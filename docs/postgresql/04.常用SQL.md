## 常用SQL



### 数据库管理

??? note "数据库创建"
    CREATE DATABASE实际上是通过拷贝一个现有的数据库进行工作的。默认地它将拷贝名为template1的标准系统数据库。 
    
    所以该数据库是创建新数据库的"模板"。如果你给template1增加对象，这些对象将被拷贝到随后创建的用户数据库中。这样的行为允许节点对数据库中的标准套件进行修改。
    
    比如，如果你把过程语言PL/Perl安装到template1里， 那么你在创建用户数据库的时候它们就会自动可得，而不需要额外的动作。
    
    PostgreSQL默认有template0、template1两个模板，创建数据库时不指定模板，则默认模板为template1。用户也可以指定其他的自定义模板创建数据库。
    
      - 使用 template1 模板库建库时不可指定新的字符集和本地化collate属性
    
      - 使用 template0 模板库建库时可指定字符集和本地化collate属性



<details>
  <summary>建库</summary>

    ```sql
    create database db_test  with owner fengzhao tablespace pg_default;

    CREATE DATABASE db_test
     WITH  
        OWNER = stxz  
        TEMPLATE = template0 
        ENCODING = UTF8	
        LC_COLLATE = 'zh_CN.utf8'
        LC_CTYPE = 'zh_CN.utf8'
        TABLESPACE = default 
        ALLOW_CONNECTIONS = true 
        CONNECTION LIMIT = -1 
        IS_TEMPLATE = 0 
    ;			 
	

    ```

</details>


```SQL

-----------------------------------------------------------------------------------------------------------------
-- 建库
-- CREATE DATABASE实际上是通过拷贝一个现有的数据库进行工作的。默认地它将拷贝名为template1的标准系统数据库。 
-- 所以该数据库是创建新数据库的"模板"。如果你给template1增加对象，这些对象将被拷贝到随后创建的用户数据库中。这样的行为允许节点对数据库中的标准套件进行修改。 
-- 比如，如果你把过程语言PL/Perl安装到template1里， 那么你在创建用户数据库的时候它们就会自动可得，而不需要额外的动作。

-- PostgreSQL默认有template0、template1两个模板，创建数据库时不指定模板，则默认模板为template1。用户也可以指定其他的自定义模板创建数据库。
-- 使用 template1 模板库建库时不可指定新的字符集和本地化collate属性
-- 使用 template0 模板库建库时可指定字符集和本地化collate属性

-- 建库指定owner，指定表空间，这时默认的模板就是template1
create database db_test  with owner fengzhao tablespace pg_default;




CREATE DATABASE db_test
 WITH  
    OWNER = stxz  
    TEMPLATE = template0 
    ENCODING = UTF8	
    LC_COLLATE = 'zh_CN.utf8'
    LC_CTYPE = 'zh_CN.utf8'
    TABLESPACE = default 
    ALLOW_CONNECTIONS = true 
    CONNECTION LIMIT = -1 
    IS_TEMPLATE = 0 
;			 
			 


grant connect on database db_test to fengzhao;



-- 建模式

create schema public;
comment on schema public is 'test';
alter schema public owner to fengzhao;






-----------------------------------------------------------------------------------------------------------------






select *  from pg_database;
select * from pg_user;
select * from pg_stat_activity;

```