
# 关系模型


## 关系模型基本逻辑概念

???+ 实体[Entity]
     实体是现实世界中可以区分于其他对象的一个事物或对象，每个实体有一组性质，其中一些性质的值可以唯一标识一个实体。实体是首要的数据对象，常用于表示一个人、地方、某样事物或某个事件。一个特定的实体被称为实体实例（entity instance或entity occurrence）。<br>
     例如每个人就是一个实体，人有姓名，性别，年龄，身份证等属性。身份证号就可以唯一标识一个人。**可以简单把一个实体等价认为一行数据。** <br>
     
     - 实体属性：属性是实体集中的每个实体都拥有描述性信息，比如每个student实体都有 student_id，sex，name，age等属性。<br>
     - 简单属性：不可以进一步拆分的属性，例如：student实体的sex属性只能是male或female。<br>
     - 复合属性：可以进一步拆分的属性，例如：student实体的name属性可以进一步拆分为：first_name和last_name两个子属性。<br>
     - 单值属性：每个特定实体中的某个属性只有一个值。即student表中任何一个行的sex列都只能是一个值，male和female。<br>
     - 多值属性：每个特定实体中的某个属性可能有多个值。即student表中任何一个行的phone_number列可能有多个值，一个学生有多个电话号码。<br>
     - 派生属性：这类属性的值可以从别的相关属性或实体派生出来（也就是可通过别的属性计算出来）。即年龄是通过当前时间和出生日期计算出来的。<br>

???+ 实体集[Entities]
     实体集：是相同类型即具有相同属性的实体集合，例如：实体集 student 可以用来标识大学中所有学生的集合。**可以简单的把实体集等价认为是一张表。**


???+ 联系[Relationship]
     联系：实体与实体之间相互关联，存在关联关系，例如：student实体与insructor实体之间存在关系，表示教师是学生的导师。关系表示一个或多个实体之间的联系。关系依赖于实体，一般没有物理概念上的存在。关系最常用来表示实体之间，一对一，一对多，多对多的对应。关系的构图是一个菱形，关系的名称一般为动词<br>

???+ 联系集[Relationships]
     联系集：相同类型联系的集合，例如：student与insructor这两个实体集中的多个教师与多个学生之间存在导师-学生关系（advisor）。每个实体集可以参与多个联系集。<br>

     - 联系集的度：参与联系集的实体集的数量称为度，我们常见的是二元联系集，是涉及两个实体的联系集。度为3。<br>

     - 参与：如果实体集中的每个实体都参与到联系集中，则称为完全参与，如果只有部分实体参与到联系中，称为部分参与。<br>


???+ 映射基数
     映射基数（基数比率）：表示一个实体通过联系集可能关联的实体个数。<br>

     - 一对一：A实体集中的一个实体最多与B实体集中一个实体关联，B实体集中的一个实体最多与A实体集中一个实体关联。**每个学生只能有一个老师，每个老师只能有一个学生。**<br>
     - 一对多：A实体集中的一个实体可能与B实体集中任意个实体关联，B实体集中的一个实体最多与A实体集中一个实体关联。**每个学生可以有任意个老师，每个老师只能有一个学生。**<br>
     - 多对一：**多个学生对应一个老师。**<br>
     - 多对多：**多个学生对应多个老师。**<br>



???+ 表
     - 在关系数据库中，表也被叫做关系，它是一种行列形式的二维表。其实就是一系列二维数组的集合，用于存储各种信息。<br>
     - 关系模型中用 **元组** 指代 **行** ，用 **属性** 指代 **列**。<br>
     - 用 **关系实例** 指代一个关系中的特定实例，也就是一行数据。<br>
     - 对于关系中的每个属性的取值范围，称为该属性的域，对于域中的元素，如果是不可再分的单元，则称为为这个域是**原子性**的。<br>



## 关系模型基础

关系模型是逻辑模型中的一种，也是现在普遍使用的一种。其由实体、属性和关系三者构成。其可以使用一张二维表进行关系呈现。

关系模型由 ==数据结构、数据操作和完整性约束== 三部分构成:

- 构造机制（数据结构）：其中数据结构是指数据自身的组织形式；
- 构造机制（数据结构）：数据操作是指对数据进行的增删改查的操作，而对数据的查询是该模型中最为重要的操作；
- 约束机制（数据约束）：完整性约束是指满足现实条件的数据值的范围等


作为数据库的一种数据模型，关系模型提供了一组完整性规则或限制。==完整性约束用于确定关系数据库里数据的准确性和一致性。==

在关系型数据库里，完整性约束包括域完整性、实体完整性、引用完整性以及用户定义完整性。


### 完整性约束

#### 域完整性

域完整性，是指给定列的取值范围（即输入的有效性），比如性别取值应为男或女。<br>

强制域有效性的方法有：

- 限制数据类型（通过数据类型）: 建表时指定字段的数据类型，自然而然就限制了字段的取值范围。<br>
- 格式（通过 CHECK 约束和规则）：check约束，指定某个字段的取值范围。例如用户名必须大写、余额不能小于零等。<br>
- 可能值的范围（通过 FOREIGN KEY 约束、CHECK 约束、DEFAULT 定义、NOT NULL 定义和规则）。<br>


> 现在互联网业务系统中，数据库往往是瓶颈，字段限制，往往可以在前端校验完成，外键约束，实体完整性等，可以在后端完成，不一定要完全依赖数据库的各种约束。这样可以有效减少数据库计算判断的压力。


#### 实体完整性

实体完整性，是指使用主键来唯一地标识一个实体。

在关系数据库中，一条记录代表一个实体。而实体是可以相互区分、识别的，也即它们应具有某种唯一性标识（该标识不能取相同的值，也不能为空）。<br>

实体完整性强制表的标识符列或主键的完整性（通过索引、UNIQUE 约束、PRIMARY KEY 约束或 IDENTITY 属性）。<br>


#### 引用完整性

引用完整性，就是定义外键与主键之间的引用规则。参照的完整性要求关系中不允许引用不存在的实体。也称引用完整性，参照完整性描述了实体间的联系。参照完整性一般是指多个实体表之间的引用关系。





???+ 码

     码是数据系统中的基本概念。所谓码就是能唯一标识实体的属性，他是整个实体集的性质，而不是单个实体的性质。

     一个元组的属性值必须是能够唯一区分元组的，换句话说，一个关系中没有两个元组在所有属性上的取值都相同。即表中没有完全重复的行。

    - 超码：一个或多个属性的集合，这些属性可以使我们在一个关系中唯一标识一个元组，这个属性集合被称为超码（super key），如果K是超码，那么K的任意超集也是超码。

    - 候选码：存在这样得一些超码，即他们得任意真子集都不能成为超码。这样的最小超码称为候选码（candidate key）

    - 主码：主码（primary key，中文又称主键）是被数据库设计者被选中的，主要用来在一个关系中区分不同元组的候选码。

    - 外码：外码（foregin key，中文又称外键），假设在某个表R1中存在一个属性，这个属性是另外一个表R2的主键。则这个属性在R1上被称为参照R2的外码（外键）。
           外码用于表示两个或多个实体间的关联关系。外码实际上是关系中的一个或多个属性，这些属性引用其他关系的主码或（候选码）




???+ 函数依赖
   　设一个关系为R(U)，X和Y为属性集U上的子集，若对于X上的每个值都有Y上的一个唯一值与之对应，则称X和Y具有函数依赖关系，并称X 函数决定Y,或称Y函数依赖于X，记作X→Y，称X为决定因素。










## 形式化关系查询

关系代数是一种过程化查询语言。它包含一个运算的集合。这些运算以一个或多个关系做为输入，产生一个新关系做为结果。


基本运算：

- 选择运算：对应SELECT条件查询，选择运算选出来给定谓词的元组。\Sigma
- 投影运算：对应SELECT的字段，仅查询出需要的字段
- 集合并运算: 对应 UNION 查询，
- 集合差运算：
- 笛卡尔积运算：




\Sigma

