

##  字符

字符（Charcter）是文字与符号的总称，包括文字、图形符号、数学符号等。26个英文字母属于字符，每个汉字也属于一个字符。

计算机只能处理数字，如果要处理文本，就必须先把文本转换为数字才能处理。最早的计算机在设计时采用8个比特（bit）作为一个字节（byte）。

所以，一个字节能表示的最大的整数就是255（二进制11111111=十进制255），如果要表示更大的整数，就必须用更多的字节。

比如两个字节可以表示的最大整数是65535，4个字节可以表示的最大整数是4294967295。


## 字符编码和字符集

**字符集** 

由非常多个字符组合后产生的集合，这个集合称为字符集。

也就是说，我们可以人为的根据某个规则归纳一些我们使用的文字、符号，这些文字、符号的集合就称为一个字符集，并且可以根据不同的规则划分不同的字符集。

### 字符编码

二进制（binary）

binary 。计算机底层存储处理数据只是一大堆二进制的0和1

如果要想让计算机识别我们人类的文字、符号、数字，就需要一个转换规则，把我们人类使用的各种字符转换成计算机认识的二进制，也就是0和1。字符集和二进制的映射编码规则就称为**字符编码规则**。


### ASCII编码

由于计算机是美国人发明的，因此，最早只有127个字母被编码到计算机里，也就是大小写英文字母、数字和一些符号，这个编码表被称为ASCII编码，比如大写字母 A 的编码是65，小写字母 z 的编码是122。

ASCII字符集最大的缺点就是只能显示26个基本拉丁字母、阿拉伯数字和英式的标点符号，以及控制字符（回车键、退格、换行键等），因此只能用于显示现代美国英语。

但是要处理中文显然一个字节是不够的，至少需要两个字节，而且还不能和ASCII编码冲突，所以，中国制定了GB2312编码，用来把中文编进去。

全世界有上百种语言，日本把日文编到Shift_JIS里，韩国把韩文编到Euc-kr里，各国有各国的标准，就会不可避免地出现冲突，结果就是，在多语言混合的文本中，显示出来会有乱码。


### Unicode字符集

在中国发展出以上字符集合字符编码的同时，计算机也在世界各个国家迅速普及和发展着，每个国家为了使计算机能够显示当地语言和符号，也纷纷设计出了各种字符集和字符编码规则。

每个国家搞一套，在自己国家使用没问题，但随着互联网的兴起，使得各个国家的计算机都接入到互联网，信息的交流和通信越来越多，但由于编码规则不同，很快就出现了不兼容的乱码现象。

为了解决这个问题，迫切需要一个统一的字符集，能够涵盖世界各个国家的文字和符号，这个字符集就是Unicode字符集。

Unicode字符集每年都在修订和更新中，持续不断地纳入新的文字和字符。

Unicode字符集编码是由一个名为Unicode学术学会(Unicode Consortium)的机构制订的字符编码系统，支持现今世界各种不同语言的书面文本的交换、处理及显示。

该编码于1990年开始研发，1994年正式公布。


#### Unicode字符集的优缺点

Unicode字符编码的优点是能覆盖世界上任何一种语言所用的文字符号，但缺点也很明显，我们常用的文字字符都是采用2个字节16位编码，这在进行字符存储和网络传输时，消耗的资源是比较大的。

例如，如果一个仅包含基本7位ASCII字符的Unicode文件，如果每个字符都使用2字节的Unicode编码传输，其第一字节的8位始终为0，这就造成了比较大的浪费。

为了解决这个问题，节省存储空间、提高网络传输效率，提出了Unicode转换格式（Unicode Transformation Format），简称UTF。

UTF-32、UTF-16、UTF-8都是为了转换Unicode码所制定的各种转换方案。



## MySQL中的字符集

character set 。想要把各种人类可以理解的字符存储到计算机中，就需要建立字符与二进制数字的映射关系。

字符集就是这样的一种映射关系，不同的字符集表示的字符数量不同，字符集越大，所能表示的字符越多，需要占用的二进制位更多，需要的磁盘空间就越大。


MySQL中所支持的字符集存在 information. CHARACTER_SETS表中，其中  **utf8mb4**  字符集兼容性最好，它可以存各种语言的字符，包括 emoji 表情等。

```SQL
-- 查看MySQL支持的字符集

SHOW CHARACTER SET;

select * from information_schema.character_sets;



```




### 排序规则

在 SQL 中，经常有排序或比较等场景。

collation，检验规则，又称排序规则，一般是用于比较字符的一套规则，即字符的排序规则。比如有的规则区分大小写，有的则无视。


世界上的文字很多，所以才会有“不区分音调”的要求，这时候e、ē、é、ě、è就是等价的。

那么假设我们要进行拼音查找，只要按e去找就可以全部列出来，很方便。甚至，它们也和ê、ë也是等价的，这样就更方便了。

每种字符集都可能有多种检验规则，并且都有一个默认的检验规则(information_schema. CHARACTER_SETS.DEFAULT_COLLATE_NAME)

**每个校验规则只能用于一个字符集，因此字符集与校验规则是一对多的关系。**

校验规则存储在  information_schema.COLLATIONS 表中。一般使用  utf8mb4_general_ci 排序规则。

排序规则命名惯例：字符集名\_对应的语言排序规则_ai/as/ci/cs/ks/bin






## 计算中的常见中文字符集

### GB2312-80 字符集

GB 2312 或 GB 2312-80 是 **中国国家标准简体中文字符集** ，全称《信息交换用汉字编码字符集·基本集》，又称 GB0，由中国国家标准总局发布，于 1981 年 5 月 1 日实施。GB 2312 编码通行于中国大陆；新加坡等地也采用此编码。

中国大陆几乎所有的中文系统和国际化的软件都支持 GB 2312。

GB 2312 标准共收录 6763 个汉字，其中一级汉字 3755 个，二级汉字 3008 个；同时收录了包括拉丁字母、希腊字母、日文平假名及片假名字母、俄语西里尔字母在内的 682 个字符。

GB 2312 的出现，基本满足了汉字的计算机处理需要，它所收录的汉字已经覆盖中国大陆99.75% 的使用频率。

对于人名、古汉语等方面出现的罕用字，GB 2312 不能处理，这导致了后来 GBK 及 GB 18030 汉字字符集的出现。


GB 2312 对任意一个图形字符都采用两个字节表示，并对所收汉字进行了“分区”处理，每区含有 94 个汉字／符号，分别对应第一字节和第二字节。这种表示方式也称为区位码。

- 01-09 区为特殊符号。
- 16-55 区为一级汉字，按拼音排序。
- 56-87 区为二级汉字，按部首／笔画排序。
- 10-15 区及 88-94 区则未有编码。

GB 2312 的编码范围为 2121H-777EH，与 ASCII 有重叠，通行方法是将 GB 码两个字节的最高位置 1 以示区别。



### GBK字符集

GBK 即汉字内码扩展规范，K 为汉语拼音 Kuo Zhan（扩展）中“扩”字的声母。英文全称 Chinese Internal Code Specification。GBK 共收入 21886 个汉字和图形符号，包括：

- GB 2312 中的全部汉字、非汉字符号。
- BIG5 中的全部汉字。
- 与 ISO 10646 相应的国家标准 GB 13000 中的其它 CJK 汉字，以上合计 20902 个汉字。
- 其它汉字、部首、符号，共计 984 个。

GBK 向下与 GB 2312 完全兼容，向上支持 ISO 10646 国际标准，在前者向后者过渡过程中起到的承上启下的作用。

GBK 采用双字节表示，总体编码范围为 8140-FEFE 之间，首字节在 81-FE 之间，尾字节在 40-FE 之间，剔除 XX7F 一条线。GBK 编码区分三部分：
汉字区　包括
- GBK/2：0XBOA1-F7FE, 收录 GB 2312 汉字 6763 个，按原序排列；
GBK/3：0X8140-AOFE，收录 CJK 汉字 6080 个；
GBK/4：0XAA40-FEAO，收录 CJK 汉字和增补的汉字 8160 个。
图形符号区　包括
GBK/1：0XA1A1-A9FE，除 GB 2312 的符号外，还增补了其它符号
GBK/5：0XA840-A9AO，扩除非汉字区。
用户自定义区
GBK 区域中的空白区，用户可以自己定义字符。



### GB18030字符集

GB18030编码采用单字节、双字节、四字节分段编码方案，具体码位见下文。GB18030向下兼容GBK和GB2312编码。

国家标准GB18030-2005《信息技术 中文编码字符集》是我国继GB2312-1980和GB13000-1993之后最重要的汉字编码标准，是我国计算机系统必须遵循的基础性标准之一。

GB18030有两个版本：GB18030-2000和GB18030-2005。GB18030-2000是GBK的取代版本，它的主要特点是在GBK基础上增加了CJK统一汉字扩充A的汉字。GB18030-2005的主要特点是在GB18030-2000基础上增加了CJK统一汉字扩充B的汉字。