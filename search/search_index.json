{"config":{"lang":["en"],"separator":"[\\s\\u200b\\u3000\\-\u3001\u3002\uff0c\uff0e\uff1f\uff01\uff1b]+","pipeline":["stemmer"]},"docs":[{"location":"","title":"Home","text":""},{"location":"#mysql","title":"MySQL\u7248\u672c","text":"<p>\u672c\u7ad9\u70b9\u4e2d\u7684\u793a\u4f8b\u4ee3\u7801\u4ec5\u9488\u5bf9 MySQL<code>8.0.26</code> \u7248\u672c\u8fdb\u884c\u4e86\u6d4b\u8bd5\u3002</p>"},{"location":"#_1","title":"\u6307\u5f15","text":"<p>\u5982\u679c\u4f60\u662f \u65b0\u624b , \u90a3\u4e48\u8bf7\u4ece Ansible \u5165\u95e8 \u5f00\u59cb\u4e86\u89e3 Ansible\u3002</p> <p>\u5982\u679c\u4f60\u662f \u8fd0\u7ef4\u4eba\u5458 , \u90a3\u4e48\u8bf7\u770b\u770b Ansible \u8fdb\u9636 \u4ee5\u4fbf\u6df1\u5165\u4f7f\u7528 Ansible\u3002</p> <p>\u5982\u679c\u4f60\u60f3\u5f00\u53d1 Ansible \u4ee5\u5b9e\u73b0\u81ea\u5b9a\u4e49\u7684\u529f\u80fd, \u90a3\u4e48\u8bf7\u770b\u770b Ansible \u5f00\u53d1 \u4ee5\u4fbf\u5feb\u901f\u5f00\u53d1\u4f7f\u7528\u3002</p> <p>\u5982\u679c\u4f60\u60f3\u5728 WEB \u754c\u9762\u4e0a\u6267\u884c ansible , \u90a3\u4e48\u8bf7\u770b\u770b Ansible UI \u4ee5\u4fbf\u5feb\u901f\u5728 WEB \u4e2d\u4f7f\u7528\u3002</p> <p>\u5982\u679c\u4f60\u60f3\u5bfb\u627e\u53ef\u4f7f\u7528\u7684 Roles , \u90a3\u4e48\u8bf7\u770b\u770b Ansible Roles \u4ee5\u4fbf\u5feb\u901f\u5e94\u7528\u3002</p> <p>\u5982\u679c\u4f60\u60f3\u4e3a\u81ea\u5df1\u7684Ansible\u5b66\u4e60\u505a\u4e2a\u9636\u6bb5\u603b\u7ed3, \u4e0d\u59a8\u53bb\u8003\u53d6\u7ea2\u5e3d\u7684 Ansible \u8ba4\u8bc1\uff0c\u90a3\u4e48\u8bf7\u770b\u770b Ansible \u8ba4\u8bc1 \u4ee5\u4fbf\u9009\u62e9\u9002\u5408\u81ea\u5df1\u7684\u8003\u8bd5\u3002</p> <p>\u82e5\u60a8\u89c9\u5f97\u672c\u7ad9\u70b9\u6240\u521b\u9020\u7684\u5185\u5bb9\u5bf9\u60a8 \u6709\u6240\u5e2e\u52a9 \uff0c\u53ef\u8003\u8651\u7565\u8868\u5fc3\u610f\uff0c\u652f\u6301\u4e00\u4e0b\u3002</p> <p>\u5982\u679c\u4f60\u53d1\u73b0\u6587\u7ae0 \u6709\u9519\u8bef\uff0c\u8bf7\u5728\u6587\u7ae0\u4e0b\u65b9 \u8bc4\u8bba \u5904\u6279\u8bc4\u6307\u6b63\uff0c\u6216\u8005\u63d0\u4ea4\u4e00\u4e2aPR\u5e2e\u52a9\u4fee\u6b63\u3002</p> <p>\u5982\u679c\u4f60\u5728\u4f7f\u7528 Ansible \u7684\u8fc7\u7a0b\u4e2d\u5b58\u5728\u95ee\u9898\uff0c\u8bf7\u5728 \u8bba\u575b \u4e2d\u63d0\u51fa\u95ee\u9898\uff0c\u540e\u7eed\u4f1a\u6709\u7f51\u53cb\u5e2e\u5fd9\u89e3\u51b3\u3002\u5982\u679c\u4f60\u80fd\u5e2e\u52a9\u89e3\u51b3\u95ee\u9898\uff0c\u8bf7\u5e2e\u5fd9\u89e3\u51b3\u4e0b\uff0c\u5e76\u628a\u89e3\u51b3\u65b9\u6848\u56de\u590d\u5728\u5e16\u5b50\u4e2d\u3002</p> <p></p> <p></p>"},{"location":"#mysql_1","title":"MySQL\u5165\u95e8\u6559\u7a0b","text":"<p>\u4ece\u96f6\u5f00\u59cb\u5b66\u4e60MySQL\uff0c\u4e3b\u8981\u662f\u9762\u5411MySQL\u6570\u636e\u5e93\u7ba1\u7406\u7cfb\u7edf\u521d\u5b66\u8005\u3002\u524d\u7aef\u5f00\u53d1\u5de5\u7a0b\u5e08\u4e3a\u4ec0\u4e48\u5199\u8fd9\u4e2a\u5165\u95e8\u6559\u7a0b\u5462\uff1f\u6700\u8fd1\u9879\u76ee\u5f3a\u8feb\u6211\u8fd9\u4e2a\u524d\u7aef\u8001\u53f8\u673a\u4f7f\u7528MySQL\uff0c\u867d\u7136\u6211\u5728\u9879\u76ee\u4e2d\u5df2\u7ecf\u4f7f\u7528\u8fc7\u4e00\u6bb5\u65f6\u95f4\uff0c\u4e3a\u4e86\u5199\u51fa\u9ad8\u8d28\u91cf\u7684SQL\u8bed\u53e5\uff0c\u80fd\u5feb\u901f\u5b9a\u4f4d\u89e3\u51b3\u6570\u636e\u5e93\u5f15\u53d1\u7684\u95ee\u9898\uff0c\u7cfb\u7edf\u7684\u8fc7\u4e00\u904d\u57fa\u7840\uff0c\u4f60\u4e5f\u53ef\u4ee5\u5f53\u505a\u662f\u6211\u7684\u7b14\u8bb0\u3002\u6709\u5e78\u4e5f\u8ba4\u8bc6\u4e00\u4e9b MySQL \u7684 DBA\uff0c\u8fd9\u8ba9\u6211\u5b66\u4e60\u8d77\u6765\u6bd4\u8f83\u5feb\uff0c\u80fd\u5feb\u901f\u5165\u95e8\uff0c\u8fdb\u5165\u5b9e\u6218\u5f00\u53d1\u9636\u6bb5\u3002</p> <p>\u539f\u672c\u6211\u662f\u4f7f\u7528 MongoDB \u8fd9\u7c7b\u578b\u7684 NoSQL \u6570\u636e\u5e93\uff0cMongoDB\u5728 Nodejs \u5728 Mongoose \u5305\u7684\u5e2e\u52a9\u4e0b JSON \u7684\u6570\u636e\u683c\u5f0f\u76f4\u63a5\u63d2\u5165 MongoDB \u4e2d\uff0c\u5bf9\u4e8e\u4e00\u4e2a\u524d\u7aef\u5f00\u53d1\u5de5\u7a0b\u5e08\uff0c\u4f7f\u7528\u8d77\u6765\u975e\u5e38\u8212\u670d\u3002\u4f46\u662f\u6ca1\u6709\u529e\u6cd5\uff0c\u6211\u662f\u88ab\u903c\u7684\uff0c\u4ece\u6b64\u5165\u4e86\u4e00\u4e2a\u65b0\u5751\uff0c\u6211\u5c31\u51b3\u5fc3\u7cfb\u7edf\u7684\u597d\u597d\u5b66\u4e60\u4e00\u4e0b\u3002\u5982\u679c\u4f60\u5bf9\u672c\u5c0f\u7535\u5b50\u4e66\u9605\u8bfb\u975e\u5e38\u6ca1\u6709\u8010\u5fc3\uff0c\u4f60\u53ef\u4ee5\u770b\u770b\u6211\u505a\u7684\u4e00\u7bc7\u7b14\u8bb0 \u300a21\u5206\u949fMySQL\u57fa\u7840\u5165\u95e8\u300b \uff0c\u8fd9\u4e2a\u7b14\u8bb0\u8fd8\u53ef\u4ee5\u5728 SegmentFault \u91cc\u9762\u9605\u8bfb\uff0c\u6709\u5bfc\u822a\u9605\u8bfb\u975e\u5e38\u65b9\u4fbf\uff0c\u4e3a\u4ec0\u4e48\u53ea\u9700\u898121\u5206\u949f\u5462\uff1f\u56e0\u4e3a\u5728\u6211\u4eec\u5927\u5929\u671d\u6709\u53e5\u8bdd\u53eb\u505a\u201c\u4e0d\u7ba1\u4e09\u4e03\u4e8c\u5341\u4e00\u201d\uff0c\u4f60\u53ef\u4ee5\u4e0d\u7ba1\u4e09\u4e03\u4e8c\u5341\u4e00\u5f00\u59cb\u4f7f\u7528 MySQL \u53ca\u5feb\u901f\u5165\u95e8\uff0c\u91cc\u9762\u7cfb\u7edf\u7684\u6574\u7406\u4e86\uff0c\u4e00\u4e9b\u5e38\u7528\u7684SQL\u8bed\u53e5\u3002</p> <p>\u5728\u672c\u4e66\u4e2d\u6240\u641c\u96c6\u5230\u5f97\u5404\u79cd\u8d44\u6e90\uff0c\u6211\u628a\u5b83\u5c06\u653e\u5230\u8fd9\u91cc Awesome MySQL\u3002\u6240\u6709SQL\u8bed\u53e5\u4f8b\u5b50\uff0c\u662f\u57fa\u4e8e MySQL 5.7.14 \u6216\u8005 MySQL 5.7.16 \u8fd0\u884c\u7684\u3002\u8fd9\u91cc\u9762\u7684\u4e00\u4e9b\u7406\u8bba\u77e5\u8bc6\u90fd\u662f\u4ece\u7ef4\u57fa\u767e\u79d1\u7b49\u5404\u79cd\u767e\u79d1\u3001\u5404\u79cd\u5b98\u7f51\u642c\u8fd0\u8fc7\u6765\u7684\uff0c\u5076\u5c14\u4f1a\u6709\u4e00\u4e9b\u57fa\u7840\u7406\u8bba\u77e5\u8bc6\u603b\u7ed3\uff0c\u5982\u679c\u6709\u9519\u8bef\u6216\u8005\u8bef\u5dee\uff0c\u53ef\u4ee5\u7ed9\u6211\u6765\u4e2a\u75af\u72c2\u7684Pull requesets\u6216Issue\u3002\u5982\u679c\u5b9e\u5728\u770b\u4e0d\u4e0b\u53bb\u4f60\u53ef\u4ee5\ud83d\udd2b\u3002</p> <p>MariaDB\uff0c\u662f MySQL server \u7684\u4e00\u4e2a\u7531\u793e\u533a\u5f00\u53d1\u7684\u5206\u652f\uff0cMariaDB\u5927\u90e8\u5206\u8ddf MySQL 5.5 \u4ee5\u524d\u7248\u672c\u4f7f\u7528\u5dee\u4e0d\u591a\u3002\u81ea\u5df1\u7535\u8111\u4e0a\u662f MySQL 5.7.14\uff0c\u516c\u53f8\u670d\u52a1\u5668\u4e0a\u9762\u662f MariaDB \u6700\u65b0\u7248\u672c\uff0c\u751f\u4ea7\u4e0a MySQL 5.7.16\uff0c\u6240\u4ee5\u5f88\u5c34\u5c2c\uff0c\u5076\u5c14\u63d0\u53caMariaDB\u4e5f\u662f\u5f88\u6b63\u5e38\u7684\u5427\u3002</p>"},{"location":"#_2","title":"\u76ee\u5f55","text":""},{"location":"#awesome-mysql","title":"Awesome MySQL","text":"<ul> <li>21\u5206\u949fMySQL\u57fa\u7840\u5165\u95e8</li> <li>\u624b\u518c\u6587\u6863 - \u4e00\u4e9b\u975e\u5b98\u65b9\u7684\u624b\u518c\u6587\u6863\u641c\u96c6</li> <li>\u5206\u6790\u5de5\u5177 - \u6027\u80fd\uff0c\u7ed3\u6784\u548c\u6570\u636e\u5206\u6790\u5de5\u5177</li> <li>GUI - \u641c\u96c6\u7684\u4e00\u4e9b MySQL \u7684\u5ba2\u6237\u7aef\uff0c\u4e5f\u6709\u547d\u4ee4\u884c\u5ba2\u6237\u7aef</li> <li>\u670d\u52a1\u5668 - MySQL\u670d\u52a1\u5668\u7684\u884d\u751f\u54c1</li> <li>\u5907\u4efd - \u5907\u4efd/\u5b58\u50a8/\u6062\u590d \u5de5\u5177</li> <li>\u5b98\u65b9\u8d44\u6599 - \u5b98\u65b9\u7684\u4e00\u4e9b\u7f51\u7ad9\u548c\u6587\u7ae0</li> <li>\u4f18\u79c0\u6587\u7ae0 - \u4e00\u4e9b\u4f18\u79c0\u7684\u6587\u7ae0</li> </ul>"},{"location":"#1-mysql","title":"\u7b2c1\u7ae0 \u521d\u8bc6MySQL","text":"<ul> <li>1.1 \u6570\u636e\u5e93\u57fa\u7840<ul> <li>\u4ec0\u4e48\u662f\u6570\u636e\u5e93</li> <li>\u6570\u636e\u5e93\u5206\u7c7b</li> <li>\u6570\u636e\u5e93\u6a21\u578b</li> <li>\u6570\u636e\u8868</li> <li>\u5173\u7cfb\u952e</li> </ul> </li> <li>1.2 \u6570\u636e\u5e93\u6280\u672f\u6784\u6210<ul> <li>\u6570\u636e\u5e93\u7cfb\u7edf</li> <li>\u5173\u7cfb\u6570\u636e\u5e93\u57fa\u672c\u6982\u5ff5</li> <li>SQL\u8bed\u8a00</li> <li>\u6570\u636e\u5e93\u8bbf\u95ee\u6280\u672f</li> </ul> </li> <li>1.3 \u4ec0\u4e48\u662fMySQL<ul> <li>MySQL\u4ecb\u7ecd</li> <li>MySQL\u53d1\u5c55\u5386\u53f2</li> <li>MySQL\u7248\u672c</li> <li>MySQL\u7684\u4f18\u52bf</li> </ul> </li> <li>1.4 \u5982\u4f55\u5b66\u4e60MySQL</li> </ul>"},{"location":"#2-mysql","title":"\u7b2c2\u7ae0 MySQL\u7684\u5b89\u88c5\u4e0e\u914d\u7f6e","text":"<ul> <li>2.1 Mac\u5e73\u53f0\u4e0b\u5b89\u88c5\u4e0e\u914d\u7f6eMySQL<ul> <li>Mac\u4e0a\u5b89\u88c5MySQL</li> <li>Mac\u4e0a\u5378\u8f7dMySQL</li> </ul> </li> <li>2.2 Centos \u5e73\u53f0\u5b89\u88c5\u4e0e\u5378\u8f7dMySQL<ul> <li>\u68c0\u67e5\u662f\u5426\u5df2\u5b89\u88c5</li> <li>\u66f4\u65b0\u5b89\u88c5\u6e90</li> <li>\u68c0\u67e5\u662f\u5426\u4e0b\u8f7d\u6210\u529f</li> <li>\u67e5\u770b\u7248\u672c</li> <li>\u542f\u52a8\u6307\u5b9a\u7248\u672c</li> <li>\u5b89\u88c5MySQL</li> <li>\u67e5\u770b\u5b89\u88c5\u76ee\u5f55</li> <li>MariaDB\u5207\u6362MySQL</li> <li>\u5378\u8f7d MySQL \u8f6f\u4ef6</li> </ul> </li> <li>2.3 Docker \u5b89\u88c5 MySQL<ul> <li>\u5feb\u901f\u542f\u52a8\u4e00\u4e2a MySQL \u670d\u52a1\u5668\u5b9e\u4f8b</li> <li>\u901a\u8fc7\u547d\u4ee4\u884c\u8bbf\u95ee MySQL \u5bb9\u5668</li> <li>\u4f7f\u7528 MySQL \u81ea\u5b9a\u4e49\u914d\u7f6e\u6587\u4ef6</li> <li>\u4f7f\u7528 stack \u90e8\u7f72 MySQL</li> </ul> </li> <li>2.4 \u542f\u52a8\u6570\u636e\u5e93\u8bbe\u7f6e\u521d\u59cb\u5bc6\u7801<ul> <li>\u547d\u4ee4\u884c\u542f\u52a8\u5173\u95ed\u91cd\u542fMySQL\u670d\u52a1</li> <li>\u56fe\u50cf\u754c\u9762\u542f\u52a8\u5173\u95ed\u91cd\u542fMySQL\u670d\u52a1</li> <li>\u67e5\u770b\u521d\u59cb\u5bc6\u7801</li> <li>\u8bbe\u7f6e\u521d\u59cb\u5316\u5bc6\u7801</li> <li>\u542f\u52a8\u62a5\u9519\u5904\u7406</li> </ul> </li> <li>2.5 MySQL\u5de5\u5177<ul> <li>\u547d\u4ee4\u884c\u4f7f\u7528\u7a0b\u5e8f</li> <li>MySQL Workbench\u5ba2\u6237\u7aef</li> <li>\u5e38\u7528\u56fe\u5f62\u7ba1\u7406\u5de5\u5177</li> <li>MyCli\u66ff\u4ee3MySQL\u7684mysql\u547d\u4ee4\u884c\u5de5\u5177</li> </ul> </li> <li>2.6 MySQL\u914d\u7f6e\u4fee\u6539<ul> <li>MySQL\u5b89\u88c5\u76ee\u5f55\u8bf4\u660e</li> <li>\u914d\u7f6e\u6587\u4ef6\u7684\u4f4d\u7f6e</li> <li>Windows\u7cfb\u7edf\u914d\u7f6e\u6587\u4ef6\u8bfb\u53d6</li> <li>Linux\u7cfb\u7edf\u914d\u7f6e\u6587\u4ef6\u8bfb\u53d6</li> <li>\u914d\u7f6e\u6587\u4ef6\u5185\u5bb9</li> </ul> </li> </ul>"},{"location":"#3","title":"\u7b2c3\u7ae0 \u6570\u636e\u5e93\u7684\u57fa\u672c\u64cd\u4f5c","text":"<ul> <li>3.1 \u8fde\u63a5\u6570\u636e\u5e93<ul> <li>MySQL\u547d\u4ee4\u8bed\u6cd5</li> <li>MySQL\u547d\u4ee4\u8fde\u63a5\u6570\u636e\u5e93</li> <li>\u5f00\u542fMySQL\u7684\u8fdc\u7a0b\u5e10\u53f7</li> <li>MySQL\u4fee\u6539\u5bc6\u7801</li> </ul> </li> <li>3.2 \u67e5\u770b\u9009\u62e9\u6570\u636e\u5e93<ul> <li>\u67e5\u770b\u6570\u636e\u5e93</li> <li>\u9009\u62e9\u6570\u636e\u5e93</li> </ul> </li> <li>3.3 \u521b\u5efa\u6570\u636e\u5e93<ul> <li>SQL\u8bed\u53e5\u521b\u5efa\u6570\u636e\u5e93</li> <li>\u7ba1\u7406\u5de5\u5177\u521b\u5efa\u6570\u636e\u5e93</li> </ul> </li> <li>3.4 \u5220\u9664\u6570\u636e\u5e93<ul> <li>SQL\u8bed\u53e5\u5220\u9664\u6570\u636e\u5e93</li> <li>\u7ba1\u7406\u5de5\u5177\u5220\u9664\u6570\u636e\u5e93</li> </ul> </li> <li>3.5 \u6570\u636e\u5e93\u5b58\u50a8\u5f15\u64ce<ul> <li>\u5b58\u50a8\u5f15\u64ce\u7b80\u4ecb</li> <li>\u5e38\u7528\u5f15\u64ce\u5bf9\u6bd4</li> <li>\u67e5\u770b\u5b58\u50a8\u5f15\u64ce</li> <li>\u8bbe\u7f6e\u5b58\u50a8\u5f15\u64ce</li> <li>\u5982\u4f55\u9009\u62e9\u5408\u9002\u7684\u5b58\u50a8\u5f15\u64ce</li> </ul> </li> </ul>"},{"location":"#4","title":"\u7b2c4\u7ae0 \u6570\u636e\u8868\u7684\u57fa\u672c\u64cd\u4f5c","text":"<ul> <li>4.1 \u521b\u5efa\u6570\u636e\u8868</li> </ul>"},{"location":"#5","title":"\u7b2c5\u7ae0 \u6570\u636e\u7c7b\u578b\u548c\u8fd0\u7b97\u7b26","text":""},{"location":"#6-mysql","title":"\u7b2c6\u7ae0 MySQL\u51fd\u6570","text":""},{"location":"#7","title":"\u7b2c7\u7ae0 \u67e5\u8be2\u6570\u636e","text":""},{"location":"#8","title":"\u7b2c8\u7ae0 \u63d2\u5165\u3001\u66f4\u65b0\u4e0e\u5220\u9664\u6570\u636e","text":""},{"location":"#9","title":"\u7b2c9\u7ae0 \u7d22\u5f15","text":""},{"location":"#10","title":"\u7b2c10\u7ae0 \u5b58\u50a8\u8fc7\u7a0b\u548c\u51fd\u6570","text":""},{"location":"#11","title":"\u7b2c11\u7ae0 \u89c6\u56fe","text":""},{"location":"#12-mysql","title":"\u7b2c12\u7ae0 MySQL\u51fd\u6570","text":""},{"location":"#13-mysql","title":"\u7b2c13\u7ae0 MySQL\u7528\u6237\u7ba1\u7406","text":""},{"location":"#14","title":"\u7b2c14\u7ae0 \u6570\u636e\u5907\u4efd\u4e0e\u8fd8\u539f","text":""},{"location":"#15-mysql","title":"\u7b2c15\u7ae0 MySQL\u65e5\u5fd7","text":""},{"location":"#16","title":"\u7b2c16\u7ae0 \u6027\u80fd\u4f18\u5316","text":""},{"location":"#17","title":"\u7b2c17\u7ae0 \u5404\u79cd\u95ee\u9898\u89e3\u51b3","text":"<ul> <li>\u8ba9MySQL\u652f\u6301emoji\u56fe\u6807\u5b58\u50a8</li> <li>Centos6\u4e0b\u5347\u7ea7MySQL\u6570\u636e\u5e93</li> <li>MySQL\u4fee\u6539\u5bc6\u7801<ul> <li>mysqld_safe\u4e0d\u5b58\u5728\u4fee\u6539\u5bc6\u7801</li> <li>\u542f\u52a8\u4fee\u6539\u4e22\u5931\u7684mysql\u5355\u5b9e\u4f8broot\u5bc6\u7801\u65b9\u6cd5</li> <li>Mac\u4e0b\u91cd\u7f6eMySQL\u7684root\u5bc6\u7801</li> <li>\u4e0d\u91cd\u542fmysqld\u4fee\u6539\u5bc6\u7801\u7684\u65b9\u6cd5</li> </ul> </li> <li>Centos7 \u9ed8\u8ba4\u4e3aMariaDB\u5bfc\u81f4mysql\u5b89\u88c5\u4e0d\u4e0a</li> <li>mysql\u547d\u4ee4\u4e0d\u5b58\u5728</li> <li>MySQL\u670d\u52a1\u542f\u52a8\u5931\u8d25\u89e3\u51b3\u65b9\u6848</li> <li>\u5bc6\u7801\u4e0d\u6ee1\u8db3\u5f53\u524d\u7684\u7b56\u7565\u8981\u6c42\u5bfc\u81f4\u65e0\u6cd5\u5f00\u542f\u8fdc\u7a0b\u5e10\u53f7</li> </ul>"},{"location":"#_3","title":"\u8bfb\u8005\u5bf9\u8c61","text":"<p>\u6574\u672c\u4e66\u76ee\u5f55\u89c4\u5212\u53c2\u8003\u4e86\u5176\u5b83\u51e0\u672c MySQL \u4e66\u7c4d\u76ee\u5f55\u89c4\u5212\u7684\uff0c\u5728\u6211\u8fb9\u5b66\u4e60\u8fb9\u6574\u7406\u7684\u8fc7\u7a0b\u53ef\u80fd\u6709\u4fee\u6539\uff0c\u8fd9\u4e2a\u8fc7\u7a0b\u6709\u70b9\u6162\uff0c\u5e0c\u671b\u80fd\u5b8c\u6210\uff0c\u6240\u4ee5\u6559\u7a0b\u9002\u5408\u4ee5\u4e0b\u8bfb\u8005\u5b66\u4e60\u9605\u8bfb\u4f7f\u7528\uff1a</p> <ul> <li>MySQL \u6570\u636e\u5e93\u521d\u5b66\u8005\u3002</li> <li>\u5bf9\u6570\u636e\u5e93\u5f00\u53d1\u611f\u5174\u8da3\uff0c\u5e0c\u671b\u5feb\u901f\u3001\u5168\u9762\u638c\u63e1 MySQL \u7684\u4eba\u5458\u3002</li> <li>\u5bf9\u5176\u4ed6\u6570\u636e\u5e93\u6709\u4e00\u5b9a\u7684\u4e86\u89e3\uff0c\u60f3\u8f6c\u5230 MySQL \u5e73\u53f0\u4f7f\u7528\u5b83\u7684\u5f00\u53d1\u8005\u3002</li> <li>\u50cf\u6211\u4e00\u6837\u88ab\u903c\u65e0\u5948\u4f7f\u7528 MySQL \u6570\u636e\u5e93\u7684\u4eba\u3002</li> </ul> <p>\u4ece\u76ee\u5f55\u6765\u770b\uff0c\u770b\u4e0a\u53bb\u5185\u5bb9\u4e30\u5bcc\uff0c\u6bd4\u8f83\u5b8c\u6574\u7684\u4ecb\u7ecd\u4e86 MySQL \u6570\u636e\u5e93\u6280\u672f\u7684\u6559\u7a0b\uff0c\u6211\u4e0d\u662f<code>DBA</code>\uff0c\u6211\u4e0d\u662f\uff0c\u6b63\u5728\u770b\u8fd9\u7bc7\u6587\u7ae0\u7684\u4f60\uff0c\u5f88\u53ef\u80fd\u4e5f\u4e0d\u662f\uff0c\u4e0d\u60f3\u8bef\u4eba\u5b50\u5f1f\uff0c\u5728\u9879\u76ee\u4e2d\u5e94\u7528\u4e86\u4e00\u6bb5\u65f6\u95f4 MySQL\uff0c\u5982\u679c\u4f60\u662f<code>DBA</code>\u8bf7\u591a\u591a\u6307\u6559\uff0c\u6587\u91c7\u4e0d\u4f73\u8fd8\u671b\u9ad8\u62ac\u8d35\u624b\uff0c\u4e0d\u751a\u611f\u6fc0\uff0c\u5c0f\u5f1f\u5728\u8fd9\u91cc\u7ed9\u60a8\u97a0\u8eac\uff0c\u6b22\u8fce\u7ed9\u6211\u7ea0\u9519\u3002</p> <p>\u6211\u60f3\u5ff5\u4e00\u4e2a\u5973\u5b69\u513f\uff0c\u5b9e\u5c5e\u65e0\u5948\u6211\u5f97\u7ee7\u7eed\u52aa\u529b\uff0c\u597d\u597d\u8bfb\u4e66\u505a\u4e2a\u6709\u8da3\u7684\u4eba\uff0c\u5b8c\u6210\u6211\u7684\u201c\u8457\u4f5c\u201d\uff0c\u5f85\u6211\u8457\u4f5c\u5b8c\u6210\u53ef\u5426\u8ddf\u6211\u7ea6\u4e2a\u4f1a\uff1f</p>"},{"location":"resources/","title":"MySQL \u8d44\u6e90\u603b\u89c8","text":"<p>mysql-5.7.31-linux-glibc2.12-x86_64.tar.gz</p> <p>mysql-8.0.24-linux-glibc2.12-x86_64.tar.xz</p> <p>\u56fd\u5185\u7684\u534e\u4e3a\u4e91\u955c\u50cf\u7ad9</p> <p>MySQL8.0 \u5b98\u65b9\u624b\u518c\u4e2d\u6587\u7248</p> <p>MySQL8 \u67e5\u8be2\u6027\u80fd\u8c03\u4f18</p> <p>\u6df1\u5165\u7406\u89e3 MySQL InnoDB \u5b58\u50a8\u5f15\u64ce</p>"},{"location":"resources/#_1","title":"\u79d1\u5927\u5b66\u4e60\u8d44\u6e90","text":"<p>1.\u6570\u636e\u5e93\u7cfb\u7edf\u6982\u8bba*\u7b2c\u4e00\u7ae0*\u7eea\u8bba</p> <p>2.\u6570\u636e\u5e93\u7cfb\u7edf\u6982\u8bba*\u7b2c\u4e8c\u7ae0*\u5173\u7cfb\u6570\u636e\u5e93</p> <p>3.1 \u6570\u636e\u5e93\u7cfb\u7edf\u6982\u8bba*\u7b2c\u4e09\u7ae0*\u5173\u7cfb\u6570\u636e\u5e93\u6807\u51c6\u8bed\u8a00 SQL_\u4e0a</p> <p>3.2 \u6570\u636e\u5e93\u7cfb\u7edf\u6982\u8bba*\u7b2c\u4e09\u7ae0*\u5173\u7cfb\u6570\u636e\u5e93\u6807\u51c6\u8bed\u8a00 SQL_\u4e0b</p> <p>4.\u6570\u636e\u5e93\u7cfb\u7edf\u6982\u8bba*\u7b2c\u56db\u7ae0*\u6570\u636e\u5e93\u5b89\u5168\u6027</p> <p>5.\u6570\u636e\u5e93\u7cfb\u7edf\u6982\u8bba*\u7b2c\u4e94\u7ae0*\u6570\u636e\u5e93\u5b8c\u6574\u6027</p> <p>6.\u6570\u636e\u5e93\u7cfb\u7edf\u6982\u8bba*\u7b2c\u516d\u7ae0*\u5173\u7cfb\u6570\u636e\u7406\u8bba</p> <p>7.\u6570\u636e\u5e93\u7cfb\u7edf\u6982\u8bba*\u7b2c\u4e03\u7ae0*\u6570\u636e\u5e93\u8bbe\u8ba1</p> <p>8.\u6570\u636e\u5e93\u7cfb\u7edf\u6982\u8bba*\u7b2c\u516b\u7ae0*\u6570\u636e\u5e93\u7f16\u7a0b</p> <p>9.\u6570\u636e\u5e93\u7cfb\u7edf\u6982\u8bba*\u7b2c\u4e5d\u7ae0*\u5173\u7cfb\u67e5\u8be2\u5904\u7406\u548c\u67e5\u8be2\u4f18\u5316</p> <p>10.\u6570\u636e\u5e93\u7cfb\u7edf\u6982\u8bba*\u7b2c\u5341\u7ae0*\u6570\u636e\u5e93\u6062\u590d\u6280\u672f</p> <p>11.\u6570\u636e\u5e93\u7cfb\u7edf\u6982\u8bba*\u7b2c\u5341\u4e00\u7ae0*\u5e76\u53d1\u63a7\u5236</p>"},{"location":"resources/#_2","title":"\u6570\u636e\u5e93\u5b66\u4e60\u8d44\u6599","text":"<p>15-445 Introduction to Database System\u53ef\u80fd\u662f\u6570\u636e\u5e93\u9886\u57df\u6700\u51fa\u540d\u7684\u4e00\u95e8\u7ecf\u5178\u8bfe\u7a0b\u3002</p> <p>\u8fd9\u4e3b\u8981\u662f\u56e0\u4e3a\u662f\u8fd9\u95e8\u8bfe\u7684\u6388\u8bfe\u8001\u5e08<code>Andy Pavlo</code>\u591a\u5e74\u6765\u4e00\u76f4\u575a\u6301\u5c06\u8fd9\u95e8\u8bfe\u51e0\u4e4e\u6240\u6709\u7684\u8d44\u6e90\u90fd\u5f00\u653e\u51fa\u6765\u4f9b\u5168\u4e16\u754c\u6240\u6709\u5bf9\u6570\u636e\u5e93\u611f\u5174\u8da3\u7684\u4eba\u5b66\u4e60\u3002\u8be5\u8bfe\u7a0b\u4ee5 <code>Database System Concepts</code> \u4e3a\u6559\u6750\uff0c\u63d0\u4f9b\u968f\u5802\u8bb2\u4e49\u3001\u7b14\u8bb0\u548c\u89c6\u9891\uff0c\u7cbe\u5fc3\u51c6\u5907\u4e86\u51e0\u4e2a\u4e92\u76f8\u52fe\u8fde\u7684\u5c0f\u5b9e\u9a8c\u3002</p> <p>\u8be5\u8bfe\u7a0b\u5341\u5206\u6ce8\u91cd\u7cfb\u7edf\u8bbe\u8ba1\u548c\u7f16\u7a0b\u5b9e\u73b0\uff0c\u7528\u4e3b\u8bb2\u6559\u6388 <code>Andy Pavlo</code> \u7684\u8bdd\u8bf4\uff0c\u8fd9\u662f\u4e00\u95e8\u53ef\u4ee5\u5199\u5728\u7b80\u5386\u4e0a\u3001\u5e76\u4e14\u80fd\u5e2e\u4f60\u62ff\u5230\u597d offer \u7684\u8bfe\u7a0b\u3002</p> <p>\u7b80\u5355\u4ecb\u7ecd\u4e0b cmu15445 \u7684\u6559\u5b66\u5927\u7eb2\uff0c\u8be5\u8bfe\u4ee5 Database System Concepts \u4e3a\u8f85\u52a9\u6559\u6750\uff0c \u8bb2\u8ff0\u4e86\u6570\u636e\u5e93\u7ba1\u7406\u7cfb\u7edf\uff08DBMS\uff09\u8bbe\u8ba1\u548c\u5b9e\u73b0\u7684\u65b9\u65b9\u9762\u9762\uff0c\u5305\u62ec\uff1a</p> <ul> <li>\u6570\u636e\u6a21\u578b\uff08\u5173\u7cfb\u578b\uff0c\u6587\u6863\u578b\uff0c\u952e\u503c\u578b\uff09</li> <li>\u5b58\u50a8\u6a21\u578b\uff08n-ary\uff0cdecomposition\uff0c\u53ef\u4ee5\u7406\u89e3\u4e3a\u884c\u5f0f\u3001\u5217\u5f0f\uff09</li> <li>\u67e5\u8be2\u8bed\u8a00\uff08sql\uff0c\u5b58\u50a8\u8fc7\u7a0b stored procedures\uff09</li> <li>\u5b58\u50a8\u7ed3\u6784\uff08heaps\uff0c\u57fa\u4e8e\u65e5\u5fd7 log-structured\uff09</li> <li>\u7d22\u5f15\u8bbe\u8ba1\uff08\u6392\u5e8f\u6811\uff0c\u54c8\u5e0c\u8868\uff09</li> <li>\u4e8b\u52a1\u5904\u7406\uff08ACID\uff0c\u5e76\u53d1\u63a7\u5236\uff09</li> <li>\u6570\u636e\u6062\u590d\uff08\u65e5\u5fd7\u3001\u5feb\u7167\uff09</li> <li>\u6267\u884c\u5f15\u64ce\uff08joins\uff0c\u6392\u5e8f\uff0c\u805a\u96c6\uff0c\u4f18\u5316\uff09</li> <li>\u5e76\u53d1\u67b6\u6784\uff08\u591a\u6838\uff0c\u5206\u5e03\u5f0f\uff09</li> </ul> <p>https://blog.bcmeng.com/</p> <p>OLAP \u6027\u80fd\u4f18\u5316\u6307\u5357</p>"},{"location":"BigData/HDFS/1.HDFS%E5%AE%9E%E6%88%98/","title":"HDFS \u90e8\u7f72","text":""},{"location":"BigData/HDFS/1.HDFS%E5%AE%9E%E6%88%98/#_1","title":"\u6982\u8ff0","text":"<p>Hadoop\u662f\u4e00\u4e2a\u5f00\u6e90\u7684\u5206\u5e03\u5f0f\u8ba1\u7b97\u5e73\u53f0\uff0c\u7531Apache\u8f6f\u4ef6\u57fa\u91d1\u4f1a\u5f00\u53d1\u548c\u7ef4\u62a4\u3002\u5b83\u662f\u5927\u6570\u636e\u5904\u7406\u7684\u57fa\u77f3\uff0c\u80fd\u591f\u9ad8\u6548\u5730\u5b58\u50a8\u548c\u5904\u7406\u5927\u89c4\u6a21\u6570\u636e\u3002</p> <p>\u76ee\u524d\u4e1a\u754c\u57fa\u672c\u4e0a\u7528\u7684\u90fd\u662f**Hadoop\u53ca\u5176\u751f\u6001\u4e0b\u7684\u4ea7\u54c1**\u3002</p> <p>Hadoop\u7684\u4e3b\u8981\u7279\u70b9\u662f\u9ad8\u53ef\u9760\u6027\u548c\u9ad8\u6269\u5c55\u6027\uff0c\u5b83\u53ef\u4ee5\u5728\u6210\u767e\u4e0a\u5343\u4e2a\u8282\u70b9\u4e0a\u8fd0\u884c\uff0c\u6bcf\u4e2a\u8282\u70b9\u90fd\u53ef\u4ee5\u5b58\u50a8\u548c\u5904\u7406\u6570\u636e\u3002</p> <p>\u72ed\u4e49\u7684Hadoop\uff0c\u901a\u5e38\u5c31\u6307HDFS + MapReduce + YARN \uff0c\u4f46\u662f\u968f\u7740\u5176\u751f\u6001\u7684\u53d1\u5c55\uff0c\u4eca\u5929\u6211\u4eec\u518d\u63d0\u53caHadoop\uff0c\u901a\u5e38\u6307\u7684\u662f\u5b83\u7684\u6574\u4e2a\u751f\u6001\uff0c\u5305\u62ecHive\u3001Hbase\u3001Spark\u3001Pig\u3001Flume\u3001Sqoop\u7b49\u7b49\u3002</p> <p>\u8fd9\u91cc\uff0c\u6211\u4eec\u4e3b\u8981\u4ecb\u7ecd\u201c\u72ed\u4e49\u7684Hadoop\u201d\uff0c\u6307HDFS\u3001MapReduce\u3001YARN\u8fd9\u4e09\u4e2a\u7ec4\u4ef6\u3002</p> <p>\u5728\u65e9\u671f\uff0cHadoop\u7684\u751f\u6001\u8fd8\u4e0d\u9f50\u5168\uff0c\u56e0\u6b64MapReduce\u65e2\u8d1f\u8d23\u8ba1\u7b97\uff0c\u4e5f\u8d1f\u8d23\u5bf9\u591a\u8282\u70b9\u7684\u8d44\u6e90\u8fdb\u884c\u7ba1\u7406\uff0c\u4ee5\u5b8c\u6210\u4f5c\u4e1a\u7684\u5408\u7406\u5206\u914d\u3002</p> <p>\u5347\u7ea7\u52302.x\u540e\uff0c\u628a1.x\u4e2dMapReduce\u7684\u529f\u80fd\u5265\u79bb\u5f00\uff0c\u65b0\u589e\u4e86YARN\u7ec4\u4ef6\u505a\u7edf\u4e00\u7684\u8d44\u6e90\u7ba1\u7406\u548c\u8c03\u5ea6\u3002</p> <p>Hadoop\u4e3b\u8981\u7531\u4ee5\u4e0b\u4e09\u4e2a\u7ec4\u4ef6\u6784\u6210\uff1a</p> <p>1\u3001Hadoop\u5206\u5e03\u5f0f\u6587\u4ef6\u7cfb\u7edf\uff08HDFS\uff09\uff1aHDFS\u662fHadoop\u7684\u5b58\u50a8\u7cfb\u7edf\uff0c\u7528\u4e8e\u5b58\u50a8\u5927\u91cf\u7684\u6570\u636e\u3002\u5b83\u901a\u8fc7\u5c06\u6570\u636e\u5206\u6563\u5b58\u50a8\u5728\u591a\u4e2a\u8282\u70b9\u4e0a\u6765\u5b9e\u73b0\u6570\u636e\u7684\u53ef\u9760\u5b58\u50a8\u548c\u9ad8\u541e\u5410\u91cf\u8bbf\u95ee\u3002</p> <p>\u200b       \u6570\u636e\u88ab\u5206\u5272\u6210\u5757\uff08\u901a\u5e38\u662f128MB\u6216256MB\u5927\u5c0f\uff09\uff0c\u5e76\u5728\u591a\u4e2a\u8282\u70b9\u4e0a\u590d\u5236\uff0c\u4ee5\u63d0\u9ad8\u6570\u636e\u7684\u53ef\u9760\u6027\u548c\u7cfb\u7edf\u7684\u5bb9\u9519\u80fd\u529b\u3002\u2003\u2003</p> <p>2\u3001MapReduce\uff1aMapReduce\u662fHadoop\u7684\u5904\u7406\u6846\u67b6\uff0c\u7528\u4e8e\u5927\u89c4\u6a21\u6570\u636e\u5904\u7406\u3002\u5b83\u5c06\u6570\u636e\u5904\u7406\u4efb\u52a1\u5206\u89e3\u6210\u4e24\u4e2a\u51fd\u6570\uff1aMap\u548cReduce\u3002Map\u51fd\u6570\u5904\u7406\u8f93\u5165\u6570\u636e\uff0c\u5e76\u751f\u6210\u4e2d\u95f4\u952e\u503c\u5bf9\u3002Reduce\u51fd\u6570\u5219\u5bf9\u8fd9\u4e9b\u4e2d\u95f4\u952e\u503c\u5bf9\u8fdb\u884c\u805a\u5408\u5904\u7406\uff0c\u751f\u6210\u6700\u7ec8\u7684\u7ed3\u679c\u3002\u2003\u2003</p> <p>3\u3001YARN\uff08Yet Another Resource Negotiator\uff09\uff1aYARN\u662fHadoop\u7684\u8d44\u6e90\u7ba1\u7406\u5668\uff0c\u8d1f\u8d23\u7ba1\u7406\u96c6\u7fa4\u4e2d\u7684\u8ba1\u7b97\u8d44\u6e90\u3002\u5b83\u5141\u8bb8\u5404\u79cd\u6570\u636e\u5904\u7406\u5e94\u7528\u5728Hadoop\u96c6\u7fa4\u4e0a\u8fd0\u884c\uff0c\u4e0d\u4ec5\u4ec5\u9650\u4e8eMapReduce\u3002</p> <p>HDFS</p> <p>Hadoop Distributed File System (HDFS) \u662fHadoop\u7684\u6700\u6838\u5fc3\u7ec4\u4ef6\uff0c\u7528\u6765\u5b58\u50a8\u5927\u91cf\u6570\u636e\u3002HDFS\u662f\u4e00\u79cd\u5206\u5e03\u5f0f\u6587\u4ef6\u7cfb\u7edf\uff0c\u5b83\u5c06\u6570\u636e\u5b58\u50a8\u5728\u7531\u5927\u91cf\u5ec9\u4ef7\u786c\u4ef6\u7ec4\u6210\u7684\u96c6\u7fa4\u4e0a\uff0c\u5e76\u63d0\u4f9b\u9ad8\u541e\u5410\u91cf\u7684\u6570\u636e\u8bbf\u95ee\uff0c\u9002\u5408\u7528\u4e8e\u5927\u89c4\u6a21\u6570\u636e\u5904\u7406\u573a\u666f\u3002</p> <p>\u7531\u4e8e\u8981\u5177\u6709\u9ad8\u5bb9\u9519\u6027\u3001\u9ad8\u541e\u5410\u91cf\u7684\u7279\u70b9\uff0cHDFS\u5728\u5b58\u50a8\u6570\u636e\u65f6\u4f1a\u8fdb\u884c\u5207\u5757\uff0c\u7136\u540e\u5bf9\u6bcf\u4e2a\u5757\u8fdb\u884c\u591a\u526f\u672c\u5b58\u50a8\uff0c\u6bcf\u4e2a\u526f\u672c\u5b58\u50a8\u5728\u4e0d\u540c\u7684\u4ece\u8282\u70b9\u4e0a\uff0c\u4ee5\u907f\u514d\u56e0\u5355\u8282\u70b9\u6545\u969c\u9020\u6210\u6570\u636e\u4e22\u5931\u3002</p> <p>\u6b63\u56e0\u4e3aHDFS\u662f\u591a\u526f\u672c\u5b58\u50a8\u7684\uff08\u9ed8\u8ba4\u526f\u672c\u6570\u4e3a3\uff09\uff0c\u5982\u679c\u4f60\u770b\u5230\u4f60\u5728\u4f60\u4eec\u516c\u53f8\u81ea\u7814\u7684\u7ba1\u7406\u5e73\u53f0\u4e0a\u770b\u5230\u7684\u8868\u603b\u5927\u5c0f\u662f3GB\uff0c\u90a3\u4e48\u5176\u5b9e\u5b83\u6709\u53ef\u80fd\u5b9e\u9645\u4e0a\u53ea\u67091GB\u3002\u8981\u6ce8\u610f\u5206\u6e05\u6587\u4ef6\u5927\u5c0f\u7edf\u8ba1\u7684\u8ba1\u7b97\u65b9\u6cd5\u3002</p> <p>HDFS\u4e3b\u8981\u6709\u4e09\u4e2a\u6838\u5fc3\u6982\u5ff5\uff1a</p> <ul> <li>Client\uff1a\u7528\u4e8e\u4e0eHDFS\u4ea4\u4e92\u7684\u63a5\u53e3\uff0c\u6bd4\u5982\u547d\u4ee4<code>hadoop fs</code>\u6216\u8005Java\u63a5\u53e3\u3002\u901a\u8fc7RPC\u4e0e\u8282\u70b9\u901a\u4fe1\u3002\u2003\u2003</li> <li>NameNode\uff1aHDFS\u96c6\u7fa4\u4e2d\u7684\u4e3b\u8282\u70b9\uff0c\u8d1f\u8d23\u7ef4\u62a4\u6574\u4e2a\u6587\u4ef6\u7cfb\u7edf\u7684\u547d\u540d\u7a7a\u95f4\u548c\u5143\u6570\u636e\u3002\u2003\u2003</li> <li>DataNode\uff1a\u5b58\u50a8\u5b9e\u9645\u7684\u6570\u636e\u5757\uff0c\u8d1f\u8d23\u5904\u7406\u6587\u4ef6\u7cfb\u7edf\u5ba2\u6237\u7aef\u7684\u8bfb\u5199\u8bf7\u6c42\uff0c\u53d1\u9001\u5fc3\u8df3\u3002</li> </ul> <p>\u5ba2\u6237\u7aef</p> <p>HDFS Shell \u547d\u4ee4\u7684\u57fa\u672c\u683c\u5f0f\u5982\u4e0b\uff1ahdfs dfs \u547d\u4ee4 \u53c2\u6570\u3002</p> <p>\u5b83\u548c Linux \u4e0a\u7684 Shell \u547d\u4ee4\u662f\u6bd4\u8f83\u76f8\u4f3c\u7684\uff0c\u6bd4\u5982\u67e5\u770b\u67d0\u4e2a\u76ee\u5f55\u4e0b\u7684\u6587\u4ef6\uff0c\u5728 Linux \u4e2d\u662f ls\uff0c\u90a3\u4e48\u5728 HDFS \u4e2d\u5c31\u662f hdfs dfs -ls\u3002\u518d\u6bd4\u5982\u67e5\u770b HDFS \u4e0a\u7684\u6587\u4ef6\u5185\u5bb9\uff0c\u547d\u4ee4\u4e3a hdfs dfs -cat filename\u3002</p> <p>\u53ef\u4ee5\u770b\u5230\u662f\u975e\u5e38\u76f8\u4f3c\u7684\uff0c\u53ea\u4e0d\u8fc7\u5bf9\u4e8e HDFS \u6765\u8bf4\uff0c\u547d\u4ee4\u7684\u524d\u9762\u9700\u8981\u52a0\u4e0a\u4e00\u4e2a\u6a2a\u6760\u3002</p> <p>\u53ea\u8981\u4f60\u5728\u96c6\u7fa4\u91cc\u9762\u7684\u4efb\u4f55\u4e00\u4e2a\u8282\u70b9\u6267\u884c\u8bf8\u5982 <code>hdfs dfs -ls /</code> \u4e4b\u7c7b\u7684\u547d\u4ee4\u64cd\u4f5c\uff0c\u90a3\u4e48\u4f60\u5c31\u4f7f\u7528\u7684\u662f\u4e3b\u8282\u70b9\u6216\u8005\u4ece\u8282\u70b9\uff0c\u5426\u5219\u4f60\u4f7f\u7528\u7684\u5c31\u662f\u5ba2\u6237\u7aef\u3002\u6ce8\u610f\uff0c\u5ba2\u6237\u7aef\u6ca1\u6709\u5305\u62ec\u5728Hadoop\u96c6\u7fa4\u4e4b\u4e2d\u3002</p>"},{"location":"BigData/HDFS/1.HDFS%E5%AE%9E%E6%88%98/#_2","title":"\u96c6\u7fa4\u89c4\u5212","text":"<p>https://www.cnblogs.com/live41/p/15483192.html https://www.cnblogs.com/Courage129/p/17528827.html</p> ip\u5730\u5740 \u8282\u70b9\u89d2\u8272 <code>ActiveNameNode</code>\u3001<code>ResourceManager</code> <code>StadbyNameNode</code> JournalNode <p>\u73af\u5883\u53d8\u91cf</p> JAVA_HOME HADOOP_HOME <pre><code>mkdir -p  /data/ &amp;&amp;  cd /data/\nwget https://dlcdn.apache.org/hadoop/common/hadoop-3.4.1/hadoop-3.4.1.tar.gz\n\n# \u89e3\u538b\ntar -zxvf hadoop-3.4.1.tar.gz\n\n# HDFS\u7684\u914d\u7f6e\u6587\u4ef6\uff1a\u5927\u591a\u6570\u9ed8\u8ba4\u662fXML\u548cTXT\u683c\u5f0f\u5b58\u5728\u3002\u914d\u7f6e\u6587\u4ef6\u9ed8\u8ba4\u5b58\u653e\u5728/etc/hadoop\u76ee\u5f55\u4e0b\u3002\n\n# HDFS\u4e2d6\u4e2a\u91cd\u8981\u7684\u914d\u7f6e\u6587\u4ef6\uff1a\n\n# core-site.xml:Hadoop\u5168\u5c40\u7684\u914d\u7f6e\u6587\u4ef6\uff0c\u4e5f\u5305\u542b\u4e00\u4e9bHDFS\u7684\u5b8f\u89c2\u914d\u7f6e\u3002\n# dfs-site.xml:HDFS\u914d\u7f6e\u6587\u4ef6\u3002\n# yarn-site.xml:YARN\u914d\u7f6e\u6587\u4ef6\u3002\n# mapred-sie.xml:MapReduce\u914d\u7f6e\u6587\u4ef6\u3002\n# slaves:\u4ece\u8282\u70b9\u5217\u8868\u3002\n# hadoop-env.sh:\u4e0e\u8fd0\u884c\u811a\u672c\u7684\u73af\u5883\u53d8\u91cf\u76f8\u5173\u7684\u914d\u7f6e\u6587\u4ef6\u3002\n\n# \u8bbe\u7f6eJavaHome\uff0c\u4fee\u6539JAVA_HOME\u53d8\u91cf\uff0c\u5927\u7ea6\u572854\u884c\nvim /data/hadoop-3.4.1/etc/hadoop/hadoop-env.sh\nexport JAVA_HOME=/usr/java/jdk1.8.0_201\n\n# \u4fdd\u5b58\u540e\u6d4b\u8bd5\u542f\u52a8\ncd /data/hadoop-3.4.1/\nbin/hadoop\n\n\n# \u5728core\u914d\u7f6e\u6587\u4ef6\u6587\u4ef6\u7684configuration\u8282\u70b9\u6dfb\u52a0\u4e0b\u9762\u914d\u7f6e\u6587\u4ef6\uff08\u7b2c19\u884c\uff09\u3002 \u5982\u679c\u6ca1\u6307\u5b9ahadoop.tmp.dir\u3002\u90a3\u4e48 namenode \u683c\u5f0f\u5316\u5728 /tmp/hadoop-root/dfs/name \u4e0b\nvim  /data/hadoop-3.4.1/etc/hadoop/core-site.xml\n&lt;configuration&gt;\n    &lt;property&gt;\n        &lt;name&gt;fs.defaultFS&lt;/name&gt; &lt;!--\u6307\u5b9anamenode\u7684\u5730\u5740--&gt;\n        &lt;value&gt;hdfs://localhost:9000&lt;/value&gt;\n    &lt;/property&gt;\n    &lt;property&gt;\n        &lt;name&gt;hadoop.tmp.dir&lt;/name&gt;&lt;!--\u7528\u6765\u6307\u5b9a\u4f7f\u7528hadoop\u65f6\u4ea7\u751f\u6587\u4ef6\u7684\u5b58\u653e\u76ee\u5f55--&gt;\n        &lt;value&gt;/var/sxt/hadoop/local&lt;/value&gt;\n    &lt;/property&gt;\n&lt;/configuration&gt;\n\n# \u5728dfs\u6587\u4ef6\u7684configuration\u8282\u70b9\u6dfb\u52a0\u4e0b\u9762\u914d\u7f6e\u6587\u4ef6\uff08\u7b2c19\u884c\uff09\nvim  /data/hadoop-3.4.1/etc/hadoop/hdfs-site.xml\n&lt;configuration&gt;\n    &lt;property&gt;\n        &lt;name&gt;dfs.replication&lt;/name&gt;\n        &lt;value&gt;1&lt;/value&gt;\n    &lt;/property&gt;\n&lt;/configuration&gt;\n\n# \u6587\u4ef6\u9876\u90e8\u6dfb\u52a0\u4ee5\u4e0b\u53c2\u6570\nvim  /data/hadoop-3.4.1/sbin/start-dfs.sh\nvim  /data/hadoop-3.4.1/sbin/stop-dfs.sh\n#!/usr/bin/env bash\nHDFS_DATANODE_USER=root\nHADOOP_SECURE_DN_USER=hdfs\nHDFS_NAMENODE_USER=root\nHDFS_SECONDARYNAMENODE_USER=root\n\n\n# \u6587\u4ef6\u9876\u90e8\u6dfb\u52a0\u4ee5\u4e0b\u53c2\u6570\nvim  /data/hadoop-3.4.1/sbin/start-yarn.sh\nvim  /data/hadoop-3.4.1/sbin/stop-yarn.sh\n#!/usr/bin/env bash\nYARN_RESOURCEMANAGER_USER=root\nHADOOP_SECURE_DN_USER=yarn\nYARN_NODEMANAGER_USER=root\n\n\n# \u6587\u4ef6\u7cfb\u7edf\u683c\u5f0f\u5316\n/data/hadoop-3.4.1/bin/hdfs namenode -format\n\n# \u542f\u52a8NameNode\u548cDataNode\ncd /data/hadoop-3.4.1/ &amp;&amp;  sbin/start-dfs.sh\n\n# \u6d4f\u89c8\u5668\u6253\u5f00\u7ec8\u7aef\u8fdb\u884c\u67e5\u770b\u8fd0\u884c\u72b6\u6001\uff0c\u6ce8\u610f\u9632\u706b\u5899\u7aef\u53e3\u662f\u5426\u6253\u5f00\uff0cNameNode\u7f51\u5740\u5982\u4e0b\uff1a\nhttp://192.168.40.134:9870/\n# \u73b0\u72b6\u72b6\u6001 Active \u5373\u4e3a\u8fd0\u884c\u6210\u529f\n\n# \u505c\u6b62NameNode\u548cDataNode\nsbin/stop-dfs.sh\n\n# \u542f\u52a8\uff0c\u6ce8\u610f\u987a\u5e8f\nsbin/start-dfs.sh\nsbin/start-yarn.sh\n\n# \u505c\u6b62\uff0c\u6ce8\u610f\u987a\u5e8f\nsbin/stop-yarn.sh\nsbin/stop-dfs.sh\n</code></pre>"},{"location":"BigData/HDFS/1.HDFS%E5%AE%9E%E6%88%98/#hive","title":"Hive","text":"<p>\u5728 Hive \u73af\u5883\u4e2d\uff0c<code>HADOOP_HOME</code> \u6307\u7684\u662f Hadoop \u7684\u5b89\u88c5\u76ee\u5f55\u3002</p> <p>Hive \u662f\u57fa\u4e8e Hadoop \u7684\u4e00\u4e2a\u6570\u636e\u4ed3\u5e93\uff0c\u5b83\u9700\u8981 Hadoop \u6765\u63d0\u4f9b\u5e95\u5c42\u7684\u6570\u636e\u5b58\u50a8\uff08HDFS\uff09\u548c\u8ba1\u7b97\u6846\u67b6\uff08MapReduce\uff09\u3002</p> <p><code>HADOOP_HOME</code> \u544a\u8bc9 Hive \u5728\u54ea\u91cc\u627e\u5230 Hadoop \u7684\u914d\u7f6e\u6587\u4ef6\u3001\u53ef\u6267\u884c\u6587\u4ef6\u7b49\uff0c\u4ee5\u4fbf Hive \u80fd\u591f\u6b63\u786e\u5730\u4e0e Hadoop \u4ea4\u4e92\u3002</p> <p>\u66f4\u8be6\u7ec6\u89e3\u91ca\uff1a</p> <ul> <li>Hadoop \u5b89\u88c5\u76ee\u5f55:</li> </ul> <p><code>HADOOP_HOME</code> \u6307\u7684\u4e0d\u662f\u4f60\u81ea\u5df1\u7684\u5bb6\u76ee\u5f55\uff08~\uff09\uff0c\u800c\u662f Hadoop \u8f6f\u4ef6\u7684\u5b89\u88c5\u76ee\u5f55\uff0c\u4f8b\u5982 <code>/usr/local/hadoop</code>\u3002</p> <ul> <li>Hive \u4f9d\u8d56 Hadoop:</li> </ul> <p>Hive \u4f9d\u8d56 Hadoop \u6765\u5b58\u50a8\u548c\u5904\u7406\u6570\u636e\u3002</p> <p><code>HADOOP_HOME</code> \u544a\u8bc9 Hive \u5728\u54ea\u91cc\u627e\u5230 Hadoop \u7684\u76f8\u5173\u7ec4\u4ef6\uff0c\u4f8b\u5982 HDFS \u7684\u540d\u79f0\u8282\u70b9\u548c\u6570\u636e\u8282\u70b9\uff0cMapReduce \u7684\u6267\u884c\u5f15\u64ce\u7b49\u3002</p> <ul> <li>\u8bbe\u7f6e <code>HADOOP_HOME</code> \u7684\u5fc5\u8981\u6027:</li> </ul> <p>\u5982\u679c\u4f60\u6ca1\u6709\u6b63\u786e\u8bbe\u7f6e <code>HADOOP_HOME</code>\uff0cHive \u5c06\u65e0\u6cd5\u8bbf\u95ee HDFS \u5b58\u50a8\u7684\u6570\u636e\uff0c\u4e5f\u65e0\u6cd5\u5229\u7528 Hadoop \u7684\u8ba1\u7b97\u80fd\u529b\u6765\u6267\u884c\u67e5\u8be2\u548c\u5206\u6790\u3002</p> <ul> <li>\u5982\u4f55\u8bbe\u7f6e <code>HADOOP_HOME</code>:</li> </ul> <p>\u4f60\u901a\u5e38\u9700\u8981\u5728 Hive \u7684\u914d\u7f6e\u6587\u4ef6\u4e2d\u8bbe\u7f6e <code>HADOOP_HOME</code>\uff0c\u4f8b\u5982 <code>hive-site.xml</code>\u3002\u8bbe\u7f6e\u7684\u65b9\u5f0f\u53d6\u51b3\u4e8e\u4f60\u7684 Hive \u73af\u5883\u3002</p> <ul> <li>Hive \u8bfb\u53d6 Hadoop \u914d\u7f6e:</li> </ul> <p>Hive \u4f1a\u8bfb\u53d6 Hadoop \u7684\u914d\u7f6e\uff08\u901a\u5e38\u5728<code>hadoop/conf/core-site.xml</code> \u548c <code>hadoop/conf/hdfs-site.xml</code> \u4e2d\uff09\uff0c\u5e76\u4e14 Hive \u7684\u914d\u7f6e\u4f1a\u8986\u76d6 Hadoop \u7684\u914d\u7f6e\u3002</p> <p>\u8fd9\u610f\u5473\u7740\u5982\u679c Hadoop \u7684\u914d\u7f6e\u548c Hive \u7684\u914d\u7f6e\u51b2\u7a81\uff0cHive \u7684\u914d\u7f6e\u4f1a\u4f18\u5148\u88ab\u4f7f\u7528\u3002</p> <p>\u603b\u7ed3\uff1a <code>HADOOP_HOME</code> \u662f\u4e00\u4e2a\u73af\u5883\u53d8\u91cf\uff0c\u5b83\u6307\u5411 Hadoop \u7684\u5b89\u88c5\u76ee\u5f55\uff0cHive \u9700\u8981\u5b83\u6765\u4e0e Hadoop \u4ea4\u4e92\uff0c\u5426\u5219 Hive \u65e0\u6cd5\u6b63\u786e\u5730\u5b58\u50a8\u3001\u67e5\u8be2\u548c\u5206\u6790\u6570\u636e\u3002</p> <p>Hive \u5176\u5b9e\u662f\u8981\u90e8\u7f72\u5728 NameNode \u4e2d\u5373\u53ef\uff08\u9700\u8981\u518d\u6709\u7684 namenode \u4e0a\u5b89\u88c5)\uff0c\u53ef\u4ee5\u4e0d\u5728 datanode \u8282\u70b9\u7684\u673a\u5668\u4e0a\u5b89\u88c5\u3002</p>"},{"location":"BigData/HDFS/1.HDFS%E5%AE%9E%E6%88%98/#hdfs-ipc","title":"HDFS IPC \u901a\u8baf","text":"<p>Hadoop\u4f5c\u4e3a\u4e00\u4e2a\u5206\u5e03\u5f0f\u7cfb\u7edf\uff0c\u5404\u4e2a\u6a21\u5757\u8fdb\u7a0b\u4e4b\u95f4\u5b58\u5728\u5404\u79cdIPC\uff0c\u5373RPC\u901a\u4fe1\u3002</p>"},{"location":"BigData/HDFS/1.HDFS%E5%AE%9E%E6%88%98/#hdfs_1","title":"HDFS\u7528\u6237\u548c\u6743\u9650","text":"<p>HDFS\u6587\u4ef6\u6743\u9650\u7528\u4f5c\u6bcf\u6b21\u8bbf\u95eeHDFS\u6587\u4ef6\u6216\u76ee\u5f55\u65f6\u5c1d\u8bd5\u7684\u6388\u6743\u68c0\u67e5\u3002HDFS\u6587\u4ef6\u6743\u9650\u4e0e\u901a\u5e38\u5728Linux\u6216Unix\u6587\u4ef6\u7cfb\u7edf\u4e2d\u4f7f\u7528\u7684\u6743\u9650\u975e\u5e38\u76f8\u4f3c\u3002\u4f46HDFS\u4e0eLinux\u548c\u5176\u4ed6\u91c7\u7528POSIX\u6a21\u578b\u7684\u64cd\u4f5c\u7cfb\u7edf\u4e4b\u95f4\u4e5f\u5b58\u5728\u663e\u8457\u5dee\u5f02\u3002</p> <p>\u5728Linux\u4e2d\uff0c\u6bcf\u4e2a\u6587\u4ef6\u548c\u76ee\u5f55\u90fd\u6709\u4e00\u4e2a\u7528\u6237\u548c\u7ec4\u3002HDFS\u672c\u8eab\u6ca1\u6709\u4efb\u4f55\u7528\u6237\u6216\u7ec4\u7684\u6982\u5ff5\uff0cHDFS\u53ea\u662f\u4ece\u5e95\u5c42\u7684\u64cd\u4f5c\u7cfb\u7edf\u5b9e\u4f53(\u4f8b\u5982\u5728Linux\u6587\u4ef6\u7cfb\u7edf\u4e2d\u521b\u5efa\u7684\u7528\u6237\u548c\u7ec4)\u5bfc\u51fa\u7528\u6237\u548c\u7ec4\u3002</p> <p>\u5728Kerberos\u96c6\u7fa4\u4e2d\uff0c\u7528\u6237\u7684Kerberos\u51ed\u8bc1\u51b3\u5b9a\u5ba2\u6237\u7aef\u8fdb\u7a0b\u7684\u8eab\u4efd\uff0c\u5728\u9ed8\u8ba4\u7684\u7b80\u5355\u5b89\u5168\u6a21\u5f0f\u4e0b\uff0c\u7528\u6237\u7684\u8eab\u4efd\u7531\u4e3b\u673a\u64cd\u4f5c\u7cfb\u7edf\u786e\u5b9a\u3002</p> <p>\u4e0eLinux\u6587\u4ef6\u7cfb\u7edf\u4e00\u6837\uff0c\u53ef\u4ee5\u4e3a\u6587\u4ef6\u6216\u76ee\u5f55\u7684\u6240\u6709\u8005\uff0c\u7ec4\u7684\u6210\u5458\u4ee5\u53ca\u5176\u4ed6\u4eba\u5206\u914d\u5355\u72ec\u7684\u6587\u4ef6\u6743\u9650\u3002\u53ef\u4ee5\u50cfLinux\u4e2d\u4e00\u6837\u4f7f\u7528\u6211\u4eec\u719f\u6089\u7684r(\u8bfb\u53d6\u6587\u4ef6\u5e76\u5217\u51fa\u76ee\u5f55\u7684\u5185\u5bb9)\uff0cw(\u521b\u5efa\u6216\u5220\u9664\u6587\u4ef6\u6216\u76ee\u5f55)\u548cx(\u8bbf\u95ee\u76ee\u5f55\u7684\u5b50\u76ee\u5f55)\u6743\u9650\u3002</p> <p>\u53ef\u4ee5\u4f7f\u7528\u516b\u8fdb\u5236(\u4f8b\u5982\"755\",\"644\"\u7b49)\u6765\u8bbe\u7f6e\u6587\u4ef6\u7684\u6a21\u5f0f\u3002\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u5728Linux\u6587\u4ef6\u7cfb\u7edf\u4e2d\uff0cx\u8868\u793a\u6267\u884c\u6587\u4ef6\u7684\u6743\u9650\u3002\u4f46\u5728HDFS\u4e2d\u6ca1\u6709\u8fd9\u6837\u7684\u6982\u5ff5\uff08\u663e\u7136\u5728HDFS\u4e2d\u5b58\u53ef\u6267\u884c\u6587\u4ef6\u5e76\u8fdb\u884c\u6267\u884c\u6709\u70b9\u53ef\u6015\uff09\u3002</p> <pre><code>hdfs dfs -help \u67d0\u4e2a\u547d\u4ee4\n\n# \u67e5\u770b\u67d0\u4e2a\u76ee\u5f55\u6709\u54ea\u4e9b\u6587\u4ef6\uff0c\u52a0\u4e0a -R \u8868\u793a\u9012\u5f52\u663e\u793a\u3002\nhdfs dfs -ls /\n\n# \u5728 hdfs \u4e0a\u9762\u521b\u5efa\u76ee\u5f55\uff0c\u52a0\u4e0a -p \u8868\u793a\u9012\u5f52\u521b\u5efa\uff0c\u548c Linux \u662f\u4e00\u6837\u7684\u3002\nhdfs dfs -mkdir -p  /\nhdfs dfs -mkdir -p  /girls\n\n# \u5c06\u672c\u5730\u6587\u4ef6\u6216\u76ee\u5f55\u79fb\u52a8\u5230 hdfs \u4e0a\u9762\uff0c\u6ce8\u610f\u662f\u79fb\u52a8\uff0c\u79fb\u5b8c\u4e4b\u540e\u672c\u5730\u5c31\u6ca1\u4e86\u3002\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u5982\u679c\u5728\u79fb\u52a8\u7684\u65f6\u5019\u4e0d\u624b\u52a8\u6307\u5b9a\u6587\u4ef6\u540d\uff0c\u6bd4\u5982\u5c06 /code2.py \u6362\u6210 /\uff0c\u90a3\u4e48\u79fb\u52a8\u540e\u7684\u6587\u4ef6\u540d\u548c\u539f\u6765\u4e00\u6837\u3002\nhdfs dfs -moveFromLocal \u672c\u5730\u8def\u5f84 hdfs\u8def\u5f84\n\n# \u5c06\u4e00\u4e2a\u6587\u4ef6\u7684\u5185\u5bb9\u8ffd\u52a0\u5230\u53e6\u4e00\u4e2a\u6587\u4ef6\u91cc\u9762\u53bb\u3002\nhdfs dfs -appendToFile \u8ffd\u52a0\u7684\u6587\u4ef6 \u8ffd\u52a0\u5230\u54ea\u4e2a\u6587\u4ef6\n\n# \u66f4\u6539\u7ec4\u3001\u66f4\u6539\u6743\u9650\u3001\u66f4\u6539\u6240\u6709\u8005\uff0c\u8fd9\u4e2a\u548c Linux \u4e2d\u7528\u6cd5\u4e00\u6837\u3002\nhdfs dfs [-chgrp\u3001-chmod\u3001-chown]\n\nhdfs dfs -chmod 700 /girls/test\n\n# \u8bbe\u7f6e\u6587\u4ef6\u7684\u526f\u672c\u6570\u91cf\uff0c\u6bd4\u5982 hdfs dfs -setrep 5 /file.txt\uff0c\u8868\u793a\u5c06 file.txt \u7684\u526f\u672c\u8bbe\u7f6e\u6210 5\u3002\nhdfs dfs -setrep \u6570\u503c \u6587\u4ef6\n\n\n# \u67e5\u770b\u67d0\u4e2a\u76ee\u5f55\u6709\u54ea\u4e9b\u6587\u4ef6\uff0c\u52a0\u4e0a -R \u8868\u793a\u9012\u5f52\u663e\u793a\u3002\nroot@qhdata-dev:/data/hadoop-3.4.1/bin# ./hdfs dfs -ls  /user\nFound 1 items\ndrwx------   - root supergroup          0 2025-05-29 16:12 /user/root\nroot@qhdata-dev:/data/hadoop-3.4.1/bin#\nroot@qhdata-dev:/data/hadoop-3.4.1/bin#\nroot@qhdata-dev:/data/hadoop-3.4.1/bin# ./hdfs dfs -ls  /user/root/\nroot@qhdata-dev:/data/hadoop-3.4.1/bin#\n</code></pre> <p>\u53ea\u662f\u5c06\u6587\u4ef6\u5207\u5206\u6210\u5757\uff0c\u7136\u540e\u6563\u843d\u5728\u4e0d\u540c\u8282\u70b9\u7684\u672c\u5730\u5b58\u50a8\u4e2d\u3002\u67e5\u627e\u7684\u65f6\u5019\uff0c\u4f1a\u53bb NameNode \u83b7\u53d6\u5143\u4fe1\u606f\uff0c\u627e\u5230\u76f8\u5e94\u7684\u5757\u518d\u7ec4\u5408\u8d77\u6765\uff0c\u5c31\u8fd9\u4e48\u7b80\u5355\u3002</p> <p>\u56e0\u6b64 HDFS \u8fd8\u662f\u9700\u8981\u4f9d\u8d56\u672c\u5730\u6587\u4ef6\u7cfb\u7edf\u7684\uff0c\u53ea\u4e0d\u8fc7\u5185\u90e8\u7684 NameNode \u4f1a\u5e2e\u52a9\u6211\u4eec\u5bf9\u5757\u8fdb\u884c\u7ba1\u7406\uff0c\u4f46\u672c\u8d28\u4e0a\u5c31\u662f\u6587\u4ef6\u7684\u62c6\u5206\u4e0e\u5408\u5e76\u7684\u8fc7\u7a0b\u3002</p> <p>\u5f53\u7136\uff0c\u60a8\u4e5f\u53ef\u4ee5\u4e3a\u6587\u4ef6\u6216\u76ee\u5f55\u6307\u5b9aumask\u503c\u3002\u9ed8\u8ba4\u7684umask\u503c\u4e3a\"022\"\uff0c\u4f46\u662f\u53ef\u4ee5\u901a\u8fc7\u4ee5\u4e0b\u65b9\u5f0f\u4e3a <code>${HADOOP_HOME}/etc/hadoop/core-site.xml</code>\u6587\u4ef6\u8fdb\u884c\u4fee\u6539\u3002</p> <pre><code>\u3000&lt;property&gt;\n\u3000\u3000\u3000\u3000\u3000\u3000&lt;name&gt;fs.permissions.umask-mode&lt;/name&gt;\n\u3000\u3000\u3000\u3000\u3000\u3000&lt;value&gt;037&lt;/value&gt;\n\u3000\u3000\u3000\u3000\u3000\u3000&lt;description&gt;\u6307\u5b9aHDFS\u96c6\u7fa4\u7684umask\u503c,\u9ed8\u8ba4\u503c\u4e3a022(\u521b\u5efa\u7684\u6587\u4ef6(\u76ee\u5f55)\u6743\u9650\u5373\u4e3a\"755\"),\u5728Linux\u4e2d\uff0cx\u8868\u793a\u6267\u884c\u6587\u4ef6\u6743\u9650\uff0c\u800c\u5728HDFS\u4e2d\u6ca1\u6709\u8fd9\u6837\u7684\u6982\u5ff5,\u5c3d\u7ba1\u4f60\u53ef\u4ee5\u4e3a\u8be5\u6587\u4ef6\u6dfb\u52a0x\u6743\u9650\u3002&lt;/description&gt;\n&lt;/property&gt;\n</code></pre> <p>\u53ef\u4ee5\u901a\u8fc7\u5728<code>hdfs-site.xml</code>\u914d\u7f6e\u6587\u4ef6\u4e2d\u5c06\u53c2\u6570<code>dfs.permissions.enabled</code>\u7684\u503c\u8bbe\u7f6e\u4e3ature\u6765\u914d\u7f6eHDFS\u6743\u9650\u3002</p> <p>\u5982\u4e0b\u6240\u793a\uff0c\u6b64\u53c2\u6570\u7684\u9ed8\u8ba4\u503c\u4e3atrue\uff0c\u56e0\u6b64\u6743\u9650\u68c0\u67e5\u529f\u80fd\u5df2\u7ecf\u6253\u5f00\uff0c\u6545HDFS\u4e0d\u9700\u8981\u518d\u6267\u884c\u5176\u4ed6\u4efb\u4f55\u64cd\u4f5c\u6765\u8fdb\u884c\u6743\u9650\u68c0\u67e5\u3002</p> <pre><code>&lt;property&gt;\n    &lt;name&gt;dfs.permissions.enabled&lt;/name&gt;\n\u3000\u3000 &lt;value&gt;true&lt;/value&gt;\n\u3000\u3000 &lt;description&gt;\u5982\u679c\u4e3a\"true\"\uff0c\u5219\u5728HDFS\u4e2d\u542f\u7528\u6743\u9650\u68c0\u67e5;\u5982\u679c\u4e3a\"false\"\uff0c\u5219\u5173\u95ed\u6743\u9650\u68c0\u67e5;\u9ed8\u8ba4\u503c\u4e3a\"true\"\u3002&lt;/description&gt;\n&lt;/property&gt;\n</code></pre> <pre><code>\u3000\n</code></pre> <p>\u4e0eLinux\u6587\u4ef6\u7cfb\u7edf\u4e0d\u540c\uff0c\u4e3b\u673a\u7528\u6237root\u4e0d\u662fHDFS\u7684\u8d85\u7ea7\u7528\u6237\u3002\u8d85\u7ea7\u7528\u6237\u662f\u542f\u52a8NameNode\u7684\u7528\u6237\uff0c\u901a\u5e38\u662f\u64cd\u4f5c\u7cfb\u7edf\u7528\u6237(\u5982\"root\",\"hdfs\",\"hadoop\"\u7b49)\uff0c\u56e0\u6b64\u7528\u6237(\u5982\"root\",\"hdfs\",\"hadoop\"\u7b49)\u901a\u5e38\u662fHDFS\u7684\u8d85\u7ea7\u7528\u6237\u3002</p> <p>\u53ef\u4ee5\u901a\u8fc7\u5728 <code>${HADOOP_HOME}/etc/hadoop/hdfs-site.xml</code> \u914d\u7f6e\u6587\u4ef6\u4e2d\u8bbe\u7f6e <code>dfs.permissions.superusergroup</code> \u53c2\u6570\u6765\u914d\u7f6e\u8d85\u7ea7\u7528\u6237\u7ec4(\u6539\u53c2\u6570\u4ec5\u80fd\u88ab\u8bbe\u7f6e\u4e00\u6b21)\u3002</p> <p>\u5728HDFS\u7684 <code>Web UI</code>\u8bbf\u9875\u9762\u8fdb\u884c\u6587\u4ef6\u5199\u64cd\u4f5c\u65f6\uff0c\u9047\u5230\u7528\u6237\u6743\u9650\u95ee\u9898\uff0c\u4f46\u662f\u6b64\u65f6\u7528\u6237\u4e3a\uff1a<code>dr.who</code>\u3002\u901a\u8fc7\u4fee\u6539 <code>core-site.xml</code>  \u914d\u7f6e\u6587\u4ef6\uff0c\u66f4\u6539 <code>Web UI</code>\u8bbf\u95ee\u65f6\u7684\u9ed8\u8ba4\u7528\u6237\uff0c\u4ece\u800c\u786e\u5b9a\u5177\u4f53\u7528\u6237\uff1b</p> <p>\u8fd9\u662f\u56e0\u4e3aWEB\u6d4f\u89c8\u5668\u4e2d\u662f\u4ee5\u533f\u540d\u7528\u6237\uff08dr.who\uff09\u767b\u9646\u7684\uff0c\u5176\u53ea\u6709\u53ea\u8bfb\u6743\u9650\uff0c\u591a\u6570\u64cd\u4f5c\u662f\u505a\u4e0d\u4e86\u7684\u3002</p> <p>\u5982\u679c\u9700\u8981\u4ee5\u7279\u6743\u7528\u6237\u5728\u6d4f\u89c8\u5668\u4e2d\u8fdb\u884c\u64cd\u4f5c\uff0c\u9700\u8981\u901a\u8fc7\u4fee\u6539 <code>core-site.xml</code>  \u914d\u7f6e\u6587\u4ef6\uff0c\u66f4\u6539 <code>Web UI</code>\u8bbf\u95ee\u65f6\u7684\u9ed8\u8ba4\u7528\u6237\uff0c\u4ece\u800c\u786e\u5b9a\u5177\u4f53\u7528\u6237\uff1b</p> <pre><code>&lt;!-- \u914d\u7f6e HDFS \u7f51\u9875\u767b\u5f55\u4f7f\u7528\u7684\u9759\u6001\u7528\u6237\u4e3a hdfs --&gt;\n&lt;property&gt;\n    &lt;name&gt;hadoop.http.staticuser.user&lt;/name&gt;\n    &lt;value&gt;hdfs&lt;/value&gt;\n&lt;/property&gt;\n</code></pre> <p>\u6ce8\u610f\uff1a\u4e0d\u63a8\u8350\u8fd9\u6837\u505a\uff0c**<code>Web UI</code>**\u53ea\u8bfb\u6743\u9650\u6bd4\u8f83\u5b89\u5168\u7684\uff0c\u7b80\u5355\u6d4f\u89c8\u5373\u53ef\uff0c\u5982\u679c\u7ed9\u4e0e\u9ad8\u6743\u9650\uff0c\u4f1a\u6709\u5f88\u5927\u7684\u5b89\u5168\u95ee\u9898\uff0c\u9020\u6210\u6570\u636e\u6cc4\u9732\u6216\u4e22\u5931\u3002</p> <p>HDFS\u672c\u8eab\u5728\u6700\u5f00\u59cb\u8fdb\u884c\u8bbe\u8ba1\u65f6\uff0c\u5e76\u6ca1\u6709\u8003\u8651\u9274\u6743\u76f8\u5173\u8bbe\u8ba1\uff0c\u800c\u662f\u4ee5\u6ee1\u8db3\u5927\u6570\u636e\u7684\u4e1a\u52a1\u573a\u666f\u4f5c\u4e3a\u4f18\u5148\u8981\u52a1\uff0c\u56e0\u6b64\u6700\u5f00\u59cb\u65f6\u53ea\u6709\u7b80\u5355\u8ba4\u8bc1\u6a21\u5f0f\u3002\u7b49\u540e\u7eed\u7ecf\u8fc7\u4e00\u5b9a\u7a0b\u5ea6\u7684\u53d1\u5c55\uff0c\u53d1\u73b0\u9274\u6743\u8d8a\u6765\u8d8a\u6210\u4e3a\u4e1a\u52a1\u7684\u9700\u8981\uff0c\u56e0\u6b64\u624d\u5c06\u9274\u6743\u4f5c\u4e3a\u4e00\u4e2a\u529f\u80fd\u8fdb\u884c\u8bbe\u8ba1\u3002</p> <p>\u5728\u8bbe\u8ba1\u4e0a\u4e5f\u662f\u5145\u5206\u5229\u7528\u73b0\u6709\u7684\u6846\u67b6\u6216\u8005\u5916\u90e8\u7684\u8ba4\u8bc1\u7cfb\u7edf\uff0cHDFS\u5bf9\u63a5\u76f8\u5173\u7684\u8ba4\u8bc1\u7cfb\u7edf\u63a5\u53e3\uff0c\u4ece\u800c\u5b8c\u6210\u9ad8\u6548\uff08\u5077\u61d2\uff09\u7684\u5b9e\u73b0\u9274\u6743\u529f\u80fd\u3002</p> <p>\u76ee\u524dHDFS\u6709\u652f\u6301\u4e24\u79cd\u7528\u6237\u8eab\u4efd\u8ba4\u8bc1\uff1a\u7b80\u5355\u8ba4\u8bc1**\u548c**kerberos\u8ba4\u8bc1\u3002</p> <ul> <li>\u7b80\u5355\u8ba4\u8bc1: \u57fa\u4e8e\u5ba2\u6237\u7aef\u8fdb\u7a0b\u6240\u5728\u7684Linux/Unix\u7cfb\u7edf\u7684\u5f53\u524d\u7528\u6237\u540d\u6765\u8fdb\u884c\u8ba4\u8bc1\u3002\u53ea\u8981\u7528\u6237\u80fd\u6b63\u5e38\u767b\u5f55\u64cd\u4f5c\u7cfb\u7edf\u5c31\u8ba4\u8bc1\u6210\u529f\u3002\u8fd9\u6837\u5ba2\u6237\u7aef\u4e0eNameNode\u4ea4\u4e92\u65f6\uff0c\u4f1a\u5c06\u7528\u6237\u7684\u767b\u5f55\u8d26\u53f7\uff08\u4e0ewhoami\u547d\u4ee4\u8f93\u51fa\u4e00\u81f4\uff09\u4f5c\u4e3a\u5408\u6cd5\u7528\u6237\u540d\u4f20\u7ed9Namenode\u3002 </li> </ul> <p>\u8fd9\u6837\u7684\u8ba4\u8bc1\u673a\u5236\u5b58\u5728\u6076\u610f\u7528\u6237\u53ef\u4ee5\u4f2a\u9020\u5176\u4ed6\u4eba\u7684\u7528\u6237\u540d\u7684\u98ce\u9669\uff0c\u5bf9\u6570\u636e\u5b89\u5168\u9020\u6210\u6781\u5927\u7684\u9690\u60a3\uff0c\u7ebf\u4e0a\u751f\u4ea7\u73af\u5883\u4e00\u822c\u4e0d\u4f1a\u4f7f\u7528\u3002</p> <p>\u7b80\u5355\u8ba4\u8bc1\u6a21\u5f0f\u4e0b\uff0c\u91c7\u96c6\u7684\u9274\u6743\u6a21\u5f0f\u8ddflinux\u7cfb\u7edf\u4e00\u81f4\uff0c\u4f7f\u7528UGO\uff08user\u3001group\u3001other\uff09\u6a21\u5f0f\uff0c\u76f8\u5173\u7684acl\u8ddflinux\u7cfb\u7edf\u7c7b\u4f3c\uff0c\u672c\u6587\u4e0d\u5728\u8ffd\u8ff0\u3002</p> <ul> <li>kerberos\u8ba4\u8bc1: kerberos\u662f\u4e00\u4e2a\u7f51\u7edc\u8ba4\u8bc1\u534f\u8bae\uff0c\u5176\u4f7f\u7528\u5bc6\u94a5\u52a0\u5bc6\u6280\u672f\u4e3a\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u7aef\u5e94\u7528\u63d0\u4f9b\u5f3a\u8ba4\u8bc1\u529f\u80fd\u3002\u5b83\u6709\u4e00\u4e2a\u7ba1\u7406\u7aef\uff08AdminServer\uff09\u7528\u4e8e\u7ba1\u7406\u6240\u6709\u9700\u8981\u8ba4\u8bc1\u7684\u8d26\u53f7\u4fe1\u606f\uff0c\u53e6\u5916\u8fd8\u6709\u82e5\u5e72\u7684\u5bc6\u94a5\u5206\u53d1\u670d\u52a1\u5668\uff08KDC\uff09\u7528\u4e8e\u63d0\u4f9b\u8ba4\u8bc1\u548c\u5206\u53d1\u5bc6\u94a5\u670d\u52a1\u3002 </li> </ul> <p>\u7528\u6237\u4ece Kerberos \u7ba1\u7406\u5458\u5904\u83b7\u53d6\u5bf9\u5e94\u7684 Kerberos \u8d26\u53f7\u540d\u6216\u8005\u5bc6\u94a5\u6587\u4ef6\uff0c\u7136\u540e\u901a\u8fc7 kinit \u7b49\u65b9\u5f0f\u8ba4\u8bc1Kerberos\uff0c\u62ff\u5230TGT\uff08ticket-granting-ticket\uff09\u7968\u636e\u3002</p> <p>\u5ba2\u6237\u7aef\u4f1a\u5c06TGT\u4fe1\u606f\u4f20\u8f93\u5230NN\u7aef\uff0cNN\u5728\u83b7\u53d6\u5230\u8ba4\u8bc1\u4fe1\u606f\u540e\uff0c\u5c06principle\u9996\u90e8\u622a\u53d6\u51fa\u6765\u4f5c\u4e3a\u5ba2\u6237\u7aef\u7684\u7528\u6237\u540d\u3002\u4f8b\u5982\u4f7f\u7528 todd/foobar@CORP.COMPANY.COM\u8ba4\u8bc1\u6210\u529f\u540e\uff0c da\u4f5c\u4e3aprinciple\u7684\u9996\u90e8\u4f1a\u4f5c\u4e3a\u8be5\u5ba2\u6237\u7aef\u7684\u7528\u6237\u540d\u4f7f\u7528\u3002 </p> <p>\u4f7f\u7528Kerberos\u53ef\u4ee5\u6781\u5927\u589e\u5f3aHDFS\u7684\u5b89\u5168\u6027\uff0c\u7279\u522b\u662f\u5728\u591a\u79df\u6237\u7684\u751f\u4ea7\u73af\u5883\u4e0b\u3002</p> <p>\u53ef\u4ee5\u901a\u8fc7core-site.xml\u914d\u7f6e\u6587\u4ef6\u8fdb\u884c\u914d\u7f6e\u548c\u8c03\u6574\uff0c\u5982\u679c\u4e0d\u914d\u7f6e\uff0c\u9ed8\u8ba4\u4f7f\u7528**\u7b80\u5355\u8ba4\u8bc1**\u65b9\u5f0f</p> <pre><code>\n</code></pre> <p>https://blog.csdn.net/weixin_43845924/article/details/135566680</p> <p>https://www.cnblogs.com/auguse/articles/11751418.html</p> <p>Hadoop\u4e2d\u7528\u6237\u4ee3\u7406\uff08Proxy User\uff09\u6307\u7684\u662f\u4e00\u4e2a\u7528\u6237\uff08A\uff09\u4ee5\u53e6\u4e00\u4e2a\u7528\u6237\uff08B\uff09\u7684\u540d\u4e49\u6765\u8bbf\u95eeHadoop\u96c6\u7fa4\uff0c\u5b83\u5141\u8bb8\u8d85\u7ea7\u7528\u6237\u6a21\u62df\u4e00\u4e2a\u666e\u901a\u7528\u6237\u6765\u6267\u884c\u4efb\u52a1\u3002</p> <p>Hadoop 2.0\u7248\u672c\u5f00\u59cb\u652f\u6301ProxyUser\u673a\u5236\uff0c\u8fd9\u610f\u5473\u7740\u7528\u6237A\u53ef\u4ee5\u5229\u7528\u81ea\u5df1\u7684\u8ba4\u8bc1\u4fe1\u606f\uff0c\u4ee5\u7528\u6237B\u7684\u8eab\u4efd\u8bbf\u95eeHadoop\u96c6\u7fa4\u3002</p> <p>Hadoop\u7528\u6237\u4ee3\u7406\u529f\u80fd\u7684\u4f5c\u7528\u662f\u8ba9\u8d85\u7ea7\u7528\u6237superuser\u6a21\u62df\u4e00\u4e2a\u666e\u901a\u7528\u6237\u6765\u6267\u884c\u4efb\u52a1\u3002\u6bd4\u5982\u7528\u6237joe\u901a\u8fc7oozie\u63d0\u4ea4\u4e00\u4e2a\u4efb\u52a1\u5230\u96c6\u7fa4\u4e0a\uff0c\u5982\u679c\u4e0d\u8bbe\u7f6e\u7528\u6237\u4ee3\u7406\uff0c\u90a3\u4e48\u5c31\u4f1a\u4ee5\u542f\u52a8oozie(oozie)\u8fdb\u7a0b\u7684\u7528\u6237\u6765\u63d0\u4ea4\u4efb\u52a1,\u8fd9\u6837\u4efb\u52a1\u5c31\u663e\u793a\u4e3aoozie\uff0c\u65e0\u6cd5\u5224\u65ad\u662f\u54ea\u4e2a\u7528\u6237\u63d0\u4ea4\u4e86\u4efb\u52a1\u3002\u5f53\u5f00\u59cbproxy\u529f\u80fd\u540e\uff0c\u4f1a\u4ee5superuser\u6a21\u62dfjoe\u6765\u63d0\u4ea4\u4efb\u52a1\uff0c\u4efb\u52a1\u7684\u63d0\u4ea4\u8005\u662fsupersuer\uff0c\u4f46\u663e\u793a\u4e3ajoe.</p>"},{"location":"BigData/HDFS/1.HDFS%E5%AE%9E%E6%88%98/#hdfs_2","title":"HDFS\u6570\u636e\u8bfb\u5199","text":"<p>HDFS\u5ba2\u6237\u7aef\u5bf9HDFS\u6570\u636e\u7684\u8bbf\u95ee\u65b9\u5f0f</p> <ul> <li> <p><code>HDFS WEB UI</code> \u901a\u8fc7http://master:50070/\u53bb\u8bbf\u95eeHDFS WEB UI\u7684\u65f6\u5019\uff0c\u6211\u4eec\u4f1a\u7ecf\u5e38\u4f7f\u7528**Utilities**\u4e0b\u7684<code>Browse the file system</code>\u53bb\u67e5\u770bHDFS\u4e2d\u7684\u6587\u4ef6\u3002</p> </li> <li> <p>HDFS\u63d0\u4f9b\u4e86\u548cLinux\u7c7b\u4f3c\u7684\u547d\u4ee4\u6765\u8bbf\u95ee\u6587\u4ef6\u7cfb\u7edf\uff0c\u6bd4\u5982\u5728Linux\u4e2d\u60f3\u770b\u4e0b\u6587\u4ef6\u76ee\u5f55/home/hadoop-twq/test\u4e2d\u6709\u54ea\u4e9b\u6587\u4ef6\u3002</p> </li> </ul> <p>HDFS Shell CLI\u652f\u6301\u64cd\u4f5c\u591a\u79cd\u6587\u4ef6\u7cfb\u7edf\uff0c\u5305\u62ec\u672c\u5730\u6587\u4ef6\u7cfb\u7edf\uff08file:///\uff09\u3001\u5206\u5e03\u5f0f\u6587\u4ef6\u7cfb\u7edf\uff08hdfs://nn:8020\uff09\u7b49</p> <p>\u64cd\u4f5c\u7684\u662f\u4ec0\u4e48\u6587\u4ef6\u7cfb\u7edf\u53d6\u51b3\u4e8eURL\u4e2d\u7684\u524d\u7f00\u534f\u8bae\u3002\u5982\u679c\u6ca1\u6709\u6307\u5b9a\u524d\u7f00\uff0c\u5219\u5c06\u4f1a\u8bfb\u53d6\u73af\u5883\u53d8\u91cf\u4e2d\u7684fs.defaultFS\u5c5e\u6027\uff0c\u4ee5\u8be5\u5c5e\u6027\u503c\u4f5c\u4e3a\u9ed8\u8ba4\u6587\u4ef6\u7cfb\u7edf\u3002</p> <p>\u6bd4\u5982\uff0c\u5728HDFS\u96c6\u7fa4\u5916\u90e8\u5f04\u4e2aHDFS\u5305\uff0c\u6267\u884c <code>HDFS Shell CLI</code>\u547d\u4ee4\u8bbf\u95eeHDFS\u96c6\u7fa4\u7684\u95ee\u9898\u3002\u6b64\u65f6\u5c31\u76f8\u5f53\u4e8e <code>mysql -h</code>\u8fd9\u6837\u505a\u4e3a\u5ba2\u6237\u7aef\u6765\u8bbf\u95ee\u3002</p> <ul> <li></li> <li></li> </ul> <p>WebHDFS\u662fHortonWorks\u5f00\u53d1\u7684\uff0c\u7136\u540e\u6350\u7ed9\u4e86Apache\uff0c\u53ef\u89c1\u535a\u5ba2\uff1aWebHDFS \u2013 HTTP REST Access to HDFS\u3002</p> <p>HttpFS\u662fClouera\u5f00\u53d1\u7684\uff0c\u4e5f\u6350\u7ed9\u4e86Apache\uff0c\u53ef\u89c1\u535a\u5ba2\uff1aHttpFS for CDH3 \u2013 The Apache Hadoop FileSystem over HTTP\u3002</p> <p>\u5b83\u4eec\u7684\u7ec8\u6781\u76ee\u6807\u5b8c\u5168\u4e00\u81f4\uff1a\u5c31\u662f\u8ba9\u8eab\u5904HDFS\u96c6\u7fa4\u4e4b\u5916\u7684\u5e94\u7528\u7a0b\u5e8f\uff0c\u4e0d\u4f46\u4e0d\u7528\u5b89\u88c5Hadoop\u548cJava\u5e93\uff0c\u5e76\u4e14\u53ef\u4ee5\u901a\u8fc7\u6d41\u884c\u7684REST\u98ce\u683c\u7684\u63a5\u53e3\u53bb\u8bbf\u95eeHDFS\u96c6\u7fa4\uff0c\u8fd8\u6709HttpFS\u4e0eWebHDFS\u7684HTTP REST API\u5b8c\u5168\u517c\u5bb9\u3002\u8fd9\u6837\u4e00\u6765\uff0c\u4e0d\u7ba1\u662f\u4f7f\u7528C++\u3001Python\u6216\u5176\u5b83\u8bed\u8a00\u7684\u5916\u90e8\u7a0b\u5e8f\uff0c\u90fd\u53ef\u4ee5\u4ee5\u4e00\u79cd\u7edf\u4e00\u7684\u65b9\u5f0f\u8bbf\u95eeHDFS\u3002</p> <ul> <li>WebHDFS\u662fHDFS\u5185\u7f6e\u7684\u7ec4\u4ef6\uff0c\u5df2\u7ecf\u8fd0\u884c\u4e8eNameNode\u548cDataNode\u4e2d\u3002</li> </ul> <p>\u5ba2\u6237\u7aef\u901a\u8fc7NameNode\u7684HTTP API\u53d1\u8d77\u6587\u4ef6\u8bfb\u5199\u8bf7\u6c42\uff0cURL\u5c06\u4f1a\u88ab\u91cd\u5b9a\u5411\u5230\u6587\u4ef6\u88ab\u5206\u914d\u5230\u6240\u5728\u7684DataNode \u7684HTTP API\uff0c\u5e76\u4e14\u4f1a\u5b8c\u5168\u5229\u7528HDFS\u7684\u5e26\u5bbd\u3002</p> <ul> <li>HttpFS\u662f\u5728Apache Tomcat\u4e0a\u8fd0\u884c\u7684Java\u5e94\u7528\u7a0b\u5e8f\uff0c\u5176\u5141\u8bb8\u901a\u8fc7WebHDFS REST API\u8fdc\u7a0b\u8bbf\u95eeHDFS\u6587\u4ef6\u7cfb\u7edf\u3002\u3000</li> </ul> <p>WebHDFS\u548cHttpFS\u90fd\u662fHadoop\u7684HTTP/HTTPS REST\u63a5\u53e3\u3002\u8fd9\u4e24\u4e2a\u63a5\u53e3\u4f7f\u6211\u4eec\u80fd\u591f\u8bfb\u53d6HDFS\u6570\u636e\u5e76\u5199\u5165\uff0c\u4ee5\u53ca\u6267\u884c\u4e0eHDFS\u76f8\u5173\u7684\u51e0\u4e2a\u7ba1\u7406\u547d\u4ee4\u3002</p> <p>\u4ece\u96c6\u7fa4\u5916\u90e8\u8bbf\u95eeHDFS\uff0c\u5916\u90e8\u7cfb\u7edf\u4f7f\u7528\u4e00\u822c\u63a8\u8350HttpFS\uff0c\u4e0d\u8fc7\u53d6\u51b3\u4e8e\u5b9e\u9645\u7684\u5e94\u7528\u73af\u5883\u60c5\u51b5\u3002</p> <pre><code>WebHDFS vs HttpFs Major difference between WebHDFS and HttpFs: WebHDFS needs access to all nodes of the cluster and when some data is read it is transmitted from that node directly, whereas in HttpFs, a singe node will act similar to a \u201cgateway\u201d and will be a single point of data transfer to the client node. So, HttpFs could be choked during a large file transfer but the good thing is that we are minimizing the footprint required to access HDFS.\n</code></pre>"},{"location":"BigData/HDFS/1.HDFS%E5%AE%9E%E6%88%98/#webhdfs","title":"WebHDFS","text":"<p>\u4f7f\u7528WebHDFS\u5f88\u7b80\u5355\uff0c\u9700\u8981\u505a\u7684\u5c31\u662f\u5c06HDFS\u6587\u4ef6\u7cfb\u7edfURI\u66ff\u6362\u4e3a<code>NameNode WEBUI HTTP URL</code></p> <p>\u4f7f\u7528\u5185\u7f6e\u7684<code>WebHDFS REST API</code>\u64cd\u4f5c\u8bbf\u95ee\u3002\u4e00\u53e5\u8bdd\uff0c\u5176\u5b9e\u5c31\u662f<code>NameNode</code>\u66b4\u9732 <code>HTTP WEBUI API</code>\u7aef\u53e3\uff0c\u6765\u5bf9\u5ba2\u6237\u7aef\u63d0\u4f9b\u8bfb\u5199API</p> <ul> <li>HDFS\u5185\u7f6e\u3001\u9ed8\u8ba4\u5f00\u542f</li> <li>\u57fa\u4e8eREST\u7684HDFS API</li> <li>\u91cd\u5b9a\u5411\u5230\u8d44\u6e90\u6240\u5728\u7684datanode</li> <li>\u5ba2\u6237\u7aef\u4f1a\u548cnn\u3001dn\u4ea4\u4e92</li> <li>\u4f7f\u7528\u5185\u7f6e\u7684<code>WebHDFS REST API</code>\u64cd\u4f5c\u8bbf\u95eehttp://:master:9870/webhdfs/v1/?op=LISTSTATUS \u3002\u7aef\u53e3\u7531dfs.namenode.http-address\u6307\u5b9a\u3002\u9ed8\u8ba4\u503c9870</li> </ul> <pre><code># \u4f7f\u7528HDFS Shell CLI\u5c06\u6587\u4ef6\u79fb\u52a8\u5230HDFS\u6839\u76ee\u5f55\u4e2d\nroot@qhdata-dev:/data/hadoop-3.4.1/bin#./hdfs dfs -moveFromLocal ~/demo.txt /demo.txt\n\n# WebHDFS\u4f7f\u7528\u57fa\u672c\u7684HTTP\u64cd\u4f5c\uff0c\u5982GET,PUT,POST\u548cDELETE\u6765\u8fdc\u7a0b\u64cd\u4f5cHDFS\u6587\u4ef6\u7cfb\u7edf\u3002\n\n# \u4f7f\u7528WebHDFS API\u6765\u8bbf\u95ee\u6587\u4ef6\uff0cURL\u5176\u5b9e\u5c31\u662fNameNode\u7684WEBUI\uff0c\u53ef\u4ee5\u53d1\u73b0\u5176\u5b9e\u662f\u8bf7\u6c42\u4f1a\u88ab\u91cd\u5b9a\u5411\u5230Datanode\u4e3b\u673a\u540d\u6620\u5c04\u7684HTTP\u7aef\u53e3\u3002\nroot@qhdata-dev:/data/hadoop-3.4.1/bin#\nroot@qhdata-dev:/data/hadoop-3.4.1/bin# curl -i -L http://10.10.20.243:9870/webhdfs/v1/demo.txt?op=OPEN\nHTTP/1.1 307 Temporary Redirect\nDate: Fri, 30 May 2025 07:32:54 GMT\nCache-Control: no-cache\nExpires: Fri, 30 May 2025 07:32:54 GMT\nDate: Fri, 30 May 2025 07:32:54 GMT\nPragma: no-cache\nX-Content-Type-Options: nosniff\nX-FRAME-OPTIONS: SAMEORIGIN\nX-XSS-Protection: 1; mode=block\nLocation: http://qhdata-dev:9864/webhdfs/v1/demo.txt?op=OPEN&amp;namenoderpcaddress=localhost:9000&amp;offset=0\nContent-Type: application/octet-stream\nContent-Length: 0\n\nHTTP/1.1 200 OK\naccess-control-allow-methods: GET\naccess-control-allow-origin: *\ncontent-type: application/octet-stream\nconnection: close\ncontent-length: 5\n\ndemo\nroot@qhdata-dev:/data/hadoop-3.4.1/bin#\nroot@qhdata-dev:/data/hadoop-3.4.1/bin#\n\n# \u5bf9\u4e8e\u96c6\u7fa4\u5916\u90e8\u7684\u673a\u5668\uff0c\u65e0\u6cd5\u611f\u77e5\u54ea\u4e2a\u662fDatanode\uff0c\u663e\u7136\u8fd9\u6837\u65e0\u6cd5\u5f7b\u5e95\u505a\u5230\u900f\u660e\u3002\n</code></pre>"},{"location":"BigData/HDFS/1.HDFS%E5%AE%9E%E6%88%98/#httpfs","title":"HttpFS","text":"<p>HttpFS ,\u5b83\u672c\u8d28\u4e0a\u662f\u4e00\u4e2a\u4ee3\u7406\uff0c\u662f java jetty web \u7a0b\u5e8f\uff0c\u76f4\u63a5\u8fd0\u884c\u5728\u53ef\u4ee5\u5728 Hadoop \u96c6\u7fa4\u4e0a\uff0c\u53ef\u4ee5\u611f\u77e5 NameNode HA \u7684\u914d\u7f6e.</p> <ul> <li> <p>\u672c\u8d28\u4e0a\u662f\u5bf9 WebHDFS \u8fdb\u884c\u4e86\u4e00\u6b21\u5c01\u88c5\uff0c\u4f46\u4f7f\u7528\u5b83\u7684\u65f6\u5019\u4e0d\u7528\u62c5\u5fc3\u5ba2\u6237\u7aef\u672c\u5730\u662f\u5426\u914d\u7f6e\u597d\u6240\u6709\u7684 DataNode IP \u4e3b\u673a\u540d\u6620\u5c04\u3002</p> </li> <li> <p>\u56e0\u4e3a\u662f\u53ef\u4ee5\u72ec\u7acb\u90e8\u7f72\u7684\uff0c\u6240\u4ee5\u53ef\u4ee5\u5bf9HttpHDFS\u8bbe\u7f6e\u9632\u706b\u5899\uff0c\u800c\u907f\u514dNameNode\u66b4\u9732\u5728\u5899\u5916\uff0c\u5bf9\u4e00\u4e9b\u5b89\u5168\u6027\u8981\u6c42\u6bd4\u8f83\u9ad8\u7684\u7cfb\u7edf\uff0cHttpHDFS\u4f1a\u66f4\u597d\u4e9b\u3002</p> </li> <li> <p>HttpFS\u53ef\u7528\u4e8e\u5728\u8fd0\u884c\u4e0d\u540c\u7248\u672cHadoop(\u514b\u670dRPC\u7248\u672c\u63a7\u5236\u95ee\u9898)\u7684\u96c6\u7fa4\u4e4b\u95f4\u4f20\u8f93\u6570\u636e\uff0c\u4f8b\u5982\u4f7f\u7528HadoopDiscreCP\u3002</p> </li> <li> <p>HttpFS\u53ef\u7528\u4e8e\u5728\u9632\u706b\u5899\u540e\u9762\u7684\u96c6\u7fa4\u4e0a\u8bbf\u95eeHDFS\u4e2d\u7684\u6570\u636e(HttpFS\u670d\u52a1\u5668\u5145\u5f53\u7f51\u5173\uff0c\u662f\u5141\u8bb8\u8de8\u8d8a\u9632\u706b\u5899\u8fdb\u5165\u96c6\u7fa4\u7684\u552f\u4e00\u7cfb\u7edf)</p> </li> <li> <p>HttpFS \u662f\u4e00\u4e2a\u63d0\u4f9bRESTful \u63a5\u53e3\u7684\u7f51\u5173\u7684\u670d\u52a1\u5668\uff0c\u8be5\u7f51\u5173\u652f\u6301\u6240\u6709HDFS\u6587\u4ef6\u7cfb\u7edf\u64cd\u4f5c</p> </li> <li>\u5bf9\u4e8e\u6587\u4ef6CURD\u7684\u64cd\u4f5c\u5168\u90e8\u63d0\u4ea4\u7ed9HttpFS\u670d\u52a1\u8fdb\u884c\u4e2d\u8f6c\uff0c\u7136\u540e\u7531HttpFS\u53bb\u8ddfHDFS\u96c6\u7fa4\u4ea4\u4e92</li> <li>HttpFS\u662f\u4e00\u4e2a\u72ec\u7acb\u4e8eHDFS\u7684\u670d\u52a1\uff0c\u82e5\u4f7f\u7528\u9700\u8981\u624b\u52a8\u5b89\u88c5\u3002\u672c\u8d28\u4e0a\u662f\u4e00\u4e2a\u4ee3\u7406\u670d\u52a1</li> <li>HttpFS\u672c\u8eab\u662fJava Web\u5e94\u7528\u7a0b\u5e8f\u3002\u4f7f\u7528\u5185\u7f6e\u7684Jetty\u670d\u52a1\u5668\u5bf9\u5916\u63d0\u4f9b\u670d\u52a1</li> <li>HttpFS\u9ed8\u8ba4\u7aef\u53e3\u53f7\u4e3a14000</li> </ul> <pre><code>curl -i -L  http://10.10.20.243:14000/webhdfs/v1/demo.txt?user.name=root&amp;op=OPEN\n</code></pre>"},{"location":"BigData/HDFS/1.HDFS%E5%AE%9E%E6%88%98/#hdfs-shell","title":"HDFS shell","text":"<ul> <li>hadoop\uff1a</li> <li>hdfs</li> <li>yarn</li> </ul> <p>hdfs\u6709\u4e09\u7c7b\u5b50\u547d\u4ee4\uff1a</p> <ul> <li>\u7ba1\u7406\u547d\u4ee4</li> <li>\u5ba2\u6237\u7aef\u547d\u4ee4</li> <li>\u540e\u53f0\u547d\u4ee4</li> </ul> <pre><code>Admin Commands:\n\ncacheadmin           configure the HDFS cache\ncrypto               configure HDFS encryption zones\ndebug                run a Debug Admin to execute HDFS debug commands\ndfsadmin             run a DFS admin client\ndfsrouteradmin       manage Router-based federation\nec                   run a HDFS ErasureCoding CLI\nfsck                 run a DFS filesystem checking utility\nfsImageValidation    run FsImageValidation to check an fsimage\nhaadmin              run a DFS HA admin client\njmxget               get JMX exported values from NameNode or DataNode.\noev                  apply the offline edits viewer to an edits file\noiv                  apply the offline fsimage viewer to an fsimage\noiv_legacy           apply the offline fsimage viewer to a legacy fsimage\nstoragepolicies      list/get/set/satisfyStoragePolicy block storage policies\n\n    Client Commands:\n\nclasspath            prints the class path needed to get the hadoop jar and the required libraries\ndfs                  run a filesystem command on the file system\nenvvars              display computed Hadoop environment variables\nfetchdt              fetch a delegation token from the NameNode\ngetconf              get config values from configuration\ngroups               get the groups which users belong to\nlsSnapshot           list all snapshots for a snapshottable directory\nlsSnapshottableDir   list all snapshottable dirs owned by the current user\nsnapshotDiff         diff two snapshots of a directory or diff the current directory contents with a snapshot\nversion              print the version\n\n    Daemon Commands:\n\nbalancer             run a cluster balancing utility\ndatanode             run a DFS datanode\ndfsrouter            run the DFS router\ndiskbalancer         Distributes data evenly among disks on a given node\njournalnode          run the DFS journalnode\nmover                run a utility to move block replicas across storage types\nnamenode             run the DFS namenode\nnfs3                 run an NFS version 3 gateway\nportmap              run a portmap service\nsecondarynamenode    run the DFS secondary namenode\nsps                  run external storagepolicysatisfier\nzkfc                 run the ZK Failover Controller daemon\n\nSUBCOMMAND may print help when invoked w/o parameters or with -h.\nroot@qhdata-dev:/data/hadoop-3.4.1/bin#\n</code></pre>"},{"location":"BigData/HDFS/1.HDFS%E5%AE%9E%E6%88%98/#hdfs_3","title":"HDFS\u7684\u6570\u636e\u526f\u672c\u5b58\u653e\u78c1\u76d8\u9009\u62e9\u7b56\u7565","text":"<p>\u5728 HDFS \u4e2d\uff0cDataNode \u5c06\u6570\u636e\u5757\u5b58\u50a8\u5230\u672c\u5730\u6587\u4ef6\u7cfb\u7edf\u76ee\u5f55\u4e2d\uff0c\u5177\u4f53\u7684\u76ee\u5f55\u53ef\u4ee5\u901a\u8fc7\u914d\u7f6e <code>hdfs-site.xml</code> \u91cc\u9762\u7684 dfs.datanode.data.dir \u53c2\u6570\u3002</p> <p>\u5728\u5178\u578b\u7684\u5b89\u88c5\u914d\u7f6e\u4e2d\uff0c\u4e00\u822c\u90fd\u4f1a\u914d\u7f6e\u591a\u4e2a\u76ee\u5f55\uff0c\u5e76\u4e14\u628a\u8fd9\u4e9b\u76ee\u5f55\u5206\u522b\u914d\u7f6e\u5230\u4e0d\u540c\u7684\u8bbe\u5907\u4e0a\uff0c\u6bd4\u5982\u5206\u522b\u914d\u7f6e\u5230\u4e0d\u540c\u7684HDD\uff08HDD\u7684\u5168\u79f0\u662fHard Disk Drive\uff09\u548cSSD\uff08\u5168\u79f0Solid State Drives\uff09\u4e0a\u3002</p> <pre><code>&lt;property&gt;\n    &lt;!-- \u8bbe\u7f6e\u6570\u636e\u5b58\u50a8\u7b56\u7565\uff0c\u9ed8\u8ba4\u4e3a\u8f6e\u8be2\uff0c\u73b0\u5728\u7684\u60c5\u51b5\u663e\u7136\u5e94\u8be5\u7528\u201c\u9009\u62e9\u7a7a\u95f4\u591a\u7684\u78c1\u76d8\u5b58\u201d\u6a21\u5f0f --&gt;\n     &lt;name&gt;dfs.datanode.data.dir&lt;/name&gt;\n     &lt;value&gt;file:///dfs/data1,file:///dfs/data2,[SSD]file:///dfs/data3,[SSD]file:///dfs/data4&lt;/value&gt;\n&lt;/property&gt;\n\n\n&lt;property&gt;\n    &lt;!-- \u9ed8\u8ba4\u503c0.75\u3002\u5b83\u7684\u542b\u4e49\u662f\u6570\u636e\u5757\u5b58\u50a8\u5230\u53ef\u7528\u7a7a\u95f4\u591a\u7684\u5377\u4e0a\u7684\u6982\u7387\uff0c\u7531\u6b64\u53ef\u89c1\uff0c\u8fd9\u4e2a\u503c\u5982\u679c\u53d60.5\u4ee5\u4e0b\uff0c\u5bf9\u8be5\u7b56\u7565\u800c\u8a00\u662f\u6beb\u65e0\u610f\u4e49\u7684\uff0c\u4e00\u822c\u5c31\u91c7\u7528\u9ed8\u8ba4\u503c\u3002--&gt;\n    &lt;name&gt;dfs.datanode.available-space-volume-choosing-policy.balanced-space-preference-fraction&lt;/name&gt;\n    &lt;value&gt;0.75f&lt;/value&gt;\n&lt;/property&gt;\n</code></pre> <p>\u5f53\u6211\u4eec\u5f80 HDFS \u4e0a\u5199\u5165\u65b0\u7684\u6570\u636e\u5757\uff0cDataNode \u5c06\u4f1a\u4f7f\u7528 volume \u9009\u62e9\u7b56\u7565\u6765\u4e3a\u8fd9\u4e2a\u5757\u9009\u62e9\u5b58\u50a8\u7684\u5730\u65b9\u3002\u901a\u8fc7\u53c2\u6570 <code>fs.datanode.fsdataset.volume.choosing.policy</code> \u6765\u8bbe\u7f6e\uff0c\u8fd9\u4e2a\u53c2\u6570\u76ee\u524d\u652f\u6301\u4e24\u79cd\u78c1\u76d8\u9009\u62e9\u7b56\u7565</p> <ul> <li>org.apache.hadoop.hdfs.server.datanode.fsdataset.RoundRobinVolumeChoosingPolicy</li> <li>org.apache.hadoop.hdfs.server.datanode.fsdataset.AvailableSpaceVolumeChoosingPolicy</li> </ul> <p>\u8fd9\u4e24\u79cd\u65b9\u5f0f\u7684\u4f18\u7f3a\u70b9\uff1a\u91c7\u7528RoundRobin\u8f6e\u8be2\u5377\u5b58\u50a8\u65b9\u5f0f\u867d\u7136\u80fd\u4fdd\u8bc1\u6bcf\u5757\u76d8\u90fd\u80fd\u5f97\u5230\u4f7f\u7528\uff0c\u4f46\u662f\u5728\u957f\u671f\u8fd0\u884c\u7684\u96c6\u7fa4\u4e2d\u7531\u4e8e\u6570\u636e\u5220\u9664\u548c\u78c1\u76d8\u70ed\u63d2\u62d4\u7b49\u539f\u56e0\uff0c\u53ef\u80fd\u9020\u6210\u78c1\u76d8\u7a7a\u95f4\u7684\u4e0d\u5747\u3002</p> <p>\u6240\u4ee5\u6700\u597d\u5c06\u78c1\u76d8\u9009\u62e9\u7b56\u7565\u914d\u7f6e\u6210\u7b2c\u4e8c\u79cdAvailableSpace\uff0c\u6839\u636e\u78c1\u76d8\u7a7a\u95f4\u5269\u4f59\u91cf\u6765\u9009\u62e9\u78c1\u76d8\u5b58\u50a8\u6570\u636e\u5757\uff0c\u8fd9\u6837\u80fd\u4fdd\u8bc1\u8282\u70b9\u78c1\u76d8\u6570\u636e\u91cf\u5e73\u8861IO\u538b\u529b\u88ab\u5206\u6563\u3002</p> <pre><code>&lt;property&gt;\n    &lt;name&gt;dfs.datanode.fsdataset.volume.choosing.policy&lt;/name&gt;         \n    &lt;value&gt;org.apache.hadoop.hdfs.server.datanode.fsdataset.AvailableSpaceVolumeChoosingPolicy&lt;/value&gt;\n&lt;/property&gt;\n\n&lt;property&gt;\n    &lt;!--\u914d\u7f6e\u5404\u4e2a\u78c1\u76d8\u7684\u5747\u8861\u9608\u503c\u7684\uff0c\u9ed8\u8ba4\u4e3a10G\uff0c\u5728\u6b64\u8282\u70b9\u7684\u6240\u6709\u6570\u636e\u5b58\u50a8\u7684\u76ee\u5f55\u4e2d\uff0c\u627e\u4e00\u4e2a\u5360\u7528\u6700\u5927\u7684\uff0c\u627e\u4e00\u4e2a\u5360\u7528\u6700\u5c0f\u7684\uff0c\u5982\u679c\u5728\u4e24\u8005\u4e4b\u5dee\u572810G\u7684\u8303\u56f4\u5185\uff0c\u90a3\u4e48\u5757\u5206\u914d\u7684\u65b9\u5f0f\u662f\u8f6e\u8be2\u3002--&gt;\n    &lt;name&gt;dfs.datanode.available-space-volume-choosing-policy.balanced-space-threshold &lt;/name&gt;         \n    &lt;value&gt;10737418240&lt;/value&gt;\n&lt;/property&gt;\n</code></pre> <p>https://www.cnblogs.com/liugp/p/16609303.html</p>"},{"location":"BigData/HDFS/1.HDFS%E5%AE%9E%E6%88%98/#hdfs-ha","title":"HDFS HA","text":"<p>\u5728 HDFS 1.X \u65f6\uff0cNameNode \u662f HDFS \u96c6\u7fa4\u4e2d\u53ef\u80fd\u53d1\u751f\u5355\u70b9\u6545\u969c\u7684\u8282\u70b9\uff0c\u96c6\u7fa4\u4e2d\u53ea\u6709\u4e00\u4e2a NameNode\uff0c\u4e00\u65e6 NameNode \u5b95\u673a\uff0c\u6574\u4e2a\u96c6\u7fa4\u5c06\u5904\u4e8e\u4e0d\u53ef\u7528\u7684\u72b6\u6001\u3002</p> <p>\u867d\u7136hadoop1.0\u6709secondarynamenode\uff0ccheckpointnode\uff0cbuckcupnode\u8fd9\u4e9b\uff0c\u4f46\u662f\u5355\u70b9\u95ee\u9898\u4f9d\u7136\u5b58\u5728\u3002</p> <p></p> <p>\u5728 HDFS 2.X \u65f6\uff0cHDFS \u63d0\u51fa\u4e86\u9ad8\u53ef\u7528(High Availability)\u7684\u65b9\u6848\uff0c\u89e3\u51b3\u4e86 HDFS 1.X \u65f6\u7684\u5355\u70b9\u95ee\u9898\u3002</p> <p>\u5728\u4e00\u4e2a\u5178\u578b\u7684 HA \u96c6\u7fa4\u4e2d\uff0c\u4f1a\u914d\u7f6e\u4e24\u4e2a NameNode\uff1a</p> <ul> <li> <p>\u4e00\u4e2a\u662f Active NameNode(\u4e3b)\uff1a\u5904\u4e8eActive\u72b6\u6001\uff08\u8d1f\u8d23\u96c6\u7fa4\u4e2d\u7684\u6240\u6709\u5ba2\u6237\u7aef\u64cd\u4f5c\uff09</p> </li> <li> <p>\u4e00\u4e2a\u662f Standby NameNode(\u5907)\u3002\u5904\u4e8eStandby\u72b6\u6001\uff08\u7ef4\u62a4\u8db3\u591f\u7684\u72b6\u6001\u4ee5\u5728\u5fc5\u8981\u65f6\u63d0\u4f9b\u5feb\u901f\u6545\u969c\u8f6c\u79fb\uff09</p> </li> </ul> <p>\u4e00\u65e6<code>`Active NameNode</code>\u51fa\u73b0\u6545\u969c\uff0c\u53ef\u4ee5\u8fc5\u901f\u5207\u6362\u81f3 <code>Standby NameNode</code>\uff0c\u4ece\u800c\u4e0d\u95f4\u65ad\u5bf9\u5916\u63d0\u4f9b\u670d\u52a1\u3002</p> <p></p> <p>\u4e3b\u8282\u70b9\u8d1f\u8d23\u6267\u884c\u6240\u6709\u4fee\u6539\u547d\u540d\u7a7a\u95f4\u7684\u64cd\u4f5c\uff0c\u5907\u8282\u70b9\u5219\u6267\u884c\u540c\u6b65\u64cd\u4f5c\uff0c\u4ee5\u4fdd\u8bc1\u4e0e\u4e3b\u8282\u70b9\u547d\u540d\u7a7a\u95f4\u7684\u4e00\u81f4\u6027\u3002</p> <p>\u8bf4\u5230\u540c\u6b65\u81ea\u7136\u8981\u8003\u8651\u5230\u6570\u636e\u4e00\u81f4\u6027\uff0c\u4ece\u6302\u4e86\u600e\u4e48\u529e\u3002\u8fd9\u91cc\u5c31\u9700\u8981\u5f15\u5165\u4e86\u4e00\u4e2a\u4e2d\u95f4\u534f\u8c03\u8282\u70b9\uff1a</p> <p>\u4e3a\u4e86\u4fdd\u6301<code>Standby NameNode</code>\u65f6\u65f6\u7684\u4e0e<code>Active NameNode</code>\u7684\u6570\u636e\u4fdd\u6301\u4e00\u81f4\uff0c\u4ed6\u4eec\u4e4b\u95f4\u6570\u636e\u4ea4\u4e92\u901a\u8fc7\u4e00\u7cfb\u5217\u5b88\u62a4\u7684\u8f7b\u91cf\u7ea7\u8fdb\u7a0bJournalNode\u3002</p> <p><code>HDFS HA using QJM</code>\u65b9\u6848\u57282012\u5e74\u968fHadoop 2.0\u6b63\u5f0f\u53d1\u5e03\uff0c\u6b64\u540e\u4e00\u76f4\u662fHadoop\u793e\u533a\u9ed8\u8ba4HDFS HA\u65b9\u6848\u3002</p>"},{"location":"BigData/HDFS/1.HDFS%E5%AE%9E%E6%88%98/#journalnode","title":"JournalNode","text":"<p>JN\u8282\u70b9\u5c31\u597d\u4f3c\u4e00\u4e2a\u9ad8\u53ef\u7528\u7684\u6d88\u606f\u4e2d\u95f4\u4ef6\u4e00\u6837\uff0c\u4e3b\u8981\u4f5c\u7528\u662f\u628a\u4fee\u6539log\u540c\u6b65\u5230JN\u8282\u70b9\uff0c\u7136\u540eJN\u8282\u70b9\u518d\u540c\u6b65\u5230\u5176\u4ed6JN\u8282\u70b9</p> <p>\u4efb\u4f55\u5199\u64cd\u4f5c\u5728 <code>Active NN</code>\u4e0a\u6267\u884c\u65f6\uff0cJN\u8282\u70b9\u8fdb\u7a0b\u540c\u65f6\u4e5f\u4f1a\u8bb0\u5f55\u4fee\u6539log\u5230\u81f3\u5c11\u534a\u6570\u4ee5\u4e0a\u7684JN\u4e2d\uff08JN\u8282\u70b9\u4e2a\u6570\u4e3a\u5947\u6570\uff0c\u81f3\u5c11\u4e3a3\uff09</p> <p>\u8fd9\u65f6 <code>Standby NN</code> \u76d1\u6d4b\u5230 <code>JN</code> \u91cc\u9762\u7684\u540c\u6b65log\u53d1\u751f\u53d8\u5316\u4e86\u4f1a\u8bfb\u53d6 <code>JN</code> \u91cc\u9762\u7684\u4fee\u6539log\uff0c\u7136\u540e\u540c\u6b65\u5230\u81ea\u5df1\u7684\u7684\u76ee\u5f55\u955c\u50cf\u6811\u91cc\u9762\u3002</p> <p>\u7531\u4e8e<code>JournalNode</code>\u662f**\u4e00\u4e2a\u8f7b\u91cf\u7ea7\u7684\u5b88\u62a4\u8fdb\u7a0b\uff0c\u53ef\u4ee5\u4e0eHadoop\u5176\u4ed6\u670d\u52a1\u5171\u7528\u673a\u5668\u3002**</p> <p>\u5efa\u8bae\u5c06JournalNode\u90e8\u7f72\u5728\u63a7\u5236\u8282\u70b9\u4e0a\uff0c\u4ee5\u907f\u514d\u6570\u636e\u8282\u70b9\u5728\u8fdb\u884c\u5927\u6570\u636e\u91cf\u4f20\u8f93\u65f6\u5f15\u8d77JournalNode\u5199\u5165\u5931\u8d25\u3002</p> <p>\u4e3a\u4fdd\u8bc1\u6545\u969c\u8f6c\u79fb\u5feb\u901f\u8fdb\u884c\uff0c<code>Standby NN</code>\u9700\u8981\u65f6\u523b\u4fdd\u6301\u6700\u65b0\u7684\u5757\u4fe1\u606f\uff0c\u4e3a\u6b64<code>DataNodes</code>\u540c\u65f6\u5411\u4e24\u4e2a<code>NameNodes</code>\u6c47\u62a5\u5757\u4fe1\u606f\u548c\u5fc3\u8df3\u3002</p> <p>\u770b\u5230\u8fd9\u91cc\uff0cJN\u663e\u7136\u5c31\u662f\u4e00\u4e2a\u57fa\u4e8ePaxos\u7b97\u6cd5\u5b9e\u73b0\u7684\u6d88\u606f\u4e2d\u95f4\u4ef6\uff0c\u901a\u8fc7\u8fd9\u79cd\u65b9\u5f0f\u6765\u5b9e\u73b0HDFS HA\u65b9\u6848\u3002\u4fdd\u8bc1\u5143\u6570\u636e\u7684\u4e00\u81f4\u6027\u3002</p> <p>JN \u8282\u70b9\u672c\u8eab\u4e5f\u662f\u4e00\u4e2a\u591a\u8282\u70b9\u7684\u96c6\u7fa4\uff0c\u4ece\u800c\u4fdd\u8bc1\u5b83\u81ea\u8eab\u7684\u53ef\u9760\u6027\u3002\u800c\u4e14 <code>JournalNode</code> \u8282\u70b9\u4f1a\u5728\u96c6\u7fa4\u81ea\u52a8\u7684\u9009\u62e9\u4e00\u4e2a\"\u4e3b\"\u8282\u70b9\u51fa\u6765\uff0cActive \u8282\u70b9\u4f1a\u548c <code>JournalNode</code>\u7684\u4e3b\u8282\u70b9\u901a\u4fe1\uff0c\u7136\u540e <code>JournalNode</code> \u96c6\u7fa4\u7684\u4e3b\u8282\u70b9\u4f1a\u5c06\u6570\u636e\u53d1\u9001\u7ed9\u5176\u4ed6\u7684\u8282\u70b9\uff0c\u53ea\u8981\u6709\u8fc7\u534a\u7684\u8282\u70b9\u5b8c\u6210\u4e86\u6570\u636e\u7684\u5b58\u50a8\uff0c<code>JournalNode</code> \u96c6\u7fa4\u7684\u4e3b\u8282\u70b9\uff0c\u5c31\u4f1a\u5c06\u6210\u529f\u4fe1\u606f\u8fd4\u56de\u7ed9 Active \u8282\u70b9\u3002\u5f53 JournalNode \u96c6\u7fa4\u7684\u4e3b\u8282\u70b9\u6302\u6389\uff0c\u5176\u4ed6\u7684 JournalNode \u8282\u70b9\u4f1a\u5feb\u901f\u9009\u4e3e\u51fa\u65b0\u7684\"\u4e3b\"\u8282\u70b9\u6765\u3002</p> <p>HDFS-3077(Quorum-based protocol for reading and writing edit logs) \u5bf9\u4e0a\u8ff0\u8fc7\u7a0b\u8fdb\u884c\u4e86\u5b9e\u73b0\u3002QJM\u5168\u79f0Qurom Journal Manager\uff0c\u5b83\u7684\u4e00\u4e2a\u6838\u5fc3\u539f\u7406\u662f\u57fa\u4e8eQuorum((\u6700\u4f4e)\u6cd5\u5b9a\u4eba\u6570)\u7684\u539f\u7406\u3002</p> <ul> <li>Quorum\u662f\u4e00\u79cd\u57fa\u4e8e\u6570\u91cf\u7684\u4e00\u81f4\u6027\u534f\u8bae\uff0c\u5b83\u8981\u6c42\u591a\u6570\u8282\u70b9\u8fbe\u6210\u4e00\u81f4\u624d\u80fd\u5b8c\u6210\u64cd\u4f5c\u3002</li> <li>Paxos\u662f\u4e00\u79cd\u57fa\u4e8e\u6295\u7968\u7684\u4e00\u81f4\u6027\u534f\u8bae\uff0c\u5b83\u8981\u6c42\u6bcf\u4e2a\u8282\u70b9\u90fd\u8fdb\u884c\u6295\u7968\uff0c\u4ee5\u786e\u4fdd\u6574\u4e2a\u7cfb\u7edf\u7684\u4e00\u81f4\u6027\u3002</li> </ul> <p>\u901a\u8fc7 <code>JournalNode</code> \u901a\u8fc7\u81ea\u8eab\u5177\u5907\u5b58\u50a8\u80fd\u529b\uff0c\u548c\u4fdd\u8bc1\u81ea\u8eab\u7684\u53ef\u9760\u6027\uff0c\u4e3a <code>Active NameNode</code>\u548c <code>Standby NameNode</code> \u8282\u70b9\u4e4b\u95f4\u7684\u6570\u636e\u6700\u7ec8\u4e00\u81f4\u6027\u63d0\u4f9b\u4e86\u670d\u52a1\u3002</p> <p>\u5728 2.0 \u4e2d\u4e0d\u518d\u6709 SecondaryNameNode \u8fd9\u4e2a\u89d2\u8272\u4e86\uff1a</p> <p>NameNode \u5728\u542f\u52a8\u540e\uff0c\u4f1a\u5148\u52a0\u8f7d FSImage \u6587\u4ef6\u548c\u5171\u4eab\u76ee\u5f55\u4e0a\u7684 EditLog Segment \u6587\u4ef6\uff0c\u4e4b\u540e NameNode \u4f1a\u542f\u52a8 EditLogTailer \u7ebf\u7a0b\u548c StandbyCheckpointer \u7ebf\u7a0b\uff0c\u6b63\u5f0f\u8fdb\u5165 Standby \u6a21\u5f0f</p> <p>JN\u53ef\u7528\u6027\u5bb9\u9519</p> <p>\u5f53\u4e00\u4e2aJN\u8282\u70b9\u5de5\u4f5c\u72b6\u6001\u5f02\u5e38\u65f6\uff0c\u5176\u6570\u636e\u5c31\u4f1a\u4e0e\u5176\u4ed6JN\u8282\u70b9\u7684\u6570\u636e\u4e0d\u540c\u6b65\u3002\u5982\u679c\u8d85\u8fc7\u4e00\u534a\u7684JN\u8282\u70b9\u7684\u6570\u636e\u4e0d\u540c\u6b65\u65f6\uff0cNameNode\u5c06\u65e0\u6cd5\u5de5\u4f5c\uff0c\u5bfc\u81f4HDFS\u670d\u52a1\u4e0d\u53ef\u7528\u3002\u5bf9\u4e8e\u4e00\u4e2a\u75312N+1\u53f0JournalNode\u7ec4\u6210\u7684\u96c6\u7fa4\uff0c\u53ef\u4ee5\u5bb9\u5fcd\u6700\u591aN\u53f0JournalNode\u8282\u70b9\u6302\u6389\u3002</p>"},{"location":"BigData/HDFS/1.HDFS%E5%AE%9E%E6%88%98/#zkfc","title":"ZKFC","text":"<p>\u5f15\u5165JN\u8282\u70b9\uff0c\u4fdd\u8bc1\u4e86\u4e3b\u4eceNameNode\u7684\u6570\u636e\u540c\u6b65\u4e00\u81f4\u6027\u95ee\u9898\u3002\u4f46\u662f\u4e3b\u4ece\u5207\u6362\u95ee\u9898\u4ecd\u7136\u5b58\u5728\u3002</p> <p>\u501f\u52a9ZK\u7684ZKFC(Zookeeper FailoverController Active&amp;standby)\uff0cZKFC\u6765\u5b9e\u73b0\u81ea\u52a8\u5207\u6362Active NameNode\u3002</p> <p>FailoverController\u548cNameNode\u653e\u5230\u4e00\u53f0\u7269\u7406\u673a\u4e0a\uff0c\u4e5f\u5c31\u662f\u4ec5\u4ec5\u662f\u8de8\u8fdb\u7a0b\u8c03\u7528\u800c\u975e\u8de8\u7f51\u7edc\u8c03\u7528\uff0c\u5982\u679c\u653e\u5230\u4e0d\u540c\u7684\u7269\u7406\u673a\uff0c\u90a3\u4e48\u5b83\u4eec\u6c9f\u901a\u5c31\u9700\u8981\u901a\u8fc7\u7f51\u7edc\u4f20\u8f93\u6765\u8fdb\u884c\uff0c\u5c31\u4f1a\u4ea7\u751f\u5f88\u591a\u7684\u4e0d\u53ef\u9760\u6027\uff0c\u52a0\u5927\u4e86\u76d1\u63a7\u7684\u98ce\u9669\u3002</p> <p>ZKFC\u529f\u80fd</p> <ul> <li> <p>\u76d1\u63a7NameNode:\u76d1\u63a7NameNode\u7684\u5b58\u6d3b\u72b6\u6001\u3001\u64cd\u4f5c\u7cfb\u7edf\u548c\u786c\u4ef6\u4fe1\u606f\u3002</p> </li> <li> <p>\u8fde\u63a5Zookeeper\u5e76\u521b\u5efa<code>Active NameNode</code>\uff1aZookeeper\u4e2d\u6709\u76ee\u5f55\u6811\uff0c\u5f53\u6240\u6709 NameNode \u548c ZKFC \u542f\u52a8\u65f6\uff0cZKFC\u9996\u5148\u5411Zookeeper\u7533\u8bf7\u4e00\u4e2a\u521b\u5efa\u9501\uff0c\u8c01\u62ff\u5230\u4e86\u521b\u5efa\u9501\uff0c\u8c01\u5c31\u80fd\u521b\u5efa\u4e00\u4e2a\u4e34\u65f6\u5b50\u8282\u70b9\uff0c\u8fd9\u610f\u5473\u77402\u4e2aZKFC\u53ea\u6709\u4e00\u4e2a\u80fd\u521b\u5efa\u5b50\u8282\u70b9\uff0c\u8fd9\u4e2a\u88abZKFC\u521b\u5efa\u6210\u529f\u7684\u5b50\u8282\u70b9\u4e2d\u5305\u542b\u7684\u5c31\u662f<code>Active NameNode</code>\u3002</p> </li> <li> <p>\u964d\u7ea7<code>Active NameNode</code>\uff0c\u5347\u7ea7<code>Standby NameNode</code>\uff1a\u5047\u8bbe<code>Active NameNode</code>\u5b58\u6d3b\u4f46\u662fZKFC\u8fdb\u7a0b\u5f02\u5e38\u9000\u51fa\uff0c\u8fd9\u65f6\u5019\u5c31\u4f1a\u89e6\u53d1\u6b64\u673a\u5236\uff0cZookeeper\u7684\u4e34\u65f6\u5b50\u8282\u70b9\u4f1a\u88ab\u5220\u9664\uff0c\u7136\u540e\u89e6\u53d1callback\u673a\u5236\uff0c\u7b2c\u4e8c\u4e2aZKFC\u5c31\u4f1a\u62a2\u5230\u521b\u5efa\u9501\uff0c\u5e76\u81ea\u5df1\u5c06<code>Active NameNode</code>\u964d\u7ea7\u6210<code>Standby NameNode</code>\uff0c\u5347\u7ea7<code>Standby NameNode</code>\u4e3a<code>Active NameNode</code>\u3002</p> </li> </ul>"},{"location":"BigData/HDFS/1.HDFS%E5%AE%9E%E6%88%98/#federation","title":"\u8054\u90a6\u673a\u5236**Federation**","text":"<p>\u5355 NameNode \u7684\u67b6\u6784\u5b58\u5728\u7684\u95ee\u9898\uff1a\u5f53\u96c6\u7fa4\u4e2d\u6570\u636e\u589e\u957f\u5230\u4e00\u5b9a\u89c4\u6a21\u540e\uff0cNameNode \u8fdb\u7a0b\u5360\u7528\u7684\u5185\u5b58\u53ef\u80fd\u4f1a\u8fbe\u5230\u6210\u767e\u4e0a\u5343 GB\uff08\u8c03\u5927 NameNode \u7684 JVM \u5806\u5185\u5b58\u5df2\u65e0\u53ef\u80fd\uff09\uff0c\u6b64\u65f6\uff0cNameNode \u6210\u4e86\u96c6\u7fa4\u7684\u6027\u80fd\u74f6\u9888\u3002</p> <p>\u96b6\u5c5e\u4e8e\u540c\u4e00\u4e2aNameNode\u6240\u7ba1\u7406\u7684\u6570\u636e\u90fd\u662f\u5728\u540c\u4e00\u4e2a\u547d\u540d\u7a7a\u95f4\u4e0b\u7684\uff0c\u800c\u4e00\u4e2anamespace\u5bf9\u5e94\u4e00\u4e2ablock pool\u3002Block Pool\u662f\u540c\u4e00\u4e2anamespace\u4e0b\u7684block\u7684\u96c6\u5408</p> <p>HDFS Federation\u66f4\u5e94\u8be5\u662f NameNode Federation\uff0c\u591a\u4e2aNameNode\u7684\u60c5\u51b5\u610f\u5473\u7740\u6709\u591a\u4e2anamespace(\u547d\u540d\u7a7a\u95f4)\u3002\u8fd9\u4e9bNameNode\u662f\u5171\u4eab\u96c6\u7fa4\u4e2d\u6240\u6709\u7684DataNode\u7684\uff0c\u5b83\u4eec\u8fd8\u662f\u5728\u540c\u4e00\u4e2a\u96c6\u7fa4\u5185\u7684</p> <p>HDFS Federation\u662f\u89e3\u51b3NameNode\u5355\u70b9\u95ee\u9898\u7684\u6c34\u5e73\u6a2a\u5411\u6269\u5c55\u65b9\u6848\u3002</p>"},{"location":"BigData/HDFS/1.HDFS%E5%AE%9E%E6%88%98/#_3","title":"\u7aef\u53e3","text":""},{"location":"BigData/HDFS/1.HDFS%E5%AE%9E%E6%88%98/#namenode","title":"Namenode \u7aef\u53e3","text":"2.x\u7aef\u53e3 3.x\u7aef\u53e3 name desc 50470 9871 dfs.namenode.https-address The namenode secure http server address and port. 50070 9870 dfs.namenode.http-address The address and the base port where the dfs namenode web ui will listen on. 8020 9820 fs.defaultFS \u6307\u5b9aHDFS\u8fd0\u884c\u65f6nameNode\u5730\u5740"},{"location":"BigData/HDFS/1.HDFS%E5%AE%9E%E6%88%98/#secondary-namenode","title":"Secondary NameNode \u7aef\u53e3","text":"2.x\u7aef\u53e3 3.x\u7aef\u53e3 name desc 50091 9869 dfs.namenode.secondary.https-address The secondary namenode HTTPS server address and port 50090 9868 dfs.namenode.secondary.http-address The secondary namenode HTTPS server address and port 2.x\u7aef\u53e3 3.x\u7aef\u53e3 name desc 50020 9867 dfs.datanode.ipc.address The datanode ipc server address and port. 50010 9866 dfs.datanode.address The datanode server address and port for data transfer. 50475 9865 dfs.datanode.https.address The datanode secure http server address and port 50075 9864 dfs.datanode.http.address The datanode http server address and por"},{"location":"BigData/HIVE/2.HIVE%E5%85%83%E6%95%B0%E6%8D%AE/","title":"2.HIVE\u5143\u6570\u636e","text":"<p>&lt;&lt;&lt;&lt;&lt;&lt;&lt; HEAD \u5927\u6570\u636e\u5143\u6570\u636e\u670d\u52a1 <code>Hive Metastore Service</code>\uff08\u4ee5\u4e0b\u7b80\u79f0 HMS\uff09\u662f\u4e00\u9879\u5355\u72ec\u7684\u670d\u52a1\uff0c\u4e0d\u662f Hive \u7684\u4e00\u90e8\u5206\uff0c\u751a\u81f3\u4e0d\u5fc5\u4f4d\u4e8e\u540c\u4e00\u96c6\u7fa4\u4e0a\u3002Hive \u7684\u5143\u6570\u636e\u4fe1\u606f\u901a\u5e38\u5b58\u50a8\u5728\u5173\u7cfb\u578b\u6570\u636e\u5e93\u4e2d\uff0c\u5e38\u7528 MySQL \u6570\u636e\u5e93\u4f5c\u4e3a\u5143\u6570\u636e\u5e93\u7ba1\u7406\u3002 =======</p>"},{"location":"BigData/HIVE/2.HIVE%E5%85%83%E6%95%B0%E6%8D%AE/#hms","title":"HMS","text":"<p><code>metastore</code>\u6709\u4e24\u4e2a\u610f\u601d\uff0c\u4e00\u662f\u6307\u5b58\u653e<code>\u5143\u6570\u636e</code>\u7684\u5730\u65b9\uff0c\u4e00\u822c\u662f\u7528MySQL\u6570\u636e\u5e93\uff0c\u4e8c\u662f\u6307<code>metastore server</code>\u3002</p> <p>\u5927\u6570\u636e\u5143\u6570\u636e\u670d\u52a1 <code>Hive Metastore Service</code>\uff08\u4ee5\u4e0b\u7b80\u79f0HMS\uff09\u662f\u4e00\u9879\u5355\u72ec\u7684\u670d\u52a1\uff0c\u4e0d\u662fHive\u7684\u4e00\u90e8\u5206\uff0c\u751a\u81f3\u4e0d\u5fc5\u4f4d\u4e8e\u540c\u4e00\u96c6\u7fa4\u4e0a\u3002</p> <p>1\uff09\u5185\u5d4c\u6a21\u5f0f\uff1a\u5c06\u5143\u6570\u636e\u4fdd\u5b58\u5728\u672c\u5730\u5185\u5d4c\u7684derby\u6570\u636e\u5e93\u4e2d\uff0c\u5185\u5d4c\u7684derby\u6570\u636e\u5e93\u6bcf\u6b21\u53ea\u80fd\u8bbf\u95ee\u4e00\u4e2a\u6570\u636e\u6587\u4ef6\uff0c\u4e5f\u5c31\u610f\u5473\u7740\u5b83\u4e0d\u652f\u6301\u591a\u4f1a\u8bdd\u8fde\u63a5\u3002</p> <p>2\uff09\u672c\u5730\u6a21\u5f0f\uff1a\u5c06\u5143\u6570\u636e\u4fdd\u5b58\u5728\u672c\u5730\u72ec\u7acb\u7684\u6570\u636e\u5e93\u4e2d\uff08\u4e00\u822c\u662fmysql\uff09\uff0c\u8fd9\u53ef\u4ee5\u652f\u6301\u591a\u4f1a\u8bdd\u8fde\u63a5\u3002</p> <p>3\uff09\u8fdc\u7a0b\u6a21\u5f0f\uff1a\u628a\u5143\u6570\u636e\u4fdd\u5b58\u5728\u8fdc\u7a0b\u72ec\u7acb\u7684mysql\u6570\u636e\u5e93\u4e2d\uff0c\u907f\u514d\u6bcf\u4e2a\u5ba2\u6237\u7aef\u90fd\u53bb\u5b89\u88c5mysql\u6570\u636e\u5e93\u3002</p> <p>Metastore \u901a\u8fc7 DataNucleus\uff08\u4e00\u4e2a\u57fa\u4e8e Java JDO \u7684\u5bf9\u8c61\u5173\u7cfb\u6620\u5c04 (ORM) \u5c42\uff09\u5c06\u5bf9\u8c61\u5b9a\u4e49\u6301\u4e45\u5316\u5230\u5173\u7cfb\u6570\u636e\u5e93 (RDBMS)</p> <p>HMS\u670d\u52a1</p> <p>\u5ba2\u6237\u7aef\u8fde\u63a5metastore\u670d\u52a1\uff0cmetastore\u518d\u53bb\u8fde\u63a5MySQL\u6570\u636e\u5e93\u6765\u5b58\u53d6\u5143\u6570\u636e\u3002</p> <p>\u6709\u4e86metastore\u670d\u52a1\uff0c\u5c31\u53ef\u4ee5\u6709\u591a\u4e2a\u5ba2\u6237\u7aef\u540c\u65f6\u8fde\u63a5\uff0c\u800c\u4e14\u8fd9\u4e9b\u5ba2\u6237\u7aef\u4e0d\u9700\u8981\u77e5\u9053MySQL\u6570\u636e\u5e93\u7684\u7528\u6237\u540d\u548c\u5bc6\u7801\uff0c\u53ea\u9700\u8981\u8fde\u63a5metastore \u670d\u52a1\u5373\u53ef\u3002 </p> <p>Metastore \u67093\u79cd\u5f00\u542f\u65b9\u5f0f:</p> <ul> <li>\u9ed8\u8ba4\u5f00\u542f\u65b9\u5f0f\uff1a</li> </ul> <p>\u6ca1\u6709\u914d\u7f6emetaStore\u7684\u65f6\u5019\uff0c\u6bcf\u5f53\u5f00\u542fbin/hive\uff1b\u6216\u8005\u5f00\u542fhiveServer2\u7684\u65f6\u5019\uff0c\u90fd\u4f1a\u5728\u5185\u90e8\u542f\u52a8\u4e00\u4e2ametastore\u5d4c\u5165\u5f0f\u670d\u52a1\uff1b\u8d44\u6e90\u6bd4\u8f83\u6d6a\u8d39,\u5982\u679c\u5f00\u542f\u591a\u4e2a\u7a97\u53e3,\u5c31\u4f1a\u5b58\u5728\u591a\u4e2ametastore server\u3002</p> <ul> <li>local mataStore(\u672c\u5730)</li> </ul> <p>\u5f53metaStore\u548c\u88c5\u8f7d\u5143\u6570\u636e\u7684\u6570\u636e\u5e93(MySQL)\u5b58\u5728\u540c\u4e00\u673a\u5668\u4e0a\u65f6\u914d\u7f6e\u662f\u6b64\u6a21\u5f0f\u3002</p> <p>\u5f00\u542fmetastore\u670d\u52a1\u5c31\u53ea\u9700\u8981\u5f00\u542f\u4e00\u6b21\u5c31\u597d\uff0c\u907f\u514d\u8d44\u6e90\u6d6a\u8d39!</p> <ul> <li>Remote Metastore(\u8fdc\u7a0b)</li> </ul> <p>\u5f53metaStore\u548c\u88c5\u8f7d\u5143\u6570\u636e\u7684\u6570\u636e\u5e93(MySQL)\u4e0d\u5b58\u5728\u540c\u4e00\u673a\u5668\u4e0a\u65f6\u914d\u7f6e\u662f\u6b64\u6a21\u5f0f\u3002</p> <p>\u5f00\u542fmetastore\u670d\u52a1\u5c31\u53ea\u9700\u8981\u5f00\u542f\u4e00\u6b21\u5c31\u597d,\u907f\u514d\u8d44\u6e90\u6d6a\u8d39!</p> <p>4b6372e71813cbab1fd8bdd80e392779f311c66f</p> <p>HMS \u7528\u4e8e\u7ba1\u7406 hive \u7684\u5143\u6570\u636e\u5e76\u63d0\u4f9b\u670d\u52a1\u3002\u8fd9\u91cc\u7684\u5143\u6570\u636e\u5305\u62ec\uff1a\u6570\u636e\u5e93\u3001\u8868\u3001\u8868\u7684\u6a21\u5f0f\u3001\u76ee\u5f55\u3001\u5206\u533a\u3001\u7d22\u5f15\u4ee5\u53ca\u547d\u540d\u7a7a\u95f4\u7b49\u3002</p> <p>HMS \u53ef\u80fd\u662f\u5916\u90e8\u7684\u72ec\u7acb\u6570\u636e\u5e93\uff0c\u6240\u4ee5\u5b83\u7684\u6027\u80fd\u4e5f\u4f1a\u5f71\u54cd\u5230\u6574\u4e2a**HiveServer**\u7684\u6027\u80fd\uff0c\u4e3b\u8981\u5305\u62ec**HiveMetaStore**\u8bbf\u95ee\u65f6\u95f4\uff0c\u8bbf\u95ee\u6b21\u6570\uff0c\u8fde\u63a5\u5e76\u53d1\u6570\u3002</p> <p>HMS \u5b58\u50a8\u7740\u6570\u636e\u4ed3\u5e93\u4e2d\u6240\u4f9d\u8d56\u7684\u6240\u6709\u5143\u6570\u636e\u5e76\u63d0\u4f9b\u76f8\u5e94\u7684\u67e5\u8be2\u670d\u52a1\u3002\u4f7f\u5f97\u8ba1\u7b97\u5f15\u64ce\uff08Hive\u3001Spark\u3001Presto\uff09\u80fd\u5728\u6d77\u91cf\u6570\u636e\u4e2d\u51c6\u786e\u8bbf\u95ee\u5230\u9700\u8981\u8bbf\u95ee\u7684\u5177\u4f53\u6570\u636e\uff0c\u5176\u5728\u79bb\u7ebf\u6570\u4ed3\u7684\u7a33\u5b9a\u6784\u5efa\u4e0a\u626e\u6f14\u7740\u4e3e\u8db3\u8f7b\u91cd\u7684\u89d2\u8272</p> <p>&lt;&lt;&lt;&lt;&lt;&lt;&lt; HEAD \u4e3a\u6570\u636e\u5e93\u521b\u5efa\u7684\u76ee\u5f55\u4e00\u822c\u5728 hive \u6570\u636e\u4ed3\u5e93\u76ee\u5f55\u4e0b\u3002 =======</p> <p>Hive \u7684\u5143\u6570\u636e\u4fe1\u606f\u901a\u5e38\u5b58\u50a8\u5728\u5173\u7cfb\u578b\u6570\u636e\u5e93\u4e2d\uff0c\u5e38\u7528MySQL\u6570\u636e\u5e93\u4f5c\u4e3a\u5143\u6570\u636e\u5e93\u7ba1\u7406\u3002</p> <p>4b6372e71813cbab1fd8bdd80e392779f311c66f</p> <p>Hive-Metastore \u5185\u5404\u8868\u4f5c\u7528</p> <p>&lt;&lt;&lt;&lt;&lt;&lt;&lt; HEAD | \u8868\u540d                      | \u4f5c\u7528                                                                                                                           | | ------------------------- | ------------------------------------------------------------------------------------------------------------------------------ | | DBS                       | database \u4fe1\u606f                                                                                                                  | | DATABASE_PARAMS           | \u6570\u636e\u5e93\u7684\u76f8\u5173\u53c2\u6570                                                                                                               | | FUNCS                     | \u7528\u6237\u6ce8\u518c\u7684\u51fd\u6570\u4fe1\u606f                                                                                                             | | FUNC_RU                   | \u7528\u6237\u6ce8\u518c\u51fd\u6570\u7684\u8d44\u6e90\u4fe1\u606f                                                                                                         | | TBLS                      | \u5b58\u50a8 Hive \u8868\u3001\u8bd5\u56fe\u3001\u7d22\u5f15\u8868\u7684\u57fa\u672c\u4fe1\u606f                                                                                           | | TABLE_PARAMS              | \u8868\u76f8\u5173\u4fe1\u606f                                                                                                                     | | TAB_COL_STATS             |                                                                                                                                | | TBL_COL_PRIVS             |                                                                                                                                | | TBL_PRIVS                 |                                                                                                                                | | IDXS                      | \u7d22\u5f15\u8868\uff0c\u5b58\u50a8 Hive \u7d22\u5f15\u76f8\u5173\u7684\u5143\u6570\u636e                                                                                             | | INDEX_PARAMS              | \u7d22\u5f15\u76f8\u5173\u7684\u5c5e\u6027\u4fe1\u606f                                                                                                             | | BUCKETING_COLS            | \u5b58\u50a8 bucket \u5b57\u6bb5\u4fe1\u606f\uff0c\u901a\u8fc7 SD_ID \u4e0e\u5176\u4ed6\u8868\u5173\u8054                                                                                  | | CDS                       | \u4e00\u4e2a\u5b57\u6bb5 CD_ID\uff0c\u4e0e SDS \u8868\u5173\u8054                                                                                                  | | COLUMNS_V2                | \u5b58\u50a8\u5b57\u6bb5\u4fe1\u606f\uff0c\u901a\u8fc7 CD_ID \u4e0e\u5176\u4ed6\u8868\u5173\u8054                                                                                          | | PARTITIONS                | \u5206\u533a\u8bb0\u5f55\uff0cSD_ID\uff0cTBL_ID \u5173\u8054                                                                                                   | | PARTITION_KEYS            | \u5b58\u50a8\u5206\u533a\u5b57\u6bb5\uff0cTBL_ID \u5173\u8054                                                                                                      | | PARTITION_KEY_VALS        | \u5206\u533a\u7684\u503c\uff0c\u901a\u8fc7 PART_ID \u5173\u8054\u3002\u4e0e PARTITION_KEYS \u5171\u7528 INTEGER_IDX \u6765\u6807\u793a\u4e0d\u540c\u7684\u5206\u533a\u5b57\u6bb5                                           | | PARTITION_PARAMS          | \u5b58\u50a8\u67d0\u5206\u533a\u76f8\u5173\u4fe1\u606f\uff0c\u5305\u62ec\u6587\u4ef6\u6570\uff0c\u6587\u4ef6\u5927\u5c0f\uff0c\u8bb0\u5f55\u6761\u6570\u7b49 PART_ID \u5173\u8054                                                              | | PART_COL_PRIVS            | \u5206\u533a\u5b57\u6bb5\u7684\u6743\u9650\u4fe1\u606f                                                                                                             | | PART_COL_STATS            | \u5206\u533a\u5b57\u6bb5\u7684\u7edf\u8ba1\u4fe1\u606f                                                                                                             | | PART_PRIVS                | \u5206\u533a\u7684\u6388\u6743\u4fe1\u606f                                                                                                                 | | SDS                       | \u5b58\u50a8\u5bf9\u5e94\u6587\u4ef6\u7684\u57fa\u672c\u4fe1\u606f\uff0c\u5982 INPUT_FORMAT\u3001OUTPUT_FORMAT\u3001\u662f\u5426\u538b\u7f29\u7b49\u3002TBLS \u8868\u4e2d\u7684 SD_ID \u4e0e\u8be5\u8868\u5173\u8054\uff0c\u53ef\u4ee5\u83b7\u53d6 Hive \u8868\u7684\u5b58\u50a8\u4fe1\u606f\u3002 | | SD_PARAMS                 | \u8be5\u8868\u5b58\u50a8 Hive \u5b58\u50a8\u7684\u5c5e\u6027\u4fe1\u606f                                                                                                   | | SORT_COLS                 | \u6392\u5e8f\u5b57\u6bb5\uff0c\u901a\u8fc7 SD_ID \u5173\u8054                                                                                                      | | SERDES                    | \u5b58\u50a8\u5e8f\u5217\u5316\u53cd\u5e8f\u5217\u5316\u4f7f\u7528\u7684\u7c7b                                                                                                     | | SERDE_PARAMS              | \u5e8f\u5217\u5316\u53cd\u5e8f\u5217\u5316\u76f8\u5173\u4fe1\u606f\uff0c\u901a\u8fc7 SERDE_ID \u5173\u8054                                                                                     | | SKEWED_COL_NAMES          |                                                                                                                                | | SKEWED_COL_VALUE_LOC_MAP  |                                                                                                                                | | SKEWED_STRING_LIST        |                                                                                                                                | | SKEWED_STRING_LIST_VALUES |                                                                                                                                | | SKEWED_VALUES             |                                                                                                                                | | GLOBAL_PRIVS              | \u5b58\u50a8\u5168\u5c40\u53d8\u91cf                                                                                                                   | | ROLES                     | \u89d2\u8272\u8868\uff0c\u548c GLOBAL_PRIVS \u914d\u5408                                                                                                   | | VERSION                   | \u5b58\u50a8 hive \u7684\u7248\u672c\u4fe1\u606f                                                                                                           | | SEQUENCE_TABLE            | \u5b58\u50a8 sqeuence \u76f8\u5173\u4fe1\u606f                                                                                                         | =======</p> <p>HMS\u53ef\u80fd\u662f\u5916\u90e8\u7684\u72ec\u7acb\u6570\u636e\u5e93\uff0c\u6240\u4ee5\u5b83\u7684\u6027\u80fd\u4e5f\u4f1a\u5f71\u54cd\u5230\u6574\u4e2a**HiveServer**\u7684\u6027\u80fd\uff0c\u4e3b\u8981\u5305\u62ec**HiveMetaStore**\u8bbf\u95ee\u65f6\u95f4\uff0c\u8bbf\u95ee\u6b21\u6570\uff0c\u8fde\u63a5\u5e76\u53d1\u6570\u3002</p> <p>HMS\u5b58\u50a8\u7740\u6570\u636e\u4ed3\u5e93\u4e2d\u6240\u4f9d\u8d56\u7684\u6240\u6709\u5143\u6570\u636e\u5e76\u63d0\u4f9b\u76f8\u5e94\u7684\u67e5\u8be2\u670d\u52a1\u3002\u4f7f\u5f97\u8ba1\u7b97\u5f15\u64ce\uff08Hive\u3001Spark\u3001Presto\uff09\u80fd\u5728\u6d77\u91cf\u6570\u636e\u4e2d\u51c6\u786e\u8bbf\u95ee\u5230\u9700\u8981\u8bbf\u95ee\u7684\u5177\u4f53\u6570\u636e\uff0c\u5176\u5728\u79bb\u7ebf\u6570\u4ed3\u7684\u7a33\u5b9a\u6784\u5efa\u4e0a\u626e\u6f14\u7740\u4e3e\u8db3\u8f7b\u91cd\u7684\u89d2\u8272</p> <p>\u4e3a\u6570\u636e\u5e93\u521b\u5efa\u7684\u76ee\u5f55\u4e00\u822c\u5728hive\u6570\u636e\u4ed3\u5e93\u76ee\u5f55\u4e0b\u3002</p> <p>https://www.cnblogs.com/convict/p/16575595.html</p> <p>Hive-Metastore\u5185\u5404\u8868\u4f5c\u7528</p> \u8868\u540d \u4f5c\u7528 DBS database\u4fe1\u606f DATABASE_PARAMS \u6570\u636e\u5e93\u7684\u76f8\u5173\u53c2\u6570 FUNCS \u7528\u6237\u6ce8\u518c\u7684\u51fd\u6570\u4fe1\u606f FUNC_RU \u7528\u6237\u6ce8\u518c\u51fd\u6570\u7684\u8d44\u6e90\u4fe1\u606f TBLS \u5b58\u50a8Hive\u8868\u3001\u8bd5\u56fe\u3001\u7d22\u5f15\u8868\u7684\u57fa\u672c\u4fe1\u606f TABLE_PARAMS \u8868\u76f8\u5173\u4fe1\u606f TAB_COL_STATS TBL_COL_PRIVS TBL_PRIVS IDXS \u7d22\u5f15\u8868\uff0c\u5b58\u50a8Hive\u7d22\u5f15\u76f8\u5173\u7684\u5143\u6570\u636e INDEX_PARAMS \u7d22\u5f15\u76f8\u5173\u7684\u5c5e\u6027\u4fe1\u606f BUCKETING_COLS \u5b58\u50a8bucket\u5b57\u6bb5\u4fe1\u606f\uff0c\u901a\u8fc7SD_ID\u4e0e\u5176\u4ed6\u8868\u5173\u8054 CDS \u4e00\u4e2a\u5b57\u6bb5CD_ID\uff0c\u4e0eSDS\u8868\u5173\u8054 COLUMNS_V2 \u5b58\u50a8\u5b57\u6bb5\u4fe1\u606f\uff0c\u901a\u8fc7CD_ID\u4e0e\u5176\u4ed6\u8868\u5173\u8054 PARTITIONS \u5206\u533a\u8bb0\u5f55\uff0cSD_ID\uff0cTBL_ID\u5173\u8054 PARTITION_KEYS \u5b58\u50a8\u5206\u533a\u5b57\u6bb5\uff0cTBL_ID\u5173\u8054 PARTITION_KEY_VALS \u5206\u533a\u7684\u503c\uff0c\u901a\u8fc7PART_ID\u5173\u8054\u3002\u4e0ePARTITION_KEYS\u5171\u7528INTEGER_IDX\u6765\u6807\u793a\u4e0d\u540c\u7684\u5206\u533a\u5b57\u6bb5 PARTITION_PARAMS \u5b58\u50a8\u67d0\u5206\u533a\u76f8\u5173\u4fe1\u606f\uff0c\u5305\u62ec\u6587\u4ef6\u6570\uff0c\u6587\u4ef6\u5927\u5c0f\uff0c\u8bb0\u5f55\u6761\u6570\u7b49PART_ID\u5173\u8054 PART_COL_PRIVS \u5206\u533a\u5b57\u6bb5\u7684\u6743\u9650\u4fe1\u606f PART_COL_STATS \u5206\u533a\u5b57\u6bb5\u7684\u7edf\u8ba1\u4fe1\u606f PART_PRIVS \u5206\u533a\u7684\u6388\u6743\u4fe1\u606f SDS \u5b58\u50a8\u5bf9\u5e94\u6587\u4ef6\u7684\u57fa\u672c\u4fe1\u606f\uff0c\u5982INPUT_FORMAT\u3001OUTPUT_FORMAT\u3001\u662f\u5426\u538b\u7f29\u7b49\u3002TBLS\u8868\u4e2d\u7684SD_ID\u4e0e\u8be5\u8868\u5173\u8054\uff0c\u53ef\u4ee5\u83b7\u53d6Hive\u8868\u7684\u5b58\u50a8\u4fe1\u606f\u3002 SD_PARAMS \u8be5\u8868\u5b58\u50a8Hive\u5b58\u50a8\u7684\u5c5e\u6027\u4fe1\u606f SORT_COLS \u6392\u5e8f\u5b57\u6bb5\uff0c\u901a\u8fc7SD_ID\u5173\u8054 SERDES \u5b58\u50a8\u5e8f\u5217\u5316\u53cd\u5e8f\u5217\u5316\u4f7f\u7528\u7684\u7c7b SERDE_PARAMS \u5e8f\u5217\u5316\u53cd\u5e8f\u5217\u5316\u76f8\u5173\u4fe1\u606f\uff0c\u901a\u8fc7SERDE_ID\u5173\u8054 SKEWED_COL_NAMES SKEWED_COL_VALUE_LOC_MAP SKEWED_STRING_LIST SKEWED_STRING_LIST_VALUES SKEWED_VALUES GLOBAL_PRIVS \u5b58\u50a8\u5168\u5c40\u53d8\u91cf ROLES \u89d2\u8272\u8868\uff0c\u548cGLOBAL_PRIVS\u914d\u5408 VERSION \u5b58\u50a8hive\u7684\u7248\u672c\u4fe1\u606f SEQUENCE_TABLE \u5b58\u50a8sqeuence\u76f8\u5173\u4fe1\u606f &gt;&gt;&gt;&gt;&gt;&gt;&gt; 4b6372e71813cbab1fd8bdd80e392779f311c66f"},{"location":"SQLite/SQLite/","title":"\u6982\u8ff0","text":"<p>SQLite \u73b0\u5728\u5df2\u7ecf\u662f\u5168\u7403\u7528\u6237\u6700\u591a\u7684\u6570\u636e\u5e93\u4ea7\u54c1\u3002\u5b83\u975e\u5e38\u5c0f\u5de7\u4ee5\u53ca\u5355\u6587\u4ef6\u65e0\u5355\u72ec\u64cd\u4f5c\u7cfb\u7edf\u8fdb\u7a0b\uff0c\u5c31\u50cf\u75c5\u6bd2\u4e00\u6837\u4f9d\u9644\u5728\u5bbf\u4e3b\u7a0b\u5e8f\u7684\u8fdb\u7a0b\u91cc\u8fd0\u884c\u3002\u4f60\u770b\u4e0d\u5230\u5b83\uff0c\u4f46\u5b83\u5374\u65e0\u5904\u4e0d\u5728\u3002</p> <p>\u6c7d\u8f66\uff0c\u624b\u673a\uff0c\u6d4f\u89c8\u5668\uff0c\u4ee5\u53ca\u5404\u7c7b app \u91cc\u90fd\u80fd\u89c1\u5230 .db \u7ed3\u5c3e\u7684 SQLite \u6570\u636e\u5e93\u6587\u4ef6\u3002 \u5047\u5982 SQLite \u51fa\u73b0\u91cd\u5927 bug\uff0c\u6216\u8005\u50cf\u5e73\u5e38\u7684\u6570\u636e\u5e93\u90a3\u6837\u65e0\u6cd5\u8fde\u63a5\uff0c\u6574\u4e2a\u5730\u7403\u90fd\u4f1a\u4e71\u5957\u3002\u4f60\u8eab\u8fb9\u7528\u7684\u51e0\u4e4e\u6240\u6709\u7535\u5b50\u4ea7\u54c1\uff08\u624b\u673a\uff0c\u7535\u8111\uff0ciPad\uff0c\u7b14\u8bb0\u672c\uff09\u548c\u5d4c\u5165\u5f0f\u8bbe\u5907\u5168\u90e8\u90fd\u4f1a\u51fa\u95ee\u9898\u3002\u5b83\u7684\u8bde\u751f\u5230\u5927\u8303\u56f4\u5168\u7403\u6d41\u884c\u7684\u8fc7\u7a0b\u548c\u4e00\u822c\u8f6f\u4ef6\u6709\u7740\u4e0d\u592a\u4e00\u6837\u7684\u53d1\u5c55\u5386\u7a0b\u3002</p> <p>SQLite \u8bde\u751f\u7684\u5951\u673a\u5c31\u662f\u5178\u578b\u7684\u7a0b\u5e8f\u5458\u5f00\u53d1\u7684\u6545\u4e8b\u5267\u672c\u3002\u4f5c\u8005 Richard \u6700\u5f00\u59cb\u5728\u4e00\u8258\u519b\u8230\u4e0a\u505a contractor\uff08\u5c31\u662f\u6211\u4eec\u8bf4\u7684\u5916\u5305\uff09\u3002\u4ed6\u4eec\u7a0b\u5e8f\u8dd1\u5728\u519b\u8230\u5b89\u88c5\u7684\u7535\u8111\u4e0a\uff0c\u7535\u8111\u4e0a\u88c5\u7684\u662f informix\u3002Richard \u7684\u5de5\u4f5c\u5c31\u662f\u628a informix \u7684\u6570\u636e\u62ff\u51fa\u6765\u8fdb\u884c\u8ba1\u7b97\u7136\u540e\u5c55\u793a\u5230\u7535\u8111\u5c4f\u5e55\u4e0a\uff08\u8fd9\u548c\u6211\u4eec\u4eca\u5929\u7684 CRUD \u5de5\u4f5c\u7c7b\u4f3c\uff09\u3002\u6bd4\u8f83\u4ee4\u4eba\u607c\u706b\u7684\u662f informix \u5f88\u4e0d\u7a33\u5b9a\uff0c\u7ecf\u5e38\u5d29\u6e83\u8fde\u4e0d\u4e0a\u3002\u90e8\u961f\u91cc\u7684\u94c1\u62f3\u957f\u5b98\u53ef\u4e0d\u61c2\u5565 TCP/IP \u6216\u8005\u6570\u636e\u5e93\u7cfb\u7edf\u77e5\u8bc6\u3002\u4ed6\u4eec\u53ea\u770b\u5230\u8f6f\u4ef6\u7684\u62a5\u9519 dialog\uff08\u5bf9\u8bdd\u6846\uff09 \u7ecf\u5e38\u5f39\u51fa\u6765\uff0c\u800c\u8fd9\u4e2a dialog \u53c8\u662f SQLite \u7684\u4f5c\u8005 Richard \u5199\u7684\u8f6f\u4ef6\u753b\u51fa\u6765\u7684\uff0c\u9505\u81ea\u7136\u4ece\u5929\u800c\u964d\u3002\u4e8e\u662f Richard \u51b3\u5b9a\u81ea\u5df1\u4ece\u5934\u5199\u4e00\u4e2a\u65e0\u9700\u5916\u90e8\u8fde\u63a5\u7684\u6570\u636e\u5e93\u6765\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\u3002</p> <p>SQLite \u662f\u4e00\u4e2a C \u5b9e\u73b0\u7684 SQL \u6570\u636e\u5e93\u5f15\u64ce\uff0c\u5b83\u7684\u7279\u70b9\u662f\u5c0f\u578b\u3001\u5feb\u901f\u3001\u81ea\u5305\u542b\u3001\u9ad8\u53ef\u9760\u6027\u548c\u529f\u80fd\u9f50\u5168\u3002SQLite \u5d4c\u5165\u5728\u6240\u6709\u624b\u673a\u548c\u5927\u591a\u6570\u8ba1\u7b97\u673a\u4e2d\uff0c\u4e5f\u6346\u7ed1\u5728\u4e3a\u6570\u4f17\u591a\u7684\u5176\u5b83\u5e94\u7528\u4e2d\uff0c\u662f\u4e16\u754c\u4e0a\u4f7f\u7528\u91cf\u6700\u5927\u7684\u6570\u636e\u5e93\u5f15\u64ce\u3002SQLite\u662f\u4e00\u4e2a\u8fdb\u7a0b\u5185\u7684\u8f7b\u91cf\u7ea7\u5d4c\u5165\u5f0f\u6570\u636e\u5e93\uff0c\u5b83\u7684\u6570\u636e\u5e93\u5c31\u662f\u4e00\u4e2a\u6587\u4ef6\uff0c\u5b9e\u73b0\u4e86\u81ea\u7ed9\u81ea\u8db3\u3001\u65e0\u670d\u52a1\u5668\u3001\u96f6\u914d\u7f6e\u7684\u3001\u4e8b\u52a1\u6027\u7684SQL\u6570\u636e\u5e93\u5f15\u64ce\u3002</p> <p>\u5b83\u662f\u4e00\u4e2a\u96f6\u914d\u7f6e\u7684\u6570\u636e\u5e93\uff0c\u8fd9\u5c31\u4f53\u73b0\u51fa\u6765SQLite\u4e0e\u5176\u4ed6\u6570\u636e\u5e93\u7684\u6700\u5927\u7684\u533a\u522b\uff1aSQLite\u4e0d\u9700\u8981\u5728\u7cfb\u7edf\u4e2d\u914d\u7f6e\uff0c\u76f4\u63a5\u53ef\u4ee5\u4f7f\u7528\u3002\u4e14SQLite\u4e0d\u662f\u4e00\u4e2a\u72ec\u7acb\u7684\u8fdb\u7a0b\uff0c\u53ef\u4ee5\u6309\u5e94\u7528\u7a0b\u5e8f\u9700\u6c42\u8fdb\u884c\u9759\u6001\u6216\u52a8\u6001\u8fde\u63a5\u3002SQLite\u53ef\u76f4\u63a5\u8bbf\u95ee\u5176\u5b58\u50a8\u6587\u4ef6\u3002</p> <p>SQLite \u7ecf\u8fc7 20 \u591a\u5e74\u53d1\u5c55\uff0c\u652f\u6301\u51e0\u4e4e\u6240\u6709\u6570\u636e\u5e93\u529f\u80fd\uff0c\u5e76\u4e14\u80fd\u8dd1\u5728\u51e0\u4e4e\u6240\u6709\u5c0f\u578b\u7684\u5d4c\u5165\u5f0f\u73af\u5883\u91cc\u3002\u5bf9\u8fd9\u4e9b\u5c0f\u578b\u73af\u5883\u9700\u8981\u505a\u7684\u4f18\u5316\u6bd4\u666e\u901a\u6570\u636e\u5e93\u8981\u66f4\u591a\uff0c\u5b9e\u73b0\u8d77\u6765\u8981\u66f4\u590d\u6742\u3002\u60f3\u5b66\u4e60\u6570\u636e\u5e93\u7684\u5b9e\u73b0\u4ece SQLite \u5165\u624b\u5e76\u4e0d\u662f\u4e00\u4e2a\u597d\u7684\u9009\u62e9\u3002\u5b83\u867d\u7136\u8fd0\u884c\u73af\u5883\u548c\u4ee3\u7801\u91cf\u5c0f\u5de7\uff0c\u4f46\u5728\u5de5\u7a0b\u5c42\u9762\u5b9e\u9645\u662f\u4e2a\u5927\u9879\u76ee\uff0c\u80cc\u540e\u8fd8\u6709\u65e0\u6570\u7684\u5355\u5143\u6d4b\u8bd5\u3002\u5b83\u505a\u5230\u4e86\u8f6f\u4ef6\u5f00\u53d1\u7684\u4e00\u4e2a\u975e\u5e38\u96be\u505a\u5230\u7684\u4e8b\u60c5\uff1a100% \u6d4b\u8bd5\u8986\u76d6\u3002\u8fd9\u610f\u5473\u7740\u540e\u7eed\u7684\u4efb\u4f55\u5f00\u53d1\u8fed\u4ee3\u90fd\u80fd\u505a\u5230\u673a\u5668\u81ea\u52a8\u5316\u6d4b\u8bd5\uff0c\u81ea\u52a8\u627e\u51fa\u65b0\u52a0\u5165\u4ee3\u7801\u4ea7\u751f\u7684\u517c\u5bb9\u6027\u95ee\u9898\uff0c\u4e0d\u5f97\u4e0d\u8bf4\u8fd9\u662f\u7a0b\u5e8f\u5458\u68a6\u60f3\u4e2d\u7684\u4ee3\u7801\u8fed\u4ee3\u65b9\u5f0f\u3002SQLite \u4e00\u5f00\u59cb\u5c31\u8bde\u751f\u5728\u5de5\u4e1a\u754c\u5de8\u5934\u516c\u53f8\u7684\u5939\u7f1d\u91cc\u9762\uff0c\u4ece\u6700\u5f00\u59cb\u5b83\u5c31\u662f\u4e00\u4e2a\u5bf9\u8fd0\u884c\u8d28\u91cf\u8981\u6c42\u6781\u9ad8\u7684\u5de5\u4e1a\u8f6f\u4ef6\u3002\u5b83\u770b\u8d77\u6765\u50cf\u4e00\u4e2a\u7cbe\u81f4\u7684\u5c0f\u8f6f\u4ef6\uff0c\u4f46\u7edd\u4e0d\u662f\u4e00\u4e2a\u5c0f\u73a9\u5177\uff0c\u5f53\u5e74\u4ed6\u5408\u4f5c\u7684\u662f\u6469\u6258\u7f57\u62c9\u548c\u8bfa\u57fa\u4e9a\u8fd9\u79cd\u5de8\u5934\u653e\u5728\u4eca\u5929\u4e5f\u662f facebook\uff0cgoogle \u8fd9\u79cd\u4f53\u91cf\u3002\u4ece\u5b83\u6253\u8d25\u8bfa\u57fa\u4e9a\u5185\u90e8 9 \u4e2a\u540c\u7c7b\u4ea7\u54c1\u8fd9\u6bb5\u7ecf\u5386\u6765\u770b\uff0c\u8fd9\u662f\u5f88\u5178\u578b\u7684\u4e00\u4e2a\u5934\u90e8\u8f6f\u4ef6\u8d62\u5bb6\u901a\u5403\u7684\u6848\u4f8b\u3002\u5b83\u662f\u7eaf\u7cb9\u7684\u5546\u4e1a\u9a71\u52a8\u9879\u76ee\uff0c\u5e76\u4e0d\u662f\u5f00\u6e90\u793e\u533a\u7684\u9879\u76ee\uff0c\u5f00\u6e90\u53ea\u662f\u5b83\u5546\u4e1a\u6a21\u5f0f\u7684\u4e00\u90e8\u5206\u3002</p> <p>1.SQlite \u901a\u8fc7\u6587\u4ef6\u6765\u4fdd\u5b58\u6570\u636e\u5e93\uff0c\u4e00\u4e2a\u6587\u4ef6\u5c31\u662f\u4e00\u4e2a\u6570\u636e\u5e93\u3002 2.\u6570\u636e\u5e93\u91cc\u53c8\u5305\u542b\u6570\u4e2a\u8868\u683c\uff1b 3.\u6bcf\u4e2a\u8868\u683c\u91cc\u9762\u5305\u542b\u4e86\u591a\u4e2a\u8bb0\u5f55\uff1b 4.\u6bcf\u4e2a\u8bb0\u5f55\u7531\u591a\u4e2a\u5b57\u6bb5\u7ec4\u6210\uff1b 5.\u6bcf\u4e2a\u5b57\u6bb5\u90fd\u6709\u5176\u5bf9\u5e94\u7684\u503c\uff1b 6.\u6bcf\u4e2a\u503c\u90fd\u53ef\u4ee5\u6307\u5b9a\u7c7b\u578b\uff0c\u5e76\u4e14\u6307\u5b9a\u7ea6\u675f\u3002</p>"},{"location":"SQLite/SQLite/#_2","title":"\u6570\u636e\u7c7b\u578b","text":"<p>\u8bb8\u591aSQL\u6570\u636e\u5e93\u5f15\u64ce\uff08\u9664SQLite\u4e4b\u5916\u7684\u5404\u79cdSQL\u6570\u636e\u5e93\u5f15\u64ce\uff09\u4f7f\u7528\u9759\u6001\u3001\u4e25\u683c\u7684\u6570\u636e\u7c7b\u578b\u3002\u5bf9\u4e8e\u9759\u6001\u7c7b\u578b\uff0c\u4e00\u4e2a\u503c\u7684\u6570\u636e\u7c7b\u578b\u7531\u5b83\u7684\u5bb9\u5668\uff0c\u5373\u5b58\u50a8\u8fd9\u4e2a\u503c\u7684\u5217\u6765\u51b3\u5b9a\u3002</p> <p>SQLite\u5219\u4f7f\u7528\u66f4\u52a0\u901a\u7528\u7684\u52a8\u6001\u7c7b\u578b\u7cfb\u7edf\u3002\u5728<code>SQLite</code>\u4e2d\uff0c\u4e00\u4e2a\u503c\u7684\u6570\u636e\u7c7b\u578b\u88ab\u5173\u8054\u5230\u8fd9\u4e2a\u503c\u672c\u8eab\uff0c\u800c\u4e0d\u662f\u5b83\u7684\u5bb9\u5668\u3002</p> <p>SQLite\u7684\u52a8\u6001\u7c7b\u578b\u7cfb\u7edf\u5411\u540e\u517c\u5bb9\u4e00\u822c\u9759\u6001\u7c7b\u578b\u7cfb\u7edf\u7684\u6570\u636e\u5e93\u5f15\u64ce\u3002\u5728\u67d0\u79cd\u610f\u4e49\u4e0a\uff0c\u5de5\u4f5c\u5728\u9759\u6001\u7c7b\u578b\u6570\u636e\u5e93\u4e0a\u7684SQL\u58f0\u660e\u4e5f\u540c\u6837\u80fd\u5de5\u4f5c\u5728SQLite\u4e0a\u3002</p> <p>\u4f46\u662fSQLite\u52a8\u6001\u7c7b\u578b\u8fd8\u5141\u8bb8\u505a\u4e00\u4e9b\u5728\u4f20\u7edf\u4e25\u683c\u7c7b\u578b\u7684\u6570\u636e\u5e93\u4e2d\u4e0d\u80fd\u505a\u7684\u4e8b\u60c5\u3002</p>"},{"location":"advanced/1.1.3InnoDB%E2%80%94%E2%80%94%E5%B4%A9%E6%BA%83%E6%81%A2%E5%A4%8D/","title":"1.1.3InnoDB\u2014\u2014\u5d29\u6e83\u6062\u590d","text":""},{"location":"advanced/1.1.3InnoDB%E2%80%94%E2%80%94%E5%B4%A9%E6%BA%83%E6%81%A2%E5%A4%8D/#_1","title":"\u6570\u636e\u66f4\u65b0\u6d41\u7a0b","text":"<p>\u5f53\u6211\u4eec\u67e5\u8be2\u6570\u636e\u7684\u65f6\u5019\uff0c\u4f1a\u5148\u53bbBuffer Pool\u4e2d\u67e5\u8be2\u3002\u5982\u679cBuffer Pool\u4e2d\u4e0d\u5b58\u5728\uff0c\u5b58\u50a8\u5f15\u64ce\u4f1a\u5148\u5c06\u6570\u636e\u4ece\u78c1\u76d8\u52a0\u8f7d\u5230Buffer Pool\u4e2d\uff0c\u7136\u540e\u5c06\u6570\u636e\u8fd4\u56de\u7ed9\u5ba2\u6237\u7aef\uff1b</p> <p>\u540c\u7406\uff0c\u5f53\u6211\u4eec\u66f4\u65b0\u67d0\u4e2a\u6570\u636e\u7684\u65f6\u5019\uff0c\u5982\u679c\u8fd9\u4e2a\u6570\u636e\u4e0d\u5b58\u5728\u4e8eBuffer Pool\uff0c\u540c\u6837\u4f1a\u5148\u6570\u636e\u52a0\u8f7d\u8fdb\u6765\uff0c\u7136\u540e\u4fee\u6539\u4fee\u6539\u5185\u5b58\u7684\u6570\u636e\u3002\u88ab\u4fee\u6539\u8fc7\u7684\u6570\u636e\u4f1a\u5728\u4e4b\u540e\u7edf\u4e00\u5237\u5165\u78c1\u76d8\u3002</p> <p>\u5047\u8bbe\u6211\u4eec\u4fee\u6539Buffer Pool\u4e2d\u7684\u6570\u636e\u6210\u529f\uff0c\u4f46\u662f\u8fd8\u6ca1\u6765\u5f97\u53ca\u5c06\u6570\u636e\u5237\u5165\u78c1\u76d8MySQL\u5c31\u6302\u4e86\u600e\u4e48\u529e\uff1f\u6309\u7167\u4e0a\u56fe\u7684\u903b\u8f91\uff0c\u6b64\u65f6\u66f4\u65b0\u4e4b\u540e\u7684\u6570\u636e\u53ea\u5b58\u5728\u4e8eBuffer Pool\u4e2d\uff0c\u5982\u679c\u6b64\u65f6MySQL\u5b95\u673a\u4e86\uff0c\u8fd9\u90e8\u5206\u6570\u636e\u5c06\u4f1a\u6c38\u4e45\u7684\u4e22\u5931\uff1b</p>"},{"location":"advanced/1.1.3InnoDB%E2%80%94%E2%80%94%E5%B4%A9%E6%BA%83%E6%81%A2%E5%A4%8D/#redoundo","title":"redo\u548cundo","text":"<p>MySQL\u80fd\u591f\u5b9e\u73b0\u5d29\u6e83\u6062\u590d\u7684**\u4e8b\u5b9e**\u6765\u770b\uff0cMySQL\u5fc5\u5b9a\u5b9e\u73b0\u4e86\u67d0\u4e9b\u9a9a\u64cd\u4f5c\u3002\u6ca1\u9519\uff0c\u8fd9\u5c31\u662f\u63a5\u4e0b\u6765\u6211\u4eec\u8981\u4ecb\u7ecd\u7684\u53e6\u5916\u7684\u4e24\u4e2a\u5173\u952e\u529f\u80fd\uff0cRedo Log**\u548c**Undo Log\u3002</p> <p>\u8fd9\u4e24\u79cd\u65e5\u5fd7\u662f\u5c5e\u4e8eInnoDB\u5b58\u50a8\u5f15\u64ce\u7684\u65e5\u5fd7\uff0c\u548cMySQL Server\u7684Binlog\u4e0d\u662f\u4e00\u4e2a\u7ef4\u5ea6\u7684\u65e5\u5fd7\u3002</p> <ol> <li>Redo Log \u8bb0\u5f55\u4e86\u6b64\u6b21\u4e8b\u52a1 \u300c\u5b8c\u6210\u540e\u300d \u7684\u6570\u636e\u72b6\u6001\uff0c\u8bb0\u5f55\u7684\u662f\u66f4\u65b0\u4e4b \u300c\u540e\u300d \u7684\u503c</li> <li>Undo Log \u8bb0\u5f55\u4e86\u6b64\u6b21\u4e8b\u52a1 \u300c\u5f00\u59cb\u524d\u300d \u7684\u6570\u636e\u72b6\u6001\uff0c\u8bb0\u5f55\u7684\u662f\u66f4\u65b0\u4e4b \u300c\u524d\u300d \u7684\u503c</li> </ol> <p>\u8fd9\u4e24\u79cd\u65e5\u5fd7\u6709\u660e\u663e\u7684\u533a\u522b\u3002</p> <p>\u66f4\u65b0\u6570\u636e\u8fd8\u662f\u4f1a\u5224\u65ad\u6570\u636e\u662f\u5426\u5b58\u5728\u4e8eBuffer Pool\u4e2d\uff0c\u4e0d\u5b58\u5728\u5219\u52a0\u8f7d\u8fdb\u6765\u3002\u4e0a\u9762\u6211\u4eec\u63d0\u5230\u4e86\u56de\u6eda\u7684\u95ee\u9898\uff0c\u5728\u66f4\u65b0Buffer Pool\u4e2d\u7684\u6570\u636e\u4e4b\u524d\uff0c\u6211\u4eec\u9700\u8981\u5148\u5c06\u8be5\u6570\u636e\u4e8b\u52a1\u5f00\u59cb\u4e4b\u524d\u7684\u72b6\u6001\u5199\u5165Undo Log\u4e2d\u3002\u5047\u8bbe\u66f4\u65b0\u5230\u4e00\u534a\u51fa\u9519\u4e86\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u901a\u8fc7Undo Log\u6765\u56de\u6eda\u5230\u4e8b\u52a1\u5f00\u59cb\u524d\u3002</p> <p>\u7136\u540e\u6267\u884c\u5668\u4f1a\u66f4\u65b0Buffer Pool\u4e2d\u7684\u6570\u636e\uff0c\u6210\u529f\u66f4\u65b0\u540e\u4f1a\u5c06\u6570\u636e\u6700\u65b0\u72b6\u6001\u5199\u5165Redo Log Buffer\u4e2d\u3002\u56e0\u4e3a\u4e00\u4e2a\u4e8b\u52a1\u4e2d\u53ef\u80fd\u6d89\u53ca\u5230\u591a\u6b21\u8bfb\u5199\u64cd\u4f5c\uff0c\u5199\u5165Buffer\u4e2d\u5206\u7ec4\u5199\u5165\uff0c\u6bd4\u8d77\u4e00\u6761\u6761\u7684\u5199\u5165\u78c1\u76d8\u6587\u4ef6\uff0c\u6548\u7387\u4f1a\u9ad8\u5f88\u591a\u3002</p>"},{"location":"advanced/1.1.3InnoDB%E2%80%94%E2%80%94%E5%B4%A9%E6%BA%83%E6%81%A2%E5%A4%8D/#undo","title":"undo","text":"<p>undo log \u662fmysql\u4e2d\u6bd4\u8f83\u91cd\u8981\u7684\u4e8b\u52a1\u65e5\u5fd7\u4e4b\u4e00undo log\u662f\u4e00\u79cd\u7528\u4e8e\u64a4\u9500\u56de\u9000\u7684\u65e5\u5fd7\u3002</p> <p>\u5728\u4e00\u4e2a\u4e8b\u52a1\u6ca1\u63d0\u4ea4\u4e4b\u524d\uff0cMySQL\u4f1a\u5148\u8bb0\u5f55\u66f4\u65b0\u524d\u7684\u6570\u636e\u5230 undo log\u65e5\u5fd7\u6587\u4ef6\u91cc\u9762\uff0c\u5f53\u4e8b\u52a1\u56de\u6eda\u65f6\u6216\u8005\u6570\u636e\u5e93\u5d29\u6e83\u65f6\uff0c\u53ef\u4ee5\u5229\u7528 undo log\u6765\u8fdb\u884c\u56de\u9000\u3002</p> <p>\u5728MySQL\u4e2d\uff0cundo log\u65e5\u5fd7\u7684\u4f5c\u7528\u4e3b\u8981\u6709\u4e24\u4e2a\uff1a</p> <p>1\u3001\u63d0\u4f9b\u56de\u6eda\u64cd\u4f5c\u3010undo log\u5b9e\u73b0\u4e8b\u52a1\u7684\u539f\u5b50\u6027\u3011</p> <p>\u5728\u8bbe\u8ba1DB\u65f6\uff0c\u6211\u4eec\u5047\u8bbe\u6570\u636e\u5e93\u53ef\u80fd\u5728\u4efb\u4f55\u65f6\u523b\uff0c\u7531\u4e8e\u5982\u786c\u4ef6\u6545\u969c\uff0c\u8f6f\u4ef6Bug\uff0c\u8fd0\u7ef4\u64cd\u4f5c\u7b49\u539f\u56e0\u7a81\u7136\u5d29\u6e83\u3002</p> <p>\u8fd9\u4e2a\u65f6\u5019\u5c1a\u672a\u5b8c\u6210\u63d0\u4ea4\u7684\u4e8b\u52a1\u53ef\u80fd\u5df2\u7ecf\u6709\u90e8\u5206\u6570\u636e\u5199\u5165\u4e86\u78c1\u76d8\uff0c\u5982\u679c\u4e0d\u52a0\u5904\u7406\uff0c\u4f1a\u8fdd\u53cd\u6570\u636e\u5e93\u5bf9Atomic\u7684\u4fdd\u8bc1\uff0c\u4e5f\u5c31\u662f\u4efb\u4f55\u4e8b\u52a1\u7684\u4fee\u6539\u8981\u4e48\u5168\u90e8\u63d0\u4ea4\uff0c\u8981\u4e48\u5168\u90e8\u53d6\u6d88\u3002</p> <p>\u9488\u5bf9\u8fd9\u4e2a\u95ee\u9898\uff0c\u76f4\u89c2\u7684\u60f3\u6cd5\u662f\u7b49\u5230\u4e8b\u52a1\u771f\u6b63\u63d0\u4ea4\u65f6\uff0c\u624d\u80fd\u5141\u8bb8\u8fd9\u4e2a\u4e8b\u52a1\u7684\u4efb\u4f55\u4fee\u6539\u843d\u76d8\uff0c\u4e5f\u5c31\u662fNo-Steal\u7b56\u7565\u3002\u663e\u800c\u6613\u89c1\uff0c\u8fd9\u79cd\u505a\u6cd5\u4e00\u65b9\u9762\u9020\u6210\u5f88\u5927\u7684\u5185\u5b58\u7a7a\u95f4\u538b\u529b\uff0c\u53e6\u4e00\u65b9\u9762\u63d0\u4ea4\u65f6\u7684\u5927\u91cf\u968f\u673aIO\u4f1a\u6781\u5927\u7684\u5f71\u54cd\u6027\u80fd\u3002</p> <p>\u56e0\u6b64\uff0c\u6570\u636e\u5e93\u5b9e\u73b0\u4e2d\u901a\u5e38\u4f1a\u5728\u6b63\u5e38\u4e8b\u52a1\u8fdb\u884c\u4e2d\uff0c\u5c31\u4e0d\u65ad\u7684\u8fde\u7eed\u5199\u5165Undo Log\uff0c\u6765\u8bb0\u5f55\u672c\u6b21\u4fee\u6539\u4e4b\u524d\u7684\u5386\u53f2\u503c\u3002</p> <p>\u5f53Crash\u771f\u6b63\u53d1\u751f\u65f6\uff0c\u53ef\u4ee5\u5728Recovery\u8fc7\u7a0b\u4e2d\u901a\u8fc7\u56de\u653eUndo Log\u5c06\u672a\u63d0\u4ea4\u4e8b\u52a1\u7684\u4fee\u6539\u62b9\u6389\u3002InnoDB\u91c7\u7528\u7684\u5c31\u662f\u8fd9\u79cd\u65b9\u5f0f\u3002</p> <p>\u6211\u4eec\u5728\u8fdb\u884c\u6570\u636e\u66f4\u65b0\u64cd\u4f5c\u7684\u65f6\u5019\uff0c\u4e0d\u4ec5\u4f1a\u8bb0\u5f55redo log\uff0c\u8fd8\u4f1a\u8bb0\u5f55undo log\uff0c\u5982\u679c\u56e0\u4e3a\u67d0\u4e9b\u539f\u56e0\u5bfc\u81f4\u4e8b\u52a1\u56de\u6eda\uff0c\u90a3\u4e48\u8fd9\u4e2a\u65f6\u5019MySQL\u5c31\u8981\u6267\u884c\u56de\u6eda\uff08rollback\uff09\u64cd\u4f5c\uff0c\u5229\u7528undo log\u5c06\u6570\u636e\u6062\u590d\u5230\u4e8b\u52a1\u5f00\u59cb\u4e4b\u524d\u7684\u72b6\u6001\u3002</p> <p>\u4f8b\u5982\u5982\u6211\u4eec\u6267\u884c\u4e0b\u9762\u4e00\u6761\u5220\u9664\u8bed\u53e5\uff1a</p> <pre><code>delete from user where id = 1;\n</code></pre> <p>\u90a3\u4e48\u6b64\u65f6undo log\u4f1a\u8bb0\u5f55\u4e00\u6761\u5bf9\u5e94\u7684insert \u8bed\u53e5\u3010\u53cd\u5411\u64cd\u4f5c\u7684\u8bed\u53e5\u3011\uff0c\u4ee5\u4fdd\u8bc1\u5728\u4e8b\u52a1\u56de\u6eda\u65f6\uff0c\u5c06\u6570\u636e\u8fd8\u539f\u56de\u53bb\u3002</p> <p>\u5982\u679c\u8fd9\u4e2a\u4fee\u6539\u51fa\u73b0\u5f02\u5e38\uff0c\u53ef\u4ee5\u4f7f\u7528undo log\u65e5\u5fd7\u6765\u5b9e\u73b0\u56de\u6eda\u64cd\u4f5c\uff0c\u4ee5\u4fdd\u8bc1\u4e8b\u52a1\u7684\u4e00\u81f4\u6027\u3002</p> <p>2\u3001MVCC\uff0c\u5373\u591a\u7248\u672c\u63a7\u5236\u3002\u5728MySQL\u6570\u636e\u5e93InnoDB\u5b58\u50a8\u5f15\u64ce\u4e2d\uff0c\u7528undo Log\u6765\u5b9e\u73b0\u591a\u7248\u672c\u5e76\u53d1\u63a7\u5236(MVCC)\u3002\u5f53\u8bfb\u53d6\u7684\u67d0\u4e00\u884c\u88ab\u5176\u4ed6\u4e8b\u52a1\u9501\u5b9a\u65f6\uff0c\u5b83\u53ef\u4ee5\u4eceundo log\u4e2d\u5206\u6790\u51fa\u8be5\u884c\u8bb0\u5f55\u4ee5\u524d\u7684\u6570\u636e\u7248\u672c\u662f\u600e\u6837\u7684\uff0c\u4ece\u800c\u8ba9\u7528\u6237\u80fd\u591f\u8bfb\u53d6\u5230\u5f53\u524d\u4e8b\u52a1\u64cd\u4f5c\u4e4b\u524d\u7684\u6570\u636e\u3010\u5feb\u7167\u8bfb\u3011\u3002</p> <p>\u4e0b\u9762\u89e3\u91ca\u4e00\u4e0b\u4ec0\u4e48\u662f\u5feb\u7167\u8bfb\uff0c\u4e0e\u4e4b\u5bf9\u5e94\u7684\u8fd8\u6709\u4e00\u4e2a\u662f---\u5f53\u524d\u8bfb\u3002</p> <p>\u5feb\u7167\u8bfb\uff1a</p> <p>SQL\u8bfb\u53d6\u7684\u6570\u636e\u662f\u5feb\u7167\u7248\u672c\u3010\u53ef\u89c1\u7248\u672c\u3011\uff0c\u4e5f\u5c31\u662f\u5386\u53f2\u7248\u672c\uff0c\u4e0d\u7528\u52a0\u9501\uff0c\u666e\u901a\u7684SELECT\u5c31\u662f\u5feb\u7167\u8bfb\u3002</p> <p>\u5f53\u524d\u8bfb\uff1a</p> <p>SQL\u8bfb\u53d6\u7684\u6570\u636e\u662f\u6700\u65b0\u7248\u672c\u3002\u901a\u8fc7\u9501\u673a\u5236\u6765\u4fdd\u8bc1\u8bfb\u53d6\u7684\u6570\u636e\u65e0\u6cd5\u901a\u8fc7\u5176\u4ed6\u4e8b\u52a1\u8fdb\u884c\u4fee\u6539UPDATE\u3001DELETE\u3001INSERT\u3001SELECT \u2026 LOCK IN SHARE MODE\u3001SELECT \u2026 FOR UPDATE\u90fd\u662f\u5f53\u524d\u8bfb\u3002</p>"},{"location":"advanced/1.1.3InnoDB%E2%80%94%E2%80%94%E5%B4%A9%E6%BA%83%E6%81%A2%E5%A4%8D/#undo_1","title":"undo\u8868\u7a7a\u95f4\u548c\u5b58\u50a8\u673a\u5236","text":"<p>\u6240\u8c13\u8868\u7a7a\u95f4\u5176\u5b9e\u662f\u771f\u5b9e\u5b58\u5728\u4e8e\u78c1\u76d8\u4e0a\u7684\u6570\u636e\u6587\u4ef6\u3002\u800c\u8fd9\u91cc\u7684\u6240\u8bf4\u7684 undolog\u8868\u7a7a\u95f4 \u5176\u5b9e\u5c31\u662f\u78c1\u76d8\u4e0a\u4e13\u95e8\u5b58\u653e undolog \u7684\u6587\u4ef6\u3002</p> <p>\u5728MySQL5.5\u4ee5\u53ca\u4e4b\u524d\uff0cInnoDB\u7684undo log\u4e5f\u662f\u5b58\u653e\u5728 ibdata1 \u91cc\u9762\u7684\u3002\u4e00\u65e6\u51fa\u73b0\u5927\u4e8b\u52a1\uff0c\u8fd9\u4e2a\u5927\u4e8b\u52a1\u6240\u4f7f\u7528\u7684undolog\u5360\u7528\u7684\u7a7a\u95f4\u5c31\u4f1a\u4e00\u76f4\u5728ibdata1\u91cc\u9762\u5b58\u5728\uff0c\u5373\u4f7f\u8fd9\u4e2a\u4e8b\u52a1\u5df2\u7ecf\u5173\u95ed\u3002</p> <p>MySQL\u4ece8.0\u5f00\u59cbundo \u8868\u7a7a\u95f4\u7ba1\u7406\u5df2\u7ecf\u53d1\u751f\u4e86\u6539\u53d8\uff0c\u57285.7\u7248\u672c\u4e2d\u4e00\u65e6MySQL\u521d\u59cb\u5316\u4ee5\u540e\uff0c\u5c31\u4e0d\u80fd\u518d\u6539\u53d8undo\u8868\u7a7a\u95f4\u4e86\u3002</p> <p>\u6240\u4ee5\u6211\u4eec\u57285.7\u7248\u672c\u4e2d\u90fd\u662f\u5728\u521d\u59cb\u5316\u7684\u65f6\u5019\u5bf9undo\u8868\u7a7a\u95f4\u8fdb\u884c\u4e00\u4e9b\u8bbe\u7f6e\uff0c\u7c7b\u4f3c\u8fd9\u6837\uff1a\u5728my.cnf\u6587\u4ef6\u4e2d\u52a0\u5165innodb_undo_directory= /data/mysql/undologs \u548c innodb_undo_tablespaces=5 \u8fd9\u4e24\u4e2a\u53c2\u6570\u3002</p> <p>\u4e4b\u6240\u4ee5\u8fd9\u4e48\u6539\uff0c\u662f\u56e0\u4e3a\u6211\u4eec\u60f3\u628aundo\u8868\u7a7a\u5355\u72ec\u4ece\u7cfb\u7edf\u8868\u7a7a\u95f4idbdata\u4e2d\u5206\u79bb\u51fa\u6765\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u6d88\u9664\u56e0undo\u7684\u95ee\u9898\u9020\u6210\u5bf9ibdata\u7cfb\u7edf\u8868\u7a7a\u95f4\u7684\u5f71\u54cd\u3002</p> <p>\u6240\u4ee5\u4e0a\u9762\u7684\u53c2\u6570\u914d\u7f6e\u57285.7\u7248\u672c\u4e2d\u662f\u6211\u4eec\u5bf9MySQL\u521d\u59cb\u5316\u505a\u7684\u4e00\u4e2a\u5e38\u89c4\u7684\u6700\u4f73\u5b9e\u8df5\u8bbe\u7f6e\uff0c\u5982\u679c\u4e0d\u8bbe\u7f6e\uff0c\u90a3\u4e48\u57285.7\u7248\u672c\u4e2d\uff0cundo\u8fd8\u662f\u9ed8\u8ba4\u4f1a\u653e\u5728ibdata\u4e2d\u3002</p> <p>\u4eceMySQL8.0\u7248\u672c\u5f00\u59cb\uff0cMySQL\u9ed8\u8ba4\u5bf9undo\u8fdb\u884c\u4e86\u5206\u79bb\u64cd\u4f5c\uff0c\u4f7f\u7528\u9ed8\u8ba4\u914d\u7f6e\u521d\u59cb\u5316\u65f6\uff0c\u5c31\u4f1a\u5728datadir\u76ee\u5f55\u4e0b\u751f\u6210\u4e24\u4e2a10MiB\u5927\u5c0f\u7684undo\u8868\u7a7a\u95f4\u6587\u4ef6undo_001 \u548c undo002 </p> <p>\u9ed8\u8ba4\u81f3\u5c11\u521d\u59cb\u53162\u4e2aUndo\u8868\u7a7a\u95f4\uff0c\u6700\u5927\u652f\u6301127\u4e2aUndo\u8868\u7a7a\u95f4\uff0c\u9ed8\u8ba4\u8868\u7a7a\u95f4\u540d\u79f0\u4e3aundo_001\uff0cundo_002</p> <p>\u56e0\u4e3a\u5927\u4e8b\u52a1\u53ef\u80fd\u4f1a\u5bfc\u81f4\u5355\u4e2aundo\u6587\u4ef6\u53d8\u7684\u5f88\u5927\uff0c\u521b\u5efa\u989d\u5916\u7684\u8868\u7a7a\u95f4\u6587\u4ef6\u53ef\u4ee5\u907f\u514d\u8fd9\u4e2a\u6587\u4ef6\uff0c8.0.14 \u4e4b\u540eUNDO\u8868\u7a7a\u95f4\u652f\u6301**\u5728\u7ebf\u6269\u7f29\u5bb9**</p> <pre><code>CREATE UNDO TABLESPACE tablespace_name ADD DATAFILE 'file_name.ibu';\n-- \u4e0d\u652f\u6301\u6307\u5b9a\u76f8\u5bf9\u8def\u5f84,\u53ea\u652f\u6301\u7edd\u5bf9\u8def\u5f84,\u4e14\u5fc5\u987b\u662finnodb_directories\u53c2\u6570\u5b9a\u4e49\u53ef\u8bc6\u522b\u7684\u8def\u5f84\u6216\u9ed8\u8ba4\u7684\u6570\u636e\u76ee\u5f55\u4e0b\n</code></pre> <ul> <li> <ul> <li>\u4e0d\u652f\u6301\u6307\u5b9a\u76f8\u5bf9\u8def\u5f84,\u53ea\u652f\u6301\u7edd\u5bf9\u8def\u5f84,\u4e14\u5fc5\u987b\u662f<code>innodb_directories</code>\u53c2\u6570\u5b9a\u4e49\u53ef\u8bc6\u522b\u7684\u8def\u5f84\u6216\u9ed8\u8ba4\u7684\u6570\u636e\u76ee\u5f55\u4e0b</li> </ul> </li> <li>\u52a8\u6001\u521b\u5efa\u7684undo\u8868\u7a7a\u95f4\u5fc5\u987b\u4ee5.ibu\u7ed3\u5c3e</li> </ul> <pre><code># 8.0.23\u4e4b\u524d\uff0cundo\u521d\u59cb\u5316\u5927\u5c0f\u4f9d\u8d56\u4e8einoodb_page_size\uff0c\u5bf9\u4e8e\u9ed8\u8ba4\u768416KB\u7684\u9875\uff0cundo\u9ed8\u8ba4\u662f10MiB\n</code></pre> <pre><code># \n\nmysql&gt; show VARIABLES like '%undo%';\n+--------------------------+------------+\n| Variable_name            | Value      |\n+--------------------------+------------+\n| innodb_max_undo_log_size | 1073741824 |\n| innodb_undo_directory    | ./         |\n| innodb_undo_log_encrypt  | OFF        |\n| innodb_undo_log_truncate | ON         |\n| innodb_undo_tablespaces  | 2          |\n+--------------------------+------------+\n5 rows in set (0.01 sec)\n\nmysql&gt;\n\n\nshow variables like '%undo%';\n+--------------------------+------------+\n| Variable_name            | Value      |\n+--------------------------+------------+\n| innodb_max_undo_log_size | 8589934592 |   \n| innodb_undo_directory    | ./         |  \n| innodb_undo_log_encrypt  | OFF        |\n| innodb_undo_log_truncate | ON         |\n| innodb_undo_tablespaces  | 2          |\n+--------------------------+------------+\n\nshow variables like '%truncate%';\n+--------------------------------------+-------+\n| Variable_name                        | Value |\n+--------------------------------------+-------+\n| innodb_purge_rseg_truncate_frequency | 128   |\n| innodb_undo_log_truncate             | ON    |\n+--------------------------------------+-------+\n\nshow variables like '%segment%';\n+-------------------------------+-----------+\n| Variable_name                 | Value     |\n+-------------------------------+-----------+\n| innodb_rollback_segments      | 128       |\n| innodb_segment_reserve_factor | 12.500000 |\n+-------------------------------+-----------+\n\ninnodb_undo_log_truncate    --\u63a7\u5236\u662f\u5426\u81ea\u52a8\u505aUNDO\u7684truncate\u6536\u7f29\u64cd\u4f5c\uff0c\u9ed8\u8ba4\u4e3aON\uff0c\u53ea\u6709\u4e3aON\u65f6\uff0c\u4e0b\u97622\u4e2a\u53c2\u6570\u624d\u751f\u6548\ninnodb_max_undo_log_size    --\u63a7\u5236UNDO\u505atruncate\u6536\u7f29\u64cd\u4f5c\u7684\u9608\u503c,\u5f53UNDO\u8fbe\u5230\u8be5\u503c\u65f6\u624d\u51fa\u53d1\u6536\u7f29\u64cd\u4f5c\ninnodb_purge_rseg_truncate_frequency \n        -- Batch UNDO\u6e05\u7406\u7684\u6b21\u6570,\u9ed8\u8ba4\u6700\u5927\u503c128,\u4e5f\u5c31\u662f128\u6b21\u540e\u624d\u4f1a\u89e6\u53d1\u4e00\u6b21UNDO\u7684truncate,\u800c\u6bcf\u6b21\u6e05\u7406\u7684undo page\u7531innodb_purge_batch_size\u53c2\u6570\u51b3\u5b9a,innodb_purge_batch_size\u9ed8\u8ba4\u4e3a300,\u4e5f\u5c31\u662f300*128\u4e2aUNDO\u5c0f\u6279\u6b21\u6e05\u7406\u540e\u624d\u4f1a\u89e6\u53d1UNDO\u8868\u7a7a\u95f4\u7684truncate(\u4e5f\u5c31\u662fUNDO\u8868\u7a7a\u95f4\u7684\u6536\u7f29)\u64cd\u4f5c\n\ninnodb_undo_tablespaces\n-- \u63a7\u5236\u751f\u6210\u7684UNDO\u8868\u7a7a\u95f4\u7684\u6570\u91cf,\u9ed8\u8ba42\u4e2a,\u57288.0\u5bf9\u8be5\u53c2\u6570\u505a\u4e86\u5e9f\u5f03,\u4f46\u5e76\u672a\u63d0\u4f9b\u5176\u4ed6\u53c2\u6570\u63a7\u5236UNDO\u6570\u91cf,\u5f53\u524d\u4f9d\u65e7\u53ef\u4ee5\u4f7f\u7528\u8be5\u53c2\u6570\u505aUNDO\u8868\u7a7a\u95f4\u6570\u91cf\u914d\u7f6e,\u901a\u5e38\u5efa\u8bae\u914d\u7f6e\u4e3a3(\u624b\u5de5\u6536\u7f29UNDO\u65f6\u9700\u8981\u81f3\u5c113\u4e2aUNDO\u8868\u7a7a\u95f4)\n\ninnodb_rollback_segments            -- UNDO\u8868\u7a7a\u95f4\u56de\u6eda\u6bb5\u7684\u6570\u91cf,\u9ed8\u8ba4\u4e3a\u6700\u5927\u503c128\n</code></pre>"},{"location":"advanced/1.1.3InnoDB%E2%80%94%E2%80%94%E5%B4%A9%E6%BA%83%E6%81%A2%E5%A4%8D/#undo_2","title":"UNDO \u8868\u7a7a\u95f4\u8fd0\u7ef4","text":"<pre><code>-- \u53ef\u4ee5\u67e5\u770b\u5230undo\u7684\u8868\u7a7a\u95f4\u540d\u79f0/\u6587\u4ef6\u8def\u5f84/\u521d\u59cb\u5927\u5c0f/\u6269\u5c55\u5927\u5c0f/\u78c1\u76d8\u6587\u4ef6\u5927\u5c0f/\u53ef\u7528\u7a7a\u95f4\u53ca\u662f\u5426\u542f\u7528\u7684\u72b6\u6001\u7b49\nSELECT T1.SPACE AS SPACE_ID,\n       T1.NAME AS TABLESPACE_NAME,\n       T2.FILE_NAME,\n       ROUND(T2.INITIAL_SIZE / 1024 / 1024, 2) AS \"INITIAL_SIZE(M)\",\n       ROUND(T2.AUTOEXTEND_SIZE / 1024 / 1024, 2) AS \"AUTOEXTEND_SIZE(M)\",\n       ROUND(T1.FILE_SIZE / 1024 / 1024, 2) AS \"FILE_SIZE_DISK(M)\",\n       ROUND(T2.DATA_FREE / 1024 / 1024, 2) AS \"DATA_FREE(M)\",\n       T2.STATUS,\n       T1.STATE\n  FROM INFORMATION_SCHEMA.INNODB_TABLESPACES T1,\n       INFORMATION_SCHEMA.FILES              T2\n WHERE T1.SPACE = T2.FILE_ID\n   AND T1.ROW_FORMAT = 'Undo';\n\n\n\n\n\n-- \u521b\u5efa\u4e00\u4e2a\u65b0\u7684UNDO\u8868\u7a7a\u95f4\nCREATE UNDO TABLESPACE undo_004 ADD DATAFILE 'undo_004.ibu';\n\n-- \u53ef\u4ee5\u7528\u524d\u9762\u7684\u547d\u4ee4\u67e5\u770b\u521b\u5efa\u540e\u7684\u72b6\u6001\n\n-- \u53ef\u4ee5\u5c06\u5df2\u6709\u7684UNDO\u8868\u793a\u4e3ainactive(\u4e5f\u53ef\u7406\u89e3\u4e3aUNDO\u8868\u7a7a\u95f4\u6536\u7f29)\n-- PS:\u8bbe\u7f6e\u4e3aINACTIVE\u7684\u8868\u7a7a\u95f4\u7684STATE\u4e3aempty,\u8868\u793a\u8fd9\u4e2a\u8868\u7a7a\u95f4\u4e0d\u5305\u542b\u4efb\u4f55\u4e8b\u52a1\u56de\u6eda\u6570\u636e,\u4e14\u8868\u7a7a\u95f4\u4e5f\u6536\u7f29\u4e3a\u9ed8\u8ba4\u5927\u5c0f\nALTER UNDO TABLESPACE undo_003 SET INACTIVE;\n\n-- \u53ef\u4ee5\u5c06inactive\u7684UNDO\u8f6c\u4e3aactive\nALTER UNDO TABLESPACE innodb_undo_001 SET ACTIVE;\n\n-- \u53ef\u4ee5\u5c06inactive\u7684UNDO\u8868\u7a7a\u95f4\u8fdb\u884c\u5220\u9664\n-- PS:\u9ed8\u8ba4\u4ee5innodb_\u5f00\u5934\u521d\u59cb\u5316\u7684undo\u8868\u7a7a\u95f4\u4e0d\u53ef\u88ab\u5220\u9664\nDROP UNDO TABLESPACE innodb_undo_001;\nERROR: 3119 (42000): InnoDB: Tablespace names starting with `innodb_` are reserved.\n\n-- \u975e\u7cfb\u7edf\u9ed8\u8ba4\u7684UNDO\u5728inactive\u540e\u53ef\u88ab\u5220\u9664\nALTER UNDO TABLESPACE undo_003 SET ACTIVE;\nQuery OK, 0 rows affected (0.0030 sec)\n</code></pre>"},{"location":"advanced/1.1.3InnoDB%E2%80%94%E2%80%94%E5%B4%A9%E6%BA%83%E6%81%A2%E5%A4%8D/#undo-inactivetruncate","title":"\u5f71\u54cdUNDO inactive(truncate)\u6027\u80fd\u7684\u56e0\u7d20","text":"<ul> <li>UNDO \u8868\u7a7a\u95f4\u7684\u5927\u5c0f</li> <li>UNDO \u8868\u7a7a\u95f4\u7684\u6570\u91cf</li> <li>UNDO LOGS\u7684\u6570\u91cf(\u5b9e\u9645INSERT/UPDATE/DELETE\u8fd9\u7c7b\u4e8b\u52a1\u56de\u6eda\u6bb5\u7684\u6570\u636e\u91cf)</li> <li>\u78c1\u76d8IO\u7684\u80fd\u529b/\u5f53\u524d\u7cfb\u7edf\u7684\u8d1f\u8f7d</li> <li>\u662f\u5426\u5b58\u5728\u957f\u4e8b\u52a1\u5728\u4f7f\u7528\u8be5UNDO\u8868\u7a7a\u95f4</li> </ul> <p>PS:\u901a\u5e38\u5bf9\u8868\u7a7a\u95f4\u505a\u6536\u7f29\u524d\u6700\u7b80\u5355\u907f\u514d\u6027\u80fd\u7684\u65b9\u5f0f\u662f\u63d0\u524d\u521b\u5efa\u4e00\u4e2aUNDO\u8868\u7a7a\u95f4,\u6536\u7f29\u5b8c\u540e\u518d\u5220\u9664\u6216\u4e00\u76f4\u4fdd\u7559\u5747\u53ef</p>"},{"location":"advanced/1.2.1.Innodb%E2%80%94%E2%80%94%E5%8F%8C%E5%86%99%E7%BC%93%E5%86%B2%E5%8C%BADoublewriteBuffer/","title":"Doublewrite\u67b6\u6784","text":"<p>Doublewrite Buffer\u88abMySQL\u653e\u5728\u5b98\u65b9\u6587\u6863\u76ee\u5f55\u7684 \"InnoDB On-Disk Structures\" \u4e2d\u4e86\uff0c\u4f46\u771f\u5b9e\u60c5\u51b5\u662fDoublewrite Buffer\u662f\u5185\u5b58+\u78c1\u76d8\u7684\u7ed3\u6784\u3002</p>"},{"location":"advanced/1.2.1.Innodb%E2%80%94%E2%80%94%E5%8F%8C%E5%86%99%E7%BC%93%E5%86%B2%E5%8C%BADoublewriteBuffer/#_1","title":"\u80cc\u666f","text":"<p>\u64cd\u4f5c\u7cfb\u7edf\u53ef\u4ee5\u770b\u6210\u662f\u4e00\u4e2a\u7a0b\u5e8f\uff0c\u4f5c\u4e3a\u7a0b\u5e8f\u800c\u8a00\uff0c\u90fd\u6709\u6700\u5c0f\u5904\u7406\u5355\u4f4d\u7684\u8bf4\u6cd5\uff0c\u6211\u4eec\u5e38\u89c1\u7684\u670d\u52a1\u5668\u4e00\u822c\u90fd\u662fLinux\u64cd\u4f5c\u7cfb\u7edf\uff0c\u5bf9\u5e94\u6587\u4ef6\u7cfb\u7edf\u7684\u9875\uff08OS Page\uff09\u5c31\u53ef\u4ee5\u770b\u6210\u662fLinux\u64cd\u4f5c\u7cfb\u7edf\u4e0e\u6587\u4ef6\u7cfb\u7edf\u4ea4\u4e92\u7684\u6700\u5c0f\u5355\u4f4d\u3002</p> <p>\u4e00\u822c\u60c5\u51b5\u4e0b\uff0c\u9664\u4e86\u64cd\u4f5c\u7cfb\u7edf\u7684\u9875\uff08OS Page\uff09\u4e3a4KB\u4e4b\u5916\uff0c\u5176\u4f59\u7a0b\u5e8f\u7684\u9875\uff08Page\uff09\u90fd\u4f1a\u5927\u4e8e\u7b49\u4e8e\u64cd\u4f5c\u7cfb\u7edf\u7684\u9875\u5927\u5c0f\uff0c\u6bd4\u5982\uff0cOracle\u7684Page\u5927\u5c0f\u4e3a8KB\u3002</p> <p>MySQL\u7684Page\u5927\u5c0f\u4e5f\u53ef\u4ee5\u901a\u8fc7\u4e0a\u9762innodb_page_size\u53c2\u6570\u6307\u5b9a\uff0c\u5177\u4f53\u60c5\u51b5\u5982\u4e0b\uff1a</p> <ul> <li>&lt;5.6\u7248\u672c\u65f6\uff0c\u4e0d\u53ef\u8c03\u6574\uff1b</li> <li>5.6\u7248\u672c\u65f6\uff0c\u53ef\u81ea\u5b9a\u4e49\u4e3a8KB\u30014KB\uff0c\u4f46\u4e0d\u80fd\u8c03\u5927\u3010\u8c03\u5c0f\u662f\u4e3a\u4e86\u8c03\u9ad8\u6570\u636e\u5bf9\u9f50\u6982\u7387\u3011\uff1b</li> <li>5.7\u4ee5\u4e0a\uff0c\u624d\u53ef\u4ee5\u6539\u621032KB\u300164KB\u3010\u4e14\u6700\u597d\u8bbe\u7f6e\u6210\u9ed8\u8ba4\u503c16KB\u7684\u6574\u6570\u500d\uff0c\u8fd9\u662f\u5168\u5c40\u9009\u9879\uff0c\u65e0\u6cd5\u5728MySQL\u8fd0\u884c\u8fc7\u7a0b\u4e2d\u52a8\u6001\u4fee\u6539\u3011\u3002</li> </ul> <p>\u8bf4\u4e86\u8fd9\u4e48\u591a\uff0c\u5176\u5b9e\u5927\u591a\u6570\u60c5\u51b5\u4e00\u822c\u90fd\u4e0d\u7528\u4fee\u6539\uff0c\u4f7f\u7528\u9ed8\u8ba4\u503c\u5373\u53ef\u3002</p> <p>\u6709\u70b9\u626f\u8fdc\u4e86\u3002\u6211\u4eec\u77e5\u9053\u64cd\u4f5c\u7cfb\u7edf\u7684\u9875\u5927\u5c0f\u548cMySQL\u7684\u9875\u5927\u5c0f\u4e86\uff0c\u800c\u4e14MySQL\u7a0b\u5e8f\u662f\u8dd1\u5728Linux\u64cd\u4f5c\u7cfb\u7edf\u4e0a\u7684\uff0c\u6240\u4ee5\u53ef\u4ee5\u5f97\u51fa\u5982\u4e0b\u7ed3\u8bba\uff1a</p> <p>MySQL\u5c06Buffer Pool\u4e2d\u4e00\u4e2a\u6570\u636e\u9875\u5237\u5165\u78c1\u76d8\uff0c\u8981\u51994\u4e2a\u6587\u4ef6\u7cfb\u7edf\u91cc\u7684\u9875\uff08\u4e5f\u53ef\u4ee5\u8bf4\u6210\u4e00\u4e2aMySQL\u6570\u636e\u9875\u6620\u5c044\u4e2a\u7cfb\u7edf\u9875\uff09</p> <p>\u5f53\u6570\u636e\u5e93\u5c06\u810f\u9875\uff08\u4fee\u6539\u8fc7\u7684\u9875\uff09\u4ece\u7f13\u51b2\u6c60\uff08Buffer Pool\uff09\u5237\u65b0\u5230\u78c1\u76d8\u65f6\uff0c\u53ef\u80fd\u4f1a\u56e0\u4e3a\u4ee5\u4e0b\u539f\u56e0\u5bfc\u81f4\u6570\u636e\u9875\u635f\u574f\uff1a</p> <ul> <li>\u90e8\u5206\u5199\u5165 \uff1a\u64cd\u4f5c\u7cfb\u7edf\u6216\u78c1\u76d8\u63a7\u5236\u5668\u5728\u5199\u5165\u8fc7\u7a0b\u4e2d\u53d1\u751f\u6545\u969c\uff08\u5982\u65ad\u7535\u3001\u5d29\u6e83\u7b49\uff09\uff0c\u5bfc\u81f4\u6570\u636e\u9875\u672a\u5b8c\u5168\u5199\u5165\u78c1\u76d8\u3002</li> <li>\u4e0d\u4e00\u81f4\u72b6\u6001 \uff1a\u6570\u636e\u9875\u53ea\u5199\u4e86\u4e00\u90e8\u5206\uff0c\u5bfc\u81f4\u9875\u5185\u5bb9\u4e0d\u5b8c\u6574\u6216\u635f\u574f\u3002</li> </ul>"},{"location":"advanced/1.2.1.Innodb%E2%80%94%E2%80%94%E5%8F%8C%E5%86%99%E7%BC%93%E5%86%B2%E5%8C%BADoublewriteBuffer/#doublewrite_1","title":"Doublewrite\u89e3\u51b3\u4e86\u4ec0\u4e48\u95ee\u9898\uff1f","text":"<p>\u4e3a\u4e86\u89e3\u51b3**\u90e8\u5206\u9875\u9762\u5199\u5165**\u95ee\u9898(Partial Page Write)\u3002</p> <p>MySQL\u5199\u5165\u4fee\u6539\u65f6\u5237\u65b0\u6574\u4e2a\u9875\u9762(\u9ed8\u8ba416KB)\uff0c\u800c\u4e0d\u4ec5\u4ec5\u662f\u5237\u65b0\u9875\u9762\u4e2d\u5df2\u66f4\u6539\u7684\u8bb0\u5f55\u3002</p> <p>\u800c\u64cd\u4f5c\u7cfb\u7edf\u7684\u5355\u6b21io\uff0c\u4e00\u822c\u662f512byte\u4e3a\u5355\u4f4d\u7684\u3002\u5728\u65ad\u7535\uff0cOS crash(\u64cd\u4f5c\u7cfb\u7edf\u5d29\u6e83)\u60c5\u51b5\u4e0b\u53ef\u80fd\u4f1a\u4e22\u5931\u6570\u636e\u3002</p>"},{"location":"advanced/1.2.1.Innodb%E2%80%94%E2%80%94%E5%8F%8C%E5%86%99%E7%BC%93%E5%86%B2%E5%8C%BADoublewriteBuffer/#doublewrite_2","title":"Doublewrite\u662f\u6307\u54ea\u4e24\u6b21\u5199\u5165\uff1f","text":"<ol> <li>\u5199Doublewrite buffer\uff0c\u6ce8\u610f: Doublewrite buffer**\u662f\u78c1\u76d8\u4e0d\u662f\u5185\u5b58**\u3002</li> <li>\u5199\u5165\u6570\u636e\u6587\u4ef6\u3002</li> </ol> <p>\u5199\u5165\u987a\u5e8f\uff1a\u5148\u5199doublewrite buffer,\u5199**\u6210\u529f\u540e**\u518d\u5199\u5230\u6570\u636e\u6587\u4ef6\u3002</p>"},{"location":"advanced/1.2.1.Innodb%E2%80%94%E2%80%94%E5%8F%8C%E5%86%99%E7%BC%93%E5%86%B2%E5%8C%BADoublewriteBuffer/#doublewrite-buffer","title":"Doublewrite buffer\u5b58\u50a8\u533a\u4f4d\u4e8e\u4ec0\u4e48\u5730\u65b9\uff1f","text":"<ul> <li>\u5728MySQL 8.0.20\u4e4b\u524d\uff1a\u4f4d\u4e8eInnoDB\u7cfb\u7edf\u8868\u7a7a\u95f4\u4e2d(ibdata\u6587\u4ef6)</li> <li>\u4eceMySQL 8.0.20\u5f00\u59cb\uff1a\u4f4d\u4e8edoublewrite\u6587\u4ef6\u4e2d\uff0c\u6587\u4ef6\u7531innodb_doublewrite_dir\u548cinnodb_doublewrite_files \u914d\u7f6e\u786e\u5b9a</li> </ul> <pre><code># \u6307\u5b9adf\u6587\u4ef6\u7684\u5b58\u50a8\u8def\u5f84\uff0c\u9ed8\u8ba4\u662f\u8ddfinnodb_data_home_dir\uff0c\u4e00\u822c\u5c31\u662f\u6570\u636e\u76ee\u5f55datadir\ninnodb_doublewrite_dir=innodb_data_home_dir\n\n# \u6307\u5b9adb\u6587\u4ef6\u7684\u6570\u91cf\uff0c\u9ed8\u8ba4\u4e3a\u6bcf\u4e2abuffer_pool_instance\u521b\u5efa2\u4e2a\uff0c\u6700\u5c0f\u662f2\uff0c\u6700\u5927\u662f256\ninnodb_doublewrite_files=\n</code></pre>"},{"location":"advanced/1.2.1.Innodb%E2%80%94%E2%80%94%E5%8F%8C%E5%86%99%E7%BC%93%E5%86%B2%E5%8C%BADoublewriteBuffer/#innodb-doublewrite-buffer","title":"innodb \u4ec0\u4e48\u65f6\u5019\u5c06\u810f\u9875\u5199\u5165Doublewrite buffer\u4e2d?","text":"<p>\u7531\u4ee5\u4e0b\u51e0\u4e2a\u53c2\u6570\u51b3\u5b9a\uff1a</p> <ul> <li>innodb_max_dirty_pages_pct_lwm: \u4f4e\u4f4d\u6c34\u5e73\u6807\u8bb0\uff0c\u8fbe\u5230\u8be5\u503c\u5c06\u542f\u52a8\u7f13\u51b2\u5237\u65b0,\u9ed8\u8ba4\u4e3a10\uff08\u767e\u5206\u6bd4\uff0c\u810f\u9875/\u7f13\u51b2\u6c60\uff09</li> <li>innodb_max_dirty_pages_pct: \u810f\u9875\u6570\u91cf\u4e0e\u7f13\u51b2\u6c60\u6bd4\u4f8b\u9608\u503c\uff0c\u9ed8\u8ba4\u4e3a90</li> <li>\u5982\u679c\u5f00\u542f\u81ea\u9002\u5e94\u5237\u65b0\uff08Adaptive Flushing\uff09InnoDB\u6839\u636e\u91cd\u505a\u65e5\u5fd7\u751f\u6210\u7684\u901f\u5ea6\u548c\u5f53\u524d\u7684\u5237\u65b0\u7387\uff0c\u4f7f\u7528\u81ea\u9002\u5e94\u5237\u65b0\u7b97\u6cd5\u6765\u52a8\u6001\u8c03\u6574\u5237\u65b0\u7387\u3002</li> </ul>"},{"location":"advanced/1.2.1.Innodb%E2%80%94%E2%80%94%E5%8F%8C%E5%86%99%E7%BC%93%E5%86%B2%E5%8C%BADoublewriteBuffer/#_2","title":"\u5982\u4f55\u67e5\u770b\u53cc\u5199\u7f13\u51b2\u533a\u7684\u5927\u5c0f?","text":"<p>8.0.20\u4e4b\u524d,Doublewrite buffer\u662f\u7cfb\u7edf\u8868\u7a7a\u95f4\u4e2d\u8fde\u7eed\u7684128\u4e2a\u9875(\u6bcf\u4e2a\u987516k)\uff0c\u603b\u51712M</p> <p>8.0.20\u5f00\u59cb\u7684doublewrite buffer\u7531\u5355\u72ec\u6587\u4ef6\u4fdd\u5b58\uff1a</p> <pre><code># Doubliewrite\u6587\u4ef6\u547d\u540d\n#  #_\u9875\u5927\u5c0f_\u6587\u4ef6\u7f16\u53f7.dblwr\n# \u9875\u5927\u5c0f\u4e00\u822c\u9ed8\u8ba4\u5c31\u662f16KB\uff0c\u7531innodb_page_size\u63a7\u5236\n-rwxrwxrwx 1 root root 192K  7\u6708  6 23:15 '#ib_16384_0.dblwr'\n-rwxrwxrwx 1 root root 8.2M  7\u6708  6 23:16 '#ib_16384_1.dblwr'\n</code></pre>"},{"location":"advanced/1.2.1.Innodb%E2%80%94%E2%80%94%E5%8F%8C%E5%86%99%E7%BC%93%E5%86%B2%E5%8C%BADoublewriteBuffer/#doublewrite-buffer_1","title":"Doublewrite buffer\u4ece\u810f\u9875\u5237\u65b0\u901f\u5ea6\u7531\u54ea\u4e9b\u53c2\u6570\u63a7\u5236?","text":"<p>\u6e05\u6d17\u7ebf\u7a0b\u6570\u7531innodb_page_cleaners\u914d\u7f6e(8.0.20\u7248\u672c\u9ed8\u8ba4\u4e3a4)\uff0c\u5355\u4e2a\u7ebf\u7a0b\u6700\u591a\u6bcf\u6b21\u5199\u5165doublewrite buffer \u7684\u9875\u9762\u6570\u7531innodb_doublewrite_pages\u53d8\u91cf\u63a7\u5236\uff0c \u5728\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u4e3ainnodb_write_io_threads\u7684\u503c\uff08\u9ed8\u8ba44\uff09, \u6bcf\u79d2\u5199\u5165\u6b21\u6570\u8fd8\u53d7\u5230innodb_io_capacity \uff08\u5b9a\u4e49\u4e86\u6bcf\u79d2I / O\u64cd\u4f5c\u6570,\u9ed8\u8ba4\u503c200\uff09\u548cinnodb_io_capacity_max\uff08InnoDB\u5728\u7531\u540e\u53f0\u4efb\u52a1\u6bcf\u79d2\u6267\u884c\u7684\u6700\u5927IOPS\u6570 \uff09\u63a7\u5236\u3002</p>"},{"location":"advanced/1.2.1.Innodb%E2%80%94%E2%80%94%E5%8F%8C%E5%86%99%E7%BC%93%E5%86%B2%E5%8C%BADoublewriteBuffer/#redo-logdoublewrite-buffer","title":"\u4e3a\u4ec0\u4e48\u6709\u4e86redo log\uff0c\u8fd8\u9700\u8981doublewrite buffer\uff1f","text":"<p>\u4e00\u822c\u90fd\u8ba4\u4e3a\uff0credo\u63d0\u4f9b\u4e86\u5d29\u6e83\u6062\u590d\u529f\u80fd\uff0c</p>"},{"location":"advanced/1.2.1.Innodb%E2%80%94%E2%80%94%E5%8F%8C%E5%86%99%E7%BC%93%E5%86%B2%E5%8C%BADoublewriteBuffer/#16kmysql","title":"16K\u539f\u5b50\u5199MySQL","text":"<p>\u5728\u6570\u636e\u5e93\u9886\u57df\uff0c\u63d0\u5347\u6570\u636e\u5e93\u6027\u80fd\u7684\u65b9\u6cd5\u5f88\u591a\uff0c\u4f46\u5176\u4e2d\u6548\u679c\u6bd4\u8f83\u663e\u8457\u7684\u5c31\u5305\u62ec16K\u539f\u5b50\u5199\u7684MySQL\uff0c\u5b83\u7684\u6548\u679c\u5728\u4e8e\u53ef\u4ee5\u76f8\u5bf9\u663e\u8457\u5730\u63d0\u5347MySQL\u670d\u52a1\u7684\u8bfb\u5199\u6027\u80fd\uff0c\u5e76\u4e14\u8fd8\u6709\u964d\u4f4e\u5199\u653e\u5927\u7b49\u4f18\u52bf\u3002\u800c\u8981\u5b9e\u73b016K\u539f\u5b50\u5199\u7684\u7279\u6027\uff0c\u4e0d\u4ec5\u9700\u8981\u6570\u636e\u5e93\u8f6f\u4ef6\u672c\u8eab\u7684\u652f\u6301\uff0c\u8fd8\u9700\u8981\u786c\u4ef6\u548c\u6587\u4ef6\u7cfb\u7edf\u5c42\u9762\u7684\u652f\u6301\u3002</p> <p>https://docs.aws.amazon.com/zh_cn/AWSEC2/latest/UserGuide/configure-twp.html</p> <p>\"4K\u5bf9\u9f50\"\u6307\u7684\u662f\u7b26\u5408\"4K\u6247\u533a\"\u5b9a\u4e49\u683c\u5f0f\u5316\u8fc7\u7684\u786c\u76d8\uff0c\u5e76\u4e14\u6309\u7167\"4K\u6247\u533a\"\u7684\u89c4\u5219\u5199\u5165\u6570\u636e\u3002</p> <p>4K\u5bf9\u9f50\u662f\u4e00\u79cd\u9ad8\u7ea7\u786c\u76d8\u4f7f\u7528\u6280\u672f\uff0c\u7528\u7279\u6b8a\u65b9\u6cd5\u5c06\u6587\u4ef6\u7cfb\u7edf\u683c\u5f0f\u4e0e\u786c\u76d8\u7269\u7406\u5c42\u4e0a\u8fdb\u884c\u5951\u5408\uff0c\u4e3a\u63d0\u9ad8\u786c\u76d8\u5bff\u547d\u4e0e\u9ad8\u6548\u7387\u4f7f\u7528\u786c\u76d8\u7a7a\u95f4\u63d0\u4f9b\u89e3\u51b3\u65b9\u6848\u3002</p> <p>\u4ea7\u751f\u80cc\u666f\u673a\u68b0\u786c\u76d8\u5728\u50a8\u5b58\u6570\u636e\u65f6\uff0c\u4e00\u76f4\u90fd\u662f\u4ee5512byte\u5927\u5c0f\u7684\u6247\u533a\uff08Sector\uff09\u4e3a\u5355\u4f4d\u5206\u5272\u8fdb\u884c\u8bfb\u5199\u3002</p> <p>\u968f\u7740\u786c\u76d8\u5bb9\u91cf\u7684\u4e0d\u65ad\u63d0\u5347\uff0c\u8fd9\u79cd\u5206\u914d\u6807\u51c6\u5df2\u7ecf\u8d8a\u6765\u8d8a\u663e\u7684\u4e0d\u5408\u65f6\u5b9c\u3002\u56e0\u6b64\uff0c\u786c\u76d8\u751f\u4ea7\u5382\u5546\u4eec\u51b3\u5b9a\u5c06\u6247\u533a\u5bb9\u91cf\u6269\u5927\u52304KB\uff0c\u4e5f\u5c31\u662f\u201c4K\u6247\u533a\u201d\u3002</p> <p>\u5728NTFS6.X\u4ee5\u524d\u7684\u89c4\u8303\u4e2d\uff0c\u6570\u636e\u7684\u5199\u5165\u70b9\u6b63\u597d\u4f1a\u4ecb\u4e8e\u4e24\u4e2a4K\u6247\u533a\u7684\u4e4b\u95f4\uff0c\u4e5f\u5c31\u662f\u8bf4\u5373\u4f7f\u662f\u5199\u5165\u6570\u636e\u91cf\u975e\u5e38\u5c0f\uff0c\u4e5f\u4f1a\u4f7f\u7528\u5230\u4e24\u4e2a4K\u6247\u533a\uff0c\u663e\u7136\u8fd9\u6837\u5bf9\u5199\u5165\u901f\u5ea6\u548c\u8bfb\u53d6\u901f\u5ea6\u90fd\u4f1a\u9020\u6210\u6bd4\u8f83\u5927\u7684\u5f71\u54cd\u3002\u4e3a\u6b64\u5bf9\u4e8e\u201c4K\u4e0d\u5bf9\u9f50\u201d\u7684\u60c5\u51b5\u6765\u8bf4\uff0c\u4e00\u5b9a\u8981\u4fee\u6539\u6210\u201c4K\u5bf9\u9f50\u201d\u624d\u597d\uff0c\u5426\u5219\u4e0d\u4f46\u4f1a\u6781\u5927\u7684\u964d\u4f4e\u6570\u636e\u5199\u5165\u548c\u8bfb\u53d6\u901f\u5ea6\uff0c\u8fd8\u4f1a\u9020\u6210\u786c\u76d8\u4e0d\u5fc5\u8981\u7684\u5199\u5165\u6b21\u6570\uff0c\u51cf\u5c11\u4f7f\u7528\u5bff\u547d\u3002\u5c06\u786c\u76d8\u8c03\u6574\u4e3a4K\u5bf9\u9f50\u540e\uff0c\u53ef\u4ee5\u63d0\u5347\u786c\u76d8\u7684\u8bfb\u5199\u901f\u5ea6\u3002\u8981\u5b9e\u73b04K\u5bf9\u9f50\uff0c\u9996\u5148\u8981\u5f00\u542f\u786c\u76d8\u7684AHCI\u6a21\u5f0f\uff0c\u7136\u540e\u4f7f\u75284K\u5bf9\u9f50\u5de5\u5177\u8fdb\u884c4K\u5bf9\u9f50\uff0c\u8fdb\u800c\u51cf\u5c11\u8bfb\u5199\u6b21\u6570\uff0c\u4f7f\u6570\u636e\u4f20\u8f93\u66f4\u4e3a\u9ad8\u6548\u3002</p> <p>\u539f\u7406\u7535\u8111\u4f20\u7edf\u673a\u68b0\u786c\u76d8\u7684\u6bcf\u4e2a\u6247\u533a\u4e00\u822c\u5927\u5c0f\u4e3a512\u5b57\u8282\uff1b\u5f53\u4f7f\u7528\u67d0\u4e00\u6587\u4ef6\u7cfb\u7edf\u5c06\u786c\u76d8\u683c\u5f0f\u5316\u65f6\uff0c\u6587\u4ef6\u7cfb\u7edf\u4f1a\u5c06\u786c\u76d8\u6247\u533a\u3001\u78c1\u9053\u4e0e\u67f1\u9762\u7edf\u8ba1\u6574\u7406\u5e76\u5b9a\u4e49\u4e00\u4e2a\u7c07\u4e3a\u591a\u5c11\u6247\u533a\u65b9\u4fbf\u5feb\u901f\u5b58\u50a8\u3002</p> <p>\u663e\u7136\uff0c\u5982\u679c\u670916K\u5bf9\u9f50\u7684\u78c1\u76d8\uff0c\u53ef\u4ee5\u663e\u8457\u63d0\u5347MySQL\u6027\u80fd\u3002</p>"},{"location":"advanced/1.MySQL%E6%9E%B6%E6%9E%84%E5%88%B0InnoDB%E6%9E%B6%E6%9E%84/","title":"MySQL\u4f53\u7cfb\u67b6\u6784","text":"<p>\u6570\u636e\u5e93\u662f\u6570\u636e\u7684\u96c6\u5408\uff0c\u6570\u636e\u5e93\u7ba1\u7406\u7cfb\u7edf\uff08DBMS\uff09\u662f\u64cd\u4f5c\u548c\u7ba1\u7406\u6570\u636e\u5e93\u7684\u5e94\u7528\u7a0b\u5e8f\u3002\u6570\u636e\u5e93\u5e94\u7528\u4e3b\u8981\u6709\u4e24\u7c7b\uff1aOLAP\uff08\u8054\u673a\u5206\u6790\u5904\u7406\uff09\u548cOLTP\uff08\u8054\u673a\u4e8b\u52a1\u5904\u7406\uff09\u3002</p> <p>OLAP\u7684\u4e3b\u8981\u7279\u70b9\u662f:</p> <ul> <li>\u5b9e\u65f6\u6027\u8981\u6c42\u4e0d\u9ad8</li> <li>\u6570\u636e\u91cf\u5927</li> <li>\u5e76\u53d1\u91cf\u5c0f</li> </ul> <p>OLTP\u7684\u4e3b\u8981\u7279\u70b9\u662f:</p> <ul> <li>\u5b9e\u65f6\u6027\u8981\u6c42\u9ad8</li> <li>\u6570\u636e\u91cf\u5c0f</li> <li>\u9ad8\u5e76\u53d1</li> <li>\u8981\u6c42\u6ee1\u8db3ACID</li> </ul> <p>mysql\u662f\u4e00\u79cdDBMS\uff0c\u5176\u4f53\u7cfb\u67b6\u6784\u5982\u4e0b\u56fe\u6240\u793a\uff1a</p> <p></p> <p>mysql\u4e2d\u96c6\u6210\u7684\u662f\u63d2\u4ef6\u5f0f\u7684\u5b58\u50a8\u5f15\u64ce\uff0cInnoDB\u5f15\u64ce\u662f\u5176\u4e2d\u4e4b\u4e00\u3002\u5b58\u50a8\u5f15\u64ce\u57fa\u4e8e\u8868\u800c\u4e0d\u662f\u6570\u636e\u5e93\uff1a\u540c\u4e00\u4e2a\u6570\u636e\u5e93\u4e2d\u6839\u636e\u4e0d\u540c\u8868\u7684\u8bbf\u95ee\u64cd\u4f5c\u9700\u6c42\u53ef\u4ee5\u9009\u62e9\u4e0d\u540c\u7684\u5b58\u50a8\u5f15\u64ce\u3002</p>"},{"location":"advanced/1.MySQL%E6%9E%B6%E6%9E%84%E5%88%B0InnoDB%E6%9E%B6%E6%9E%84/#innodb","title":"InnoDB","text":"<p>InnoDB\u5f15\u64ce\u4e3b\u8981\u9762\u5bf9OLTP\u7c7b\u5e94\u7528\u3002</p> <p>InnoDB\u5f15\u64ce\u5728mysql\u4e2d\u5904\u4e8e\u6587\u4ef6\u548c\u6587\u4ef6\u7cfb\u7edf\u7684\u4e0a\u5c42\uff0c\u7ba1\u7406\u7740\u5bf9InnoDB\u5f15\u64ce\u8868\u7684\u8bbf\u95ee\u548c\u66f4\u65b0\u3002</p>"},{"location":"advanced/1.MySQL%E6%9E%B6%E6%9E%84%E5%88%B0InnoDB%E6%9E%B6%E6%9E%84/#innodb_1","title":"InnoDB\u67b6\u6784\u56fe","text":"<p>MySQL5.7\u7248\u672c\u4e2d\u7684\u67b6\u6784\u56fe\uff1a</p> <p></p> <p>MySQL8.0 \u7248\u672c\u4e2d\u7684\u67b6\u6784\u56fe\uff1a</p> <p></p> <p>\u56fe\u7247\u6765\u6e90\u4e0e\u5b98\u7f51\uff1a</p> <p>https://dev.mysql.com/doc/refman/5.7/en/innodb-architecture.html</p>"},{"location":"advanced/1.MySQL%E6%9E%B6%E6%9E%84%E5%88%B0InnoDB%E6%9E%B6%E6%9E%84/#innodb_2","title":"InnoDB\u7684\u4e00\u4e2a\u591a\u7ebf\u7a0b\u6a21\u578b","text":""},{"location":"advanced/1.MySQL%E6%9E%B6%E6%9E%84%E5%88%B0InnoDB%E6%9E%B6%E6%9E%84/#master-thread-","title":"Master Thread - \u6838\u5fc3\u7ebf\u7a0b","text":"<p>\u4ee5\u4e0b\u5185\u5bb9\u5168\u90e8\u5f15\u81ea\uff1a InnoDB\u5b58\u50a8\u5f15\u64ce\u2014\u2014Master Thread\u5de5\u4f5c\u65b9\u5f0f</p> <p>\uff08\u5f53\u505a\u5907\u4efd\uff09</p> <p>Master Thread\u662fInnoDB\u5b58\u50a8\u5f15\u64ce\u975e\u5e38\u6838\u5fc3\u7684\u4e00\u4e2a\u540e\u53f0\u7ebf\u7a0b\uff0c\u4e3b\u8981\u8d1f\u8d23\u5c06\u7f13\u51b2\u6c60\u4e2d\u7684\u6570\u636e\u5f02\u6b65\u5237\u65b0\u5230\u78c1\u76d8\uff0c\u4fdd\u8bc1\u6570\u636e\u7684\u4e00\u81f4\u6027\uff0c\u5305\u62ec\u810f\u9875\u7684\u5237\u65b0\u3001\u5408\u5e76\u63d2\u5165\u7f13\u51b2\u3001UNDO\u9875\u7684\u56de\u6536\u7b49\u3002</p>"},{"location":"advanced/1.MySQL%E6%9E%B6%E6%9E%84%E5%88%B0InnoDB%E6%9E%B6%E6%9E%84/#innodb-10xmaster-thread","title":"InnoDB 1.0.x\u7248\u672c\u4e4b\u524d\u7684Master Thread","text":"<p>Master Thread\u5177\u6709 \u6700\u9ad8\u7684\u7ebf\u7a0b\u4f18\u5148\u7ea7\u522b\u3002</p> <p>\u5176\u5185\u90e8\u7531\u591a\u4e2a\u5faa\u73af\u7ec4\u6210\uff1a\u4e3b\u5faa\u73af\uff08loop\uff09\u3001\u540e\u53f0\u5faa\u73af\uff08backgroup loop\uff09\u3001\u5237\u65b0\u5faa\u73af\uff08flush loop\uff09\u3001\u6682\u505c\u5faa\u73af\uff08suspend loop\uff09\u3002</p> <p>Master Thread\u4f1a \u6839\u636e\u6570\u636e\u5e93\u8fd0\u884c\u7684\u72b6\u6001 \u5728loop\u3001backgroup loop\u3001flush loop\u548csuspend loop\u4e2d \u8fdb\u884c\u5207\u6362\u3002</p> <p>loop\u662f\u4e3b\u5faa\u73af\uff0c\u5927\u591a\u6570\u7684\u64cd\u4f5c\u90fd\u5728\u8fd9\u4e2a\u5faa\u73af\u4e2d\uff0c\u4e3b\u8981\u6709\u4e24\u5927\u90e8\u5206\u7684\u64cd\u4f5c\u2014\u2014\u6bcf\u79d2\u949f\u7684\u64cd\u4f5c\u548c\u6bcf10\u79d2\u949f\u7684\u64cd\u4f5c\u3002\u4f2a\u4ee3\u7801\u5982\u4e0b\uff1a</p> <pre><code>void master_thread()\n{\n    loop:\n    for(int i = 0; i &lt; 10; ++i){\n        do thing once per second;\n        sleep 1 second if necessary;\n    }\n    do things once per ten seconds;\n    goto loop;\n}\n</code></pre> <p>\u6bcf\u79d2\u4e00\u6b21\u7684\u64cd\u4f5c\u5305\u62ec\uff1a</p> <ol> <li>\u65e5\u5fd7\u7f13\u51b2\u5237\u65b0\u5230\u78c1\u76d8\uff0c\u5373\u4f7f\u8fd9\u4e2a\u4e8b\u52a1\u8fd8\u6ca1\u6709\u63d0\u4ea4\uff08\u603b\u662f\uff09\uff1b</li> </ol> <p>\u5373\u4f7f\u67d0\u4e2a\u4e8b\u52a1\u8fd8\u6ca1\u6709\u63d0\u4ea4\uff0cInnoDB\u5b58\u50a8\u5f15\u64ce\u4ecd\u7136\u6bcf\u79d2\u4f1a\u5c06\u91cd\u505a\u65e5\u5fd7\u7f13\u51b2\u4e2d\u7684\u5185\u5bb9\u5237\u65b0\u5230\u91cd\u505a\u65e5\u5fd7\u6587\u4ef6\u3002\u8fd9\u4e5f\u89e3\u91ca\u4e86\u4e3a\u4ec0\u4e48\u518d\u5927\u7684\u4e8b\u52a1\u63d0\u4ea4\u7684\u65f6\u95f4\u4e5f\u662f\u5f88\u77ed\u7684\u3002</p> <ol> <li>\u5408\u5e76\u63d2\u5165\u7f13\u51b2\uff08\u53ef\u80fd\uff09\uff1b</li> </ol> <p>\u5408\u5e76\u63d2\u5165\u7f13\u51b2\u5e76\u4e0d\u662f\u6bcf\u79d2\u90fd\u4f1a\u53d1\u751f\u7684\u3002InnoDB\u5b58\u50a8\u5f15\u64ce\u4f1a\u5224\u65ad\u5f53\u524d\u4e00\u79d2\u5185\u53d1\u751f\u7684IO\u6b21\u6570\u662f\u5426\u5c0f\u4e8e5\u6b21\uff0c\u5982\u679c\u5c0f\u4e8e5\u6b21\uff0cInnoDB\u5b58\u50a8\u5f15\u64ce\u8ba4\u4e3a\u5f53\u524d\u7684IO\u538b\u529b\u5f88\u5c0f\uff0c\u53ef\u4ee5\u6267\u884c\u5408\u5e76\u63d2\u5165\u7f13\u51b2\u7684\u64cd\u4f5c\uff1b</p> <ol> <li> <p>\u81f3\u591a\u5237\u65b0100\u4e2aInnoDB\u7684\u7f13\u51b2\u6c60\u4e2d\u7684\u810f\u9875\u5230\u78c1\u76d8\uff08\u53ef\u80fd\uff09\uff1b    \u5237\u65b0100\u4e2a\u810f\u9875\u4e5f\u4e0d\u662f\u6bcf\u79d2\u90fd\u4f1a\u53d1\u751f\u7684\uff0cInnoDB\u5b58\u50a8\u5f15\u64ce\u901a\u8fc7\u5224\u65ad\u5f53\u524d\u7f13\u51b2\u6c60\u4e2d\u810f\u9875\u7684\u6bd4\u4f8b(buf_get_modified_ratio_pct)\u662f\u5426\u8d85\u8fc7\u4e86\u914d\u7f6e\u6587\u4ef6\u4e2d    innodb_max_dirty_pages_pct\u8fd9\u4e2a\u53c2\u6570\uff08\u9ed8\u8ba4\u662f75\uff0c\u4ee3\u886875%\uff09\uff0c\u5982\u679c\u8d85\u8fc7\u4e86\u8fd9\u4e2a\u503c\uff0cInnoDB\u5b58\u50a8\u5f15\u64ce\u5219\u8ba4\u4e3a\u9700\u8981\u505a\u78c1\u76d8\u540c\u6b65\u7684\u64cd\u4f5c\uff0c\u5c06100\u4e2a\u810f\u9875\u5199\u5165\u78c1\u76d8\u4e2d\u3002</p> </li> <li> <p>\u5982\u679c\u5f53\u524d\u6ca1\u6709\u7528\u6237\u6d3b\u52a8\uff0c\u5219\u5207\u6362\u5230background loop(\u53ef\u80fd)\uff1b</p> </li> </ol> <p>\u7efc\u4e0a\u6240\u8ff0\uff0c\u4f2a\u4ee3\u7801\u53ef\u4ee5\u8fdb\u4e00\u6b65\u5177\u4f53\u5316\u3002</p> <pre><code>void master_thread()\n{\n    loop:\n    for(int i = 0; i &lt; 10; ++i){\n        thread_sleep(1);\n        do log buffer flush to disk;\n        if(last_one_second_ios &lt; 5)\n            do merge at most 5 insert buffer;\n        if(buf_get_modified_ratio_pct &gt; innodb_max_dirty_pages_pct)\n            do buffer pool flush 100 dirty page;\n        if(no user activity)\n            goto backgroud loop;\n    }\n    do things once per ten seconds;\n    backgroud loop;\n    do something;\n    goto loop;\n}\n</code></pre> <p>\u6bcf10\u79d2\u7684\u64cd\u4f5c\u4e3b\u8981\u662f\u4e0b\u9762\u51e0\u4e2a\u65b9\u9762\uff1a</p> <ol> <li> <p>\u5237\u65b0100\u4e2a\u810f\u9875\u5230\u78c1\u76d8\uff08\u53ef\u80fd\uff09    InnoDB\u5b58\u50a8\u5f15\u64ce\u4f1a\u5148\u5224\u65ad\u8fc7\u53bb10\u79d2\u4e4b\u5185\u78c1\u76d8\u7684IO\u64cd\u4f5c\u662f\u5426\u5c0f\u4e8e200\u6b21\uff0c\u5982\u679c\u662f\uff0cInnoDB\u5b58\u50a8\u5f15\u64ce\u8ba4\u4e3a\u5f53\u524d\u6709\u8db3\u591f\u7684\u78c1\u76d8IO\u80fd\u529b\uff0c\u56e0\u6b64\u5c06100\u4e2a\u810f\u9875\u5237\u65b0\u5230\u78c1\u76d8\u3002</p> </li> <li> <p>\u5408\u5e76\u81f3\u591a5\u4e2a\u63d2\u5165\u7f13\u51b2\uff08\u603b\u662f\uff09</p> </li> <li> <p>\u5c06\u65e5\u5fd7\u7f13\u51b2\u5237\u65b0\u5230\u78c1\u76d8\uff08\u603b\u662f\uff09</p> </li> <li> <p>\u5220\u9664\u65e0\u7528\u7684Undo\u9875\uff08\u603b\u662f\uff09</p> </li> <li> <p>\u5237\u65b0100\u4e2a\u6216\u800510\u4e2a\u810f\u9875\u5230\u78c1\u76d8\uff08\u603b\u662f\uff09    InnoDB\u5b58\u50a8\u5f15\u64ce\u4f1a\u6267\u884cfull purge\u64cd\u4f5c\uff0c\u5373\u5220\u9664\u65e0\u7528\u7684Undo\u9875\u3002\u5bf9\u8868\u8fdb\u884cupdate\uff0cdelete\u8fd9\u7c7b\u7684\u64cd\u4f5c\u65f6\uff0c\u539f\u5148\u7684\u884c\u88ab\u6807\u8bb0\u4e3a\u5220\u9664\uff0c\u4f46\u662f\u56e0\u4e3a\u4e00\u81f4\u6027\u8bfb\u7684\u5173\u7cfb\uff0c\u9700\u8981\u4fdd\u7559\u8fd9\u4e9b\u884c\u7248\u672c\u7684\u4fe1\u606f\u3002\u4f46\u662f\u5728full purge\u8fc7\u7a0b\u4e2d\uff0cInnoDB\u5b58\u50a8\u5f15\u64ce\u4f1a\u5224\u65ad\u5f53\u524d\u4e8b\u52a1\u7cfb\u7edf\u4e2d\u5df2\u88ab\u5220\u9664\u7684\u884c\u662f\u5426\u53ef\u4ee5\u5220\u9664\uff0c\u6bd4\u5982\u6709\u65f6\u5019\u53ef\u80fd\u8fd8\u6709\u67e5\u8be2\u64cd\u4f5c\u9700\u8981\u8bfb\u53d6\u4e4b\u524d\u7248\u672c\u7684undo\u4fe1\u606f\uff0c\u5982\u679c\u53ef\u4ee5\u5220\u9664\uff0cInnoDB\u5b58\u50a8\u5f15\u64ce\u4f1a\u7acb\u5373\u5c06\u5176\u5220\u9664\u3002\u4ece\u6e90\u4ee3\u7801\u4e2d\u53ef\u4ee5\u770b\u51fa\uff0cInnoDB\u5b58\u50a8\u5f15\u64ce\u5728\u6267\u884cfull purge \u64cd\u4f5c\u65f6\uff0c\u6bcf\u6b21\u6700\u591a\u5c1d\u8bd5\u56de\u653620\u4e2aundo\u9875\u3002</p> </li> </ol> <p>\u7136\u540e\uff0cInnoDB\u5b58\u50a8\u5f15\u64ce\u4f1a\u5224\u65ad\u7f13\u51b2\u6c60\u4e2d\u810f\u9875\u7684\u6bd4\u4f8b\uff08buf_get_modified_ratio_pct\uff09,\u5982\u679c\u6709\u8d85\u8fc770%\u7684\u810f\u9875\uff0c\u5219\u5237\u65b0100\u4e2a\u810f\u9875\u5230\u78c1\u76d8\uff0c\u5982\u679c\u810f\u9875\u7684\u6bd4\u4f8b\u5c0f\u4e8e70%,\u5219\u53ea\u9700\u5237\u65b010%\u7684\u810f\u9875\u5230\u78c1\u76d8\u3002</p> <p>\u4f2a\u4ee3\u7801\u8fdb\u4e00\u6b65\u7ec6\u5316:</p> <pre><code>void master_thread()\n{\n    loop:\n    for(int i = 0; i &lt; 10; ++i){\n        thread_sleep(1);\n        do log buffer flush to disk;\n        if(last_one_second_ios &lt; 5)\n            do merge at most 5 insert buffer;\n        if(buf_get_modified_ratio_pct &gt; innodb_max_dirty_pages_pct)\n            do buffer pool flush 100 dirty page;\n        if(no user activity)\n            goto backgroud loop;\n    }\n    if(last_ten_second_ios &lt; 200)\n        do buffer pool flush 100 dirty page;\n\n    do merge at most 5 insert buffer;\n    do log buffer flush to disk;\n    do full purge;\n    if(buf_get_modified_ratio_pct &gt; 70%)\n        do buffer pool flush 100 dirty page;\n    else\n        buffer pool flush 10 dirty page;\n    goto loop;\n    backgroud loop;\n    do something;\n    goto loop;\n}\n</code></pre> <p>\u5982\u679c\u5f53\u524d\u6ca1\u6709\u7528\u6237\u6d3b\u52a8\uff08\u6570\u636e\u5e93\u7a7a\u95f2\uff09\u6216\u8005\u6570\u636e\u5e93\u5173\u7cfb\uff0c\u5c31\u4f1a\u5207\u6362\u5230backgroud loop\u8fd9\u4e2a\u5faa\u73af\u3002 backgroud loop\u4f1a\u6267\u884c\u4ee5\u4e0b\u64cd\u4f5c\uff1a</p> <ol> <li>\u5220\u9664\u65e0\u7528\u7684Undo\u9875\uff08\u603b\u662f\uff09</li> <li>\u5408\u5e7620\u4e2a\u63d2\u5165\u7f13\u51b2\uff08\u603b\u662f\uff09</li> <li>\u8df3\u56de\u5230\u4e3b\u5faa\u73af\uff08\u603b\u662f\uff09</li> <li>\u4e0d\u65ad\u5237\u65b0100\u4e2a\u9875\u76f4\u5230\u7b26\u5408\u6761\u4ef6\uff08\u53ef\u80fd\uff0c\u9700\u8981\u8df3\u8f6c\u5230flush loop\u4e2d\u5b8c\u6210\uff09</li> </ol> <p>\u5982\u679cflush loop\u4e2d\u4e5f\u6ca1\u6709\u4ec0\u4e48\u4e8b\u60c5\u53ef\u4ee5\u505a\u4e86\uff0cInnoDB\u5b58\u50a8\u5f15\u64ce\u4f1a\u5207\u6362\u5230suspend_loop\uff0c\u5c06Master Thread\u6302\u8d77\uff0c\u7b49\u5f85\u4e8b\u4ef6\u7684\u53d1\u751f\u3002\u82e5\u7528\u6237\u542f\u7528\u4e86InnoDB\u5b58\u50a8\u5f15\u64ce\uff0c\u5374\u6ca1\u6709\u4f7f\u7528\u4efb\u4f55InnoDB\u5b58\u50a8\u5f15\u64ce\u7684\u8868\uff0c\u90a3\u4e48Master Thread\u603b\u662f\u5904\u4e8e\u6302\u8d77\u7684\u72b6\u6001\u3002</p> <p>\u6700\u540e\uff0cMaster Thread\u5b8c\u6574\u7684\u4f2a\u4ee3\u7801\u5982\u4e0b\uff1a</p> <pre><code>void master_thread()\n{\n    loop:\n    for(int i = 0; i &lt; 10; ++i){\n    thread_sleep(1);                            // sleep 1\u79d2\n        do log buffer flush to disk;\n        if(last_one_second_ios &lt; 5)\n            do merge at most 5 insert buffer;\n        if(buf_get_modified_ratio_pct &gt; innodb_max_dirty_pages_pct) \n                                              // \u5982\u679c\u7f13\u51b2\u6c60\u4e2d\u7684\u810f\u9875\u6bd4\u4f8b\u5927\u4e8einnodb_max_dirty_pages_pct(\u9ed8\u8ba4\u662f75\u65f6)\n            do buffer pool flush 100 dirty page;    // \u5237\u65b0100\u810f\u9875\u5230\u78c1\u76d8\n        if(no user activity)\n            goto backgroud loop;\n    }\n    if(last_ten_second_ios &lt; 200)   // \u5982\u679c\u8fc7\u53bb10\u5185\u78c1\u76d8IO\u6b21\u6570\u5c0f\u4e8e\u8bbe\u7f6e\u7684innodb_io_capacity\u7684\u503c\uff08\u9ed8\u8ba4\u662f200\uff09\n        do buffer pool flush 100 dirty page;\n\n    do merge at most 5 insert buffer;   // \u5408\u5e76\u63d2\u5165\u7f13\u51b2\u662finnodb_io_capacity\u76845%\uff0810\uff09\uff08\u603b\u662f\uff09\n    do log buffer flush to disk;\n    do full purge;\n    if(buf_get_modified_ratio_pct &gt; 70%)\n        do buffer pool flush 100 dirty page;\n    else\n        buffer pool flush 10 dirty page;\n\n    backgroud loop\uff1a // \u540e\u53f0\u5faa\u73af\n    do full purge   // \u5220\u9664\u65e0\u7528\u7684undo\u9875 \uff08\u603b\u662f\uff09\n    do merge 20 insert buffer;  // \u5408\u5e76\u63d2\u5165\u7f13\u51b2\u662finnodb_io_capacity\u76845%\uff0810\uff09\uff08\u603b\u662f\uff09\n    if not idle                 // \u5982\u679c\u4e0d\u7a7a\u95f2\uff0c\u5c31\u8df3\u56de\u4e3b\u5faa\u73af\uff0c\u5982\u679c\u7a7a\u95f2\u5c31\u8df3\u5165flush loop\n        goto loop:              // \u8df3\u5230\u4e3b\u5faa\u73af\n    else\n        goto flush loop\n\n    flush loop:                 // \u5237\u65b0\u5faa\u73af\n    do buffer pool flush 100 dirty page;\n    if(buf_get_modified_ratio_pct &gt; innodb_max_dirty_pages_pct) \n                                // \u5982\u679c\u7f13\u51b2\u6c60\u4e2d\u7684\u810f\u9875\u6bd4\u4f8b\u5927\u4e8einnodb_max_dirty_pages_pct\u7684\u503c\uff08\u9ed8\u8ba475%\uff09\n        goto flush loop;        // \u8df3\u5230\u5237\u65b0\u5faa\u73af\uff0c\u4e0d\u65ad\u5237\u65b0\u810f\u9875\uff0c\u76f4\u5230\u7b26\u5408\u6761\u4ef6\n\n        goto suspend loop;      // \u5b8c\u6210\u5237\u65b0\u810f\u9875\u7684\u4efb\u52a1\u540e\uff0c\u8df3\u5165suspend loop\n\n    suspend loop:\n    suspend_thread();           //master\u7ebf\u7a0b\u6302\u8d77\uff0c\u7b49\u5f85\u4e8b\u4ef6\u53d1\u751f\n    waiting event;\n    goto loop;\n}\n</code></pre>"},{"location":"advanced/1.MySQL%E6%9E%B6%E6%9E%84%E5%88%B0InnoDB%E6%9E%B6%E6%9E%84/#innodb-12xmaster-thread","title":"InnoDB 1.2.x\u7248\u672c\u4e4b\u524d\u7684Master Thread","text":"<p>1.0.x\u7248\u672c\u4e2d\uff0cInnoDB\u5b58\u50a8\u5f15\u64ce\u6700\u591a\u53ea\u4f1a\u5237\u65b0100\u4e2a\u810f\u9875\u5230\u78c1\u76d8\uff0c\u5408\u5e7620\u4e2a\u63d2\u5165\u7f13\u51b2\u3002\u5982\u679c\u662f\u5728\u5199\u5165\u5bc6\u96c6\u7684\u5e94\u7528\u7a0b\u5e8f\u4e2d\uff0c\u6bcf\u79d2\u53ef\u80fd\u4f1a\u4ea7\u751f\u5927\u4e8e100\u4e2a\u7684\u810f\u9875\uff0c\u5982\u679c\u662f\u4ea7\u751f\u5927\u4e8e20\u4e2a\u63d2\u5165\u7f13\u51b2\u7684\u60c5\u51b5\uff0c\u90a3\u4e48\u53ef\u80fd\u4f1a\u6765\u4e0d\u53ca\u5237\u65b0\u6240\u6709\u7684\u810f\u9875\u4ee5\u53ca\u5408\u5e76\u63d2\u5165\u7f13\u51b2\u3002</p> <p>\u540e\u6765\uff0cInnoDB\u5b58\u50a8\u5f15\u64ce\u63d0\u4f9b\u4e86\u53c2\u6570innodb_io_capacity\uff0c\u7528\u6765\u8868\u793a\u78c1\u76d8IO\u7684\u541e\u5410\u91cf\uff0c\u9ed8\u8ba4\u503c\u4e3a200\u3002</p> <pre><code>mysql&gt; show variables like 'innodb_io_capacity';\n+--------------------+-------+\n| Variable_name      | Value |\n+--------------------+-------+\n| innodb_io_capacity | 200   |\n+--------------------+-------+\n1 row in set (0.00 sec)\n</code></pre> <p>\u5bf9\u4e8e\u5237\u65b0\u5230\u78c1\u76d8\u7684\u9875\u7684\u6570\u91cf\uff0c\u4f1a\u6309\u7167innodb_io_capacity\u7684\u767e\u5206\u6bd4\u6765\u8fdb\u884c\u63a7\u5236\u3002\u89c4\u5219\u5982\u4e0b\uff1a</p> <ol> <li>\u5728\u5408\u5e76\u63d2\u5165\u7f13\u51b2\u65f6\uff0c\u5408\u5e76\u63d2\u5165\u7f13\u51b2\u7684\u6570\u91cf\u4e3ainnodb_io_capacity\u503c\u76845%;</li> <li>\u5728\u4ece\u7f13\u51b2\u533a\u5237\u65b0\u810f\u9875\u65f6\uff0c\u5237\u65b0\u810f\u9875\u7684\u6570\u91cf\u4e3ainnodb_io_capacity;</li> </ol> <p>\u5982\u679c\u7528\u6237\u4f7f\u7528\u7684\u662fSSD\u7c7b\u7684\u78c1\u76d8\uff0c\u53ef\u4ee5\u5c06innodb_io_capacity\u7684\u503c\u8c03\u9ad8\uff0c\u76f4\u5230\u7b26\u5408\u78c1\u76d8IO\u7684\u541e\u5410\u91cf\u4e3a\u6b62\uff1b</p> <p>\u53e6\u4e00\u4e2a\u95ee\u9898\u662f\u53c2\u6570innodb_max_dirty_pages_pct\u7684\u9ed8\u8ba4\u503c\uff0c\u57281.0.x\u7248\u672c\u4e4b\u524d\uff0c\u8be5\u503c\u7684\u9ed8\u8ba4\u503c\u662f90\uff0c\u610f\u5473\u7740\u810f\u9875\u5360\u7f13\u51b2\u6c60\u768490%\u3002InnoDB\u5b58\u50a8\u5f15\u64ce\u5728\u6bcf\u79d2\u5237\u65b0\u7f13\u51b2\u6c60\u548cflush loop\u65f6\u4f1a\u5224\u65ad\u8fd9\u4e2a\u503c\uff0c\u5982\u679c\u8be5\u503c\u5927\u4e8einnodb_max_dirty_pages_pct,\u624d\u4f1a\u5237\u65b0100\u4e2a\u810f\u9875\uff0c\u5982\u679c\u6709\u5f88\u5927\u7684\u5185\u5b58\uff0c\u6216\u8005\u6570\u636e\u5e93\u670d\u52a1\u5668\u7684\u538b\u529b\u5f88\u5927\uff0c\u8fd9\u65f6\u5237\u65b0\u810f\u9875\u7684\u901f\u5ea6\u53cd\u800c\u4f1a\u964d\u4f4e\u3002 \u540e\u6765\u5c06innodb_max_dirty_pages_pct\u7684\u9ed8\u8ba4\u503c\u6539\u4e3a\u4e8675\u3002\u8fd9\u6837\u65e2\u53ef\u4ee5\u52a0\u5feb\u5237\u65b0\u810f\u9875\u7684\u9891\u7387\uff0c\u53c8\u80fd\u591f\u4fdd\u8bc1\u78c1\u76d8IO\u7684\u8d1f\u8f7d\u3002</p> <pre><code>mysql&gt; show variables like 'innodb_max_dirty_pages_pct';\n+----------------------------+-------+\n| Variable_name              | Value |\n+----------------------------+-------+\n| innodb_max_dirty_pages_pct | 75    |\n+----------------------------+-------+\n1 row in set (0.00 sec)\n</code></pre> <p>\u8fd8\u6709\u4e00\u4e2a\u65b0\u7684\u53c2\u6570\u662finnodb_adaptive_flushing(\u81ea\u9002\u5e94\u5730\u5237\u65b0)\uff0c\u8be5\u503c\u5f71\u54cd\u6bcf\u79d2\u5237\u65b0\u810f\u9875\u7684\u6570\u91cf\u3002\u539f\u6765\u7684\u5237\u65b0\u89c4\u5219\u662f\uff1a\u810f\u9875\u5728\u7f13\u51b2\u6c60\u6240\u5360\u7684\u6bd4\u4f8b\u5c0f\u4e8einnodb_max_dirty_pages_pct\u65f6\uff0c\u4e0d\u5237\u65b0\u810f\u9875\uff1b\u5927\u4e8einnodb_max_dirty_pages_pct\u65f6\uff0c\u5237\u65b0100\u4e2a\u810f\u9875\u3002\u968f\u7740innodb_adaptive_flushing\u53c2\u6570\u7684\u5f15\u5165\uff0cInnoDB\u901a\u8fc7\u4e00\u4e2a\u540d\u4e3abuf_flush_get_desired_flush_rate\u7684\u51fd\u6570\u6765\u5224\u65ad\u9700\u8981\u5237\u65b0\u810f\u9875\u6700\u5408\u9002\u7684\u6570\u91cf\u3002buf_flush_get_desired_flush_rate\u51fd\u6570\u901a\u8fc7\u5224\u65ad\u4ea7\u751f\u91cd\u505a\u65e5\u5fd7\u7684\u901f\u7387\u6765\u51b3\u5b9a\u6700\u5408\u9002\u7684\u5237\u65b0\u810f\u9875\u6570\u91cf\u3002</p> <p>\u4e4b\u524d\u6bcf\u6b21\u8fdb\u884cfull purge \u64cd\u4f5c\u65f6\uff0c\u6700\u591a\u56de\u653620\u4e2aUndo\u9875\uff0c\u4eceInnoDB 1.0.x\u7248\u672c\u5f00\u59cb\u5f15\u5165\u4e86\u53c2\u6570innodb_purge_batch_size,\u8be5\u53c2\u6570\u53ef\u4ee5\u63a7\u5236\u6bcf\u6b21full purge\u56de\u6536\u7684Undo\u9875\u7684\u6570\u91cf\u3002\u8be5\u53c2\u6570\u7684\u9ed8\u8ba4\u503c\u4e3a20\uff0c\u5e76\u53ef\u4ee5\u52a8\u6001\u5730\u5bf9\u5176\u8fdb\u884c\u4fee\u6539\u3002</p> <pre><code>mysql&gt; show variables like 'innodb_purge_batch_size';\n+-------------------------+-------+\n| Variable_name           | Value |\n+-------------------------+-------+\n| innodb_purge_batch_size | 20    |\n+-------------------------+-------+\n1 row in set (0.00 sec)\n</code></pre> <p>Master Thread\u7684\u4f2a\u4ee3\u7801\u53d8\u4e3a\u4e86\u4e0b\u9762\u7684\u5f62\u5f0f\uff1a</p> <pre><code>void master_thread()\n{\n    loop:\n    for(int i = 0; i &lt; 10; ++i){\n        thread_sleep(1);\n        do log buffer flush to disk;\n        if(last_one_second_ios &lt; 5%innodb_io_capacity)\n            do merge 5%innodb_io_capacity insert buffer;\n        if(buf_get_modified_ratio_pct &gt; innodb_max_dirty_pages_pct)\n            do buffer pool flush 100%innodb_io_capacity dirty page;\n        else if enable adaptive flush\n            do buffer pool flush desired amount dirty page;\n        if(no user activity)\n            goto backgroud loop;\n    }\n    if(last_ten_second_ios &lt; innodb_io_capacity)\n        do buffer pool flush 100%innodb_io_capacity dirty page;\n\n    do merge 5%innodb_io_capacity insert buffer;\n    do log buffer flush to disk;\n    do full purge;\n    if(buf_get_modified_ratio_pct &gt; 70%)\n        do buffer pool flush 100%innodb_io_capacity dirty page;\n    else\n        do buffer pool flush 10%innodb_io_capacity dirty page;\n\n    goto loop;\n    backgroud loop\uff1a\n    do full purge\n    do merge 100%innodb_io_capacity insert buffer;\n    if not idle\n        goto loop:\n    else\n        goto flush loop\n\n    flush loop:\n    do buffer pool flush 100%innodb_io_capacity dirty page;\n    if(buf_get_modified_ratio_pct &gt; innodb_max_dirty_pages_pct)\n        goto flush loop;\n\n    goto suspend loop;\n\n    suspend loop:\n    suspend_thread();\n    waiting event;\n    goto loop;\n}\n</code></pre> <p>\u8fd9\u4e2a\u7248\u672c\u7684\u6027\u80fd\u5f97\u5230\u4e86\u63d0\u9ad8\u3002</p> <pre><code>mysql&gt; show engine innodb status\\G\n*************************** 1. row ***************************\n  Type: InnoDB\n  Name: \nStatus: \n=====================================\n170312 20:14:04 INNODB MONITOR OUTPUT\n=====================================\nPer second averages calculated from the last 38 seconds\n-----------------\nBACKGROUND THREAD\n-----------------\nsrv_master_thread loops: 1 1_second, 1 sleeps, 0 10_second, 1 background, 1 flush\nsrv_master_thread log flush and writes: 1\n</code></pre> <p>\u53ef\u4ee5\u770b\u5230\u4e3b\u5faa\u73af\u8fdb\u884c\u4e861\u6b21\uff0c\u6bcf\u79d2\u7684\u64cd\u4f5c\u8fdb\u884c\u4e861\u6b21\uff0c10\u79d2\u4e00\u6b21\u7684\u64cd\u4f5c\u8fdb\u884c\u4e860\u6b21\uff0cbackgound loop\u8fdb\u884c\u4e861\u6b21\uff0cflush loop\u8fdb\u884c\u4e861\u6b21\u3002</p>"},{"location":"advanced/1.MySQL%E6%9E%B6%E6%9E%84%E5%88%B0InnoDB%E6%9E%B6%E6%9E%84/#innodb-12xmaster-thread_1","title":"InnoDB 1.2.x\u7248\u672c\u7684Master Thread","text":"<p>1.2.x\u7248\u672c\u4e2d\u518d\u6b21\u5bf9Master Thread\u8fdb\u884c\u4e86\u4f18\u5316\u3002 Master Thread\u7684\u4f2a\u4ee3\u7801\u5982\u4e0b\uff1a</p> <pre><code>if InnoDB is idle\n    srv_master_do_idle_tasks();\nelse\n    srv_master_do_active_tasks();\n</code></pre> <p>\u5176\u4e2dsrv_master_do_idle_tasks()\u5c31\u662f\u4e4b\u524d\u7248\u672c\u4e2d\u6bcf10\u79d2\u7684\u64cd\u4f5c\uff0csrv_master_do_active_tasks()\u5904\u7406\u7684\u662f\u4e4b\u524d\u6bcf\u79d2\u4e2d\u7684\u64cd\u4f5c\u3002\u540c\u65f6\uff0c\u5bf9\u4e8e\u5237\u65b0\u810f\u9875\u7684\u64cd\u4f5c\uff0c\u4eceMaster Thread\u7ebf\u7a0b\u5206\u79bb\u5230\u4e00\u4e2a\u5355\u72ec\u7684Page Cleaner Thread\uff0c\u4ece\u800c\u51cf\u8f7b\u4e86Master Thread\u7684\u5de5\u4f5c\uff0c\u540c\u65f6\u8fdb\u4e00\u6b65\u63d0\u9ad8\u4e86\u7cfb\u7edf\u7684\u5e76\u53d1\u6027\u3002</p>"},{"location":"advanced/1.MySQL%E6%9E%B6%E6%9E%84%E5%88%B0InnoDB%E6%9E%B6%E6%9E%84/#io-thread","title":"IO Thread","text":"<p>InnoDB\u4e2d\u5927\u91cf\u4f7f\u7528**AIO (Async IO)** \u6765\u5904\u7406IO\u8bf7\u6c42\u3002</p> <p>IO Thread\u7684\u4f5c\u7528\uff0c\u662f\u8d1f\u8d23\u8fd9\u4e9b IO \u8bf7\u6c42\u7684\u56de\u8c03\uff08call back\uff09</p> <p>\u53ef\u4f7f\u7528 <code>show engine innodb status</code>\u770b\u5230\u4ee5\u4e0b\u7c7b\u578b</p> <ul> <li>insert buffer thread</li> <li>log thread</li> <li>read thread\uff084\u4e2a\uff09</li> <li>write thread\uff084\u4e2a\uff09</li> </ul>"},{"location":"advanced/1.MySQL%E6%9E%B6%E6%9E%84%E5%88%B0InnoDB%E6%9E%B6%E6%9E%84/#purge-thread","title":"Purge Thread","text":""},{"location":"advanced/1.MySQL%E6%9E%B6%E6%9E%84%E5%88%B0InnoDB%E6%9E%B6%E6%9E%84/#_1","title":"\u4f5c\u7528","text":"<p>\u4e8b\u52a1\u88ab\u63d0\u4ea4\u540e\uff0c\u5176\u6240\u4f7f\u7528\u7684undo log\u53ef\u80fd\u4e0d\u5728\u9700\u8981\u3002\u56e0\u6b64\uff0c\u9700\u8981purge thread\u6765\u56de\u6536\u5df2\u7ecf\u4f7f\u7528\u5e76\u5206\u914d\u7684undo\u9875\u3002</p>"},{"location":"advanced/1.MySQL%E6%9E%B6%E6%9E%84%E5%88%B0InnoDB%E6%9E%B6%E6%9E%84/#_2","title":"\u6765\u5386","text":"<p>\u4ee5\u524dMaster Thread\u6765\u5b8c\u6210\u91ca\u653eundo log\uff0cInnoDB1.1\u72ec\u7acb\u51fa\u6765\uff0c\u5206\u62c5\u4e3b\u7ebf\u7a0b\u538b\u529b</p>"},{"location":"advanced/1.MySQL%E6%9E%B6%E6%9E%84%E5%88%B0InnoDB%E6%9E%B6%E6%9E%84/#purge-thread_1","title":"\u67e5\u770bpurge thread\u7684\u6570\u91cf","text":"<pre><code>mysql&gt; show variables like 'innodb_purge_threads';\n+----------------------+-------+\n| Variable_name        | Value |\n+----------------------+-------+\n| innodb_purge_threads | 4     |\n+----------------------+-------+\n1 row in set (0.02 sec)\n</code></pre>"},{"location":"advanced/1.MySQL%E6%9E%B6%E6%9E%84%E5%88%B0InnoDB%E6%9E%B6%E6%9E%84/#page-cleaner-thread","title":"Page Cleaner Thread","text":""},{"location":"advanced/1.MySQL%E6%9E%B6%E6%9E%84%E5%88%B0InnoDB%E6%9E%B6%E6%9E%84/#_3","title":"\u4f5c\u7528","text":"<p>**\u810f\u9875**\u5237\u65b0\u5230\u78c1\u76d8</p>"},{"location":"advanced/1.MySQL%E6%9E%B6%E6%9E%84%E5%88%B0InnoDB%E6%9E%B6%E6%9E%84/#_4","title":"\u6765\u5386","text":"<p>\u4ee5\u524dMaster Thread\u6765\u5237\u65b0\u810f\u9875\uff0cInnoDB1.2\u72ec\u7acb\u51fa\u6765\uff0c\u5206\u62c5\u4e3b\u7ebf\u7a0b\u538b\u529b</p>"},{"location":"advanced/2.InnoDB%E2%80%94%E2%80%94%E7%AE%80%E4%BB%8B/","title":"InnoDB\u7b80\u4ecb","text":""},{"location":"advanced/2.InnoDB%E2%80%94%E2%80%94%E7%AE%80%E4%BB%8B/#innodb_1","title":"\u4f7f\u7528InnoDB\u7684\u597d\u5904","text":"<ol> <li> <p>\u5982\u679c\u60a8\u7684\u670d\u52a1\u5668\u7531\u4e8e\u786c\u4ef6\u6216\u8f6f\u4ef6\u95ee\u9898\u800c\u610f\u5916\u9000\u51fa\uff0c\u65e0\u8bba\u5f53\u65f6\u6570\u636e\u5e93\u4e2d\u53d1\u751f\u4e86\u4ec0\u4e48\uff0c\u91cd\u65b0\u542f\u52a8\u6570\u636e\u5e93\u540e\u90fd\u4e0d\u9700\u8981\u6267\u884c\u4efb\u4f55\u7279\u6b8a\u64cd\u4f5c\u3002InnoDB<code>\u5d29\u6e83\u6062\u590d</code>\u4f1a\u81ea\u52a8\u63d0\u4ea4 \u5d29\u6e83\u4e4b\u524d\u5df2\u63d0\u4ea4 \u7684\u6240\u6709\u4e8b\u52a1\u5e76\u843d\u76d8\u6301\u4e45\u5316\uff0c\u5e76\u64a4\u6d88\u6240\u6709 \u6b63\u5728\u5904\u7406\u4f46\u5c1a\u672a\u63d0\u4ea4 \u7684\u4e8b\u52a1\u3002\u53ea\u9700\u91cd\u65b0\u542f\u52a8\u5e76\u4ece\u4e0a\u6b21\u4e2d\u65ad\u7684\u5730\u65b9\u7ee7\u7eed\u5373\u53ef\u3002</p> </li> <li> <p>InnoDB\u5b58\u50a8\u5f15\u64ce\u6709\u81ea\u5df1\u7684<code>\u7f13\u51b2\u6c60</code>\uff0c\u5728\u8bbf\u95ee\u6570\u636e\u65f6\u53ef\u4ee5\u5728\u4e3b\u5b58\u4e2d\u7f13\u5b58 \u8868 \u548c \u7d22\u5f15\u6570\u636e \u3002\u7ecf\u5e38\u4f7f\u7528\u7684\u6570\u636e\u76f4\u63a5\u4ece \u5185\u5b58 \u4e2d\u5904\u7406\u3002\u6b64\u7f13\u5b58\u9002\u7528\u4e8e\u8bb8\u591a\u7c7b\u578b\u7684\u4fe1\u606f\uff0c\u5e76\u52a0\u5feb\u5904\u7406\u901f\u5ea6\u3002\u5728\u4e13\u7528\u6570\u636e\u5e93\u670d\u52a1\u5668\u4e0a\uff0c\u901a\u5e38\u4f1a\u5c06\u9ad8\u8fbe 80% \u7684\u7269\u7406\u5185\u5b58\u5206\u914d\u7ed9\u7f13\u51b2\u6c60\u3002</p> </li> <li> <p>\u5982\u679c\u5c06\u76f8\u5173\u6570\u636e\u5206\u5272\u5230\u4e0d\u540c\u7684\u8868\u4e2d\uff0c\u5219\u53ef\u4ee5\u8bbe\u7f6e\u6267\u884c\u53c2\u7167\u5b8c\u6574\u6027\u7684<code>\u5916\u952e</code>\u3002\u66f4\u65b0\u6216\u5220\u9664\u6570\u636e\uff0c\u5176\u4ed6\u8868\u4e2d\u7684\u76f8\u5173\u6570\u636e\u5c06 \u81ea\u52a8 \u66f4\u65b0\u6216\u5220\u9664\u3002\u5982\u679c\u5c1d\u8bd5\u5c06\u6570\u636e\u63d2\u5165\u5230\u4e00\u4e2a\u8f85\u52a9\u8868\u4e2d\uff0c\u800c\u4e3b\u8868\u4e2d\u6ca1\u6709\u76f8\u5e94\u7684\u6570\u636e\uff0c\u90a3\u4e48 \u9519\u8bef\u7684\u6570\u636e\u5c06\u81ea\u52a8\u88ab\u8e22\u51fa \u3002</p> </li> <li> <p>\u5982\u679c\u6570\u636e\u5728\u78c1\u76d8\u6216\u5185\u5b58\u4e2d\u635f\u574f\uff0c\u5219<code>\u6821\u9a8c\u673a\u5236</code>\u4f1a\u5728\u4f7f\u7528\u524d\u63d0\u9192\u60a8\u6ce8\u610f\u865a\u5047\u6570\u636e\u3002</p> </li> <li> <p>\u5f53\u60a8\u4e3a\u6bcf\u4e2a\u8868\u4f7f\u7528\u9002\u5f53\u7684<code>\u4e3b\u952e</code>\u5217\u8bbe\u8ba1\u6570\u636e\u5e93\u65f6\uff0c\u6d89\u53ca\u8fd9\u4e9b\u5217\u7684\u64cd\u4f5c\u5c06 \u81ea\u52a8\u4f18\u5316 \u3002\u5728 WHERE \u5b50\u53e5\u3001 ORDER BY \u5b50\u53e5\u3001 GROUP BY \u5b50\u53e5\u548c join\u64cd\u4f5c \u4e2d\u5f15\u7528\u4e3b\u952e\u5217\u975e\u5e38\u5feb\u3002</p> </li> <li> <p>\u63d2\u5165\u3001\u66f4\u65b0\u548c\u5220\u9664\u7531\u4e00\u79cd\u79f0\u4e3a<code>change buffering</code>\u7684\u81ea\u52a8\u673a\u5236\u8fdb\u884c\u4f18\u5316\u3002InnoDB\u4e0d\u4ec5\u5141\u8bb8\u5bf9\u540c\u4e00\u4e2a\u8868\u5e76\u53d1\u8bfb\u548c\u5199\u8bbf\u95ee\uff0c\u5b83\u8fd8 \u7f13\u5b58\u4fee\u6539\u540e\u7684\u6570\u636e \u4ee5\u7b80\u5316\u78c1\u76d8I/O\u3002</p> </li> <li> <p><code>\u81ea\u9002\u5e94\u54c8\u5e0c\u7d22\u5f15</code>\u3002\u5f53\u4ece\u4e00\u4e2a\u8868\u4e2d\u4e00\u904d\u53c8\u4e00\u904d\u8bbf\u95ee\u76f8\u540c\u7684\u6570\u636e\u65f6\uff0cInnoDB\u4f1a\u81ea\u52a8\u5bf9\u8fd9\u4e9b\u6570\u636e\u5efa\u7acb\u81ea\u9002\u5e94\u54c8\u5e0c\u7d22\u5f15\uff0c\u5c31\u50cf\u4ece\u54c8\u5e0c\u8868\u4e2d\u67e5\u51fa\u6765\u4e00\u6837\u3002</p> </li> <li> <p>\u60a8\u53ef\u4ee5\u538b\u7f29\u8868\u548c\u5173\u8054\u7684\u7d22\u5f15\u3002</p> </li> <li> <p>\u60a8\u53ef\u4ee5\u521b\u5efa\u548c\u5220\u9664\u7d22\u5f15\uff0c\u800c\u5bf9\u6027\u80fd\u548c\u53ef\u7528\u6027\u7684\u5f71\u54cd\u8981\u5c0f\u5f97\u591a\u3002</p> </li> <li> <p>\u622a\u65ad\u8868\u7a7a\u95f4\u6587\u4ef6\u975e\u5e38\u5feb\uff0c\u53ef\u4ee5\u91ca\u653e\u78c1\u76d8\u7a7a\u95f4\u4f9b<code>\u64cd\u4f5c\u7cfb\u7edf</code>\u91cd\u7528\uff0c\u800c\u4e0d\u662f\u91ca\u653e\u53ea\u6709InnoDB\u624d\u80fd\u91cd\u7528\u7684<code>\u7cfb\u7edf\u8868\u7a7a\u95f4</code>\u5185\u7684\u7a7a\u95f4\u3002</p> </li> <li> <p>\u5bf9\u4e8e<code>BLOB</code>\u548c\u957f<code>TEXT</code>\u5b57\u6bb5\uff0c\u4f7f\u7528<code>\u52a8\u6001\u884c\u683c\u5f0f</code>\u7684\u8868\u6570\u636e\u7684\u5b58\u50a8\u5e03\u5c40\u66f4\u6709\u6548\u3002</p> </li> <li> <p>\u60a8\u53ef\u4ee5\u901a\u8fc7\u67e5\u8be2<code>INFORMATION_SCHEMA</code>\u8868\u6765\u76d1\u89c6\u5b58\u50a8\u5f15\u64ce\u7684\u5185\u90e8\u5de5\u4f5c\u3002</p> </li> <li> <p>\u60a8\u53ef\u4ee5\u901a\u8fc7<code>\u67e5\u8be2\u6027\u80fd\u6a21\u5f0f</code>\u8868\u6765\u76d1\u89c6\u5b58\u50a8\u5f15\u64ce\u7684\u6027\u80fd\u7ec6\u8282\u3002</p> </li> <li> <p>\u60a8\u53ef\u4ee5\u81ea\u7531\u5730\u5c06<code>InnoDB</code>\u8868\u4e0e\u5176\u4ed6MySQL\u5b58\u50a8\u5f15\u64ce\u7684\u8868\u6df7\u5408\u4f7f\u7528\uff0c\u5373\u4f7f\u5728\u540c\u4e00\u6761\u8bed\u53e5\u4e2d\u4e5f\u662f\u5982\u6b64\u3002\u4f8b\u5982\uff0c\u60a8\u53ef\u4ee5\u4f7f\u7528JOIN\u64cd\u4f5c\u5728\u5355\u4e2a\u67e5\u8be2\u4e2d\u5408\u5e76\u6765\u81ea<code>InnoDB</code>\u548c <code>MEMORY</code>\u8868\u7684\u6570\u636e\u3002</p> </li> <li> <p>InnoDB\u662f\u4e3a\u5904\u7406\u5927\u6570\u636e\u91cf\u65f6\u7684CPU\u6548\u7387\u548c\u6700\u9ad8\u6027\u80fd\u800c\u8bbe\u8ba1\u7684\u3002</p> </li> <li> <p>InnoDB\u8868\u53ef\u4ee5\u5904\u7406\u5927\u91cf\u6570\u636e\uff0c\u5373\u4f7f\u662f\u5728\u6587\u4ef6\u5927\u5c0f\u9650\u5236\u57282GB\u7684\u64cd\u4f5c\u7cfb\u7edf\u4e0a\u3002</p> </li> </ol>"},{"location":"advanced/2.InnoDB%E2%80%94%E2%80%94%E7%AE%80%E4%BB%8B/#innodb_2","title":"\u5982\u4f55\u4f7fInnoDB\u6027\u80fd\u66f4\u9ad8","text":"<ol> <li> <p>\u4e3a\u6bcf\u4e2a\u8868\u4e2d\u67e5\u8be2\u6700\u9891\u7e41\u7684\u4e00\u5217\u6216\u51e0\u5217\u6307\u5b9a\u4e00\u4e2a\u4e3b\u952e\uff0c\u5982\u679c\u6ca1\u6709\u660e\u663e\u7684\u4e3b\u952e\uff0c\u5219\u6307\u5b9a\u4e00\u4e2a \u81ea\u52a8\u9012\u589e\u7684\u503c \u3002</p> </li> <li> <p>\u4f7f\u7528join\u8fde\u63a5\u4ece\u591a\u4e2a\u8868\u4e2d\u6839\u636e\u76f8\u540c\u7684ID\u503c\u63d0\u53d6\u6570\u636e\u65f6\uff0c\u4e3a\u4e86\u63d0\u9ad8\u8fde\u63a5\u6027\u80fd\uff0c\u53ef\u4ee5\u5728\u8fde\u63a5\u5217\u4e0a\u5b9a\u4e49<code>\u5916\u952e</code>\uff0c\u5e76\u5728\u6bcf\u4e2a\u8868\u4e2d\u4f7f\u7528 \u76f8\u540c\u7684\u6570\u636e\u7c7b\u578b \u58f0\u660e\u8fd9\u4e9b\u5217\u3002 \u6dfb\u52a0\u5916\u952e\u53ef\u4ee5\u786e\u4fdd\u5f15\u7528\u7684\u5217\u88ab\u7d22\u5f15\uff0c\u8fd9\u53ef\u4ee5\u63d0\u9ad8\u6027\u80fd\u3002\u5916\u952e\u8fd8\u5c06 \u5220\u9664 \u6216 \u66f4\u65b0 \u4f20\u64ad\u5230\u6240\u6709\u53d7\u5f71\u54cd\u7684\u8868\uff0c\u5e76\u9632\u6b62\u5728\u7236\u8868\u4e2d\u6ca1\u6709\u5bf9\u5e94id\u7684\u60c5\u51b5\u4e0b\u5728\u5b50\u8868\u4e2d\u63d2\u5165\u6570\u636e\u3002</p> </li> <li> <p>\u5173\u95ed<code>\u81ea\u52a8\u63d0\u4ea4</code>\u3002\u6bcf\u79d2\u63d0\u4ea4\u6570\u767e\u6b21\u4f1a\u9650\u5236\u6027\u80fd(\u53d7\u5b58\u50a8\u8bbe\u5907\u7684\u5199\u5165\u901f\u5ea6\u9650\u5236)\u3002</p> </li> <li> <p>\u901a\u8fc7\u4f7f\u7528<code>START TRANSACTION</code>\u548c<code>COMMIT</code>\u8bed\u53e5\u5c06\u76f8\u5173\u7684DML\u64cd\u4f5csql\u5206\u7ec4\u5230\u4e8b\u52a1\u4e2d\u3002\u4e0d\u5efa\u8bae\u8fc7\u4e8e\u9891\u7e41\u5730\u63d0\u4ea4\uff0c\u4e5f\u4e0d\u5efa\u8bae\u53d1\u51fa\u4e00\u4e2a\u6279\u6b21\u4e2d\u542b\u6709\u5927\u91cf\u7684INSERT\u3001UPDATE\u6216DELETE\u8bed\u53e5\uff0c\u8fd9\u4e9b\u8bed\u53e5\u53ef\u80fd\u8fd0\u884c\u51e0\u4e2a\u5c0f\u65f6\u3002</p> </li> <li> <p>\u4e0d\u5efa\u8bae\u4f7f\u7528<code>LOCK TABLES</code> \u8bed\u53e5\u3002<code>InnoDB</code>\u53ef\u4ee5\u540c\u65f6\u5904\u7406\u5bf9\u540c\u4e00\u4e2a\u8868\u8fdb\u884c\u8bfb\u5199\u7684\u591a\u4e2a\u4f1a\u8bdd\uff0c\u800c\u65e0\u9700\u727a\u7272\u53ef\u9760\u6027\u6216\u9ad8\u6027\u80fd\u3002\u8981\u83b7\u5f97\u5bf9\u4e00\u7ec4\u884c\u7684\u6392\u4ed6\u6027\u5199\u8bbf\u95ee\u6743\u9650\uff0c\u8bf7\u4f7f\u7528 <code>SELECT ... FOR UPDATE</code>\u8bed\u6cd5\u4ec5\u9501\u5b9a\u8981\u66f4\u65b0\u7684\u884c\u3002</p> </li> <li> <p>\u542f\u7528<code>innodb_file_per_table</code>\u9009\u9879\uff0c\u6216\u8005\u4f7f\u7528\u5e38\u89c4<code>\u8868\u7a7a\u95f4</code>\u5c06\u8868\u7684<code>\u6570\u636e</code>\u548c<code>\u7d22\u5f15</code>\u653e\u5728 \u5355\u72ec\u7684\u6587\u4ef6 \u4e2d\uff0c\u800c\u4e0d\u662f<code>\u7cfb\u7edf\u8868\u7a7a\u95f4</code>\u4e2d\u3002  \u9ed8\u8ba4\u60c5\u51b5\u4e0b<code>innodb_file_per_table</code>\u9009\u9879\u662f\u542f\u7528\u7684\u3002</p> </li> <li> <p>\u8bc4\u4f30\u60a8\u7684\u6570\u636e\u548c\u8bbf\u95ee\u6a21\u5f0f\u662f\u5426\u53ef\u4ee5\u4ece<code>InnoDB</code>\u8868\u6216\u9875\u9762\u538b\u7f29\u529f\u80fd\u4e2d\u53d7\u76ca\u3002\u60a8\u53ef\u4ee5\u5728<code>InnoDB</code>\u4e0d\u727a\u7272\u8bfb/\u5199\u529f\u80fd\u7684\u60c5\u51b5\u4e0b\u538b\u7f29\u8868\u3002</p> </li> <li> <p>\u4f7f\u7528\u9009\u9879<code>sql_mode=NO_ENGINE_SUBSTITUTION</code>\u8fd0\u884c\u670d\u52a1\u5668\uff0c\u4ee5\u9632\u6b62\u5728CREATE TABLE\u7684engine =\u5b50\u53e5\u4e2d\u6307\u5b9a\u7684\u5f15\u64ce\u51fa\u73b0\u95ee\u9898\u65f6\u4f7f\u7528\u4e0d\u540c\u7684\u5b58\u50a8\u5f15\u64ce\u521b\u5efa\u8868\u3002</p> </li> </ol>"},{"location":"advanced/3.InnoDB%E2%80%94%E2%80%94%E5%85%B3%E9%94%AE%E7%89%B9%E6%80%A7/","title":"InnoDB\u7684\u5173\u952e\u7279\u6027","text":""},{"location":"advanced/3.InnoDB%E2%80%94%E2%80%94%E5%85%B3%E9%94%AE%E7%89%B9%E6%80%A7/#insert-buffer-","title":"Insert Buffer - \u63d2\u5165\u7f13\u51b2","text":"<p>\u4ee5\u4e0b\u5185\u5bb9\u5f15\u81ea InnoDB\u7684\u5173\u952e\u7279\u6027</p> <p>\u56de\u987e\u4e00\u4e0b\uff0cInnoDB\u662f\u7d22\u5f15\u7ec4\u7ec7\u8868\uff0c\u4e3b\u952e\u662f\u552f\u4e00\u6807\u8bc6\u3002</p> <p>\u5728\u6570\u636e\u91cf\u8f83\u5c0f\u7684\u7cfb\u7edf\u4e2d\u7ecf\u5e38\u4f7f\u7528\u7684\u81ea\u589eID\u505a\u4e3a\u4e3b\u952e\uff0c\u5229\u7528\u6570\u636e\u5e93\u7684\u81ea\u589eID\uff0c\u4ece1\u5f00\u59cb\uff0c\u57fa\u672c\u53ef\u4ee5\u505a\u5230\u8fde\u7eed\u9012\u589e\u3002</p> <p>\u4f46\u662f\u5bf9\u4e8e\u6709\u591a\u4e2a\u4e8c\u7ea7\u7d22\u5f15\u7684\u8868\uff0c\u4e8c\u7ea7\u7d22\u5f15\u7684\u53f6\u5b50\u8282\u70b9\u7684\u6570\u636e\u63d2\u5165\uff0c\u5c31\u4e0d\u662f\u987a\u5e8f\u7684\u4e86\u3002</p>"},{"location":"advanced/3.InnoDB%E2%80%94%E2%80%94%E5%85%B3%E9%94%AE%E7%89%B9%E6%80%A7/#insert-buffer","title":"Insert Buffer\u7684\u4f5c\u7528","text":"<p>\u63d2\u5165\u7f13\u51b2\u662f\u4e3a\u4e86 \u63d0\u9ad8\u63d2\u5165\u6570\u636e\u6548\u7387 \u7684\uff0c\u5728\u5f80\u975e\u805a\u7c07\u7d22\u5f15\u4e2d\u63d2\u5165\u6570\u636e\u65f6\uff0c\u9996\u5148\u4f1a\u770b\u7f13\u51b2\u6c60\u4e2d\uff0c\u662f\u5426\u6709\u8981\u63d2\u5165\u7684\u975e\u805a\u7c07\u7d22\u5f15\u9875\u3002\u5982\u679c\u6709\u5219\u76f4\u63a5\u63d2\u5165\uff0c\u90a3\u4e2a\u9875\u53d8\u6210\u810f\u9875\u3002\u5982\u679c\u6ca1\u6709\uff0c\u5c31\u628a \u591a\u6b21\u63d2\u5165\u7684\u6570\u636e\u5148\u7f13\u51b2\u5230\u63d2\u5165\u7f13\u51b2\u4e2d \uff0c\u7136\u540e \u5408\u5e76\u591a\u6b21\u64cd\u4f5c \uff0c\u5373\u628a\u975e\u805a\u96c6\u7d22\u5f15\u5728\u4e00\u8d77\u7684\u6570\u636e\u5408\u5e76\u4e3a\u4e00\u6b21IO\uff08\u51cf\u5c11IO\uff09\uff0c\u518d\u4ee5\u4e00\u5b9a\u7684\u9891\u7387\u5237\u65b0\u5230\u78c1\u76d8(\u5c06Insert Buffer\u548c\u8f85\u52a9\u7d22\u5f15\u9875\u5b57\u8282\u70b9\u8fdb\u884cmerge\u64cd\u4f5c)\uff0c\u4f46\u662f\u63d2\u5165\u7f13\u51b2\u53ea\u662f\u9488\u5bf9 \u975e\u805a\u96c6\u7d22\u5f15\u6ca1\u6709\u975e\u552f\u4e00\u7ea6\u675f\u7684\u7d22\u5f15 \u7684\u63d2\u5165\u6709\u6548\u3002</p> <p>\uff08\u7c7b\u4f3c\u4e8eMRR\uff0c\u968f\u673aIO\u53d8\u987a\u5e8fIO\uff09</p>"},{"location":"advanced/3.InnoDB%E2%80%94%E2%80%94%E5%85%B3%E9%94%AE%E7%89%B9%E6%80%A7/#_1","title":"\u4ec0\u4e48\u662f\u805a\u96c6\u7d22\u5f15/\u975e\u805a\u96c6\u7d22\u5f15","text":"<p>InnoDB\u7684\u6570\u636e\u662f\u6309\u4e3b\u952e\u7684\u7d22\u5f15\u7684\u987a\u5e8f\u6765\u5b58\u653e\u6570\u636e\u7684\uff0c\u8fd9\u79cd\u7d22\u5f15\u88ab\u79f0\u4e3a\u805a\u96c6\u7d22\u5f15\uff0c\u4e00\u4e2a\u8868\u6709\u4e14\u53ea\u6709\u4e00\u4e2a\u805a\u96c6\u7d22\u5f15\u3002\u4f46\u6211\u4eec\u53ef\u4ee5\u4e3a\u4e00\u4e2a\u8868\u521b\u5efa\u591a\u4e2a\u7d22\u5f15\uff0c\u8fd9\u4e9b\u7d22\u5f15\u88ab\u79f0\u4e3a\u975e\u805a\u96c6\u7d22\u5f15\uff0c\u6216\u8005\u8f85\u52a9\u7d22\u5f15\u3002\u8fd9\u4e9b\u7d22\u5f15\u662f\u5b58\u653e\u5728\u53e6\u5916\u7684\u7d22\u5f15\u9875\u7684\uff0c\u8ddf\u5b9e\u9645\u6570\u636e\u7684\u5b58\u653e\u662f\u6ca1\u6709\u5173\u7cfb\u7684\u3002\u975e\u805a\u96c6\u7d22\u5f15\u8bb0\u5f55\u7684\u662f\u7d22\u5f15\u5217\u7684\u6570\u636e\uff0c\u4e0d\u662f\u5168\u90e8\u7684\u5217\u3002</p> <p>\u5982\u679c\u4e0d\u4e86\u89e3\u805a\u96c6\u7d22\u5f15\uff0c\u6709\u53ef\u80fd\u4f1a\u88ab\u7ed5\u6655\uff0c\u4f46\u662f\uff0c\u81f3\u5c11\u53ef\u4ee5\u5f97\u51fa\u4e00\u4e2a\u7ed3\u8bba\uff0c\u5c31\u662f\u805a\u96c6\u7d22\u5f15\u662f\u6309\u987a\u5e8f\u5b58\u653e\u7684\uff0c\u800c\u975e\u805a\u96c6\u7d22\u5f15\u662f\u6ca1\u6709\u5fc5\u7136\u7684\u987a\u5e8f\u7684\u3002\u8fd9\u5c31\u5bfc\u81f4\u4e00\u4e2a\u95ee\u9898\uff0c\u5f53\u63d2\u5165\u4e00\u6761\u6570\u636e\u65f6\uff0c\u66f4\u65b0\u975e\u805a\u96c6\u7d22\u5f15\u65f6\uff0c\u5fc5\u987b\u5230\u5904\u53bb\u627e\u975e\u805a\u96c6\u7d22\u5f15\u6240\u5728\u7684\u9875\uff08\u4e5f\u79f0\u4e3a\u79bb\u6563\u5199\uff09\uff0c\u8fd9\u6837\u7684\u63d2\u5165\u6548\u7387\u5c31\u6bd4\u8f83\u4f4e\u4e86\u3002</p>"},{"location":"advanced/3.InnoDB%E2%80%94%E2%80%94%E5%85%B3%E9%94%AE%E7%89%B9%E6%80%A7/#_2","title":"\u4e3a\u4ec0\u4e48\u5fc5\u987b\u662f\u6ca1\u6709\u552f\u4e00\u7ea6\u675f\u7684","text":"<p>\u5982\u679c\u8be5\u975e\u805a\u96c6\u7d22\u5f15\u6709\u552f\u4e00\u7ea6\u675f\uff0c\u90a3\u4e48\u4e3a\u4e86\u4fdd\u8bc1\u552f\u4e00\u6027\uff0c\u5fc5\u987b\u6bcf\u6b21\u63d2\u5165\u524d\u90fd\u53bb\u67e5\u8be2\u662f\u5426\u5b58\u5728\u76f8\u540c\u7684\u6570\u636e\uff0c\u8fd9\u65f6\u5c31\u5fc5\u987b\u5230\u78c1\u76d8\u5230\u5904\u627e\u662f\u5426\u5b58\u5728\u8be5\u503c\uff08\u4e5f\u79f0\u4e3a\u79bb\u6563\u8bfb\uff09\uff0c\u8fd9\u5c31\u5bfc\u81f4\u63d2\u5165\u7f13\u51b2\u5931\u6548\u4e86\u3002</p> <p>\u63d2\u5165\u7f13\u51b2\u662f\u4e3a\u4e86\u89e3\u51b3\u975e\u805a\u96c6\u7d22\u5f15\u968f\u673a\u5199\u5bfc\u81f4\u7684\u6548\u7387\u4f4e\u7684\u95ee\u9898\uff0c\u4f46\u662f\u5bf9\u4e8e\u6709\u552f\u4e00\u7ea6\u675f\u7684\u975e\u805a\u96c6\u7d22\u5f15\u4e5f\u65e0\u80fd\u4e3a\u529b\u3002</p>"},{"location":"advanced/3.InnoDB%E2%80%94%E2%80%94%E5%85%B3%E9%94%AE%E7%89%B9%E6%80%A7/#_3","title":"\u79bb\u6563\u8bfb/\u5199\u6548\u7387\u771f\u7684\u5f88\u6162\u5417","text":"<p>\u5728\u673a\u68b0\u786c\u76d8\u91cc\uff0c\u79bb\u6563\u8bfb\u5fc5\u987b\u8981\u79fb\u52a8\u78c1\u5934\uff0c\u6240\u4ee5\u901f\u5ea6\u771f\u7684\u5f88\u6162\uff0c\u4f46\u662f\u968f\u7740\u56fa\u6001\u786c\u76d8\u7684\u53d1\u5c55\uff0c\u4e5f\u8bb8\u8fd9\u4e2a\u5c31\u4e0d\u662f\u95ee\u9898\u4e86\u3002\u56fa\u6001\u786c\u76d8\u7684\u968f\u673a\u8bfb\u5199\u80fd\u529b\u5f88\u5f3a\uff0c\u800c\u4e14\u73b0\u5728\u56fa\u6001\u786c\u76d8\u7684\u4ef7\u683c\u4e5f\u4f4e\u4e86\u4e0d\u5c11\u3002\u4e0d\u8fc7\u8981\u8ba9mysql\u652f\u6301\u56fa\u6001\u786c\u76d8\uff0c\u53ef\u80fd\u8fd8\u6709\u914d\u7f6e\u4e0d\u5c11\u53c2\u6570\uff0c\u76f4\u63a5\u4e0a\u56fa\u6001\u786c\u76d8\u4f3c\u4e4e\u6548\u679c\u4e0d\u660e\u663e\u5462\u3002</p> <p></p>"},{"location":"advanced/3.InnoDB%E2%80%94%E2%80%94%E5%85%B3%E9%94%AE%E7%89%B9%E6%80%A7/#_4","title":"\u5e26\u6765\u7684\u4e00\u4e2a\u95ee\u9898","text":"<p>\u5728\u5199\u5bc6\u96c6\u7684\u60c5\u51b5\u4e0b\uff0c\u63d2\u5165\u7f13\u51b2\u4f1a\u5360\u7528\u8fc7\u591a\u7684\u7f13\u51b2\u6c60\u5185\u5b58\uff0c\u9ed8\u8ba4\u6700\u5927\u53ef\u4ee5\u5360\u7528\u00bd\u7684\u7f13\u51b2\u6c60\u5185\u5b58\uff0c\u4fee\u6b63\u8fd9\u4e2a\u95ee\u9898\u53ef\u4ee5\u4fee\u6539\u9ed8\u8ba4\u503c\u5bf9\u63d2\u5165\u7f13\u51b2\u7684\u5927\u5c0f\u8fdb\u884c\u63a7\u5236\u3002</p> <ul> <li>innodb1.0.x\u7248\u672c\uff1a\u5bf9insert buffer\u5347\u7ea7\u4e3achange buffer\uff0c\u5176\u4f7f\u7528\u7684\u5bf9\u8c61\u4f9d\u7136\u662f\u975e\u552f\u4e00\u7684\u8f85\u52a9\u7d22\u5f15\uff0c\u4ece\u8fd9\u4e2a\u7248\u672c\u5f00\u59cb\uff0cinnodb\u5b58\u50a8\u5f15\u64ce\u53ef\u4ee5\u5bf9**DML**(\u6570\u636e\u64cd\u4f5c\u8bed\u8a00)\u64cd\u4f5c---insert  delete  update**\u8fdb\u884c\u7f13\u51b2\uff0c\u5206\u522b\u662f**insert  buffer \u3001delete buffer\u3001purge buffer,\u5e76\u63d0\u4f9b\u53c2\u6570**innodb_change_buffering**\u7528\u6765\u5f00\u542f\u5404\u79cdbuffer\u7684\u9009\u9879\uff0c\u53ef\u9009\u503c\u4e3ainserts\u3001deletes\u3001purges\u3001changes(\u8868\u793a\u542f\u7528inserts\u548cdeletes)\u3001all(\u8868\u793a\u542f\u7528\u6240\u6709)\u3001none(\u8868\u793a\u90fd\u4e0d\u542f\u7528)\uff0c\u9ed8\u8ba4\u4e3aall</li> </ul> <pre><code>mysql&gt; show variables like 'innodb_change_buffering';\n+-------------------------+-------+\n| Variable_name           | Value |\n+-------------------------+-------+\n| innodb_change_buffering | all   |\n+-------------------------+-------+\n1 row in set, 1 warning (0.00 sec)\n</code></pre> <ul> <li>innodb 1.2.x\u7248\u672c\uff1a\u901a\u8fc7\u53c2\u6570innodb_change_buffer_max_size\u6765\u63a7\u5236change buffer\u6700\u5927\u4f7f\u7528\u5185\u5b58\u7684\u6570\u91cf\uff0c\u9ed8\u8ba4\u4e3a25\uff0c\u8868\u793a\u6700\u591a\u4f7f\u7528\u00bc\u7684\u7f13\u51b2\u6c60\u5185\u5b58\u7a7a\u95f4\uff0c\u8be5\u53c2\u6570\u6700\u5927\u6709\u6548\u503c\u4e3a50.</li> </ul> <pre><code>mysql&gt; show variables like 'innodb_change_buffer_max_size';\n+-------------------------------+-------+\n| Variable_name                 | Value |\n+-------------------------------+-------+\n| innodb_change_buffer_max_size | 25    |\n+-------------------------------+-------+\n1 row in set, 1 warning (0.00 sec)\n</code></pre>"},{"location":"advanced/3.InnoDB%E2%80%94%E2%80%94%E5%85%B3%E9%94%AE%E7%89%B9%E6%80%A7/#insert-buffer_1","title":"Insert Buffer\u5185\u90e8\u5b9e\u73b0","text":"<p>insert buffer\u5185\u90e8\u662f\u4e00\u9897B+\u6811\uff0cMySQL4.1\u4e4b\u524d\u662f\u6bcf\u5f20\u8868\u6709\u4e00\u9897insert buffer B+\u6811\uff0c\u800c\u73b0\u5728\u7684\u7248\u672c\u662f\u5168\u5c40\u53ea\u6709\u4e00\u9897B+\u6811\uff0c\u8d1f\u8d23\u5bf9\u6240\u6709\u7684\u8868\u7684\u8f85\u52a9\u7d22\u5f15\u8fdb\u884cinsert buffer, \u8fd9\u9897B+\u6811\u5b58\u653e\u5728\u5171\u4eab\u8868\u7a7a\u95f4\u4e2d\uff0c\u5373ibdata1\u4e2d\u3002</p> <p><code>Insert Buffer</code>\u4e2dB+\u6811\u7684\u975e\u53f6\u5b50\u8282\u70b9\u4e2d\u5b58\u653e\u7684\u662f\u67e5\u8be2\u7684<code>serarch key</code>\uff08\u952e\u503c\uff09\uff0c\u7ed3\u6784\u5982\u4e0b\u56fe\u6240\u793a</p> <pre><code>+-------+--------+--------+\n| space | marker | offset |\n+-------+--------+--------+\n</code></pre> <p>search key\u4e00\u5171\u5360\u67099\u4e2a\u5b57\u8282:</p> <ul> <li>**space**\u8868\u793a\u5f85\u63d2\u5165\u8bb0\u5f55\u6240\u5728\u8868\u7684\u8868\u7a7a\u95f4id,\u5360\u75284\u4e2a\u5b57\u8282\uff0c\u6bcf\u4e2a\u8868\u6709\u552f\u4e00\u7684space id,\u53ef\u901a\u8fc7space id\u67e5\u8be2\u662f\u54ea\u5f20\u8868\uff0c</li> <li>**marker**\u5360\u75281\u5b57\u8282\uff0c\u7528\u6765\u517c\u5bb9\u8001\u7248\u672c\u7684insert buffer,</li> <li>**offset**\u8868\u793a\u9875\u6240\u5728\u7684\u504f\u79fb\u91cf\uff0c\u5360\u75284\u5b57\u8282\u3002</li> </ul> <p>\u5f53\u4e00\u4e2a\u8f85\u52a9\u7d22\u5f15\u8981\u63d2\u5165\u5230\u9875\uff08space\uff0coffset\uff09\u65f6\uff0c\u5982\u679c\u8fd9\u4e2a\u9875\u4e0d\u5728\u7f13\u51b2\u6c60\u4e2d\uff0c\u5219\u6309\u7167\u4e0a\u8ff0\u7ed3\u6784\u6784\u9020\u4e00\u4e2asearch key\uff0c\u7136\u540e\u67e5\u8be2Insert Buffer\u7684B+\u6811\uff0c\u5c06\u8fd9\u6761\u8bb0\u5f55\u63d2\u5165\u5230Insert BufferB+\u6811\u4e2d\u3002</p> <p>\u5bf9\u4e8eInsert Buffer\u7684B+\u6811\u7684\u53f6\u5b50\u8282\u70b9\uff0c\u5e76\u975e\u53ea\u6709\u8bb0\u5f55\uff0c\u800c\u662f\u5982\u4e0b\u6240\u793a\uff1a</p> <pre><code>+-------+--------+--------+----------+-----------+-----------+\n| space | marker | offset | metadata | \u8f85\u52a9\u7d22\u5f15\u503c |    ...    |\n+-------+--------+--------+----------+-----------+-----------+\n</code></pre> <p>\u524d\u9762\u548c\u975e\u53f6\u5b50\u7ed3\u70b9\u7684\u542b\u4e49\u76f8\u540c\uff0c\u4e00\u5171\u5360\u75289\u4e2a\u5b57\u8282\uff0cmetadata\u5360\u75284\u4e2a\u5b57\u8282\uff0c\u4ece\u7b2c5\u5217\u5f00\u59cb\uff0c\u5c31\u662f\u5b9e\u9645\u63d2\u5165\u8bb0\u5f55\u7684\u5404\u4e2a\u5b57\u6bb5\u4e86\uff0c\u6240\u4ee5\u4e0e\u539f\u63d2\u5165\u8bb0\u5f55\u76f8\u6bd4\u8f83\uff0cB+\u6811\u7684\u53f6\u5b50\u8282\u70b9\u8bb0\u5f55\u9700\u8981\u989d\u5916\u8bb0\u5f5513\u5b57\u8282\u7684\u5f00\u9500</p> <p>metadata\u4e2d\u5b58\u50a8\u7684\u5185\u5bb9</p> \u540d\u79f0 \u5b57\u8282 \u542b\u4e49 IBUF_REC_OFFSET_COUONT 2 \u5bf9\u6bcf\u4e2a\u8fdb\u5165Insert Buffer\u7684\u8bb0\u5f55\u8fdb\u884c\u6392\u5e8f IBUF_REC_OFFSET_TYPE 1 \u6bcf\u4e2a\u8fdb\u5165Insert Buffer\u7684\u8bb0\u5f55\u7c7b\u578b IBUF_REC_OFFSET_FLAGS 1 \u6bcf\u4e2a\u8fdb\u5165Insert Buffer\u7684\u8bb0\u5f55\u6807\u8bb0"},{"location":"advanced/3.InnoDB%E2%80%94%E2%80%94%E5%85%B3%E9%94%AE%E7%89%B9%E6%80%A7/#insert-buffer-bitmap","title":"Insert Buffer BitMap","text":"<p>\u56e0\u4e3a\u542f\u7528Insert Buffer\u4e4b\u540e\uff0c\u8f85\u52a9\u7d22\u5f15\u9875\uff08space\uff0coffset\uff09\u53ef\u80fd\u88ab\u8bb0\u5f55\u5230Insert Buffer\u7684B+\u6811\u4e2d\uff0c\u6240\u4ee5\u4e3a\u4e86\u4fdd\u8bc1\u6bcf\u6b21Merge Insert Buffer\u5fc5\u987b\u6210\u529f\uff0c\u9700\u8981\u4e00\u4e2a\u7279\u6b8a\u7684\u9875\u6765\u6807\u8bb0\u6bcf\u4e2a\u8f85\u52a9\u7d22\u5f15\u9875\uff08space\uff0coffset\uff09\u7684\u53ef\u7528\u7a7a\u95f4\u3002</p> <p>\u6bcf\u4e2aInsert Buffer BitMap\u9875\u7528\u6765\u8ffd\u8e2a16384\u4e2a\u8f85\u52a9\u7d22\u5f15\uff0c\u4e5f\u5c31\u662f256\u4e2a\u533a(Extent)\u3002\u6bcf\u4e2aInsert Buffer BitMap\u572816384\u4e2a\u9875\u7684\u7b2c\u4e8c\u9875\u4e2d\u3002</p> <p>\u76f8\u5173\u77e5\u8bc6\u70b9\uff1a</p> <ul> <li>\u6bcf\u4e2a\u533a64\u9875\uff0c\u4e00\u987516KB\uff0c\u4e00\u4e2a\u533a\u6240\u5360\u5927\u5c0f\u4e3a\uff1a 16 * 64 = 1024KB = 1M</li> <li>256\u4e2a\u533a\uff0c\u4e00\u4e2a\u533a64\u9875\uff0c\u5219\u4e00\u4e2aBiMap\u53ef\u4ee5\u8ffd\u8e2a\u7684\u9875\u4e3a\uff1a256 * 64 = 16384</li> </ul> <p>\u6bcf\u4e2a\u8f85\u52a9\u7d22\u5f15\u9875\u5728Insert Buffer BitMap\u4e2d\uff0c\u5360\u75284\u4f4d\uff08bit\uff09\uff0c\u7531\u4e0b\u8868\u4e09\u90e8\u5206\u7ec4\u6210</p> \u540d\u79f0 \u5927\u5c0f \u8bf4\u660e IBF_BITMAP_FREE 2 \u8868\u793a\u8be5\u8f85\u52a9\u7d22\u5f15\u9875\u53ef\u7528\u7a7a\u95f4\u6570\u91cf\uff0c\u53ef\u53d6\u503c\u4e3a0\u8868\u793a\u65e0\u53ef\u7528\u7a7a\u95f41\u8868\u793a\u5269\u4f59\u7a7a\u95f4 &gt; 1/32 \u9875\uff08512\u5b57\u8282\uff092\u8868\u793a\u5269\u4f59\u7a7a\u95f4 &gt; 1/16 \u98753\u8868\u793a\u5269\u4f59\u7a7a\u95f4 &gt; \u215b \u9875 IBF_BITMAP_BUFFERED 1 1\u8868\u793a\u8be5\u8f85\u52a9\u7d22\u5f15\u9875\u6709\u8bb0\u5f55\u88ab\u7f13\u5b58\u5728Insert Buffer B+\u6811\u4e2d IBF_BITMAP_IBUF 1 1\u8868\u793a\u8be5\u9875\u4e3aInsert Buffer B+\u6811\u7684\u7d22\u5f15\u9875 <p>\u76f8\u5173\u77e5\u8bc6\u70b9\uff1a</p> <ul> <li>\u4e3a\u4ec0\u4e48\u4e00\u4e2a\u9875\u4e2d\uff0c\u81f3\u5c11\u8981\u6709 1/32 \u7684\u5269\u4f59\u7a7a\u95f4\uff1f   \u6309\u7167\u4e00\u822c\u60c5\u51b5\u6765\u8bf4\uff0c\u4e00\u9875\u4e3a16K\uff0c16 * 1024 / 32 = 512 B\u3002\u4ece\u78c1\u76d8\u7684\u7269\u7406\u7ed3\u6784\u6765\u770b\u5b58\u53d6\u4fe1\u606f\u7684\u6700\u5c0f\u5355\u4f4d\u662f\u6247\u533a\uff0c\u4e00\u4e2a\u6247\u533a\u5927\u5c0f\u4e3a 512 B.</li> </ul>"},{"location":"advanced/3.InnoDB%E2%80%94%E2%80%94%E5%85%B3%E9%94%AE%E7%89%B9%E6%80%A7/#merge-insert-buffer-insert-buffermerge","title":"Merge Insert Buffer \u2014\u2014 \u4ee5\u4e00\u5b9a\u7684\u9891\u7387\u5237\u65b0\u5230\u78c1\u76d8(\u5c06Insert Buffer\u548c\u8f85\u52a9\u7d22\u5f15\u9875\u5b57\u8282\u70b9\u8fdb\u884cmerge\u64cd\u4f5c)","text":"<p>merge insert buffer \u7684\u64cd\u4f5c\u53ef\u80fd\u4f1a\u53d1\u751f\u5728\u4ee5\u4e0b\u51e0\u79cd\u60c5\u51b5\uff1a</p> <ol> <li>\u8f85\u52a9\u7d22\u5f15\u9875\u88ab\u8bfb\u53d6\u5230\u7f13\u51b2\u6c60\u65f6\u3002\u4f8b\u5982\u6267\u884c\u6b63\u5e38\u7684SELECT \u64cd\u4f5c\uff0c\u8fd9\u65f6\u9700\u8981\u68c0\u67e5Insert BufferBitMap\u9875\uff0c\u786e\u8ba4\u8be5\u8f85\u52a9\u7d22\u5f15\u9875\u662f\u5426\u6709\u8bb0\u5f55\u5b58\u653e\u4e8eInsert Buffer B+\u6811\u4e2d\uff0c\u82e5\u6709\uff0c\u5219\u5c06Insert Buffer B+\u6811\u4e2d\u7684\u8bb0\u5f55\u63d2\u5165\u5230\u8be5\u8f85\u52a9\u7d22\u5f15\u9875\u4e2d\u3002</li> <li>insert buffer bitmap\u8ffd\u8e2a\u5230\u8be5\u8f85\u52a9\u7d22\u5f15\u9875\u5df2\u65e0\u53ef\u7528\u7a7a\u95f4\u65f6\uff08\u542f\u7528insert  buffer\u540e\uff0c\u8f85\u52a9\u7d22\u5f15\u9875\u4e2d\u7684\u8bb0\u5f55\u53ef\u80fd\u88ab\u63d2\u5165\u5230insert buffer B+\u6811\u4e2d\uff0c\u4e3a\u4e86\u4fdd\u8bc1\u6bcf\u6b21\u7684merge insert buffer\u9875\u6210\u529f\uff0c\u901a\u8fc7insert buffer bitmap\u7c7b\u578b\u7684\u7279\u6b8a\u9875\u6765\u8bb0\u5f55\u8f85\u52a9\u7d22\u5f15\u9875\u7684\u53ef\u7528\u7a7a\u95f4\uff09\uff0c\u5e76\u81f3\u5c11\u5f97\u7531**1/32** \u7684\u53ef\u7528\u7a7a\u95f4\u3002\u82e5\u5f80\u8f85\u52a9\u7d22\u5f15\u9875\u63d2\u5165\u4e00\u6761\u8bb0\u5f55\u540e\uff0c\u53d1\u73b0\u7a7a\u95f4\u5c11\u4e8e 1/32 \uff0c\u5219\u4f1a\u5f3a\u5236\u8bfb\u53d6\u8f85\u52a9\u7d22\u5f15\u9875\uff0c\u5c06Insert Buffer B+\u6811\u4e2d\uff0c\u8be5\u9875\u7684\u8bb0\u5f55\u63d2\u5165\u5230\u8f85\u52a9\u7d22\u5f15\u9875\u4e2d\u3002    \uff08\u4e3a\u4ec0\u4e48\u662f 1/32\uff1f\uff09</li> <li>master thread:\u6b64\u7ebf\u7a0b\u4e2d\u6bcf\u79d2\u6216\u8005\u6bcf10\u79d2\u8fdb\u884c\u4e00\u6b21merge insert buffer\u64cd\u4f5c\uff0c\u4e0d\u540c\u4e4b\u5904\u5728\u4e8e\u6bcf\u6b21merge\u7684\u6570\u91cf\u4e0d\u4e00\u6837\u3002</li> </ol>"},{"location":"advanced/3.InnoDB%E2%80%94%E2%80%94%E5%85%B3%E9%94%AE%E7%89%B9%E6%80%A7/#double-write-","title":"Double Write - \u4e24\u6b21\u5199","text":""},{"location":"advanced/3.InnoDB%E2%80%94%E2%80%94%E5%85%B3%E9%94%AE%E7%89%B9%E6%80%A7/#doublewrite","title":"Doublewrite\u67b6\u6784","text":"<p>Doublewrite Buffer\u88abMySQL\u653e\u5728\u5b98\u65b9\u6587\u6863\u76ee\u5f55\u7684 \"InnoDB On-Disk Structures\" \u4e2d\u4e86\uff0c\u4f46\u771f\u5b9e\u60c5\u51b5\u662fDoublewrite Buffer\u662f\u5185\u5b58+\u78c1\u76d8\u7684\u7ed3\u6784\u3002</p>"},{"location":"advanced/3.InnoDB%E2%80%94%E2%80%94%E5%85%B3%E9%94%AE%E7%89%B9%E6%80%A7/#_5","title":"\u80cc\u666f","text":"<p>\u64cd\u4f5c\u7cfb\u7edf\u53ef\u4ee5\u770b\u6210\u662f\u4e00\u4e2a\u7a0b\u5e8f\uff0c\u4f5c\u4e3a\u7a0b\u5e8f\u800c\u8a00\uff0c\u90fd\u6709\u6700\u5c0f\u5904\u7406\u5355\u4f4d\u7684\u8bf4\u6cd5\u3002</p> <p>\u6211\u4eec\u5e38\u89c1\u7684\u670d\u52a1\u5668\u4e00\u822c\u90fd\u662fLinux\u64cd\u4f5c\u7cfb\u7edf\uff0c\u5bf9\u5e94\u6587\u4ef6\u7cfb\u7edf\u7684\u9875\uff08OS Page\uff09\u5c31\u53ef\u4ee5\u770b\u6210\u662fLinux\u64cd\u4f5c\u7cfb\u7edf\u4e0e\u6587\u4ef6\u7cfb\u7edf\u4ea4\u4e92\u7684\u6700\u5c0f\u5355\u4f4d\u3002</p> <p>\u4e00\u822c\u60c5\u51b5\u4e0b\uff0c\u9664\u4e86\u64cd\u4f5c\u7cfb\u7edf\u7684\u9875\uff08OS Page\uff09\u4e3a4KB\u4e4b\u5916\uff0c\u5176\u4f59\u7a0b\u5e8f\u7684\u9875\uff08Page\uff09\u90fd\u4f1a\u5927\u4e8e\u7b49\u4e8e\u64cd\u4f5c\u7cfb\u7edf\u7684\u9875\u5927\u5c0f\uff0c\u6bd4\u5982\uff0cOracle\u7684Page\u5927\u5c0f\u4e3a8KB\u3002</p> <p>MySQL\u7684Page\u5927\u5c0f\u4e5f\u53ef\u4ee5\u901a\u8fc7\u4e0a\u9762<code>innodb_page_size</code>\u53c2\u6570\u6307\u5b9a\uff0c\u5177\u4f53\u60c5\u51b5\u5982\u4e0b\uff1a</p> <ul> <li>&lt;5.6\u7248\u672c\u65f6\uff0c\u4e0d\u53ef\u8c03\u6574\uff1b</li> <li>5.6\u7248\u672c\u65f6\uff0c\u53ef\u81ea\u5b9a\u4e49\u4e3a8KB\u30014KB\uff0c\u4f46\u4e0d\u80fd\u8c03\u5927\u3010\u8c03\u5c0f\u662f\u4e3a\u4e86\u8c03\u9ad8\u6570\u636e\u5bf9\u9f50\u6982\u7387\u3011\uff1b</li> <li>5.7\u4ee5\u4e0a\uff0c\u624d\u53ef\u4ee5\u6539\u621032KB\u300164KB\u3010\u4e14\u6700\u597d\u8bbe\u7f6e\u6210\u9ed8\u8ba4\u503c16KB\u7684\u6574\u6570\u500d\uff0c\u8fd9\u662f\u5168\u5c40\u9009\u9879\uff0c\u65e0\u6cd5\u5728MySQL\u8fd0\u884c\u8fc7\u7a0b\u4e2d\u52a8\u6001\u4fee\u6539\u3011\u3002</li> </ul> <p>\u8bf4\u4e86\u8fd9\u4e48\u591a\uff0c\u5176\u5b9e\u5927\u591a\u6570\u60c5\u51b5\u4e00\u822c\u90fd\u4e0d\u7528\u4fee\u6539\uff0c\u4f7f\u7528\u9ed8\u8ba4\u503c\u5373\u53ef\u3002</p> <p>\u6709\u70b9\u626f\u8fdc\u4e86\u3002\u6211\u4eec\u77e5\u9053\u64cd\u4f5c\u7cfb\u7edf\u7684\u9875\u5927\u5c0f\u548cMySQL\u7684\u9875\u5927\u5c0f\u4e86\uff0c\u800c\u4e14MySQL\u7a0b\u5e8f\u662f\u8dd1\u5728Linux\u64cd\u4f5c\u7cfb\u7edf\u4e0a\u7684\uff0c\u6240\u4ee5\u53ef\u4ee5\u5f97\u51fa\u5982\u4e0b\u7ed3\u8bba\uff1a</p> <p>MySQL\u5c06Buffer Pool\u4e2d\u4e00\u9875\u6570\u636e\u5237\u5165\u78c1\u76d8\uff0c\u8981\u51994\u4e2a\u6587\u4ef6\u7cfb\u7edf\u91cc\u7684\u9875\uff08\u4e5f\u53ef\u4ee5\u8bf4\u6210\u4e00\u4e2aMySQL\u6570\u636e\u9875\u6620\u5c044\u4e2a\u7cfb\u7edf\u9875\uff09</p>"},{"location":"advanced/3.InnoDB%E2%80%94%E2%80%94%E5%85%B3%E9%94%AE%E7%89%B9%E6%80%A7/#doublewrite_1","title":"Doublewrite\u4e3b\u8981\u89e3\u51b3\u4e86\u4ec0\u4e48\u95ee\u9898\uff1f","text":"<p>\u4e3a\u4e86\u89e3\u51b3**\u90e8\u5206\u9875\u9762\u5199\u5165**\u95ee\u9898(Partial Page Write)\u3002</p> <p>\u5f53\u524d\u6240\u6709\u6570\u636e\u5e93\u666e\u904d\u91c7\u7528 <code>Write Ahead Log</code> \u7b56\u7565\uff0c\u5373\u5148\u5199\u65e5\u5fd7\u5728\u4fee\u6539\u78c1\u76d8\u6570\u636e\uff0c\u8fd9\u6837\u53ef\u4ee5\u4fdd\u8bc1\u5185\u5b58\u4e2d\u4e22\u5931\u7684\u6570\u636e\u53ef\u4ee5\u901a\u8fc7Log\u6062\u590d\u3002</p> <p>\u800c\u65e5\u5fd7\u8bb0\u5f55\u7684\u5185\u5bb9\u662f\u4ee5\u6570\u636e\u9875\u4e3a\u5355\u4f4d\u7684\uff08\u5373\u6570\u636e\u5e93\u6700\u5c0f\u64cd\u4f5c\u5355\u5143\uff09</p> <p>\u5728PostgreSQL\u4e2d\u9ed8\u8ba4page\u5927\u5c0f\u4e3a8KB\uff0c\u5728MySQL\u4e2d\u9ed8\u8ba4page\u5927\u5c0f\u4e3a16KB\uff0c\u800c\u64cd\u4f5c\u7cfb\u7edf\u7684\u5355\u6b21IO\u4e00\u822c\u4ee54KB\u4e3a\u5355\u4f4d\u8fdb\u884c\u8bfb\u5199\uff0c\u6240\u4ee5\u5199\u5b8cWAL\u65e5\u5fd7\uff08redo log\uff09\u540e\uff0c\u5728\u5f80\u78c1\u76d8\u5199\u6570\u636e\u9875\u7684\u8fc7\u7a0b\u4e2d\u5982\u679c\u4e00\u4e2apage\u5199\u5230\u4e00\u534a\u51fa\u73b0\u4e86\u95ee\u9898\uff0c\u90a3\u4e48\u4e0b\u6b21\u542f\u52a8\u5728\u6839\u636e WAL \u65e5\u5fd7\u6062\u590d\u65f6\uff0c\u518d\u57fa\u4e8e\u8fd9\u4e2a<code>corrupted page</code>\u8fdb\u884c\u6062\u590d\u80af\u5b9a\u662f\u4e0d\u884c\u7684\u3002</p> <p>\u4e00\u4e2a\u6570\u636e\u9875\u7684\u5927\u5c0f\u662f16K\uff0c\u5047\u8bbe\u5728\u628a\u5185\u5b58\u4e2d\u7684\u810f\u9875\u5199\u5230\u6570\u636e\u5e93\u7684\u65f6\u5019\uff0c\u5199\u4e862K\u7a81\u7136\u6389\u7535\uff0c\u4e5f\u5c31\u662f\u8bf4\u524d2K\u6570\u636e\u662f\u65b0\u7684\uff0c\u540e14K\u662f\u65e7\u7684\uff0c\u90a3\u4e48\u78c1\u76d8\u6570\u636e\u5e93\u8fd9\u4e2a\u6570\u636e\u9875\u5c31\u662f\u4e0d\u5b8c\u6574\u7684\uff0c\u662f\u4e00\u4e2a\u574f\u6389\u7684\u6570\u636e\u9875\u3002redo\u53ea\u80fd\u52a0\u4e0a\u65e7\u3001\u6821\u68c0\u5b8c\u6574\u7684\u6570\u636e\u9875\u6062\u590d\u4e00\u4e2a\u810f\u5757\uff0c\u4e0d\u80fd\u4fee\u590d\u574f\u6389\u7684\u6570\u636e\u9875\uff0c\u6240\u4ee5\u8fd9\u4e2a\u6570\u636e\u5c31\u4e22\u5931\u4e86\uff0c\u53ef\u80fd\u4f1a\u9020\u6210\u6570\u636e\u4e0d\u4e00\u81f4\u3002</p>"},{"location":"advanced/3.InnoDB%E2%80%94%E2%80%94%E5%85%B3%E9%94%AE%E7%89%B9%E6%80%A7/#doublewrite_2","title":"Doublewrite\u662f\u6307\u54ea\u4e24\u6b21\u5199\u5165\uff1f","text":"<ol> <li> <p>\u5199<code>Doublewrite buffer</code>\uff0c\u6ce8\u610f: Doublewrite buffer**\u662f\u78c1\u76d8\u4e0d\u662f\u5185\u5b58**\u3002</p> </li> <li> <p>\u5199\u5165\u6570\u636e\u6587\u4ef6\u3002</p> </li> </ol> <p>\u5199\u5165\u987a\u5e8f\uff1a\u5148\u5199doublewrite buffer\uff0c\u5199**\u6210\u529f\u540e**\u518d\u5199\u5230\u6570\u636e\u6587\u4ef6\u3002</p>"},{"location":"advanced/3.InnoDB%E2%80%94%E2%80%94%E5%85%B3%E9%94%AE%E7%89%B9%E6%80%A7/#doublewrite-buffer","title":"Doublewrite buffer\u5b58\u50a8\u533a\u4f4d\u4e8e\u4ec0\u4e48\u5730\u65b9\uff1f","text":"<ul> <li>\u5728MySQL 8.0.20\u4e4b\u524d\uff1a\u4f4d\u4e8eInnoDB\u7cfb\u7edf\u8868\u7a7a\u95f4\u4e2d(ibdata\u6587\u4ef6)</li> <li>\u4eceMySQL 8.0.20\u5f00\u59cb\uff1a\u4f4d\u4e8edoublewrite\u5355\u72ec\u7684\u6587\u4ef6\u4e2d\uff0c\u6587\u4ef6\u7531innodb_doublewrite_dir\u548cinnodb_doublewrite_files\u914d\u7f6e\u786e\u5b9a</li> </ul> <pre><code># Doubliewrite\u6587\u4ef6\u547d\u540d\n# #_\u9875\u5927\u5c0f_\u6587\u4ef6\u7f16\u53f7.dblwr\n# \u9875\u5927\u5c0f\u4e00\u822c\u9ed8\u8ba4\u5c31\u662f16KB\uff0c\u7531innodb_page_size\u63a7\u5236\n-rwxrwxrwx 1 root root 192K  7\u6708  6 23:15 '#ib_16384_0.dblwr'\n-rwxrwxrwx 1 root root 8.2M  7\u6708  6 23:16 '#ib_16384_1.dblwr'\n</code></pre> <pre><code># \u63a7\u5236\u662f\u5426\u542f\u7528\u53cc\u5199\u7f13\u51b2\u533a\uff0c\u9ed8\u8ba4\u542f\u7528\u3002\u751f\u4ea7\u73af\u5883\u7981\u6b62\u5173\u95ed\ninnodb_doublewrite=on\n\n# \u6307\u5b9adoublewrite\u6587\u4ef6\u7684\u5b58\u50a8\u8def\u5f84\uff0c\u9ed8\u8ba4\u662f\u8ddfinnodb_data_home_dir\u4e00\u8d77\uff0c\u4e00\u822c\u5c31\u662f\u6570\u636e\u76ee\u5f55datadir\ninnodb_doublewrite_dir=innodb_data_home_dir\n\n# \u6307\u5b9adoublewrite\u6587\u4ef6\u7684\u6570\u91cf\uff0c\u9ed8\u8ba4\u4e3a\u6bcf\u4e2abuffer_pool_instance\u521b\u5efa2\u4e2adbw\u6587\u4ef6\uff0c\u6700\u5c0f\u662f2\uff0c\u6700\u5927\u662f256\ninnodb_doublewrite_files=\n\n# innodb_doublewrite_pages \u53d8\u91cf\uff08\u5728 MySQL 8.0.20 \u4e2d\u5f15\u5165\uff09\u63a7\u5236\u6bcf\u4e2a\u7ebf\u7a0b\u7684\u6700\u5927\u53cc\u5199\u9875\u6570\u3002\u5982\u679c\u672a\u6307\u5b9a\u503c\uff0c\u5c06\u8bbe\u7f6e\u4e3a innodb_write_io_threads \u503c\u3002\u8be5\u53d8\u91cf\u7528\u4e8e\u9ad8\u7ea7\u6027\u80fd\u8c03\u6574\u3002\u9ed8\u8ba4\u503c\u9002\u5408\u5927\u591a\u6570\u7528\u6237\u3002\ninnodb_doublewrite_pages=innodb_write_io_threads\n</code></pre>"},{"location":"advanced/3.InnoDB%E2%80%94%E2%80%94%E5%85%B3%E9%94%AE%E7%89%B9%E6%80%A7/#innodb-doublewrite-buffer","title":"innodb \u4ec0\u4e48\u65f6\u5019\u5c06\u810f\u9875\u5199\u5165Doublewrite buffer\u4e2d?","text":"<p>\u7531\u4ee5\u4e0b\u51e0\u4e2a\u53c2\u6570\u51b3\u5b9a\uff1a</p> <ul> <li>innodb_max_dirty_pages_pct_lwm: \u4f4e\u4f4d\u6c34\u5e73\u6807\u8bb0\uff0c\u8fbe\u5230\u8be5\u503c\u5c06\u542f\u52a8\u7f13\u51b2\u5237\u65b0,\u9ed8\u8ba4\u4e3a10\uff08\u767e\u5206\u6bd4\uff0c\u810f\u9875/\u7f13\u51b2\u6c60\uff09</li> <li>innodb_max_dirty_pages_pct: \u810f\u9875\u6570\u91cf\u4e0e\u7f13\u51b2\u6c60\u6bd4\u4f8b\u9608\u503c\uff0c\u9ed8\u8ba4\u4e3a90</li> <li>\u5982\u679c\u5f00\u542f\u81ea\u9002\u5e94\u5237\u65b0\uff08Adaptive Flushing\uff09InnoDB\u6839\u636e\u91cd\u505a\u65e5\u5fd7\u751f\u6210\u7684\u901f\u5ea6\u548c\u5f53\u524d\u7684\u5237\u65b0\u7387\uff0c\u4f7f\u7528\u81ea\u9002\u5e94\u5237\u65b0\u7b97\u6cd5\u6765\u52a8\u6001\u8c03\u6574\u5237\u65b0\u7387\u3002</li> </ul>"},{"location":"advanced/3.InnoDB%E2%80%94%E2%80%94%E5%85%B3%E9%94%AE%E7%89%B9%E6%80%A7/#_6","title":"\u5982\u4f55\u67e5\u770b\u53cc\u5199\u7f13\u51b2\u533a\u7684\u5927\u5c0f?","text":"<p>8.0.20\u4e4b\u524d,Doublewrite buffer\u662f\u7cfb\u7edf\u8868\u7a7a\u95f4\u4e2d\u8fde\u7eed\u7684128\u4e2a\u9875(\u6bcf\u4e2a\u987516k)\uff0c\u603b\u51712M</p>"},{"location":"advanced/3.InnoDB%E2%80%94%E2%80%94%E5%85%B3%E9%94%AE%E7%89%B9%E6%80%A7/#doublewrite-buffer_1","title":"Doublewrite buffer\u4ece\u810f\u9875\u5237\u65b0\u901f\u5ea6\u7531\u54ea\u4e9b\u53c2\u6570\u63a7\u5236?","text":"<p>\u6e05\u6d17\u7ebf\u7a0b\u6570\u7531innodb_page_cleaners\u914d\u7f6e(8.0.20\u7248\u672c\u9ed8\u8ba4\u4e3a4)\uff0c\u5355\u4e2a\u7ebf\u7a0b\u6700\u591a\u6bcf\u6b21\u5199\u5165doublewrite buffer \u7684\u9875\u9762\u6570\u7531innodb_doublewrite_pages\u53d8\u91cf\u63a7\u5236\uff0c \u5728\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u4e3ainnodb_write_io_threads\u7684\u503c\uff08\u9ed8\u8ba44\uff09, \u6bcf\u79d2\u5199\u5165\u6b21\u6570\u8fd8\u53d7\u5230innodb_io_capacity \uff08\u5b9a\u4e49\u4e86\u6bcf\u79d2I / O\u64cd\u4f5c\u6570,\u9ed8\u8ba4\u503c200\uff09\u548cinnodb_io_capacity_max\uff08InnoDB\u5728\u7531\u540e\u53f0\u4efb\u52a1\u6bcf\u79d2\u6267\u884c\u7684\u6700\u5927IOPS\u6570 \uff09\u63a7\u5236\u3002</p>"},{"location":"advanced/3.InnoDB%E2%80%94%E2%80%94%E5%85%B3%E9%94%AE%E7%89%B9%E6%80%A7/#redo-logdoublewrite-buffer","title":"\u4e3a\u4ec0\u4e48\u6709\u4e86redo log\uff0c\u8fd8\u9700\u8981doublewrite buffer\uff1f","text":"<p>\u4e00\u822c\u90fd\u8ba4\u4e3a\uff0credo\u63d0\u4f9b\u4e86\u5d29\u6e83\u6062\u590d\u529f\u80fd\uff0c</p> <p>\u4e24\u6b21\u5199\u5e26\u7ed9innodb\u5b58\u50a8\u5f15\u64ce\u7684\u662f\u6570\u636e\u9875\u7684\u53ef\u9760\u6027</p>"},{"location":"advanced/3.InnoDB%E2%80%94%E2%80%94%E5%85%B3%E9%94%AE%E7%89%B9%E6%80%A7/#_7","title":"\u4f7f\u7528\u4e24\u6b21\u5199\u7684\u539f\u56e0\uff1a","text":"<p>\u5f53innodb\u5b58\u50a8\u5f15\u64ce\u6b63\u5728\u5199\u5165\u67d0\u4e2a\u9875\u5230\u8868\u4e2d\uff0c\u800c\u8fd9\u4e2a\u9875\u53ea\u5199\u4e86\u4e00\u90e8\u5206\u5c31\u53d1\u751f\u4e86\u5b95\u673a\uff0c\u79f0\u4e3a\u90e8\u5206\u5199\u5931\u6548\uff0c\u4f1a\u5bfc\u81f4\u6570\u636e\u4e22\u5931\uff0c\u53ef\u4ee5\u901a\u8fc7\u91cd\u505a\u65e5\u5fd7\u6062\u590d\uff0c\u53ef\u662f\u91cd\u505a\u65e5\u5fd7\u4e2d\u8bb0\u5f55\u7684\u662f\u5bf9\u9875\u7684\u7269\u7406\u64cd\u4f5c\uff0c\u5982\u504f\u79fb\u91cf80\uff0c\u5199<code>ddd</code>\u64cd\u4f5c\u3002</p> <p>\u5982\u679c\u8fd9\u4e2a\u9875\u672c\u8eab\u5df2\u7ecf\u635f\u574f\uff0c\u5219\u91cd\u505a\u4e5f\u6ca1\u610f\u4e49\uff0c\u56e0\u6b64\uff0c\u53ef\u4ee5\u5728\u5e94\u7528\u91cd\u505a\u4e4b\u524d\uff0c\u7528\u6237\u9700\u8981\u4e00\u4e2a\u9875\u7684\u526f\u672c\uff0c\u5f53\u53d1\u751f\u5199\u5931\u6548\u65f6\uff0c\u901a\u8fc7\u526f\u672c\u8fd8\u539f\u8be5\u9875\uff0c\u518d\u8fdb\u884c\u91cd\u505a\uff0c\u8fd9\u5c31\u662fdoublewrite\u3002</p> <p>\u5728\u6570\u636e\u5e93\u4e2d\uff0c\u6570\u636e\u662f\u88ab\u5206\u6210\u4e00\u5757\u4e00\u5757\u7684\u3002\u5728\u64cd\u4f5c\u7cfb\u7edf\u4e2d\uff0c\u6570\u636e\u4e5f\u662f\u88ab\u5206\u6210\u4e00\u5757\u4e00\u5757\u7684\u3002  \u4e00\u822c\u60c5\u51b5\u4e0b\uff0c\u6570\u636e\u5e93\u7684\u5757\u8981\u6bd4\u64cd\u4f5c\u7cfb\u7edf\u7684\u5feb\u5927\uff0c\u4e14\u6570\u636e\u5e93\u5757\u7684\u5927\u5c0f\u662f\u64cd\u4f5c\u7cfb\u7edf\u5757\u7684\u5927\u5c0f\u7684\u6574\u6570\u500d\u3002  \u6240\u4ee5\uff0c\u6570\u636e\u5e93\u7684\u5757\u6ca1\u6cd5\u4fdd\u8bc1\u539f\u5b50\u5730\u6301\u4e45\u5316\u3002</p> <p>Double write \u8981\u89e3\u51b3\u7684\u662f inplace update \u7684 partial write \u7684\u95ee\u9898\u3002\u4ec0\u4e48\u53eb partial write\uff1f\u6570\u636e\u5e93 flush \u810f\u9875\u7684\u65f6\u5019\uff0c\u7cfb\u7edf\u53ef\u80fd\u5b95\u673a\uff0c\u8fd9\u4e2a\u65f6\u5019\uff0c\u6570\u636e\u5e93\u7684\u4e00\u4e2a\u810f\u9875\u53ef\u80fd\u53ea\u5237\u4e86\u4e00\u90e8\u5206\u3002  \u800c InnoDB  \u7684 redo log \u6ca1\u6709\u8bb0\u5f55\u6574\u4e2a page \u7684\u5185\u5bb9\u3002\u56e0\u4e3a\u5982\u679c\u6bcf\u6b21\u4fee\u6539\u90fd\u8bb0\u5f55\u6574\u4e2a page\uff0c\u90a3\u65e5\u5fd7\u5c31\u592a\u5927\u4e86\u3002  \u4e5f\u5c31\u662f\u8bf4\uff0c old_page + redo_log =&gt; new_page\u3002\u5982\u679c old_page \u7684\u5185\u5bb9\u88ab\u5199\u574f\u4e86\uff0c\u6570\u636e\u5c31\u6ca1\u6cd5\u6062\u590d\u4e86\u3002  Double write \u7684\u505a\u6cd5\u5c31\u662f\u5148\u5c06 old_page + redo_log \u5f97\u5230\u7684 new_page \u5148\u6301\u4e45\u5316\u5230\u78c1\u76d8\u4e0a\u7684\u201c\u53e6\u4e00\u4e2a\u5730\u65b9\u201d\u3002\u7136\u540e\u518d\u8fdb\u884c inplace update\uff0c\u5982\u679c\u4e2d\u9014\u53d1\u751f\u5b95\u673a\uff0c\u53ef\u4ee5\u4ece\u201c\u53e6\u4e00\u4e2a\u5730\u65b9\u201d\u6062\u590d\u8fd9\u4e2a page \u7684\u6570\u636e\u3002</p> <p>partial write\u7684\u95ee\u9898\u662f\u5f88\u591a\u6570\u636e\u5e93\u8bbe\u8ba1\u4e2d\u90fd\u9700\u8981\u8003\u8651\u5230\u8fd9\u4e48\u4e00\u4e2a\u4e34\u754c\u70b9\u7684\u95ee\u9898\u3002MySQL\u4e2d\u7684\u9875\u662f16k\uff0c\u6570\u636e\u7684\u6821\u9a8c\u662f\u6309\u7167\u8fd9\u4e2a\u4e3a\u5355\u4f4d\u8fdb\u884c\u7684\uff0c\u800c\u64cd\u4f5c\u7cfb\u7edf\u5c42\u9762\u7684\u6570\u636e\u5355\u4f4d\u80af\u5b9a\u8fbe\u4e0d\u523016k\uff08\u6bd4\u5982\u662f4k\uff09\uff0c\u90a3\u4e48\u4e00\u65e6\u53d1\u751f\u65ad\u7535\u65f6\uff0c\u53ea\u4fdd\u7559\u4e86\u90e8\u5206\u5199\u5165\uff0c\u5982\u679c\u662fOracle DBA\u4e00\u822c\u5bf9\u6b64\u90fd\u4f1a\u5f88\u6de1\u5b9a\uff0c\u8bf4\u7528redo\u6765\u6062\u590d\u561b\u3002\u4f46\u53ef\u80fd\u6211\u4eec\u88ab\u5c4f\u853d\u4e86\u4e00\u4e9b\u7ec6\u8282\uff0cMySQL\u5728\u6062\u590d\u7684\u8fc7\u7a0b\u4e2d\u4e00\u4e2a\u57fa\u51c6\u662f\u68c0\u67e5page\u7684checksum\uff0c\u4e5f\u5c31\u662fpage\u7684\u6700\u540e\u4e8b\u52a1\u53f7\uff0c\u53d1\u751f\u8fd9\u79cdpartial page write \u7684\u95ee\u9898\u65f6\uff0c\u56e0\u4e3apage\u5df2\u7ecf\u635f\u574f\uff0c\u6240\u4ee5\u5c31\u65e0\u6cd5\u5b9a\u4f4d\u5230page\u4e2d\u7684\u4e8b\u52a1\u53f7\uff0c\u8fd9\u4e2a\u65f6\u5019redo\u5c31\u65e0\u6cd5\u76f4\u63a5\u6062\u590d\u3002</p>"},{"location":"advanced/3.InnoDB%E2%80%94%E2%80%94%E5%85%B3%E9%94%AE%E7%89%B9%E6%80%A7/#doublewrite_3","title":"doublewrite\u7684\u6784\u6210\uff1a","text":"<p>\u4e00\u90e8\u5206\u662f\u5185\u5b58\u7684doublewrite buffer\uff0c\u5927\u5c0f\u4e3a2MB\uff0c\u53e6\u4e00\u90e8\u5206\u662f\u7269\u7406\u78c1\u76d8\u4e0a\u5171\u4eab\u7a7a\u95f4\u4e2d\u7684\u8fde\u7eed128\u9875\uff0c\u4e24\u4e2a\u533a\uff0c\u5927\u5c0f\u4e5f\u4e3a2MB\u3002\u5176\u4e2d120\u4e2a\u7528\u4e8e\u6279\u91cf\u5237\u810f\u6570\u636e\uff0c\u53e6\u59168\u4e2a\u7528\u4e8eSingle Page Flush\u3002\u6839\u636e\u963f\u91cc\u7fdf\u536b\u7965\u540c\u5b66\u5206\u6790\uff0c\u4e4b\u6240\u4ee5\u8fd9\u6837\u505a\u662f\u56e0\u4e3a\u6279\u91cf\u5237\u810f\u662f\u540e\u53f0\u7ebf\u7a0b\u505a\u7684\uff0c\u8fd9\u6837\u4e0d\u5f71\u54cd\u524d\u53f0\u7ebf\u7a0b\u3002\u800cSingle Page Flush\u662f\u7528\u6237\u7ebf\u7a0b\u53d1\u8d77\u7684\uff0c\u9700\u8981\u5c3d\u5feb\u5730\u5237\u810f\u5e76\u66ff\u6362\u51fa\u4e00\u4e2a\u7a7a\u95f2\u9875\u51fa\u6765\u3002\u6240\u4ee5\u4e0d\u662f\u4e00\u4e2a\u4e25\u683c\u768464+64\u7684\u62c6\u5206\uff0c\u6700\u540e\u4e5f\u7ed9\u51fa\u4e86\u8fd9\u7bc7\u6587\u7ae0\u7684\u94fe\u63a5\u3002\uff08https://yq.aliyun.com/articles/50627\uff09</p> <p>2MB\u7684 Double Write \u533a\uff0c\u53ef\u4ee5\u5b58\u50a8 2 * 1024 / 16 = 128 \u9875</p>"},{"location":"advanced/3.InnoDB%E2%80%94%E2%80%94%E5%85%B3%E9%94%AE%E7%89%B9%E6%80%A7/#doublewrite_4","title":"doublewrite\u7684\u5e94\u7528\uff1a","text":"<ol> <li>\u5f53\u4e00\u7cfb\u5217\u673a\u5236\u89e6\u53d1\u6570\u636e\u7f13\u51b2\u6c60\u4e2d\u7684\u810f\u9875\u5237\u65b0\u65f6\uff0c\u5e76\u4e0d\u76f4\u63a5\u5199\u5165\u78c1\u76d8\u6570\u636e\u6587\u4ef6\u4e2d\uff0c\u800c\u662f\u5148\u62f7\u8d1d\u81f3\u5185\u5b58\u4e2d\u7684doublewrite buffer\u4e2d\uff1b</li> <li>\u63a5\u7740\u4ecedoublewrite buffer\u5206\u4e24\u6b21\u5199\u5165\u78c1\u76d8\u5171\u4eab\u8868\u7a7a\u95f4\u4e2d(\u8fde\u7eed\u5b58\u50a8\uff0c\u987a\u5e8f\u5199\uff0c\u6027\u80fd\u5f88\u9ad8)\uff0c\u6bcf\u6b21\u51991MB\uff1b</li> <li>\u5f85\u7b2c\u4e8c\u6b65\u5b8c\u6210\u540e\uff0c\u518d\u5c06doublewrite buffer\u4e2d\u7684\u810f\u9875\u6570\u636e\u5199\u5165\u5b9e\u9645\u7684\u5404\u4e2a\u8868\u7a7a\u95f4\u6587\u4ef6(\u79bb\u6563\u5199)\uff1b(\u810f\u9875\u6570\u636e\u56fa\u5316\u540e\uff0c\u5373\u8fdb\u884c\u6807\u8bb0\u5bf9\u5e94doublewrite\u6570\u636e\u53ef\u8986\u76d6)\u3002</li> </ol> <p>\u56e0\u6b64\u5728\u64cd\u4f5c\u7cfb\u7edf\u5c06\u9875\u5199\u5165\u78c1\u76d8\u7684\u8fc7\u7a0b\u4e2d\u53d1\u751f\u4e86\u5d29\u6e83\uff0cinnodb\u53ef\u4ee5\u4ece\u5171\u4eab\u8868\u7a7a\u95f4\u4e2d\u7684doublewrite\u4e2d\u627e\u5230\u8be5\u9875\u7684\u526f\u672c\uff0c\u5c06\u5176\u590d\u5236\u5230\u8868\u7a7a\u95f4\u6587\u4ef6\uff0c\u518d\u5e94\u7528\u91cd\u505a\u65e5\u5fd7\u6062\u590d</p> <p></p>"},{"location":"advanced/3.InnoDB%E2%80%94%E2%80%94%E5%85%B3%E9%94%AE%E7%89%B9%E6%80%A7/#doublewrite_5","title":"doublewrite\u7684\u8bbe\u7f6e\uff1a","text":"<p>\u53c2\u6570skip_innodb_doublewrite\u53ef\u4ee5\u7981\u6b62\u4f7f\u7528\u4e24\u6b21\u5199\u529f\u80fd\uff0c\u8fd9\u65f6\u53ef\u80fd\u4f1a\u53d1\u751f\u5199\u5931\u6548\u95ee\u9898\uff0c</p> <p>\u6709\u4e9b\u6587\u4ef6\u7cfb\u7edf\u672c\u8eab\u5c31\u63d0\u4f9b\u4e86\u90e8\u5206\u5199\u5931\u6548\u7684\u9632\u8303\u673a\u5236\uff0c\u6bd4\u5982ZFS\u6587\u4ef6\u7cfb\u7edf\uff0c\u56e0\u6b64\u7528\u6237\u5c31\u53ef\u4ee5\u4e0d\u5fc5\u542f\u7528\u4e24\u6b21\u5199\u529f\u80fd\u3002 </p>"},{"location":"advanced/3.InnoDB%E2%80%94%E2%80%94%E5%85%B3%E9%94%AE%E7%89%B9%E6%80%A7/#doublewrite_6","title":"doublewrite\u7684\u5d29\u6e83\u6062\u590d","text":"<p>\u5982\u679c\u64cd\u4f5c\u7cfb\u7edf\u5728\u5c06\u9875\u5199\u5165\u78c1\u76d8\u7684\u8fc7\u7a0b\u4e2d\u53d1\u751f\u5d29\u6e83\uff0c\u5728\u6062\u590d\u8fc7\u7a0b\u4e2d\uff0cinnodb\u5b58\u50a8\u5f15\u64ce\u53ef\u4ee5\u4ece\u5171\u4eab\u8868\u7a7a\u95f4\u7684doublewrite\u4e2d\u627e\u5230\u8be5\u9875\u7684\u4e00\u4e2a\u6700\u8fd1\u7684\u526f\u672c\uff0c\u5c06\u5176\u590d\u5236\u5230\u8868\u7a7a\u95f4\u6587\u4ef6\uff0c\u518d\u5e94\u7528redo log\uff0c\u5c31\u5b8c\u6210\u4e86\u6062\u590d\u8fc7\u7a0b\u3002</p> <p>\u5bf9\u4e8e\u6587\u4ef6\u6821\u9a8c\u6765\u8bf4\uff0c\u4e00\u4e2a\u4e2d\u5fc3\u8bcd\u5c31\u662fchecksum\u3002\u5982\u679c\u51fa\u73b0\u4e86partial write\u7684\u65f6\u5019\uff0c\u6bd4\u5982\u65ad\u7535\uff0c\u90a3\u4e48\u4e24\u6b21\u5199\u7684\u8fc7\u7a0b\u4e2d\uff0c\u5f88\u53ef\u80fdpage\u662f\u4e0d\u4e00\u81f4\u7684\uff0c\u8fd9\u6837checksum\u6821\u9a8c\u5c31\u5f88\u53ef\u80fd\u51fa\u73b0\u95ee\u9898\u3002\u800c\u51fa\u73b0\u95ee\u9898\u65f6\uff0c\u56e0\u4e3a\u6709\u4e86\u524d\u671f\u5199\u5165\u5171\u4eab\u8868\u7a7a\u95f4\u7684\u9875\u4fe1\u606f\uff0c\u6240\u4ee5\u5c31\u53ef\u4ee5\u91cd\u6784\u51fa\u9875\u7684\u4fe1\u606f\u91cd\u65b0\u5199\u5165\u3002</p> <p>\u56e0\u4e3a\u6709\u526f\u672c\u6240\u4ee5\u4e5f\u4e0d\u62c5\u5fc3\u8868\u7a7a\u95f4\u4e2d\u6570\u636e\u9875\u662f\u5426\u635f\u574f\u3002</p>"},{"location":"advanced/3.InnoDB%E2%80%94%E2%80%94%E5%85%B3%E9%94%AE%E7%89%B9%E6%80%A7/#doublewrite_7","title":"doublewrite\u7684\u526f\u4f5c\u7528","text":"<ol> <li>double write\u5e26\u6765\u7684\u5199\u8d1f\u8f7d    double write\u662f\u4e00\u4e2abuffer, \u4f46\u5176\u5b9e\u5b83\u662f\u5f00\u5728\u7269\u7406\u6587\u4ef6\u4e0a\u7684\u4e00\u4e2abuffer, \u5176\u5b9e\u4e5f\u5c31\u662ffile, \u6240\u4ee5\u5b83\u4f1a\u5bfc\u81f4\u7cfb\u7edf\u6709\u66f4\u591a\u7684fsync\u64cd\u4f5c, \u800c\u786c\u76d8\u7684fsync\u6027\u80fd\u662f\u5f88\u6162\u7684, \u6240\u4ee5\u5b83\u4f1a\u964d\u4f4emysql\u7684\u6574\u4f53\u6027\u80fd\u3002</li> </ol> <p>\u4f46\u662f\uff0cdoublewrite buffer\u5199\u5165\u78c1\u76d8\u5171\u4eab\u8868\u7a7a\u95f4\u8fd9\u4e2a\u8fc7\u7a0b\u662f\u8fde\u7eed\u5b58\u50a8\uff0c\u662f\u987a\u5e8f\u5199\uff0c\u6027\u80fd\u975e\u5e38\u9ad8\uff0c(\u7ea6\u5360\u5199\u7684%10)\uff0c\u727a\u7272\u4e00\u70b9\u5199\u6027\u80fd\u6765\u4fdd\u8bc1\u6570\u636e\u9875\u7684\u5b8c\u6574\u8fd8\u662f\u5f88\u6709\u5fc5\u8981\u7684\u3002</p> <ol> <li>\u76d1\u63a7double write\u5de5\u4f5c\u8d1f\u8f7d</li> </ol> <pre><code>mysql&gt; show global status like '%dblwr%';\n+----------------------------+-------+\n| Variable_name              | Value |\n+----------------------------+-------+\n| Innodb_dblwr_pages_written | 7     |\n| Innodb_dblwr_writes        | 3     |\n+----------------------------+-------+\n2 rows in set (0.00 sec)\n</code></pre> <p>\u5173\u6ce8\u70b9\uff1aInnodb_dblwr_pages_written / Innodb_dblwr_writes</p> <p>\u5f00\u542fdoublewrite\u540e\uff0c\u6bcf\u6b21\u810f\u9875\u5237\u65b0\u5fc5\u987b\u8981\u5148\u5199doublewrite\uff0c\u800cdoublewrite\u5b58\u5728\u4e8e\u78c1\u76d8\u4e0a\u7684\u662f\u4e24\u4e2a\u8fde\u7eed\u7684\u533a\uff0c\u6bcf\u4e2a\u533a\u7531\u8fde\u7eed\u7684\u9875\u7ec4\u6210\uff0c\u4e00\u822c\u60c5\u51b5\u4e0b\u4e00\u4e2a\u533a\u6700\u591a\u6709**64\u4e2a\u9875**\uff0c\u6240\u4ee5\u4e00\u6b21IO\u5199\u5165\u5e94\u8be5\u53ef\u4ee5\u6700\u591a\u519964\u4e2a\u9875\u3002</p> <p>\u800c\u6839\u636e\u4ee5\u4e0a\u7cfb\u7edfInnodb_dblwr_pages_written\u4e0eInnodb_dblwr_writes\u7684\u6bd4\u4f8b\u6765\u770b\uff0c\u5927\u6982\u57283\u5de6\u53f3\uff0c\u8fdc\u8fdc\u8fd8\u6ca1\u523064(\u5982\u679c\u7ea6\u7b49\u4e8e64\uff0c\u90a3\u4e48\u8bf4\u660e\u7cfb\u7edf\u7684\u5199\u538b\u529b\u975e\u5e38\u5927\uff0c\u6709\u5927\u91cf\u7684\u810f\u9875\u8981\u5f80\u78c1\u76d8\u4e0a\u5199)\uff0c\u6240\u4ee5\u4ece\u8fd9\u4e2a\u89d2\u5ea6\u4e5f\u53ef\u4ee5\u770b\u51fa\uff0c\u7cfb\u7edf\u5199\u5165\u538b\u529b\u5e76\u4e0d\u9ad8\u3002</p> <ol> <li> <p>\u5173\u95eddouble write\u9002\u5408\u7684\u573a\u666f</p> </li> <li> <p>\u6d77\u91cfDML</p> </li> <li> <p>\u4e0d\u60e7\u6015\u6570\u636e\u635f\u574f\u548c\u4e22\u5931</p> </li> <li> <p>\u7cfb\u7edf\u5199\u8d1f\u8f7d\u6210\u4e3a\u4e3b\u8981\u8d1f\u8f7d</p> <pre><code>mysql&gt; show variables like '%double%';\n+--------------------+-------+\n| Variable_name      | Value |\n+--------------------+-------+\n| innodb_doublewrite | ON    |\n+--------------------+-------+\n1 row in set (0.04 sec)\n</code></pre> </li> </ol> <p>\u4f5c\u4e3aInnoDB\u7684\u4e00\u4e2a\u5173\u952e\u7279\u6027\uff0cdoublewrite\u529f\u80fd\u9ed8\u8ba4\u662f\u5f00\u542f\u7684\uff0c\u4f46\u662f\u5728\u4e0a\u8ff0\u7279\u6b8a\u7684\u4e00\u4e9b\u573a\u666f\u4e5f\u53ef\u4ee5\u89c6\u60c5\u51b5\u5173\u95ed\uff0c\u6765\u63d0\u9ad8\u6570\u636e\u5e93\u5199\u6027\u80fd\u3002\u9759\u6001\u53c2\u6570\uff0c\u914d\u7f6e\u6587\u4ef6\u4fee\u6539\uff0c\u91cd\u542f\u6570\u636e\u5e93\u3002</p>"},{"location":"advanced/3.InnoDB%E2%80%94%E2%80%94%E5%85%B3%E9%94%AE%E7%89%B9%E6%80%A7/#double-writedata-page","title":"\u4e3a\u4ec0\u4e48\u6ca1\u6709\u628adouble write\u91cc\u9762\u7684\u6570\u636e\u5199\u5230data page\u91cc\u9762\u5462\uff1f","text":"<ol> <li>double write\u91cc\u9762\u7684\u6570\u636e\u662f\u8fde\u7eed\u7684\uff0c\u5982\u679c\u76f4\u63a5\u5199\u5230data page\u91cc\u9762\uff0c\u800cdata page\u7684\u9875\u53c8\u662f\u79bb\u6563\u7684\uff0c\u5199\u5165\u4f1a\u5f88\u6162\u3002</li> <li>double write\u91cc\u9762\u7684\u6570\u636e\u6ca1\u6709\u529e\u6cd5\u88ab\u53ca\u65f6\u7684\u8986\u76d6\u6389\uff0c\u5bfc\u81f4double write\u7684\u538b\u529b\u5f88\u5927\uff1b\u77ed\u65f6\u95f4\u5185\u53ef\u80fd\u4f1a\u51fa\u73b0double write\u6ea2\u51fa\u7684\u60c5\u51b5\uff0c\u6240\u4ee5\u5927\u91cf\u7684DML\u64cd\u4f5c\u65f6\uff0c\u53ef\u4ee5\u5173\u95edDouble Write\uff0c\u4f46\u4f1a\u5199\u5931\u6548\u3002</li> </ol> <p>\u8fd8\u53ef\u53c2\u8003\u8fd9\u7bc7\u6587\u7ae0\uff1a\u9875\u65ad\u88c2(partial write)\u4e0edoublewrite\u6280\u672f</p> <p>https://www.modb.pro/db/114783</p>"},{"location":"advanced/3.InnoDB%E2%80%94%E2%80%94%E5%85%B3%E9%94%AE%E7%89%B9%E6%80%A7/#adaptive-hash-index-","title":"Adaptive Hash Index - \u81ea\u9002\u5e94\u54c8\u5e0c\u7d22\u5f15","text":""},{"location":"advanced/3.InnoDB%E2%80%94%E2%80%94%E5%85%B3%E9%94%AE%E7%89%B9%E6%80%A7/#_8","title":"\u542b\u4e49","text":"<p>innodb\u5b58\u50a8\u5f15\u64ce\u4f1a\u76d1\u63a7\u5bf9\u8868\u4e0a\u7684\u5404\u7d22\u5f15\u9875\u7684\u67e5\u8be2\uff0c\u5982\u679c\u89c2\u5bdf\u5230\u5efa\u7acb\u54c8\u5e0c\u7d22\u5f15\u53ef\u4ee5\u5e26\u6765\u901f\u5ea6\u63d0\u5347\uff0c\u5219\u5efa\u7acb\u54c8\u5e0c\u7d22\u5f15\uff0c\u79f0\u4e4b\u4e3a\u81ea\u9002\u5e94\u54c8\u5e0c\u7d22\u5f15\uff08Adaptive hash index,AHI\uff09.AHI\u662f\u901a\u8fc7**\u7f13\u51b2\u6c60\u7684B+\u6811**\u6784\u9020\u800c\u6765\uff0c\u56e0\u6b64\u5efa\u7acb\u901f\u5ea6\u5f88\u5feb\uff0cinnodb\u4f1a\u81ea\u52a8\u6839\u636e\u8bbf\u95ee\u7684\u9891\u7387\u548c\u6a21\u5f0f\u81ea\u52a8\u7684\u4e3a\u67d0\u4e9b\u70ed\u70b9\u9875\u5efa\u7acb\u54c8\u5e0c\u7d22\u5f15\u3002</p>"},{"location":"advanced/3.InnoDB%E2%80%94%E2%80%94%E5%85%B3%E9%94%AE%E7%89%B9%E6%80%A7/#_9","title":"\u5efa\u7acb\u8981\u6c42\uff1a","text":"<ol> <li>\u5bf9\u4e8e\u8fd9\u4e2a\u9875\u7684\u8fde\u7eed\u8bbf\u95ee\u6a21\u5f0f\u5fc5\u987b\u662f\u4e00\u6837\u7684\uff0c\u5373\u6307\u67e5\u8be2\u6761\u4ef6\u4e00\u6837(\u5bf9\u4e8e\u591a\u5217\u7d22\u5f15\u6765\u8bf4\uff0cwhere a =1 \u548c where a = 1 and b =2\u65f6\u4e0d\u540c\u7684\u8bbf\u95ee\u6a21\u5f0f)</li> <li>\u4ee5\u8be5\u6a21\u5f0f\u8bbf\u95ee\u4e86100\u6b21</li> <li>\u9875\u901a\u8fc7\u8be5\u6a21\u5f0f\u8bbf\u95ee\u4e86N\u6b21\uff0c\u5176\u4e2dN=\u9875\u4e2d\u8bb0\u5f55*1/16</li> </ol>"},{"location":"advanced/3.InnoDB%E2%80%94%E2%80%94%E5%85%B3%E9%94%AE%E7%89%B9%E6%80%A7/#_10","title":"\u9650\u5236\uff1a","text":"<p>\u54c8\u5e0c\u7d22\u5f15\u53ea\u80fd\u7528\u6765\u641c\u7d22\u7b49\u503c\u7684\u67e5\u8be2\uff0c\u5982select * from table where index_col=\"xxx\";\u800c\u5bf9\u4e8e\u5176\u4ed6\u67e5\u627e\u7c7b\u578b\uff0c\u5982\u8303\u56f4\u67e5\u627e\u4e0d\u80fd\u4f7f\u7528\u54c8\u5e0c\u7d22\u5f15\uff0c\u901a\u8fc7\u53c2\u6570innodb_adptive_hash_index\u6765\u7981\u6b62\u6216\u8005\u5f00\u542f\u6b64\u7279\u6027\uff0c\u9ed8\u8ba4AHI\u4e3a\u5f00\u542f\u72b6\u6001\u3002</p>"},{"location":"advanced/3.InnoDB%E2%80%94%E2%80%94%E5%85%B3%E9%94%AE%E7%89%B9%E6%80%A7/#aio-io","title":"AIO - \u5f02\u6b65IO","text":""},{"location":"advanced/3.InnoDB%E2%80%94%E2%80%94%E5%85%B3%E9%94%AE%E7%89%B9%E6%80%A7/#_11","title":"\u76ee\u7684\uff1a","text":"<p>\u4e3a\u4e86\u63d0\u9ad8\u78c1\u76d8\u64cd\u4f5c\u6027\u80fd\uff0c\u4f7f\u7528\u5f02\u6b65io(asynchronous io,AIO)\u7684\u65b9\u5f0f\u6765\u5904\u7406\u78c1\u76d8\u64cd\u4f5c\uff0c</p>"},{"location":"advanced/3.InnoDB%E2%80%94%E2%80%94%E5%85%B3%E9%94%AE%E7%89%B9%E6%80%A7/#_12","title":"\u542b\u4e49\uff1a","text":"<p>\u4e0eAIO\u76f8\u5bf9\u5e94\u7684\u662fSync IO\uff0c\u5373\u6bcf\u6b21\u8fdb\u884c\u4e00\u6b21IO\u64cd\u4f5c\uff0c\u9700\u8981\u7b49\u5f85\u6b64\u6b21\u64cd\u4f5c\u7ed3\u675f\u540e\uff0c\u624d\u80fd\u8fdb\u884c\u4e0b\u4e00\u6b65\u64cd\u4f5c\u3002</p> <p>\u7528\u6237\u53ef\u4ee5\u5728\u53d1\u51fa\u4e00\u4e2aio\u8bf7\u6c42\u540e\u7acb\u5373\u518d\u53d1\u51fa\u53e6\u4e00\u4e2aio\u8bf7\u6c42\uff0c\u5f53\u5168\u90e8io\u8bf7\u6c42\u53d1\u9001\u5b8c\u6bd5\u540e\uff0c\u7b49\u5f85\u6240\u6709\u7684io\u64cd\u4f5c\u5b8c\u6210\uff0c\u79f0\u4e3aAIO\uff0cAIO\u8fd8\u53ef\u4ee5\u8fdb\u884cio merge\u64cd\u4f5c\uff0c\u4e5f\u5c31\u662f\u5c06\u591a\u4e2aio\u5408\u5e76\u4e3a\u4e00\u4e2aio.\u8fd9\u6837\u53ef\u4ee5\u63d0\u9ad8IPOS\u6027\u80fd\u3002</p> <p>\u4f8b\u5982\uff0c\u7528\u6237\u67e5\u8be2\u7684\u9875\u4e3a</p> <p>\uff083,5\uff09\uff083,6\uff09\uff083,7\uff09</p> <p>\u6bcf\u4e2a\u9875\u7684\u5927\u5c0f\u4e3a16KB\uff0c\u90a3\u4e48\uff0cSync IO\u9700\u8981\u4e09\u6b21IO \u64cd\u4f5c\u3002\u800cAIO\u4f1a\u5224\u65ad\u8fd9\u4e09\u4e2a\u9875\u662f\u8fde\u7eed\u7684\uff0c\uff08\u901a\u8fc7space\uff0coffset\u5c31\u53ef\u4ee5\u770b\u51fa\u6765\uff09\u56e0\u6b64\uff0cAIO\u4f1a\u53d1\u51fa\u4e00\u4e2aIO\u8bf7\u6c42\uff0c\u4ece(3,5)\u5f00\u59cb\uff0c\u8bfb\u53d648KB\u7684\u9875</p>"},{"location":"advanced/3.InnoDB%E2%80%94%E2%80%94%E5%85%B3%E9%94%AE%E7%89%B9%E6%80%A7/#_13","title":"\u5b9e\u73b0\uff1a","text":"<p>\u200b    \u5728innodb1.1.x\u4e4b\u524d\uff0cAio\u662f\u901a\u8fc7innodb\u5b58\u50a8\u5f15\u64ce\u7684\u4ee3\u7801\u6a21\u62df\u5b9e\u73b0\uff0c\u800c\u4eceinnodb1.1.x\u5f00\u59cb\uff0c\u63d0\u4f9b\u4e86\u5185\u6838\u7ea7\u522bAIO\u7684\u652f\u6301\uff0c\u5373\u4e3anative AIO,</p>"},{"location":"advanced/3.InnoDB%E2%80%94%E2%80%94%E5%85%B3%E9%94%AE%E7%89%B9%E6%80%A7/#_14","title":"\u5e94\u7528","text":"<p>read ahead\u65b9\u5f0f\u7684\u8bfb\u53d6\uff0c\u810f\u9875\u7684\u5237\u65b0\u7b49\u90fd\u662fAIO\u5b8c\u6210\u7684</p>"},{"location":"advanced/3.InnoDB%E2%80%94%E2%80%94%E5%85%B3%E9%94%AE%E7%89%B9%E6%80%A7/#_15","title":"\u5237\u65b0\u4e34\u8fd1\u9875","text":""},{"location":"advanced/3.InnoDB%E2%80%94%E2%80%94%E5%85%B3%E9%94%AE%E7%89%B9%E6%80%A7/#_16","title":"\u5de5\u4f5c\u539f\u7406","text":"<p>\u5f53\u5237\u65b0\u4e00\u4e2a\u810f\u9875\u65f6\uff0cinnodb\u4f1a\u68c0\u6d4b**\u8be5\u9875\u6240\u5728\u533a\u7684\u6240\u6709\u9875**\uff0c\u5982\u679c\u662f\u810f\u9875\uff0c\u90a3\u4e48\u4e00\u8d77\u5237\u65b0</p>"},{"location":"advanced/3.InnoDB%E2%80%94%E2%80%94%E5%85%B3%E9%94%AE%E7%89%B9%E6%80%A7/#_17","title":"\u597d\u5904","text":"<p>\u901a\u8fc7AIO\uff0c\u5c06\u591a\u4e2aIO\u5199\u5165\u64cd\u4f5c\u5408\u5e76\u5230\u4e00\u4e2aIO\u64cd\u4f5c\u4e2d\uff0c\u5bf9\u4e8e\u673a\u68b0\u786c\u76d8\u6765\u8bf4\uff0c\u6027\u80fd\u63d0\u5347\u5f88\u660e\u663e\u3002\u56fa\u6001\u786c\u76d8\u5efa\u8bae\u5173\u95ed</p>"},{"location":"advanced/3.InnoDB%E2%80%94%E2%80%94%E5%85%B3%E9%94%AE%E7%89%B9%E6%80%A7/#_18","title":"\u53c2\u6570\u63a7\u5236","text":"<p>\u53c2\u6570innodb_flush_neighbors\u6765\u5f00\u542f\u6216\u5173\u95ed\u8be5\u7279\u6027\uff0c\u4e3a0\u5219\u5173\u95ed</p>"},{"location":"advanced/3.InnoDB%E2%80%94%E2%80%94%E5%85%B3%E9%94%AE%E7%89%B9%E6%80%A7/#-read-ahead","title":"\u9884\u8bfb - read ahead","text":"<p>InnoDB\u5728I/O\u7684\u4f18\u5316\u4e0a\u6709\u4e2a\u6bd4\u8f83\u91cd\u8981\u7684\u7279\u6027\u4e3a\u9884\u8bfb\uff0c\u9884\u8bfb\u8bf7\u6c42\u662f\u4e00\u4e2ai/o\u8bf7\u6c42\uff0c\u5b83\u4f1a\u5f02\u6b65\u5730\u5728\u7f13\u51b2\u6c60\u4e2d\u9884\u5148\u56de\u8fc1\u591a\u4e2a\u9875\u9762\uff0c\u9884\u8ba1\u5f88\u5feb\u5c31\u4f1a\u9700\u8981\u8fd9\u4e9b\u9875\u9762\uff0c\u8fd9\u4e9b\u8bf7\u6c42\u5728\u4e00\u4e2a\u8303\u56f4\u5185\u5f15\u5165\u6240\u6709\u9875\u9762\u3002InnoDB\u4ee564\u4e2apage\u4e3a\u4e00\u4e2aextent\uff0c\u90a3\u4e48InnoDB\u7684\u9884\u8bfb\u662f\u4ee5page\u4e3a\u5355\u4f4d\u8fd8\u662f\u4ee5extent\uff1f</p> <p></p> <p>\u6570\u636e\u5e93\u8bf7\u6c42\u6570\u636e\u7684\u65f6\u5019\uff0c\u4f1a\u5c06\u8bfb\u8bf7\u6c42\u4ea4\u7ed9\u6587\u4ef6\u7cfb\u7edf\uff0c\u653e\u5165\u8bf7\u6c42\u961f\u5217\u4e2d\uff1b\u76f8\u5173\u8fdb\u7a0b\u4ece\u8bf7\u6c42\u961f\u5217\u4e2d\u5c06\u8bfb\u8bf7\u6c42\u53d6\u51fa\uff0c\u6839\u636e\u9700\u6c42\u5230\u76f8\u5173\u6570\u636e\u533a(\u5185\u5b58\u3001\u78c1\u76d8)\u8bfb\u53d6\u6570\u636e\uff1b\u53d6\u51fa\u7684\u6570\u636e\uff0c\u653e\u5165\u54cd\u5e94\u961f\u5217\u4e2d\uff0c\u6700\u540e\u6570\u636e\u5e93\u5c31\u4f1a\u4ece\u54cd\u5e94\u961f\u5217\u4e2d\u5c06\u6570\u636e\u53d6\u8d70\uff0c\u5b8c\u6210\u4e00\u6b21\u6570\u636e\u8bfb\u64cd\u4f5c\u8fc7\u7a0b\u3002</p> <p>\u63a5\u7740\u8fdb\u7a0b\u7ee7\u7eed\u5904\u7406\u8bf7\u6c42\u961f\u5217\uff0c(\u5982\u679c\u6570\u636e\u5e93\u662f\u5168\u8868\u626b\u63cf\u7684\u8bdd\uff0c\u6570\u636e\u8bfb\u8bf7\u6c42\u5c06\u4f1a\u5360\u6ee1\u8bf7\u6c42\u961f\u5217)\uff0c\u5224\u65ad\u540e\u9762\u51e0\u4e2a\u6570\u636e\u8bfb\u8bf7\u6c42\u7684\u6570\u636e\u662f\u5426\u76f8\u90bb\uff0c\u518d\u6839\u636e\u81ea\u8eab\u7cfb\u7edfIO\u5e26\u5bbd\u5904\u7406\u91cf\uff0c\u8fdb\u884c\u9884\u8bfb\uff0c\u8fdb\u884c\u8bfb\u8bf7\u6c42\u7684\u5408\u5e76\u5904\u7406\uff0c\u4e00\u6b21\u6027\u8bfb\u53d6\u591a\u5757\u6570\u636e\u653e\u5165\u54cd\u5e94\u961f\u5217\u4e2d\uff0c\u518d\u88ab\u6570\u636e\u5e93\u53d6\u8d70\u3002(\u5982\u6b64\uff0c\u4e00\u6b21\u7269\u7406\u8bfb\u64cd\u4f5c\uff0c\u5b9e\u73b0\u591a\u9875\u6570\u636e\u8bfb\u53d6\uff0crrqm&gt;0\uff08# iostat -x\uff09\uff0c\u5047\u8bbe\u662f4\u4e2a\u8bfb\u8bf7\u6c42\u5408\u5e76\uff0c\u5219rrqm\u53c2\u6570\u663e\u793a\u7684\u5c31\u662f4)</p> <p>\u9884\u8bfb\u8bf7\u6c42\u662f\u4e00\u4e2aI/O\u8bf7\u6c42\uff0c\u7528\u4e8e\u5f02\u6b65\u9884\u53d6\u7f13\u51b2\u6c60\u4e2d\u7684\u591a\u4e2a\u9875\u9762\uff0c\u4ee5\u9884\u671f\u8fd9\u4e9b\u9875\u9762\u5c06\u5f88\u5feb\u88ab\u9700\u8981\u3002\u8bf7\u6c42\u5728\u4e00\u4e2a\u533a\u6bb5\u4e2d\u5f15\u5165\u6240\u6709\u9875\u9762\u3002InnoDB\u4f7f\u7528\u4e24\u79cd\u9884\u8bfb\u7b97\u6cd5\u6765\u63d0\u9ad8I/O\u6027\u80fd:</p> <ul> <li> <p>\u7ebf\u6027\u9884\u8bfb(\u9ed8\u8ba4\u65b9\u5f0f)\uff0c\u5b83\u6839\u636e\u6309\u987a\u5e8f\u8bbf\u95ee\u7684\u7f13\u51b2\u6c60\u4e2d\u7684\u9875\u9762\u6765\u9884\u6d4b\u53ef\u80fd\u5f88\u5feb\u9700\u8981\u54ea\u4e9b\u9875\u9762\u3002\u901a\u8fc7\u4f7f\u7528\u914d\u7f6e\u53c2\u6570innodb_read_ahead_threshold\u6765\u8c03\u6574\u89e6\u53d1\u5f02\u6b65\u8bfb\u53d6\u8bf7\u6c42\u6240\u9700\u7684\u987a\u5e8f\u9875\u9762\u8bbf\u95ee\u6b21\u6570\uff0c\u53ef\u4ee5\u63a7\u5236InnoDB\u4f55\u65f6\u6267\u884c\u9884\u8bfb\u64cd\u4f5c\u3002\u5728\u6dfb\u52a0\u8fd9\u4e2a\u53c2\u6570\u4e4b\u524d\uff0cInnoDB\u53ea\u4f1a\u5728\u8bfb\u53d6\u5f53\u524d\u533a\u6bb5\u7684\u6700\u540e\u4e00\u9875\u65f6\u8ba1\u7b97\u662f\u5426\u8981\u5bf9\u6574\u4e2a\u4e0b\u4e00\u4e2a\u533a\u6bb5\u53d1\u51fa\u5f02\u6b65\u9884\u53d6\u8bf7\u6c42\u3002</p> <p>\u914d\u7f6e\u53c2\u6570innodb_read_ahead_threshold\u63a7\u5236\u7740InnoDB\u68c0\u6d4b\u987a\u5e8f\u9875\u9762\u8bbf\u95ee\u6a21\u5f0f\u7684\u654f\u611f\u5ea6\u3002\u5982\u679c\u4ece\u4e00\u4e2a\u533a\u6bb5\u8fde\u7eed\u8bfb\u53d6\u7684\u9875\u9762\u6570\u5927\u4e8e\u6216\u7b49\u4e8einnodb_read_ahead_threshold, InnoDB\u4f1a\u5bf9\u6574\u4e2a\u540e\u7eed\u533a\u6bb5\u542f\u52a8\u4e00\u4e2a\u5f02\u6b65\u9884\u8bfb\u64cd\u4f5c\u3002innodb_read_ahead_threshold\u53ef\u4ee5\u8bbe\u7f6e\u4e3a0-64\u4e4b\u95f4\u7684\u4efb\u4f55\u503c\u3002\u9ed8\u8ba4\u503c\u662f56\u3002\u503c\u8d8a\u9ad8\uff0c\u8bbf\u95ee\u6a21\u5f0f\u68c0\u67e5\u8d8a\u4e25\u683c\u3002\u4f8b\u5982\uff0c\u5982\u679c\u4f60\u5c06\u8fd9\u4e2a\u503c\u8bbe\u7f6e\u4e3a48,InnoDB\u53ea\u4f1a\u572848\u4e2a\u9875\u9762\u88ab\u987a\u5e8f\u8bbf\u95ee\u7684\u60c5\u51b5\u4e0b\u89e6\u53d1\u4e00\u4e2a\u7ebf\u6027\u63d0\u524d\u8bfb\u53d6\u8bf7\u6c42\u3002\u5982\u679c\u503c\u662f8,InnoDB\u4f1a\u89e6\u53d1\u5f02\u6b65\u63d0\u524d\u8bfb\u53d6\uff0c\u5373\u4f7f\u53ea\u67098\u4e2a\u9875\u9762\u88ab\u987a\u5e8f\u8bbf\u95ee\u3002\u60a8\u53ef\u4ee5\u5728MySQL\u914d\u7f6e\u6587\u4ef6\u4e2d\u8bbe\u7f6e\u8be5\u53c2\u6570\u7684\u503c\uff0c\u6216\u8005\u4f7f\u7528set GLOBAL\u8bed\u53e5\u52a8\u6001\u5730\u66f4\u6539\u5b83\uff0c\u8fd9\u9700\u8981\u8db3\u591f\u7684\u6743\u9650\u6765\u8bbe\u7f6e\u5168\u5c40\u7cfb\u7edf\u53d8\u91cf\u3002</p> </li> </ul> <pre><code>mysql&gt; show variables like 'innodb_read_ahead_threshold';\n+-----------------------------+-------+\n| Variable_name               | Value |\n+-----------------------------+-------+\n| innodb_read_ahead_threshold | 56    |\n+-----------------------------+-------+\n</code></pre> <ul> <li>\u968f\u673a\u9884\u8bfb\uff0c\u5b83\u6839\u636e\u7f13\u51b2\u6c60\u4e2d\u5df2\u7ecf\u5b58\u5728\u7684\u9875\u9762\u9884\u6d4b\u4f55\u65f6\u53ef\u80fd\u9700\u8981\u8fd9\u4e9b\u9875\u9762\uff0c\u800c\u4e0d\u8003\u8651\u8fd9\u4e9b\u9875\u9762\u88ab\u8bfb\u53d6\u7684\u987a\u5e8f\u3002\u5982\u679c\u5728\u7f13\u51b2\u6c60\u4e2d\u53d1\u73b0\u6765\u81ea\u76f8\u540c\u533a\u6bb5\u768413\u4e2a\u8fde\u7eed\u7684\u9875\u9762\uff0cInnoDB\u5f02\u6b65\u5730\u53d1\u51fa\u8bf7\u6c42\u6765\u9884\u53d6\u533a\u6bb5\u7684\u5269\u4f59\u9875\u9762\u3002\u9ed8\u8ba4\u662f\u5173\u95ed\u7684\u3002\u8981\u542f\u7528\u8fd9\u4e2a\u7279\u6027\uff0c\u8bf7\u5c06\u914d\u7f6e\u53d8\u91cfinnodb_random_read_ahead\u8bbe\u7f6e\u4e3aON\u3002</li> </ul> <pre><code>mysql&gt; show variables like 'innodb_random_read_ahead';\n+--------------------------+-------+\n| Variable_name            | Value |\n+--------------------------+-------+\n| innodb_random_read_ahead | OFF   |\n+--------------------------+-------+\n</code></pre> <p><code>SHOW ENGINE INNODB STATUS</code>\u547d\u4ee4\u663e\u793a\u7edf\u8ba1\u4fe1\u606f\uff0c\u5e2e\u52a9\u60a8\u8bc4\u4f30\u9884\u8bfb\u7b97\u6cd5\u7684\u6709\u6548\u6027\u3002\u7edf\u8ba1\u4fe1\u606f\u5305\u62ec\u4ee5\u4e0b\u5168\u5c40\u72b6\u6001\u53d8\u91cf\u7684\u8ba1\u6570\u5668\u4fe1\u606f:</p> <ul> <li>Innodb_buffer_pool_read_ahead</li> <li>Innodb_buffer_pool_read_ahead_evicted</li> <li>Innodb_buffer_pool_read_ahead_rnd</li> </ul> <p>\u5728\u5fae\u8c03innodb_random_read_ahead\u8bbe\u7f6e\u65f6\uff0c\u8fd9\u4e9b\u4fe1\u606f\u53ef\u80fd\u5f88\u6709\u7528\u3002</p> <p>\u4ee5\u4e0a\u5185\u5bb9\u6765\u6e90\u4e8e</p> <ol> <li>\u5b98\u65b9\u6587\u6863</li> <li>InnoD\u5b58\u50a8\u5f15\u64ce\u7684\u5173\u952e\u7279\u6027</li> <li>\u963f\u91cc\u4e91\u6816\u793e\u533a-Double Write</li> </ol>"},{"location":"advanced/3.InnoDB%E2%80%94%E2%80%94%E5%85%B3%E9%94%AE%E7%89%B9%E6%80%A7/#_19","title":"\u78c1\u76d8\u539f\u5b50\u5199","text":""},{"location":"advanced/4.InnoDB%E5%86%85%E5%AD%98%E7%BB%93%E6%9E%84%E2%80%94%E2%80%94%E7%BC%93%E5%86%B2%E6%B1%A0/","title":"\u7f13\u51b2\u6c60","text":"<p>\u4f20\u7edf\u7684 DBMS \u67b6\u6784\u90fd\u5c5e\u4e8e disk-oriented architecture\uff0c\u5373\u5047\u8bbe\u6570\u636e\u4e3b\u8981\u5b58\u50a8\u5728\u975e\u6613\u5931\u7684\u78c1\u76d8\uff08non-volatile disk\uff09\u4e0a\u3002</p> <p>\u4e8e\u662f DBMS \u4e2d\u4e00\u822c\u90fd\u6709\u78c1\u76d8\u7ba1\u7406\u6a21\u5757\uff08disk manager\uff09\uff0c\u5b83\u4e3b\u8981\u8d1f\u8d23\u6570\u636e\u5728\u975e\u6613\u5931\u4e0e\u6613\u5931\uff08volatile\uff09\u7684\u5b58\u50a8\u5668\u4e4b\u95f4\u7684\u79fb\u52a8\u3002</p> <p>\u8fd9\u91cc\u9700\u8981\u7406\u89e3\u4e24\u70b9\uff1a</p> <ul> <li>\u4e3a\u4ec0\u4e48\u9700\u8981\u5c06\u6570\u636e\u5728\u4e0d\u540c\u7684\u5b58\u50a8\u5668\u4e4b\u95f4\u79fb\u52a8\uff1f</li> <li>\u4e3a\u4ec0\u4e48\u8981\u81ea\u5df1\u6765\u505a\u6570\u636e\u79fb\u52a8\u7684\u7ba1\u7406\uff0c\u800c\u975e\u5229\u7528 OS \u81ea\u5e26\u7684\u78c1\u76d8\u7ba1\u7406\u6a21\u5757\uff1f</li> </ul> <p>\u4ece InnoDB \u903b\u8f91\u5b58\u50a8\u7ed3\u6784\u6765\u770b\uff0c\u6240\u6709\u7684\u6570\u636e\u90fd\u88ab\u903b\u8f91\u7684\u5b58\u653e\u5728\u4e00\u4e2a\u7a7a\u95f4\u4e2d\uff0c\u8fd9\u4e2a\u7a7a\u95f4\u5c31\u53eb\u505a\u8868\u7a7a\u95f4\uff08tablespace\uff09\u3002</p> <p>****\u8868\u7a7a\u95f4\u7531 \u6bb5\uff08segment\uff09\u3001\u533a\uff08extent\uff09\u3001\u9875\uff08page\uff09****\u7ec4\u6210\u3002</p> <p>\u5f53\u6211\u4eec\u521b\u5efa\u4e00\u4e2a\u8868\u4e4b\u540e\uff0c\u5728\u78c1\u76d8\u4e0a\u4f1a\u6709\u5bf9\u5e94\u7684\u8868\u540d\u79f0<code>.ibd</code>\u7684\u78c1\u76d8\u6587\u4ef6\u3002</p> <p>\u8868\u7a7a\u95f4\u7684\u78c1\u76d8\u6587\u4ef6\u91cc\u9762\u6709\u5f88\u591a\u7684\u6570\u636e\u9875\uff0c\u4e00\u4e2a\u6570\u636e\u9875\u6700\u591a 16kb\uff0c\u56e0\u4e3a\u4e0d\u53ef\u80fd\u4e00\u4e2a\u6570\u636e\u9875\u4e00\u4e2a\u78c1\u76d8\u6587\u4ef6\uff0c\u6240\u4ee5\u6570\u636e\u533a\u7684\u6982\u5ff5\u5f15\u5165\u4e86\u3002</p>"},{"location":"advanced/4.InnoDB%E5%86%85%E5%AD%98%E7%BB%93%E6%9E%84%E2%80%94%E2%80%94%E7%BC%93%E5%86%B2%E6%B1%A0/#_2","title":"\u5185\u5b58","text":""},{"location":"advanced/4.InnoDB%E5%86%85%E5%AD%98%E7%BB%93%E6%9E%84%E2%80%94%E2%80%94%E7%BC%93%E5%86%B2%E6%B1%A0/#buffer-pool","title":"\u5185\u5b58\u7f13\u51b2\u6c60\uff08buffer pool\uff09","text":"<p>InnoDB \u5b58\u50a8\u5f15\u64ce\u662f\u57fa\u4e8e\u78c1\u76d8\u5b58\u50a8\u7684\uff0c\u5e76\u5c06\u5176\u4e2d\u7684\u8bb0\u5f55\u6309\u7167\u9875\u7684\u65b9\u5f0f\u8fdb\u7ba1\u7406\uff0c\u56e0\u6b64\u53ef\u4ee5\u5c06\u5176\u89c6\u4e3a\u57fa\u4e8e\u78c1\u76d8\u7684\u6570\u636e\u5e93\u7cfb\u7edf\u3002</p> <p>\u5728\u6570\u636e\u5e93\u7cfb\u7edf\u4e2d\uff0c\u7531\u4e8e CPU \u548c\u78c1\u76d8\u4ea4\u6362\u901f\u5ea6\u7684\u5dee\u8ddd\uff0c\u57fa\u4e8e\u78c1\u76d8\u7684\u6570\u636e\u5e93\u7cfb\u7edf\u901a\u5e38\u4f7f\u7528\u7f13\u51b2\u6c60\u6280\u672f\u6765\u63d0\u9ad8\u6570\u636e\u5e93\u7684\u6574\u4f53\u6027\u80fd\u3002</p> <p>\u5185\u5b58\u7f13\u51b2\u6c60\u7b80\u5355\u8bf4\u5c31\u662f MySQL \u8fdb\u7a0b\u5411\u64cd\u4f5c\u7cfb\u7edf\u7533\u8bf7\u4e00\u5757\u5185\u5b58\u533a\u57df\uff0c\u901a\u8fc7\u5185\u5b58\u7684\u901f\u5ea6\u6765\u5f25\u8865\u78c1\u76d8\u7684\u901f\u5ea6\uff0c\u5728\u6570\u636e\u5e93\u4e2d\u8bfb\u53d6\u9875\u65f6\uff0c\u9996\u5148\u5c06\u78c1\u76d8\u8bfb\u5230\u7684\u9875\u653e\u5230\u7f13\u51b2\u6c60\u4e2d\uff0c\u8fd9\u4e2a\u8fc7\u7a0b\u79f0\u4e3a\u5c06\u9875 fix \u5230\u7f13\u51b2\u6c60\u3002</p> <p><code>buffer pool</code> \u4e00\u822c\u79f0\u4e3a<code>\u5185\u5b58\u7f13\u51b2\u6c60</code>\uff0c\u5728 MySQL \u4e5f\u6709\u4eba\u7b80\u79f0<code>bp</code>\u3002</p> <p>\u4e0b\u6b21\u518d\u8bfb\u53d6\u76f8\u5173\u7684\u9875\u65f6\uff0c\u4e0b\u6b21\u518d\u8bfb\u53d6\u76f8\u540c\u7684\u9875\u65f6\uff0c\u5148\u5224\u65ad\u662f\u5426\u5728\u7f13\u51b2\u6c60\u4e2d\uff0c\u82e5\u5728\uff0c\u5219\u79f0\u4e3a\u8be5\u9875\u5728\u7f13\u51b2\u6c60\u88ab\u547d\u4e2d\u3002</p> <p>\u5bf9\u4e8e\u4fee\u6539\u6570\u636e\uff08\u589e\u5220\u6539\uff09\uff0c\u540c\u6837\u9996\u5148\u4fee\u6539\u7f13\u51b2\u6c60\u4e2d\u7684\u9875\uff0c\u7136\u540e\u5728\u4ee5\u4e00\u5b9a\u7684\u9891\u7387\u5237\u65b0\u5230\u78c1\u76d8\u3002\u901a\u8fc7\u4e00\u79cd\u88ab\u79f0\u4f5c checkpoint \u7684\u673a\u5236\u5237\u56de\u78c1\u76d8\u3002</p>"},{"location":"advanced/4.InnoDB%E5%86%85%E5%AD%98%E7%BB%93%E6%9E%84%E2%80%94%E2%80%94%E7%BC%93%E5%86%B2%E6%B1%A0/#_3","title":"\u5173\u952e\u6982\u5ff5\u2014\u2014\u6570\u636e\u9875","text":"<p>\u5728 MySQL \u4e2d\uff0cinnodb \u8868\u4ee5 tablename.ibd \u683c\u5f0f\u7684\u6587\u4ef6\u5b58\u653e\u5728\u78c1\u76d8\u4e2d\u3002</p> <p>\u6570\u636e\u9875\u662f MySQL \u62bd\u8c61\u51fa\u6765\u7684\u6570\u636e\u5355\u4f4d\uff0c\u78c1\u76d8\u6587\u4ef6\u4e2d\u5c31\u662f\u5b58\u653e\u4e86\u5f88\u591a\u6570\u636e\u9875\uff0c\u6bcf\u4e2a\u6570\u636e\u9875\u91cc\u5b58\u653e\u4e86\u5f88\u591a\u884c\u6570\u636e\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u6570\u636e\u9875\u7684\u5927\u5c0f\u662f 16KB\u3002</p> <p>\u6570\u636e\u5e93\u91c7\u7528\u6570\u636e\u9875\u7684\u5f62\u5f0f\u7ec4\u7ec7\u6570\u636e\u3002MySQL \u9ed8\u8ba4\u7684\u975e\u538b\u7f29\u6570\u636e\u9875\u4e3a 16KB\u3002\u5728 ibd \u4e2d\u95f4\u4e2d\uff0c0-16KB \u504f\u79fb\u91cf\u5373\u4e3a 0 \u53f7\u6570\u636e\u9875\uff0c16KB-32KB \u7684\u4e3a 1 \u53f7\u6570\u636e\u9875\uff0c\u4f9d\u6b21\u7c7b\u63a8\u3002</p> <p>\u6570\u636e\u9875\u7684\u5934\u5c3e\u9664\u4e86\u4e00\u4e9b\u5143\u4fe1\u606f\u5916\uff0c\u8fd8\u6709 Checksum \u6821\u9a8c\u503c\uff0c\u8fd9\u4e9b\u6821\u9a8c\u503c\u5728\u5199\u5165\u78c1\u76d8\u524d\u8ba1\u7b97\u5f97\u5230\uff0c\u5f53\u4ece\u78c1\u76d8\u4e2d\u8bfb\u53d6\u65f6\uff0c\u91cd\u65b0\u8ba1\u7b97\u6821\u9a8c\u503c\u5e76\u4e0e\u6570\u636e\u9875\u4e2d\u5b58\u50a8\u7684\u5bf9\u6bd4\uff0c\u5982\u679c\u53d1\u73b0\u4e0d\u540c\uff0c\u5219\u4f1a\u5bfc\u81f4 MySQL crash\u3002\u9047\u5230\u8fd9\u79cd\u60c5\u51b5\uff0c\u5f80\u5f80\u9700\u8981\u4ece\u5907\u4efd\u96c6\u4e2d\u6062\u590d\u6570\u636e\uff0c\u5982\u679c\u5907\u4efd\u4e0d\u53ef\u7528\uff0c\u53ea\u80fd\u4f7f\u7528 innodb_force_recovery \u5f3a\u884c\u542f\u52a8\uff0c\u7136\u540e\u5c3d\u53ef\u80fd\u591a\u7684\u5bfc\u51fa\u6570\u636e\u3002</p> <p>\u4e25\u683c\u6765\u8bb2\uff0cInnoDB \u7684\u6570\u636e\u9875\u6709\u5f88\u591a\u79cd\uff0c\u6bd4\u5982\uff0c\u7d22\u5f15\u9875\uff0cUndo \u9875\uff0cInode \u9875\uff0c\u7cfb\u7edf\u9875\uff0cBloB \u9875\u7b49\uff0c\u4e00\u5171\u6709 10 \u591a\u79cd\u3002</p> <p>\u5bf9\u5e94\u7684\uff0c\u5728 <code>Buffer Pool</code> \u4e2d\uff0c\u4e5f\u662f\u4ee5\u6570\u636e\u9875\u4e3a\u6570\u636e\u5355\u4f4d\uff0c\u5b58\u653e\u7740\u5f88\u591a\u6570\u636e\u3002</p> <p>\u4f46\u662f\u901a\u5e38\u88ab\u53eb\u505a\u7f13\u5b58\u9875\uff0c\u56e0\u4e3a <code>Buffer Pool</code> \u662f\u4e00\u4e2a\u7f13\u51b2\u6c60\uff0c\u5e76\u4e14\u91cc\u9762\u7684\u6570\u636e\u90fd\u662f\u4ece\u78c1\u76d8\u6587\u4ef6\u4e2d\u7f13\u5b58\u5230\u5185\u5b58\u4e2d\u3002</p> <p>\u6240\u4ee5\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u7f13\u5b58\u9875\u7684\u5927\u5c0f\u4e5f\u662f 16KB\uff0c\u56e0\u4e3a\u5b83\u548c\u78c1\u76d8\u6587\u4ef6\u4e2d\u6570\u636e\u9875\u662f\u4e00\u4e00\u5bf9\u5e94\u7684\u3002</p> <p>\u7f13\u51b2\u6c60\u548c\u78c1\u76d8\u4e4b\u95f4\u7684\u6570\u636e\u4ea4\u6362\u7684\u5355\u4f4d\u662f\u6570\u636e\u9875\uff0c\u5305\u62ec\u4ece\u78c1\u76d8\u4e2d\u8bfb\u53d6\u6570\u636e\u5230\u7f13\u51b2\u6c60\u548c\u7f13\u51b2\u6c60\u4e2d\u6570\u636e\u5237\u56de\u78c1\u76d8\u4e2d\u3002</p> <p>\u7f13\u51b2\u6c60\u4e2d\u57fa\u672c\u6982\u5ff5</p> <p>\u7f13\u51b2\u6c60\u662f MySQL \u5411\u64cd\u4f5c\u7cfb\u7edf\u7533\u8bf7\u7684\u4e00\u5757\u5185\u5b58\u533a\u57df\uff0c\u64cd\u4f5c\u7cfb\u7edf\u662f\u4ee5\u9875\u4e3a\u5355\u4f4d\u5bf9\u5185\u5b58\u8fdb\u884c\u7ba1\u7406\u3002</p> <p>\u7f13\u51b2\u6c60\u662f InnoDB \u5b58\u50a8\u5f15\u64ce\u4e2d\u6700\u91cd\u8981\u7684\u7ec4\u4ef6\u3002\u4e3a\u4e86\u63d0\u9ad8 MySQL \u7684\u5e76\u53d1\u6027\u80fd\uff0c\u4f7f\u7528\u5230\u7684\u6570\u636e\u90fd\u4f1a\u7f13\u5b58\u5728\u7f13\u51b2\u6c60\u4e2d\uff0c\u7136\u540e\u6240\u6709\u7684\u589e\u5220\u6539\u67e5\u64cd\u4f5c\u90fd\u5c06\u5728\u7f13\u51b2\u6c60\u4e2d\u6267\u884c\u3002</p> <p>\u5bf9\u4e8e\u6bcf\u4e2a\u66f4\u65b0\u8bf7\u6c42\uff0c\u5c3d\u91cf\u5c31\u662f \u53ea\u66f4\u65b0\u5185\u5b58\uff0c\u7136\u540e\u5f80\u78c1\u76d8\u987a\u5e8f\u5199\u65e5\u5fd7\u6587\u4ef6\u3002</p> <p>\u66f4\u65b0\u5185\u5b58\u7684\u6027\u80fd\u662f\u6781\u9ad8\u7684\uff0c\u7136\u540e\u987a\u5e8f\u5199\u78c1\u76d8\u4e0a\u7684\u65e5\u5fd7\u6587\u4ef6\u7684\u6027\u80fd\u4e5f\u662f\u6bd4\u8f83\u9ad8\u7684\uff0c\u56e0\u4e3a\u987a\u5e8f\u5199\u78c1\u76d8\u6587\u4ef6\uff0c\u4ed6\u7684\u6027\u80fd\u8981\u8fdc\u9ad8\u4e8e\u968f\u673a\u8bfb\u5199\u78c1\u76d8\u6587\u4ef6\u3002</p> <p>\u5177\u4f53\u6765\u770b\uff0c\u7f13\u51b2\u6c60\u4e2d\u7684\u9875\u7c7b\u578b\u6709\uff1a</p> <ul> <li>\u6570\u636e\u9875</li> <li>\u7d22\u5f15\u9875</li> <li>undo \u9875</li> <li>\u63d2\u5165\u7f13\u51b2</li> <li>\u81ea\u9002\u5e94\u54c8\u5e0c\u7d22\u5f15</li> <li>InnoDB \u5b58\u50a8\u7684\u9501\u4fe1\u606f</li> <li>\u6570\u636e\u5b57\u5178\u4fe1\u606f\u7b49\u3002</li> </ul> <p>\u4e0d\u80fd\u7b80\u5355\u7684\u8ba4\u4e3a\uff0c\u7f13\u51b2\u6c60\u53ea\u662f\u7f13\u51b2\u7d22\u5f15\u548c\u6570\u636e\u9875\u3002\u5b83\u4eec\u53ea\u662f\u5360\u5185\u5b58\u7f13\u51b2\u6c60\u5f88\u5927\u7684\u4e00\u90e8\u5206\u800c\u5df2</p> <p>\u5728 Linux \u4e2d\uff0c\u64cd\u4f5c\u7cfb\u7edf\u4ee5\u9875\u4e3a\u5355\u4f4d\u7ba1\u7406\u5185\u5b58\uff0c\u65e0\u8bba\u662f\u5c06\u78c1\u76d8\u4e2d\u7684\u6570\u636e\u52a0\u8f7d\u5230\u5185\u5b58\u4e2d\uff0c\u8fd8\u662f\u5c06\u5185\u5b58\u4e2d\u7684\u6570\u636e\u5199\u56de\u78c1\u76d8\uff0c\u64cd\u4f5c\u7cfb\u7edf\u90fd\u4f1a\u4ee5\u9875\u9762\u4e3a\u5355\u4f4d\u8fdb\u884c\u64cd\u4f5c\u3002 \u54ea\u6015\u6211\u4eec\u53ea\u5411\u78c1\u76d8\u4e2d\u5199\u5165\u4e00\u4e2a\u5b57\u8282\u7684\u6570\u636e\uff0c\u6211\u4eec\u4e5f\u9700\u8981\u5c06\u6574\u4e2a\u9875\u9762\u4e2d\u7684\u5168\u90e8\u6570\u636e\u5237\u5165\u78c1\u76d8\u4e2d\u3002 \u5728\u64cd\u4f5c\u7cfb\u7edf\u5c42\u9762\uff0c\u6bcf\u4e2a\u8fdb\u7a0b\u90fd\u6709\u81ea\u5df1\u72ec\u7acb\u7684\u5730\u5740\u7a7a\u95f4\uff0c\u770b\u5230\u7684\u90fd\u662f\u64cd\u4f5c\u7cfb\u7edf\u865a\u62df\u51fa\u6765\u7684\u5730\u5740\u7a7a\u95f4\uff0c\u865a\u62df\u5730\u5740\u6700\u7ec8\u8fd8\u662f\u8981\u843d\u5728\u5b9e\u9645\u5185\u5b58\u7684\u7269\u7406\u5730\u5740\u4e0a\u8fdb\u884c\u64cd\u4f5c\u7684\u3002 \u64cd\u4f5c\u7cfb\u7edf\u5c31\u4f1a\u901a\u8fc7\u9875\u8868\u7684\u673a\u5236\u6765\u5b9e\u73b0\u8fdb\u7a0b\u7684\u865a\u62df\u5730\u5740\u5230\u7269\u7406\u5730\u5740\u3002\u5176\u4e2d\u6bcf\u4e00\u9875\u7684\u5927\u5c0f\u90fd\u662f\u56fa\u5b9a\u7684\u3002</p> <pre><code>####X86\uff1a\n[root@ens8 ~]# getconf PAGESIZE\n4096\n####ARM\uff1a\nroot@ens8ARM:~# getconf PAGESIZE\n65536\n</code></pre> <p>Linux \u540c\u65f6\u652f\u6301\u6b63\u5e38\u5927\u5c0f\u7684\u5185\u5b58\u9875\u548c\u5927\u5185\u5b58\u9875\uff08Huge Page\uff09</p> <p>\u7edd\u5927\u591a\u6570\u5904\u7406\u5668\u4e0a\u7684\u5185\u5b58\u9875\uff08page\uff09\u7684\u9ed8\u8ba4\u5927\u5c0f\u90fd\u662f 4KB\uff0c\u867d\u7136\u90e8\u5206\u5904\u7406\u5668\u4f1a\u4f7f\u7528 8KB\u300116KB \u6216\u8005 64KB \u4f5c\u4e3a\u9ed8\u8ba4\u7684\u9875\u9762\u5927\u5c0f\uff0c\u4f46\u662f 4KB \u7684\u9875\u9762\u4ecd\u7136\u662f\u64cd\u4f5c\u7cfb\u7edf\u9ed8\u8ba4\u5185\u5b58\u9875\u914d\u7f6e\u7684\u4e3b\u6d41\uff1b</p> <p>\u4e3a\u4ec0\u4e48 Linux \u9ed8\u8ba4\u9875\u5927\u5c0f\u662f 4KB</p> <p>\u603b\u7ed3\u4e00\u4e0b\uff1a</p> <ul> <li> <p>innodb_page_size \u4f5c\u4e3a innodb \u548c OS \u4ea4\u4e92\u5355\u4f4d\u3002\u6587\u4ef6\u7cfb\u7edf\u5bf9\u6587\u4ef6\u7684 buffer IO\uff0c\u4e5f\u662f page \u4e3a\u5355\u4f4d\u8fdb\u884c\u5904\u7406\u7684\u3002</p> </li> <li> <p>InnoDB \u7f13\u51b2\u6c60\u4e2d\u7684\u6570\u636e\u8bbf\u95ee\u662f\u4ee5 Page \u4e3a\u5355\u4f4d\u7684\uff0c\u6bcf\u4e2a Page \u7684\u5927\u5c0f\u9ed8\u8ba4\u4e3a 16KB\uff0cBuffer Pool \u662f\u7528\u6765\u7ba1\u7406\u548c\u7f13\u5b58\u8fd9\u4e9b Page \u7684\u3002</p> </li> </ul>"},{"location":"advanced/4.InnoDB%E5%86%85%E5%AD%98%E7%BB%93%E6%9E%84%E2%80%94%E2%80%94%E7%BC%93%E5%86%B2%E6%B1%A0/#_4","title":"\u5185\u5b58\u7f13\u51b2\u6c60\u76f8\u5173\u53c2\u6570\u914d\u7f6e","text":"<pre><code># \u5185\u5b58\u7f13\u51b2\u6c60\u603b\u5927\u5c0f\uff0c\u9ed8\u8ba4\u662f128M\uff0c\u5e94\u5f53\u9002\u5f53\u8bbe\u7f6e\u8c03\u5927buffer_pool_size,\u4e00\u822c\u8bbe\u7f6e\u4e3a\u670d\u52a1\u5668\u5185\u5b5860%\u3002\u901a\u5e38\u5b9e\u9645\u5360\u7528\u7684\u5185\u5b58\u4f1a\u6bd4\u914d\u7f6e\u7684\u8fd8\u8981\u592710%\n# MySQL5.7.5\u4e4b\u540e\u53ef\u4ee5\u52a8\u6001\u5728\u7ebf\u8c03\u6574\u3002\u5728\u8c03\u6574innodb_buffer_pool_size \u671f\u95f4\uff0c\u7528\u6237\u7684\u8bf7\u6c42\u5c06\u4f1a\u963b\u585e\uff0c\u76f4\u5230\u8c03\u6574\u5b8c\u6bd5\uff0c\u6240\u4ee5\u8bf7\u52ff\u5728\u767d\u5929\u8c03\u6574\uff0c\u5c3d\u91cf\u5728\u51cc\u66683-4\u70b9\u4e1a\u52a1\u4f4e\u5cf0\u671f\u8c03\u6574\u3002\ninnodb_buffer_pool_size=8G\n\n# \u5185\u5b58\u7f13\u51b2\u6c60\u5b9e\u4f8b\u6570\uff0c\u9ed8\u8ba4\u662f1\uff0c\u901a\u8fc7\u5c06buffer pool\u5206\u6210\u591a\u4e2a\u533a\uff0c\u6bcf\u4e2a\u533a\u7528\u72ec\u7acb\u7684\u9501\u4fdd\u62a4\uff0c\u8fd9\u6837\u5c31\u51cf\u5c11\u4e86\u8bbf\u95eebuffer_pool\u65f6\u9700\u8981\u4e0a\u9501\u7684\u7c92\u5ea6\uff0c\u4ee5\u63d0\u9ad8\u5e76\u53d1\u80fd\u529b\u548c\u6027\u80fd\u3002\ninnodb_buffer_pool_instances=16\n\n# innodb\u9875\u5927\u5c0f\uff0c\u9ed8\u8ba4\u662f16KB\uff0c\u4e00\u822c\u8bbe\u7f6e\u4e3a16KB\u621664KB\ninnodb_page_size=16KB\n\n# \u5728\u8c03\u6574\u5185\u5b58\u7f13\u51b2\u6c60\u603b\u5927\u5c0f\u65f6\uff0c\u5185\u90e8\u628a\u6570\u636e\u9875\u79fb\u52a8\u5230\u4e00\u4e2a\u65b0\u7684\u4f4d\u7f6e\uff0c\u5355\u4f4d\u662f\u5757\u3002\u5982\u679c\u60f3\u589e\u52a0\u79fb\u52a8\u7684\u901f\u5ea6\uff0c\u9700\u8981\u8c03\u6574innodb_buffer_pool_chunk_size\u53c2\u6570\u7684\u5927\u5c0f\uff0c\u9ed8\u8ba4\u662f128M\u3002\u7f13\u51b2\u6c60\u914d\u7f6e\u65f6\u7684\u57fa\u672c\u5355\u4f4d\uff0c\u4ee5\u5757\u7684\u5f62\u5f0f\u914d\u7f6e\uff0cinnodb_buffer_pool_chunk_size\u53c2\u6570\u6307\u660e\u5757\u5927\u5c0f\u3002\n# innodb_buffer_pool_size=innodb_buffer_pool_chunk_size * innodb_buffer_pool_instances * n\ninnodb_buffer_pool_chunk_size=128MB\n</code></pre>"},{"location":"advanced/4.InnoDB%E5%86%85%E5%AD%98%E7%BB%93%E6%9E%84%E2%80%94%E2%80%94%E7%BC%93%E5%86%B2%E6%B1%A0/#lru","title":"\u4ec0\u4e48\u662f LRU \u7b97\u6cd5","text":"<p>LRU \u5c31\u662f\u4e00\u79cd\u5f88\u5e38\u89c1\u7684\u7f13\u5b58\u6dd8\u6c70\u7b56\u7565\u3002\u6309\u7167\u82f1\u6587\u7684\u76f4\u63a5\u539f\u4e49\u5c31\u662f Least Recently Used\uff0c\u6700\u8fd1\u6700\u4e45\u672a\u4f7f\u7528\u3002</p> <p>\u5229\u7528\u597d LRU \u7b97\u6cd5\uff0c\u6211\u4eec\u80fd\u591f\u63d0\u9ad8\u5bf9\u70ed\u70b9\u6570\u636e\u7684\u7f13\u5b58\u6548\u7387\uff0c\u8fdb\u800c\u63d0\u5347\u7f13\u5b58\u670d\u52a1\u7684\u5185\u5b58\u4f7f\u7528\u7387\u3002</p> <p>\u4e00\u822c\u8ba1\u7b97\u673a\u5185\u5b58\u5bb9\u91cf\u6709\u9650\uff0c\u64cd\u4f5c\u7cfb\u7edf\u5206\u914d\u7ed9 MySQL \u7684\u5185\u5b58\u7f13\u5b58\u6c60\u5bb9\u91cf\u81ea\u7136\u4e5f\u6709\u9650\uff0c\u5982\u679c\u7f13\u5b58\u6c60\u6ee1\u4e86\u5c31\u8981\u5220\u9664\u4e00\u4e9b\u5185\u5bb9\uff0c\u7ed9\u65b0\u5185\u5bb9\u817e\u4f4d\u7f6e\u3002</p> <p>\u4f46\u95ee\u9898\u662f\uff0c\u5220\u9664\u54ea\u4e9b\u5185\u5bb9\u5462\uff1f\u6211\u4eec\u80af\u5b9a\u5e0c\u671b\u5220\u6389\u54ea\u4e9b\u6ca1\u4ec0\u4e48\u7528\u7684\u7f13\u5b58\uff0c\u800c\u628a\u6709\u7528\u7684\u6570\u636e\u7ee7\u7eed\u7559\u5728\u7f13\u5b58\u91cc\uff0c\u65b9\u4fbf\u4e4b\u540e\u7ee7\u7eed\u4f7f\u7528\u3002</p> <p>\u90a3\u4e48\uff0c\u4ec0\u4e48\u6837\u7684\u6570\u636e\uff0c\u6211\u4eec\u5224\u5b9a\u4e3a\u300c\u6709\u7528\u7684\u300d\u7684\u6570\u636e\u5462\uff1fLRU \u7f13\u5b58\u6dd8\u6c70\u7b97\u6cd5\u5c31\u662f\u4e00\u79cd\u5e38\u7528\u7b56\u7565\u3002</p> <p>LRU \u7684\u5168\u79f0\u662f Least Recently Used\uff0c\u8fd9\u4e2a\u7b97\u6cd5\u8ba4\u4e3a\u6700\u8fd1\u4f7f\u7528\u8fc7\u7684\u6570\u636e\u5e94\u8be5\u662f\u662f\u300c\u6709\u7528\u7684\u300d\uff0c\u5f88\u4e45\u90fd\u6ca1\u7528\u8fc7\u7684\u6570\u636e\u5e94\u8be5\u662f\u65e0\u7528\u7684\uff0c\u5185\u5b58\u6ee1\u4e86\u5c31\u4f18\u5148\u5220\u90a3\u4e9b\u5f88\u4e45\u6ca1\u7528\u8fc7\u7684\u6570\u636e\u3002</p> <p>\u5b83\u662f\u6309\u7167\u4e00\u4e2a\u975e\u5e38\u8457\u540d\u7684\u8ba1\u7b97\u673a\u64cd\u4f5c\u7cfb\u7edf\u57fa\u7840\u7406\u8bba\u5f97\u6765\u7684\uff1a</p> <p>\u6700\u8fd1\u4f7f\u7528\u7684\u9875\u9762\u6570\u636e\u4f1a\u5728\u672a\u6765\u4e00\u6bb5\u65f6\u671f\u5185\u4ecd\u7136\u88ab\u4f7f\u7528,\u5df2\u7ecf\u5f88\u4e45\u6ca1\u6709\u4f7f\u7528\u7684\u9875\u9762\u5f88\u6709\u53ef\u80fd\u5728\u672a\u6765\u8f83\u957f\u7684\u4e00\u6bb5\u65f6\u95f4\u5185\u4ecd\u7136\u4e0d\u4f1a\u88ab\u4f7f\u7528\u3002</p> <p>\u57fa\u4e8e\u8fd9\u4e2a\u601d\u60f3\uff0c\u4f1a\u5b58\u5728\u4e00\u79cd\u7f13\u5b58\u6dd8\u6c70\u673a\u5236\uff0c\u6bcf\u6b21\u4ece\u5185\u5b58\u4e2d\u627e\u5230 \u6700\u4e45\u672a\u4f7f\u7528\u7684\u6570\u636e\u7136\u540e\u7f6e\u6362\u51fa\u6765 \uff0c\u4ece\u800c\u5b58\u5165\u65b0\u7684\u6570\u636e\uff01</p> <p>LRU \u7684\u4e3b\u8981\u8861\u91cf\u6307\u6807\u662f \u4f7f\u7528\u7684\u65f6\u95f4 \u3002\u9644\u52a0\u6307\u6807\u662f \u4f7f\u7528\u7684\u6b21\u6570\u3002</p> <p>\u5728\u8ba1\u7b97\u673a\u4e2d\u5927\u91cf\u4f7f\u7528\u4e86\u8fd9\u4e2a\u673a\u5236\uff0c\u5b83\u7684\u5408\u7406\u6027\u5728\u4e8e \u4f18\u5148\u7b5b\u9009\u70ed\u70b9\u6570\u636e \uff0c\u6240\u8c13\u70ed\u70b9\u6570\u636e\uff0c\u5c31\u662f \u6700\u8fd1\u6700\u591a\u4f7f\u7528\u7684\u6570\u636e \uff01</p>"},{"location":"advanced/4.InnoDB%E5%86%85%E5%AD%98%E7%BB%93%E6%9E%84%E2%80%94%E2%80%94%E7%BC%93%E5%86%B2%E6%B1%A0/#lru_1","title":"LRU \u7684\u5b9e\u73b0","text":"<ul> <li>\u5b9e\u73b0 LRU \u7f13\u5b58\u7684\u5e38\u7528\u65b9\u6cd5\u662f\u4f7f\u7528\u56fa\u5b9a\u957f\u5ea6\u7684\u961f\u5217\u3002\u5b9e\u73b0 LRU \u7684\u5173\u952e\u662f\u5c06\u6240\u6709\u6700\u8fd1\u4f7f\u7528\u7684\u6570\u636e\u653e\u5728\u961f\u5217\u7684\u5f00\u5934\u3002</li> <li>\u6bcf\u6b21\u6709\u65b0\u6570\u636e\u63d2\u5165\u4e4b\u524d\uff0c\u6211\u4eec\u68c0\u67e5\u961f\u5217\u662f\u5426\u5df2\u6ee1\u3002\u5982\u679c\u961f\u5217\u5df2\u6ee1\uff0c\u6211\u4eec\u5c06\u5220\u9664\u5176\u6700\u540e\u4e00\u4e2a\u5143\u7d20\uff0c\u5e76\u5c06\u65b0\u8282\u70b9\u63d2\u5165\u961f\u5217\u7684\u5f00\u5934\u3002</li> <li>\u5982\u679c\u961f\u5217\u672a\u6ee1\uff0c\u6211\u4eec\u53ea\u9700\u5c06\u6570\u636e\u6dfb\u52a0\u5230\u961f\u5217\u7684\u5f00\u5934\u3002</li> </ul> <p>\u5728\u4e00\u4e9b\u5927\u5382\u9762\u8bd5\u4e2d\uff0c\u7ecf\u5e38\u4f1a\u8981\u6c42\u624b\u5199 LRU \u7b97\u6cd5\u3002</p>"},{"location":"advanced/4.InnoDB%E5%86%85%E5%AD%98%E7%BB%93%E6%9E%84%E2%80%94%E2%80%94%E7%BC%93%E5%86%B2%E6%B1%A0/#lru-list","title":"LRU List","text":"<p>\u901a\u5e38\uff0c\u6570\u636e\u5e93\u4e2d\u7684\u7f13\u51b2\u6c60\u662f\u901a\u8fc7 LRU (Latest Recent Used) \u7b97\u6cd5\u6765\u7ba1\u7406\u7684\uff0c\u5373\u6700\u9891\u7e41\u4f7f\u7528\u7684\u9875\u5728 LRU \u6700\u524d\u7aef\u3002</p> <p>\u4f46\u662f MySQL InnoDB \u5bf9\u4f20\u7edf\u7684 LRU \u7b97\u6cd5\u505a\u4e86\u4e00\u4e9b\u4f18\u5316\u3002\u5728 buffer pool \u4e2d\u7684\u7684\u6570\u636e\u9875\u53ef\u4ee5\u8ba4\u4e3a\u662f\u4e00\u4e2a LIST \u5217\u8868\uff0c\u5206\u4e3a\u4e24\u4e2a\u5b50\u5217\u8868 \uff08New Sublist\uff09 \uff08 Old Sublist\uff09</p> <pre><code># \u8fd9\u4e2a\u53c2\u6570\u63a7\u5236\u7740 New Sublist \u548c Old Sublist \u7684\u6bd4\u4f8b \uff0cNew Sublist\u53605/8\uff0cOld Sublist\u53603/8\ninnodb_old_blocks_pct=37\n</code></pre> <p>\u53ef\u4ee5\u7b80\u5355\u7406\u89e3\u4e3a New Sublist \u4e2d\u7684\u9875\u90fd\u662f\u6700\u6d3b\u8dc3\u7684\u70ed\u70b9\u6570\u636e\u9875\u3002</p> <p>\u5f53\u6709\u6570\u636e\u9875\u8981\u52a0\u8f7d\u5230\u5185\u5b58\u4e2d\uff0c\u5c31\u63d2\u5165\u5230 Old Sublist \u7684\u5934\u90e8\uff0c\u5e76\u4e14\u4ece Old Sublist \u5c3e\u90e8\u79fb\u9664\u4e0d\u518d\u4f7f\u7528\u7684\u9875\u3002</p> <p>\u53ef\u4ee5\u770b\u5230\uff0c\u8fd9\u662f\u4e00\u4e2a\u5148\u8fdb\u5148\u51fa\u7684\u961f\u5217\u3002</p> <p>\u5f88\u660e\u663e\u4e0d\u7528\u4e00\u4e2a\u961f\u5217\u6765\u7ba1\u7406\u8fd9\u4e9b\uff0c\u53ef\u4ee5\u907f\u514d\u4e00\u6b21\u5927\u8868\u7684\u5168\u8868\u626b\u63cf\uff0c\u5c31\u628a\u7f13\u51b2\u6c60\u4e2d\u7684\u6240\u6709\u6570\u636e\u90fd\u5237\u51fa\u3002</p> <p>MySQL \u9ed8\u8ba4\u5728 InnoDB \u7f13\u51b2\u6c60\uff08\u800c\u4e0d\u662f\u6574\u4e2a\u7f13\u51b2\u6c60\uff09\u4e2d\u4ec5\u4fdd\u7559\u6700\u9891\u7e41\u8bbf\u95ee\u9875\u7684 25% \u3002</p> <p>\u5728\u591a\u6570\u4f7f\u7528\u573a\u666f\u4e0b\uff0c\u5408\u7406\u7684\u9009\u62e9\u662f\uff1a\u4fdd\u7559\u6700\u6709\u7528\u7684\u6570\u636e\u9875\uff0c\u6bd4\u52a0\u8f7d\u6240\u6709\u7684\u9875(\u5f88\u591a\u9875\u53ef\u80fd\u5728\u540e\u7eed\u7684\u5de5\u4f5c\u4e2d\u5e76\u6ca1\u6709\u8bbf\u95ee\u5230)\u5728\u7f13\u51b2\u6c60\u4e2d\u8981\u66f4\u5feb\u3002</p> <pre><code># INFORMATION_SCHEMA\u4e2d\u6709\u51e0\u4e2a\u7f13\u51b2\u6c60\u8868\u63d0\u4f9b\u6709\u5173InnoDB\u7f13\u51b2\u6c60\u4e2d\u9875\u9762\u7684\u7f13\u51b2\u6c60\u72b6\u6001\u4fe1\u606f\u548c\u5143\u6570\u636e\u3002\n\n############ \u67e5\u8be2INNODB_BUFFER_PAGE\u8868\u53ef\u80fd\u4f1a\u5f71\u54cd\u6027\u80fd\u3002 \u9664\u975e\u60a8\u4e86\u89e3\u6027\u80fd\u5f71\u54cd\u5e76\u786e\u5b9a\u5176\u53ef\u63a5\u53d7\uff0c\u5426\u5219\u8bf7\u52ff\u5728\u751f\u4ea7\u7cfb\u7edf\u4e0a\u67e5\u8be2\u6b64\u8868\u3002 \u4e3a\u907f\u514d\u5f71\u54cd\u751f\u4ea7\u7cfb\u7edf\u7684\u6027\u80fd\uff0c\u8bf7\u91cd\u73b0\u8981\u8c03\u67e5\u7684\u95ee\u9898\u5e76\u5728\u6d4b\u8bd5\u5b9e\u4f8b\u4e0a\u67e5\u8be2\u7f13\u51b2\u6c60\u7edf\u8ba1\u4fe1\u606f\u3002\n\nmysql&gt; SHOW TABLES FROM INFORMATION_SCHEMA LIKE 'INNODB_BUFFER%';\n+-----------------------------------------------+\n| Tables_in_INFORMATION_SCHEMA (INNODB_BUFFER%) |\n+-----------------------------------------------+\n| INNODB_BUFFER_PAGE_LRU                        |\n| INNODB_BUFFER_PAGE                            |\n| INNODB_BUFFER_POOL_STATS                      |\n+-----------------------------------------------+\n\n# INNODB_BUFFER_PAGE\uff1a\u4fdd\u5b58InnoDB\u7f13\u51b2\u6c60\u4e2d\u6bcf\u4e2a\u9875\u9762\u7684\u4fe1\u606f\u3002\n\n# INNODB_BUFFER_PAGE_LRU\uff1a\u4fdd\u5b58\u6709\u5173InnoDB\u7f13\u51b2\u6c60\u4e2d\u9875\u9762\u7684\u4fe1\u606f\uff0c\u7279\u522b\u662f\u5b83\u4eec\u5728LRU\u5217\u8868\u4e2d\u7684\u6392\u5e8f\u65b9\u5f0f\uff0c\u786e\u5b9a\u54ea\u4e9b\u9875\u9762\u5728\u7f13\u51b2\u6c60\u53d8\u6ee1\u65f6\u4ece\u7f13\u51b2\u6c60\u4e2d\u9010\u51fa\u3002 INNODB_BUFFER_PAGE_LRU\u8868\u4e0eINNODB_BUFFER_PAGE\u8868\u5177\u6709\u76f8\u540c\u7684\u5217\u3002\n# \u4f46INNODB_BUFFER_PAGE_LRU\u8868\u5177\u6709LRU_POSITION\u5217\u800c\u4e0d\u662fBLOCK_ID\u5217\u3002\n# INNODB_BUFFER_POOL_STATS\uff1a\u63d0\u4f9b\u7f13\u51b2\u6c60\u72b6\u6001\u4fe1\u606f\u3002\u8bb8\u591a\u76f8\u540c\u7684\u4fe1\u606f\u7531SHOW ENGINE INNODB STATUS\u8f93\u51fa\u63d0\u4f9b\uff0c\u6216\u8005\u53ef\u4ee5\u4f7f\u7528InnoDB\u7f13\u51b2\u6c60\u670d\u52a1\u5668\u72b6\u6001\u53d8\u91cf\u83b7\u5f97\u3002\n</code></pre>"},{"location":"advanced/4.InnoDB%E5%86%85%E5%AD%98%E7%BB%93%E6%9E%84%E2%80%94%E2%80%94%E7%BC%93%E5%86%B2%E6%B1%A0/#innodb","title":"\u4f7f\u7528 InnoDB \u6807\u51c6\u76d1\u89c6\u5668\u76d1\u89c6\u7f13\u51b2\u6c60","text":"<p><code>InnoDB</code>\u53ef\u4ee5\u4f7f\u7528\u8bbf\u95ee\u7684\u6807\u51c6\u76d1\u89c6\u5668\u8f93\u51fa\uff0c <code>SHOW ENGINE INNODB STATUS</code>\u63d0\u4f9b\u6709\u5173\u7f13\u51b2\u6c60\u64cd\u4f5c\u7684\u5ea6\u91cf\u3002</p> <p>\u7f13\u51b2\u6c60\u5ea6\u91cf\u6807\u51c6\u4f4d\u4e8e<code>BUFFER POOL AND MEMORY</code>\u201c <code>InnoDB</code>\u6807\u51c6\u76d1\u89c6\u5668\u201d\u8f93\u51fa\u4e2d\u7684\u90e8\u5206\uff0c\u5176\u8f93\u51fa\u7c7b\u4f3c\u4e8e\u4ee5\u4e0b\u5185\u5bb9\uff1a</p> <pre><code>----------------------\nBUFFER POOL AND MEMORY\n----------------------\nTotal large memory allocated 2198863872\nDictionary memory allocated 776332\nBuffer pool size   131072\nFree buffers       124908\nDatabase pages     5720\nOld database pages 2071\nModified db pages  910\nPending reads 0\nPending writes: LRU 0, flush list 0, single page 0\nPages made young 4, not young 0\n0.10 youngs/s, 0.00 non-youngs/s\nPages read 197, created 5523, written 5060\n0.00 reads/s, 190.89 creates/s, 244.94 writes/s\nBuffer pool hit rate 1000 / 1000, young-making rate 0 / 1000 not\n0 / 1000\nPages read ahead 0.00/s, evicted without access 0.00/s, Random read\nahead 0.00/s\nLRU len: 5720, unzip_LRU len: 0\nI/O sum[0]:cur[0], unzip sum[0]:cur[0]\n</code></pre> <p>\u4e0b\u8868\u63cf\u8ff0\u4e86<code>InnoDB</code>\u6807\u51c6\u76d1\u89c6\u5668\u62a5\u544a\u7684\u7f13\u51b2\u6c60\u5ea6\u91cf\u6807\u51c6</p> \u540d\u79f0 \u63cf\u8ff0 Total memory allocated \u4e3a\u7f13\u51b2\u6c60\u5206\u914d\u7684\u603b\u5185\u5b58\uff08\u4ee5\u5b57\u8282\u4e3a\u5355\u4f4d\uff09 Dictionary memory allocated \u4e3a<code>InnoDB</code>\u6570\u636e\u5b57\u5178\u5206\u914d\u7684\u603b\u5185\u5b58\uff0c\u4ee5\u5b57\u8282\u4e3a\u5355\u4f4d Buffer pool size \u5206\u914d\u7ed9\u7f13\u51b2\u6c60\u7684\u9875\u9762\u603b\u5927\u5c0f Free buffers \u7f13\u51b2\u6c60\u7a7a\u95f2\u5217\u8868\u7684\u9875\u9762\u603b\u5927\u5c0f Database pages \u7f13\u51b2\u6c60 LRU \u5217\u8868\u7684\u9875\u9762\u603b\u5927\u5c0f Old database pages \u7f13\u51b2\u6c60\u65e7 LRU \u5b50\u5217\u8868\u7684\u9875\u9762\u603b\u5927\u5c0f Modified db pages \u7f13\u51b2\u6c60\u4e2d\u5f53\u524d\u4fee\u6539\u7684\u9875\u9762\u6570 Pending reads \u7b49\u5f85\u8bfb\u5165\u7f13\u51b2\u6c60\u7684\u7f13\u51b2\u6c60\u9875\u9762\u6570 Pending writes LRU \u4ece LRU \u5217\u8868\u7684\u5e95\u90e8\u5f00\u59cb\u5199\u5165\u7684\u7f13\u51b2\u6c60\u4e2d\u7684\u65e7\u810f\u9875\u6570 Pending writes flush list \u68c0\u67e5\u70b9\u671f\u95f4\u8981\u5237\u65b0\u7684\u7f13\u51b2\u6c60\u9875\u9762\u6570 Pending writes single page \u7f13\u51b2\u6c60\u4e2d\u6682\u6302\u7684\u72ec\u7acb\u9875\u9762\u5199\u5165\u6570 Pages made young \u7f13\u51b2\u6c60 LRU \u5217\u8868\u4e2d\u53d8\u5e74\u8f7b\u7684\u9875\u9762\u603b\u6570\uff08\u5df2\u79fb\u81f3\u201c new \u201d\u9875\u9762\u7684\u5b50\u5217\u8868\u7684\u5f00\u5934\uff09 Pages made not young \u7f13\u51b2\u6c60 LRU \u5217\u8868\u4e2d\u6ca1\u6709\u5e74\u8f7b\u7684\u9875\u9762\u603b\u6570\uff08\u4fdd\u7559\u5728\u201c old \u201d\u5b50\u5217\u8868\u4e2d\u4f46\u6ca1\u6709\u5e74\u8f7b\u7684\u9875\u9762\uff09 youngs/s \u6bcf\u79d2\u5e73\u5747\u8bbf\u95ee\u7f13\u51b2\u6c60 LRU \u5217\u8868\u4e2d\u7684\u65e7\u9875\u9762\u6240\u5bfc\u81f4\u7684\u9875\u9762\u5e74\u8f7b non-youngs/s \u6bcf\u79d2\u5e73\u5747\u8bbf\u95ee\u7f13\u51b2\u6c60 LRU \u5217\u8868\u4e2d\u7684\u65e7\u9875\u9762\u5bfc\u81f4\u7684\u9875\u9762\u4e0d\u5e74\u8f7b Pages read \u4ece\u7f13\u51b2\u6c60\u8bfb\u53d6\u7684\u9875\u9762\u603b\u6570 Pages created \u5728\u7f13\u51b2\u6c60\u4e2d\u521b\u5efa\u7684\u9875\u9762\u603b\u6570 Pages written \u4ece\u7f13\u51b2\u6c60\u5199\u5165\u7684\u9875\u9762\u603b\u6570 reads/s \u6bcf\u79d2\u5e73\u5747\u6bcf\u79d2\u8bfb\u53d6\u7684\u7f13\u51b2\u6c60\u9875\u9762\u6570 creates/s \u6bcf\u79d2\u5e73\u5747\u521b\u5efa\u7684\u7f13\u51b2\u6c60\u9875\u9762\u7684\u6bcf\u79d2\u6570\u91cf writes/s \u6bcf\u79d2\u5e73\u5747\u7f13\u51b2\u6c60\u9875\u9762\u5199\u5165\u6570 Buffer pool hit rate \u4ece\u7f13\u51b2\u6c60\u5185\u5b58\u4e0e\u78c1\u76d8\u5b58\u50a8\u8bfb\u53d6\u7684\u9875\u9762\u7684\u7f13\u51b2\u6c60\u9875\u9762\u547d\u4e2d\u7387 young-making rate \u9875\u9762\u8bbf\u95ee\u7684\u5e73\u5747\u547d\u4e2d\u7387\u4f7f\u9875\u9762\u66f4\u5e74\u8f7b not (young-making rate) \u9875\u9762\u8bbf\u95ee\u672a\u4f7f\u9875\u9762\u53d8\u5e74\u8f7b\u7684\u5e73\u5747\u547d\u4e2d\u7387 Pages read ahead \u9884\u8bfb\u64cd\u4f5c\u7684\u6bcf\u79d2\u5e73\u5747\u6570 Pages evicted without access \u6bcf\u79d2\u4ece\u7f13\u51b2\u6c60\u8bbf\u95ee\u800c\u672a\u8bbf\u95ee\u7684\u9875\u9762\u7684\u5e73\u5747\u503c Random read ahead \u968f\u673a\u9884\u8bfb\u64cd\u4f5c\u7684\u6bcf\u79d2\u5e73\u5747\u6570 LRU len \u7f13\u51b2\u6c60 LRU \u5217\u8868\u7684\u9875\u9762\u603b\u5927\u5c0f unzip_LRU len \u7f13\u51b2\u6c60 unzip_LRU \u5217\u8868\u7684\u9875\u9762\u603b\u5927\u5c0f I/O sum \u6700\u8fd1 50 \u79d2\u5185\u8bbf\u95ee\u7684\u7f13\u51b2\u6c60 LRU \u5217\u8868\u9875\u9762\u7684\u603b\u6570 I/O cur \u5df2\u8bbf\u95ee\u7684\u7f13\u51b2\u6c60 LRU \u5217\u8868\u9875\u9762\u7684\u603b\u6570 I/O unzip sum \u5df2\u8bbf\u95ee\u7684\u7f13\u51b2\u6c60 unzip_LRU \u5217\u8868\u9875\u9762\u7684\u603b\u6570 I/O unzip cur \u5df2\u8bbf\u95ee\u7684\u7f13\u51b2\u6c60 unzip_LRU \u5217\u8868\u9875\u9762\u7684\u603b\u6570"},{"location":"advanced/4.InnoDB%E5%86%85%E5%AD%98%E7%BB%93%E6%9E%84%E2%80%94%E2%80%94%E7%BC%93%E5%86%B2%E6%B1%A0/#_5","title":"\u7f13\u51b2\u6c60\u9884\u70ed","text":"<p>https://dev.mysql.com/doc/refman/8.0/en/innodb-preload-buffer-pool.html</p> <p>\u5728\u751f\u4ea7\u4e2d\uff0c\u91cd\u542f MySQL \u540e\uff0c\u4f1a\u53d1\u73b0\u4e00\u6bb5\u65f6\u95f4\u5185 SQL \u6027\u80fd\u53d8\u5dee\uff0c\u7136\u540e\u6700\u7ec8\u6062\u590d\u5230\u539f\u6709\u6027\u80fd\u3002</p> <p>MySQL \u8fdb\u7a0b\u91cd\u542f\u540e\uff0c\u5b83\u5728\u5185\u5b58\u4e2d\u7684\u6570\u636e\u81ea\u7136\u5c31\u91ca\u653e\u4e86\u3002\u901a\u8fc7\u4e1a\u52a1\u7684\u8bbf\u95ee\u624d\u4f1a\u9010\u6b65\u5c06\u70ed\u70b9\u6570\u636e\u4ece\u78c1\u76d8\u7f13\u5b58\u5230 InnoDB Buffer Pool \u4e2d\uff0c\u4ece\u78c1\u76d8\u8bfb\u53d6\u6570\u636e\u81ea\u7136\u6ca1\u6709\u4ece\u5185\u5b58\u8bfb\u53d6\u6570\u636e\u5feb\u3002\u968f\u7740\u4e1a\u52a1\u7684\u8bbf\u95ee\uff0cMySQL \u4f1a\u9010\u6b65\u7ecf\u5e38\u64cd\u4f5c\u7684\u70ed\u70b9\u6570\u636e\u90fd\u5df2\u7ecf\u7f13\u5b58\u5230 InnoDB Buffer Pool \u7f13\u51b2\u6c60\u4e2d\u3002\u6700\u540e\u8d8b\u4e8e\u539f\u6709\u60c5\u51b5\u3002</p> <p>MySQL \u91cd\u542f\u540e\uff0c\u5c06\u70ed\u70b9\u6570\u636e\u4ece\u78c1\u76d8\u9010\u6e10\u7f13\u5b58\u5230 <code>InnoDB Buffer Pool</code> \u7684\u8fc7\u7a0b\u79f0\u4e3a\u9884\u70ed\uff08\u5b98\u65b9\u6587\u6863\u79f0\u4e4b\u4e3a warmup\uff09\u3002</p> <p>\u8ba9\u5e94\u7528\u7cfb\u7edf\u81ea\u8eab\u6162\u6162\u901a\u8fc7 SQL \u7ed9<code>InnoDB Buffer Pool</code>\u9884\u70ed\u6210\u672c\u5f88\u9ad8\uff0c\u5982\u679c\u9047\u5230\u9ad8\u5cf0\u671f\u6781\u6709\u53ef\u80fd\u5e26\u6765\u4e00\u573a\u6027\u80fd\u707e\u96be\uff0c\u5bfc\u81f4\u4e1a\u52a1\u5361\u987f\u4e0d\u80fd\u987a\u5229\u8fd0\u8425\u3002</p> <p>\u4e3a\u4e86\u907f\u514d\u8fd9\u79cd\u60c5\u51b5\u53d1\u751f\uff0cMySQL 5.6 \u5f15\u5165\u4e86\u6570\u636e\u9884\u70ed\u673a\u5236\uff0c\u5728\u505c\u6b62\u6570\u636e\u5e93\u7684\u65f6\u5019\uff0c\u628a\u5185\u5b58\u4e2d\u7684\u70ed\u70b9\u6570\u636e dump \u5230\u78c1\u76d8\u6587\u4ef6\u4e2d\uff0c\u542f\u52a8\u65f6\uff0c\u76f4\u63a5\u628a\u70ed\u70b9\u6570\u636e\u4ece\u78c1\u76d8\u52a0\u8f7d\u56de\u5185\u5b58\u4e2d\u3002</p> <p>\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u5bf9\u4e8e\u8f83\u5927\u5185\u5b58\u7684\u6570\u636e\u5e93\u6765\u8bf4\uff0c\u914d\u7f6e\u8fd9\u79cd\u9884\u70ed\u673a\u5236\uff0c\u4f1a\u8ba9\u5173\u95ed\u6570\u636e\u5e93\u7684\u65f6\u95f4\u975e\u5e38\u957f\u3002\u540c\u6837\u542f\u52a8\u8fc7\u7a0b\u4e5f\u4f1a\u5ef6\u957f\u3002</p> <pre><code># \u5173\u95ed\u6570\u636e\u5e93\u65f6\u662f\u5426\u4fdd\u7559\u5f53\u524d\u7684\u7f13\u51b2\u6c60\u7684\u72b6\u6001\u5230\u78c1\u76d8\u4e2d\uff0cMySQL5.7\u4e4b\u540e\u9ed8\u8ba4\u5f00\u542f\ninnodb_buffer_pool_dump_at_shutdown=on\n\n# \u4fdd\u7559\u5185\u5b58\u7f13\u51b2\u6c60\u4e2d\u6570\u636e\u7684\u6bd4\u4f8b\uff0c\u9ed8\u8ba4\u662f25%\ninnodb_buffer_pool_dump_pct=25\n\n# \u7f13\u51b2\u6c60\u6570\u636edump\u5230\u78c1\u76d8\u4e2d\u7684\u6587\u4ef6\u540d\u79f0\uff0c\u9ed8\u8ba4\u662fib_buffer_pool\uff0c\u4e00\u822c\u653e\u5728\u78c1\u76d8\u7684datadir/ib_buffer_pool\u4e2d\ninnodb_buffer_pool_filename=ib_buffer_pool\n\n# \u9884\u70ed\u5f00\u5173\uff1a\u542f\u52a8\u65f6\u81ea\u52a8\u4ece\u78c1\u76d8\u6587\u4ef6\u8bfb\u53d6\u70ed\u70b9\u6570\u636e\u5230\u5185\u5b58\u7684innodb_buffer_pool\u4e2d\ninnodb_buffer_pool_load_at_startup=on\n</code></pre>"},{"location":"advanced/4.InnoDB%E5%86%85%E5%AD%98%E7%BB%93%E6%9E%84%E2%80%94%E2%80%94%E7%BC%93%E5%86%B2%E6%B1%A0/#mysql","title":"MySQL \u7ebf\u7a0b","text":""},{"location":"advanced/4.InnoDB%E5%86%85%E5%AD%98%E7%BB%93%E6%9E%84%E2%80%94%E2%80%94%E7%BC%93%E5%86%B2%E6%B1%A0/#_6","title":"\u5237\u810f","text":"<p>\u810f\u9875</p> <p>\u5f53\u4fee\u6539\u6570\u636e\u7684\u4e8b\u52a1\u63d0\u4ea4\u540e\uff0c\u6570\u636e\u5237\u5230\u78c1\u76d8\u4e4b\u524d\uff0c\u6b64\u65f6\u5185\u5b58\u4e2d\u7684\u6570\u636e\u9875\u548c\u78c1\u76d8\u4e2d\u7684\u6570\u636e\u662f\u4e0d\u4e00\u81f4\u7684\uff0c\u6211\u4eec\u628a\u6b64\u65f6\u5185\u5b58\u4e2d\u7684\u8fd9\u4e9b\u6570\u636e\u9875\u6210\u4e3a\u810f\u9875\u3002</p> <p>\u5237\u810f</p> <p>\u5237\u810f\uff0c\u5373\u628a buffer pool \u4e2d\u7684\u5185\u5b58\u810f\u9875\u6570\u636e\u5237\u56de\u78c1\u76d8\u843d\u5730\u3002</p> <p>InnoDB \u4f1a\u5728\u540e\u53f0\u6267\u884c\u67d0\u4e9b\u4efb\u52a1\uff0c\u5305\u62ec\u4ece\u7f13\u51b2\u6c60\u5237\u65b0\u810f\u9875\uff08\u90a3\u4e9b\u5df2\u66f4\u6539\u4f46\u5c1a\u672a\u5199\u5165\u6570\u636e\u5e93\u6587\u4ef6\u7684\u9875\uff09\u3002</p> <p>InnoDB \u5f53\u7f13\u51b2\u6c60\u4e2d\u810f\u9875\u7684\u767e\u5206\u6bd4\u8fbe\u5230\u5b9a\u4e49\u7684\u4f4e\u6c34\u4f4d\u8bbe\u7f6e\u65f6\uff0c\u5176\u5b9e\u5c31\u662f\u5f53\u7f13\u51b2\u6c60\u4e2d\u7684\u810f\u9875\u5360\u7528\u6bd4\u8fbe\u5230<code>innodb_max_dirty_pages_pct_lwm</code>\u7684\u8bbe\u5b9a\u503c\u7684\u65f6\u5019\uff0c\u5c31\u4f1a\u81ea\u52a8\u5c06\u810f\u9875\u6e05\u51fa buffer pool\uff0c\u8fd9\u662f\u4e3a\u4e86\u4fdd\u8bc1<code>buffer pool</code>\u5f53\u4e2d\u810f\u9875\u7684\u5360\u6709\u7387\uff0c\u4e5f\u662f\u4e3a\u4e86\u9632\u6b62\u810f\u9875\u5360\u6709\u7387\u8d85\u8fc7<code>innodb_max_dirty_pages_pct</code>\u7684\u8bbe\u5b9a\u503c\uff0c\u5f53\u810f\u9875\u7684\u5360\u6709\u7387\u8fbe\u5230\u4e86 innodb_max_dirty_pages_pct \u7684\u8bbe\u5b9a\u503c\u7684\u65f6\u5019\uff0cInnoDB \u5c31\u4f1a\u5f3a\u5236\u5237\u65b0 buffer pool pages\u3002</p> <p>InnoDB \u91c7\u7528\u4e00\u79cd\u57fa\u4e8e redo log \u7684\u6700\u8fd1\u751f\u6210\u91cf\u548c\u6700\u8fd1\u5237\u65b0\u9891\u7387\u7684\u7b97\u6cd5\u6765\u51b3\u5b9a\u51b2\u6d17\u901f\u5ea6\uff0c\u8fd9\u6837\u7684\u7b97\u6cd5\u53ef\u4ee5\u4fdd\u8bc1\u6570\u636e\u5e93\u7684\u51b2\u6d17\u4e0d\u4f1a\u5f71\u54cd\u5230\u6570\u636e\u5e93\u7684\u6027\u80fd\uff0c\u4e5f\u80fd\u4fdd\u8bc1\u6570\u636e\u5e93 buffer pool \u4e2d\u7684\u6570\u636e\u7684\u810f\u6570\u636e\u7684\u5360\u7528\u6bd4\u3002\u8fd9\u79cd\u81ea\u52a8\u8c03\u6574\u5237\u65b0\u901f\u7387\u6709\u52a9\u4e8e\u907f\u514d\u8fc7\u591a\u7684\u7f13\u51b2\u6c60\u5237\u65b0\u9650\u5236\u4e86\u666e\u901a\u8bfb\u5199\u8bf7\u6c42\u53ef\u7528\u7684 I/O \u5bb9\u91cf\uff0c\u4ece\u800c\u907f\u514d\u541e\u5410\u91cf\u7a81\u7136\u4e0b\u964d\uff0c\u4f46\u8fd8\u662f\u5bf9\u6b63\u5e38 IO \u6709\u5f71\u54cd\u3002</p>"},{"location":"advanced/4.InnoDB%E5%86%85%E5%AD%98%E7%BB%93%E6%9E%84%E2%80%94%E2%80%94%E7%BC%93%E5%86%B2%E6%B1%A0/#_7","title":"\u591a\u7ebf\u7a0b\u5237\u810f","text":"<ul> <li> <p>5.6 \u7248\u672c\u4ee5\u524d\uff0c\u810f\u9875\u7684\u6e05\u7406\u5de5\u4f5c\u4ea4\u7531 master thread \u7684;</p> </li> <li> <p>Page cleaner thread \u662f 5.6.2 \u5f15\u5165\u7684\u4e00\u4e2a\u65b0\u7ebf\u7a0b\uff08\u5355\u7ebf\u7a0b\uff09\uff0c\u4ece master \u7ebf\u7a0b\u4e2d\u5378\u4e0b buffer pool \u5237\u810f\u9875\u7684\u5de5\u4f5c\u72ec\u7acb\u51fa\u6765\u7684\u7ebf\u7a0b(\u9ed8\u8ba4\u662f\u542f\u4e00\u4e2a\u7ebf\u7a0b)\uff1b</p> </li> <li> <p>5.7 \u5f00\u59cb\u652f\u6301\u591a\u7ebf\u7a0b\u5237\u810f\u9875\uff0c\u7ebf\u7a0b\u6570\u91cf\u901a\u8fc7<code>innodb_page_cleaners</code>\u53c2\u6570\u63a7\u5236\uff0c\u9ed8\u8ba4\u662f<code>4</code>\u4e2a\uff0c\u5982\u679c\u6570\u91cf\u8d85\u8fc7 buffer pool instance\uff0c\u90a3\u4e48\u4f1a\u964d\u7ea7\u6210\u8ddf\u5b83\u4e00\u81f4\u3002</p> </li> </ul> <p>\u5237\u810f\u4e3b\u8981\u5206\u4ee5\u4e0b\u51e0\u79cd\u573a\u666f\uff1a</p> <p>1\u3001\u6570\u636e\u5e93\u5173\u95ed\uff0c</p>"},{"location":"advanced/4.InnoDB%E5%86%85%E5%AD%98%E7%BB%93%E6%9E%84%E2%80%94%E2%80%94%E7%BC%93%E5%86%B2%E6%B1%A0/#_8","title":"\u4e24\u9636\u6bb5\u63d0\u4ea4","text":"<p>\u5185\u90e8 XA \u4e8b\u52a1\u4e3b\u8981\u6307\u5355\u8282\u70b9\u5b9e\u4f8b\u5185\u90e8\uff0c\u4e00\u4e2a\u4e8b\u52a1\u8de8\u591a\u4e2a\u5b58\u50a8\u5f15\u64ce\u8fdb\u884c\u8bfb\u5199\uff0c\u90a3\u4e48\u5c31\u4f1a\u4ea7\u751f\u5185\u90e8 XA \u4e8b\u52a1\uff1b\u8fd9\u91cc\u9700\u8981\u6307\u51fa\u7684\u662f\uff0cMySQL \u5185\u90e8\u6bcf\u4e2a\u4e8b\u52a1\u90fd\u9700\u8981\u5199 binlog\uff0c\u5e76\u4e14\u9700\u8981\u4fdd\u8bc1 binlog \u4e0e\u5f15\u64ce\u4fee\u6539\u7684\u4e00\u81f4\u6027\uff0c\u56e0\u6b64 binlog \u662f\u4e00\u4e2a\u7279\u6b8a\u7684\u53c2\u4e0e\u8005\uff0c\u6240\u4ee5\u5728\u6253\u5f00 binlog \u7684\u60c5\u51b5\u4e0b\uff0c\u5373\u4f7f\u4e8b\u52a1\u4fee\u6539\u53ea\u6d89\u53ca\u4e00\u4e2a\u5f15\u64ce\uff0c\u5185\u90e8\u4e5f\u4f1a\u542f\u52a8 XA \u4e8b\u52a1\u3002</p> <p>\u5916\u90e8 XA \u4e8b\u52a1\u4e0e\u5185\u90e8 XA \u4e8b\u52a1\u6838\u5fc3\u903b\u8f91\u7c7b\u4f3c\uff0c\u63d0\u4f9b\u7ed9\u7528\u6237\u4e00\u5957 XA \u4e8b\u52a1\u7684\u64cd\u4f5c\u547d\u4ee4\uff0c\u5305\u62ec XA start\uff0c XA end\uff0cXA prepre \u548c XA commit \u7b49\uff0c\u53ef\u4ee5\u652f\u6301\u8de8\u591a\u4e2a\u8282\u70b9\u7684 XA \u4e8b\u52a1\u3002\u5916\u90e8 XA \u7684\u534f\u8c03\u8005\u662f\u7528\u6237\u7684\u5e94\u7528\uff0c\u53c2\u4e0e\u8005\u662f MySQL \u8282\u70b9\uff0c\u56e0\u6b64\u9700\u8981\u5e94\u7528\u6301\u4e45\u5316\u534f\u8c03\u4fe1\u606f\uff0c\u89e3\u51b3\u4e8b\u52a1\u4e00\u81f4\u6027\u95ee\u9898\u3002\u65e0\u8bba\u5916\u90e8 XA \u4e8b\u52a1\u8fd8\u662f\u5185\u90e8 XA \u4e8b\u52a1\uff0c\u5b58\u50a8\u5f15\u64ce\u5b9e\u73b0\u7684 prepare \u548c commit \u63a5\u53e3\u90fd\u662f\u540c\u4e00\u6761\u8def\u5f84\u3002</p> <p>\u5bf9\u4e8e\u7528\u6237\u4e8b\u52a1\uff0c\u662f\u5426\u4f7f\u7528\u4e8c\u9636\u6bb5\u63d0\u4ea4\uff0c\u53d6\u51b3\u4e8e\u662f\u5426\u5f00\u542f\u4e86 binlog\u3002</p> <p>\u56e0\u4e3a MySQL \u628a binlog \u4e5f\u770b\u4f5c\u4e00\u4e2a\u5b58\u50a8\u5f15\u64ce\uff0c\u5f00\u542f binlog\uff0cSQL \u8bed\u53e5\u6539\u53d8\uff08\u63d2\u5165\u3001\u66f4\u65b0\u3001\u5220\u9664\uff09InnoDB \u8868\u7684\u6570\u636e\uff0c\u8fd9\u4e2a SQL \u8bed\u53e5\u6267\u884c\u8fc7\u7a0b\u4e2d\uff0c\u5c31\u6d89\u53ca\u5230\u4e24\u4e2a\u5b58\u50a8\u5f15\u64ce\u3002</p> <p>\u5728 MySQL \u4e2d\uff0c\u4e24\u9636\u6bb5\u63d0\u4ea4\u6709\u51e0\u4e2a\u6700\u91cd\u8981\u7684\u6587\u4ef6\uff1a</p>"},{"location":"advanced/4.InnoDB%E5%86%85%E5%AD%98%E7%BB%93%E6%9E%84%E2%80%94%E2%80%94%E7%BC%93%E5%86%B2%E6%B1%A0/#redo-log","title":"\u91cd\u505a\u65e5\u5fd7 redo log","text":"<p>\u91cd\u505a\u65e5\u5fd7\uff0c\u53c8\u53eb\u4e8b\u52a1\u65e5\u5fd7\uff0c\u662f InnoDB \u5b58\u50a8\u5f15\u64ce\u5c42\u7684\u65e5\u5fd7\u3002\u4e00\u822c\u4e5f\u53eb**\u7269\u7406\u65e5\u5fd7**</p> <p>\u5728 MySQL \u91cc\uff0c\u5982\u679c\u6bcf\u4e00\u6b21\u7684\u66f4\u65b0\u64cd\u4f5c\u90fd\u9700\u8981\u5199\u8fdb\u78c1\u76d8\u6301\u4e45\u5316\uff0c\u7136\u540e\u78c1\u76d8\u4e5f\u8981\u627e\u5230\u5bf9\u5e94\u7684\u90a3\u6761\u8bb0\u5f55\uff0c\u7136\u540e\u518d\u66f4\u65b0\uff0c\u6574\u4e2a\u8fc7\u7a0b IO \u6210\u672c\u3001\u67e5\u627e\u6210\u672c\u90fd\u5f88\u9ad8\u3002</p> <p>\u5f53\u7f13\u51b2\u6c60\u4e2d\u7684\u67d0\u9875\u6570\u636e\u88ab\u4fee\u6539\u540e\uff0c\u8be5\u9875\u5c31\u88ab\u6807\u8bb0\u4e3a \u201d\u810f\u9875\u201c\uff0c\u810f\u9875\u7684\u6570\u636e\u4f1a\u88ab\u5b9a\u671f\u5237\u65b0\u5230\u78c1\u76d8\u4e0a\u3002</p> <p>\u5018\u82e5\u6bcf\u6b21\u4e00\u4e2a\u9875\u53d1\u751f\u53d8\u5316\uff0c\u5c31\u5c06\u65b0\u9875\u7684\u7248\u672c\u5237\u65b0\u5230\u78c1\u76d8\uff0c\u90a3\u4e48\u8fd9\u4e2a\u5f00\u9500\u662f\u975e\u5e38\u5927\u7684\u3002\u5e76\u4e14\uff0c\u5982\u679c\u70ed\u70b9\u6570\u636e\u90fd\u96c6\u4e2d\u5728\u67d0\u51e0\u4e2a\u9875\u4e2d\uff0c\u90a3\u4e48\u6570\u636e\u5e93\u7684\u6027\u80fd\u5c06\u53d8\u5f97\u975e\u5e38\u5dee\u3002\u53e6\u5916\uff0c\u5982\u679c\u5728\u4ece\u7f13\u51b2\u6c60\u5c06\u9875\u7684\u65b0\u7248\u672c\u5237\u65b0\u5230\u78c1\u76d8\u65f6\u53d1\u751f\u4e86\u5b95\u673a\uff0c\u90a3\u4e48\u8fd9\u4e2a\u6570\u636e\u5c31\u4e0d\u80fd\u6062\u590d\u4e86\u3002</p> <p>\u6240\u4ee5\uff0c\u4e3a\u4e86\u907f\u514d\u53d1\u751f\u6570\u636e\u4e22\u5931\u7684\u95ee\u9898\uff0c\u5f53\u524d\u4e8b\u52a1\u6570\u636e\u5e93\u7cfb\u7edf\uff08\u5e76\u975e MySQL \u6240\u72ec\u6709\uff09\u666e\u904d\u90fd\u91c7\u7528\u4e86 WAL\uff08Write Ahead Log\uff0c\u9884\u5199\u65e5\u5fd7\uff09\u7b56\u7565\uff1a\u5373\u5f53\u4e8b\u52a1\u63d0\u4ea4\u65f6\uff0c\u5148\u5199\u91cd\u505a\u65e5\u5fd7\uff08redo log\uff09\uff0c\u518d\u4fee\u6539\u9875\uff08\u5148\u4fee\u6539\u7f13\u51b2\u6c60\uff0c\u518d\u5237\u65b0\u5230\u78c1\u76d8\uff09\uff1b\u5f53\u7531\u4e8e\u53d1\u751f\u5b95\u673a\u800c\u5bfc\u81f4\u6570\u636e\u4e22\u5931\u65f6\uff0c\u901a\u8fc7 redo log \u6765\u5b8c\u6210\u6570\u636e\u7684\u6062\u590d\u3002\u8fd9\u4e5f\u662f\u4e8b\u52a1 ACID \u4e2d D\uff08Durability \u6301\u4e45\u6027\uff09\u7684\u8981\u6c42\u3002</p> <p>\u6709\u4e86 redo log\uff0cInnoDB \u5c31\u53ef\u4ee5\u4fdd\u8bc1\u5373\u4f7f\u6570\u636e\u5e93\u53d1\u751f\u5f02\u5e38\u91cd\u542f\uff0c\u4e4b\u524d\u63d0\u4ea4\u7684\u8bb0\u5f55\u90fd\u4e0d\u4f1a\u4e22\u5931\uff0c\u8fd9\u4e2a\u80fd\u529b\u79f0\u4e3a crash-safe\u3002</p> <p>\u4e3e\u4e2a\u7b80\u5355\u7684\u4f8b\u5b50\uff0c\u5047\u8bbe\u4f60\u975e\u5e38\u70ed\u5fc3\u4e14 rich \u7684\uff0c\u501f\u51fa\u53bb\u4e86\u5f88\u591a\u94b1\uff0c\u4f46\u662f\u4f60\u975e\u5e38 old school\uff0c\u4e0d\u4f1a\u4f7f\u7528\u7535\u5b50\u8bbe\u5907\u5e76\u4e14\u8bb0\u6027\u4e0d\u592a\u597d\uff0c\u6240\u4ee5\u4f60\u7528\u4e00\u4e2a\u5c0f\u672c\u672c\u8bb0\u4e0b\u4e86\u6240\u6709\u6b20\u4f60\u94b1\u7684\u4eba\u7684\u540d\u5b57\u548c\u5177\u4f53\u91d1\u989d\u3002\u8fd9\u6837\uff0c\u522b\u4eba\u8fd8\u4f60\u94b1\u7684\u65f6\u5019\uff0c\u4f60\u5c31\u7ffb\u51fa\u4f60\u7684\u5c0f\u672c\u672c\uff0c\u4e00\u9875\u9875\u5730\u627e\u5230\u4ed6\u7684\u540d\u5b57\u7136\u540e\u628a\u8fd9\u6b21\u8fd8\u7684\u94b1\u6263\u9664\u6389\u3002</p> <p>\u4f46\u662f\u5462\uff0c\u5176\u5b9e\u4f60\u5e73\u5e38\u662f\u975e\u5e38\u5fd9\u788c\u7684\uff0c\u6ca1\u529e\u6cd5\u968f\u65f6\u968f\u5730\u7ffb\u5c0f\u672c\u672c\u505a\u8bb0\u5f55\uff0c\u56e0\u6b64\u4f60\u5c31\u60f3\u51fa\u4e86\u4e00\u4e2a\u4e3b\u610f\uff1a\u6bcf\u5f53\u6709\u4eba\u8fd8\u4f60\u94b1\u7684\u65f6\u5019\uff0c\u4f60\u5c31\u5728\u4e00\u5f20\u767d\u7eb8\u4e0a\u8bb0\u4e0b\u6765\uff0c\u7136\u540e\u6311\u4e2a\u65f6\u95f4\u5bf9\u7167\u5c0f\u672c\u672c\u628a\u767d\u7eb8\u4e0a\u7684\u8d26\u76ee\u90fd\u7ed9\u6e05\u4e86\u3002</p> <p>\u8fd9\u5c31\u662f WAL\u3002\u767d\u7eb8\u5c31\u662f redo log\uff0c\u5c0f\u672c\u672c\u5c31\u662f\u78c1\u76d8\u3002</p> <p>\u6240\u4ee5\u6709\u4e00\u79cd\u6280\u672f\u53eb WAL \uff0c\u5168\u79f0\u662f Write-Ahead Logging\uff0c\u5b83\u7684\u5173\u952e\u70b9\u5c31\u662f\u5148\u5199\u65e5\u5fd7\uff0c\u518d\u5199\u78c1\u76d8\u3002\uff08\u65e5\u5fd7\u5148\u884c\uff09</p> <p>PostgreSQL \u6587\u6863\u4e2d\u6709\u8fd9\u4e48\u4e00\u53e5\u8bdd Write-Ahead Logging (WAL) is a standard method for ensuring data integrity</p> <p>\u901a\u8fc7\u65e5\u5fd7\u5b9e\u73b0\u4e8b\u52a1\u7684\u539f\u5b50\u6027\u548c\u6301\u4e45\u6027\u662f\u5f53\u4eca\u7684\u4e3b\u6d41\u65b9\u6848\u3002</p> <p>\u5728\u78c1\u76d8\u4e2d\u5199\u5165\u6570\u636e\u5c31\u4e0d\u80fd\u50cf\u7a0b\u5e8f\u4fee\u6539\u5185\u5b58\u4e2d\u53d8\u91cf\u503c\u90a3\u6837\uff0c\u76f4\u63a5\u6539\u53d8\u67d0\u8868\u67d0\u884c\u67d0\u5217\u7684\u67d0\u4e2a\u503c\uff0c\u800c\u662f\u5fc5\u987b\u5c06\u4fee\u6539\u6570\u636e\u8fd9\u4e2a\u64cd\u4f5c\u6240\u9700\u7684\u5168\u90e8\u4fe1\u606f\uff0c\u5305\u62ec\u4fee\u6539\u4ec0\u4e48\u6570\u636e\u3001\u6570\u636e\u7269\u7406\u4e0a\u4f4d\u4e8e\u54ea\u4e2a\u5185\u5b58\u9875\u548c\u78c1\u76d8\u5757\u4e2d\u3001\u4ece\u4ec0\u4e48\u503c\u6539\u6210\u4ec0\u4e48\u503c\uff0c\u7b49\u7b49\uff0c\u4ee5\u65e5\u5fd7\u7684\u5f62\u5f0f\u2014\u2014\u5373\u4ec5\u8fdb\u884c\u987a\u5e8f\u8ffd\u52a0\u7684\u6587\u4ef6\u5199\u5165\u7684\u5f62\u5f0f\uff08\u8fd9\u662f\u6700\u9ad8\u6548\u7684\u5199\u5165\u65b9\u5f0f\uff09\u5148\u8bb0\u5f55\u5230\u78c1\u76d8\u4e2d\u3002\u53ea\u6709\u5728\u65e5\u5fd7\u8bb0\u5f55\u5168\u90e8\u90fd\u5b89\u5168\u843d\u76d8\uff0c\u6570\u636e\u5e93\u5728\u65e5\u5fd7\u4e2d\u770b\u5230\u4ee3\u8868\u4e8b\u52a1\u6210\u529f\u63d0\u4ea4\u7684\u201c\u63d0\u4ea4\u8bb0\u5f55\u201d\uff08Commit Record\uff09\u540e\uff0c\u624d\u4f1a\u6839\u636e\u65e5\u5fd7\u4e0a\u7684\u4fe1\u606f\u5bf9\u771f\u6b63\u7684\u6570\u636e\u8fdb\u884c\u4fee\u6539\uff0c\u4fee\u6539\u5b8c\u6210\u540e\uff0c\u518d\u5728\u65e5\u5fd7\u4e2d\u52a0\u5165\u4e00\u6761\u201c\u7ed3\u675f\u8bb0\u5f55\u201d\uff08End Record\uff09\u8868\u793a\u4e8b\u52a1\u5df2\u5b8c\u6210\u6301\u4e45\u5316\uff0c\u8fd9\u79cd\u4e8b\u52a1\u5b9e\u73b0\u65b9\u6cd5\u88ab\u79f0\u4e3a\u201cCommit Logging\u201d\uff08\u63d0\u4ea4\u65e5\u5fd7\uff09\u3002</p> <p>WAL \u7684\u6838\u5fc3\u6982\u5ff5\u662f\u6570\u636e\u6587\u4ef6\uff08\u8868\u548c\u7d22\u5f15\u6240\u5728\u7684\u4f4d\u7f6e\uff09\u7684\u66f4\u6539\u5fc5\u987b\u4ec5\u5728\u8bb0\u5f55\u8fd9\u4e9b\u66f4\u6539\u4e4b\u540e\u5199\u5165\uff0c\u5373\u5728\u63cf\u8ff0\u66f4\u6539\u7684\u65e5\u5fd7\u8bb0\u5f55\u5df2\u5237\u65b0\u5230\u6c38\u4e45\u5b58\u50a8\u4e4b\u540e\u3002</p> <p>\u5982\u679c\u6211\u4eec\u9075\u5faa\u8fd9\u4e2a\u8fc7\u7a0b\uff0c\u6211\u4eec\u4e0d\u9700\u8981\u5728\u6bcf\u6b21\u4e8b\u52a1\u63d0\u4ea4\u65f6\u5c06\u6570\u636e\u9875\u771f\u6b63\u5237\u65b0\u5230\u78c1\u76d8\uff0c\u56e0\u4e3a\u6211\u4eec\u77e5\u9053\u5728\u53d1\u751f\u5d29\u6e83\u65f6\u6211\u4eec\u5c06\u80fd\u591f\u4f7f\u7528\u65e5\u5fd7\u6062\u590d\u6570\u636e\u5e93;</p> <p>\u4efb\u4f55\u5c1a\u672a\u5e94\u7528\u7684\u66f4\u6539\u53ef\u4ee5\u4ece\u65e5\u5fd7\u8bb0\u5f55\u4e2d\u91cd\u505a\u6570\u636e\u9875\u3002\uff08\u8fd9\u662f\u524d\u6eda\u6062\u590d\uff0c\u4e5f\u79f0\u4e3a redo\uff09</p> <p>\u5177\u4f53\u6765\u8bf4\uff0c\u5f53\u6709\u4e00\u6761\u8bb0\u5f55\u9700\u8981\u66f4\u65b0\u7684\u65f6\u5019\uff0cInnoDB \u5f15\u64ce\u5c31\u4f1a\u5148\u628a\u8bb0\u5f55\u5199\u5230 redo log \uff08\u78c1\u76d8\u4e2d\u7684\u7269\u7406\u6587\u4ef6\uff09\u91cc\u9762\uff0c\u5e76\u66f4\u65b0\u5185\u5b58\uff0c\u8fd9\u4e2a\u65f6\u5019\u66f4\u65b0\u5c31\u51e0\u4e4e\u7b97\u5b8c\u6210\u4e86\u3002</p> <p>\uff08\u540e\u9762\u4f1a\u8bb2\uff0c\u8fd9\u65f6\u4e25\u683c\u8bf4\u8fd8\u4e0d\u7b97\u4e8b\u52a1 commit \u6210\u529f\uff0c\u5ba2\u6237\u7aef\u8fd8\u770b\u4e0d\u5230\u8fd4\u56de\u6210\u529f\uff09</p> <p>\u7531\u4e8e redo-log \u662f\u987a\u5e8f\u5199\u7684\uff0c\u6240\u4ee5\u901f\u5ea6\u6bd4\u8f83\u5feb\u3002redo-log \u662f\u7269\u7406\u65e5\u5fd7\uff0c\u8bb0\u5f55\u7684\u662f \u201c\u5728\u67d0\u4e2a\u6570\u636e\u9875\u4e0a\u505a\u4e86\u4ec0\u4e48\u4fee\u6539\u201d\u3002</p> <p>redo-log \u662f\u5faa\u73af\u5199\u7684\uff0c\u5f53 redo-log \u5199\u5b8c\u540e\uff0c\u5c31\u8981\u5237\u76d8\u3002\u628a\u6570\u636e\u5237\u5230\u78c1\u76d8\u4e2d\u3002\uff08\u66f4\u4e25\u683c\u5730\u8bf4\uff0c\u4f55\u65f6\u5237\u76d8\u5e94\u8be5\u8fd8\u662f\u6709\u53c2\u6570\u63a7\u5236\u7684\u3002\uff09</p> <p>\u7531\u4e8e\u5185\u5b58\u7f13\u51b2\u7684\u5b58\u5728\uff0c\u5bf9\u6570\u636e\u7684\u589e\u5220\u6539\u90fd\u5148\u4fee\u6539\u5185\u5b58\u4e2d\u7684\u6570\u636e\u9875\uff0c\u518d\u5b9a\u671f flush \u843d\u76d8\u6301\u4e45\u5316\u3002</p> <p>\u5728\u6bcf\u6b21\u4e8b\u52a1\u63d0\u4ea4\u7684\u65f6\u5019\uff0c\u5c06\u8be5\u4e8b\u52a1\u6d89\u53ca\u4fee\u6539\u7684\u6570\u636e\u9875\u5168\u90e8\u5237\u56de\u5230\u78c1\u76d8\u4e2d\u3002\u4f46\u662f\u8fd9\u4e48\u505a\u4f1a\u6709\u4e25\u91cd\u7684\u6027\u80fd\u95ee\u9898\uff0c\u4e3b\u8981\u4f53\u73b0\u5728\u4e24\u4e2a\u65b9\u9762\uff1a</p> <ul> <li>\u56e0\u4e3a Innodb \u662f\u4ee5\u9875\u4e3a\u5355\u4f4d\u8fdb\u884c\u78c1\u76d8\u4ea4\u4e92\u7684\uff0c\u800c\u4e00\u4e2a\u4e8b\u52a1\u5f88\u53ef\u80fd\u53ea\u4fee\u6539\u4e00\u4e2a\u6570\u636e\u9875\u91cc\u9762\u7684\u51e0\u4e2a\u5b57\u8282\uff0c\u8fd9\u4e2a\u65f6\u5019\u5c06\u5b8c\u6574\u7684\u6570\u636e\u9875\u5237\u5230\u78c1\u76d8\u7684\u8bdd\uff0c\u592a\u6d6a\u8d39\u8d44\u6e90\u4e86\u3002</li> <li>\u4e00\u4e2a\u4e8b\u52a1\u53ef\u80fd\u6d89\u53ca\u4fee\u6539\u591a\u4e2a\u6570\u636e\u9875\uff0c\u5e76\u4e14\u8fd9\u4e9b\u6570\u636e\u9875\u5728\u7269\u7406\u4e0a\u5e76\u4e0d\u8fde\u7eed\uff0c\u4f7f\u7528\u968f\u673a IO \u5199\u5165\u6027\u80fd\u592a\u5dee\u3002</li> </ul> <p>\u56e0\u6b64 MySQL \u8bbe\u8ba1\u4e86 <code>redo log</code> \u3002\u5177\u4f53\u6765\u8bf4\u5c31\u662f\u53ea\u8bb0\u5f55\u4e8b\u52a1\u5bf9\u6570\u636e\u9875\u505a\u4e86\u54ea\u4e9b\u4fee\u6539\uff0c\u8fd9\u6837\u5c31\u80fd\u5b8c\u7f8e\u5730\u89e3\u51b3\u6027\u80fd\u95ee\u9898\u4e86(\u76f8\u5bf9\u800c\u8a00\u6587\u4ef6\u66f4\u5c0f\uff0c\u5e76\u4e14\u662f\u987a\u5e8f IO)\u3002</p> <p>redo log \u5305\u62ec\u4e24\u90e8\u5206\uff1a</p> <ul> <li>\u4e00\u4e2a\u662f\u5185\u5b58\u4e2d\u7684\u65e5\u5fd7\u7f13\u51b2\uff08redo log buffer\uff0c\u5185\u5b58\u5730\u5740\u7a7a\u95f4\uff09\u3002\uff08innodb_log_buffer_size\uff09</li> <li>\u53e6\u4e00\u4e2a\u662f\u78c1\u76d8\u4e0a\u7684\u65e5\u5fd7\u6587\u4ef6\uff08redo log file\uff0c\u7269\u7406\u78c1\u76d8\u6587\u4ef6\uff09\u3002\uff08innodb_log_file_size\uff09</li> </ul> <p>MySQL \u6bcf\u6267\u884c\u4e00\u6761 DML \u8bed\u53e5\uff0c\u5148\u5c06\u8bb0\u5f55\u5199\u5165 redo log buffer \uff0c\u540e\u7eed\u67d0\u4e2a\u65f6\u95f4\u70b9\u518d\u4e00\u6b21\u6027\u5c06\u591a\u4e2a\u64cd\u4f5c\u8bb0\u5f55\u5199\u5230 redo log file \u3002</p> <p>\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0credo log \u5728\u78c1\u76d8\u4e0a\u7531\u540d\u4e3a <code>ib_logfile0</code> \u548c <code>ib_logfile1</code> \u7684\u4e24\u4e2a\u7269\u7406\u6587\u4ef6\u3002</p>"},{"location":"advanced/4.InnoDB%E5%86%85%E5%AD%98%E7%BB%93%E6%9E%84%E2%80%94%E2%80%94%E7%BC%93%E5%86%B2%E6%B1%A0/#redolog","title":"redolog \u76f8\u5173\u914d\u7f6e\u53c2\u6570","text":"<pre><code>### redolog \u5173\u952e\u53c2\u6570\n\n# redo-log \u9ed8\u8ba4\u662f\u5728 datadir \u76ee\u5f55\u4e0b\uff0c\u540d\u4e3a `ib_logfile1` \u548c `ib_logfile2` \u8fd9\u6837\u7684\u4e24\u4e2a\u6587\u4ef6\u3002\n# \u6307\u5b9aredolog\u7684\u5b58\u653e\u76ee\u5f55\uff0c\u9ed8\u8ba4\u662f\"./\"\uff0c\u5373\u5728datadir\u76ee\u5f55\u4e0b\uff0c\u6761\u4ef6\u5141\u8bb8\u7684\u8bdd\uff0c\u4e00\u822c\u4e0d\u5efa\u8bae\u653e\u5728\u8ddfdatadir\u540c\u4e00\u5757\u78c1\u76d8\u4e0b\uff0c\u9632\u6b62IO\u4e89\u7528\n# \u6ce8\u610f\u8fd9\u4e2a\u76ee\u5f55\u8981\u63d0\u524d\u521b\u5efa\u597d\uff0c\u5e76\u8bbe\u7f6e\u597d\u6b63\u786e\u7684\u6743\u9650\ninnodb_log_group_home_dir=/data/mysql_redo_log/\n\n# \u5355\u4e2aredolog\u6587\u4ef6\u7684\u5927\u5c0f\uff0c\u9ed8\u8ba4\u662f48MB\uff0c\u6700\u5927\u503c\u4e3a512G\uff0c\u6ce8\u610f\u6700\u5927\u503c\u6307\u7684\u6240\u6709redo-log\u6587\u4ef6\u4e4b\u548c\n# \u5982\u679c\u6570\u636e\u5e93\u5355\u4e2a\u4e8b\u52a1\u8f83\u5927\u7684\u8bdd\uff0credolog\u5e94\u8be5\u5c3d\u91cf\u8bbe\u7f6e\u7684\u7a0d\u5fae\u5927\u70b9\ninnodb_log_file_size=48MB\n\n# regolog\u662f\u4ee5\u4e00\u7ec4\u6587\u4ef6\u7684\u5f62\u5f0f\u51fa\u73b0\u3002\u8fd9\u4e2a\u53c2\u6570\u4e86\u6307\u5b9a\u4e86\u4e00\u7ec4\u91cc\u9762\u6709\u591a\u5c11\u4e2aredo log\u6587\u4ef6\ninnodb_log_files_in_group=2  # \u9ed8\u8ba4\u503c\u662f2\n# regolog\u6587\u4ef6\u7684\u603b\u5927\u5c0f\u5c31\u662f\u7b49\u4e8e innodb_log_file_size*innodb_log_files_in_group\n\n# redo_log_buffer \u5927\u5c0f\uff0c\u9ed8\u8ba4\u4e3a16M\u3002\u5ef6\u8fdf\u4e8b\u52a1\u65e5\u5fd7\u5199\u5165\u78c1\u76d8\uff0c\u628a redo log \u653e\u5230\u8be5\u7f13\u51b2\u533a\n# \u7136\u540e\u6839\u636e innodb_flush_log_at_trx_commit \u53c2\u6570\u7684\u8bbe\u7f6e\uff0c\u518d\u628a\u65e5\u5fd7\u4ecebuffer\u4e2dflush\u5230\u78c1\u76d8\n# innodb_log_buffer_size\u662f\u4f1a\u8bdd\u7ea7\u7684\uff0c\u6240\u6709\u6574\u4e2aredolog buffer\u5360\u7528\u7684\u7a7a\u95f4\u5e94\u8be5\u662finnodb_log_buffer_size * connections\n# \u4e00\u822c\u9ed8\u8ba4\u503c16MB\u662f\u591f\u7528\u7684\uff0c\u4f46\u5982\u679c\u4e8b\u52a1\u4e4b\u4e2d\u542b\u6709blog/text\u7b49\u5927\u5b57\u6bb5\uff0c\u8fd9\u4e2a\u7f13\u51b2\u533a\u4f1a\u88ab\u5f88\u5feb\u586b\u6ee1\u4f1a\u5f15\u8d77\u989d\u5916\u7684IO\u8d1f\u8f7d\u3002\u5bf9\u4e8e\u5927\u4e8b\u52a1\u64cd\u4f5c\u3002\u53ef\u4ee5\u8003\u8651\u8bbe\u7684\u5927\u4e00\u4e9b\u3002\ninnodb_log_buffer_size=16M\n\n## \u4fee\u6539redo_log\u6587\u4ef6\u5927\u5c0f\u5fc5\u987b\u8981\u5148\u5173\u95ed\u5b9e\u4f8b\u540e\u518d\u4fee\u6539\u3002\n## MySQL 8.0.30 \u7248\u672c\u4e2d\u63d0\u4f9b\u52a8\u6001\u8c03\u6574redo log \u6587\u4ef6\u5927\u5c0f\u7684\u529f\u80fd\u3002\u81ea\u6b64\uff0c\u53ef\u4ee5\u5728\u7ebf\u8c03\u6574\u65e0\u9700\u91cd\u542f\u3002\n\ninnodb_flush_log_at_trx_commit=1\n# innodb_flush_log_at_trx_commit \u63a7\u5236 redolog \u4ece redolog buffer\u5237\u65b0\u5230\u78c1\u76d8\u7684\u7b56\u7565\uff0c\u5177\u4f53\u542b\u4e49\u5982\u4e0b:\n\n# \u9ed8\u8ba4\u4e3a1\u3002\u503c\u4e3a1\uff0c\u6bcf\u6b21 commit \u90fd\u4f1a\u628a redo log \u4ece redo log buffer \u5199\u5165\u5230 system \uff0c\u5e76fsync\u5237\u65b0\u5230\u78c1\u76d8\u6587\u4ef6\u4e2d\u3002\n\n# \u503c\u4e3a2\u65f6\uff0c\u8868\u793a\u6bcf\u6b21\u4e8b\u52a1\u63d0\u4ea4\u65f6 MySQL \u4f1a\u628a\u65e5\u5fd7\u4ece redo log buffer \u5199\u5165\u5230 system \uff0c\u4f46\u53ea\u5199\u5165\u5230 file system buffer\uff0c\u7531\u7cfb\u7edf\u5185\u90e8\u6765 fsync \u5230\u78c1\u76d8\u6587\u4ef6\u3002\u5982\u679c\u6570\u636e\u5e93\u5b9e\u4f8b crash \uff0c\u4e0d\u4f1a\u4e22\u5931 redo log\uff0c\u4f46\u662f\u5982\u679c\u670d\u52a1\u5668 crash\uff0c\u7531\u4e8e file system buffer \u8fd8\u6765\u4e0d\u53ca fsync \u5230\u78c1\u76d8\u6587\u4ef6\uff0c\u6240\u4ee5\u4f1a\u4e22\u5931\u8fd9\u4e00\u90e8\u5206\u7684\u6570\u636e\u3002\n\n# \u503c\u4e3a0\uff0c\u8868\u793a\u4e8b\u52a1\u63d0\u4ea4\u65f6\u4e0d\u8fdb\u884c\u5199\u5165redo log\u64cd\u4f5c\uff0c\u8fd9\u4e2a\u64cd\u4f5c\u4ec5\u5728 master thread \u4e2d\u5b8c\u6210\uff0c\u800c\u5728 master thread \u4e2d\u6bcf1\u79d2\u8fdb\u884c\u4e00\u6b21\u91cd\u505a\u65e5\u5fd7\u7684 fsync \u64cd\u4f5c\uff0c\u56e0\u6b64\u5b9e\u4f8b crash \u6700\u591a\u4e22\u59311\u79d2\u949f\u5185\u7684\u4e8b\u52a1\u3002\n\n\n# \u8fd9\u4e2a\u53c2\u6570\u662finnodb\u7684\u6570\u636e\u9875\u5927\u5c0f\u5355\u4f4d\uff0c\u4e00\u822c\u8bbe\u7f6e\u4e3a\ninnodb_page_size=16KB\n\n\n# https://blog.csdn.net/u010647035/article/details/104733939\n\n\n\n## MySQL8.0.30 \u7248\u672c\u4e2d\u63d0\u4f9b\u5728\u7ebf\u52a8\u6001\u8c03\u6574redo log\u6587\u4ef6\u5927\u5c0f\u7684\u529f\u80fd\u3002\u81ea\u6b64\uff0c\u53ef\u4ee5\u76f4\u63a5\u5728\u7ebf\u8c03\u6574\u4e14\u65e0\u9700\u91cd\u542f\n## \u81ea8.0.30\u540e\uff0credo\u6587\u4ef6\u603b\u5927\u5c0f\u53c2\u6570\u4e5f\u53d8\u6210\u4e86\u7531 innodb_redo_log_capacity \u53c2\u6570\u76f4\u63a5\u63a7\u5236\uff0c\u9ed8\u8ba4\u662f100MB\u3002\n## \u4e00\u65e6\u8bbe\u7f6e\u4e86\u8fd9\u4e2a\u53c2\u6570\uff0c\u524d\u9762\u7684\u7ec4\u6570\u91cf\u548c\u5927\u5c0f\u90fd\u88ab\u5ffd\u7565\u3002\n## redo\u6587\u4ef6\u4e5f\u5b58\u653e\u5728datadir\u7684#innodb_redo\u76ee\u5f55\u4e2d\u3002\u5206\u4e3a\u4e24\u7c7b\uff1aordinary(\u5df2\u7528\u8fc7\u7684\uff0c\u4e0d\u5e26_tmp \u540e\u7f00\u7684) \u548c spare(\u7a7a\u95f2\u7684\uff0c\u5e26tmp\u540e\u7f00\u7684) \u3002\n## \u4e00\u822c\u4f1a\u5c06redo\u6587\u4ef6\u5e73\u5747\u5206\u621032\u4efd\u6587\u4ef6\u3002\u4ee5 #ib_redoN \u6587\u4ef6\u547d\u540d\uff0cN\u4e3a\u5e8f\u53f7\n\n# \u5728\u7ebf\u8c03\u6574redo\u4e3a8GB\nSET GLOBAL innodb_redo_log_capacity = 8589934592;\n\n# \u5728\u7ebf\u76f4\u63a5\u8c03\u6574redo\u4e3a2GB\nset persist innodb_redo_log_capacity=2*1024*1024*1024;\n\n\n# \u65b0\u589e\u5bf9\u5e94\u7684\u72b6\u6001\u53d8\u91cfinnodb_redo_log_capacity_resized\uff0c\u65b9\u4fbf\u5728 MySQL \u4fa7\u76d1\u63a7\u5f53\u524d REDO \u65e5\u5fd7\u6587\u4ef6\u5927\u5c0f\nshow status like 'innodb_redo_log_capacity_resized';\n\n# \u540c\u65f6 performance_schema \u5e93\u91cc\u65b0\u589e\u8868innodb_redo_log_files\uff1a\u83b7\u53d6\u5f53\u524d\u4f7f\u7528\u7684 REDO \u65e5\u5fd7\u6587\u4ef6 LSN \u533a\u95f4\u3001\u5b9e\u9645\u5199\u5165\u5927\u5c0f\u3001\u662f\u5426\u5df2\u6ee1\u7b49\u7edf\u8ba1\u6570\u636e\u3002\u4f8b\u5982\u5f53\u524d15\u4e2a REDO \u65e5\u5fd7\u6587\u4ef6\u7684\u7edf\u8ba1\u6570\u636e\u5982\u4e0b\uff1a\u4e00\u76ee\u4e86\u7136\uff01\n</code></pre>"},{"location":"advanced/4.InnoDB%E5%86%85%E5%AD%98%E7%BB%93%E6%9E%84%E2%80%94%E2%80%94%E7%BC%93%E5%86%B2%E6%B1%A0/#redolog_1","title":"redolog \u52a8\u6001\u5f00\u5173","text":"<p>\u5728 MySQL 8.0.21 \u65b0\u7248\u672c\u53d1\u5e03\u4e2d\uff0c\u652f\u6301\u4e86\u4e00\u4e2a\u65b0\u7279\u6027 Redo Logging \u52a8\u6001\u5f00\u5173\u3002</p> <p>\u501f\u52a9\u8fd9\u4e2a\u529f\u80fd\uff0c\u5728\u65b0\u5b9e\u4f8b\u5bfc\u6570\u636e\u7684\u573a\u666f\u4e0b\uff0c\u4e8b\u52a1\u5904\u7406\u53ef\u4ee5\u8df3\u8fc7\u8bb0\u5f55 redolog \u548c doublewrite buffer\uff0c\u4ece\u800c\u52a0\u5feb\u6570\u636e\u7684\u5bfc\u5165\u901f\u5ea6\u3002</p> <p>\u540c\u65f6\uff0c\u4ed8\u51fa\u7684\u4ee3\u4ef7\u662f\u77ed\u65f6\u95f4\u727a\u7272\u4e86\u6570\u636e\u5e93\u7684 ACID \u4fdd\u969c\u3002\u6240\u4ee5\u4e3b\u8981\u4f7f\u7528\u573a\u666f\u5c31\u662f\u5411\u4e00\u4e2a\u65b0\u5b9e\u4f8b\u5bfc\u5165\u6570\u636e\u3002</p> <p>\u6ce8\u610f\u4e8b\u9879</p> <ul> <li>\u8be5\u7279\u6027\u4ec5\u7528\u4e8e\u65b0\u5b9e\u4f8b\u5bfc\u6570\u636e\u573a\u666f\uff0c\u4e0d\u53ef\u7528\u4e8e\u7ebf\u4e0a\u7684\u751f\u4ea7\u73af\u5883\uff1b</li> <li>Redo logging \u5173\u95ed\u72b6\u6001\u4e0b\uff0c\u652f\u6301\u6b63\u5e38\u6d41\u7a0b\u7684\u5173\u95ed\u548c\u91cd\u542f\u5b9e\u4f8b\uff1b\u4f46\u5728\u5f02\u5e38\u5b95\u673a\u60c5\u51b5\u4e0b\uff0c\u53ef\u80fd\u4f1a\u5bfc\u81f4\u4e22\u6570\u636e\u548c\u9875\u9762\u635f\u574f\uff1bRedo logging \u5173\u95ed\u540e\u5f02\u5e38\u5b95\u673a\u7684\u5b9e\u4f8b\u9700\u8981\u5e9f\u5f03\u91cd\u5efa\uff0c\u76f4\u63a5\u91cd\u542f\u4f1a\u6709\u5982\u4e0b\u62a5\u9519\uff1a[ERROR] [MY-013578] [InnoDB] Server was killed when Innodb Redo logging was disabled. Data files could be corrupt. You can try to restart the database with innodb_force_recovery=6.</li> <li>Redo logging \u5173\u95ed\u72b6\u6001\u4e0b\uff0c\u4e0d\u652f\u6301 cloning operations \u548c redo log archiving \u8fd9\u4e24\u4e2a\u529f\u80fd\uff1b</li> <li>\u6267\u884c\u8fc7\u7a0b\u4e2d\u4e0d\u652f\u6301\u5176\u4ed6\u5e76\u53d1\u7684 ALTER INSTANCE \u64cd\u4f5c\uff1b</li> </ul> <p>\u65b0\u589e\u5185\u5bb9</p> <ul> <li>SQL \u8bed\u6cd5<code>ALTER INSTANCE {ENABLE | DISABLE} INNODB REDO_LOG</code>\u3002</li> <li>INNODB_REDO_LOG_ENABLE \u6743\u9650\uff0c\u5141\u8bb8\u6267\u884c Redo Logging \u52a8\u6001\u5f00\u5173\u7684\u64cd\u4f5c\u3002</li> <li>Innodb_redo_log_enabled \u7684 status\uff0c\u7528\u4e8e\u663e\u793a\u5f53\u524d Redo Logging \u5f00\u5173\u72b6\u6001\u3002</li> </ul> <p>\u7528\u6cd5</p> <pre><code>--\u5148\u8d4b\u6743\nGRANT INNODB_REDO_LOG_ENABLE ON *.* to 'data_load_admin';\n--\u7136\u540e\u5173\u95edredo_log\nALTER INSTANCE DISABLE INNODB REDO_LOG;\n--\u786e\u8ba4\u662f\u5426\u5173\u95ed\u6210\u529f\nSHOW GLOBAL STATUS LIKE 'Innodb_redo_log_enabled';\n\n--\u5f00\u59cb\u5f80\u65b0\u5b9e\u4f8b\u5bfc\u5165\u6570\u636e\n\n--\u91cd\u65b0\u5f00\u542fredo_log\nALTER INSTANCE ENABLE INNODB REDO_LOG;\n--\u786e\u8ba4\u662f\u5426\u5f00\u542f\u6210\u529f\nSHOW GLOBAL STATUS LIKE 'Innodb_redo_log_enabled';\n</code></pre>"},{"location":"advanced/4.InnoDB%E5%86%85%E5%AD%98%E7%BB%93%E6%9E%84%E2%80%94%E2%80%94%E7%BC%93%E5%86%B2%E6%B1%A0/#redolog_2","title":"redolog \u5f52\u6863","text":"<p>\u70ed\u5907\u7684\u539f\u7406\u90fd\u662f\u8981\u5907\u4efd redolog\uff0c\u7531\u4e8e redolog \u662f\u5faa\u73af\u5199\u7684\u3002</p> <p>\u5982\u679c\u5907\u4efd\u671f\u95f4\u8fd8\u662f\u6709\u5927\u91cf\u7684\u4e8b\u52a1\u5199\u5165\uff0c\u5907\u4efd\u901f\u5ea6\u8ddf\u4e0d\u4e0a redo log \u751f\u6210\u7684\u901f\u5ea6\uff0c\u7ed3\u679c\u5bfc\u81f4 redo log \u88ab\u8986\u76d6\u4e86\uff0c\u7136\u540e\u5907\u4efd\u5c31\u65e0\u6cd5\u4fdd\u8bc1\u4e00\u81f4\u6027\u3002\u5bfc\u81f4\u5907\u4efd\u5931\u8d25\u3002</p> <p>MySQL8.0.17 \u4e2d\u5f15\u5165\u4e86 redo log \u7684\u5f52\u6863\u529f\u80fd\uff0c\u5982\u679c\u6211\u4eec\u5f00\u542f\u5f52\u6863\u529f\u80fd\uff0credo log \u4f1a\u6301\u7eed\u4e0d\u65ad\u7684\u751f\u6210\uff0c\u800c\u4e0d\u4f1a\u8986\u76d6\u6389\u4e4b\u524d\u7684 redo log\u3002</p> <p>\u8bd5\u60f3\u8fd9\u6837\u4e00\u79cd\u60c5\u51b5\uff0c\u5728\u5bf9\u4e00\u4e2a\u9ad8\u5e76\u53d1\u7684\u6570\u636e\u5e93\u8fdb\u884c\u70ed\u5907\u4efd\u7684\u65f6\u5019\uff0c\u5907\u4efd\u901f\u5ea6\u5f88\u6162\u800c redo log \u751f\u6210\u7684\u901f\u5ea6\u5f88\u5feb\uff0c\u5907\u4efd\u7684\u901f\u5ea6\u8ddf\u4e0d\u4e0a redo log \u7684\u751f\u6210\u901f\u5ea6\uff0c\u5bfc\u81f4 redo log \u88ab\u8986\u76d6\u4e86\uff0c\u6b64\u65f6\u5907\u4efd\u7684\u4e00\u81f4\u6027\u5c31\u65e0\u6cd5\u5f97\u5230\u4fdd\u8bc1\u4e86\u3002</p> <p>\u6709\u4e86 redo log \u7684\u5f52\u6863\u529f\u80fd\uff0c\u5c31\u53ef\u4ee5\u5728\u5907\u4efd\u542f\u52a8\u7684\u65f6\u5019\u540c\u6b65\u542f\u52a8 redo log \u5f52\u6863\uff0c\u800c\u5728\u5907\u4efd\u7ed3\u675f\u7684\u65f6\u5019\u540c\u6b65\u505c\u6b62 redo log \u5f52\u6863\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u907f\u514d\u8fd9\u4e2a\u5907\u4efd\u7684\u95ee\u9898\u4e86\u3002</p> <p>\u5907\u4efd\u7ed3\u675f\u4e4b\u540e\uff0c\u4f9d\u65e7\u53ef\u4ee5\u5229\u7528\u8fd9\u4e2a\u671f\u95f4\u4ea7\u751f\u7684 redo log \u8fdb\u884c\u6570\u636e\u6062\u590d\u3002</p> <p>\u60f3\u8981\u542f\u7528 redo log \u5f52\u6863\u529f\u80fd\uff0c\u53ea\u9700\u8bbe\u7f6e innodb_redo_log_archive_dirs \u9009\u9879\u5373\u53ef\uff0c\u8be5\u9009\u9879\u53ef\u652f\u6301\u5728\u7ebf\u52a8\u6001\u4fee\u6539\uff0c\u4f8b\u5982\uff1a</p> <p>https://blog.csdn.net/qq_35246620/article/details/79345359</p>"},{"location":"advanced/4.InnoDB%E5%86%85%E5%AD%98%E7%BB%93%E6%9E%84%E2%80%94%E2%80%94%E7%BC%93%E5%86%B2%E6%B1%A0/#binlog","title":"\u4e8c\u8fdb\u5236\u65e5\u5fd7 binlog","text":"<p>binlog \u662f MySQL \u7684 server \u5c42\u5f88\u91cd\u8981\u7684\u4e00\u4e2a\u6587\u4ef6\uff0c\u5b83\u7684\u4e3b\u8981\u4f5c\u7528\u5982\u4e0b\uff1a</p> <ul> <li>\u7528\u4e8e\u590d\u5236\uff0c\u5728\u4e3b\u4ece\u590d\u5236\u4e2d\uff0c\u4ece\u5e93\u5229\u7528\u4e3b\u5e93\u4e0a\u7684 binlog \u8fdb\u884c\u91cd\u64ad\uff0c\u5b9e\u73b0\u4e3b\u4ece\u540c\u6b65\u3002</li> <li>\u7528\u4e8e\u6570\u636e\u5e93\u7684\u57fa\u4e8e\u65f6\u95f4\u70b9\u7684\u8fd8\u539f\u3002</li> </ul> <p>binlog \u662f\u903b\u8f91\u4e0a\u7684\u65e5\u5fd7\uff0c</p>"},{"location":"advanced/4.InnoDB%E5%86%85%E5%AD%98%E7%BB%93%E6%9E%84%E2%80%94%E2%80%94%E7%BC%93%E5%86%B2%E6%B1%A0/#binlog_1","title":"binlog \u76f8\u5173\u914d\u7f6e","text":"<pre><code># \u76f8\u5173\u53c2\u6570\n\n# binlog_cache\u662fsession\u7ea7\u522b\u7684\uff0c\u4e5f\u5c31\u662f\u8bf4\u5b9e\u9645binlog cache\u5360\u7528\u5185\u5b58\u6570= connections * binlog_cache\u3002\nbinlog_cache_size  # \u9ed8\u8ba4\u503c\u662f32k\uff0c\u5199binlog\u4e4b\u524d\uff0c\u4f1a\u5148\u5199binlog_cache\n\n# \u4e00\u822c\u8bbe\u7f6e\u4e3arow\nbinlog_format\n\n# binlog\u662f\u5426\u52a0\u5bc6\uff0c\u9ed8\u8ba4\u4e0d\u52a0\u5bc6\nbinlog_encryption=off\n\n# binlog\u8fc7\u671f\u65f6\u95f4\uff0c\u9ed8\u8ba4\u662f30\u5929\nbinlog_expire_logs_seconds=2592000\n</code></pre> <p>redo-log \u548c binlog \u662f \u4e24\u9636\u6bb5\u63d0\u4ea4\u7684\u91cd\u70b9\uff0c</p> <ul> <li>\u5f53\u672a\u5f00\u542f binlog \u65f6\uff0cInnoDB \u901a\u8fc7 redo \u548c undo \u65e5\u5fd7\u6765\u6062\u590d\u6570\u636e\u5e93 (safe crash recovery)\uff1a</li> </ul> <p>\u5f53**\u6570\u636e\u6062\u590d\uff08\u6307\u4e8b\u52a1\u5df2\u7ecf\u63d0\u4ea4\u6210\u529f\uff0c\u4f46\u662f\u6570\u636e\u8fd8\u6ca1\u6709\u5237\u56de\u78c1\u76d8\u65f6\u91cd\u542f\u7684\u8fd9\u79cd\u60c5\u51b5\uff09**\u65f6\uff1a</p> <ul> <li>\u6240\u6709\u5df2\u7ecf\u5728\u5b58\u50a8\u5f15\u64ce\u5185\u90e8\u63d0\u4ea4\u7684\u4e8b\u52a1\u5e94\u7528 redo log \u6062\u590d\u3002</li> <li> <p>\u6240\u6709\u5df2\u7ecf prepared \u4f46\u662f\u6ca1\u6709 commit \u7684\u4e8b\u52a1\u5219\u4f1a\u901a\u8fc7 undo log \u505a\u56de\u6eda</p> </li> <li> <p>\u5f00\u542f binlog \u65f6\uff0c\u4e24\u9636\u6bb5\u7684\u6d41\u7a0b\uff1a</p> </li> <li> <p>InnoDB \u7684\u4e8b\u52a1 Prepare \u9636\u6bb5\uff0c\u5373 SQL \u5df2\u7ecf\u6210\u529f\u6267\u884c\u5e76\u751f\u6210 redo \u548c undo \u7684\u5185\u5b58\u65e5\u5fd7\uff1b\uff08\u5199 redo_log_buffer\uff09</p> </li> <li>binlog \u63d0\u4ea4\uff0c\u901a\u8fc7 write() \u5c06 binlog \u5185\u5b58\u65e5\u5fd7\u6570\u636e\u5199\u5165\u6587\u4ef6\u7cfb\u7edf\u7f13\u5b58\uff1b</li> <li>sync() \u5c06 binlog \u6587\u4ef6\u7cfb\u7edf\u7f13\u5b58\u65e5\u5fd7\u6570\u636e\u6c38\u4e45\u5199\u5165\u78c1\u76d8\uff1b\uff08\u8fd9\u4e00\u6b65\u5c31\u53ef\u4ee5\u7ed9\u5ba2\u6237\u7aef\u8fd4\u56de\u4e8b\u52a1\u63d0\u4ea4\u6210\u529f\uff09</li> <li>InnoDB \u5185\u90e8\u63d0\u4ea4\uff0ccommit \u9636\u6bb5\u5728\u5b58\u50a8\u5f15\u64ce\u5185\u63d0\u4ea4\uff0c\u901a\u8fc7 innodb_flush_log_at_trx_commit \u53c2\u6570\u63a7\u5236\uff0c\u4f7f undo \u548c redo \u6c38\u4e45\u5199\u5165\u78c1\u76d8\u3002</li> </ul> <p>Prepare \u9636\u6bb5\uff1a\u5199 redo-log , \u6b64\u65f6 redo log \u5904\u4e8e prepare \u72b6\u6001\u3002\u6ce8\u610f\u8fd9\u91cc\u53ef\u80fd\u53ea\u662f\u5199 innodb_log_buffer \uff08\u8fd9\u662f\u5185\u5b58\u4e2d\u7684\u91cd\u505a\u65e5\u5fd7\u7f13\u51b2\u533a\uff09</p> <p>Commit \u9636\u6bb5\uff1ainnodb \u91ca\u653e\u9501(\u91ca\u653e\u9501\u4f4f\u7684\u8d44\u6e90)\uff0c\u91ca\u653e\u56de\u6eda\u6bb5\uff0c\u8bbe\u7f6e\u63d0\u4ea4\u72b6\u6001\uff0cbinlog \u6301\u4e45\u5316\u5230\u78c1\u76d8\uff0c\u7136\u540e\u5b58\u50a8\u5f15\u64ce\u5c42\u63d0\u4ea4</p> <p>\u5f53\u5173\u95ed binlog \u65f6\uff0c\u4e1a\u52a1\u4f60\u6839\u672c\u4e0d\u9700\u8981 binlog \u5e26\u7ed9\u4f60\u7684\u7279\u6027\uff08\u6bd4\u5982\u6570\u636e\u5907\u4efd\u6062\u590d\u3001\u642d\u5efa MySQL \u4e3b\u4ece\u96c6\u7fa4\uff09\uff0c\u90a3\u4f60\u6839\u672c\u5c31\u7528\u4e0d\u7740\u8ba9 MySQL \u5199 binlog\uff0c\u4e5f\u7528\u4e0d\u7740\u4ec0\u4e48\u4e24\u9636\u6bb5\u63d0\u4ea4\u3002</p> <p>\u53ea\u7528\u4e00\u4e2a redolog \u5c31\u591f\u4e86\u3002\u65e0\u8bba\u4f60\u7684\u6570\u636e\u5e93\u5982\u4f55 crash\uff0credolog \u4e2d\u8bb0\u5f55\u7684\u5185\u5bb9\u603b\u80fd\u8ba9\u4f60 MySQL \u5185\u5b58\u4e2d\u7684\u6570\u636e\u6062\u590d\u6210 crash \u4e4b\u524d\u7684\u72b6\u6001\u3002</p> <p>\u6240\u4ee5\u8bf4\uff0c\u4e24\u9636\u6bb5\u63d0\u4ea4\u7684\u4e3b\u8981\u7528\u610f\u662f\uff1a\u4e3a\u4e86\u4fdd\u8bc1 redolog \u548c binlog \u6570\u636e\u7684\u5b89\u5168\u4e00\u81f4\u6027\u3002\u53ea\u6709\u5728\u8fd9\u4e24\u4e2a\u65e5\u5fd7\u6587\u4ef6\u903b\u8f91\u4e0a\u9ad8\u5ea6\u4e00\u81f4\u4e86\u3002</p> <p>\u4f60\u624d\u80fd\u653e\u5fc3\u5730\u4f7f\u7528 redolog \u5e2e\u4f60\u5c06\u6570\u636e\u5e93\u4e2d\u7684\u72b6\u6001\u6062\u590d\u6210 crash \u4e4b\u524d\u7684\u72b6\u6001\uff0c\u4f7f\u7528 binlog \u5b9e\u73b0\u6570\u636e\u5907\u4efd\u3001\u6062\u590d\u3001\u4ee5\u53ca\u4e3b\u4ece\u590d\u5236\u3002</p> <p>\u800c\u4e24\u9636\u6bb5\u63d0\u4ea4\u7684\u673a\u5236\u53ef\u4ee5\u4fdd\u8bc1\u8fd9\u4e24\u4e2a\u65e5\u5fd7\u6587\u4ef6\u7684\u903b\u8f91\u662f\u9ad8\u5ea6\u4e00\u81f4\u7684\u3002\u6ca1\u6709\u9519\u8bef\u3001\u6ca1\u6709\u51b2\u7a81\u3002</p>"},{"location":"advanced/4.InnoDB%E5%86%85%E5%AD%98%E7%BB%93%E6%9E%84%E2%80%94%E2%80%94%E7%BC%93%E5%86%B2%E6%B1%A0/#undolog","title":"\u56de\u6eda\u65e5\u5fd7 undolog","text":"<p>undolog \u662f mysql \u4e2d\u6bd4\u8f83\u91cd\u8981\u7684\u4e8b\u52a1\u65e5\u5fd7\u4e4b\u4e00\uff0c\u987e\u540d\u601d\u4e49\uff0cundolog \u662f\u4e00\u79cd\u7528\u4e8e\u64a4\u9500\u56de\u9000\u7684\u65e5\u5fd7\uff0c\u5728\u4e8b\u52a1\u6ca1\u63d0\u4ea4\u4e4b\u524d\uff0cMySQL \u4f1a\u5148\u8bb0\u5f55\u66f4\u65b0\u524d\u7684\u6570\u636e\u5230 undolog \u65e5\u5fd7\u6587\u4ef6\u91cc\u9762\uff0c\u5f53\u4e8b\u52a1\u56de\u6eda\u65f6\u6216\u8005\u6570\u636e\u5e93\u5d29\u6e83\u65f6\uff0c\u53ef\u4ee5\u5229\u7528 undolog \u6765\u8fdb\u884c\u56de\u9000\u3002</p> <p>\u4e3a\u4e86\u65b9\u4fbf\u4e8b\u52a1\u56de\u6eda\uff0c\u6570\u636e\u5e93\u5728\u4fee\u6539\u6570\u636e\u65f6\u4e5f\u5fc5\u987b\u8bb0\u5f55\u6570\u636e\u7684\u65e7\u503c\uff0c\u8fd9\u5c31\u662f Undo Log\u3002\u6b63\u56e0\u4e3a\u6709\u4e86 Redo Log\uff0c\u5bf9\u4e8e\u5df2\u7ecf\u63d0\u4ea4\u7684\u4e8b\u52a1\u7684\u6570\u636e\u4e00\u5b9a\u5b58\u5728\u4e8e\u78c1\u76d8\uff0c\u6240\u4ee5\u4fdd\u8bc1\u4e86\u6570\u636e\u5e93\u7cfb\u7edf\u7684\u6301\u4e45\u6027\uff1b\u800c\u6709\u4e86 Undo Log\uff0c\u6570\u636e\u5e93\u53ef\u4ee5\u4fdd\u8bc1\u5728\u6545\u969c\u6062\u590d\u65f6\u5bf9\u6ca1\u6709\u5b8c\u6210\u7684\u4e8b\u52a1\u8fdb\u884c\u56de\u6eda\uff0c\u4e5f\u5c31\u4fdd\u8bc1\u7684\u4e8b\u52a1\u7684\u539f\u5b50\u6027\u3002</p> <p>\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u521d\u59cb\u5316\u540e\uff0c\u4f1a\u521b\u5efa\u4e24\u4e2a undo \u8868\u7a7a\u95f4<code>innodb_undo_001</code>\u548c<code>innodb_undo_002</code>\u3002\u5bf9\u5e94\u5230\u78c1\u76d8\u5c31\u662f<code>innodb_undo_directory</code>\u4e0b\u7684\u4e24\u4e2a\u6587\u4ef6<code>undo_001</code>\u548c<code>undo_002</code>\uff0c\u5982\u679c\u6ca1\u6709\u8bbe\u7f6e\u8be5\u53c2\u6570\uff0c\u9ed8\u8ba4\u5c31\u662f\u5728<code>datadir</code>\u76ee\u5f55\u4e0b\u3002</p> <p>MySQL \u5b9e\u4f8b\u6700\u591a\u652f\u6301 127 \u4e2a undo \u8868\u7a7a\u95f4\uff0c\u5176\u4e2d\u5305\u62ec MySQL \u5b9e\u4f8b\u521d\u59cb\u5316\u65f6\u521b\u5efa\u7684\u4e24\u4e2a\u9ed8\u8ba4 undo \u8868\u7a7a\u95f4\u3002undo \u8868\u7a7a\u95f4\u7684\u6570\u91cf\u7531 innodb_undo_tablespaces \u63a7\u5236\u3002\u9ed8\u8ba4\u503c 0\uff0c\u6700\u5927\u503c 95</p> <pre><code>ALTER UNDO TABLESPACE tablespace_name SET INACTIVE;\n\nDROP UNDO TABLESPACE tablespace_name;\n\nSELECT NAME, STATE FROM INFORMATION_SCHEMA.INNODB_TABLESPACES\n  WHERE NAME LIKE 'tablespace_name';\n\n\nSELECT TABLESPACE_NAME, FILE_NAME FROM INFORMATION_SCHEMA.FILES WHERE FILE_TYPE LIKE 'UNDO LOG';\n\nSHOW STATUS LIKE 'Innodb_undo_tablespaces%';\n</code></pre> <p>undo \u8868\u7a7a\u95f4\u6587\u4ef6\u7684\u521d\u59cb\u5927\u5c0f\u53d6\u51b3\u4e8e<code>innodb_page_size</code>\u503c\u3002\u5bf9\u4e8e\u9ed8\u8ba4\u7684 16k InnoDB \u9875\u9762\u5927\u5c0f\uff0c\u521d\u59cb undo \u8868\u7a7a\u95f4\u6587\u4ef6\u5927\u5c0f\u4e3a 10MiB\u3002\u5bf9\u4e8e 4k\uff0c8k\uff0c32k \u548c 64k \u9875\u9762\u5927\u5c0f\uff0c\u521d\u59cb undo \u8868\u7a7a\u95f4\u6587\u4ef6\u5927\u5c0f\u5206\u522b\u4e3a 7MiB\uff0c8MiB\uff0c20MiB \u548c 40MiB\u3002</p> <ul> <li>\u4e8b\u52a1\u56de\u6eda</li> </ul> <p>\u5728\u8bbe\u8ba1\u6570\u636e\u5e93\u65f6\uff0c\u6211\u4eec\u5047\u8bbe\u6570\u636e\u5e93\u53ef\u80fd\u5728\u4efb\u4f55\u65f6\u523b\uff0c\u7531\u4e8e\u5982\u786c\u4ef6\u6545\u969c\uff0c\u8f6f\u4ef6 Bug\uff0c\u8fd0\u7ef4\u64cd\u4f5c\u7b49\u539f\u56e0\u7a81\u7136\u5d29\u6e83\u3002\u8fd9\u4e2a\u65f6\u5019\u5c1a\u672a\u5b8c\u6210\u63d0\u4ea4\u7684\u4e8b\u52a1\u53ef\u80fd\u5df2\u7ecf\u6709\u90e8\u5206\u6570\u636e\u5199\u5165\u4e86\u78c1\u76d8\uff0c\u5982\u679c\u4e0d\u52a0\u5904\u7406\uff0c\u4f1a\u8fdd\u53cd\u6570\u636e\u5e93\u5bf9 Atomic \u7684\u4fdd\u8bc1\uff0c\u4e5f\u5c31\u662f\u4efb\u4f55\u4e8b\u52a1\u7684\u4fee\u6539\u8981\u4e48\u5168\u90e8\u63d0\u4ea4\uff0c\u8981\u4e48\u5168\u90e8\u53d6\u6d88\u3002\u9488\u5bf9\u8fd9\u4e2a\u95ee\u9898\uff0c\u76f4\u89c2\u7684\u60f3\u6cd5\u662f\u7b49\u5230\u4e8b\u52a1\u771f\u6b63\u63d0\u4ea4\u65f6\uff0c\u624d\u80fd\u5141\u8bb8\u8fd9\u4e2a\u4e8b\u52a1\u7684\u4efb\u4f55\u4fee\u6539\u843d\u76d8\uff0c\u4e5f\u5c31\u662f No-Steal \u7b56\u7565\u3002\u663e\u800c\u6613\u89c1\uff0c\u8fd9\u79cd\u505a\u6cd5\u4e00\u65b9\u9762\u9020\u6210\u5f88\u5927\u7684\u5185\u5b58\u7a7a\u95f4\u538b\u529b\uff0c\u53e6\u4e00\u65b9\u9762\u63d0\u4ea4\u65f6\u7684\u5927\u91cf\u968f\u673a IO \u4f1a\u6781\u5927\u7684\u5f71\u54cd\u6027\u80fd\u3002\u56e0\u6b64\uff0c\u6570\u636e\u5e93\u5b9e\u73b0\u4e2d\u901a\u5e38\u4f1a\u5728\u6b63\u5e38\u4e8b\u52a1\u8fdb\u884c\u4e2d\uff0c\u5c31\u4e0d\u65ad\u7684\u8fde\u7eed\u5199\u5165 Undo Log\uff0c\u6765\u8bb0\u5f55\u672c\u6b21\u4fee\u6539\u4e4b\u524d\u7684\u5386\u53f2\u503c\u3002\u5f53 Crash \u771f\u6b63\u53d1\u751f\u65f6\uff0c\u53ef\u4ee5\u5728 Recovery \u8fc7\u7a0b\u4e2d\u901a\u8fc7\u56de\u653e Undo Log \u5c06\u672a\u63d0\u4ea4\u4e8b\u52a1\u7684\u4fee\u6539\u62b9\u6389\u3002InnoDB \u91c7\u7528\u7684\u5c31\u662f\u8fd9\u79cd\u65b9\u5f0f\u3002</p> <pre><code>-- \u5982\u679c\u4e1a\u52a1\u4e0a\u6709\u8dd1\u6279\u91cf\u6216\u8005\u5927\u8868\u7684DML\u64cd\u4f5c\u65f6\uff0c\u5f15\u8d77\u5927\u4e8b\u7269\uff0c\u6216\u9488\u5bf9\u591a\u5f20\u5927\u8868\u5173\u8054\u66f4\u65b0\u65f6\u95f4\u8f83\u957f\uff0c\u53ef\u80fd\u77ed\u65f6\u95f4\u5185\u4f1a\u5c06undo\"\u6491\u5927\"\uff0coracle \u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u521b\u5efa\u4e00\u4e2a\u65b0\u7684 undo\uff0c\u901a\u8fc7\u5728\u7ebf\u7684\u66ff\u6362\u7684\u65b9\u5f0f\uff0c\u5c06\u81a8\u80c0\u7684 undo \u4f7f\u7528 drop \u5220\u9664\u4ee5\u91ca\u653e\u7a7a\u95f4\u3002\n-- MySQL8.0\u540c\u6837\u53ef\u4ee5\u4f7f\u7528\u8fd9\u79cd\u65b9\u5f0f\u6765\u5904\u7406\uff0c\u56e0\u5927\u4e8b\u7269\u6216\u957f\u4e8b\u7269\u5f15\u8d77\u7684undo\u8fc7\u5927\u5360\u7528\u7a7a\u95f4\u8f83\u591a\u7684\u60c5\u51b5\u3002\n\n-- \u6dfb\u52a0\u65b0\u7684undo\u6587\u4ef6undo003\u3002mysql8.0\u4e2d\u9ed8\u8ba4innodb_undo_tablespace\u4e3a2\u4e2a\uff0c\u4e0d\u8db32\u4e2a\u65f6\uff0c\u4e0d\u5141\u8bb8\u8bbe\u7f6e\u4e3ainactive\uff0c\u4e14\u9ed8\u8ba4\u521b\u5efa\u7684undo\u53d7\u4fdd\u62a4\uff0c\u4e0d\u5141\u8bb8\u5220\u9664\u3002\n-- \u5c06\u81a8\u80c0\u7684 undo \u4e34\u65f6\u8bbe\u7f6e\u4e3ainactive\uff0c\u4ee5\u53ca innodb_undo_log_truncate=on\uff0c\u81ea\u52a8 truncate \u91ca\u653e\u81a8\u80c0\u7684undo\u7a7a\u95f4\u3002\n-- \u91cd\u65b0\u5c06\u91ca\u653e\u7a7a\u95f4\u4e4b\u540e\u7684undo\u8bbe\u7f6e\u4e3aactive\uff0c\u53ef\u91cd\u65b0\u4e0a\u7ebf\u4f7f\u7528\u3002\n\n-- \u5728undo\u9047\u5230\u5927\u4e8b\u52a1\u5e76\u6301\u7eed\u589e\u957f\u7684\u60c5\u51b5\u4e0b\uff0c\u901a\u8fc7\u65b0\u589e\u4e34\u65f6undo\uff0c\u624b\u52a8\u91ca\u653e\u7cfb\u7edf\u9ed8\u8ba4\u76842\u4e2aundo\u8868\u7a7a\u95f4\u5927\u5c0f\u3002\u5f53\u7136\uff0c\u622a\u65ad UNDO \u8868\u7a7a\u95f4\u6587\u4ef6\u5bf9\u6570\u636e\u5e93\u6027\u80fd\u6709\u4e00\u5b9a\u5f71\u54cd\uff0c\u5c3d\u91cf\u5728\u76f8\u5bf9\u7a7a\u95f2\u65f6\u95f4\u8fdb\u884c\u3002\n-- \u5f53UNDO\u8868\u7a7a\u95f4\u88ab\u622a\u65ad\u65f6\uff0cUNDO\u8868\u7a7a\u95f4\u4e2d\u7684\u56de\u6eda\u6bb5\u5c06\u88ab\u505c\u7528\u3002\u5176\u4ed6UNDO\u8868\u7a7a\u95f4\u4e2d\u7684\u6d3b\u52a8\u56de\u6eda\u6bb5\u8d1f\u8d23\u6574\u4e2a\u7cfb\u7edf\u8d1f\u8f7d\uff0c\u8fd9\u53ef\u80fd\u4f1a\u5bfc\u81f4\u6027\u80fd\u7565\u6709\u4e0b\u964d\u3002\u6027\u80fd\u53d7\u5f71\u54cd\u7684\u7a0b\u5ea6\u53d6\u51b3\u4e8e\u8bf8\u591a\u56e0\u7d20\n\n-- \u56e0\u6b64\uff0c\u907f\u514d\u6f5c\u5728\u6027\u80fd\u5f71\u54cd\u7684\u6700\u7b80\u5355\u65b9\u6cd5:\n-- 1\u3001\u5c31\u662f\u901a\u8fc7create undo tablespace undo_XXX add datafile \u2018/path/undo_xxx.ibu\u2019;\u591a\u6dfb\u52a0\u51e0\u4e2aUNDO\u8868\u7a7a\u95f4\uff1b\n-- 2\u3001\u5982\u679c\u6761\u4ef6\u5141\u8bb8\uff0c\u78c1\u76d8\u4e0a\u91c7\u7528\u9ad8\u6027\u80fd\u7684SSD\u6765\u5b58\u50a8\u6570\u636e\uff0c\u5b58\u50a8REDO\u3001UNDO\u7b49\u3002\n-- \u5f15\u8d77UNDO\u8fc7\u5ea6\u81a8\u80c0\u7684\u539f\u56e0\u5927\u591a\u662f\u56e0\u4e3a\u57fa\u7840\u6570\u636e\u91cf\u5927\uff0c\u4e1a\u52a1\u5e76\u53d1\u9ad8\uff0c\u8868\u5173\u8054\u64cd\u4f5c\u8f83\u9891\u7e41\uff0c\u51fa\u73b0\u5927\u4e14\u957f\u7684\u4e8b\u7269\u64cd\u4f5c\uff0c\u5bfc\u81f4UNDO\u4e00\u76f4\u5904\u4e8eactive\u72b6\u6001\uff0c\u4e0d\u80fd\u53ca\u65f6\u91ca\u653e\u56de\u6eda\u6bb5\u7b49\u3002\n-- \u5927\u4e8b\u52a1\u5f15\u8d77\u7684\u95ee\u9898\u7531\u6765\u5df2\u4e45\uff0c\u5373\u4f7f\u6211\u4eec\u80fd\u89c4\u907f99%\u7684\u5927\u4e8b\u7269\uff0c\u4f46\u5b9e\u9645\u4e1a\u52a1\u9047\u5230\u90a31%\u7684\u5927\u4e8b\u7269\u521a\u6027\u9700\u6c42\u53d1\u8fc7\u6765\u65f6\uff0c\u8fd8\u8981MySQL\u5404\u79cd\u573a\u666f\u3001\u5404\u79cd\u67b6\u6784\u548c\u4e1a\u52a1\u5c42\u597d\u597d\u78e8\u5408\u3002\n</code></pre> <p>undo \u4e24\u5927\u4f5c\u7528\uff1a</p> <ul> <li> <p>\u5b9e\u73b0\u4e8b\u52a1\u56de\u6eda\uff0c\u4fdd\u969c\u4e8b\u52a1\u7684\u539f\u5b50\u6027\u3002\u4e8b\u52a1\u5904\u7406\u8fc7\u7a0b\u4e2d\uff0c\u5982\u679c\u51fa\u73b0\u4e86\u9519\u8bef\u6216\u8005\u7528\u6237\u6267 \u884c\u4e86 ROLLBACK \u8bed\u53e5\uff0cMySQL \u53ef\u4ee5\u5229\u7528 undo log \u4e2d\u7684\u5386\u53f2\u6570\u636e\u5c06\u6570\u636e\u6062\u590d\u5230\u4e8b\u52a1\u5f00\u59cb\u4e4b\u524d\u7684\u72b6\u6001\u3002</p> </li> <li> <p>\u5b9e\u73b0 MVCC\uff08\u591a\u7248\u672c\u5e76\u53d1\u63a7\u5236\uff09\u5173\u952e\u56e0\u7d20\u4e4b\u4e00\u3002MVCC \u662f\u901a\u8fc7 ReadView + undo log \u5b9e\u73b0\u7684\u3002undo log \u4e3a\u6bcf\u6761\u8bb0\u5f55\u4fdd\u5b58\u591a\u4efd\u5386\u53f2\u6570\u636e\uff0cMySQL \u5728\u6267\u884c\u5feb\u7167\u8bfb\uff08\u666e\u901a select \u8bed\u53e5\uff09\u7684\u65f6\u5019\uff0c\u4f1a\u6839\u636e\u4e8b\u52a1\u7684 Read View \u91cc\u7684\u4fe1\u606f\uff0c\u987a\u7740 undo log \u7684\u7248\u672c\u94fe\u627e\u5230\u6ee1\u8db3\u5176\u53ef\u89c1\u6027\u7684\u8bb0\u5f55\u3002</p> </li> </ul>"},{"location":"advanced/4.InnoDB%E5%86%85%E5%AD%98%E7%BB%93%E6%9E%84%E2%80%94%E2%80%94%E7%BC%93%E5%86%B2%E6%B1%A0/#_9","title":"\u7ec4\u63d0\u4ea4","text":""},{"location":"advanced/4.InnoDB%E5%86%85%E5%AD%98%E7%BB%93%E6%9E%84%E2%80%94%E2%80%94%E7%BC%93%E5%86%B2%E6%B1%A0/#_10","title":"\u80cc\u666f","text":"<ul> <li> <p>\u64cd\u4f5c\u7cfb\u7edf\u4f7f\u7528 \u7f13\u5b58 \u6765\u586b\u8865\u5185\u5b58\u548c\u78c1\u76d8\u8bbf\u95ee\u7684\u5dee\u8ddd\uff0c\u5bf9\u78c1\u76d8\u6587\u4ef6\u7684\u5199\u5165\u4f1a\u5148\u5199\u5165\u5230\u9875\u9762\u7f13\u5b58\u4e2d\u3002</p> </li> <li> <p>\u5728\u4e00\u4e9b GNU/Linux \u548c UNIX \u4e2d\uff0c\u4f7f\u7528 **Unix fsync() \u7cfb\u7edf\u8c03\u7528**\u6765\u628a\u6570\u636e\u5237\u5230\u78c1\u76d8\uff08InnoDB \u9ed8\u8ba4\u4f7f\u7528 *fsyn*c \u8fd9\u4e2a\uff09</p> </li> <li> <p>\u5f15\u81ea MySQL refman 8.5.8</p> </li> <li> <p>\u6570\u636e\u5e93\u5728\u4e8b\u52a1\u63d0\u4ea4\u8fc7\u7a0b\u4e2d\u8c03\u7528 fsync \u5c06\u6570\u636e\u6301\u4e45\u5316\u5230\u78c1\u76d8\uff0c\u624d\u6ee1\u8db3**ACID**\u4e2d\u7684**D\uff08\u6301\u4e45\u5316\uff09**</p> </li> <li> <p>fsync \u662f\u6602\u8d35\u7684\u64cd\u4f5c\uff0c\u5bf9\u4e8e\u666e\u901a\u78c1\u76d8\uff0c\u6bcf\u79d2\u80fd\u5b8c\u6210\u51e0\u767e\u6b21 fsync</p> </li> <li> <p>MySQL \u4e2d\u4f7f\u7528\u4e86\u4e24\u9636\u6bb5\u63d0\u4ea4\u534f\u8bae\uff0c\u4e3a\u4e86\u6ee1\u8db3 D(\u6301\u4e45\u5316) \uff0c\u4e00\u6b21\u4e8b\u52a1\u63d0\u4ea4\u6700\u591a\u4f1a\u5bfc\u81f4 3 \u6b21 fsync</p> </li> <li> <p>\u63d0\u4ea4\u7684\u4e8b\u52a1\u5728\u5b58\u50a8\u5f15\u64ce\u5185\u90e8\uff08redo log\uff09\u4e2d\u51c6\u5907\u597d\uff0c\u4e00\u6b21 fsync\uff1b\uff08\u5199 redo-log \u5230\u78c1\u76d8\uff1a/datadit/ib_logfile0\uff09</p> </li> <li> <p>\u4e8b\u52a1\u5199\u5165\u5230 binlog \u4e2d\u5e76\u5237\u76d8\u6301\u4e45\u5316\uff0c\u4e00\u6b21 fsync\uff1b\uff08\u5199 binlog \u5230\u78c1\u76d8\uff09</p> </li> <li> <p>\u4e8b\u52a1\u5728\u5b58\u50a8\u5f15\u64ce\u5185\u90e8\u63d0\u4ea4\uff0c\u4e00\u6b21 fsync\uff08\u5199\u6570\u636e\u6587\u4ef6\u5230\u78c1\u76d8\uff0c\u53ef\u4ee5\u7701\u7565\uff0c\u5b58\u50a8\u5f15\u64ce\u51c6\u5907\u597d\u7684\u4e8b\u52a1\u53ef\u4ee5\u901a\u8fc7 binlog \u6765\u6062\u590d\uff09</p> </li> </ul> <p>\u867d\u7136\u4e0a\u9762\u8bf4\u7684\u8fd9\u4e9b redo log \u7684\u5237\u76d8\u53ef\u4ee5\u901a\u8fc7 innodb_flush_log_at_trx_commit \uff0cbinlog \u5237\u76d8\u901a\u8fc7 sync_binlog \u53c2\u6570\u6765\u63a7\u5236\u3002</p> <p>\u4f46\u662f binlog \u548c redo log \u7684\u5237\u76d8\u8fd8\u662f\u4f1a\u6210\u4e3a\u6700\u5927\u7684\u5f00\u9500\u3002\u901a\u8fc7\u7ec4\u63d0\u4ea4\uff0c\u5c06\u591a\u4e2a\u4e8b\u52a1\u7684 binlog\uff0c\u6700\u5927\u5316\u6bcf\u6b21\u5237\u76d8\u7684\u6536\u76ca\uff0c\u5f31\u5316\u78c1\u76d8\u74f6\u9888\uff0c\u63d0\u9ad8\u6027\u80fd\u3002</p>"},{"location":"advanced/4.InnoDB%E5%86%85%E5%AD%98%E7%BB%93%E6%9E%84%E2%80%94%E2%80%94%E7%BC%93%E5%86%B2%E6%B1%A0/#_11","title":"\u7ec4\u63d0\u4ea4\u539f\u7406","text":"<p>\u7ec4\u63d0\u4ea4\uff08group commit\uff09\uff1a</p> <p>\u5982\u679c\u591a\u4e2a\u4e8b\u52a1\uff0c\u80fd\u5728\u540c\u4e00\u65f6\u95f4\u5185\u5e76\u53d1\u63d0\u4ea4\u6210\u529f\uff0c\u90a3\u4e48\u5c31\u8bf4\u660e\u8fd9\u51e0\u4e2a\u4e8b\u52a1\u662f\u4e0d\u51b2\u7a81\u7684\uff0c\u903b\u8f91\u4e0a\u53ef\u4ee5\u8ba4\u4e3a\u662f\u4e00\u7ec4\u4e8b\u52a1\uff0c\u5728\u4ece\u5e93\u4e0a\u53ef\u4ee5\u5e76\u53d1 replay\u3002</p> <p>\u57fa\u4e8e Commit_Order \u7684\u5e76\u884c\u590d\u5236\u662f\u5728\u4e3b\u6570\u636e\u5e93\u5b9e\u4f8b\u4e8b\u52a1\u63d0\u4ea4\u65f6\uff0c\u5199\u5165\u4e00\u4e9b\u989d\u5916\u4fe1\u606f\uff0c\u4ece\u800c\u5728\u4ece\u673a\u56de\u653e\u65f6\uff0c\u53ef\u4ee5\u6839\u636e\u8fd9\u4e9b\u4fe1\u606f\u5224\u65ad\u662f\u5426\u53ef\u4ee5\u8fdb\u884c\u5e76\u884c\u7684\u56de\u653e\u3002</p> <p>\u540c\u4e00\u7ec4\u63d0\u4ea4\u7684\u4e8b\u52a1\u4e4b\u95f4\u662f\u4e0d\u51b2\u7a81\u7684\uff0c\u56e0\u6b64\u53ef\u4ee5\u5e76\u884c\u56de\u653e\u3002</p> <p>\u7ec4\u63d0\u4ea4\uff0c\u5c31\u597d\u50cf\u6211\u4eec\u5e73\u65f6\u6e21\u8239\u65f6\uff0c\u4e00\u822c\u8981\u7b49\u5230\u4eba\u5750\u6ee1\u540e\uff0c\u4e00\u6b21\u6027\u5f00\u8239\u3002</p> <p>\u7ec4\u63d0\u4ea4\u5c06\u4e8b\u52a1\u5206\u4e3a\u4e09\u4e2a\u9636\u6bb5(Flush \u9636\u6bb5\u3001Sync \u9636\u6bb5\u3001Commit \u9636\u6bb5)</p> <p>\u6bcf\u4e2a\u9636\u6bb5\u90fd\u4f1a\u7ef4\u62a4\u4e00\u4e2a\u961f\u5217\u3002</p> <ul> <li> <p>Flush \u9636\u6bb5\uff1a</p> </li> <li> <p>\u5c06 binlog \u6570\u636e\u5199\u5165\u6587\u4ef6\uff0c\u5f53\u7136\u6b64\u65f6\u53ea\u662f\u5199\u5165\u6587\u4ef6\u7cfb\u7edf\u7684\u5185\u5b58\u7f13\u51b2\uff0c\u5e76\u4e0d\u80fd\u4fdd\u8bc1\u6570\u636e\u5e93\u5d29\u6e83\u65f6 binlog \u4e0d\u4e22\u5931\u3002</p> </li> <li> <p>Flush \u9636\u6bb5\u961f\u5217\u7684\u4f5c\u7528\u662f\u63d0\u4f9b\u4e86 Redo log \u7684\u7ec4\u63d0\u4ea4\u3002</p> </li> <li> <p>\u5982\u679c\u5728\u8fd9\u4e00\u6b65\u5b8c\u6210\u540e\u6570\u636e\u5e93\u5d29\u6e83\uff0c\u7531\u4e8e\u534f\u8c03\u8005 binlog \u4e2d\u4e0d\u4fdd\u8bc1\u6709\u8be5\u7ec4\u4e8b\u52a1\u7684\u8bb0\u5f55\uff0c\u6240\u4ee5 MySQL \u53ef\u80fd\u4f1a\u5728\u91cd\u542f\u540e\u56de\u6eda\u8be5\u7ec4\u4e8b\u52a1</p> </li> <li> </li> </ul> <p>\u53c2\u8003</p> <p>https://www.cnblogs.com/JiangLe/p/9650728.html</p>"},{"location":"advanced/4.InnoDB%E5%86%85%E5%AD%98%E7%BB%93%E6%9E%84%E2%80%94%E2%80%94%E7%BC%93%E5%86%B2%E6%B1%A0/#sync","title":"Sync \u9636\u6bb5\uff1a","text":""},{"location":"advanced/4.InnoDB%E5%86%85%E5%AD%98%E7%BB%93%E6%9E%84%E2%80%94%E2%80%94%E7%BC%93%E5%86%B2%E6%B1%A0/#innodb_1","title":"InnoDB \u78c1\u76d8\u7ed3\u6784","text":""},{"location":"advanced/4.InnoDB%E5%86%85%E5%AD%98%E7%BB%93%E6%9E%84%E2%80%94%E2%80%94%E7%BC%93%E5%86%B2%E6%B1%A0/#_12","title":"\u8868","text":"<p>\u521b\u5efa InnoDB \u8868\uff0c\u4f7f\u7528\u5982\u4e0b\u8bed\u53e5\uff1a</p> <pre><code>CREATE TABLE t1 (a INT, b CHAR (20), PRIMARY KEY (a)) ENGINE=InnoDB;\n</code></pre> <p>InnoDB \u4e00\u822c\u90fd\u662f\u9ed8\u8ba4\u5b58\u50a8\u5f15\u64ce\uff0c\u4e5f\u53ef\u4ee5\u4e0d\u7528\u6307\u5b9a ENGINE\u3002\u4f7f\u7528\u5982\u4e0b\u8bed\u53e5\u67e5\u8be2 InnoDB \u662f\u5426\u9ed8\u8ba4\u5b58\u50a8\u5f15\u64ce\u3002</p> <pre><code>SELECT @@default_storage_engine;\n</code></pre> <p>\u4e00\u4e2a InnoDB \u8868\u548c\u7d22\u5f15\uff0c\u53ef\u4ee5\u5728 system tablespace, file-per-table tablespace, ogeneral tablespace \u4e2d\u521b\u5efa\u3002</p> <p>\u9ed8\u8ba4\u5730\uff0cInnoDB \u7684\u8868\u90fd\u662f**\u72ec\u7acb\u8868\u7a7a\u95f4**\u3002</p> <p>\u5f53 innodb_file_per_table \u662f enabled \u72b6\u6001\uff0c\u5b83\u662f\u9ed8\u8ba4\u7684\uff0c\u4e00\u4e2a InnoDB \u8868\u88ab\u663e\u5f0f\u521b\u5efa\u5728\u5355\u72ec\u7684\u8868\u7a7a\u95f4\u4e2d\u3002</p> <p>\u5982\u679c\u662f disabled \u72b6\u6001\uff0c\u4f1a\u521b\u5efa\u5728\u7cfb\u7edf\u8868\u7a7a\u95f4\uff0c\u5982\u679c\u8981\u7528\u901a\u7528\u8868\u7a7a\u95f4\uff0c\u90a3\u4e48\u4f7f\u7528 CREATE TABLE ... TABLESPACE \u8bed\u6cd5\u6765\u521b\u5efa\u8868\u3002</p>"},{"location":"advanced/4.InnoDB%E5%86%85%E5%AD%98%E7%BB%93%E6%9E%84%E2%80%94%E2%80%94%E7%BC%93%E5%86%B2%E6%B1%A0/#_13","title":"\u4e3b\u952e","text":"<p>\u5f3a\u70c8\u5efa\u8bae\u4e3a\u6bcf\u4e2a innodb \u8868\u8bbe\u7acb\u4e3b\u952e\u3002</p>"},{"location":"advanced/4.InnoDB%E5%86%85%E5%AD%98%E7%BB%93%E6%9E%84%E2%80%94%E2%80%94%E7%BC%93%E5%86%B2%E6%B1%A0/#_14","title":"\u521b\u5efa\u5916\u90e8\u8868","text":"<p>\u6709\u65f6\u5019\uff0c\u53ef\u80fd\u9700\u8981\u521b\u5efa\u5916\u90e8\u8868\uff08\u5373\u5728 datadir \u5916\u90e8\u521b\u5efa\u8868\uff09\uff0c\u53ef\u80fd\u662f\u7531\u4e8e\u7a7a\u95f4\u7ba1\u7406\uff0cIO \u4f18\u5316\u7b49\u539f\u56e0\u3002</p> <p>InnoDB \u652f\u6301\u5916\u90e8\u8868\u7684\u8bed\u6cd5\uff1a</p> <pre><code>-- \u7b2c\u4e00\u79cd\u60c5\u51b5\uff0c\u4f7f\u7528 DATA DIRECTORY \u5b50\u53e5\nCREATE TABLE t1 (c1 INT PRIMARY KEY) DATA DIRECTORY = '/external/directory';\n</code></pre>"},{"location":"advanced/4.InnoDB%E5%86%85%E5%AD%98%E7%BB%93%E6%9E%84%E2%80%94%E2%80%94%E7%BC%93%E5%86%B2%E6%B1%A0/#innodb_2","title":"\u5bfc\u5165 InnoDB \u8868","text":"<p>\u8868\u7a7a\u95f4\u4f20\u8f93\u7279\u6027</p> <ul> <li>\u590d\u5236\u6570\u636e\u5230\u65b0\u5b9e\u4f8b\u3002</li> <li>\u4ece\u5907\u4efd\u8868\u7a7a\u95f4\u4e2d\u6062\u590d\u6570\u636e</li> <li>\u6bd4 dump \u8868\u66f4\u5feb\u7684\u65b9\u5f0f\uff08dump \u9700\u8981\u91cd\u65b0\u63d2\u5165\u6570\u636e\u548c\u91cd\u5efa\u7d22\u5f15\uff09</li> </ul> <p>\u524d\u63d0\uff1a</p> <ul> <li><code>innodb_file_per_table</code> \u53d8\u91cf\u5fc5\u987b\u5f00\u542f\uff0c\u9ed8\u8ba4\u5c31\u662f\u5f00\u542f\u7684\u3002</li> <li>innodb_page_size \u5fc5\u987b\u76f8\u7b49\u3002</li> <li>\u5982\u679c\u4e00\u4e2a\u8868\u6709\u5916\u952e\u5173\u7cfb\uff0c\u5728\u6267\u884c <code>DISCARD TABLESPACE</code> \u8bed\u53e5\u4e4b\u524d\u5fc5\u987b\u5148\u5173\u6389</li> </ul> <p>https://blog.k4nz.com/7bbf69045e0da119a1a892e054c6d145/</p>"},{"location":"advanced/4.InnoDB%E5%86%85%E5%AD%98%E7%BB%93%E6%9E%84%E2%80%94%E2%80%94%E7%BC%93%E5%86%B2%E6%B1%A0/#innodb-ioasync-io","title":"InnoDB \u5f15\u64ce\u4e4b-\u5f02\u6b65 IO\uff08Async IO\uff09\u548c\u9884\u8bfb","text":"<p>\u5728 MySQL \u4e2d\uff0cInnoDB \u7684\u5f02\u6b65 IO \u4e3b\u8981\u662f\u7528\u6765\u5904\u7406\u9884\u8bfb\u4ee5\u53ca\u5bf9\u6570\u636e\u6587\u4ef6\u7684\u5199\u8bf7\u6c42\u7684\u3002\u800c\u5bf9\u4e8e\u6b63\u5e38\u7684\u9875\u9762\u6570\u636e\u8bfb\u53d6\u5219\u662f\u901a\u8fc7\u540c\u6b65 IO \u8fdb\u884c\u7684\u3002</p> <p>\u8fd9\u4e2a\u662f\u7531 <code>innodb_use_native_aio</code> \u53c2\u6570\u63a7\u5236\u7684\u3002\u5b83\u9002\u7528\u4e8e Linux \u64cd\u4f5c\u7cfb\u7edf\uff0c\u5e76\u4e14\u9ed8\u8ba4\u542f\u7528\u3002\u64cd\u4f5c\u7cfb\u7edf\u9700\u8981 <code>libaio</code> \u5e93\u3002</p> <p>InnoDB \u5728 I/O \u7684\u4f18\u5316\u4e0a\u6709\u4e2a\u6bd4\u8f83\u91cd\u8981\u7684\u7279\u6027\u4e3a\u9884\u8bfb\uff0c\u9884\u8bfb\u8bf7\u6c42\u662f\u4e00\u4e2a i/o \u8bf7\u6c42\uff0c\u5b83\u4f1a\u5f02\u6b65\u5730\u5c06\u591a\u4e2a\u9875\u9762\u9884\u8bfb\u5165\u7f13\u51b2\u6c60\uff0c\u9884\u8ba1\u5f88\u5feb\u5c31\u4f1a\u9700\u8981\u8fd9\u4e9b\u9875\u9762\uff0c\u8fd9\u4e9b\u8bf7\u6c42\u5728\u4e00\u4e2a\u8303\u56f4\u5185\u5f15\u5165\u6240\u6709\u9875\u9762\u3002</p> <p>\u7a0b\u5e8f\u662f\u6709\u7a7a\u95f4\u5c40\u90e8\u6027\u7684\uff0c\u9760\u8fd1\u5f53\u524d\u88ab\u8bbf\u95ee\u6570\u636e\u7684\u6570\u636e\uff0c\u5728\u672a\u6765\u5f88\u5927\u6982\u7387\u4f1a\u88ab\u8bbf\u95ee\u5230\u3002</p> <p>\u6240\u4ee5\uff0cMySQL \u5728\u52a0\u8f7d\u6570\u636e\u9875\u65f6\uff0c\u4f1a\u63d0\u524d\u628a\u5b83\u76f8\u90bb\u7684\u6570\u636e\u9875\u4e00\u5e76\u52a0\u8f7d\u8fdb\u6765\uff0c\u76ee\u7684\u662f\u4e3a\u4e86\u51cf\u5c11\u78c1\u76d8 IO\u3002</p> <p>\u4f46\u662f\u53ef\u80fd\u8fd9\u4e9b\u88ab\u63d0\u524d\u52a0\u8f7d\u8fdb\u6765\u7684\u6570\u636e\u9875\uff0c\u5e76\u6ca1\u6709\u88ab\u8bbf\u95ee\uff0c\u76f8\u5f53\u4e8e\u8fd9\u4e2a\u9884\u8bfb\u662f\u767d\u505a\u4e86\uff0c\u8fd9\u4e2a\u5c31\u662f\u9884\u8bfb\u5931\u6548\u3002</p> <p>\u5982\u679c\u4f7f\u7528\u7b80\u5355\u7684 LRU \u7b97\u6cd5\uff0c\u5c31\u4f1a\u628a\u9884\u8bfb\u9875\u653e\u5230 LRU \u94fe\u8868\u5934\u90e8\uff0c\u800c\u5f53 Buffer Pool \u7a7a\u95f4\u4e0d\u591f\u7684\u65f6\u5019\uff0c\u8fd8\u9700\u8981\u628a\u672b\u5c3e\u7684\u9875\u6dd8\u6c70\u6389\u3002</p> <p>\u5982\u679c\u8fd9\u4e9b\u9884\u8bfb\u9875\u5982\u679c\u4e00\u76f4\u4e0d\u4f1a\u88ab\u8bbf\u95ee\u5230\uff0c\u5c31\u4f1a\u51fa\u73b0\u4e00\u4e2a\u5f88\u5947\u602a\u7684\u95ee\u9898\uff0c\u4e0d\u4f1a\u88ab\u8bbf\u95ee\u7684\u9884\u8bfb\u9875\u5374\u5360\u7528\u4e86 LRU \u94fe\u8868\u524d\u6392\u7684\u4f4d\u7f6e\uff0c\u800c\u672b\u5c3e\u6dd8\u6c70\u7684\u9875\uff0c\u53ef\u80fd\u662f\u9891\u7e41\u8bbf\u95ee\u7684\u9875\uff0c\u8fd9\u6837\u5c31\u5927\u5927\u964d\u4f4e\u4e86\u7f13\u5b58\u547d\u4e2d\u7387\u3002</p> <p>\u6570\u636e\u5e93\u8bf7\u6c42\u6570\u636e\u7684\u65f6\u5019\uff0c\u4f1a\u5c06\u8bfb\u8bf7\u6c42\u4ea4\u7ed9\u6587\u4ef6\u7cfb\u7edf\uff0c\u653e\u5165\u8bf7\u6c42\u961f\u5217\u4e2d\uff1b\u76f8\u5173\u8fdb\u7a0b\u4ece\u8bf7\u6c42\u961f\u5217\u4e2d\u5c06\u8bfb\u8bf7\u6c42\u53d6\u51fa\uff0c\u6839\u636e\u9700\u6c42\u5230\u76f8\u5173\u6570\u636e\u533a(\u5185\u5b58\u3001\u78c1\u76d8)\u8bfb\u53d6\u6570\u636e\uff1b\u53d6\u51fa\u7684\u6570\u636e\uff0c\u653e\u5165\u54cd\u5e94\u961f\u5217\u4e2d\uff0c\u6700\u540e\u6570\u636e\u5e93\u5c31\u4f1a\u4ece\u54cd\u5e94\u961f\u5217\u4e2d\u5c06\u6570\u636e\u53d6\u8d70\uff0c\u5b8c\u6210\u4e00\u6b21\u6570\u636e\u8bfb\u64cd\u4f5c\u8fc7\u7a0b\u3002</p> <p>\u63a5\u7740\u8fdb\u7a0b\u7ee7\u7eed\u5904\u7406\u8bf7\u6c42\u961f\u5217\uff0c(\u5982\u679c\u6570\u636e\u5e93\u662f\u5168\u8868\u626b\u63cf\u7684\u8bdd\uff0c\u6570\u636e\u8bfb\u8bf7\u6c42\u5c06\u4f1a\u5360\u6ee1\u8bf7\u6c42\u961f\u5217)\uff0c\u5224\u65ad\u540e\u9762\u51e0\u4e2a\u6570\u636e\u8bfb\u8bf7\u6c42\u7684\u6570\u636e\u662f\u5426\u76f8\u90bb\uff0c\u518d\u6839\u636e\u81ea\u8eab\u7cfb\u7edf IO \u5e26\u5bbd\u5904\u7406\u91cf\uff0c\u8fdb\u884c\u9884\u8bfb\uff0c\u8fdb\u884c\u8bfb\u8bf7\u6c42\u7684\u5408\u5e76\u5904\u7406\uff0c\u4e00\u6b21\u6027\u8bfb\u53d6\u591a\u5757\u6570\u636e\u653e\u5165\u54cd\u5e94\u961f\u5217\u4e2d\uff0c\u518d\u88ab\u6570\u636e\u5e93\u53d6\u8d70\u3002(\u5982\u6b64\uff0c\u4e00\u6b21\u7269\u7406\u8bfb\u64cd\u4f5c\uff0c\u5b9e\u73b0\u591a\u9875\u6570\u636e\u8bfb\u53d6\uff0crrqm&gt;0\uff08# iostat -x\uff09\uff0c\u5047\u8bbe\u662f 4 \u4e2a\u8bfb\u8bf7\u6c42\u5408\u5e76\uff0c\u5219 rrqm \u53c2\u6570\u663e\u793a\u7684\u5c31\u662f 4)</p> <p>InnoDB \u4f7f\u7528\u4e24\u79cd\u9884\u8bfb\u7b97\u6cd5\u6765\u63d0\u9ad8 I/O \u6027\u80fd\uff1a\u7ebf\u6027\u9884\u8bfb\uff08linear read-ahead\uff09\u548c\u968f\u673a\u9884\u8bfb\uff08randomread-ahead\uff09</p> <p>\u4e3a\u4e86\u533a\u5206\u8fd9\u4e24\u79cd\u9884\u8bfb\u7684\u65b9\u5f0f\uff0c\u6211\u4eec\u53ef\u4ee5\u628a\u7ebf\u6027\u9884\u8bfb\u653e\u5230\u4ee5 extent \u4e3a\u5355\u4f4d\uff0c\u800c\u968f\u673a\u9884\u8bfb\u653e\u5230\u4ee5 extent \u4e2d\u7684 page \u4e3a\u5355\u4f4d\u3002\u7ebf\u6027\u9884\u8bfb\u7740\u773c\u4e8e\u5c06\u4e0b\u4e00\u4e2a extent \u63d0\u524d\u8bfb\u53d6\u5230 buffer pool \u4e2d\uff0c\u800c\u968f\u673a\u9884\u8bfb\u7740\u773c\u4e8e\u5c06\u5f53\u524d extent \u4e2d\u7684\u5269\u4f59\u7684 page \u63d0\u524d\u8bfb\u53d6\u5230 buffer pool \u4e2d\u3002</p> <p>\u7ebf\u6027\u9884\u8bfb\uff08linear read-ahead\uff09\uff1a\u5b83\u53ef\u4ee5\u6839\u636e\u987a\u5e8f\u8bbf\u95ee\u7f13\u51b2\u6c60\u4e2d\u7684\u9875\u9762\uff0c\u9884\u6d4b\u54ea\u4e9b\u9875\u9762\u53ef\u80fd\u9700\u8981\u5f88\u5feb\u3002\u901a\u8fc7\u4f7f\u7528\u914d\u7f6e\u53c2\u6570 innodb_read_ahead_threshold\uff0c\u901a\u8fc7\u8c03\u6574\u89e6\u53d1\u5f02\u6b65\u8bfb\u53d6\u8bf7\u6c42\u6240\u9700\u7684\u987a\u5e8f\u9875\u8bbf\u95ee\u6570\uff0c\u53ef\u4ee5\u63a7\u5236 Innodb \u6267\u884c\u63d0\u524d\u8bfb\u64cd\u4f5c\u7684\u65f6\u95f4\u3002\u5728\u6dfb\u52a0\u6b64\u53c2\u6570\u4e4b\u524d\uff0cInnoDB \u53ea\u4f1a\u8ba1\u7b97\u5f53\u5728\u5f53\u524d\u8303\u56f4\u7684\u6700\u540e\u4e00\u9875\u4e2d\u8bfb\u53d6\u6574\u4e2a\u4e0b\u4e00\u4e2a\u533a\u6bb5\u65f6\u662f\u5426\u53d1\u51fa\u5f02\u6b65\u9884\u53d6\u8bf7\u6c42\u3002</p> <p>\u7ebf\u6027\u9884\u8bfb\u65b9\u5f0f\u6709\u4e00\u4e2a\u5f88\u91cd\u8981\u7684\u53d8\u91cf\u63a7\u5236\u662f\u5426\u5c06\u4e0b\u4e00\u4e2a extent \u9884\u8bfb\u5230 buffer pool \u4e2d\uff0c\u901a\u8fc7\u4f7f\u7528\u914d\u7f6e\u53c2\u6570 innodb_read_ahead_threshold\uff0c\u53ef\u4ee5\u63a7\u5236 Innodb \u6267\u884c\u9884\u8bfb\u64cd\u4f5c\u7684\u65f6\u95f4\u3002\u5982\u679c\u4e00\u4e2a extent \u4e2d\u7684\u88ab\u987a\u5e8f\u8bfb\u53d6\u7684 page \u8d85\u8fc7\u6216\u8005\u7b49\u4e8e\u8be5\u53c2\u6570\u53d8\u91cf\u65f6\uff0cInnodb \u5c06\u4f1a\u5f02\u6b65\u7684\u5c06\u4e0b\u4e00\u4e2a extent \u8bfb\u53d6\u5230 buffer pool \u4e2d\uff0cinnodb_read_ahead_threshold \u53ef\u4ee5\u8bbe\u7f6e\u4e3a 0-64 \u7684\u4efb\u4f55\u503c\uff0c\u9ed8\u8ba4\u503c\u4e3a 56\uff0c\u503c\u8d8a\u9ad8\uff0c\u8bbf\u95ee\u6a21\u5f0f\u68c0\u67e5\u8d8a\u4e25\u683c\u3002</p>"},{"location":"advanced/4.InnoDB%E5%86%85%E5%AD%98%E7%BB%93%E6%9E%84%E2%80%94%E2%80%94%E7%BC%93%E5%86%B2%E6%B1%A0/#_15","title":"\u8868\u7a7a\u95f4","text":"<p>InnoDB \u8868\u7a7a\u95f4\uff08Tablespace\uff09\u53ef\u4ee5\u770b\u505a\u4e00\u4e2a\u903b\u8f91\u6982\u5ff5\uff0cInnoDB \u628a\u6570\u636e\u4fdd\u5b58\u5728\u8868\u7a7a\u95f4\uff0c\u672c\u8d28\u4e0a\u662f\u4e00\u4e2a\u6216\u591a\u4e2a\u78c1\u76d8\u6587\u4ef6\u7ec4\u6210\u7684\u865a\u62df\u6587\u4ef6\u7cfb\u7edf\u3002</p>"},{"location":"advanced/4.InnoDB%E5%86%85%E5%AD%98%E7%BB%93%E6%9E%84%E2%80%94%E2%80%94%E7%BC%93%E5%86%B2%E6%B1%A0/#_16","title":"\u7cfb\u7edf\u8868\u7a7a\u95f4","text":"<p>\u7cfb\u7edf\u8868\u7a7a\u95f4\u662f change buffer \u7684\u5b58\u653e\u533a\u57df\u3002\u5982\u679c\u6ca1\u6709\u542f\u7528\u72ec\u7acb\u8868\u7a7a\u95f4\uff0c\u4e5f\u4f1a\u5728\u5176\u4e2d\u5b58\u653e\u4e1a\u52a1\u8868\u6570\u636e\u548c\u7d22\u5f15\u6570\u636e\u3002</p> <p>\u5728\u8001\u7248\u672c MySQL\uff0cInnoDB \u6570\u636e\u5b57\u5178\u4e5f\u5b58\u653e\u5728\u7cfb\u7edf\u8868\u7a7a\u95f4\u4e2d\u3002doublewrite buufer \u4e5f\u5b58\u653e\u5728\u7cfb\u7edf\u8868\u7a7a\u95f4\u4e2d\uff0c\u5728 8.0.20 \u4e4b\u540e\uff0cdoublewrite buufer \u4e5f\u5b58\u5728\u5355\u72ec\u7684\u6587\u4ef6\u4e2d\u4e86\u3002</p> <p>\u7cfb\u7edf\u8868\u7a7a\u95f4\u53ef\u4ee5\u7531\u591a\u4e2a\u6587\u4ef6\u7ec4\u6210\uff0c\u9ed8\u8ba4\u662f\u4e00\u4e2a\uff0c\u540d\u4e3a ibdata1\uff0c\u9ed8\u8ba4\u653e\u5728 datadir \u76ee\u5f55\u4e0b\u9762\u3002</p> <p>\u7531\u5982\u4e0b\u53c2\u6570\u63a7\u5236</p> <pre><code># \u6587\u4ef6\u8def\u5f84\uff0c\u9ed8\u8ba4\u662f datadir \u4e0b\uff0c\u4e5f\u53ef\u4ee5\u81ea\u5b9a\u4e49\u8def\u5f84\ninnodb_data_home_dir=/myibdata/\n\n# \u53c2\u6570\u8bed\u6cd5:\u6587\u4ef6\u540d:\u6587\u4ef6\u521d\u59cb\u5927\u5c0f\uff08\u521d\u59cb\u5927\u5c0f\u4e0d\u4f4e\u4e8e12M\uff09:\u81ea\u589e\u957f\u5c5e\u6027\uff1a\u6700\u5927\u5c5e\u6027\ninnodb_data_file_path=file_name:file_size[:autoextend[:max:max_file_size]]\n\n# \u6bcf\u6b21\u81ea\u52a8\u6269\u5c55\u7684\u589e\u91cf\u5927\u5c0f\uff0c\u7531innodb_autoextend_increment\u63a7\u5236\uff0c\u5355\u4f4d\u4e3aM\uff0c\u9ed8\u8ba4\u662f64M\ninnodb_autoextend_increment=64\n\n# \u9ed8\u8ba4\u503c\u5982\u4e0b:ibdata1:12M:\u81ea\u589e\u957f\ninnodb_data_file_path=ibdata1:12M:autoextend\n\n# \u4e5f\u53ef\u4ee5\u4e00\u6b21\u5b9a\u4e49\u4e24\u4e2a\u7cfb\u7edf\u8868\u7a7a\u95f4\u6587\u4ef6\ninnodb_data_file_path=ibdata1:50M;ibdata2:50M:autoextend\n</code></pre> <p>\u4e5f\u53ef\u4ee5\u624b\u52a8\u8c03\u6574\u589e\u957f ibdata \u6587\u4ef6</p> <pre><code># \u5148\u5173\u505c\u6570\u636e\u5e93\n\n# \u5982\u679cibdata\u8bbe\u7f6e\u4e86\u81ea\u589e\u957f\u5c5e\u6027\uff0c\u5220\u6389\u5b83\n</code></pre>"},{"location":"advanced/4.InnoDB%E5%86%85%E5%AD%98%E7%BB%93%E6%9E%84%E2%80%94%E2%80%94%E7%BC%93%E5%86%B2%E6%B1%A0/#_17","title":"\u5355\u72ec\u8868\u7a7a\u95f4","text":"<p>MySQL 5.6.6 \u4e4b\u524d\u7684\u7248\u672c\uff0cInnoDB \u9ed8\u8ba4\u4f1a\u5c06\u6240\u6709\u7684\u6570\u636e\u5e93 InnoDB \u5f15\u64ce\u7684\u8868\u6570\u636e\u5b58\u50a8\u5728\u4e00\u4e2a\u5171\u4eab\u7a7a\u95f4\u4e2d\uff1aibdata1\uff0c\u8fd9\u6837\u5c31\u4f1a\u8ba9\u7ba1\u7406\u611f\u89c9\u5f88\u96be\u53d7\uff0c\u589e\u5220\u6570\u636e\u5e93\u7684\u65f6\u5019\uff0cibdata1 \u6587\u4ef6\u4e0d\u4f1a\u81ea\u52a8\u6536\u7f29\u3002</p> <p>\u5355\u4e2a\u6570\u636e\u5e93\u7684\u5907\u4efd\u4e5f\u5c06\u6210\u4e3a\u95ee\u9898\u3002\u901a\u5e38\u53ea\u80fd\u5c06\u6570\u636e\u4f7f\u7528 mysqldump \u5bfc\u51fa\uff0c\u7136\u540e\u518d\u5bfc\u5165\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\u3002</p> <p>\u5728\u4e4b\u540e\u7684\u7248\u672c\uff0c\u4e3a\u4e86\u4f18\u5316\u4e0a\u8ff0\u95ee\u9898\uff0c\u72ec\u7acb\u8868\u7a7a\u95f4 innodb_file_per_table \u53c2\u6570\u9ed8\u8ba4\u5f00\u542f</p> <pre><code>mysql&gt; show variables like 'innodb_file_per_table';\n+-----------------------+-------+\n| Variable_name         | Value |\n+-----------------------+-------+\n| innodb_file_per_table | ON    |\n+-----------------------+-------+\n1 row in set, 1 warning (0.05 sec)\n</code></pre> <p>\u72ec\u7acb\u8868\u7a7a\u95f4\u5c31\u662f\u6bcf\u4e2a\u8868\u5355\u72ec\u521b\u5efa\u4e00\u4e2a .ibd \u6587\u4ef6\uff0c\u8be5\u6587\u4ef6\u5b58\u50a8\u7740\u8be5\u8868\u7684\u7d22\u5f15\u548c\u6570\u636e\u3002\u7531 innodb_file_per_table \u53d8\u91cf\u63a7\u5236\u3002\u7981\u7528 innodb_file_per_table \u4f1a\u5bfc\u81f4 InnoDB \u5728\u7cfb\u7edf\u8868\u7a7a\u95f4\u4e2d\u521b\u5efa\u8868\u3002</p> <p>InnoDB \u8868\u7a7a\u95f4\u6587\u4ef6 .ibd \u521d\u59cb\u5927\u5c0f\u4e3a 96K\uff0c\u800c InnoDB \u9ed8\u8ba4\u9875\u5927\u5c0f\u4e3a 16K\uff0c\u9875\u5927\u5c0f\u4e5f\u53ef\u4ee5\u901a\u8fc7 innodb_page_size \u914d\u7f6e\u3002</p> <p>\u5728 ibd \u6587\u4ef6\u4e2d\uff0c0-16KB \u504f\u79fb\u91cf\u5373\u4e3a 0 \u53f7\u6570\u636e\u9875\uff0c16KB-32KB \u7684\u4e3a 1 \u53f7\u6570\u636e\u9875\uff0c\u4ee5\u6b64\u7c7b\u63a8\u3002</p> <p>\u9875\u7684\u5934\u5c3e\u9664\u4e86\u4e00\u4e9b\u5143\u4fe1\u606f\u5916\uff0c\u8fd8\u6709 Checksum \u6821\u9a8c\u503c\uff0c\u8fd9\u4e9b\u6821\u9a8c\u503c\u5728\u5199\u5165\u78c1\u76d8\u524d\u8ba1\u7b97\u5f97\u5230\uff0c\u5f53\u4ece\u78c1\u76d8\u4e2d\u8bfb\u53d6\u65f6\uff0c\u91cd\u65b0\u8ba1\u7b97\u6821\u9a8c\u503c\u5e76\u4e0e\u6570\u636e\u9875\u4e2d\u5b58\u50a8\u7684\u5bf9\u6bd4\uff0c\u5982\u679c\u53d1\u73b0\u4e0d\u540c\uff0c\u5219\u4f1a\u5bfc\u81f4 MySQL \u5d29\u6e83\u3002</p>"},{"location":"advanced/4.InnoDB%E5%86%85%E5%AD%98%E7%BB%93%E6%9E%84%E2%80%94%E2%80%94%E7%BC%93%E5%86%B2%E6%B1%A0/#_18","title":"\u4e3a\u4ec0\u4e48\u4f1a\u51fa\u73b0","text":"<p>InnoDB \u662f\u57fa\u4e8e**\u78c1\u76d8**\u5b58\u50a8\u7684\uff0c\u5e76\u5c06\u5176\u4e2d\u7684\u6570\u636e\u6309**\u9875\u7684\u65b9\u5f0f**\u8fdb\u884c\u7ba1\u7406\u3002\u56e0\u6b64 InnoDB \u53ef\u89c6\u4e3a\u57fa\u4e8e\u78c1\u76d8\u7684\u6570\u636e\u5e93\u7cfb\u7edf\u3002\u7531\u4e8e CPU \u7684\u901f\u5ea6\u548c\u78c1\u76d8 IO \u901f\u5ea6\u7684\u5de8\u5927\u9e3f\u6c9f\uff0c\u9700\u8981\u7f13\u51b2\u6c60\u6765\u63d0\u9ad8\u6570\u636e\u5e93\u7684\u6574\u4f53\u6027\u80fd</p>"},{"location":"advanced/4.InnoDB%E5%86%85%E5%AD%98%E7%BB%93%E6%9E%84%E2%80%94%E2%80%94%E7%BC%93%E5%86%B2%E6%B1%A0/#_19","title":"\u662f\u4ec0\u4e48","text":"<p>\u7f13\u51b2\u6c60\u662f\u4e3b\u5185\u5b58\u4e2d\u7684\u4e00\u4e2a\u533a\u57df\uff0c\u5728<code>InnoDB</code>\u8bbf\u95ee\u8868\u548c\u7d22\u5f15\u6570\u636e\u65f6\u4f1a\u5728\u5176\u4e2d\u8fdb\u884c \u9ad8\u901f\u7f13\u5b58\u3002\u7f13\u51b2\u6c60\u5141\u8bb8\u76f4\u63a5\u4ece\u5185\u5b58\u4e2d\u5904\u7406\u7ecf\u5e38\u4f7f\u7528\u7684\u6570\u636e\uff0c\u4ece\u800c\u52a0\u5feb\u4e86\u5904\u7406\u901f\u5ea6\u3002\u5728\u4e13\u7528\u670d\u52a1\u5668\u4e0a\uff0c\u901a\u5e38\u5c06\u591a\u8fbe 80\uff05\u7684\u7269\u7406\u5185\u5b58\u5206\u914d\u7ed9\u7f13\u51b2\u6c60\u3002</p> <p>\u4e3a\u4e86\u63d0\u9ad8\u5927\u5bb9\u91cf\u8bfb\u53d6\u64cd\u4f5c\u7684\u6548\u7387\uff0c\u7f13\u51b2\u6c60\u88ab\u5206\u4e3a\u591a\u4e2a\u9875\u9762\uff0c\u8fd9\u4e9b\u9875\u9762\u53ef\u80fd\u5305\u542b\u591a\u4e2a\u884c\u3002\u4e3a\u4e86\u63d0\u9ad8\u7f13\u5b58\u7ba1\u7406\u7684\u6548\u7387\uff0c\u7f13\u51b2\u6c60\u88ab\u5b9e\u73b0\u4e3a\u9875\u9762\u7684\u94fe\u63a5\u5217\u8868\u3002\u4f7f\u7528LRU\u7b97\u6cd5\u7684\u53d8\u4f53\u5c06\u5f88\u5c11\u4f7f\u7528\u7684\u6570\u636e\u4ece\u7f13\u5b58\u4e2d\u8001\u5316\u6389 \u3002</p> <p>\u77e5\u9053\u5982\u4f55\u5229\u7528\u7f13\u51b2\u6c60\u5c06\u7ecf\u5e38\u8bbf\u95ee\u7684\u6570\u636e\u4fdd\u7559\u5728\u5185\u5b58\u4e2d\u662f MySQL \u4f18\u5316\u7684\u91cd\u8981\u65b9\u9762\u3002</p>"},{"location":"advanced/4.InnoDB%E5%86%85%E5%AD%98%E7%BB%93%E6%9E%84%E2%80%94%E2%80%94%E7%BC%93%E5%86%B2%E6%B1%A0/#_20","title":"\u67b6\u6784","text":"<p>\u7b80\u8981\u67b6\u6784\u56fe</p> <p></p>"},{"location":"advanced/4.InnoDB%E5%86%85%E5%AD%98%E7%BB%93%E6%9E%84%E2%80%94%E2%80%94%E7%BC%93%E5%86%B2%E6%B1%A0/#_21","title":"\u5173\u952e\u6982\u5ff5 \u2014\u2014 \u6570\u636e\u9875","text":"<p>\u5b83\u662f MySQL \u62bd\u8c61\u51fa\u6765\u7684\u6570\u636e\u5355\u4f4d\uff0c\u78c1\u76d8\u6587\u4ef6\u4e2d\u5c31\u662f\u5b58\u653e\u4e86\u5f88\u591a\u6570\u636e\u9875\uff0c\u6bcf\u4e2a\u6570\u636e\u9875\u91cc\u5b58\u653e\u4e86\u5f88\u591a\u884c\u6570\u636e\u3002</p> <p>\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u6570\u636e\u9875\u7684\u5927\u5c0f\u662f 16kb\u3002\u5927\u6982\u7ed3\u679c\u5982\u4e0b\u56fe\u6240\u793a</p> <p></p> <p>\u6240\u4ee5\u5bf9\u5e94\u7684\uff0c\u5728 <code>Buffer Pool</code> \u4e2d\uff0c\u4e5f\u662f\u4ee5\u6570\u636e\u9875\u4e3a\u6570\u636e\u5355\u4f4d\uff0c\u5b58\u653e\u7740\u5f88\u591a\u6570\u636e\u3002\u4f46\u662f\u6211\u4eec\u901a\u5e38\u53eb\u505a\u7f13\u5b58\u9875\uff0c\u56e0\u4e3a <code>Buffer Pool</code> \u6bd5\u7adf\u662f\u4e00\u4e2a\u7f13\u51b2\u6c60\uff0c\u5e76\u4e14\u91cc\u9762\u7684\u6570\u636e\u90fd\u662f\u4ece\u78c1\u76d8\u6587\u4ef6\u4e2d\u7f13\u5b58\u5230\u5185\u5b58\u4e2d\u3002</p> <p>\u6240\u4ee5\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u7f13\u5b58\u9875\u7684\u5927\u5c0f\u4e5f\u662f 16kb\uff0c\u56e0\u4e3a\u5b83\u548c\u78c1\u76d8\u6587\u4ef6\u4e2d\u6570\u636e\u9875\u662f\u4e00\u4e00\u5bf9\u5e94\u7684\u3002</p> <p>\u6240\u4ee5\uff0c\u7f13\u51b2\u6c60\u548c\u78c1\u76d8\u4e4b\u95f4\u7684\u6570\u636e\u4ea4\u6362\u7684\u5355\u4f4d\u662f\u6570\u636e\u9875\uff0c\u5305\u62ec\u4ece\u78c1\u76d8\u4e2d\u8bfb\u53d6\u6570\u636e\u5230\u7f13\u51b2\u6c60\u548c\u7f13\u51b2\u6c60\u4e2d\u6570\u636e\u5237\u56de\u78c1\u76d8\u4e2d\uff0c\u5982\u56fe\u6240\u793a\uff1a</p> <p></p>"},{"location":"advanced/4.InnoDB%E5%86%85%E5%AD%98%E7%BB%93%E6%9E%84%E2%80%94%E2%80%94%E7%BC%93%E5%86%B2%E6%B1%A0/#_22","title":"\u600e\u4e48\u505a\u7684","text":"<ul> <li>\u7b2c\u4e00\u6b21\u8bfb\u53d6\u6570\u636e\u65f6\uff0c\u9996\u5148\u4ece\u78c1\u76d8\u4e2d\u8bfb\u53d6\u6570\u636e\u9875\uff0c\u5e76\u653e\u5230(FIX)\u7f13\u51b2\u6c60\u4e2d\u3002</li> <li>\u518d\u6b21\u8bfb\u53d6\u540c\u6837\u7684\u6570\u636e\u65f6\uff0c\u5148\u770b\u7f13\u51b2\u6c60\u4e2d\u662f\u5426\u6709\u76f8\u540c\u7684\u6570\u636e\u9875\u3002\u6709\u5219\u547d\u4e2d\uff0c\u4ece\u7f13\u51b2\u6c60\u4e2d\u8bfb\u53d6\u3002\u5426\u5219\u4ece\u78c1\u76d8\u8bfb\u53d6</li> </ul> <p>\u7f13\u51b2\u6c60\u662f InnoDB \u5b58\u50a8\u5f15\u64ce\u4e2d\u6700\u91cd\u8981\u7684\u7ec4\u4ef6\u3002\u56e0\u4e3a\u4e3a\u4e86\u63d0\u9ad8 MySQL \u7684\u5e76\u53d1\u6027\u80fd\uff0c\u4f7f\u7528\u5230\u7684\u6570\u636e\u90fd\u4f1a\u7f13\u5b58\u5728\u7f13\u51b2\u6c60\u4e2d\uff0c\u7136\u540e\u6240\u6709\u7684\u589e\u5220\u6539\u67e5\u64cd\u4f5c\u90fd\u5c06\u5728\u7f13\u51b2\u6c60\u4e2d\u6267\u884c\u3002</p> <p>\u901a\u8fc7\u8fd9\u79cd\u65b9\u5f0f\uff0c\u4fdd\u8bc1\u6bcf\u4e2a\u66f4\u65b0\u8bf7\u6c42\uff0c\u5c3d\u91cf\u5c31\u662f**\u53ea\u66f4\u65b0\u5185\u5b58\uff0c\u7136\u540e\u5f80\u78c1\u76d8\u987a\u5e8f\u5199\u65e5\u5fd7\u6587\u4ef6**\u3002</p> <p>\u66f4\u65b0\u5185\u5b58\u7684\u6027\u80fd\u662f\u6781\u9ad8\u7684\uff0c\u7136\u540e\u987a\u5e8f\u5199\u78c1\u76d8\u4e0a\u7684\u65e5\u5fd7\u6587\u4ef6\u7684\u6027\u80fd\u4e5f\u662f\u6bd4\u8f83\u9ad8\u7684\uff0c\u56e0\u4e3a\u987a\u5e8f\u5199\u78c1\u76d8\u6587\u4ef6\uff0c\u4ed6\u7684\u6027\u80fd\u8981\u8fdc\u9ad8\u4e8e\u968f\u673a\u8bfb\u5199\u78c1\u76d8\u6587\u4ef6\u3002</p>"},{"location":"advanced/4.InnoDB%E5%86%85%E5%AD%98%E7%BB%93%E6%9E%84%E2%80%94%E2%80%94%E7%BC%93%E5%86%B2%E6%B1%A0/#_23","title":"\u670d\u52a1\u5668\u7684\u5185\u5b58\u5927\u5c0f\u5f88\u91cd\u8981","text":"<pre><code>mysql&gt; show variables like 'innodb_buffer_pool_size';\n+-------------------------+---------+\n| Variable_name           | Value   |\n+-------------------------+---------+\n| innodb_buffer_pool_size | 8388608 |\n+-------------------------+---------+\n1 row in set (0.02 sec)\n</code></pre>"},{"location":"advanced/4.InnoDB%E5%86%85%E5%AD%98%E7%BB%93%E6%9E%84%E2%80%94%E2%80%94%E7%BC%93%E5%86%B2%E6%B1%A0/#_24","title":"\u7f13\u51b2\u6c60\u4e2d\u7f13\u5b58\u7684\u6570\u636e\u9875\u7c7b\u578b","text":"<ul> <li>\u7d22\u5f15\u9875</li> <li>\u6570\u636e\u9875</li> <li>undo \u9875</li> <li>\u63d2\u5165\u7f13\u51b2(Insert buffer)</li> <li>\u81ea\u9002\u5e94\u54c8\u5e0c\u7d22\u5f15</li> <li>\u9501\u4fe1\u606f</li> <li>\u6570\u636e\u5b57\u5178\u4fe1\u606f(data dictionary)</li> </ul>"},{"location":"advanced/4.InnoDB%E5%86%85%E5%AD%98%E7%BB%93%E6%9E%84%E2%80%94%E2%80%94%E7%BC%93%E5%86%B2%E6%B1%A0/#_25","title":"\u600e\u4e48\u8bc6\u522b\u6570\u636e\u5728\u54ea\u4e2a\u7f13\u5b58\u9875\u4e2d\uff1f","text":"<p>\u5230\u6b64\uff0c\u6211\u4eec\u90fd\u77e5\u9053 <code>Buffer Pool</code> \u4e2d\u662f\u7528\u7f13\u5b58\u9875\u6765\u7f13\u5b58\u6570\u636e\u7684\uff0c\u4f46\u662f\u6211\u4eec\u600e\u4e48\u77e5\u9053\u7f13\u5b58\u9875\u5bf9\u5e94\u7740\u54ea\u4e2a\u8868\uff0c\u5bf9\u5e94\u7740\u54ea\u4e2a\u6570\u636e\u9875\u5462\uff1f</p> <p>\u6240\u4ee5\u6bcf\u4e2a\u7f13\u5b58\u9875\u90fd\u4f1a\u5bf9\u5e94\u7740\u4e00\u4e2a\u63cf\u8ff0\u6570\u636e\u5757\uff0c\u91cc\u9762\u5305\u542b\u6570\u636e\u9875\u6240\u5c5e\u7684\u8868\u7a7a\u95f4\u3001\u6570\u636e\u9875\u7684\u7f16\u53f7\uff0c\u7f13\u5b58\u9875\u5728 <code>Buffer Pool</code> \u4e2d\u7684\u5730\u5740\u7b49\u7b49\u3002</p> <p>\u63cf\u8ff0\u6570\u636e\u5757\u672c\u8eab\u4e5f\u662f\u4e00\u5757\u6570\u636e\uff0c\u5b83\u7684\u5927\u5c0f\u5927\u6982\u662f\u7f13\u5b58\u9875\u5927\u5c0f\u7684 5%\u5de6\u53f3\uff0c\u5927\u6982 800 \u4e2a\u5b57\u8282\u5de6\u53f3\u7684\u5927\u5c0f\u3002</p> <p>\u63cf\u8ff0\u5982\u56fe\u6240\u793a\uff1a</p> <p></p>"},{"location":"advanced/4.InnoDB%E5%86%85%E5%AD%98%E7%BB%93%E6%9E%84%E2%80%94%E2%80%94%E7%BC%93%E5%86%B2%E6%B1%A0/#_26","title":"\u7f13\u51b2\u6c60\u5b9e\u4f8b","text":""},{"location":"advanced/4.InnoDB%E5%86%85%E5%AD%98%E7%BB%93%E6%9E%84%E2%80%94%E2%80%94%E7%BC%93%E5%86%B2%E6%B1%A0/#_27","title":"\u6982\u5ff5","text":"<p>\u5373\u7f13\u51b2\u6c60\u7684\u4e2a\u6570\u3002\u6bcf\u9875\u6839\u636e\u54c8\u5e0c\u503c\u5206\u914d\u5230\u4e0d\u540c\u7f13\u51b2\u6c60\u5b9e\u4f8b</p>"},{"location":"advanced/4.InnoDB%E5%86%85%E5%AD%98%E7%BB%93%E6%9E%84%E2%80%94%E2%80%94%E7%BC%93%E5%86%B2%E6%B1%A0/#_28","title":"\u597d\u5904","text":"<p>\u51cf\u5c11\u8d44\u6e90\u7ade\u4e89\u3001\u652f\u6301\u66f4\u5927\u7684\u5e76\u53d1\u5904\u7406\uff0c\u52a0\u5feb\u67e5\u8be2\u901f\u5ea6</p>"},{"location":"advanced/4.InnoDB%E5%86%85%E5%AD%98%E7%BB%93%E6%9E%84%E2%80%94%E2%80%94%E7%BC%93%E5%86%B2%E6%B1%A0/#_29","title":"\u67e5\u770b\u7f13\u51b2\u6c60\u5b9e\u4f8b\u4e2a\u6570","text":"<p>\u67e5\u770b\u7f13\u51b2\u6c60\u5b9e\u4f8b\u4e2a\u6570(\u9ed8\u8ba4\u4e3a 1)</p> <pre><code>mysql&gt; show variables like 'innodb_buffer_pool_instances';\n+------------------------------+-------+\n| Variable_name                | Value |\n+------------------------------+-------+\n| innodb_buffer_pool_instances | 1     |\n+------------------------------+-------+\n1 row in set (0.03 sec)\n</code></pre> <p>\u200b \u53ef\u901a\u8fc7\u914d\u7f6e\u6587\u4ef6\u4fee\u6539\u5b9e\u4f8b\u4e2a\u6570</p>"},{"location":"advanced/4.InnoDB%E5%86%85%E5%AD%98%E7%BB%93%E6%9E%84%E2%80%94%E2%80%94%E7%BC%93%E5%86%B2%E6%B1%A0/#buffer-pool_1","title":"Buffer Pool \u5982\u4f55\u5e94\u5bf9\u9ad8\u5e76\u53d1\u573a\u666f","text":""},{"location":"advanced/4.InnoDB%E5%86%85%E5%AD%98%E7%BB%93%E6%9E%84%E2%80%94%E2%80%94%E7%BC%93%E5%86%B2%E6%B1%A0/#1-buffer-pool","title":"1\u3001\u5355\u4e2a Buffer Pool \u7684\u95ee\u9898","text":"<p>\u76f4\u5230\u73b0\u5728\uff0c\u4f30\u8ba1\u5927\u5bb6\u90fd\u4ee5\u4e3a\u7f13\u51b2\u6c60\u53ea\u662f\u4e00\u4e2a\u5927\u7684\u5185\u5b58\u533a\u57df\uff0c\u5728 InnoDB \u5b58\u50a8\u5f15\u64ce\u4e2d\u53ea\u6709\u4e00\u4e2a\uff0c\u8fd9\u662f\u5bf9\u7684\u5417\uff1f</p> <p>\u6211\u4eec\u53ef\u4ee5\u60f3\u8c61\uff0c\u5982\u679c InnoDB \u5b58\u50a8\u5f15\u64ce\u53ea\u6709\u4e00\u4e2a <code>Buffer Pool</code>\uff0c\u5f53\u9ad8\u5e76\u53d1\u65f6\uff0c\u591a\u4e2a\u8bf7\u6c42\u8fdb\u6765\uff0c\u90a3\u4e48\u4e3a\u4e86\u4fdd\u8bc1\u6570\u636e\u7684\u4e00\u81f4\u6027\uff08\u7f13\u5b58\u9875\u3001free \u94fe\u8868\u3001flush \u94fe\u8868\u3001lru \u94fe\u8868\u7b49\u591a\u79cd\u64cd\u4f5c\uff09\uff0c\u5fc5\u987b\u5f97\u7ed9\u7f13\u51b2\u6c60\u52a0\u9501\u4e86\uff0c\u6bcf\u4e00\u65f6\u523b\u53ea\u80fd\u6709\u4e00\u4e2a\u8bf7\u6c42\u83b7\u5f97\u9501\u53bb\u64cd\u4f5c <code>Buffer Pool</code>\uff0c\u5176\u4ed6\u8bf7\u6c42\u53ea\u80fd\u6392\u961f\u7b49\u5f85\u9501\u91ca\u653e\u3002\u90a3\u4e48\u6b64\u65f6 MySQL \u7684\u6027\u80fd\u662f\u591a\u4e48\u7684\u4f4e\uff01</p>"},{"location":"advanced/4.InnoDB%E5%86%85%E5%AD%98%E7%BB%93%E6%9E%84%E2%80%94%E2%80%94%E7%BC%93%E5%86%B2%E6%B1%A0/#2-buffer-pool","title":"2\u3001\u591a\u4e2a Buffer Pool","text":"<p>\u65e2\u7136\u4e00\u4e2a <code>Buffer Pool</code> \u4e0d\u591f\u7528\uff0c\u90a3\u4e48\u6574\u591a\u51e0\u4e2a\u5457\u3002</p> <p>\u5728\u751f\u4ea7\u73af\u5883\u4e2d\uff0c\u5176\u5b9e\u6211\u4eec\u662f\u53ef\u4ee5\u7ed9 MySQL \u8bbe\u7f6e\u591a\u4e2a <code>Buffer Pool</code> \u6765\u63d0\u5347 MySQL \u7684\u5e76\u53d1\u80fd\u529b\u7684~</p> <p>\u5982\u4f55\u8bbe\u7f6e\uff1f</p> <p>\u6211\u4eec\u5148\u770b\u770b MySQL \u7684\u9ed8\u8ba4\u89c4\u5219\uff1a\u5982\u679c\u4f60\u7ed9 <code>Buffer Pool</code> \u5206\u914d\u7684\u5185\u5b58\u5c0f\u4e8e 1GB\uff0c\u90a3\u4e48\u6700\u591a\u5c31\u53ea\u4f1a\u7ed9\u4f60\u4e00\u4e2a <code>Buffer Pool</code>\u3002</p> <p>\u4f46\u662f\u5462\uff0c\u5982\u679c\u4f60\u7ed9 MySQL \u8bbe\u7f6e\u7684\u5185\u5b58\u5f88\u5927\uff0c\u6b64\u65f6\u4f60\u53ef\u4ee5\u5229\u7528\u4e0b\u9762\u4e24\u4e2a\u53c2\u6570\u6765\u8bbe\u7f6e <code>Buffer Pool</code> \u7684\u603b\u5927\u5c0f\u548c\u603b\u5b9e\u4f8b\u6570\uff0c\u8fd9\u6837\uff0cMySQL \u5c31\u80fd\u6709\u591a\u4e2a <code>Buffer Pool</code> \u6765\u652f\u6491\u9ad8\u5e76\u53d1\u4e86\u3002</p> <pre><code>[server]\ninnodb_buffer_pool_size = 8589934592\ninnodb_buffer_pool_instances = 4\n</code></pre> <p>\u89e3\u91ca\u4e00\u4e0b\uff1a\u4e0a\u9762\u5229\u7528\u53c2\u6570 <code>innodb_buffer_pool_size</code> \u6765\u8bbe\u7f6e <code>Buffer Pool</code> \u7684\u603b\u5927\u5c0f\u4e3a 8G\uff0c\u5229\u7528\u53c2\u6570 <code>innodb_buffer_pool_instances</code> \u6765\u8bbe\u7f6e\u4e00\u5171\u6709 4 \u4e2a <code>Buffer Pool</code> \u5b9e\u4f8b\u3002\u90a3\u4e48\u5c31\u662f\u8bf4\uff0cMySQL \u4e00\u5171\u6709 4 \u4e2a <code>Buffer Pool</code> \uff0c\u6bcf\u4e2a\u7684\u5927\u5c0f\u4e3a 2G\u3002</p> <p>\u5f53\u7136\u4e86\uff0c\u6bcf\u4e2a <code>Buffer Pool</code> \u8d1f\u8d23\u7ba1\u7406\u7740\u81ea\u5df1\u7684\u63cf\u8ff0\u6570\u636e\u5757\u548c\u7f13\u5b58\u9875\uff0c\u6709\u81ea\u5df1\u72ec\u7acb\u4e00\u5957 free \u94fe\u8868\u3001flush \u94fe\u8868\u548c lru \u94fe\u8868\u3002</p> <p>\u5230\u8fd9\uff0c\u6211\u4eec\u5c31\u6653\u5f97\uff0c\u53ea\u8981\u4f60\u80fd\u5206\u914d\u8db3\u591f\u5927\u7684\u5185\u5b58\u7ed9 <code>Buffer Pool</code> \uff0c\u4f60\u5c31\u80fd\u521b\u5efa\u5c3d\u91cf\u591a\u7684 <code>Buffer Pool</code> \u6765\u5e94\u5bf9\u9ad8\u5e76\u53d1\u573a\u666f~</p> <p>\u6b63\u6240\u8c13\uff0c\u5e76\u53d1\u6027\u80fd\u4e0d\u9ad8\uff0c\u673a\u5668\u914d\u7f6e\u6765\u51d1\uff0c\u8fd9\u8fd8\u662f\u6709\u9053\u7406\u7684\u3002</p> <p>\u4f46\u662f\u6b63\u7ecf\u70b9\u6765\u8bf4\uff0c\u6700\u57fa\u672c\u6700\u4e3b\u8981\u7684\u8fd8\u662f\u54b1\u4eec\u5199\u7684 SQL\u3002\u5f53\u7136\u4e86\uff0c\u80fd\u5199\u51fa\u4e00\u624b\u597d SQL\uff0c\u524d\u63d0\u6211\u4eec\u8fd8\u662f\u5f97\u7406\u89e3 MySQL \u5404\u4e2a\u7ec4\u4ef6\u7684\u539f\u7406\uff0c\u719f\u6089\u7d22\u5f15\u7684\u539f\u7406\u3001\u4e8b\u52a1\u539f\u7406\u548c\u9501\u539f\u7406\u7b49\u3002\u5f53\u7136\u4e86\uff0c\u4e4b\u540e\u6211\u4e5f\u4f1a\u5206\u522b\u5bf9\u8fd9\u4e9b\u505a\u51fa\u4e00\u4e2a\u5b66\u4e60\u603b\u7ed3\u5206\u4eab\u51fa\u6765\u3002</p>"},{"location":"advanced/4.InnoDB%E5%86%85%E5%AD%98%E7%BB%93%E6%9E%84%E2%80%94%E2%80%94%E7%BC%93%E5%86%B2%E6%B1%A0/#3-buffer-pool","title":"3\u3001\u751f\u4ea7\u73af\u5883\u4e2d\uff0c\u5982\u4f55\u52a8\u6001\u8c03\u6574 Buffer Pool \u7684\u5927\u5c0f","text":"<p>\u76f8\u4fe1\u57fa\u672c\u6bcf\u4e2a\u516c\u53f8\uff0c\u9879\u76ee\u4e0a\u7ebf\u540e\uff0c\u7528\u6237\u548c\u6d41\u91cf\u4f1a\u4e0d\u65ad\u5730\u589e\u957f\uff0c\u8fd9\u5bf9\u4e8e MySQL \u6765\u8bf4\uff0c\u4f1a\u6709\u4ec0\u4e48\u53d8\u5316\uff1f</p> <p>\u9996\u5148\uff0c\u8bbf\u95ee\u589e\u591a\uff0c\u4e0d\u65ad\u5730\u4ece\u78c1\u76d8\u6587\u4ef6\u4e2d\u7684\u6570\u636e\u9875\u8bfb\u53d6\u6570\u636e\u5230 <code>Buffer Pool</code>\uff0c\u4e5f\u4e0d\u65ad\u5730\u5c06 <code>Buffer Pool</code> \u7684\u810f\u7f13\u5b58\u9875\u5237\u56de\u78c1\u76d8\u6587\u4ef6\u4e2d\u3002\u5f88\u660e\u663e\u7684\uff0c<code>Buffer Pool</code> \u8d8a\u5c0f\uff0c\u8fd9\u4e24\u4e2a\u64cd\u4f5c\u5c31\u4f1a\u8d8a\u9891\u7e41\uff0c\u4f46\u662f\u78c1\u76d8 IO \u64cd\u4f5c\u53c8\u662f\u6bd4\u8f83\u8017\u65f6\u7684\uff0c\u672c\u6765 SQL \u6267\u884c\u53ea\u8981 20 ms\uff0c\u5982\u679c\u78b0\u5de7\u78b0\u5230\u9047\u5230\u7f13\u5b58\u9875\u7528\u5b8c\uff0c\u5c31\u8981\u7ecf\u5386\u4e00\u7cfb\u5217\u7684\u64cd\u4f5c\uff0cSQL \u6700\u540e\u6267\u884c\u5b8c\u53ef\u80fd\u5c31\u8981 200 ms\uff0c\u751a\u81f3\u66f4\u591a\u4e86\u3002</p> <p>\u6240\u4ee5\u6211\u4eec\u6b64\u65f6\u9700\u8981\u53ca\u65f6\u8c03\u6574 <code>Buffer Pool</code> \u7684\u5927\u5c0f\u3002</p>"},{"location":"advanced/4.InnoDB%E5%86%85%E5%AD%98%E7%BB%93%E6%9E%84%E2%80%94%E2%80%94%E7%BC%93%E5%86%B2%E6%B1%A0/#i-buffer-pool","title":"\u2160\u3001\u5982\u4f55\u52a8\u6001\u8c03\u6574 Buffer Pool \u7684\u5927\u5c0f\uff1f","text":"<p>\u4f46\u662f\u751f\u4ea7\u73af\u5883\uff0c\u80af\u5b9a\u4e0d\u80fd\u8ba9\u6211\u4eec\u76f4\u63a5\u4fee\u6539 MySQL \u914d\u7f6e\u7136\u540e\u518d\u91cd\u542f\u5427\uff0c\u8fd9\u4f30\u8ba1\u8981\u9a82\u6b7b\u3002</p> <p>\u5728 MySQL 5.7 \u540e\uff0cMySQL \u5141\u8bb8\u6211\u4eec\u52a8\u6001\u8c03\u6574\u53c2\u6570 <code>innodb_buffer_pool_size</code> \u7684\u503c\u6765\u8c03\u6574 <code>Buffer Pool</code> \u7684\u5927\u5c0f\u4e86\u3002</p> <p>\u5047\u5982\u5c31\u8fd9\u6837\u76f4\u63a5\u8c03\u5927\u4f1a\u5b58\u5728\u5565\u95ee\u9898\uff1f</p> <p>\u5047\u8bbe\u8c03\u6574\u524d\u7684\u914d\u7f6e\uff1aBuffer Pool \u7684\u603b\u5927\u5c0f\u4e3a 8G\uff0c\u4e00\u5171 4 \u4e2a Buffer Pool\uff0c\u6bcf\u4e2a\u5927\u5c0f\u4e3a 2G\u3002</p> <pre><code>[server]\ninnodb_buffer_pool_size = 8589934592\ninnodb_buffer_pool_instances = 4\n</code></pre> <p>\u5047\u8bbe\u7ed9 <code>Buffer Pool</code> \u8c03\u6574\u5230 16 G\uff0c\u5c31\u662f\u8bf4\u53c2\u6570 <code>innodb_buffer_pool_size</code> \u6539\u4e3a 17179869184\u3002</p> <p>\u6b64\u65f6\uff0cMySQL \u4f1a\u4e3a <code>Buffer Pool</code> \u7533\u8bf7\u4e00\u5757\u5927\u5c0f\u4e3a 16G \u7684\u8fde\u7eed\u5185\u5b58\uff0c\u7136\u540e\u5206\u6210 4 \u5757\uff0c\u63a5\u7740\u5c06\u6bcf\u4e00\u4e2a <code>Buffer Pool</code> \u7684\u6570\u636e\u90fd\u590d\u5236\u5230\u5bf9\u5e94\u7684\u5185\u5b58\u5757\u91cc\uff0c\u6700\u540e\u518d\u6e05\u7a7a\u4e4b\u524d\u7684\u5185\u5b58\u533a\u57df\u3002</p> <p>\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\uff0c\u5168\u90e8\u6570\u636e\u8981\u4ece\u4e00\u5757\u5730\u65b9\u590d\u5236\u5230\u53e6\u5916\u4e00\u5757\u5730\u65b9\uff0c\u90a3\u8fd9\u662f\u76f8\u5f53\u8017\u8d39\u65f6\u95f4\u7684\u64cd\u4f5c\uff0c\u6574\u6574 8 \u4e2a G \u7684\u6570\u636e\u8981\u8fdb\u884c\u590d\u5236\u7c98\u8d34\u5462\uff01\u800c\u4e14\uff0c\u5982\u679c\u672c\u6765 <code>Buffer Pool</code> \u662f\u66f4\u5927\u7684\u8bdd\uff0c\u90a3\u5c31\u66f4\u6050\u6016\u4e86\u3002</p>"},{"location":"advanced/4.InnoDB%E5%86%85%E5%AD%98%E7%BB%93%E6%9E%84%E2%80%94%E2%80%94%E7%BC%93%E5%86%B2%E6%B1%A0/#iibuffer-pool-chunk","title":"\u2161\u3001Buffer Pool \u7684 chunk \u673a\u5236","text":"<p>\u4e3a\u4e86\u89e3\u51b3\u4e0a\u9762\u7684\u95ee\u9898\uff0c<code>Buffer Pool</code> \u5f15\u5165\u4e00\u4e2a\u673a\u5236\uff1achunk \u673a\u5236\u3002</p> <ol> <li>\u6bcf\u4e2a <code>Buffer Pool</code> \u5176\u5b9e\u662f\u7531\u591a\u4e2a chunk \u7ec4\u6210\u7684\u3002\u6bcf\u4e2a chunk \u7684\u5927\u5c0f\u7531\u53c2\u6570 <code>innodb_buffer_pool_chunk_size</code> \u63a7\u5236\uff0c\u9ed8\u8ba4\u503c\u662f 128M\u3002</li> <li>\u6bcf\u4e2a chunk \u5c31\u662f\u4e00\u7cfb\u5217\u7684\u63cf\u8ff0\u6570\u636e\u5757\u548c\u5bf9\u5e94\u7684\u7f13\u5b58\u9875\u3002</li> <li>\u6bcf\u4e2a <code>Buffer Pool</code> \u91cc\u7684\u6240\u6709 chunk \u5171\u4eab\u4e00\u5957 free\u3001flush\u3001lru \u94fe\u8868\u3002</li> </ol> <p>\u5f97\u76ca\u4e8e chunk \u673a\u5236\uff0c\u5c31\u80fd\u907f\u514d\u4e86\u4e0a\u9762\u8bf4\u5230\u7684\u95ee\u9898\u3002\u5f53\u6269\u5927 <code>Buffer Pool</code> \u5185\u5b58\u65f6\uff0c\u4e0d\u518d\u9700\u8981\u5168\u90e8\u6570\u636e\u8fdb\u884c\u590d\u5236\u548c\u7c98\u8d34\uff0c\u800c\u662f\u5728\u539f\u672c\u7684\u57fa\u7840\u4e0a\u8fdb\u884c\u589e\u51cf\u5185\u5b58\u3002</p> <p>\u4e0b\u9762\u7ee7\u7eed\u7528\u4e0a\u9762\u7684\u4f8b\u5b50\uff0c\u4ecb\u7ecd\u4e00\u4e0b chunk \u673a\u5236\u4e0b\uff0c<code>Buffer Pool</code> \u662f\u5982\u4f55\u52a8\u6001\u8c03\u6574\u5927\u5c0f\u7684\u3002</p> <p>\u8c03\u6574\u524d <code>Buffer Pool</code> \u7684\u603b\u5927\u5c0f\u4e3a 8G\uff0c\u8c03\u6574\u540e\u7684 <code>Buffer Pool</code> \u5927\u5c0f\u4e3a 16 G\u3002</p> <p>\u7531\u4e8e <code>Buffer Pool</code> \u7684\u5b9e\u4f8b\u6570\u662f\u4e0d\u53ef\u4ee5\u53d8\u7684\uff0c\u6240\u4ee5\u662f\u6bcf\u4e2a <code>Buffer Pool</code> \u589e\u52a0 2G \u7684\u5927\u5c0f\uff0c\u6b64\u65f6\u53ea\u8981\u7ed9\u6bcf\u4e2a <code>Buffer Pool</code> \u7533\u8bf7 \uff082000M/128M\uff09\u4e2a chunk \u5c31\u884c\u4e86\uff0c\u4f46\u662f\u8981\u6ce8\u610f\u7684\u662f\uff0c\u65b0\u589e\u7684\u6bcf\u4e2a chunk \u90fd\u662f\u8fde\u7eed\u7684 128M \u5185\u5b58\u3002</p>"},{"location":"advanced/4.InnoDB%E5%86%85%E5%AD%98%E7%BB%93%E6%9E%84%E2%80%94%E2%80%94%E7%BC%93%E5%86%B2%E6%B1%A0/#4-buffer-pool","title":"4\u3001\u751f\u4ea7\u73af\u5883\u4e2d\uff0c\u5e94\u8be5\u7ed9 Buffer Pool \u8bbe\u7f6e\u591a\u5927\u7684\u5185\u5b58","text":""},{"location":"advanced/4.InnoDB%E5%86%85%E5%AD%98%E7%BB%93%E6%9E%84%E2%80%94%E2%80%94%E7%BC%93%E5%86%B2%E6%B1%A0/#i-buffer-pool_1","title":"\u2160\u3001\u5982\u4f55\u8bbe\u7f6e Buffer Pool \u7684\u603b\u5185\u5b58\u5927\u5c0f","text":"<p>\u6211\u4eec\u90fd\u77e5\u9053\uff0c\u7ed9 Buffer Pool \u5206\u914d\u8d8a\u5927\u7684\u5185\u5b58\uff0cMySQL \u7684\u5e76\u53d1\u6027\u80fd\u5c31\u8d8a\u597d\u3002\u90a3\u662f\u4e0d\u662f\u90fd\u5e94\u8be5\u5c06\u767e\u5206\u4e4b\u4e5d\u5341\u4e5d\u7684\u673a\u5668\u7684\u5185\u5b58\u90fd\u5206\u914d\u7ed9 Buffe Pool \u5462\uff1f</p> <p>\u90a3\u5f53\u7136\u4e0d\u662f\u4e86\uff01</p> <p>\u5148\u4e0d\u8bf4\u64cd\u4f5c\u7cfb\u7edf\u5185\u6838\u4e5f\u9700\u8981\u51e0\u4e2a G \u5185\u5b58\uff0cMySQL \u9664\u4e86 Buffer Pool \u8fd8\u6709\u5f88\u591a\u522b\u7684\u5185\u5b58\u6570\u636e\u7ed3\u6784\u5462\uff0c\u8fd9\u4e9b\u90fd\u662f\u9700\u8981\u5185\u5b58\u7684\uff0c\u6240\u4ee5\u8bf4\uff0c\u4e0a\u9762\u7684\u60f3\u6cd5\u662f\u7edd\u5bf9\u4e0d\u884c\u7684\uff01</p> <p>\u6bd4\u8f83\u5408\u7406\u7684\u6bd4\u4f8b\uff0c\u5e94\u8be5\u662f Buffer Pool \u7684\u5185\u5b58\u5927\u5c0f\u5360\u673a\u5668\u603b\u5185\u5b58\u7684 50% ~ 60%\uff0c\u4f8b\u5982\u673a\u5668\u7684\u603b\u5185\u5b58\u6709 32G\uff0c\u90a3\u4e48\u4f60\u7ed9 Buffer Pool \u5206\u914d\u4e2a 20G \u5de6\u53f3\u5c31\u633a\u5408\u7406\u7684\u4e86\u3002</p>"},{"location":"advanced/4.InnoDB%E5%86%85%E5%AD%98%E7%BB%93%E6%9E%84%E2%80%94%E2%80%94%E7%BC%93%E5%86%B2%E6%B1%A0/#ii-buffer-pool","title":"\u2161\u3001\u5982\u4f55\u8bbe\u7f6e Buffer Pool \u7684\u5b9e\u4f8b\u6570","text":"<p>Buffer Pool \u7684\u603b\u5927\u5c0f\u641e\u5b9a\u4e86\uff0c\u90a3\u5e94\u8be5\u8bbe\u7f6e\u591a\u5c11\u4e2a\u5b9e\u4f8b\u6570\u5462\uff1f</p> <p>\u8fd9\u91cc\u6709\u4e00\u4e2a\u516c\u5f0f\uff1aBuffer Pool \u603b\u5927\u5c0f = \uff08chunk \u5927\u5c0f * Buffer Pool \u6570\u91cf\uff09* n \u500d\u3002</p> <p>\u4e0a\u4e2a\u4f8b\u5b50\u89e3\u91ca\u4e00\u4e0b\u3002</p> <p>\u5047\u8bbe\u6b64\u65f6 Buffer Pool \u7684\u603b\u5927\u5c0f\u4e3a 8G\uff0c\u5373 8192M\uff0c\u90a3\u4e48 Buffer Pool \u7684\u6570\u91cf\u5e94\u8be5\u662f\u591a\u5c11\u4e2a\u5462\uff1f</p> <p>8192 = \uff08 128 _ Buffer Pool \u6570\u91cf\uff09_ n</p> <p>64 \u4e2a\uff1a\u4e5f\u662f\u53ef\u4ee5\u7684\uff0c\u4f46\u662f\u6bcf\u4e2a Buffer Pool \u5c31\u53ea\u8981\u4e00\u4e2a chunk\u3002</p> <p>16 \u4e2a\uff1a\u4e5f\u662f\u53ef\u4ee5\u7684\uff0c\u6bcf\u4e2a Buffer Pool \u62e5\u6709\u56db\u4e2a chunk\u3002</p> <p>8 \u4e2a\uff1a\u4e5f\u662f\u53ef\u4ee5\u7684\uff0c\u6bcf\u4e2a Buffer Pool \u62e5\u6709\u516b\u4e2a chunk\u3002</p> <p>\u6240\u4ee5\u8bf4\uff0c\u53ea\u8981\u4f60\u7684 Buffer Pool \u6570\u91cf\u7b26\u5408\u4e0a\u9762\u7684\u516c\u5f0f\uff0c\u5176\u5b9e\u90fd\u662f\u53ef\u4ee5\u7684\uff0c\u770b\u4f60\u4eec\u6839\u636e\u4e1a\u52a1\u540e\u600e\u4e48\u9009\u62e9\u4e86\u3002</p>"},{"location":"advanced/4.InnoDB%E5%86%85%E5%AD%98%E7%BB%93%E6%9E%84%E2%80%94%E2%80%94%E7%BC%93%E5%86%B2%E6%B1%A0/#buffer-pool_2","title":"Buffer Pool \u7684\u521d\u59cb\u5316","text":"<p>\u5230\u6b64\uff0c\u6211\u4eec\u90fd\u77e5\u9053\u4e86\uff0c<code>Buffer Pool</code> \u662f\u7f13\u5b58\u6570\u636e\u7684\u6570\u636e\u5355\u4f4d\u4e3a\u7f13\u5b58\u9875\uff0c\u5229\u7528\u63cf\u8ff0\u6570\u636e\u5757\u6765\u6807\u8bc6\u7f13\u5b58\u9875\u3002</p> <p>\u90a3\u4e48\uff0cMySQL \u542f\u52a8\u65f6\uff0c\u662f\u5982\u4f55\u521d\u59cb\u5316 <code>Buffer Pool</code> \u7684\u5462\uff1f</p> <ol> <li> <p>MySQL \u542f\u52a8\u65f6\uff0c\u4f1a\u6839\u636e\u53c2\u6570 <code>innodb_buffer_pool_size</code> \u7684\u503c\u6765\u4e3a <code>Buffer Pool</code> \u5206\u914d\u5185\u5b58\u533a\u57df\u3002</p> </li> <li> <p>\u7136\u540e\u4f1a\u6309\u7167\u7f13\u5b58\u9875\u7684\u9ed8\u8ba4\u5927\u5c0f 16k \u4ee5\u53ca\u5bf9\u5e94\u7684\u63cf\u8ff0\u6570\u636e\u5757\u7684 800 \u4e2a\u5b57\u8282 \u5de6\u53f3\u5927\u5c0f\uff0c\u5728 <code>Buffer Pool</code> \u4e2d\u5212\u5206\u4e2d\u4e00\u4e2a\u4e2a\u7684\u7f13\u5b58\u9875\u548c\u4e00\u4e2a\u4e2a\u7684\u63cf\u8ff0\u6570\u636e\u5e93\u5757\u3002</p> </li> <li> <p>\u6ce8\u610f\uff0c\u6b64\u65f6\u7684\u7f13\u5b58\u9875\u548c\u63cf\u8ff0\u6570\u636e\u5757\u90fd\u662f\u7a7a\u7684\uff0c\u6bd5\u7adf\u624d\u521a\u542f\u52a8 MySQL \u5462\u3002</p> </li> </ol>"},{"location":"advanced/4.InnoDB%E5%86%85%E5%AD%98%E7%BB%93%E6%9E%84%E2%80%94%E2%80%94%E7%BC%93%E5%86%B2%E6%B1%A0/#doublewrite","title":"doublewrite \u7279\u6027","text":"<p>\u4ecb\u7ecd double write \u4e4b\u524d\u6211\u4eec\u6709\u5fc5\u8981\u4e86\u89e3<code>partial page write</code>\uff08\u90e8\u5206\u9875\u5931\u6548\uff09\u95ee\u9898\u3002</p> <p>InnoDB \u7684 <code>Page Size</code> \u4e00\u822c\u662f 16KB\uff0c\u5176\u6570\u636e\u6821\u9a8c\u4e5f\u662f\u9488\u5bf9\u8fd9 16KB \u6765\u8ba1\u7b97\u7684\u3002\u5c06\u6570\u636e\u5199\u5165\u5230\u78c1\u76d8\u662f\u4ee5 Page \u4e3a\u5355\u4f4d\u8fdb\u884c\u64cd\u4f5c\u7684\u3002\u6211\u4eec\u77e5\u9053\uff0c\u7531\u4e8e\u6587\u4ef6\u7cfb\u7edf\u5bf9\u4e00\u6b21\u5927\u6570\u636e\u9875\uff08\u4f8b\u5982 InnoDB \u7684 16KB\uff09\u5927\u591a\u6570\u60c5\u51b5\u4e0b\u4e0d\u662f\u539f\u5b50\u64cd\u4f5c\uff0c\u8fd9\u610f\u5473\u7740\u5982\u679c\u670d\u52a1\u5668\u5b95\u673a\u4e86\uff0c\u53ef\u80fd\u53ea\u505a\u4e86\u90e8\u5206\u5199\u5165\u3002\u5047\u5982 16K \u7684\u6570\u636e\uff0c\u5199\u5165 4K \u65f6\uff0c\u53d1\u751f\u4e86\u7cfb\u7edf\u65ad\u7535/os crash \uff0c\u53ea\u6709\u4e00\u90e8\u5206\u5199\u662f\u6210\u529f\u7684\uff0c\u8fd9\u79cd\u60c5\u51b5\u4e0b\u5c31\u662f partial page write \u95ee\u9898\u3002</p> <p>\u6709\u7ecf\u9a8c\u7684 DBA \u53ef\u80fd\u4f1a\u60f3\u5230\uff0c\u5982\u679c\u53d1\u751f\u5199\u5931\u6548\uff0cMySQL \u53ef\u4ee5\u6839\u636e <code>redo log</code> \u8fdb\u884c\u6062\u590d\u3002\u8fd9\u662f\u4e00\u4e2a\u529e\u6cd5\uff0c\u4f46\u662f\u5fc5\u987b\u6e05\u695a\u5730\u8ba4\u8bc6\u5230\uff0c<code>redo log</code> \u4e2d\u8bb0\u5f55\u7684\u662f\u5bf9\u9875\u7684\u7269\u7406\u4fee\u6539\uff08redo \u7684\u6700\u5c0f\u539f\u5b50\u5355\u4f4d\u662f\u6570\u636e\u5e93\u4e2d\u7684\u9875\u8fd9\u4e2a\u6982\u5ff5\uff09\u3002\u5982\u504f\u79fb\u91cf 800\uff0c\u5199\"aaaa\"\u8bb0\u5f55\u3002\u5982\u679c\u8fd9\u4e2a\u9875\u672c\u8eab\u5df2\u7ecf\u53d1\u751f\u4e86\u635f\u574f\uff0c\u518d\u5bf9\u5176\u8fdb\u884c\u91cd\u505a\u662f\u6ca1\u6709\u610f\u4e49\u7684\u3002MySQL \u5728\u6062\u590d\u7684\u8fc7\u7a0b\u4e2d\u68c0\u67e5 page \u7684 checksum\uff0cchecksum \u5c31\u662f\u68c0\u67e5 page \u7684\u6700\u540e\u4e8b\u52a1\u53f7\uff0c\u53d1\u751f <code>partial page write</code> \u95ee\u9898\u65f6\uff0cpage \u5df2\u7ecf\u635f\u574f\uff0c\u627e\u4e0d\u5230\u8be5 page \u4e2d\u7684\u4e8b\u52a1\u53f7\u3002\u5728 InnoDB \u770b\u6765\uff0c\u8fd9\u6837\u7684\u6570\u636e\u9875\u662f\u65e0\u6cd5\u901a\u8fc7 checksum \u9a8c\u8bc1\u7684\uff0c\u5c31\u65e0\u6cd5\u6062\u590d\u3002\u5373\u65f6\u6211\u4eec\u5f3a\u5236\u8ba9\u5176\u901a\u8fc7\u9a8c\u8bc1\uff0c\u4e5f\u65e0\u6cd5\u4ece\u5d29\u6e83\u4e2d\u6062\u590d\uff0c\u56e0\u4e3a\u5f53\u524d InnoDB \u5b58\u5728\u7684\u4e00\u4e9b\u65e5\u5fd7\u7c7b\u578b\uff0c\u6709\u4e9b\u662f\u903b\u8f91\u64cd\u4f5c\uff0c\u5e76\u4e0d\u80fd\u505a\u5230\u5e42\u7b49\u3002</p> <p>\u4e3a\u4e86\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\uff0cInnoDB \u5b9e\u73b0\u4e86 <code>double write buffer</code>\uff0c\u7b80\u5355\u6765\u8bf4\uff0c\u5c31\u662f\u5728\u5199\u6570\u636e\u9875\u4e4b\u524d\uff0c\u5148\u628a\u8fd9\u4e2a\u6570\u636e\u9875\u5199\u5230\u4e00\u5757\u72ec\u7acb\u7684\u7269\u7406\u6587\u4ef6\u4f4d\u7f6e\uff08ibdata \u6587\u4ef6\uff0c\u5728 8.0.20 \u4e4b\u540e\uff0cdoublewrite buufer \u4e5f\u5b58\u5728\u5355\u72ec\u7684\u6587\u4ef6\u4e2d\u4e86\uff09\u3002\u7136\u540e\u518d\u5199\u5230\u6570\u636e\u9875\u3002\u8fd9\u6837\u5728\u5b95\u673a\u91cd\u542f\u65f6\uff0c\u5982\u679c\u51fa\u73b0\u6570\u636e\u9875\u635f\u574f\uff0c\u90a3\u4e48\u5728\u5e94\u7528 <code>redo log</code> \u4e4b\u524d\uff0c\u9700\u8981\u901a\u8fc7\u8be5\u9875\u7684\u526f\u672c\u6765\u8fd8\u539f\u8be5\u9875\uff0c\u7136\u540e\u518d\u8fdb\u884c <code>redo log</code> \u91cd\u505a\uff0c\u8fd9\u5c31\u662f double write\u3002double write \u6280\u672f\u5e26\u7ed9 innodb \u5b58\u50a8\u5f15\u64ce\u7684\u662f\u6570\u636e\u9875\u7684\u53ef\u9760\u6027\u3002</p> <p>\u53c2\u8003</p>"},{"location":"advanced/4.InnoDB%E5%86%85%E5%AD%98%E7%BB%93%E6%9E%84%E2%80%94%E2%80%94%E7%BC%93%E5%86%B2%E6%B1%A0/#lru-list_1","title":"LRU list","text":""},{"location":"advanced/4.InnoDB%E5%86%85%E5%AD%98%E7%BB%93%E6%9E%84%E2%80%94%E2%80%94%E7%BC%93%E5%86%B2%E6%B1%A0/#lru_2","title":"\u4f20\u7edf\u7684 LRU","text":"<p>\u6309\u7167\u82f1\u6587\u7684\u76f4\u63a5\u539f\u4e49\u5c31\u662f Least Recently Used,\u6700\u8fd1\u6700\u4e45\u672a\u4f7f\u7528\u3002</p>"},{"location":"advanced/4.InnoDB%E5%86%85%E5%AD%98%E7%BB%93%E6%9E%84%E2%80%94%E2%80%94%E7%BC%93%E5%86%B2%E6%B1%A0/#_30","title":"\u7531\u6765","text":"<p>\u5b83\u662f\u6309\u7167\u4e00\u4e2a\u975e\u5e38\u8457\u540d\u7684\u8ba1\u7b97\u673a\u64cd\u4f5c\u7cfb\u7edf\u57fa\u7840\u7406\u8bba\u5f97\u6765\u7684\uff1a\u6700\u8fd1\u4f7f\u7528\u7684\u9875\u9762\u6570\u636e\u4f1a\u5728\u672a\u6765\u4e00\u6bb5\u65f6\u671f\u5185\u4ecd\u7136\u88ab\u4f7f\u7528,\u5df2\u7ecf\u5f88\u4e45\u6ca1\u6709\u4f7f\u7528\u7684\u9875\u9762\u5f88\u6709\u53ef\u80fd\u5728\u672a\u6765\u8f83\u957f\u7684\u4e00\u6bb5\u65f6\u95f4\u5185\u4ecd\u7136\u4e0d\u4f1a\u88ab\u4f7f\u7528\u3002\u57fa\u4e8e\u8fd9\u4e2a\u601d\u60f3,\u4f1a\u5b58\u5728\u4e00\u79cd\u7f13\u5b58\u6dd8\u6c70\u673a\u5236\uff0c\u6bcf\u6b21\u4ece\u5185\u5b58\u4e2d\u627e\u5230**\u6700\u4e45\u672a\u4f7f\u7528\u7684\u6570\u636e\u7136\u540e\u7f6e\u6362\u51fa\u6765**\uff0c\u4ece\u800c\u5b58\u5165\u65b0\u7684\u6570\u636e\uff01</p>"},{"location":"advanced/4.InnoDB%E5%86%85%E5%AD%98%E7%BB%93%E6%9E%84%E2%80%94%E2%80%94%E7%BC%93%E5%86%B2%E6%B1%A0/#_31","title":"\u4f5c\u7528","text":"<p>\u5b83\u7684\u4e3b\u8981\u8861\u91cf\u6307\u6807\u662f**\u4f7f\u7528\u7684\u65f6\u95f4**\uff0c</p> <p>(\u9644\u52a0\u6307\u6807\u662f**\u4f7f\u7528\u7684\u6b21\u6570**)</p> <p>\u5728\u8ba1\u7b97\u673a\u4e2d\u5927\u91cf\u4f7f\u7528\u4e86\u8fd9\u4e2a\u673a\u5236\uff0c\u5b83\u7684\u5408\u7406\u6027\u5728\u4e8e**\u4f18\u5148\u7b5b\u9009\u70ed\u70b9\u6570\u636e**\uff0c\u6240\u8c13\u70ed\u70b9\u6570\u636e\uff0c\u5c31\u662f**\u6700\u8fd1\u6700\u591a\u4f7f\u7528\u7684\u6570\u636e**\uff01</p>"},{"location":"advanced/4.InnoDB%E5%86%85%E5%AD%98%E7%BB%93%E6%9E%84%E2%80%94%E2%80%94%E7%BC%93%E5%86%B2%E6%B1%A0/#_32","title":"\u7279\u5f81","text":"<ul> <li>\u6700\u65b0\u7684\u6570\u636e\u4f1a\u63d2\u5165\u5bf9\u5217\u524d\u9762</li> <li>\u8bbf\u95ee\u5217\u8868\u4e2d\u65e7\u7684\u6570\u636e\uff0c\u4f1a\u4f7f\u5b83\u91cd\u65b0\u7f6e\u4e8e\u5217\u8868\u9876\u90e8</li> </ul>"},{"location":"advanced/4.InnoDB%E5%86%85%E5%AD%98%E7%BB%93%E6%9E%84%E2%80%94%E2%80%94%E7%BC%93%E5%86%B2%E6%B1%A0/#innodb-lru","title":"InnoDB \u4e2d\u7684 LRU","text":"<p>\u7f13\u51b2\u6c60\u4e2d\uff0c\u9875\u7684\u5927\u5c0f\u4e5f\u662f 16KB</p>"},{"location":"advanced/4.InnoDB%E5%86%85%E5%AD%98%E7%BB%93%E6%9E%84%E2%80%94%E2%80%94%E7%BC%93%E5%86%B2%E6%B1%A0/#lru_3","title":"\u4e0e\u4f20\u7edf LRU \u7279\u6b8a\u7684\u5730\u65b9","text":"<p>\u65b0\u589e\u4e86 midPoint \u4f4d\u7f6e\u3002\u65b0\u8bfb\u53d6\u5230\u7684\u9875\u5e76\u6ca1\u6709\u76f4\u63a5\u653e\u5728 LRU \u5217\u7684\u9996\u90e8\uff0c\u800c\u662f\u653e\u5728\u8ddd\u79bb\u5c3e\u90e8 37%\u7684\u4f4d\u7f6e\u3002\u8fd9\u4e2a\u7b97\u6cd5\u79f0\u4e4b\u4e3a**midpoint insertion stategy**\u3002</p> <ul> <li> <p>\u5373 midPoint \u5728\u6574\u4f53\u5217\u8868\u7684 \u215d \u5904</p> </li> <li> <p>midpoint \u4e4b\u524d\u7684\u662f new \u533a\u57df\uff08\u70ed\u6570\u636e\uff09</p> </li> <li> <p>midpoint \u4e4b\u540e\u7684\u6570\u636e\u662f\u4e0d\u6d3b\u8dc3\u6570\u636e\uff0cold \u533a\u57df\u3002</p> </li> <li>midpoint \u5904\uff0c\u662f\u65b0\u5b50\u5217\u8868\u7684\u5c3e\u90e8\u4e0e\u65e7\u5b50\u5217\u8868\u7684\u5934\u76f8\u4ea4\u7684\u8fb9\u754c</li> <li>\u5f53 InnoDB \u5c06\u9875\u9762\u8bfb\u5165\u7f13\u51b2\u6c60\u65f6\uff0c\u5b83\u9996\u5148\u5c06\u5176\u63d2\u5165\u4e2d\u70b9(\u65e7\u5b50\u5217\u8868\u7684\u5934\u90e8)\u3002\u56e0\u4e3a\u5b83\u662f\u7528\u6237\u53d1\u8d77\u7684\u64cd\u4f5c(\u5982 SQL \u67e5\u8be2)\u6240\u9700\u7684\uff0c\u6216\u8005\u662f InnoDB \u81ea\u52a8\u6267\u884c\u7684\u9884\u8bfb\u64cd\u4f5c\u7684\u4e00\u90e8\u5206\uff0c\u6240\u4ee5\u8fd9\u4e9b\u9875\u9762\u53ef\u4ee5\u88ab\u8bfb\u53d6\u3002</li> <li>\u8bbf\u95ee\u65e7\u5b50\u5217\u8868\u4e2d\u7684\u9875\u9762\u4f1a\u4f7f\u5176\u53d8\u5f97\u201c\u5e74\u8f7b\u201d\uff0c\u5e76\u5c06\u5176\u79fb\u52a8\u5230\u65b0\u5b50\u5217\u8868\u7684\u5934\u90e8\u3002\u5982\u679c\u7531\u4e8e\u7528\u6237\u542f\u52a8\u7684\u64cd\u4f5c\u9700\u8981\u8be5\u9875\u800c\u8bfb\u53d6\u8be5\u9875\uff0c\u5219\u4f1a\u7acb\u5373\u8fdb\u884c\u7b2c\u4e00\u6b21\u8bbf\u95ee\uff0c\u5e76\u4f7f\u8be5\u9875\u53d8\u5f97\u5e74\u8f7b\u3002\u5982\u679c\u8be5\u9875\u662f\u7531\u4e8e\u9884\u8bfb\u64cd\u4f5c\u800c\u88ab\u8bfb\u53d6\u7684\uff0c\u5219\u7b2c\u4e00\u6b21\u8bbf\u95ee\u4e0d\u4f1a\u7acb\u5373\u53d1\u751f\uff0c\u5e76\u4e14\u5728\u8be5\u9875\u88ab\u9010\u51fa\u4e4b\u524d\u53ef\u80fd\u6839\u672c\u4e0d\u4f1a\u53d1\u751f\u3002</li> <li>\u5f53\u6570\u636e\u5e93\u8fd0\u884c\u65f6\uff0c\u7f13\u51b2\u6c60\u4e2d\u672a\u88ab\u8bbf\u95ee\u7684\u9875\u901a\u8fc7\u5411\u5217\u8868\u7684\u5c3e\u90e8\u79fb\u52a8\u6765\u201c\u8001\u5316\u201d\u3002\u65b0\u5b50\u5217\u8868\u548c\u65e7\u5b50\u5217\u8868\u4e2d\u7684\u9875\u9762\u90fd\u4f1a\u968f\u7740\u5176\u4ed6\u9875\u9762\u53d8\u4e3a\u65b0\u9875\u9762\u800c\u8001\u5316\u3002\u65e7\u5b50\u5217\u8868\u4e2d\u7684\u9875\u9762\u4e5f\u4f1a\u968f\u7740\u9875\u9762\u63d2\u5165\u5230\u4e2d\u70b9\u5904\u800c\u8001\u5316\u3002\u6700\u7ec8\uff0c\u672a\u4f7f\u7528\u7684\u9875\u9762\u5230\u8fbe\u65e7\u5b50\u5217\u8868\u7684\u5c3e\u90e8\u5e76\u88ab\u9010\u51fa\u3002</li> </ul> <p></p>"},{"location":"advanced/4.InnoDB%E5%86%85%E5%AD%98%E7%BB%93%E6%9E%84%E2%80%94%E2%80%94%E7%BC%93%E5%86%B2%E6%B1%A0/#midpoint","title":"\u67e5\u770b midpoint","text":"<pre><code>mysql&gt; show variables like 'innodb_old_blocks_pct';\n+-----------------------+-------+\n| Variable_name         | Value |\n+-----------------------+-------+\n| innodb_old_blocks_pct | 37    |\n+-----------------------+-------+\n1 row in set (0.04 sec)\n</code></pre> <ul> <li>37\uff1a\u672b\u5c3e\u5904\u7684 37%\u7684\u4f4d\u7f6e\uff0c\u5373\u672b\u5c3e \u215c \u7684\u4f4d\u7f6e</li> </ul>"},{"location":"advanced/4.InnoDB%E5%86%85%E5%AD%98%E7%BB%93%E6%9E%84%E2%80%94%E2%80%94%E7%BC%93%E5%86%B2%E6%B1%A0/#_33","title":"\u4e3a\u4ec0\u4e48\u4e0d\u628a\u6700\u65b0\u67e5\u5230\u7684\u6570\u636e\u653e\u5230\u9996\u90e8","text":"<p>\u4f8b\u5982**\u7d22\u5f15\u626b\u63cf**\u6216**\u6570\u636e\u626b\u63cf** / \u5168\u8868\u626b\u63cf\uff0c\u4f1a\u4f7f\u5927\u91cf\u7684\u7f13\u51b2\u6c60\u4e2d\u5927\u91cf\u7684\u9875\u88ab\u5237\u65b0\u51fa\u53bb\u3002\u7136\u800c\u88ab\u626b\u63cf\u5230\u7684\u6570\u636e\u9875\u53ea\u662f\u672c\u6b21\u64cd\u4f5c\u6240\u9700\u8981\u7684\uff0c\u5e76\u975e\u70ed\u70b9\u6570\u636e\u3002\u800c\u771f\u6b63\u7684\u70ed\u70b9\u6570\u636e\u8fd8\u662f\u4ece\u78c1\u76d8\u8bfb\u53d6\uff0c\u5f71\u54cd\u4e86\u7f13\u51b2\u6c60\u6548\u7387\u3002</p> <p>MySQL \u4e3a\u4e86\u63d0\u9ad8\u6027\u80fd\uff0c\u63d0\u4f9b\u4e86\u4e00\u4e2a\u673a\u5236\uff1a\u9884\u8bfb\u673a\u5236\u3002</p> <p>\u5f53\u4f60\u4ece\u78c1\u76d8\u4e0a\u52a0\u8f7d\u4e00\u4e2a\u6570\u636e\u9875\u7684\u65f6\u5019\uff0c\u4ed6\u53ef\u80fd\u4f1a\u8fde\u5e26\u7740\u628a\u8fd9\u4e2a\u6570\u636e\u9875\u76f8\u90bb\u7684\u5176\u4ed6\u6570\u636e\u9875\uff0c\u4e5f\u52a0\u8f7d\u5230\u7f13\u5b58\u91cc\u53bb\u3002\u8fd9\u4e2a\u673a\u5236\u4f1a\u5e26\u6765\u8fd9\u4e48\u4e00\u4e2a\u95ee\u9898\uff1a\u8fde\u5e26\u7684\u6570\u636e\u9875\u53ef\u80fd\u5728\u540e\u9762\u7684\u67e5\u8be2\u6216\u8005\u4fee\u6539\u4e2d\uff0c\u5e76\u4e0d\u4f1a\u7528\u5230\uff0c\u4f46\u662f\u5b83\u4eec\u5374\u5728 lru \u94fe\u8868\u7684\u5934\u90e8\u3002</p> <p>\u82e5\u8fd8\u672a\u7406\u89e3\uff0c\u53ef\u53c2\u9605\u5b98\u65b9\u6587\u6863\uff1a\u9632\u6b62\u7f13\u51b2\u6c60\u626b\u63cf</p>"},{"location":"advanced/4.InnoDB%E5%86%85%E5%AD%98%E7%BB%93%E6%9E%84%E2%80%94%E2%80%94%E7%BC%93%E5%86%B2%E6%B1%A0/#_34","title":"\u7f13\u51b2\u6c60\u53ef\u8c03\u6574\u7684\u914d\u7f6e","text":"<ul> <li> <p>\u7406\u60f3\u60c5\u51b5\u4e0b\uff0c\u60a8\u53ef\u4ee5\u5c06\u7f13\u51b2\u6c60\u7684\u5927\u5c0f\u8bbe\u7f6e\u4e3a\u5c3d\u53ef\u80fd\u5927\u7684\u503c\uff0c\u4ece\u800c\u4e3a\u670d\u52a1\u5668\u4e0a\u7684\u5176\u4ed6\u8fdb\u7a0b\u7559\u51fa\u8db3\u591f\u7684\u5185\u5b58\u6765\u8fd0\u884c\uff0c\u800c\u4e0d\u9700\u8981\u8fc7\u591a\u7684\u5206\u9875\u3002\u7f13\u51b2\u6c60\u8d8a\u5927\uff0cInnoDB \u5c31\u8d8a\u50cf\u5185\u5b58\u4e2d\u7684\u6570\u636e\u5e93\uff0c\u4ece\u78c1\u76d8\u8bfb\u53d6\u6570\u636e\u4e00\u6b21\uff0c\u7136\u540e\u5728\u540e\u7eed\u8bfb\u53d6\u671f\u95f4\u8bbf\u95ee\u5185\u5b58\u4e2d\u7684\u6570\u636e\u3002\u4f46\u5e76\u4e0d\u662f\u8d8a\u5927\u8d8a\u597d</p> </li> <li> <p>\u5728\u5177\u6709\u8db3\u591f\u5185\u5b58\u7684 64 \u4f4d\u7cfb\u7edf\u4e0a\uff0c\u60a8\u53ef\u4ee5\u5c06\u7f13\u51b2\u6c60\u62c6\u5206\u4e3a\u591a\u4e2a\u90e8\u5206\uff0c\u4ee5\u6700\u5927\u9650\u5ea6\u5730\u51cf\u5c11\u5e76\u53d1\u64cd\u4f5c\u4e4b\u95f4\u5bf9\u5185\u5b58\u7ed3\u6784\u7684\u4e89\u7528\u3002\u5373\u589e\u52a0\u7f13\u51b2\u6c60\u5b9e\u4f8b</p> </li> <li> <p>\u60a8\u53ef\u4ee5\u5c06\u9891\u7e41\u8bbf\u95ee\u7684\u6570\u636e\u4fdd\u7559\u5728\u5185\u5b58\u4e2d\uff0c\u800c\u4e0d\u8003\u8651\u4f1a\u5c06\u5927\u91cf\u4e0d\u7ecf\u5e38\u8bbf\u95ee\u7684\u6570\u636e\u5f15\u5165\u7f13\u51b2\u6c60\u7684\u64cd\u4f5c\u7684\u7a81\u7136\u6d3b\u52a8\u9ad8\u5cf0\u3002\u53ef\u4ee5\u8c03\u6574 midpoint \u7684\u4f4d\u7f6e\u3002</p> </li> <li> <p>\u60a8\u53ef\u4ee5\u63a7\u5236\u5982\u4f55\u4ee5\u53ca\u4f55\u65f6\u6267\u884c\u9884\u8bfb\u8bf7\u6c42\uff0c\u4ee5\u4fbf\u5728\u9884\u671f\u5f88\u5feb\u9700\u8981\u9875\u9762\u7684\u60c5\u51b5\u4e0b\u5c06\u9875\u9762\u5f02\u6b65\u9884\u53d6\u5230\u7f13\u51b2\u6c60\u4e2d\u3002</p> </li> <li> <p>\u60a8\u53ef\u4ee5\u63a7\u5236\u4f55\u65f6\u53d1\u751f\u540e\u53f0\u5237\u65b0\uff0c\u4ee5\u53ca\u662f\u5426\u6839\u636e\u5de5\u4f5c\u8d1f\u8f7d\u52a8\u6001\u8c03\u6574\u5237\u65b0\u901f\u7387</p> </li> <li> <p>\u60a8\u53ef\u4ee5\u914d\u7f6e InnoDB \u5982\u4f55\u4fdd\u7559\u5f53\u524d\u7684\u7f13\u51b2\u6c60\u72b6\u6001\uff0c\u4ee5\u907f\u514d\u670d\u52a1\u5668\u91cd\u542f\u540e\u8fc7\u957f\u7684\u9884\u70ed\u671f</p> </li> <li> <p>\u63a7\u5236\u6700\u65b0\u6570\u636e\u9875\u653e\u5230\u70ed\u70b9\u533a\u57df\u7684\u65f6\u95f4\uff0c\u8fbe\u5230\u8fd9\u4e2a\u65f6\u95f4\u540e\uff0c\u5c31\u53ef\u4ee5\u628a\u6570\u636e\u653e\u5230\u70ed\u70b9\u533a\u57df\u3002</p> </li> </ul> <pre><code>mysql&gt; show variables like 'innodb_old_blocks_time';\n+------------------------+-------+\n| Variable_name          | Value |\n+------------------------+-------+\n| innodb_old_blocks_time | 1000  |\n+------------------------+-------+\n1 row in set (0.04 sec)\n</code></pre> <ul> <li>\u6570\u636e\u4ece old \u8f6c\u5230 new\uff0c\u6b64\u64cd\u4f5c\u79f0\u4e3a page made young</li> <li>\u6570\u636e\u672a\u4ece old \u8f6c\u5230 new\uff0c\u6b64\u64cd\u4f5c\u79f0\u4e3a page not made young</li> </ul>"},{"location":"advanced/4.InnoDB%E5%86%85%E5%AD%98%E7%BB%93%E6%9E%84%E2%80%94%E2%80%94%E7%BC%93%E5%86%B2%E6%B1%A0/#innodb_3","title":"\u4f7f\u7528 InnoDB \u6807\u51c6\u76d1\u89c6\u5668\u76d1\u89c6\u7f13\u51b2\u6c60","text":"<p><code>InnoDB</code>\u53ef\u4ee5\u4f7f\u7528\u8bbf\u95ee\u7684\u6807\u51c6\u76d1\u89c6\u5668\u8f93\u51fa\uff0c <code>SHOW ENGINE INNODB STATUS</code>\u63d0\u4f9b\u6709\u5173\u7f13\u51b2\u6c60\u64cd\u4f5c\u7684\u5ea6\u91cf\u3002\u7f13\u51b2\u6c60\u5ea6\u91cf\u6807\u51c6\u4f4d\u4e8e<code>BUFFER POOL AND MEMORY</code>\u201c <code>InnoDB</code>\u6807\u51c6\u76d1\u89c6\u5668\u201d\u8f93\u51fa\u4e2d\u7684\u90e8\u5206\uff0c\u5176\u8f93\u51fa\u7c7b\u4f3c\u4e8e\u4ee5\u4e0b\u5185\u5bb9\uff1a</p> <pre><code>----------------------\nBUFFER POOL AND MEMORY\n----------------------\nTotal large memory allocated 2198863872\nDictionary memory allocated 776332\nBuffer pool size   131072\nFree buffers       124908\nDatabase pages     5720\nOld database pages 2071\nModified db pages  910\nPending reads 0\nPending writes: LRU 0, flush list 0, single page 0\nPages made young 4, not young 0\n0.10 youngs/s, 0.00 non-youngs/s\nPages read 197, created 5523, written 5060\n0.00 reads/s, 190.89 creates/s, 244.94 writes/s\nBuffer pool hit rate 1000 / 1000, young-making rate 0 / 1000 not\n0 / 1000\nPages read ahead 0.00/s, evicted without access 0.00/s, Random read\nahead 0.00/s\nLRU len: 5720, unzip_LRU len: 0\nI/O sum[0]:cur[0], unzip sum[0]:cur[0]\n</code></pre> <p>\u4e0b\u8868\u63cf\u8ff0\u4e86<code>InnoDB</code>\u6807\u51c6\u76d1\u89c6\u5668\u62a5\u544a\u7684\u7f13\u51b2\u6c60\u5ea6\u91cf \u6807\u51c6</p> \u540d\u79f0 \u63cf\u8ff0 Total memory allocated \u4e3a\u7f13\u51b2\u6c60\u5206\u914d\u7684\u603b\u5185\u5b58\uff08\u4ee5\u5b57\u8282\u4e3a\u5355\u4f4d\uff09 Dictionary memory allocated \u4e3a<code>InnoDB</code>\u6570\u636e\u5b57\u5178\u5206\u914d\u7684\u603b\u5185\u5b58\uff0c\u4ee5\u5b57\u8282\u4e3a\u5355\u4f4d Buffer pool size \u5206\u914d\u7ed9\u7f13\u51b2\u6c60\u7684\u9875\u9762\u603b\u5927\u5c0f Free buffers \u7f13\u51b2\u6c60\u7a7a\u95f2\u5217\u8868\u7684\u9875\u9762\u603b\u5927\u5c0f Database pages \u7f13\u51b2\u6c60 LRU \u5217\u8868\u7684\u9875\u9762\u603b\u5927\u5c0f Old database pages \u7f13\u51b2\u6c60\u65e7 LRU \u5b50\u5217\u8868\u7684\u9875\u9762\u603b\u5927\u5c0f Modified db pages \u7f13\u51b2\u6c60\u4e2d\u5f53\u524d\u4fee\u6539\u7684\u9875\u9762\u6570 Pending reads \u7b49\u5f85\u8bfb\u5165\u7f13\u51b2\u6c60\u7684\u7f13\u51b2\u6c60\u9875\u9762\u6570 Pending writes LRU \u4ece LRU \u5217\u8868\u7684\u5e95\u90e8\u5f00\u59cb\u5199\u5165\u7684\u7f13\u51b2\u6c60\u4e2d\u7684\u65e7\u810f\u9875\u6570 Pending writes flush list \u68c0\u67e5\u70b9\u671f\u95f4\u8981\u5237\u65b0\u7684\u7f13\u51b2\u6c60\u9875\u9762\u6570 Pending writes single page \u7f13\u51b2\u6c60\u4e2d\u6682\u6302\u7684\u72ec\u7acb\u9875\u9762\u5199\u5165\u6570 Pages made young \u7f13\u51b2\u6c60 LRU \u5217\u8868\u4e2d\u53d8\u5e74\u8f7b\u7684\u9875\u9762\u603b\u6570\uff08\u5df2\u79fb\u81f3\u201c new \u201d\u9875\u9762\u7684\u5b50\u5217\u8868\u7684\u5f00\u5934\uff09 Pages made not young \u7f13\u51b2\u6c60 LRU \u5217\u8868\u4e2d\u6ca1\u6709\u5e74\u8f7b\u7684\u9875\u9762\u603b\u6570\uff08\u4fdd\u7559\u5728\u201c old \u201d\u5b50\u5217\u8868\u4e2d\u4f46\u6ca1\u6709\u5e74\u8f7b\u7684\u9875\u9762\uff09 youngs/s \u6bcf\u79d2\u5e73\u5747\u8bbf\u95ee\u7f13\u51b2\u6c60 LRU \u5217\u8868\u4e2d\u7684\u65e7\u9875\u9762\u6240\u5bfc\u81f4\u7684\u9875\u9762\u5e74\u8f7b non-youngs/s \u6bcf\u79d2\u5e73\u5747\u8bbf\u95ee\u7f13\u51b2\u6c60 LRU \u5217\u8868\u4e2d\u7684\u65e7\u9875\u9762\u5bfc\u81f4\u7684\u9875\u9762\u4e0d\u5e74\u8f7b Pages read \u4ece\u7f13\u51b2\u6c60\u8bfb\u53d6\u7684\u9875\u9762\u603b\u6570 Pages created \u5728\u7f13\u51b2\u6c60\u4e2d\u521b\u5efa\u7684\u9875\u9762\u603b\u6570 Pages written \u4ece\u7f13\u51b2\u6c60\u5199\u5165\u7684\u9875\u9762\u603b\u6570 reads/s \u6bcf\u79d2\u5e73\u5747\u6bcf\u79d2\u8bfb\u53d6\u7684\u7f13\u51b2\u6c60\u9875\u9762\u6570 creates/s \u6bcf\u79d2\u5e73\u5747\u521b\u5efa\u7684\u7f13\u51b2\u6c60\u9875\u9762\u7684\u6bcf\u79d2\u6570\u91cf writes/s \u6bcf\u79d2\u5e73\u5747\u7f13\u51b2\u6c60\u9875\u9762\u5199\u5165\u6570 Buffer pool hit rate \u4ece\u7f13\u51b2\u6c60\u5185\u5b58\u4e0e\u78c1\u76d8\u5b58\u50a8\u8bfb\u53d6\u7684\u9875\u9762\u7684\u7f13\u51b2\u6c60\u9875\u9762\u547d\u4e2d\u7387 young-making rate \u9875\u9762\u8bbf\u95ee\u7684\u5e73\u5747\u547d\u4e2d\u7387\u4f7f\u9875\u9762\u66f4\u5e74\u8f7b not (young-making rate) \u9875\u9762\u8bbf\u95ee\u672a\u4f7f\u9875\u9762\u53d8\u5e74\u8f7b\u7684\u5e73\u5747\u547d\u4e2d\u7387 Pages read ahead \u9884\u8bfb\u64cd\u4f5c\u7684\u6bcf\u79d2\u5e73\u5747\u6570 Pages evicted without access \u6bcf\u79d2\u4ece\u7f13\u51b2\u6c60\u8bbf\u95ee\u800c\u672a\u8bbf\u95ee\u7684\u9875\u9762\u7684\u5e73\u5747\u503c Random read ahead \u968f\u673a\u9884\u8bfb\u64cd\u4f5c\u7684\u6bcf\u79d2\u5e73\u5747\u6570 LRU len \u7f13\u51b2\u6c60 LRU \u5217\u8868\u7684\u9875\u9762\u603b\u5927\u5c0f unzip_LRU len \u7f13\u51b2\u6c60 unzip_LRU \u5217\u8868\u7684\u9875\u9762\u603b\u5927\u5c0f I/O sum \u6700\u8fd1 50 \u79d2\u5185\u8bbf\u95ee\u7684\u7f13\u51b2\u6c60 LRU \u5217\u8868\u9875\u9762\u7684\u603b\u6570 I/O cur \u5df2\u8bbf\u95ee\u7684\u7f13\u51b2\u6c60 LRU \u5217\u8868\u9875\u9762\u7684\u603b\u6570 I/O unzip sum \u5df2\u8bbf\u95ee\u7684\u7f13\u51b2\u6c60 unzip_LRU \u5217\u8868\u9875\u9762\u7684\u603b\u6570 I/O unzip cur \u5df2\u8bbf\u95ee\u7684\u7f13\u51b2\u6c60 unzip_LRU \u5217\u8868\u9875\u9762\u7684\u603b\u6570 <ul> <li>youngs/s   \u4ec5\u9002\u7528\u4e8e old \u9875\u3002\u5b83\u57fa\u4e8e\u5bf9\u9875\u9762\u7684**\u8bbf\u95ee\u6b21\u6570**\uff0c\u800c\u4e0d\u662f\u9875\u9762\u6570\u91cf\u3002\u53ef\u4ee5\u5bf9\u7ed9\u5b9a\u9875\u9762\u8fdb\u884c\u591a\u6b21\u8bbf\u95ee\uff0c\u6240\u6709\u8fd9\u4e9b\u8bbf\u95ee\u90fd\u4f1a\u88ab\u8ba1\u7b97\u5728\u5185\u3002\u5982\u679c\u5728\u6ca1\u6709\u8fdb\u884c\u5927\u578b\u626b\u63cf\u7684\u60c5\u51b5\u4e0b\u770b\u5230\u975e\u5e38\u4f4e\u7684 Young/s \u503c\uff0c\u5219\u53ef\u80fd\u9700\u8981\u51cf\u5c11\u5ef6\u8fdf\u65f6\u95f4\u6216\u589e\u52a0\u7528\u4e8e\u65e7\u5b50\u5217\u8868\u7684\u7f13\u51b2\u6c60\u7684\u767e\u5206\u6bd4\u3002\u589e\u52a0\u767e\u5206\u6bd4\u4f1a\u4f7f\u65e7\u5b50\u5217\u8868\u53d8\u5927\uff0c\u56e0\u6b64\u8be5\u5b50\u5217\u8868\u4e2d\u7684\u9875\u9762\u9700\u8981\u66f4\u957f\u65f6\u95f4\u624d\u80fd\u79fb\u52a8\u5230\u5c3e\u90e8\uff0c\u8fd9\u4f1a\u589e\u52a0\u518d\u6b21\u8bbf\u95ee\u8fd9\u4e9b\u9875\u9762\u5e76\u4f7f\u5176\u5e74\u8f7b\u5316\u7684\u53ef\u80fd\u6027\u3002</li> <li>non-youngs/s   \u4ec5\u9002\u7528\u4e8e\u65e7\u9875\u3002\u5b83\u57fa\u4e8e\u5bf9\u9875\u9762\u7684\u8bbf\u95ee\u6b21\u6570\uff0c\u800c\u4e0d\u662f\u9875\u9762\u6570\u91cf\u3002\u53ef\u4ee5\u5bf9\u7ed9\u5b9a\u9875\u9762\u8fdb\u884c\u591a\u6b21\u8bbf\u95ee\uff0c\u6240\u6709\u8fd9\u4e9b\u8bbf\u95ee\u90fd\u4f1a\u88ab\u8ba1\u7b97\u5728\u5185\u3002\u5982\u679c\u5728\u6267\u884c\u5927\u578b\u8868\u683c\u626b\u63cf\u65f6\u672a\u770b\u5230\u66f4\u9ad8\u7684**non-youngs/s\u503c(\u4ee5\u53ca\u66f4\u9ad8\u7684youngs/s**\u503c)\uff0c\u8bf7\u589e\u52a0\u5ef6\u8fdf\u503c\u3002</li> <li>young-making rate   \u8be5\u503c\u8003\u8651\u4e86\u5bf9\u6240\u6709\u7f13\u51b2\u6c60\u9875\u9762\u7684\u8bbf\u95ee\uff0c\u800c\u4e0d\u4ec5\u4ec5\u662f\u5bf9\u65e7\u5b50\u5217\u8868\u4e2d\u7684\u9875\u9762\u7684\u8bbf\u95ee\u3002young-making rate \u548c not-young-making rate \u901a\u5e38\u4e0d\u7b49\u4e8e\u603b\u7f13\u51b2\u6c60\u547d\u4e2d\u7387\u3002\u65e7\u5b50\u5217\u8868\u4e2d\u7684\u9875\u9762\u547d\u4e2d\u4f1a\u5bfc\u81f4\u9875\u9762\u79fb\u52a8\u5230\u65b0\u5b50\u5217\u8868\uff0c\u800c\u65b0\u5b50\u5217\u8868\u4e2d\u7684\u9875\u9762\u547d\u4e2d\u4f1a\u5bfc\u81f4\u9875\u9762\u4ec5\u5728\u4e0e\u5934\u90e8\u6709\u4e00\u5b9a\u8ddd\u79bb\u65f6\u624d\u79fb\u52a8\u5230\u5217\u8868\u7684\u5934\u90e8\u3002</li> <li>not (young-making rate)   Not(Young-Making Rate)\u662f\u7531\u4e8e\u672a\u6ee1\u8db3 Innodb_old_block_time \u5b9a\u4e49\u7684\u5ef6\u8fdf\uff0c\u6216\u7531\u4e8e\u65b0\u5b50\u5217\u8868\u4e2d\u7684\u9875\u9762\u547d\u4e2d\u672a\u5bfc\u81f4\u9875\u9762\u79fb\u52a8\u5230\u9875\u5934\u800c\u5bfc\u81f4\u9875\u9762\u8bbf\u95ee\u672a\u5bfc\u81f4\u9875\u9762\u5e74\u8f7b\u7684\u5e73\u5747\u547d\u4e2d\u7387\u3002\u6b64\u901f\u7387\u8003\u8651\u4e86\u5bf9\u6240\u6709\u7f13\u51b2\u6c60\u9875\u9762\u7684\u8bbf\u95ee\uff0c\u800c\u4e0d\u4ec5\u4ec5\u662f\u5bf9\u65e7\u5b50\u5217\u8868\u4e2d\u7684\u9875\u9762\u7684\u8bbf\u95ee\u3002</li> </ul> <p>\u7f13\u51b2\u6c60\u670d\u52a1\u5668\u72b6\u6001\u53d8\u91cf\u548c <code>INNODB_BUFFER_POOL_STATS</code>\u8868\u63d0\u4f9b\u4e86\u8bb8\u591a\u4e0e<code>InnoDB</code>\u6807\u51c6\u76d1\u89c6\u5668\u8f93\u51fa\u4e2d\u76f8\u540c\u7684\u7f13\u51b2\u6c60\u5ea6\u91cf \u6807\u51c6</p>"},{"location":"advanced/4.InnoDB%E5%86%85%E5%AD%98%E7%BB%93%E6%9E%84%E2%80%94%E2%80%94%E7%BC%93%E5%86%B2%E6%B1%A0/#unzip_lru","title":"unzip_LRU","text":"<p>InnoDB \u4ece 1.0.X \u5f00\u59cb\u652f\u6301\u9875\u538b\u7f29\u6280\u672f\u3002\u539f\u672c 16k \u7684\u9875\uff0c\u53ef\u4ee5\u538b\u7f29\u5230 2k\u30014k\u30018k\u3002\u56e0\u6b64\u9700\u8981 unzip_LRU \u5217\u6765\u7ba1\u7406\uff0c\u4f46\u662f\u6ce8\u610f\uff1aLRU list \u4e2d\u5305\u542b\u4e86 unzip_LRU</p> <p>\u5982\u4f55\u7ed9 unzip_LRU \u5206\u914d\u5185\u5b58\uff1a\uff08\u5047\u8bbe\u9700\u8981\u4ece\u7f13\u51b2\u6c60\u4e2d\u7533\u8bf7 4KB \u5927\u5c0f\u7684\u5185\u5b58\uff09</p> <ul> <li>\u68c0\u67e5 4KB \u7684 unzip_LRU \u5217\u8868\uff0c\u68c0\u67e5\u662f\u5426\u6709\u53ef\u7528\u7684\u7a7a\u95f2\u9875</li> <li>\u82e5\u6709\uff0c\u5219\u76f4\u63a5\u4f7f\u7528</li> <li>\u5426\u5219\u7533\u8bf7 8KB \u7684 unzip_LRU \u9875</li> <li>\u82e5\u80fd\u7533\u8bf7\u5230\u9875\uff0c\u5219\u62c6\u5206\u6210\u4e24\u4e2a 4KB \u9875\uff0c\u5e76\u5b58\u653e\u5230 unzip_LRU \u5217\u8868</li> <li>\u5982\u679c\u7533\u8bf7\u4e0d\u5230\uff0c\u5219\u4ece LRU \u5217\u8868\u7533\u8bf7\u4e00\u4e2a 16K \u7684\u9875\u9762\uff0c\u62c6\u5206\u6210\u4e00\u4e2a 8K\uff0c\u4e24\u4e2a 4k\uff0c\u5206\u522b\u653e\u5230\u5bf9\u5e94\u7684 unzip_LRU \u5217\u8868\u4e2d</li> </ul>"},{"location":"advanced/4.InnoDB%E5%86%85%E5%AD%98%E7%BB%93%E6%9E%84%E2%80%94%E2%80%94%E7%BC%93%E5%86%B2%E6%B1%A0/#free-list","title":"Free list","text":""},{"location":"advanced/4.InnoDB%E5%86%85%E5%AD%98%E7%BB%93%E6%9E%84%E2%80%94%E2%80%94%E7%BC%93%E5%86%B2%E6%B1%A0/#_35","title":"\u7ed3\u6784","text":"<p>\u5b83\u662f\u4e00\u4e2a\u53cc\u5411\u94fe\u8868\uff0c\u94fe\u8868\u7684\u6bcf\u4e2a\u8282\u70b9\u5c31\u662f\u4e00\u4e2a\u4e2a\u7a7a\u95f2\u7684\u7f13\u5b58\u9875\u5bf9\u5e94\u7684\u63cf\u8ff0\u6570\u636e\u5757\u3002</p> <p>\u4ed6\u672c\u8eab\u5176\u5b9e\u5c31\u662f\u7531 <code>Buffer Pool</code> \u91cc\u7684\u63cf\u8ff0\u6570\u636e\u5757\u7ec4\u6210\u7684\uff0c\u4f60\u53ef\u4ee5\u8ba4\u4e3a\u662f\u6bcf\u4e2a\u63cf\u8ff0\u6570\u636e\u5757\u91cc\u90fd\u6709\u4e24\u4e2a\u6307\u9488\uff0c\u4e00\u4e2a\u662f free_pre \u6307\u9488\uff0c\u4e00\u4e2a\u662f free_next \u6307\u9488\uff0c\u5206\u522b\u6307\u5411\u81ea\u5df1\u7684\u4e0a\u4e00\u4e2a free \u94fe\u8868\u7684\u8282\u70b9\uff0c\u4ee5\u53ca\u4e0b\u4e00\u4e2a free \u94fe\u8868\u7684\u8282\u70b9\u3002</p> <p>\u901a\u8fc7 <code>Buffer Pool</code> \u4e2d\u7684\u63cf\u8ff0\u6570\u636e\u5757\u7684 free_pre \u548c free_next \u4e24\u4e2a\u6307\u9488\uff0c\u5c31\u53ef\u4ee5\u628a\u6240\u6709\u7684\u63cf\u8ff0\u6570\u636e\u5757\u4e32\u6210\u4e00\u4e2a free \u94fe\u8868\u3002</p> <p>\u4e0b\u9762\u6211\u4eec\u53ef\u4ee5\u7528\u4f2a\u4ee3\u7801\u6765\u63cf\u8ff0\u4e00\u4e0b free \u94fe\u8868\u4e2d\u63cf\u8ff0\u6570\u636e\u5757\u8282\u70b9\u7684\u6570\u636e\u7ed3\u6784\uff1a</p> <pre><code>DescriptionDataBlock{\n    block_id = block1;\n    free_pre = null;\n    free_next = block2;\n}\n</code></pre> <p>free \u94fe\u8868\u6709\u4e00\u4e2a\u57fa\u7840\u8282\u70b9\uff0c\u4ed6\u4f1a\u5f15\u7528\u94fe\u8868\u7684\u5934\u8282\u70b9\u548c\u5c3e\u8282\u70b9\uff0c\u91cc\u9762\u8fd8\u5b58\u50a8\u4e86\u94fe\u8868\u4e2d\u6709\u591a\u5c11\u4e2a\u63cf\u8ff0\u6570\u636e\u5757\u7684\u8282\u70b9\uff0c\u4e5f\u5c31\u662f\u6709\u591a\u5c11\u4e2a\u7a7a\u95f2\u7684\u7f13\u5b58\u9875\u3002</p> <p>\u4e0b\u9762\u6211\u4eec\u4e5f\u7528\u4f2a\u4ee3\u7801\u6765\u63cf\u8ff0\u4e00\u4e0b\u57fa\u7840\u8282\u70b9\u7684\u6570\u636e\u7ed3\u6784\uff1a</p> <pre><code>FreeListBaseNode{\n    start = block01;\n    end = block03;\n    count = 2;\n}\n</code></pre> <p>\u5230\u6b64\uff0cfree \u94fe\u8868\u5c31\u4ecb\u7ecd\u5b8c\u4e86\u3002\u4e0a\u9762\u6211\u4eec\u4e5f\u4ecb\u7ecd\u4e86 MySQL \u542f\u52a8\u65f6 <code>Buffer Pool</code> \u7684\u521d\u59cb\u6d41\u7a0b\uff0c\u63a5\u4e0b\u6765\uff0c\u6211\u4f1a\u5c06\u7ed3\u5408\u521a\u4ecb\u7ecd\u5b8c\u7684 free \u94fe\u8868\uff0c\u8bb2\u89e3\u4e00\u4e0b SQL \u8fdb\u6765\u65f6\uff0c\u78c1\u76d8\u6570\u636e\u9875\u8bfb\u53d6\u5230 <code>Buffer Pool</code> \u7684\u7f13\u5b58\u9875\u7684\u8fc7\u7a0b\u3002\u4f46\u662f\uff0c\u6211\u4eec\u5148\u8981\u4e86\u89e3\u4e00\u4e0b\u4e00\u4e2a\u65b0\u6982\u5ff5\uff1a\u6570\u636e\u9875\u7f13\u5b58\u54c8\u5e0c\u8868\uff0c\u5b83\u7684 key \u662f\u8868\u7a7a\u95f4+\u6570\u636e\u9875\u53f7\uff0c\u800c value \u662f\u5bf9\u5e94\u7f13\u5b58\u9875\u7684\u5730\u5740\u3002</p> <p>\u63cf\u8ff0\u5982\u56fe\u6240\u793a\uff1a</p> <p></p>"},{"location":"advanced/4.InnoDB%E5%86%85%E5%AD%98%E7%BB%93%E6%9E%84%E2%80%94%E2%80%94%E7%BC%93%E5%86%B2%E6%B1%A0/#buffer-pool_3","title":"\u78c1\u76d8\u6570\u636e\u9875\u8bfb\u53d6\u5230 <code>Buffer Pool</code> \u7684\u7f13\u5b58\u9875\u7684\u8fc7\u7a0b","text":"<ol> <li> <p>\u9996\u5148\uff0cSQL \u8fdb\u6765\u65f6\uff0c\u5224\u65ad\u6570\u636e\u5bf9\u5e94\u7684\u6570\u636e\u9875\u80fd\u5426\u5728 \u6570\u636e\u9875\u7f13\u5b58\u54c8\u5e0c\u8868\u91cc \u627e\u5230\u5bf9\u5e94\u7684\u7f13\u5b58\u9875\u3002</p> </li> <li> <p>\u5982\u679c\u627e\u5230\uff0c\u5c06\u76f4\u63a5\u5728 <code>Buffer Pool</code> \u4e2d\u8fdb\u884c\u589e\u5220\u6539\u67e5\u3002</p> </li> <li> <p>\u5982\u679c\u627e\u4e0d\u5230\uff0c\u5219\u4ece free \u94fe\u8868\u4e2d\u627e\u5230\u4e00\u4e2a\u7a7a\u95f2\u7684\u7f13\u5b58\u9875\uff0c\u7136\u540e\u4ece\u78c1\u76d8\u6587\u4ef6\u4e2d\u8bfb\u53d6\u5bf9\u5e94\u7684\u6570\u636e\u9875\u7684\u6570\u636e\u5230\u7f13\u5b58\u9875\u4e2d\uff0c\u5e76\u4e14\u5c06\u6570\u636e\u9875\u7684\u4fe1\u606f\u548c\u7f13\u5b58\u9875\u7684\u5730\u5740\u5199\u5165\u5230\u5bf9\u5e94\u7684\u63cf\u8ff0\u6570\u636e\u5757\u4e2d\uff0c\u7136\u540e\u4fee\u6539\u76f8\u5173\u7684\u63cf\u8ff0\u6570\u636e\u5757\u7684 free_pre \u6307\u9488\u548c free_next \u6307\u9488\uff0c\u5c06\u4f7f\u7528\u4e86\u7684\u63cf\u8ff0\u6570\u636e\u5757\u4ece free \u94fe\u8868\u4e2d\u79fb\u9664\u3002\u8bb0\u5f97\uff0c\u8fd8\u8981\u5728\u6570\u636e\u9875\u7f13\u5b58\u54c8\u5e0c\u8868\u4e2d\u5199\u5165\u5bf9\u5e94\u7684 key-value \u5bf9\u3002\u6700\u540e\u4e5f\u662f\u5728 <code>Buffer Pool</code> \u4e2d\u8fdb\u884c\u589e\u5220\u6539\u67e5\u3002</p> </li> </ol>"},{"location":"advanced/4.InnoDB%E5%86%85%E5%AD%98%E7%BB%93%E6%9E%84%E2%80%94%E2%80%94%E7%BC%93%E5%86%B2%E6%B1%A0/#free-list-lru-list","title":"Free list \u548c LRU List \u5173\u7cfb","text":"<p>\u6570\u636e\u5e93\u521a\u542f\u52a8\u65f6\uff0cLRU list \u662f\u7a7a\u7684\u3002Free list \u662f\u6700\u5927\u7684\u3002\u5f53\u9700\u8981\u4ece\u7f13\u51b2\u6c60\u4e2d\u5206\u9875\u65f6\uff0c\u770b Free list \u6709\u7a7a\u95f2\u9875\uff1a</p> <ul> <li> <p>\u6709\u5219\u5220\u9664 Free list \u7684\u9875\uff0c\u52a0\u5165\u5230 LRU list \u4e2d\u3002\u7ef4\u6301\u4e00\u4e2a\u6570\u91cf\u5e73\u8861</p> </li> <li> <p>\u5426\u5219\uff0c\u6839\u636e LRU \u7b97\u6cd5\uff0c\u6dd8\u6c70 LRU \u672b\u5c3e\u7684\u9875\uff0c\u7701\u51fa\u5185\u5b58\u6765\uff0c\u5206\u914d\u7ed9\u65b0\u7684\u9875</p> </li> <li> <p>lru \u94fe\u8868\u5c3e\u90e8\u7684\u7f13\u5b58\u9875\u4f55\u65f6\u5237\u5165\u78c1\u76d8?</p> </li> </ul> <p>\u5f53 free list \u4e3a\u7a7a\u4e86\uff0c\u6b64\u65f6\u9700\u8981\u5c06\u6570\u636e\u9875\u52a0\u8f7d\u5230\u7f13\u51b2\u6c60\u91cc\uff0c\u5c31\u4f1a lru list \u7684 old \u6570\u636e\u533a\u57df\u5c3e\u90e8\u7684\u7f13\u5b58\u9875\u5237\u5165\u78c1\u76d8\uff0c\u7136\u540e\u6e05\u7a7a\uff0c\u518d\u52a0\u8f7d\u6570\u636e\u9875\u7684\u6570\u636e\u3002</p> <p>\u4e00\u6761\u540e\u53f0\u7ebf\u7a0b\uff0c\u8fd0\u884c\u4e00\u4e2a\u5b9a\u65f6\u4efb\u52a1\uff0c\u5b9a\u65f6\u5c06 lru list \u7684 old \u6570\u636e\u533a\u57df\u7684\u5c3e\u90e8\u7684\u4e00\u4e9b\u7f13\u5b58\u9875\u5237\u5165\u78c1\u76d8\uff0c\u7136\u540e\u6e05\u7a7a\uff0c\u6700\u540e\u628a\u4ed6\u4eec\u5bf9\u5e94\u7684\u63cf\u8ff0\u6570\u636e\u5757\u52a0\u5165\u5230 free \u94fe\u8868\u4e2d\u53bb\u3002</p> <p>\u5f53\u7136\u4e86\uff0c\u9664\u4e86 lru list \u5c3e\u90e8\u7684\u7f13\u5b58\u9875\u4f1a\u88ab\u5237\u5165\u78c1\u76d8\uff0c\u8fd8\u6709\u7684\u5c31\u662f flush list \u7684\u7f13\u5b58\u9875\u3002</p> <p>\u540e\u53f0\u7ebf\u7a0b\u540c\u65f6\u4e5f\u4f1a\u5728 MySQL \u4e0d\u7e41\u5fd9\u7684\u65f6\u5019\uff0c\u5c06 flush \u94fe\u8868\u4e2d\u7684\u7f13\u5b58\u9875\u5237\u5165\u78c1\u76d8\u4e2d\uff0c\u8fd9\u4e9b\u7f13\u5b58\u9875\u7684\u63cf\u8ff0\u6570\u636e\u5757\u4f1a\u4ece lru \u94fe\u8868\u548c flush \u94fe\u8868\u4e2d\u79fb\u9664\uff0c\u5e76\u52a0\u5165\u5230 free \u94fe\u8868\u4e2d\u3002</p>"},{"location":"advanced/4.InnoDB%E5%86%85%E5%AD%98%E7%BB%93%E6%9E%84%E2%80%94%E2%80%94%E7%BC%93%E5%86%B2%E6%B1%A0/#flush-list","title":"Flush list","text":""},{"location":"advanced/4.InnoDB%E5%86%85%E5%AD%98%E7%BB%93%E6%9E%84%E2%80%94%E2%80%94%E7%BC%93%E5%86%B2%E6%B1%A0/#dirty-page","title":"\u810f\u9875\uff08dirty page\uff09","text":"<p>\u6211\u4eec\u90fd\u77e5\u9053 SQL \u7684\u589e\u5220\u6539\u67e5\u90fd\u5728 <code>Buffer Pool</code> \u4e2d\u6267\u884c\uff0c\u6162\u6162\u5730\uff0c<code>Buffer Pool</code> \u4e2d\u7684\u7f13\u5b58\u9875\u56e0\u4e3a\u4e0d\u65ad\u88ab\u4fee\u6539\u800c\u5bfc\u81f4\u548c\u78c1\u76d8\u6587\u4ef6\u4e2d\u7684\u6570\u636e\u4e0d\u4e00\u81f4\u4e86\uff0c\u4e5f\u5c31\u662f <code>Buffer Pool</code> \u4e2d\u4f1a\u6709\u5f88\u591a\u4e2a\u810f\u9875\uff0c\u810f\u9875\u91cc\u9762\u5f88\u591a\u810f\u6570\u636e\u3002</p> <p>\u6240\u4ee5\uff0cMySQL \u4f1a\u6709\u4e00\u6761\u540e\u53f0\u7ebf\u7a0b\uff0c\u5b9a\u65f6\u5730\u5c06 <code>Buffer Pool</code> \u4e2d\u7684\u810f\u9875\u5237\u56de\u5230\u78c1\u76d8\u6587\u4ef6\u4e2d\u3002</p> <p>\u4f46\u662f\uff0c\u540e\u53f0\u7ebf\u7a0b\u600e\u4e48\u77e5\u9053\u54ea\u4e9b\u7f13\u5b58\u9875\u662f\u810f\u9875\u5462\uff0c\u4e0d\u53ef\u80fd\u5c06\u5168\u90e8\u7684\u7f13\u5b58\u9875\u90fd\u5f80\u78c1\u76d8\u4e2d\u5237\u5427\uff0c\u8fd9\u4f1a\u5bfc\u81f4 MySQL \u6682\u505c\u4e00\u6bb5\u65f6\u95f4\u3002</p> <p>MySQL \u901a\u8fc7 checkPoint \u6280\u672f\u5c06\u810f\u9875\u5237\u65b0\u5230\u78c1\u76d8</p> <ul> <li>Flush list \u4e2d\u7684\u9875\uff0c\u5373\u4e3a\u810f\u9875</li> <li>\u810f\u9875\u65e2\u5b58\u5728\u4e8e LRU \u5217\u8868\u4e2d\uff0c\u4e5f\u5b58\u5728\u4e8e Flush list \u4e2d\uff08LRU \u5217\u8868\u7528\u6765\u7ba1\u7406\u7f13\u51b2\u6c60\u4e2d\u9875\u7684\u53ef\u7528\u6027\uff0cFlush list \u810f\u9875\u5237\u65b0\u5230\u78c1\u76d8\uff0c\u4e24\u8005\u4e92\u4e0d\u5f71\u54cd\uff09</li> </ul>"},{"location":"advanced/4.InnoDB%E5%86%85%E5%AD%98%E7%BB%93%E6%9E%84%E2%80%94%E2%80%94%E7%BC%93%E5%86%B2%E6%B1%A0/#_36","title":"\u7ed3\u6784","text":"<p>Flush list \u4e5f\u662f\u901a\u8fc7\u7f13\u5b58\u9875\u7684\u63cf\u8ff0\u6570\u636e\u5757\u4e2d\u7684\u4e24\u4e2a\u6307\u9488\uff0c\u8ba9\u4fee\u6539\u8fc7\u7684\u7f13\u5b58\u9875\u7684\u63cf\u8ff0\u6570\u636e\u5757\u80fd\u4e32\u6210\u4e00\u4e2a\u53cc\u5411\u94fe\u8868\uff0c\u8fd9\u4e24\u6307\u9488\u5927\u5bb6\u53ef\u4ee5\u8ba4\u4e3a\u662f flush_pre \u6307\u9488\u548c flush_next \u6307\u9488\u3002</p> <p>\u4e0b\u9762\u6211\u7528\u4f2a\u4ee3\u7801\u6765\u63cf\u8ff0\u4e00\u4e0b\uff1a</p> <pre><code>DescriptionDataBlock{\n    block_id = block1;\n    // free \u94fe\u8868\u7684\n    free_pre = null;\n    free_next = null;\n\n    // flush \u94fe\u8868\u7684\n    flush_pre = null;\n    flush_next = block2;\n}\n</code></pre> <p>flush \u94fe\u8868\u4e5f\u6709\u5bf9\u5e94\u7684\u57fa\u7840\u8282\u70b9\uff0c\u4e5f\u662f\u5305\u542b\u94fe\u8868\u7684\u5934\u8282\u70b9\u548c\u5c3e\u8282\u70b9\uff0c\u8fd8\u6709\u5c31\u662f\u4fee\u6539\u8fc7\u7684\u7f13\u5b58\u9875\u7684\u6570\u91cf\u3002</p> <pre><code>FlushListBaseNode{\n    start = block1;\n    end = block2;\n    count = 2;\n}\n</code></pre> <p>\u5230\u8fd9\u91cc\uff0c\u6211\u4eec\u90fd\u77e5\u9053\uff0cSQL \u7684\u589e\u5220\u6539\u90fd\u4f1a\u4f7f\u5f97\u7f13\u5b58\u9875\u53d8\u4e3a\u810f\u9875\uff0c\u6b64\u65f6\u4f1a\u4fee\u6539\u810f\u9875\u5bf9\u5e94\u7684\u63cf\u8ff0\u6570\u636e\u5757\u7684 flush_pre \u6307\u9488\u548c flush_next \u6307\u9488\uff0c\u4f7f\u5f97\u63cf\u8ff0\u6570\u636e\u5757\u52a0\u5165\u5230 flush \u94fe\u8868\u4e2d\uff0c\u4e4b\u540e MySQL \u7684\u540e\u53f0\u7ebf\u7a0b\u5c31\u53ef\u4ee5\u5c06\u8fd9\u4e2a\u810f\u9875\u5237\u56de\u5230\u78c1\u76d8\u4e2d\u3002</p> <p>\u63cf\u8ff0\u5982\u56fe\u6240\u793a\uff1a</p> <p></p>"},{"location":"advanced/4.InnoDB%E5%86%85%E5%AD%98%E7%BB%93%E6%9E%84%E2%80%94%E2%80%94%E7%BC%93%E5%86%B2%E6%B1%A0/#_37","title":"\u586b\u5145\u56e0\u5b50","text":"<p>\u586b\u5145\u56e0\u5b50\u662f\u6307\u5728\u521b\u5efa\u8868\u6216\u7d22\u5f15\u65f6\uff0c\u6570\u636e\u5757\u7684\u586b\u5145\u7a0b\u5ea6\u3002\u5b83\u662f\u4e00\u4e2a\u767e\u5206\u6bd4\u503c\uff0c\u8303\u56f4\u4ece 1 \u5230 100\u3002</p> <p>\u4f8b\u5982\uff0c\u586b\u5145\u56e0\u5b50\u4e3a 80 \u8868\u793a\u6570\u636e\u5757\u88ab\u586b\u5145\u4e86 80% \u7684\u7a7a\u95f4\uff0c\u5269\u4f59 20% \u7684\u7a7a\u95f4\u7528\u4e8e\u672a\u6765\u7684\u6570\u636e\u63d2\u5165\u548c\u66f4\u65b0\u3002</p> <p>\u586b\u5145\u56e0\u5b50\u7684\u4f5c\u7528</p> <ul> <li>\u51cf\u5c11\u5757\u5206\u88c2\uff1a \u5f53\u6570\u636e\u5757\u88ab\u586b\u6ee1\u65f6\uff0c\u63d2\u5165\u65b0\u7684\u6570\u636e\u4f1a\u5bfc\u81f4\u5757\u5206\u88c2\uff0c\u8fd9\u4f1a\u964d\u4f4e\u6570\u636e\u5e93\u7684\u6027\u80fd\u3002\u8bbe\u7f6e\u5408\u9002\u7684\u586b\u5145\u56e0\u5b50\u53ef\u4ee5\u9884\u7559\u4e00\u5b9a\u7684\u7a7a\u95f4\uff0c\u51cf\u5c11\u5757\u5206\u88c2\u7684\u53d1\u751f\u3002</li> <li>\u63d0\u9ad8\u67e5\u8be2\u6548\u7387\uff1a \u8f83\u9ad8\u7684\u586b\u5145\u56e0\u5b50\u53ef\u4ee5\u51cf\u5c11\u8bfb\u53d6\u6570\u636e\u6240\u9700\u7684 I/O \u64cd\u4f5c\uff0c\u4ece\u800c\u63d0\u9ad8\u67e5\u8be2\u6548\u7387\u3002</li> <li>\u5e73\u8861\u5b58\u50a8\u7a7a\u95f4\u548c\u6027\u80fd\uff1a \u586b\u5145\u56e0\u5b50\u9700\u8981\u5728\u5b58\u50a8\u7a7a\u95f4\u5229\u7528\u7387\u548c\u6027\u80fd\u4e4b\u95f4\u627e\u5230\u5e73\u8861\u70b9\u3002</li> </ul> <p><code>B+TREE</code>\u603b\u662f\u4f1a\u4fdd\u6301\u4e00\u4e2a\u5e73\u8861\uff0c\u90a3\u586b\u5145\u56e0\u5b50\u5230\u5e95\u5728\u8fd9\u91cc\u8d77\u4e00\u4e2a\u4ec0\u4e48\u4f5c\u7528\uff0cInnoDB\u5728\u521b\u5efa\u6216\u91cd\u5efab\u6811\u7d22\u5f15\u65f6\u662f\u8fdb\u884c\u6279\u91cf\u52a0\u8f7d\u7684\uff0c\u8fd9\u6837\u521b\u5efa\u7d22\u5f15\u7684\u9014\u5f84\u79f0\u4e3a\u6392\u5e8f\u7d22\u5f15\u6784\u5efa\u3002innodb_fill_factor\u914d\u7f6e\u9009\u9879\u5b9a\u4e49\u5728\u6392\u5e8f\u7d22\u5f15\u6784\u5efa\u671f\u95f4\u586b\u5145\u7684\u6bcf\u4e2aB-tree\u9875\u9762\u4e0a\u7684\u7a7a\u95f4\u767e\u5206\u6bd4\uff0c\u5176\u4f59\u7a7a\u95f4\u4fdd\u7559\u7ed9\u672a\u6765\u7d22\u5f15\u589e\u957f\u3002</p> <p>\u6839\u636e\u5b98\u65b9\u7684\u8d44\u6599\uff0c\u5982\u679c\u662fcluster\u7d22\u5f15\u7684\u60c5\u51b5\u4e0b\uff08\u5176\u5b9e\u5c31\u662f\u6240\u8c13\u7684\u7d22\u5f15\u7ec4\u7ec7\u8868\uff08oracle\uff09\uff0c \u805a\u7c07\u7d22\u5f15+\u4e3b\u952e\uff08sql server\uff09\uff09\uff0cinnodb \u4f1a\u7559\u4e0b 1/16\u7684\u9875\u9762\u6765\u4fdd\u8bc1\u540e\u7eed\u7684\u63d2\u5165\u548c\u5347\u7ea7\u7d22\u5f15\u8bb0\u5f55\u7684\u7a7a\u95f4\u9884\u7559\uff0c\u5f53\u7136\u586b\u5145\u7d22\u5f15\u7684\u4f5c\u7528\u5e76\u4e0d\u662f\u4ec5\u4ec5\u4e8e\u6b64\uff0c\u5728\u6211\u4eec\u5927\u91cf\u5220\u9664row \u7684\u60c5\u51b5\u4e0b\uff0c\u9ed8\u8ba4\u7684\u60c5\u51b5\u4e0b\uff0c\u5f53\u4e00\u4e2a\u9875\u9762\u7684\u6570\u636e\u4e0d\u8db350%\u7684\u60c5\u51b5\u4e0b\uff0c\u5c31\u8981\u5f00\u59cb\u6536\u7f29\u9875\u9762\uff0c\u6216\u8005\u6211\u4eec\u79f0\u4e4b\u4e3a\uff0c\u5408\u5e76\u9875\u9762\u3002</p> <p>\u6240\u4ee5\u586b\u5145\u56e0\u5b50\u7684\u8bbe\u8ba1\u5c24\u5176\u9488\u5bf9\u4e00\u4e9b\u7279\u6b8a\u7684\u8868\u6765\u8bf4\uff0c\u662f\u6709\u5fc5\u8981\u8fdb\u884c\u5355\u4f53\u8bbe\u8ba1\u7684\u3002\u5c24\u5176\u5bf9\u6027\u80fd\u8981\u6c42\u6781\u9ad8\u7684\u9886\u57df\uff0c\u4f60\u613f\u610f\u4f60\u7684\u6570\u636e\u9875\u9762\u4e00\u4f1a\u5408\u5e76\uff0c\u4e00\u4f1a\u5206\u5272\u5417\uff0c\u6240\u4ee5\u4e0b\u9762\u5c31\u9700\u8981\u5f00\u59cb\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\u3002</p> <p>\u4e0b\u9762\u6709\u51e0\u4e2a\u4e1a\u52a1\u573a\u666f\u7684\u5047\u8bbe\uff1a</p> <ul> <li> <p>\u5047\u8bbe1\uff0c \u4e1a\u52a1\u6bd4\u8f83\u7a33\u5b9a\uff0c\u6570\u636e\u5728\u843d\u76d8\u540e\u4e0d\u4f1a\u7ecf\u5e38\u7684\u66f4\u6539\uff0c\u6216\u8005\u5220\u9664\u3002</p> </li> <li> <p>\u5047\u8bbe2\uff0c \u6570\u636e\u5c5e\u4e8e\u8bb0\u5f55\u53d8\u66f4\u6027\u8d28\uff0c\u4f1a\u7ecf\u5e38\u88abUPDATE \uff0c\u4f8b\u5982\u4e00\u4e9b\u8ba2\u5355\u7684\u72b6\u6001\uff0c\u4e00\u4e2a\u8ba2\u5355\u81f3\u5c11\u67093\u4e2a\u72b6\u6001\uff0c\u5728\u51e0\u5206\u949f\u4e2d\u5185\u4f1a\u8fdb\u884c\u53d8\u5316\uff0c\u5e76\u4e14\u4f1a\u7ecf\u5e38\u66f4\u6539\u4e00\u4e9b\u6ce8\u91ca\u3002</p> </li> <li> <p>\u5047\u8bbe3\uff0c\u8868\u5c5e\u4e8e\u7edf\u8ba1\u8868\uff0c\u6570\u636e\u5728\u8bb0\u5f55\u540e\u4e0d\u4f1a\u6539\u53d8\uff0c\u5927\u90e8\u5206\u90fd\u662f\u5728\u8fdb\u884c\u67e5\u8be2\u6d3b\u52a8</p> </li> </ul>"},{"location":"advanced/4.InnoDB%E5%86%85%E5%AD%98%E7%BB%93%E6%9E%84%E2%80%94%E2%80%94%E7%BC%93%E5%86%B2%E6%B1%A0/#innodb_4","title":"InnoDB \u8868\u538b\u7f29","text":"<p>\u6570\u636e\u5e93\u4e2d\u7684\u8868\u662f\u7531\u4e00\u884c\u884c\u8bb0\u5f55\uff08rows\uff09\u6240\u7ec4\u6210\uff0c\u6bcf\u884c\u8bb0\u5f55\u88ab\u5b58\u50a8\u5728\u4e00\u4e2a\u9875\u4e2d\uff0c\u5728 MySQL \u4e2d\uff0c\u4e00\u4e2a\u9875\u7684\u5927\u5c0f\u9ed8\u8ba4\u4e3a 16K\uff0c\u4e00\u4e2a\u4e2a\u9875\u53c8\u7ec4\u6210\u4e86\u6bcf\u5f20\u8868\u7684\u8868\u7a7a\u95f4\u3002</p> <p>\u901a\u5e38\u6211\u4eec\u8ba4\u4e3a\uff0c \u5982\u679c\u4e00\u4e2a\u9875\u4e2d\u5b58\u653e\u7684\u8bb0\u5f55\u6570\u8d8a\u591a\uff0c\u6570\u636e\u5e93\u7684\u6027\u80fd\u8d8a\u9ad8 \u3002\u8fd9\u662f\u56e0\u4e3a\u6570\u636e\u5e93\u8868\u7a7a\u95f4\u4e2d\u7684\u9875\u662f\u5b58\u653e\u5728\u78c1\u76d8\u4e0a\uff0cMySQL \u6570\u636e\u5e93\u5148\u8981\u5c06\u78c1\u76d8\u4e2d\u7684\u9875\u8bfb\u53d6\u5230\u5185\u5b58\u7f13\u51b2\u6c60\uff0c\u7136\u540e\u4ee5\u9875\u4e3a\u5355\u4f4d\u6765\u8bfb\u53d6\u548c\u7ba1\u7406\u8bb0\u5f55\u3002</p> <p>\u4e00\u4e2a\u9875\u4e2d\u5b58\u653e\u7684\u8bb0\u5f55\u8d8a\u591a\uff0c\u5185\u5b58\u4e2d\u80fd\u5b58\u653e\u7684\u8bb0\u5f55\u6570\u4e5f\u5c31\u8d8a\u591a\uff0c\u90a3\u4e48\u5b58\u53d6\u6548\u7387\u4e5f\u5c31\u8d8a\u9ad8\u3002\u82e5\u60f3\u5c06\u4e00\u4e2a\u9875\u4e2d\u5b58\u653e\u7684\u8bb0\u5f55\u6570\u53d8\u591a\uff0c\u53ef\u4ee5\u542f\u7528\u538b\u7f29\u529f\u80fd\u3002</p> <p>\u6b64\u5916\uff0c\u542f\u7528\u538b\u7f29\u540e\uff0c\u5b58\u50a8\u7a7a\u95f4\u5360\u7528\u4e5f\u53d8\u5c0f\u4e86\uff0c\u540c\u6837\u5355\u4f4d\u7684\u5b58\u50a8\u80fd\u5b58\u653e\u7684\u6570\u636e\u4e5f\u53d8\u591a\u4e86\u3002</p> <p>\u8868\u538b\u7f29\u53ef\u4ee5\u5728\u521b\u5efa\u8868\u65f6\u5f00\u542f\uff0c\u538b\u7f29\u8868\u80fd\u591f\u4f7f\u8868\u4e2d\u7684\u6570\u636e\u4ee5\u538b\u7f29\u683c\u5f0f\u5b58\u50a8\uff0c\u538b\u7f29\u80fd\u591f\u663e\u8457\u63d0\u9ad8\u539f\u751f\u6027\u80fd\u548c\u53ef\u4f38\u7f29\u6027\u3002\u538b\u7f29\u610f\u5473\u7740\u5728\u786c\u76d8\u548c\u5185\u5b58\u4e4b\u95f4\u4f20\u8f93\u7684\u6570\u636e\u66f4\u5c0f\u4e14\u5360\u7528\u76f8\u5bf9\u5c11\u7684\u5185\u5b58\u53ca\u786c\u76d8\uff0c\u5bf9\u4e8e\u8f85\u52a9\u7d22\u5f15\uff0c\u8fd9\u79cd\u538b\u7f29\u5e26\u6765\u66f4\u52a0\u660e\u663e\u7684\u597d\u5904\uff0c\u56e0\u4e3a\u7d22\u5f15\u6570\u636e\u4e5f\u88ab\u538b\u7f29\u4e86\u3002\u538b\u7f29\u5bf9\u4e8e\u786c\u76d8\u662f SSD \u7684\u5b58\u50a8\u8bbe\u5907\u5c24\u4e3a\u91cd\u8981\uff0c\u56e0\u4e3a\u5b83\u4eec\u76f8\u5bf9\u666e\u901a\u7684 HDD \u786c\u76d8\u6bd4\u8f83\u8d35\u4e14\u5bb9\u91cf\u6709\u9650\u3002</p> <p>\u6211\u4eec\u90fd\u77e5\u9053\uff0cCPU \u548c\u5185\u5b58\u7684\u901f\u5ea6\u8fdc\u8fdc\u5927\u4e8e\u78c1\u76d8\uff0c\u56e0\u4e3a\u5bf9\u4e8e\u6570\u636e\u5e93\u670d\u52a1\u5668\uff0c\u78c1\u76d8 IO \u53ef\u80fd\u4f1a\u6210\u4e3a\u7d27\u8981\u8d44\u6e90\u6216\u8005\u74f6\u9888\u3002\u6570\u636e\u538b\u7f29\u80fd\u591f\u8ba9\u6570\u636e\u5e93\u53d8\u5f97\u66f4\u5c0f\uff0c\u4ece\u800c\u51cf\u5c11\u78c1\u76d8\u7684 I/O\uff0c\u8fd8\u80fd\u63d0\u9ad8\u7cfb\u7edf\u541e\u5410\u91cf\uff0c\u4ee5\u5f88\u5c0f\u7684\u6210\u672c\uff08\u8017\u8d39\u8f83\u591a\u7684 CPU \u8d44\u6e90\uff09\u3002\u5bf9\u4e8e\u8bfb\u6bd4\u91cd\u6bd4\u8f83\u591a\u7684\u5e94\u7528\uff0c\u538b\u7f29\u662f\u7279\u522b\u6709\u7528\u3002\u538b\u7f29\u80fd\u591f\u8ba9\u7cfb\u7edf\u62e5\u6709\u8db3\u591f\u7684\u5185\u5b58\u6765\u5b58\u50a8\u70ed\u6570\u636e\u3002</p> <p>\u5728\u521b\u5efa<code>InnoDB</code>\u8868\u65f6\u5e26\u4e0a<code>ROW_FORMAT=COMPRESSED</code>\u53c2\u6570\u80fd\u591f\u4f7f\u7528\u6bd4\u9ed8\u8ba4\u7684 16K \u66f4\u5c0f\u7684\u9875\u3002\u8fd9\u6837\u5728\u8bfb\u5199\u65f6\u9700\u8981\u66f4\u5c11\u7684 I/O\uff0c\u5bf9\u4e8e SSD \u78c1\u76d8\u66f4\u6709\u4ef7\u503c\u3002</p> <p>COMPRESS \u9875\u538b\u7f29\u662f<code>MySQL5.7</code>\u7248\u672c\u4e4b\u524d\u63d0\u4f9b\u7684\u9875\u538b\u7f29\u529f\u80fd\u3002\u53ea\u8981\u5728\u521b\u5efa\u8868\u65f6\u6307\u5b9a<code>ROW_FORMAT=COMPRESS</code>\uff0c\u5e76\u8bbe\u7f6e\u901a\u8fc7\u9009\u9879<code>KEY_BLOCK_SIZE</code>\u8bbe\u7f6e\u538b\u7f29\u7684\u6bd4\u4f8b\u3002</p> <pre><code>CREATE TABLE `v_test2` (\n  `a` varchar(4) COLLATE utf8mb4_general_ci DEFAULT NULL,\n  `b` char(4) COLLATE utf8mb4_general_ci DEFAULT NULL,\n  `c` char(10) COLLATE utf8mb4_general_ci DEFAULT NULL,\n  `f` varchar(255) COLLATE utf8mb4_general_ci DEFAULT NULL\n) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci ROW_FORMAT=COMPRESSED KEY_BLOCK_SIZE=8 ;\n</code></pre> <p>InnoDB \u672a\u538b\u7f29\u7684\u6570\u636e\u9875\u662f 16KB\uff0c\u6839\u636e\u9009\u9879\u7ec4\u5408\u503c\uff0cMySQL \u4e3a\u6bcf\u4e2a\u8868\u7684.ibd \u6587\u4ef6\u4f7f\u7528 1KB,2KB,4KB,8kb,16KB \u9875\u5927\u5c0f\u3002</p> <p>\u5b9e\u9645\u7684\u538b\u7f29\u7b97\u6cd5\u5e76\u4e0d\u4f1a\u53d7 KEY_BLOCK_SIZE \u503c\u5f71\u54cd\uff0c\u8fd9\u4e2a\u503c\u53ea\u662f\u51b3\u5b9a\u6bcf\u4e2a\u538b\u7f29\u5757\u6709\u591a\u5927\uff0c\u4ece\u800c\u5f71\u54cd\u591a\u5c11\u884c\u88ab\u538b\u7f29\u5230\u6bcf\u4e2a\u9875\u3002</p> <p>\u8bbe\u7f6e KEY_BLOCK_SIZE \u503c\u7b49\u4e8e 16k \u5e76\u4e0d\u80fd\u6709\u6548\u7684\u8fdb\u884c\u538b\u7f29\uff0c\u56e0\u4e3a\u9ed8\u8ba4\u7684 innodb \u9875\u5c31\u662f 16k\uff0c\u4f46\u662f\u5bf9\u4e8e\u62e5\u6709\u5f88\u591a BLOB,TEXT,VARCHAR \u7c7b\u578b\u5b57\u6bb5\u7684\u8868\u53ef\u80fd\u4f1a\u6709\u6548\u679c\u7684\u3002</p> <p>\u53c2\u8003</p>"},{"location":"advanced/4.InnoDB%E5%86%85%E5%AD%98%E7%BB%93%E6%9E%84%E2%80%94%E2%80%94%E7%BC%93%E5%86%B2%E6%B1%A0/#innodb_5","title":"InnoDB \u6570\u636e\u9875\u89e3\u6790","text":"<p>\u6570\u636e\u5e93\u91c7\u7528\u6570\u636e\u9875\u7684\u5f62\u5f0f\u7ec4\u7ec7\u6570\u636e\u3002MySQL \u9ed8\u8ba4\u7684\u975e\u538b\u7f29\u6570\u636e\u9875\u4e3a 16KB\u3002</p> <p>\u5728 ibd \u4e2d\u95f4\u4e2d\uff0c0-16KB \u504f\u79fb\u91cf\u5373\u4e3a 0 \u53f7\u6570\u636e\u9875\uff0c16KB-32KB \u7684\u4e3a 1 \u53f7\u6570\u636e\u9875\uff0c\u4f9d\u6b21\u7c7b\u63a8\u3002</p> <p>\u6570\u636e\u9875\u7684\u5934\u5c3e\u9664\u4e86\u4e00\u4e9b\u5143\u4fe1\u606f\u5916\uff0c\u8fd8\u6709 Checksum \u6821\u9a8c\u503c\uff0c\u8fd9\u4e9b\u6821\u9a8c\u503c\u5728\u5199\u5165\u78c1\u76d8\u524d\u8ba1\u7b97\u5f97\u5230\uff0c\u5f53\u4ece\u78c1\u76d8\u4e2d\u8bfb\u53d6\u65f6\uff0c\u91cd\u65b0\u8ba1\u7b97\u6821\u9a8c\u503c\u5e76\u4e0e\u6570\u636e\u9875\u4e2d\u5b58\u50a8\u7684\u5bf9\u6bd4\uff0c\u5982\u679c\u53d1\u73b0\u4e0d\u540c\uff0c\u5219\u4f1a\u5bfc\u81f4 MySQL crash\u3002</p> <p>\u9047\u5230\u8fd9\u79cd\u60c5\u51b5\uff0c\u5f80\u5f80\u9700\u8981\u4ece\u5907\u4efd\u96c6\u4e2d\u6062\u590d\u6570\u636e\uff0c\u5982\u679c\u5907\u4efd\u4e0d\u53ef\u7528\uff0c\u53ea\u80fd\u4f7f\u7528 innodb_force_recovery \u5f3a\u884c\u542f\u52a8\uff0c\u7136\u540e\u5c3d\u53ef\u80fd\u591a\u7684\u5bfc\u51fa\u6570\u636e\u3002\u8fd9\u7bc7\u6708\u62a5\u4e2d\u4ecb\u7ecd\u4e86\u4e00\u79cd\u4ece\u7269\u7406\u6587\u4ef6\u4e2d\u6062\u590d\u6570\u636e\u7684\u65b9\u6cd5\uff0c\u5728\u8d70\u6295\u65e0\u8def\u7684\u60c5\u51b5\u4e0b\u53ef\u4ee5\u4f7f\u7528\u3002</p>"},{"location":"advanced/4.InnoDB%E5%86%85%E5%AD%98%E7%BB%93%E6%9E%84%E2%80%94%E2%80%94%E7%BC%93%E5%86%B2%E6%B1%A0/#_38","title":"\u6570\u636e\u9875\u683c\u5f0f","text":"<p>\u4e25\u683c\u6765\u8bb2\uff0cInnoDB \u7684\u6570\u636e\u9875\u6709\u5f88\u591a\u79cd\uff0c\u6bd4\u5982\uff0c\u7d22\u5f15\u9875\uff0cUndo \u9875\uff0cInode \u9875\uff0c\u7cfb\u7edf\u9875\uff0cBloB \u9875\u7b49\uff0c\u4e00\u5171\u6709 10 \u591a\u79cd</p> <p>\u6570\u636e\u9875\u5305\u62ec\u4e03\u4e2a\u90e8\u5206\uff0c\u6570\u636e\u9875\u6587\u4ef6\u5934\uff0c\u6570\u636e\u9875\u5934\uff0c\u6700\u5927\u6700\u5c0f\u8bb0\u5f55\uff0c\u7528\u6237\u8bb0\u5f55\uff0c\u7a7a\u95f2\u7a7a\u95f4\uff0c\u6570\u636e\u76ee\u5f55\uff0c\u6570\u636e\u9875\u5c3e\u90e8\u3002\u7b80\u5355\u7684\u6765\u8bf4\uff0c\u6570\u636e\u9875\u5206\u4e24\u90e8\u5206\uff0c\u4e00\u90e8\u5206\u5b58\u50a8\u6570\u636e\u8bb0\u5f55\uff0c\u6309\u7167\u8bb0\u5f55\u7684\u5927\u5c0f\u901a\u8fc7\u8bb0\u5f55\u7684\u6307\u9488\u8fde\u63a5\u8d77\u6765\u3002</p>"},{"location":"advanced/4.InnoDB%E5%86%85%E5%AD%98%E7%BB%93%E6%9E%84%E2%80%94%E2%80%94%E7%BC%93%E5%86%B2%E6%B1%A0/#_39","title":"\u603b\u7ed3","text":"<p>\u5230\u6b64\uff0c\u6211\u5df2\u7ecf\u5c06\u7f13\u51b2\u6c60 <code>Buffer Pool</code>\u4ecb\u7ecd\u5b8c\u6bd5\u4e86\u3002</p> <p>\u4e0b\u9762\u7b80\u5355\u603b\u7ed3\u4e00\u4e0b <code>Buffer Pool</code> \u4ece\u521d\u59cb\u5316\u5230\u4f7f\u7528\u7684\u6574\u4e2a\u6d41\u7a0b\u3002</p> <p>1\u3001MySQL \u542f\u52a8\u65f6\u4f1a\u6839\u636e\u5206\u914d\u6307\u5b9a\u5927\u5c0f\u5185\u5b58\u7ed9 <code>Buffer Pool</code>\uff0c\u5e76\u4e14\u4f1a\u521b\u5efa\u4e00\u4e2a\u4e2a\u63cf\u8ff0\u6570\u636e\u5757\u548c\u7f13\u5b58\u9875\u3002</p> <p>2\u3001SQL \u8fdb\u6765\u65f6\uff0c\u9996\u5148\u4f1a\u6839\u636e\u6570\u636e\u7684\u8868\u7a7a\u95f4\u548c\u6570\u636e\u9875\u7f16\u53f7\u67e5\u8be2 \u6570\u636e\u9875\u7f13\u5b58\u54c8\u5e0c\u8868 \u4e2d\u662f\u5426\u6709\u5bf9\u5e94\u7684\u7f13\u5b58\u9875\u3002</p> <p>3\u3001\u5982\u679c\u6709\u5bf9\u5e94\u7684\u7f13\u5b58\u9875\uff0c\u5219\u76f4\u63a5\u5728 <code>Buffer Pool</code>\u4e2d\u6267\u884c\u3002</p> <p>4\u3001\u5982\u679c\u6ca1\u6709\uff0c\u5219\u68c0\u67e5 free \u94fe\u8868\u770b\u770b\u6709\u6ca1\u6709\u7a7a\u95f2\u7684\u7f13\u5b58\u9875\u3002</p> <p>5\u3001\u5982\u679c\u6709\u7a7a\u95f2\u7684\u7f13\u5b58\u9875\uff0c\u5219\u4ece\u78c1\u76d8\u4e2d\u52a0\u8f7d\u5bf9\u5e94\u7684\u6570\u636e\u9875\uff0c\u7136\u540e\u5c06\u63cf\u8ff0\u6570\u636e\u5757\u4ece free \u94fe\u8868\u4e2d\u79fb\u9664\uff0c\u5e76\u4e14\u52a0\u5165\u5230 lru \u94fe\u8868\u7684 old \u6570\u636e\u533a\u57df\u7684\u94fe\u8868\u5934\u90e8\u3002\u540e\u9762\u5982\u679c\u88ab\u4fee\u6539\u4e86\uff0c\u8fd8\u9700\u8981\u52a0\u5165\u5230 flush \u94fe\u8868\u4e2d\u3002</p> <p>6\u3001\u5982\u679c\u6ca1\u6709\u7a7a\u95f2\u7684\u7f13\u5b58\u9875\uff0c\u5219\u5c06 lru \u94fe\u8868\u7684 old \u6570\u636e\u533a\u57df\u7684\u94fe\u8868\u5c3e\u90e8\u7684\u7f13\u5b58\u9875\u5237\u56de\u78c1\u76d8\uff0c\u7136\u540e\u6e05\u7a7a\uff0c\u63a5\u7740\u5c06\u6570\u636e\u9875\u7684\u6570\u636e\u52a0\u8f7d\u5230\u7f13\u5b58\u9875\u4e2d\uff0c\u5e76\u4e14\u63cf\u8ff0\u6570\u636e\u5757\u4f1a\u52a0\u5165\u5230 lru \u94fe\u8868\u7684 old \u6570\u636e\u533a\u57df\u7684\u94fe\u8868\u5934\u90e8\u3002\u540e\u9762\u5982\u679c\u88ab\u4fee\u6539\u4e86\uff0c\u8fd8\u9700\u8981\u52a0\u5165\u5230 flush \u94fe\u8868\u4e2d\u3002</p> <p>7\u30015 \u6216\u8005 6 \u540e\uff0c\u5c31\u63a5\u7740\u5728 <code>Buffer Pool</code> \u4e2d\u6267\u884c\u589e\u5220\u6539\u67e5\u3002</p> <p>\u6ce8\u610f\uff1a5 \u548c 6 \u4e2d\uff0c\u7f13\u5b58\u9875\u52a0\u5165\u5230 old \u6570\u636e\u533a\u57df\u7684\u94fe\u8868\u5934\u90e8\u540e\uff0c\u5982\u679c\u5728 1s \u540e\u88ab\u8bbf\u95ee\uff0c\u5219\u5c06\u5165\u5230 new \u6570\u636e\u533a\u57df\u7684\u94fe\u8868\u5934\u90e8\u3002</p> <p>8\u3001\u6700\u540e\uff0c\u5c31\u662f\u63cf\u8ff0\u6570\u636e\u5757\u968f\u7740 SQL \u8bed\u53e5\u7684\u6267\u884c\u4e0d\u65ad\u5730\u5728 free \u94fe\u8868\u3001flush \u94fe\u8868\u548c lru \u94fe\u8868\u4e2d\u79fb\u52a8\u4e86\u3002</p>"},{"location":"advanced/5.MySQL%E6%BA%90%E4%BB%A3%E7%A0%81%E8%B0%83%E8%AF%95%E7%8E%AF%E5%A2%83/","title":"\u6982\u8ff0","text":"<p>\u5728\u5982\u4eca\u5f00\u6e90\u6570\u636e\u5e93\u7684\u65f6\u4ee3\uff0c\u8d8a\u6765\u8d8a\u591a\u7684\u4eba\u5f00\u59cb\u7814\u7a76\u6570\u636e\u5e93\u7684\u6e90\u7801\uff0c\u5e76\u7ed9\u793e\u533a\u8d21\u732e\u4ee3\u7801\uff0cMySQL \u5b98\u65b9\u6bcf\u6b21\u53d1\u5e03\u65b0\u7248\u672c\u90fd\u8981\u611f\u8c22\u4e00\u4e9b\u5728\u793e\u533a\u4e0a\u8d21\u732e\u4ee3\u7801\u7684\u7a0b\u5e8f\u5458\u3002 \u73b0\u5728\u65b0\u7684\u6570\u636e\u5e93\u65f6\u4ee3\u4e5f\u7ed9 DBA \u63d0\u51fa\u4e86\u66f4\u9ad8\u7684\u8981\u6c42\uff0c\u5b66\u4f1a\u8c03\u8bd5\u6e90\u7801\uff0c\u901a\u8fc7\u6e90\u7801\u5b9a\u4f4d\u95ee\u9898\uff0c\u8fd9\u662f DBA \u8fdb\u9636\u7684\u65b9\u5411\u3002MySQL \u7684\u6e90\u7801\u6709\u51e0\u767e\u4e0a\u5343\u4e07\u884c\uff0c\u60f3\u5168\u90e8\u641e\u61c2\u51e0\u4e4e\u662f\u4e0d\u53ef\u80fd\u7684\uff0c\u7814\u7a76\u6e90\u7801\u4e00\u822c\u63a8\u8350\u4ece\u67d0\u4e2a\u529f\u80fd\u70b9\u5165\u624b\u3002 \u800c\u5b66\u4f1a\u8c03\u8bd5\u6e90\u7801\uff0c\u4e0d\u7ba1\u5bf9\u7814\u7a76\u6e90\u7801\u6216\u901a\u8fc7\u6e90\u7801\u5b9a\u4f4d\u95ee\u9898\uff0c\u90fd\u662f\u5fc5\u5907\u7684\u6280\u80fd\u3002</p> <p>\u4e00\u822c\u5728\u5b9e\u9645\u5e94\u7528\u4e2d\uff0c<code>MySQL</code> \u90fd\u662f\u8fd0\u884c\u5728 <code>Linux</code> \u5e73\u53f0\u4e0b\uff0c\u5728 <code>Linux</code> \u5e73\u53f0\u4e0b\u4e00\u822c\u662f\u901a\u8fc7 <code>GDB(GNU symbolic debugger)</code>\u5de5\u5177\u8fdb\u884c\u8c03\u8bd5\uff0c<code>C/C++</code> \u9879\u76ee\u7684\u5f00\u53d1\u548c\u8c03\u8bd5\u5305\u62ec\u6545\u969c\u6392\u67e5\u90fd\u662f\u5229\u7528 <code>GDB</code> \u5b8c\u6210\u7684\u3002</p> <p>\u6b64\u5916\uff0c <code>VSCODE</code> \u8fd9\u79cd <code>IDE</code> \u5de5\u5177\u53ef\u4ee5\u5728\u672c\u5730\u7684 <code>Windows</code> \u64cd\u4f5c\u7cfb\u7edf\u4e0b\uff0c\u901a\u8fc7 <code>ssh</code> \u8fdc\u7a0b\u8c03\u8bd5 <code>Linux</code> \u5e73\u53f0\u4e0b\u7684 <code>MySQL</code> \u3002\u5982\u679c\u8981\u5728 Windows \u4e0a\u8c03\u8bd5 Windows Vscode \u63d2\u4ef6</p> <ul> <li>\u4e2d\u6587\u8bed\u8a00\u5305</li> <li>Remote</li> <li>C/C++</li> <li>C/C++ Clang Command Adapter</li> <li>CodeLLDB</li> <li>CMake Tools</li> </ul> <p>\u88c5\u5b8c\u540e\uff0c\u5de6\u4fa7\u4f1a\u663e\u793a\uff1a\u5206\u4e0a\u4e0b\u4e24\u680f\u3002\u4e0a\u680f\u662f\u4f60\u672c\u5730 <code>Windows</code> \u4e0a\u88c5\u7684 VSCode \u63d2\u4ef6\uff1b\u4e0b\u680f\u662f\u4f60\u8fdc\u7aef <code>Linux</code> \u4e0a\u88c5\u7684 <code>VSCode</code> \u63d2\u4ef6\u3002</p> <ul> <li>\u91cd\u8981\u7684\u4e8b\u60c5\u63d0\u524d\u8bf4\uff1amysql8.x \u662f\u5929\u5751\uff0c\u7f16\u8bd1\u65f6\u6587\u4ef6\u89e3\u538b\u7684\u7a7a\u95f4\u5f3a\u70c8\u5efa\u8bae&gt;40G\uff01\uff01\uff01\uff0130G \u771f\u5f97\u5f88\u52c9\u5f3a\uff0c\u6210\u529f\u5168\u9760\u8fd0\u6c14\uff01\u7f16\u8bd1\u7b49\u4e86 one hour\uff0c\u7cfb\u7edf\u544a\u8bc9\u4f60\u786c\u76d8\u7a7a\u95f4\u4e0d\u8db3\uff1a\uff09</li> <li>\u91cd\u8981\u7684\u4e8b\u60c5\u63d0\u524d\u8bf4\uff1a\u8bf7\u51c6\u5907\u597d\u8db3\u591f\u7684\u65f6\u95f4\uff0c\u6211 8 \u6838 16G \u7684\u670d\u52a1\u5668\uff0c\u7f16\u8bd1\u4e86\u5f88\u957f\u65f6\u95f4\uff0c\u5927\u6982\u662f\u4e09\u4e2a\u591a\u5c0f\u65f6\u3002</li> <li>\u91cd\u8981\u7684\u4e8b\u60c5\u63d0\u524d\u8bf4\uff1a\u7f16\u8bd1\u5f02\u5e38\u540e\uff0c\u9700\u8981\u5220\u9664\u5bf9\u5e94\u7684 cmake cache \u540e\u518d\u6b21\u8fdb\u884c\u7f16\u8bd1\uff0c\u5426\u5219\u6bcf\u6b21\u90fd\u4f1a\u8bfb\u53d6\u7f13\u5b58\u8fdb\u884c\u76f8\u540c\u7684\u62a5\u9519\u3002</li> </ul> <p>\u6e90\u4ee3\u7801\u7248\u672c\u9009\u62e9</p> <p>\u9996\u5148\u9700\u8981\u4ece\u5b98\u7f51\u4e0a\u4e0b\u8f7d\u6e90\u7801\uff0c\u64cd\u4f5c\u7cfb\u7edf\u9009\u62e9\u4e3a <code>source code</code>\uff0c\u64cd\u4f5c\u7cfb\u7edf\u7248\u672c\u9009\u62e9\u4e3a <code>ALL OPERATING SYSTEM</code>\uff0c\u4e0b\u8f7d\u5e26 <code>boost</code> \u5934\u6587\u4ef6\u7684\u6e90\u7801\u5305\u3002\u5982\u679c\u5bf9 <code>MySQL</code> \u7684\u7248\u672c\u6ca1\u6709\u7279\u522b\u8981\u6c42\u7684\u8bdd\uff0c\u4e00\u822c\u63a8\u8350\u4e0b\u8f7d\u6700\u65b0\u7248\u672c\u7684\u3002 \u56e0\u4e3a\u8001\u7248\u672c\u4e2d\u5b58\u5728 <code>bug</code> \u7684\u6982\u7387\u8f83\u5927\uff0c\u7f16\u8bd1\u8fc7\u7a0b\u9700\u8981\u89e3\u51b3\u8fd9\u4e9b <code>bug</code>\uff0c\u6bd4\u5982\u5728 <code>8.0.23</code> \u7248\u672c\u4e2d\u7f16\u8bd1\u8fc7\u7a0b\u4e2d\u62a5\u4e86\u8fd9\u4e2a\u9519\uff1a<code>buf0buf.cc:1227:44: error: \u2018SYS_gettid\u2019 was not declared in this scope</code>\u3002 \u53c2\u8003 <code>MySQL</code> \u5b98\u65b9\u8bba\u575b\uff1ahttps://forums.mysql.com/read.php?117,674410,676378#msg-676378\uff0c\u5728<code>storage/innobase/buf/buf0flu.cc</code>\u6587\u4ef6\u4ee3\u7801\u4e2d\u52a0\u4e0a\u58f0\u660e<code>#include &lt;sys/syscall.h&gt;</code>\uff0c\u89e3\u51b3\u4e86\u8fd9\u4e2a\u62a5\u9519\u3002</p> <p>\u73af\u5883\u914d\u7f6e</p> <ul> <li>\u786c\u4ef6\u73af\u5883\u914d\u7f6e\uff1a8 \u6838 + 16GiB + 200GiB \u7684\u670d\u52a1\u5668</li> <li>\u64cd\u4f5c\u7cfb\u7edf\u73af\u5883\uff1aUbuntu 20.04.4 LTS</li> <li>\u8f6f\u4ef6\u73af\u5883</li> <li>cmake version 3.16.3 \uff08\uff08Require \u9700\u8981\u6e90\u7801\u5b89\u88c5 cmake3.5.1+\uff0c\u4f46 cmake \u4e0d\u8981\u5347\u7ea7\u5230\u6700\u65b0\u3002 3.5.1 \u7248\u672c\u30013.5.2 \u7248\u672c\u5373\u53ef\u3002\u56e0\u4e3a 3.20+\u7248\u672c\u7f16\u8bd1 mysql8.0 \u4f1a\u62a5\u5404\u79cd\u9519\u8bef\uff09</li> <li>GNU Make 4.2.1 \uff08Require GNU make 3.75 or later GNU Make 4.2.1\uff09</li> <li>GCC gcc version 9.4.0 ( MySQL 8.4 source code permits use of C++17 features , Linux: GCC 10 )</li> </ul> <pre><code># \u51c6\u5907\u73af\u5883\napt install -y cmake make gcc g++ libncurses5-dev bison openssl libssl-dev git autoconf automake libtool  unzip build-essential perl pkg-config\n\n# \u521b\u5efa\u76ee\u5f55\nmkdir -p /data/{mysql_source_code,mysql_install_dir,mysql_data}  &amp;&amp; cd /data/mysql_source_code\n\n# \u76f4\u63a5\u53bb https://dev.mysql.com/downloads/mysql/ \u76f4\u63a5\u4e0b\u8f7d\u5e26 Boost \u7b2c\u4e09\u65b9\u5e93\u4f9d\u8d56\u7684\u6e90\u7801\u3002\n# Boost \u662f\u4e00\u4e2a\u529f\u80fd\u5f3a\u5927\u3001\u6784\u9020\u7cbe\u5de7\u3001\u8de8\u5e73\u53f0\u3001\u5f00\u6e90\u5e76\u4e14\u5b8c\u5168\u514d\u8d39\u7684 C++ \u7a0b\u5e8f\u5e93\uff0c\u53ef\u4ee5\u8ba4\u4e3a\u662f\u534a\u4e2aC++\u6807\u51c6\u5e93\u3002\n# MySQL \u7684\u4ee3\u7801\u4f9d\u8d56 Boost\u5e93\uff0c\u6240\u4ee5\u76f4\u63a5\u4e0b\u8f7d\u4e00\u4e2a\u643a\u5e26Boost\u5e93\u7684\u6e90\u7801\u6bd4\u8f83\u7701\u5fc3\uff0c\u4e0d\u9700\u8981\u518d\u53bb\u4e0b\u8f7d\u5bf9\u5e94\u7684Boost\u5e93\u3002\nwget https://dev.mysql.com/get/Downloads/MySQL-8.0/mysql-boost-8.0.39.tar.gz -P  /data/mysql_source_code\n\n# libboost-all-dev \u5305\u4f1a\u5b89\u88c5 Boost \u5e93\u7684\u6240\u6709\u4e3b\u8981\u7ec4\u4ef6\uff08\u5305\u62ec\u5934\u6587\u4ef6\u548c\u7f16\u8bd1\u597d\u7684\u5e93\u6587\u4ef6\uff09\uff0c\u6db5\u76d6\u4e86\u5f00\u53d1\u6240\u9700\u7684\u4e00\u5207\u3002\nsudo apt update\nsudo apt install libboost-all-dev\n\n# wget https://dev.mysql.com/get/Downloads/MySQL-8.0/mysql-8.0.39.tar.gz\n\n# \u89e3\u538b\ncd /data/mysql_source/  &amp;&amp; tar -zxvf mysql-boost-8.0.39.tar.gz\n\n# \u521b\u5efabuild\u76ee\u5f55\u5e76\u8fdb\u5165\nmkdir -p /data/mysql_source_code/mysql-8.0.39/build/ &amp;&amp; cd /data/mysql_source_code/mysql-8.0.39/build/\n\n# Configure , \u8d1f\u8d23\u5c06\u6e90\u4ee3\u7801\u4e0e\u5f53\u524d\u7cfb\u7edf\u8fdb\u884c\u914d\u7f6e\u548c\u9002\u914d\u3002\n\ncmake .. -DWITH_BOOST=/data/mysql_source_code/mysql-8.0.39/boost \\\n-DWITH_DEBUG=1 \\\n-DCMAKE_BUILD_TYPE=1\\\n-DWITH_INNOBASE_STORAGE_ENGINE=1\\\n-DWITH_ARCHIVE_STORAGE_ENGINE=1\\\n-DWITH_BLACKHOLE_STORAGE_ENGINE=1\\\n-DWITH_FEDERATED_STORAGE_ENGINE=1\\\n-DWITH_PARTITION_STORAGE_ENGINE=1\\\n-DMYSQL_TCP_PORT=3306\\\n-DENABLED_LOCAL_INFILE=1\\\n-DEXTRA_CHARSETS=all\\\n-DEFAULT_CHARSET=utf8\\\n-DDEFAULT_COLLATION=utf8_general_ci\\\n-DMYSQL_USER=mysql\\\n-DWITH_BINLOG_PREALLOC=ON\\\n-DCMAKE_INSTALL_PREFIX=/data/mysql_install_dir\n\n# \u53c2\u6570\u542b\u4e49\n# DWITH_DEBUG=1                         \u8fd9\u4e2a\u662f\u6700\u5173\u952e\u7684\u914d\u7f6e\uff0c\u662f\u4e3a\u4e86\u5f00\u542fdebug\u8c03\u8bd5\u6a21\u5f0f;\n# DCMAKE_INSTALL_PREFIX=                \u8868\u793a\u7f16\u8bd1\u72b6\u6001\u7684\u8def\u5f84\uff0c\u9009\u62e9\u6e90\u7801\u6587\u4ef6\u5939\u4e4b\u5916\u7684\u4e00\u4e2a\u81ea\u5efa\u7684build\u6587\u4ef6\u5939;\n# DWITH_BOOST=                          \u6307\u5b9a boost \u8def\u5f84\uff0c\u53ef\u4ee5\u76f4\u63a5\u6307\u5411\u6e90\u7801\u6587\u4ef6\u5939\u4e0b\u7684boost\u6587\u4ef6\u5939\uff1b\n# DCMAKE_BUILD_TYPE=1                   \u8868\u793a\u5f00\u542fdebug\uff0c\u65b9\u4fbf\u540e\u7eed\u4ee3\u7801\u8c03\u8bd5\uff1b\n# DWITH_BLACKHOLE_STORAGE_ENGINE=1      \u8868\u793a\u5f00\u542fBLACKHOLE\u5b58\u50a8\u5f15\u64ce\n# DWITH_PARTITION_STORAGE_ENGINE=1      \u8868\u793a\u5f00\u542fPARTITION\u5b58\u50a8\u5f15\u64ce\n# DWITH_FEDERATED_STORAGE_ENGINE=1      \u8868\u793a\u5f00\u542fFEDERATED\u5b58\u50a8\u5f15\u64ce\n# CMAKE_INSTALL_PREFIX=                 \u8fd9\u4e2a\u8868\u793aBASEDIR\u8def\u5f84\uff0c\u9ed8\u8ba4\u662f/usr/local/mysql\uff0c\u662f\u5404\u79cd\u914d\u7f6e\u7684\u8def\u5f84\u524d\u7f00PREFIX\n# DMYSQL_DATADIR\uff1a                      \u8fd9\u4e2a\u8868\u793a\u8868\u793aMySQL\u9ed8\u8ba4\u7684\u6570\u636e\u76ee\u5f55\uff0c\u9009\u62e9build\u6587\u4ef6\u5939\u4e0b\u7684data\u6587\u4ef6\n# \u5176\u4ed6\u8be6\u7ec6\u53c2\u6570\u53c2\u8003\u5b98\u7f51 https://dev.mysql.com/doc/refman/8.4/en/source-configuration-options.html\n# Cmake\u6784\u5efa\u53c2\u6570\uff0c\u4e3b\u8981\u5206\u4e3a\u51e0\u7c7b\uff1a\n# 1. \u901a\u7528\u53c2\u6570\uff1a\n# 2. \u5b89\u88c5\u5e03\u5c40\u53c2\u6570\uff1a\n# 3. \u5b58\u50a8\u53c2\u6570\uff1a\n# 4. \u7279\u6027\u53c2\u6570\uff1a\n\n# \u6839\u636e Makefile \u4e2d\u7684\u89c4\u5219\u8fdb\u884c\u5b9e\u9645\u7684\u7f16\u8bd1\u8fc7\u7a0b\uff0c\u751f\u6210\u53ef\u6267\u884c\u6587\u4ef6\u6216\u5e93\u3002\nmake -j4\n\n# \u8d1f\u8d23\u5c06\u6700\u7ec8\u7f16\u8bd1\u597d\u7684\u6587\u4ef6\u590d\u5236\u5230\u6307\u5b9a\u7684\u5b89\u88c5\u76ee\u5f55\u4e2d\uff0c\u4ee5\u4f9b\u7cfb\u7edf\u4e2d\u7684\u5176\u4ed6\u7a0b\u5e8f\u4f7f\u7528\u3002\nmake install\n\n# \u4e5f\u53ef\u4ee5\u4f7f\u7528make package\u6765\u751f\u6210\u5b89\u88c5\u5305\uff08\u5c31\u50cf\u4e8c\u8fdb\u5236\u5305\u4e00\u6837\uff09\n\n\n# \u63a5\u7740make install\u6210\u529f\u540e\uff0c\u914d\u7f6e\u4e00\u4e2a\u7b80\u5355\u7684\u5e38\u89c4\u914d\u7f6e\u6587\u4ef6/etc/my.cnf\uff0c\u5c31\u53ef\u4ee5\u521d\u59cb\u5316\u6570\u636e\u5e93\u5e76\u542f\u52a8\u6570\u636e\u5e93\u4e86\u3002\n\n\n\n/usr/local/mysql/bin/mysqld  --initialize-insecure\n\nmysqld_safe --user=mysql &amp;\n\n\n# \u542f\u52a8\u5b8c\u6570\u636e\u5e93\u540e\uff0c\u767b\u5f55\u6570\u636e\u5e93\u53ef\u4ee5\u53d1\u73b0\u73b0\u5728\u5df2\u7ecf\u662fdebug\u6a21\u5f0f\u4e86\u3002\n/usr/local/mysql/bin/mysql -u root -p\nmysql&gt; select version();\n+--------------+\n| version()    |\n+--------------+\n| 8.0.39-debug |\n+--------------+\n1 row in set (0.00 sec)\n\nmysql&gt;\n</code></pre>"},{"location":"advanced/5.MySQL%E6%BA%90%E4%BB%A3%E7%A0%81%E8%B0%83%E8%AF%95%E7%8E%AF%E5%A2%83/#mysql","title":"\u4fee\u6539 MySQL \u7248\u672c","text":"<p><code>/include/mysql_version.h</code>\u8fd9\u662f\u4e00\u4e2a C \u8bed\u8a00\u7684\u5934\u6587\u4ef6\uff0c\u662f\u5728\u7f16\u8bd1\u7684\u8fc7\u7a0b\u4e2d\u751f\u6210\u7684\uff0c\u901a\u8fc7 cmake \u548c make \u4e4b\u540e\u5c31\u4f1a\u751f\u6210\u3002\u6e90\u4ee3\u7801\u76ee\u5f55\u4e2d\u5b9e\u9645\u5e76\u4e0d\u5b58\u5728\u8fd9\u4e2a\u6587\u4ef6\u3002</p> <p>\u6e90\u4ee3\u7801\u5b9e\u9645\u4e0a\u53ea\u6709<code>/include/mysql_version.h.in</code> \uff0c\u8fd9\u79cd.h.in \u662f\u4e00\u4e2a\u6a21\u677f\u6587\u4ef6\uff0c\u5b83\u662f\u5728 cmake \u6216\u8005 automake \u7684\u8fc7\u7a0b\u4e2d\u4ea7\u751f\u7684\u4e00\u4e2a\u7528\u4e8e\u8f93\u5165\u8bbe\u7f6e\u4fe1\u606f\u7b49\u529f\u80fd\u7684\u4e2d\u95f4\u6587\u4ef6\u3002\u5b83\u4f1a\u5728\u4f60\u8c03\u7528 confing\u3001automake \u7b49.sh \u6587\u4ef6\u4e4b\u540e\uff0c\u81ea\u52a8\u751f\u6210\u4e00\u4e2a\u76f8\u5e94\u7684.h \u6587\u4ef6\uff0c\u7136\u540e\u5c31\u53ef\u4ee5\u5728\u6e90\u7801\u4e2d\u8c03\u7528\u3002</p> <pre><code># Bug #31466846 RENAME THE VERSION FILE TO MYSQL_VERSION\n\nversion \u662f C++11 \u7684\u4e00\u4e2a\u5934\u6587\u4ef6\uff0c\u4f46 MySQL \u4ee5\u5f80\u90fd\u662f\u5728\u6e90\u4ee3\u7801\u4e2d\u7528 VERSION \u8fd9\u4e2a\u6587\u4ef6\u6765\u8868\u793a\u7248\u672c\u53f7\uff0c\u5728\u5f15\u5165\u6587\u4ef6\u65f6\u53c8\u56e0 macOS \u4e0d\u533a\u5206\u6587\u4ef6\u5927\u5c0f\u5199\uff0c\u4ea7\u751f\u4e86\u51b2\u7a81\uff0c\u5bfc\u81f4\u7f16\u8bd1\u65f6\u62a5\u9519\u4e2d\u65ad\u3002\u6240\u4ee5\u540e\u9762\u6539\u6210\u4e86MYSQL_VERSION\n</code></pre> <ul> <li>./mysql-8.0.39/include/mysql_version.h.in \u6e90\u4ee3\u7801\u4e2d\u7684\u6a21\u7248\u6587\u4ef6\uff0c\u8fd9\u4e2a\u6587\u4ef6\u6ca1\u6709\u786c\u7f16\u7801\uff0c\u53ea\u662f\u5b9a\u4e49\u4e86\u4e00\u7cfb\u5217\u5b8f</li> <li>./mysql-8.0.39/MYSQL_VERSION \u7248\u672c\u6587\u4ef6\uff0c\u5b9a\u4e49\u4e86\u7248\u672c\u53f7\uff1aMYSQL_VERSION_MAJOR.MYSQL_VERSION_MINOR.MYSQL_VERSION_PATCH</li> <li>./mysql-8.0.39/build/include/mysql_version.h make \u4e4b\u540e\u751f\u6210\u7684\u7248\u672c\u6587\u4ef6</li> <li>./mysql-8.0.39/cmake/mysql_server.cmake \u7248\u672c\u6784\u5efa\u811a\u672c</li> </ul> <p>https://dev.mysql.com/doc/dev/mysql-server/8.0.40/mysql__version_8h_source.html</p> <p>https://cloud.tencent.com/developer/article/2223495</p> <pre><code>#define PROTOCOL_VERSION            10\n#define MYSQL_SERVER_VERSION       \"8.0.39\"\n#define MYSQL_BASE_VERSION         \"mysqld-8.0\"\n#define MYSQL_SERVER_SUFFIX_DEF    \"\"\n#define MYSQL_VERSION_ID            80039\n#define MYSQL_VERSION_STABILITY     \"LTS\"\n#define MYSQL_PORT                  3306\n#define MYSQL_ADMIN_PORT            33062\n#define MYSQL_PORT_DEFAULT          0\n#define MYSQL_UNIX_ADDR            \"/tmp/mysql.sock\"\n#define MYSQL_CONFIG_NAME          \"my\"\n#define MYSQL_PERSIST_CONFIG_NAME  \"mysqld-auto\"\n#define MYSQL_COMPILATION_COMMENT  \"Source distribution\"\n#define MYSQL_COMPILATION_COMMENT_SERVER  \"Source distribution\"\n#define LIBMYSQL_VERSION           \"8.0.39\"\n#define LIBMYSQL_VERSION_ID         80039\n</code></pre>"},{"location":"advanced/5.MySQL%E6%BA%90%E4%BB%A3%E7%A0%81%E8%B0%83%E8%AF%95%E7%8E%AF%E5%A2%83/#vscode-remote-ssh","title":"VSCODE REMOTE-SSH \u5de5\u4f5c\u539f\u7406","text":"<p>\u4ece\u5b98\u65b9\u4ecb\u7ecd\u6587\u6863\u4e2d\u7684\u8fd9\u5f20\u539f\u7406\u56fe\u6211\u4eec\u53ef\u4ee5\u770b\u5230\uff0c\u7528\u6237\u672c\u5730\u7684<code>VS Code</code>\u662f\u901a\u8fc7<code>SSH</code>\u901a\u9053\u8fde\u63a5\u5230\u8fdc\u7a0b\u4e3b\u673a\u7684\u3002\u7528\u6237\u7684\u5f00\u53d1\u4ee3\u7801\u3001\u8fd0\u884c\u73af\u5883\u3001\u8c03\u8bd5\u73af\u5883\u90fd\u662f\u5728\u8fdc\u7a0b\u4e3b\u673a\u4e0a\u3002</p> <p>\u8fdc\u7a0b\u8fde\u63a5\u662f\u57fa\u4e8e<code>Visual Studio Code Remote - SSH</code>\u8fd9\u4e2a\u6269\u5c55\u6765\u5b9e\u73b0\u7684\u3002</p> <p>\u5f53\u7528\u6237\u8fdb\u884c\u8fdc\u7a0b\u8fde\u63a5\u65f6\uff0c<code>VS Code</code>\u4f1a\u5728\u8fdc\u7a0b\u4e3b\u673a\u4e0a\u5b89\u88c5\u4e00\u4e2a server \u5305\uff0c\u8fd9\u4e2a\u5b89\u88c5\u8fc7\u7a0b\u662f\u5728\u9996\u6b21\u8fde\u63a5\u65f6\u81ea\u52a8\u5b8c\u6210\u7684\u3002\u7531\u4e8e Server \u5305\u662f\u5b89\u88c5\u548c\u8fd0\u884c\u5728\u8fdc\u7aef\u670d\u52a1\u5668\u4e0a\uff0c\u800c\u672c\u5730\u7684 VS Code \u53ea\u662f\u7f16\u8f91\u548c\u5c55\u793a\u7684\u7a97\u53e3\uff0c\u4e24\u8005\u4e4b\u95f4\u901a\u8fc7<code>SSH Tunnel</code>\u901a\u4fe1\uff0c\u56e0\u6b64\u5b9e\u9645\u7684\u5de5\u4f5c\u73af\u5883\u5b8c\u5168\u662f\u5728\u8fdc\u7aef\uff0c\u5982\u679c\u9700\u8981\u4f7f\u7528\u7b2c\u4e09\u65b9\u7684\u6269\u5c55\uff0c\u4e5f\u53ef\u4ee5\u76f4\u63a5\u5b89\u88c5\u5728\u8fdc\u7aef\u670d\u52a1\u5668\u73af\u5883\u3002</p> <p>1\u3001\u5177\u4f53\u7684\u8fde\u63a5\u8fc7\u7a0b\u5982\u4e0b\uff1a</p> <p>\u9996\u6b21\u8fde\u63a5\u65f6\uff0c\u4e0b\u8f7d<code>VS Code Server</code> \uff0c<code>VS Code Server</code>\u5305\u7684\u7248\u672c\u53d6\u51b3\u4e8e\u4f60\u672c\u5730\u4f7f\u7528\u7684<code>VS Code</code>\u7684\u7248\u672c\uff0c\u4e0b\u8f7d\u5730\u5740\u4e3a\uff1a</p> <pre><code>x86: https://update.code.visualstudio.com/commit:${commit_id}/server-linux-x64/stable\narm: https://update.code.visualstudio.com/commit:${commit_id}/server-linux-arm64/stable\n</code></pre> <p>\u5176\u4e2d<code>commit_id</code>\u662f\u53d8\u5316\u7684\uff0c\u6bcf\u4e2a\u4e0d\u540c\u7248\u672c\u7684<code>VS Code</code>\u7684<code>commit_id</code>\u90fd\u4e0d\u540c\uff0c\u53ef\u4ee5\u5728<code>VS Code</code>\u7684 Help -&gt; About \u4e2d\u67e5\u770b</p> <pre><code>[client]\nport    = 3306\nsocket = /usr/local/mysql/mysql.sock\n\n[mysql]\nprompt=\"\\u@\\h \\R:\\m:\\s [\\d]&gt; \"\nno-auto-rehash\n\n[mysqld]\nuser    = root\nport    = 3306\nadmin_address = 127.0.0.1\nbasedir = /usr/local/mysql\ndatadir = /data/mysql_data/\nsocket    = /usr/local/mysql/mysql.sock\npid-file = /usr/local/mysql/mysqld.pid\ncharacter-set-server = utf8mb4\n</code></pre>"},{"location":"basic/0.mysql_source/","title":"0. MySQL\u7684\u8d77\u6e90\u548c\u5206\u652f","text":""},{"location":"basic/0.mysql_source/#mysql","title":"MySQL\u7684\u524d\u4e16\u4eca\u751f","text":"<p>MySQL\u7684\u6d77\u8c5a\u6807\u5fd7\u7684\u540d\u5b57\u53eb\"sakila\"\uff0c\u5b83\u662f\u7531MySQL AB\u516c\u53f8\u7684\u521b\u59cb\u4eba\u4ece\u7528\u6237\u5728\"\u6d77\u8c5a\u547d\u540d\"\u7684\u7ade\u8d5b\u4e2d\u5efa\u8bae\u7684\u5927\u91cf\u7684\u540d\u5b57\u8868\u4e2d\u9009\u51fa\u7684\u3002</p> <p>\u83b7\u80dc\u7684\u540d\u5b57\u662f\u7531\u6765\u81ea\u975e\u6d32\u65af\u5a01\u58eb\u5170\u7684\u5f00\u6e90\u8f6f\u4ef6\u5f00\u53d1\u8005Ambrose Twebaze\u63d0\u4f9b\u3002</p> <p>\u6839\u636eAmbrose\u6240\u8bf4\uff0cSakila\u6765\u81ea\u4e00\u79cd\u53ebSiSwati\u7684\u65af\u5a01\u58eb\u5170\u65b9\u8a00\uff0c\u4e5f\u662f\u5728Ambrose\u7684\u5bb6\u4e61\u4e4c\u5e72\u8fbe\u9644\u8fd1\u7684\u5766\u6851\u5c3c\u4e9a\u7684Arusha\u7684\u4e00\u4e2a\u5c0f\u9547\u7684\u540d\u5b57\u3002</p>"},{"location":"basic/0.mysql_source/#_1","title":"\u521d\u671f\u5f00\u6e90\u6570\u636e\u5e93\u9636\u6bb5","text":"<p>MySQL\u7684\u5386\u53f2\u6700\u65e9\u53ef\u4ee5\u8ffd\u6eaf\u52301979\u5e74\uff0c\u6709\u4e00\u4e2a\u4eba\u53ebMonty Widenius, \u4e3a\u4e00\u4e2a\u53ebTcX\u7684\u5c0f\u516c\u53f8\u6253\u5de5\uff0c\u5e76\u7528BASIC\u8bbe\u8ba1\u4e86\u4e00\u4e2a\u62a5\u8868\u5de5\u5177\uff0c\u53ef\u4ee5\u57284M\u4e3b\u9891\u548c16KB\u5185\u5728\u7684\u8ba1\u7b97\u673a\u4e0a\u8fd0\u884c\u3002</p> <p>\u8fc7\u4e86\u4e0d\u4e45\uff0c\u4ed6\u53c8\u4f7f\u7528C\u8bed\u8a00\u91cd\u5199\u6b64\u5de5\u5177\uff0c\u79fb\u690d\u5230Unix\u5e73\u53f0\uff0c\u5f53\u65f6\uff0c\u5b83\u53ea\u662f\u4e00\u4e2a\u5f88\u5e95\u5c42\u7684\u9762\u5411\u62a5\u8868\u7684\u5b58\u50a8\u5f15\u64ce\u3002\u8fd9\u4e2a\u5de5\u5177\u53eb\u505aUnireg\u3002</p> <p>1985 \u5e74\uff0c\u745e\u5178\u7684\u51e0\u4f4d\u5fd7\u540c\u9053\u5408\u5c0f\u4f19\u5b50\uff08\u4ee5David Axmark \u4e3a\u9996\uff09 \u6210\u7acb\u4e86\u4e00\u5bb6\u516c\u53f8\uff0c\u8fd9\u5c31\u662fMySQL AB \u7684\u524d\u8eab\u3002</p> <p>\u8fd9\u4e2a\u516c\u53f8\u6700\u521d\u5e76\u4e0d\u662f\u4e3a\u4e86\u5f00\u53d1\u6570\u636e\u5e93\u4ea7\u54c1\uff0c\u800c\u662f\u5728\u5b9e\u73b0\u4ed6\u4eec\u60f3\u6cd5\u7684\u8fc7\u7a0b\u4e2d\uff0c\u9700\u8981\u4e00\u4e2a\u6570\u636e\u5e93\u3002\u4ed6\u4eec\u5e0c\u671b\u80fd\u591f\u4f7f\u7528\u5f00\u6e90\u7684\u4ea7\u54c1\u3002</p> <p>\u4f46\u5728\u5f53\u65f6\u5e76\u6ca1\u6709\u4e00\u4e2a\u5408\u9002\u7684\u9009\u62e9\uff0c\u6ca1\u529e\u6cd5\uff0c\u90a3\u5c31\u81ea\u5df1\u5f00\u53d1\u5427\u3002</p> <p>\u5728\u6700\u521d\uff0c\u4ed6\u4eec\u53ea\u662f\u81ea\u5df1\u8bbe\u8ba1\u4e86\u4e00\u4e2a\u5229\u7528\u7d22\u5f15\u987a\u5e8f\u5b58\u53d6\u6570\u636e\u7684\u65b9\u6cd5\uff0c\u4e5f\u5c31\u662fISAM\uff08Indexed Sequential Access Method\uff09\u5b58\u50a8\u5f15\u64ce\u6838\u5fc3\u7b97\u6cd5\u7684\u524d\u8eab\uff0c\u5229\u7528 ISAM \u7ed3\u5408 mSQL \u6765\u5b9e\u73b0\u4ed6\u4eec\u7684\u5e94\u7528\u9700\u6c42\u3002</p> <p>\u5728\u65e9\u671f\uff0c\u4ed6\u4eec\u4e3b\u8981\u662f\u4e3a\u745e\u5178\u7684\u4e00\u4e9b\u5927\u578b\u96f6\u552e\u5546\u63d0\u4f9b\u6570\u636e\u4ed3\u5e93\u670d\u52a1\u3002\u5728\u7cfb\u7edf\u4f7f\u7528\u8fc7\u7a0b\u4e2d\uff0c\u968f\u7740\u6570\u636e\u91cf\u8d8a\u6765\u8d8a\u5927\uff0c\u7cfb\u7edf\u590d\u6742\u5ea6\u8d8a\u6765\u8d8a\u9ad8\uff0cISAM \u548cmSQL \u7684\u7ec4\u5408\u9010\u6e10\u4e0d\u582a\u91cd\u8d1f\u3002</p> <p>\u5728\u5206\u6790\u6027\u80fd\u74f6\u9888\u4e4b\u540e\uff0c\u4ed6\u4eec\u53d1\u73b0\u95ee\u9898\u51fa\u5728 mSQL \u4e0a\u9762\u3002\u4e0d\u5f97\u5df2\uff0c\u4ed6\u4eec\u629b\u5f03\u4e86mSQL\uff0c\u91cd\u65b0\u5f00\u53d1\u4e86\u4e00\u5957\u529f\u80fd\u7c7b\u4f3c\u7684\u6570\u636e\u5b58\u50a8\u5f15\u64ce\uff0c\u8fd9\u5c31\u662f ISAM \u5b58\u50a8\u5f15\u64ce\u3002</p> <p>\u5927\u5bb6\u53ef\u80fd\u5df2\u7ecf\u6ce8\u610f\u5230\u4ed6\u4eec\u5f53\u65f6\u7684\u4e3b\u8981\u5ba2\u6237\u662f\u6570\u636e\u4ed3\u5e93\uff0c\u5e94\u8be5\u4e5f\u5bb9\u6613\u7406\u89e3\u4e3a\u4ec0\u4e48\u76f4\u81f3\u73b0\u5728\uff0cMySQL \u6700\u64c5\u957f\u7684\u662f\u67e5\u8be2\u6027\u80fd\uff0c\u800c\u4e0d\u662f\u4e8b\u52a1\u5904\u7406\uff08\u9700\u8981\u501f\u52a9\u7b2c\u4e09\u65b9\u5b58\u50a8\u5f15\u64ce\uff09\u3002</p> <p>1990\u5e74\uff0cTcX\u7684customer \u4e2d\u5f00\u59cb\u6709\u4eba\u8981\u6c42\u8981\u4e3a\u5b83\u7684API\u63d0\u4f9bSQL\u652f\u6301\uff0c\u5f53\u65f6\uff0c\u6709\u4eba\u60f3\u5230\u4e86\u76f4\u63a5\u4f7f\u7528\u5546\u7528\u6570\u636e\u5e93\u7b97\u4e86\uff0c\u4f46\u662fMonty\u89c9\u5f97\u5546\u7528\u6570\u636e\u5e93\u7684\u901f\u5ea6\u96be\u4ee4\u4eba\u6ee1\u610f\u3002</p> <p>\u4e8e\u662f\uff0c\u4ed6\u76f4\u63a5\u501f\u52a9\u4e8emSQL\u7684\u4ee3\u7801\uff0c\u5c06\u5b83\u96c6\u6210\u5230\u81ea\u5df1\u7684\u5b58\u50a8\u5f15\u64ce\u4e2d\u3002\u4f46\u4e0d\u5de7\u7684\u662f\uff0c\u6548\u679c\u5e76\u4e0d\u592a\u597d\u3002\u4e8e\u662f,Monty\u96c4\u5fc3\u5927\u8d77\uff0c\u51b3\u5fc3\u81ea\u5df1\u91cd\u5199\u4e00\u4e2aSQL\u652f\u6301\u3002</p> <p>1996\u5e74\uff0cMySQL 1.0\u53d1\u5e03, \u5728\u5c0f\u8303\u56f4\u5185\u4f7f\u7528\u3002\u5230\u4e8696\u5e7410\u6708\uff0cMySQL 3.11.1\u53d1\u5e03\u4e86\uff0c\u6ca1\u67092.x\u7248\u672c\u3002</p> <p>\u6700\u5f00\u59cb\uff0c\u53ea\u63d0\u4f9b\u4e86Solaris\u4e0b\u7684\u4e8c\u8fdb\u5236\u7248\u672c\u3002\u4e00\u4e2a\u6708\u540e\uff0cLinux\u7248\u672c\u51fa\u73b0\u4e86\u3002 \u6b64\u65f6\u7684MySQL\u8fd8\u975e\u5e38\u7b80\u964b\uff0c\u9664\u4e86\u5728\u4e00\u4e2a\u8868\u4e0a\u505a\u4e00\u4e9bInsert\uff0cUpdate\uff0cDelete\u548cSelect \u64cd\u4f5c\u804c\u4f4d\uff0c\u6ca1\u6709\u5176\u4ed6\u66f4\u591a\u7684\u529f\u80fd\u3002</p> <p>\u7d27\u63a5\u4e0b\u6765\u7684\u4e24\u5e74\u91cc\uff0cMySQL\u4f9d\u6b21\u79fb\u690d\u5230\u5404\u4e2a\u5e73\u53f0\u4e0b\u3002\u5b83\u53d1\u5e03\u65f6\uff0c\u91c7\u7528\u7684\u8bb8\u53ef\u7b56\u7565\uff0c\u6709\u4e9b\u4e0e\u4f17\u4e0d\u540c\uff1a\u5141\u8bb8\u514d\u8d39\u5546\u7528\uff0c\u4f46\u662f\u4e0d\u80fd\u5c06MySQL\u4e0e\u81ea\u5df1\u7684\u4ea7\u54c1\u7ed1\u5b9a\u5728\u4e00\u8d77\u53d1\u5e03\u3002</p> <p>\u5982\u679c\u60f3\u4e00\u8d77\u53d1\u5e03\uff0c\u5c31\u5fc5\u987b\u4f7f\u7528\u7279\u6b8a\u8bb8\u53ef\uff0c\u610f\u5473\u7740\u8981\u82b1\u94f6\u5b50\u3002\u5f53\u7136\uff0c\u5546\u4e1a\u652f\u6301\u4e5f\u662f\u9700\u8981\u82b1\u94f6\u5b50\u7684\u3002\u5176\u5b83\u7684\uff0c\u968f\u7528\u6237\u600e\u4e48\u7528\u90fd\u53ef\u4ee5\u3002\u8fd9\u79cd\u7279\u6b8a\u8bb8\u53ef\u4e3aMySQL\u5e26\u6765\u4e86\u4e00\u4e9b\u6536\u5165\uff0c\u4ece\u800c\u4e3a\u5b83\u7684\u6301\u7eed\u53d1\u5c55\u6253\u4e0b\u4e86\u826f\u597d\u7684\u57fa\u7840\u3002</p> <p>1999-2000\u5e74\uff0c\u6709\u4e00\u5bb6\u516c\u53f8\u5728\u745e\u5178\u6210\u7acb\u4e86\uff0c\u53ebMySQL AB\u3002\u00a0\u96c7\u4e86\u51e0\u4e2a\u4eba\uff0c\u4e0eSleepycat\u5408\u4f5c\uff0c\u5f00\u53d1\u51fa\u4e86 Berkeley DB\u5f15\u64ce\uff0c\u56e0\u4e3aBDB\u652f\u6301\u4e8b\u52a1\u5904\u7406\uff0c\u6240\u4ee5\uff0cMySQL\u4ece\u6b64\u5f00\u59cb\u652f\u6301\u4e8b\u52a1\u5904\u7406\u4e86\u3002</p> <p>\u57282000 \u5e74\u7684\u65f6\u5019\uff0cMySQL \u516c\u5e03\u4e86\u81ea\u5df1\u7684\u6e90\u4ee3\u7801\uff0c\u5e76\u91c7\u7528GPL\uff08GNU General Public License\uff09\u8bb8\u53ef\u534f\u8bae\uff0c\u6b63\u5f0f\u8fdb\u5165\u5f00\u6e90\u4e16\u754c\u3002</p> <p>2000\u5e744\u6708\uff0cMySQL\u5bf9\u65e7\u7684\u5b58\u50a8\u5f15\u64ce\u8fdb\u884c\u4e86\u6574\u7406\uff0c\u547d\u540d\u4e3aMyISAM\u3002</p> <p>2001\u5e74\uff0cHeikiki Tuuri\u5411MySQL\u63d0\u51fa\u5efa\u8bae\uff0c\u5e0c\u671b\u80fd\u96c6\u6210\u4ed6\u4eec\u7684\u5b58\u50a8\u5f15\u64ceInnoDB\uff0c\u8fd9\u4e2a\u5f15\u64ce\u540c\u6837\u652f\u6301\u4e8b\u52a1\u5904\u7406\uff0c\u8fd8\u652f\u6301\u884c\u7ea7\u9501\u3002</p> <p>\u6240\u4ee5\u57282001\u5e74\u53d1\u5e03\u76843.23 \u7248\u672c\u7684\u65f6\u5019\uff0c\u8be5\u7248\u672c\u5df2\u7ecf\u652f\u6301\u5927\u591a\u6570\u7684\u57fa\u672c\u7684SQL \u64cd\u4f5c\uff0c\u800c\u4e14\u8fd8\u96c6\u6210\u4e86MyISAM\u548cInnoDB \u5b58\u50a8\u5f15\u64ce\u3002MySQL\u4e0eInnoDB\u7684\u6b63\u5f0f\u7ed3\u5408\u7248\u672c\u662f4.0\u3002</p> <p>2004\u5e7410\u6708\uff0c\u53d1\u5e03\u4e86\u7ecf\u5178\u76844.1\u7248\u672c\u3002 </p> <p>2005\u5e7410\u6708\uff0c\u6709\u53d1\u5e03\u4e86\u91cc\u7a0b\u7891\u7684\u4e00\u4e2a\u7248\u672c\uff0cMySQL 5.0\u3002\u57285.0\u4e2d\u52a0\u5165\u4e86\u6e38\u6807\uff0c\u5b58\u50a8\u8fc7\u7a0b\uff0c\u89e6\u53d1\u5668\uff0c\u89c6\u56fe\u548c\u4e8b\u52a1\u7684\u652f\u6301\u3002\u57285.0 \u4e4b\u540e\u7684\u7248\u672c\u91cc\uff0cMySQL\u660e\u786e\u5730\u8868\u73b0\u51fa\u8fc8\u5411\u9ad8\u6027\u80fd\u6570\u636e\u5e93\u7684\u53d1\u5c55\u6b65\u4f10\u3002</p>"},{"location":"basic/0.mysql_source/#sunoracle","title":"SUN\u548cOracle\u53d1\u5c55\u9636\u6bb5","text":"<p>2008\u5e741\u670816\u53f7 MySQL\u88abSun\u516c\u53f8\u6536\u8d2d\u3002</p> <p>2009\u5e7404\u670820\u65e5Oracle\u6536\u8d2dSun \u516c\u53f8\uff0cMySQL \u8f6c\u5165Oracle \u95e8\u4e0b\u3002</p> <p>\u88ab\u7532\u9aa8\u6587\u516c\u53f8\u6536\u8d2d\u540e\uff0cOracle\u5927\u5e45\u8c03\u6da8MySQL\u5546\u4e1a\u7248\u7684\u552e\u4ef7\uff0c\u4e14\u7532\u9aa8\u6587\u516c\u53f8\u4e0d\u518d\u652f\u6301\u53e6\u4e00\u4e2a\u81ea\u7531\u8f6f\u4ef6\u9879\u76eeOpenSolaris\u7684\u53d1\u5c55\u3002</p> <p>\u56e0\u6b64\u5bfc\u81f4\u81ea\u7531\u8f6f\u4ef6\u793e\u7fa4\u4eec\u5bf9\u4e8eOracle\u662f\u5426\u8fd8\u4f1a\u6301\u7eed\u652f\u6301MySQL\u793e\u533a\u7248\uff08MySQL\u4e4b\u4e2d\u552f\u4e00\u7684\u514d\u8d39\u7248\u672c\uff09\u6709\u6240\u9690\u5fe7\uff0cMySQL\u7684\u521b\u59cb\u4eba\u9ea6\u514b\u5c14\u00b7\u7ef4\u5fb7\u7ebd\u65af\u4ee5MySQL\u4e3a\u57fa\u7840\uff0c\u6210\u7acb\u5206\u652f\u8ba1\u5212MariaDB\u3002</p> <p>2010\u5e7404\u670822\u65e5\uff0cOracle\u53d1\u5e03\u4e86MySQL 5.5\u3002\u81ea\u6b64\uff0cMySQL \u8fdb\u5165\u4e86\u53d1\u5c55\u7684\u5feb\u8f66\u9053\uff0c\u6210\u4e3a\u4e86\u6700\u6d41\u884c\u7684\u6570\u636e\u5e93\u3002</p> <p>MySQL, the most popular Open Source SQL database management system, is developed, distributed, and supported by Oracle Corporation.</p> <p>MySQL\u6709\u5f88\u591a\u5206\u652f\uff0c\u5176\u4e2dPercona Server for MySQL\u662f \u4e00\u4e2a\u975e\u5e38\u4f18\u79c0\u7684MySQL\u5206\u652f\uff0c\u5b83\u5b8c\u5168\u517c\u5bb9Oracle\u5b98\u65b9\u7684MySQL Server\u3002</p> <p>Percona Server for MySQL\u548cMySQL\u7684\u5173\u7cfb:</p> <ul> <li> <p>Percona Server for MySQL\u662f\u57fa\u4e8eMySQL\u793e\u533a\u7248\u7684\u6e90\u7801\u8fdb\u884c\u4e8c\u6b21\u5f00\u53d1\u800c\u4ea7\u751f\u7684\uff1b</p> </li> <li> <p>Percona Server for MySQL\u4fee\u590d\u4e86MySQL\u4e2d\u4e00\u4e9b\u5df2\u77e5\u7684bug\uff1b</p> </li> <li> <p>Percona Server for MySQL\u8fdb\u884c\u4e86\u529f\u80fd\u548c\u6027\u80fd\u7684\u589e\u5f3a\uff1b</p> </li> <li> <p>\u9664\u975e\u542f\u52a8\u4e86\u67d0\u4e9b\u7279\u6b8a\u7684\u529f\u80fd\uff0c Percona Server for MySQL\u548cMySQL\u53ef\u4ee5\u65e0\u7f1d\u8fdb\u884c\u5207\u6362\u3002</p> </li> </ul>"},{"location":"basic/0.mysql_source/#_2","title":"\u5404\u79cd\u5206\u652f\u6d41\u6d3e","text":""},{"location":"basic/0.mysql_source/#percona","title":"percona\u7b80\u4ecb","text":"<p>Percona\u662f\u539fMySQL\u8fd0\u7ef4\u90e8\u603b\u76d1Peter\u548cVadim\u57282006\u5e74\u79bb\u5f00\u540e\u521b\u5efa\u7684\uff0c\u56e0\u5176\u672c\u8eab\u662f\u8fd0\u7ef4\u51fa\u8eab\uff0c\u6240\u4ee5\u4ed6\u505a\u7684\u8fd9\u4e2a\u5206\u652f\u57fa\u672c\u4e0a\u4e5f\u662f\u4e3a\u8fd0\u7ef4\u4eba\u5458\u670d\u52a1\u7684\u3002</p> <p>\u4e00\u4e9bDB\u5e38\u7528\u7684\u5de5\u5177XtraBackup\u548cPercona Toolkit\uff0c\u90fd\u662f\u51fa\u81ea\u6b64\u516c\u53f8\u3002</p> <p>\u8fd9\u5bb6\u516c\u53f8\u58f0\u79f0\u4ed6\u4eec\u63d0\u4f9b\u7684\u8f6f\u4ef6\u90fd\u662f\u514d\u8d39\u7684\uff0c\u4ed6\u4eec\u7684\u6536\u5165\u4e3b\u8981\u6765\u4e0e\u5f00\u6e90\u793e\u533a\uff0c\u4f01\u4e1a\u7684\u652f\u6301\uff0c\u4ee5\u53ca\u4f7f\u7528\u4ed6\u4eec\u8f6f\u4ef6\u7684\u516c\u53f8\u7684\u652f\u4ed8\u4ed6\u4eec\u63d0\u4f9bsupport\u7684\u8d39\u7528\u3002</p> <p>Percona\u516c\u53f8\u6700\u4e3b\u8981\u7684\u4ea7\u54c1\u8fd8\u662fMySQL\u5206\u652f\u4ea7\u54c1\uff1aPercona Server\u3002Percona Server \u58f0\u79f0\u53ef\u4ee5\"\u5b8c\u5168\u4e0e MySQL \u517c\u5bb9\"\uff0c\u8fd9\u662f\u4e0e\u5176\u4ed6\u66f4\u6539\u4e86\u5927\u91cf\u57fa\u672c\u6838\u5fc3 MySQL \u4ee3\u7801\u7684\u5206\u652f\u7684\u6700\u5927\u533a\u522b\u3002\u56e0\u6b64\u4ece\u7406\u8bba\u4e0a\u8bb2\uff0c\u4eceMysql\u8fc1\u79fb\u5230Percona Server\uff0c\u65e0\u9700\u66f4\u6539\u7a0b\u5e8f\u4e2d\u7684\u4efb\u4f55\u4ee3\u7801\u3002</p> <p>Percona\u516c\u53f8\u5728MySQL\u6570\u636e\u5e93\u4f18\u5316\u65b9\u9762\u505a\u4e86\u975e\u5e38\u591a\u7684\u5de5\u4f5c\uff0c\u4f8b\u5982\uff0cPercona Server\u5728\u5b98\u65b9InnoDB\u5b58\u50a8\u5f15\u64ce\u7684\u57fa\u7840\u4e0a\u5f00\u53d1\u4e86XtraDB\u5b58\u50a8\u5f15\u64ce\uff0c\u53ef\u4ee5\u8ba4\u4e3aXtraDB\u662fInnoDB\u5b58\u50a8\u5f15\u64ce\u7684\u589e\u5f3a\u7248\u3002</p> <p>\u4e0eMySQL5.1\u5185\u7f6e\u7684InnoDB\u76f8\u6bd4\uff0c\u5355\u4f4d\u65f6\u95f4\u6267\u884c\u4e8b\u52a1\u6570\u91cf\u662f\u540e\u8005\u76842.7\u500d\u3002XtraDB\u5f15\u64ce\u80fd\u505a\u5230\u7684\u5411\u4e0b\u517c\u5bb9\uff0c\u521b\u5efa\u6570\u636e\u8868\u7684\u65f6\u5019\uff0cInnoDB\u5f15\u64ce\u4f1a\u81ea\u52a8\u88ab\u66ff\u6362\u6210XtraDB\u5f15\u64ce\uff0c\u7528\u6237\u548c\u5ba2\u6237\u7aef\u6839\u672c\u611f\u89c9\u4e0d\u5230\u533a\u522b\u3002(\u6ce8\u610f\u8fd9\u91cc\u53ea\u662f\u8bf4Mysql 5.1\u7684\u60c5\u51b5\uff0c\u73b0\u5728MySQL\u5df2\u7ecf\u53d1\u5c55\u52308.0\u4e86\uff0c\u60c5\u51b5\u5df2\u7ecf\u4e0d\u540c)\u3002</p> <p>\u5b8c\u5168\u517c\u5bb9Mysql\u610f\u5473\u7740\uff0cPercona Server\u9700\u8981\u8ddf\u7740Mysql \u5b98\u65b9\u7248\u672c\u4e00\u8d77\u6f14\u8fdb\u3002</p> <p>Percona Server\u91c7\u53d6\u7684\u7b56\u7565\u662f\uff1a\u5148\u517c\u5bb9MySQL\u7136\u540e\u518d\u8fdb\u884c\u4f18\u5316\uff0c\u6240\u4ee5\u7528\u6237\u53ef\u4ee5\u5f88\u5bb9\u6613\u7684\u4eceMySQL\u8fc1\u79fb\u5230Percona Server\u4e0a\u9762\uff0c\u800c\u4e0d\u7528\u53bb\u8003\u8651\u517c\u5bb9\u6027\u7684\u95ee\u9898\u3002Percona Server\u4f1a\u5728\u6bcf\u4e2a\u5b98\u65b9\u7248\u672c\u7684\u57fa\u7840\u4e0a\uff0c\u6dfb\u52a0\u4e00\u4e9b\u65b0\u7684\u529f\u80fd\u7279\u6027\u3002</p> <p>Percona Server \u548c Oracle MySQL Server \u7684\u5bf9\u6bd4</p> <p>\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0cPercona Server \u867d\u7136\u662f\u5f00\u6e90\u7684\uff0c\u4f46\u662f\u4ed6\u4eec\u81ea\u5df1\u7ba1\u7406\u4ee3\u7801\uff0c\u4e0d\u63a5\u53d7\u5916\u90e8\u5f00\u53d1\u4eba\u5458\u7684\u8d21\u732e\uff0c\u4ee5\u8fd9\u79cd\u65b9\u5f0f\u786e\u4fdd\u4ed6\u4eec\u5bf9\u4ea7\u54c1\u4e2d\u6240\u5305\u542b\u529f\u80fd\u7684\u63a7\u5236\u3002</p>"},{"location":"basic/0.mysql_source/#mariadb","title":"MariaDB\u7b80\u4ecb","text":"<p>MariaDB \u7684\u4e3b\u8981\u521b\u5efa\u8005\u662f Monty Widenius\uff0c\u4e5f\u662f MySQL \u7684\u521d\u59cb\u521b\u5efa\u8005\u30022008\u5e74Sun\u4ee510\u4ebf\u7f8e\u91d1\u6536\u8d2dMySQL\uff0c\u7ed3\u679cSun\u53c8\u628aMicrosystems\u548cMySQL\u8f6c\u624b\u5356\u7ed9Oracle\uff0cMonty\u6124\u800c\u51fa\u8d70\uff0c\u521b\u7acbMariaDB\u5206\u652f\u3002</p> <p>\u4ece\u67d0\u79cd\u7a0b\u5ea6\u6765\u8bf4\uff0c\u53ef\u80fdMariaDB\u624d\u662f\u4e00\u8109\u76f8\u627f\u8fc7\u6765\u7684\u539f\u6c41\u539f\u5473\u7684MySQL\u3002(\u51fa\u8d70\u4e5f\u8bb8\u662f\u56e0\u4e3a\u62c5\u5fc3 Oracle \u662f\u5426\u4f1a\u6295\u5165\u7cbe\u529b\uff0c\u6765\u4fdd\u6301MySql\u5728\u6570\u636e\u5e93\u9886\u57df\u7684\u9886\u5148\u5730\u4f4d)</p> <p>\u4e0ePercona Server\u4e0d\u540c\uff0cMariaDB\u662f\u4e00\u4e2a\"\u5f00\u653e\"\u7684\u5206\u652f\uff0cMonty\u4e3a\u4e86\u907f\u514d\u5b83\u95ed\u6e90\u7279\u522b\u6210\u7acb\u4e86\u4e00\u4e2a\u57fa\u91d1\u4f1a( https://mariadb.org/)\uff0c\u628aMariaDB\u653e\u5728\u57fa\u91d1\u4f1a\u91cc\uff0c\u57fa\u91d1\u4f1a\u65e0\u6cd5\u8fdb\u884c\u5546\u4e1a\u6d3b\u52a8\uff0c\u4e5f\u5c31\u4e0d\u4f1a\u6b65MySQL\u7684\u540e\u5c18\u3002</p> <p>\u5f53\u7136\uff0c\u4e5f\u6709\u4e00\u4e2a\u5bf9\u5e94\u7684 MariaDB\u516c\u53f8\uff0c\u63d0\u4f9b\u5185\u90e8QA\u7a33\u5b9a\u6027\u6d4b\u8bd5\u3001\u5546\u4e1a\u5957\u4ef6\u3001\u8ba2\u9605\u670d\u52a1\u3001\u57f9\u8bad\u3001\u751a\u81f3\u5b9a\u5236\u5316\u5f00\u53d1\u670d\u52a1\u7b49\uff0c\u6240\u4ee5\u5373\u4f7fMariaDB\u8fd9\u4e2a\u516c\u53f8\u88ab\u6536\u8d2d\u4e86\uff0c\u4e5f\u4e0d\u4f1a\u5f71\u54cd\u5230MariaDB\u672c\u8eab\u7684\u53d1\u5c55\u3002</p> <p>MariaDB\u57fa\u91d1\u4f1a\u5206\u4e3a\u767d\u91d1\u3001\u91d1\u724c\u548c\u94dc\u724c\u4e09\u4e2a\u7ea7\u522b\u7684\u8d5e\u52a9\u4f1a\u5458\uff0c\u666e\u904d\u6765\u81ea\u4e8eMariaDB\u9879\u76ee\u7684\u8d21\u732e\u8005\u6216\u7528\u6237\u3002\u503c\u5f97\u4e00\u63d0\u7684\u662f\uff0c\u57282017\u5e74\u76843\u6708\u4e0e6\u6708\uff0c\u963f\u91cc\u4e91\u548c\u817e\u8baf\u4e91\u5148\u540e\u6210\u4e3aMariaDB\u7684\u767d\u91d1\u8d5e\u52a9\u5546\u3002</p> <p>\u5728\u65e9\u671f\uff0cMariaDB \u8fd8\u58f0\u79f0\u81ea\u5df1\u662f MySQL \u7684\u66ff\u4ee3\uff0c\u4ece MySQL \u5207\u6362\u5230 MariaDB \u65f6\uff0c\u65e0\u9700\u66f4\u6539\u4efb\u4f55\u57fa\u672c\u4ee3\u7801\u3002\u7136\u800c\u4f17\u591a\u56e0\u7d20\uff0c\u5bfc\u81f4MariaDB\u8fd9\u4e2a\u5206\u652f\u4e0a\u4e5f\u6bd4\u5b98\u65b9MySQL\u8d70\u5f97\u66f4\u5feb\u4e00\u4e9b\uff0c\u5bf9\u5185\u6838\u8fdb\u884c\u4e86\u5927\u91cf\u7684\u4fee\u6539\u3002\u8fd9\u91cc\u6709\u4f17\u591a\u56e0\u7d20\uff1a</p> <ul> <li>MariaDB \u81ea\u8eab\"\u5f00\u653e\"\u7684\u5b9a\u4f4d</li> <li>\u57fa\u91d1\u4f1a\u7684\u8d5e\u52a9\u5546\u7684\u63a8\u52a8</li> </ul> <p>\u867d\u8bf4\u57fa\u91d1\u4f1a\u4e0d\u80fd\u8fdb\u884c\u5546\u4e1a\u6d3b\u52a8\uff0c\u4f46\u662f\u5982\u963f\u91cc\u4e91/\u817e\u8baf\u4e91\uff0c\u672c\u8eab\u4e5f\u662f\u516c\u6709\u4e91\u7684\u63d0\u4f9b\u5546\uff0c\u9762\u5bf9\u5927\u91cf\u7684\u4e2d\u5c0f\u4f01\u4e1a\u5ba2\u6237\u9700\u6c42\uff0c\u4ed6\u4eec\u5728\u6570\u636e\u5e93\u5c42\u9762\u6240\u6709\u7684\u529f\u80fd\u6539\u8fdb\u6216\u8005bugfix\uff0c\u8d21\u732e\u7ed9\u57fa\u91d1\u4f1a\u7684\u65f6\u5019\uff0c\u66f4\u5bb9\u6613\u88ab\u91c7\u7eb3\u3002 </p> <p>\u8fd9\u610f\u5473\u7740\uff0c\u5b9e\u9645\u4e0aMaridb\u9ad8\u7248\u672c\u5df2\u7ecf\u4e0d\u662f100%\u517c\u5bb9 Oracle MySQL \u5b98\u65b9\u7248\u672c\u4e86\u3002</p>"},{"location":"basic/0.mysql_source/#_3","title":"\u5982\u4f55\u9009\u62e9\u5408\u9002\u7684\u5206\u652f","text":"<p>\u6beb\u65e0\u7591\u95ee\uff0cOracle \u5b98\u65b9 MySQL \u662f\u4e00\u6b3e\u975e\u5e38\u51fa\u8272\u7684\u4ea7\u54c1\uff0c\u662f\u4e00\u4e2a\u975e\u5e38\u9002\u5408\u5927\u591a\u6570\u4f7f\u7528\u60c5\u51b5\u7684\u6570\u636e\u5e93\u3002\u4ece DB-Engines Ranking \u4e0a\uff0c\u53ef\u4ee5\u770b\u5230\u5b98\u65b9\u7684 MySQL \u9ad8\u5c45\u7b2c2\uff0cMariaDB \u6392\u540d\u572815\uff0cPercona Server for MySQL \u751a\u81f3\u6ca1\u6709\u51fa\u73b0\u5728\u622a\u56fe\u4e0a(\u6392\u540d90)\u3002</p> <p>MariaDB \u6392\u540d\u5982\u6b64\u4e4b\u9ad8\uff0c\u539f\u56e0\u6709\u5f88\u591a\uff1a\u81ea\u8eab\u7684\u529f\u80fd\u7279\u6027\uff0c\u540c\u65f6\u662fRed Hat\u3001SUSE\u7b49\u63d0\u4f9b\u7684LAMP\u67b6\u6784\u5b89\u88c5\u5305\u7684\u9ed8\u8ba4\u6570\u636e\u5e93\uff0c\u8fd8\u6709\u4e00\u4e9b\u8d5e\u52a9\u5546\u662f\u516c\u6709\u4e91\u5382\u5546\u3002</p> <p>\u5bf9\u4e8e\u4e00\u4e9b\u6ca1\u6709\u6570\u636e\u5e93\u5185\u6838\u7814\u53d1\u80fd\u529b\u7684\u56e2\u961f\uff0c\u8fd8\u662f\u5efa\u8bae\u4f7f\u7528Percona Server\u6216\u5b98\u65b9\u7684Oracle MySQL\u3002</p> <p>Percona Server\u867d\u7136\u6392\u540d\u662f\u6700\u9760\u540e\u7684\uff0c\u4e5f\u8bb8\u662f\u5927\u591a\u6570DBA\u6700\u559c\u7231\u7684\uff0c\u56fd\u5185\u5f88\u591a\u5927\u578b\u4e92\u8054\u7f51\u516c\u53f8\u90fd\u4f7f\u7528Percona Server\u3002</p> <p>\u539f\u56e0\u5728\u4e8e\uff1aMariaDB\u65b0\u7279\u6027\u5f88\u591a\uff0c\u6709\u5f88\u591a\u65b0\u529f\u80fd\uff0c\u5176\u5b9e\u6709\u4e9b\u6211\u4eec\u4e0d\u9700\u8981\uff0c\u8fd8\u5bb9\u6613\u51fabug\u3002Percona Server\u5206\u652f\u66f4\u7a33\u5b9a\uff0c\u5bf9DBA\u8fd0\u7ef4\u66f4\u52a0\u53cb\u597d\u3002</p> <p>\u90a3\u4e3a\u4ec0\u4e48Percona Server\u6392\u540d\u8fd9\u4e48\u4f4e\u5462\uff1f\u8fd9\u53ef\u80fd\u4e0ePercona Server\u7684\u5b9a\u4f4d\u6709\u5173\uff0c\u5176\u53ea\u652f\u6301Linux\u64cd\u4f5c\u7cfb\u7edf\uff0c\u4f5c\u4e3a\u751f\u4ea7\u6570\u636e\u5e93\u4f7f\u7528\u3002</p> <p>\u800c\u5b98\u65b9MySQL\u3001MariaDB\u90fd\u652f\u6301\u591a\u79cd\u64cd\u4f5c\u7cfb\u7edf\uff0c\u4f8b\u5982Windows\u3001OS X\u3001Solaris\u7b49\uff0c\u65e0\u7591\u6269\u5927\u4e86\u53d7\u4f17\u3002</p> <p>\u53e6\u5916\uff0c\u5bf9\u4e8e\u5b98\u65b9MySQL\u3001MariaDB\u90fd\u6709\u516c\u6709\u4e91\u5382\u5546\u5c06\u5176\u4ee5DBSaaS\u7684\u65b9\u5f0f\u63d0\u4f9b\u670d\u52a1\uff0c\u4f46\u662f\uff0c\u6ca1\u6709\u516c\u6709\u4e91\u5382\u5546\u4f7f\u7528Percona Server\u3002</p>"},{"location":"basic/0.mysql_source/#_4","title":"\u5b66\u4e60\u4e66\u7c4d","text":"<p>Database System Concepts 7<sup>th</sup></p> <p>\u6570\u636e\u5e93\u7cfb\u7edf\u6982\u5ff5</p> <p>\u4e60\u9898\u7b54\u6848https://github.com/noahabe/database_system_concepts_answers</p> <p>Database System Concepts 6<sup>th</sup></p>"},{"location":"basic/1.introduce_database/","title":"\u6570\u636e\u5e93\u57fa\u7840","text":"<p>\u6570\u636e\u5e93(Database\uff0cDB)\u662f\u6309\u7167\u6570\u636e\u7ed3\u6784\u6765\u7ec4\u7ec7\u3001\u5b58\u50a8\u548c\u7ba1\u7406\u6570\u636e\u7684\u5efa\u7acb\u5728\u8ba1\u7b97\u673a\u5b58\u50a8\u8bbe\u5907\u4e0a\u7684\u4ed3\u5e93\u3002</p> <p>\u7b80\u5355\u6765\u8bf4\u662f\u672c\u8eab\u53ef\u89c6\u4e3a\u7535\u5b50\u5316\u7684\u6587\u4ef6\u67dc\u2014\u2014\u5b58\u50a8\u7535\u5b50\u6587\u4ef6\u7684\u5904\u6240\uff0c\u7528\u6237\u53ef\u4ee5\u5bf9\u6587\u4ef6\u4e2d\u7684\u6570\u636e\u8fdb\u884c\u65b0\u589e\u3001\u622a\u53d6\u3001\u66f4\u65b0\u3001\u5220\u9664\u7b49\u64cd\u4f5c\u3002\u6570\u636e\u7ba1\u7406\u4e0d\u518d\u4ec5\u4ec5\u662f\u5b58\u50a8\u548c\u7ba1\u7406\u6570\u636e\uff0c\u800c\u8f6c\u53d8\u6210\u7528\u6237\u6240\u9700\u8981\u7684\u5404\u79cd\u6570\u636e\u7ba1\u7406\u7684\u65b9\u5f0f\u3002\u6570\u636e\u5e93\u6709\u5f88\u591a\u79cd\u7c7b\u578b\uff0c\u4ece\u6700\u7b80\u5355\u7684\u5b58\u50a8\u6709\u5404\u79cd\u6570\u636e\u7684\u8868\u683c\u5230\u80fd\u591f\u8fdb\u884c\u6d77\u91cf\u6570\u636e\u5b58\u50a8\u7684\u5927\u578b\u6570\u636e\u5e93\u7cfb\u7edf\u90fd\u5728\u5404\u4e2a\u65b9\u9762\u5f97\u5230\u4e86\u5e7f\u6cdb\u7684\u5e94\u7528\u3002</p>"},{"location":"basic/1.introduce_database/#_2","title":"\u4ec0\u4e48\u662f\u6570\u636e\u5e93","text":"<p>\u4eba\u4eec\u901a\u5e38\u7528\u6570\u636e\u5e93\u8fd9\u4e2a\u672f\u8bed\u6765\u4ee3\u8868\u4ed6\u4eec\u4f7f\u7528\u7684\u6570\u636e\u5e93\u8f6f\u4ef6\u3002\u8fd9\u662f\u4e0d\u6b63\u786e\u7684\uff0c\u5b83\u662f\u5f15\u8d77\u6df7\u6dc6\u7684\u6839\u6e90\u3002\u786e\u5207\u5730\u8bf4\uff0c\u6570\u636e\u5e93\u8f6f\u4ef6\u5e94\u79f0\u4e3a<code>DBMS</code>(\u6570\u636e\u5e93\u7ba1\u7406\u7cfb\u7edf)\u3002 \u6570\u636e\u5e93\u662f\u901a\u8fc7 <code>DBMS</code> \u521b\u5efa\u548c\u64cd\u7eb5\u7684\u5bb9\u5668\u3002\u6570\u636e\u5e93\u53ef\u4ee5\u662f\u4fdd\u5b58\u5728\u786c\u8bbe\u5907\u4e0a\u7684\u6587\u4ef6\uff0c\u4f46\u4e5f\u53ef\u4ee5\u4e0d\u662f\u3002 \u5728\u5f88\u5927\u7a0b\u5ea6\u4e0a\u8bf4\uff0c\u6570\u636e\u5e93\u7a76\u7adf\u662f\u6587\u4ef6\u8fd8\u662f\u522b\u7684\u4ec0\u4e48\u4e1c\u897f\u5e76\u4e0d\u91cd\u8981\uff0c\u56e0\u4e3a\u4f60\u5e76\u4e0d\u76f4\u63a5\u8bbf\u95ee\u6570\u636e\u5e93\uff1b\u4f60\u4f7f\u7528\u7684\u662f<code>DBMS</code>\uff0c\u5b83\u66ff\u4f60\u8bbf\u95ee\u6570\u636e\u5e93\u3002</p> <p>\u6570\u636e\u5e93\u6307\u7684\u662f\u4ee5\u4e00\u5b9a\u65b9\u5f0f\u50a8\u5b58\u5728\u4e00\u8d77\u3001\u80fd\u4e3a\u591a\u4e2a\u7528\u6237\u5171\u4eab\u3001\u5177\u6709\u5c3d\u53ef\u80fd\u5c0f\u7684\u5197\u4f59\u5ea6\u3001\u4e0e\u5e94\u7528\u7a0b\u5e8f\u5f7c\u6b64\u72ec\u7acb\u7684\u6570\u636e\u96c6\u5408\u3002 \u7b80\u5355\u6765\u8bf4\u53ef\u89c6\u4e3a\u7535\u5b50\u5316\u7684\u6587\u4ef6\u67dc\u2014\u2014\u5b58\u50a8\u7535\u5b50\u6587\u4ef6\u7684\u5904\u6240\uff0c\u7528\u6237\u53ef\u4ee5\u5bf9\u6587\u4ef6\u4e2d\u7684\u6570\u636e\u8fd0\u884c\u65b0\u589e\u3001\u622a\u53d6\u3001\u66f4\u65b0\u3001\u5220\u9664\u7b49\u64cd\u4f5c\u3002</p> <p>RDBMS\u5373\u5173\u7cfb\u6570\u636e\u5e93\u7ba1\u7406\u7cfb\u7edf(Relational Database Management System)\u7684\u7279\u70b9\uff1a</p> <ol> <li>\u6570\u636e\u4ee5\u8868\u683c\u7684\u5f62\u5f0f\u51fa\u73b0</li> <li>\u6bcf\u884c\u4e3a\u5404\u79cd\u8bb0\u5f55\u540d\u79f0</li> <li>\u6bcf\u5217\u4e3a\u8bb0\u5f55\u540d\u79f0\u6240\u5bf9\u5e94\u7684\u6570\u636e\u57df</li> <li>\u8bb8\u591a\u7684\u884c\u548c\u5217\u7ec4\u6210\u4e00\u5f20\u8868\u5355</li> <li>\u82e5\u5e72\u7684\u8868\u5355\u7ec4\u6210database</li> </ol> <p>\u5728\u5173\u7cfb\u578b\u6570\u636e\u5e93\u7406\u8bba\u4e2d\uff0c\u6570\u636e\u5e93\u5bf9\u8c61\u662f\u7528\u4e8e\u5b58\u50a8\u6216\u5f15\u7528\u6570\u636e\u7684\u6570\u636e\u7ed3\u6784\u3002\u8868\u662f\u4e00\u4e2a\u5178\u578b\u7684\u4f8b\u5b50\uff0c\u8fd8\u6709\u66f4\u591a\u79cd\u5bf9\u8c61\uff0c\u4f8b\u5982\u7d22\u5f15\uff0c\u5e8f\u5217\uff0c\u89c6\u56fe\uff0c\u51fd\u6570\u7b49\u3002</p>"},{"location":"basic/1.introduce_database/#_3","title":"\u6570\u636e\u5e93\u5206\u7c7b","text":"<p>\u6570\u636e\u5e93\u7684\u5206\u7c7b\u53ef\u591a\u4e86\u53bb\u4e86\uff0c\u5728\u7ef4\u57fa\u767e\u79d1\u4e0a\u9762\u6709\u4e0b\u9762\u8fd9\u4e9b\u6570\u636e\u5e93\uff0c\u5e76\u7c97\u7565\u7684\u5206\u4e86\u4e2a\u7c7b\u522b\u3002 \u4e00\u770b\u8fd9\u91cc\u9762\u7684\u5b66\u95ee\u5927\u4e86\u53bb\u4e86\uff0c\u8fd8\u662f\u5148\u642c\u4e00\u4e9b\u4ee3\u8868\u6027\u7684\u5427\uff0c\u957f\u957f\u89c1\u8bc6\uff0c\u8981\u6df1\u5165\u4e86\u89e3\u5404\u79cd\u6982\u5ff5\u63a8\u8350\u770b\u300a\u6570\u636e\u5e93\u7cfb\u7edf\u6982\u8bba\u300b\u3002</p>"},{"location":"basic/1.introduce_database/#_4","title":"\u5173\u7cfb\u578b\u6570\u636e\u5e93","text":"<p>\uff08\u82f1\u8bed\uff1aRelational database\uff09\uff0c\u662f\u521b\u5efa\u5728\u5173\u7cfb\u6a21\u578b\u57fa\u7840\u4e0a\u7684\u6570\u636e\u5e93\uff0c\u501f\u52a9\u4e8e\u96c6\u5408\u4ee3\u6570\u7b49\u6570\u5b66\u6982\u5ff5\u548c\u65b9\u6cd5\u6765\u5904\u7406\u6570\u636e\u5e93\u4e2d\u7684\u6570\u636e\u3002\u73b0\u5b9e\u4e16\u754c\u4e2d\u7684\u5404\u79cd\u5b9e\u4f53\u4ee5\u53ca\u5b9e\u4f53\u4e4b\u95f4\u7684\u5404\u79cd\u8054\u7cfb\u5747\u7528\u5173\u7cfb\u6a21\u578b\u6765\u8868\u793a\u3002\u5173\u7cfb\u6a21\u578b\u662f\u7531\u57c3\u5fb7\u52a0\u00b7\u79d1\u5fb7\u4e8e1970\u5e74\u9996\u5148\u63d0\u51fa\u7684\uff0c\u5e76\u914d\u5408\u201c\u79d1\u5fb7\u5341\u4e8c\u5b9a\u5f8b\u201d\u3002\u73b0\u5982\u4eca\u867d\u7136\u5bf9\u6b64\u6a21\u578b\u6709\u4e00\u4e9b\u6279\u8bc4\u610f\u89c1\uff0c\u4f46\u5b83\u8fd8\u662f\u6570\u636e\u5b58\u50a8\u7684\u4f20\u7edf\u6807\u51c6\u3002\u6807\u51c6\u6570\u636e\u67e5\u8be2\u8bed\u8a00SQL\u5c31\u662f\u4e00\u79cd\u57fa\u4e8e\u5173\u7cfb\u6570\u636e\u5e93\u7684\u8bed\u8a00\uff0c\u8fd9\u79cd\u8bed\u8a00\u6267\u884c\u5bf9\u5173\u7cfb\u6570\u636e\u5e93\u4e2d\u6570\u636e\u7684\u68c0\u7d22\u548c\u64cd\u4f5c\u3002 </p> <ul> <li>MySQL</li> <li>MariaDB\uff08MySQL\u7684\u4ee3\u66ff\u54c1\uff0c\u82f1\u6587\u7ef4\u57fa\u767e\u79d1\u4eceMySQL\u8f6c\u5411MariaDB\uff09</li> <li>Percona Server\uff08MySQL\u7684\u4ee3\u66ff\u54c1\uff09</li> <li>PostgreSQL</li> <li>Microsoft Access</li> <li>Google Fusion Tables</li> <li>SQL Server</li> <li>FileMaker</li> <li>Oracle</li> <li>Sybase</li> <li>dBASE</li> <li>Clipper</li> <li>FoxPro</li> </ul> <p>\u51e0\u4e4e\u6240\u6709\u7684\u6570\u636e\u5e93\u7ba1\u7406\u7cfb\u7edf\u90fd\u914d\u5907\u4e86\u4e00\u4e2a\u5f00\u653e\u5f0f\u6570\u636e\u5e93\u8fde\u63a5\uff08ODBC\uff09\u9a71\u52a8\u7a0b\u5e8f\uff0c\u4ee4\u5404\u4e2a\u6570\u636e\u5e93\u4e4b\u95f4\u5f97\u4ee5\u4e92\u76f8\u96c6\u6210\u3002</p>"},{"location":"basic/1.introduce_database/#nosql","title":"\u975e\u5173\u7cfb\u578b\u6570\u636e\u5e93\uff08NoSQL\uff09","text":"<p>NoSQL\u4e00\u8bcd\u6700\u65e9\u51fa\u73b0\u4e8e1998\u5e74\uff0c\u662fCarlo Strozzi\u5f00\u53d1\u7684\u4e00\u4e2a\u8f7b\u91cf\u3001\u5f00\u6e90\u3001\u4e0d\u63d0\u4f9bSQL\u529f\u80fd\u7684\u5173\u7cfb\u6570\u636e\u5e93\u3002</p> <p>\u5f53\u4ee3\u5178\u578b\u7684\u5173\u7cfb\u6570\u636e\u5e93\u5728\u4e00\u4e9b\u6570\u636e\u654f\u611f\u7684\u5e94\u7528\u4e2d\u8868\u73b0\u4e86\u7cdf\u7cd5\u7684\u6027\u80fd\uff0c\u4f8b\u5982\u4e3a\u5de8\u91cf\u6587\u6863\u521b\u5efa\u7d22\u5f15\u3001\u9ad8\u6d41\u91cf\u7f51\u7ad9\u7684\u7f51\u9875\u670d\u52a1\uff0c\u4ee5\u53ca\u53d1\u9001\u6d41\u5f0f\u5a92\u4f53\u3002</p> <p>\u5173\u7cfb\u578b\u6570\u636e\u5e93\u7684\u5178\u578b\u5b9e\u73b0\u4e3b\u8981\u88ab\u8c03\u6574\u7528\u4e8e\u6267\u884c\u89c4\u6a21\u5c0f\u800c\u8bfb\u5199\u9891\u7e41\uff0c\u6216\u8005\u5927\u6279\u91cf\u6781\u5c11\u5199\u8bbf\u95ee\u7684\u4e8b\u52a1\u3002</p>"},{"location":"basic/1.introduce_database/#keyvalue","title":"Key/value\u6700\u7ec8\u4e00\u81f4\u6027\u5b58\u50a8","text":"<ul> <li>Apache Cassandra\uff08\u4e3aFacebook\u6240\u4f7f\u7528\uff09\uff1a\u9ad8\u5ea6\u53ef\u6269\u5c55</li> <li>Dynamo</li> <li>Hibari</li> <li>Project Voldemort</li> <li>Riak </li> </ul>"},{"location":"basic/1.introduce_database/#keyvalue_1","title":"Key/value\u786c\u76d8\u5b58\u50a8","text":"<ul> <li>LevelDB\uff08Google\uff09</li> <li>BigTable</li> <li>MemcacheDB</li> <li>Tokyo Cabinet</li> <li>Tuple space</li> <li>TreapDB</li> </ul>"},{"location":"basic/1.introduce_database/#keyvalue-ram","title":"Key/value RAM\u5b58\u50a8","text":"<ul> <li>Oracle Coherence</li> <li>memcached</li> <li>Citrusleaf database</li> <li>Velocity</li> <li>Redis</li> <li>Tuple space</li> </ul>"},{"location":"basic/1.introduce_database/#keyvaluepaxos","title":"Key/value\u57fa\u4e8ePaxos\u7b97\u6cd5\u7684\u5b58\u50a8","text":"<ul> <li>Keyspace</li> </ul>"},{"location":"basic/1.introduce_database/#_5","title":"\u6570\u636e\u5e93\u6a21\u578b","text":"<p>\u6570\u636e\u5e93\u6a21\u578b\u63cf\u8ff0\u4e86\u5728\u6570\u636e\u5e93\u4e2d\u7ed3\u6784\u5316\u548c\u64cd\u7eb5\u6570\u636e\u7684\u65b9\u6cd5\uff0c\u6a21\u578b\u7684\u7ed3\u6784\u90e8\u5206\u89c4\u5b9a\u4e86\u6570\u636e\u5982\u4f55\u88ab\u63cf\u8ff0\uff08\u4f8b\u5982\u6811\u3001\u8868\u7b49\uff09\u3002\u6570\u636e\u5e93\u6a21\u578b\u7684\u5206\u7c7b\u5982\u4e0b\uff1a</p> <ul> <li>\u5bf9\u8c61\u6a21\u578b</li> <li>\u5c42\u6b21\u6a21\u578b\uff08\u8f7b\u91cf\u7ea7\u6570\u636e\u8bbf\u95ee\u534f\u8bae\uff09</li> <li>\u7f51\u72b6\u6a21\u578b\uff08\u5927\u578b\u6570\u636e\u50a8\u5b58\uff09</li> <li>\u5173\u7cfb\u6a21\u578b</li> <li>\u9762\u5411\u5bf9\u8c61\u6a21\u578b</li> <li>\u534a\u7ed3\u6784\u5316\u6a21\u578b</li> <li>\u5e73\u9762\u6a21\u578b\uff08\u8868\u683c\u6a21\u578b\uff0c\u4e00\u822c\u5728\u5f62\u5f0f\u4e0a\u662f\u4e00\u4e2a\u4e8c\u7ef4\u6570\u7ec4\u3002\u5982\u8868\u683c\u6a21\u578b\u6570\u636eExcel)</li> </ul>"},{"location":"basic/1.introduce_database/#_6","title":"\u67b6\u6784","text":"<p>\u6570\u636e\u5e93\u7684\u67b6\u6784\u53ef\u4ee5\u5927\u81f4\u533a\u5206\u4e3a\u4e09\u4e2a\u6982\u62ec\u5c42\u6b21\uff1a\u5185\u5c42\u3001\u6982\u5ff5\u5c42\u548c\u5916\u5c42\u3002</p> <ul> <li>\u5185\u5c42\uff1a\u6700\u63a5\u8fd1\u5b9e\u9645\u5b58\u50a8\u4f53\uff0c\u4ea6\u5373\u6709\u5173\u6570\u636e\u7684\u5b9e\u9645\u5b58\u50a8\u65b9\u5f0f\u3002</li> <li>\u5916\u5c42\uff1a\u6700\u63a5\u8fd1\u7528\u6237\uff0c\u5373\u6709\u5173\u4e2a\u522b\u7528\u6237\u89c2\u770b\u6570\u636e\u7684\u65b9\u5f0f\u3002</li> <li>\u6982\u5ff5\u5c42\uff1a\u4ecb\u4e8e\u4e24\u8005\u4e4b\u95f4\u7684\u95f4\u63a5\u5c42\u3002</li> </ul>"},{"location":"basic/1.introduce_database/#_7","title":"\u6570\u636e\u5e93\u7684\u4e09\u7ea7\u6a21\u5f0f\u548c\u4e24\u7ea7\u6620\u5c04","text":"<p>\u7f8e\u56fd\u56fd\u5bb6\u6807\u51c6\u534f\u4f1a(ANSI)\u7684\u6570\u636e\u5e93\u7ba1\u7406\u7cfb\u7edf\u7814\u7a76\u5c0f\u7ec4\u4e8e1978\u5e74\u63d0\u51fa\u4e86\u6807\u51c6\u5316\u7684\u5efa\u8bae\uff0c\u5c06\u6570\u636e\u5e93\u7ed3\u6784\u5206\u4e3a3\u7ea7\uff1a</p> <ul> <li> <p>\u9762\u5411\u7528\u6237\u6216\u5e94\u7528\u7a0b\u5e8f\u5458\u7684\u7528\u6237\u7ea7</p> </li> <li> <p>\u9762\u5411\u5efa\u7acb\u548c\u7ef4\u62a4\u6570\u636e\u5e93\u4eba\u5458\u7684\u6982\u5ff5\u7ea7</p> </li> <li> <p>\u9762\u5411\u7cfb\u7edf\u7a0b\u5e8f\u5458\u7684\u7269\u7406\u7ea7</p> </li> </ul> <p>\u4eba\u4eec\u4e3a\u6570\u636e\u5e93\u8bbe\u8ba1\u4e86\u4e00\u4e2a\u4e25\u8c28\u7684\u4f53\u7cfb\u7ed3\u6784\uff0c\u6570\u636e\u5e93\u9886\u57df\u516c\u8ba4\u7684\u6807\u51c6\u7ed3\u6784\u662f\u4e09\u7ea7\u6a21\u5f0f\u7ed3\u6784\uff0c\u5b83\u5305\u62ec**\u5916\u6a21\u5f0f\u3001\u6982\u5ff5\u6a21\u5f0f\u3001\u5185\u6a21\u5f0f**\u3002</p> <p>\u901a\u8fc7\u4e09\u7ea7\u6a21\u5f0f\u6709\u6548\u5730\u7ec4\u7ec7\u3001\u7ba1\u7406\u6570\u636e\uff0c\u63d0\u9ad8\u4e86\u6570\u636e\u5e93\u7684\u903b\u8f91\u72ec\u7acb\u6027\u548c\u7269\u7406\u72ec\u7acb\u6027\u3002</p>"},{"location":"basic/1.introduce_database/#_8","title":"\u6570\u636e\u5e93\u7d22\u5f15","text":"<p>\u6570\u636e\u7d22\u5f15\u7684\u89c2\u5ff5\u7531\u6765\u5df2\u4e45\uff0c\u50cf\u662f\u4e00\u672c\u4e66\u524d\u9762\u51e0\u9875\u90fd\u6709\u76ee\u5f55\uff0c\u76ee\u5f55\u4e5f\u7b97\u662f\u7d22\u5f15\u7684\u4e00\u79cd\uff0c\u53ea\u662f\u5b83\u7684\u5206\u7c7b\u8f83\u5e7f\uff0c\u4f8b\u5982\u8f66\u724c\u3001\u8eab\u4efd\u8bc1\u5b57\u53f7\u3001\u6761\u7801\u7b49\uff0c\u90fd\u662f\u4e00\u4e2a\u7d22\u5f15\u7684\u53f7\u7801\uff0c\u5f53\u6211\u4eec\u770b\u5230\u53f7\u7801\u65f6\uff0c\u53ef\u4ee5\u4ece\u53f7\u7801\u4e2d\u770b\u51fa\u5176\u4e2d\u7684\u7aef\u502a\uff0c\u82e5\u662f\u8981\u627e\u7684\u4eba\u3001\u8f66\u6216\u7269\u54c1\uff0c\u4e5f\u53ea\u8981\u63d0\u4f9b\u76f8\u5173\u7684\u53f7\u7801\uff0c\u5373\u53ef\u8fc5\u901f\u67e5\u5230\u6b63\u786e\u7684\u4eba\u4e8b\u7269\u3002</p>"},{"location":"basic/1.introduce_database/#_9","title":"\u6570\u636e\u5e93\u64cd\u4f5c\uff1a\u4e8b\u52a1","text":"<p>\u4e8b\u52a1\uff08transaction\uff09\u662f\u7528\u6237\u5b9a\u4e49\u7684\u4e00\u4e2a\u6570\u636e\u5e93\u64cd\u4f5c\u5e8f\u5217\uff0c\u8fd9\u4e9b\u64cd\u4f5c\u8981\u4e48\u5168\u505a\uff0c\u8981\u4e48\u5168\u4e0d\u505a\uff0c\u662f\u4e00\u4e2a\u4e0d\u53ef\u5206\u533a\u7684\u5de5\u4f5c\u5355\u4f4d\u3002 </p>"},{"location":"basic/1.introduce_database/#_10","title":"\u6570\u636e\u8868","text":"<p>\u5173\u7cfb\u6570\u636e\u5e93\u6ca1\u6709\u6570\u636e\u8868\uff0c\u5173\u952e\u5b57\u3001\u4e3b\u952e\u3001\u7d22\u5f15\u7b49\u4e5f\u5c31\u65e0\u4ece\u8c08\u8d77\uff0c\u6570\u636e\u8868\u662f\u5173\u7cfb\u6570\u636e\u5e93\u4e2d\u4e00\u4e2a\u975e\u5e38\u91cd\u8981\u7684\u5bf9\u8c61\uff0c\u662f\u5176\u5b83\u5bf9\u8c61\u7684\u57fa\u7840\uff0c\u4e5f\u662f\u4e00\u7cfb\u5217\u4e8c\u7ef4\u6570\u7ec4\u7684\u96c6\u5408\uff0c\u7528\u6765\u5b58\u50a8\u3001\u64cd\u4f5c\u6570\u636e\u7684\u903b\u8f91\u7ed3\u6784\u3002\u6839\u636e\u4fe1\u606f\u7684\u5206\u7c7b\u60c5\u51b5\u3002\u4e00\u4e2a\u6570\u636e\u5e93\u4e2d\u53ef\u80fd\u5305\u542b\u82e5\u5e72\u4e2a\u6570\u636e\u8868\uff0c\u6bcf\u5f20\u8868\u662f\u7531\u884c\u548c\u5217\u7ec4\u6210\uff0c\u8bb0\u5f55\u4e00\u6761\u6570\u636e\u6570\u636e\u8868\u5c31\u589e\u52a0\u4e00\u884c\uff0c\u6bcf\u4e00\u5217\u662f\u7531\u5b57\u6bb5\u540d\u548c\u5b57\u6bb5\u6570\u636e\u96c6\u5408\u7ec4\u6210\uff0c\u5217\u88ab\u79f0\u4e4b\u4e3a\u5b57\u6bb5\uff0c\u6bcf\u4e00\u5217\u8fd8\u6709\u81ea\u5df1\u7684\u591a\u4e2a\u5c5e\u6027\uff0c\u4f8b\u5982\u662f\u5426\u5141\u8bb8\u4e3a\u7a7a\u3001\u9ed8\u8ba4\u503c\u3001\u957f\u5ea6\u3001\u7c7b\u578b\u3001\u5b58\u50a8\u7f16\u7801\u3001\u6ce8\u91ca\u7b49</p> <p></p> <p>\u6570\u636e\u7c7b\u578b</p> <p>\u5728\u5b9a\u4e49\u6570\u636e\u5b57\u6bb5\u7684\u7c7b\u578b\u5bf9\u4f60\u7684\u6570\u636e\u5e93\u7684\u4f18\u5316\u975e\u5e38\u91cd\u8981\uff0c\u6570\u636e\u7c7b\u578b\u51b3\u5b9a\u4e86\u6570\u636e\u5728\u8ba1\u7b97\u673a\u4e2d\u7684\u5b58\u50a8\u683c\u5f0f\uff0c\u4ee3\u8868\u4e0d\u540c\u7684\u4fe1\u606f\u7c7b\u578b\uff0c\u5927\u81f4\u53ef\u4ee5\u5206\u4e3a\uff1a\u6570\u503c\u3001\u65e5\u671f/\u65f6\u95f4\u548c\u5b57\u7b26\u4e32(\u5b57\u7b26)\u7c7b\u578b\uff0c\u5b57\u7b26\u4e32\u7c7b\u578b\u53c8\u5305\u62ec\u4e8c\u8fdb\u5236\u7c7b\u578b\u3002</p> <p>\u4e0a\u56fe\u4e2d\u6bcf\u4e00\u5217\u5c31\u662f\u4e00\u4e2a\u5b57\u6bb5\uff0c\u6bcf\u4e2a\u5b57\u6bb5\u90fd\u6709\u81ea\u5df1\u7684\u7c7b\u578b\uff0c\u4f8b\u5982<code>name</code>\u5217\u4e3a\u5b57\u7b26\u4e32\u7c7b\u578b\uff0c<code>level</code> \u5217\u4e3a\u6570\u5b57\u7c7b\u578b\u3002</p>"},{"location":"basic/1.introduce_database/#_11","title":"\u5173\u7cfb\u952e","text":"<p>\u5173\u7cfb\u952e\u662f\u5173\u7cfb\u6570\u636e\u5e93\u7684\u91cd\u8981\u7ec4\u6210\u90e8\u5206\u3002\u5173\u7cfb\u952e\u662f\u4e00\u4e2a\u8868\u4e2d\u7684\u4e00\u4e2a\u6216\u51e0\u4e2a\u5c5e\u6027\uff0c\u7528\u6765\u6807\u8bc6\u8be5\u8868\u7684\u6bcf\u4e00\u884c\u6216\u4e0e\u53e6\u4e00\u4e2a\u8868\u4ea7\u751f\u8054\u7cfb\u3002\u4e00\u5217(\u6216\u4e00\u7ec4\u5217)\uff0c\u5176\u503c\u80fd\u591f\u552f\u4e00\u533a\u5206\u8868\u4e2d\u6bcf\u4e2a\u884c\u3002</p>"},{"location":"basic/1.introduce_database/#_12","title":"\u4e3b\u952e","text":"<p>\u4e3b\u952e\uff08primary key\u6216unique key\uff09\uff0c\u53c8\u79f0\u4e3b\u7801\uff0c\u6570\u636e\u5e93\u8868\u4e2d\u5bf9\u50a8\u5b58\u6570\u636e\u5bf9\u8c61\u4e88\u4ee5\u552f\u4e00\u548c\u5b8c\u6574\u6807\u8bc6\u7684\u6570\u636e\u5217\u6216\u5c5e\u6027\u7684\u7ec4\u5408\u3002\u4e00\u4e2a\u6570\u636e\u5217\u53ea\u80fd\u6709\u4e00\u4e2a\u4e3b\u952e\uff0c\u4e14\u4e3b\u952e\u7684\u53d6\u503c\u4e0d\u80fd\u7f3a\u5931\uff0c\u5373\u4e0d\u80fd\u4e3a\u7a7a\u503c\uff08Null\uff09\u3002unique \u53ef\u7a7a\uff0c\u53ef\u4ee5\u5728\u4e00\u4e2a\u8868\u91cc\u7684\u4e00\u4e2a\u6216\u591a\u4e2a\u5b57\u6bb5\u5b9a\u4e49\uff1bprimary key \u4e0d\u53ef\u7a7a\u4e0d\u53ef\u91cd\u590d\uff0c\u5728\u4e00\u4e2a\u8868\u91cc\u53ef\u4ee5\u5b9a\u4e49\u8054\u5408\u4e3b\u952e\uff1bunique\u7d22\u5f15\u548cprimary\u7d22\u5f15\u533a\u522b:</p> <ol> <li>primary key = unique + not null</li> <li>\u552f\u4e00\u7ea6\u675f\u548c\u4e3b\u952e\u4e00\u6837\u90fd\u662f\u7ea6\u675f\u7684\u8303\u7574\uff0c\u800c\u4e14\u90fd\u53ef\u4ee5\u4f5c\u4e3a\u5916\u952e\u7684\u53c2\u8003\uff0c\u4e0d\u540c\u7684\u662f\uff0c\u4e00\u5f20\u8868\u53ea\u80fd\u6709\u4e00\u4e2a\u4e3b\u952e</li> <li>\u4e3b\u952e\u548c\u552f\u4e00\u7ea6\u675f\u7684\u521b\u5efa\u9700\u8981\u4f9d\u9760\u7d22\u5f15\uff0c\u5982\u679c\u5728\u521b\u5efa\u4e3b\u952e\u6216\u552f\u4e00\u7ea6\u675f\u7684\u65f6\u5019\u6ca1\u6709\u5df2\u7ecf\u5efa\u597d\u7684\u7d22\u5f15\u53ef\u4ee5\u4f7f\u7528\u7684\u8bdd\uff0cOracle\u4f1a\u81ea\u52a8\u5efa\u7acb\u4e00\u4e2a\u552f\u4e00\u7684\u7d22\u5f15\u3002</li> </ol> <p>\u8868\u4e2d\u7684\u4efb\u4f55\u5217\u90fd\u53ef\u4ee5\u4f5c\u4e3a\u4e3b\u952e\uff0c\u53ea\u8981\u5b83\u6ee1\u8db3\u4ee5\u4e0b\u6761\u4ef6: </p> <ul> <li>unique \u5c31\u662f\u552f\u4e00\uff0c\u5f53\u4f60\u9700\u8981\u9650\u5b9a\u4f60\u7684\u67d0\u4e2a\u8868\u5b57\u6bb5\u6bcf\u4e2a\u503c\u90fd\u552f\u4e00\uff0c\u6ca1\u6709\u91cd\u590d\u503c\u65f6\u4f7f\u7528\u3002</li> <li>\u4efb\u610f\u4e24\u884c\u90fd\u4e0d\u5177\u6709\u76f8\u540c\u7684\u4e3b\u952e\u503c\uff1b</li> <li>\u6bcf\u4e2a\u884c\u90fd\u5fc5\u987b\u5177\u6709\u4e00\u4e2a\u4e3b\u952e\u503c(\u4e3b\u952e\u5217\u4e0d\u5141\u8bb8NULL\u503c)\u3002</li> </ul> <p>\u9664MySQL\u5f3a\u5236\u5b9e\u65bd\u7684\u89c4\u5219\u5916\uff0c\u5e94\u8be5\u575a\u6301\u7684\u51e0\u4e2a\u666e\u904d\u8ba4\u53ef\u7684\u6700\u597d\u4e60\u60ef\u4e3a:</p> <ul> <li>\u4e0d\u66f4\u65b0\u4e3b\u952e\u5217\u4e2d\u7684\u503c\uff1b</li> <li>\u4e0d\u91cd\u7528\u4e3b\u952e\u5217\u7684\u503c\uff1b</li> <li>\u4e0d\u5728\u4e3b\u952e\u5217\u4e2d\u4f7f\u7528\u53ef\u80fd\u4f1a\u66f4\u6539\u7684\u503c\u3002(\u4f8b\u5982\uff0c\u5982\u679c\u4f7f\u7528\u4e00\u4e2a\u540d\u5b57\u4f5c\u4e3a\u4e3b\u952e\u4ee5\u6807\u8bc6\u67d0\u4e2a\u4f9b\u5e94\u5546\uff0c\u5f53\u8be5\u4f9b\u5e94\u5546\u5408\u5e76\u548c\u66f4\u6539\u5176\u540d\u5b57\u65f6\uff0c\u5fc5\u987b\u66f4\u6539\u8fd9\u4e2a\u4e3b\u952e\u3002)</li> </ul>"},{"location":"basic/1.introduce_database/#_13","title":"\u8d85\u952e","text":"<p>\u8d85\u952e\uff08superkey\uff09\uff0c\u6709\u7684\u6587\u732e\u79f0\u201c\u8d85\u7801\u201d\uff0c\u662f\u5728\u6570\u636e\u5e93\u5173\u7cfb\u6a21\u5f0f\u8bbe\u8ba1\u4e2d\u80fd\u591f\u552f\u4e00\u6807\u793a\u591a\u5143\u7ec4\uff08\u5373\u201c\u884c\u201d\uff09\u7684\u5c5e\u6027\u96c6\u3002\u5305\u542b\u6240\u6709\u5c5e\u6027\u7684\u96c6\u53eb\u505a\u660e\u663e\uff08\u5e73\u51e1\uff09\u8d85\u952e\u3002</p>"},{"location":"basic/1.introduce_database/#_14","title":"\u5019\u9009\u952e","text":"<p>\u5728\u5173\u7cfb\u6a21\u578b\u4e2d\uff0c\u5019\u9009\u952e\u6216\u5019\u9009\u7801\uff08candidate key\uff09\u662f\u67d0\u4e2a\u5173\u7cfb\u53d8\u91cf\u7684\u4e00\u7ec4\u5c5e\u6027\u6240\u7ec4\u6210\u7684\u96c6\u5408\uff0c\u5b83\u9700\u8981\u540c\u65f6\u6ee1\u8db3\u4e0b\u5217\u4e24\u4e2a\u6761\u4ef6\uff1a</p> <ul> <li>\u8fd9\u4e2a\u5c5e\u6027\u96c6\u5408\u59cb\u7ec8\u80fd\u591f\u786e\u4fdd\u5728\u5173\u7cfb\u4e2d\u80fd\u552f\u4e00\u6807\u8bc6\u5143\u7ec4</li> <li>\u5728\u8fd9\u4e2a\u5c5e\u6027\u96c6\u5408\u4e2d\u627e\u4e0d\u51fa\u771f\u5b50\u96c6\u80fd\u591f\u6ee1\u8db3\u6761\u4ef6</li> </ul> <p>\u6ee1\u8db3\u7b2c\u4e00\u4e2a\u6761\u4ef6\u7684\u5c5e\u6027\u96c6\u5408\u79f0\u4e3a\u8d85\u952e\uff0c\u56e0\u6b64\u6211\u4eec\u4e5f\u53ef\u4ee5\u628a\u5019\u9009\u952e\u5b9a\u4e49\u4e3a\u201c\u6700\u5c0f\u8d85\u952e\u201d\uff0c\u4e5f\u5c31\u662f\u4e0d\u542b\u6709\u591a\u4f59\u5c5e\u6027\u7684\u8d85\u952e\u3002</p> <p>\u5019\u9009\u952e\u7684\u91cd\u8981\u6027\u662f\u5b83\u4eec\u80fd\u591f\u5728\u5173\u7cfb\u4e2d\u552f\u4e00\u6807\u8bc6\u51fa\u4e0d\u540c\u7684\u5143\u7ec4\uff0c\u56e0\u6b64\u8d85\u952e\u4e5f\u662f\u5728\u8bbe\u8ba1\u6570\u636e\u5e93\u6a21\u5f0f\u65f6\u9700\u8981\u6307\u5b9a\u7684\u6700\u91cd\u8981\u7684\u7ea6\u675f\u4e4b\u4e00\u3002\u7531\u4e8e\u5728\u5173\u7cfb\u6a21\u578b\u4e2d\uff0c\u6bcf\u4e2a\u5173\u7cfb\u90fd\u662f\u4e00\u4e2a\u96c6\u5408\uff08\u6ca1\u6709\u91cd\u590d\u7684\u5143\u7d20\uff09\uff0c\u6240\u4ee5\u6bcf\u4e2a\u5173\u7cfb\u90fd\u81f3\u5c11\u6709\u4e00\u4e2a\u5019\u9009\u952e\uff08\u56e0\u4e3a\u6240\u6709\u5c5e\u6027\u7ec4\u5408\u5fc5\u7136\u662f\u4e2a\u8d85\u952e\uff09\u3002\u4f46\u662f\u5728\u67d0\u4e9b\u5173\u7cfb\u578b\u6570\u636e\u5e93\u4e2d\u8868\u4e5f\u80fd\u4ee3\u8868\u591a\u91cd\u96c6\uff0c\u6240\u4ee5\u5728\u6bcf\u4e2a\u5173\u7cfb\u4e2d\u90fd\u663e\u5f0f\u5730\u5b9a\u4e49\u81f3\u5c11\u4e00\u4e2a\u5019\u9009\u952e\u662f\u4e00\u6761\u5f88\u91cd\u8981\u7684\u8bbe\u8ba1\u539f\u5219\u3002\u6570\u636e\u5e93\u7ba1\u7406\u7cfb\u7edf\u901a\u5e38\u90fd\u9700\u8981\u5c06\u6bcf\u4e2a\u5173\u7cfb\u4e2d\u7684\u67d0\u4e2a\u5019\u9009\u952e\u5b9a\u4e49\u4e3a\u4e3b\u952e\uff0c\u4ea6\u5373\u8fd9\u4e2a\u5019\u9009\u952e\u662f\u533a\u5206\u4e0d\u540c\u5143\u7ec4\u65f6\u9996\u9009\u7684\u8bc6\u522b\u65b9\u5f0f\uff0c\u4f8b\u5982\u5916\u952e\u901a\u5e38\u5c31\u662f\u5f15\u7528\u4e3b\u952e\u800c\u975e\u5176\u4ed6\u5019\u9009\u952e\u3002</p>"},{"location":"basic/1.introduce_database/#_15","title":"\u5916\u952e","text":"<p>\u5916\u952e\uff08foreign key\uff0c\u53f0\u6e7e\u8bd1\u4f5c\u5916\u6765\u952e\uff09\uff0c\u53c8\u79f0\u5916\u90e8\u952e\u3002\u5176\u5b9e\u5728\u5173\u7cfb\u6570\u636e\u5e93\u4e2d\uff0c\u6bcf\u4e2a\u6570\u636e\u8868\u90fd\u662f\u7531\u5173\u7cfb\u6765\u8fde\u7cfb\u5f7c\u6b64\u7684\u5173\u7cfb\uff0c\u7236\u6570\u636e\u8868\uff08Parent Entity\uff09\u7684\u4e3b\u952e\uff08primary key\uff09\u4f1a\u653e\u5728\u53e6\u4e00\u4e2a\u6570\u636e\u8868\uff0c\u5f53\u505a\u5c5e\u6027\u4ee5\u521b\u5efa\u5f7c\u6b64\u7684\u5173\u7cfb\uff0c\u800c\u8fd9\u4e2a\u5c5e\u6027\u5c31\u662f\u5916\u952e\u3002</p> <p>\u6bd4\u5982\uff0c\u5b66\u751f\u8ddf\u8001\u5e08\u4e4b\u95f4\u662f\u6559\u5b66\u7684\u5173\u7cfb\uff0c\u5b66\u751f\u6570\u636e\u8868\u4f1a\u6709\u4e2a\u5c5e\u6027\u53eb\u6307\u5bfc\u8001\u5e08\uff08FK\uff09\uff0c\u800c\u8fd9\u4e2a\u503c\u5c31\u662f\u5bf9\u5e94\u5230\u8001\u5e08\u6570\u636e\u8868\u7684\u8001\u5e08\u4ee3\u53f7\uff08PK\uff09\uff0c\u5b66\u751f\u7684\u6307\u5bfc\u8001\u5e08\u5c31\u662f\u5916\u952e\u3002</p>"},{"location":"basic/1.introduce_database/#_16","title":"\u4ee3\u7406\u952e","text":"<p>\u5728\u5173\u7cfb\u578b\u6570\u636e\u5e93\u8bbe\u8ba1\u4e2d\uff0c\u4ee3\u7406\u952e\u662f\u5728\u5f53\u6570\u636e\u8868\u4e2d\u7684\u5019\u9009\u952e\u90fd\u4e0d\u9002\u5408\u5f53\u4e3b\u952e\u65f6\uff0c\u4f8b\u5982\u6570\u636e\u592a\u957f\uff0c\u6216\u662f\u610f\u4e49\u5c42\u9762\u592a\u591a\uff0c\u5c31\u4f1a\u8bf7\u4e00\u4e2a\u65e0\u610f\u4e49\u7684\u4f46\u552f\u4e00\u7684\u5b57\u6bb5\u6765\u4ee3\u4e3a\u4f5c\u4e3b\u952e\u3002</p> <p>\u4ee3\u7406\u952e\u662f\uff1a</p> <ul> <li>Surrogate (1) \u2013 Hall, Owlett and Codd (1976)     \u4e00\u4e2a\u4ee3\u7406\u952e\u503c\u786e\u5b9a\u4e86\u5916\u90e8\u4e16\u754c\u7684\u4e00\u4e2a\u5b9e\u4f53\u3002\u4ee3\u7406\u952e\u503c\u662f\u6570\u636e\u5e93\u751f\u6210\u7684\uff0c\u4ece\u6765\u4e0d\u663e\u793a\u7ed9\u7528\u6237\u6216\u5e94\u7528\u7a0b\u5e8f\u770b\u3002</li> <li>Surrogate (2) \u2013 Wieringa and De Jonge (1991)     \u4e00\u4e2a\u4ee3\u7406\u952e\u503c\u786e\u5b9a\u4e86\u6570\u636e\u5e93\u4e2d\u7684\u4e00\u4e2a\u5bf9\u8c61\u3002\u4ee3\u7406\u952e\u503c\u662f\u6570\u636e\u5e93\u751f\u6210\u7684\uff0c\u7528\u6237\u6216\u5e94\u7528\u7a0b\u5e8f\u770b\u4e0d\u5230\u5b83\u3002</li> </ul> <p>\u5728\u5b9e\u8df5\u4e2d\uff0c\u4ee3\u7406\u952e\u503c\u901a\u5e38\u662f\u4e2a\u81ea\u52a8\u9012\u589e\u7684\u6570\u5b57\u3002\u5728Sybase\u6216SQL Server\uff0c\u7528identity column\u6807\u8bc6\u4ee3\u7406\u952e\uff0cPostgreSQL\u91cc\u7528serial\uff0cOracle\u91cc\u7528SEQUENCE\uff0c\u5728MySQL\u91cc\u7528\u4e00\u4e2a\u6807\u8bb0\u6709AUTO_INCREMENT\u7684\u5b57\u6bb5\u3002</p>"},{"location":"basic/1.introduce_database/#_17","title":"\u81ea\u7136\u952e","text":"<p>\u81ea\u7136\u952e\u4e0e\u4ee3\u7406\u952e\u76f8\u53cd\uff0c\u5b83\u662f\u5728\u81ea\u7136\u751f\u6d3b\u4e2d\u552f\u4e00\u786e\u5b9a\u4e00\u4e2a\u4e8b\u7269\u7684\u6807\u8bc6\u3002\u8eab\u4efd\u8bc1\u53f7\u5c31\u662f\u4e00\u4e2a\u81ea\u7136\u952e\uff0c\u7528\u4e8e\u786e\u5b9a\u4e00\u4e2a\u4eba\u3002</p>"},{"location":"basic/1.introduce_database/#sql","title":"SQL\u8bed\u8a00\u6982\u8ff0","text":"<p>SQL\u8bed\u8a00\u6982\u89c8</p> <p>SQL\u6700\u65e9\u662fIBM\u516c\u53f8\u5f00\u53d1\uff0c\u6700\u521d\u79f0\u4f5cSequel\uff0c\u540e\u6765\u53d8\u4e3aSQL\uff08\u7ed3\u6784\u5316\u67e5\u8be2\u8bed\u8a00\uff09\uff0cSQL\u7684\u6807\u51c6\u662f\u7531 \u7f8e\u56fd\u56fd\u5bb6\u6807\u51c6\u5316\u7ec4\u7ec7(ANSI) \u548c \u56fd\u9645\u6807\u51c6\u5316\u7ec4\u7ec7(ISO) \u5236\u5b9a\u3002\u6700\u65b0\u7684\u6807\u51c6\u662f SQL:2016</p> <p>SQL\u8bed\u8a00\u6709\u4ee5\u4e0b\u51e0\u4e2a\u90e8\u5206\uff1a</p> <ul> <li>\u6570\u636e\u5b9a\u4e49\u8bed\u8a00\uff08DDL\uff09\uff1a\u8868\u5b9a\u4e49\uff0c\u8868\u5220\u9664\uff0c\u8868\u7ed3\u6784\u4fee\u6539\u7b49\u8bed\u53e5\u3002</li> <li>\u5b8c\u6574\u6027\uff1aSQL DDL \u4e2d\u5305\u62ec\u6570\u636e\u5b9a\u4e49\u7684\u5b8c\u6574\u6027\u7684\u7ea6\u675f\u3002\u662f\u6307\u6570\u636e\u7684\u4e00\u81f4\u6027\u548c\u6709\u6548\u6027\u3002</li> <li>\u6570\u636e\u64cd\u7eb5\u8bed\u8a00\uff08DML\uff09\uff1a\u5bf9\u6570\u636e\u5e93\u8868\u7684\u589e\u5220\u6539\u67e5\u8bed\u53e5\u3002</li> <li>\u6570\u636e\u63a7\u5236\u8bed\u8a00\uff08DCL\uff09\uff1a\u7528\u6765\u786e\u8ba4\u6216\u53d6\u6d88\u5bf9\u6570\u636e\u7684\u53d8\u66f4\u3002\u8fd8\u6709\u6743\u9650\u63a7\u5236\u3002</li> </ul> <p>\u89c6\u56fe\u5b9a\u4e49\uff1aSQL  DDL \u5305\u542b\u89c6\u56fe\u5b9a\u4e49\u7684\u547d\u4ee4 \u4e8b\u52a1\u63a7\u5236\uff1aSQL \u5d4c\u5165\u5f0f\u548c\u52a8\u6001SQL \u6388\u6743</p> <p>\u6bcf\u4e2a\u5173\u7cfb\u578b\u6570\u636e\u5e93\u90fd\u5728\u4e0d\u540c\u7a0b\u5ea6\u4e0a\u5b9e\u73b0SQL\u6807\u51c6\uff0c\u4f46\u662f\u4e5f\u6709\u81ea\u5df1\u5b9e\u73b0\u7684\u6807\u51c6\uff0c\u4f46\u662f\u5927\u90e8\u5206\u90fd\u662f\u57fa\u672c\u4e00\u81f4\uff0c\u4f46\u662f\u6bcf\u4e2a\u6570\u636e\u5e93\u90fd\u6709\u81ea\u5df1\u7684\u9ad8\u7ea7\u7279\u6027\u548c\u5b9e\u73b0\u6807\u51c6\u3002</p> <p>oracle\uff0cmysql\uff0cserver sql \u662f\u4e0d\u540c\u516c\u53f8\u5bf9\u5173\u7cfb\u578b\u6570\u636e\u5e93\u7684\u5177\u4f53\u5b9e\u73b0\uff0c\u4ed6\u4eec\u90fd\u90e8\u5206\u5b9e\u73b0\u4e86\u6807\u51c6SQL\u3002</p> <p>\u6807\u51c6SQL\u7684\u8bed\u6cd5\u89c4\u5219:</p> <ul> <li>SQL \u5bf9\u5173\u952e\u5b57\u7684\u5927\u5c0f\u5199\u4e0d\u654f\u611f\uff0c\u6bd4\u5982SELECT \u4e0e select \u662f\u76f8\u540c\u7684\uff0c\u4e00\u4e2a\u5173\u952e\u5b57\u6df7\u5408\u5927\u5c0f\u5199\u4e5f\u662f\u53ef\u4ee5\u7684\uff0c\u6bd4\u5982 SeLect\uff0c\u5173\u952e\u5b57\u5efa\u8bae\u5927\u5199\u3002</li> <li>\u6570\u636e\u5e93\u540d\uff0c\u8868\u540d\uff0c\u8868\u5b57\u6bb5\u4e00\u822c\u6765\u8bf4\u90fd\u662f\u533a\u5206\u5927\u5c0f\u5199\u7684\uff0c\u6240\u4ee5\u5728\u4f7f\u7528SQL\u547d\u4ee4\u64cd\u4f5c\u6570\u636e\u5e93\u8868\u548c\u5b57\u6bb5\u65f6\u9700\u8981\u8f93\u5165\u6b63\u786e\u7684\u540d\u79f0\u3002</li> <li> <p>SQL\u8bed\u53e5\u53ef\u4ee5\u4ee5\u5355\u884c\u6216\u8005\u591a\u884c\u4e66\u5199\uff0c\u4ee5\u5206\u884c\u7ed3\u675f\uff08\u67d0\u4e9b\u6570\u636e\u5e93\u7cfb\u7edf\u8981\u6c42\u5728\u6bcf\u6761 SQL \u8bed\u53e5\u7684\u672b\u7aef\u4f7f\u7528\u5206\u53f7\uff0c\u6bd4\u5982MySQL\uff09\u3002\u5206\u53f7\u662f\u5728\u6570\u636e\u5e93\u7cfb\u7edf\u4e2d\u5206\u9694\u6bcf\u6761 SQL \u8bed\u53e5\u7684\u6807\u51c6\u65b9\u6cd5\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u5728\u5bf9\u670d\u52a1\u5668\u7684\u76f8\u540c\u8bf7\u6c42\u4e2d\u6267\u884c\u4e00\u6761\u4ee5\u4e0a\u7684 SQL \u8bed\u53e5\u3002</p> </li> <li> <p>SQL\u7684\u6ce8\u91ca\uff1a</p> </li> </ul> <pre><code>\u5355\u884c\u6ce8\u91ca\uff1a -- \u6ce8\u91ca\u5185\u5bb9\u3001# \u6ce8\u91ca\u5185\u5bb9  \uff08\u5728MySQL\u4e2d\uff0c-- \u540e\u9762\u4e00\u5b9a\u8981\u52a0\u4e00\u4e2a\u7a7a\u683c\uff0c#\u540e\u9762\u53ef\u52a0\u53ef\u4e0d\u52a0\u7a7a\u683c\u3002\u5355\u884c\u6ce8\u91ca\u5efa\u8bae\u4f7f\u7528 #\uff09\nSELECT * FROM Websites;  -- \u8fd9\u91cc\u662f\u6ce8\u91ca\nSELECT * FROM Websites;  # \u8fd9\u91cc\u662f\u6ce8\u91ca\n\n\u591a\u884c\u6ce8\u91ca\uff1a \n/* \n\u6ce8\u91ca\u5185\u5bb9 \n\u6ce8\u91ca\u5185\u5bb9\n*/\n</code></pre>"},{"location":"basic/10.MySQL%E5%AD%98%E5%82%A8%E5%BC%95%E6%93%8E/","title":"\u5b58\u50a8\u5f15\u64ce\u6982\u8ff0","text":"<p>\u4e3a\u4e86\u65b9\u4fbf\u7ba1\u7406\uff0c\u628a\u8fde\u63a5\u7ba1\u7406\u3001\u67e5\u8be2\u7f13\u5b58\u3001\u8bed\u6cd5\u89e3\u6790\u3001\u67e5\u8be2\u4f18\u5316\u8fd9\u4e9b\u5e76\u4e0d\u6d89\u53ca\u771f\u5b9e\u6570\u636e\u5b58\u50a8\u7684\u529f\u80fd\u5212\u5206\u4e3a MySQL Server \u7684\u529f\u80fd\uff0c\u628a\u771f\u5b9e\u5b58\u53d6\u6570\u636e\u7684\u529f\u80fd\u5212\u5206\u4e3a\u5b58\u50a8\u5f15\u64ce\u7684\u529f\u80fd\u3002\u6240\u4ee5\u5728 <code>MySQL server</code> \u5b8c\u6210\u4e86\u67e5\u8be2\u4f18\u5316\u540e\uff0c\u53ea\u9700\u6309\u7167\u751f\u6210\u7684\u6267\u884c\u8ba1\u5212\u8c03\u7528\u5e95\u5c42\u5b58\u50a8\u5f15\u64ce\u63d0\u4f9b\u7684 API\uff0c\u83b7\u53d6\u5230\u6570\u636e\u540e\u8fd4\u56de\u7ed9\u5ba2\u6237\u7aef\u5c31\u597d\u4e86\u3002</p> <p>MySQL \u4e2d\u63d0\u5230\u4e86**\u5b58\u50a8\u5f15\u64ce**\u7684\u6982\u5ff5\uff0c\u7b80\u800c\u8a00\u4e4b\uff0c\u5b58\u50a8\u5f15\u64ce\u5c31\u662f\u6307\u8868\u7684\u7c7b\u578b\u3002\u5176\u5b9e\u5b58\u50a8\u5f15\u64ce\u4ee5\u524d\u53eb\u505a\u8868\u5904\u7406\u5668\uff0c\u540e\u6765\u6539\u540d\u4e3a\u5b58\u50a8\u5f15\u64ce\uff0c\u5b83\u7684\u529f\u80fd\u5c31\u662f\u63a5\u6536\u4e0a\u5c42\u4f20\u4e0b\u6765\u7684\u6307\u4ee4\uff0c\u7136\u540e\u5bf9\u8868\u4e2d\u7684\u6570\u636e\u8fdb\u884c\u63d0\u53d6\u6216\u5199\u5165\u64cd\u4f5c\u3002</p> <p>\u53ef\u4ee5\u901a\u8fc7\u5982\u4e0bSQL\u8bed\u53e5\u6765\u67e5\u8be2MySQL\u652f\u6301\u7684\u5404\u79cd\u5b58\u50a8\u5f15\u64ce</p> <pre><code>show engines;\n\nSELECT * FROM INFORMATION_SCHEMA.ENGINES;\n</code></pre> Engine Support Comment Transactions XA Savepoints InnoDB DEFAULT Supports transactions, row-level locking, and foreign keys YES YES YES MRG_MYISAM YES Collection of identical MyISAM tables NO NO NO MEMORY YES Hash based, stored in memory, useful for temporary tables NO NO NO BLACKHOLE YES /dev/null storage engine (anything you write to it disappears) NO NO NO MyISAM YES MyISAM storage engine NO NO NO CSV YES CSV storage engine NO NO NO ARCHIVE YES Archive storage engine NO NO NO PERFORMANCE_SCHEMA YES Performance Schema NO NO NO FEDERATED NO Federated MySQL storage engine NULL NULL NULL"},{"location":"basic/10.MySQL%E5%AD%98%E5%82%A8%E5%BC%95%E6%93%8E/#blackhole","title":"Blackhole","text":"<p>Blackhole\u5f15\u64ce\u5145\u5f53\u4e00\u4e2a**\u9ed1\u6d1e**\uff0c\u63a5\u53d7\u6570\u636e\uff0c\u4f46\u5c06\u5176\u6254\u6389\uff0c\u4e0d\u5b58\u50a8\u6570\u636e\u3002</p> <p>Blackhole\u5f15\u64ce\u652f\u6301\u5404\u79cd\u7d22\u5f15\uff0c\u6240\u4ee5\u5efa\u8868\u65f6\u53ef\u4ee5\u5305\u542b\u7d22\u5f15\u58f0\u660e\u3002Blackhole\u8868\u652f\u6301\u89e6\u53d1\u5668\uff0c\u56e0\u4e3a\u5b9e\u9645\u4e0a\u5e76\u4e0d\u5b58\u50a8\u6570\u636e\uff0c\u56e0\u6b64\u4e0d\u4f1a\u89e6\u53d1UPDATE\u548cDELETE\u89e6\u53d1\u5668\uff0cINSERT\u89e6\u53d1\u5668\u4f1a\u89e6\u53d1\u3002</p> <p>Blackhole\u5f15\u64ce\u8fd9\u4e48\u7279\u522b\uff0c\u5982\u679c\u771f\u7684\u6ca1\u6709\u7528\u5904\uff0c\u4e5f\u5c31\u4e0d\u53ef\u80fd\u5b58\u5728\uff0c\u90a3\u5b83\u5230\u5e95\u6709\u4ec0\u4e48\u4ef7\u503c\u5462\uff1f\u5b98\u65b9\u6587\u6863\u5217\u4e3e\u4e86\u51e0\u4e2a\uff1a</p> <ul> <li>Replication\u573a\u666f\u5b9e\u73b0\u4e2d\u7ee7\u6216\u8fc7\u6ee4</li> <li>\u6821\u9a8cdump\u6587\u4ef6\u8bed\u6cd5\u3002</li> <li>\u6d4b\u91cf\u5f00\u542f binlog \u65e5\u5fd7\u6240\u5e26\u6765\u7684\u989d\u5916\u5f00\u9500\u3002</li> <li>\u67e5\u627e\u548c\u5b58\u50a8\u5f15\u64ce\u65e0\u5173\u7684\u5176\u4ed6\u65b9\u9762\u7684\u6027\u80fd\u74f6\u9888\u3002</li> </ul> <p>\u6211\u4eec\u6765\u770b\u770bReplication\u573a\u666f\u5b9e\u73b0\u4e2d\u7ee7\u6216\u8fc7\u6ee4\u8fd9\u79cd\u3002</p> <p>Insert\u5230Blackhole\u8868\u4e2d\u4e0d\u4f1a\u5b58\u50a8\u6570\u636e\uff0c\u4f46\u5982\u679c\u542f\u7528\u4e86\u57fa\u4e8e\u8bed\u53e5\u7684\u4e8c\u8fdb\u5236\u65e5\u5fd7\u8bb0\u5f55\uff0c\u5219\u4f1a\u8bb0\u5f55SQL\u8bed\u53e5\u5230binlog\u65e5\u5fd7\u3002\u8fd9\u53ef\u4ee5\u7528\u4f5c\u4e2d\u7ee7\u5668\u6216\u8fc7\u6ee4\u673a\u5236\u3002</p> <p>\u5047\u8bbe\u4e1a\u52a1\u9700\u8981slave\u7aef\u8fc7\u6ee4\uff0c\u4f46\u662f\u5c06\u6240\u6709binlog\u65e5\u5fd7\u4f20\u8f93\u5230slave\u7aef\u4f1a\u5bfc\u81f4\u592a\u591a\u6d41\u91cf\u3002\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u53ef\u4ee5\u5728 master\u4e3b\u673a\u4e0a\u8bbe\u7f6e\u4e00\u4e2a\u9ed8\u8ba4\u5b58\u50a8\u5f15\u64ce\u4e3aBlackhole\u7684\u201cdummy\u201d\u4ece\u8fdb\u7a0b</p>"},{"location":"basic/10.MySQL%E5%AD%98%E5%82%A8%E5%BC%95%E6%93%8E/#memory","title":"MEMORY\u5b58\u50a8\u5f15\u64ce","text":"<p>Memory \u5b58\u50a8\u5f15\u64ce \u662f MySQL \u4e2d\u4e00\u79cd\u9ad8\u6027\u80fd\u4f46\u975e\u6301\u4e45\u5316\u7684\u5b58\u50a8\u65b9\u6848\uff0c\u9002\u5408\u4e34\u65f6\u6570\u636e\u5b58\u50a8\u548c\u7f13\u5b58\u573a\u666f\u3002\u5176\u6838\u5fc3\u4f18\u52bf\u5728\u4e8e\u6781\u5feb\u7684\u8bfb\u5199\u901f\u5ea6\uff0c\u9700\u6ce8\u610f\u6570\u636e\u4e22\u5931\u98ce\u9669\u548c\u5185\u5b58\u5360\u7528\u9650\u5236\u3002\u5b83\u7528\u4e8e\u521b\u5efa\u5185\u5b58\u4e2d\u7684\u8868\uff0c\u6570\u636e\u5b58\u50a8\u5728\u5185\u5b58\uff0c\u8bbf\u95ee\u5feb\u901f\u4f46\u91cd\u542f\u540e\u6570\u636e\u4e22\u5931\u3002\u901a\u8fc7--init-file\u542f\u52a8mysqld\u53ef\u6301\u4e45\u5316\u6570\u636e\u3002</p> <p>\u5728\u4f7f\u7528\u65f6\u9700\u7ed3\u5408\u4e1a\u52a1\u9700\u6c42\uff0c\u5408\u7406\u914d\u7f6e\u53c2\u6570\uff08\u5982max_heap_table_size\uff09\uff0c\u5e76\u907f\u514d\u5c06\u5176\u7528\u4e8e\u9700\u8981\u6301\u4e45\u5316\u6216\u4e8b\u52a1\u652f\u6301\u7684\u573a\u666f\u3002</p>"},{"location":"basic/11.sql-Transaction/","title":"11. MySQL\u4e8b\u52a1\u548c\u9501","text":""},{"location":"basic/11.sql-Transaction/#_1","title":"\u6570\u636e\u5e93\u4e8b\u52a1","text":"<p>\u6570\u636e\u5e93\u4e8b\u52a1(Database Transaction)\uff0c\u4e00\u822c\u662f\u6307\u8981\u505a\u7684\u6216\u6240\u505a\u7684\u4e8b\u60c5\u3002\u5728\u8ba1\u7b97\u673a\u672f\u8bed\u4e2d\u662f\u6307\u8bbf\u95ee\u5e76\u53ef\u80fd\u66f4\u65b0\u6570\u636e\u5e93\u4e2d\u5404\u79cd\u6570\u636e\u9879\u7684\u4e00\u4e2a\u7a0b\u5e8f\u6267\u884c\u5355\u5143(unit)\u3002</p> <p>\u4e00\u4e2a\u6570\u636e\u5e93\u4e8b\u52a1\u901a\u5e38\u5305\u542b\u5bf9\u6570\u636e\u5e93\u8fdb\u884c\u8bfb\u6216\u5199\u7684\u4e00\u4e2a\u64cd\u4f5c\u5e8f\u5217\u3002\u5b83\u7684\u5b58\u5728\u6709\u4ee5\u4e0b\u4e24\u4e2a\u76ee\u7684\uff1a</p> <ul> <li>\u4e3a\u6570\u636e\u5e93\u64cd\u4f5c\u5e8f\u5217\u63d0\u4f9b\u4e86\u4e00\u4e2a\u4ece\u5931\u8d25\u4e2d\u6062\u590d\u5230\u6b63\u5e38\u72b6\u6001\u7684\u65b9\u6cd5\uff0c\u540c\u65f6\u63d0\u4f9b\u4e86\u6570\u636e\u5e93\u5373\u4f7f\u5728\u5f02\u5e38\u72b6\u6001\u4e0b\u4ecd\u80fd\u4fdd\u6301\u4e00\u81f4\u6027\u7684\u65b9\u6cd5\u3002</li> <li>\u5f53\u591a\u4e2a\u5e94\u7528\u7a0b\u5e8f\u5728\u5e76\u53d1\u8bbf\u95ee\u6570\u636e\u5e93\u65f6\uff0c\u53ef\u4ee5\u5728\u8fd9\u4e9b\u5e94\u7528\u7a0b\u5e8f\u4e4b\u95f4\u63d0\u4f9b\u4e00\u4e2a\u9694\u79bb\u65b9\u6cd5\uff0c\u4ee5\u9632\u6b62\u5f7c\u6b64\u7684\u64cd\u4f5c\u4e92\u76f8\u5e72\u6270\u3002</li> </ul> <p>\u4f20\u7edf\u5173\u7cfb\u578b\u6570\u636e\u5e93 \u4e8b\u52a1 \u662f\u8bbf\u95ee\u5e76\u53ef\u80fd\u66f4\u65b0\u5404\u79cd\u6570\u636e\u9879\u7684\u4e00\u4e2a\u7a0b\u5e8f\u6267\u884c \u5355\u5143 (unit)\u3002</p> <p>\u4e8b\u52a1\u7531\u4e00\u4e2a\u6216\u591a\u4e2a\u6b65\u9aa4\u7ec4\u6210\uff0c\u4e00\u822c\u4f7f\u7528\u5f62\u5982 <code>begin transaction</code> \u548c <code>end transaction</code> \u8bed\u53e5\u6216\u8005\u51fd\u6570\u8c03\u7528\u4f5c\u4e3a\u4e8b\u52a1\u754c\u9650\u3002</p> <p>\u4e8b\u52a1\u5185\u7684\u6240\u6709\u6b65\u9aa4\u5fc5\u987b\u4f5c\u4e3a\u4e00\u4e2a\u5355\u4e00\u7684\u3001\u4e0d\u53ef\u5206\u5272\u7684\u5355\u5143\u53bb\u6267\u884c\u3002</p> <p>\u56e0\u6b64\u4e8b\u52a1\u7684\u7ed3\u679c\u53ea\u6709\u4e24\u79cd\uff1a1. \u5168\u90e8\u6b65\u9aa4\u90fd\u6267\u884c\u5b8c\u6210\uff0c2. \u4efb\u4e00\u6b65\u9aa4\u6267\u884c\u5931\u8d25\u5219\u6574\u4e2a\u4e8b\u52a1\u56de\u6eda\u3002</p> <p>\u4e8b\u52a1\u662f\u5e94\u7528\u7a0b\u5e8f\u4e2d\u4e00\u7cfb\u5217\u4e25\u5bc6\u7684\u64cd\u4f5c\uff0c\u6240\u6709\u64cd\u4f5c\u5fc5\u987b\u6210\u529f\u5b8c\u6210\uff0c\u5426\u5219\u5728\u6bcf\u4e2a\u64cd\u4f5c\u4e2d\u6240\u4f5c\u7684\u6240\u6709\u66f4\u6539\u90fd\u4f1a\u88ab\u64a4\u6d88\u3002\u4e5f\u5c31\u662f\u8bf4\u4e8b\u52a1\u9700\u8981\u5177\u6709\u539f\u5b50\u6027\uff0c\u4e00\u4e2a\u4e8b\u52a1\u4e2d\u7684\u4e00\u7cfb\u5217\u7684\u64cd\u4f5c\u8981\u4e48\u5168\u90e8\u6210\u529f\uff0c\u8981\u4e48\u4e00\u4e2a\u90fd\u4e0d\u505a\u3002</p>"},{"location":"basic/11.sql-Transaction/#_2","title":"\u672c\u5730\u4e8b\u52a1","text":"<p>\u4e8b\u52a1\u4ec5\u9650\u4e8e\u5bf9\u5355\u4e00\u6570\u636e\u5e93\u8d44\u6e90\u7684\u8bbf\u95ee\u63a7\u5236\uff0c\u67b6\u6784\u670d\u52a1\u5316\u4ee5\u540e\uff0c\u4e8b\u52a1\u7684\u6982\u5ff5\u5ef6\u4f38\u5230\u4e86\u670d\u52a1\u4e2d\u3002\u5018\u82e5\u5c06\u4e00\u4e2a\u5355\u4e00\u7684\u670d\u52a1\u64cd\u4f5c\u4f5c\u4e3a\u4e00\u4e2a\u4e8b\u52a1\uff0c\u90a3\u4e48\u6574\u4e2a\u670d\u52a1\u64cd\u4f5c\u53ea\u80fd\u6d89\u53ca\u4e00\u4e2a\u5355\u4e00\u7684\u6570\u636e\u5e93\u8d44\u6e90,\u8fd9\u7c7b\u57fa\u4e8e\u5355\u4e2a\u670d\u52a1\u5355\u4e00\u6570\u636e\u5e93\u8d44\u6e90\u8bbf\u95ee\u7684\u4e8b\u52a1\uff0c\u88ab\u79f0\u4e3a \u672c\u5730\u4e8b\u52a1(Local Transaction)\u3002</p> <p>\u4e00\u4e2a\u4e8b\u52a1\u88ab\u63d0\u4ea4\u7ed9\u4e86DBMS\uff08\u6570\u636e\u5e93\u7ba1\u7406\u7cfb\u7edf\uff09\uff0c\u5219 DBMS \u9700\u8981\u786e\u4fdd\u8be5\u4e8b\u52a1\u4e2d\u7684\u6240\u6709\u64cd\u4f5c\u90fd\u6210\u529f\u5b8c\u6210\u4e14\u5176\u7ed3\u679c\u88ab\u6c38\u4e45\u4fdd\u5b58\u5728\u6570\u636e\u5e93\u4e2d\uff0c\u5982\u679c\u4e8b\u52a1\u4e2d\u6709\u7684\u64cd\u4f5c\u6ca1\u6709\u6210\u529f\u5b8c\u6210\uff0c\u5219\u4e8b\u52a1\u4e2d\u7684\u6240\u6709\u64cd\u4f5c\u90fd\u9700\u8981\u88ab\u56de\u6eda\uff0c\u56de\u5230\u4e8b\u52a1\u6267\u884c\u524d\u7684\u72b6\u6001\uff08\u8981\u4e48\u5168\u6267\u884c\uff0c\u8981\u4e48\u5168\u90fd\u4e0d\u6267\u884c\uff09;</p> <p>\u540c\u65f6\uff0c\u8be5\u4e8b\u52a1\u5bf9\u6570\u636e\u5e93\u6216\u8005\u5176\u4ed6\u4e8b\u52a1\u7684\u6267\u884c\u65e0\u5f71\u54cd\uff0c\u6240\u6709\u7684\u4e8b\u52a1\u90fd\u597d\u50cf\u5728\u72ec\u7acb\u7684\u8fd0\u884c\u4e00\u6837\u3002</p> <p>\u4f46\u5728\u73b0\u5b9e\u60c5\u51b5\u4e0b\uff0c\u5931\u8d25\u7684\u98ce\u9669\u5f88\u9ad8\u3002\u5728\u4e00\u4e2a\u6570\u636e\u5e93\u4e8b\u52a1\u7684\u6267\u884c\u8fc7\u7a0b\u4e2d\uff0c\u6709\u53ef\u80fd\u4f1a\u9047\u4e0a\u4e8b\u52a1\u64cd\u4f5c\u5931\u8d25\u3001\u6570\u636e\u5e93\u7cfb\u7edf/\u64cd\u4f5c\u7cfb\u7edf\u5931\u8d25\uff0c\u751a\u81f3\u662f\u5b58\u50a8\u4ecb\u8d28\u5931\u8d25\u7b49\u60c5\u51b5\u3002</p> <p>\u8fd9\u4fbf\u9700\u8981 DBMS \u5bf9\u4e00\u4e2a\u6267\u884c\u5931\u8d25\u7684\u4e8b\u52a1\u6267\u884c\u6062\u590d\u64cd\u4f5c\uff0c\u5c06\u5176\u6570\u636e\u5e93\u72b6\u6001\u6062\u590d\u5230\u4e00\u81f4\u72b6\u6001\uff08\u6570\u636e\u7684\u4e00\u81f4\u6027\u5f97\u5230\u4fdd\u8bc1\u7684\u72b6\u6001\uff09\u3002</p> <p>\u4e3a\u4e86\u5b9e\u73b0\u5c06\u6570\u636e\u5e93\u72b6\u6001\u6062\u590d\u5230\u4e00\u81f4\u72b6\u6001\u7684\u529f\u80fd\uff0cDBMS \u901a\u5e38\u9700\u8981\u7ef4\u62a4\u4e8b\u52a1\u65e5\u5fd7\u4ee5\u8ffd\u8e2a\u4e8b\u52a1\u4e2d\u6240\u6709\u5f71\u54cd\u6570\u636e\u5e93\u6570\u636e\u7684\u64cd\u4f5c\u3002</p> <p>\u4e8b\u52a1\u5e94\u8be5\u5177\u6709 4 \u4e2a\u5c5e\u6027\uff1a\u539f\u5b50\u6027\u3001\u4e00\u81f4\u6027\u3001\u9694\u79bb\u6027\u3001\u6301\u4e45\u6027\u3002\u8fd9\u56db\u4e2a\u5c5e\u6027\u901a\u5e38\u79f0\u4e3a ACID \u7279\u6027\u3002</p> <ul> <li>\u539f\u5b50\u6027(Atomicity)\uff1a\u4e8b\u52a1\u4f5c\u4e3a\u4e00\u4e2a\u6574\u4f53\u88ab\u6267\u884c\uff0c\u5305\u542b\u5728\u5176\u4e2d\u7684\u5bf9\u6570\u636e\u5e93\u7684\u64cd\u4f5c\u8981\u4e48\u5168\u90e8\u88ab\u6267\u884c\uff0c\u8981\u4e48\u90fd\u4e0d\u6267\u884c\u3002</li> <li>\u4e00\u81f4\u6027(Consistency)\uff1a\u4e8b\u52a1\u5e94\u786e\u4fdd\u6570\u636e\u5e93\u7684\u72b6\u6001\u4ece\u4e00\u4e2a\u4e00\u81f4\u72b6\u6001\u8f6c\u53d8\u4e3a\u53e6\u4e00\u4e2a\u4e00\u81f4\u72b6\u6001\u3002\u4e00\u81f4\u72b6\u6001\u7684\u542b\u4e49\u662f\u6570\u636e\u5e93\u4e2d\u7684\u6570\u636e\u5e94\u6ee1\u8db3\u5b8c\u6574\u6027\u7ea6\u675f\u3002</li> <li>\u9694\u79bb\u6027(Isolation)\uff1a\u591a\u4e2a\u4e8b\u52a1\u5e76\u53d1\u6267\u884c\u65f6\uff0c\u4e00\u4e2a\u4e8b\u52a1\u7684\u6267\u884c\u4e0d\u5e94\u5f71\u54cd\u5176\u4ed6\u4e8b\u52a1\u7684\u6267\u884c\u3002\uff08\u53d6\u51b3\u4e8e RDBMS \u7684\u9694\u79bb\u7ea7\u522b\uff09</li> <li>\u6301\u4e45\u6027(Durability)\uff1a \u4e00\u4e2a\u4e8b\u52a1\u4e00\u65e6\u63d0\u4ea4\uff0c\u4ed6\u5bf9\u6570\u636e\u5e93\u7684\u4fee\u6539\u5e94\u8be5\u6c38\u4e45\u4fdd\u5b58\u5728\u6570\u636e\u5e93\u4e2d\u3002</li> </ul> <p>\u5728\u540c\u4e00\u4e2a RDBMS \u4e2d\uff0c\u7528\u4e00\u4e2a\u5e38\u7528\u7684 A \u8d26\u6237\u5411 B \u8d26\u53f7\u6c47\u94b1 \u7684\u4f8b\u5b50\u6765\u8bf4\u660e\u5982\u4f55\u901a\u8fc7\u6570\u636e\u5e93\u4e8b\u52a1\u4fdd\u8bc1\u6570\u636e\u7684\u51c6\u786e\u6027\u548c\u5b8c\u6574\u6027\u3002\u719f\u6089\u5173\u7cfb\u578b\u6570\u636e\u5e93\u4e8b\u52a1\u7684\u90fd\u77e5\u9053\u4ece\u5e10\u53f7 A \u5230\u5e10\u53f7 B \u9700\u8981 6 \u4e2a\u64cd\u4f5c\uff1a</p> <pre><code>1. \u4eceA\u8d26\u53f7\u4e2d\u628a\u4f59\u989d\u8bfb\u51fa\u6765\uff08500\uff09\u3002\n\n2. \u5bf9A\u8d26\u53f7\u505a\u51cf\u6cd5\u64cd\u4f5c\uff08500-100\uff09\u3002\n\n3. \u628a\u7ed3\u679c\u5199\u56deA\u8d26\u53f7\u4e2d\uff08400\uff09\u3002\n\n4. \u4eceB\u8d26\u53f7\u4e2d\u628a\u4f59\u989d\u8bfb\u51fa\u6765\uff08500\uff09\u3002\n\n5. \u5bf9B\u8d26\u53f7\u505a\u52a0\u6cd5\u64cd\u4f5c\uff08500+100\uff09\u3002\n\n6. \u628a\u7ed3\u679c\u5199\u56deB\u8d26\u53f7\u4e2d\uff08600\uff09\u3002\n</code></pre> \u6570\u636e\u5e93\u4e8b\u52a1 <ul> <li> <p>\u539f\u5b50\u6027\uff1a\u4e00\u4e2a\u4e8b\u52a1\u5fc5\u987b\u88ab\u89c6\u4e3a\u4e00\u4e2a\u4e0d\u53ef\u5206\u5272\u7684\u6700\u5c0f\u5de5\u4f5c\u5355\u4f4d\uff0c\u6574\u4e2a\u4e8b\u52a1\u4e2d\u7684\u6240\u6709\u64cd\u4f5c\u8981\u4e48\u5168\u90e8\u63d0\u4ea4\u6210\u529f\uff0c\u8981\u4e48\u5168\u90e8\u5931\u8d25\u56de\u6eda\uff0c\u4e0d\u80fd\u53ea\u6267\u884c\u4e00\u90e8\u5206\u64cd\u4f5c\u3002</p> <p>\u4fdd\u8bc11-6\u6240\u6709\u8fc7\u7a0b\u8981\u4e48\u90fd\u6267\u884c\uff0c\u8981\u4e48\u90fd\u4e0d\u6267\u884c\u3002\u4e00\u65e6\u5728\u6267\u884c\u67d0\u4e00\u6b65\u9aa4\u7684\u8fc7\u7a0b\u4e2d\u53d1\u751f\u95ee\u9898\uff0c\u5c31\u9700\u8981\u6267\u884c\u56de\u6eda\u64cd\u4f5c\u3002 \u5047\u5982\u6267\u884c\u5230\u7b2c\u4e94\u6b65\u7684\u65f6\u5019\uff0cB\u8d26\u6237\u7a81\u7136\u4e0d\u53ef\u7528\uff08\u6bd4\u5982\u88ab\u6ce8\u9500\uff09\uff0c\u90a3\u4e48\u4e4b\u524d\u7684\u6240\u6709\u64cd\u4f5c\u90fd\u5e94\u8be5\u56de\u6eda\u5230\u6267\u884c\u4e8b\u52a1\u4e4b\u524d\u7684\u72b6\u6001\u3002</p> </li> <li> <p>\u4e00\u81f4\u6027\uff1a\u4e00\u81f4\u6027\u8981\u6c42\u6570\u636e\u5e93\u603b\u662f\u4ece\u4e00\u4e2a\u4e00\u81f4\u6027\u7684\u72b6\u6001\u8f6c\u6362\u4e3a\u53e6\u5916\u4e00\u4e2a\u4e00\u81f4\u6027\u7684\u72b6\u6001</p> <p>\u5728\u8f6c\u8d26\u4e4b\u524d\uff0cA\u548cB\u7684\u8d26\u6237\u4e2d\u5171\u6709500+500=1000\u5143\u94b1\u3002\u5728\u8f6c\u8d26\u4e4b\u540e\uff0cA\u548cB\u7684\u8d26\u6237\u4e2d\u5171\u6709400+600=1000\u5143\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c\u6570\u636e\u7684\u72b6\u6001\u5728\u6267\u884c\u8be5\u4e8b\u52a1\u64cd\u4f5c\u4e4b\u540e\u4ece\u4e00\u4e2a\u72b6\u6001\u6539\u53d8\u5230\u4e86\u53e6\u5916\u4e00\u4e2a\u72b6\u6001\u3002\u540c\u65f6\u4e00\u81f4\u6027\u8fd8\u80fd\u4fdd\u8bc1\u8d26\u6237\u4f59\u989d\u4e0d\u4f1a\u53d8\u6210\u8d1f\u6570\u7b49\u3002</p> </li> <li> <p>\u9694\u79bb\u6027\uff1a\u591a\u4e2a\u4e8b\u52a1\u5e76\u53d1\u6267\u884c\u65f6\uff0c\u4e00\u4e2a\u4e8b\u52a1\u7684\u6267\u884c\u4e0d\u5e94\u5f71\u54cd\u5176\u4ed6\u4e8b\u52a1\u7684\u6267\u884c\u3002\uff08\u53d6\u51b3\u4e8eRDBMS\u7684\u4e8b\u52a1\u9694\u79bb\u7ea7\u522b\uff09</p> <p>\u5728A\u5411B\u8f6c\u8d26\u7684\u6574\u4e2a\u8fc7\u7a0b\u4e2d\uff0c\u53ea\u8981\u4e8b\u52a1\u8fd8\u6ca1\u6709\u63d0\u4ea4\uff08commit\uff09\uff0c\u67e5\u8be2A\u8d26\u6237\u548cB\u8d26\u6237\u7684\u65f6\u5019\uff0c\u4e24\u4e2a\u8d26\u6237\u91cc\u9762\u7684\u94b1\u7684\u6570\u91cf\u90fd\u4e0d\u4f1a\u6709\u53d8\u5316\u3002 \u5982\u679c\u5728A\u7ed9B\u8f6c\u8d26\u7684\u540c\u65f6\uff0c\u6709\u53e6\u5916\u4e00\u4e2a\u4e8b\u52a1\u6267\u884c\u4e86C\u7ed9B\u8f6c\u8d26\u7684\u64cd\u4f5c\uff0c\u90a3\u4e48\u5f53\u4e24\u4e2a\u4e8b\u52a1\u90fd\u7ed3\u675f\u7684\u65f6\u5019\uff0cB\u8d26\u6237\u91cc\u9762\u7684\u94b1\u5e94\u8be5\u662fA\u8f6c\u7ed9B\u7684\u94b1\u52a0\u4e0aC\u8f6c\u7ed9B\u7684\u94b1\u518d\u52a0\u4e0a\u81ea\u5df1\u539f\u6709\u7684\u94b1\u3002</p> </li> <li> <p>\u6301\u4e45\u6027\uff1a\u4e8b\u52a1\u4e00\u65e6\u63d0\u4ea4\uff0c\u6240\u505a\u7684\u72b6\u6001\u5c31\u4f1a\u6c38\u4e45\u4fdd\u5b58\u5728\u6570\u636e\u5e93\u4e2d\uff0c\u5373\u4f7f\u7cfb\u7edf\u5954\u6e83\uff0c\u4fee\u6539\u7684\u6570\u636e\u4e5f\u4e0d\u4f1a\u4e22\u3002</p> <p>\u4e00\u65e6\u8f6c\u8d26\u6210\u529f\uff08\u4e8b\u52a1\u63d0\u4ea4\uff09\uff0c\u4e24\u4e2a\u8d26\u6237\u7684\u91cc\u9762\u7684\u94b1\u5c31\u4f1a\u771f\u7684\u53d1\u751f\u53d8\u5316\uff08\u4f1a\u628a\u6570\u636e\u5199\u5165\u6570\u636e\u5e93\u505a\u6301\u4e45\u5316\u4fdd\u5b58\uff09\u3002</p> </li> </ul>"},{"location":"basic/11.sql-Transaction/#_3","title":"\u5206\u5e03\u5f0f\u4e8b\u52a1","text":""},{"location":"basic/11.sql-Transaction/#_4","title":"\u67e5\u8be2\u4f1a\u4e0d\u4f1a\u5f00\u4e8b\u52a1\uff1f","text":"<p>MySQL \u4e2d\u4e8b\u52a1\u9ed8\u8ba4\u662f\u9690\u5f0f\u4e8b\u52a1\uff08\u5373\u81ea\u52a8\u63d0\u4ea4<code>autocommit=1</code>\uff09\uff0c\u5728\u6267\u884c <code>INSERT</code>\u3001<code>UPDATE</code>\u3001<code>DELETE</code> \u7b49\u5177\u4f53\u6570\u636e\u64cd\u4f5c\u7684\u65f6\u5019\uff0c\u6570\u636e\u5e93\u81ea\u52a8\u5f00\u542f\u4e8b\u52a1\u3001\u63d0\u4ea4\u6216\u56de\u6eda\u4e8b\u52a1\u3002\u4e5f\u5c31\u662f\u5982\u679c\u4e0d\u662f\u663e\u5f0f\u5f00\u542f\u4e00\u4e2a\u4e8b\u52a1\uff0c\u5219\u6bcf\u6761 SQL \u8bed\u53e5\u90fd\u5f62\u6210\u72ec\u7acb\u4e8b\u52a1\u3002\u5982\u679c\u8be5\u8bed\u53e5\u6267\u884c\u540e\u6ca1\u6709\u8fd4\u56de\u9519\u8bef\uff0cMySQL \u4f1a\u81ea\u52a8\u6267\u884c COMMIT\u3002\u4f46\u5982\u679c\u8be5\u8bed\u53e5\u8fd4\u56de\u9519\u8bef\uff0c\u5219\u6839\u636e\u9519\u8bef\u60c5\u51b5\u6267\u884c COMMIT \u6216 ROLLBACK\u3002</p> <p>\u5982\u679c\u60f3\u5f00\u542f\u4e8b\u52a1\uff0c\u5148\u8bbe\u7f6e <code>autocommit=0</code>\uff0c\u7136\u540e\u7528 <code>START TRANSACTION</code>\u3001 <code>COMMIT</code>\u3001 <code>ROLLBACK</code> \u8fd9\u4e9b\u4e8b\u52a1\u63a7\u5236\u8bed\u53e5\u6765\u4f7f\u7528\u5177\u4f53\u7684\u4e8b\u52a1\u3002</p> <p>\u901a\u8fc7\u5982\u4e0b\u65b9\u5f0f\uff0c\u53ef\u4ee5\u5173\u95ed autocommit\uff1b\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0cautocommit \u53c2\u6570\u662f\u9488\u5bf9\u8fde\u63a5\u7684\uff0c\u5728\u4e00\u4e2a\u8fde\u63a5\u4e2d\u4fee\u6539\u4e86\u53c2\u6570\uff0c\u4e0d\u4f1a\u5bf9\u5176\u4ed6\u8fde\u63a5\u4ea7\u751f\u5f71\u54cd\u3002\u5982\u679c\u4f60\u65b0\u5f00\u4e00\u4e2a\u547d\u4ee4\u7a97\u53e3\uff0c\u4f1a\u6062\u590d\u5230\u9ed8\u8ba4\u503c\u3002</p> <pre><code>mysql&gt; set autocommit = 0;\nQuery OK, 0 rows affected\n\nmysql&gt; show variables like 'autocommit';\n+---------------+-------+\n| Variable_name | Value |\n+---------------+-------+\n| autocommit    | OFF   |\n+---------------+-------+\n1 row in set\n</code></pre> <p>\u5982\u679c\u5173\u95ed\u4e86 autocommit\uff0c\u5219\u4e00\u4e2a\u4f1a\u8bdd\u4e2d\u6240\u6709\u7684 sql \u8bed\u53e5\u90fd\u5728\u4e00\u4e2a\u4e8b\u52a1\u4e2d\uff0c\u76f4\u5230\u6267\u884c\u4e86 commit \u6216 rollback\uff0c\u8be5\u4e8b\u52a1\u7ed3\u675f\uff0c\u540c\u65f6\u9a6c\u4e0a\u5f00\u59cb\u4e0b\u4e00\u4e2a\u4e8b\u52a1\u3002</p> <pre><code>--\u7a97\u53e3\u4e00\uff1a\u663e\u5f0f\u5f00\u542f\u4e8b\u52a1\uff0c\u52a0\u9501\u6267\u884c\u67e5\u8be2\u3002\u5e76\u672a\u63d0\u4ea4\u4e8b\u52a1\uff0c\u9501\u4e00\u76f4\u7ef4\u6301\nstart  TRANSACTION;\nselect *  from test1 for share ;\n\n--\u7a97\u53e3\u4e8c\uff1a\u53d8\u66f4\u8868\u7ed3\u6784\uff0c\u8981\u83b7\u53d6\u5199\u9501\uff0c\u4e00\u76f4\u5728\u7b49\u5f85\uff0cWaiting for table metadata lock\nalter table test1 add COLUMN test4 VARCHAR(20) ;\n\n--\u7a97\u53e3\u4e09\uff1a\u67e5\u770b\u672a\u63d0\u4ea4\u7684\u4e8b\u52a1\uff0c\u6709\u4e00\u6761\u8bb0\u5f55\uff0c\u6b63\u5728\u6267\u884c\u7684sql\u4e3a\u7a7a\nselect * from INFORMATION_SCHEMA.INNODB_TRX;\n</code></pre> <p>\u4e8b\u52a1\u7684\u4e00\u4e9b\u5173\u952e\u8bed\u53e5</p> <pre><code>-- \u5f00\u59cb\u4e00\u4e2a\u65b0\u7684\u8bfb\u5199\u4e8b\u52a1:\u56db\u79cd\u5199\u6cd5\n\n-- BEGIN \u8bed\u53e5\u3002\u8fd9\u4e2a\u8bed\u53e5\u672c\u8d28\u4e0a\u5e94\u8be5\u662f\u8f9e\u65e7\u8fce\u65b0\uff08\u63d0\u4ea4\u8001\u4e8b\u52a1\uff0c\u51c6\u5907\u65b0\u4e8b\u52a1\uff09\u3002\n-- \u5728\u4e00\u4e2a\u4f1a\u8bdd\u4e2d\uff0c\u5982\u679c\u524d\u9762\u7684\u4e00\u4e2a\u4e8b\u52a1\u8fd8\u6ca1\u63d0\u4ea4\u5c31\u9047\u5230BEGIN\u8bed\u53e5\u65f6\uff0c\u8fd9\u4e2aBEGIN\u5c31\u4f1a\u63d0\u4ea4\u8001\u4e8b\u52a1\uff0c\u51c6\u5907\u65b0\u4e8b\u52a1\u3002\n-- \u539f\u56e0\u662fMySQL\u4e0d\u652f\u6301\u5d4c\u5957\u4e8b\u52a1\u3002\u524d\u9762\u7684\u4e8b\u52a1\u6ca1\u6709\u63d0\u4ea4\u7684\u60c5\u51b5\u4e0b\uff0c\u53c8\u8981BEGIN\u5f00\u59cb\u4e00\u4e2a\u65b0\u4e8b\u52a1\uff0c\u524d\u9762\u7684\u4e8b\u52a1\u65e0\u5904\u5b89\u653e\uff0c\u53ea\u80fd\u88ab\u52a8\u63d0\u4ea4\u4e86\u3002  \nBEGIN ;       \nBEGIN WORK ; \nSTART TRANSACTION ;\nSTART TRANSACTION READ WRITE ;\n\n-- \u5f00\u59cb\u4e00\u4e2a\u65b0\u7684\u53ea\u8bfb\u4e8b\u52a1\nSTART TRANSACTION READ ONLY\n\n-- \u8fd9\u4e24\u7c7b\u8bed\u53e5\u90fd\u4e0d\u9700\u7acb\u5373\u521b\u5efa\u4e00\u81f4\u6027\u8bfb\u89c6\u56fe\uff0c\u4e8b\u52a1\u7684\u542f\u52a8\u5c06\u5ef6\u8fdf\u81f3\u5b9e\u9645\u9700\u8981\u65f6\u3002\n\n\n\n-- \u5f00\u542f\u4e00\u4e2a\u65b0\u7684\u8bfb\u5199\u4e8b\u52a1\uff1a\u4e24\u79cd\u5199\u6cd5\nSTART TRANSACTION WITH CONSISTENT SNAPSHOT\nSTART TRANSACTION WITH CONSISTENT SNAPSHOT, READ WRITE\n\n-- \u5f00\u542f\u4e00\u4e2a\u65b0\u7684\u53ea\u8bfb\u4e8b\u52a1\nSTART TRANSACTION WITH CONSISTENT SNAPSHOT, READ ONLY\n\n-- \u8fd9\u4e24\u7c7b\u8bed\u53e5\u90fd\u4f1a\u5148\u542f\u52a8\u4e8b\u52a1\uff0c\u968f\u540e\u7acb\u5373\u521b\u5efa\u4e00\u81f4\u6027\u8bfb\u89c6\u56fe\u3002\n</code></pre>"},{"location":"basic/11.sql-Transaction/#_5","title":"\u4e8b\u52a1\u5f00\u542f\u65f6\u95f4","text":"<p>\u4e00\u822c\u6211\u4eec\u4f1a\u8ba4\u4e3a begin/start transaction \u662f\u4e8b\u52a1\u5f00\u59cb\u7684\u65f6\u95f4\u70b9\uff0c\u4e5f\u5c31\u662f\u4e00\u65e6\u6211\u4eec\u6267\u884c\u4e86 start transaction\uff0c\u5c31\u8ba4\u4e3a\u4e8b\u52a1\u5df2\u7ecf\u5f00\u59cb\u4e86\uff0c\u5176\u5b9e\u8fd9\u662f\u9519\u8bef\u7684\u3002</p> <p>\u4e0a\u9762\u7684\u5b9e\u9a8c\u4e5f\u8bf4\u660e\u4e86\u8fd9\u4e00\u70b9\u3002\u4e8b\u52a1\u5f00\u59cb\u7684\u771f\u6b63\u7684\u65f6\u95f4\u70b9(LSN)\uff0c\u662f start transaction \u4e4b\u540e\u6267\u884c\u7684\u7b2c\u4e00\u6761\u8bed\u53e5\uff0c\u4e0d\u7ba1\u662f\u4ec0\u4e48\u8bed\u53e5\uff0c\u4e0d\u7ba1\u6210\u529f\u4e0e\u5426\u3002</p> <p>MySQL \u4e00\u81f4\u6027\u8bfb\u6df1\u5165\u7814\u7a76</p> <p>\u6ce8\u610f\uff0c\u4e8b\u52a1\u662f\u5426\u63d0\u4ea4\u548c\u662f\u5426\u6709 sql \u5728\u6267\u884c\uff0c\u5e76\u4e0d\u662f\u4e00\u56de\u4e8b</p>"},{"location":"basic/11.sql-Transaction/#_6","title":"\u4e8b\u52a1\u4fdd\u5b58\u70b9","text":"<p>\u6241\u5e73\u4e8b\u52a1\uff08Flat Transaction\uff09\u662f\u4e8b\u52a1\u7c7b\u578b\u4e2d\u6700\u7b80\u5355\u7684\u4e00\u79cd\uff0c\u5728\u5b9e\u9645\u751f\u4ea7\u73af\u5883\u4e2d\uff0c\u8fd9\u53ef\u80fd\u662f\u4f7f\u7528\u6700\u4e3a\u9891\u7e41\u7684\u4e8b\u52a1\u3002\u5728\u6241\u5e73\u4e8b\u52a1\u4e2d\uff0c\u6240\u6709\u64cd\u4f5c\u90fd\u5904\u4e8e\u540c\u4e00\u5c42\u6b21\uff0c\u5176\u7531<code>BEGIN</code>\u5f00\u59cb\uff0c\u7531<code>COMMIT</code>\u6216<code>ROLLBACK</code>\u7ed3\u675f\uff0c\u5176\u95f4\u7684\u64cd\u4f5c\u662f\u539f\u5b50\u7684\uff0c\u8981\u4e48\u90fd\u6267\u884c\uff0c\u8981\u4e48\u90fd\u56de\u6eda</p> <p>\u56e0\u6b64\u6241\u5e73\u4e8b\u52a1\u662f\u5e94\u7528\u7a0b\u5e8f\u6210\u4e3a\u539f\u5b50\u64cd\u4f5c\u7684\u57fa\u672c\u7ec4\u6210\u6a21\u5757</p> <p>\u4e8b\u52a1\u662f\u8bbf\u95ee\u5e76\u66f4\u65b0\u6570\u636e\u5e93\u4e2d\u5404\u79cd\u6570\u636e\u9879\u7684\u4e00\u4e2a\u7a0b\u5e8f\u6267\u884c\u5355\u5143\uff0c\u4e8b\u52a1\u4f1a\u628a\u6570\u636e\u5e93\u4ece\u4e00\u79cd\u4e00\u81f4\u72b6\u6001\u8f6c\u6362\u4e3a\u53e6\u4e00\u79cd\u4e00\u81f4\u72b6\u6001\uff0c\u8fd9\u5c31\u662f\u4e8b\u52a1\u7684\u76ee\u7684\uff0c\u4e5f\u662f\u4e8b\u52a1\u6a21\u578b\u533a\u522b\u4e0e\u6587\u4ef6\u7cfb\u7edf\u7684\u91cd\u8981\u7279\u6027\u4e4b\u4e00\u3002</p> <p>\u6211\u4eec\u4e4b\u524d\u7406\u89e3\u7684\u4e8b\u52a1\u64cd\u4f5c\u662f\u539f\u5b50\u7684\uff0c\u8981\u4e48\u90fd\u6267\u884c\uff0c\u8981\u4e48\u90fd\u56de\u6eda\uff0c\u4e5f\u5c31\u662f\u901a\u5e38\u610f\u4e49\u4e0a\u6211\u4eec\u7406\u89e3\u7684\u4e8b\u52a1\u6982\u5ff5\u3002</p> <p>\u6241\u5e73\u4e8b\u52a1\u867d\u7136\u7b80\u5355\uff0c\u4f46\u5728\u5b9e\u9645\u751f\u4ea7\u73af\u5883\u4e2d\u4f7f\u7528\u6700\u4e3a\u9891\u7e41\uff0c\u6545\u6bcf\u4e2a\u6570\u636e\u5e93\u7cfb\u7edf\u90fd\u5b9e\u73b0\u4e86\u5bf9\u6241\u5e73\u4e8b\u52a1\u7684\u652f\u6301\u6241\u5e73\u4e8b\u52a1\u7684\u4e3b\u8981\u9650\u5236\u662f\u4e0d\u80fd\u63d0\u4ea4\u6216\u8005\u56de\u6eda\u4e8b\u52a1\u7684\u67d0\u4e00\u90e8\u5206\uff0c\u6216\u5206\u51e0\u4e2a\u6b65\u9aa4\u63d0\u4ea4\u3002</p> <p>\u4f8b\u5982\u7528\u6237\u5728\u65c5\u884c\u7f51\u7ad9\u4e0a\u8fdb\u884c\u81ea\u5df1\u7684\u65c5\u884c\u5ea6\u5047\u8ba1\u5212\u3002\u7528\u6237\u8bbe\u60f3\u4ece\u676d\u5dde\u5230\u610f\u5927\u5229\u7684\u4f5b\u7f57\u4f26\u8428\uff0c\u8fd9\u4e24\u4e2a\u57ce\u5e02\u4e4b\u95f4\u6ca1\u6709\u76f4\u8fbe\u7684\u73ed\u673a\uff0c\u9700\u8981\u7528\u6237\u9884\u8ba2\u5e76\u8f6c\u4e58\u822a\u73ed\uff0c\u6216\u8005\u9700\u8981\u642d\u706b\u8f66\u7b49\u5f85\u3002\u7528\u6237\u9884\u8ba2\u65c5\u884c\u5ea6\u5047\u7684\u4e8b\u52a1\u4e3a\uff1a</p> <pre><code>BEGIN WORK\n-- S1\uff1a\u9884\u8ba2\u676d\u5dde\u5230\u4e0a\u6d77\u7684\u9ad8\u94c1\n-- S2\uff1a\u4e0a\u6d77\u6d66\u4e1c\u56fd\u9645\u673a\u573a\u5750\u98de\u673a\uff0c\u9884\u8ba2\u53bb\u7c73\u5170\u7684\u822a\u73ed\n-- S3\uff1a\u5728\u7c73\u5170\u8f6c\u706b\u8f66\u524d\u5f80\u4f5b\u7f57\u4f26\u8428\uff0c\u9884\u8ba2\u53bb\u4f5b\u7f57\u4f26\u8428\u7684\u706b\u8f66\n</code></pre> <p>\u4f46\u662f\u5f53\u7528\u6237\u6267\u884c\u5230 S3 \u65f6\uff0c\u53d1\u73b0\u7531\u4e8e\u98de\u673a\u5230\u8fbe\u7c73\u5170\u7684\u65f6\u95f4\u592a\u665a\uff0c\u5df2\u7ecf\u6ca1\u6709\u5f53\u5929\u7684\u706b\u8f66\u3002\u8fd9\u65f6\u7528\u6237\u5e0c\u671b\u5728\u7c73\u5170\u5f53\u5730\u4f4f\u4e00\u665a\uff0c\u7b2c\u4e8c\u5929\u51fa\u53d1\u53bb\u4f5b\u7f57\u4f26\u8428\u3002\u8fd9\u65f6\u5982\u679c\u4e8b\u52a1\u4e3a\u6241\u5e73\u4e8b\u52a1\uff0c\u5219\u9700\u8981\u56de\u6eda\u4e4b\u524d S1\u3001S2\u3001S3 \u7684\u4e09\u4e2a\u64cd\u4f5c\uff0c\u8fd9\u4e2a\u4ee3\u4ef7\u5c31\u663e\u5f97\u6709\u70b9\u5927\u3002\u56e0\u4e3a\u5f53\u518d\u6b21\u8fdb\u884c\u8be5\u4e8b\u52a1\u65f6\uff0cS1\u3001S2 \u7684\u6267\u884c\u8ba1\u5212\u662f\u4e0d\u53d8\u7684</p> <p>\u4ece\u9650\u5236\u4e2d\u770b\u51fa\uff0c\u5982\u679c\u652f\u6301\u6709\u8ba1\u5212\u7684\u56de\u6eda\u64cd\u4f5c\uff0c\u90a3\u4e48\u5c31\u4e0d\u9700\u8981\u7ec8\u6b62\u6574\u4e2a\u4e8b\u52a1\u3002\u56e0\u6b64\u5c31\u51fa\u73b0\u4e86\u5e26\u6709\u4fdd\u5b58\u70b9\u7684\u6241\u5e73\u4e8b\u52a1\u3002</p> <p>\u5e26\u6709\u4fdd\u5b58\u70b9\u7684\u6241\u5e73\u4e8b\u52a1\uff0c\u9664\u4e86\u652f\u6301\u6241\u5e73\u4e8b\u52a1\u652f\u6301\u7684\u64cd\u4f5c\u5916\uff0c\u5141\u8bb8\u5728\u4e8b\u52a1\u6267\u884c\u8fc7\u7a0b\u4e2d\u56de\u6eda\u5230\u540c\u4e00\u4e8b\u52a1\u4e2d\u8f83\u65e9\u7684\u4e00\u4e2a\u72b6\u6001\u3002\u8fd9\u662f\u56e0\u4e3a\u67d0\u4e9b\u4e8b\u52a1\u53ef\u80fd\u5728\u6267\u884c\u8fc7\u7a0b\u4e2d\u51fa\u73b0\u7684\u9519\u8bef\u5e76\u4e0d\u4f1a\u5bfc\u81f4\u6240\u6709\u7684\u64cd\u4f5c\u90fd\u65e0\u6548\uff0c\u653e\u5f03\u6574\u4e2a\u4e8b\u52a1\u4e0d\u5408\u4e4e\u8981\u6c42\uff0c\u5f00\u9500\u4e5f\u592a\u5927</p> <p>\u5728\u6807\u51c6 SQL \u4e2d\uff0cSQL \u8bed\u8a00\u56fd\u9645\u6807\u51c6\u4e2d\uff0c<code>SAVEPOINT name</code>\u8bed\u53e5\u58f0\u660e\u4e00\u4e2a savepoint\u3002<code>ROLLBACK TO SAVEPOINT name</code>\u8bed\u53e5\u56de\u6eda\u5230 savepoint\u3002<code>RELEASE SAVEPOINT name</code>\u5c06\u4f7f\u5f97\u547d\u540d\u7684 savepoint \u88ab\u653e\u5f03\uff0c\u4f46\u4e0d\u5f71\u54cd\u5176\u4ed6 savepoint\u3002<code>ROLLBACK</code>\u6216<code>COMMIT</code>\u5bfc\u81f4\u6240\u6709<code>savepoint</code>\u88ab\u653e\u5f03\u3002</p> <p>\u5bf9\u4e8e\u4e00\u4e2a\u4e8b\u52a1\u4e2d\u6709\u591a\u4e2a\u8bed\u53e5\u64cd\u4f5c\u5e8f\u5217\uff0c\u5982\u679c\u652f\u6301\u6709\u8ba1\u5212\u7684\u56de\u6eda\u64cd\u4f5c\uff0c\u90a3\u4e48\u5c31\u4e0d\u9700\u8981\u7ec8\u6b62\u6574\u4e2a\u4e8b\u52a1\u3002\u56e0\u6b64\u5c31\u51fa\u73b0\u4e86\u5e26\u6709**\u4fdd\u5b58\u70b9\u7684\u4e8b\u52a1**</p> <p>\u4e8b\u52a1\u4fdd\u5b58\u70b9\uff08savepoint\uff09\uff0c\u6307\u7684\u662f\u5bf9\u4e8b\u52a1\u6267\u884c\u8fc7\u7a0b\u4e2d\u505a\u4f4d\u7f6e\u4fdd\u5b58\uff08\u7c7b\u4f3c\u6211\u4eec\u6253\u6e38\u620f\u65f6\u7684\u5b58\u76d8\u70b9\uff09\uff0c\u5982\u679c\u4f60\u5199\u4e86\u4e00\u5927\u5806\u7684\u8bed\u53e5\uff0c\u4f46\u662f\u6709\u90e8\u5206\u662f\u4f60\u4e0d\u60f3\u56de\u6eda\u7684\uff0c\u60f3\u4fdd\u7559\u4fee\u6539\u7684\u72b6\u6001\uff0c\u4f46\u662f\u90e8\u5206\u662f\u4f60\u60f3\u56de\u6eda\u7684\u3002</p> <pre><code>mysql&gt; start transaction; --\u5f00\u542f\u4e8b\u52a1\nQuery OK, 0 rows affected\n\nmysql&gt; insert into classes values(7,'\u521d\u4e09\u4e03\u73ed');\nQuery OK, 1 row affected\n\nmysql&gt; savepoint point1; --\u6ce8\u610f\uff1a\u8fd9\u8fb9\u8bbe\u7f6e\u4e86\u4e00\u4e2a\u5b58\u76d8\u70b9\nQuery OK, 0 rows affected\n\nmysql&gt; insert into classes values(8,'\u521d\u4e09\u516b\u73ed');\nQuery OK, 1 row affected\n\nmysql&gt; rollback to point1; --\u8bb0\u4f4f\u8fd9\u4e2a\u8bed\u6cd5\uff0c\u56de\u6eda\u5230\u5b58\u76d8\u70b9\uff0c\u5b58\u76d8\u70b9\u4e4b\u540e\u7684\u8bed\u53e5\u5c31\u4e22\u5f03\u4e86\nQuery OK, 0 rows affected\n\nmysql&gt; commit;\nQuery OK, 0 rows affected\n\nmysql&gt; select * from  classes; --\u6700\u540e\u8f93\u51fa\uff0c\u786e\u5b9e\u53ea\u6709\u5b58\u76d8\u70b9\u4e4b\u524d\u7684\u6210\u529f\u4e86\n+---------+-----------+\n| classid | classname |\n+---------+-----------+\n|       1 | \u521d\u4e09\u4e00\u73ed  |\n|       2 | \u521d\u4e09\u4e8c\u73ed  |\n|       3 | \u521d\u4e09\u4e09\u73ed  |\n|       4 | \u521d\u4e09\u56db\u73ed  |\n|       5 | \u521d\u4e09\u4e94\u73ed  |\n|       6 | \u521d\u4e09\u516d\u73ed  |\n|       7 | \u521d\u4e09\u4e03\u73ed  |\n+---------+-----------+\n7 rows in set\n</code></pre>"},{"location":"basic/11.sql-Transaction/#mysql","title":"MySQL\u4e2d\u7684\u4e8b\u52a1","text":"<p>\u4e8b\u52a1\u4e0d\u662f<code>MySQL</code>\u7684\u539f\u751f\u652f\u6301\uff0c\u800c\u662f<code>InnoDB</code>\u5b58\u50a8\u5f15\u64ce\u5e26\u6765\u7684 Feature\u3002\u65e7\u7248\u672cMySQL\u7684\u9ed8\u8ba4\u5b58\u50a8\u5f15\u64ce MyISAM \u5c31\u4e0d\u652f\u6301\u4e8b\u52a1\u80fd\u529b\u3002\u6b63\u56e0\u4e3a\u4e8b\u52a1\u80fd\u529b\uff0cMySQL \u7684\u529f\u80fd\u8d8a\u53d1\u5f3a\u5927\uff0c\u4e5f\u662f\u56e0\u4e3a\u4e8b\u52a1\uff0cMySQL\u7ecf\u5e38\u5b58\u5728\u548c\u7d22\u5f15\u65e0\u5173\u7684\u5f88\u591a\u6162\u67e5\u8be2\u3002</p> <p>\u524d\u9762\u94fa\u57ab\u4e86\u5f88\u591a\u6570\u636e\u57fa\u7840\u77e5\u8bc6\uff0c\u4f5c\u4e3a<code>MySQL</code>\u4e2d\u652f\u6301\u4e8b\u52a1\u7684\u9ed8\u8ba4\u5b58\u50a8\u5f15\u64ce\uff0cInnoDB\u5bf9\u8868\u4e2d\u6570\u636e\u7684\u8bfb\u5199\u64cd\u4f5c\u90fd\u5728\u4e8b\u52a1\u4e2d\u6267\u884c\u3002</p> <p><code>MySQL</code>\u88ab\u8bbe\u8ba1\u4e3a\u652f\u6301\u9ad8\u5e76\u53d1\uff0c\u652f\u6301\u5f88\u591a\u5ba2\u6237\u7aef\u540c\u65f6\u8fde\u63a5\u5230\u6570\u636e\u5e93\uff0c\u8fd9\u4e9b\u8fde\u63a5\u53ef\u4ee5\u540c\u65f6\u6267\u884c <code>SQL</code>\u3002\u5982\u679c\u8fd9\u4e9b <code>SQL</code> \u90fd\u8981\u8bfb\u5199 InnoDB \u8868\uff0c<code>InnoDB</code> \u4f1a\u4e3a\u6bcf\u4e2a\u8fde\u63a5\u542f\u52a8\u4e00\u4e2a\u4e8b\u52a1\uff0c\u8fd9\u610f\u5473\u7740\u9700\u8981\u540c\u65f6\u542f\u52a8\u5f88\u591a\u4e8b\u52a1\u3002</p> <p>\u5bf9\u4e8e <code>OLTP</code> \u573a\u666f\uff0c\u901a\u5e38\u60c5\u51b5\u4e0b\uff0c\u4e8b\u52a1\u90fd\u4f1a\u5f88\u5feb\u6267\u884c\u5b8c\u6210\u3002\u542f\u52a8\u4e8b\u52a1\u3001\u6267\u884c SQL\u3001\u63d0\u4ea4\u4e8b\u52a1\u7684\u6574\u4e2a\u6d41\u7a0b\u53ea\u4f1a\u6301\u7eed\u5f88\u77ed\u7684\u65f6\u95f4\u3002</p> <p>\u4ee5\u8fd9\u6837\u4e00\u4e2a\u573a\u666f\u4e3a\u4f8b\uff1a</p> <ul> <li>\u5ba2\u6237\u7aef\u8fde\u63a5\u5230 MySQL;</li> <li>\u5ba2\u6237\u7aef\u6267\u884c begin \u8bed\u53e5;</li> <li>\u5ba2\u6237\u7aef\u6267\u884c\u4e00\u6761 update \u8bed\u53e5\uff0c\u6309\u4e3b\u952e ID \u66f4\u65b0\u4e00\u6761\u8bb0\u5f55;</li> <li>\u8fd9\u4e2a\u6b65\u9aa4\u4e2d\uff0cInnoDB \u4f1a\u5728\u6267\u884c update \u8bed\u53e5\u4e4b\u524d\uff0c\u771f\u6b63\u542f\u52a8\u4e00\u4e2a\u4e8b\u52a1;</li> <li>\u5ba2\u6237\u7aef\u6267\u884c commit \u8bed\u53e5;</li> <li>\u5ba2\u6237\u7aef\u5173\u95ed\u6570\u636e\u5e93\u8fde\u63a5\u3002InnoDB \u4f1a\u5728\u8fd9\u4e00\u6b65\u91ca\u653e\u4e8b\u52a1\u3002</li> </ul> <p>\u5728\u8fd9\u4e2a\u573a\u666f\u4e0b\uff0cInnoDB \u4e8b\u52a1\u4ece\u542f\u52a8\u5230\u91ca\u653e\u7684\u6574\u4e2a\u751f\u547d\u5468\u671f\uff0c\u6709\u53ef\u80fd\u53ea\u6301\u7eed 1 ~ 2 \u6beb\u79d2\uff08\u751a\u81f3\u66f4\u77ed\uff09\u3002</p>"},{"location":"basic/11.sql-Transaction/#_7","title":"\u4e8b\u52a1\u5bf9\u8c61\u548c\u4e8b\u52a1\u6c60","text":"<p>\u7531\u4e8e\u8981\u5b58\u653e**\u4e8b\u52a1 ID**\u3001\u4e8b\u52a1\u72b6\u6001\u3001Undo\u65e5\u5fd7\u7f16\u53f7\u3001\u4e8b\u52a1\u6240\u5c5e\u7684\u7528\u6237\u7ebf\u7a0b**\u7b49\u4fe1\u606f\uff0c\u6bcf\u4e2a\u4e8b\u52a1\u90fd\u6709\u4e00\u4e2a\u4e0e\u4e4b\u5bf9\u5e94\u7684\u5bf9\u8c61\uff0c\u6211\u4eec\u79f0\u4e4b\u4e3a**\u4e8b\u52a1\u5bf9\u8c61\u3002</p> <p>\u6bcf\u4e2a\u4e8b\u52a1\u5bf9\u8c61\u90fd\u8981\u5360\u7528\u5185\u5b58\uff0c\u5982\u679c\u6bcf\u542f\u52a8\u4e00\u4e2a\u4e8b\u52a1\u90fd\u8981\u4e3a\u4e8b\u52a1\u5bf9\u8c61\u5206\u914d\u5185\u5b58\uff0c\u91ca\u653e\u4e8b\u52a1\u65f6\u53c8\u8981\u91ca\u653e\u5185\u5b58\uff0c\u4f1a\u964d\u4f4e\u6570\u636e\u5e93\u6027\u80fd\u3002\u4e3a\u4e86\u907f\u514d\u9891\u7e41\u5206\u914d\u3001\u91ca\u653e\u5185\u5b58\u5bf9\u6570\u636e\u5e93\u6027\u80fd\u4ea7\u751f\u5f71\u54cd\uff0cInnoDB \u5f15\u5165\u4e86\u4e8b\u52a1\u6c60\uff08Pool\uff09\uff0c\u7528\u4e8e\u7ba1\u7406\u4e8b\u52a1\u3002</p> <p>\u987e\u540d\u601d\u4e49\uff0c\u4e8b\u52a1\u6c60\u4e2d\u653e\u7684\u662f\u4e8b\u52a1\u5bf9\u8c61\u3002\u4e8b\u52a1\u6c60\u4e5f\u4e00\u6837\u6709\u5927\u5c0f\u9650\u5236\uff0c\u4e0d\u80fd\u65e0\u9650\u5236\u7684\u5b58\u653e\u4e8b\u52a1\u5bf9\u8c61\u3002\u6570\u636e\u5e93\u7e41\u5fd9\u7684\u65f6\u5019\uff0c\u6709\u5f88\u591a\u5f88\u591a\u4e8b\u52a1\u5bf9\u8c61\uff0c\u9700\u8981\u591a\u4e2a\u4e8b\u52a1\u6c60\u6765\u7ba1\u7406\u3002\u4e8b\u52a1\u6c60\u591a\u4e86\u4e4b\u540e\u5c31\u6709\u5982\u4e0b\u95ee\u9898\uff1a</p> <ul> <li>\u4e8b\u52a1\u6c60\u7684\u7ba1\u7406\u5206\u914d\uff1a\u600e\u4e48\u521b\u5efa\u65b0\u7684\u4e8b\u52a1\u6c60\uff1f</li> <li>\u5ba2\u6237\u7aef\u521b\u5efa\u4e86\u4e00\u4e2a\u65b0\u7684\u6570\u636e\u5e93\u8fde\u63a5\uff0c\u8981\u83b7\u53d6\u4e00\u4e2a\u65b0\u7684\u4e8b\u52a1\u5bf9\u8c61\uff0c\u4ece\u54ea\u4e2a\u4e8b\u52a1\u6c60\u83b7\u53d6\uff1f</li> <li>\u591a\u4e2a</li> </ul> <p>\u4e3a\u4e86\u89e3\u51b3\u8fd9\u4e9b\u95ee\u9898\uff0cInnoDB \u53c8\u5f15\u5165\u4e86**\u4e8b\u52a1\u6c60\u7ba1\u7406\u5668\uff08PoolManager\uff09**\uff0c\u7528\u4e8e\u7ba1\u7406\u4e8b\u52a1\u6c60\uff1a\u4e8b\u52a1\u6c60\u7684\u521b\u5efa\u4e0e\u521d\u59cb\u5316\u3002</p> <p>InnoDB \u6574\u4e2a\u751f\u547d\u5468\u671f\u4e2d\uff0c\u4e8b\u52a1\u6c60\u7ba1\u7406\u5668\u53ea\u6709\u4e00\u4e2a\uff0c\u5b83\u6709\u4e2a\u5f88\u91cd\u8981\u7684\u5c5e\u6027\uff08m_size\uff09\uff0c\u7528\u4e8e\u6307\u5b9a\u6bcf\u4e2a\u4e8b\u52a1\u6c60\u80fd\u7528\u591a\u5927\u5185\u5b58\u6765\u5b58\u653e\u4e8b\u52a1\u5bf9\u8c61\u3002\u8fd9\u4e2a\u5c5e\u6027\u503c\u6765\u6e90\u4e8e\u4e00\u4e2a\u786c\u7f16\u7801\u7684\u5e38\u91cf\u503c\u3002</p> <p><pre><code>// https://github.com/mysql/mysql-server/blob/trunk/storage/innobase/trx/trx0trx.cc#L429\n/** Size of on trx_t pool in bytes. */\nstatic const ulint MAX_TRX_BLOCK_SIZE = 1024 * 1024 * 4;\n</code></pre> \u8fd9\u610f\u5473\u7740\u6bcf\u4e2a\u4e8b\u52a1\u6c60\u80fd\u7528\u6765\u5b58\u653e\u4e8b\u52a1\u5bf9\u8c61\u7684\u5185\u5b58\u662f 4194304 \u5b57\u8282\uff0c\u4e5f\u5c31\u662f 4 M</p> <p>MySQL \u542f\u52a8\u8fc7\u7a0b\u4e2d\uff0c\u4e8b\u52a1\u6c60\u7ba1\u7406\u5668\u53ea\u4f1a\u521b\u5efa\u5e76\u521d\u59cb\u5316\u4e00\u4e2a\u4e8b\u52a1\u6c60\u3002\u8fd9\u4e2a\u4e8b\u52a1\u6c60\u4f1a\u653e\u5165\u4e8b\u52a1\u6c60\u7ba1\u7406\u5668\u7684 m_pools \u5c5e\u6027\u3002\u8fd9\u4e2a\u5c5e\u6027\u662f\u4e2a\u6570\u7ec4\uff08vector\uff09\uff0c\u7528\u4e8e\u7ba1\u7406\u6240\u6709\u4e8b\u52a1\u6c60\u3002</p> <p>\u4e8b\u52a1\u7684\u6838\u5fc3\u6570\u636e\u7ed3\u6784</p> <p>https://github.com/mysql/mysql-server/blob/trunk/storage/innobase/include/trx0trx.h#L675</p> <p><code>trx_t</code>: \u6574\u4e2a\u7ed3\u6784\u4f53\u5728\u6bcf\u4e2a\u8fde\u63a5\u90fd\u4f1a\u6301\u6709\u4e00\u4e2a\uff0c\u4e5f\u5c31\u662f\u5728\u521b\u5efa\u8fde\u63a5\u540e\u6267\u884c\u7b2c\u4e00\u4e2a\u4e8b\u52a1\u5f00\u59cb\uff0c\u6574\u4e2a\u7ed3\u6784\u4f53\u5c31\u88ab\u521d\u59cb\u5316\u4e86\uff0c\u540e\u7eed\u8fd9\u4e2a\u8fde\u63a5\u7684\u6240\u6709\u4e8b\u52a1\u4e00\u76f4\u590d\u7528\u91cc\u9762\u7684\u6570\u636e\u7ed3\u6784\uff0c\u76f4\u5230\u8fd9\u4e2a\u8fde\u63a5\u65ad\u5f00\u3002\u53ef\u4ee5\u8bf4\u8fd9\u4e2a\u7ed3\u6784\u4f53\u8d2f\u7a7f\u8fde\u63a5\u7684\u6574\u4e2a\u751f\u547d\u5468\u671f\uff0c\u4e00\u76f4\u88ab\u8fde\u63a5\u5185\u7684\u4e8b\u52a1\u4f7f\u7528\u3002</p> <p><code>trx_lock_t</code>: \u5728 8.0 \u4e2d\uff0c\u5c06 lock \u5355\u72ec\u4ece trx_t \u4e2d\u89e3\u8026\u51fa\u6765\u3002\u89c2\u5bdf trx_lock_t \u7684\u5b9a\u4e49\u3002\u6bcf\u4e2a\u4e8b\u52a1\u90fd\u4f1a\u7ef4\u62a4\u6267\u884c\u8fc7\u7a0b\u4e2d\u52a0\u7684\u6240\u6709\u9501\uff08 trx_locks\uff0c\u53cc\u5411\u94fe\u8868\uff09\uff0c\u4ee5\u53ca\u53d1\u751f\u9501\u7b49\u5f85\u65f6\u7b49\u5f85\u7684\u9501\uff08 wait_lock \uff09</p> <p>\u540c\u65f6\uff0c\u4e8b\u52a1\u542f\u52a8\u540e\uff0c\u5c31\u4f1a\u628a\u8fd9\u4e2a<code>trx_t</code>\u7ed3\u6784\u4f53\u52a0\u5165\u5230\u5168\u5c40\u4e8b\u52a1\u94fe\u8868\u4e2d(trx_sys-&gt;mysql_trx_list)\uff0c\u5982\u679c\u662f\u8bfb\u5199\u4e8b\u52a1\uff0c\u8fd8\u4f1a\u52a0\u5165\u5230\u5168\u5c40\u8bfb\u5199\u4e8b\u52a1\u94fe\u8868\u4e2d(trx_sys-&gt;rw_trx_list)\u3002\u5728\u4e8b\u52a1\u63d0\u4ea4\u7684\u65f6\u5019\uff0c\u8fd8\u4f1a\u52a0\u5165\u5230\u5168\u5c40\u63d0\u4ea4\u4e8b\u52a1\u94fe\u8868\u4e2d(trx_sys-&gt;trx_serial_list)\u3002</p> <pre><code>\n</code></pre> <p>state\u5b57\u6bb5\u8bb0\u5f55\u4e86\u4e8b\u52a1\u56db\u79cd\u72b6\u6001:TRX_STATE_NOT_STARTED, TRX_STATE_ACTIVE, TRX_STATE_PREPARED, TRX_STATE_COMMITTED_IN_MEMORY\u3002</p> <p>\u4ece\u5e76\u53d1\u63a7\u5236\u7684\u89d2\u5ea6\u6765\u770b\uff0c\u4e8b\u52a1\u5728\u5176\u751f\u547d\u5468\u671f\u5185\u53ef\u80fd\u5b58\u5728\u5982\u4e0b\u72b6\u6001\uff1a</p> <ul> <li>TRX_STATE_NOT_STARTED</li> <li>TRX_STATE_FORCED_ROLLBACK</li> <li>TRX_STATE_ACTIVE</li> <li>TRX_STATE_PREPARED</li> <li>TRX_STATE_COMMITTED_IN_MEMORY (alias below COMMITTED)</li> </ul> <p>\u6b63\u5e38\u7684\u4e8b\u52a1\u751f\u547d\u5468\u671f\u72b6\u6001\u53d8\u5316\uff1a   NOT_STARTED -&gt; ACTIVE -&gt; COMMITTED -&gt; NOT_STARTED</p>"},{"location":"basic/11.sql-Transaction/#_8","title":"\u7528\u6237\u4e8b\u52a1\u548c\u5185\u90e8\u4e8b\u52a1","text":"<p>InnoDB \u8bfb\u5199\u8868\u4e2d\u6570\u636e\u7684\u64cd\u4f5c\u90fd\u5728\u4e8b\u52a1\u4e2d\u6267\u884c\uff0c\u5f00\u59cb\u4e00\u4e2a\u4e8b\u52a1\u7684\u65b9\u5f0f\u6709\u4e24\u79cd\uff1a</p> <ul> <li>\u624b\u52a8\uff1a\u901a\u8fc7 <code>BEGIN</code>\u3001<code>START TRANSACTION</code> \u8bed\u53e5\u4ee5\u53ca\u5b83\u4eec\u7684\u6269\u5c55\u5f62\u5f0f\u5f00\u59cb\u4e00\u4e2a\u4e8b\u52a1\u3002</li> <li>\u81ea\u52a8\uff1a\u76f4\u63a5\u6267\u884c\u4e00\u6761 SQL \u8bed\u53e5\uff0cInnoDB \u4f1a\u81ea\u52a8\u5f00\u59cb\u4e00\u4e2a\u4e8b\u52a1\uff0cSQL \u8bed\u53e5\u6267\u884c\u5b8c\u6210\u4e4b\u540e\uff0c\u53c8\u4f1a\u81ea\u52a8\u63d0\u4ea4\u8fd9\u4e2a\u4e8b\u52a1\u3002</li> </ul> <p>\u8fd9\u4e24\u79cd\u65b9\u5f0f\u5f00\u59cb\u7684\u4e8b\u52a1\uff0c\u90fd\u7528\u6765\u6267\u884c\u7528\u6237 SQL \u8bed\u53e5\uff0c\u5c5e\u4e8e \u7528\u6237\u4e8b\u52a1\u3002\u6b63\u5e38\u60c5\u51b5\u4e0b\uff0c\u7528\u6237\u4e8b\u52a1\u4e0e\u8fde\u63a5\u4f1a\u8bdd\u90fd\u662f\u4e00\u5bf9\u4e00\u7684\u3002\u5728 \u5f53\u524d\u6570\u636e\u5e93\u8fde\u63a5 \u7684\u64cd\u4f5c\u65f6\u5e8f\u4e0a\uff0c\u4e8b\u52a1\u548c\u4e8b\u52a1\u4e4b\u95f4\u7684\u6267\u884c\u662f\u7ebf\u6027\u6392\u5f00\u4f9d\u6b21\u6267\u884c\u7684\u3002</p> <p>\uff08there is a 1:1 relationship between a transaction handle (trx) and a session (client connection). One session is associated with exactly one user transaction\uff09</p> <p>\u5f53\u5efa\u7acb\u4e86 java.sql.Connection \u8fde\u63a5\u540e\uff0c\u53ef\u4ee5\u4e0d\u9650\u6b21\u6570\u6267\u884c\u4e8b\u52a1SQL\u8bf7\u6c42 \uff0c\u7531\u4e8eConnection\u5bf9\u8c61\u7684\u901a\u4fe1\u503c\u57fa\u4e8eTCP/IP\u534f\u8bae\u7684\uff0c\u5f53\u521d\u59cb\u5316\u540e\u5728\u624b\u52a8\u5173\u95ed\u4e4b\u524d\u548c\u6570\u636e\u5e93\u4fdd\u6301\u5fc3\u8df3\u5b58\u6d3b\u8fde\u63a5\u3002\u6240\u4ee5\uff0c\u53ef\u4ee5\u4f7f\u7528Connection\u5bf9\u8c61\u6267\u884c\u4e0d\u9650\u6b21\u6570\u7684SQL\u8bed\u53e5\u8bf7\u6c42\uff0c\u5305\u62ec\u4e8b\u52a1\u8bf7\u6c42\u3002\u8fd9\u4e2a\u770b\u4f3c\u6bd4\u8f83\u7b80\u5355\u7684\u8868\u8ff0\uff0c\u5728\u5b9e\u9645\u4f7f\u7528\u8fc7\u7a0b\u4e2d\u975e\u5e38\u91cd\u8981\uff0c\u6570\u636e\u5e93\u8fde\u63a5\u6c60\u5c31\u662f\u57fa\u4e8e\u6b64\u7279\u6027\u5efa\u7acb\u7684</p> <p>InnoDB \u6709\u65f6\u5019\u4e5f\u9700\u8981\u81ea\u5df1\u6267\u884c\u4e00\u4e9b SQL \u8bed\u53e5\uff0c\u4e3a\u4e86\u548c\u7528\u6237 SQL \u505a\u533a\u5206\uff0c\u6211\u4eec\u628a\u8fd9\u4e9b SQL \u79f0\u4e3a\u5185\u90e8 SQL\u3002\u5185\u90e8 SQL \u4e5f\u9700\u8981\u5728\u4e8b\u52a1\u4e2d\u6267\u884c\uff0c\u6267\u884c\u8fd9\u4e9b SQL \u7684\u4e8b\u52a1\u5c31\u662f**\u5185\u90e8\u4e8b\u52a1**\u3002\u5185\u90e8\u4e8b\u52a1\u7684\u6700\u5927\u7279\u70b9\u5c31\u662f\u4e0d\u8ddf\u7528\u6237\u8fde\u63a5\u76f8\u5173\u8054\uff08these transactions would no longer be associated with a session\uff09</p> <p>InnoDB \u6709\u51e0\u79cd\u573a\u666f\u4f1a\u4f7f\u7528\u5185\u90e8\u4e8b\u52a1\uff0c\u4ee5\u4e0b\u662f\u5176\u4e2d\u4e3b\u8981\u7684\u4e09\u79cd:\u53c2\u8003</p> <ul> <li> <p>\u5982\u679c\u4e0a\u6b21\u5173\u95ed MySQL \u65f6\u6709\u672a\u63d0\u4ea4\uff0c\u6216\u8005\u6b63\u5728\u63d0\u4ea4\u4f46\u672a\u63d0\u4ea4\u5b8c\u6210\u7684\u4e8b\u52a1( ACTIVE or PREPARED)\uff0c\u5728\u542f\u52a8\u8fc7\u7a0b\u4e2d\uff08\u6267\u884c\u5d29\u6e83\u6062\u590d\uff09\uff0cInnoDB \u4f1a\u628a\u8fd9\u4e9b\u4e8b\u52a1\u6062\u590d\u4e3a\u5185\u90e8\u4e8b\u52a1\uff0c\u7136\u540e\u63d0\u4ea4\u6216\u8005\u56de\u6eda\u3002</p> </li> <li> <p>\u540e\u53f0\u7ebf\u7a0b(\u6bd4\u5982  purge system )\u6267\u884c\u4e00\u4e9b\u64cd\u4f5c\u65f6\uff0c\u9700\u8981\u5728\u5185\u90e8\u4e8b\u52a1\u4e2d\u6267\u884c\u5185\u90e8 SQL\u3002\u4ee5 ib_dict_stats \u7ebf\u7a0b\u4e3a\u4f8b\uff0c\u5b83\u8ba1\u7b97\u5404\u8868\u3001\u7d22\u5f15\u7684\u7edf\u8ba1\u4fe1\u606f\u4e4b\u540e\uff0c\u4f1a\u4f7f\u7528\u5185\u90e8\u4e8b\u52a1\u6267\u884c\u5185\u90e8 SQL\uff0c\u66f4\u65b0 mysql.innodb_table_stats\u3001mysql.innodb_index_stats \u8868\u4e2d\u7684\u7edf\u8ba1\u4fe1\u606f\u3002</p> </li> <li> <p>\u4e3a\u4e86\u5b9e\u73b0\u539f\u5b50\u64cd\u4f5c\uff0cDDL \u8bed\u53e5\u6267\u884c\u8fc7\u7a0b\u4e2d\uff0cInnoDB \u4f1a\u4f7f\u7528**\u5185\u90e8\u4e8b\u52a1\uff08\uff09**\u6267\u884c\u5185\u90e8 SQL\uff0c\u63d2\u5165\u4e00\u4e9b\u6570\u636e\u5230 mysql.innodb_ddl_log \u8868\u4e2d</p> </li> </ul> <p>\u4e8b\u52a1\u5bf9\u8c61\u5206\u914d</p> <p>InnoDB \u7528\u4e8b\u52a1\u6c60\u6765\u7ba1\u7406\u4e8b\u52a1\u5bf9\u8c61\uff0c\u7528\u4e8b\u52a1\u6c60\u7ba1\u7406\u5668\u6765\u7ba1\u7406\u4e8b\u52a1\u6c60\u3002</p> <p>\u4e0d\u7ba1\u662f\u7528\u6237\u4e8b\u52a1\uff0c\u8fd8\u662f\u5185\u90e8\u4e8b\u52a1\uff0c\u771f\u6b63\u542f\u52a8\u4e8b\u52a1\u4e4b\u524d\uff0c\u90fd\u9700\u8981\u901a\u8fc7\u4e8b\u52a1\u6c60\u7ba1\u7406\u5668\u4ece\u67d0\u4e2a\u4e8b\u52a1\u6c60\u7684\u4e8b\u52a1\u961f\u5217\u4e2d\u5206\u914d\u4e00\u4e2a\u4e8b\u52a1\u5bf9\u8c61\u3002</p> <p>\u5206\u914d\u4e8b\u52a1\u5bf9\u8c61\u4e4b\u540e\uff0cInnoDB \u8fd8\u4f1a\u5bf9\u4e8b\u52a1\u5bf9\u8c61\u7684\u51e0\u4e2a\u5c5e\u6027\u518d\u505a\u4e00\u6b21\u521d\u59cb\u5316\u5de5\u4f5c\uff0c\u628a\u8fd9\u51e0\u4e2a\u5c5e\u6027\u518d\u4e00\u6b21\u8bbe\u7f6e\u4e3a\u521d\u59cb\u503c\uff0c\u5176\u5b9e\u5c31\u662f\u5bf9\u8fd9\u4e9b\u5c5e\u6027\u505a\u4e86\u91cd\u590d\u7684\u8d4b\u503c\u64cd\u4f5c\u3002</p> <p>\u8fd9\u4e9b\u5c5e\u6027\u4e2d\uff0c\u6709\u5fc5\u8981\u63d0\u4e00\u4e0b\u7684\u662f\u4e8b\u52a1\u72b6\u6001\uff08trx-&gt;state\uff09\u3002\u51fa\u5382\u8bbe\u7f6e\u7684\u4e8b\u52a1\u5bf9\u8c61\uff0c\u4e8b\u52a1\u72b6\u6001\u662f TRX_STATE_NOT_STARTED\uff0c\u8868\u793a\u4e8b\u52a1\u8fd8\u6ca1\u6709\u5f00\u59cb\u3002</p> <p>\u4e8b\u52a1\u7684\u542f\u52a8</p>"},{"location":"basic/11.sql-Transaction/#_9","title":"\u5e76\u53d1\u63a7\u5236","text":"<p>\u5728\u8ba1\u7b97\u673a\u79d1\u5b66\uff0c\u7279\u522b\u662f\u7a0b\u5e8f\u8bbe\u8ba1\u3001\u64cd\u4f5c\u7cfb\u7edf\u3001\u591a\u5904\u7406\u673a\u548c\u6570\u636e\u5e93\u7b49\u9886\u57df\uff0c\u5e76\u53d1\u63a7\u5236\uff08Concurrency control\uff09\u662f\u786e\u4fdd\u53ca\u65f6\u7ea0\u6b63\u7531\u5e76\u53d1\u64cd\u4f5c\u5bfc\u81f4\u7684\u9519\u8bef\u7684\u4e00\u79cd\u673a\u5236\u3002</p> <p>\u6211\u4eec\u90fd\u77e5\u9053\u4e8b\u52a1\u7684\u51e0\u79cd\u6027\u8d28\uff0c\u6570\u636e\u5e93\u4e3a\u4e86\u7ef4\u62a4\u8fd9\u4e9b\u6027\u8d28\uff0c\u5c24\u5176\u662f \u4e00\u81f4\u6027 \u548c \u9694\u79bb\u6027 \uff0c\u4e00\u822c\u4f7f\u7528 \u52a0\u9501 \u8fd9\u79cd\u65b9\u5f0f\u3002</p> <p>\u540c\u65f6\u6570\u636e\u5e93\u53c8\u662f\u4e2a\u9ad8\u5e76\u53d1\u7684\u5e94\u7528\uff0c\u540c\u4e00\u65f6\u95f4\u4f1a\u6709\u5927\u91cf\u7684\u5e76\u53d1\u8bbf\u95ee\uff0c\u5982\u679c\u52a0\u9501\u8fc7\u5ea6\uff0c\u4f1a\u6781\u5927\u7684\u964d\u4f4e\u5e76\u53d1\u5904\u7406\u80fd\u529b\u3002</p> <p>\u6240\u4ee5\u5bf9\u4e8e\u52a0\u9501\u7684\u5904\u7406\uff0c\u53ef\u4ee5\u8bf4\u5c31\u662f\u6570\u636e\u5e93\u5bf9\u4e8e\u4e8b\u52a1\u5904\u7406\u7684\u7cbe\u9ad3\u6240\u5728\u3002</p> <p>\u6570\u636e\u5e93\u7ba1\u7406\u7cfb\u7edf\uff08DBMS\uff09\u4e2d\u7684\u5e76\u53d1\u63a7\u5236\u7684\u4efb\u52a1\u662f \u786e\u4fdd\u5728\u591a\u4e2a\u4e8b\u52a1\u540c\u65f6\u5b58\u53d6\u6570\u636e\u5e93\u4e2d\u540c\u4e00\u6570\u636e\u65f6\u4e0d\u7834\u574f\u4e8b\u52a1\u7684\u9694\u79bb\u6027\u548c\u4e00\u81f4\u6027\u4ee5\u53ca\u6570\u636e\u5e93\u7684\u7edf\u4e00\u6027\u3002</p>"},{"location":"basic/11.sql-Transaction/#_10","title":"\u810f\u8bfb\u73b0\u8c61","text":"<p>\u4e00\u53e5\u8bdd\u6982\u51b5\uff1a\u4e00\u4e2a\u4e8b\u52a1\u8bfb\u53d6\u5230\u4e86\u53e6\u5916\u4e8b\u52a1\u4e2d\u672a\u63d0\u4ea4\u7684\u6570\u636e\u3002</p> <p>\u810f\u8bfb\u662f\u6307\u5728\u6570\u636e\u5e93\u8bbf\u95ee\u4e2d\uff0c\u5f53\u4e00\u4e2a\u4e8b\u52a1 A \u6b63\u5728\u8bbf\u95ee\u6570\u636e\uff0c\u5e76\u4e14\u5bf9\u6570\u636e\u8fdb\u884c\u4e86\u4fee\u6539\uff0c\u800c\u8fd9\u79cd\u4fee\u6539\u4e8b\u52a1\u8fd8\u6ca1\u6709\u63d0\u4ea4\u5230\u6570\u636e\u5e93\u4e2d\uff0c\u8fd9\u65f6\u53e6\u5916\u4e00\u4e2a\u4e8b\u52a1 B \u4e5f\u8bbf\u95ee\u8fd9\u4e2a\u6570\u636e\uff0c\u7136\u540e\u4f7f\u7528\u4e86\u8fd9\u4e2a\u6570\u636e\u3002</p> <p>\u7136\u540e A \u53c8\u8fdb\u884c\u56de\u6eda\u64cd\u4f5c\uff0c\u5219\u4e8b\u52a1 B \u8bbf\u95ee\u7684\u6570\u636e\u662f\u65e0\u6548\u7684\u3002\u5373\u4e0a\u8ff0\u8f6c\u8d26\u4f8b\u5b50\u4e2d\uff0c\u8f6c\u8d26\u4e8b\u52a1\u8fdb\u884c\u5230\u4e00\u534a\u7684\u65f6\u5019\uff0c\u6b64\u65f6\u53e6\u5916\u4e00\u4e2a\u4e8b\u52a1\u53bb\u8bfb\u4e86 A \u8d26\u53f7\u7684\u4f59\u989d\uff0c\u7136\u540e\u4ee5\u524d\u7684\u8f6c\u8d26\u4e8b\u52a1\u56de\u6eda\uff0cA \u7684\u4f59\u989d\u53d8\u56de\u4ee5\u524d\u7684\u503c\u3002</p> <p>\u6b64\u65f6\u540e\u9762\u8bfb\u4f59\u989d\u7684\u4e8b\u52a1\u5373\u4e3a\u810f\u8bfb\u3002\u5728\u9ad8\u5e76\u53d1\u60c5\u51b5\u4e0b\u548c\u5bf9\u6570\u636e\u51c6\u786e\u6027\u8981\u6c42\u8f83\u9ad8\u7684\u60c5\u51b5\u4e0b\uff0c\u8fd9\u4e2a\u73b0\u8c61\u51e0\u4e4e\u662f\u4e0d\u80fd\u5bb9\u5fcd\u7684\u3002</p> <p>\u4e3e\u4e00\u4e2a\u5b9e\u9645\u573a\u666f\u4e2d\u7684\u4f8b\u5b50\uff1a\u4e24\u4e2a\u706b\u8f66\u7968\u4ee3\u552e\u70b9\uff0c\u540c\u65f6\u8bfb\u53d6 12306 \u6570\u636e\u5e93\u4e2d\u7684\u67d0\u8d9f\u5217\u8f66\u7684\u8f66\u7968\u4f59\u7968\u6570\u91cf\u4e3a X\uff0c\u7136\u540e\u540c\u65f6\u5356\u51fa\u4e00\u5f20\u7968\uff0c\u7136\u540e\u540c\u65f6\u63d0\u4ea4\u4e86 X-1 \u5230\u6570\u636e\u5e93\u4e2d\uff0c\u8fd9\u6837\u5c31\u9020\u6210\u4e86\u5356\u4e86\u4e24\u5f20\u7968\uff0c\u800c\u5e93\u4e2d\u8bb0\u5f55\u53ea\u51cf\u4e86\u4e00\u5f20\u3002\u751f\u8fd9\u79cd\u60c5\u51b5\u7684\u539f\u56e0\u662f\u56e0\u4e3a\u4e24\u4e2a\u4e8b\u52a1\u8bfb\u5165\u540c\u4e00\u6570\u636e\u5e76\u540c\u65f6\u4fee\u6539\uff0c\u5176\u4e2d\u4e00\u4e2a\u4e8b\u52a1\u63d0\u4ea4\u7684\u7ed3\u679c\u7834\u574f\u4e86\u53e6\u4e00\u4e2a\u4e8b\u52a1\u63d0\u4ea4\u7684\u7ed3\u679c\uff0c\u5bfc\u81f4\u5176\u6570\u636e\u7684\u4fee\u6539\u88ab\u4e22\u5931\uff0c\u7834\u574f\u4e86\u4e8b\u52a1\u7684\u9694\u79bb\u6027\u3002\u5e76\u53d1\u63a7\u5236\u8981\u89e3\u51b3\u7684\u5c31\u662f\u8fd9\u7c7b\u95ee\u9898\u3002</p>"},{"location":"basic/11.sql-Transaction/#_11","title":"\u4e0d\u53ef\u91cd\u590d\u8bfb","text":"<p>\u4e00\u53e5\u8bdd\u6982\u62ec\uff1a\u540c\u4e00\u4e8b\u52a1\u5185\u524d\u540e\u591a\u6b21\u8bfb\u53d6\uff0c\u6570\u636e\u5185\u5bb9\u4e0d\u4e00\u81f4\uff08\u7b2c\u4e8c\u6b21\u8bfb\u5230\u4e86\u5176\u4ed6\u4e8b\u52a1\u66f4\u65b0\u63d0\u4ea4\u7684\u6570\u636e\uff09</p> <p>\u4e8b\u52a1 A \u5728\u6267\u884c\u8bfb\u53d6\u64cd\u4f5c\uff0c\u7531\u6574\u4e2a\u4e8b\u52a1 A \u6bd4\u8f83\u5927\uff0c\u524d\u540e\u8bfb\u53d6\u540c\u4e00\u6761\u6570\u636e\u9700\u8981\u7ecf\u5386\u5f88\u957f\u7684\u65f6\u95f4 \u3002\u800c\u5728\u4e8b\u52a1 A \u7b2c\u4e00\u6b21\u8bfb\u53d6\u6570\u636e\uff0c\u6bd4\u5982\u6b64\u65f6\u8bfb\u53d6\u4e86\u5c0f\u660e\u7684\u5e74\u9f84\u4e3a 20 \u5c81\uff0c\u4e8b\u52a1 B \u6267\u884c\u66f4\u6539\u64cd\u4f5c\uff0c\u5c06\u5c0f\u660e\u7684\u5e74\u9f84\u66f4\u6539\u4e3a 30 \u5c81\uff0c\u6b64\u65f6\u4e8b\u52a1 A \u7b2c\u4e8c\u6b21\u8bfb\u53d6\u5230\u5c0f\u660e\u7684\u5e74\u9f84\u65f6\uff0c\u53d1\u73b0\u5176\u5e74\u9f84\u662f 30 \u5c81\uff0c\u548c\u4e4b\u524d\u7684\u6570\u636e\u4e0d\u4e00\u6837\u4e86\uff0c\u4e5f\u5c31\u662f\u6570\u636e\u4e0d\u91cd\u590d\u4e86\uff0c\u7cfb\u7edf\u4e0d\u53ef\u4ee5\u8bfb\u53d6\u5230\u91cd\u590d\u7684\u6570\u636e\uff0c\u6210\u4e3a\u4e0d\u53ef\u91cd\u590d\u8bfb\u3002</p>"},{"location":"basic/11.sql-Transaction/#_12","title":"\u5e7b\u8bfb","text":"<p>\u4e8b\u52a1 T1 \u8bfb\u53d6\u4e00\u7ec4\u6ee1\u8db3\u67d0\u4e9b &lt;\u641c\u7d22\u6761\u4ef6&gt; \u7684\u6570\u636e\u3002\u4e8b\u52a1 T2 \u521b\u5efa\u4e86\u6ee1\u8db3 T1 \u7684 &lt;\u641c\u7d22\u6761\u4ef6&gt; \u7684\u6570\u636e\u9879\u5e76\u63d0\u4ea4\u3002\u5982\u679c T1 \u7528\u76f8\u540c\u7684&lt;\u641c\u7d22\u6761\u4ef6&gt;\u518d\u6b21\u8bfb\u53d6\uff0c\u5f97\u5230\u4e00\u7ec4\u4e0d\u540c\u4e8e\u7b2c\u4e00\u6b21\u8bfb\u53d6\u7684\u6570\u636e\u3002\u8fd9\u5c31\u53eb\u5e7b\u8bfb\u3002</p> <p>\u5f53\u540c\u4e00\u4e2a\u67e5\u8be2\u5728\u4e0d\u540c\u7684\u65f6\u95f4\u4ea7\u751f\u4e0d\u540c\u7684\u7ed3\u679c\u96c6\u65f6\uff0c\u4e8b\u52a1\u4e2d\u5c31\u4f1a\u51fa\u73b0\u6240\u8c13\u7684\u5e7b\u8c61\u95ee\u9898\u3002\u4f8b\u5982\uff0c\u5982\u679c SELECT \u6267\u884c\u4e86\u4e24\u6b21\uff0c\u4f46\u7b2c\u4e8c\u6b21\u8fd4\u56de\u4e86\u7b2c\u4e00\u6b21\u6ca1\u6709\u8fd4\u56de\u7684\u884c\uff0c\u5219\u8be5\u884c\u662f\u201c\u5e7b\u50cf\u201d\u884c\u3002</p> <p>\u4e0d\u53ef\u91cd\u590d\u8bfb\u548c\u5e7b\u8bfb\u6709\u4ec0\u4e48\u4e0d\u540c\uff1f</p> <p>\u6ce8\u610f\u548c\u5e7b\u8bfb\u5b9a\u4e49\u7684\u4e24\u4e2a\u4e0d\u540c</p> <ul> <li>\u5e7b\u8bfb\u5b9a\u4e49\u4e2d\u6709 &lt; search condition &gt;</li> <li>\u5e7b\u8bfb\u5b9a\u4e49\u4e2d T2 \u662f\u201c\u521b\u5efa\u6570\u636e\u201d\uff0c\u4e0d\u53ef\u91cd\u590d\u8bfb\u7684\u5b9a\u4e49\u4e2d T2 \u662f\u4fee\u6539\u6216\u8005\u5220\u9664\u6570\u636e</li> </ul> <p>\u5728\u6ee1\u8db3 &lt; search condition &gt; \u7684\u8303\u56f4\u5185\uff0c\u4fee\u6539\u548c\u5220\u9664\u6570\u636e\u5fc5\u5b9a\u662f\u5bf9\u5df2\u7ecf\u5b58\u5728\u7684\u6570\u636e\u884c\u64cd\u4f5c\uff0c\u800c\u521b\u5efa\u6570\u636e\u5219\u610f\u5473\u7740\u521b\u5efa\u4e4b\u524d\u8fd9\u4e2a\u6570\u636e\u9879\u662f\u4e0d\u5b58\u5728\u7684\u3002</p> <p>\"\u521b\u5efa\u6570\u636e\"\u4e0d\u4ec5\u662f<code>insert</code>\uff0c\u8fd8\u5305\u62ec<code>update</code>, <code>update</code> \u628a\u672c\u6765\u4e0d\u6ee1\u8db3\u8c13\u8bcd\u8303\u56f4\u7684\u6570\u636e\u9879\u66f4\u65b0\u6210\u6ee1\u8db3\u8c13\u8bcd\u8303\u56f4\u7684\u6570\u636e\u9879\uff0c\u6bd4\u5982\uff1a\u8c13\u8bcd\u8303\u56f4\u662f <code>a&gt;1 and a&lt;5</code>\uff0c<code>update a=4 where a=6</code> \u5c31\u662f\u8fd9\u6837\u7684\u60c5\u51b5\u3002</p>"},{"location":"basic/11.sql-Transaction/#_13","title":"\u6570\u636e\u5e93\u9694\u79bb\u7ea7\u522b","text":"<p>ANSI/ISO SQL \u5b9a\u4e49\u7684 SQL \u6807\u51c6\u4e2d\u63cf\u8ff0\u4e86\u56db\u79cd\u9694\u79bb\u7ea7\u522b\uff0c\u4ece\u9ad8\u5230\u5e95\u4f9d\u6b21\u4e3a\uff1a</p> <ul> <li>\u5e8f\u5217\u5316(Serializable)</li> <li>\u53ef\u91cd\u590d\u8bfb(Repeatable reads)</li> <li>\u8bfb\u5df2\u63d0\u4ea4(Read committed)</li> <li>\u8bfb\u672a\u63d0\u4ea4\u8bfb(Read uncommitted)</li> </ul> <p>\u5bf9\u5e94\u7684\u9694\u79bb\u7ea7\u522b\u5982\u4e0b\uff1a</p> \u9694\u79bb\u7ea7\u522b \u810f\u8bfb\u73b0\u8c61 \u4e0d\u53ef\u91cd\u590d\u8bfb\u73b0\u8c61 \u5e7b\u8bfb\u73b0\u8c61 \u8bfb\u672a\u63d0\u4ea4\u8bfb \u53ef\u80fd \u53ef\u80fd \u53ef\u80fd \u8bfb\u5df2\u63d0\u4ea4 \u4e0d\u53ef\u80fd \u53ef\u80fd \u53ef\u80fd \u53ef\u91cd\u590d\u8bfb \u4e0d\u53ef\u80fd \u4e0d\u53ef\u80fd \u53ef\u80fd \u5e8f\u5217\u5316 \u4e0d\u53ef\u80fd \u4e0d\u53ef\u80fd \u4e0d\u53ef\u80fd <p>\u6ce8\u610f\uff0c\u4e0d\u540c\u7684\u6570\u636e\u5e93\u5382\u5546\u5bf9 SQL \u6807\u51c6\u4e2d\u89c4\u5b9a\u7684\u8fd9\u56db\u79cd\u9694\u79bb\u7ea7\u522b\u7684\u652f\u6301\u4e0d\u4e00\u6837\uff0c\u6709\u7684 RDBMS \u6570\u636e\u5e93\u53ea\u5b9e\u73b0\u4e86\u5176\u4e2d\u51e0\u79cd\u9694\u79bb\u7ea7\u522b\uff0c\u6211\u4eec\u8ba8\u8bba\u7684 MySQL \u867d\u7136\u652f\u6301 4 \u79cd\u9694\u79bb\u7ea7\u522b\uff0c\u4f46\u662f\u4e0e SQL \u6807\u51c6\u4e2d\u89c4\u5b9a\u7684\u5404\u7ea7\u9694\u79bb\u7ea7\u522b\u5141\u8bb8\u53d1\u751f\u7684\u73b0\u8c61\u5374\u6709\u4e9b\u51fa\u5165\u3002</p> <p>\u56db\u4e2a\u9694\u79bb\u7ea7\u522b\u4ece\u4e0a\u5230\u4e0b\u5bf9\u4e8b\u52a1\u6267\u884c\u7684\u5e76\u53d1\u7a0b\u5ea6\u8fdb\u884c\u4e86\u4e0d\u540c\u7a0b\u5ea6\u7684\u9650\u5236\uff0c\u66f4\u52a0\u4e25\u683c\u7684\u9650\u5236\u5728\u5e26\u6765\u66f4\u597d\u7684\u6570\u636e\u4e00\u81f4\u6027\u7684\u540c\u65f6\uff0c\u4e5f\u4f1a\u635f\u5931\u66f4\u591a\u5e76\u53d1\u5e26\u6765\u7684\u9ad8\u6027\u80fd\u3002</p> <p>\u5b9e\u9645\u4f7f\u7528\u4e2d\uff0c\u9694\u79bb\u7ea7\u522b\u5e76\u4e0d\u662f\u8d8a\u9ad8\u5c31\u8d8a\u597d\uff0c\u5927\u591a\u6570\u60c5\u51b5\u4e0b\u5e94\u7528\u5e76\u4e0d\u9700\u8981\u5f88\u9ad8\u7684\u6570\u636e\u4e00\u81f4\u6027\u3002\u76f8\u53cd\u7684\uff0c\u5728\u591a\u7528\u6237\u73af\u5883\u4e0b\uff0c\u66f4\u5f3a\u8c03\u7684\u662f\u5e76\u53d1\u5ea6\u3002\u6240\u4ee5\u7efc\u5408\u8003\u8651\u9009\u53d6\u4e00\u4e2a\u6298\u4e2d\u7684\u529e\u6cd5\u5f80\u5f80\u80fd\u8fbe\u5230\u6700\u4f18\u7684\u6548\u679c\u3002</p> <p>\u5728\u5927\u591a\u6570 <code>RDBMS</code> \u4e2d\uff0c\u8bbe\u7f6e\u7684\u9694\u79bb\u7ea7\u522b\u53ef\u80fd\u90fd\u662f\u8bfb\u5df2\u7ecf\u63d0\u4ea4\u3002</p> <ul> <li> <p>MySQL \u9ed8\u8ba4\u9694\u79bb\u7ea7\u522b\u662f REPEATABLE-READ\uff0c\u5b9e\u9645\u4e0a MySQL \u5185\u90e8\u901a\u8fc7 MVCC \u548c\u95f4\u9699\u9501\u89e3\u51b3\u4e86\u5e7b\u8bfb\u7684\u95ee\u9898\u3002</p> </li> <li> <p>PostgreSQL \u5185\u90e8\u5b9e\u9645\u4e0a\u53ea\u652f\u6301\u63d0\u4ea4\u8bfb\u3001\u53ef\u91cd\u590d\u8bfb\u3001\u5e8f\u5217\u5316\u4e09\u79cd\u7ea7\u522b\uff0cPostgreSQL \u5185\u90e8\u4f1a\u5c06 <code>Read uncommitted</code> \u89c6\u540c\u4e3a <code>Read commit</code> \u5904\u7406\u3002\u9ed8\u8ba4\u662f <code>Read commit</code></p> </li> </ul>"},{"location":"basic/11.sql-Transaction/#mvcc","title":"MVCC \u673a\u5236","text":"<p>MVCC \u7684\u6838\u5fc3\u601d\u60f3\u662f\u4e3a\u6bcf\u4e2a\u6570\u636e\u884c\u4fdd\u5b58\u5176\u5728\u4e0d\u540c\u65f6\u95f4\u70b9\u7684\u7248\u672c\uff0c\u5e76\u901a\u8fc7\u7248\u672c\u53f7\u6216\u65f6\u95f4\u6233\u6765\u6807\u8bc6\u8fd9\u4e9b\u7248\u672c\u3002\u5f53\u4e00\u4e2a\u4e8b\u52a1\u5f00\u59cb\u65f6\uff0cMySQL \u4f1a\u4e3a\u8be5\u4e8b\u52a1\u521b\u5efa\u4e00\u4e2a\u72ec\u7acb\u7684\u4e8b\u52a1 ID\uff0c\u5e76\u5229\u7528\u8fd9\u4e2a ID \u53bb\u83b7\u53d6\u6570\u636e\u7684\u4e00\u81f4\u6027\u5feb\u7167\u3002</p> <p>\u4e3a\u4e86\u5b9e\u73b0<code>READ COMMITTED</code>\u4ee5\u53ca<code>REPEATABLE READ</code>\uff0c\u6211\u4eec\u9700\u8981\u4fdd\u8bc1\u4e0d\u540c\u7684\u4e8b\u52a1\u5728\u67d0\u4e00\u65f6\u523b\u53ea\u80fd\u770b\u5230\u4e00\u90e8\u5206\u5386\u53f2\u6570\u636e\u6216\u8005\u81ea\u5df1\u6240\u4fee\u6539\u7684\u6570\u636e\uff0c\u800c\u591a\u7248\u672c\u5e76\u53d1\u63a7\u5236\uff08Multiversion concurrency control\uff09\u901a\u8fc7 undo log \u7ec4\u6210\u7684\u7248\u672c\u94fe\u4ee5\u53ca ReadView \u5e2e\u6211\u4eec\u5b9e\u73b0\u4e86\u8fd9\u4e00\u70b9\u3002</p> <p>\u5bf9\u4e8e\u4f7f\u7528 InnoDB \u5b58\u50a8\u5f15\u64ce\u7684\u8868\u6765\u8bf4\uff0c\u6bcf\u884c\u8bb0\u5f55\u540e\u9762\u4f1a\u6709\u4e09\u4e2a\u9690\u85cf\u5b57\u6bb5\uff1a</p> <ul> <li> <p>DB_TRX_ID\uff1a\u8868\u793a\u6700\u540e\u4e00\u6b21\u4fee\u6539\u672c\u8bb0\u5f55\u7684\u4e8b\u52a1 ID\uff0c\u5360\u7528 6 \u5b57\u8282</p> </li> <li> <p>DB_ROLL_PTR\uff1a\u56de\u6eda\u6307\u9488\uff0c\u6307\u5411 undo log \u4e2d\u672c\u8bb0\u5f55\u7684\u4e0a\u4e00\u4e2a\u7248\u672c\uff0c\u53ef\u4ee5\u901a\u8fc7\u56de\u6eda\u6307\u9488\u5c06\u6240\u6709\u8bb0\u5f55\u4e32\u6210\u4e86\u4e00\u4e2a\u7248\u672c\u94fe</p> </li> <li> <p>DB_ROW_ID\uff1a\u81ea\u589e ID\uff0c\u5982\u679c\u8868\u6ca1\u6709\u5b9a\u4e49\u4e3b\u952e\u6216\u8005\u6ca1\u6709\u5217\u662f\u552f\u4e00\u975e\u7a7a\u7684\uff0c\u5c31\u4f1a\u751f\u6210\u8fd9\u4e2a\u9690\u85cf\u5217\uff0c\u5bf9\u4e8e\u6211\u4eec\u7684 tbl_user \u8868\u4e0d\u5b58\u5728\u8fd9\u4e2a\u9690\u85cf\u5217</p> </li> </ul> <p>\u4e3a\u4e86\u5b9e\u73b0\u539f\u5b50\u6027\uff0c\u6bcf\u5f53\u4e8b\u52a1\u4fee\u6539\u4e00\u6761\u8bb0\u5f55\uff08INSERT\u3001UPDATE \u6216\u8005 DELETE\uff09\u65f6\uff0c\u90fd\u4f1a\u5728\u7c7b\u578b\u4e3a FIL_PAGE_UNDO_LOG \u7684\u9875\u4e2d\u6dfb\u52a0\u4e00\u6761 undo log\uff0c\u4e4b\u540e\u53ef\u4ee5\u901a\u8fc7\u904d\u5386\u65e5\u5fd7\u5b9e\u73b0\u56de\u6eda\u64cd\u4f5c\u3002</p> <p>\u53ef\u91cd\u590d\u8bfb\u9694\u79bb\u7ea7\u662f\u7531 <code>MVCC</code> \u5b9e\u73b0\u7684\uff0c\u5b9e\u73b0\u7684\u65b9\u5f0f\u662f\u542f\u52a8\u4e8b\u52a1\u540e\uff0c\u5728\u6267\u884c\u7b2c\u4e00\u4e2a\u67e5\u8be2\u8bed\u53e5\u540e\uff0c\u4f1a\u521b\u5efa\u4e00\u4e2a <code>Read View</code>\uff0c\u540e\u7eed\u7684\u67e5\u8be2\u8bed\u53e5\u5229\u7528\u8fd9\u4e2a <code>Read View</code>\uff0c\u901a\u8fc7\u8fd9\u4e2a <code>Read View</code> \u5c31\u53ef\u4ee5\u5728 <code>undo log</code> \u7248\u672c\u94fe\u627e\u5230\u4e8b\u52a1\u5f00\u59cb\u65f6\u7684\u6570\u636e\uff0c\u6240\u4ee5\u4e8b\u52a1\u8fc7\u7a0b\u4e2d\u6bcf\u6b21\u67e5\u8be2\u7684\u6570\u636e\u90fd\u662f\u4e00\u6837\u7684\uff0c\u5373\u4f7f\u4e2d\u9014\u6709\u5176\u4ed6\u4e8b\u52a1\u63d2\u5165\u4e86\u65b0\u7eaa\u5f55\uff0c\u662f\u67e5\u8be2\u4e0d\u51fa\u6765\u8fd9\u6761\u6570\u636e\u7684\uff0c\u6240\u4ee5\u5c31\u5f88\u597d\u4e86\u907f\u514d\u5e7b\u8bfb\u95ee\u9898\u3002</p> <p>MySQL \u91cc\u9664\u4e86\u666e\u901a\u67e5\u8be2\u662f\u5feb\u7167\u8bfb\uff0c\u5176\u4ed6\u90fd\u662f\u5f53\u524d\u8bfb\uff0c\u6bd4\u5982 update\u3001insert\u3001delete\uff0c\u8fd9\u4e9b\u8bed\u53e5\u6267\u884c\u524d\u90fd\u4f1a\u67e5\u8be2\u6700\u65b0\u7248\u672c\u7684\u6570\u636e\uff0c\u7136\u540e\u518d\u505a\u8fdb\u4e00\u6b65\u7684\u64cd\u4f5c\u3002</p> <p>\u8fd9\u5f88\u597d\u7406\u89e3\uff0c\u5047\u8bbe\u4f60\u8981 <code>update</code> \u4e00\u4e2a\u8bb0\u5f55\uff0c\u53e6\u4e00\u4e2a\u4e8b\u52a1\u5df2\u7ecf <code>delete</code> \u8fd9\u6761\u8bb0\u5f55\u5e76\u4e14\u63d0\u4ea4\u4e8b\u52a1\u4e86\uff0c\u8fd9\u6837\u4e0d\u662f\u4f1a\u4ea7\u751f\u51b2\u7a81\u5417\uff0c\u6240\u4ee5 <code>update</code> \u7684\u65f6\u5019\u80af\u5b9a\u8981\u77e5\u9053\u6700\u65b0\u7684\u6570\u636e\u3002</p> <p>https://cloud.tencent.com/developer/article/2136022</p>"},{"location":"basic/11.sql-Transaction/#_14","title":"\u6570\u636e\u5e93\u9501","text":"<p>\u5728 <code>DBMS</code> \u4e2d\uff0c\u5f53\u5e76\u53d1\u4e8b\u52a1\u540c\u65f6\u8bbf\u95ee\u4e00\u4e2a\u8d44\u6e90\u65f6\uff0c\u6709\u53ef\u80fd\u5bfc\u81f4\u5728\u4e0d\u540c\u4e8b\u52a1\u5185\u90e8\u770b\u5230\u7684\u6570\u636e\u4e0d\u4e00\u81f4\u3002</p> <p>\u56e0\u6b64\u9700\u8981\u4e00\u79cd\u673a\u5236\u6765\u5c06\u6570\u636e\u8bbf\u95ee\u987a\u5e8f\u5316\uff0c\u4ee5\u4fdd\u8bc1\u6570\u636e\u5e93\u6570\u636e\u7684\u4e00\u81f4\u6027\u3002\u9501\u5c31\u662f\u5176\u4e2d\u7684\u4e00\u79cd\u673a\u5236\u3002</p> <p>\u52a0\u9501\u7684\u76ee\u7684\u5c31\u662f\u4fdd\u8bc1\u5171\u4eab\u8d44\u6e90\u5728\u4efb\u610f\u65f6\u95f4\u91cc\uff0c\u53ea\u6709\u4e00\u4e2a\u7ebf\u7a0b\u8bbf\u95ee\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u907f\u514d\u591a\u7ebf\u7a0b\u5bfc\u81f4\u5171\u4eab\u6570\u636e\u9519\u4e71\u7684\u95ee\u9898\u3002</p>"},{"location":"basic/11.sql-Transaction/#_15","title":"\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u7684\u9501","text":"<p>\u591a\u7ebf\u7a0b\u8bbf\u95ee\u5171\u4eab\u8d44\u6e90\u7684\u65f6\u5019\uff0c\u907f\u514d\u4e0d\u4e86\u8d44\u6e90\u7ade\u4e89\u800c\u5bfc\u81f4\u6570\u636e\u9519\u4e71\u7684\u95ee\u9898\uff0c\u6240\u4ee5\u6211\u4eec\u901a\u5e38\u4e3a\u4e86\u89e3\u51b3\u8fd9\u4e00\u95ee\u9898\uff0c\u90fd\u4f1a\u5728\u8bbf\u95ee\u5171\u4eab\u8d44\u6e90\u4e4b\u524d\u52a0\u9501\u3002</p> <p>\u6700\u5e95\u5c42\u7684\u4e24\u79cd\u5c31\u662f\u4f1a\u300c\u4e92\u65a5\u9501\u548c\u81ea\u65cb\u9501\u300d\uff0c\u6709\u5f88\u591a\u9ad8\u7ea7\u7684\u9501\u90fd\u662f\u57fa\u4e8e\u5b83\u4eec\u5b9e\u73b0\u7684\uff0c\u4f60\u53ef\u4ee5\u8ba4\u4e3a\u5b83\u4eec\u662f\u5404\u79cd\u9501\u7684\u5730\u57fa\uff0c\u6240\u4ee5\u6211\u4eec\u5fc5\u987b\u6e05\u695a\u5b83\u4fe9\u4e4b\u95f4\u7684\u533a\u522b\u548c\u5e94\u7528\u3002</p> <p>\u4e92\u65a5\u9501\u662f\u4e00\u79cd\u300c\u72ec\u5360\u9501\u300d\uff0c\u6bd4\u5982\u5f53\u7ebf\u7a0b A \u52a0\u9501\u6210\u529f\u540e\uff0c\u6b64\u65f6\u4e92\u65a5\u9501\u5df2\u7ecf\u88ab\u7ebf\u7a0b A \u72ec\u5360\u4e86\uff0c\u53ea\u8981\u7ebf\u7a0b A \u6ca1\u6709\u91ca\u653e\u624b\u4e2d\u7684\u9501\uff0c\u7ebf\u7a0b B \u52a0\u9501\u5c31\u4f1a\u5931\u8d25\uff0c\u4e8e\u662f\u5c31\u4f1a\u91ca\u653e CPU \u8ba9\u7ed9\u5176\u4ed6\u7ebf\u7a0b\uff0c\u65e2\u7136\u7ebf\u7a0b B \u91ca\u653e\u6389\u4e86 CPU\uff0c\u81ea\u7136\u7ebf\u7a0b B \u52a0\u9501\u7684\u4ee3\u7801\u5c31\u4f1a\u88ab\u963b\u585e\u3002</p> <p>\u5bf9\u4e8e\u4e92\u65a5\u9501\u52a0\u9501\u5931\u8d25\u800c\u963b\u585e\u7684\u73b0\u8c61\uff0c\u662f\u7531\u64cd\u4f5c\u7cfb\u7edf\u5185\u6838\u5b9e\u73b0\u7684\u3002</p> <p>\u5f53\u52a0\u9501\u5931\u8d25\u65f6\uff0c\u5185\u6838\u4f1a\u5c06\u7ebf\u7a0b\u7f6e\u4e3a\u300c\u7761\u7720\u300d\u72b6\u6001\uff0c\u7b49\u5230\u9501\u88ab\u91ca\u653e\u540e\uff0c\u5185\u6838\u4f1a\u5728\u5408\u9002\u7684\u65f6\u673a\u5524\u9192\u7ebf\u7a0b\uff0c\u5f53\u8fd9\u4e2a\u7ebf\u7a0b\u6210\u529f\u83b7\u53d6\u5230\u9501\u540e\uff0c\u4e8e\u662f\u5c31\u53ef\u4ee5\u7ee7\u7eed\u6267\u884c\u3002</p> <p>\u53ef\u4ee5\u7b80\u5355\u7406\u89e3\u4e3a\u5f53\u67d0\u4e2a\u4e8b\u52a1\u5728\u64cd\u4f5c\u5f00\u59cb\u65f6\uff0c\u9501\u5b9a\u67d0\u4e00\u4e2a\u8d44\u6e90\u5bf9\u8c61\uff08\u6bd4\u5982\u67d0\u4e2a\u8868\uff0c\u6bd4\u5982\u67d0\u4e00\u884c\uff09\uff0c\u5728\u8fd9\u4e2a\u4e8b\u52a1\u64cd\u4f5c\u7ed3\u675f\u4e4b\u524d\uff0c\u4e0d\u5141\u8bb8\u5176\u4ed6\u4e8b\u52a1\u64cd\u4f5c\u8fd9\u4e2a\u5bf9\u8c61\u3002</p> <ul> <li> <p>\u57fa\u4e8e\u9501\u7684\u5c5e\u6027\u5206\u7c7b\uff1a\u5171\u4eab\u9501\u3001\u6392\u4ed6\u9501\u3002</p> </li> <li> <p>\u57fa\u4e8e\u9501\u7684\u7c92\u5ea6\u5206\u7c7b\uff1a\u8868\u9501\u3001\u884c\u9501\u3001\u8bb0\u5f55\u9501\u3001\u95f4\u9699\u9501\u3001\u4e34\u952e\u9501\u3002</p> </li> <li> <p>\u57fa\u4e8e\u9501\u7684\u72b6\u6001\u5206\u7c7b\uff1a\u610f\u5411\u5171\u4eab\u9501\u3001\u610f\u5411\u6392\u5b83\u9501\u3002</p> </li> <li> <p>\u8fd8\u6709\u6b7b\u9501...</p> </li> </ul>"},{"location":"basic/11.sql-Transaction/#_16","title":"\u4e50\u89c2\u9501\u4e0e\u60b2\u89c2\u9501","text":"<p>\u4e50\u89c2\u9501\u548c\u60b2\u89c2\u9501\u662f\u4e24\u79cd\u601d\u60f3\uff0c\u7528\u4e8e\u89e3\u51b3\u5e76\u53d1\u573a\u666f\u4e0b\u7684\u6570\u636e\u7ade\u4e89\u95ee\u9898\u3002</p>"},{"location":"basic/11.sql-Transaction/#_17","title":"\u4e50\u89c2\u9501","text":"<p>\u4e50\u89c2\u9501\u4e0d\u662f\u6570\u636e\u5e93\u81ea\u5e26\u7684\uff0c\u9700\u8981\u6211\u4eec\u81ea\u5df1\u53bb\u5b9e\u73b0\u3002</p> <p>\u4e50\u89c2\u9501\u662f\u6307\u64cd\u4f5c\u6570\u636e\u5e93\u65f6(\u66f4\u65b0\u64cd\u4f5c)\u60f3\u6cd5\u5f88\u4e50\u89c2\uff0c\u8ba4\u4e3a\u8fd9\u6b21\u7684\u64cd\u4f5c\u4e0d\u4f1a\u5bfc\u81f4\u51b2\u7a81\u3002\u5728\u64cd\u4f5c\u6570\u636e\u65f6\uff0c\u5e76\u4e0d\u8fdb\u884c\u4efb\u4f55\u5176\u4ed6\u7684\u7279\u6b8a\u5904\u7406\uff08\u4e5f\u5c31\u662f\u4e0d\u52a0\u9501\uff09\uff0c\u800c\u5728\u8fdb\u884c\u66f4\u65b0\u540e\uff0c\u518d\u53bb\u5224\u65ad\u662f\u5426\u6709\u51b2\u7a81\u4e86\u3002</p> <p>\u901a\u5e38\u5b9e\u73b0\u662f\u8fd9\u6837\u7684\uff1a\u5728\u8868\u4e2d\u7684\u6570\u636e\u8fdb\u884c\u64cd\u4f5c\u65f6(\u66f4\u65b0)\uff0c\u5148\u7ed9\u6570\u636e\u8868\u52a0\u4e00\u4e2a\u7248\u672c(version)\u5b57\u6bb5\uff0c\u6bcf\u64cd\u4f5c\u4e00\u6b21\uff0c\u5c06\u90a3\u6761\u8bb0\u5f55\u7684\u7248\u672c\u53f7\u52a0 1\u3002\u4e5f\u5c31\u662f\u5148\u67e5\u8be2\u51fa\u90a3\u6761\u8bb0\u5f55\uff0c\u83b7\u53d6\u51fa version \u5b57\u6bb5\uff0c\u5982\u679c\u8981\u5bf9\u90a3\u6761\u8bb0\u5f55\u8fdb\u884c\u64cd\u4f5c(\u66f4\u65b0)\uff0c\u5219\u5148\u5224\u65ad\u6b64\u523b version \u7684\u503c\u662f\u5426\u4e0e\u521a\u521a\u67e5\u8be2\u51fa\u6765\u65f6\u7684 version \u7684\u503c\u76f8\u7b49\uff0c\u5982\u679c\u76f8\u7b49\uff0c\u5219\u8bf4\u660e\u8fd9\u6bb5\u671f\u95f4\uff0c\u6ca1\u6709\u5176\u4ed6\u7a0b\u5e8f\u5bf9\u5176\u8fdb\u884c\u64cd\u4f5c\uff0c\u5219\u53ef\u4ee5\u6267\u884c\u66f4\u65b0\uff0c\u5c06 version \u5b57\u6bb5\u7684\u503c\u52a0 1\uff1b\u5982\u679c\u66f4\u65b0\u65f6\u53d1\u73b0\u6b64\u523b\u7684 version \u503c\u4e0e\u521a\u521a\u83b7\u53d6\u51fa\u6765\u7684 version \u7684\u503c\u4e0d\u76f8\u7b49\uff0c\u5219\u8bf4\u660e\u8fd9\u6bb5\u671f\u95f4\u5df2\u7ecf\u6709\u5176\u4ed6\u7a0b\u5e8f\u5bf9\u5176\u8fdb\u884c\u64cd\u4f5c\u4e86\uff0c\u5219\u4e0d\u8fdb\u884c\u66f4\u65b0\u64cd\u4f5c\u3002</p> <p>\u4e50\u89c2\u9501\u8ba4\u4e3a\u4e00\u822c\u60c5\u51b5\u4e0b\u6570\u636e\u4e0d\u4f1a\u9020\u6210\u51b2\u7a81\uff08\u6240\u4ee5\u53eb\"\u4e50\u89c2\"\uff09\uff0c\u6240\u4ee5\u5728\u6570\u636e\u8fdb\u884c\u63d0\u4ea4\u66f4\u65b0\u65f6\u624d\u4f1a\u5bf9\u6570\u636e\u7684\u51b2\u7a81\u4e0e\u5426\u8fdb\u884c\u68c0\u6d4b\u3002</p> <p>\u5b83\u672c\u8eab\u662f\u79cd\u7a0b\u5e8f\u8bbe\u8ba1\u601d\u60f3\uff0c\u901a\u8fc7\u4e00\u79cd\u6807\u8bc6\u6765\u51b3\u5b9a\u6570\u636e\u662f\u5426\u53ef\u4ee5\u64cd\u4f5c\u3002</p>"},{"location":"basic/11.sql-Transaction/#_18","title":"\u60b2\u89c2\u9501","text":"<p>\u4e0e\u4e50\u89c2\u9501\u76f8\u5bf9\u5e94\u7684\u5c31\u662f\u60b2\u89c2\u9501\u4e86\u3002\u60b2\u89c2\u9501\u5c31\u662f\u5728\u64cd\u4f5c\u6570\u636e\u65f6\uff0c\u8ba4\u4e3a\u6b64\u64cd\u4f5c\u4f1a\u51fa\u73b0\u6570\u636e\u51b2\u7a81\uff0c\u6240\u4ee5\u5728\u8fdb\u884c\u6bcf\u6b21\u64cd\u4f5c\u65f6\u90fd\u8981\u901a\u8fc7\u83b7\u53d6\u9501\u624d\u80fd\u8fdb\u884c\u5bf9\u76f8\u540c\u6570\u636e\u7684\u64cd\u4f5c\uff0c\u8fd9\u70b9\u8ddf java \u4e2d\u7684 synchronized \u5f88\u76f8\u4f3c\uff0c\u6240\u4ee5\u60b2\u89c2\u9501\u9700\u8981\u8017\u8d39\u8f83\u591a\u7684\u65f6\u95f4\u3002\u53e6\u5916\u4e0e\u4e50\u89c2\u9501\u76f8\u5bf9\u5e94\u7684\uff0c\u60b2\u89c2\u9501\u662f\u7531\u6570\u636e\u5e93\u81ea\u5df1\u5b9e\u73b0\u4e86\u7684\uff0c\u8981\u7528\u7684\u65f6\u5019\uff0c\u6211\u4eec\u76f4\u63a5\u8c03\u7528\u6570\u636e\u5e93\u7684\u76f8\u5173\u8bed\u53e5\u5c31\u53ef\u4ee5\u4e86\u3002</p>"},{"location":"basic/11.sql-Transaction/#_19","title":"\u8bfb\u9501\u5199\u9501","text":"<p>\u8bfb\u9501\u662f\u5171\u4eab\u7684\uff0c\u662f\u4e92\u76f8\u4e0d\u963b\u585e\u7684\uff0c\u591a\u4e2a\u6570\u636e\u5e93\u4e8b\u52a1\u5728\u540c\u4e00\u65f6\u95f4\u8bfb\u53d6\u540c\u4e00\u8d44\u6e90\uff0c\u4e92\u4e0d\u5e72\u6270\u3002\uff08\u8bfb\u4e0e\u8bfb\u4e4b\u95f4\u4e0d\u4e92\u65a5\uff09</p> <p>\u5199\u9501\u662f\u6392\u4ed6\u7684\uff0c\u4f1a\u963b\u585e\u5176\u4ed6\u7684\u5199\u9501\u548c\u8bfb\u9501\uff0c\u5199\u9501\u6709\u66f4\u9ad8\u7684\u4f18\u5148\u7ea7\u3002\uff08\u5373\u6211\u5728\u5199\u8d44\u6e90\u7684\u65f6\u5019\uff0c\u5176\u4ed6\u7528\u6237\u65e0\u6cd5\u8bfb\u5199\uff09</p> <p>\u4e00\u79cd\u63d0\u9ad8\u5171\u4eab\u8d44\u6e90\u5e76\u53d1\u6027\u7684\u65b9\u5f0f\u5c31\u662f\u8ba9\u9501\u5b9a\u5bf9\u8c61\u66f4\u6709\u9009\u62e9\u6027\u3002\u5c3d\u91cf\u53ea\u9501\u5b9a\u9700\u8981\u4fee\u6539\u7684\u90e8\u5206\u6570\u636e\uff0c\u800c\u4e0d\u662f\u6240\u6709\u7684\u8d44\u6e90\uff0c\u9501\u5b9a\u7684\u8d44\u6e90\u8d8a\u5c11\uff0c\u7cfb\u7edf\u7684\u5e76\u53d1\u6027\u66f4\u597d\u3002</p> <p>\u4efb\u4f55\u65f6\u5019\uff0c\u8ba9\u9501\u5b9a\u7684\u6570\u636e\u91cf\u6700\u5c0f\u5316\uff0c\u7406\u8bba\u4e0a\u5c31\u80fd\u4fdd\u8bc1\u5728\u7ed9\u5b9a\u8d44\u6e90\u4e0a\u540c\u65f6\u8fdb\u884c\u66f4\u6539\u64cd\u4f5c\uff0c\u53ea\u8981\u88ab\u4fee\u6539\u7684\u6570\u636e\u5f7c\u6b64\u4e0d\u51b2\u7a81\u5373\u53ef\u3002</p> <p>\u9501\u5b9a\u7b56\u7565\u662f\u9501\u5f00\u9500\u548c\u6570\u636e\u5b89\u5168\u6027\u4e4b\u95f4\u7684\u5e73\u8861\uff0c\u8fd9\u79cd\u5e73\u8861\u4f1a\u5f71\u54cd\u6027\u80fd\u3002\u5927\u591a\u6570\u5546\u4e1a\u6570\u636e\u5e93\u7cfb\u7edf\u6ca1\u6709\u63d0\u4f9b\u592a\u591a\u7684\u9009\u62e9\uff0c\u4e00\u822c\u90fd\u662f\u5728\u8868\u4e2d\u65bd\u52a0\u884c\u7ea7\u9501\uff08row level lock\uff09\uff0c \u4e3a\u4e86\u5728\u9501\u6bd4\u8f83\u591a\u7684\u60c5\u51b5\u4e0b\u5c3d\u53ef\u80fd\u5730\u63d0\u4f9b\u66f4\u597d\u7684\u6027\u80fd\uff0c\u7684\u5b9e\u73b0\u65b9\u5f0f\u975e\u5e38\u590d\u6742\u3002 \u9501\u662f\u6570\u636e\u5e93\u5b9e\u73b0\u4e00\u81f4\u6027\u4fdd\u8bc1\u7684\u65b9\u6cd5\u3002\u6570\u636e\u5e93\u64cd\u4f5c\u4e13\u5bb6\u5fc5\u987b\u6df1\u5165\u6e90\u4ee3\u7801\uff0c\u624d\u80fd\u786e\u5b9a\u5408\u9002\u7684\u914d\u7f6e\uff0c \u4ee5\u4f18\u5316\u901f\u5ea6\u4e0e\u6570\u636e\u5b89\u5168\u4e4b\u95f4\u7684\u5e73\u8861\u3002</p>"},{"location":"basic/11.sql-Transaction/#_20","title":"\u9501\u7684\u7c92\u5ea6","text":"<p>\u6839\u636e\u9501\u5b9a\u5bf9\u8c61\u7684\u7c92\u5ea6\u548c\u9501\u5b9a\u8303\u56f4\uff0c\u53ef\u4ee5\u5927\u81f4\u5206\u4e3a\uff1a</p> <ul> <li> <p>\u5168\u5c40\u9501\uff08\u6574\u4e2a\u5b9e\u4f8b\uff09</p> </li> <li> <p>\u8868\u9501\uff08table lock\uff09\uff08\u88ab\u9501\u5b9a\u7684\u8d44\u6e90\u7684\u7c92\u5ea6\u662f\u8868\uff09</p> </li> <li> <p>\u884c\u9501 \uff08row lock\uff09\uff08\u88ab\u9501\u5b9a\u8d44\u6e90\u7684\u7c92\u5ea6\u662f\u884c\uff09</p> </li> </ul> <pre><code>-- InnoDB \u884c\u7ea7\u9501\u662f\u901a\u8fc7\u7ed9\u7d22\u5f15\u4e0a\u7684\u7d22\u5f15\u9879\u52a0\u9501\u6765\u5b9e\u73b0\u7684\uff0cInnoDB\u884c\u7ea7\u9501\u53ea\u6709\u901a\u8fc7\u7d22\u5f15\u6761\u4ef6\u68c0\u7d22\u6570\u636e\uff0c\u624d\u4f7f\u7528\u884c\u7ea7\u9501;\n-- \u5426\u5219\uff0cInnoDB\u4f7f\u7528\u8868\u9501\uff0c\u5728\u4e0d\u901a\u8fc7\u7d22\u5f15(\u4e3b\u952e)\u6761\u4ef6\u67e5\u8be2\u7684\u65f6\u5019\uff0cInnoDB\u662f\u8868\u9501\u800c\u4e0d\u662f\u884c\u9501\u3002\n\n-- \u5982\u679c\u6ca1\u6709\u4f7f\u7528\u7d22\u5f15\u6216\u7d22\u5f15\u5931\u6548\uff0c\u884c\u9501\u5c31\u4f1a\u53d8\u6210\u8868\u9501\nSELECT c1 FROM t WHERE c1 = 10 FOR UPDATE;\n</code></pre> <p>https://www.jianshu.com/p/1f4940c134b3</p>"},{"location":"basic/11.sql-Transaction/#_21","title":"\u5168\u5c40\u9501","text":"<p>FTWRL \u662f FLUSH TABLES WITH READ LOCK \u7684\u7b80\u79f0(FTWRL)\uff0c\u8be5\u547d\u4ee4\u4e3b\u8981\u7528\u4e8e\u4fdd\u8bc1\u5907\u4efd\u4e00\u81f4\u6027\u5907\u4efd\u3002</p> <pre><code>-- \u6267\u884c\u540e\uff0c\u6574\u4e2a\u6570\u636e\u5e93\u5c31\u5904\u4e8e\u53ea\u8bfb\u72b6\u6001\u4e86\uff0c\u6240\u6709\u5199\u7ebf\u7a0b\u90fd\u4f1a\u88ab\u963b\u585e\nflush tables with read lock;\n</code></pre> <p>\u4e3a\u4e86\u8fbe\u5230\u8fd9\u4e2a\u76ee\u7684\uff0c\u5b83\u9700\u8981\u5173\u95ed\u6240\u6709\u8868\u5bf9\u8c61\uff0c\u56e0\u6b64\u8fd9\u4e2a\u547d\u4ee4\u7684\u6740\u4f24\u6027\u5f88\u5927\uff0c\u6267\u884c\u547d\u4ee4\u65f6\u5bb9\u6613\u5bfc\u81f4\u5e93 hang \u4f4f\u3002</p> <p>\u5982\u679c\u5b83\u5728\u4e3b\u5e93\u6267\u884c\uff0c\u5219\u4e1a\u52a1\u65e0\u6cd5\u6b63\u5e38\u8bbf\u95ee\uff1b\u5982\u679c\u5728\u5907\u5e93\uff0c\u5219\u4f1a\u5bfc\u81f4 SQL \u7ebf\u7a0b\u5361\u4f4f\uff0c\u4e3b\u5907\u5ef6\u8fdf\u3002</p> <p>\u5168\u5c40\u9501\u4e3b\u8981\u5e94\u7528\u4e8e\u505a\u5168\u5e93\u903b\u8f91\u5907\u4efd\uff0c\u8fd9\u6837\u5728\u5907\u4efd\u6570\u636e\u5e93\u671f\u95f4\uff0c\u4e0d\u4f1a\u56e0\u4e3a\u6570\u636e\u6216\u8868\u7ed3\u6784\u7684\u66f4\u65b0\uff0c\u800c\u51fa\u73b0\u5907\u4efd\u6587\u4ef6\u7684\u6570\u636e\u4e0e\u9884\u671f\u7684\u4e0d\u4e00\u6837\u3002</p>"},{"location":"basic/11.sql-Transaction/#_22","title":"\u5171\u4eab\u9501/\u6392\u5b83\u9501","text":"<p>\u8bfb\u9501\u5199\u9501\u4e5f\u88ab\u79f0\u4e3a\u5171\u4eab\u9501\u548c\u6392\u4ed6\u9501</p> <p>InnoDB \u5b9e\u73b0\u4e86\u884c\u7ea7\u522b\u7684\u5171\u4eab\u9501\u548c\u6392\u5b83\u9501\u3002</p> <ul> <li>\u8bfb\u9501\u662f\u5171\u4eab\u7684\uff0c\u662f\u4e92\u76f8\u4e0d\u963b\u585e\u7684\uff0c\u591a\u4e2a\u5ba2\u6237\u7aef(\u4e25\u683c\u8bf4\u5e94\u8be5\u662f\u4e0d\u540c\u4e8b\u52a1)\u5728\u540c\u4e00\u65f6\u95f4\u8bfb\u53d6\u540c\u4e00\u8d44\u6e90\uff0c\u4e92\u4e0d\u5e72\u6270\u3002\uff08\u5373\u6211\u5728\u8bfb\u8d44\u6e90\u7684\u65f6\u5019\uff0c\u5176\u4ed6\u4eba\u53ea\u80fd\u8bfb\u4e0d\u80fd\u5199\uff09</li> <li>\u5199\u9501\u662f\u6392\u4ed6\u7684\uff0c\u4f1a\u963b\u585e\u5176\u4ed6\u7684\u5199\u9501\u548c\u8bfb\u9501\uff0c\u5199\u9501\u6709\u66f4\u9ad8\u7684\u4f18\u5148\u7ea7\u3002\uff08\u5373\u6211\u5728\u5199\u8d44\u6e90\u7684\u65f6\u5019\uff0c\u5176\u4ed6\u7528\u6237\u65e0\u6cd5\u8bfb\u5199\uff09</li> <li>\u5141\u8bb8\u4e0d\u540c\u4e8b\u52a1\u4e4b\u95f4\u5171\u4eab\u52a0\u9501\u8bfb\u53d6\uff0c\u4f46\u4e0d\u5141\u8bb8\u5176\u5b83\u4e8b\u52a1\u4fee\u6539\u6216\u8005\u52a0\u5165\u6392\u4ed6\u9501\u3002</li> </ul> <p>\u9690\u5f0f\u52a0\u9501\uff1aInnoDB\uff0c\u5728\u6267\u884c\u4e8b\u52a1\u8fc7\u7a0b\u4e2d\u4f1a\u81ea\u52a8\u52a0\u9501\uff0c\u5f53\u4e8b\u52a1 COMMIT \u5b8c\u6210\u6216 ROLLBACK \u65f6\u9501\u4f1a\u81ea\u52a8\u91ca\u653e\u3002</p> <p>\u663e\u5f0f\u52a0\u9501\uff1a</p> <pre><code>-- \u5168\u5c40\u52a0\u9501\uff0c\u5bf9\u6574\u4e2a\u6570\u636e\u5e93\u5b9e\u4f8b\u52a0\u9501\uff0c\u8fd9\u4e2a\u8bed\u53e5\u901a\u5e38\u4e5f\u53ebFTWRL\n-- \u6574\u4e2a\u5e93\u5904\u4e8e\u53ea\u8bfb\u72b6\u6001\u7684\u65f6\u5019\uff0c\u53ef\u4ee5\u4f7f\u7528\u8fd9\u4e2a\u547d\u4ee4\uff0c\u4e4b\u540e\u5176\u4ed6\u7ebf\u7a0b\u7684\u4ee5\u4e0b\u8bed\u53e5\u4f1a\u88ab\u963b\u585e\n-- \u6570\u636e\u66f4\u65b0\u8bed\u53e5\uff08\u6570\u636e\u7684\u589e\u5220\u6539\uff09\u3001\u6570\u636e\u5b9a\u4e49\u8bed\u53e5\uff08\u5305\u62ec\u5efa\u8868\u3001\u4fee\u6539\u8868\u7ed3\u6784\u7b49\uff09\u548c\u66f4\u65b0\u7c7b\u4e8b\u52a1\u7684\u63d0\u4ea4\u8bed\u53e5\u3002DDL\u548cDML\u90fd\u4f1a\u88ab\u963b\u585e\nFlush tables with read lock ;\n\n-- \u5168\u5c40\u9501\u7684\u4f7f\u7528\u573a\u666f\uff1a\u4e00\u822c\u662f\u6570\u636e\u5e93\u903b\u8f91\u5907\u4efd\uff0c\u6216\u67d0\u79cd\u7279\u6b8a\u4e1a\u52a1\u9700\u6c42\u8981\u8ba9\u6574\u4e2a\u5e93\u4e34\u65f6\u53ea\u8bfb\u3002\n\n\n-- \u5bf9\u67d0\u4e2a\u5bf9\u8c61\uff08\u4e00\u822c\u662f\u884c\u9501\uff09\u663e\u5f0f\u52a0\u8bfb\u9501\uff0c\u5982\u679c\u8fd9\u884c\u5bf9\u67d0\u4e9b\u884c\u52a0\u9501\u7684\u65f6\u5019\uff0c\u5176\u4ed6\u4e8b\u52a1\u8fd8\u5728\u5199\u5165\uff0c\u90a3\u4e48\u8fd9\u884cselect\u4f1a\u4e00\u76f4\u7b49\u5230\u5176\u4ed6\u4e8b\u52a1\u63d0\u4ea4\u624d\u4f1a\u8bfb\u5230\u6700\u65b0\u7684\u6570\u636e\u3002\nSELECT ... FOR SHARE\n-- \u7b49\u4ef7\u4e8e SELECT...LOCK IN SHARE MODE\uff0c\u540e\u9762\u8fd9\u79cd\u5199\u6cd5\u53ef\u4ee5\u517c\u5bb9\u8001\u7248\u672c\uff0cFOR SHARE\u8fd9\u79cd\u5199\u6cd5\u53ef\u4ee5\u652f\u6301\u66f4\u591a\u7279\u6027\u3002\n-- \u5728 MySQL8.0.22\u4e4b\u524d\uff0c SELECT ... FOR SHARE\u9700\u8981SELECT\u6743\u9650\u5916\uff0c\u8fd8\u9700\u8981 DELETE, LOCK TABLES, or UPDATE \u4e09\u4e2a\u4e4b\u4e00\n-- \u5728 MySQL8.0.22\u4e4b\u540e\uff0c SELECT ... FOR SHARE\u53ea\u9700\u8981select\u6743\u9650\n\n\n\n-- \u663e\u5f0f\u52a0\u5199\u9501\nSELECT...FOR UPDATE\n\n-- \u663e\u793a\u52a0\u8bfb\u9501\u6216\u5199\u9501\n-- \u5982\u679c\u5728\u67d0\u4e2a\u7ebf\u7a0bA\u4e2d\u6267\u884clock tables t1 read, t2 write; \u8fd9\u4e2a\u8bed\u53e5\uff0c\n-- \u90a3\u4e48\u5176\u4ed6\u7ebf\u7a0b\u5199t1\u3001\u8bfb\u5199t2\u7684\u8bed\u53e5\u90fd\u4f1a\u88ab\u963b\u585e\u3002\u540c\u65f6\uff0c\u7ebf\u7a0bA\u5728\u6267\u884cunlock tables\u4e4b\u524d\uff0c\u4e5f\u53ea\u80fd\u6267\u884c\u8bfbt1\u3001\u8bfb\u5199t2\u7684\u64cd\u4f5c\u3002\u8fde\u5199t1\u90fd\u4e0d\u5141\u8bb8\uff0c\u81ea\u7136\u4e5f\u4e0d\u80fd\u8bbf\u95ee\u5176\u4ed6\u8868\u3002\nlock tables \u2026 read/write\n-- \u91ca\u653e\u9501 unlock tables\n</code></pre>"},{"location":"basic/11.sql-Transaction/#_23","title":"\u8bfb\u9501","text":"<pre><code>-- \u6ce8\u610f\uff1a\u8fd9\u91cc\u90fd\u662f\u663e\u793a\u5f00\u542f\u4e8b\u52a1\uff0c\u6545\u610f\u6267\u884c\u4e8b\u52a1\u4e0d\u63d0\u4ea4\u3002\n-- session1\nstart transaction;\nselect * from test where id = 1 lock in share mode;\n-- \u5728session1\u7ebf\u7a0b\u91cc\u9762\uff0c\u5b83\u81ea\u5df1\u4e5f\u65e0\u6cd5\u83b7\u5f97\u5199\u9501\nupdate emp set ename = 'ALLEN1111' where ename='ALLEN' ;\n\n-- session2\nstart transaction;\nselect * from test where id = 1 lock in share mode;\n\n-- \u6b64\u65f6 session1 \u548c session2 \u90fd\u53ef\u4ee5\u6b63\u5e38\u83b7\u53d6\u7ed3\u679c\uff0c\u90a3\u4e48\u518d\u52a0\u5165 session3 \u6392\u4ed6\u9501\u8bfb\u53d6\u5c1d\u8bd5\n\n-- session3:\nstart transaction;\n-- session3\u7684SQL\u53ef\u4ee5\u6362\u6210\u4efb\u610f\u7684\u5199\u8bed\u53e5\uff08update,insert,delete,alter\u6548\u679c\u90fd\u662f\u4e00\u6837\uff09\nselect * from test where id = 1 for update;\n-- Lock wait timeout exceeded; try restarting transaction -- \u5728 session3 \u4e2d\u5219\u65e0\u6cd5\u83b7\u53d6\u6570\u636e\uff0c\u76f4\u5230\u8d85\u65f6\u6216\u5176\u5b83\u4e8b\u7269 commit\n\n\n\n-- \u901a\u8fc7 information_schema.INNODB_TRX \u8868\u91cc\u7684 trx_mysql_thread_id \u53ef\u4ee5\u627e\u5230\u9501\u8868\u7684\u7ebf\u7a0bID\n-- \u518d\u56de information_schema.`PROCESSLIST` \u8868\u91cc\u9762\u53bb\u67e5\uff0c\u5c31\u53ef\u4ee5\u627e\u5230\u76f8\u5e94\u7684\u8fde\u63a5\u3002\nSELECT * FROM information_schema.INNODB_TRX\n</code></pre>"},{"location":"basic/11.sql-Transaction/#_24","title":"\u5199\u9501","text":"<p>\u5f53\u4e00\u4e2a\u4e8b\u52a1\u52a0\u5165\u6392\u4ed6\u9501\u540e\uff0c\u4e0d\u5141\u8bb8\u5176\u4ed6\u4e8b\u52a1\u52a0\u5171\u4eab\u9501\u6216\u8005\u6392\u5b83\u9501\u8bfb\u53d6\uff0c\u66f4\u52a0\u4e0d\u5141\u8bb8\u5176\u4ed6\u4e8b\u52a1\u4fee\u6539\u52a0\u9501\u7684\u884c\u3002</p> <pre><code>-- session1:\n-- session\u5bf9\u8d44\u6e90\u6dfb\u52a0\u5199\u9501\nstart transaction;\nselect * from test where id = 1 for update;\n\n-- session2(session2\u5bf9test\u7684\u589e\u5220\u6539\u67e5\u4efb\u4f55\u8bbf\u95ee\u90fd\u4f1a\u88ab\u963b\u585e)\n-- \u5982\u679csession1\u7684\u4e8b\u52a1\u4e00\u76f4\u4e0d\u63d0\u4ea4\u6216\u56de\u6eda\uff0c\u90a3\u4e48session2\u8d85\u65f6\nstart transaction;\nselect * from test where id = 1 for update;\n</code></pre>"},{"location":"basic/11.sql-Transaction/#_25","title":"\u9501\u7684\u91ca\u653e","text":"<p>MySQL \u4e2d\u91ca\u653e\u9501\u7684\u52a8\u4f5c\u90fd\u662f\u9690\u5f0f\u7684\uff0c\u5bf9\u4e8e\u9501\u7684\u91ca\u653e\u5de5\u4f5c\uff0cMySQL \u81ea\u5df1\u6765\u5e72\uff0c\u5c31\u7c7b\u4f3c\u4e8e JVM \u4e2d\u7684 GC \u673a\u5236\u4e00\u6837\uff0c\u628a\u5185\u5b58\u91ca\u653e\u7684\u5de5\u4f5c\u7559\u7ed9\u4e86\u81ea\u5df1\u5b8c\u6210\u3002</p> <p>\u5bf9\u4e8e\u9501\u7684\u91ca\u653e\u65f6\u673a\uff0c\u5728\u4e0d\u540c\u7684\u9694\u79bb\u7ea7\u522b\u4e2d\u4e5f\u5e76\u4e0d\u76f8\u540c\uff0c\u6bd4\u5982\u5728\u201c\u8bfb\u672a\u63d0\u4ea4\u201d\u7ea7\u522b\u4e2d\uff0c\u662f SQL \u6267\u884c\u5b8c\u6210\u540e\u5c31\u7acb\u9a6c\u91ca\u653e\u9501\uff1b\u800c\u5728\u201c\u53ef\u91cd\u590d\u8bfb\u201d\u7ea7\u522b\u4e2d\uff0c\u662f\u5728\u4e8b\u52a1\u7ed3\u675f\u540e\u624d\u4f1a\u91ca\u653e\u3002</p> <p>\u5982\u679c\u5b8c\u5168\u6309\u7167\u6570\u636e\u5e93\u89c4\u8303\u6765\u5b9e\u73b0 RC \u9694\u79bb\u7ea7\u522b\uff0c\u4e3a\u4e86\u4fdd\u8bc1\u5176\u4ed6\u4e8b\u52a1\u53ef\u4ee5\u8bfb\u5230\u672a\u63d0\u4ea4\u7684\u6570\u636e\uff0c\u90a3\u5c31\u5fc5\u987b\u5f97\u5728 SQL \u6267\u884c\u5b8c\u6210\u540e\uff0c\u7acb\u9a6c\u91ca\u653e\u6389\u9501\uff0c\u8fd9\u65f6\u53e6\u4e00\u4e2a\u4e8b\u52a1\u624d\u80fd\u8bfb\u5230 SQL \u5bf9\u5e94\u5199\u7684\u6570\u636e\uff0c\u4f46\u5728 InnoDB \u5f15\u64ce\u4e2d\uff0c\u5b83\u57fa\u4e8e MVCC \u673a\u5236\u5b9e\u73b0\u4e86\u8be5\u6548\u679c\uff0c\u4e3a\u6b64\uff0cInnoDB \u7684 RC \u7ea7\u522b\u4e2d\uff0cSQL \u6267\u884c\u7ed3\u675f\u540e\u5e76\u4e0d\u4f1a\u91ca\u653e\u9501\u3002</p>"},{"location":"basic/11.sql-Transaction/#_26","title":"\u610f\u5411\u9501","text":"<p>MySQL \u652f\u6301\u591a\u79cd\u7c92\u5ea6\u7684\u9501\uff08\u8868\u9501\uff0c\u884c\u9501\uff09\u3002\u5b83\u5141\u8bb8<code>\u884c\u7ea7\u9501</code>\u4e0e<code>\u8868\u7ea7\u9501</code>\u5171\u5b58\uff0c\u4e3a\u4e86\u5b9e\u73b0\u591a\u7c92\u5ea6\u7ea7\u522b\u7684\u9501\u5b9a\uff0cInnoDB \u4f7f\u7528\u4e86**\u610f\u5411\u9501**\uff0c\u5b83\u5176\u5b9e\u5c31\u662f\u5176\u4e2d\u7684\u4e00\u79cd<code>\u8868\u9501</code>\u3002</p> <p>\u5047\u8bbe\u4e00\u5f20\u8868\u4e2d\u6709\u4e00\u5343\u4e07\u6761\u6570\u636e\uff0c\u73b0\u5728\u4e8b\u52a1 T1 \u5bf9 ID=8888888 \u7684\u8fd9\u6761\u6570\u636e\u52a0\u4e86\u4e00\u4e2a\u884c\u9501\uff0c\u6b64\u65f6\u6765\u4e86\u4e00\u4e2a\u4e8b\u52a1 T2\uff0c\u60f3\u8981\u83b7\u53d6\u8fd9\u5f20\u8868\u7684\u8868\u7ea7\u522b\u5199\u9501\u3002</p> <p>\u5199\u9501\u5fc5\u987b\u4e3a\u6392\u4ed6\u9501\uff0c\u4e5f\u5c31\u662f\u5728\u540c\u4e00\u65f6\u523b\u5185\uff0c\u53ea\u5141\u8bb8\u5f53\u524d\u4e8b\u52a1\u64cd\u4f5c\uff0c\u5982\u679c\u8868\u4e2d\u5b58\u5728\u5176\u4ed6\u4e8b\u52a1\u5df2\u7ecf\u83b7\u53d6\u4e86\u9501\uff0c\u76ee\u524d\u4e8b\u52a1\u5c31\u65e0\u6cd5\u6ee1\u8db3\u201c\u72ec\u5360\u6027\u201d\uff0c\u56e0\u6b64\u4e0d\u80fd\u83b7\u53d6\u9501\u3002</p> <pre><code>-- \u8868\u7ea7\u522b\u7684\u9501\n\n-- \u7528\u8bfb\u9501\u9501\u8868\uff0c\u4f1a\u963b\u585e\u5176\u4ed6\u4e8b\u52a1\u4fee\u6539\u8868\u6570\u636e\u3002\nLOCK TABLE my_tabl_name READ;\n-- \u7528\u5199\u9501\u9501\u8868\uff0c\u4f1a\u963b\u585e\u5176\u4ed6\u4e8b\u52a1\u8bfb\u548c\u5199\u3002\nLOCK TABLE my_table_name WRITE;\n\n\n-- \u884c\u7ea7\u522b\u7684\u9501\uff08\u67e5\u8be2\u8d70\u7d22\u5f15\uff09\n\n-- \u8bfb\u9501\nSELECT ... FOR SHARE\n-- \u5199\u9501\nSELECT ... FOR UPDATE\n\n\n-- \u8003\u8651\u8fd9\u6837\u7684\u4e00\u4e2a\u4f8b\u5b50\uff1a\n\n-- \u4e8b\u52a1A\u9501\u4f4f\u4e86\u8868\u4e2d\u7684\u4e00\u884c\uff0c\u8ba9\u8fd9\u4e00\u884c\u53ea\u80fd\u8bfb\uff0c\u4e0d\u80fd\u5199\u3002\uff08\u5bf9\u67d0\u884c\u52a0\u8bfb\u9501\uff09\n\n-- \u4e8b\u52a1B\u7533\u8bf7\u6574\u4e2a\u8868\u7684\u5199\u9501\u3002\uff08\u5982\u679c\u4e8b\u52a1B\u7533\u8bf7\u6210\u529f\uff0c\u90a3\u4e48\u7406\u8bba\u4e0a\u5b83\u5c31\u80fd\u4fee\u6539\u8868\u4e2d\u7684\u4efb\u610f\u4e00\u884c\uff0c\u8fd9\u4e0eA\u6301\u6709\u7684\u884c\u9501\u662f\u51b2\u7a81\u7684\u3002\uff09\n\n-- \u6570\u636e\u5e93\u9700\u8981\u907f\u514d\u8fd9\u79cd\u51b2\u7a81\uff0c\u5c31\u662f\u8bf4\u8981\u8ba9B\u7684\u7533\u8bf7\u88ab\u963b\u585e\uff0c\u76f4\u5230A\u91ca\u653e\u4e86\u884c\u9501\u3002\n\n-- \u6570\u636e\u5e93\u5185\u90e8\u8981\u600e\u4e48\u5224\u65ad\u8fd9\u4e2a\u51b2\u7a81\u5462\uff1f\uff08\u5373B\u4e8b\u52a1\u51c6\u5907\u5bf9\u5168\u8868\u52a0\u5199\u9501\u4e4b\u524d\u7684\u68c0\u6d4b\uff09\n\n-- step1\uff1a\u5224\u65ad\u8868\u662f\u5426\u5df2\u88ab\u5176\u4ed6\u4e8b\u52a1\u7528\u8868\u9501\u9501\u8868\u3002\n-- step2\uff1a\u904d\u5386\u8868\u4e2d\u7684\u6bcf\u4e00\u884c\u662f\u5426\u5df2\u88ab\u884c\u9501\u9501\u4f4f\u3002\uff08\u7531\u4e8e\u8fd9\u6837\u7684\u6548\u7387\u5f88\u4f4e\uff0c\u9700\u8981\u904d\u5386\u6574\u4e2a\u8868\u3002\uff09\n\n-- \u4e8e\u662f\u610f\u5411\u9501\u51fa\u73b0\u4e86\uff0c\u5728\u610f\u5411\u9501\u5b58\u5728\u7684\u60c5\u51b5\u4e0b\uff0c\u4e8b\u52a1A\u5fc5\u987b\u5148\u7533\u8bf7\u8868\u7684\u610f\u5411\u5171\u4eab\u9501\uff0c\u6210\u529f\u540e\u518d\u7533\u8bf7\u4e00\u884c\u7684\u884c\u9501\u3002\n\n-- \u5728\u610f\u5411\u9501\u5b58\u5728\u7684\u60c5\u51b5\u4e0b\uff0c\u4e0a\u9762\u7684\u5224\u65ad\u53ef\u4ee5\u6539\u6210\n\n-- step1\uff1a\u4e0d\u53d8\n-- step2\uff1a\u53d1\u73b0\u8868\u4e0a\u6709\u610f\u5411\u5171\u4eab\u9501\uff0c\u8bf4\u660e\u8868\u4e2d\u6709\u4e9b\u884c\u88ab\u5171\u4eab\u884c\u9501\u9501\u4f4f\u4e86\uff0c\u56e0\u6b64\uff0c\u4e8b\u52a1B\u7533\u8bf7\u8868\u7684\u5199\u9501\u4f1a\u88ab\u963b\u585e\u3002\n\n\n-- \u6240\u4ee5\u51c6\u786e\u6765\u8bb2\uff0cSELECT ... FOR SHARE \u6301\u6709\u7684\u662f IS lock\uff08\u610f\u5411\u8bfb\u9501\uff09\n-- \u6240\u4ee5\u51c6\u786e\u6765\u8bb2\uff0cSELECT ... FOR UPDATE \u6301\u6709\u7684\u662f IX lock\uff08\u610f\u5411\u5199\u9501\uff09\n\n-- \u610f\u5411\u9501\u5b9e\u73b0\u7684\u80cc\u666f\u662f\u591a\u7c92\u5ea6\u9501\u7684\u5e76\u5b58\u573a\u666f\u3002\n\n-- \u6ce8\u610f\uff1a\u7533\u8bf7\u610f\u5411\u9501\u7684\u52a8\u4f5c\u662f\u6570\u636e\u5e93\u5185\u90e8\u5b8c\u6210\u7684\uff0c\u5c31\u662f\u8bf4\uff0c\u4e8b\u52a1A\u7533\u8bf7\u4e00\u884c\u7684\u884c\u9501\u7684\u65f6\u5019\uff0c\u6570\u636e\u5e93\u5185\u90e8\u4f1a\u81ea\u52a8\u5148\u5f00\u59cb\u7533\u8bf7\u8868\u7684\u610f\u5411\u9501\uff0c\u4e0d\u9700\u8981\u6211\u4eec\u81ea\u5df1\u5b9e\u73b0\u3002\n-- \u610f\u5411\u9501\u662f\u8868\u7ea7\u9501\u7684\u4e00\u79cd\uff0c\u5b83\u662f\u7531\u6570\u636e\u5e93\u5f15\u64ce\u81ea\u884c\u7ef4\u62a4\u7684\uff0c\u7528\u6237\u81ea\u5df1\u65e0\u9700\u4e5f\u65e0\u6cd5\u64cd\u4f5c\u610f\u5411\u9501\u3002\n</code></pre>"},{"location":"basic/11.sql-Transaction/#_27","title":"\u95f4\u9699\u9501","text":"<p>\u95f4\u9699\u9501\uff08Gap Lock\uff09\u662f InnoDB \u5b58\u50a8\u5f15\u64ce\u4e3a\u4e86\u5b9e\u73b0\u53ef\u91cd\u590d\u8bfb\u9694\u79bb\u7ea7\u522b\u800c\u5f15\u5165\u7684\u4e00\u79cd\u9501\u673a\u5236\u3002\u5b83\u9501\u4f4f\u7684\u662f\u7d22\u5f15\u8bb0\u5f55\u4e4b\u95f4\u7684\u95f4\u9699\uff08\u800c\u4e0d\u662f\u7d22\u5f15\u8bb0\u5f55\u672c\u8eab\uff09\uff0c\u9632\u6b62\u5176\u4ed6\u4e8b\u52a1\u5728\u8fd9\u4e2a\u95f4\u9699\u4e2d\u63d2\u5165\u65b0\u7684\u6570\u636e\u3002</p> <p>\u4e3a\u4ec0\u4e48\u9700\u8981\u95f4\u9699\u9501\uff1f</p> <p>\u9632\u6b62\u5e7b\u8bfb: \u5e7b\u8bfb\u662f\u6307\u5728\u4e00\u4e2a\u4e8b\u52a1\u4e2d\uff0c\u4e24\u6b21\u8bfb\u53d6\u540c\u4e00\u6761\u6570\u636e\uff0c\u5374\u5f97\u5230\u4e86\u4e0d\u540c\u7684\u7ed3\u679c\u3002\u95f4\u9699\u9501\u901a\u8fc7\u9501\u5b9a\u7d22\u5f15\u8bb0\u5f55\u4e4b\u95f4\u7684\u95f4\u9699\uff0c\u9632\u6b62\u5176\u4ed6\u4e8b\u52a1\u5728\u8be5\u95f4\u9699\u4e2d\u63d2\u5165\u65b0\u7684\u6570\u636e\uff0c\u4ece\u800c\u907f\u514d\u5e7b\u8bfb\u7684\u53d1\u751f\u3002</p> <p>\u95f4\u9699\u9501\u7684\u7279\u6027</p> <ul> <li>\u9501\u5b9a\u8303\u56f4: \u95f4\u9699\u9501\u9501\u5b9a\u7684\u662f\u7d22\u5f15\u8bb0\u5f55\u4e4b\u95f4\u7684\u95f4\u9699\uff0c\u800c\u4e0d\u662f\u7d22\u5f15\u8bb0\u5f55\u672c\u8eab\u3002</li> <li>\u9501\u7c7b\u578b: \u95f4\u9699\u9501\u662f\u6392\u5b83\u9501\uff0c\u5176\u4ed6\u4e8b\u52a1\u4e0d\u80fd\u5728\u9501\u5b9a\u7684\u95f4\u9699\u4e2d\u63d2\u5165\u65b0\u7684\u6570\u636e\u3002</li> <li>\u89e6\u53d1\u6761\u4ef6: \u5f53\u4e8b\u52a1\u6267\u884c\u8303\u56f4\u67e5\u8be2\u65f6\uff0cInnoDB \u4f1a\u81ea\u52a8\u4e3a\u7b26\u5408\u6761\u4ef6\u7684\u7d22\u5f15\u8bb0\u5f55\u4e4b\u95f4\u7684\u95f4\u9699\u52a0\u4e0a\u95f4\u9699\u9501\u3002</li> <li>\u9501\u7684\u91ca\u653e: \u4e8b\u52a1\u63d0\u4ea4\u6216\u56de\u6eda\u65f6\uff0c\u95f4\u9699\u9501\u4f1a\u81ea\u52a8\u91ca\u653e\u3002</li> </ul>"},{"location":"basic/11.sql-Transaction/#mdl","title":"MDL \u9501","text":"<p>\u5728 MySQL \u4f7f\u7528\u8fc7\u7a0b\u4e2d\uff0c\u4e0d\u514d\u6709\u5bf9\u8868\u8fdb\u884c\u66f4\u6539\u7684<code>DDL</code>\u64cd\u4f5c(alter/drop table)\u3002</p> <p>\u6709\u7684\u65f6\u5019\u6211\u4eec\u4f1a\u53d1\u73b0\uff0c\u4e00\u6761\u7b80\u5355\u7684\u5bf9\u8868\u589e\u52a0\u5b57\u6bb5\u7684\u64cd\u4f5c\uff0c\u4f1a\u6267\u884c\u5f88\u957f\u65f6\u95f4\uff0c\u4e25\u91cd\u65f6\u751a\u81f3\u5bfc\u81f4\u6574\u4e2a\u6570\u636e\u5e93\u6302\u6389\u3002</p> <p>\u5728\u51fa\u73b0\u95ee\u9898\u65f6\u67e5\u770b show processlist \u7684\u65f6\u5019\uff0c\u53ef\u4ee5\u770b\u5230\u7b80\u5355\u7684\u6240\u8c13\u7684<code>Waiting for table metadata lock</code>\u4e4b\u7c7b\u7684\u72b6\u6001\uff0c\u6709\u4e9b\u60c5\u51b5\u5f88\u96be\u6392\u67e5\u3002</p> <p>\u5143\u6570\u636e\u9501\u662f server \u5c42\u7684\u8868\u7ea7\u9501\u3002\u4e3b\u8981\u7528\u4e8e\u9694\u79bb DML \u548c DDL \u64cd\u4f5c\u4e4b\u95f4\u7684\u5e72\u6270\u3002MDL \u9501\u4e0d\u4ec5\u4ec5\u662f\u4f5c\u7528\u5728 table \u4e0a\uff0c\u4e5f\u4f5c\u7528\u5728 schemas/</p> <p>\u6bcf\u6267\u884c\u4e00\u6761 DML\u3001DDL \u8bed\u53e5\u65f6\u90fd\u4f1a\u7533\u8bf7 MDL \u9501\uff0cDML \u64cd\u4f5c\u9700\u8981 MDL \u8bfb\u9501\uff0cDDL \u64cd\u4f5c\u9700\u8981 MDL \u5199\u9501\uff08MDL \u52a0\u9501\u8fc7\u7a0b\u662f\u7cfb\u7edf\u81ea\u52a8\u63a7\u5236\uff0c\u65e0\u6cd5\u76f4\u63a5\u5e72\u9884\uff0c\u8bfb\u8bfb\u5171\u4eab\uff0c\u8bfb\u5199\u4e92\u65a5\uff0c\u5199\u5199\u4e92\u65a5\uff09</p> <p>\u7533\u8bf7 MDL \u9501\u7684\u64cd\u4f5c\u4f1a\u5f62\u6210\u4e00\u4e2a\u961f\u5217\uff0c\u961f\u5217\u4e2d\u5199\u9501\u83b7\u53d6\u4f18\u5148\u7ea7\u9ad8\u4e8e\u8bfb\u9501\u3002\u4e00\u65e6\u51fa\u73b0\u5199\u9501\u7b49\u5f85\uff0c\u4e0d\u4f46\u5f53\u524d\u64cd\u4f5c\u4f1a\u88ab\u963b\u585e\uff0c\u540c\u65f6\u8fd8\u4f1a\u963b\u585e\u540e\u7eed\u8be5\u8868\u7684\u6240\u6709\u64cd\u4f5c\u3002\u4e8b\u52a1\u4e00\u65e6\u7533\u8bf7\u5230 MDL \u9501\u540e\uff0c\u76f4\u5230\u4e8b\u52a1\u6267\u884c\u5b8c\u624d\u4f1a\u5c06\u9501\u91ca\u653e\u3002</p> <p>\u5176\u5b9e MDL Lock \u662f MySQL \u4e0a\u5c42\u4e00\u4e2a\u975e\u5e38\u590d\u6742\u7684\u5b50\u7cfb\u7edf\uff0c\u6709\u81ea\u5df1\u7684\u6b7b\u9501\u68c0\u6d4b\u673a\u5236\u3002</p> <p>\u8003\u8651\u5982\u4e0b\u4e24\u4e2a session:</p> session1 session2 BEGIN SELECT * FROM XXX; sleep(60); DROP TABLE XXX SELECT * FROM XXX <ul> <li>session1 \u663e\u793a\u5f00\u542f\u4e8b\u52a1\uff0c\u4e24\u6b21\u67e5\u8be2\u95f4\u9694<code>60</code>\u79d2\u3002</li> <li>session2 \u5728\u8fd9\u4e24\u6b21\u67e5\u8be2\u4e4b\u95f4\u6267\u884c\u5220\u8868\u8bed\u53e5\u3002</li> </ul> <p>\u5982\u679c DROP TABLE \u6210\u529f\u6267\u884c\u4e86\uff0c\u90a3\u4f1a\u8bdd 1 \u7684\u7b2c\u4e8c\u4e2a select \u4f1a\u51fa\u9519\uff0c\u8fd9\u660e\u663e\u4e0d\u662f\u6211\u4eec\u60f3\u8981\u7684\u7ed3\u679c\u3002</p> <p>\u6240\u4ee5\u4e3a\u4e86\u907f\u514d\u6b64\u7c7b\u95ee\u9898\uff0cMySQL5.5 \u7248\u672c\u52a0\u5165\u4e86 MDL(Metadata Lock)\uff1a</p> <ul> <li>\u5f53\u5bf9\u4e00\u4e2a\u8868\u505a CRUD \u64cd\u4f5c\u7684\u65f6\u5019\uff0c\u52a0 MDL \u8bfb\u9501\uff08MDL_SHARED_READ\uff09\uff1b</li> <li> <p>\u5f53\u8981\u5bf9\u8868\u505a\u7ed3\u6784\u53d8\u66f4\u64cd\u4f5c\uff08DDL\uff09\uff08alter, drop\uff09\u7684\u65f6\u5019\uff0c\u52a0 MDL \u5199\u9501\uff08MDL_EXCLUSIVE\uff09\u3002</p> </li> <li> <p>\u8bfb\u9501\u4e4b\u95f4\u4e0d\u4e92\u65a5\uff0c\u56e0\u6b64\u53ef\u4ee5\u6709\u591a\u4e2a\u7ebf\u7a0b\u540c\u65f6\u5bf9\u4e00\u5f20\u8868\u589e\u5220\u6539\u67e5\u3002</p> </li> <li>\u8bfb\u5199\u9501\u4e4b\u95f4\u3001\u5199\u9501\u4e4b\u95f4\u4e92\u65a5\uff0c\u7528\u6765\u4fdd\u8bc1\u53d8\u66f4\u7ed3\u6784\u64cd\u4f5c\u7684\u5b89\u5168\u6027\u3002\u56e0\u6b64\uff0c\u5982\u679c\u6709\u4e24\u4e2a\u7ebf\u7a0b\u8981\u540c\u65f6\u7ed9\u4e00\u4e2a\u8868\u52a0\u5b57\u6bb5\uff0c\u5176\u4e2d\u4e00\u4e2a\u8981\u7b49\u53e6\u4e00\u4e2a\u6267\u884c\u5b8c\u624d\u80fd\u5f00\u59cb\u6267\u884c\u3002</li> </ul> <p>\u5728\u8fd9\u4e2a\u4f8b\u5b50\u4e2d\uff0c<code>show processlist</code> \u53ef\u4ee5\u770b\u5230\uff0c session2 \u7684 DROP \u8bed\u53e5\u4e00\u76f4\u5728\u7b49\u5f85 <code>Waiting for table metadata lock</code></p>"},{"location":"basic/11.sql-Transaction/#_28","title":"\u8e29\u5751\u5b9e\u6218\u4e00","text":"session1 session2 session3 session4 begin select * from user limit 1 select * from user limit 1 alter table user add address varchar(32) select * from user limit 1 <ul> <li>session1 \u6267\u884c select \uff0c\u6301\u6709 MDL \u8bfb\u9501\uff08\u7531\u4e8e\u663e\u793a\u5f00\u542f\u4e8b\u52a1\uff0c\u4e8b\u52a1\u5e76\u672a\u7ed3\u675f\uff0c\u6240\u4ee5\u4e00\u76f4\u6301\u6709 MDL \u8bfb\u9501\uff09\u3002</li> <li>session2 \u6267\u884c select\uff0c\u4e5f\u8981\u6301\u6709 MDL \u8bfb\u9501\uff0c\u7531\u4e8e MDL \u8bfb\u9501\u4e0d\u4e92\u65a5\uff0c\u6240\u4ee5\u4e5f\u53ef\u4ee5\u62ff\u5230\uff0c\u6b63\u5e38\u6267\u884c\u4e8b\u52a1\u5b8c\u6210\uff0c\u91ca\u653e MDL \u8bfb\u9501</li> <li>session3 \u8981\u6301\u6709 MDL \u5199\u9501\uff0c\u7531\u4e8e session1 \u7684 MDL \u8bfb\u9501\u5e76\u672a\u91ca\u653e\uff0c\u6240\u4ee5 session3 \u88ab\u963b\u585e\uff0c\u72b6\u6001\u662f<code>Waiting for table metadata lock</code></li> <li> <p>session4 \u4e5f\u4f1a\u88ab\u963b\u585e\uff08\u5982\u679c\u6709 MDL \u5199\u9501\u88ab\u963b\u585e\uff0c\u540e\u7eed\u5bf9\u8fd9\u4e2a\u8868\u7684\u6240\u6709\u8bf7\u6c42\u90fd\u4f1a\u88ab\u963b\u585e\uff09</p> </li> <li> <p>\u539f\u56e0\u5256\u6790\uff1a\u5e94\u8be5\u662f MySQL \u5185\u90e8\u7ef4\u62a4\u4e86\u4e00\u4e2a MDL \u961f\u5217\uff0c\u907f\u514d MDL \u5199\u9501\u4e00\u76f4\u8bf7\u6c42\u4e0d\u5230\u3002</p> </li> <li>\uff08\u5982\u679c\u6ca1\u6709\u5148\u6765\u540e\u5230\u7684\u8bdd\uff0c\u540e\u9762\u7684\u8bfb\u5199\u8bf7\u6c42\u4e0d\u505c\u7684\u8fc7\u6765\u8fdb\u884c\u67e5\u8be2\uff0c\u8fd9\u4e2a DDL \u4f1a\u4e00\u76f4\u88ab\u963b\u585e\uff09</li> <li>\u95ee\u9898\u6ce8\u610f\uff1a\u5982\u679c\u67d0\u4e2a\u8868\u4e0a\u7684\u67e5\u8be2\u8bed\u53e5\u9891\u7e41\uff0c\u800c\u4e14\u5ba2\u6237\u7aef\u6709\u91cd\u8bd5\u673a\u5236\uff0c\u4e5f\u5c31\u662f\u8bf4\u8d85\u65f6\u540e\u4f1a\u518d\u8d77\u4e00\u4e2a\u65b0 session \u518d\u8bf7\u6c42\u7684\u8bdd\uff0c\u8fd9\u4e2a\u5e93\u7684\u7ebf\u7a0b\u5f88\u5feb\u5c31\u4f1a\u7206\u6ee1\u3002</li> </ul> <p>\u7533\u8bf7 MDL \u9501\u7684\u64cd\u4f5c\u4f1a\u5f62\u6210\u4e00\u4e2a\u961f\u5217\uff0c\u961f\u5217\u4e2d\u5199\u9501\u83b7\u53d6\u4f18\u5148\u7ea7\u9ad8\u4e8e\u8bfb\u9501\u3002\u4e00\u65e6\u51fa\u73b0\u5199\u9501\u7b49\u5f85\uff0c\u4e0d\u4f46\u5f53\u524d\u64cd\u4f5c\u4f1a\u88ab\u963b\u585e\uff0c\u540c\u65f6\u8fd8\u4f1a\u963b\u585e\u540e\u7eed\u8be5\u8868\u7684\u6240\u6709\u64cd\u4f5c\u3002\u4e8b\u52a1\u4e00\u65e6\u7533\u8bf7\u5230 MDL \u9501\u540e\uff0c\u76f4\u5230\u4e8b\u52a1\u6267\u884c\u5b8c\u624d\u4f1a\u5c06\u9501\u91ca\u653e\u3002</p> <p>\uff08\u8fd9\u91cc\u6709\u79cd\u7279\u6b8a\u60c5\u51b5\u5982\u679c\u4e8b\u52a1\u4e2d\u5305\u542b DDL \u64cd\u4f5c\uff0cmysql \u4f1a\u5728 DDL \u64cd\u4f5c\u8bed\u53e5\u6267\u884c\u524d\uff0c\u9690\u5f0f\u63d0\u4ea4 commit\uff0c\u4ee5\u4fdd\u8bc1\u8be5 DDL \u8bed\u53e5\u64cd\u4f5c\u4f5c\u4e3a\u4e00\u4e2a\u5355\u72ec\u7684\u4e8b\u52a1\u5b58\u5728\uff0c\u540c\u65f6\u4e5f\u4fdd\u8bc1\u5143\u6570\u636e\u6392\u4ed6\u9501\u7684\u91ca\u653e\uff0c\u4f8b\u5982 id 44 \u7684\u8bed\u53e5\u6539\u4e3a\uff0c\u6b64\u65f6\u4e00\u65e6 alter \u8bed\u53e5\u6267\u884c\u5b8c\u6210\u4f1a\u9a6c\u4e0a\u63d0\u4ea4\u4e8b\u52a1\uff08autocommit=1\uff09\uff0c\u540e\u9762\u7684 select \u5c31\u5728\u672c\u6b21\u4e8b\u52a1\u4e4b\u5916\uff0c\u5176\u6267\u884c\u5b8c\u6210\u540e\u4e0d\u4f1a\u6301\u6709\u8bfb\u9501\uff09"},{"location":"basic/11.sql-Transaction/#_29","title":"\u6392\u67e5\u601d\u8def","text":"<p>\u5bf9\u4e8e\u8fd9\u79cd\u60c5\u51b5\uff0c\u6392\u67e5\u601d\u8def\u5c31\u662f\u6700\u7b80\u5355\u7684\u67e5\u770b\u5173\u4e8e\u8fd9\u4e2a\u8868\u4e0a\u64cd\u4f5c\u7684\u6240\u6709\u8fdb\u7a0b\u548c\u4e8b\u52a1\uff1b</p> <pre><code>-- \u67e5\u4e8b\u52a1\nselect * from information_schema.innodb_trx  where trx_query like '%table_name%';\n\n-- \u67e5\u8fdb\u7a0b\nselect * from information_schema.PROCESSLIST where info like '%table_name%';\n</code></pre>"},{"location":"basic/11.sql-Transaction/#_30","title":"\u8e29\u5751\u5b9e\u6218\u4e8c","text":"<p>\u6211\u4eec\u77e5\u9053\uff0c\u5982\u679c\u4e00\u4e2a\u4e8b\u52a1\u6ca1\u6709\u63d0\u4ea4\uff0c\u4f1a\u963b\u585e\u540e\u9762\u7684 DDL \u64cd\u4f5c\u3002</p> <p>\u90a3\u4e48\uff0c\u662f\u4e0d\u662f\u6211\u4eec\u6267\u884c <code>select * from information_schema.innodb_trx</code> \u67e5\u8be2\u4e0d\u5230\u6b63\u5728\u6267\u884c\u7684\u4e8b\u52a1\uff0c\u5c31\u4e0d\u4f1a\u51fa\u73b0 MDL \u963b\u585e\u7684\u60c5\u51b5\u4e86\u5462?</p> <p>\u663e\u7136\u4e0d\u662f\u3002\u6765\u770b\u4e00\u4e2a\u4f8b\u5b50\uff08\u67e5\u8be2\u4e00\u4e2a\u4e0d\u5b58\u5728\u7684\u5217\uff09\uff1a</p> session1 session2 begin; select unknown from user; alter table user add column address varchar(20) <p>\u6211\u4eec\u53d1\u73b0\uff0csession2 \u963b\u585e\uff0c\u7b49\u5f85\u83b7\u53d6 MDL \u5199\u9501\u3002\u67e5\u770b\u6b63\u5728\u8fd0\u884c\u7684\u4e8b\u52a1\uff0c\u53d1\u73b0\u5e76\u6ca1\u6709\u4e8b\u52a1\u5728\u8fd0\u884c\u3002</p> <pre><code>mysql&gt; mysql&gt; select * from information_schema.innodb_trx\\G;\nEmpty set (0.00 sec)\n</code></pre> <p>\u56e0\u4e3a<code>information_schema.innodb_trx</code>\u4e2d\u4e0d\u4f1a\u8bb0\u5f55\u6267\u884c\u5931\u8d25\u7684\u4e8b\u52a1(\u67e5\u8be2\u4e0d\u5b58\u5728\u7684\u5217\uff0c\u8bed\u53e5\u672a\u63d0\u4ea4\u7b49)\uff0c\u4f46\u662f\u5728\u8fd9\u4e2a\u6267\u884c\u5931\u8d25\u7684\u4e8b\u52a1\u56de\u6eda\u524d\uff0c\u8fd9\u4e2a\u4e8b\u52a1\u5b83\u4f9d\u7136\u6301\u6709 MDL\uff0c\u6240\u4ee5 DDL \u64cd\u4f5c\u4f9d\u7136\u4f1a\u88ab\u963b\u585e\u3002</p>"},{"location":"basic/11.sql-Transaction/#_31","title":"\u6392\u67e5\u601d\u8def","text":"<p>\u8fd9\u4e2a\u65f6\u5019\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u67e5\u627e<code>performance_schema.events_statements_current</code>\u8868\u6765\u627e\u5230\u76f8\u5173\u7684\u8bed\u53e5\u548c\u4f1a\u8bdd\u4fe1\u606f\uff0c\u7136\u540e kill \u6389</p> <pre><code>-- \u4f7f\u7528 sys.schema_table_lock_waits \u6392\u67e5\u7684\u65f6\u5019\u4e00\u5b9a\u8981\u6ce8\u610f\u8ba4\u771f\u770b\nselect * from sys.schema_table_lock_waits ;\n\nSELECT * FROM PERFORMANCE_SCHEMA.events_statements_current WHERE SQL_TEXT LIKE '%dim_admin_area%' ;\n\n\n\nSELECT\n    *\nFROM\n    information_schema.`PROCESSLIST`\nWHERE\n    id IN ( SELECT PROCESSLIST_id FROM PERFORMANCE_SCHEMA.threads WHERE thread_id IN ( SELECT thread_id FROM PERFORMANCE_SCHEMA.events_statements_current WHERE SQL_TEXT LIKE '%dim_admin_area%' ) )\n</code></pre> \u603b\u7ed3 <p>MySQL \u5728\u8fdb\u884c\u4e00\u4e9b alter table \u7b49 DDL \u64cd\u4f5c\u65f6\uff0c\u5982\u679c\u8be5\u8868\u4e0a\u6709\u672a\u63d0\u4ea4\u7684\u4e8b\u52a1\uff08\u65e0\u8bba\u6b63\u5e38\u4e8b\u52a1\u8fd8\u662f\u5931\u8d25\u4e8b\u52a1\uff09\u90fd\u4f1a\u51fa\u73b0 Waiting for table metadata lock \uff0c\u800c\u4e00\u65e6\u51fa\u73b0 metadata lock\uff0c\u8be5\u8868\u4e0a\u7684\u540e\u7eed\u64cd\u4f5c\u90fd\u4f1a\u88ab\u963b\u585e\u3002</p>"},{"location":"basic/11.sql-Transaction/#online-ddl","title":"Online DDL","text":"<p>\u5728 MySQL \u4f7f\u7528\u8fc7\u7a0b\u4e2d\uff0c\u6839\u636e\u4e1a\u52a1\u7684\u9700\u6c42\u5bf9\u8868\u7ed3\u6784\u8fdb\u884c\u53d8\u66f4\u662f\u4e2a\u666e\u904d\u7684\u8fd0\u7ef4\u64cd\u4f5c\uff0c\u8fd9\u4e9b\u79f0\u4e3a DDL \u64cd\u4f5c\u3002\u5e38\u89c1\u7684 DDL \u64cd\u4f5c\u6709\u5728\u8868\u4e0a\u589e\u52a0\u65b0\u5217\uff0c\u6216\u7ed9\u67d0\u4e2a\u5217\u6dfb\u52a0\u7d22\u5f15\u3002</p> <p>\u7ed9\u4e00\u4e2a\u8868\u52a0\u5b57\u6bb5\uff0c\u6216\u8005\u4fee\u6539\u5b57\u6bb5\uff0c\u6216\u8005\u52a0\u7d22\u5f15\uff0c\u90fd\u9700\u8981\u626b\u63cf\u5168\u8868\u7684\u6570\u636e\u3002\u5bf9\u5927\u8868\u64cd\u4f5c\u7684\u65f6\u5019\uff0c\u4f60\u80af\u5b9a\u4f1a\u7279\u522b\u5c0f\u5fc3\uff0c\u4ee5\u514d\u5bf9\u7ebf\u4e0a\u670d\u52a1\u9020\u6210\u5f71\u54cd\u3002\u56e0\u4e3a\u5927\u8868 DDL \u5f80\u5f80\u4f1a\u8017\u65f6\u5f88\u4e45\u3002</p> <p>\u4ece\u524d\u9762\u7684\u63cf\u8ff0\u53ef\u4ee5\u5f97\u5230\u4e00\u4e2a\u7ed3\u8bba\uff1a\u4e8b\u52a1\u4e2d\u7684 MDL \u9501\uff0c\u5728\u8bed\u53e5\u6267\u884c\u5f00\u59cb\u65f6\u7533\u8bf7\uff0c\u4f46\u662f\u8bed\u53e5\u7ed3\u675f\u540e\u5e76\u4e0d\u4f1a\u9a6c\u4e0a\u91ca\u653e\uff0c\u800c\u4f1a\u7b49\u5230\u6574\u4e2a\u4e8b\u52a1\u63d0\u4ea4\u540e\u518d\u91ca\u653e\u3002</p> <p>\u5982\u4f55\u5b89\u5168\u7684\u7ed9\u4e00\u4e2a\u8868\u8fdb\u884c DDL \u5462\uff1f</p> <p>\u9996\u5148\u8981\u89e3\u51b3\u7684\u662f\u957f\u4e8b\u52a1\uff1a\u4e8b\u52a1\u4e0d\u63d0\u4ea4\uff0c\u5c31\u4f1a\u4e00\u76f4\u5360\u7740 MDL \u9501\u3002\u5728 information_schema.innodb_trx \u4e2d\uff0c\u53ef\u4ee5\u67e5\u5230\u5f53\u524d\u6267\u884c\u4e2d\u7684\u4e8b\u52a1\u3002</p> <p>\u5982\u679c\u4f60\u8981\u505a DDL \u53d8\u66f4\u7684\u8868\u521a\u597d\u6709\u957f\u4e8b\u52a1\u5728\u6267\u884c\uff0c\u8981\u8003\u8651\u5148\u6682\u505c DDL\uff0c\u6216\u8005 kill \u6389\u8fd9\u4e2a\u957f\u4e8b\u52a1\u3002</p> <p>\u5728 MySQL 5.6 \u4e4b\u524d\uff0cMySQL \u7684 DDL \u64cd\u4f5c\u4f1a\u6309\u7167\u539f\u6765\u7684\u8868\u590d\u5236\u4e00\u4efd\uff0c\u5e76\u505a\u76f8\u5e94\u7684\u4fee\u6539\u3002</p> <p>\u4f8b\u5982\uff0c\u5bf9\u8868 A \u8fdb\u884c DDL \u7684\u5185\u90e8\u5b9e\u73b0\u5177\u4f53\u8fc7\u7a0b\u5982\u4e0b\uff1a</p> <ul> <li>\u6309\u7167\u8868 A \u7684\u5b9a\u4e49\u65b0\u5efa\u4e00\u4e2a\u8868 B</li> <li>\u5bf9\u8868 A \u52a0\u5199\u9501</li> <li>\u5728\u8868 B \u4e0a\u6267\u884c DDL \u6307\u5b9a\u7684\u64cd\u4f5c</li> <li>\u5c06 A \u4e2d\u7684\u6570\u636e\u62f7\u8d1d\u5230 B</li> <li>\u91ca\u653e A \u7684\u5199\u9501</li> <li>\u5220\u9664\u8868 A</li> <li>\u5c06\u8868 B \u91cd\u547d\u540d\u4e3a A</li> </ul> <p>\u5728 2-4 \u7684\u8fc7\u7a0b\u4e2d\uff0c\u5982\u679c\u8868 A \u6570\u636e\u91cf\u6bd4\u8f83\u5927\uff0c\u62f7\u8d1d\u5230\u8868 B \u7684\u8fc7\u7a0b\u4f1a\u6d88\u8017\u5927\u91cf\u65f6\u95f4\uff0c\u5e76\u5360\u7528\u989d\u5916\u7684\u5b58\u50a8\u7a7a\u95f4\u3002</p> <p>\u6b64\u5916\uff0c\u7531\u4e8e DDL \u64cd\u4f5c\u5360\u7528\u4e86\u8868 A \u7684\u5199\u9501\uff0c\u6240\u4ee5\u8868 A \u4e0a\u7684 DDL \u548c DML \u90fd\u5c06\u963b\u585e\u65e0\u6cd5\u63d0\u4f9b\u670d\u52a1\u3002</p> <p>MySQL 5.6 \u7248\u672c\u5f15\u5165\u4e86 Online DDL \u7279\u6027\u3002</p> <p>\u5728 MySQL 5.6 \u4e4b\u524d\uff0c\u6267\u884c DDL \u7684\u552f\u4e00\u65b9\u6cd5\u662f\u9010\u884c\u590d\u5236\u884c\u3002INPLACE DDL \u4e3b\u8981\u7531 InnoDB \u5904\u7406\uff0c\u800c\u9010\u884c COPY \u5728\u670d\u52a1\u5668\u5c42\u5904\u7406\u3002</p> <p>\u8fd9\u79cd\u60c5\u51b5\uff0c\u5f80\u5f80\u9700\u8981\u5bf9\u6574\u4e2a\u8868\u52a0\u9501\uff0c\u8fd9\u4f1a\u5bfc\u81f4\u957f\u65f6\u95f4\u7684\u963b\u585e\uff0c\u5f71\u54cd\u4e1a\u52a1\u7684\u6b63\u5e38\u8fd0\u884c\u3002</p> <p>\u5728 MySQL 5.7\uff0cOnline DDL \u5728\u6027\u80fd\u548c\u7a33\u5b9a\u6027\u4e0a\u4e0d\u65ad\u5f97\u5230\u4f18\u5316\uff0c\u6bd4\u5982\u901a\u8fc7 bulk load \u65b9\u5f0f\u6765\u53bb\u9664\u8868\u91cd\u5efa\u65f6\u7684 redo \u65e5\u5fd7\u7b49\u3002</p> <p>\u5230\u4e86 MySQL 8.0\uff0cOnline DDL \u5df2\u7ecf\u652f\u6301\u79d2\u7ea7\u52a0\u5217\u7279\u6027\uff0c\u8be5\u7279\u6027\u6765\u6e90\u4e8e\u56fd\u5185\u7684\u817e\u8baf\u4e92\u5a31 DBA \u56e2\u961f\u3002</p> <p>\u67e5\u9605\u5b98\u65b9\u6587\u6863\u5f97\u77e5\uff0c\u5feb\u901f\u52a0\u5217\u5373 Instant Add Column \uff0c\u8be5\u529f\u80fd\u81ea MySQL 8.0.12 \u7248\u672c\u5f15\u5165\uff0c\u662f\u7531\u817e\u8baf\u6e38\u620f DBA \u56e2\u961f\u8d21\u732e\u3002\u6ce8\u610f\u4e00\u4e0b\uff0c\u6b64\u529f\u80fd\u53ea\u9002\u7528\u4e8e InnoDB \u8868\u3002</p> <p>\u57fa\u672c\u4e0a\uff0c\u5728 MySQL8.0 \u4e0a\uff0c\u4e0d\u9700\u8981\u518d\u7528 pt-osc \u548c gh-ost \u7b49\u5de5\u5177\uff0c\u5927\u591a\u6570\u60c5\u51b5\u90fd\u53ef\u4ee5\u76f4\u63a5 online DDL \u4e86\u3002</p> <p>\u6982\u62ec\u6765\u8bf4\uff0c\u5728 MySQL 8.0 \u4e0a\uff0cOnline DDL \u6709 2 \u79cd\u5212\u5206\u7ef4\u5ea6\uff08\u5176\u5b9e\u5c31\u662f\u4e24\u79cd\u53c2\u6570\uff09\uff1a</p> <ul> <li>\u4e00\u662f DDL \u671f\u95f4\u8fd0\u884c\u7684\u5e76\u53d1\u7a0b\u5ea6</li> <li>\u4e8c\u662f DDL \u7684\u6267\u884c\u7b97\u6cd5</li> </ul> <p>\u5148\u8bf4 DDL \u65f6\u7684**\u4e1a\u52a1 DML \u64cd\u4f5c\u8fd0\u884c\u7a0b\u5ea6**\uff08Permits Concurrent DML\uff09\uff0c\u53ef\u4ee5\u901a\u8fc7 LOCK \u5173\u952e\u5b57\u6765\u6307\u5b9a DDL \u671f\u95f4\u52a0\u9501\u7a0b\u5ea6\uff0c\u53ef\u9009\uff1a</p> <ul> <li>LOCK=NONE \u5141\u8bb8\u67e5\u8be2\u548c DML \u64cd\u4f5c\uff1b\u4ee5\u907f\u514d\u5728\u5197\u957f\u7684 DDL \u64cd\u4f5c\u671f\u95f4\u4f7f\u8868\u4e0d\u53ef\u7528\u3002</li> <li>LOCK=SHARED \u5141\u8bb8\u67e5\u8be2\uff0c\u4e0d\u5141\u8bb8 DML \u64cd\u4f5c\uff1b</li> <li>LOCK=DEFAULT \u7531\u7cfb\u7edf\u51b3\u5b9a\uff0c\u9009\u62e9\u6700\u5bbd\u677e\u7684\u6a21\u5f0f\uff08\u9ed8\u8ba4\u662f\u8fd9\u79cd\uff09\uff1b</li> <li>LOCK=EXCLUSIVE \u963b\u6b62\u5e76\u53d1\u67e5\u8be2\u548c DML\u3002\u5728\u5c3d\u53ef\u80fd\u77ed\u7684\u65f6\u95f4\u5185\u5b8c\u6210 DDL \u64cd\u4f5c\uff0c\u5e76\u4e14\u4e0d\u9700\u8981\u5e76\u53d1\u67e5\u8be2\u548c DML \u8bbf\u95ee\uff0c\u5219\u4f7f\u7528\u6b64\u5b50\u53e5\u3002</li> </ul> <p>\u53e6\u4e00\u79cd\u5212\u5206\u65b9\u5f0f\u4e3a\u662f\u5426\u62f7\u8d1d\u6570\u636e\uff0c\u53ef\u5206\u4e3a\u5982\u4e0b\u51e0\u79cd\uff1a</p> <ul> <li>\u4ec5\u4fee\u6539\u5143\u6570\u636e\uff1a\u5305\u62ec\u4fee\u6539\u8868\u540d\uff0c\u5b57\u6bb5\u540d\u7b49\uff1b</li> <li>ALGORITHM=COPY\uff1a\u91c7\u7528\u62f7\u8868\u65b9\u5f0f\u8fdb\u884c\u8868\u53d8\u66f4\uff0c\u4e0e pt-osc/gh-ost \u7c7b\u4f3c\uff1b</li> <li>ALGORITHM=INPLACE\uff1a\u4ec5\u9700\u8981\u8fdb\u884c\u5f15\u64ce\u5c42\u6570\u636e\u6539\u52a8\uff0c\u4e0d\u6d89\u53ca Server \u5c42\uff1b</li> <li>ALGORITHM=INSTANT\uff1a\u4e0e\u7b2c\u4e00\u79cd\u65b9\u5f0f\u7c7b\u4f3c\uff0c\u4ec5\u4fee\u6539\u5143\u6570\u636e\u3002\u76ee\u524d\u4ec5\u652f\u6301\u5728\u8868\u6700\u540e\u589e\u52a0\u65b0\u5217\uff1b</li> <li>ALGORITHM=DEFAULT\uff1a\u7531\u7cfb\u7edf\u51b3\u5b9a\uff0c\u9009\u62e9\u6700\u4f18\u7684\u7b97\u6cd5\u6267\u884c DDL\u3002 \u7528\u6237\u53ef\u4ee5\u9009\u7528\u4e0a\u8ff0\u7b97\u6cd5\u6765\u6267\u884c\uff0c\u4f46\u672c\u8eab\u53d7\u5230 DDL \u7c7b\u578b\u9650\u5236\uff0c\u5982\u679c\u6307\u5b9a\u7684\u7b97\u6cd5\u65e0\u6cd5\u6267\u884c DDL\uff0c\u5219 ALTER \u64cd\u4f5c\u4f1a\u62a5\u9519\u3002</li> </ul> <pre><code>-- \u7d22\u5f15\u7684\u589e\u5220\u6539\u67e5\uff08\u53ea\u80fd\u65b0\u589e\u548c\u5220\u9664\uff0c\u4e0d\u80fd\u76f4\u63a5\u6539\uff09\n-- \u5728\u7ebf\u52a0\u7d22\u5f15\uff1a\u64cd\u4f5c\u671f\u95f4\uff0c\u53ef\u4ee5\u6b63\u5e38\u8bfb\u5199\u3002\nCREATE INDEX name ON table (col_list) ;\n\nALTER TABLE tbl_name ADD INDEX name (col_list) ;\n-- \u521b\u5efa\u666e\u901a\u7d22\u5f15\nALTER TABLE table_name ADD INDEX index_name (column_list);\n-- \u521b\u5efa\u552f\u4e00\u7d22\u5f15\nALTER TABLE table_name ADD UNIQUE (column_list);\n\nCREATE INDEX index_name ON table_name (column_list);\nCREATE UNIQUE INDEX index_name ON table_name (column_list);\n\n\n\n\n\n\n-- \u4fee\u6539\u5b57\u6bb5\u6570\u636e\u7c7b\u578b\uff08\u4fee\u6539\u5b57\u6bb5\u957f\u5ea6\uff09\n-- ALTER  TABLE \u8868\u540d MODIFY [COLUMN] \u5b57\u6bb5\u540d \u65b0\u6570\u636e\u7c7b\u578b \u65b0\u7c7b\u578b\u957f\u5ea6  \u65b0\u9ed8\u8ba4\u503c  \u65b0\u6ce8\u91ca;\nalter table db_qhdata_policy.temp_policy_org_base  MODIFY   apprdate   varchar(50) ;\n-- \u5373\u4f7f\u662f\u5927\u8868\uff0calter\u7ebf\u7a0b\u6301\u7eed copy to tmp table \u72b6\u6001\u5f88\u957f\u65f6\u95f4\uff0c alter\u5e76\u6ca1\u6709\u963b\u585e\u5176\u4ed6\u7ebf\u7a0b\u7684\u8bfb\u8bf7\u6c42\n\n\n\n\n\n\n-- \u5b57\u6bb5\u91cd\u547d\u540d\nALTER TABLE tbl CHANGE old_col_name new_col_name data_type, ALGORITHM=INPLACE, LOCK=NONE;\n</code></pre> <p>\u4ece\u6d41\u7a0b\u4e0a\u770b\uff0cOnline DDL \u53ef\u5206\u4e3a 3 \u4e2a\u9636\u6bb5\uff1a</p> <ul> <li>\u521d\u59cb\u5316\u9636\u6bb5\uff0c\u786e\u5b9a DDL \u64cd\u4f5c\u652f\u6301\u7684\u6700\u4f18 LOCK \u548c ALGORITHM \u8bbe\u7f6e\uff0c\u5e76\u4e0e\u7528\u6237\u6307\u5b9a\u7684\u8bbe\u7f6e\u76f8\u6bd4\uff0c\u82e5\u65e0\u6cd5\u529e\u5230\u5219\u62a5\u9519\uff1b</li> <li>\u6267\u884c\u9636\u6bb5\uff0c\u5982\u679c\u9700\u8981\u62f7\u8868\u6216\u4fee\u6539\u5f15\u64ce\u5c42\u6570\u636e\uff0c\u5219\u8be5\u9636\u6bb5\u662f\u6700\u8017\u65f6\u7684\u9636\u6bb5\uff1b</li> <li>\u63d0\u4ea4\u9636\u6bb5\uff0c\u8be5\u9636\u6bb5\u4f1a\u52a0\u9501\u8fdb\u884c\u65b0\u65e7\u8868\u5207\u6362\uff1b</li> </ul> <p>\u76ee\u524d\u53ef\u7528\u7684 DDL \u64cd\u4f5c\u5de5\u5177\u5305\u62ec</p> <ul> <li>Percona \u5f00\u6e90\u7684 pt-osc</li> <li>github \u5f00\u6e90\u7684 gh-ost\uff0c</li> <li>MySQL \u539f\u751f\u63d0\u4f9b\u7684\u5728\u7ebf\u4fee\u6539\u8868\u7ed3\u6784\u547d\u4ee4 Online DDL\u3002</li> </ul> <p>pt-osc \u548c gh-ost \u5747\u91c7\u7528\u62f7\u8868\u65b9\u5f0f\u5b9e\u73b0\uff0c\u5373\u521b\u5efa\u4e2a\u7a7a\u7684\u65b0\u8868\uff0c\u901a\u8fc7 select+inser t \u5c06\u65e7\u8868\u4e2d\u7684\u8bb0\u5f55\u9010\u6b21\u8bfb\u53d6\u5e76\u63d2\u5165\u5230\u65b0\u8868\u4e2d\u3002</p> <p>\u4e0d\u540c\u4e4b\u5904\u5728\u4e8e\u5904\u7406 DDL \u671f\u95f4\u4e1a\u52a1\u5bf9\u8868\u7684 DML \u64cd\u4f5c\uff08\u589e\u5220\u6539\uff09\u3002</p> <p>\u4ece <code>MySQL 8.0.28</code> \u5f00\u59cb, InnoDB \u652f\u6301 <code>ALTER TABLE ... RENAME COLUMN</code> \u64cd\u4f5c\u4f7f\u7528 <code>ALGORITHM=INSTANT</code>\u3002</p> <p>\u4ece <code>MySQL 8.0.29</code> \u5f00\u59cb, InnoDB \u652f\u6301 <code>ALTER TABLE ... DROP COLUMN</code> \u64cd\u4f5c\u4f7f\u7528 <code>ALGORITHM=INSTANT</code>\u3002</p> <p>\u5728 <code>8.0.29</code> \u4e4b\u524d\uff0c instant \u6dfb\u52a0\u5217\uff0c\u53ea\u80fd\u662f\u52a0\u5728\u8868\u7684\u6700\u540e\u4e00\u5217\uff0c\u4ece <code>8.0.29</code> \u5f00\u59cb\uff0c\u53ef\u4ee5\u5728\u8868\u7684\u4efb\u610f\u4f4d\u7f6e\u6dfb\u52a0\u3002</p> <p>\u5728 8.0.29 \u4e4b\u540e\uff0c2 \u5343\u4e07\u7684\u8868\u5728\u4efb\u4e00\u4f4d\u7f6e\u5373\u65f6\u6dfb\u52a0\u5217\u5728\u79d2\u7ea7\u5185\u5b8c\u6210\u3002</p> <pre><code>ALTER TABLE sbtest1 ADD COLUMN k2 int(10) AFTER k,ALGORITHM=INSTANT;\n</code></pre> <p>MySQL 8.0.29 \u5f00\u59cb\uff0c<code>ALTER TABLE \u2026 ALGORITHM=INSTANT</code> \u652f\u6301\u5220\u9664\u67d0\u5217\u3002</p> <p>\u4e3a\u4e86\u652f\u6301 <code>ALTER TABLE \u2026 ALGORITHM=INSTANT</code> \u7684\u65b0\u7279\u6027\uff0c<code>InnoDB redo log</code> \u683c\u5f0f\u5bf9\u4e8e\u6240\u6709 DML \u64cd\u4f5c\u90fd\u53d1\u751f\u4e86\u53d8\u5316\u3002</p> <p>\u65b0\u7684 redo \u65e5\u5fd7\u683c\u5f0f\u5f15\u5165\u4e86\u4e00\u4e2a\u8bbe\u8ba1\u7f3a\u9677\uff0c\u4f1a\u5bfc\u81f4 <code>instant add/drop columns</code> \u7684\u8868\u6570\u636e\u635f\u574f\u3002</p> <p>https://opensource.actionsky.com/20220809-mysql/</p> <p>https://zhuanlan.zhihu.com/p/115277009</p> <p>https://blog.csdn.net/weixin_45238761/article/details/125343029</p> <p>https://cloud.tencent.cn/developer/article/2407101</p>"},{"location":"basic/11.sql-Transaction/#mysql-ddl","title":"MySQL \u539f\u5b50 DDL","text":"<p>\u5728 MySQL8.0 \u4e4b\u524d\u7684\u7248\u672c\u4e2d\uff0c\u8fd9\u4e9b\u5143\u6570\u636e\u88ab\u5b58\u653e\u5728\u8bb8\u591a\u4e0d\u540c\u7684\u6587\u4ef6\u4e2d\uff08.FRM\uff0c.PAR\uff0c.OPT\uff0c.TRN\uff0c.TRG \u6587\u4ef6\u7b49\uff09\uff0c\u8fd9\u5c31\u5bfc\u81f4\u4e86\u4e00\u7cfb\u5217\u5f0a\u7aef\uff0c\u5305\u62ec\u6570\u636e\u53ef\u80fd\u4e0d\u4e00\u81f4\u3001API \u63a5\u53e3\u7684\u590d\u6742\u6027\u7b49\u7b49\uff0c\u5728\u4e4b\u524d\u7684\u6708\u62a5\u4e2d\u4e5f\u6709\u8be6\u7ec6\u63cf\u8ff0\u3002\u5143\u6570\u636e\u88ab\u653e\u5728\u8bb8\u591a\u4e0d\u540c\u7684\u6587\u4ef6\u4e2d\uff0c\u5bfc\u81f4\u6570\u636e\u53ef\u80fd\u4e0d\u4e00\u81f4\u7684\u5177\u4f53\u8868\u73b0\u4e3a\uff1a</p> <ul> <li> <p><code>Server</code> \u5c42\u7684 <code>metadata</code> \u548c <code>Storage Engine</code> \u5c42\u7684 <code>metadata</code> \u6570\u636e\u4e0d\u4e00\u81f4</p> </li> <li> <p>InnoDB \u4e2d\u7684 metadata \u548c\u6570\u636e\u4e0d\u4e00\u81f4</p> </li> <li> <p>Binlog \u548c\u6570\u636e\u4e0d\u4e00\u81f4</p> </li> </ul> <p>MySQL 5.6/5.7 \u7684\u7528\u6237\u53ef\u80fd\u4f1a\u53d1\u73b0\uff0ccreate \u4e00\u5f20\u8868\u8fc7\u7a0b\u4e2d\u53d1\u751f crash\uff0c\u91cd\u542f\u540e\u521b\u5efa\u4e00\u5f20\u540c\u540d\u65b0\u8868\u65f6\uff0c\u4f1a\u53d1\u73b0\u521b\u5efa\u5931\u8d25\u3002\u8fd9\u662f\u56e0\u4e3a\u8fc7\u53bb MySQL 5.6/5.7 \u7684 DDL \u64cd\u4f5c\u4e0d\u662f\u539f\u5b50\u7684\uff0c\u4e00\u5f20\u8868\u521b\u5efa\u5931\u8d25\u540e\u4f1a\u9057\u7559\u4e0b ibd \u6587\u4ef6\u3002</p> <p>\u5bf9\u4e8e\u590d\u5408\u7684 DDL\uff0c\u6bd4\u5982 DROP TABLE t1, t2;\u6267\u884c\u8fc7\u7a0b\u4e2d\u5982\u679c\u9047\u5230 server crash\uff0c\u6709\u53ef\u80fd\u51fa\u73b0\u8868 t1 \u88ab DROP \u6389\u4e86\uff0c\u4f46\u662f t2 \u6ca1\u6709\u88ab DROP \u6389\u7684\u60c5\u51b5\u3002</p> <p>\u5373\u4fbf\u662f\u4e00\u6761 DDL\uff0c\u6bd4\u5982 CREATE TABLE t1(a int);\u4e5f\u53ef\u80fd\u5728 server crash \u7684\u60c5\u51b5\u4e0b\u5bfc\u81f4\u5efa\u8868\u4e0d\u5b8c\u6574\uff0c\u6709\u53ef\u80fd\u5728\u5efa\u8868\u5931\u8d25\u7684\u60c5\u51b5\u4e0b\u9057\u7559.frm \u6216\u8005.ibd \u6587\u4ef6\u3002</p> <p>MySQL 8.0 \u5bf9 DDL \u7684\u5b9e\u73b0\u91cd\u65b0\u8fdb\u884c\u4e86\u8bbe\u8ba1\uff0c\u6700\u5927\u7684\u6539\u8fdb\u662f DDL \u64cd\u4f5c\u652f\u6301\u539f\u5b50\u7279\u6027\u3002\u7531\u4e8e MySQL \u662f\u4e00\u4e2a\u591a\u5f15\u64ce\u6570\u636e\u5e93\uff0c\u5728 engine \u5c42\uff08SE\uff09\u548c server \u5c42\uff08SL\uff09\u90fd\u7ef4\u62a4\u4e86\u81ea\u5df1\u7684\u6570\u636e\u5b57\u5178\u5bf9\u8c61\u3002</p> <p>MySQL 8.0 \u4e4b\u524d\u7684\u7248\u672c DDL \u662f\u975e\u539f\u5b50\u6027\u7684\uff0c\u5bf9\u4e8e\u591a\u6761 sql \u6784\u6210\u7684 ddl \u8bed\u53e5\u6bd4\u5982</p> <pre><code>rename table t1 to t1_bak,t2 to t2_bak;\n</code></pre> <p>\u6267\u884c\u8fc7\u7a0b\u4e2d\u5982\u679c\u9047\u5230\u7cfb\u7edf\u5f02\u5e38 crash\uff0c\u6709\u53ef\u80fd\u51fa\u73b0\u8868 t1 \u88ab rename\uff0c\u4f46\u662f t2 \u6ca1\u6709\u88ab rename \u7684\u60c5\u51b5\u3002\u51fa\u73b0\u8be5\u60c5\u51b5\u7684\u539f\u56e0\u5c31\u662f MySQL \u4e0d\u652f\u6301\u539f\u5b50\u7684 DDL\u3002</p> <p>\u4e3a\u4e86\u5b9e\u73b0 DDL \u539f\u5b50\u6027\uff0cMySQL 8.0 \u4f7f\u7528 Innodb \u8868\u5b58\u50a8\u76f8\u5173\u7684\u6570\u636e\u5b57\u5178\u4fe1\u606f\uff0c\u8fd9\u4e9b\u6570\u636e\u5b57\u5178\u8868\u9ed8\u8ba4\u4e0d\u53ef\u89c1\uff0c\u67e5\u770b\u65b9\u6cd5\u53c2\u7167\u6587\u6863</p> <p>\u4ec0\u4e48\u662f\u539f\u5b50 DDL?</p> <p>\u5f53\u6267\u884c DDL \u65f6\uff0c\u6570\u636e\u5b57\u5178\u66f4\u65b0\u3001\u5b58\u50a8\u5f15\u64ce\u64cd\u4f5c\u548c\u4e8c\u8fdb\u5236\u65e5\u5fd7\u4e2d\u7684\u5199\u64cd\u4f5c\u88ab\u5408\u5e76\u5230\u4e00\u4e2a\u539f\u5b50\u4e8b\u52a1\u4e2d\uff0c\u8be5\u4e8b\u52a1\u8981\u4e48\u5b8c\u5168\u6267\u884c\uff0c\u8981\u4e48\u5b8c\u5168\u4e0d\u6267\u884c\u3002</p> <p>\u8fd9\u63d0\u4f9b\u4e86\u66f4\u597d\u7684\u53ef\u9760\u6027\uff0c\u672a\u5b8c\u6210\u7684 ddl \u4e0d\u4f1a\u7559\u4e0b\u4efb\u4f55\u4e0d\u5b8c\u6574\u7684\u6570\u636e\u3002</p> <p>\u539f\u5b50 DDL \u4e0d\u662f\u4e8b\u52a1 DDL\u3002DDL \u8bed\u53e5\uff0c\u65e0\u8bba\u662f\u539f\u5b50\u8bed\u53e5\u8fd8\u662f\u5176\u4ed6\u8bed\u53e5\uff0c\u90fd\u4f1a\u9690\u5f0f\u5730\u7ed3\u675f\u5f53\u524d\u4f1a\u8bdd\u4e2d\u6d3b\u52a8\u7684\u4efb\u4f55\u4e8b\u52a1\uff0c\u5c31\u50cf\u5728\u6267\u884c\u8bed\u53e5\u4e4b\u524d\u6267\u884c\u4e86 COMMIT \u4e00\u6837\u3002\u8fd9\u610f\u5473\u7740 DDL \u8bed\u53e5\u4e0d\u80fd\u5728\u53e6\u4e00\u4e2a\u4e8b\u52a1\u3001\u4e8b\u52a1\u63a7\u5236\u8bed\u53e5\uff08\u5982 START TRANSACTION ... COMMIT \uff09\u4e2d\u6267\u884c\uff0c\u4e5f\u4e0d\u80fd\u4e0e\u540c\u4e00\u4e8b\u52a1\u4e2d\u7684\u5176\u4ed6\u8bed\u53e5\u7ed3\u5408\u6267\u884c\u3002</p> <pre><code>-- MySQL5.7\nSTART TRANSACTION;\n    select * from mytest.t2_34;\n    alter table mytest.t2_34  ADD INDEX idx_b(b) USING BTREE;\n    -- \u5bf9\u4e8eMySQL5.7\uff0c\u5982\u679c\u4e8b\u52a1\u4e2d\u5305\u542bDDL\u64cd\u4f5c\uff0cmysql\u4f1a\u5728DDL\u64cd\u4f5c\u8bed\u53e5\u6267\u884c\u540e\uff0c\u9690\u5f0f\u63d0\u4ea4commit\u3002\u4ee5\u4fdd\u8bc1\u8be5DDL\u8bed\u53e5\u64cd\u4f5c\u4f5c\u4e3a\u4e00\u4e2a\u5355\u72ec\u7684\u4e8b\u52a1\u5b58\u5728\uff0c\u540c\u65f6\u4e5f\u4fdd\u8bc1\u5143\u6570\u636e\u6392\u4ed6\u9501\u7684\u91ca\u653e\n    select * from mytest.t2_34;\nROLLBACK; --\u8fd9\u91cc\u7684rollback\u8bed\u53e5\u5176\u5b9e\u5df2\u7ecf\u4e0d\u80fd\u56de\u6eda\u4e0a\u9762\u7684DDL\u4e86\uff0c\u56e0\u4e3a\u5df2\u7ecf\u63d0\u4ea4\u4e86\u3002\n\n\n--\u5bf9\u4e8eMySQL8.0\uff0c\u6267\u884c\u4e0a\u8ff0\u8bed\u53e5\u3002\u53d1\u73b0\u4f1a\u51fa\u73b0MDL\u963b\u585e\n\n--\u7136\u540e\u67e5\u8be2\u4f1a\u8bdd\u548c\u4e8b\u52a1\uff0c\u53d1\u73b0\u662f\u88ab\u4e00\u4e2asleep\u963b\u585e\n select * from information_schema.processlist;\n select * from information_schema.innodb_trx;\n</code></pre> <pre><code>-- \u5bf9\u4e8e\u8fd9\u4e2a  5.7\u548c8.0\u7684\u8868\u73b0\u662f\u4e00\u81f4\u7684\nSTART TRANSACTION;\n    select * from db_test.test;\n    create  table db_test.test1  like db_test.test;\n    create  table db_test.test1  like db_test.test;\n    select * from db_test.test1;\nROLLBACK;\n</code></pre> <p>https://www.cnblogs.com/radondb/p/16688994.html</p>"},{"location":"basic/11.sql-Transaction/#ddl","title":"\u652f\u6301\u7684 DDL \u8bed\u53e5","text":"<p>\u539f\u5b50 DDL \u652f\u6301\u4e0e\u8868\u76f8\u5173\u7684 DDL \u8bed\u53e5\u548c\u4e0e\u8868\u65e0\u5173\u7684 DDL \u8bed\u53e5\u3002</p> <p>\u4e0e\u8868\u76f8\u5173\u7684 DDL \u64cd\u4f5c\u9700\u8981\u5b58\u50a8\u5f15\u64ce\u7684\u652f\u6301\uff0c\u800c\u4e0e\u8868\u65e0\u5173\u7684 DDL \u64cd\u4f5c\u4e0d\u9700\u8981\u5b58\u50a8\u5f15\u64ce\u7684\u652f\u6301\u3002\u76ee\u524d\uff0c\u53ea\u6709 InnoDB \u5b58\u50a8\u5f15\u64ce\u652f\u6301\u539f\u5b50 DDL\u3002</p> <p>\u4e0e\u8868\u76f8\u5173\u7684\u539f\u5b50 DDL \u5305\u62ec\u6570\u636e\u5e93\u3001\u8868\u7a7a\u95f4\u3001\u8868\u3001\u7d22\u5f15\u7684 CREATE\u3001ALTER \u4ee5\u53ca DROP \u8bed\u53e5\uff0c\u4ee5\u53ca TRUNCATE TABLE \u8bed\u53e5\u3002</p> <p>\u4e0e\u8868\u65e0\u5173\u7684\u539f\u5b50 DDL \u5305\u62ec\uff1a</p> <p>\u5b58\u50a8\u8fc7\u7a0b\u3001\u89e6\u53d1\u5668\u3001\u89c6\u56fe\u4ee5\u53ca\u7528\u6237\u5b9a\u4e49\u51fd\u6570\uff08UDF\uff09\u7684 CREATE \u548c DROP \u8bed\u53e5\uff0c\u4ee5\u53ca\u9002\u7528\u7684 ALTER \u8bed\u53e5\u3002</p> <p>\u5e10\u6237\u7ba1\u7406\u8bed\u53e5\uff1a\u7528\u6237\u548c\u89d2\u8272\u7684 CREATE\u3001ALTER\u3001DROP \u8bed\u53e5\uff0c\u4ee5\u53ca\u9002\u7528\u7684 RENAME \u8bed\u53e5\uff0c\u4ee5\u53ca GRANT \u548c REVOKE \u8bed\u53e5\u3002</p> <p>\u4ee5\u4e0b\u8bed\u53e5\u4e0d\u652f\u6301\u539f\u5b50 DDL \u64cd\u4f5c\uff1a</p> <pre><code>\u975e InnoDB \u5b58\u50a8\u5f15\u64ce\u4e0a\u7684\u8868\u76f8\u5173 DDL \u8bed\u53e5\u3002\n</code></pre> <p>INSTALL PLUGIN \u548c UNINSTALL PLUGIN \u8bed\u53e5\u3002 INSTALL COMPONENT \u548c UNINSTALL COMPONENT \u8bed\u53e5\u3002 CREATE SERVER\u3001ALTER SERVER \u4ee5\u53ca DROP SERVER \u8bed\u53e5\u3002</p>"},{"location":"basic/11.sql-Transaction/#ddl_1","title":"\u539f\u5b50 DDL \u7684\u7279\u6027","text":"<p>\u539f\u5b50 DDL \u8bed\u53e5\u5177\u6709\u4ee5\u4e0b\u7279\u6027\uff1a</p> <ul> <li>\u4e0e DDL \u64cd\u4f5c\u76f8\u5173\u7684\u6570\u636e\u5b57\u5178\u66f4\u65b0\u3001\u5b58\u50a8\u5f15\u64ce\u64cd\u4f5c\u548c\u4e8c\u8fdb\u5236\u65e5\u5fd7\u5199\u5165\u5408\u5e76\u4e3a\u4e00\u4e2a\u5355\u4e00\u7684\u539f\u5b50\u64cd\u4f5c\u3002</li> </ul> <p>\u5373\u4f7f\u670d\u52a1\u5668\u5728\u64cd\u4f5c\u8fc7\u7a0b\u4e2d\u505c\u6b62\uff0c\u8be5\u64cd\u4f5c\u4e5f\u4f1a\u63d0\u4ea4\uff0c\u5e76\u5c06\u9002\u7528\u7684\u66f4\u6539\u6301\u4e45\u5316\u5230\u6570\u636e\u5b57\u5178\u3001\u5b58\u50a8\u5f15\u64ce\u548c\u4e8c\u8fdb\u5236\u65e5\u5fd7\u4e2d\uff0c\u6216\u8005\u56de\u6eda\u3002</p> <p>\u5c06\u53ef\u80fd\u5b58\u5728\u7684\u5143\u6570\u636e\u66f4\u65b0\u3001\u4e8c\u8fdb\u5236\u65e5\u5fd7\u5199\u5165\u4ee5\u53ca\u5b58\u50a8\u5f15\u64ce\u64cd\u4f5c\u7ec4\u5408\u6210\u5355\u4e2a\u4e8b\u52a1\u3002</p> <p>DDL \u64cd\u4f5c\u8fc7\u7a0b\u4e2d\u4e0d\u5b58\u5728 SQL \u5c42\u7684\u4e2d\u95f4\u63d0\u4ea4\u64cd\u4f5c\u3002</p> <p>\u5982\u679c\u5b58\u5728\u7684\u8bdd\uff1a \u6570\u636e\u5b57\u5178\u3001\u8fc7\u7a0b\u3001\u4e8b\u4ef6\u4ee5\u53ca\u7528\u6237\u5b9a\u4e49\u51fd\u6570\u7684\u7f13\u5b58\u72b6\u6001\u4e0e DDL \u64cd\u4f5c\u7684\u72b6\u6001\u4e00\u81f4\uff0c\u610f\u5473\u7740 DDL \u64cd\u4f5c\u6210\u529f\u6216\u8005\u56de\u6eda\u65f6\uff0c\u7f13\u5b58\u90fd\u4f1a\u8fdb\u884c\u76f8\u5e94\u66f4\u65b0\u3002 DDL \u64cd\u4f5c\u6d89\u53ca\u7684\u5b58\u50a8\u5f15\u64ce\u76f8\u5173\u4fee\u6539\u4e0d\u4f1a\u6267\u884c\u4e2d\u95f4\u7684\u63d0\u4ea4\u64cd\u4f5c\uff0c\u800c\u662f\u4f5c\u4e3a DDL \u4e8b\u52a1\u7684\u4e00\u90e8\u5206\u8fdb\u884c\u5904\u7406\u3002 \u5b58\u50a8\u5f15\u64ce\u652f\u6301 DDL \u64cd\u4f5c\u7684\u91cd\u505a\u548c\u56de\u6eda\uff0c\u8fd9\u4e9b\u64cd\u4f5c\u53d1\u751f\u5728 DDL \u64cd\u4f5c\u7684 Post-DDL \u9636\u6bb5\u3002</p> <p>\u4ece MySQL 8.0.21 \u5f00\u59cb\uff0c\u5728\u652f\u6301\u539f\u5b50 DDL \u7684\u5b58\u50a8\u5f15\u64ce\u4e0a\uff0c\u5f53\u4f7f\u7528\u57fa\u4e8e\u884c\u7684\u590d\u5236\u65f6\uff0c CREATE TABLE ... SELECT \u8bed\u53e5\u5c06\u4f5c\u4e3a\u4e00\u4e2a\u4e8b\u52a1\u8bb0\u5f55\u5728\u4e8c\u8fdb\u5236\u65e5\u5fd7\u4e2d\u3002\u4ee5\u524d\uff0c\u5b83\u88ab\u8bb0\u5f55\u4e3a\u4e24\u4e2a\u4e8b\u52a1\uff0c\u4e00\u4e2a\u7528\u4e8e\u521b\u5efa\u8868\uff0c\u53e6\u4e00\u4e2a\u7528\u4e8e\u63d2\u5165\u6570\u636e\u3002</p> <p>\u5982\u679c\u670d\u52a1\u5668\u5728\u4e24\u4e2a\u4e8b\u52a1\u4e4b\u95f4\u6216\u63d2\u5165\u6570\u636e\u65f6\u53d1\u751f\u6545\u969c\uff0c\u5c31\u4f1a\u5bfc\u81f4\u590d\u5236\u51fa\u4e00\u4e2a\u7a7a\u8868\u3002\u968f\u7740\u539f\u5b50 DDL \u652f\u6301\u7684\u5f15\u5165\uff0c CREATE TABLE ... SELECT \u8bed\u53e5\u73b0\u5728\u53ef\u4ee5\u5b89\u5168\u5730\u7528\u4e8e\u57fa\u4e8e\u884c\u7684\u590d\u5236\uff0c\u5e76\u5141\u8bb8\u7528\u4e8e\u57fa\u4e8e GTID \u7684\u590d\u5236\u3002</p>"},{"location":"basic/12.MySQL%E5%86%85%E5%AD%98%E6%A6%82%E8%BF%B0/","title":"\u5185\u5b58\u6982\u8ff0","text":"<p>MySQL\u5206\u914d\u7f13\u51b2\u533a\u548c\u7f13\u5b58\u4ee5\u63d0\u9ad8\u6570\u636e\u5e93\u64cd\u4f5c\u7684\u6027\u80fd\u3002\u9ed8\u8ba4\u914d\u7f6e\u65e8\u5728\u8ba9<code>MySQL</code>\u670d\u52a1\u5668\u5728\u5177\u6709\u5927\u7ea6512MB RAM\u7684\u865a\u62df\u673a\u4e0a\u542f\u52a8\u3002\u60a8\u53ef\u4ee5\u901a\u8fc7\u589e\u52a0\u67d0\u4e9b\u7f13\u5b58\u548c\u7f13\u51b2\u533a\u76f8\u5173\u7cfb\u7edf\u53d8\u91cf\u7684\u503c\u6765\u63d0\u9ad8 <code>MySQL</code> \u6027\u80fd\u3002\u60a8\u8fd8\u53ef\u4ee5\u4fee\u6539\u9ed8\u8ba4\u914d\u7f6e\u4ee5\u5728\u5185\u5b58\u6709\u9650\u7684\u7cfb\u7edf\u4e0a\u8fd0\u884c MySQL\u3002</p> <p><code>MySQL</code>\u7684\u5185\u5b58\u5360\u7528\u4e3b\u8981\u7531\u4e24\u90e8\u5206\u7ec4\u6210\uff0c<code>global_buffers</code> \u4e0e <code>all_thread_buffers</code>\uff0c\u5176\u4e2d <code>global_buffers</code> \u4e3a\u5168\u5c40\u5171\u4eab\u7f13\u5b58\uff0c<code>all_thread_buffers</code> \u4e3a\u6240\u6709\u7ebf\u7a0b\u72ec\u7acb\u7f13\u5b58</p> <p><code>MySQL</code>\u4ee5\u4e24\u79cd\u65b9\u5f0f\u4f7f\u7528\u5185\u5b58\uff1a</p> <p>1\u3001\u6c38\u4e45\u4fdd\u7559\u4f9b\u5176\u4f7f\u7528\u7684\u5185\u5b58 \u2013 \u6b64\u7c7b\u79f0\u4e3a\"\u5168\u5c40\u7f13\u51b2\u533a\"\u7684\u5185\u5b58\u5728\u670d\u52a1\u5668\u542f\u52a8\u671f\u95f4\u4ece\u64cd\u4f5c\u7cfb\u7edf\u83b7\u53d6\uff0c\u4e0d\u4f1a\u91ca\u653e\u5230\u4efb\u4f55\u5176\u4ed6\u8fdb\u7a0b\u3002</p> <p>2\u3001\u6839\u636e\u8bf7\u6c42\u52a8\u6001\u8bf7\u6c42\u7684\u5185\u5b58 \u2013 MySQL\u4f7f\u7528\"\u7ebf\u7a0b\u7f13\u51b2\u533a\"\uff0c\u8fd9\u662f\u5728\u5904\u7406\u65b0\u67e5\u8be2\u65f6\u4ece\u64cd\u4f5c\u7cfb\u7edf\u8bf7\u6c42\u7684\u5185\u5b58\u3002\u6267\u884c\u67e5\u8be2\u540e\uff0c\u6b64\u5185\u5b58\u5c06\u91ca\u653e\u56de\u64cd\u4f5c\u7cfb\u7edf\u3002</p> <p>\u56e0\u6b64\uff0c\u60a8\u53ef\u4ee5\u8bf4MySQL\u7684\u5185\u5b58\u4f7f\u7528\u91cf\u662f\"\u5168\u5c40\u7f13\u51b2\u533a+\uff08\u7ebf\u7a0b\u7f13\u51b2\u533ax\u5141\u8bb8\u7684\u6700\u5927\u8fde\u63a5\u6570\uff09\"\u3002</p> <p>\u5185\u5b58\u662f\u91cd\u8981\u7684\u6027\u80fd\u53c2\u6570\uff0c\u5e38\u5e38\u51fa\u73b0\u7531\u4e8e\u5f02\u5e38\u7684 <code>SQL</code> \u8bf7\u6c42\u4ee5\u53ca\u5f85\u4f18\u5316\u7684\u6570\u636e\u5e93\u5bfc\u81f4\u5185\u5b58\u5229\u7528\u7387\u5347\u9ad8\u7684\u60c5\u51b5\uff0c\u4e25\u91cd\u65f6\u8fd8\u4f1a\u51fa\u73b0\u7531\u4e8e <code>OOM</code> \u5bfc\u81f4\u5b9e\u4f8b\u53d1\u751f HA \u5207\u6362\u7684\u60c5\u51b5\u3002</p> <p>\u4e00\u4e2a\u5e38\u89c1\u95ee\u9898\u662f\u5b9e\u4f8b\u5360\u7528\u5927\u91cf\u5185\u5b58\u6216\u5185\u5b58\u4e0d\u8db3 (OOM) \u95ee\u9898\u3002\u8fd0\u884c\u5185\u5b58\u5229\u7528\u7387\u9ad8\u7684\u6570\u636e\u5e93\u5b9e\u4f8b\u901a\u5e38\u4f1a\u5bfc\u81f4\u6027\u80fd\u95ee\u9898\u3001\u505c\u6ede\uff0c\u751a\u81f3\u6570\u636e\u5e93\u505c\u673a\u3002</p> <p>\u67d0\u4e9b <code>MySQL</code> \u5185\u5b58\u5757\u5728\u5168\u5c40\u5185\u4f7f\u7528\u3002\u8fd9\u610f\u5473\u7740\u6240\u6709\u67e5\u8be2\u5de5\u4f5c\u8d1f\u8f7d\u5171\u4eab\u5185\u5b58\u4f4d\u7f6e\uff0c\u59cb\u7ec8\u88ab\u5360\u7528\uff0c\u5e76\u4e14\u4ec5\u5728 <code>MySQL</code> \u8fdb\u7a0b\u505c\u6b62\u65f6\u91ca\u653e\u3002</p> <p>\u67d0\u4e9b\u5185\u5b58\u5757\u57fa\u4e8e\u4f1a\u8bdd\uff0c\u8fd9\u610f\u5473\u7740\u4e00\u65e6\u4f1a\u8bdd\u5173\u95ed\uff0c\u8be5\u4f1a\u8bdd\u4f7f\u7528\u7684\u5185\u5b58\u5c31\u4f1a\u91ca\u653e\u56de\u7cfb\u7edf\u3002</p> <p>MySQL \u7684\u5185\u5b58\u5927\u4f53\u53ef\u4ee5\u5206\u4e3a\u5171\u4eab\u5185\u5b58\u548c session \u79c1\u6709\u5185\u5b58\u4e24\u90e8\u5206\uff0c\u4e0b\u9762\u5c06\u8be6\u7ec6\u4ecb\u7ecd\u5404\u90e8\u5206\u7684\u6784\u6210\u3002</p> <p>https://opensource.actionsky.com/20201009-mysql/</p>"},{"location":"basic/12.MySQL%E5%86%85%E5%AD%98%E6%A6%82%E8%BF%B0/#_2","title":"\u5171\u4eab\u5185\u5b58","text":"<p>MySQL \u5728\u670d\u52a1\u5668\u542f\u52a8\u65f6\u5206\u914d\u5168\u5c40\u7f13\u51b2\u533a\uff0c\u8fd9\u4e9b\u7f13\u51b2\u533a\u5728\u6240\u6709\u8fde\u63a5\u4e4b\u95f4\u5171\u4eab\u3002MySQL \u7684\u5927\u90e8\u5206\u5185\u5b58\u88ab\u5168\u5c40\u7f13\u51b2\u533a\uff08\u4f8b\u5982 innodb_buffer_pool_size\u3001innodb_log_buffer_size\u3001key_buffer_size \u7b49\uff09\u6d88\u8017\u4e86\u3002</p> <pre><code>  mysql&gt;\nmysql&gt;   show variables where variable_name in (\n    -&gt;     'innodb_buffer_pool_size','innodb_log_buffer_size','innodb_additional_mem_pool_size','key_buffer_size','query_cache_size'\n    -&gt;     );\n+-------------------------+-------------+\n| Variable_name           | Value       |\n+-------------------------+-------------+\n| innodb_buffer_pool_size | 60129542144 |\n| innodb_log_buffer_size  | 16777216    |\n| key_buffer_size         | 8388608     |\n+-------------------------+-------------+\n3 rows in set (0.00 sec)\n\nmysql&gt;\n</code></pre> <p>\u53c2\u6570\u8bf4\u660e\uff1a</p> <ul> <li> <p>innodb_buffer_pool</p> <p>\u8be5\u90e8\u5206\u7f13\u5b58\u662f Innodb \u5f15\u64ce\u6700\u91cd\u8981\u7684\u7f13\u5b58\u533a\u57df\uff0c\u662f\u901a\u8fc7\u5185\u5b58\u6765\u5f25\u8865\u7269\u7406\u6570\u636e\u6587\u4ef6\u7684\u91cd\u8981\u624b\u6bb5\u3002\u5176\u4e2d\u4e3b\u8981\u5305\u542b\u6570\u636e\u9875\u3001\u7d22\u5f15\u9875\u3001undo \u9875\u3001insert buffer\u3001\u81ea\u9002\u5e94\u54c8\u5e0c\u7d22\u5f15\u3001\u9501\u4fe1\u606f\u4ee5\u53ca\u6570\u636e\u5b57\u5178\u7b49\u4fe1\u606f\u3002\u5728\u8fdb\u884c SQL \u8bfb\u548c\u5199\u7684\u64cd\u4f5c\u65f6\uff0c\u9996\u5148\u5e76\u4e0d\u662f\u5bf9\u7269\u7406\u6570\u636e\u6587\u4ef6\u64cd\u4f5c\uff0c\u800c\u662f\u5148\u5bf9 buffer_pool \u8fdb\u884c\u64cd\u4f5c\uff0c\u7136\u540e\u518d\u901a\u8fc7 checkpoint \u7b49\u673a\u5236\u5199\u56de\u6570\u636e\u6587\u4ef6\u3002\u8be5\u7a7a\u95f4\u7684\u4f18\u70b9\u662f\u53ef\u4ee5\u63d0\u5347\u6570\u636e\u5e93\u7684\u6027\u80fd\u3001\u52a0\u5feb SQL \u8fd0\u884c\u901f\u5ea6\uff0c\u7f3a\u70b9\u662f\u6545\u969c\u6062\u590d\u901f\u5ea6\u8f83\u6162\u3002</p> </li> <li> <p>innodb_log_buffer</p> <p>\u8be5\u90e8\u5206\u4e3b\u8981\u5b58\u653e <code>redo log</code> \u7684\u4fe1\u606f\uff0c\u5728 RDS \u4e0a\u4f1a\u8bbe\u7f6e 1 M \u7684\u5927\u5c0f\u3002InnoDB \u4f1a\u9996\u5148\u5c06 <code>redo log</code> \u5199\u5728\u8fd9\u91cc\uff0c\u7136\u540e\u6309\u7167\u4e00\u5b9a\u9891\u7387\u5c06\u5176\u5237\u65b0\u56de\u91cd\u505a\u65e5\u5fd7\u6587\u4ef6\u4e2d\u3002\u8be5\u7a7a\u95f4\u4e0d\u9700\u8981\u592a\u5927\uff0c\u56e0\u4e3a\u4e00\u822c\u60c5\u51b5\u4e0b\u8be5\u90e8\u5206\u7f13\u5b58\u4f1a\u4ee5\u8f83\u5feb\u9891\u7387\u5237\u65b0\u81f3 redo log\uff08Master Thread \u4f1a\u6bcf\u79d2\u5237\u65b0\u3001\u4e8b\u52a1\u63d0\u4ea4\u65f6\u4f1a\u5237\u65b0\u3001\u5176\u7a7a\u95f4\u5c11\u4e8e \u00bd \u65f6\u540c\u6837\u4f1a\u5237\u65b0\uff09\u3002</p> </li> <li> <p>innodb_additional_mem_pool</p> <p>\u8be5\u90e8\u5206\u4e3b\u8981\u5b58\u653e InnoDB \u5185\u7684\u4e00\u4e9b\u6570\u636e\u7ed3\u6784\uff0c\u5728 RDS \u4e2d\u7edf\u4e00\u8bbe\u7f6e\u4e3a 2 M\u3002\u901a\u5e38\u662f\u5728 buffer_pool \u4e2d\u7533\u8bf7\u5185\u5b58\u7684\u65f6\u5019\u8fd8\u9700\u8981\u5728\u989d\u5916\u5185\u5b58\u4e2d\u7533\u8bf7\u7a7a\u95f4\u5b58\u50a8\u8be5\u5bf9\u8c61\u7684\u7ed3\u6784\u4fe1\u606f\u3002\u8be5\u5927\u5c0f\u4e3b\u8981\u4e0e\u8868\u6570\u91cf\u6709\u5173\uff0c\u8868\u6570\u91cf\u8d8a\u5927\u9700\u8981\u66f4\u5927\u7684\u7a7a\u95f4\u3002</p> </li> <li> <p>key_buffer</p> <p>\u8be5\u90e8\u5206\u662f MyISAM \u8868\u7684\u91cd\u8981\u7f13\u5b58\u533a\u57df\uff0c\u6240\u6709\u5b9e\u4f8b\u7edf\u4e00\u4e3a 16 M\u3002\u8be5\u90e8\u5206\u4e3b\u8981\u5b58\u653e MyISAM \u8868\u7684\u952e\u3002MyISAM \u8868\u4e0d\u540c\u4e8e InnoDB \u8868\uff0c\u5176\u7f13\u5b58\u7684\u7d22\u5f15\u7f13\u5b58\u662f\u653e\u5728 key_buffer \u4e2d\u7684\uff0c\u800c\u6570\u636e\u7f13\u5b58\u5219\u5b58\u50a8\u4e8e\u64cd\u4f5c\u7cfb\u7edf\u7684\u5185\u5b58\u4e2d\u3002RDS \u7684\u7cfb\u7edf\u662f MyISAM \u5f15\u64ce\u7684\uff0c\u56e0\u6b64\u5728 RDS \u4e2d\u662f\u7ed9\u4e88\u8be5\u90e8\u5206\u4e00\u5b9a\u91cf\u7684\u7a7a\u95f4\u7684\u3002</p> </li> <li> <p>query_cache</p> <p>\u8be5\u90e8\u5206\u662f\u5bf9\u67e5\u8be2\u7ed3\u679c\u505a\u7f13\u5b58\u4ee5\u51cf\u5c11\u89e3\u6790 SQL \u548c\u6267\u884c SQL \u7684\u82b1\u9500\uff0c\u5728 RDS \u4e0a\u5173\u95ed\u4e86\u8be5\u90e8\u5206\u7684\u7f13\u5b58\u3002\u4e3b\u8981\u9002\u5408\u4e8e\u8bfb\u591a\u5199\u5c11\u7684\u5e94\u7528\u573a\u666f\uff0c\u56e0\u4e3a\u5b83\u662f\u6309\u7167 SQL \u8bed\u53e5\u7684 hash \u503c\u8fdb\u884c\u7f13\u5b58\u7684\uff0c\u5f53\u8868\u6570\u636e\u53d1\u751f\u53d8\u5316\u540e\u5373\u5931\u6548\u3002</p> </li> </ul>"},{"location":"basic/12.MySQL%E5%86%85%E5%AD%98%E6%A6%82%E8%BF%B0/#session","title":"Session \u79c1\u6709\u5185\u5b58","text":"<p>\u5171\u4eab\u5185\u5b58\u4e2d\u4ecb\u7ecd\u7684\u5185\u5b58\u7a7a\u95f4\u662f\u5b9e\u4f8b\u521b\u5efa\u65f6\u5373\u5206\u914d\u7684\u5185\u5b58\u7a7a\u95f4\uff0c\u5e76\u4e14\u662f\u6240\u6709\u8fde\u63a5\u5171\u4eab\u7684\u3002\u800c\u51fa\u73b0 <code>OOM</code>\u5f02\u5e38\u7684\u5b9e\u4f8b\u90fd\u662f\u7531\u4e8e\u4e0b\u9762\u5404\u4e2a\u8fde\u63a5\u79c1\u6709\u7684\u5185\u5b58\u9020\u6210\u7684\u3002</p> <pre><code>mysql&gt;\nmysql&gt;  show variables where variable_name in ('read_buffer_size','read_rnd_buffer_size','sort_buffer_size','join_buffer_size','binlog_cache_size','tmp_table_size' );\n+----------------------+------------+\n| Variable_name        | Value      |\n+----------------------+------------+\n| binlog_cache_size    | 32768      |\n| join_buffer_size     | 262144     |\n| read_buffer_size     | 131072     |\n| read_rnd_buffer_size | 262144     |\n| sort_buffer_size     | 268435456  |\n| tmp_table_size       | 2147483648 |\n+----------------------+------------+\n6 rows in set (0.00 sec)\n\nmysql&gt;\nmysql&gt;\n</code></pre> <p>\u53c2\u6570\u8bf4\u660e\uff1a</p> <ul> <li> <p>read_buffer&amp;read_rnd_buffer</p> <p>\u5206\u522b\u5b58\u653e\u4e86\u5bf9\u987a\u5e8f\u548c\u968f\u673a\u626b\u63cf\uff08\u4f8b\u5982\u6309\u7167\u6392\u5e8f\u7684\u987a\u5e8f\u8bbf\u95ee\uff09\u7684\u7f13\u5b58\uff0cRDS \u7ed9\u6bcf\u4e2a session \u8bbe\u7f6e 256 K \u7684\u5927\u5c0f\u3002\u5f53 thread \u8fdb\u884c\u987a\u5e8f\u6216\u968f\u673a\u626b\u63cf\u6570\u636e\u65f6\u4f1a\u9996\u5148\u626b\u63cf\u8be5 buffer \u7a7a\u95f4\u4ee5\u907f\u514d\u66f4\u591a\u7684\u7269\u7406\u8bfb\u3002</p> </li> <li> <p>sort_buffer_size</p> <p><code>sort_buffer_size</code> \u662f\u4e00\u4e2aconnection\u7ea7\u53c2\u6570\uff0c\u5728\u6bcf\u4e2aconnection\u9700\u8981buffer\u7684\u65f6\u5019\uff0c\u4e00\u6b21\u6027\u5206\u914d\u7684\u5185\u5b58\u3002<code>sort_buffer_size</code>\u5e76\u4e0d\u662f\u8d8a\u5927\u8d8a\u597d\uff0c\u8fc7\u5927\u7684\u8bbe\u7f6e+\u9ad8\u5e76\u53d1\u53ef\u80fd\u4f1a\u8017\u5c3d\u7cfb\u7edf\u5185\u5b58\u8d44\u6e90\u3002\u9700\u8981\u6267\u884c <code>order by</code> \u548c <code>group by</code> \u7684 SQL \u90fd\u4f1a\u5206\u914d <code>sort_buffer</code>\uff0c\u7528\u4e8e\u5b58\u50a8\u6392\u5e8f\u7684\u4e2d\u95f4\u7ed3\u679c\uff0c<code>MySQL</code>\u4e0a\u9ed8\u8ba4\u662f256 K\u3002\u5728\u6392\u5e8f\u8fc7\u7a0b\u4e2d\uff0c\u82e5\u5b58\u50a8\u91cf\u5927\u4e8e<code>sort_buffer_size</code>\uff0c\u5219\u4f1a\u5728\u78c1\u76d8\u751f\u6210\u4e34\u65f6\u8868\u4ee5\u5b8c\u6210\u64cd\u4f5c\u3002\u5728 <code>Linux</code> \u7cfb\u7edf\u4e2d\uff0c\u5f53\u5206\u914d\u7a7a\u95f4\u5927\u4e8e 2M \u65f6\u4f1a\u4f7f\u7528 mmap() \u800c\u4e0d\u662f malloc() \u6765\u8fdb\u884c\u5185\u5b58\u5206\u914d\uff0c\u5bfc\u81f4\u6548\u7387\u964d\u4f4e\u3002</p> </li> <li> <p>join_buffer_size</p> <p>MySQL \u4ec5\u652f\u6301 <code>nest loop</code> \u7684 join \u7b97\u6cd5\uff0cRDS \u8bbe\u7f6e 256 K \u7684\u5927\u5c0f\u3002\u5904\u7406\u903b\u8f91\u662f\u9a71\u52a8\u8868\u7684\u4e00\u884c\u548c\u975e\u9a71\u52a8\u8868\u8054\u5408\u67e5\u627e\uff0c\u8fd9\u65f6\u5c31\u53ef\u4ee5\u5c06\u975e\u9a71\u52a8\u8868\u653e\u5165 join_buffer\uff0c\u4e0d\u9700\u8981\u8bbf\u95ee\u62e5\u6709\u5e76\u53d1\u4fdd\u62a4\u673a\u5236\u7684 <code>buffer_pool</code>\u3002</p> </li> <li> <p>binlog_cache</p> <p>\u8be5\u533a\u57df\u7528\u6765\u7f13\u5b58\u8be5 thread \u7684 binlog \u65e5\u5fd7\uff0cRDS \u8bbe\u7f6e 256 K \u7684\u5927\u5c0f\u3002\u5728\u4e00\u4e2a\u4e8b\u52a1\u8fd8\u6ca1\u6709 commit \u4e4b\u524d\u4f1a\u5148\u5c06\u5176\u65e5\u5fd7\u5b58\u50a8\u4e8e binlog_cache \u4e2d\uff0c\u7b49\u5230\u4e8b\u52a1 commit \u540e\u4f1a\u5c06\u5176 binlog \u5237\u56de\u78c1\u76d8\u4e0a\u7684 binlog \u6587\u4ef6\u4ee5\u6301\u4e45\u5316\u3002</p> </li> <li> <p>tmp_table</p> <p>\u4e0d\u540c\u4e8e\u4e0a\u9762\u5404\u4e2a session \u5c42\u6b21\u7684 buffer\uff0c\u8fd9\u4e2a\u53c2\u6570\u53ef\u4ee5\u5728\u63a7\u5236\u53f0\u4e0a\u4fee\u6539\u3002\u8be5\u53c2\u6570\u662f\u6307\u7528\u6237\u5185\u5b58\u4e34\u65f6\u8868\u7684\u5927\u5c0f\uff0c\u5982\u679c\u8be5 thread \u521b\u5efa\u7684\u4e34\u65f6\u8868\u8d85\u8fc7\u5b83\u8bbe\u7f6e\u7684\u5927\u5c0f\u4f1a\u628a\u4e34\u65f6\u8868\u8f6c\u6362\u4e3a\u78c1\u76d8\u4e0a\u7684\u4e00\u5f20 MyISAM \u4e34\u65f6\u8868\u3002\u5982\u679c\u7528\u6237\u5728\u6267\u884c\u4e8b\u52a1\u65f6\u9047\u5230\u7c7b\u4f3c\u5982\u4e0b\u8fd9\u6837\u7684\u9519\u8bef\uff0c\u53ef\u4ee5\u8003\u8651\u589e\u5927 tmp_table \u7684\u503c\u3002</p> </li> </ul>"},{"location":"basic/12.MySQL%E5%86%85%E5%AD%98%E6%A6%82%E8%BF%B0/#mysql","title":"MySQL\u5185\u5b58\u5360\u7528\u5206\u6790","text":"<p>\u5728 MySQL \u4f7f\u7528\u8fc7\u7a0b\u4e2d\uff0c\u4f60\u4e00\u5b9a\u51fa\u73b0\u8fc7\u5185\u5b58\u98d9\u5347\u3001OOM\u3001\u5185\u5b58\u957f\u671f\u5904\u4e8e\u9ad8\u4f4d\u7b49\u5185\u5b58\u5f02\u5e38\u73b0\u8c61\u3002\u4e3a\u4e86\u6392\u67e5\u5185\u5b58\u5f02\u5e38\uff0c\u6211\u4eec\u9700\u8981\u5206\u6790\u5185\u5b58\u5360\u7528\u60c5\u51b5\uff0c\u627e\u51fa\u5185\u5b58\u5360\u7528\u5927\u6237\u3002</p>"},{"location":"basic/12.MySQL%E5%86%85%E5%AD%98%E6%A6%82%E8%BF%B0/#_3","title":"\u5185\u5b58\u76d1\u63a7\u8868","text":"<p>\u6211\u4eec\u53ef\u4ee5\u4ece\u4ee5\u4e0b\u51e0\u5f20\u8868\u4e2d\u5206\u6790\u5185\u5b58\uff0c\u6bcf\u5f20\u8868\u5bf9\u5e94\u4e0d\u540c\u7684\u7ef4\u5ea6\uff0c\u6709\u7528\u6237\u7ef4\u5ea6\u3001\u4e3b\u673a\u7ef4\u5ea6\u3001\u8fdb\u7a0b\u7ef4\u5ea6\u3002\u4e3a\u4e86\u6253\u5f00 performance_schema \u529f\u80fd\uff0c\u6211\u4eec\u9700\u8981\u5728 MySQL \u914d\u7f6e\u4e2d\u8bbe\u7f6e performance_schema = ON\u3002</p> <pre><code>SELECT * FROM information_schema.tables WHERE table_schema='performance_schema' AND table_name LIKE '%memory%';\n\n-- performance_schema.memory_summary_by_account_by_event_name\n-- performance_schema.memory_summary_by_host_by_event_name\n-- performance_schema.memory_summary_by_thread_by_event_name\n-- performance_schema.memory_summary_by_user_by_event_name\n-- performance_schema.memory_summary_global_by_event_name\n</code></pre> <pre><code>--\u67e5\u770b MySQL \u603b\u6d88\u8017\u5185\u5b58\nselect * from sys.memory_global_total;\n\n\n\n--\u6839\u636e\u4e8b\u4ef6\uff0c\u67e5\u770b\u5185\u5b58\u603b\u4f53\u5229\u7528\u60c5\u51b5\nselect * from sys.memory_global_by_current_bytes limit 10;\n\n\n\n--\u67e5\u770b\u7ebf\u7a0b\u5185\u5b58\u5360\u7528\u60c5\u51b5\nselect thread_id,event_name,CURRENT_NUMBER_OF_BYTES_USED/1024/1024 from performance_schema.memory_summary_by_thread_by_event_name order by CURRENT_NUMBER_OF_BYTES_USED desc limit 20;\n</code></pre>"},{"location":"basic/13.MySQL%E6%98%AF%E5%A6%82%E4%BD%95%E6%89%93%E5%BC%80%E5%92%8C%E5%85%B3%E9%97%AD%E8%A1%A8/","title":"MySQL\u662f\u5982\u4f55\u6253\u5f00\u548c\u5173\u95ed\u8868\uff1f","text":"<p>\u5f53\u6267\u884c<code>mysqladmin status</code>\u547d\u4ee4\u65f6\uff0c\u5e94\u8be5\u770b\u5230\u7c7b\u4f3c\u4ee5\u4e0b\u7684\u5185\u5bb9\uff1a</p> <pre><code>Uptime: 426 Running threads: 1 Questions: 11082\nReloads: 1 Open tables: 12\n</code></pre> <p>MySQL\u662f\u591a\u7ebf\u7a0b\u7684\uff0c\u56e0\u6b64\u53ef\u80fd\u6709\u8bb8\u591a\u5ba2\u6237\u7aef\u540c\u65f6\u5bf9\u4e00\u4e2a\u7ed9\u5b9a\u8868\u53d1\u51fa\u67e5\u8be2\u3002\u4e3a\u4e86\u6700\u5927\u7a0b\u5ea6\u5730\u51cf\u5c11\u540c\u4e00\u5f20\u8868\u4e0a\u5177\u6709\u4e0d\u540c\u72b6\u6001\u7684\u591a\u4e2a\u5ba2\u6237\u7aef\u4f1a\u8bdd\u7684\u95ee\u9898\uff0c\u6bcf\u4e2a\u5e76\u53d1\u4f1a\u8bdd\u4f1a\u72ec\u7acb\u6253\u5f00\u8be5\u8868\u3002\u8fd9\u4f1a\u989d\u5916\u6d88\u8017\u66f4\u9ad8\u5185\u5b58\uff0c\u4f46\u901a\u5e38\u4f1a\u63d0\u9ad8\u6027\u80fd\u3002</p> <p>https://dev.mysql.com/doc/refman/8.4/en/table-cache.html</p> <p>MySQL\u901a\u8fc7**TABLE\u5bf9\u8c61**\u8fdb\u884c\u8868\u7684\u8bfb\u5199\u7b49\u64cd\u4f5c\uff0c\u5bf9\u4e8e\u6784\u5efaTABLE\u5bf9\u8c61\u6240\u9700\u7684\u8868\u5b9a\u4e49\u76f8\u5173\u4fe1\u606f\uff0cMySQL\u4f1a\u901a\u8fc7Dictionary_client\u4e0eDD\u6a21\u5757\u8fdb\u884c\u4ea4\u4e92\u3002</p> <p>\u5728\u6253\u5f00\u4e00\u4e2a\u8868\u51c6\u5907\u8bbf\u95ee\u6570\u636e\u7684\u65f6\u5019\uff0c\u901a\u5e38\u8981\u5148\u6253\u5f00\u5176\u6570\u636e\u5b57\u5178\uff0c\u5176\u4e2d\u5305\u542b\u4e86\u5b57\u6bb5\u4fe1\u606f\uff0c\u7d22\u5f15\u4fe1\u606f\uff0c\u9ed8\u8ba4\u503c\uff0c\u5b57\u7b26\u96c6\uff0c\u7edf\u8ba1\u6570\u636e\uff0c\u81ea\u589e\u5b57\u6bb5\uff0c\u81ea\u589e\u9501\u7b49\u7b49\u4fe1\u606f\u3002</p> <p>\u5176\u4e2d\u6709\u4e9b\u5728MySQL\u5c42\uff0c\u6709\u4e9b\u5728Innodb\u5c42\uff08\u6bd4\u5982\u7edf\u8ba1\u4fe1\u606f\uff09\uff0c\u53c8\u6bd4\u5982\u5b57\u6bb5\u7c7b\u578b\u5728MySQL\u5c42\u548cInnodb\u5c42\u7684\u8868\u793a\u662f\u4e0d\u540c\u7684\uff0c\u5b9e\u9645\u4e0a\u8fd9\u5305\u542b3\u5c42\u4fe1\u606f\uff1a</p> <ul> <li> <p>table instance:MySQL\u5c42\u76f8\u5173\u7684\u5b57\u5178\u4fe1\u606f\uff0c\u6bcf\u4e2a\u4f1a\u8bdd\u72ec\u5360\u7531<code>table share</code>\u751f\u6210\u800c\u6765\u3002\u5728\u8bed\u53e5\u7ed3\u675f\u7684\u65f6\u5019\u91ca\u653e\uff0c\u8fd9\u91cc\u7684\u91ca\u653e\u5e76\u4e0d\u662f\u771f\u6b63\u7684\u91ca\u653e\uff0c\u53ef\u80fd\u662f\u7f13\u5b58\uff0c\u5176\u7f13\u5b58\u7684\u4e2a\u6570\u548ctable_open_cache\u548ctable_open_cache_instances\u6709\u5173\uff0c\u5176\u7f13\u5b58\u4f4d\u7f6e\u7ea6\u5b9a\u4e3a<code>table cache</code>\uff0c\u5185\u90e8\u4e3aTABLE\u3002</p> </li> <li> <p>table share\uff1aMySQL\u5c42\u76f8\u5173\u5b57\u5178\u7684\u4fe1\u606f\uff0c\u6574\u4e2a\u6570\u636e\u5e93\u53ea\u6709\u4e00\u4efd\uff0c\u6bcf\u4e2a\u8868\u90fd\u5305\u542b\u4e00\u4e2a\u30025.7\u6765\u81eaFRM\u6587\u4ef6\uff0c8.0\u5219\u6765\u81ea\u65b0\u7684SDI\u7f13\u5b58\u76f8\u5173\u5b57\u5178\u4fe1\u606f\u3002\u5f53\u6ca1\u6709table cache\u5f15\u7528\u7684\u65f6\u5019\u4f1a\u8003\u8651\u91ca\u653e\uff0c\u4f46\u662f\u540c\u524d\u9762\u4e00\u6837\uff0c\u91ca\u653e\u53ef\u80fd\u662f\u7f13\u5b58\uff0c\u7f13\u5b58\u7684\u4e2a\u6570\u548c<code>table_definition_cache</code>\u6709\u5173\uff0c\u5176\u7f13\u5b58\u4f4d\u7f6e\u7ea6\u5b9a\u4e3a<code>table def cache</code>\uff0c\u5185\u90e8\u4e3aTABLE_SHARED\u3002</p> </li> <li> <p>dict table\uff1aInnodb\u5c42\u7684\u4fe1\u606f\uff0c\u8fd9\u4e2a\u6570\u636e\u5e93\u53ea\u6709\u4e00\u4efd\uff0c\u6bcf\u4e2a\u8868\u90fd\u5305\u542b\u4e00\u4e2a\uff0c\u5176\u4fe1\u606f\u6765\u81eaInnodb\u7684\u6570\u636e\u5b57\u5178\uff0c\u4e3b\u8981\u662fSYS_TABLES/SYS_COLUMN\u7b49\u51e0\u4e2a\u8868\u3002\u5f53\u6ca1\u6709table cache\u5f15\u7528\u7684\u65f6\u5019\u4f1a\u8003\u8651\u91ca\u653e\uff0c\u540c\u6837\u91ca\u653e\u53ef\u80fd\u662f\u7f13\u5b58\uff0c\u7f13\u5b58\u7684\u4e2a\u6570\u4f9d\u65e7\u548ctable_definition_cache\u6709\u5173\uff0c\u5176\u7f13\u5b58\u4f4d\u7f6e\u7ea6\u5b9a\u4e3adict table cache\uff0c\u5185\u90e8\u4e3adict_table_t</p> </li> </ul>"},{"location":"basic/14.MySQL%E6%95%B0%E6%8D%AE%E5%AD%97%E5%85%B8/","title":"\u6982\u8ff0","text":"<p>\u5728\u5b66\u4e60 MySQL \u6570\u636e\u5b57\u5178\u4e4b\u524d\uff0c\u5148\u4e00\u8d77\u4e86\u89e3\u4e00\u4e0b\u4ec0\u4e48\u662f\u6570\u636e\u5b57\u5178\u548c\u5143\u6570\u636e\uff1a</p> <ul> <li> <p>\u6570\u636e\u5b57\u5178\u5c31\u7c7b\u4f3c\u4e8e\u7cfb\u7edf\u7f16\u76ee\u6216\u82b1\u540d\u518c\uff0c\u5b83\u4fdd\u5b58\u6570\u636e\u5e93\u670d\u52a1\u5668\u4e0a\u7684\u5143\u6570\u636e\u4fe1\u606f\uff08\u6570\u636e\u5e93\u7684\u6574\u4f53\u5c5e\u6027\u4fe1\u606f\uff09\u3002</p> </li> <li> <p>\u5143\u6570\u636e\u4fe1\u606f\u5305\u62ec\uff1a\u6570\u636e\u5e93\u7684\u5c5e\u6027\u4fe1\u606f\u3001\u6570\u636e\u8868\u7684\u5c5e\u6027\u4fe1\u606f\u3001\u5b57\u6bb5\u7684\u5c5e\u6027\u4fe1\u606f\u3001\u89c6\u56fe\u7684\u5c5e\u6027\u4fe1\u606f\u3001\u7528\u6237\u4fe1\u606f\u3001\u7edf\u8ba1\u7c7b\u4fe1\u606f\u7b49\u3002</p> </li> </ul> <p>MySQL\u7684\u5143\u6570\u636e\u5b58\u5728\u5f88\u591a\u79cd\u7c7b\uff0c\u5305\u62ec Schema\uff0cTable\uff0cIndex\uff0cView\uff0cTablespace \u7b49\u7b49\uff0c\u63cf\u8ff0\u4e86\u6570\u636e\u5e93\u4e2d\u5e93\uff0c\u8868\uff0c\u7d22\u5f15\uff0c\u89c6\u56fe\uff0c\u6587\u4ef6\u7b49\u5c5e\u6027\uff0c\u5728 MySQL \u4e2d\u4e5f\u88ab\u79f0\u4e3a\u6570\u636e\u5b57\u5178\uff0c\u6bcf\u79cd\u8d44\u6e90\u90fd\u88ab\u62bd\u8c61\u4e3a DD object\uff0c\u6bcf\u4e2a DD object \u6709\u4e00\u4e2a Object_id \u6807\u8bc6\uff0cMySQL \u5185\u90e8\u5b9e\u73b0\u4e5f\u662f\u4ee5\u7b80\u6d01\u7684\u591a\u6001\u548c\u6a21\u7248\u65b9\u5f0f\u5b9e\u73b0\u7684\u3002</p>"},{"location":"basic/14.MySQL%E6%95%B0%E6%8D%AE%E5%AD%97%E5%85%B8/#_2","title":"\u5143\u6570\u636e\u7269\u7406\u5b58\u50a8","text":"<p>\u5728 <code>MySQL 8.0</code> \u4e4b\u524d\uff0c<code>Server</code> \u5c42\u548c\u5b58\u50a8\u5f15\u64ce\u5c42\u4f1a\u5404\u81ea\u4fdd\u7559\u4e00\u4efd\u5143\u6570\u636e\uff08schema name, table definition \u7b49\uff09\uff0c\u4e0d\u4ec5\u5728\u4fe1\u606f\u5b58\u50a8\u4e0a\u6709\u7740\u91cd\u590d\u5197\u4f59\uff0c\u800c\u4e14\u53ef\u80fd\u5b58\u5728\u4e24\u8005\u4e4b\u95f4\u5b58\u50a8\u7684\u5143\u6570\u636e\u4e0d\u540c\u6b65\u7684\u73b0\u8c61\u3002\u5b57\u5178\u6570\u636e\u5b58\u50a8\u5728\u5143\u6570\u636e\u6587\u4ef6\u3001\u975e\u4e8b\u52a1\u6027\u8868\u548c\u7279\u5b9a\u4e8e\u5b58\u50a8\u5f15\u64ce\u7684\u6570\u636e\u5b57\u5178\u4e2d\u3002</p> <p>\u4ee5\u4e0a\u8bbe\u8ba1\u5bfc\u81f4\u539f\u5b50DDL\u53d8\u5f97\u975e\u5e38\u56f0\u96be\uff0c\u5728 MySQL 8.0\u4e4b\u524d\uff0c\u5982\u679cDDL\u671f\u95f4\u4e2d\u53d1\u751fcrash\uff0c\u540e\u671f\u7684\u6062\u590d\u5f88\u5bb9\u6613\u51fa\u73b0\u5404\u79cd\u95ee\u9898\uff0c\u5bfc\u81f4\u8868\u65e0\u6cd5\u8bbf\u95ee\u3001\u590d\u5236\u5f02\u5e38\u7b49\u3002</p> <p>\u5728MySQL 8.0\u53ca\u66f4\u9ad8\u7248\u672c\u4e2d\uff0c\u5f15\u5165\u4e86\u4e8b\u52a1\u6027\u6570\u636e\u5b57\u5178\uff08Transactional Data Dictionary\uff0c\u7b80\u79f0\u6570\u636e\u5b57\u5178\uff09\u3002\u5b83\u5b8c\u5168\u57fa\u4e8eInnoDB\u5b58\u50a8\u5f15\u64ce\uff0c\u5e76\u4e14\u53d6\u4ee3\u4e86\u65e9\u671f\u7248\u672c\u4e2d\u4f7f\u7528\u7684\u5404\u79cd\u975e\u4e8b\u52a1\u6027\u5143\u6570\u636e\u5b58\u50a8\u65b9\u5f0f\uff08\u5982FRM\u3001TRG\u3001PAR\u7b49\u6587\u4ef6\uff09\u3002\u8fd9\u610f\u5473\u7740\u6240\u6709\u7684\u7cfb\u7edf\u5143\u6570\u636e\uff0c\u5305\u62ec\u8868\u7ed3\u6784\u3001\u5217\u4fe1\u606f\u3001\u7d22\u5f15\u3001\u89e6\u53d1\u5668\u3001\u5b58\u50a8\u8fc7\u7a0b\u548c\u51fd\u6570\u7b49\uff0c\u73b0\u5728\u90fd\u5b58\u50a8\u5728InnoDB\u8868\u4e2d\uff0c\u4ece\u800c\u786e\u4fdd\u4e86\u5143\u6570\u636e\u64cd\u4f5c\uff08\u5982\u521b\u5efa\u8868\u3001\u4fee\u6539\u5217\u7b49\uff09\u7684\u539f\u5b50\u6027\u3001\u4e00\u81f4\u6027\u548c\u9694\u79bb\u6027\u3002</p> <p>DD\u5b9e\u73b0\u4e86<code>Server</code> \u5c42\u548c\u5b58\u50a8\u5f15\u64ce\u5c42\u4e4b\u95f4\u7edf\u4e00\u7684\u5143\u6570\u636e\u7ba1\u7406\uff0c\u8fd9\u4e9b\u5143\u6570\u636e\u90fd\u5b58\u50a8\u5728 <code>InnoDB</code> \u5f15\u64ce\u7684\u8868\u4e2d\uff0c<code>Server</code> \u5c42\u548c\u5f15\u64ce\u5c42\u5171\u4eab\u4e00\u4efd\u5143\u6570\u636e\uff0c\u4e14\u652f\u6301\u539f\u5b50\u6027\u3002</p> <p>\u53c2\u8003\u5b98\u65b9\u535a\u5ba2 https://dev.mysql.com/blog-archive/mysql-8-0-data-dictionary-architecture-and-design/</p> <p>\u8fd9\u79cd\u53d8\u5316\u5e26\u6765\u4e86\u51e0\u4e2a\u663e\u8457\u7684\u597d\u5904\uff1a</p> <ul> <li> <p>\u539f\u5b50\u6027\uff1a\u5bf9\u5143\u6570\u636e\u7684\u6240\u6709\u66f4\u6539\u90fd\u662f\u539f\u5b50\u7684\uff0c\u8981\u4e48\u5168\u90e8\u6210\u529f\uff0c\u8981\u4e48\u5728\u5931\u8d25\u65f6\u5168\u90e8\u56de\u6eda\uff0c\u4ece\u800c\u907f\u514d\u4e86\u5143\u6570\u636e\u7684\u4e0d\u4e00\u81f4\u72b6\u6001\u3002</p> </li> <li> <p>\u4e00\u81f4\u6027\uff1a\u7531\u4e8eInnoDB\u652f\u6301\u4e8b\u52a1\uff0c\u56e0\u6b64\u6570\u636e\u5b57\u5178\u4e2d\u7684\u4fe1\u606f\u59cb\u7ec8\u4fdd\u6301\u4e00\u81f4\uff0c\u5373\u4f7f\u5728\u5e76\u53d1\u4fee\u6539\u7684\u60c5\u51b5\u4e0b\u4e5f\u662f\u5982\u6b64\u3002</p> </li> <li> <p>\u5d29\u6e83\u6062\u590d\uff1a\u5728\u53d1\u751f\u6545\u969c\u540e\uff0cInnoDB\u7684\u6062\u590d\u673a\u5236\u53ef\u4ee5\u786e\u4fdd\u6570\u636e\u5b57\u5178\u7684\u5b8c\u6574\u6027\u3002</p> </li> <li> <p>\u6027\u80fd\uff1aInnoDB\u7684\u7f13\u5b58\u548c\u4e8b\u52a1\u7ba1\u7406\u7279\u6027\u6709\u52a9\u4e8e\u63d0\u9ad8\u5143\u6570\u636e\u64cd\u4f5c\u7684\u6027\u80fd\u3002</p> </li> <li> <p>\u7b80\u5316\u7ba1\u7406\uff1a\u4e0d\u518d\u9700\u8981\u7ef4\u62a4\u591a\u79cd\u4e0d\u540c\u7c7b\u578b\u7684\u5143\u6570\u636e\u6587\u4ef6\u548c\u8868\uff0c\u6240\u6709\u6570\u636e\u5b57\u5178\u4fe1\u606f\u90fd\u96c6\u4e2d\u5b58\u50a8\u5728InnoDB\u8868\u4e2d\uff0c\u7b80\u5316\u4e86\u6570\u636e\u5e93\u7684\u7ba1\u7406\u548c\u5907\u4efd\u3002</p> </li> <li> <p>\u5411\u540e\u517c\u5bb9\u6027\uff1a\u5c3d\u7ba1\u5185\u90e8\u5b9e\u73b0\u53d1\u751f\u4e86\u91cd\u5927\u53d8\u5316\uff0c\u4f46MySQL\u52aa\u529b\u4fdd\u6301\u4e86\u4e0e\u65e9\u671f\u7248\u672c\u7684\u517c\u5bb9\u6027\uff0c\u4ee5\u4fbf\u73b0\u6709\u7684\u5e94\u7528\u7a0b\u5e8f\u548c\u811a\u672c\u80fd\u591f\u7ee7\u7eed\u65e0\u7f1d\u5de5\u4f5c\u3002 </p> </li> </ul> <p>\u8fd9\u4e9b\u5143\u6570\u636e\u5bf9\u5e94\u7684 <code>InnoDB</code>\u5f15\u64ce\u8868\u6211\u4eec\u4e00\u822c\u79f0\u4e3a**\u7cfb\u7edf\u8868**\uff0c\u5176\u8868\u7ed3\u6784\u662f\u56fa\u5b9a\u7684\u76f4\u63a5\u5b9a\u4e49\u5728\u4ee3\u7801\u7c7b\u7ed3\u6784\u4e2d\uff08\u56e0\u6b64\u4e0d\u518d\u9700\u8981\u8bb0\u5f55\u989d\u5916\u7684\u5143\u6570\u636e\uff0c\u8981\u4e0d\u7136\u5c31\u5957\u5a03\u4e86\uff09\uff0c\u5bf9\u5e94\u8868\u6587\u4ef6\u5728\u6574\u4e2a <code>MySQL</code> \u8fdb\u884c\u521d\u59cb\u5316\u65f6\u5c31\u5efa\u7acb\u4e86\uff0c\u6709\u5982 <code>tables</code>\u3001<code>columns</code>\u3001<code>indexes</code>\u3001<code>foreign_keys</code>\u7b49\u7cfb\u7edf\u8868\u3002</p>"},{"location":"basic/14.MySQL%E6%95%B0%E6%8D%AE%E5%AD%97%E5%85%B8/#_3","title":"\u6570\u5b57\u5b57\u5178\u89c6\u56fe","text":"<p>information_schema\u6570\u636e\u5e93\u73b0\u5728\u63d0\u4f9b\u4e86\u4e00\u7ec4\u89c6\u56fe\uff0c\u8fd9\u4e9b\u89c6\u56fe\u4f5c\u4e3a\u8bbf\u95ee\u4e8b\u52a1\u6027\u6570\u636e\u5b57\u5178\u7684\u63a5\u53e3\u3002</p> <p>\u8fd9\u4e9b\u89c6\u56fe\u63d0\u4f9b\u4e86\u5173\u4e8e\u6570\u636e\u5e93\u5bf9\u8c61\u7684\u8be6\u7ec6\u4fe1\u606f\uff0c\u5982\u8868\u3001\u5217\u3001\u7d22\u5f15\u3001\u89e6\u53d1\u5668\u3001\u5b58\u50a8\u8fc7\u7a0b\u548c\u51fd\u6570\u7b49\u3002\u901a\u8fc7\u67e5\u8be2\u8fd9\u4e9b\u89c6\u56fe\uff0c\u7ba1\u7406\u5458\u548c\u5f00\u53d1\u4eba\u5458\u53ef\u4ee5\u83b7\u53d6\u5173\u4e8e\u6570\u636e\u5e93\u7ed3\u6784\u548c\u5c5e\u6027\u7684\u5b9e\u65f6\u4fe1\u606f\uff0c\u800c\u65e0\u9700\u76f4\u63a5\u8bbf\u95ee\u5e95\u5c42\u7684InnoDB\u8868\u3002</p> <p>\u5728MySQL 8\u4e2d\uff0c\u4e8b\u52a1\u6570\u636e\u5b57\u5178\uff08Data Dictionary\uff09\u662f\u4e00\u4e2a\u96c6\u4e2d\u7684\u5143\u6570\u636e\u5b58\u50a8\u7cfb\u7edf\uff0c\u5b83\u5305\u542b\u4e86\u5173\u4e8e\u6570\u636e\u5e93\u5bf9\u8c61\u7684\u5404\u79cd\u4fe1\u606f\u3002\u8fd9\u4e9b\u4fe1\u606f\u88ab\u7ec4\u7ec7\u6210\u4e00\u7cfb\u5217\u7684\u201c\u5b57\u5178\u8868\u201d\uff0c\u4f46\u5b9e\u9645\u4e0a\u8fd9\u4e9b\u5b57\u5178\u8868\u5e76\u4e0d\u76f4\u63a5\u66b4\u9732\u7ed9\u7528\u6237\u3002\u76f8\u53cd\uff0c\u7528\u6237\u901a\u8fc7information_schema\u6570\u636e\u5e93\u4e2d\u7684\u89c6\u56fe\u6765\u8bbf\u95ee\u8fd9\u4e9b\u5b57\u5178\u8868\u7684\u5185\u5bb9\u3002</p> <p>\u4ee5\u4e0b\u662f\u4e00\u4e9b\u4e3b\u8981\u7684information_schema\u89c6\u56fe\uff0c\u5b83\u4eec\u5bf9\u5e94\u4e8e\u4e8b\u52a1\u6570\u636e\u5b57\u5178\u4e2d\u7684\u4e0d\u540c\u90e8\u5206\uff0c\u5e76\u63d0\u4f9b\u4e86\u5173\u4e8e\u6570\u636e\u5e93\u5bf9\u8c61\u7684\u8be6\u7ec6\u4fe1\u606f\uff1a</p> <ul> <li> <p>TABLES (information_schema.TABLES)</p> <ul> <li>\u63d0\u4f9b\u6570\u636e\u5e93\u4e2d\u6240\u6709\u8868\u7684\u4fe1\u606f\u3002</li> <li>\u5305\u62ec\u8868\u540d\u3001\u8868\u7c7b\u578b\uff08BASE TABLE, VIEW\u7b49\uff09\u3001\u521b\u5efa\u65f6\u95f4\u3001\u6700\u540e\u4fee\u6539\u65f6\u95f4\u7b49\u3002</li> </ul> </li> <li> <p>COLUMNS (information_schema.COLUMNS)</p> <ul> <li>\u63d0\u4f9b\u8868\u4e2d\u6240\u6709\u5217\u7684\u4fe1\u606f\u3002</li> <li>\u5305\u62ec\u5217\u540d\u3001\u6570\u636e\u7c7b\u578b\u3001\u5b57\u7b26\u96c6\u3001\u5217\u9ed8\u8ba4\u503c\u3001\u662f\u5426\u53ef\u4e3aNULL\u7b49\u3002</li> </ul> </li> <li> <p>STATISTICS (information_schema.STATISTICS)</p> <ul> <li>\u63d0\u4f9b\u5173\u4e8e\u8868\u7d22\u5f15\u7684\u4fe1\u606f\u3002</li> <li>\u5728MySQL\u4e2d\uff0c\u7d22\u5f15\u548c\u952e\u662f\u540c\u4e00\u4e2a\u6982\u5ff5\uff0c\u56e0\u6b64\u8fd9\u4e2a\u89c6\u56fe\u4e5f\u5305\u542b\u4e86\u4e3b\u952e\u3001\u5916\u952e\u548c\u552f\u4e00\u952e\u7684\u4fe1\u606f\u3002</li> <li>\u5305\u62ec\u7d22\u5f15\u540d\u3001\u5217\u540d\u3001\u7d22\u5f15\u7c7b\u578b\uff08BTREE, HASH\u7b49\uff09\u3001\u662f\u5426\u552f\u4e00\u7b49\u3002</li> </ul> </li> <li> <p>KEY_COLUMN_USAGE (information_schema.KEY_COLUMN_USAGE)</p> <ul> <li>\u63cf\u8ff0\u54ea\u4e9b\u5217\u88ab\u7528\u4f5c\u8868\u7684\u952e\uff08\u4e3b\u952e\u3001\u5916\u952e\u7b49\uff09\u3002</li> <li>\u63d0\u4f9b\u5217\u540d\u3001\u7ea6\u675f\u540d\u3001\u5f15\u7528\u7684\u8868\u7b49\u4fe1\u606f\u3002</li> </ul> </li> <li> <p>ROUTINES (information_schema.ROUTINES)</p> <ul> <li>\u63d0\u4f9b\u5173\u4e8e\u5b58\u50a8\u8fc7\u7a0b\u548c\u51fd\u6570\u7684\u4fe1\u606f\u3002</li> <li>\u5305\u62ec\u4f8b\u7a0b\u540d\u3001\u4f8b\u7a0b\u7c7b\u578b\uff08PROCEDURE, FUNCTION\uff09\u3001\u521b\u5efa\u65f6\u95f4\u3001SQL\u6a21\u5f0f\u7b49\u3002</li> </ul> </li> <li> <p>TRIGGERS (information_schema.TRIGGERS)</p> <ul> <li>\u63d0\u4f9b\u5173\u4e8e\u89e6\u53d1\u5668\u7684\u4fe1\u606f\u3002</li> <li>\u5305\u62ec\u89e6\u53d1\u5668\u540d\u3001\u5173\u8054\u7684\u8868\u3001\u89e6\u53d1\u65f6\u95f4\uff08BEFORE, AFTER\uff09\u3001\u89e6\u53d1\u4e8b\u4ef6\uff08INSERT, UPDATE, DELETE\uff09\u7b49\u3002</li> </ul> </li> <li> <p>REFERENTIAL_CONSTRAINTS (information_schema.REFERENTIAL_CONSTRAINTS)</p> <ul> <li>\u63cf\u8ff0\u5916\u952e\u7ea6\u675f\u3002</li> <li>\u63d0\u4f9b\u7ea6\u675f\u540d\u3001\u7ea6\u675f\u7c7b\u578b\uff08\u901a\u5e38\u662fFOREIGN KEY\uff09\u3001\u6d89\u53ca\u7684\u8868\u7b49\u3002</li> </ul> </li> <li> <p>TABLE_CONSTRAINTS (information_schema.TABLE_CONSTRAINTS)</p> <ul> <li>\u63d0\u4f9b\u5173\u4e8e\u8868\u7ea6\u675f\u7684\u4fe1\u606f\uff0c\u5982\u4e3b\u952e\u3001\u552f\u4e00\u952e\u3001\u68c0\u67e5\u7ea6\u675f\u7b49\u3002</li> <li>\u5305\u62ec\u7ea6\u675f\u540d\u3001\u7ea6\u675f\u7c7b\u578b\u3001\u7ea6\u675f\u72b6\u6001\u7b49\u3002</li> </ul> </li> <li> <p>SCHEMATA (information_schema.SCHEMATA)</p> <ul> <li>\u63d0\u4f9b\u5173\u4e8e\u6570\u636e\u5e93\u4e2d\u6240\u6709\u6a21\u5f0f\uff08\u6570\u636e\u5e93\uff09\u7684\u4fe1\u606f\u3002</li> <li>\u5305\u62ec\u6a21\u5f0f\u540d\u3001\u5b57\u7b26\u96c6\u3001\u6392\u5e8f\u89c4\u5219\u7b49\u3002</li> </ul> </li> <li> <p>VIEWS (information_schema.VIEWS)</p> <ul> <li>\u63d0\u4f9b\u5173\u4e8e\u6570\u636e\u5e93\u4e2d\u6240\u6709\u89c6\u56fe\u7684\u4fe1\u606f\u3002</li> <li>\u5305\u62ec\u89c6\u56fe\u540d\u3001\u89c6\u56fe\u5b9a\u4e49\u3001\u5b89\u5168\u7c7b\u578b\uff08DEFINER, INVOKER\uff09\u7b49\u3002</li> </ul> </li> <li> <p>PARTITIONS (information_schema.PARTITIONS)</p> <ul> <li>\u5982\u679c\u8868\u88ab\u5206\u533a\uff0c\u8fd9\u4e2a\u89c6\u56fe\u63d0\u4f9b\u5173\u4e8e\u6bcf\u4e2a\u5206\u533a\u7684\u8be6\u7ec6\u4fe1\u606f\u3002</li> <li>\u5305\u62ec\u5206\u533a\u540d\u3001\u5206\u533a\u65b9\u6cd5\uff08RANGE, LIST, HASH\u7b49\uff09\u3001\u5206\u533a\u8868\u8fbe\u5f0f\u7b49\u3002</li> </ul> </li> </ul>"},{"location":"basic/14.MySQL%E6%95%B0%E6%8D%AE%E5%AD%97%E5%85%B8/#sdi","title":"\u6570\u636e\u5b57\u5178SDI\u4fe1\u606f","text":"<p>\u9664\u4e86\u5c06\u6570\u636e\u5e93\u5bf9\u8c61\u7684\u5143\u6570\u636e\u5b58\u50a8\u5728\u6570\u636e\u76ee\u5f55\u4e2d\uff0cMySQL\u8fd8\u652f\u6301\u4ee5\u5e8f\u5217\u5316\u7684\u683c\u5f0f\u8fdb\u884c\u5b58\u50a8\u3002\u5373\u5e8f\u5217\u5316\u6570\u636e\u76ee\u5f55\u4fe1\u606f(SDI)\uff0cSDI\u662f\u8868\u548c\u8868\u7a7a\u95f4\u5bf9\u8c61\u7684\u5e8f\u5217\u5316\u5143\u6570\u636e\u3002 innodb\u5c06SDI\u6570\u636e\u5b58\u50a8\u5728\u81ea\u5df1\u7684\u8868\u7a7a\u95f4\u4e2d\uff1b</p> <p>SDI\u6570\u636e\u5b58\u5728\u4e8einnodb\u7684\u6240\u6709\u8868\u7a7a\u95f4\u4e2d\uff0c\u4e34\u65f6\u8868\u7a7a\u95f4\u548cundo\u8868\u7a7a\u95f4\u9664\u5916\u3002\u8868\u7a7a\u95f4\u4e2d\u7684SDI\u8bb0\u5f55\u53ea\u662f\u7528\u6765\u63cf\u8ff0\u8868\u7a7a\u95f4\u4e2d\u7684\u8868\u548c\u8868\u7a7a\u95f4\u5bf9\u8c61\u3002</p> <p>SDI\u6570\u636e\u8ddf\u7740DDL\u64cd\u4f5c\u6216<code>CHECK TABLE FOR UPGRADE</code>\u64cd\u4f5c\u66f4\u65b0\u3002\u5347\u7ea7MySQL Server\u5230\u65b0\u7684\u7248\u672c\u4e0d\u4f1a\u66f4\u65b0SDI\u6570\u636e\u3002</p> <p>SDI\u6570\u636e\u7684\u5b58\u5728\u63d0\u4f9b\u4e86\u5143\u6570\u636e\u5197\u4f59\u3002\u4f8b\u5982\uff0c\u5982\u679c\u6570\u636e\u5b57\u5178\u4e0d\u53ef\u7528\uff0c\u53ef\u4ee5\u4ece\u8868\u7a7a\u95f4\u6587\u4ef6\u4e2d\u63d0\u53d6\u5b57\u5178\u5bf9\u8c61\u5143\u6570\u636e\u3002\u53ef\u4ee5\u4f7f\u7528\u5de5\u5177ibd2sdi\u76f4\u63a5\u4eceinnodb\u7684\u8868\u7a7a\u95f4\u6587\u4ef6\u4e2d\u62bd\u53d6\u51fa\u5143\u6570\u636e\u4fe1\u606f\u3002</p>"},{"location":"basic/14.MySQL%E6%95%B0%E6%8D%AE%E5%AD%97%E5%85%B8/#_4","title":"\u6570\u636e\u5b57\u5178\u5185\u90e8","text":"<p>\u524d\u9762\u8bb2\u5230\uff0c\u8fd9\u4e9b\u6570\u636e\u5b57\u5178\u662f\u901a\u8fc7<code>information_schema</code>\u4e2d\u7684\u5404\u79cd\u6765\u5bf9\u5916\u66b4\u9732\u67e5\u8be2\u63a5\u53e3\uff0c\u5176\u5b9e\u8fd9\u4e9b\u6570\u636e\u5b57\u5178\uff0c\u6bcf\u79cd\u8d44\u6e90\u90fd\u88ab\u62bd\u8c61\u4e3a DD object\uff0c\u6bcf\u4e2a DD object \u6709\u4e00\u4e2a Object_id \u6807\u8bc6\uff0cMySQL \u5185\u90e8\u5b9e\u73b0\u4e5f\u662f\u4ee5\u7b80\u6d01\u7684\u591a\u6001\u548c\u6a21\u7248\u65b9\u5f0f\u5b9e\u73b0\u7684\u3002</p> <p>\u901a\u8fc7\u5c06\u6240\u6709DD\u6570\u636e\u552f\u4e00\u5730\u6301\u4e45\u5316\u5230InnoDB\u5b58\u50a8\u5f15\u64ce\u7684<code>DD tables</code>\uff0c\u5b9e\u73b0\u4e86DD\u7684\u7edf\u4e00\u7ba1\u7406\u3002\u4e3a\u4e86\u907f\u514d\u6bcf\u6b21\u8bbf\u95eeDD\u90fd\u53bb\u5b58\u50a8\u4e2d\u8bfb\u53d6\u6570\u636e\uff0c\u4f7fDD\u5185\u5b58\u5bf9\u8c61\u80fd\u591f\u590d\u7528\uff0cDD\u5b9e\u73b0\u4e86\u4e24\u7ea7\u7f13\u5b58\u7684\u67b6\u6784\uff0c\u8fd9\u6837\u5728\u6bcf\u4e2a\u7ebf\u7a0b\u4f7f\u7528DD client\u8bbf\u95eeDD\u65f6\u53ef\u4ee5\u901a\u8fc7\u4e24\u7ea7\u7f13\u5b58\u6765\u52a0\u901f\u5bf9DD\u7684\u5185\u5b58\u8bbf\u95ee\u3002</p> <p>MySQL\u9884\u7559\u4e86\u591a\u5f20\u7cfb\u7edf\u7684 DD \u8868\u6765\u6301\u4e45\u5316\u548c\u6784\u5efa <code>DD object</code> \u4fe1\u606f\uff0c\u5728 MySQL 8.0\uff0c\u8fd9\u4e9b\u7cfb\u7edf\u7684 DD \u8868\u5b58\u50a8 Innodb \u5f15\u64ce\u7684\u5171\u4eab DD \u7cfb\u7edf\u8868\u7a7a\u95f4 (mysql.ibd) \u4e2d\uff0c\u662f\u5728 MySQL \u521d\u59cb\u5316\u6570\u636e\u76ee\u5f55\u5c31\u6784\u5efa\u597d\u7684\uff0c\u8fd9\u4e9b\u7cfb\u7edf DD \u8868\u5728 debug \u6a21\u5f0f\u4e0b\u53ef\u4ee5\u50cf\u6b63\u5e38\u7528\u6237\u8868\u4e00\u6837\u8bbf\u95ee\uff0c\u5982 tables\uff0ccolumns, indexes \u7b49\u8868\u3002</p> <p>\u6570\u636e\u5b57\u5178\u8868\u662f\u53d7\u4fdd\u62a4\u7684\uff0c\u53ea\u6709\u5728 MySQL \u7684 debug \u7248\u672c\u4e2d\u624d\u80fd\u8bbf\u95ee\u3002\u7f16\u8bd1 debug \u7248\u672c\u53c2\u8003\uff1a Compiling MySQL for Debugging</p> <p>Data Dictionary Table\u662f\u7cfb\u7edf\u7684\u6839\u672c\uff0c\u540c\u65f6\u6570\u636e\u4e5f\u975e\u5e38\u654f\u611f\uff0c\u5fc5\u987b\u4fdd\u62a4\u8fd9\u4e9b\u8868\u4e0d\u53d7DDL\u7684\u5f71\u54cd\uff0c\u540c\u65f6\u4e0d\u53d7\u4eba\u4e3a\u7684\u66f4\u6539\u3002\u4e0d\u4e86\u89e3\u5e95\u5c42\u5b9e\u73b0\u539f\u7406\u4e0b\uff0c\u4e00\u65e6\u66f4\u6539\u90a3\u5c31\u662f\u707e\u96be\u6027\u7684\uff0c\u6240\u4ee5\u5e94\u8be5\u4fdd\u6301\u9690\u85cf\u3002\u5f3a\u70c8\u4e0d\u5efa\u8bae\u76f4\u63a5\u4fee\u6539\u6216\u5199\u5165\u6570\u636e\u5b57\u5178\u8868\uff0c\u8fd9\u53ef\u80fd\u4f1a\u5bfc\u81f4\u60a8\u7684 MySQL \u5b9e\u4f8b\u65e0\u6cd5\u8fd0\u884c\u3002</p>"},{"location":"basic/14.MySQL%E6%95%B0%E6%8D%AE%E5%AD%97%E5%85%B8/#dd","title":"DD\u5185\u90e8\u6570\u636e\u7ed3\u6784","text":"<p>\u6570\u636e\u5b57\u5178\u7684\u4ee3\u7801\u4f4d\u4e8e<code>sql/dd</code>\u76ee\u5f55\uff0c\u6240\u6709\u6570\u636e\u5b57\u5178\u76f8\u5173\u7684\u4fe1\u606f\u90fd\u5728dd\u8fd9\u4e2a\u547d\u540d\u7a7a\u95f4\u4e2d\uff0c\u5404\u6570\u636e\u5b57\u5178\u8868\u672c\u8eab\u7684\u5b9a\u4e49\u4f4d\u4e8e<code>ql/dd/impl/tables</code>\u76ee\u5f55\u7684\u4ee3\u7801\u4e2d\uff0c\u53ef\u4ee5\u7406\u89e3\u4e3a\u6570\u636e\u5b57\u5178\u8868\u7684\u5143\u6570\u636e\u5728\u4ee3\u7801\u4e2d\u5df2\u7ecf\u5b9a\u4e49\u597d\u4e86\u3002\u6240\u6709\u7684\u6570\u636e\u5b57\u5178\u8868\u5bf9\u5e94\u7684\u7c7b\uff0c\u6700\u7ec8\u90fd\u662f\u6d3e\u751f\u81eadd::Object_table\uff0c\u4fbf\u4e8e\u7edf\u4e00\u5904\u7406\u3002</p> <p>https://dev.mysql.com/doc/dev/mysql-server/latest/classdd_1_1Object__table.html</p> <p>https://dev.mysql.com/doc/dev/mysql-server/latest/object__table_8h_source.html</p> <p>MySQL8\u5728\u521d\u59cb\u5316\u548c\u542f\u52a8\u65f6\uff0c\u4f1a\u4f7f\u7528<code>Object_table_definition_impl::get_ddl()</code>\u51fd\u6570\u6765\u83b7\u53d6<code>m_target_def</code>\u4e2d\u4fe1\u606f\u6240\u751f\u6210\u7684DDL\u8bed\u53e5\uff0c\u521b\u5efa\u51faschemata\u8868\uff1b\u4f7f\u7528Object_table_definition_impl::get_dml()\u83b7\u53d6DML\u8bed\u53e5\uff0c\u7528\u4e8e\u521d\u59cb\u5316\u8868\u4e2d\u7684\u6570\u636e</p> <p>dd::tables::Schemata\u7c7b\u7684\u7ee7\u627f\u5173\u7cfb\uff0c\u5982\u56fe3\u3002\u6240\u6709\u7684\u6570\u636e\u5b57\u5178\u8868\u5bf9\u5e94\u7684\u7c7b\uff0c\u6700\u7ec8\u90fd\u662f\u6d3e\u751f\u81eadd::Object_table\uff0c\u4fbf\u4e8e\u7edf\u4e00\u5904\u7406\u3002</p> <p><code>data dictionary</code>\u63d0\u4f9b\u4e86\u7edf\u4e00\u7684<code>client API</code>\u4f9b Server \u5c42\u548c\u5f15\u64ce\u5c42\u4f7f\u7528\uff0c\u5305\u542b\u5bf9\u5143\u6570\u636e\u8bbf\u95ee\u7684 acquire() / drop() / store() / update() \u57fa\u672c\u64cd\u4f5c\u3002</p>"},{"location":"basic/14.MySQL%E6%95%B0%E6%8D%AE%E5%AD%97%E5%85%B8/#dd_1","title":"DD\u6570\u636e\u8bbf\u95ee","text":"<p>\"\u4e24\u7ea7\u7f13\u5b58+\u6301\u4e45\u5316\"\u7ed3\u6784\uff0c\u6574\u4e2aMySQL 8.0\u7684\u6570\u636e\u5b57\u5178\u5b9e\u73b0\u5728\u6570\u636e\u5b57\u5178\u5bf9\u8c61\u5206\u5e03\u4e0a\u5448\u73b0\u8fd9\u79cd\u4e09\u7ea7\u5b58\u50a8\u7684\u65b9\u5f0f\u3002</p> <p>\u6bcf\u4e2aSQL\u8fde\u63a5\u4e2d\u7684\u5de5\u4f5c\u7ebf\u7a0b\u9700\u8981\u8bbf\u95eeDD\u65f6\u90fd\u4f1a\u901a\u8fc7\u5efa\u7acb\u4e00\u4e2a<code>DD client</code>\uff08DD\u7cfb\u7edf\u63d0\u4f9b\u7684\u4e00\u5957\u901a\u7528\u7684DD\u8bbf\u95ee\u63a5\u53e3\uff09\u6765\u8bbf\u95eeDD\uff0c\u5177\u4f53\u6d41\u7a0b\u4e3a**\u901a\u8fc7\u4e0e\u7ebf\u7a0bTHD\u7ed1\u5b9a\u7684\u7c7b<code>Dictionary_client</code>\uff0c\u6765\u4f9d\u6b21\u8bbf\u95ee\u4e00\u7ea7\u7f13\u5b58\u548c\u4e8c\u7ea7\u7f13\u5b58\uff0c\u5982\u679c\u4e24\u7ea7\u7f13\u5b58\u4e2d\u90fd\u6ca1\u6709\u8981\u8bbf\u95ee\u7684DD\u5bf9\u8c61\uff0c\u5219\u4f1a\u76f4\u63a5\u53bb\u5b58\u50a8\u5728InnoDB\u7684DD tables\u4e2d\u53bb\u8bfb\u53d6**\u3002</p> <p>DD\u5bf9\u8c61\u5b9a\u4e49\u7684\u6838\u5fc3\u4ee3\u7801\u5728<code>dd/cache/object_registry.h.h</code>\u4e2d\uff0c\u6bcf\u4e2a <code>Object_registry</code>\u7531\u4e0d\u540c\u5143\u6570\u636e\u7c7b\u578b\u7684 <code>Local_multi_map</code> \u7ec4\u6210\uff0c\u7528\u4e8e\u7ba1\u7406\u4e0d\u540c\u7c7b\u578b\u7684\u5bf9\u8c61\u5b57\u5178\u5f97\uff08\u6bd4\u5982\u8868\u3001schema\u3001\u5b57\u7b26\u96c6\u3001\u7edf\u8ba1\u6570\u636e\u3001Event \u7b49\uff09\u7f13\u5b58\u3002</p> <p>Dictionary_client\u7684\u6838\u5fc3\u4ee3\u7801\u5728<code>dd/cache/dictionary_client.h</code>\u4e2d\uff0cDictionary_client\u505a\u4e3aTHD\u7684\u6210\u5458\uff0c\u88abServer\u5c42\u7684\u4ee3\u7801\u6765\u4f7f\u7528\u8bbf\u95eeDD\u3002</p> <p>\u5e95\u5c42\u5b9e\u73b0\u4e86\u5bf9 InnoDB \u5f15\u64ce\u5b58\u653e\u7684\u6570\u636e\u5b57\u5178\u8868\u7684\u8bfb\u5199\u64cd\u4f5c\uff0c\u5305\u542b\u5f00\u8868(open table)\u3001\u6784\u9020\u4e3b\u952e\u3001\u4e3b\u952e\u67e5\u627e\u7b49\u8fc7\u7a0b\u3002client \u548c\u5e95\u5c42\u5b58\u50a8\u4e4b\u95f4\u901a\u8fc7**\u4e24\u7ea7\u7f13\u5b58**\u6765\u52a0\u901f\u5bf9\u5143\u6570\u636e\u5bf9\u8c61\u7684\u5185\u5b58\u8bbf\u95ee\uff0c\u4e24\u7ea7\u7f13\u5b58\u90fd\u662f\u57fa\u4e8e hash map \u5b9e\u73b0\u7684\uff1a</p> <ul> <li> <p>\u4e00\u5c42\u7f13\u5b58\u662f local \u7684\uff0c\u7531\u6bcf\u4e2a client\uff08\u6bcf\u4e2a\u8fde\u63a5\u7ebf\u7a0b\u5bf9\u5e94\u4e00\u4e2a client\uff09\u72ec\u4eab\uff0c\u7528\u4e8e\u52a0\u901f\u5728\u5f53\u524d\u7ebf\u7a0b\u4e2d\u5bf9\u4e8e\u76f8\u540c\u5bf9\u8c61\u7684\u91cd\u590d\u8bbf\u95ee\uff1b</p> </li> <li> <p>\u4e8c\u7ea7\u7f13\u5b58\u662f\u5168\u5c40 share \u7684\uff0c\u4e3a\u6240\u6709\u7ebf\u7a0b\u5171\u4eab\u7684\u5168\u5c40\u7f13\u5b58(\u591a\u7ebf\u7a0b\u5171\u4eab\u7684\u7f13\u5b58)\u3002</p> </li> </ul> <pre><code>class Dictionary_client {\n public:\n\n  class Auto_releaser {\n\n  };\n}\n</code></pre>"},{"location":"basic/14.MySQL%E6%95%B0%E6%8D%AE%E5%AD%97%E5%85%B8/#_5","title":"\u7f13\u5b58\u8bfb\u53d6\u8fc7\u7a0b","text":"<p>DD\u5bf9\u8c61\u4e3b\u8981\u6709\u4e24\u79cd\u8bbf\u95ee\u65b9\u5f0f\uff0c\u5373\u901a\u8fc7\u5143\u6570\u636e\u7684id\uff0c\u6216\u8005name\u6765\u8bbf\u95ee\u3002\u9700\u8981\u8bbf\u95eeDD\u7684\u6570\u636e\u5e93\u5de5\u4f5c\u7ebf\u7a0b\u901a\u8fc7<code>DD client</code>\uff0c\u4f20\u5165\u5143\u6570\u636e\u7684id\uff0cname\u7b49key\u53bb\u7f13\u5b58\u4e2d\u8bfb\u53d6\u5143\u6570\u636e\u5bf9\u8c61\u3002\u8bfb\u53d6\u7684\u6574\u4f53\u8fc7\u7a0b\uff1a\u4e00\u7ea7\u672c\u5730\u7f13\u5b58 -&gt; \u4e8c\u7ea7\u5171\u4eab\u7f13\u5b58 -&gt; \u5b58\u50a8\u5f15\u64ce\u3002\u6d41\u7a0b\u56fe\u5982\u4e0b\uff1a</p> <p>\u4f7f\u7528\u8c03\u8bd5\u652f\u6301\u7f16\u8bd1 MySQL \u540e\uff0c\u4f7f\u7528\u6b64 SET \u8bed\u53e5\u4f7f\u6570\u636e\u5b57\u5178\u8868\u5bf9mysql\u5ba2\u6237\u7aef\u4f1a\u8bdd\u53ef\u89c1\uff1a</p> <pre><code># \u8bbe\u7f6e\u4f1a\u8bdd\u5c5e\u6027\nmysql&gt; SET SESSION debug='+d,skip_dd_table_access_check';\n\n# \u4f7f\u7528\u6b64\u67e5\u8be2\u68c0\u7d22\u6570\u636e\u5b57\u5178\u8868\nmysql&gt; SELECT name, schema_id, hidden, type FROM mysql.tables where schema_id=1 AND hidden='System';\n\n\n# \u7528\u4e8e SHOW CREATE TABLE \u67e5\u770b\u6570\u636e\u5b57\u5178\u8868\u5b9a\u4e49\nmysql&gt; SHOW CREATE TABLE mysql.catalogs\n</code></pre> <pre><code> SELECT count(*)  FROM information_schema.innodb_tables;                        -- 34 \n SELECT count(*)  FROM information_schema.tables;                               -- 328\n SELECT count(*)  FROM mysql.tables;                                            -- 361\n SELECT count(*)  FROM mysql.tables  where schema_id=1 AND hidden='System';     -- 32\u5f20\u5185\u90e8\u8868\n\n    SELECT CONVERT( properties USING utf8mb4) as properties FROM mysql.dd_properties;\n\n\nmysql&gt; \nmysql&gt; SELECT id, name,schema_id , engine ,mysql_version_id , comment , hidden  FROM mysql.tables  where schema_id=1 AND hidden='System';\n+----+------------------------------+-----------+--------+------------------+---------+--------+\n| id | name                         | schema_id | engine | mysql_version_id | comment | hidden |\n+----+------------------------------+-----------+--------+------------------+---------+--------+\n|  6 | catalogs                     |         1 | InnoDB |            80039 |         | System |\n|  7 | character_sets               |         1 | InnoDB |            80039 |         | System |\n|  8 | check_constraints            |         1 | InnoDB |            80039 |         | System |\n|  9 | collations                   |         1 | InnoDB |            80039 |         | System |\n| 10 | column_statistics            |         1 | InnoDB |            80039 |         | System |\n| 11 | column_type_elements         |         1 | InnoDB |            80039 |         | System |\n| 12 | columns                      |         1 | InnoDB |            80039 |         | System |\n|  1 | dd_properties                |         1 | InnoDB |            80039 |         | System |\n| 13 | events                       |         1 | InnoDB |            80039 |         | System |\n| 14 | foreign_key_column_usage     |         1 | InnoDB |            80039 |         | System |\n| 15 | foreign_keys                 |         1 | InnoDB |            80039 |         | System |\n| 16 | index_column_usage           |         1 | InnoDB |            80039 |         | System |\n| 17 | index_partitions             |         1 | InnoDB |            80039 |         | System |\n| 18 | index_stats                  |         1 | InnoDB |            80039 |         | System |\n| 19 | indexes                      |         1 | InnoDB |            80039 |         | System |\n|  5 | innodb_ddl_log               |         1 | InnoDB |            80039 |         | System |\n|  2 | innodb_dynamic_metadata      |         1 | InnoDB |            80039 |         | System |\n| 20 | parameter_type_elements      |         1 | InnoDB |            80039 |         | System |\n| 21 | parameters                   |         1 | InnoDB |            80039 |         | System |\n| 22 | resource_groups              |         1 | InnoDB |            80039 |         | System |\n| 23 | routines                     |         1 | InnoDB |            80039 |         | System |\n| 24 | schemata                     |         1 | InnoDB |            80039 |         | System |\n| 25 | st_spatial_reference_systems |         1 | InnoDB |            80039 |         | System |\n| 26 | table_partition_values       |         1 | InnoDB |            80039 |         | System |\n| 27 | table_partitions             |         1 | InnoDB |            80039 |         | System |\n| 28 | table_stats                  |         1 | InnoDB |            80039 |         | System |\n| 29 | tables                       |         1 | InnoDB |            80039 |         | System |\n| 30 | tablespace_files             |         1 | InnoDB |            80039 |         | System |\n| 31 | tablespaces                  |         1 | InnoDB |            80039 |         | System |\n| 32 | triggers                     |         1 | InnoDB |            80039 |         | System |\n| 33 | view_routine_usage           |         1 | InnoDB |            80039 |         | System |\n| 34 | view_table_usage             |         1 | InnoDB |            80039 |         | System |\n+----+------------------------------+-----------+--------+------------------+---------+--------+\n32 rows in set (0.01 sec)\n\nmysql&gt; \n</code></pre> <pre><code>mysql&gt; select table_name  from information_schema.tables where table_schema='mysql' ; \n+------------------------------------------------------+\n| TABLE_NAME                                           |\n+------------------------------------------------------+\n| columns_priv                                         |\n| component                                            |\n| db                                                   |\n| default_roles                                        |\n| engine_cost                                          |\n| func                                                 |\n| general_log                                          |\n| global_grants                                        |\n| gtid_executed                                        |\n| help_category                                        |\n| help_keyword                                         |\n| help_relation                                        |\n| help_topic                                           |\n| innodb_index_stats                                   |\n| innodb_table_stats                                   |\n| password_history                                     |\n| plugin                                               |\n| procs_priv                                           |\n| proxies_priv                                         |\n| replication_asynchronous_connection_failover         |\n| replication_asynchronous_connection_failover_managed |\n| replication_group_configuration_version              |\n| replication_group_member_actions                     |\n| role_edges                                           |\n| server_cost                                          |\n| servers                                              |\n| slave_master_info                                    |\n| slave_relay_log_info                                 |\n| slave_worker_info                                    |\n| slow_log                                             |\n| tables_priv                                          |\n| time_zone                                            |\n| time_zone_leap_second                                |\n| time_zone_name                                       |\n| time_zone_transition                                 |\n| time_zone_transition_type                            |\n| user                                                 |\n+------------------------------------------------------+\n37 rows in set (0.02 sec)\n\nmysql&gt; \n</code></pre> <pre><code>CREATE TABLE `mysql`.`tables` (\n  `id` bigint unsigned NOT NULL AUTO_INCREMENT,\n  `schema_id` bigint unsigned NOT NULL,\n  `name` varchar(64) CHARACTER SET utf8mb3 COLLATE utf8mb3_bin NOT NULL,\n  `type` enum('BASE TABLE','VIEW','SYSTEM VIEW') COLLATE utf8mb3_bin NOT NULL,\n  `engine` varchar(64) CHARACTER SET utf8mb3 COLLATE utf8mb3_general_ci NOT NULL,\n  `mysql_version_id` int unsigned NOT NULL,\n  `row_format` enum('Fixed','Dynamic','Compressed','Redundant','Compact','Paged') COLLATE utf8mb3_bin DEFAULT NULL,\n  `collation_id` bigint unsigned DEFAULT NULL,\n  `comment` varchar(2048) COLLATE utf8mb3_bin NOT NULL,\n  `hidden` enum('Visible','System','SE','DDL') COLLATE utf8mb3_bin NOT NULL,\n  `options` mediumtext COLLATE utf8mb3_bin,\n  `se_private_data` mediumtext COLLATE utf8mb3_bin,\n  `se_private_id` bigint unsigned DEFAULT NULL,\n  `tablespace_id` bigint unsigned DEFAULT NULL,\n  `partition_type` enum('HASH','KEY_51','KEY_55','LINEAR_HASH','LINEAR_KEY_51','LINEAR_KEY_55','RANGE','LIST','RANGE_COLUMNS','LIST_COLUMNS','AUTO','AUTO_LINEAR') COLLATE utf8mb3_bin DEFAULT NULL,\n  `partition_expression` varchar(2048) COLLATE utf8mb3_bin DEFAULT NULL,\n  `partition_expression_utf8` varchar(2048) COLLATE utf8mb3_bin DEFAULT NULL,\n  `default_partitioning` enum('NO','YES','NUMBER') COLLATE utf8mb3_bin DEFAULT NULL,\n  `subpartition_type` enum('HASH','KEY_51','KEY_55','LINEAR_HASH','LINEAR_KEY_51','LINEAR_KEY_55') COLLATE utf8mb3_bin DEFAULT NULL,\n  `subpartition_expression` varchar(2048) COLLATE utf8mb3_bin DEFAULT NULL,\n  `subpartition_expression_utf8` varchar(2048) COLLATE utf8mb3_bin DEFAULT NULL,\n  `default_subpartitioning` enum('NO','YES','NUMBER') COLLATE utf8mb3_bin DEFAULT NULL,\n  `created` timestamp NOT NULL,\n  `last_altered` timestamp NOT NULL,\n  `view_definition` longblob,\n  `view_definition_utf8` longtext COLLATE utf8mb3_bin,\n  `view_check_option` enum('NONE','LOCAL','CASCADED') COLLATE utf8mb3_bin DEFAULT NULL,\n  `view_is_updatable` enum('NO','YES') COLLATE utf8mb3_bin DEFAULT NULL,\n  `view_algorithm` enum('UNDEFINED','TEMPTABLE','MERGE') COLLATE utf8mb3_bin DEFAULT NULL,\n  `view_security_type` enum('DEFAULT','INVOKER','DEFINER') COLLATE utf8mb3_bin DEFAULT NULL,\n  `view_definer` varchar(288) COLLATE utf8mb3_bin DEFAULT NULL,\n  `view_client_collation_id` bigint unsigned DEFAULT NULL,\n  `view_connection_collation_id` bigint unsigned DEFAULT NULL,\n  `view_column_names` longtext COLLATE utf8mb3_bin,\n  `last_checked_for_upgrade_version_id` int unsigned NOT NULL,\n  `engine_attribute` json DEFAULT NULL,\n  `secondary_engine_attribute` json DEFAULT NULL,\n  PRIMARY KEY (`id`),\n  UNIQUE KEY `schema_id` (`schema_id`,`name`),\n  UNIQUE KEY `engine` (`engine`,`se_private_id`),\n  KEY `engine_2` (`engine`),\n  KEY `collation_id` (`collation_id`),\n  KEY `tablespace_id` (`tablespace_id`),\n  KEY `type` (`type`),\n  KEY `view_client_collation_id` (`view_client_collation_id`),\n  KEY `view_connection_collation_id` (`view_connection_collation_id`),\n  KEY `type_2` (`type`,`view_definer`),\n  CONSTRAINT `tables_ibfk_1` FOREIGN KEY (`schema_id`) REFERENCES `schemata` (`id`),\n  CONSTRAINT `tables_ibfk_2` FOREIGN KEY (`collation_id`) REFERENCES `collations` (`id`),\n  CONSTRAINT `tables_ibfk_3` FOREIGN KEY (`tablespace_id`) REFERENCES `tablespaces` (`id`),\n  CONSTRAINT `tables_ibfk_4` FOREIGN KEY (`view_client_collation_id`) REFERENCES `collations` (`id`),\n  CONSTRAINT `tables_ibfk_5` FOREIGN KEY (`view_connection_collation_id`) REFERENCES `collations` (`id`)\n) /*!50100 TABLESPACE `mysql` */ ENGINE=InnoDB AUTO_INCREMENT=363 DEFAULT CHARSET=utf8mb3 COLLATE=utf8mb3_bin STATS_PERSISTENT=0 ROW_FORMAT=DYNAMIC \n</code></pre> <pre><code>ysql&gt; SELECT name, schema_id, hidden, type FROM mysql.tables; \n+------------------------------------------------------+-----------+---------+-------------+\n| name                                                 | schema_id | hidden  | type        |\n+------------------------------------------------------+-----------+---------+-------------+\n| dd_properties                                        |         1 | System  | BASE TABLE  |\n| innodb_dynamic_metadata                              |         1 | System  | BASE TABLE  |\n| innodb_table_stats                                   |         1 | Visible | BASE TABLE  |\n| innodb_index_stats                                   |         1 | Visible | BASE TABLE  |\n| innodb_ddl_log                                       |         1 | System  | BASE TABLE  |\n| catalogs                                             |         1 | System  | BASE TABLE  |\n| character_sets                                       |         1 | System  | BASE TABLE  |\n| check_constraints                                    |         1 | System  | BASE TABLE  |\n| collations                                           |         1 | System  | BASE TABLE  |\n| column_statistics                                    |         1 | System  | BASE TABLE  |\n| column_type_elements                                 |         1 | System  | BASE TABLE  |\n| columns                                              |         1 | System  | BASE TABLE  |\n| events                                               |         1 | System  | BASE TABLE  |\n| foreign_key_column_usage                             |         1 | System  | BASE TABLE  |\n| foreign_keys                                         |         1 | System  | BASE TABLE  |\n| index_column_usage                                   |         1 | System  | BASE TABLE  |\n| index_partitions                                     |         1 | System  | BASE TABLE  |\n| index_stats                                          |         1 | System  | BASE TABLE  |\n| indexes                                              |         1 | System  | BASE TABLE  |\n| parameter_type_elements                              |         1 | System  | BASE TABLE  |\n| parameters                                           |         1 | System  | BASE TABLE  |\n| resource_groups                                      |         1 | System  | BASE TABLE  |\n| routines                                             |         1 | System  | BASE TABLE  |\n| schemata                                             |         1 | System  | BASE TABLE  |\n| st_spatial_reference_systems                         |         1 | System  | BASE TABLE  |\n| table_partition_values                               |         1 | System  | BASE TABLE  |\n| table_partitions                                     |         1 | System  | BASE TABLE  |\n| table_stats                                          |         1 | System  | BASE TABLE  |\n| tables                                               |         1 | System  | BASE TABLE  |\n| tablespace_files                                     |         1 | System  | BASE TABLE  |\n| tablespaces                                          |         1 | System  | BASE TABLE  |\n| triggers                                             |         1 | System  | BASE TABLE  |\n| view_routine_usage                                   |         1 | System  | BASE TABLE  |\n| view_table_usage                                     |         1 | System  | BASE TABLE  |\n| CHARACTER_SETS                                       |         2 | Visible | SYSTEM VIEW |\n| CHECK_CONSTRAINTS                                    |         2 | Visible | SYSTEM VIEW |\n| COLLATIONS                                           |         2 | Visible | SYSTEM VIEW |\n| COLLATION_CHARACTER_SET_APPLICABILITY                |         2 | Visible | SYSTEM VIEW |\n| COLUMNS                                              |         2 | Visible | SYSTEM VIEW |\n| COLUMNS_EXTENSIONS                                   |         2 | Visible | SYSTEM VIEW |\n| COLUMN_STATISTICS                                    |         2 | Visible | SYSTEM VIEW |\n| EVENTS                                               |         2 | Visible | SYSTEM VIEW |\n| FILES                                                |         2 | Visible | SYSTEM VIEW |\n| INNODB_DATAFILES                                     |         2 | Visible | SYSTEM VIEW |\n| INNODB_FOREIGN                                       |         2 | Visible | SYSTEM VIEW |\n| INNODB_FOREIGN_COLS                                  |         2 | Visible | SYSTEM VIEW |\n| INNODB_FIELDS                                        |         2 | Visible | SYSTEM VIEW |\n| INNODB_TABLESPACES_BRIEF                             |         2 | Visible | SYSTEM VIEW |\n| KEY_COLUMN_USAGE                                     |         2 | Visible | SYSTEM VIEW |\n| KEYWORDS                                             |         2 | Visible | SYSTEM VIEW |\n| PARAMETERS                                           |         2 | Visible | SYSTEM VIEW |\n| PARTITIONS                                           |         2 | Visible | SYSTEM VIEW |\n| REFERENTIAL_CONSTRAINTS                              |         2 | Visible | SYSTEM VIEW |\n| RESOURCE_GROUPS                                      |         2 | Visible | SYSTEM VIEW |\n| ROUTINES                                             |         2 | Visible | SYSTEM VIEW |\n| SCHEMATA                                             |         2 | Visible | SYSTEM VIEW |\n| SCHEMATA_EXTENSIONS                                  |         2 | Visible | SYSTEM VIEW |\n| SHOW_STATISTICS                                      |         2 | System  | SYSTEM VIEW |\n| ST_SPATIAL_REFERENCE_SYSTEMS                         |         2 | Visible | SYSTEM VIEW |\n| ST_UNITS_OF_MEASURE                                  |         2 | Visible | SYSTEM VIEW |\n| ST_GEOMETRY_COLUMNS                                  |         2 | Visible | SYSTEM VIEW |\n| STATISTICS                                           |         2 | Visible | SYSTEM VIEW |\n| TABLE_CONSTRAINTS                                    |         2 | Visible | SYSTEM VIEW |\n| TABLE_CONSTRAINTS_EXTENSIONS                         |         2 | Visible | SYSTEM VIEW |\n| TABLES                                               |         2 | Visible | SYSTEM VIEW |\n| TABLES_EXTENSIONS                                    |         2 | Visible | SYSTEM VIEW |\n| TABLESPACES_EXTENSIONS                               |         2 | Visible | SYSTEM VIEW |\n| TRIGGERS                                             |         2 | Visible | SYSTEM VIEW |\n| VIEW_ROUTINE_USAGE                                   |         2 | Visible | SYSTEM VIEW |\n| VIEW_TABLE_USAGE                                     |         2 | Visible | SYSTEM VIEW |\n| VIEWS                                                |         2 | Visible | SYSTEM VIEW |\n| COLUMN_PRIVILEGES                                    |         2 | Visible | SYSTEM VIEW |\n| ENGINES                                              |         2 | Visible | SYSTEM VIEW |\n| OPTIMIZER_TRACE                                      |         2 | Visible | SYSTEM VIEW |\n| PLUGINS                                              |         2 | Visible | SYSTEM VIEW |\n| PROCESSLIST                                          |         2 | Visible | SYSTEM VIEW |\n| PROFILING                                            |         2 | Visible | SYSTEM VIEW |\n| SCHEMA_PRIVILEGES                                    |         2 | Visible | SYSTEM VIEW |\n| TABLESPACES                                          |         2 | Visible | SYSTEM VIEW |\n| TABLE_PRIVILEGES                                     |         2 | Visible | SYSTEM VIEW |\n| USER_PRIVILEGES                                      |         2 | Visible | SYSTEM VIEW |\n| cond_instances                                       |         3 | Visible | BASE TABLE  |\n| error_log                                            |         3 | Visible | BASE TABLE  |\n| events_waits_current                                 |         3 | Visible | BASE TABLE  |\n| events_waits_history                                 |         3 | Visible | BASE TABLE  |\n| events_waits_history_long                            |         3 | Visible | BASE TABLE  |\n| events_waits_summary_by_host_by_event_name           |         3 | Visible | BASE TABLE  |\n| events_waits_summary_by_instance                     |         3 | Visible | BASE TABLE  |\n| events_waits_summary_by_thread_by_event_name         |         3 | Visible | BASE TABLE  |\n| events_waits_summary_by_user_by_event_name           |         3 | Visible | BASE TABLE  |\n| events_waits_summary_by_account_by_event_name        |         3 | Visible | BASE TABLE  |\n| events_waits_summary_global_by_event_name            |         3 | Visible | BASE TABLE  |\n| file_instances                                       |         3 | Visible | BASE TABLE  |\n| file_summary_by_event_name                           |         3 | Visible | BASE TABLE  |\n| file_summary_by_instance                             |         3 | Visible | BASE TABLE  |\n| host_cache                                           |         3 | Visible | BASE TABLE  |\n| mutex_instances                                      |         3 | Visible | BASE TABLE  |\n| objects_summary_global_by_type                       |         3 | Visible | BASE TABLE  |\n| performance_timers                                   |         3 | Visible | BASE TABLE  |\n| processlist                                          |         3 | Visible | BASE TABLE  |\n| rwlock_instances                                     |         3 | Visible | BASE TABLE  |\n| setup_actors                                         |         3 | Visible | BASE TABLE  |\n| setup_consumers                                      |         3 | Visible | BASE TABLE  |\n| setup_instruments                                    |         3 | Visible | BASE TABLE  |\n| setup_objects                                        |         3 | Visible | BASE TABLE  |\n| setup_threads                                        |         3 | Visible | BASE TABLE  |\n| table_io_waits_summary_by_index_usage                |         3 | Visible | BASE TABLE  |\n| table_io_waits_summary_by_table                      |         3 | Visible | BASE TABLE  |\n| table_lock_waits_summary_by_table                    |         3 | Visible | BASE TABLE  |\n| threads                                              |         3 | Visible | BASE TABLE  |\n| events_stages_current                                |         3 | Visible | BASE TABLE  |\n| events_stages_history                                |         3 | Visible | BASE TABLE  |\n| events_stages_history_long                           |         3 | Visible | BASE TABLE  |\n| events_stages_summary_by_thread_by_event_name        |         3 | Visible | BASE TABLE  |\n| events_stages_summary_by_account_by_event_name       |         3 | Visible | BASE TABLE  |\n| events_stages_summary_by_user_by_event_name          |         3 | Visible | BASE TABLE  |\n| events_stages_summary_by_host_by_event_name          |         3 | Visible | BASE TABLE  |\n| events_stages_summary_global_by_event_name           |         3 | Visible | BASE TABLE  |\n| events_statements_current                            |         3 | Visible | BASE TABLE  |\n| events_statements_history                            |         3 | Visible | BASE TABLE  |\n| events_statements_history_long                       |         3 | Visible | BASE TABLE  |\n| events_statements_summary_by_thread_by_event_name    |         3 | Visible | BASE TABLE  |\n| events_statements_summary_by_account_by_event_name   |         3 | Visible | BASE TABLE  |\n| events_statements_summary_by_user_by_event_name      |         3 | Visible | BASE TABLE  |\n| events_statements_summary_by_host_by_event_name      |         3 | Visible | BASE TABLE  |\n| events_statements_summary_global_by_event_name       |         3 | Visible | BASE TABLE  |\n| events_statements_summary_by_digest                  |         3 | Visible | BASE TABLE  |\n| events_statements_summary_by_program                 |         3 | Visible | BASE TABLE  |\n| events_statements_histogram_global                   |         3 | Visible | BASE TABLE  |\n| events_statements_histogram_by_digest                |         3 | Visible | BASE TABLE  |\n| events_transactions_current                          |         3 | Visible | BASE TABLE  |\n| events_transactions_history                          |         3 | Visible | BASE TABLE  |\n| events_transactions_history_long                     |         3 | Visible | BASE TABLE  |\n| events_transactions_summary_by_thread_by_event_name  |         3 | Visible | BASE TABLE  |\n| events_transactions_summary_by_account_by_event_name |         3 | Visible | BASE TABLE  |\n| events_transactions_summary_by_user_by_event_name    |         3 | Visible | BASE TABLE  |\n| events_transactions_summary_by_host_by_event_name    |         3 | Visible | BASE TABLE  |\n| events_transactions_summary_global_by_event_name     |         3 | Visible | BASE TABLE  |\n| events_errors_summary_by_user_by_error               |         3 | Visible | BASE TABLE  |\n| events_errors_summary_by_host_by_error               |         3 | Visible | BASE TABLE  |\n| events_errors_summary_by_account_by_error            |         3 | Visible | BASE TABLE  |\n| events_errors_summary_by_thread_by_error             |         3 | Visible | BASE TABLE  |\n| events_errors_summary_global_by_error                |         3 | Visible | BASE TABLE  |\n| users                                                |         3 | Visible | BASE TABLE  |\n| accounts                                             |         3 | Visible | BASE TABLE  |\n| hosts                                                |         3 | Visible | BASE TABLE  |\n| socket_instances                                     |         3 | Visible | BASE TABLE  |\n| socket_summary_by_instance                           |         3 | Visible | BASE TABLE  |\n| socket_summary_by_event_name                         |         3 | Visible | BASE TABLE  |\n| session_connect_attrs                                |         3 | Visible | BASE TABLE  |\n| session_account_connect_attrs                        |         3 | Visible | BASE TABLE  |\n| keyring_keys                                         |         3 | Visible | BASE TABLE  |\n| memory_summary_global_by_event_name                  |         3 | Visible | BASE TABLE  |\n| memory_summary_by_account_by_event_name              |         3 | Visible | BASE TABLE  |\n| memory_summary_by_host_by_event_name                 |         3 | Visible | BASE TABLE  |\n| memory_summary_by_thread_by_event_name               |         3 | Visible | BASE TABLE  |\n| memory_summary_by_user_by_event_name                 |         3 | Visible | BASE TABLE  |\n| table_handles                                        |         3 | Visible | BASE TABLE  |\n| metadata_locks                                       |         3 | Visible | BASE TABLE  |\n| data_locks                                           |         3 | Visible | BASE TABLE  |\n| data_lock_waits                                      |         3 | Visible | BASE TABLE  |\n| replication_connection_configuration                 |         3 | Visible | BASE TABLE  |\n| replication_group_members                            |         3 | Visible | BASE TABLE  |\n| replication_connection_status                        |         3 | Visible | BASE TABLE  |\n| replication_applier_configuration                    |         3 | Visible | BASE TABLE  |\n| replication_applier_status                           |         3 | Visible | BASE TABLE  |\n| replication_applier_status_by_coordinator            |         3 | Visible | BASE TABLE  |\n| replication_applier_status_by_worker                 |         3 | Visible | BASE TABLE  |\n| replication_group_member_stats                       |         3 | Visible | BASE TABLE  |\n| replication_applier_filters                          |         3 | Visible | BASE TABLE  |\n| replication_applier_global_filters                   |         3 | Visible | BASE TABLE  |\n| replication_asynchronous_connection_failover         |         3 | Visible | BASE TABLE  |\n| replication_asynchronous_connection_failover_managed |         3 | Visible | BASE TABLE  |\n| log_status                                           |         3 | Visible | BASE TABLE  |\n| prepared_statements_instances                        |         3 | Visible | BASE TABLE  |\n| user_variables_by_thread                             |         3 | Visible | BASE TABLE  |\n| status_by_account                                    |         3 | Visible | BASE TABLE  |\n| status_by_host                                       |         3 | Visible | BASE TABLE  |\n| status_by_thread                                     |         3 | Visible | BASE TABLE  |\n| status_by_user                                       |         3 | Visible | BASE TABLE  |\n| global_status                                        |         3 | Visible | BASE TABLE  |\n| session_status                                       |         3 | Visible | BASE TABLE  |\n| variables_by_thread                                  |         3 | Visible | BASE TABLE  |\n| global_variables                                     |         3 | Visible | BASE TABLE  |\n| session_variables                                    |         3 | Visible | BASE TABLE  |\n| variables_info                                       |         3 | Visible | BASE TABLE  |\n| persisted_variables                                  |         3 | Visible | BASE TABLE  |\n| user_defined_functions                               |         3 | Visible | BASE TABLE  |\n| binary_log_transaction_compression_stats             |         3 | Visible | BASE TABLE  |\n| tls_channel_status                                   |         3 | Visible | BASE TABLE  |\n| keyring_component_status                             |         3 | Visible | BASE TABLE  |\n| db                                                   |         1 | Visible | BASE TABLE  |\n| user                                                 |         1 | Visible | BASE TABLE  |\n| default_roles                                        |         1 | Visible | BASE TABLE  |\n| role_edges                                           |         1 | Visible | BASE TABLE  |\n| global_grants                                        |         1 | Visible | BASE TABLE  |\n| password_history                                     |         1 | Visible | BASE TABLE  |\n| func                                                 |         1 | Visible | BASE TABLE  |\n| plugin                                               |         1 | Visible | BASE TABLE  |\n| help_topic                                           |         1 | Visible | BASE TABLE  |\n| help_category                                        |         1 | Visible | BASE TABLE  |\n| help_relation                                        |         1 | Visible | BASE TABLE  |\n| servers                                              |         1 | Visible | BASE TABLE  |\n| tables_priv                                          |         1 | Visible | BASE TABLE  |\n| columns_priv                                         |         1 | Visible | BASE TABLE  |\n| help_keyword                                         |         1 | Visible | BASE TABLE  |\n| time_zone_name                                       |         1 | Visible | BASE TABLE  |\n| time_zone                                            |         1 | Visible | BASE TABLE  |\n| time_zone_transition                                 |         1 | Visible | BASE TABLE  |\n| time_zone_transition_type                            |         1 | Visible | BASE TABLE  |\n| time_zone_leap_second                                |         1 | Visible | BASE TABLE  |\n| procs_priv                                           |         1 | Visible | BASE TABLE  |\n| general_log                                          |         1 | Visible | BASE TABLE  |\n| slow_log                                             |         1 | Visible | BASE TABLE  |\n| component                                            |         1 | Visible | BASE TABLE  |\n| slave_relay_log_info                                 |         1 | Visible | BASE TABLE  |\n| slave_master_info                                    |         1 | Visible | BASE TABLE  |\n| slave_worker_info                                    |         1 | Visible | BASE TABLE  |\n| gtid_executed                                        |         1 | Visible | BASE TABLE  |\n| replication_asynchronous_connection_failover         |         1 | Visible | BASE TABLE  |\n| replication_asynchronous_connection_failover_managed |         1 | Visible | BASE TABLE  |\n| replication_group_member_actions                     |         1 | Visible | BASE TABLE  |\n| replication_group_configuration_version              |         1 | Visible | BASE TABLE  |\n| server_cost                                          |         1 | Visible | BASE TABLE  |\n| engine_cost                                          |         1 | Visible | BASE TABLE  |\n| proxies_priv                                         |         1 | Visible | BASE TABLE  |\n| version                                              |         4 | Visible | VIEW        |\n| sys_config                                           |         4 | Visible | BASE TABLE  |\n| innodb_buffer_stats_by_schema                        |         4 | Visible | VIEW        |\n| x$innodb_buffer_stats_by_schema                      |         4 | Visible | VIEW        |\n| innodb_buffer_stats_by_table                         |         4 | Visible | VIEW        |\n| x$innodb_buffer_stats_by_table                       |         4 | Visible | VIEW        |\n| schema_object_overview                               |         4 | Visible | VIEW        |\n| schema_auto_increment_columns                        |         4 | Visible | VIEW        |\n| x$schema_flattened_keys                              |         4 | Visible | VIEW        |\n| schema_redundant_indexes                             |         4 | Visible | VIEW        |\n| ps_check_lost_instrumentation                        |         4 | Visible | VIEW        |\n| latest_file_io                                       |         4 | Visible | VIEW        |\n| x$latest_file_io                                     |         4 | Visible | VIEW        |\n| io_by_thread_by_latency                              |         4 | Visible | VIEW        |\n| x$io_by_thread_by_latency                            |         4 | Visible | VIEW        |\n| io_global_by_file_by_bytes                           |         4 | Visible | VIEW        |\n| x$io_global_by_file_by_bytes                         |         4 | Visible | VIEW        |\n| io_global_by_file_by_latency                         |         4 | Visible | VIEW        |\n| x$io_global_by_file_by_latency                       |         4 | Visible | VIEW        |\n| io_global_by_wait_by_bytes                           |         4 | Visible | VIEW        |\n| x$io_global_by_wait_by_bytes                         |         4 | Visible | VIEW        |\n| io_global_by_wait_by_latency                         |         4 | Visible | VIEW        |\n| x$io_global_by_wait_by_latency                       |         4 | Visible | VIEW        |\n| innodb_lock_waits                                    |         4 | Visible | VIEW        |\n| x$innodb_lock_waits                                  |         4 | Visible | VIEW        |\n| memory_by_user_by_current_bytes                      |         4 | Visible | VIEW        |\n| x$memory_by_user_by_current_bytes                    |         4 | Visible | VIEW        |\n| memory_by_host_by_current_bytes                      |         4 | Visible | VIEW        |\n| x$memory_by_host_by_current_bytes                    |         4 | Visible | VIEW        |\n| memory_by_thread_by_current_bytes                    |         4 | Visible | VIEW        |\n| x$memory_by_thread_by_current_bytes                  |         4 | Visible | VIEW        |\n| memory_global_by_current_bytes                       |         4 | Visible | VIEW        |\n| x$memory_global_by_current_bytes                     |         4 | Visible | VIEW        |\n| memory_global_total                                  |         4 | Visible | VIEW        |\n| x$memory_global_total                                |         4 | Visible | VIEW        |\n| schema_index_statistics                              |         4 | Visible | VIEW        |\n| x$schema_index_statistics                            |         4 | Visible | VIEW        |\n| x$ps_schema_table_statistics_io                      |         4 | Visible | VIEW        |\n| schema_table_statistics                              |         4 | Visible | VIEW        |\n| x$schema_table_statistics                            |         4 | Visible | VIEW        |\n| schema_table_statistics_with_buffer                  |         4 | Visible | VIEW        |\n| x$schema_table_statistics_with_buffer                |         4 | Visible | VIEW        |\n| schema_tables_with_full_table_scans                  |         4 | Visible | VIEW        |\n| x$schema_tables_with_full_table_scans                |         4 | Visible | VIEW        |\n| schema_unused_indexes                                |         4 | Visible | VIEW        |\n| schema_table_lock_waits                              |         4 | Visible | VIEW        |\n| x$schema_table_lock_waits                            |         4 | Visible | VIEW        |\n| statement_analysis                                   |         4 | Visible | VIEW        |\n| x$statement_analysis                                 |         4 | Visible | VIEW        |\n| statements_with_errors_or_warnings                   |         4 | Visible | VIEW        |\n| x$statements_with_errors_or_warnings                 |         4 | Visible | VIEW        |\n| statements_with_full_table_scans                     |         4 | Visible | VIEW        |\n| x$statements_with_full_table_scans                   |         4 | Visible | VIEW        |\n| x$ps_digest_avg_latency_distribution                 |         4 | Visible | VIEW        |\n| x$ps_digest_95th_percentile_by_avg_us                |         4 | Visible | VIEW        |\n| statements_with_runtimes_in_95th_percentile          |         4 | Visible | VIEW        |\n| x$statements_with_runtimes_in_95th_percentile        |         4 | Visible | VIEW        |\n| statements_with_sorting                              |         4 | Visible | VIEW        |\n| x$statements_with_sorting                            |         4 | Visible | VIEW        |\n| statements_with_temp_tables                          |         4 | Visible | VIEW        |\n| x$statements_with_temp_tables                        |         4 | Visible | VIEW        |\n| user_summary_by_file_io_type                         |         4 | Visible | VIEW        |\n| x$user_summary_by_file_io_type                       |         4 | Visible | VIEW        |\n| user_summary_by_file_io                              |         4 | Visible | VIEW        |\n| x$user_summary_by_file_io                            |         4 | Visible | VIEW        |\n| user_summary_by_statement_type                       |         4 | Visible | VIEW        |\n| x$user_summary_by_statement_type                     |         4 | Visible | VIEW        |\n| user_summary_by_statement_latency                    |         4 | Visible | VIEW        |\n| x$user_summary_by_statement_latency                  |         4 | Visible | VIEW        |\n| user_summary_by_stages                               |         4 | Visible | VIEW        |\n| x$user_summary_by_stages                             |         4 | Visible | VIEW        |\n| user_summary                                         |         4 | Visible | VIEW        |\n| x$user_summary                                       |         4 | Visible | VIEW        |\n| host_summary_by_file_io_type                         |         4 | Visible | VIEW        |\n| x$host_summary_by_file_io_type                       |         4 | Visible | VIEW        |\n| host_summary_by_file_io                              |         4 | Visible | VIEW        |\n| x$host_summary_by_file_io                            |         4 | Visible | VIEW        |\n| host_summary_by_statement_type                       |         4 | Visible | VIEW        |\n| x$host_summary_by_statement_type                     |         4 | Visible | VIEW        |\n| host_summary_by_statement_latency                    |         4 | Visible | VIEW        |\n| x$host_summary_by_statement_latency                  |         4 | Visible | VIEW        |\n| host_summary_by_stages                               |         4 | Visible | VIEW        |\n| x$host_summary_by_stages                             |         4 | Visible | VIEW        |\n| host_summary                                         |         4 | Visible | VIEW        |\n| x$host_summary                                       |         4 | Visible | VIEW        |\n| wait_classes_global_by_avg_latency                   |         4 | Visible | VIEW        |\n| x$wait_classes_global_by_avg_latency                 |         4 | Visible | VIEW        |\n| wait_classes_global_by_latency                       |         4 | Visible | VIEW        |\n| x$wait_classes_global_by_latency                     |         4 | Visible | VIEW        |\n| waits_by_user_by_latency                             |         4 | Visible | VIEW        |\n| x$waits_by_user_by_latency                           |         4 | Visible | VIEW        |\n| waits_by_host_by_latency                             |         4 | Visible | VIEW        |\n| x$waits_by_host_by_latency                           |         4 | Visible | VIEW        |\n| waits_global_by_latency                              |         4 | Visible | VIEW        |\n| x$waits_global_by_latency                            |         4 | Visible | VIEW        |\n| metrics                                              |         4 | Visible | VIEW        |\n| processlist                                          |         4 | Visible | VIEW        |\n| x$processlist                                        |         4 | Visible | VIEW        |\n| session                                              |         4 | Visible | VIEW        |\n| x$session                                            |         4 | Visible | VIEW        |\n| session_ssl_status                                   |         4 | Visible | VIEW        |\n| ENABLED_ROLES                                        |         2 | Visible | SYSTEM VIEW |\n| APPLICABLE_ROLES                                     |         2 | Visible | SYSTEM VIEW |\n| ADMINISTRABLE_ROLE_AUTHORIZATIONS                    |         2 | Visible | SYSTEM VIEW |\n| ROLE_COLUMN_GRANTS                                   |         2 | Visible | SYSTEM VIEW |\n| ROLE_ROUTINE_GRANTS                                  |         2 | Visible | SYSTEM VIEW |\n| ROLE_TABLE_GRANTS                                    |         2 | Visible | SYSTEM VIEW |\n| USER_ATTRIBUTES                                      |         2 | Visible | SYSTEM VIEW |\n| INNODB_SESSION_TEMP_TABLESPACES                      |         2 | Visible | SYSTEM VIEW |\n| INNODB_VIRTUAL                                       |         2 | Visible | SYSTEM VIEW |\n| INNODB_BUFFER_POOL_STATS                             |         2 | Visible | SYSTEM VIEW |\n| INNODB_BUFFER_PAGE                                   |         2 | Visible | SYSTEM VIEW |\n| INNODB_CMPMEM_RESET                                  |         2 | Visible | SYSTEM VIEW |\n| INNODB_CMPMEM                                        |         2 | Visible | SYSTEM VIEW |\n| INNODB_TRX                                           |         2 | Visible | SYSTEM VIEW |\n| INNODB_CMP_PER_INDEX_RESET                           |         2 | Visible | SYSTEM VIEW |\n| INNODB_CMP_RESET                                     |         2 | Visible | SYSTEM VIEW |\n| INNODB_FT_DEFAULT_STOPWORD                           |         2 | Visible | SYSTEM VIEW |\n| INNODB_METRICS                                       |         2 | Visible | SYSTEM VIEW |\n| INNODB_TEMP_TABLE_INFO                               |         2 | Visible | SYSTEM VIEW |\n| INNODB_FT_DELETED                                    |         2 | Visible | SYSTEM VIEW |\n| INNODB_TABLESTATS                                    |         2 | Visible | SYSTEM VIEW |\n| INNODB_CMP                                           |         2 | Visible | SYSTEM VIEW |\n| INNODB_TABLES                                        |         2 | Visible | SYSTEM VIEW |\n| INNODB_FT_BEING_DELETED                              |         2 | Visible | SYSTEM VIEW |\n| INNODB_BUFFER_PAGE_LRU                               |         2 | Visible | SYSTEM VIEW |\n| INNODB_CMP_PER_INDEX                                 |         2 | Visible | SYSTEM VIEW |\n| INNODB_FT_CONFIG                                     |         2 | Visible | SYSTEM VIEW |\n| INNODB_CACHED_INDEXES                                |         2 | Visible | SYSTEM VIEW |\n| INNODB_FT_INDEX_TABLE                                |         2 | Visible | SYSTEM VIEW |\n| INNODB_COLUMNS                                       |         2 | Visible | SYSTEM VIEW |\n| INNODB_FT_INDEX_CACHE                                |         2 | Visible | SYSTEM VIEW |\n| INNODB_INDEXES                                       |         2 | Visible | SYSTEM VIEW |\n| INNODB_TABLESPACES                                   |         2 | Visible | SYSTEM VIEW |\n| innodb_redo_log_files                                |         3 | Visible | BASE TABLE  |\n+------------------------------------------------------+-----------+---------+-------------+\n361 rows in set (0.02 sec)\n\nmysql&gt; \n</code></pre> DD \u8868\u540d \u8bf4\u660e catalogs \u76ee\u5f55\u4fe1\u606f\u3002 character_sets \u53ef\u7528\u5b57\u7b26\u96c6\u7684\u4fe1\u606f\u3002 check_constraints \u5173\u4e8e\u8868\u4e0a\u5b9a\u4e49\u7684CHECK\u7ea6\u675f\u7684\u4fe1\u606f\u3002 collations \u5173\u4e8e\u6bcf\u4e2a\u5b57\u7b26\u96c6\u7684\u6392\u5e8f\u89c4\u5219\u7684\u4fe1\u606f \u3002 column_statistics \u5217\u503c\u7684\u76f4\u65b9\u56fe\u7edf\u8ba1\u4fe1\u606f\u3002 column_type_elements \u5173\u4e8e\u5217\u4f7f\u7528\u7684\u7c7b\u578b\u7684\u4fe1\u606f\u3002 columns \u5173\u4e8e\u8868\u4e2d\u5217\u7684\u4fe1\u606f\u3002 dd_properties \u6807\u8bc6\u6570\u636e\u5b57\u5178\u5c5e\u6027\u7684\u8868\uff0c\u4f8b\u5982\u5b83\u7684\u7248\u672c\u3002\u670d\u52a1\u5668\u4f7f\u7528\u5b83\u6765\u786e\u5b9a\u662f\u5426\u5fc5\u987b\u5c06\u6570\u636e\u5b57\u5178\u5347\u7ea7\u5230\u8f83\u65b0\u7684\u7248\u672c\u3002 events \u5173\u4e8e\u4e8b\u4ef6\u8c03\u5ea6\u5668\u4e8b\u4ef6\u7684\u4fe1\u606f\u3002 foreign_keys, foreign_key_column_usage \u5173\u4e8e\u5916\u952e\u7684\u4fe1\u606f\u3002 index_column_usage \u7d22\u5f15\u4f7f\u7528\u7684\u5217\u7684\u4fe1\u606f\u3002 index_partitions \u5173\u4e8e\u7d22\u5f15\u4f7f\u7528\u7684\u5206\u533a\u7684\u4fe1\u606f\u3002 index_stats \u7528\u4e8e\u5b58\u50a8\u5728\u6267\u884cANALYZE TABLE\u65f6\u751f\u6210\u7684\u52a8\u6001\u7d22\u5f15\u7edf\u8ba1\u4fe1\u606f\u3002 indexes \u5173\u4e8e\u8868\u7d22\u5f15\u7684\u4fe1\u606f\u3002 innodb_ddl_log \u5b58\u50a8DDL\u64cd\u4f5c\u7684\u5d29\u6e83\u5b89\u5168\u65e5\u5fd7\u3002 parameter_type_elements \u5173\u4e8e\u5b58\u50a8\u8fc7\u7a0b\u548c\u51fd\u6570\u53c2\u6570\u7684\u4fe1\u606f\uff0c\u4ee5\u53ca\u5173\u4e8e\u5b58\u50a8\u51fd\u6570\u8fd4\u56de\u503c\u7684\u4fe1\u606f\u3002 parameters \u5b58\u50a8\u8fc7\u7a0b\u548c\u51fd\u6570\u7684\u76f8\u5173\u4fe1\u606f\u3002 resource_groups \u8d44\u6e90\u7ec4\u4fe1\u606f\u3002 schemata \u5173\u4e8eschemata\u7684\u4fe1\u606f\u3002 st_spatial_reference_systems \u7a7a\u95f4\u6570\u636e\u7684\u53ef\u7528\u7a7a\u95f4\u53c2\u8003\u7cfb\u7edf\u7684\u4fe1\u606f\u3002 table_partition_values \u8868\u5206\u533a\u4f7f\u7528\u7684\u503c\u7684\u4fe1\u606f\u3002 table_partitions \u5173\u4e8e\u8868\u4f7f\u7528\u7684\u5206\u533a\u7684\u4fe1\u606f\u3002 table_stats \u6267\u884cANALYZE table\u65f6\u751f\u6210\u7684\u52a8\u6001\u8868\u7edf\u8ba1\u4fe1\u606f\u3002 tables \u5173\u4e8e\u6570\u636e\u5e93\u4e2d\u8868\u7684\u4fe1\u606f\u3002 tablespace_files \u8868\u7a7a\u95f4\u4f7f\u7528\u7684\u6587\u4ef6\u4fe1\u606f\u3002 tablespaces \u6d3b\u52a8\u8868\u7a7a\u95f4\u7684\u4fe1\u606f\u3002 triggers \u89e6\u53d1\u5668\u4fe1\u606f\u3002 view_routine_usage \u5173\u4e8e\u89c6\u56fe\u548c\u89c6\u56fe\u4f7f\u7528\u7684\u5b58\u50a8\u51fd\u6570\u4e4b\u95f4\u7684\u4f9d\u8d56\u5173\u7cfb\u7684\u4fe1\u606f\u3002 view_table_usage \u7528\u4e8e\u8ddf\u8e2a\u89c6\u56fe\u53ca\u5176\u5e95\u5c42\u8868\u4e4b\u95f4\u7684\u4f9d\u8d56\u5173\u7cfb\u3002 <p>\u53c2\u8003 </p> <p>http://mysql.taobao.org/monthly/2021/08/02/ http://mysql.taobao.org/monthly/2023/10/03/ http://mysql.taobao.org/monthly/2022/01/04/</p>"},{"location":"basic/15.%E6%95%B0%E6%8D%AE%E6%96%87%E4%BB%B6%E6%A0%BC%E5%BC%8F/","title":"\u6587\u4ef6\u683c\u5f0f","text":""},{"location":"basic/15.%E6%95%B0%E6%8D%AE%E6%96%87%E4%BB%B6%E6%A0%BC%E5%BC%8F/#csv","title":"CSV \u6587\u4ef6\u683c\u5f0f","text":"<p>CSV \u683c\u5f0f\u7684\u8bde\u751f\u751a\u81f3\u6bd4\u4e2a\u4eba\u8ba1\u7b97\u673a\uff08PC\uff09\u66f4\u65e9\u3002\u5728\u4e0a\u4e2a\u4e16\u7eaa 70 \u5e74\u4ee3\u7684 IBM FORTRAN 77 \u5df2\u7ecf\u5b9a\u4e49\u4e86\u7528\u9017\u53f7\u6216\u7a7a\u683c\u4f5c\u4e3a\u6587\u672c\u5b9a\u754c\u7b26\u7684\u5904\u7406\u65b9\u5f0f\uff0c\u5f53\u65f6\u5b83\u88ab\u79f0\u4e3a\u5217\u8868\u5bfc\u5411\u7684 IO\uff08List-Directed Input/Output \uff09\u3002</p> <p>CSV \u7684\u540d\u79f0\u5927\u7ea6\u662f\u5728 1983 \u5e74\u51fa\u73b0\u7684\u3002\u4f34\u968f\u7740\u7535\u5b50\u8868\u683c\u8f6f\u4ef6\u7684\u5174\u8d77\uff0c\u4eba\u4eec\u53d1\u73b0\u8be5\u683c\u5f0f\u548c\u7535\u5b50\u8868\u683c\u5b58\u5728\u5929\u7136\u7684\u5173\u8054\u3002\u5e76\u4e14\u7531\u4e8e\u4f7f\u7528\u4eba\u7c7b\u53ef\u8bfb\u7684\u6587\u672c\u5f62\u5f0f\uff0c\u800c\u4e0d\u662f\u8ba1\u7b97\u673a\u53ef\u8bfb\u7684\u4e8c\u8fdb\u5236\u683c\u5f0f\uff0c\u4e0d\u4ec5\u4f7f\u5f97\u64cd\u4f5c\u5458\u80fd\u591f\u7406\u89e3\u3001\u5206\u6790\u548c\u5904\u7406\u5b83\u4eec\uff0c\u4e5f\u907f\u514d\u4e86\u4e0d\u540c\u673a\u5668\u4e4b\u95f4\u7684\u4f53\u7cfb\u5dee\u5f02\u5e26\u6765\u7684\u95ee\u9898\uff0c\u6240\u4ee5\u5f88\u5feb\u6210\u4e3a\u6570\u636e\u4ea4\u6362\u7684\u6d41\u884c\u9009\u62e9\u3002\u5728\u65e9\u671f\u7535\u5b50\u8868\u683c\u8f6f\u4ef6 SuperCalc \u624b\u518c\u4e2d\u9996\u6b21\u7ed9\u4e86\u5b83\u540d\u5b57\uff1a\u9017\u53f7\u5206\u9694\u7684\u503c\uff08Comma-Separated-Value\uff09\uff0c\u5e76\u89c4\u5b9a\u4e86\u6587\u4ef6\u683c\u5f0f\u548c\u5904\u7406\u65b9\u6cd5\u3002</p> <p>CSV\uff08\u5373 Comma Separate Values\uff09\u662f\u4ee5\u6587\u672c\u5f62\u5f0f\u8bb0\u5f55\u6570\u636e\u7684\u6587\u4ef6\uff08\u901a\u5e38\u4ee5\u9017\u53f7\u4e3a\u5206\u9694\u7b26\uff09\uff0c\u8fd9\u79cd\u683c\u5f0f\u7ecf\u5e38\u7528\u6765\u4f5c\u4e3a\u4e0d\u540c\u7a0b\u5e8f\u4e4b\u95f4\u7684\u6570\u636e\u4ea4\u4e92\u7684\u683c\u5f0f\u3002</p> <p>\u5f53\u7136\uff0c\u7528\u6237\u624b\u518c\u662f\u4ece\u5177\u4f53\u4f7f\u7528\u89d2\u5ea6\u51fa\u53d1\u7684\uff0c\u5e76\u672a\u7ed9 CSV \u683c\u5f0f\u4e00\u4e2a\u975e\u5e38\u4e25\u683c\u7684\u5b9a\u4e49\u3002</p> <ul> <li> <p>2005 \u5e74\uff0c\u56fd\u9645\u6807\u51c6\u5316\u7ec4\u7ec7 IETF \u901a\u8fc7 <code>RFC4180</code>\u6b63\u5f0f\u5b9a\u4e49\u4e86 CSV \u6587\u4ef6\u7684\u683c\u5f0f\u8981\u6c42\u3002</p> </li> <li> <p>2014 \u5e74\uff0c\u53c8\u901a\u8fc7 <code>RFC7111</code> \u8865\u5145\u89c4\u5b9a\u4e86 <code>CSV</code> \u6587\u4ef6\u5728 Web \u5e94\u7528\u4e2d\u7684\u4e00\u4e9b\u89c4\u8303\uff0c\u4e3b\u8981\u662f <code>MIME Type</code> \u53ca <code>URL</code> \u7247\u6bb5\u7684\u6b63\u5f0f\u7ea6\u5b9a\u3002</p> </li> <li> <p>2015 \u5e74\uff0cW3C \u7ed9\u8868\u683c\u5316\u7684\u6570\u636e/\u5143\u6570\u636e\u5236\u5b9a\u4e86\u4e00\u4e2a\u63a8\u8350\u8349\u6848\uff0c\u8bd5\u56fe\u5c06\u6570\u636e\u7684\u683c\u5f0f\u548c\u4f7f\u7528\u65b9\u6cd5\u8fdb\u884c\u89c4\u8303\u5316\uff0c\u5176\u4e2d\u4e5f\u5305\u542b\u4e86\u5bf9 CSV \u683c\u5f0f\u7684\u8981\u6c42\u3002</p> </li> </ul> <p>CSV \u683c\u5f0f\u5728\u53d1\u5c55\u8fc7\u7a0b\u4e2d\u4e5f\u9010\u6e10\u6f14\u53d8\u51fa\u5176\u4ed6\u4e00\u4e9b\u5206\u652f\u548c\u53d8\u79cd\u3002\u4ece\u540d\u5b57\uff08Comma-Separated-Value\uff09\u53ef\u4ee5\u770b\u51fa\uff0c\u575a\u6301\u4f7f\u7528\u9017\u53f7\u624d\u662f\u6b63\u89c4\u7684\u505a\u6cd5\u3002\u4f46\u6709\u4e9b\u7a0b\u5e8f\u4e5f\u5f00\u59cb\u4f7f\u7528 Tab \u6216\u7ba1\u9053\u7b26\uff08|\uff09\uff0c\u751a\u81f3\u5176\u4ed6\u66f4\u591a\u7b26\u53f7\u6765\u8fdb\u884c\u5206\u5272\u3002</p> <p>\u5728\u683c\u5f0f\u53d8\u5316\u7684\u540c\u65f6\uff0c\u6709\u7684\u7a0b\u5e8f\u7ee7\u7eed\u6cbf\u7528 CSV \u7684\u540d\u79f0\uff0c\u6709\u7684\u5219\u5f15\u5165\u4e86\u5176\u4ed6\u7a0d\u6709\u53d8\u5316\u7684\u540d\u5b57\uff0c\u6bd4\u5982 DSV\uff08Delimiter-Separated Values\uff09\u3002\u8fd9\u4f7f\u5f97\u5c40\u9762\u53d8\u5f97\u6709\u70b9\u6df7\u4e71\uff0c\u800c\u8fd9\u79cd\u6df7\u4e71\uff0c\u5230\u73b0\u5728\u4ecd\u7136\u5728\u5ef6\u7eed\u3002</p>"},{"location":"basic/15.%E6%95%B0%E6%8D%AE%E6%96%87%E4%BB%B6%E6%A0%BC%E5%BC%8F/#_2","title":"\u683c\u5f0f\u89c4\u8303","text":"<p>CSV \u7684\u57fa\u672c\u683c\u5f0f\u662f\u9017\u53f7\u5206\u9694\u7684\u4e00\u7cfb\u5217\u5b57\u6bb5\u3002\u540c\u65f6\u89c4\u8303\u8981\u6c42\uff0c\u6240\u6709\u5b57\u6bb5\u90fd\u53ef\u4ee5\u7528\u5f15\u7528\u7b26\u53f7\uff08\u901a\u5e38\u662f\u53cc\u5f15\u53f7 \" \uff09\u5305\u56f4\u8d77\u6765\u3002</p> <pre><code>shenzhen,2019,china\n\"shenzhen\",\"2019\",\"china\"\n</code></pre> <p>\u81f3\u4e8e\u4f55\u65f6\u5e94\u8be5\u52a0\u5f15\u53f7\u3001\u4f55\u65f6\u4e0d\u52a0\uff0c\u89c4\u8303\u5e76\u65e0\u660e\u786e\u8981\u6c42\uff0c\u800c\u662f\u628a\u8fd9\u4e2a\u51b3\u5b9a\u7559\u7ed9\u5e94\u7528\u7a0b\u5e8f\u3002\u4f46\u5982\u679c\u5b57\u6bb5\u5185\u5bb9\u4e2d\u51fa\u73b0\u4e86\u9017\u53f7\uff0c\u4e3a\u4e86\u907f\u514d\u6b67\u4e49\uff0c\u5c31\u5fc5\u987b\u52a0\u4e0a\u5f15\u53f7\u3002\u6b64\u5916\uff0c\u5982\u679c\u5b57\u6bb5\u5185\u5bb9\u4e2d\u5b58\u5728\u7a7a\u767d\u5b57\u7b26\u7684\u8bdd\uff0c\u4e3a\u4e86\u660e\u786e\u8d77\u89c1\uff0c\u4e00\u822c\u4e5f\u5efa\u8bae\u52a0\u4e0a\uff1a</p> <pre><code>shenzhen,\"Oct 2019\",\"Guangdong, China\"\n</code></pre> <p>\u89c4\u8303\u4e5f\u6ca1\u6709\u6307\u5b9a CSV \u5e94\u4f7f\u7528\u4f55\u79cd\u5b57\u7b26\u7f16\u7801\u3002\u4f46 <code>RFC7111</code> \u6709\u4e00\u4e2a\u8865\u5145\u8bf4\u660e\uff1a\u5728 Web \u670d\u52a1\u5668\u4e0a\u4f7f\u7528\u7684\u65f6\u5019\uff0c\u6807\u51c6\u7684 <code>MIME Type</code> \u5e94\u8be5\u4e3a <code>text/csv</code>\uff0c\u50cf\u5176\u4ed6\u6587\u672c\u683c\u5f0f\u4e00\u6837\uff0c\u53ef\u4ee5\u6709\u4e00\u4e2a\u53ef\u9009\u7684\u7f16\u7801\u3002</p> <ul> <li>\u6240\u6709\u884c\u5e94\u8be5\u62e5\u6709\u76f8\u540c\u6570\u91cf\u7684\u5b57\u6bb5</li> <li>\u6362\u884c\u7b26\u5e94\u7edf\u4e00\u4f7f\u7528 CRLF</li> <li>\u53ef\u4ee5\u6709\u4e00\u4e2a\u53ef\u9009\u7684\u6807\u9898\u884c\u3002\u4f46\u6587\u4ef6\u4e2d\u5230\u5e95\u662f\u5426\u5305\u542b\u6807\u9898\uff0c\u5e76\u65e0\u786e\u5b9a\u7684\u65b9\u6cd5\u6765\u6307\u5b9a\uff0c\u800c\u662f\u7559\u7ed9\u5f00\u53d1\u8005\u81ea\u5df1\u5224\u65ad\u3002</li> </ul> <p>\u53ef\u4ee5\u770b\u5230\uff0cCSV \u662f\u4e00\u4e2a\u975e\u5e38\u677e\u6563\u7684\u6587\u4ef6\u89c4\u8303\uff0c\u90fd\u53ea\u662f\u5e94\u8be5\u3002\u5728\u73b0\u5b9e\u4e16\u754c\u4e2d\uff0c\u4e0d\u89c4\u8303\u7684 CSV \u6587\u4ef6\u624d\u662f\u5e38\u6001\u3002</p> <p>\u6bd4\u5982\u8bf4\uff0c\u89c4\u8303\u8981\u6c42 CSV \u7684\u6240\u6709\u884c\u5e94\u8be5\u62e5\u6709\u76f8\u540c\u6570\u91cf\u7684\u5b57\u6bb5\u3002\u4f46\u5982\u679c\u771f\u7684\u9047\u5230\u6570\u91cf\u4e0d\u540c\u7684\u5185\u5bb9\uff0c\u53c8\u8be5\u600e\u4e48\u5904\u7406\uff1f\u6709\u4e9b\u5e93\u4f1a\u8fd4\u56de\u957f\u5ea6\u4e0d\u5b9a\u7684\u6570\u7ec4\uff0c\u6709\u4e9b\u5e93\u5219\u4f1a\u51fa\u9519\uff0c\u8fd8\u6709\u4e9b\u5e93\u901a\u8fc7\u63d0\u4f9b\u66f4\u4e30\u5bcc\u7684\u53c2\u6570\u6765\u8ba9\u5f00\u53d1\u8005\u81ea\u5b9a\u4e49\u884c\u4e3a\u3002\u8fd9\u5c31\u5e26\u6765\u4e86\u5728\u5b9e\u9645\u5e94\u7528\u4e2d\uff0c\u54ea\u6015\u5bf9\u4e8e\u76f8\u540c\u7684 CSV\uff0c\u4e0d\u540c\u7684\u5e93\u4e5f\u53ef\u80fd\u5f7c\u6b64\u8868\u73b0\u4e0d\u540c\uff0c\u65e0\u6cd5\u4e92\u76f8\u517c\u5bb9\u3002\u5982\u679c\u8981\u5904\u7406\u6765\u81ea\u5916\u90e8\u7684 CSV \u6587\u4ef6\uff0c\u6211\u4eec\u4e5f\u5fc5\u987b\u5c0f\u5fc3\u63d0\u9632\u98ce\u9669\u3002\u4e86\u89e3 CSV \u7684\u5177\u4f53\u89c4\u8303\u6709\u52a9\u4e8e\u8ba9\u6211\u4eec\u77e5\u9053\u5728\u54ea\u4e9b\u73af\u8282\u53ef\u80fd\u53d1\u751f\u95ee\u9898\uff0c\u5e76\u4f5c\u51fa\u5fc5\u8981\u7684\u9632\u8303\u3002\u5047\u5982\u5bf9 CSV \u7684\u652f\u6301\u662f\u4e00\u4e2a\u975e\u5e38\u91cd\u8981\u7684\u9700\u6c42\uff0c\u4e0d\u59a8\u8003\u8651\u628a\u5b83\u63d0\u53d6\u51fa\u6765\u4f5c\u4e3a\u5355\u72ec\u7684\u5e93/\u670d\u52a1\uff0c\u5bf9\u5916\u63d0\u4f9b\u7edf\u4e00\u7684\u63a5\u53e3\uff0c\u907f\u514d\u8ba9\u6bcf\u4e2a\u7a0b\u5e8f\u90fd\u5b9e\u73b0\u4e00\u5957\u81ea\u5df1\u7684 CSV \u8bfb\u5199\u903b\u8f91\uff0c\u4ee5\u9632\u6b62\u53ef\u80fd\u51fa\u73b0\u7684\u517c\u5bb9\u6027\u95ee\u9898\u3002</p>"},{"location":"basic/15.%E6%95%B0%E6%8D%AE%E6%96%87%E4%BB%B6%E6%A0%BC%E5%BC%8F/#csv-json","title":"CSV \u548c JSON \u683c\u5f0f\u7684\u7f3a\u70b9","text":"<p>CSV \u548c JSON \u90fd\u662f\u5c5e\u4e8e\u6587\u672c\u5b58\u50a8\u3002\u4f18\u70b9\u4e00\u5728\u4e8e\u6613\u4e8e\u4eba\u7c7b\u7406\u89e3\u3002\u53e6\u4e00\u4e2a\u4f18\u70b9\u5c31\u662f\u76f4\u63a5\u517c\u5bb9\u5176\u4ed6\u652f\u6301 CSV \u548c JSON \u7684\u6570\u636e\u5e93\u3002\u7f3a\u70b9\u4e5f\u5f88\u660e\u663e\uff0c\u5b58\u50a8\u6548\u7387\u4e0d\u9ad8\uff0c\u8bfb\u53d6\u6548\u7387\u4e5f\u4f1a\u968f\u4e4b\u964d\u4f4e\u3002</p> <p>\u53e6\u4e00\u4e2a\u95ee\u9898\u5728\u4e8e\uff0c\u6709\u4e9b CSV \u662f\uff0c\u6ca1\u6709 type \u548c size(metadata)\uff0c\u8fd9\u4e9b\u4fe1\u606f\u5728\u540e\u7eed\u64cd\u4f5c\u5982\u6821\u9a8c\u4e2d\u662f\u5f88\u91cd\u8981\u7684\u3002\u8868\u662f\u6bcf\u4e2a\u5173\u7cfb\u578b\u6570\u636e\u5e93\u6700\u57fa\u672c\u7684\u5b58\u50a8\u5bf9\u8c61\u3002</p> <p>\u7ed9\u5b9a\u4e00\u5f20\u8868\uff0c\u5e94\u8be5\u600e\u4e48\u5b58\u5728\u6587\u4ef6\u4e2d\u5462\uff1f\u5f53\u7136\u53ef\u4ee5\u7528 CSV \u683c\u5f0f\u7684\u6587\u4ef6\u6765\u5b58\u50a8\u3002\u786e\u5b9e\uff0cCSV \u6587\u4ef6\u4e2d\u7684\u6bcf\u4e00\u884c\u5bf9\u5e94\u4e8e\u4e00\u6761 row\uff0c\u6bcf\u4e2a row \u7684\u4e0d\u540c column \u7528\u9017\u53f7\u9694\u5f00\uff0c\u4e00\u4e2a\u6587\u4ef6\u5bf9\u5e94\u4e86\u4e00\u5f20\u8868\u3002</p> <p>\u4e13\u4e1a\u6570\u636e\u5e93\u80af\u5b9a\u4e0d\u4f1a\u9009\u62e9\u7528 CSV \u6216 JSON \u4f5c\u4e3a\u9ed8\u8ba4\u5b58\u50a8\uff0c\u4f46\u51e0\u4e4e\u90fd\u652f\u6301 CSV \u548c JSON \u6570\u636e\u4f5c\u4e3a <code>external table</code>\u3002</p> <p>\u5982\u679c\u8981\u8ffd\u6c42\u66f4\u9ad8\u7684\u6027\u80fd\uff0c\u6211\u4eec\u53ef\u4ee5\u9009\u62e9\u66f4\u9ad8\u6548\u7684\u7f16\u7801\u65b9\u5f0f\u628a\u6570\u636e\u4ee5\u5b57\u8282\u6d41\u7684\u5f62\u5f0f\u5b58\u50a8\u5728\u6587\u4ef6\u4e2d\uff1b\u53ea\u8981\u6570\u636e\u5e93\u7cfb\u7edf\u81ea\u8eab\u80fd\u591f\u8bfb\u53d6\u8fd9\u4e9b\u6570\u636e\u5373\u53ef\u3002</p> <p>\u5916\u90e8\u8868 \u662f <code>PostgreSQL</code> \u5f15\u5165\u5916\u90e8\u6570\u636e\u7684\u5165\u53e3\uff0c\u4efb\u4f55\u7684\u5916\u90e8\u6570\u636e\u6e90\u90fd\u53ef\u4ee5\u4f7f\u7528\u8be5\u63a5\u53e3\u628a\u6570\u636e\u5f15\u5165\u5230\u6570\u636e\u5e93\u4e2d\u3002\u7528\u6237\u53ef\u4ee5\u50cf\u8bbf\u95ee\u8868\u4e00\u6837\u8bfb\u5199\u5916\u90e8\u6570\u636e\u6e90\u4e0a\u7684\u6570\u636e\u3002\u5f88\u591a\u5f15\u64ce\u90fd\u652f\u6301\u5916\u90e8\u8868\uff0c\u6bd4\u5982 StarRocks\uff0chive \u7b49\u7b49\u3002</p>"},{"location":"basic/15.%E6%95%B0%E6%8D%AE%E6%96%87%E4%BB%B6%E6%A0%BC%E5%BC%8F/#_3","title":"\u884c\u5b58\u50a8","text":"<p>\u770b\u4e00\u4e0b CSV \u6216\u8005 JSON \u8fd9\u6837\u7684\u57fa\u4e8e\u884c\u7684\u5b58\u50a8\u683c\u5f0f\u662f\u5982\u4f55\u5b58\u50a8\u6570\u636e\u7684\u3002</p> <p>\u987e\u540d\u601d\u4e49\uff0c\u6570\u636e\u662f\u6309\u884c\u5b58\u50a8\u5728\u78c1\u76d8\u4e0a\u7684\u3002\u6bcf\u4e00\u884c\u7684\u6570\u636e\u90fd\u5b58\u50a8\u5728\u4e00\u4e2a\u8fde\u7eed\u7684\u5757\u4e2d\uff0c\u8fd9\u4f7f\u5f97\u6574\u4f53\u8bfb\u53d6\u548c\u5199\u5165\u6bd4\u8f83\u5bb9\u6613\u4e14\u76f4\u89c2\u3002\u57fa\u4e8e\u884c\u7684\u5b58\u50a8\u683c\u5f0f\u975e\u5e38\u9002\u5408\u4e8b\u52a1\u578b\u5de5\u4f5c\u8d1f\u8f7d\uff0c\u56e0\u4e3a\u8bb0\u5f55\u901a\u5e38\u662f\u5355\u6761\u63d2\u5165\u3001\u66f4\u65b0\u6216\u8005\u5220\u9664\u64cd\u4f5c\u3002</p>"},{"location":"basic/15.%E6%95%B0%E6%8D%AE%E6%96%87%E4%BB%B6%E6%A0%BC%E5%BC%8F/#_4","title":"15. MySQL\u6570\u636e\u6587\u4ef6\u683c\u5f0f","text":"<p>Parquet\u4ec5\u4ec5\u662f\u4e00\u79cd\u5b58\u50a8\u683c\u5f0f\uff0c\u5b83\u662f\u8bed\u8a00\u3001\u5e73\u53f0\u65e0\u5173\u7684\uff0c\u5e76\u4e14\u4e0d\u9700\u8981\u548c\u4efb\u4f55\u4e00\u79cd\u6570\u636e\u5904\u7406\u6846\u67b6\u7ed1\u5b9a\uff0c\u76ee\u524d\u80fd\u591f\u548cParquet\u9002\u914d\u7684\u7ec4\u4ef6\u5305\u62ec\u4e0b\u9762\u8fd9\u4e9b\uff0c\u53ef\u4ee5\u770b\u51fa\u57fa\u672c\u4e0a\u901a\u5e38\u4f7f\u7528\u7684\u67e5\u8be2\u5f15\u64ce\u548c\u8ba1\u7b97\u6846\u67b6\u90fd\u5df2\u9002\u914d\uff0c\u5e76\u4e14\u53ef\u4ee5\u5f88\u65b9\u4fbf\u7684\u5c06\u5176\u5b83\u5e8f\u5217\u5316\u5de5\u5177\u751f\u6210\u7684\u6570\u636e\u8f6c\u6362\u6210Parquet\u683c\u5f0f\u3002</p>"},{"location":"basic/16.MySQL%E5%88%86%E5%8C%BA%E8%A1%A8/","title":"\u5206\u533a\u8868\u6982\u8ff0","text":"<p>\u5206\u533a\u662f\u4e00\u79cd\u8868\u7684\u8bbe\u8ba1\u6a21\u5f0f\uff0c\u6b63\u786e\u7684\u5206\u533a\u53ef\u4ee5\u6781\u5927\u5730\u63d0\u5347\u6570\u636e\u5e93\u7684\u67e5\u8be2\u6548\u7387\uff0c\u5b8c\u6210\u66f4\u9ad8\u8d28\u91cf\u7684SQL\u7f16\u7a0b\u3002</p> <p>MySQL\u6570\u636e\u5e93\u5728**5.1\u7248\u672c\u53ca\u4ee5\u4e0a**\u65f6\u6dfb\u52a0\u4e86\u5bf9\u5206\u533a\u7684\u652f\u6301\uff0c\u5206\u533a\u7684\u8fc7\u7a0b\u662f\u5c06\u4e00\u4e2a\u8868\u6216\u7d22\u5f15\u5206\u89e3\u4e3a\u591a\u4e2a\u66f4\u5c0f\u3001\u66f4\u53ef\u7ba1\u7406\u7684\u90e8\u5206\u3002</p> <p>\u5c31\u8bbf\u95ee\u6570\u636e\u5e93\u7684\u5e94\u7528\u800c\u8a00\uff0c\u4ece\u903b\u8f91\u4e0a\u8bb2\uff0c\u53ea\u6709\u4e00\u4e2a\u8868\u6216\u4e00\u4e2a\u7d22\u5f15\uff0c\u4f46\u662f\u5728\u7269\u7406\u4e0a\u8fd9\u4e2a\u8868\u6216\u7d22\u5f15\u53ef\u80fd\u7531\u6570\u5341\u4e2a\u7269\u7406\u5206\u533a\u7ec4\u6210\u3002\u6bcf\u4e2a\u5206\u533a\u90fd\u662f\u72ec\u7acb\u7684\u5bf9\u8c61\uff0c\u53ef\u4ee5\u72ec\u81ea\u5904\u7406\uff0c\u4e5f\u53ef\u4ee5\u4f5c\u4e3a\u4e00\u4e2a\u66f4\u5927\u5bf9\u8c61\u7684\u4e00\u90e8\u5206\u8fdb\u884c\u5904\u7406\u3002</p> <p>MySQL\u6570\u636e\u5e93\u652f\u6301\u7684\u5206\u533a\u7c7b\u578b\u4e3a\u6c34\u5e73\u5206\u533a\uff08\u6307\u5c06\u540c\u4e00\u4e2a\u8868\u4e2d\u4e0d\u540c\u884c\u7684\u8bb0\u5f55\u5206\u914d\u5230\u4e0d\u540c\u7684\u7269\u7406\u6587\u4ef6\u4e2d\uff09\uff0c\u5e76\u4e0d\u652f\u6301\u5782\u76f4\u5206\u533a\uff08\u6307\u5c06\u540c\u4e00\u8868\u4e2d\u4e0d\u540c\u5217\u7684\u8bb0\u5f55\u5206\u914d\u5230\u4e0d\u540c\u7684\u7269\u7406\u6587\u4ef6\u4e2d\uff09\u3002\u6b64\u5916\uff0cMySQL\u6570\u636e\u5e93\u7684\u5206\u533a\u662f\u5c40\u90e8\u5206\u533a\u7d22\u5f15\uff0c\u4e00\u4e2a\u5206\u533a\u4e2d\u65e2\u5b58\u653e\u4e86\u6570\u636e\u53c8\u5b58\u653e\u4e86\u7d22\u5f15\u3002\u800c\u5168\u5c40\u5206\u533a\u662f\u6307\uff0c\u6570\u636e\u5b58\u653e\u5728\u5404\u4e2a\u5206\u533a\u4e2d\uff0c\u4f46\u662f\u6240\u6709\u6570\u636e\u7684\u7d22\u5f15\u653e\u5728\u4e00\u4e2a\u5bf9\u8c61\u4e2d\u3002\u76ee\u524d\uff0cMySQL\u6570\u636e\u5e93\u8fd8\u4e0d\u652f\u6301\u5168\u5c40\u5206\u533a\u3002</p> <p>\u5206\u533a\u7684\u597d\u5904\u662f\uff1a - \u53ef\u4ee5\u8ba9\u5355\u8868\u5b58\u50a8\u66f4\u591a\u7684\u6570\u636e - \u5206\u533a\u8868\u7684\u6570\u636e\u66f4\u5bb9\u6613\u7ef4\u62a4\uff0c\u53ef\u4ee5\u901a\u8fc7\u6e05\u695a\u6574\u4e2a\u5206\u533a\u6279\u91cf\u5220\u9664\u5927\u91cf\u6570\u636e\uff0c\u4e5f\u53ef\u4ee5\u589e\u52a0\u65b0\u7684\u5206\u533a\u6765\u652f\u6301\u65b0\u63d2\u5165\u7684\u6570\u636e\u3002\u53e6\u5916\uff0c\u8fd8\u53ef\u4ee5\u5bf9\u4e00\u4e2a\u72ec\u7acb\u5206\u533a\u8fdb\u884c\u4f18\u5316\u3001\u68c0\u67e5\u3001\u4fee\u590d\u7b49\u64cd\u4f5c - \u90e8\u5206\u67e5\u8be2\u80fd\u591f\u4ece\u67e5\u8be2\u6761\u4ef6\u786e\u5b9a\u53ea\u843d\u5728\u5c11\u6570\u5206\u533a\u4e0a\uff0c\u901f\u5ea6\u4f1a\u5f88\u5feb\uff08\u67e5\u8be2\u6761\u4ef6\u5c3d\u91cf\u626b\u63cf\u5c11\u7684\u5206\u533a\uff09 - \u5206\u533a\u8868\u7684\u6570\u636e\u8fd8\u53ef\u4ee5\u5206\u5e03\u5728\u4e0d\u540c\u7684\u7269\u7406\u8bbe\u5907\u4e0a\uff0c\u4ece\u800c\u9ad8\u6548\u5229\u7528\u591a\u4e2a\u786c\u4ef6\u8bbe\u5907 - \u53ef\u4ee5\u4f7f\u7528\u5206\u533a\u8868\u6765\u907f\u514d\u67d0\u4e9b\u7279\u6b8a\u74f6\u9888\uff0c\u4f8b\u5982InnoDB\u5355\u4e2a\u7d22\u5f15\u7684\u4e92\u65a5\u8bbf\u95ee\u3001ext3\u6587\u4ef6\u7cfb\u7edf\u7684inode\u9501\u7ade\u4e89 - \u53ef\u4ee5\u5907\u4efd\u548c\u6062\u590d\u5355\u4e2a\u5206\u533a</p> <p>\u5206\u533a\u7684\u9650\u5236\u548c\u7f3a\u70b9\uff1a - \u4e00\u4e2a\u8868\u6700\u591a\u53ea\u80fd\u67091024\u4e2a\u5206\u533a - \u5982\u679c\u5206\u533a\u5b57\u6bb5\u4e2d\u6709\u4e3b\u952e\u6216\u8005\u552f\u4e00\u7d22\u5f15\u7684\u5217\uff0c\u90a3\u4e48\u6240\u6709\u4e3b\u952e\u5217\u548c\u552f\u4e00\u7d22\u5f15\u5217\u90fd\u5fc5\u987b\u5305\u542b\u8fdb\u6765 - \u5206\u533a\u8868\u65e0\u6cd5\u4f7f\u7528\u5916\u952e\u7ea6\u675f - NULL\u503c\u4f1a\u4f7f\u5206\u533a\u8fc7\u6ee4\u65e0\u6548 - \u6240\u6709\u5206\u533a\u5fc5\u987b\u4f7f\u7528\u76f8\u540c\u7684\u5b58\u50a8\u5f15\u64ce</p>"},{"location":"basic/16.MySQL%E5%88%86%E5%8C%BA%E8%A1%A8/#_2","title":"\u5206\u533a\u7c7b\u578b","text":"<p>\u7b2c\u4e00\u79cd\u5206\u533a\u7c7b\u578b\u662fRANGE\u5206\u533a\uff0c\u4e5f\u662f\u6700\u5e38\u7528\u7684\u4e00\u79cd\u5206\u533a\u7c7b\u578b\uff0c\u57fa\u4e8e\u5c5e\u4e8e\u4e00\u4e2a\u7ed9\u5b9a\u8fde\u7eed\u533a\u95f4\u7684\u5217\u503c\uff0c\u628a\u591a\u884c\u5206\u914d\u7ed9\u5206\u533a\u3002</p> <p>\u8fd9\u4e9b\u533a\u95f4\u8981\u8fde\u7eed\u4e14\u4e0d\u80fd\u76f8\u4e92\u91cd\u53e0\uff0c\u4f7f\u7528VALUES LESS THAN\u64cd\u4f5c\u7b26\u6765\u8fdb\u884c\u5b9a\u4e49\u3002\u4e0d\u4f7f\u7528COLUMNS\u5173\u952e\u5b57\u65f6RANGE\u62ec\u53f7\u5185\u5fc5\u987b\u4e3a\u6574\u6570\u5b57\u6bb5\u540d\u6216\u8fd4\u56de\u786e\u5b9a\u6574\u6570\u7684\u51fd\u6570\u3002</p> <p>\u4e0b\u9762\u521b\u5efa\u4e00\u4e2a\u4ee5id\u5217\u4e3a\u533a\u95f4\u5206\u533a\u8868\uff0c\u5f53id\u5c0f\u4e8e10\u65f6\uff0c\u6570\u636e\u63d2\u5165p0\u5206\u533a\uff1b\u5f53id\u5927\u4e8e\u7b49\u4e8e10\u5c0f\u4e8e20\u65f6\uff0c\u6570\u636e\u63d2\u5165p1\u5206\u533a\u3002</p> <pre><code>CREATE TABLE employees (\n    id INT NOT NULL COMMENT '\u5458\u5de5\u552f\u4e00\u7f16\u53f7',\n    fname VARCHAR(30) COMMENT '\u5458\u5de5\u540d',\n    lname VARCHAR(30) COMMENT '\u5458\u5de5\u59d3',\n    hired DATE NOT NULL DEFAULT '1970-01-01' COMMENT '\u5165\u804c\u65e5\u671f',\n    separated DATE NOT NULL DEFAULT '9999-12-31' COMMENT '\u79bb\u804c\u65e5\u671f\uff089999-12-31 \u8868\u793a\u5728\u804c\uff09',\n    job_code INT NOT NULL COMMENT '\u804c\u4f4d\u4ee3\u7801',\n    store_id INT NOT NULL COMMENT '\u6240\u5c5e\u95e8\u5e97ID'\n) COMMENT='\u5458\u5de5\u57fa\u672c\u4fe1\u606f\u8868';\n\n\nCREATE TABLE employees (\n    id INT NOT NULL COMMENT '\u5458\u5de5\u552f\u4e00\u7f16\u53f7',\n    fname VARCHAR(30) COMMENT '\u5458\u5de5\u540d',\n    lname VARCHAR(30) COMMENT '\u5458\u5de5\u59d3',\n    hired DATE NOT NULL DEFAULT '1970-01-01' COMMENT '\u5165\u804c\u65e5\u671f',\n    separated DATE NOT NULL DEFAULT '9999-12-31' COMMENT '\u79bb\u804c\u65e5\u671f\uff089999-12-31 \u8868\u793a\u5728\u804c\uff09',\n    job_code INT NOT NULL COMMENT '\u804c\u4f4d\u4ee3\u7801',\n    store_id INT NOT NULL COMMENT '\u6240\u5c5e\u95e8\u5e97ID\uff08\u5206\u533a\u952e\uff09'\n) COMMENT='\u5458\u5de5\u57fa\u672c\u4fe1\u606f\u8868\uff0c\u6309\u95e8\u5e97ID\u5206\u533a\u5b58\u50a8'\nPARTITION BY RANGE (store_id) (  -- \u6309\u7167\u95e8\u5e97ID\u8303\u56f4\u8fdb\u884c\u5206\u533a\n    PARTITION p0 VALUES LESS THAN (6)  COMMENT '\u95e8\u5e97ID &lt; 6 \u7684\u5458\u5de5\uff08\u5206\u533a p0\uff09',\n    PARTITION p1 VALUES LESS THAN (11) COMMENT '6 &lt;= \u95e8\u5e97ID &lt; 11 \u7684\u5458\u5de5\uff08\u5206\u533a p1\uff09',\n    PARTITION p2 VALUES LESS THAN (16) COMMENT '11 &lt;= \u95e8\u5e97ID &lt; 16 \u7684\u5458\u5de5\uff08\u5206\u533a p2\uff09',\n    PARTITION p3 VALUES LESS THAN (21) COMMENT '16 &lt;= \u95e8\u5e97ID &lt; 21 \u7684\u5458\u5de5\uff08\u5206\u533a p3\uff09'\n);\n</code></pre>"},{"location":"basic/17.MySQL%E5%BF%AB%E9%80%9F%E5%AF%BC%E5%85%A5%E6%95%B0%E6%8D%AE/","title":"\u5feb\u901f\u5bfc\u5165\u6570\u636e","text":"<p>MySQL\u652f\u6301\u4f7f\u7528<code>LOAD DATA LOCAL INFILE</code>\u8bed\u53e5\uff0c\u5373\u53ef\u5c06\u5ba2\u6237\u7aef\u672c\u5730\u7684\u6587\u4ef6\u4e2d\u7684\u6570\u636eINSERT\u5230MySQL\u7684\u67d0\u5f20\u8868\u4e2d\u3002 \u6ce8\u610f\uff0c\u8fd8\u6709\u4e2a<code>LOAD DATA INFILE</code>\u8bed\u53e5\uff0c\u8fd9\u662f\u52a0\u8f7d\u670d\u52a1\u7aef\u7684\u6587\u4ef6\u800c\u975e\u5ba2\u6237\u7aef\u7684\u3002</p> <p>\u8fd9\u6761\u547d\u4ee4\u8bbe\u8ba1\u5c31\u662f\u4e3a\u4e86\u5feb\u901f\u5bfc\u5165\u3002\u6587\u4ef6\u683c\u5f0f\u7c7b\u4f3cCSV\uff0c\u53ef\u4ee5\u624b\u52a8\u6307\u5b9a\u5206\u9694\u7b26\u7b49\u7b49\u3002\u8be6\u7ec6\u7528\u6cd5\u8bf7\u53c2\u8003\u6587\u6863\u3002</p> <p><code>LOAD DATA LOCAL INFILE</code>\u7684\u5de5\u4f5c\u8fc7\u7a0b\u5927\u81f4\u5982\u4e0b\uff1a 1.\u7528\u6237\u5728\u5ba2\u6237\u7aef\u8f93\u5165\uff1aload data local file \u201c/data.txt\u201d into table test\uff1b 2.\u5ba2\u6237\u7aef-&gt;\u670d\u52a1\u7aef\uff1a\u6211\u60f3\u628a\u6211\u672c\u5730\u7684/data.txt\u6587\u4ef6\u63d2\u5165\u5230test\u8868\u4e2d\uff1b 3.\u670d\u52a1\u7aef-&gt;\u5ba2\u6237\u7aef\uff1a\u628a\u4f60\u672c\u5730\u7684/data.txt\u6587\u4ef6\u53d1\u7ed9\u6211\uff1b 4.\u5ba2\u6237\u7aef-&gt;\u670d\u52a1\u7aef\uff1a/data.txt\u6587\u4ef6\u7684\u5185\u5bb9\uff1b</p> <pre><code>-- \u903b\u8f91\u5bfc\u51fa\u53ef\u4ee5\u4f7f\u7528 mysqldump\u6216select ... into outfile \u8bed\u53e5\uff0c\u7136\u540e\u4f7f\u7528 mysqlimport \u6216 load data \u7b49\u8bed\u53e5\u6765\u5bfc\u5165\u6570\u636e\n--  \u4f18\u70b9\uff1a\u6062\u590d\u901f\u5ea6\u975e\u5e38\u5feb\uff0c\u6bd4insert\u7684\u63d2\u5165\u901f\u5ea6\u5feb\u5f88\u591a\uff0c\u6839\u636e\u5b98\u7f51\u6587\u6863\uff0c\u8bf4\u662f\u5feb20\u500d\u3002\n-- \u7f3a\u70b9\uff1a\u53ea\u80fd\u5907\u4efd\u8868\u6570\u636e\uff0c\u5e76\u4e0d\u80fd\u5305\u542b\u8868\u7ed3\u6784\uff1b\u5982\u679c\u8868\u88abdrop\uff0c\u662f\u65e0\u6cd5\u6062\u590d\u6570\u636e\u7684\u3002\uff08\u53ea\u662fselect ... into outfile\uff09\n\n-- select into outfile \u5bfc\u51fa\u8868\nselect col1\uff0c col2 from table-name into outfile  '/path/\u5907\u4efd\u6587\u4ef6\u540d\u79f0'\n\n-- \u5c06tt\u8868\u6570\u636e\u5907\u4efd\u5230tmp\u76ee\u5f55\u4e0b\u7684tt.sql\u6587\u4ef6(\u5982\u679ctt.sql\u6587\u4ef6\u5b58\u5728\uff0c\u4f1a\u62a5\u9519\u6587\u4ef6\u5df2\u7ecf\u5b58\u5728)\nselect * from tt into outfile '/tmp/tt.sql';\n\n-- \u5bfc\u5165\u6570\u636e\nLOAD DATA INFILE '/path/\u5907\u4efd\u6587\u4ef6' into table database.tt\n\n\n-- \u5c06tmp\u4e0b\u7684tt.sql\u6587\u4ef6\u6062\u590d\u5230tt\u8868\nload data infile '/tmp/tt.sql' into table db.tt\n\n-- load data\u4e0einsert\u901f\u5ea6\u5bf9\u6bd4\n-- \u4ee5\u63d2\u516510\u4e07\u6761\u6570\u636e\u4e3a\u4f8b\uff0cload data\u9700\u8981\u5927\u69821.4s\uff0cinsert\u5927\u6982\u9700\u898112.2s\uff0c\u5927\u6982\u662finsert\u768412\u500d\u3002\n</code></pre> <p>\u4e3a\u4ec0\u4e48\u662f\u6700\u5feb\u7684\uff1f - \u4e0d\u9700\u8981\u89e3\u6790SQL\uff0c\u7701CPU\u7701\u5185\u5b58\u3002 - \u670d\u52a1\u5668\u662f\u6309\u4e00\u4e2a\u5927\u5757\u6765\u8bfb\u53d6\u6587\u4ef6\u7684(Big block,\u5e94\u8be5\u662fread buffer\u91cc\u7684block,\u76ee\u524d\u6743\u5f53\u5b57\u9762\u610f\u4e49\u3002\u4e5f\u53ef\u80fd\u662f\u628aI/O\u5355\u4f4d\u5f04\u7684\u5f88\u5927\u8282\u7ea6I/O, \u6279\u91cf\u5904\u7406\u3002) - \u4f1a\u81ea\u52a8\u7981\u7528\u7d22\u5f15(UNIQUE\u9664\u5916) - \u5f15\u64ce\u4f1a\u5148\u7f13\u5b58\u884c\u518d\u5199\u5165\u4e00\u4e2a\u5927\u5757(MyISAM\uff0cAria\u652f\u6301) - \u5bf9\u4e8e\u7a7a\u8868\uff0c\u50cfAria\u8fd9\u6837\u7684\u4e8b\u52a1\u5f15\u64ce\u4f1a\u505c\u6b62log\u63d2\u5165\u4e8b\u52a1\u3002\u6bd5\u7adf\u56de\u6eda\u64cd\u4f5c\u76f4\u63a5\u5220\u8868\u5c31\u884c\u3002</p>"},{"location":"basic/17.MySQL%E5%BF%AB%E9%80%9F%E5%AF%BC%E5%85%A5%E6%95%B0%E6%8D%AE/#_2","title":"\u63d2\u5165\u901f\u5ea6\u4f18\u5316\u539f\u7406","text":""},{"location":"basic/17.MySQL%E5%BF%AB%E9%80%9F%E5%AF%BC%E5%85%A5%E6%95%B0%E6%8D%AE/#_3","title":"\u8868\u7a7a\u95f4\u4f20\u8f93","text":"<p>\u5728MySQL 5.6.6\u7248\u672c\u4e2d\u5f15\u5165\u4e86\u4e00\u79cd\u57fa\u4e8e\u8868\u7a7a\u95f4\u5feb\u901f\u8fc1\u79fb\u7684\u529f\u80fd\uff08\u7c7b\u4f3cOracle TTS\uff09\uff0c\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u5c06\u8868\u7a7a\u95f4\u590d\u5236\u5230\u53e6\u4e00\u53f0\u670d\u52a1\u5668\u6570\u636e\u5e93\u4e2d\u3002\u8fd9\u5bf9\u4e8e\u5927\u8868\u6765\u8bf4\u662f\u4e00\u4e2a\u975e\u5e38\u6709\u7528\u7684\u65b9\u6cd5\u3002\u53ef\u4f20\u8f93\u8868\u7a7a\u95f4\u673a\u5236\u6bd4\u4efb\u4f55\u5176\u4ed6\u5bfc\u51fa\u548c\u5bfc\u5165\u8868\u7684\u65b9\u6cd5\u90fd\u5feb\uff0c\u56e0\u4e3a\u53ea\u9700\u8981\u4f7f\u7528\u4f20\u7edf\u7684 Linux \u547d\u4ee4\uff08cp\u3001scp\u3001rsync\uff09\u5c06\u6570\u636e\u6587\u4ef6\u590d\u5236\u5230\u76ee\u6807\u4f4d\u7f6e\u5373\u53ef\u3002</p> <p>InnoDB\u4e2d\u652f\u6301<code>Transportable Tablespace</code>\u529f\u80fd\u3002\u4e5f\u5c31\u662f\u8868\u7a7a\u95f4\u53ef\u4ee5\u4ece\u4e00\u4e2a\u5b9e\u4f8b\u8fc1\u79fb\u5230\u53e6\u4e00\u4e2a\u5b9e\u4f8b\u3002\u76f8\u6bd4mysqldump\u6765\u8fdb\u884c\u5bfc\u5165\u5bfc\u51fa\u800c\u8a00\uff0c\u901f\u5ea6\u66f4\u5feb\uff0c\u800c\u4e14\u4f7f\u7528\u4e5f\u5f88\u4fbf\u6377\u3002</p> <p>\u8868\u7a7a\u95f4\u7684\u5bfc\u51fa\uff08export\uff09\u3002\u5728\u6e90\u5b9e\u4f8b\u4e2d\uff0c\u6267\u884c<code>FLUSH TABLES t FOR EXPORT</code>\u3002\u9996\u5148\u5bf9\u8868\u4e0a\u6392\u4ed6\u9501\uff0c\u5373\u505c\u8bfb\u5199\u3002</p> <p>\u5176\u6b21\uff0c\u505cpurge\u7ebf\u7a0b\uff1b\u6700\u540e\u5199\u810f\u9875\u5e76\u4ece\u7f13\u51b2\u533a\u6e05\u9664\u3002\u5230\u6b64\u6587\u4ef6\u53ef\u4ee5\u62f7\u8d1d\u4e86\u3002\u6ce8\u610f\uff0c\u8fd9\u91cc\u505c\u4e86purge\u7ebf\u7a0b\uff0c\u6240\u4ee5\u5728\u8868\u7a7a\u95f4\u6587\u4ef6\u4e2d\u4f1a\u6709\u672a\u88abpurge\u7684\u8bb0\u5f55\u5b58\u5728\u3002</p>"},{"location":"basic/18.MySQL%E4%B8%B4%E6%97%B6%E8%A1%A8/","title":"\u4e34\u65f6\u8868","text":"<p>\u987e\u540d\u601d\u4e49\uff0c\u4e34\u65f6\u8868\u5c31\u662f\u4e34\u65f6\u7528\u6765\u5b58\u50a8\u6570\u636e\u7684\u8868\uff0c\u662f\u5efa\u7acb\u5728\u7cfb\u7edf\u4e34\u65f6\u6587\u4ef6\u5939\u4e2d\u7684\u8868\uff0c\u5982\u679c\u4f7f\u7528\u5f97\u5f53\uff0c\u5b8c\u5168\u53ef\u4ee5\u50cf\u666e\u901a\u8868\u4e00\u6837\u8fdb\u884c\u5404\u79cd\u64cd\u4f5c\u3002</p> <p>\u6211\u4eec\u5e38\u4f7f\u7528\u4e34\u65f6\u8868\u6765\u5b58\u50a8\u4e2d\u95f4\u7ed3\u679c\u96c6\u3002\u5982\u679c\u9700\u8981\u6267\u884c\u4e00\u4e2a\u5f88\u8017\u8d44\u6e90\u7684\u67e5\u8be2\u6216\u9700\u8981\u591a\u6b21\u64cd\u4f5c\u5927\u8868\u65f6\uff0c\u53ef\u4ee5\u628a\u4e2d\u95f4\u7ed3\u679c\u6216\u5c0f\u7684\u5b50\u96c6\u653e\u5230\u4e00\u4e2a\u4e34\u65f6\u8868\u91cc\uff0c\u518d\u5bf9\u8fd9\u4e9b\u8868\u8fdb\u884c\u67e5\u8be2\uff0c\u4ee5\u6b64\u6765\u63d0\u9ad8\u67e5\u8be2\u6548\u7387\u3002\u4e34\u65f6\u8868\u4e3b\u8981\u9002\u7528\u4e8e\u9700\u8981\u4e34\u65f6\u4fdd\u5b58\u6570\u636e\u7684\u4e00\u4e9b\u573a\u666f\u3002</p> <p>\u4e00\u822c\u60c5\u51b5\u4e0b\uff0c\u4e34\u65f6\u8868\u901a\u5e38\u662f\u5728\u5e94\u7528\u7a0b\u5e8f\u4e2d\u52a8\u6001\u521b\u5efa\u6216\u8005\u7531 MySQL \u5185\u90e8\u6839\u636e\u9700\u8981\u81ea\u5df1\u521b\u5efa\u3002\u4e34\u65f6\u8868\u53ef\u4ee5\u5206\u4e3a\u5185\u90e8\u4e34\u65f6\u8868\u548c\u5916\u90e8\u4e34\u65f6\u8868\u3002</p>"},{"location":"basic/18.MySQL%E4%B8%B4%E6%97%B6%E8%A1%A8/#_2","title":"\u5916\u90e8\u4e34\u65f6\u8868","text":"<p>\u5916\u90e8\u4e34\u65f6\u8868\u4e5f\u53ef\u79f0\u4e3a\u4f1a\u8bdd\u4e34\u65f6\u8868\uff0c\u8fd9\u79cd\u4e34\u65f6\u8868\u53ea\u5bf9\u5f53\u524d\u7528\u6237\u53ef\u89c1\uff0c\u5b83\u7684\u6570\u636e\u548c\u8868\u7ed3\u6784\u90fd\u5b58\u50a8\u5728\u5185\u5b58\u4e2d\u3002\u5f53\u524d\u4f1a\u8bdd\u4e2d\u65ad\u6216\u7ed3\u675f\u540e\uff0c\u6570\u636e\u8868\u6570\u636e\u5c31\u4f1a\u4e22\u5931\uff0cMySQL \u4f1a\u81ea\u52a8\u5220\u9664\u8868\u5e76\u91ca\u653e\u5176\u6240\u5360\u7a7a\u95f4\u3002</p> <p>1\uff09\u521b\u5efa\u4e34\u65f6\u8868 \u521b\u5efa\u4e34\u65f6\u8868\u5f88\u5bb9\u6613\uff0c\u5728 <code>CREATE TABLE</code> \u8bed\u53e5\u4e0a\u6dfb\u52a0 <code>TEMPORARY</code> \u5173\u952e\u5b57\uff0c\u5982\u4e0b\u6240\u793a\uff1a</p> <pre><code>CREATE TEMPORARY TABLE &lt;\u8868\u540d&gt;...\n</code></pre> <p>\u4e34\u65f6\u8868\u7684\u547d\u540d\u53ef\u4ee5\u548c\u975e\u4e34\u65f6\u8868\u540c\u540d\uff0c\u4f46\u662f\u540c\u540d\u540e\u975e\u4e34\u65f6\u8868\u5c06\u5bf9\u5f53\u524d\u4f1a\u8bdd\u4e0d\u53ef\u89c1\uff0c\u76f4\u5230\u4e34\u65f6\u8868\u88ab\u5220\u9664\u3002</p> <p>2\uff09\u67e5\u8be2\u4e34\u65f6\u8868</p> <p>\u521b\u5efa\u4e86\u4e34\u65f6\u8868\u4e4b\u540e\uff0c\u8fd0\u884c <code>SHOW TABLES</code> \u547d\u4ee4\u4e0d\u4f1a\u5217\u51fa\u4e34\u65f6\u8868\uff0c\u4ee5\u53ca\u5728 <code>INFORMATION_SCHEMA</code> \u6570\u636e\u5e93\u4e2d\u4e5f\u4e0d\u5b58\u5728\u4e34\u65f6\u8868\u7684\u4fe1\u606f\uff0c\u8fd9\u4e0d\u662f Bug\uff0c\u800c\u662f\u8bbe\u8ba1\u5c31\u662f\u5982\u6b64\u3002</p> <p>\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u6765\u67e5\u770b\u4e34\u65f6\u8868\uff1a</p> <pre><code>SHOW CREATE TABLE &lt;\u8868\u540d&gt;; \n</code></pre> <p>3\uff09\u5220\u9664\u4e34\u65f6\u8868</p> <p>\u5f53\u7136\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u5728\u5f53\u524d\u4f1a\u8bdd\u4e2d\u624b\u52a8\u9500\u6bc1\u4e34\u65f6\u8868\uff0cSQL \u8bed\u53e5\u5982\u4e0b\uff1a</p> <pre><code>DROP TABLE &lt;\u8868\u540d&gt;;\n</code></pre>"},{"location":"basic/18.MySQL%E4%B8%B4%E6%97%B6%E8%A1%A8/#_3","title":"\u5185\u90e8\u4e34\u65f6\u8868","text":"<p>\u5185\u90e8\u4e34\u65f6\u8868\u662f\u4e00\u79cd\u7279\u6b8a\u8f7b\u91cf\u7ea7\u7684\u4e34\u65f6\u8868\uff0c\u4e0d\u540c\u4e8e\u624b\u5de5\u521b\u5efa\u7684\u4e34\u65f6\u8868\uff0c\u5b83\u662f\u88ab MySQL \u81ea\u52a8\u521b\u5efa\u7684\u3002\u5728 SQL \u7684\u6267\u884c\u8fc7\u7a0b\u4e2d\u53ef\u80fd\u4f1a\u7528\u5230\u4e34\u65f6\u8868\u6765\u5b58\u50a8\u67d0\u4e9b\u64cd\u4f5c\u7684\u4e2d\u95f4\u7ed3\u679c\uff0c\u8be5\u8fc7\u7a0b\u7531 MySQL \u81ea\u52a8\u5b8c\u6210\uff0c\u7528\u6237\u65e0\u6cd5\u624b\u5de5\u5e72\u9884\uff0c\u4e14\u8fd9\u79cd\u5185\u90e8\u8868\u5bf9\u7528\u6237\u6765\u8bf4\u662f\u4e0d\u53ef\u89c1\u7684\u3002</p> <p>\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7 EXPLAIN \u6216\u8005 SHOW STATUS \u67e5\u770b MySQL \u662f\u5426\u4f7f\u7528\u4e86\u5185\u90e8\u4e34\u65f6\u8868\u5e2e\u52a9\u5b8c\u6210\u67d0\u4e2a\u64cd\u4f5c\u3002</p> <p>\u5185\u90e8\u4e34\u65f6\u8868\u5728 SQL \u8bed\u53e5\u7684\u4f18\u5316\u8fc7\u7a0b\u4e2d\u626e\u6f14\u7740\u975e\u5e38\u91cd\u8981\u7684\u89d2\u8272\uff0cMySQL \u4e2d\u7684\u5f88\u591a\u64cd\u4f5c\u90fd\u8981\u4f9d\u8d56\u4e8e\u5185\u90e8\u4e34\u65f6\u8868\u6765\u8fdb\u884c\u4f18\u5316\u3002\u4f46\u662f\u4f7f\u7528\u5185\u90e8\u4e34\u65f6\u8868\u9700\u8981\u521b\u5efa\u8868\u4ee5\u53ca\u4e2d\u95f4\u6570\u636e\u7684\u5b58\u53d6\u4ee3\u4ef7\uff0c\u6240\u4ee5\u7528\u6237\u5728\u5199 SQL \u8bed\u53e5\u7684\u65f6\u5019\u5e94\u8be5\u5c3d\u91cf\u7684\u53bb\u907f\u514d\u4f7f\u7528\u4e34\u65f6\u8868\u3002</p> <p>\u901a\u5e38\u60c5\u51b5\u4e0b\uff0c\u5185\u90e8\u4e34\u65f6\u8868\u9996\u5148\u4fdd\u7559\u5728\u5185\u5b58\u4e2d\uff0c\u4ee5\u83b7\u5f97\u6700\u4f73\u67e5\u8be2\u6027\u80fd\u3002\u4e3a\u907f\u514d\u5185\u5b58\u5206\u914d\u8fc7\u591a\uff0cMySQL \u63d0\u4f9b\u4e86\u53c2\u6570\uff0c\u53ef\u7528\u4e8e\u8bbe\u7f6e\u5185\u5b58\u9650\u5236\u3002\u5f53\u8fbe\u5230\u8be5\u9650\u5236\u65f6\uff0c\u5185\u90e8\u4e34\u65f6\u8868\u5c31\u4f1a\u6ea2\u51fa\u5230\u78c1\u76d8\u5b58\u50a8\u3002MySQL \u53ef\u80fd\u4f1a\u4e3a\u5185\u5b58\u4e2d\u7684\u5185\u90e8\u4e34\u65f6\u8868\u6307\u5b9a\u4e0e\u78c1\u76d8\u5b58\u50a8\u4e2d\u7684\u5185\u90e8\u4e34\u65f6\u8868\u4e0d\u540c\u7684\u5b58\u50a8\u5f15\u64ce\u3002</p> <p>\u57288.0\u7248\u4e4b\u524d\uff0cMySQL \u4f7f\u7528MEMORY\u5b58\u50a8\u5f15\u64ce\u4f5c\u4e3a\u5185\u5b58\u5185\u90e8\u4e34\u65f6\u8868\u7684\u9ed8\u8ba4\u5b58\u50a8\u5f15\u64ce\u3002MySQL 8.0 \u7528TempTable\u5b58\u50a8\u5f15\u64ce\u53d6\u4ee3\u4e86\u5b83\uff0c\u4f46\u4e5f\u63d0\u4f9b\u4e86\u5207\u6362\u56de MEMORY\u5b58\u50a8\u5f15\u64ce\u7684\u9009\u9879\u3002</p> <p>TempTable\u5b58\u50a8\u5f15\u64ce\u5728\u53ef\u7ba1\u7406\u6027\u65b9\u9762\u7684\u4e00\u4e2a\u5173\u952e\u7b80\u5316\u662f\uff0c\u5b83\u4e3a\u6240\u6709\u4f7f\u7528\u5b83\u7684\u4f1a\u8bdd\u4f7f\u7528\u4e00\u4e2a\u5185\u5b58\u6c60\u3002\u7531temptable_max_ram\u8bbe\u7f6e\u7684\u5185\u5b58\u9650\u5236\u9002\u7528\u4e8e\u5e76\u53d1\u4f1a\u8bdd\u7684\u5185\u5b58\u6d88\u8017\u603b\u548c\u3002\u8fd9\u4e0e MEMORY \u5b58\u50a8\u5f15\u64ce\u4e0d\u540c\uff0cMEMORY \u5b58\u50a8\u5f15\u64ce\u7684\u5185\u5b58\u9650\u5236\u7531\u8f83\u5c0f\u7684tmp_table_size\u548cmax_heap_table_size \u8bbe\u7f6e\uff0c\u662f\u9488\u5bf9\u4f1a\u8bdd\u7684\u6bcf\u4e2a\u8868\u3002TempTable \u5b58\u50a8\u5f15\u64ce\u4e5f\u6709\u81ea\u5df1\u7684\u78c1\u76d8\u6ea2\u51fa\u673a\u5236\u3002\u4f60\u53ef\u4ee5\u5c06\u5176\u914d\u7f6e\u4e3a\u6ea2\u51fa\u5230\u5185\u5b58\u6620\u5c04\u4e34\u65f6\u6587\u4ef6\u6216InnoDB \u78c1\u76d8\u5185\u90e8\u4e34\u65f6\u8868\u3002\u5185\u5b58\u6620\u5c04\u6587\u4ef6\u63d0\u4f9b\u4e86\u6587\u4ef6\u548c\u5185\u5b58\u7a7a\u95f4\u4e4b\u95f4\u7684\u6620\u5c04\uff0c\u53ef\u52a0\u5feb\u6587\u4ef6\u8bfb\u5199\u64cd\u4f5c\u3002\u9664\u4e86\u5185\u5b58\u9650\u5236\u5916\uff0c\u8fd9\u4e24\u79cd\u4e0d\u540c\u7684\u6ea2\u51fa\u8def\u5f84\u8fd8\u80fd\u5c55\u73b0\u5185\u90e8\u4e34\u65f6\u8868\u5b58\u50a8\u5f15\u64ce\u7684\u72ec\u7279\u4e4b\u5904\uff0c\u5e76\u76f4\u63a5\u5f71\u54cd\u67e5\u8be2\u6027\u80fd\u3002</p> <p>MySQL Server \u4f1a\u5728\u4ee5\u4e0b\u60c5\u51b5\u4e0b\u521b\u5efa\u4e34\u65f6\u8868\uff1a</p> <ul> <li> <p>\u8bc4\u4f30 UNION \u8bed\u53e5\uff08\u540e\u9762\u4f1a\u4ecb\u7ecd\u4e00\u4e9b\u4f8b\u5916\u60c5\u51b5\uff09</p> </li> <li> <p>\u8bc4\u4f30\u67d0\u4e9b\u89c6\u56fe\uff0c\u5982\u4f7f\u7528 TEMPTABLE \u7b97\u6cd5\u3001UNION \u6216\u805a\u5408\u7684\u89c6\u56fe</p> </li> <li> <p>\u6c42\u503c\u6d3e\u751f\u8868(derived tables)</p> </li> <li> <p>\u8bc4\u4f30\u5e38\u7528\u8868\u8868\u8fbe\u5f0f(common table expressions)</p> </li> <li> <p>\u4e3a\u5b50\u67e5\u8be2\u6216\u534a\u8fde\u63a5\u7269\u5316\u521b\u5efa\u7684\u8868</p> </li> <li> <p>\u8bc4\u4f30\u5305\u542bORDER BY\u5b50\u53e5\u548c\u4e0d\u540cGROUP BY\u5b50\u53e5\u7684\u8bed\u53e5\uff0c\u6216\u8005ORDER BY\u6216GROUP BY\u5305\u542b\u6765\u81ea\u8fde\u63a5\u961f\u5217\u4e2d\u7b2c\u4e00\u4e2a\u8868\u4ee5\u5916\u7684\u8868\u7684\u5217\u7684\u8bed\u53e5</p> </li> <li> <p>\u7ed3\u5408ORDER BY\u5bf9DISTINCT\u8fdb\u884c\u8bc4\u4f30\u53ef\u80fd\u9700\u8981\u4f7f\u7528\u4e34\u65f6\u8868\u3002</p> </li> <li> <p>\u5bf9\u4e8e\u4f7f\u7528SQL_SMALL_RESULT\u4fee\u6539\u5668\u7684\u67e5\u8be2\uff0cMySQL \u4f1a\u4f7f\u7528\u5185\u5b58\u4e2d\u7684\u4e34\u65f6\u8868\uff0c\u9664\u975e\u67e5\u8be2\u8fd8\u5305\u542b\u9700\u8981\u78c1\u76d8\u5b58\u50a8\u7684\u5143\u7d20</p> </li> <li> <p>\u8981\u8bc4\u4f30\u4ece\u540c\u4e00\u4e2a\u8868\u4e2d\u9009\u62e9\u5e76\u63d2\u5165\u5230\u540c\u4e00\u4e2a\u8868\u4e2d\u7684INSERT ... SELECT \u8bed\u53e5\uff0cMySQL \u4f1a\u521b\u5efa\u4e00\u4e2a\u5185\u90e8\u4e34\u65f6\u8868\u6765\u4fdd\u5b58SELECT \u4e2d\u7684\u8bb0\u5f55\uff0c\u7136\u540e\u5c06\u8fd9\u4e9b\u8bb0\u5f55\u63d2\u5165\u5230\u76ee\u6807\u8868\u4e2d</p> </li> <li> <p>\u8bc4\u4f30\u591a\u8868UPDATE\u8bed\u53e5</p> </li> <li> <p>\u8bc4\u4f30GROUP_CONCAT()\u6216COUNT(DISTINCT)\u8868\u8fbe\u5f0f</p> </li> <li> <p>\u8bc4\u4f30\u7a97\u53e3\u51fd\u6570\uff0c\u5fc5\u8981\u65f6\u4f7f\u7528\u4e34\u65f6\u8868\u3002</p> </li> </ul>"},{"location":"basic/18.MySQL%E4%B8%B4%E6%97%B6%E8%A1%A8/#_4","title":"\u5185\u90e8\u4e34\u65f6\u8868\u5b58\u50a8\u5f15\u64ce","text":"<p>\u5185\u90e8\u4e34\u65f6\u8868\u53ef\u4ee5\u901a\u8fc7TempTable\u6216MEMORY\u5f15\u64ce\u5b58\u50a8\u5728\u5185\u5b58\u4e2d\uff1b\u6216\u8005\u901a\u8fc7InnoDB\u5f15\u64ce\u5b58\u50a8\u5230\u78c1\u76d8\u4e0a\u3002</p> <p>\u4f4d\u4e8e\u5185\u5b58\u4e2d\u7684\u5185\u90e8\u4e34\u65f6\u8868\u5b58\u50a8\u5f15\u64ce\u662f\u901a\u8fc7\u53d8\u91cfinternal_tmp_mem_storage_engine \u6765\u8bbe\u7f6e\u7684\uff0c\u9ed8\u8ba4\u662fTempTable\uff0c\u6b64\u5916\u8fd8\u53ef\u4ee5\u8bbe\u7f6e\u4e3aMEMORY\u3002</p> <p>TempTable\u5f15\u64ce\u53ef\u4ee5\u9ad8\u6548\u5b58\u50a8varchar\u3001varbinary\u7c7b\u578b\u7684\u5217\u3002TempTable\u5f15\u64ce\u7684\u63a7\u5236\u53d8\u91cf\u6709\uff1a</p> <p>\u2022 tmp_table_size \uff1a</p> <p>\u4ece MySQL 8.0.28 \u5f00\u59cb\uff0ctmp_table_size\u5b9a\u4e49\u4e86\u7531 TempTable \u5b58\u50a8\u5f15\u64ce\u521b\u5efa\u7684\u4efb\u4f55\u5355\u4e2a\u5185\u5b58\u5185\u90e8\u4e34\u65f6\u8868\u7684\u6700\u5927\u5927\u5c0f\u3002\u5f53\u8fbe\u5230tmp_table_size\u9650\u5236\u65f6\uff0cMySQL \u4f1a\u81ea\u52a8\u5c06\u5185\u5b58\u5185\u90e8\u4e34\u65f6\u8868\u8f6c\u6362\u4e3aInnoDB\u57fa\u4e8e\u78c1\u76d8\u7684\u5185\u90e8\u4e34\u65f6\u8868\u3002\u9ed8\u8ba4\u7684tmp_table_size\u8bbe\u7f6e\u4e3a 16777216 \u5b57\u8282\uff0816MB\uff09\u3002</p> <p>tmp_table_size\u9650\u5236\u7684\u76ee\u7684\u662f\u9632\u6b62\u5355\u4e2a\u67e5\u8be2\u6d88\u8017\u8fc7\u591a\u7684\u5168\u5c40 TempTable \u8d44\u6e90\uff0c\u4ee5\u514d\u5f71\u54cd\u9700\u8981 TempTable \u8d44\u6e90\u7684\u5e76\u53d1\u67e5\u8be2\u7684\u6027\u80fd\u3002\u5168\u5c40TempTable\u8d44\u6e90\u7531temptable_max_ram\u548ctemptable_max_mmap\u8bbe\u7f6e\u63a7\u5236\u3002</p> <p>\u5982\u679ctmp_table_size\u9650\u5236\u5c0f\u4e8etemptable_max_ram\u9650\u5236\uff0c\u5185\u5b58\u4e2d\u4e34\u65f6\u8868\u6240\u5305\u542b\u7684\u6570\u636e\u5c31\u4e0d\u53ef\u80fd\u8d85\u8fc7tmp_table_size\u9650\u5236\u6240\u5141\u8bb8\u7684\u6570\u91cf\u3002\u5982\u679ctmp_table_size\u9650\u5236\u5927\u4e8etemptable_max_ram\u548ctemptable_max_mmap\u9650\u5236\uff0c\u5219\u5185\u5b58\u4e2d\u4e34\u65f6\u8868\u6240\u5305\u542b\u7684\u6570\u636e\u4e0d\u53ef\u80fd\u8d85\u8fc7temptable_max_ram\u548ctemptable_max_mmap\u9650\u5236\u3002</p> <p>\u2022 temptable_max_ram \uff1a</p> <p>\u5b9a\u4e49\u5728TempTable\u5b58\u50a8\u5f15\u64ce\u5f00\u59cb\u4ece\u5185\u5b58\u6620\u5c04\u6587\u4ef6\u5206\u914d\u7a7a\u95f4\uff0c\u6216\u8005\u5728 MySQL \u5f00\u59cb\u4f7f\u7528InnoDB\u57fa\u4e8e\u78c1\u76d8\u5185\u90e8\u4e34\u65f6\u8868\u4e4b\u524d\uff0cTempTable\u5b58\u50a8\u5f15\u64ce\u53ef\u4ee5\u4f7f\u7528\u7684\u6700\u5927\u5185\u5b58\u5bb9\u91cf\uff0c\u5177\u4f53\u53d6\u51b3\u4e8e\u914d\u7f6e\u3002\u9ed8\u8ba4temptable_max_ram\u8bbe\u7f6e\u4e3a 1073741824 \u5b57\u8282\uff081GB\uff09\u3002</p> <p>temptable_max_ram\u8bbe\u7f6e\u4e0d\u5305\u62ec\u5206\u914d\u7ed9\u4f7f\u7528TempTable\u5b58\u50a8\u5f15\u64ce\u7684\u6bcf\u4e2a\u7ebf\u7a0b\u7684\u7ebf\u7a0b\u672c\u5730\u5185\u5b58\u5757\u3002\u7ebf\u7a0b\u672c\u5730\u5185\u5b58\u5757\u7684\u5927\u5c0f\u53d6\u51b3\u4e8e\u7ebf\u7a0b\u7b2c\u4e00\u6b21\u5185\u5b58\u5206\u914d\u8bf7\u6c42\u7684\u5927\u5c0f\u3002\u5982\u679c\u8bf7\u6c42\u5c0f\u4e8e 1MB\uff08\u5927\u591a\u6570\u60c5\u51b5\u4e0b\u90fd\u5c0f\u4e8e 1MB\uff09\uff0c\u5219\u7ebf\u7a0b\u672c\u5730\u5185\u5b58\u5757\u5927\u5c0f\u4e3a 1MB\u3002\u5982\u679c\u8bf7\u6c42\u5927\u4e8e 1MB\uff0c\u5219\u7ebf\u7a0b\u672c\u5730\u5185\u5b58\u5757\u7684\u5927\u5c0f\u4e0e\u521d\u59cb\u5185\u5b58\u8bf7\u6c42\u5927\u81f4\u76f8\u540c\u3002\u7ebf\u7a0b\u672c\u5730\u5185\u5b58\u5757\u4fdd\u5b58\u5728\u7ebf\u7a0b\u672c\u5730\u5b58\u50a8\u4e2d\uff0c\u76f4\u5230\u7ebf\u7a0b\u9000\u51fa\u3002</p> <p>\u2022 temptable_use_mmap\uff1a</p> <p>\u5f53\u8d85\u8fc7temptable_max_ram\u9650\u5236\u65f6\uff0c\u63a7\u5236TempTable\u5b58\u50a8\u5f15\u64ce\u662f\u4ece\u5185\u5b58\u6620\u5c04\u6587\u4ef6\u5206\u914d\u7a7a\u95f4\uff0c\u8fd8\u662f MySQL \u4f7f\u7528InnoDB\u78c1\u76d8\u4e0a\u7684\u5185\u90e8\u4e34\u65f6\u8868\u3002\u9ed8\u8ba4\u8bbe\u7f6e\u4e3atemptable_use_mmap=ON\u3002</p> <p>temptable_use_mmap\u53d8\u91cf\u5728 MySQL 8.0.16 \u4e2d\u5f15\u5165\uff0c\u5728 MySQL 8.0.26 \u4e2d\u88ab\u5f03\u7528\uff1b\u9884\u8ba1\u672a\u6765\u7248\u672c\u7684 MySQL \u5c06\u5220\u9664\u5bf9\u5b83\u7684\u652f\u6301\u3002\u8bbe\u7f6etemptable_max_mmap=0\u7b49\u4e8e\u8bbe\u7f6etemptable_use_mmap=OFF\u3002</p> <p>\u2022 temptable_max_mmap\uff1a</p> <p>\u5728 MySQL 8.0.23 \u4e2d\u5f15\u5165\u3002\u5b9a\u4e49\u5728 MySQL \u5f00\u59cb\u4f7f\u7528InnoDB\u78c1\u76d8\u5185\u90e8\u4e34\u65f6\u8868\u4e4b\u524d\uff0c\u5141\u8bb8 TempTable \u5b58\u50a8\u5f15\u64ce\u4ece\u5185\u5b58\u6620\u5c04\u6587\u4ef6\u4e2d\u5206\u914d\u7684\u6700\u5927\u5185\u5b58\u91cf\u3002\u9ed8\u8ba4\u8bbe\u7f6e\u4e3a 1073741824 \u5b57\u8282\uff081GiB\uff09\u3002\u8be5\u9650\u5236\u65e8\u5728\u89e3\u51b3\u5185\u5b58\u6620\u5c04\u6587\u4ef6\u5360\u7528\u4e34\u65f6\u76ee\u5f55\uff08tmpdir\uff09\u592a\u591a\u7a7a\u95f4\u7684\u98ce\u9669\u3002\u5982\u679ctemptable_max_mmap=0\u8bbe\u7f6e\u4e3a\u7981\u7528\u5185\u5b58\u6620\u5c04\u6587\u4ef6\u7684\u5206\u914d\uff0c\u5219\u65e0\u8bbatemptable_use_mmap\u8bbe\u7f6e\u5982\u4f55\uff0c\u90fd\u5c06\u6709\u6548\u7981\u7528\u5185\u5b58\u6620\u5c04\u6587\u4ef6\u3002</p> <p>TempTable \u5f15\u64ce\u4f7f\u7528\u5185\u5b58\u6620\u5c04\u6587\u4ef6(memory-mapped files),\u6709\u4ee5\u4e0b\u89c4\u5219\u63a7\u5236\uff1a</p> <ul> <li> <p>\u4e34\u65f6\u6587\u4ef6\u5728tmpdir\u53d8\u91cf\u5b9a\u4e49\u7684\u76ee\u5f55\u4e2d\u521b\u5efa\u3002</p> </li> <li> <p>\u4e34\u65f6\u6587\u4ef6\u5728\u521b\u5efa\u548c\u6253\u5f00\u540e\u4f1a\u7acb\u5373\u88ab\u5220\u9664\uff0c\u56e0\u6b64\u4e0d\u4f1a\u4fdd\u7559\u5728tmpdir\u76ee\u5f55\u4e2d\u3002\u4e34\u65f6\u6587\u4ef6\u5360\u7528\u7684\u7a7a\u95f4\u5728\u4e34\u65f6\u6587\u4ef6\u6253\u5f00\u65f6\u7531\u64cd\u4f5c\u7cfb\u7edf\u4fdd\u7559\u3002\u5f53\u4e34\u65f6\u6587\u4ef6\u88abTempTable\u5b58\u50a8\u5f15\u64ce\u5173\u95ed\u6216mysqld\u8fdb\u7a0b\u5173\u95ed\u65f6\uff0c\u8fd9\u4e9b\u7a7a\u95f4\u4f1a\u88ab\u56de\u6536\u3002</p> </li> <li> <p>\u6570\u636e\u4e0d\u4f1a\u5728\u5185\u5b58\u548c\u4e34\u65f6\u6587\u4ef6\u4e4b\u95f4\u3001\u5185\u5b58\u5185\u90e8\u6216\u4e34\u65f6\u6587\u4ef6\u4e4b\u95f4\u79fb\u52a8</p> </li> <li> <p>\u5982\u679c\u5728<code>temptable_max_ram</code>\u5b9a\u4e49\u7684\u9650\u5236\u8303\u56f4\u5185\u6709\u53ef\u7528\u7a7a\u95f4\uff0c\u65b0\u6570\u636e\u5c31\u4f1a\u5b58\u50a8\u5728\u5185\u5b58\u4e2d\u3002\u5426\u5219\uff0c\u65b0\u6570\u636e\u5c06\u5b58\u50a8\u5728\u4e34\u65f6\u6587\u4ef6\u4e2d\u3002</p> </li> <li> <p>\u5982\u679c\u5728\u8868\u7684\u90e8\u5206\u6570\u636e\u5199\u5165\u4e34\u65f6\u6587\u4ef6\u540e\uff0c\u5185\u5b58\u4e2d\u51fa\u73b0\u53ef\u7528\u7a7a\u95f4\uff0c\u5219\u53ef\u4ee5\u5c06\u5269\u4f59\u7684\u8868\u6570\u636e\u5b58\u50a8\u5728\u5185\u5b58\u4e2d\u3002</p> </li> </ul> <p>\u5f53\u5bf9\u5185\u5b58\u4e2d\u7684\u4e34\u65f6\u8868\u4f7f\u7528 MEMORY \u5b58\u50a8\u5f15\u64ce\uff08internal_tmp_mem_storage_engine=MEMORY\uff09\u65f6\uff0c\u5982\u679c\u5185\u5b58\u4e2d\u7684\u4e34\u65f6\u8868\u8fc7\u5927\uff0cMySQL \u4f1a\u81ea\u52a8\u5c06\u5176\u8f6c\u6362\u4e3a\u78c1\u76d8\u4e0a\u7684\u8868\u3002\u5185\u5b58\u4e2d\u4e34\u65f6\u8868\u7684\u6700\u5927\u5927\u5c0f\u7531<code>tmp_table_size</code>\u6216<code>max_heap_table_size</code>\u503c\u5b9a\u4e49\uff0c\u4ee5\u8f83\u5c0f\u8005\u4e3a\u51c6\u3002</p> <p>\u8fd9\u4e0e\u4f7f\u7528<code>CREATE TABLE</code>\u660e\u786e\u521b\u5efa\u7684MEMORY\u8868\u4e0d\u540c\uff0c\u5bf9\u4e8e\u8fd9\u7c7b\u8868\uff0c\u53ea\u6709<code>max_heap_table_size</code>\u53d8\u91cf\u51b3\u5b9a\u8868\u7684\u5927\u5c0f\uff0c\u800c\u4e0d\u9700\u8981\u8f6c\u6362\u4e3a\u78c1\u76d8\u4e0a\u7684\u683c\u5f0f\u3002</p>"},{"location":"basic/2.install_mysql/","title":"MySQL\u5b89\u88c5","text":"<p>mysql\u4e0b\u8f7d\u5730\u5740</p> <pre><code># \u5b98\u7f51\u5730\u5740\nhttps://dev.mysql.com/downloads/mysql/\n# \u56fd\u5185\u7684tsinghua\u955c\u50cf\nhttps://mirror.tuna.tsinghua.edu.cn/mysql/\n# \u56fd\u5185\u7684huwei\u955c\u50cf\nhttps://mirrors.huaweicloud.com/mysql/Downloads/\n\nhttps://mirrors.huaweicloud.com/mysql/Downloads/MySQL-8.0/mysql-8.0.24-linux-glibc2.12-x86_64.tar.xz\n</code></pre> <p>Windows \u7cfb\u7edf\u4e0b\u8f7d\u7684\u5b89\u88c5\u6587\u4ef6\uff1a</p> <ul> <li>\u514d\u5b89\u88c5\u65b9\u5f0f\uff08\u63a8\u8350\uff09</li> <li>5.7\uff1amysql-5.7.28-winx64.zip</li> <li> <p>8.0\uff1amysql-8.0.18-winx64.zip</p> </li> <li> <p>msi\u5b89\u88c5\u65b9\u5f0f</p> </li> <li> <p>\u4e0b\u8f7dMSI Installer\u6587\u4ef6\uff0c\u4e0b\u4e00\u6b65\u4e0b\u4e00\u6b65\u5f0f\u5b89\u88c5\u3002</p> </li> </ul> <p>Linux \u7cfb\u7edf\u4e0b\u8f7d\u7684\u5b89\u88c5\u6587\u4ef6\uff1a\u4e00\u822c\u63a8\u8350\u7528 Linux-Generic  \u8fd9\u79cd\u6e90\u683c\u5f0f\u7684\u5b89\u88c5\u6587\u4ef6\u3002</p> <ul> <li>5.7\uff1amysql-5.7.28-linux-glibc2.12-x86_64.tar.gz </li> <li>8.0\uff1amysql-8.0.23-linux-glibc2.12-x86_64.tar.xz </li> </ul> <p>\u200b    </p>"},{"location":"basic/2.install_mysql/#1windows","title":"1\u3001windows \u5b89\u88c5\u8fc7\u7a0b","text":"<p>\u4e0b\u8f7dmysql\u6587\u4ef6\u5e76\u89e3\u538b\u5230 D:/mysql \u76ee\u5f55\u4e2d\uff0c\u6dfb\u52a0 D:/mysql/bin \u5230 PATH \u7cfb\u7edf\u73af\u5883\u53d8\u91cf\u4e2d\u3002\u5728\u6839\u76ee\u5f55\u521b\u5efa my.ini \u914d\u7f6e\u6587\u4ef6\uff0c\u5185\u5bb9\u5982\u4e0b\uff1a</p> <pre><code>[client]\n# \u8bbe\u7f6emysql\u5ba2\u6237\u7aef\u8fde\u63a5\u670d\u52a1\u7aef\u65f6\u9ed8\u8ba4\u4f7f\u7528\u7684\u7aef\u53e3\nport = 3306 \n[mysql]\n# \u8bbe\u7f6emysql\u5ba2\u6237\u7aef\u9ed8\u8ba4\u5b57\u7b26\u96c6   \ndefault-character-set=utf8 \n[mysqld]\n# mysql\u670d\u52a1\u7aef\u9ed8\u8ba4\u76d1\u542c(listen on)\u7684TCP/IP\u7aef\u53e3\u53f7\nport=3306 \n# \u57fa\u51c6\u8def\u5f84\uff0c\u5176\u4ed6\u8def\u5f84\u90fd\u76f8\u5bf9\u4e8e\u8fd9\u4e2a\u8def\u5f84 \nbasedir=\"D:\\mysql\" \n# mysql\u6570\u636e\u5e93\u6587\u4ef6\u6240\u5728\u76ee\u5f55\ndatadir=\"D:\\mysql\\data\" \n# \u9ed8\u8ba4\u5b57\u7b26\u96c6 \ncharacter-set-server=utf8mb4\n# \u9ed8\u8ba4\u5b58\u50a8\u5f15\u64ce\ndefault-storage-engine=INNODB\n# SQL\u6a21\u5f0f\u4e3astrict\u6a21\u5f0f\n# sql-mode=STRICT_TRANS_TABLES,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION \n# mysql\u670d\u52a1\u5668\u652f\u6301\u7684\u6700\u5927\u5e76\u53d1\u8fde\u63a5\u6570\uff08\u7528\u6237\u6570\uff09\u3002\u5982\u679c\u8bbe\u7f6e\u5f97\u8fc7\u5c0f\u800c\u7528\u6237\u6bd4\u8f83\u591a\uff0c\u4f1a\u7ecf\u5e38\u51fa\u73b0\u201cToo many connections\u201d\u9519\u8bef\u3002\nmax_connections=1024\n# \u7981\u7528\u67e5\u8be2\u7f13\u5b58\uff0c\u8fd9\u4e2a\u53c2\u6570\u57285.7.20\u540e\u5df2\u7ecfDeprecated\n# query_cache_size=0 \n# \u5185\u5b58\u4e2d\u7684\u6bcf\u4e2a\u4e34\u65f6\u8868\u5141\u8bb8\u7684\u6700\u5927\u5927\u5c0f\u3002\u5982\u679c\u4e34\u65f6\u8868\u5927\u5c0f\u8d85\u8fc7\u8be5\u503c\uff0c\u4e34\u65f6\u8868\u5c06\u81ea\u52a8\u8f6c\u4e3a\u57fa\u4e8e\u78c1\u76d8\u7684\u8868\uff08Disk Based Table\uff09\u3002\ntmp_table_size=34M \n# \u7f13\u5b58\u7684\u6700\u5927\u7ebf\u7a0b\u6570\u3002\u5f53\u5ba2\u6237\u7aef\u8fde\u63a5\u65ad\u5f00\u65f6\uff0c\u5982\u679c\u5ba2\u6237\u7aef\u603b\u8fde\u63a5\u6570\u5c0f\u4e8e\u8be5\u503c\uff0c\u5219\u5904\u7406\u5ba2\u6237\u7aef\u4efb\u52a1\u7684\u7ebf\u7a0b\u653e\u56de\u7f13\u5b58\u3002\u5728\u9ad8\u5e76\u53d1\u60c5\u51b5\u4e0b\uff0c\u5982\u679c\u8be5\u503c\u8bbe\u7f6e\u5f97\u592a\u5c0f\uff0c\u5c31\u4f1a\u6709\u5f88\u591a\u7ebf\u7a0b\u9891\u7e41\u521b\u5efa\uff0c\u7ebf\u7a0b\u521b\u5efa\u7684\u5f00\u9500\u4f1a\u53d8\u5927\uff0c\u67e5\u8be2\u6548\u7387\u4e5f\u4f1a\u4e0b\u964d\u3002\u4e00\u822c\u6765\u8bf4\u5982\u679c\u5728\u5e94\u7528\u7aef\u6709\u826f\u597d\u7684\u591a\u7ebf\u7a0b\u5904\u7406\uff0c\u8fd9\u4e2a\u53c2\u6570\u5bf9\u6027\u80fd\u4e0d\u4f1a\u6709\u592a\u5927\u7684\u63d0\u9ad8\u3002\nthread_cache_size=8 \ndefault_authentication_plugin = mysql_native_password\n</code></pre> <p>\u4ee5\u7ba1\u7406\u5458\u8eab\u4efd\u542f\u52a8 cmd , \u8fdb\u884c\u6570\u636e\u521d\u59cb\u5316\uff1a</p> <p>mysql_install_db \u8fd9\u4e2a\u7a0b\u5e8f\u5728 MySQL 5.7.6 \u4e2d\u5df2\u7ecf\u5f03\u7528\uff0c\u56e0\u4e3a\u5b83\u7684\u529f\u80fd\u5df2\u7ecf\u96c6\u6210\u5728 mysqld \u4e2d\u4e86\uff0c\u6240\u4ee5\u5728\u5b89\u88c5 5.7 \u53ca\u4ee5\u540e\u7248\u672c\u65f6\uff0c\u76f4\u63a5\u4f7f\u7528  mysqld --initialize  \u6216\u8005  mysqld  --initialize-insecure \u5c31\u53ef\u4ee5\u76f4\u63a5\u521d\u59cb\u5316\u3002\u5728 5.7.5 \u4e4b\u524d\uff0cmysql_install_db \u8fd9\u4e2a\u7a0b\u5e8f\u662f\u7528 perl \u811a\u672c\u5199\u7684\uff0c\u6240\u4ee5\u9700\u8981\u5b89\u88c5 perl \uff0c5.7.5 \u4e4b\u540e\uff0c\u6539\u4e3a\u7528 C++ \u5199\u7684\uff0c\u5e76\u4e14\u53ef\u4ee5\u76f4\u63a5\u505a\u4e3a\u4e8c\u8fdb\u5236\u6587\u4ef6\u6267\u884c\u3002</p> <pre><code># \u4e0d\u5b89\u5168\u7684\u521d\u59cb\u5316\uff0c\u9ed8\u8ba4root\u5bc6\u7801\u4e3a\u7a7a\uff0c\u9700\u8981\u767b\u9646\u540e\u81ea\u5df1\u8bbe\u7f6e\u4e00\u4e2a\u5bc6\u7801\nmysqld --initialize-insecure --console\n# \u76f4\u63a5\u521d\u59cb\u5316\uff0c\u4e3aroot\u751f\u6210\u4e00\u4e2a\u968f\u673a\u5bc6\u7801\uff0c\u5bc6\u7801\u6253\u5370\u5728\u63a7\u5236\u53f0\u4e2d\nmysqld --initialize --console\n</code></pre> <p>\u5b89\u88c5\u7cfb\u7edf\u670d\u52a1</p> <pre><code>mysqld -install MySQL --defaults-file=\"D:\\mysql\\my.ini\" \n</code></pre> <p>\u542f\u52a8\u7cfb\u7edf\u670d\u52a1</p> <pre><code>net start mysql \n</code></pre> <p>\u767b\u9646\u5e76\u8bbe\u7f6e\u5bc6\u7801</p> <pre><code>mysql -u root -p\nuse mysql;\nupdate user set authentication_string=PASSWORD(\"123456AWS!@#\") where user=\"root\";\nflush privileges;\nquit;\n</code></pre> <p>\u9ed8\u8ba4\u5730\uff0cMySQL \u4f1a\u521b\u5efa\u5982\u4e0b\u7528\u6237\uff1a</p> <pre><code>Type 'help;' or '\\h' for help. Type '\\c' to clear the current input statement.\n\nmysql&gt; select user,host from mysql.user;\n+------------------+-----------+\n| user             | host      |\n+------------------+-----------+\n| mysql.infoschema | localhost |\n| mysql.session    | localhost |\n| mysql.sys        | localhost |\n| root             | localhost |\n+------------------+-----------+\n4 rows in set (0.05 sec)\n\nmysql&gt;\n</code></pre> <p>\u7528\u6237\u7ba1\u7406</p> <p>\u6211\u4eec\u5728\u521b\u5efa\u6570\u636e\u5e93\u7528\u6237\u7684\u65f6\u5019\u90fd\u4f1a\u6307\u5b9ahost\uff0c\u5373\u4e00\u4e2a\u5b8c\u6574\u7684\u7528\u6237\u53ef\u63cf\u8ff0\u4e3a 'username'@'host' \u3002</p> <p>\u521b\u5efa\u7528\u6237\u65f6\u4e0d\u663e\u5f0f\u6307\u5b9ahost\u5219\u9ed8\u8ba4\u4e3a%\uff0c%\u4ee3\u8868\u6240\u6709 ip \u6bb5\u90fd\u53ef\u4ee5\u4f7f\u7528\u8fd9\u4e2a\u7528\u6237\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u6307\u5b9ahost\u4e3a\u67d0\u4e2aip\u6216ip\u6bb5\uff0c\u8fd9\u6837\u4f1a\u4ec5\u5141\u8bb8\u5728\u6307\u5b9a\u7684ip\u4e3b\u673a\u4f7f\u7528\u8be5\u6570\u636e\u5e93\u7528\u6237\u3002</p> <p>\u4e0d\u8fc7\u4f60\u4e5f\u5e94\u8be5\u660e\u767d 'username'@'%' \u548c 'username'@'192.168.6.%' \u662f\u4e24\u4e2a\u6beb\u65e0\u5173\u8054\u7684\u7528\u6237\uff0c\u8fd9\u4e24\u4e2a\u7528\u6237\u53ef\u4ee5\u6709\u4e0d\u540c\u7684\u5bc6\u7801\u548c\u6743\u9650\uff0c\u8fd9\u91cc\u4e0d\u5efa\u8bae\u521b\u5efa\u591a\u4e2a\u540c\u540d\u4e0d\u540chost\u7684\u7528\u6237\uff0c\u8fd8\u6709\u4e0d\u8981\u8f7b\u6613\u66f4\u6539\u7528\u6237\u7684host\u3002</p>"},{"location":"basic/2.install_mysql/#2linux","title":"2\u3001Linux \u5b89\u88c5\u8fc7\u7a0b","text":""},{"location":"basic/2.install_mysql/#21","title":"2.1 \u4e8c\u8fdb\u5236\u5b89\u88c5","text":"<p>\u73af\u5883</p> <ul> <li>GNU/Linux-x86_64</li> <li>gcc \u8fd0\u884c\u65f6\u73af\u5883</li> </ul> <pre><code>sudo yum -y install libaio libncurses*\nsudo apt-get install libaio1 libaio-dev libncurses5\n</code></pre> <p>\u5b89\u88c5\u89c4\u8303</p> \u914d\u7f6e\u9879 \u503c\u6216\u8def\u5f84 base\u76ee\u5f55 /usr/local/mysql socket\u5957\u63a5\u5b57\u6587\u4ef6 /data/mysql/mysql.sock \u9519\u8bef\u65e5\u5fd7\uff08\u542f\u52a8\u65e5\u5fd7\uff09 /data/mysql/error.log \u8fdb\u7a0b\u6587\u4ef6 /data/mysql/mysql.pid \u6570\u636e\u76ee\u5f55 /data/mysql/ \u5b57\u7b26\u96c6\u548c\u6392\u5e8f\u89c4\u5219 utf8mb4\u548cutf8mb4_unicode_ci <p>\u7528\u6237\u548c\u6570\u636e\u76ee\u5f55\u521b\u5efa</p> <pre><code>$ groupadd mysql\n$ useradd -r -g mysql -s /bin/false mysql\n$ mkdir -p /data/mysql/{data,binlog} \n$ chown -R mysql:mysql /data/mysql\n</code></pre> <p>\u521b\u5efa /etc/my.cnf\u6587\u4ef6</p> <p>\u8fd9\u662f\u6700\u57fa\u672c\u7684\u914d\u7f6e\u6587\u4ef6\uff0c\u66f4\u8be6\u7ec6\u7684\u914d\u7f6e\uff0c\u53ef\u4ee5\u53c2\u8003\u76f8\u5173mysql\u4f18\u5316\u6587\u6863</p> <pre><code>[client]\nport = 3306\nsocket = /data/mysql/mysql.sock\n#default-character-set\u3000=\u3000utf8mb4\n\n[mysql]\nno-auto-rehash\ndefault-character-set = utf8mb4\n\n[mysqld]\n#skip-grant-tables\nlog_timestamps=SYSTEM\nuser = mysql\nport = 3306\nbasedir = /usr/local/mysql\nlog_error = /data/mysql/mysql.error\ndatadir = /data/mysql/data/\nsocket = /data/mysql/mysql.sock\npid-file = /data/mysql/db.pid\ncharacter-set-server = utf8mb4\ncollation-server = utf8mb4_general_ci\ndefault_authentication_plugin = mysql_native_password\nskip_name_resolve = 1\nopen_files_limit    = 65535\nback_log = 1024\ndefault_time_zone='+8:00'\n# innodb_buffer_pool_size=32G\ninnodb_buffer_pool_instances=8\ninnodb_log_file_size=4G\ninnodb_log_files_in_group=4\n# binlog\u8fc7\u671f\u65f6\u95f43\u5929\nbinlog_expire_logs_seconds=259200\nwait_timeout = 9000\ninteractive_timeout = 9000\nnet_write_timeout=6000\nnet_read_timeout=6000\nthread_cache_size=10\nsync_binlog=800\ninnodb_autoextend_increment=64\nopen_files_limit=10200\n#sort_buffer_size=256M\n</code></pre> <p>\u4e0b\u8f7d</p> <pre><code>$ cd /tmp/\n\n$ wget https://mirrors.huaweicloud.com/mysql/Downloads/MySQL-8.0/mysql-8.0.23-linux-glibc2.12-x86_64.tar.xz\n# $ wget https://dev.mysql.com/get/Downloads/MySQL-5.7/mysql-5.7.24-linux-glibc2.12-x86_64.tar.gz\n</code></pre> <p>\u89e3\u538b\u5e76\u5b89\u88c5</p> <pre><code>$ tar  -zxvf  /tmp/mysql-8.0.23-linux-glibc2.12-x86_64.tar.xz -C /usr/local\n$ mv  /usr/local/mysql-8.0.23-linux-glibc2.12-x86_64  /usr/local/mysql\n$ cd  /usr/local/mysql\n$ ./bin/mysqld   --initialize-insecure  \\\n    --basedir=/usr/local/mysql \\\n    --datadir=/data/mysql/data \\\n    --user=mysql  \\\n    --pid-file=/data/mysql/mysql.pid\n\n$ ./support-files/mysql.server start\n$ ./support-files/mysql.server status\n</code></pre> <p>5.6\u4e0e5.7\u5728\u521d\u59cb\u5316\u7684\u65f6\u5019\u6709\u4e00\u4e9b\u533a\u522b\uff0c\u5728 5.7.6 \u4ee5\u524d\u90fd\u7528 mysql_install_db \u6765\u521d\u59cb\u5316\u6570\u636e\u5e93\uff0c\u5728\u8fd9\u4e4b\u540e\u7684\u7248\u672c\uff0c\u7531\u4e8e mysqld \u7a0b\u5e8f\u5df2\u7ecf\u96c6\u6210\u4e86\u521d\u59cb\u5316\u6570\u636e\u5e93\u529f\u80fd\uff0c mysql_install_db  \u8fd9\u4e2a\u529f\u80fd\u5728\u672a\u6765\u7684\u7248\u672c\u4e2d\u53ef\u80fd\u4f1a\u88ab\u53bb\u6389\u3002\u6240\u4ee5\u5efa\u8bae\u76f4\u63a5\u4f7f\u7528  mysqld   --initialize-insecure \u8fd9\u6837\u7684\u65b9\u6cd5\u6765\u8fdb\u884c\u6570\u636e\u521d\u59cb\u5316\u3002</p> <p>\u6dfb\u52a0\u5230\u7cfb\u7edf\u670d\u52a1\u548c\u5f00\u673a\u81ea\u542f</p> <pre><code>$ cp /usr/local/mysql/support-files/mysql.server  /etc/init.d/mysql\n$ chkconfig --add mysql\n$ chkconfig mysql on\n</code></pre> <p>\u8bbe\u7f6eroot\u5bc6\u7801\uff0c\u5e76\u5f00\u542f\u4efb\u610fIP\u767b\u9646</p> <pre><code>/usr/local/mysql/bin/mysql -u root -p  \nalter user root@'localhost' IDENTIFIED by 'Sj36668182' ;\n-- UPDATE mysql.user SET authentication_string=PASSWORD(\"QH@123456\") WHERE user='root' ;\ngrant all privileges on *.* to 'root' @'%' identified by '123456';\nflush privileges;\n</code></pre> <p>\u8bbe\u7f6e mysql \u73af\u5883\u53d8\u91cf</p> <p>\u5c06 mysql \u5b89\u88c5\u8def\u5f84\u7684 bin \u76ee\u5f55\u52a0\u5230 Linux \u7684 PATH \u73af\u5883\uff0c\u65b9\u4fbf\u4ee5\u540e\u5728\u4efb\u610f\u76ee\u5f55\u4e0b\u90fd\u53ef\u4ee5\u90fd\u53ef\u4ee5\u6267\u884c mysql \u7684\u76f8\u5173\u547d\u4ee4\u3002</p> <pre><code>echo \"PATH=$PATH:/usr/local/mysql/bin\" &gt;&gt; /etc/profile\n# echo \"PATH=$PATH:/usr/local/mysql/bin\" &gt;&gt; ~/.bashrc \nsource /etc/profile\n</code></pre> <p>mysql\u670d\u52a1\u7ba1\u7406</p> <pre><code>$ systemctl status mysql\n$ systemctl start mysql\n$ systemctl stop mysql\n$ systemctl restart mysql\n</code></pre>"},{"location":"basic/2.install_mysql/#22","title":"2.2 \u5305\u7ba1\u7406\u5668\u5b89\u88c5","text":"<p>\u5305\u7ba1\u7406\u5668\u4e5f\u662f\u4e00\u79cd\u7b80\u5355\u7684\u5b89\u88c5\u65b9\u5f0f\uff0c\u4f46\u662f\u81ea\u7531\u6027\u6ca1\u6709\u90a3\u4e48\u597d\uff0c\u81ea\u5b9a\u4e49\u7a0b\u5ea6\u4e5f\u6ca1\u6709\u90a3\u4e48\u597d\u3002</p> <p>\u5e38\u7528\u7684 Linux \u5305\u7ba1\u7406\u5668\u6709 yum \u548c apt \u3002\u5206\u522b\u9002\u7528\u4e8e rhel \u7cfb\u548c debian \u7cfb\u7684 Linux \u53d1\u884c\u7248\u3002</p>"},{"location":"basic/2.install_mysql/#221yum","title":"2.2.1\u3001yum \u5b89\u88c5","text":"<p>\u6dfb\u52a0 MySQL Yum \u4ed3\u5e93\u5230\u7cfb\u7edf\u4ed3\u5e93\u5217\u8868\u4e2d</p> <pre><code>$ wget -P /tmp https://dev.mysql.com/get/mysql80-community-release-el7-1.noarch.rpm\n$ wget -P /tmp https://dev.mysql.com/get/mysql80-community-release-el6-1.noarch.rpm\n$ rpm -Uvh platform-and-version-specific-package-name.rpm\n</code></pre> <ol> <li>\u9009\u62e9\u7248\u672c</li> </ol> <p>\u9ed8\u8ba4\u5730\uff0cYum \u5305\u5b89\u88c5\u7684\u662f\u6700\u65b0\u7684 GA \u7248\u672c\uff08\u6807\u51c6\u53d1\u5e03\u7248\uff09\uff0c\u5982\u679c\u8fd9\u6b63\u662f\u4f60\u9700\u8981\u7684\uff0c\u53ef\u4ee5\u8df3\u8fc7\u8fd9\u4e00\u6b65\u3002</p> <p>\u5728 MySQL Yum \u4ed3\u5e93\u4e2d\uff0c\u4e0d\u540c\u7684\u53d1\u884c\u7248\u5728\u4e0d\u540c\u7684\u5b50\u4ed3\u5e93\u4e2d\uff0c\u9ed8\u8ba4\u5f53\u524d\u662f\u5f53\u524d\u6700\u65b0\u7684 GA \u7248\u672c\uff088.0\uff09\uff0c5.7 \u7cfb\u5217\u9ed8\u8ba4\u662f\u88ab\u7981\u7528\u7684\uff0c\u4f7f\u7528\u4e0b\u9762\u7684\u547d\u4ee4\u6765\u67e5\u770b\u6240\u6709 MySQL \u5b50\u4ed3\u5e93\uff0c\u770b\u770b\u54ea\u4e9b\u88ab\u542f\u7528\uff0c\u54ea\u4e9b\u88ab\u7981\u7528</p> <pre><code>$ yum repolist all | grep mysql\n$ dnf repolist all | grep mysql\n</code></pre> <p>\u5982\u679c\u8981\u5b89\u88c5 5.7 \u7cfb\u5217\u7684\uff0c\u9700\u8981\u7981\u7528\u6700\u65b0\u7684 GA \u7248\u672c\u5b50\u4ed3\u5e93\uff0c\u542f\u7528 5.7 \u7cfb\u5217\u7248\u672c\u5b50\u4ed3\u5e93\u3002</p> <pre><code>$ sudo yum-config-manager --disable mysql80-community\n$ sudo yum-config-manager --enable mysql57-community\n</code></pre> <p>\u8fd9\u4e24\u884c\u547d\u4ee4\uff0c\u5176\u5b9e\u5c31\u662f\u4fee\u6539 /etc/yum.repos.d/mysql-community.repo \u8fd9\u4e2a\u6587\u4ef6\u91cc\u9762\u7684\u5185\u5bb9\uff0c\u901a\u8fc7 enabled \u5b57\u6bb5\u6765\u63a7\u5236\u542f\u7528\u548c\u7981\u7528\u3002</p> <pre><code>[mysql80-community]\nname=MySQL 8.0 Community Server\nbaseurl=http://repo.mysql.com/yum/mysql-8.0-community/el/6/$basearch/\nenabled=0\ngpgcheck=1\ngpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-mysql\n\n# Enable to use MySQL 5.7\n[mysql57-community]\nname=MySQL 5.7 Community Server\nbaseurl=http://repo.mysql.com/yum/mysql-5.7-community/el/6/$basearch/\nenabled=1\ngpgcheck=1\ngpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-mysql\n</code></pre> <p>\u9a8c\u8bc1\u5f53\u524d\u5b50\u4ed3\u5e93\u7684\u53ef\u7528\u6027</p> <pre><code> $ yum repolist enabled | grep mysql\n</code></pre> <ol> <li>\u5b89\u88c5 MySQL</li> </ol> <pre><code>$ sudo yum install mysql-community-server\n</code></pre> <ol> <li>\u542f\u52a8 MySQL</li> </ol> <pre><code>$ sudo service mysqld start\n$ sudo systemctl start mysqld.service\n$ sudo service mysqld status\n$ sudo service mysqld status\n</code></pre> <p>\u5bf9\u4e8e 5.7 \uff0croot\u8d26\u53f7\u4f1a\u968f\u673a\u751f\u6210\u4e00\u4e2a\u5bc6\u7801\u5b58\u5728\u65e5\u5fd7\u6587\u4ef6\u4e2d\uff0c\u901a\u8fc7 sudo grep 'temporary password' /var/log/mysqld.log \u547d\u4ee4\u6765\u67e5\u770b\u3002</p> <p>\u5bc6\u7801\u8981\u6c42\u5982\u4e0b\uff1a\u81f3\u5c11\u4e00\u4e2a\u5927\u5199\u5b57\u6bcd\u3001\u81f3\u5c11\u4e00\u4e2a\u5c0f\u5199\u5b57\u6bcd\u3001\u81f3\u5c11\u4e00\u4e2a\u6570\u5b57\u3001\u81f3\u5c11\u4e00\u4e2a\u7279\u6b8a\u7b26\u53f7\u3001\u5b57\u7b26\u603b\u957f\u5ea6\u4e0d\u5c0f\u4e8e8\u3002</p>"},{"location":"basic/2.install_mysql/#3","title":"3\u3001\u7528\u6237\u7ba1\u7406","text":"<p>\u7528\u6237\u6807\u8bc6</p> <p>\u5728 MySQL \u4e2d\uff0c\u7528\u6237\u662f\u7531 mysql.user \u8868\u4e2d\u7684 Host \u548c User \u4e24\u4e2a\u5b57\u6bb5\u4e00\u8d77\u6765 \u552f\u4e00\u6807\u8bc6 \u4e00\u4e2a\u7528\u6237\u7684\u3002</p> <p>\u4efb\u4f55\u5bf9\u7528\u6237\u7684\u76f8\u5173\u64cd\u4f5c\uff08\u8d4b\u6743\uff0c\u4fee\u6539\u5bc6\u7801\u7b49\uff09\uff0c\u90fd\u662f\u901a\u8fc7 user@'host' \u8fd9\u6837\u6765\u6807\u8bc6\u4e00\u4e2a\u7528\u6237\u3002</p> <p>MySQL 8.0 \u5728\u7528\u6237\u7ba1\u7406\u65b9\u9762\u589e\u52a0\u4e86\u89d2\u8272\u7ba1\u7406\uff0c\u9ed8\u8ba4\u7684\u5bc6\u7801\u52a0\u5bc6\u65b9\u5f0f\u4e5f\u505a\u4e86\u8c03\u6574\uff0c\u7531\u4e4b\u524d\u7684 SHA1 \u6539\u4e3a\u4e86 SHA2\u3002</p> <p>\u540c\u65f6\u52a0\u4e0a MySQL 5.7 \u7684\u7981\u7528\u7528\u6237\u548c\u7528\u6237\u8fc7\u671f\u7684\u529f\u80fd\uff0cMySQL \u5728\u7528\u6237\u7ba1\u7406\u65b9\u9762\u7684\u529f\u80fd\u548c\u5b89\u5168\u6027\u90fd\u8f83\u4e4b\u524d\u7248\u672c\u5927\u5927\u7684\u589e\u5f3a\u4e86\u3002</p> <p>\u5728 MySQL 8.0 \u4e2d\uff0ccaching_sha2_password \u662f\u9ed8\u8ba4\u7684\u8eab\u4efd\u9a8c\u8bc1\u63d2\u4ef6\uff0c\u800c\u4e0d\u662f\u4e4b\u524d\u7248\u672c\u7684 mysql_native_password\uff0c\u9ed8\u8ba4\u7684\u5bc6\u7801\u52a0\u5bc6\u65b9\u5f0f\u662f SHA2 \u3002</p> <p>https://www.cnblogs.com/yinzhengjie/p/10301516.html</p> <p>\u7531\u4e8e\u6211\u4eec\u5b9e\u9645\u5f00\u53d1\u8fc7\u7a0b\u4e2d\u7684 navicate \u7b49\u5de5\u5177\u6216\u5404\u79cd\u8bed\u8a00\u7684\u5ba2\u6237\u7aef\uff0c\u53ef\u80fd\u6ca1\u6709\u5373\u4f7f\u66f4\u65b0\u4e0d\u652f\u6301 8.0 \u7684\u8fd9\u79cd\u8ba4\u8bc1\u65b9\u5f0f\uff0c\u6240\u4ee5\u4e00\u822c\u6211\u4eec\u5b89\u88c5\u65f6\u90fd\u4f1a\u8bbe\u7f6e\u4e3a\u4ee5\u524d\u7684\u8ba4\u8bc1\u65b9\u5f0f\u3002</p> <pre><code>mysql&gt; show variables like 'default_authentication_plugin';\n+-------------------------------+-----------------------+\n| Variable_name                 | Value                 |\n+-------------------------------+-----------------------+\n| default_authentication_plugin | caching_sha2_password |\n+-------------------------------+-----------------------+\n1 row in set (0.00 sec)\n\nmysql&gt; select user,host,plugin from mysql.user;\n+------------------+-----------+-----------------------+\n| user             | host      | plugin                |\n+------------------+-----------+-----------------------+\n| root             | %         | caching_sha2_password |\n| mysql.infoschema | localhost | mysql_native_password |\n| mysql.session    | localhost | mysql_native_password |\n| mysql.sys        | localhost | mysql_native_password |\n| root             | localhost | caching_sha2_password |\n+------------------+-----------+-----------------------+\n5 rows in set (0.00 sec)\n</code></pre> <p>\u5982\u679c\u9700\u8981\u4fdd\u6301\u4e4b\u524d\u7684\u9a8c\u8bc1\u65b9\u5f0f\u548c\u5bc6\u7801\u52a0\u5bc6\u65b9\u5f0f\uff0c\u9700\u8981\u5728\u914d\u7f6e\u6587\u4ef6 my.cnf \u4e2d\u4fee\u6539\u4ee5\u4e0b\u914d\u7f6e\u9879\u5e76\u91cd\u542f\u670d\u52a1\u540e\u751f\u6548\u3002</p> <pre><code>[mysqld]\ndefault_authentication_plugin = mysql_native_password\n</code></pre> <p>\u5c06 MySQL 8.0 \u4e2d\u5df2\u6709\u7684\u7528\u6237\u7684 SHA2 \u5bc6\u7801\u4fee\u6539\u4e3a SHA1 \u7684\u6a21\u5f0f\u3002</p> <pre><code>\n</code></pre> <p>\u7528\u6237\u6388\u6743\u548c\u4fee\u6539\u5bc6\u7801</p> <p>MySQL8\u521b\u5efa\u7528\u6237\u7684\u64cd\u4f5c\u5df2\u7ecf\u4e0d\u652f\u6301grant\u7684\u540c\u65f6\u521b\u5efa\u7528\u6237\u7684\u65b9\u5f0f\uff0c\u9700\u5148\u521b\u5efa\u7528\u6237\u518d\u8fdb\u884c\u6388\u6743\uff0c\u4e0b\u9762\u8fd9\u79cd\u64cd\u4f5c\u5c06\u4f1a\u62a5\u9519</p> <pre><code>GRANT ALL PRIVILEGES ON *.* TO `mike`@`%` IDENTIFIED BY '000000' WITH GRANT OPTION;\n</code></pre> <p>\u5bc6\u7801\u8fc7\u671f\u7ba1\u7406</p> <p>MySQL\u53ef\u4ee5\u7ed9\u5bc6\u7801\u8bbe\u7f6e\u751f\u547d\u5468\u671f\uff0c\u8ba9\u4e00\u4e2a\u5bc6\u7801\u53ea\u5728\u751f\u547d\u5468\u671f\u5185\u6709\u6548\uff0c\u5230\u671f\u540e\u5f3a\u8feb\u7528\u6237\u4fee\u6539\u5bc6\u7801\uff0c\u5982\u679c\u4e0d\u4fee\u6539\uff0c\u5219\u5c06\u7528\u6237\u9501\u5b9a\uff0c\u65e0\u6cd5\u767b\u9646\u3002</p> <p>MySQL \u4ece 5.6.6 \u5f00\u59cb\u5f15\u5165\u5bc6\u7801\u81ea\u52a8\u8fc7\u671f\u7684\u65b0\u529f\u80fd\uff0c\u6dfb\u52a0\u4e86 password_expired \u529f\u80fd\uff0c\u5b83\u5141\u8bb8\u8bbe\u7f6e\u7528\u6237\u7684\u8fc7\u671f\u65f6\u95f4\u3002</p> <p>MySQL 5.7.4 \u7248\u672c\u4e2d\u6539\u8fdb\u4e86\u7528\u6237\u5bc6\u7801\u8fc7\u671f\u65f6\u95f4\u8fd9\u4e2a\u7279\u6027\u3002\u53ef\u4ee5\u901a\u8fc7\u4e00\u4e2a\u5168\u5c40\u53d8\u91cf default_password_lifetime \u6765\u8bbe\u7f6e\u4e00\u4e2a\u5168\u5c40\u7684\u81ea\u52a8\u5bc6\u7801\u8fc7\u671f\u7b56\u7565\u3002</p> <pre><code># mysql5.7.10(GA)\u7248\u672c\u4e4b\u540e\u9ed8\u8ba4\u7684 default_password_lifetime \u9ed8\u8ba4\u503c\u4e3a 0\uff0c\u8868\u793a\u7981\u7528\u81ea\u52a8\u5bc6\u7801\u8fc7\u671f\u3002\u9ed8\u8ba4\u5168\u5c40\u914d\u7f6e\uff1a\u6240\u6709\u7528\u6237\u7684\u5bc6\u7801\u6c38\u4e0d\u8fc7\u671f\n# \u5982\u679c\u8981\u5efa\u7acb\u5168\u5c40\u7b56\u7565\uff0c\u8ba9\u6240\u6709\u7528\u6237\u7684\u5bc6\u7801\u7684\u4f7f\u7528\u671f\u9650\u4e3a\u516d\u4e2a\u6708\uff0c\u53ef\u5728\u670d\u52a1\u7aef\u914d\u7f6e\u6587\u4ef6 my.cnf \u4e2d\u4fee\u6539 default_password_lifetime \u914d\u7f6e\u9879\u7684\u503c\u4e3a 180\u3002\n# \u5982\u679c\u662f\u6b63\u6574\u6570 N \uff0c\u5219\u8868\u793a\u5141\u8bb8\u7684\u8bbe\u7f6e\u5bc6\u7801\u751f\u5b58\u5468\u671f \u4e3a N\uff0c\u5355\u4f4d\u4e3a\u5929 \u3002\n</code></pre> <p>\u5bc6\u7801\u7b56\u7565</p> <pre><code>-- \u67e5\u770b\u5bc6\u7801\u7b56\u7565  \nshow variables like 'validate_password%';\n-- \u65b0\u5bc6\u7801\u4e0d\u80fd\u548c\u524d\u9762\u4e09\u6b21\u7684\u5bc6\u7801\u76f8\u540c\npassword_history = 3 ; \n-- \u65b0\u5bc6\u7801\u4e0d\u80fd\u548c\u524d\u9762\u4e5d\u5341\u5929\u5185\u4f7f\u7528\u7684\u5bc6\u7801\u76f8\u540c\npassword_reuse_interval = 90 ; \n-- \u5bc6\u7801\u9a8c\u8bc1\u7b56\u7565\u4f4e\u8981\u6c42(0\u6216LOW\u4ee3\u8868\u4f4e\u7ea7)\nvalidate_password.policy=0;\n-- \u5bc6\u7801\u81f3\u5c11\u8981\u5305\u542b\u7684\u5c0f\u5199\u5b57\u6bcd\u4e2a\u6570\u548c\u5927\u5199\u5b57\u6bcd\u4e2a\u6570\nvalidate_password.mixed_case_count=0;\n-- \u5bc6\u7801\u81f3\u5c11\u8981\u5305\u542b\u7684\u6570\u5b57\u4e2a\u6570\nvalidate_password.number_count=0; \n-- \u5bc6\u7801\u81f3\u5c11\u8981\u5305\u542b\u7684\u7279\u6b8a\u5b57\u7b26\u6570\nvalidate_password.special_char_count=0; \n-- \u5bc6\u7801\u81f3\u5c11\u957f\u5ea6\nvalidate_password.length=6; \n</code></pre> <p>\u7528\u6237\u7ba1\u7406\u8bed\u53e5</p> <pre><code>-- \u5efa\u7528\u6237\nCREATE USER 'dba'@'%' IDENTIFIED WITH 'mysql_native_password' by 'admin@123' ;\n\n-- \u8d4b\u8d85\u7ea7\u6743\u9650\nGRANT ALL PRIVILEGES ON *.* TO 'dba'@'%';\n\nCREATE USER 'shendandan'@'192.168.%' IDENTIFIED WITH 'mysql_native_password' by 'admin@123' ;\n\n-- \u6307\u5b9a\u5bc6\u7801\u8fc7\u671f\uff0c\u4ee5\u4fbf\u7528\u6237\u7b2c\u4e00\u6b21\u4f7f\u7528\u7684\u65f6\u5019\u9700\u8981\u4fee\u6539\u5bc6\u7801\nCREATE USER 'jeffrey'@'localhost' IDENTIFIED WITH 'caching_sha2_password' BY 'new_password' PASSWORD EXPIRE DEFAULT;\n\n-- \u4e0d\u4f7f\u7528\u52a0\u5bc6\u8fde\u63a5\nCREATE USER 'dba'@'%' IDENTIFIED WITH 'mysql_native_password' by 'admin@123'  REQUIRE NONE ;\n\n-- \u4f7f\u7528\u52a0\u5bc6\u8fde\u63a5\nCREATE USER 'dba'@'%' IDENTIFIED WITH 'mysql_native_password' by 'admin@123'  REQUIRE NONE ;\n\n\n-- \u521b\u5efa\u7528\u6237\u5e76\u4e14\u8bbe\u7f6e\u8d44\u6e90\u95f2\u7f6e\uff08\u5982\u679c\u4e0d\u5e26\u8d44\u6e90\u9009\u9879\uff0c\u9ed8\u8ba4\u4e0d\u9650\u5236\u8d44\u6e90\uff09\n-- \u5355\u4f4d\u5c0f\u65f6\u5185\u8d26\u6237\u88ab\u5141\u8bb8\u67e5\u8be2500\u6b21\n-- \u5355\u4f4d\u5c0f\u65f6\u5185\u8d26\u6237\u88ab\u5141\u8bb8\u66f4\u65b0100\u6b21\n-- \u5355\u4f4d\u5c0f\u65f6\u5185\u6700\u5927\u8fde\u63a5\u6570\u4e0d\u9650\u5236\n-- \u540c\u4e00\u65f6\u523b\u6700\u5927\u5e76\u53d1\u8fde\u63a5\u6570\u4e0d\u9650\u5236\nCREATE USER 'jeffrey'@'%' \nIDENTIFIED WITH 'mysql_native_password' by 'admin@123'\nWITH \n    MAX_QUERIES_PER_HOUR 500 \n    MAX_UPDATES_PER_HOUR 100 \n    MAX_CONNECTIONS_PER_HOUR 0 \n    MAX_USER_CONNECTIONS 0;\n\n\n\n-- \u9501\u5b9a\u7528\u6237\nCREATE USER 'jeffrey'@'localhost' ACCOUNT LOCK\n-- \u89e3\u9501\u7528\u6237\nALTER USER 'jeffrey'@'localhost' ACCOUNT UNLOCK\n-- \u5220\u9664\u7528\u6237\nDROP USER 'jeffrey'@'localhost';\n-- \u4fee\u6539\u7528\u6237\nRENAME USER 'jeffrey'@'localhost' TO 'jeff'@'127.0.0.1';\n-- \u4fee\u6539\u5f53\u524d\u7528\u6237\u81ea\u5df1\u8d26\u53f7\u7684\u5bc6\u7801\nALTER USER USER() IDENTIFIED BY 'new_password';\n-- \u4fee\u6539\u5176\u4ed6\u7528\u6237\u8d26\u53f7\u7684\u5bc6\u7801\nALTER USER 'jeffrey'@'localhost' IDENTIFIED BY 'new_password';\n-- \u4fee\u6539\u7528\u6237\u8ba4\u8bc1\u63d2\u4ef6\nALTER USER 'jeffrey'@'localhost' IDENTIFIED WITH mysql_native_password;\n-- \u4fee\u6539\u5bc6\u7801\u548c\u63d2\u4ef6\nALTER USER 'jeffrey'@'localhost' IDENTIFIED WITH mysql_native_password BY 'new_password';\n\n\n-- \u8be6\u7ec6\u8bed\u6cd5\n\nCREATE USER [IF NOT EXISTS]\n    user [auth_option] [, user [auth_option]] ...\n    DEFAULT ROLE role [, role ] ...\n    [REQUIRE {NONE | tls_option [[AND] tls_option] ...}]\n    [WITH resource_option [resource_option] ...]\n    [password_option | lock_option] ...\n\nuser:\n    (see Section 6.2.4, \u201cSpecifying Account Names\u201d)\n\nauth_option: {\n    IDENTIFIED BY 'auth_string'\n  | IDENTIFIED WITH auth_plugin\n  | IDENTIFIED WITH auth_plugin BY 'auth_string'\n  | IDENTIFIED WITH auth_plugin AS 'hash_string'\n}\n\ntls_option: {\n   SSL\n | X509\n | CIPHER 'cipher'\n | ISSUER 'issuer'\n | SUBJECT 'subject'\n}\n\nresource_option: {\n    MAX_QUERIES_PER_HOUR count\n  | MAX_UPDATES_PER_HOUR count\n  | MAX_CONNECTIONS_PER_HOUR count\n  | MAX_USER_CONNECTIONS count\n}\n\npassword_option: {\n    PASSWORD EXPIRE [DEFAULT | NEVER | INTERVAL N DAY]\n  | PASSWORD HISTORY {DEFAULT | N}\n  | PASSWORD REUSE INTERVAL {DEFAULT | N DAY}\n  | PASSWORD REQUIRE CURRENT [DEFAULT | OPTIONAL]\n}\n\nlock_option: {\n    ACCOUNT LOCK\n  | ACCOUNT UNLOCK\n}\n</code></pre>"},{"location":"basic/2.install_mysql/#4","title":"4\u3001\u6743\u9650\u7ba1\u7406","text":"<p>grant \u662fMySQL\u4e2d\u7684\u6743\u9650\u7ba1\u7406\u8bed\u53e5\uff0c\u6240\u6709\u7684\u6743\u9650\u90fd\u662f\u4ece root \u8d4b\u6743\u51fa\u6765\u7684\u3002</p> <p>\u8d4b\u4e88\u67d0\u4e2a\u6743\u9650\u7ed9\u67d0\u4e2a\u7528\u6237\u65f6\uff0c\u6700\u540e\u8ddf\u4e0a with grant option\uff0c\u8868\u793a\u8fd9\u4e2a\u7528\u6237\u6709\u8fd9\u4e2a\u6743\u9650\u6709\u8d4b\u6743\u6743\u9650\uff0c\u5c31\u662f\u5b83\u53ef\u4ee5\u628a\u8fd9\u4e2a\u6743\u9650\u8d4b\u7ed9\u5176\u4ed6\u7528\u6237\u3002</p> <p>revoke \u662f\u6743\u9650\u6536\u56de\u8bed\u53e5</p> <pre><code>-- \u8868\u6743\u9650\ngrant select , insert , delete,alter , update \uff0ccreate, drop  on db.table to user@'host';\n\n\n-- \u5b58\u50a8\u8fc7\u7a0b/\u51fd\u6570\u6743\u9650\ngrant EXECUTE  , create routine , alter routine  on db.proc to user@'host';\n</code></pre> <p>\u5982\u679c\u9700\u8981\u4fee\u6539\u7528\u6237\uff0c\u5fc5\u987b\u8981\u6709\u5bf9<code>mysql</code>\u8fd9\u4e2aschema\u7684 <code>CREATE USER</code> \u548c <code>UPDATE</code> \u6743\u9650\u3002</p> <p>MySQL 8.0.16\u7248\u672c\u5f00\u59cb\uff0cMySQL\u5229\u7528<code>system_user</code>\u6743\u9650\u6765\u533a\u5206\u666e\u901a\u7528\u6237\u548c\u7cfb\u7edf\u7528\u6237\u3002\u5177\u4f53\u8868\u73b0\u662f\uff1a</p> <p>1\u3001\u62e5\u6709system_user\u6743\u9650\u7684\u8d26\u53f7\uff0c\u662f\u7cfb\u7edf\u8d26\u53f7\uff0c\u53ef\u4ee5\u4fee\u6539\u7cfb\u7edf\u8d26\u53f7\u81ea\u8eab\u548c\u666e\u901a\u8d26\u53f7\uff1b</p> <p>2\u3001\u6ca1\u6709system_user\u6743\u9650\u7684\u8d26\u53f7\uff0c\u662f\u666e\u901a\u8d26\u53f7\uff0c\u53ea\u80fd\u4fee\u6539\u666e\u901a\u8d26\u53f7\u81ea\u8eab\u3002</p> <p>MySQL5.7\u7248\u672c\u4e0b\uff0c\u53ea\u8981\u4e00\u4e2a\u8d26\u53f7\u6709<code>create user</code>\u6743\u9650\uff0c\u5c31\u53ef\u4ee5\u5bf9\u5176\u4ed6\u8d26\u53f7\u8fdb\u884c\u5220\u9664\u64cd\u4f5c\uff0c\u751a\u81f3<code>root</code>\u8d26\u53f7\u5b83\u90fd\u53ef\u4ee5\u5220\u9664\uff0c\u4e5f\u5c31\u662f\u8bf4**\u666e\u901a\u8d26\u53f7\u53ef\u4ee5\u5220\u9664root\u8fd9\u79cd\u9ad8\u6743\u9650\u7684\u7cfb\u7edf\u8d26\u53f7**\u3002</p> <p>MySQL8.0\u7248\u672c\u4e0b\uff0c\u4e00\u4e2a\u8d26\u53f7A\u6709<code>create user</code>\u6743\u9650\uff0c\u65e0\u6cd5\u5bf9\u62e5\u6709<code>system_user</code>\u6743\u9650\u7684<code>root\u8d26\u53f7</code>\u8fdb\u884c\u5220\u9664\u3002</p> <p>A\u8d26\u53f7\u8fd8\u9700\u8981\u62e5\u6709system_user\u6743\u9650\uff0c\u624d\u53ef\u4ee5\u5bf9root\u8d26\u53f7\u8fdb\u884c\u5220\u9664\uff0c\u56e0\u4e3aroot\u7528\u6237\u672c\u8eab\u62e5\u6709system_user\u6743\u9650\uff0c\u4e5f\u662f\u4e00\u4e2a\u7cfb\u7edf\u8d26\u53f7\uff0c\u53ea\u6709\u7cfb\u7edf\u8d26\u53f7\u624d\u80fd\u64cd\u4f5c\u7cfb\u7edf\u8d26\u53f7</p> <ul> <li> <p>\u5177\u6709system_user\u6743\u9650\u7684\u7cfb\u7edf\u8d26\u53f7\uff0c\u53ef\u4ee5\u5bf9\u666e\u901a\u8d26\u53f7\u548c\u5176\u4ed6\u7cfb\u7edf\u8d26\u53f7\u8fdb\u884c\u7ba1\u7406\uff0c\u5305\u542b\u8d26\u53f7\u7684\u521b\u5efa\u3001\u5220\u9664\u3001\u4fee\u6539\uff0c\u6743\u9650\u7684\u6388\u4e88\u548c\u56de\u6536\uff0c\u5bc6\u7801\u4fee\u6539\uff0c\u6216\u8005\u5bc6\u7801\u5c5e\u6027\u4fee\u6539\u7b49\uff08\u4f8b\u5982\u4fee\u6539\u5bc6\u7801\u8fc7\u671f\u65f6\u95f4\uff09;</p> </li> <li> <p>kill\u4e00\u4e2a\u5177\u6709system_user\u6743\u9650\u7684\u8d26\u53f7A\u6301\u6709\u7684\u4f1a\u8bdd\uff0c\u4f60\u81ea\u8eab\u6267\u884ckill\u547d\u4ee4\u7684\u8d26\u53f7B\u4e5f\u5fc5\u987b\u6709system_user\u6743\u9650\uff1b</p> </li> </ul> <p>\u5728 MySQL5.7 \u4e2d\uff0c\u5b58\u50a8\u8fc7\u7a0b\u548c\u51fd\u6570\u7684\u5143\u6570\u636e\uff0c\u662f\u5b58\u5728 <code>mysql.proc</code> \u4e2d \u5728 MySQL8.0 \u4e2d\uff0c\u5b58\u50a8\u8fc7\u7a0b\u548c\u51fd\u6570\u7684\u5143\u6570\u636e\uff0c\u662f\u5b58\u5728 <code>information_schema.routines</code> \u4e2d</p> <pre><code>-- \u5728MySQL8.0.20\u4e4b\u524d\uff0c\u9700\u8981\u5bf9\u666e\u901a\u7528\u6237\u8fdb\u884c\u5982\u4e0b\u6388\u6743\u540e\u624d\u80fd\u770b\u5230\u5176\u4ed6\u7528\u6237\u5b9a\u4e49\u7684\u51fd\u6570/\u5b58\u50a8\u8fc7\u7a0b\uff1a\nGRANT CREATE ROUTINE,ALTER ROUTINE,EXECUTE,TRIGGER,SYSTEM_USER,EVENT,SELECT ON schema_name.* TO 'YOUR_USERNAME';\n\n-- \u5728MySQL8.0.20\u540e\uff0c\u53ef\u4ee5\u8fd9\u6837\u8d4b\u6743\nGRANT CREATE ROUTINE,ALTER ROUTINE,EXECUTE,TRIGGER,SYSTEM_USER,EVENT,SHOW_ROUTINE  ON schema_name.* TO 'YOUR_USERNAME';\n\n\n-- MySQL8.0.20\u4e2d\u4e13\u95e8\u589e\u52a0\u4e86show_routine \u6743\u9650\u7528\u4e8e\u8868\u793a\u67e5\u770b\u6240\u6709\u7684 procedures/func \u7684\u6743\u9650\uff08\u5373\u4f7f\u4e0d\u662fdefiner\uff09\uff0c\u4e0d\u8fc7\u9700\u8981\u6ce8\u610f\uff0cshow_routine \u662f\u5168\u5c40\u6743\u9650\u3002\n</code></pre> <p>\u5173\u4e8e\u8fd9\u70b9\u5728MySQL\u5b98\u65b9\u6587\u6863\u4e2d\u6709\u8bf4\u660e\uff1a</p> <p>\u8d4b\u6743\u540e\uff0c\u7528\u6237\u53ef\u4ee5\u6267\u884c SHOW CREATE FUNCTION \uff0c \u00a0SHOW CREATE PROCEDURE\u00a0 \u7b49\u8bed\u53e5\u6765\u67e5\u770b\u5176\u5b9a\u4e49\u3002</p>"},{"location":"basic/2.install_mysql/#5mysql","title":"5\u3001MySQL\u81ea\u5e26\u7684\u6570\u636e\u5e93","text":"<p>MySQL \u5b98\u65b9\u63d0\u4f9b\u4e86\u591a\u4e2a\u793a\u4f8b\u6570\u636e\u5e93\uff0c\u5728MySQL\u7684\u5b66\u4e60\u3001\u5f00\u53d1\u548c\u5b9e\u8df5\u4e2d\u5177\u6709\u975e\u5e38\u91cd\u8981\u7684\u4f5c\u7528\uff0c\u80fd\u591f\u5e2e\u52a9\u521d\u5b66\u8005\u66f4\u597d\u5730\u7406\u89e3\u548c\u5e94\u7528MySQL\u7684\u5404\u79cd\u529f\u80fd\u548c\u7279\u6027\u3002</p> <p>\u5b98\u65b9\u63d0\u4f9b\u7684\u793a\u4f8b\u6570\u636e\u5177\u4f53\u5217\u8868\u5982\u4e0b\uff1a</p> <ol> <li>employee data (large dataset, includes data and test/verification suite)</li> <li>world database</li> <li>world_x database</li> <li>sakila database</li> <li>airportdb database (large dataset, intended for MySQL on OCI and HeatWave)   </li> <li>menagerie database</li> </ol> <p>\u8fd9\u4e9b\u6570\u636e\u5e93\u90fd\u53ef\u4ee5\u901a\u8fc7\u5b98\u65b9\u7f51\u5740\u8fdb\u884c\u4e0b\u8f7d\u548c\u5b89\u88c5</p>"},{"location":"basic/2.install_mysql/#sakila","title":"sakila\u6570\u636e\u5e93","text":"<p>Sakila\u6570\u636e\u5e93\u63d0\u4f9b\u4e86\u4e30\u5bcc\u7684\u6570\u636e\u96c6\u6765\u6f14\u793a\u5982\u4f55\u4f7f\u7528MySQL\u8fdb\u884c\u9ad8\u6548\u7684\u6570\u636e\u5e93\u67e5\u8be2\u548c\u6570\u636e\u7ba1\u7406\u3002\u901a\u8fc7\u4f7f\u7528Sakila\u6570\u636e\u5e93\uff0c\u521d\u5b66\u8005\u53ef\u4ee5\u5b66\u4e60\u5982\u4f55\u4f7f\u7528SELECT\u3001JOIN\u3001GROUP BY\u7b49\u5173\u952e\u5b57\u8fdb\u884c\u590d\u6742\u7684\u67e5\u8be2\uff0c\u4f7f\u7528INSERT\u3001UPDATE\u3001DELETE\u7b49\u5173\u952e\u5b57\u8fdb\u884c\u6570\u636e\u7ba1\u7406\uff0c\u4ee5\u53ca\u4f7f\u7528\u7ea6\u675f\u3001\u7d22\u5f15\u3001\u5b58\u50a8\u8fc7\u7a0b\u7b49\u9ad8\u7ea7\u529f\u80fd\u8fdb\u884c\u6570\u636e\u5e93\u8bbe\u8ba1\u548c\u4f18\u5316\u3002</p> <p>Sakila\u6570\u636e\u5e93\u8fd8\u63d0\u4f9b\u4e86\u4e00\u4e2a\u5178\u578b\u7684\u7535\u5f71\u79df\u8d41\u4e1a\u52a1\u573a\u666f\uff0c\u53ef\u4ee5\u8ba9\u5b66\u4e60\u8005\u66f4\u597d\u5730\u7406\u89e3\u6570\u636e\u5e93\u5982\u4f55\u5e94\u7528\u5728\u771f\u5b9e\u7684\u4e1a\u52a1\u573a\u666f\u4e2d\u3002\u5728\u5b98\u65b9\u7f51\u7ad9\u4e0a\uff0c\u6709\u5173\u8be5\u6570\u636e\u5e93\u7684\u6587\u6863\u548c\u793a\u4f8b\u90fd\u53ef\u4ee5\u514d\u8d39\u4e0b\u8f7d\u548c\u4f7f\u7528\u3002</p> <p>\u53ef\u4ee5\u5728MySQL\u5b98\u65b9\u7f51\u7ad9\u7684\u793a\u4f8b\u6570\u636e\u5e93\u4e2d(Sample Databases)\u627e\u5230Sakila\u793a\u4f8b\u6570\u636e\u5e93\u3002Sakila\u793a\u4f8b\u6570\u636e\u5e93\u662f\u7531Oracle\u63d0\u4f9b\u7684\uff0c\u65e8\u5728\u66ff\u4ee3\u539f\u6709\u7684world\u793a\u4f8b\u6570\u636e\u5e93\u3002\u76f8\u6bd4\u4e8eworld\u793a\u4f8b\u6570\u636e\u5e93\uff0cSakila\u793a\u4f8b\u6570\u636e\u5e93\u66f4\u52a0\u590d\u6742\uff0c\u7528\u4e8e\u6a21\u62df\u4e00\u4e2aDVD\u79df\u8d41\u5e97\uff0c\u5e76\u4e14\u5305\u542b\u4e86\u66f4\u591a\u8868\u683c\u4ee5\u53ca\u66f4\u590d\u6742\u7684\u8868\u683c\u5173\u7cfb\u3002Sakila\u793a\u4f8b\u6570\u636e\u5e93\u88ab\u8bbe\u8ba1\u7528\u6765\u63d0\u4f9b\u4e00\u4e2a\u66f4\u52a0\u5b9e\u7528\u548c\u6709\u8da3\u7684\u793a\u4f8b\uff0c\u4f9bMySQL\u5b66\u4e60\u8005\u8bad\u7ec3\u4ed6\u4eec\u7684SQL\u6280\u80fd\u3002\u5982\u679c\u60a8\u60f3\u8981\u7ec3\u4e60SQL\u6280\u80fd\uff0c\u53ef\u4ee5\u4e0b\u8f7dSakila\u793a\u4f8b\u6570\u636e\u5e93\u8fdb\u884c\u5c1d\u8bd5\u3002</p> <p>Sakila\u6570\u636e\u5e93\u5305\u62ec16\u4e2a\u8868\u30017\u4e2a\u89c6\u56fe\u30013\u4e2a Stored Procedures\u30013\u4e2a Stored Functions\u30016\u4e2a\u89e6\u53d1\u5668\u3002</p> <ol> <li> <p>actor - \u8fd9\u5f20\u8868\u5b58\u50a8\u4e86\u6240\u6709\u6f14\u5458\u7684\u4fe1\u606f\uff0c\u5305\u62ec\u6f14\u5458\u7684ID\u3001\u59d3\u540d\u548c\u6700\u540e\u66f4\u65b0\u65f6\u95f4\u3002</p> </li> <li> <p>actor_info - \u8fd9\u4e2a\u89c6\u56fe\u7ed3\u5408\u4e86 actor\u3001film_actor \u548c film \u8868\uff0c\u63d0\u4f9b\u4e86\u66f4\u8be6\u7ec6\u7684\u6f14\u5458\u4fe1\u606f\uff0c\u5305\u62ec\u6f14\u5458\u6240\u51fa\u6f14\u7684\u7535\u5f71\u540d\u79f0\u548c\u63cf\u8ff0\u3002</p> </li> <li> <p>address - \u8fd9\u5f20\u8868\u5b58\u50a8\u4e86\u5ba2\u6237\u7684\u5730\u5740\u4fe1\u606f\uff0c\u5305\u62ec\u5730\u5740ID\u3001\u5730\u5740\u3001\u533a\u57df\u3001\u57ce\u5e02\u3001\u90ae\u7f16\u3001\u56fd\u5bb6\u548c\u6700\u540e\u66f4\u65b0\u65e5\u671f\u3002</p> </li> <li> <p>category - \u8fd9\u5f20\u8868\u5b58\u50a8\u4e86\u6240\u6709\u7535\u5f71\u7684\u5206\u7c7b\u4fe1\u606f\uff0c\u5305\u62ec\u5206\u7c7bID \u548c\u5206\u7c7b\u540d\u79f0\u3002</p> </li> <li> <p>city - \u8fd9\u5f20\u8868\u5b58\u50a8\u4e86\u57ce\u5e02\u7684\u4fe1\u606f\uff0c\u5305\u62ec\u57ce\u5e02ID\u3001\u57ce\u5e02\u540d\u79f0\u3001\u533a\u57df\u4ee5\u53ca\u6700\u540e\u66f4\u65b0\u65f6\u95f4\u3002</p> </li> <li> <p>country - \u8fd9\u5f20\u8868\u5b58\u50a8\u4e86\u56fd\u5bb6\u7684\u4fe1\u606f\uff0c\u5305\u62ec\u56fd\u5bb6ID\u3001\u56fd\u5bb6\u540d\u79f0\u4ee5\u53ca\u6700\u540e\u66f4\u65b0\u65f6\u95f4\u3002</p> </li> <li> <p>customer - \u8fd9\u5f20\u8868\u5b58\u50a8\u4e86\u5ba2\u6237\u4fe1\u606f\uff0c\u5305\u62ec\u5ba2\u6237ID\u3001\u59d3\u540d\u3001\u7535\u5b50\u90ae\u4ef6\u3001\u5730\u5740\u3001\u533a\u57df\u3001\u57ce\u5e02\u3001\u90ae\u7f16\u4ee5\u53ca\u6700\u540e\u66f4\u65b0\u65f6\u95f4\u3002</p> </li> <li> <p>customer_list - \u8fd9\u4e2a\u89c6\u56fe\u7ed3\u5408\u4e86 customer\u3001address \u548c city \u8868\uff0c\u63d0\u4f9b\u4e86\u66f4\u8be6\u7ec6\u7684\u5ba2\u6237\u4fe1\u606f\uff0c\u5305\u62ec\u5ba2\u6237ID\u3001\u59d3\u540d\u3001\u7535\u5b50\u90ae\u4ef6\u3001\u5730\u5740\u3001\u533a\u57df\u3001\u57ce\u5e02\u3001\u90ae\u7f16\u3001\u56fd\u5bb6\u548c\u6700\u540e\u66f4\u65b0\u65e5\u671f\u3002</p> </li> <li> <p>film - \u8fd9\u5f20\u8868\u5b58\u50a8\u4e86\u6240\u6709\u7535\u5f71\u7684\u4fe1\u606f\uff0c\u5305\u62ec\u7535\u5f71ID\u3001\u7535\u5f71\u540d\u79f0\u3001\u63cf\u8ff0\u3001\u53d1\u5e03\u5e74\u4efd\u3001\u8bed\u8a00ID\u3001\u539f\u59cb\u8bed\u8a00ID\u3001\u65f6\u957f\u3001\u79df\u8d41\u6301\u7eed\u65f6\u95f4\u3001\u79df\u8d41\u8d39\u7528\u4ee5\u53ca\u6700\u540e\u66f4\u65b0\u65f6\u95f4\u3002</p> </li> <li> <p>film_actor - \u8fd9\u5f20\u8868\u5b58\u50a8\u4e86\u7535\u5f71\u6f14\u5458\u7684\u5173\u8054\u4fe1\u606f\uff0c\u5305\u62ec\u7535\u5f71ID\u3001\u6f14\u5458ID\u4ee5\u53ca\u6700\u540e\u66f4\u65b0\u65f6\u95f4\u3002</p> </li> <li> <p>film_category - \u8fd9\u5f20\u8868\u5b58\u50a8\u4e86\u7535\u5f71\u7c7b\u578b\u7684\u5173\u8054\u4fe1\u606f\uff0c\u5305\u62ec\u7535\u5f71ID\u3001\u5206\u7c7bID\u4ee5\u53ca\u6700\u540e\u66f4\u65b0\u65f6\u95f4\u3002</p> </li> <li> <p>film_list - \u8fd9\u4e2a\u89c6\u56fe\u7ed3\u5408\u4e86 film \u548c category \u8868\uff0c\u63d0\u4f9b\u4e86\u66f4\u8be6\u7ec6\u7684\u7535\u5f71\u4fe1\u606f\uff0c\u5305\u62ec\u7535\u5f71ID\u3001\u7535\u5f71\u540d\u79f0\u3001\u63cf\u8ff0\u3001\u53d1\u5e03\u5e74\u4efd\u3001\u8bed\u8a00\u3001\u5206\u7c7b\u3001\u65f6\u957f\u3001\u79df\u8d41\u6301\u7eed\u65f6\u95f4\u4ee5\u53ca\u79df\u8d41\u8d39\u7528\u3002</p> </li> <li> <p>film_text - \u8fd9\u5f20\u8868\u5b58\u50a8\u4e86\u7535\u5f71\u7684\u63cf\u8ff0\u4fe1\u606f\uff0c\u5305\u62ec\u7535\u5f71ID\u3001\u6807\u9898\u3001\u63cf\u8ff0\u4ee5\u53ca\u6700\u540e\u66f4\u65b0\u65f6\u95f4\u3002</p> </li> <li> <p>inventory - \u8fd9\u5f20\u8868\u5b58\u50a8\u4e86\u6240\u6709\u7535\u5f71\u7684\u5e93\u5b58\u4fe1\u606f\uff0c\u5305\u62ec\u5e93\u5b58ID\u3001\u7535\u5f71ID\u3001\u79df\u8d41\u5546\u5e97ID\u4ee5\u53ca\u6700\u540e\u66f4\u65b0\u65f6\u95f4\u3002</p> </li> <li> <p>language - \u8fd9\u5f20\u8868\u5b58\u50a8\u4e86\u8bed\u8a00\u7684\u4fe1\u606f\uff0c\u5305\u62ec\u8bed\u8a00ID\u3001\u8bed\u8a00\u540d\u79f0\u4ee5\u53ca\u6700\u540e\u66f4\u65b0\u65f6\u95f4\u3002</p> </li> <li> <p>nicer_but_slower_film_list - \u8fd9\u4e2a\u89c6\u56fe\u7ed3\u5408\u4e86 film_list\u3001film_actor\u3001actor \u548c category \u8868\uff0c\u63d0\u4f9b\u66f4\u8be6\u7ec6\u7684\u7535\u5f71\u4fe1\u606f\uff0c\u5305\u62ec\u7535\u5f71ID\u3001\u7535\u5f71\u540d\u79f0\u3001\u63cf\u8ff0\u3001\u53d1\u5e03\u5e74\u4efd\u3001\u8bed\u8a00\u3001\u79df\u8d41\u6301\u7eed\u65f6\u95f4\u3001\u79df\u8d41\u8d39\u7528\u3001\u6f14\u5458\u5217\u8868\u3001\u5206\u7c7b\u5217\u8868\u4ee5\u53ca\u5e73\u5747\u8bc4\u5206\u3002</p> </li> <li> <p>payment - \u8fd9\u5f20\u8868\u5b58\u50a8\u4e86\u6240\u6709\u987e\u5ba2\u7684\u4ed8\u6b3e\u4fe1\u606f\uff0c\u5305\u62ec\u4ed8\u6b3eID\u3001\u987e\u5ba2ID\u3001\u79df\u8d41ID\u3001\u4ed8\u6b3e\u91d1\u989d\u3001\u4ed8\u6b3e\u65f6\u95f4\u4ee5\u53ca\u6700\u540e\u66f4\u65b0\u65f6\u95f4\u3002</p> </li> <li> <p>rental - \u8fd9\u5f20\u8868\u5b58\u50a8\u4e86\u6240\u6709\u51fa\u79df\u4fe1\u606f\uff0c\u5305\u62ec\u79df\u8d41ID\u3001\u5ba2\u6237ID\u3001\u5e93\u5b58ID\u3001\u79df\u8d41\u65f6\u95f4\u3001\u8fd4\u8fd8\u65f6\u95f4\u3001\u51fa\u79df\u8d39\u7528\u4ee5\u53ca\u6700\u540e\u66f4\u65b0\u65f6\u95f4\u3002</p> </li> <li> <p>sales_by_film_category - \u8fd9\u4e2a\u89c6\u56fe\u7edf\u8ba1\u4e86\u6bcf\u79cd\u7535\u5f71\u7c7b\u578b\u7684\u9500\u552e\u989d\uff0c\u5305\u62ec\u5206\u7c7b\u540d\u79f0\u3001\u9500\u552e\u989d\u4ee5\u53ca\u6700\u540e\u66f4\u65b0\u65f6\u95f4\u3002</p> </li> <li> <p>sales_by_store - \u8fd9\u4e2a\u89c6\u56fe\u7edf\u8ba1\u4e86\u6bcf\u4e2a\u5e97\u94fa\u7684\u9500\u552e\u989d\uff0c\u5305\u62ec\u5e97\u94faID\u3001\u57ce\u5e02\u3001\u56fd\u5bb6\u3001\u9500\u552e\u989d\u4ee5\u53ca\u6700\u540e\u66f4\u65b0\u65f6\u95f4\u3002</p> </li> <li> <p>staff - \u8fd9\u5f20\u8868\u5b58\u50a8\u4e86\u5458\u5de5\u7684\u4fe1\u606f\uff0c\u5305\u62ec\u5458\u5de5ID\u3001\u59d3\u540d\u3001\u7535\u5b50\u90ae\u4ef6\u3001\u5e97\u94faID\u3001\u7528\u6237\u540d\u3001\u5bc6\u7801\u4ee5\u53ca\u6700\u540e\u66f4\u65b0\u65f6\u95f4\u3002</p> </li> <li> <p>staff_list - \u8fd9\u4e2a\u89c6\u56fe\u7ed3\u5408\u4e86 staff \u548c address \u8868\uff0c\u63d0\u4f9b\u4e86\u66f4\u8be6\u7ec6\u7684\u5458\u5de5\u4fe1\u606f\uff0c\u5305\u62ec\u5458\u5de5ID\u3001\u59d3\u540d\u3001\u7535\u5b50\u90ae\u4ef6\u3001\u5730\u5740\u3001\u533a\u57df\u3001\u57ce\u5e02\u3001\u90ae\u7f16\u3001\u56fd\u5bb6\u4ee5\u53ca\u6700\u540e\u66f4\u65b0\u65f6\u95f4\u3002</p> </li> <li> <p>store - \u8fd9\u5f20\u8868\u5b58\u50a8\u4e86\u5e97\u94fa\u7684\u4fe1\u606f\uff0c\u5305\u62ec\u5e97\u94faID\u3001\u5730\u5740ID\u3001\u7ecf\u7406ID\u4ee5\u53ca\u6700\u540e\u66f4\u65b0\u65f6\u95f4\u3002</p> </li> </ol>"},{"location":"basic/2.install_mysql/#6mariadb","title":"6\u3001Mariadb\u5b89\u88c5","text":"<p>MariaDB\u548cMySQL\u533a\u522b\uff0c\u5176\u5b9e\u4e0d\u662f\u5f88\u5927\uff0c\u5c24\u5176\u662f<code>MySQL5.x</code>\u548c<code>MariaDB</code>\uff0c\u76ee\u524dMariaDB\u548cMySQL\u4e3b\u8981\u533a\u522b\uff1a</p> <ul> <li> <p>\u8bb8\u53ef\u534f\u8bae\uff1aMariaDB\u4f7f\u7528\u7684\u662fGPL\u534f\u8bae\uff0c\u800cMySQL\u4f7f\u7528\u7684\u662fGPL\u548cCommercial License\uff08\u5546\u7528\u534f\u8bae\uff09\u3002MariaDB\u6bd4MySQL\u66f4\u52a0\u5f00\u6e90\u3002</p> </li> <li> <p>SQL\u5f15\u64ce\uff1aMariaDB\u76f8\u6bd4MySQL\uff0c\u9664\u4e86\u63d0\u4f9b\u6807\u51c6\u7684MyISAM\u3001BLACKHOLE\u3001CSV\u3001MEMORY\u3001ARCHIVE\u548cMERGE\u5f15\u64ce\u5916\uff0c\u5728MariaDB\u6e90\u7801\u4e0e\u4e8c\u8fdb\u5236\u5305\u4e2d\u8fd8\u63d0\u4f9b\u4e0b\u5217\u5b58\u50a8\u5f15\u64ce\uff1aAria\u3001XtraDB \uff08\u4e0eInnoDB\u5bf9\u7b49\u66ff\u6362\uff09\u3001FederatedX \uff08\u4e0eFederated\u5bf9\u7b49\u66ff\u6362\uff09\u3001Cassandra\u7b49SQL\u5b58\u50a8\u5f15\u64ce\u3002</p> </li> <li> <p>\u901f\u5ea6\u5feb\uff1a\u636eMariaDB\u79f0\uff0c\u540c\u7b49\u914d\u7f6e\u6761\u4ef6\u4e0b\uff0cMariaDB\u68c0\u5f55\u4f1a\u6bd4MySQL\u5feb\u3002</p> </li> </ul> <p>\u7f51\u4e0aLinux\u7f16\u8bd1\u5b89\u88c5MariaDB\u7684\u65b9\u6cd5\u5176\u5b9e\u5f88\u591a\uff0c\u4f46\u662f\u5927\u591a\u5197\u4f59\u4e25\u91cd\uff0c\u7248\u672c\u592a\u8fc7\u8001\u65e7\u3002\u7f16\u8bd1\u5b89\u88c5MariaDB\u672c\u6765\u5c31\u662f\u6bd4\u8f83\u56f0\u96be\u7684\uff0c\u5982\u679c\u4f60\u89c9\u5f97\u592a\u96be\uff0c\u53ef\u4ee5\u4f7f\u7528Docker\u3001\u8f6f\u4ef6\u5305\u7ba1\u7406\u5668\u6765\u5b89\u88c5MariaDB\u3002</p> <p>\u4f9d\u8d56</p> <ul> <li>git</li> <li>gunzip</li> <li>GNU tar</li> <li>gcc/g++ 4.8.5 or later, recommend above 9 or clang/clang++</li> <li>GNU make 3.75 or later or Ninja</li> <li>bison (3.0)</li> <li>libncurses</li> <li>zlib-dev</li> <li>libevent-dev</li> <li>cmake above 2.8.7 though preferably above 3.3</li> <li>gnutls or openssl</li> <li>jemalloc (optional)</li> <li>snappy (compression library, optional)</li> <li>valgrind (only needed if running mysql-test-run --valgrind)</li> <li>libcurl (only needed if you want to use the S3 storage engine)</li> </ul> <p>\u6709\u4e9b\u5305\u7ba1\u7406\u5668\u652f\u6301\u6784\u5efa\u4f9d\u8d56\u547d\u4ee4\u3002\u4f7f\u7528\u8fd9\u79cd\u65b9\u5f0f\uff0c\u5305\u7ba1\u7406\u5668\u4f1a\u81ea\u52a8\u5c1d\u8bd5\u4e0b\u8f7d\u5b89\u88c5\u9700\u8981\u7684\u8fd9\u4e9b\u4f9d\u8d56\u3002\u8fd9\u4f1a\u8ba9\u7f16\u8bd1\u66f4\u52a0\u7b80\u5355\uff0c\u4e0d\u540c\u7684\u53d1\u884c\u7248\u5305\u7ba1\u7406\u5668\u5404\u6709\u4e0d\u540c\u3002</p> <pre><code># for  Ubuntu or Debian\napt build-dep mariadb-server\n\n# for Fedora or Rhel\ndnf builddep mariadb-server\n\n# for Centos\nyum install yum-utils\nyum-builddep mariadb-server\n\n# for openSUSE or SUSE \nzypper source-install -d mariadb\n</code></pre> <pre><code>cd /usr/local/src/ \n\n# \u5728\u56fd\u5185\u955c\u50cf\u4e0b\u8f7d\u6700\u65b0\u7248\u7684mariadb\u6e90\u4ee3\u7801\nwget https://mirrors.neusoft.edu.cn/mariadb//mariadb-11.0.1/source/mariadb-11.0.1.tar.gz\n\ntar -zxvf mariadb-11.0.1.tar.gz  &amp;&amp; cd  ariadb-11.0.1\n\n\ncmake . -DCMAKE_INSTALL_PREFIX=/usr/local/mysql \\\n-DMYSQL_DATADIR=/mydata/data \\\n-DWITH_INNOBASE_STORAGE_ENGINE=1 \\\n-DWITH_ARCHIVE_STORAGE_ENGINE=1 \\\n-DWITH_BLACKHOLE_STORAGE_ENGINE=1 \\\n-DWITH_READLINE=1 \\\n-DWITH_SSL=system \\\n-DWITH_ZLIB=system \\\n-DWITH_LIBWRAP=0 \\\n-DMYSQL_UNIX_ADDR=/tmp/mysql.sock \\\n-DDEFAULT_CHARSET=utf8 \\\n-DDEFAULT_COLLATION=utf8_general_ci\n</code></pre>"},{"location":"basic/3.mysql_execute_command/","title":"3. MySQL\u53ef\u6267\u884c\u7a0b\u5e8f","text":""},{"location":"basic/3.mysql_execute_command/#mysql","title":"MySQL \u7a0b\u5e8f\u6982\u89c8","text":"<p>MySQL \u5b89\u88c5\u76ee\u5f55\u4e0b\u7684 /bin \u76ee\u5f55\u4e2d\u6709\u5f88\u591a\u4e8c\u8fdb\u5236\u7684\u53ef\u6267\u884c\u7a0b\u5e8f\uff0c\u6bcf\u4e2a\u64cd\u4f5c\u7cfb\u7edf\u5e73\u53f0\u7684 mysql \u7248\u672c\u4e2d\u90fd\u6709\u8fd9\u4e9b\u53ef\u6267\u884c\u6587\u4ef6\uff0c\u9664\u4e86\u5c11\u6570\u662f\u5e73\u53f0\u4e13\u7528\u7684\uff08\u4f8b\u5982\uff0c\u6570\u636e\u5e93\u542f\u52a8\u811a\u672c\u5728 windows \u4e0a\u5c31\u4e0d\u9002\u7528\uff0c\u5728 windows \u4e2d\u901a\u5e38\u7684\u505a\u6cd5\u662f\u628a mysql \u6ce8\u518c\u6210\u7cfb\u7edf\u670d\u52a1\uff0c\u7136\u540e\u914d\u7f6e\u6210\u5f00\u673a\u81ea\u542f\uff09\u3002</p> <p>\u6bcf\u4e00\u4e2a\u53ef\u6267\u884c\u7a0b\u5e8f\u90fd\u53ef\u4ee5\u5728\u7ec8\u7aef\u4e2d\u6267\u884c\uff0c\u901a\u8fc7 --help \u6765\u67e5\u770b\u547d\u4ee4\u5e2e\u52a9\uff0c\u53ef\u4ee5\u5728\u547d\u4ee4\u4e2d\u663e\u5f0f\u6307\u5b9a\u53c2\u6570\u6216\u8005\u5728\u914d\u7f6e\u6587\u4ef6\u4e2d\u6307\u5b9a\uff0c\u6765\u8986\u76d6\u547d\u4ee4\u7684\u9ed8\u8ba4\u53c2\u6570\u3002</p> <p>\u5176\u4e2d mysql \u548c mysqld \u662f\u4e24\u4e2a\u91cd\u8981\u7684\u7a0b\u5e8f\uff0c\u8fd9\u4e24\u4e2a\u5206\u522b\u662f mysql \u5ba2\u6237\u7aef\u7a0b\u5e8f\u548c\u670d\u52a1\u7aef\u7a0b\u5e8f\u3002</p>"},{"location":"basic/3.mysql_execute_command/#_1","title":"\u542f\u52a8\u6216\u8005\u505c\u6b62\u7c7b\u7a0b\u5e8f","text":"<ul> <li>mysqld \u670d\u52a1\u7aef\u5b88\u62a4\u8fdb\u7a0b\u7684\u7a0b\u5e8f\uff08\u5373 MySQL Server\uff09</li> <li>mysqld_safe \u670d\u52a1\u7aef\u542f\u52a8\u811a\u672c\uff0c\u8fd9\u4e2a\u811a\u672c\u5c1d\u8bd5\u53bb\u542f\u52a8 mysqld \u5b88\u62a4\u8fdb\u7a0b\u7a0b\u5e8f\u3002\uff08\u5b98\u65b9\u63a8\u8350\u7684 MySQL \u542f\u52a8\u65b9\u5f0f\uff09</li> <li>mysql.server \u670d\u52a1\u5668\u542f\u52a8\u811a\u672c\uff0c\u4e3b\u8981\u662f\u8bbe\u7f6e\u64cd\u4f5c\u7cfb\u7edf\u7684\u5f00\u673a\u81ea\u542f\u4efb\u52a1\uff0c\u5b83\u8c03\u7528 mysqld_safe \u53bb\u542f\u52a8\u5b88\u62a4\u8fdb\u7a0b</li> <li>mysql.multi \u591a\u5b9e\u4f8b\u7ba1\u7406\u811a\u672c\uff0c\u7528\u4e8e\u7ba1\u7406\u5355\u673a\u591a\u5b9e\u4f8b\u7684\u542f\u52a8\u6216\u505c\u6b62</li> </ul>"},{"location":"basic/3.mysql_execute_command/#_2","title":"\u5b89\u88c5\u6216\u8005\u5347\u7ea7\u65f6\u7684\u7a0b\u5e8f","text":"<ul> <li>mysql_install_db \u7cfb\u7edf\u521d\u59cb\u5316\u7a0b\u5e8f\uff0c\u8fd9\u4e2a\u7a0b\u5e8f\u4f1a\u751f\u6210\u6570\u636e\u76ee\u5f55\uff0c\u521b\u5efa mysql \u7cfb\u7edf\u6570\u636e\u5e93\uff0c\u521d\u59cb\u5316\u9ed8\u8ba4\u6743\u9650</li> </ul> <p>mysql_install_db \u8fd9\u4e2a\u7a0b\u5e8f\u5728 MySQL 5.7.6 \u4e2d\u5df2\u7ecf\u5f03\u7528\uff0c\u56e0\u4e3a\u5b83\u7684\u529f\u80fd\u5df2\u7ecf\u96c6\u6210\u5728 mysqld \u4e2d\u4e86\uff0c\u6240\u4ee5\u5728\u5b89\u88c5 5.7 \u65f6\uff0c\u76f4\u63a5\u4f7f\u7528 mysqld --initialize \u6216\u8005 mysqld --initialize-insecure \u5c31\u53ef\u4ee5\u76f4\u63a5\u521d\u59cb\u5316\u3002</p> <p>\u5728 5.7.5 \u4e4b\u524d\uff0c\u8fd9\u4e2a\u7a0b\u5e8f\u662f\u7528 perl \u811a\u672c\u5199\u7684\uff0c\u6240\u4ee5\u9700\u8981\u5b89\u88c5 perl \uff0c5.7.5 \u4e4b\u540e\uff0c\u6539\u4e3a\u7528 C++ \u5199\u7684\uff0c\u5e76\u4e14\u53ef\u4ee5\u76f4\u63a5\u505a\u4e3a\u4e8c\u8fdb\u5236\u6587\u4ef6\u6267\u884c\u3002</p> <ul> <li>mysql_plugin \u8fd9\u4e2a\u7a0b\u5e8f\u7528\u6765\u914d\u7f6e\u7ba1\u7406\u670d\u52a1\u7aef\u63d2\u4ef6</li> <li>mysql_secure_installation \u8fd9\u4e2a\u7a0b\u5e8f\u7528\u6765\u63d0\u5347\u5b89\u88c5\u8fc7\u7a0b\u7684\u5b89\u5168\u6027</li> <li>mysql_ssl_rsa_setup \u8fd9\u4e2a\u7a0b\u5e8f\u7528\u6765\u751f\u6210 ssl \u8bc1\u4e66\u548c\u5bc6\u94a5\u6587\u4ef6\uff0c\u4e3b\u8981\u7528\u4e8e\u6570\u636e\u5e93\u7684 SSL \u5b89\u5168\u8fde\u63a5</li> <li>mysql_upgrade \u8fd9\u4e2a\u7a0b\u5e8f\u5728 MySQL \u5347\u7ea7\u65f6\u4f7f\u7528\u3002</li> </ul>"},{"location":"basic/3.mysql_execute_command/#_3","title":"\u5ba2\u6237\u7aef\u7a0b\u5e8f","text":"<ul> <li>mysql \u4ea4\u4e92\u5f0f\u7684\u5ba2\u6237\u7aef\u5de5\u5177\uff0c\u767b\u9646\u540e\u53ef\u4ee5\u6267\u884c\u5404\u79cd sql \u547d\u4ee4</li> <li>mysqladmin \u6267\u884c\u7ba1\u7406\u64cd\u4f5c\u7684\u5ba2\u6237\u7aef\u7a0b\u5e8f\uff0c\u521b\u5efa\uff0c\u5220\u9664\u6570\u636e\u5e93\uff0c\u91cd\u8f7d\u6388\u6743\u8868\u7b49\u64cd\u4f5c</li> <li>mysqlcheck \u8868\u7ef4\u62a4\u5de5\u5177\uff0c\u4f8b\u5982\u68c0\u67e5\uff0c\u4fee\u590d\uff0c\u5206\u6790\uff0c\u4f18\u5316\u8868\u7b49</li> <li>mysqldump \u6570\u636e\u5e93\u5907\u4efd\u5de5\u5177\uff0c\u5c06 mysql \u5e93\u5bfc\u51fa\u4e3a sql \u6587\u4ef6</li> <li>mysqlimport \u53ef\u4ee5\u4f7f\u7528\u4e0e load data \u4e00\u6837\u7684\u65b9\u5f0f\u5411 mysql \u6570\u636e\u5e93\u4e2d\u5bfc\u5165\u6570\u636e</li> <li>mysqlshow \u4e00\u4e2a\u53ef\u4ee5\u663e\u793a\u51fa\u6570\u636e\u5e93\uff0c\u8868\uff0c\u5217\uff0c\u7d22\u5f15\u7b49\u5143\u6570\u636e\u4fe1\u606f\u7684\u7a0b\u5e8f</li> <li>mysqlpump</li> </ul>"},{"location":"basic/3.mysql_execute_command/#mysql_1","title":"\u4f7f\u7528 MySQL \u7a0b\u5e8f","text":""},{"location":"basic/3.mysql_execute_command/#mysql_2","title":"\u89e3\u6790 MySQL \u7a0b\u5e8f","text":"<p>\u5728\u547d\u4ee4\u884c\u4e2d\u4f7f\u7528 mysql \u7a0b\u5e8f\uff0c\u53c2\u6570\u53ef\u80fd\u7528 - \u6216 -- \u524d\u7f00\u6765\u6307\u5b9a\u53c2\u6570\u9009\u9879\uff0c\u4e5f\u5b58\u5728\u6ca1\u6709\u524d\u7f00\u9009\u9879\u7684\u53c2\u6570\uff0c\u8fd9\u79cd\u63d0\u4f9b\u4e86\u4e00\u4e9b\u989d\u5916\u7684\u4fe1\u606f\uff0c\u4f8b\u5982 mysql \u7a0b\u5e8f\u68c0\u6d4b\u5230\u7b2c\u4e00\u4e2a\u6ca1\u6709\u9009\u9879\u7684\u53c2\u6570\uff0c\u4f1a\u628a\u8fd9\u4e2a\u53c2\u6570\u5f53\u4f5c\u8981\u64cd\u4f5c\u7684\u6570\u636e\u5e93\u540d\u79f0\u3002</p> <p>\u6240\u4ee5 mysql --user=root test \u8fd9\u4e2a\u547d\u4ee4\u6307\u5b9a\u8981\u64cd\u4f5c\u7684\u6570\u636e\u5e93\u662f test \u3002\u76f8\u5f53\u4e8e\u767b\u5f55\u540e use test \u4e00\u6837\u3002</p> <p>\u5f88\u591a\u53c2\u6570\u9009\u9879\u5bf9\u4e00\u4e9b\u7a0b\u5e8f\u90fd\u662f\u901a\u7528\u7684\uff0c\u6700\u5e38\u7528\u7684\u662f --host(-h), --user(-u),--password(-p) ,--port(-P),--socket(-S)\uff0c\u8fd9\u4e2a\u7528\u6765\u6307\u5b9a\u8fde\u63a5\u9009\u9879\uff0c\u5bf9\u6240\u6709\u7684\u5ba2\u6237\u7aef\u7a0b\u5e8f\u90fd\u53ef\u4ee5\u9002\u7528\u3002\u7528\u4e8e\u6307\u5b9a\u8fde\u63a5\u7684\u4e3b\u673a\uff0c\u7528\u6237\u540d\uff0c\u5bc6\u7801\uff0c\u7aef\u53e3\uff0c\u5957\u63a5\u5b57\u6587\u4ef6\u3002</p> <p>\u9ed8\u8ba4\u5b89\u88c5\u540e\uff0c\u53ea\u80fd\u5728 mysql \u7684 bin \u76ee\u5f55\u4e0b\u624d\u53ef\u4ee5\u5141\u8bb8\u8fd9\u4e9b\u7a0b\u5e8f\uff0c\u6240\u4ee5\u9700\u8981\u628a\u8fd9\u4e2a\u76ee\u5f55\u6dfb\u52a0\u5230\u64cd\u4f5c\u7cfb\u7edf\u7684\u73af\u5883\u53d8\u91cf PATH \u4e2d\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u5728\u4efb\u4f55\u8def\u5f84\u4e0b\u90fd\u53ef\u4ee5\u6267\u884c\u4e8c\u8fdb\u5236\u6587\u4ef6\u3002</p> <p>\u5728 Linux \u4e2d\u53ef\u4ee5\u7528 bash \u7ec8\u7aef\u547d\u4ee4\u884c\uff0c\u5728 Windows \u4e2d\u53ef\u4ee5\u7528 cmd \u547d\u4ee4\u884c\u3002</p>"},{"location":"basic/3.mysql_execute_command/#mysql_3","title":"\u8fde\u63a5\u5230 mysql \u670d\u52a1\u5668","text":"<p>\u5bf9\u4e8e\u4e00\u4e2a\u5ba2\u6237\u7aef\u7a0b\u5e8f\uff0c\u8fde\u63a5 mysql \u7684\u65f6\u5019\uff0c\u9700\u8981\u63d0\u4f9b\u4e00\u4e9b\u53c2\u6570\uff08\u4e3b\u673a IP\uff0c\u7aef\u53e3\uff0c\u7528\u6237\u540d\uff0c\u5bc6\u7801\uff09\u3002</p> <p>\u6bcf\u4e2a\u53c2\u6570\u90fd\u6709\u9ed8\u8ba4\u503c\uff0c\u53ef\u4ee5\u901a\u8fc7\u5728\u547d\u4ee4\u884c\u4e2d\u91cd\u5199\u6216\u5728\u914d\u7f6e\u6587\u4ef6\u4e2d\u6307\u5b9a\u597d\u3002</p> <p>\u4e0b\u9762\u4ee5 mysql \u8fd9\u4e2a\u5ba2\u6237\u7aef\u7a0b\u5e8f\u4e3a\u4f8b\uff0c\u8fd9\u4e9b\u53c2\u6570\u5bf9\u4e8e\u5176\u4ed6\u7684\u5ba2\u6237\u7aef\u7a0b\u5e8f\u540c\u6837\u4e5f\u9002\u7528\u3002</p> <pre><code>$ mysql  -h localhost -u myname -ppassword mydb\n</code></pre> <p>\u76f4\u63a5\u5728\u547d\u4ee4\u884c\u4e2d\u8c03\u7528\u8fd9\u4e2a\u547d\u4ee4\uff0c\u5982\u679c\u4e0d\u5e26\u53c2\u6570\uff0c\u53c2\u6570\u76f4\u63a5\u4f7f\u7528\u9ed8\u8ba4\u503c\uff1a</p> <ul> <li>\u9ed8\u8ba4\u4e3b\u673a\u662f localhost , \u8868\u793a\u8fde\u63a5\u672c\u673a\u7684 MySQL</li> <li>\u9ed8\u8ba4\u7528\u6237\u540d\uff0c\u5728 windows \u4e2d\u662f ODBC \uff0c\u5728 Unix \u4e2d\u662f\u5f53\u524d shell \u767b\u9646\u7684\u7528\u6237\u540d\u3002\u4e00\u822c\u6211\u4eec\u4f1a\u7528 -u \u6307\u5b9a root \u6765\u767b\u5f55</li> <li>\u5982\u679c -p \u6216 --password \u6ca1\u6307\u5b9a\uff0c\u8868\u793a\u6ca1\u6709\u5bc6\u7801\u3002</li> <li>\u5bf9\u4e8e mysql \u7a0b\u5e8f\uff0c\u7b2c\u4e00\u4e2a\u65e0\u9009\u9879\u53c2\u6570\u88ab\u8ba4\u5b9a\u4e3a\u767b\u9646\u540e\u8981\u9009\u4e2d\u64cd\u4f5c\u7684\u9ed8\u8ba4\u6570\u636e\u5e93 schema\u3002</li> </ul> <p>\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u4e24\u79cd\u65b9\u5f0f\u6765\u767b\u9646\uff1a</p> <pre><code># \u957f\u53c2\u6570\nmysql --host=localhost --user=myname --password=password mydb\n# \u77ed\u53c2\u6570\nmysql -h localhost -u myname -ppassword mydb\n</code></pre> <p>\u5982\u679c\u5728\u547d\u4ee4\u4f7f\u7528 -p \u9009\u9879\u6307\u5b9a\u5bc6\u7801\uff0c\u90a3\u4e48\u5728 --password= \u548c -p \u540e\u76f4\u63a5\u8ddf\u5bc6\u7801\uff0c\u4e0d\u80fd\u5e26\u7a7a\u683c\u3002</p> <p>\u5982\u679c\u4e0d\u5728\u547d\u4ee4\u4e2d\u8ddf\u5bc6\u7801\uff0c\u90a3\u4e48 mysql \u7a0b\u5e8f\u4f1a\u4ea4\u4e92\u5f0f\u5f39\u51fa\u5bc6\u7801\u8f93\u5165\u6846\u3002\u8fd9\u79cd\u65b9\u5f0f\u662f\u53ef\u53d6\u7684\u3002</p> <p>\u5728\u4e00\u4e9b\u64cd\u4f5c\u7cfb\u7edf\u4e2d\uff0c\u76f4\u63a5\u5728 mysql \u547d\u4ee4\u4e2d\u6307\u5b9a\u5bc6\u7801\u662f\u4e0d\u5b89\u5168\u7684\uff0c\u5176\u4ed6\u7528\u6237\u53ef\u4ee5\u901a\u8fc7 ps \u7b49\u547d\u4ee4\u663e\u793a\u51fa\u4f60\u8f93\u5165\u7684\u660e\u6587\u5bc6\u7801\u3002</p> <p>\u6240\u4ee5\u5728\u7ec8\u7aef\u4e2d\uff0c\u5c3d\u91cf\u907f\u514d\u4f7f\u7528 --password=password \u548c -ppassword \u8fd9\u79cd\u683c\u5f0f\u3002</p> <p>\u5728\u4e00\u4e9b\u64cd\u4f5c\u7cfb\u7edf\u4e2d\uff0c\u9650\u5236\u4e86\u5728\u7ec8\u7aef\u4e2d\u8f93\u5165\u7684\u5bc6\u7801\u6570\u6700\u5927\u662f 8 \u4f4d\u5b57\u7b26\uff0c\u8fd9\u662f\u7cfb\u7edf\u9650\u5236\uff0c\u5e76\u4e0d\u662f mysql \u9650\u5236\u3002\u5728 mysql \u5185\u90e8\u5e76\u6ca1\u6709\u5bc6\u7801\u957f\u5ea6\u7684\u9650\u5236\u3002</p> <p>\u4e3a\u4e86\u89e3\u51b3\u8fd9\u7c7b\u95ee\u9898\uff0c\u628a\u5bc6\u7801\u8c03\u6574\u5230\u7b26\u5408\u7cfb\u7edf\u9650\u5236\u6216\u8005\u653e\u5230\u914d\u7f6e\u6587\u4ef6\u4e2d\u5373\u53ef\u3002</p> <p>mysql_config_editor \u53ef\u4ee5\u7ed9\u6307\u5b9a\u7684\u8fde\u63a5\u548c\u5bc6\u7801\u751f\u6210\u4e00\u4e2a\u52a0\u5bc6\u6587\u4ef6.mylogin.cnf\uff0c\u9ed8\u8ba4\u4f4d\u4e8e\u5f53\u524d\u7528\u6237\u5bb6\u76ee\u5f55\u4e0b\u3002</p> <p>mysql\u3001mysqladmin \u7b49\u53ef\u4ee5\u4f7f\u7528\u8be5\u6587\u4ef6\u76f4\u63a5\u767b\u5f55\uff0c\u53ef\u4ee5\u907f\u514d\u660e\u6587\u5bc6\u7801\u51fa\u73b0\u5728\u811a\u672c\u4e2d\u3002</p> <p>mysql_config_editor \u662f MySQL \u81ea\u5e26\u7684\u4e00\u6b3e\u7528\u4e8e\u5b89\u5168\u52a0\u5bc6\u767b\u5f55\u7684\u5de5\u5177\uff0c\u53ef\u4ee5\u5728\u4e00\u4e9b\u573a\u5408\u907f\u514d\u4f7f\u7528\u5bc6\u7801\u660e\u6587\uff0c\u4f8b\u5982\uff0c\u5199 shell \u811a\u672c\u65f6\uff0c\u4e0d\u7528\u5728\u4e3a\u5728\u811a\u672c\u91cc\u9762\u5199\u5165\u660e\u6587\u5bc6\u7801\u7ea0\u7ed3\u4e86\uff1b\u4e5f\u53ef\u4ee5\u7528\u4e8e\u7ba1\u7406\u591a\u53f0 MySQL \u5b9e\u4f8b\u3002</p> <p>\u53e6\u5916\uff0c\u50cf\u5982\u679c\u4f7f\u7528 mysql \u547d\u4ee4\u767b\u5f55\u6570\u636e\u5e93\uff0c\u53ef\u4ee5\u907f\u514d\u6bcf\u6b21\u90fd\u8981\u8f93\u5165\u4e00\u5806\u53c2\u6570\u3002\u7b80\u5355\u65b9\u4fbf\u3002</p> <pre><code># \u6ce8\u610f\uff1a--password,-p \u5bc6\u7801\uff0c\u6ce8\u610f\u8fd9\u4e2a\u5730\u65b9\u4e0d\u80fd\u4f7f\u7528\u201c=\u201d\u76f4\u63a5\u5199\u5165\u5bc6\u7801\nmysql_config_editor set --login_path=client --host=localhost  --user=root  --port=port_num --password\n</code></pre>"},{"location":"basic/3.mysql_execute_command/#_4","title":"\u6307\u5b9a\u53c2\u6570","text":"<p>\u6709\u5f88\u591a\u79cd\u65b9\u5f0f\u53ef\u4ee5\u7ed9 MySQL \u7a0b\u5e8f\u6307\u5b9a\u53c2\u6570\uff1a</p> <ul> <li>\u5728\u547d\u4ee4\u884c\u4e2d\u76f4\u63a5\u6307\u5b9a\u53c2\u6570\uff0c\u901a\u5e38\u662f MySQL \u7a0b\u5e8f\u540e\u8ddf\u53c2\u6570\u4ee5\u53ca\u53c2\u6570\u9009\u9879\u3002</li> <li>\u5728\u914d\u7f6e\u6587\u4ef6\u4e2d\u6307\u5b9a\uff0c\u7a0b\u5e8f\u4e00\u542f\u52a8\u5c31\u4f1a\u53bb\u8bfb\u914d\u7f6e\u6587\u4ef6\u3002</li> <li>\u5728\u73af\u5883\u53d8\u91cf\uff08MySQL \u5185\u90e8\u53d8\u91cf\uff09\u4e2d\u5217\u51fa\u9009\u9879</li> </ul> <p>\u9009\u9879\u6309\u7167\u987a\u5e8f\u88ab\u5904\u7406\uff1a</p> <ul> <li> <p>\u5982\u679c\u5728\u547d\u4ee4\u4e2d\u591a\u6b21\u6307\u5b9a\u540c\u4e00\u4e2a\u53c2\u6570\u9009\u9879\uff0c\u90a3\u4e48\u4ee5\u6700\u540e\u4e00\u4e2a\u4e3a\u51c6\u3002</p> </li> <li> <p>\u5982\u679c\u53c2\u6570\u9009\u9879\u51b2\u7a81\uff0c\u540e\u4e00\u4e2a\u53c2\u6570\u6709\u66f4\u9ad8\u7684\u4f18\u5148\u7ea7\u3002</p> </li> </ul> <p>MySQL \u7a0b\u5e8f\u5148\u627e\u73af\u5883\u53d8\u91cf\uff0c\u518d\u627e\u914d\u7f6e\u6587\u4ef6\uff0c\u6700\u540e\u901a\u8fc7\u547d\u4ee4\u884c\u4f20\u53c2\u3002</p> <p>\u8fd9\u610f\u5473\u7740\u73af\u5883\u53d8\u91cf\u7684\u4f18\u5148\u7ea7\u6700\u4f4e\uff0c\u547d\u4ee4\u884c\u53c2\u6570\u7684\u4f18\u5148\u7ea7\u6700\u9ad8\u3002</p> <p>\u53ef\u4ee5\u901a\u8fc7\u5728\u914d\u7f6e\u6587\u4ef6\u4e2d\u4e3a\u7a0b\u5e8f\u6307\u5b9a\u9ed8\u8ba4\u53c2\u6570\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u907f\u514d\u6bcf\u6b21\u6267\u884c\u547d\u4ee4\u65f6\u90fd\u8981\u8f93\u5165\u4e00\u5927\u5806\u53c2\u6570\uff0c\u5982\u679c\u9700\u8981\u6539\u53c2\u6570\u65f6\uff0c\u53ef\u4ee5\u76f4\u63a5\u5728\u547d\u4ee4\u884c\u4e2d\u6307\u5b9a\u6765\u8986\u76d6\u9ed8\u8ba4\u53c2\u6570\u3002</p> <p>\u5728\u65e9\u671f\u7684 MySQL \u7248\u672c\u4e2d\uff0c\u7a0b\u5e8f\u7684\u53c2\u6570\u53ef\u4ee5\u4f7f\u7528\u5b8c\u6574\u540d\u79f0\u6216\u53c2\u6570\u524d\u7f00\uff0c\u4f8b\u5982\u4f7f\u7528 mysqldump --compress \u4e5f\u53ef\u4ee5\u5199\u6210 mysqldump --compr\uff0c\u4f46\u662f\u4e0d\u80fd\u7528 --comp \uff0c\u56e0\u4e3a\u8fd8\u4e0d\u8db3\u4ee5\u8bc6\u522b\u51fa\u6765\u662f\u8fd9\u4e2a\u53c2\u6570\u3002</p> <p>\u5728 MySQL 5.7 \u4e2d\uff0c\u4e0d\u518d\u652f\u6301\u53c2\u6570\u524d\u7f00\u3002</p>"},{"location":"basic/3.mysql_execute_command/#_5","title":"\u5728\u547d\u4ee4\u884c\u4e2d\u6307\u5b9a\u53c2\u6570","text":"<p>\u5728\u547d\u4ee4\u884c\u4e2d\u6307\u5b9a\u53c2\u6570\u9700\u8981\u9075\u5faa\u4ee5\u4e0b\u89c4\u5219\uff1a</p> <ul> <li> <p>\u53c2\u6570\u8ddf\u5728\u547d\u4ee4\u540e\u9762\u3002</p> </li> <li> <p>\u53c2\u6570\u53ef\u4ee5\u4f7f\u7528 -- \u957f\u9009\u9879\u6216 - \u77ed\u9009\u9879\u3002\u5f88\u591a\u9009\u9879\u90fd\u652f\u6301\u957f\u9009\u9879\u548c\u77ed\u9009\u9879\u3002\u4f8b\u5982\uff1a-\uff1f \u548c --help \u90fd\u662f\u8868\u793a\u663e\u793a\u8be5\u547d\u4ee4\u7684\u5e2e\u52a9\uff0c\u4e00\u4e2a\u662f\u77ed\u9009\u9879\uff0c\u4e00\u4e2a\u662f\u957f\u9009\u9879\u3002</p> </li> <li> <p>\u53c2\u6570\u9009\u9879\u533a\u5206\u5927\u5c0f\u5199\uff0c-v \u548c -V \u5728\u5f88\u591a\u7a0b\u5e8f\u4e2d\u90fd\u6709\u4e0d\u540c\u542b\u4e49\uff0c\u5206\u522b\u8868\u793a(--verbose \u548c--version)\u3002</p> </li> <li> <p>\u5f88\u591a\u9009\u9879\u540e\u9762\u90fd\u53ef\u4ee5\u8ddf\u53c2\u6570\u503c\uff0c\u4f8b\u5982\uff1a -h localhost \u6216 --host=localhost \u8868\u793a\u8981\u8fde\u63a5\u7684\u4e3b\u673a\u5730\u5740\u3002</p> </li> <li> <p>\u5bf9\u4e8e\u957f\u9009\u9879\uff0c\u5728\u9009\u9879\u8ddf\u53c2\u6570\u503c\u4e4b\u95f4\u4f7f\u7528 = \u53f7\u8fde\u63a5\uff0c\u5bf9\u4e8e\u77ed\u9009\u9879\uff0c\u9009\u9879\u548c\u53c2\u6570\u4e4b\u95f4\u53ef\u4ee5\u5e26\u4e00\u4e2a\u7a7a\u683c\u6216\u4e0d\u5e26\u7a7a\u683c\u3002-hlocalhost \u548c -h localhost \u662f\u7b49\u4ef7\u7684\u3002</p> </li> <li> <p>\u552f\u4e00\u4f8b\u5916\u7684\u5c31\u662f\u6307\u5b9a\u5bc6\u7801\u7684\u65f6\u5019\uff0c\u53ea\u80fd\u4f7f\u7528 -ppassword \u6216 --password=password \u8fd9\u4e24\u79cd\u683c\u5f0f\u3002</p> </li> <li> <p>\u5bf9\u4e8e\u9009\u9879\u540d\u79f0\uff0c- \u53f7\u548c _ \u53f7\u662f\u7b49\u4ef7\u7684\uff0c --skip-grant-tables \u548c -- skip_grant_tables \u662f\u7b49\u4ef7\u7684\u3002\uff08\u4f46\u662f\u6700\u524d\u9762\u7684 - \u53f7\u4e0d\u80fd\u7528 _ \u53f7\u4ee3\u66ff\uff09\u3002</p> </li> <li> <p>\u5bf9\u4e8e\u4e00\u4e9b\u9700\u8981\u6307\u5b9a\u6570\u503c\u7684\u53c2\u6570\uff0c\u53ef\u4ee5\u4f7f\u7528 K,M,G \u7b49\u540e\u7f00\u6765\u8868\u793a <code>1024</code> \uff0c<code>1024^2</code>\uff0c<code>1024^3</code> \u3002</p> </li> <li> <p>\u6bd4\u5982 ./mysqladmin -u root -p'admin@123456' --count=1K --sleep=10 ping \u8868\u793a \u8fde\u7eed ping 1K \u6b21\uff0c\u6bcf\u6b21\u95f4\u9694 10s</p> </li> <li> <p>\u5f53\u6307\u5b9a\u6587\u4ef6\u540d\u7684\u65f6\u5019\uff0c\u4e0d\u8981\u7528 ~ \u4e4b\u7c7b\u7684 shell \u5143\u5b57\u7b26\u6765\u6307\u5b9a\u3002</p> </li> </ul> <p>\u53c2\u6570\u9009\u9879\u4e2d\u51fa\u73b0\u7a7a\u683c\u7684\u5730\u65b9\u9700\u8981\u7528\u5f15\u53f7\u5f15\u8d77\u6765\uff0c\u4f8b\u5982\uff1a--execute (or -e) \u9009\u9879\u53ef\u4ee5\u4f7f mysql \u8fd9\u4e2a\u5ba2\u6237\u7aef\u7a0b\u5e8f\u4f20\u4e00\u4e2a sql \u8bed\u53e5\u7ed9\u670d\u52a1\u7aef\u6267\u884c\u3002\u5f53\u4f7f\u7528\u8fd9\u4e2a\u9009\u9879\u65f6\uff0c\u5fc5\u987b\u8981\u7528\u5f15\u53f7\u628a\u540e\u9762\u7684 sql \u8bed\u53e5\u62ec\u8d77\u6765\u3002</p> <p>mysql -u root -p --execute=\"SELECT User, Host FROM mysql.user\"</p>"},{"location":"basic/3.mysql_execute_command/#_6","title":"\u53c2\u6570\u9009\u9879\u4fee\u9970","text":"<p>\u5f88\u591a\u53c2\u6570\u9009\u9879\u662f boolean \u7c7b\u578b\uff0c\u7528\u6765\u63a7\u5236\u67d0\u4e2a\u529f\u80fd\u7684\u5f00\u5173\u3002\u4f8b\u5982\uff0cmysql \u5ba2\u6237\u7aef\u7a0b\u5e8f\u4f7f\u7528 --column-names \u6765\u51b3\u5b9a\u67e5\u8be2\u7ed3\u679c\u662f\u5426\u6709\u6807\u9898\uff0c\u9ed8\u8ba4\u5730\uff0c\u5b83\u662f\u5f00\u542f\u7684\u3002\u53ef\u4ee5\u901a\u8fc7\u5982\u4e0b\u683c\u5f0f\u6765\u5173\u95ed\u5b83\uff1a</p> <pre><code>--disable-column-names\n--skip-column-names\n--column-names=0\n</code></pre> <p>-- disable \u524d\u7f00\uff0c--skip \u524d\u7f00\uff0c=0 \u540e\u7f00 \uff0c\u90fd\u6709\u4e00\u4e2a\u6548\u679c\uff0c\u90a3\u5c31\u662f\u5173\u95ed\u8fd9\u4e2a\u529f\u80fd\u3002</p> <p>\u542f\u7528\u8fd9\u4e2a\u529f\u80fd\u4e5f\u6709\u5982\u4e0b\u4e09\u79cd\u683c\u5f0f\uff1a</p> <pre><code>--column-names\n--enable-column-names\n--column-names=1\n</code></pre> <p>ON, TRUE, OFF, FALSE \u90fd\u88ab\u8ba4\u4e3a\u662f boolean \u7c7b\u578b\uff0c\u4e0d\u533a\u5206\u5927\u5c0f\u5199\u3002</p> <p>\u5982\u679c\u4e00\u4e2a\u53c2\u6570\u4ee5 --loose \u524d\u7f00\u5f00\u5934\uff0c\u5982\u679c\u547d\u4ee4\u4e0d\u80fd\u8bc6\u522b\u8fd9\u4e2a\u53c2\u6570\uff0c\u4e5f\u4e0d\u4f1a\u62a5\u9519\u9000\u51fa\uff0c\u53ea\u4f1a\u63d0\u793a warn \u8b66\u544a\u4e00\u4e0b\u3002</p> <pre><code>shell&gt; mysql --loose-no-such-option\nmysql: WARNING: unknown option '--loose-no-such-option'\n</code></pre>"},{"location":"basic/3.mysql_execute_command/#_7","title":"\u4f7f\u7528\u914d\u7f6e\u6587\u4ef6","text":"<p>\u5f88\u591a mysql \u7a0b\u5e8f\u90fd\u53ef\u4ee5\u4ece mysql \u914d\u7f6e\u6587\u4ef6\u4e2d\u8bfb\u53d6\u76f8\u5173\u53c2\u6570\uff0c\u628a\u53c2\u6570\u5199\u5728\u914d\u7f6e\u6587\u4ef6\u4e2d\u5c31\u53ef\u4ee5\u907f\u514d\u6bcf\u6b21\u6267\u884c\u547d\u4ee4\u90fd\u8981\u8f93\u5165\u53c2\u6570\u3002</p> <p>\u5224\u65ad\u4e00\u4e2a\u7a0b\u5e8f\u662f\u5426\u4ece\u914d\u7f6e\u6587\u4ef6\u4e2d\u8bfb\u53d6\u53c2\u6570\uff0c\u4f7f\u7528 --help \u6765\u67e5\u770b\u5e2e\u52a9\uff08\u5bf9\u4e8e mysqld\uff0c\u4f7f\u7528 --verbose \u548c --help\uff09\uff0c\u5982\u679c\u4e00\u4e2a\u7a0b\u5e8f\u90fd\u914d\u7f6e\u6587\u4ef6\u4e2d\u8bfb\u53c2\u6570\uff0c\u90a3\u4e48\u5b83\u4f1a\u663e\u793a\u5b83\u4ece\u54ea\u4e9b\u8def\u5f84\u5bfb\u627e\u914d\u7f6e\u6587\u4ef6\uff0c\u4ee5\u53ca\u8bc6\u522b\u5230\u7684\u9009\u9879\u7ec4\u3002</p> <pre><code>[root@localhost ~]# mysql --help --verbose | grep -C 10 /etc/my.cnf\n                      and also turns off parsing of all clientcommands except\n                      \\C and DELIMITER, in non-interactive mode (for input\n                      piped to mysql or loaded using the 'source' command).\n                      This is necessary when processing output from mysqlbinlog\n                      that may contain blobs.\n  --connect-expired-password\n                      Notify the server that this client is prepared to handle\n                      expired password sandbox mode.\n\nDefault options are read from the following files in the given order:\n/etc/my.cnf /etc/mysql/my.cnf /usr/local/mysql/etc/my.cnf ~/.my.cnf\nThe following groups are read: mysql client\nThe following options may be given as the first argument:\n--print-defaults        Print the program argument list and exit.\n--no-defaults           Don't read default options from any option file,\n                        except for login file.\n--defaults-file=#       Only read default options from the given file #.\n--defaults-extra-file=# Read this file after the global files are read.\n--defaults-group-suffix=#\n                        Also read groups with concat(group, suffix)\n--login-path=#          Read this path from the login file.\n[root@localhost ~]#\n</code></pre> <p>\u5f88\u591a\u914d\u7f6e\u6587\u4ef6\u90fd\u662f\u7eaf\u6587\u672c\u7684\uff0c\u4f7f\u7528\u4efb\u610f\u4e00\u79cd\u7f16\u8f91\u5668\u90fd\u53ef\u4ee5\u7f16\u8f91\u3002\u6709\u4e00\u4e2a\u4f8b\u5916\u7684\u662f .mylogin.cnf \u6587\u4ef6\uff0c\u8fd9\u662f\u4e00\u4e2a\u9700\u8981\u901a\u8fc7 mysql_config_editor \u5de5\u5177\u6765\u521b\u5efa\u7684\u52a0\u5bc6\u6587\u4ef6</p> <p>MySQL \u67e5\u627e\u914d\u7f6e\u6587\u4ef6\u65f6\uff0c\u90fd\u4f1a\u6309\u7167\u4e00\u5b9a\u7684\u67e5\u627e\u987a\u5e8f\u3002</p> \u914d\u7f6e\u6587\u4ef6\u8def\u5f84 \u76ee\u7684 /etc/my.cnf \u5168\u5c40 /etc/mysql/my.cnf \u5168\u5c40 SYSCONFDIR/my.cnf \u5168\u5c40 $MYSQL_HOME/my.cnf \u4ec5\u9002\u7528\u4e8e\u670d\u52a1\u7aef defaults-extra-file \u901a\u8fc7 --defaults-extra-file \u53c2\u6570\u6307\u5b9a ~/.my.cnf \u7528\u6237\u914d\u7f6e\u6587\u4ef6 ~/.mylogin.cnf \u7528\u6237\u767b\u5f55\u914d\u7f6e\u6587\u4ef6\uff08\u4ec5\u9002\u7528\u4e8e\u5ba2\u6237\u7aef\u7a0b\u5e8f\uff09 <p>SYSCONFDIR \u76ee\u5f55\u6307\u91c7\u7528 cmake \u7f16\u8bd1\u5b89\u88c5\u65f6 SYSCONFDIR \u8fd9\u4e2a\u7f16\u8bd1\u53c2\u6570\u6307\u5b9a\u7684\u76ee\u5f55\u3002\u9ed8\u8ba4\u662f /etc/ \u76ee\u5f55\u3002</p> <p>MYSQL_HOME \u662f\u4e00\u4e2a\u7cfb\u7edf\u73af\u5883\u53d8\u91cf\uff0c\u4e3b\u8981\u4f5c\u7528\u662f\u58f0\u660e my.cnf \u914d\u7f6e\u6587\u4ef6\u7684\u8def\u5f84\uff0c\u5982\u679c\u6ca1\u6709\u8bbe\u7f6e\uff0c\u5e76\u4e14\u901a\u8fc7 mysqld_safe \u542f\u52a8\u7684\u6570\u636e\u5e93\uff0c\u4e00\u822c\u662f\u6307\u5411 MySQL \u7684 basedir \uff0c</p> <p>\u4efb\u4f55\u4e00\u4e2a\u5728\u547d\u4ee4\u884c\u4e2d\u53ef\u4ee5\u7528\u957f\u9009\u9879\u6307\u5b9a\u7684\u53c2\u6570\u90fd\u53ef\u4ee5\u5728\u914d\u7f6e\u6587\u4ef6\u4e2d\u6307\u5b9a\uff0c\u67e5\u770b\u4e00\u4e2a\u7a0b\u5e8f\u7684\u53ef\u7528\u53c2\u6570\uff0c\u5728\u8fd0\u884c\u65f6\u4f7f\u7528 --help \u9009\u9879\u67e5\u770b\u6240\u6709\u53c2\u6570\u7684\u5e2e\u52a9\u3002\uff08\u5bf9\u4e8e mysqld \uff0c\u4f7f\u7528 --verbose \u548c --help \u4e00\u8d77\uff09\u3002</p> <p>\u5728\u547d\u4ee4\u4e2d\u6307\u5b9a\u53c2\u6570\u548c\u914d\u7f6e\u6587\u4ef6\u4e2d\u6307\u5b9a\u53c2\u6570\u7684\u8bed\u6cd5\u662f\u7c7b\u4f3c\u7684\uff0c\u4f46\u662f\u4e0d\u9700\u8981\u7528 -- \u524d\u7f00\uff0c\u5e76\u4e14\u6bcf\u4e00\u884c\u53ea\u6709\u4e00\u4e2a\u53c2\u6570\u3002\u4f8b\u5982\uff1a\u547d\u4ee4\u884c\u4e2d\u7684 --quick and --host=localhost \uff0c\u5728\u914d\u7f6e\u6587\u4ef6\u4e2d\u76f4\u63a5\u7528 quick \u548c host=localhost \u5c31\u53ef\u4ee5\u4e86\u3002</p> <p>\u914d\u7f6e\u6587\u4ef6\u4e2d\u7684\u7a7a\u884c\u4f1a\u88ab\u5ffd\u7565\uff0c\u975e\u7a7a\u884c\u6309\u7167\u5982\u4e0b\u89c4\u5219\uff1a</p> <ul> <li>\u6ce8\u91ca\u884c\u4ee5 # \u5f00\u5934\u3002</li> <li>[group] \u6307\u5b9a\u67d0\u4e2a\u7a0b\u5e8f\u4e0b\u7684\u53c2\u6570\uff0c\u5728\u6bcf\u4e2a group \u4e0b\u7684\u6bcf\u4e00\u884c\u53c2\u6570\uff0c\u90fd\u4f1a\u5728\u8fd0\u884c\u8fd9\u4e2a\u7a0b\u5e8f\u7684\u65f6\u5019\u5339\u914d\u3002</li> <li>\u914d\u7f6e\u6587\u4ef6\u901a\u5e38\u90fd\u662f opt_name=value \u952e\u503c\u5bf9\u7684\u683c\u5f0f\uff0c\u6709\u65f6\u5019\u4e5f\u53ef\u4ee5\u7528\"\"\u5f15\u53f7\u628a value \u5f15\u8d77\u6765\u3002</li> </ul> <p>\u4f8b\u5982\uff1a</p> <p>[mysqld] \u548c [mysql] \u4e0b\u7684\u53c2\u6570\uff0c\u5206\u522b\u5728\u8fd0\u884c mysqld \u7a0b\u5e8f\uff08\u670d\u52a1\u7aef\uff09\u548c mysql \u7a0b\u5e8f\uff08\u5ba2\u6237\u7aef\uff09\u65f6\u5339\u914d\u3002</p> <p>[client] \u53c2\u6570\u7ec4\u4f1a\u88ab\u6240\u6709 mysql \u5ba2\u6237\u7aef\u7a0b\u5e8f\u6240\u5339\u914d\u3002\u524d\u63d0\u662f\u6240\u6709\u5ba2\u6237\u7aef\u90fd\u53ef\u4ee5\u8bc6\u522b\u8fd9\u4e2a\u53c2\u6570</p> <p>\u8b6c\u5982\uff1a\u5f53\u5ba2\u6237\u7aef\u7a0b\u5e8f\u8981\u8fde\u63a5\u6570\u636e\u5e93\u65f6\uff0c[client] \u662f\u6700\u597d\u7684\u5b58\u5bc6\u7801\u7684\u65b9\u5f0f\uff08\u524d\u63d0\u662f\u8fd9\u4e2a\u914d\u7f6e\u6587\u4ef6\u53ea\u80fd\u4f60\u81ea\u5df1\u8bbf\u95ee\uff09</p> <p>\u4e0b\u9762\u662f\u4e00\u4e2a\u5168\u5c40\u7684\u914d\u7f6e\u6587\u4ef6\u793a\u4f8b\uff1a</p> <pre><code>[client]\nport=3306\nsocket=/tmp/mysql.sock\n[mysqld]\nport=3306\nsocket=/tmp/mysql.sock\nkey_buffer_size=16M\nmax_allowed_packet=8M\n[mysqldump]\nquick\n</code></pre> <p>\u4e0b\u9762\u662f\u4e00\u4e2a\u7528\u6237\u914d\u7f6e\u6587\u4ef6\u793a\u4f8b\uff1a</p> <pre><code>[client]\n# The following password will be sent to all standard MySQL clients\npassword=\"my password\"\n[mysql]\nno-auto-rehash\nconnect_timeout=2\n</code></pre> <p>\u4e5f\u53ef\u4ee5\u5728\u914d\u7f6e\u6587\u4ef6\u4e2d\u4f7f\u7528 !includedir \u6307\u4ee4\u6765\u5305\u542b\u5176\u4ed6\u8def\u5f84\u7684\u914d\u7f6e\u6587\u4ef6\u3002\u8fd9\u6837\u505a\u5c31\u662f\u914d\u7f6e\u6587\u4ef6\u5206\u5c42\u3002</p>"},{"location":"basic/3.mysql_execute_command/#_8","title":"\u914d\u7f6e\u89c4\u8303","text":"<p>\u6570\u636e\u5e93\u670d\u52a1\u7684\u914d\u7f6e\u5e94\u8be5\u7b26\u5408\u5b83\u7684\u5de5\u4f5c\u8d1f\u8f7d\uff0c\u6570\u636e\uff0c\u4ee5\u53ca\u5e94\u7528\u9700\u6c42\u3002MySQL \u4e2d\u6709\u5927\u91cf\u53ef\u4ee5\u4fee\u6539\u7684\u53c2\u6570\uff0c\u4f46\u662f\u4e0d\u5e94\u8be5\u968f\u4fbf\u53bb\u6539\u3002</p> <p>\u901a\u5e38\u5e94\u8be5\u628a\u57fa\u672c\u7684\u914d\u7f6e\u6b63\u786e\u540e\uff0c\u66f4\u591a\u7684\u65f6\u95f4\u5e94\u8be5\u82b1\u5728 schema \u7684\u8bbe\u8ba1\u4f18\u5316\uff0c\u7d22\u5f15\u548c\u67e5\u8be2\u4f18\u5316\u8bbe\u8ba1\u4e0a\u3002</p> <p>\u5bf9\u4e8e\u8fde\u63a5\u7ea7\u522b\u7684\u8bbe\u7f6e\uff0c\u4e0d\u8981\u8f7b\u6613\u5728\u5168\u5c40\u7ea7\u522b\u589e\u52a0\u5b83\u4eec\u7684\u503c\uff0c\u9664\u975e\u786e\u8ba4\u8fd9\u6837\u505a\u662f\u5bf9\u7684\u3002\u6709\u4e00\u4e9b\u7f13\u5b58\u4f1a\u4e00\u6b21\u6027\u5206\u914d\u6307\u5b9a\u5927\u5c0f\u7684\u5185\u5b58\uff0c\u800c\u4e0d\u7ba1\u5b9e\u9645\u4e0a\u662f\u5426\u771f\u6b63\u9700\u8981\u8fd9\u4e48\u5927\u3002\u6240\u4ee5\u4e00\u4e2a\u5f88\u5927\u7684\u5168\u5c40\u8bbe\u7f6e\u53ef\u80fd\u5bfc\u81f4\u6d6a\u8d39\u5927\u91cf\u5185\u5b58\u3002\u66f4\u597d\u7684\u529e\u6cd5\u662f\u5f53\u67e5\u8be2\u9700\u8981\u65f6\u5728\u8fde\u63a5\u7ea7\u522b\u4e2d\u8bbe\u7f6e\u3002</p> <p>\u6700\u5e38\u89c1\u7684\u4f8b\u5b50\u5c31\u662f sort_buffer_size\uff0c\u8be5\u53c2\u6570\u63a7\u5236\u6392\u5e8f\u64cd\u4f5c\u7684\u7f13\u5b58\u5927\u5c0f\u3002\u5982\u679c\u8bbe\u7f6e\u7684\u8fc7\u5927\uff0c\u5373\u4f7f\u975e\u5e38\u5c0f\u7684\u6392\u5e8f\u64cd\u4f5c\uff0c\u4e5f\u4f1a\u5206\u914d\u5168\u90e8\u5927\u5c0f\u7684\u5185\u5b58\u3002\u6240\u4ee5\u5982\u679c\u628a\u53c2\u6570\u8bbe\u7f6e\u7684\u8d85\u8fc7\u5e73\u5747\u6392\u5e8f\u9700\u6c42\u592a\u591a\uff0c\u5c06\u6d6a\u8d39\u5927\u91cf\u5185\u5b58\u3002</p> <p>\u4e8b\u5b9e\u4e0a\u4e0d\u53ef\u80fd\u975e\u5e38\u51c6\u786e\u5730\u628a\u63e1 MySQL \u5185\u5b58\u6d88\u8017\u4e0a\u9650\uff0cMySQL \u4e0d\u662f\u4e00\u4e2a\u4e25\u683c\u63a7\u5236\u5185\u5b58\u5206\u914d\u7684\u6570\u636e\u5e93\u670d\u52a1\u5668\u3002</p>"},{"location":"basic/3.mysql_execute_command/#_9","title":"\u63a7\u5236\u914d\u7f6e\u6587\u4ef6\u7684\u547d\u4ee4\u884c\u53c2\u6570","text":"<p>\u5f88\u591a mysql \u7a0b\u5e8f\u90fd\u652f\u6301\u7528\u914d\u7f6e\u6587\u4ef6\u6765\u6307\u53c2\u6570\u3002\u4f46\u662f\u914d\u7f6e\u6587\u4ef6\u672c\u8eab\u4e5f\u662f\u7528\u53c2\u6570\u63a7\u5236\u7684\uff0c\u6240\u4ee5\u8fd9\u7c7b\u53c2\u6570\u4e00\u822c\u4e0d\u80fd\u5728\u914d\u7f6e\u6587\u4ef6\u4e2d\u6307\u5b9a\uff0c\u8981\u5728\u547d\u4ee4\u884c\u4e2d\u6307\u5b9a\uff0c\u901a\u5e38\uff0c\u8fd9\u7c7b\u53c2\u6570\u7684\u987a\u5e8f\u5e94\u8be5\u5728\u547d\u4ee4\u884c\u540e\u7684\u7b2c\u4e00\u4e2a\uff0c</p>"},{"location":"basic/3.mysql_execute_command/#_10","title":"\u5355\u673a\u591a\u5b9e\u4f8b\u5b89\u88c5","text":"<p>\u5206\u522b\u521b\u5efa\u4e09\u4efd\u914d\u7f6e\u6587\u4ef6\uff0c\u6bcf\u4e2a\u914d\u7f6e\u6587\u4ef6\u4e2d\u5747\u6307\u5b9a\u81ea\u5df1\u7684\u6570\u636e\u76ee\u5f55\uff0c\u81ea\u5df1\u7684\u7aef\u53e3\uff0c\u81ea\u5df1\u7684\u76f8\u5173\u914d\u7f6e\u3002</p>"},{"location":"basic/3.mysql_execute_command/#mysqlbinlog","title":"mysqlbinlog \u547d\u4ee4","text":"<p>MySQL \u7684 binlog \u6587\u4ef6\u4e2d\u8bb0\u5f55\u7684\u662f\u5bf9\u6570\u636e\u5e93\u7684\u5404\u79cd\u4fee\u6539\u64cd\u4f5c\uff0c\u4ee5\u4e8b\u4ef6\u7684\u5f62\u5f0f\u6765\u8bb0\u5f55\u7684\u3002\u7528\u6765\u8868\u793a\u4fee\u6539\u64cd\u4f5c\u7684\u6570\u636e\u7ed3\u6784\u662f Log event\u3002\u4e0d\u540c\u7684\u4fee\u6539\u64cd\u4f5c\u5bf9\u5e94\u7684\u4e0d\u540c\u7684 log event\u3002</p> <p>\u6bd4\u8f83\u5e38\u7528\u7684\u51e0\u79cd<code>log event</code>\u6709\uff1a<code>Query event</code>\u3001<code>Row event</code>\u3001<code>Xid event</code>\u7b49\u3002\u5176\u4e2d<code>Query event</code>\u5bf9\u5e94\u7684\u662f\u4e00\u6761 SQL \u8bed\u53e5\uff0c\u5728 DDL \u64cd\u4f5c\u548c STMT \u683c\u5f0f\u7684 binlog \u4e2d\u7528\u7684\u6bd4\u8f83\u591a\u3002</p> <p><code>Row event</code>\u662f\u4e2a\u57fa\u7840\u7c7b\uff0c\u5b83\u7684\u6d3e\u751f\u7c7b\u6709<code>Row insert event</code>\u3001<code>Row update event</code>\u3001<code>Row delete event</code>\u4e09\u79cd\uff0c\u5206\u522b\u5bf9\u5e94 ROW \u683c\u5f0f binlog \u7684\u589e\u3001\u6539\u3001\u5220\u64cd\u4f5c\u3002</p> <p><code>Xid event</code>\u5bf9\u5e94\u7684\u662f\u652f\u6301\u4e8b\u52a1\u7684 commit \u64cd\u4f5c\uff0c\u5bf9\u4e8e\u4e0d\u652f\u6301\u4e8b\u52a1\u7684 commit \u64cd\u4f5c\uff0c\u8bb0\u5f55\u7684\u5f62\u5f0f\u662f<code>Query event</code>\u3002</p> <p>\u5176\u4ed6\u8fd8\u6709\u4e00\u4e9b event\uff0c\u6bd4\u5982<code>Format log event</code>\u3001<code>Rotate event</code>\u7b49\u7b49\uff0c\u53ef\u4ee5\u67e5\u770b MySQL \u7684\u5b98\u65b9\u6587\u6863\u4e86\u89e3\u66f4\u591a\u76f8\u5173\u4fe1\u606f\u3002<code>log event</code>\u7684\u79cd\u7c7b\u4e00\u76f4\u5728\u589e\u52a0\uff0c\u6bd4\u5982 MariaDB \u4e2d\u65b0\u589e\u7684<code>checkpoint event</code>\u7b49\u3002</p> <p>\u8981 MySQL \u672c\u8eab\u5c31\u7559\u6709\u63a5\u53e3\u4ee5\u4fbf\u65b0\u589e\u4e00\u4e2a Log event\uff0c\u4f46\u662f\u65b0\u589e\u4e00\u4e2a Log event \u65f6\u9700\u8981\u5b9e\u73b0\u51e0\u4e2a\u5fc5\u8981\u7684\u65b9\u6cd5\u51fd\u6570\uff0c\u6bd4\u5982 print\u3001write\u3001get_code_type \u7b49\u3002binlog \u6587\u4ef6\u7684\u5185\u5bb9\u5c31\u662f\u5404\u79cd Log event \u7684\u96c6\u5408\u3002</p> <p>\u4e00\u4e2a<code>binary log</code>\u6587\u4ef6\uff0c\u5f00\u5934\u662f\u4e00\u4e2a 4byte \u7684\u9b54\u6570 0xfe 0x62 0x69 0x6e = \"\u00febin\" \uff0c\u7d27\u968f\u5176\u540e\u662f\u5404\u79cd\u5404\u6837\u7684 events\uff0c\u6240\u6709 events \u90fd\u6709\u4e00\u4e2a\u901a\u7528\u7ed3\u6784\uff0c\u8be5\u7ed3\u6784\u7531 <code>event header</code> \u548c <code>event data</code> \u7ec4\u6210\uff1a</p> <p>\u7531\u4e8e binlog \u7684\u6587\u4ef6\u5185\u5bb9\u662f\u4e8c\u8fdb\u5236\u7684\uff0c\u5982\u679c\u76f4\u63a5\u901a\u8fc7\u6587\u672c\u5de5\u5177\u53bb\u67e5\u770b\uff0c\u90a3\u662f\u5f88\u8d39\u529b\u7684\uff0cMySQL \u63d0\u4f9b\u4e86 binlog \u89e3\u6790\u5de5\u5177 mysqlbinlog</p> <p>\u200b \u5c24\u5176\u6ce8\u610f\uff0c\u5f53 <code>binlog-format</code> \u662f Row-based \u65f6\uff0cevents \u7684 data bytes \u90e8\u5206\u88ab\u4f7f\u7528 base-64 \u7f16\u7801\uff0c\u4f60\u53ef\u4ee5\u901a\u8fc7\u589e\u52a0\u53c2\u6570--base64-output=DECODE-ROWS \u6765\u89e3\u7801\u67e5\u770b\uff08\u5176\u5b9e\u662f\u544a\u8bc9 server \u5f15\u64ce\u4e0d\u4f7f\u7528 BINLOG \u8bed\u53e5\u6765\u7f16\u7801\uff09</p> <p>binlog \u7684\u6838\u5fc3\u5176\u5b9e\u5c31\u662f\u8bb0\u5f55\u5728\u65e5\u5fd7\u6587\u4ef6\u4e2d\u7684\uff0c\u5404\u79cd\u5404\u6837\u7684 events\uff0c\u6240\u4ee5\u6211\u4eec\u4e5f\u53ef\u4ee5\u4f7f\u7528 SQL \u8bed\u53e5 \u2014\u2014 SHOW BINLOG EVENTS IN 'filename' \uff0c\u76f4\u63a5\u67e5\u770b binary log \u6587\u4ef6\u4e2d\u7684 events \u5217\u8868\u3002</p> <p>\u53ef\u901a\u8fc7 <code>binlog</code> \u6587\u4ef6\u7684\u5927\u5c0f\u6765\u5224\u65ad\u662f\u5426\u5b58\u5728\u5927\u4e8b\u52a1\uff0c\u5f53\u4e00\u4e2a <code>binlog</code> \u6587\u4ef6\u5feb\u88ab\u5199\u5b8c\u65f6\uff0c\u7a81\u7136\u51fa\u73b0\u5927\u4e8b\u52a1\uff0c\u4f1a\u7a81\u7834 <code>max_binlog_size</code> \u7684\u5927\u5c0f\u7ee7\u7eed\u5199\u5165\u3002</p> <p>\u6839\u636e\u8fd9\u4e2a\u7279\u70b9\uff0c\u53ea\u8981\u8fdb\u5165 binlog \u7684\u5b58\u653e\u76ee\u5f55\uff0c\u89c2\u5bdf\u5230\u6587\u4ef6\u5927\u5c0f\u5f02\u5e38\u7684 binlog\uff0c\u90a3\u4e48\u4f60\u5c31\u53ef\u4ee5\u53bb\u89e3\u6790\u8fd9\u4e2a binlog \u83b7\u53d6\u5927\u4e8b\u52a1\u4e86\u3002\u5f53\u7136\uff0c\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u8fd9\u53ea\u662f\u4e00\u90e8\u5206\uff0c\u6587\u4ef6\u5927\u5c0f\u6b63\u5e38\u7684 binlog \u4e2d\u4e5f\u85cf\u7740\u5927\u4e8b\u52a1\u3002</p> <pre><code>enum Log_event_type {\n  UNKNOWN_EVENT= 0,\n  START_EVENT_V3= 1,\n  QUERY_EVENT= 2,\n  STOP_EVENT= 3,\n  ROTATE_EVENT= 4,\n  INTVAR_EVENT= 5,\n  LOAD_EVENT= 6,\n  SLAVE_EVENT= 7,\n  CREATE_FILE_EVENT= 8,\n  APPEND_BLOCK_EVENT= 9,\n  EXEC_LOAD_EVENT= 10,\n  DELETE_FILE_EVENT= 11,\n  NEW_LOAD_EVENT= 12,\n  RAND_EVENT= 13,\n  USER_VAR_EVENT= 14,\n  FORMAT_DESCRIPTION_EVENT= 15,\n  XID_EVENT= 16,\n  BEGIN_LOAD_QUERY_EVENT= 17,\n  EXECUTE_LOAD_QUERY_EVENT= 18,\n  TABLE_MAP_EVENT = 19,\n  PRE_GA_WRITE_ROWS_EVENT = 20,\n  PRE_GA_UPDATE_ROWS_EVENT = 21,\n  PRE_GA_DELETE_ROWS_EVENT = 22,\n  WRITE_ROWS_EVENT = 23,\n  UPDATE_ROWS_EVENT = 24,\n  DELETE_ROWS_EVENT = 25,\n  INCIDENT_EVENT= 26,\n  HEARTBEAT_LOG_EVENT= 27,\n  IGNORABLE_LOG_EVENT= 28,\n  ROWS_QUERY_LOG_EVENT= 29,\n  WRITE_ROWS_EVENT = 30,\n  UPDATE_ROWS_EVENT = 31,\n  DELETE_ROWS_EVENT = 32,\n  GTID_LOG_EVENT= 33,\n  ANONYMOUS_GTID_LOG_EVENT= 34,\n  PREVIOUS_GTIDS_LOG_EVENT= 35,\n  ENUM_END_EVENT\n  /* end marker */\n};\n</code></pre>"},{"location":"basic/3.mysql_execute_command/#_11","title":"\u8bd5\u9a8c\u73af\u5883","text":"<ul> <li>MySQL 8.0.23</li> <li>Ubuntu 20.04.1 LTS</li> <li>binlog \u6a21\u5f0f\u91c7\u7528 row \u6a21\u5f0f</li> </ul> <p>\u91cd\u7f6e binlog</p> <pre><code>SQL&gt;reset master;\n\nSQL&gt;show master status;\n\n\nSQL&gt;create database test;\nSQL&gt;use test;\n\nSQL&gt; CREATE TABLE `innodb_table` (\n        `id` int(11) NOT NULL AUTO_INCREMENT,\n        `name` varchar(20) NOT NULL,\n        `age` tinyint(3) NOT NULL,\n        PRIMARY KEY (`id`)\n    ) ENGINE=innodb DEFAULT CHARSET=utf8 AUTO_INCREMENT=1;\n\n\nINSERT INTO `innodb_table`(`name`,`age`) VALUES( 'insert1', CEIL(RAND() * 110) );\nINSERT INTO `innodb_table`(`name`,`age`) VALUES( 'insert2', CEIL(RAND() * 110) );\nINSERT INTO `innodb_table`(`name`,`age`) VALUES( 'insert3', CEIL(RAND() * 110) );\n</code></pre>"},{"location":"basic/4.sql/","title":"SQL \u8bed\u6cd5","text":"<p>\u5728\u4e0d\u540c\u7684\u5173\u7cfb\u578b\u6570\u636e\u5e93\u7ba1\u7406\u7cfb\u7edf\u4e2d\uff0c==\u5b9e\u4f8b==\u548c==\u6a21\u5f0f==\u90fd\u6709\u4e0d\u540c\u7684\u6982\u5ff5\u3002\u5728 MySQL \u4e2d\uff0c\u5206\u522b\u6709\u5982\u4e0b\u610f\u4e49\uff1a</p> <ul> <li>\u5b9e\u4f8b\uff08instance\uff09\uff1a\u4e00\u4e2a\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u542f\u52a8\u4e2d\u7684\u4e00\u4e2a mysqld \u5b88\u62a4\u8fdb\u7a0b\u88ab\u79f0\u4e3a\u4e00\u4e2a\u6570\u636e\u5e93\u5b9e\u4f8b\u3002</li> <li>\u6570\u636e\u5e93\uff08database\uff09\uff1a\u5b58\u653e\u591a\u4e2a\u76f8\u5173\u4e1a\u52a1\u6570\u636e\u8868\u7684\u903b\u8f91\u5bf9\u8c61\u3002</li> <li>\u6a21\u5f0f\uff08schema\uff09\uff1aMySQL \u4e2d schema \u7b49\u540c\u4e8e database\u3002</li> </ul> <p>\u5728\u6570\u636e\u5e93\u7ba1\u7406\u7cfb\u7edf\u4e2d\uff0cSchema \u662f\u6307\u6570\u636e\u5e93\u7684\u7ed3\u6784\u548c\u7ec4\u7ec7\u65b9\u5f0f\u7684\u63cf\u8ff0\uff0c\u5b83\u5b9a\u4e49\u4e86\u5982\u4f55\u5b58\u50a8\u548c\u7ec4\u7ec7\u6570\u636e\uff0c\u4ee5\u53ca\u6570\u636e\u4e4b\u95f4\u7684\u5173\u7cfb\u548c\u7ea6\u675f\u3002\u7b80\u5355\u6765\u8bf4\uff0cSchema \u662f\u6570\u636e\u5e93\u7684\u84dd\u56fe\uff0c\u5b83\u51b3\u5b9a\u4e86\u6570\u636e\u5e93\u4e2d\u6709\u54ea\u4e9b\u8868\u3001\u6bcf\u4e2a\u8868\u6709\u54ea\u4e9b\u5b57\u6bb5\u4ee5\u53ca\u5b83\u4eec\u4e4b\u95f4\u7684\u5173\u7cfb\u3002</p> <p>\u6839\u636e <code>SQL</code> \u6807\u51c6\u5b9a\u4e49\uff0cSCHEMA\uff08\u6a21\u5f0f\uff09 \u662f\u4e00\u4e2a\u63cf\u8ff0\u7b26\u7684\u6301\u4e45\u547d\u540d\u96c6\u5408\uff08a persistent, named collection of descriptors\uff09 SCHEMA \u4e2d\u901a\u5e38\u5305\u542b\u4e86\u8868\u3001\u5217\u3001\u6570\u636e\u7c7b\u578b\u3001\u89c6\u56fe\u3001\u5b58\u50a8\u8fc7\u7a0b\u3001\u5173\u7cfb\u3001\u4e3b\u952e\u548c\u5916\u952e\u7b49 \u5173\u7cfb\u578b\u6570\u636e\u5e93\u5bf9\u8c61 \u3002</p> <p>\u5728 SQL \u6807\u51c6\u4e2d\uff0cSCHEMA \u662f\u7ec4\u7ec7\u6570\u636e\u5e93\u5bf9\u8c61\u7684\u57fa\u672c\u903b\u8f91\u7ed3\u6784\uff0c\u5b83\u521b\u5efa\u4e86\u4e00\u4e2a\u72ec\u7acb\u7684\u547d\u540d\u7a7a\u95f4\uff0c\u786e\u4fdd\u4e86\u6570\u636e\u5e93\u5185\u90e8\u5bf9\u8c61\u7684\u7ed3\u6784\u5316\u3001\u9694\u79bb\u548c\u7ba1\u7406</p> <p>SCHEMA \u548c DATABASE \u662f\u5426\u7b49\u540c\uff1f</p> <p>\u6d89\u53ca\u5230\u6570\u636e\u5e93\u7684\u6a21\u5f0f\u6709\u5f88\u591a\u7591\u60d1\uff0c\u95ee\u9898\u7ecf\u5e38\u51fa\u73b0\u5728\u6a21\u5f0f\u548c\u6570\u636e\u5e93\u4e4b\u95f4\u662f\u5426\u6709\u533a\u522b\uff0c\u5982\u679c\u6709\uff0c\u533a\u522b\u5728\u54ea\u91cc\u3002</p> <p>\u53d6\u51b3\u4e8e\u6570\u636e\u5e93\u5382\u5546\uff0c\u5bf9 schema\uff08\u6a21\u5f0f\uff09\u4ea7\u751f\u7591\u60d1\u7684\u4e00\u90e8\u5206\u539f\u56e0\u662f\u4e0d\u540c\u7684\u6570\u636e\u5e93\u5382\u5546\u7cfb\u7edf\u503e\u5411\u4e8e\u4ee5\u81ea\u5df1\u7684\u65b9\u5f0f\u5904\u7406\u6a21\u5f0f\u3002</p> <p>\u9020\u6210\u7591\u60d1\u7684\u53e6\u4e00\u4e2a\u539f\u56e0\u53ef\u80fd\u662f\u7531\u4e8e schema \u8fd9\u4e00\u672f\u8bed\u5177\u6709\u5982\u6b64\u5e7f\u6cdb\u7684\u542b\u4e49\uff0c\u56e0\u4e3a\u5b83\u5728\u4e0d\u540c\u7684\u73af\u5883\u4e0b\u6709\u4e0d\u540c\u7684\u542b\u4e49\uff0cschema \u4e00\u8bcd\u6e90\u4e8e\u5e0c\u814a\u8bed skh\u0113ma\uff0c\u610f\u601d\u662f\u5f62\u6001(form)\uff0c\u8f6e\u5ed3(figure)\uff0c\u5f62\u72b6(shape)\u6216\u65b9\u6848(plan)\u3002Schema \u5728\u5fc3\u7406\u5b66\u4e2d\u88ab\u7528\u6765\u63cf\u8ff0\u7ec4\u7ec7\u4fe1\u606f\u7c7b\u522b\u53ca\u5176\u4e4b\u95f4\u5173\u7cfb\u7684\u6709\u7ec4\u7ec7\u7684\u601d\u7ef4\u6216\u884c\u4e3a\u6a21\u5f0f\u3002</p> <p>\u6211\u4eec\u5728\u8bbe\u8ba1\u4e00\u4e2a\u6570\u636e\u5e93\u4e4b\u524d\uff0c\u8fd8\u9700\u8981\u770b\u770b\u6570\u636e\u4e2d\u7684\u4fe1\u606f\u79cd\u7c7b\u548c\u5b83\u4eec\u4e4b\u95f4\u7684\u5173\u7cfb\uff0c\u5728\u6211\u4eec\u5f00\u59cb\u4f7f\u7528 DBMS \u4e2d\u7684\u7269\u7406\u6a21\u5f0f\u4e4b\u524d\uff0c\u6211\u4eec\u9700\u8981\u521b\u5efa\u4e00\u4e2a\u6982\u5ff5\u6a21\u5f0f\u3002</p> <p>\u5728\u8f6f\u4ef6\u5f00\u53d1\u4e2d\u8ba8\u8bba\u6a21\u5f0f\u65f6\uff0c\u53ef\u4ee5\u8ba8\u8bba\u6982\u5ff5\u6a21\u5f0f\u3001\u7269\u7406\u6a21\u5f0f\u3001\u5185\u90e8\u6a21\u5f0f\u3001\u5916\u90e8\u6a21\u5f0f\u3001\u903b\u8f91\u6a21\u5f0f\u7b49\uff0c\u6bcf\u4e00\u4e2a\u90fd\u6709\u5176\u7279\u5b9a\u7684\u542b\u4e49\u3002</p> <p>\u53ef\u4ee5\u5728MySQL \u672f\u8bed\u8868\u4e2d\u67e5\u5230\u4e0a\u9762\u8fd9\u4e9b\u5b9a\u4e49\u3002</p> <p>\u5728\u5173\u7cfb\u578b\u6570\u636e\u5e93\u672f\u8bed\u4e2d\uff0c\u6a21\u5f0f\uff08schema\uff09\u662f\u4e00\u4e2a\u903b\u8f91\u6982\u5ff5\uff0c\u901a\u5e38\u88ab\u770b\u4f5c\u662f\u4e00\u4e2a\u6570\u636e\u5e93\u5bf9\u8c61\u7684\u96c6\u5408\uff0c\u7528\u4e8e\u7ec4\u7ec7\u6570\u636e\u5e93\u4e2d\u7684\u5bf9\u8c61\u3002</p> <p>\u6a21\u5f0f\u4e2d\u7684\u5bf9\u8c61\u901a\u5e38\u5305\u62ec\u8868\u3001\u7d22\u5f15\uff08Tables\uff09\u3001\u6570\u636e\u7c7b\u578b\u3001\u5e8f\u5217\u3001\u89c6\u56fe\uff08Views\uff09\u3001\u5b58\u50a8\u8fc7\u7a0b\uff08Stored Procedures\uff09\u3001\u4e3b\u952e\u3001\u5916\u952e\u7b49\u7b49\u3002</p> <p>\u4e00\u4e2a\u6570\u636e\u5e93\u4e0b\u9762\u53ef\u4ee5\u5305\u542b\u591a\u4e2a<code>Schema</code>\uff0c\u800c\u6bcf\u4e2a <code>Schema</code> \u53c8\u53ef\u4ee5\u5305\u542b\u591a\u4e2a\u6570\u636e\u5e93\u5bf9\u8c61\u3002\u8fd9\u79cd\u5c42\u7ea7\u7ed3\u6784\u4f7f\u5f97\u6570\u636e\u5e93\u7684\u7ba1\u7406\u548c\u7ef4\u62a4\u53d8\u5f97\u66f4\u52a0\u6709\u5e8f\u548c\u9ad8\u6548\u3002</p> <p>\u7136\u800c\uff0c\u5e76\u975e\u6240\u6709\u6570\u636e\u5e93\u90fd\u5b9e\u73b0\u4e86 <code>Schema</code> \u8fd9\u4e00\u5c42\u3002\u4f8b\u5982\uff0cMySQL \u76f4\u63a5\u5c06 <code>Schema</code> \u548c <code>Database</code> \u7b49\u6548\uff0c\u800c\u5728 <code>PostgreSQL</code>\u3001<code>Oracle</code>\u3001<code>SQL Server</code> \u7b49\u6570\u636e\u5e93\u4e2d\uff0cSchema \u7684\u542b\u4e49\u5e76\u4e0d\u5b8c\u5168\u76f8\u540c\u3002\u56e0\u6b64\uff0c\u5728\u5b9e\u9645\u5e94\u7528\u4e2d\uff0c\u6211\u4eec\u9700\u8981\u6839\u636e\u6240\u4f7f\u7528\u7684\u6570\u636e\u5e93\u7cfb\u7edf\u6765\u7406\u89e3 <code>Schema</code> \u7684\u5177\u4f53\u542b\u4e49\u548c\u7528\u6cd5\u3002</p> <p>\u6a21\u5f0f\u53ef\u4ee5\u4e3a\u6570\u636e\u5e93\u5bf9\u8c61\u63d0\u4f9b\u903b\u8f91\u9694\u79bb\u529f\u80fd\uff0c\u4e0d\u7528\u5e94\u7528\u7a0b\u5e8f\u53ef\u4ee5\u4f7f\u7528\u5404\u81ea\u7684\u6a21\u5f0f\uff0c\u5b9e\u73b0\u5b89\u5168\u7684\u8bbf\u95ee\u6743\u9650\u63a7\u5236\u3002</p> <ul> <li> <p>\u5bf9\u4e8e MySQL \u800c\u8a00\uff0c\u6a21\u5f0f\u548c\u6570\u636e\u5e93\u662f\u540c\u4e49\u8bcd\u3002\u8bed\u6cd5\u4e2d\u7684 SCHEMA \u90fd\u53ef\u4ee5\u4f7f\u7528 DATABASE \u66ff\u4ee3\uff0c\u4f8b\u5982 <code>CREATE DATABASE</code> \u548c <code>CREATE SCHEMA</code> \u7684\u4f5c\u7528\u5b8c\u5168\u76f8\u540c\u3002</p> </li> <li> <p>PostgreSQL \u4e2d\u7684\u4e00\u4e2a\u6570\u636e\u5e93\u5305\u542b\u4e00\u4e2a\u6216\u591a\u4e2a\u6a21\u5f0f\uff0c\u4e00\u4e2a\u6a21\u5f0f\u5305\u542b\u591a\u4e2a\u5bf9\u8c61\uff08\u8868\u3001\u7d22\u5f15\u3001\u51fd\u6570\u7b49\uff09\u3002\u6a21\u5f0f\u7684\u7ba1\u7406\u4f7f\u7528 <code>CREATE SCHEMA</code>\u3001<code>DROP SCHEMA</code> \u7b49\u8bed\u53e5\u3002</p> </li> <li> <p>Oracle \u6570\u636e\u5e93\u4e2d\u7684\u6a21\u5f0f\u6982\u5ff5\u548c\u5176\u4ed6\u6570\u636e\u5e93\u4ea7\u54c1\u4e0d\u540c\uff0c\u5b83\u548c\u7528\u6237\u7684\u6982\u5ff5\u5173\u7cfb\u7d27\u5bc6\u3002Oracle \u6570\u636e\u5e93\u4e2d\u7684\u4e00\u4e2a\u7528\u6237\u5bf9\u5e94\u4e00\u4e2a\u6a21\u5f0f\uff0c\u7528\u6237\u540d\u5c31\u662f\u6a21\u5f0f\u540d\u3002\u6a21\u5f0f\u4e2d\u7684\u5bf9\u8c61\u90fd\u5c5e\u4e8e\u8fd9\u4e2a\u7528\u6237\u3002\u5bf9\u4e8e\u6a21\u5f0f\u7684\u7ba1\u7406\uff0c\u5b9e\u9645\u4e0a\u5c31\u662f\u7528\u6237\u7684\u7ba1\u7406\uff0c\u4f8b\u5982 <code>CREATE USER</code>\u3001<code>DROP USER</code>\u3002</p> </li> </ul> <p>\u6570\u636e\u5e93\u4e00\u8bcd\uff0c\u5728\u4e0d\u540c\u7684\u4e0a\u4e0b\u6587\u6709\u4e0d\u540c\u7684\u542b\u4e49\uff0c\u56e0\u4e3a\u5b83\u53ef\u4ee5\u662f\u6570\u636e\u5e93\u4ea7\u54c1\u3001\u6570\u636e\u5e93\u670d\u52a1\uff08\u7cfb\u7edf\uff09\u3001\u6570\u636e\u5e93\u5b9e\u4f8b\u3001\u6570\u636e\u5e93\u8fdb\u7a0b\u5176\u4e2d\u4e4b\u4e00\uff0c\u800c\u8fd9\u4e9b\u540d\u8bcd\u6240\u8868\u793a\u7684\u662f\u4e0d\u540c\u7684\u4e8b\u7269\u3002</p> <p>\u5728 MySQL \u4e2d\uff0c\u7528\u6237\u548c\u6a21\u5f0f(\u6216\u8005\u8bf4\u6570\u636e\u5e93)\u6ca1\u6709\u4efb\u4f55\u76f4\u63a5\u5173\u7cfb\uff0c\u53ef\u4ee5\u5355\u72ec\u7684\u5206\u522b\u5b9e\u73b0\u5bf9\u7528\u6237\u548c\u6a21\u5f0f\u8fdb\u884c\u7ba1\u7406\u3002\u5b83\u4eec\u4e4b\u95f4\u662f\u901a\u8fc7\u6743\u9650\u8bbf\u95ee\u6765\u5173\u8054\u4f7f\u7528\uff0c\u53ef\u4ee5\u591a\u5bf9\u591a\u6765\u5173\u8054\u5b9e\u73b0\u3002\uff08\u4e00\u4e2a\u7528\u6237\u53ef\u4ee5\u8bbf\u95ee\u591a\u4e2a\u6a21\u5f0f\u4e2d\u7684\u591a\u4e2a\u5bf9\u8c61\u3002\u4e00\u4e2a\u6a21\u5f0f\u4e5f\u53ef\u4ee5\u88ab\u591a\u4e2a\u7528\u6237\u8bbf\u95ee\uff09\u3002\u4e5f\u53ef\u4ee5\u5f88\u7b80\u5355\u7684\u8de8\u7528\u6237\u8d4b\u6743\u3002A \u7528\u6237\u60f3\u8bbf\u95ee(DDL/DML)db_test \u6a21\u5f0f\u4e2d\u7684\u67d0\u4e9b\u5bf9\u8c61(\u8868\uff0c\u89c6\u56fe\u7b49)</p> <p>Oracle \u4e2d\u7684 SCHEMA \u4e0e DATABASE \u4e4b\u95f4\u7684\u5173\u7cfb</p> <p>Oracle \u4e2d\u7684 SCHEMA \u4e0e\u5176\u4ed6\u6570\u636e\u5e93\u7cfb\u7edf\u5927\u4e0d\u76f8\u540c\uff0c\u5b83\u4e0e\u6570\u636e\u5e93\u7528\u6237\u5bc6\u5207\u76f8\u5173\u3002Oracle \u5b98\u65b9\u6587\u6863\u6307\u51fa\uff0cSCHEMA \u662f\u6570\u636e\u6216\u6a21\u5f0f\u5bf9\u8c61\u7684\u903b\u8f91\u7ed3\u6784\u7684\u96c6\u5408\uff0c\u7531\u6570\u636e\u5e93\u7528\u6237\u62e5\u6709\uff0c\u5e76\u4e14\u4e0e\u8be5\u7528\u6237\u5177\u6709\u76f8\u540c\u7684\u540d\u79f0\uff0c\u4e5f\u5c31\u662f\u8bf4\u6bcf\u4e2a\u7528\u6237\u62e5\u6709\u4e00\u4e2a\u72ec\u7acb\u7684 SCHEMA\u3002</p> <p>Oracle \u6570\u636e\u5e93\u4e2d Schema \u548c User \u7684\u5173\u7cfb\u662f\u4e00\u4e00\u5bf9\u5e94\u7684\uff0c\u4e5f\u5c31\u662f\u8bf4\u4e00\u4e2a Schema \u53ea\u5bf9\u5e94\u4e00\u4e2a User\uff0c\u4e00\u4e2a User \u5bf9\u5e94\u4e00\u4e2a Schema\u3002\u5f53\u67d0\u4e2a User \u4e0b\u9762\u6709 table,view,Index......\u7b49 Schema Object \u65f6\uff0c\u8fd9\u4e2a User \u5c31\u6210\u4e86\u4e00\u4e2a Schema\u3002Schema \u662f\u6307\u4e00\u4e2a\u7528\u6237\u6240\u62e5\u6709\u7684\u6570\u636e\u5e93\u5bf9\u8c61\u7684\u96c6\u5408\uff0c\u7528\u4e8e\u6743\u9650\u7ba1\u7406\u548c\u547d\u540d\u7a7a\u95f4\u9694\u79bb\uff0c\u6211\u4e2a\u4eba\u628a\u4ed6\u7406\u89e3\u6210\u4e00\u4e2a\"\u7528\u6237\u7a7a\u95f4\"\u3002\"Schema \u5bf9\u8c61\"\u662f\u6307\u5728\u67d0\u4e2a Schema \u4e2d\u7684\u6570\u636e\u5e93\u5bf9\u8c61\uff0c\u4f8b\u5982 Schema \u4e2d\u7684\u8868\u3001\u89c6\u56fe\u3001\u7d22\u5f15\u7b49\uff1b\u975e Schema \u5bf9\u8c61\u662f\u6307\u4e0d\u5c5e\u4e8e\u67d0\u4e2a Schema \u7684\u6570\u636e\u5e93\u5bf9\u8c61\uff0c\u4f8b\u5982\u7528\u6237\u3001\u89d2\u8272\u3001\u8868\u7a7a\u95f4\u7b49\u3002</p> <p>Oracle \u5176\u5b9e\u5e76\u4e0d\u652f\u6301\u5355\u72ec CREATE SCHEMA \u8fd9\u79cd\u8bed\u53e5\u7684</p> <p>\u540c\u65f6\uff0c\u8fd9\u79cd\u8d4b\u6743\u8fd8\u662f\u5f88\u9ebb\u70e6\u7684\u3002\u8981\u5141\u8bb8\u7528\u6237 A \u5bf9\u7528\u6237 B \u7684\u5bf9\u8c61\uff08\u5982\u8868\uff09\u8fdb\u884c\u64cd\u4f5c\uff0c\u7528\u6237 A \u5fc5\u987b\u5177\u6709\u76f8\u5e94\u7684\u6743\u9650\u3002\u7528\u6237 B \u9700\u8981\u6388\u4e88\u7528\u6237 A \u8fd9\u4e9b\u6743\u9650\u3002</p> <pre><code>-- \u7528\u6237 B \u6388\u4e88\u7528\u6237 A \u5bf9\u8868 table_name \u7684 SELECT \u6743\u9650\nGRANT SELECT ON userB.table_name TO userA;\n\n-- \u7528\u6237 B \u6388\u4e88\u7528\u6237 A \u5bf9\u8868 table_name \u7684 INSERT \u548c UPDATE \u6743\u9650\nGRANT INSERT, UPDATE ON userB.table_name TO userA;\n\n\n\n-- \u7528\u6237 B \u6388\u4e88\u7528\u6237 A \u5bf9\u5176\u6240\u6709\u8868\u7684 SELECT \u6743\u9650\nBEGIN\n   FOR rec IN (SELECT table_name FROM all_tables WHERE owner = 'USERB') LOOP\n      EXECUTE IMMEDIATE 'GRANT SELECT ON userB.' || rec.table_name || ' TO userA';\n   END LOOP;\nEND;\n</code></pre> <p>\u6570\u636e\u5e93\u4ea7\u54c1</p> <p>\u662f\u6307\u7531\u5404\u6570\u636e\u5e93\u5382\u5546\u63d0\u4f9b\u7684\u4ea7\u54c1\u6216\u670d\u52a1\uff0c\u5982 Oracle\u3001MySQL\u3001PostgreSQL\uff0c\u4ee5\u53ca\u5404\u4e91\u5382\u5546\u63d0\u4f9b\u7684\u5404\u79cd\u4e91\u6570\u636e\u5e93\u670d\u52a1\uff0c\u9700\u8981\u4ed8\u8d39\u6216\u8005\u4e0b\u8f7d\u624d\u80fd\u5f97\u5230\u7684\u7269\u4ef6\uff0c\u6b64\u4e3a\u8f6f\u4ef6\uff0c\u7c7b\u4f3c\u4e8e\u5546\u54c1\u3002\u5f53\u62ff\u5230\u6570\u636e\u5e93\u4ea7\u54c1\u65f6\uff0c\u62ff\u5230\u7684\u662f\u4e00\u4efd\u6570\u636e\u5e93\u4ea7\u54c1\u7684\u8f6f\u4ef6\u62f7\u8d1d\uff1b\u800c\u8d2d\u4e70\u5728\u7ebf\u4e91\u6570\u636e\u5e93\u670d\u52a1\u65f6\uff0c\u5f97\u5230\u7684\u662f\u4e91\u6570\u636e\u5e93\u7684\u4f7f\u7528\u6743\u9650\u3002</p> <p>\u6570\u636e\u5e93\u5b9e\u4f8b</p> <p>\u662f\u6307\u5c06\u6570\u636e\u5e93\u4ea7\u54c1\u7684\u8f6f\u4ef6\u5b89\u88c5\u5230\u786c\u4ef6\u73af\u5883\u4e0a\u540e\uff0c\u7531\u64cd\u4f5c\u7cfb\u7edf\u8c03\u5ea6\u6240\u8fd0\u884c\u8d77\u6765\u7684\u4e00\u7cfb\u5217\u7a0b\u5e8f\uff0c\u5b83\u7531\u4e00\u4e2a\u6216\u591a\u4e2a\u64cd\u4f5c\u7cfb\u7edf\u8fdb\u7a0b\u3001\u5185\u5b58\u3001\u6570\u636e\u5b58\u50a8\u5355\u5143\u6240\u6784\u6210\uff0c\u5373\u8f6f\u4ef6\u7a0b\u5e8f\u7684\u8fd0\u884c\u6001\u3002\u5b66\u4e60\u8fc7\u9762\u5411\u5bf9\u8c61\u7684\u540c\u5b66\uff0c\u5c31\u975e\u5e38\u6e05\u695a\"\u5b9e\u4f8b\"\u7684\u542b\u4e49\u3002\u5f53\u6570\u636e\u5e93\u7cfb\u7edf\u9000\u51fa\u65f6\uff0c\u6570\u636e\u5e93\u5b9e\u4f8b\u4e5f\u5c31\u6d88\u4ea1\u3002SQLite \u662f\u4e00\u4e2a**\u5d4c\u5165\u5f0f\uff08Embedded\uff09**\u6570\u636e\u5e93\uff0c\u5b83\u7684\u5b9e\u73b0\u662f\u4e00\u4e2a\u5c0f\u5de7\u7684 C \u8bed\u8a00\u5e93\u3002\u5f53\u60a8\u4f7f\u7528 SQLite \u65f6\uff0c\u8fd9\u4e2a\u5e93\u4f1a\u88ab\u76f4\u63a5\u94fe\u63a5\u5230\u60a8\u7684\u5e94\u7528\u7a0b\u5e8f\u4e2d\u3002\u800c Oracle \u3001MySQL\u3001PostgreSQL \u8fd9\u4e9b\u6570\u636e\u5e93\u4ea7\u54c1\uff0c\u8fd0\u884c\u540e\u7684\u5b9e\u4f8b\u90fd\u7531\u591a\u4e2a\u6570\u636e\u5e93\u8fdb\u7a0b\u534f\u8c03\u5de5\u4f5c\u3002</p> <p>\u6570\u636e\u5e93\u670d\u52a1\uff08\u7cfb\u7edf\uff09\uff0c\u662f\u6307\u90e8\u7f72\u4e86\u6570\u636e\u5e93\u4ea7\u54c1\u540e\u6240\u8fd0\u884c\u8d77\u6765\u540e\uff0c\u5bf9\u5916\u63d0\u4f9b\u4e86\u6570\u636e\u64cd\u4f5c\u76f8\u5173\u7684\u4e00\u7cfb\u5217\u529f\u80fd\u7684\u670d\u52a1\u7cfb\u7edf\uff0c\u901a\u8fc7\u7a0b\u5e8f\u6216\u8005\u63a5\u53e3\u6765\u83b7\u53d6\u8fd9\u4e9b\u529f\u80fd\u3002\u6570\u636e\u5e93\u670d\u52a1\uff08\u7cfb\u7edf\uff09\u53ef\u7531\u591a\u4e2a\u6570\u636e\u5e93\u5b9e\u4f8b\u7ec4\u6210\uff08\u6bd4\u5982\u96c6\u7fa4\uff09\u3002\u67d0\u4e9b\u60c5\u51b5\uff0c\u6570\u636e\u5e93\u670d\u52a1\u4e0e\u6570\u636e\u5e93\u5b9e\u4f8b\u5f88\u96be\u533a\u5206\u3002</p>"},{"location":"basic/4.sql/#sql_1","title":"SQL \u8bed\u8a00\u6982\u8ff0","text":"<p>SQL \u8bed\u8a00\u6982\u89c8</p> <p>SQL \u6700\u65e9\u662f IBM \u516c\u53f8\u5f00\u53d1\uff0c\u6700\u521d\u79f0\u4f5c Sequel\uff0c\u540e\u6765\u53d8\u4e3a SQL\uff08\u7ed3\u6784\u5316\u67e5\u8be2\u8bed\u8a00\uff09\uff0cSQL \u7684\u6807\u51c6\u662f\u7531\u7f8e\u56fd\u56fd\u5bb6\u6807\u51c6\u5316\u7ec4\u7ec7\u548c\u56fd\u9645\u6807\u51c6\u5316\u7ec4\u7ec7\u5236\u5b9a\u3002</p> <p>IBM \u5bf9\u5173\u7cfb\u6570\u636e\u5e93\u4ee5\u53ca<code>SQL</code>\u8bed\u8a00\u7684\u5f62\u6210\u548c\u89c4\u8303\u5316\u4ea7\u751f\u4e86\u91cd\u5927\u7684\u5f71\u54cd\uff0c\u7b2c\u4e00\u4e2a\u7248\u672c\u7684<code>SQL</code>\u6807\u51c6<code>SQL86</code>\u5c31\u662f\u57fa\u4e8e<code>System R</code>\u7684\u624b\u518c\u800c\u6765\u7684\u3002Oracle \u5728 1979 \u5e74\u7387\u5148\u63a8\u51fa\u4e86\u652f\u6301<code>SQL</code>\u7684\u5546\u7528\u4ea7\u54c1\u3002\u968f\u7740\u6570\u636e\u5e93\u6280\u672f\u548c\u5e94\u7528\u7684\u53d1\u5c55\uff0c\u4e3a\u4e0d\u540c<code>RDBMS</code>\u63d0\u4f9b\u4e00\u81f4\u7684\u8bed\u8a00\u6210\u4e86\u4e00\u79cd\u73b0\u5b9e\u9700\u8981\u3002</p> <p>\u5bf9<code>SQL</code>\u6807\u51c6\u5f71\u54cd\u6700\u5927\u7684\u673a\u6784\u81ea\u7136\u662f\u90a3\u4e9b\u8457\u540d\u7684\u6570\u636e\u5e93\u4ea7\u5546\uff0c\u800c\u5177\u4f53\u7684\u5236\u8ba2\u8005\u5219\u662f\u4e00\u4e9b\u975e\u8425\u5229\u673a\u6784\uff0c\u4f8b\u5982**\u56fd\u9645\u6807\u51c6\u5316\u7ec4\u7ec7 ISO**\u548c**\u7f8e\u56fd\u56fd\u5bb6\u6807\u51c6\u59d4\u5458\u4f1a ANSI**\u3002\u5404\u56fd\u901a\u5e38\u4f1a\u6309\u7167<code>ISO</code>\u6807\u51c6\u548c<code>ANSI</code>\u6807\u51c6\u5236\u5b9a\u81ea\u5df1\u7684\u56fd\u5bb6\u6807\u51c6\u3002</p> <p>**\u7f8e\u56fd\u56fd\u5bb6\u6807\u51c6\u5316\u7ec4\u7ec7 ANSI**\u4e00\u4e2a\u6838\u51c6\u591a\u79cd\u884c\u4e1a\u6807\u51c6\u7684\u7ec4\u7ec7\u3002SQL \u4f5c\u4e3a\u5173\u7cfb\u578b\u6570\u636e\u5e93\u6240\u4f7f\u7528\u7684\u6807\u51c6\u8bed\u8a00\uff0c\u6700\u521d\u662f\u57fa\u4e8e IBM \u7684\u5b9e\u73b0\u5728 1986 \u5e74\u88ab\u6279\u51c6\u7684\u30021987 \u5e74\uff0c**\u56fd\u9645\u6807\u51c6\u5316\u7ec4\u7ec7 ISO**\u628a<code>ANSI SQL</code>\u4f5c\u4e3a\u56fd\u9645\u6807\u51c6\u3002</p> <p>SQL \u6709\u4e24\u4e2a\u4e3b\u8981\u7684\u6807\u51c6\uff0c\u5206\u522b\u662f<code>SQL92</code>\u548c<code>SQL99</code>\u300292 \u548c 99 \u4ee3\u8868\u4e86\u6807\u51c6\u63d0\u51fa\u7684\u65f6\u95f4\uff0c<code>SQL92</code>\u5c31\u662f 92 \u5e74\u63d0\u51fa\u7684\u6807\u51c6\u89c4\u8303\u3002\u9664\u4e86<code>SQL92</code>\u548c<code>SQL99</code>\u4ee5\u5916\uff0c\u8fd8\u6709\u5176\u4ed6\u7684\u6807\u51c6\u3002</p> <p>\u4e0b\u9762\u662f SQL \u6807\u51c6\u7b80\u8981\u7684\u53d1\u5c55\u4e0e\u6f14\u5316\u5386\u53f2\uff1a</p> <ul> <li>1986 \u5e74\uff0cANSI X3.135-1986\uff0cISO/IEC 9075:1986\uff0cSQL-86\u3002\u8fd9\u662f ANSI \u9996\u6b21\u5c06 SQL \u8bed\u8a00\u6807\u51c6\u5316\u7684\u7248\u672c\u3002</li> <li>1989 \u5e74\uff0cANSI X3.135-1989\uff0cISO/IEC 9075:1989\uff0cSQL-89\u3002\u589e\u52a0\u4e86\u5b8c\u6574\u6027\u7ea6\u675f\u3002</li> <li>1992 \u5e74\uff0cANSI X3.135-1992\uff0cISO/IEC 9075:1992\uff0cSQL-92\uff08SQL2\uff09\u3002\u6700\u91cd\u8981\u7684\u4e00\u4e2a\u7248\u672c\u3002 \u5f15\u5165\u4e86\u6807\u51c6\u7684\u5206\u7ea7\u6982\u5ff5\u3002sql92</li> <li>1999 \u5e74\uff0cISO/IEC 9075:1999\uff0cSQL:1999\uff08SQL3\uff09\u3002\u53d8\u52a8\u6700\u5927\u7684\u4e00\u4e2a\u7248\u672c\u3002\u6539\u53d8\u4e86\u6807\u51c6\u7b26\u5408\u7a0b\u5ea6\u7684\u5b9a\u4e49\uff1b\u589e\u52a0\u4e86\u9762\u5411\u5bf9\u8c61\u7279\u6027\u3001\u6b63\u5219\u8868\u8fbe\u5f0f\u3001\u5b58\u50a8\u8fc7\u7a0b\u3001Java \u7b49\u652f\u6301\u3002</li> <li>2003 \u5e74\uff0cISO/IEC 9075:2003\uff0cSQL:2003\u3002\u5f15\u5165\u4e86 XML\u3001Window \u51fd\u6570\u7b49\u3002</li> <li>2008 \u5e74\uff0cISO/IEC 9075:2008\uff0cSQL:2008\u3002\u5f15\u5165\u4e86 TRUNCATE \u7b49\u3002</li> <li>2011 \u5e74\uff0cISO/IEC 9075:2011\uff0cSQL:2011\u3002\u5f15\u5165\u4e86\u65f6\u5e8f\u6570\u636e\u7b49\u3002</li> <li>2016 \u5e74\uff0cISO/IEC 9075:2016\uff0cSQL:2016\u3002\u5f15\u5165\u4e86 JSON \u7b49\u3002</li> <li>2023 \u5e74\uff0cISO/IEC 9075:2023\uff0cSQL:2023</li> </ul> <p>\u7ec6\u5fc3\u7684\u8bfb\u8005\u80fd\u53d1\u73b0\uff0c\u4ece <code>SQL:1999</code> \u5f00\u59cb\uff0c\u6807\u51c6\u7b80\u79f0\u4e2d\u7684\u77ed\u6a2a\u7ebf\uff08-\uff09\u88ab\u6362\u6210\u4e86\u5192\u53f7\uff08:\uff09\uff0c\u800c\u4e14\u6807\u51c6\u5236\u5b9a\u7684\u5e74\u4efd\u4e5f\u6539\u7528\u56db\u4f4d\u6570\u5b57\u4e86\u3002</p> <p>\u524d\u4e00\u4e2a\u4fee\u6539\u7684\u539f\u56e0\u662f ISO \u6807\u51c6\u4e60\u60ef\u4e0a\u91c7\u7528\u5192\u53f7\uff0cANSI \u6807\u51c6\u5219\u4e00\u76f4\u91c7\u7528\u77ed\u6a2a\u7ebf\u3002\u540e\u4e00\u4e2a\u4fee\u6539\u7684\u539f\u56e0\u662f\u6807\u51c6\u7684\u547d\u540d\u4e5f\u9047\u5230\u4e86 2000 \u5e74\u95ee\u9898\u3002</p> <p><code>SQL86</code>\u5927\u6982\u53ea\u6709\u51e0\u5341\u9875\uff0c<code>SQL92</code>\u6b63\u6587\u5927\u7ea6\u6709 500 \u9875\uff0c\u800c <code>SQL99</code> \u5219\u8d85\u8fc7\u4e86 1000 \u9875\u3002\u53ef\u4ee5\u770b\u51fa\uff0c\u4ece <code>SQL99</code> \u5f00\u59cb\uff0c<code>SQL</code> \u6807\u51c6\u7684\u4e2a\u5934\u5c31\u975e\u5e38\u5e9e\u5927\u4e86\uff0c\u5185\u5bb9\u5305\u7f57\u4e07\u8c61\uff0c\u53ef\u4ee5\u8bf4\u5df2\u7ecf\u6ca1\u6709\u4eba\u80fd\u591f\u638c\u63e1\u6807\u51c6\u7684\u6240\u6709\u5185\u5bb9\u4e86\u3002</p> <p>\u4ee5 <code>SQL:2003</code> \u4e3a\u4f8b\uff0c\u5b83\u5305\u62ec\u4ee5\u4e0b 9 \u4e2a\u90e8\u5206\uff08\u4e2d\u95f4\u7f16\u53f7\u7a7a\u7f3a\u662f\u66fe\u7ecf\u88ab\u5360\u7528\uff0c\u4e4b\u540e\u88ab\u5e9f\u5f03\u7684\u6807\u51c6\u9020\u6210\u7684\uff09</p> <p>\u6700\u65b0\u7684\u6807\u51c6\u662f SQL:2023 \uff0c\u7f51\u4e0a\u6709\u4e00\u4efd\u7684SQL-99\u89c4\u8303</p> <p>SQL \u8bed\u8a00\u6709\u4ee5\u4e0b\u51e0\u4e2a\u90e8\u5206\uff1a</p> <ul> <li>\u6570\u636e\u5b9a\u4e49\u8bed\u8a00 DDL\uff1a\u4e3b\u8981\u662f\u8868\u5b9a\u4e49\uff0c\u8868\u5220\u9664\uff0c\u8868\u7ed3\u6784\u4fee\u6539\u7b49\u8bed\u53e5\u3002\u5e38\u7528\u7684\u8bed\u53e5\u5173\u952e\u5b57\u6709 CREATE\u3001DROP\u3001ALTER \u7b49\u3002</li> <li>\u6570\u636e\u64cd\u7eb5\u8bed\u8a00 DML\uff1a\u4e3b\u8981\u662f\u6570\u636e\u5e93\u8868\u7684\u589e\u5220\u6539\u8bed\u53e5\u3002\u5e38\u7528\u7684\u8bed\u53e5\u5173\u952e\u5b57\u6709 INSERT\u3001UPDATE\u3001DELETE \u7b49\u3002</li> <li>\u6570\u636e\u67e5\u8be2\u8bed\u8a00 DQL\uff1a\u4e3b\u8981\u662f\u5bf9\u6570\u636e\u8fdb\u884c\u67e5\u8be2\u64cd\u4f5c\u3002\u5e38\u7528\u5173\u952e\u5b57\u6709 SELECT\u3001FROM\u3001WHERE \u7b49\u3002</li> <li> <p>\u6570\u636e\u63a7\u5236\u8bed\u8a00 DCL\uff1a\u4e3b\u8981\u662f\u7528\u6765\u8bbe\u7f6e/\u66f4\u6539\u6570\u636e\u5e93\u7528\u6237\u6743\u9650\u3002\u5e38\u7528\u5173\u952e\u5b57\u6709 GRANT\u3001REVOKE \u7b49\u3002</p> </li> <li> <p>\u5b8c\u6574\u6027\uff1aSQL DDL \u4e2d\u5305\u62ec\u6570\u636e\u5b9a\u4e49\u7684\u5b8c\u6574\u6027\u7684\u7ea6\u675f\u3002\u662f\u6307\u6570\u636e\u7684\u4e00\u81f4\u6027\u548c\u6709\u6548\u6027.</p> </li> <li>\u89c6\u56fe\u5b9a\u4e49\uff1aSQL DDL \u5305\u542b\u89c6\u56fe\u5b9a\u4e49\u7684\u547d\u4ee4</li> <li>\u4e8b\u52a1\u63a7\u5236\uff1aSQL</li> <li>\u5d4c\u5165\u5f0f\u548c\u52a8\u6001 SQL</li> <li>\u6388\u6743</li> </ul> <p><code>SQL:2023</code>\u6700\u65b0\u6807\u51c6\u5305\u542b 11 \u4e2a\u90e8\u5206\u7684\u5185\u5bb9\uff0c\u5177\u4f53\u5982\u4e0b\uff1a</p> <ul> <li>ISO/IEC 9075-1 \u4fe1\u606f\u6280\u672f \u2013 \u6570\u636e\u5e93\u8bed\u8a00 \u2013 SQL \u2013 \u7b2c 1 \u90e8\u5206\uff1a\u6846\u67b6\uff08SQL/\u6846\u67b6\uff09</li> <li>ISO/IEC 9075-2 \u4fe1\u606f\u6280\u672f \u2013 \u6570\u636e\u5e93\u8bed\u8a00 \u2013 SQL \u2013 \u7b2c 2 \u90e8\u5206\uff1a\u57fa\u672c\u539f\u5219\uff08SQL/\u57fa\u672c\u539f\u5219\uff09</li> <li>ISO/IEC 9075-3 \u4fe1\u606f\u6280\u672f \u2013 \u6570\u636e\u5e93\u8bed\u8a00 \u2013 SQL \u2013 \u7b2c 3 \u90e8\u5206\uff1a\u8c03\u7528\u7ea7\u63a5\u53e3\uff08SQL/CLI\uff09</li> <li>ISO/IEC 9075-4 \u4fe1\u606f\u6280\u672f \u2013 \u6570\u636e\u5e93\u8bed\u8a00 \u2013 SQL \u2013 \u7b2c 4 \u90e8\u5206\uff1a\u6301\u4e45\u5b58\u50a8\u6a21\u5757\uff08SQL/PSM\uff09</li> <li>ISO/IEC 9075-9 \u4fe1\u606f\u6280\u672f \u2013 \u6570\u636e\u5e93\u8bed\u8a00 \u2013 SQL \u2013 \u7b2c 9 \u90e8\u5206\uff1a\u5916\u90e8\u6570\u636e\u7ba1\u7406\uff08SQL/MED\uff09</li> <li>ISO/IEC 9075-10 \u4fe1\u606f\u6280\u672f \u2013 \u6570\u636e\u5e93\u8bed\u8a00 \u2013 SQL \u2013 \u7b2c 10 \u90e8\u5206\uff1a\u5bf9\u8c61\u8bed\u8a00\u7ed1\u5b9a\uff08SQL/OLB\uff09</li> <li>ISO/IEC 9075-11 \u4fe1\u606f\u6280\u672f \u2013 \u6570\u636e\u5e93\u8bed\u8a00 \u2013 SQL \u2013 \u7b2c 11 \u90e8\u5206\uff1a\u4fe1\u606f\u4e0e\u5b9a\u4e49\u6982\u8981\uff08SQL/Schemata\uff09</li> <li>ISO/IEC 9075-13 \u4fe1\u606f\u6280\u672f \u2013 \u6570\u636e\u5e93\u8bed\u8a00 \u2013 SQL \u2013 \u7b2c 13 \u90e8\u5206\uff1a\u4f7f\u7528 Java \u7f16\u7a0b\u8bed\u8a00\u7684 SQL \u7a0b\u5e8f\u4e0e\u7c7b\u578b\uff08SQL/JRT\uff09</li> <li>ISO/IEC 9075-14 \u4fe1\u606f\u6280\u672f \u2013 \u6570\u636e\u5e93\u8bed\u8a00 \u2013 SQL \u2013 \u7b2c 14 \u90e8\u5206\uff1aXML \u76f8\u5173\u89c4\u8303\uff08SQL/XML\uff09</li> <li>ISO/IEC 9075-15 \u4fe1\u606f\u6280\u672f \u2013 \u6570\u636e\u5e93\u8bed\u8a00 \u2013 SQL \u2013 \u7b2c 15 \u90e8\u5206\uff1a\u591a\u7ef4\u6570\u7ec4\uff08SQL/MDA\uff09</li> <li>ISO/IEC 9075-16 \u4fe1\u606f\u6280\u672f \u2013 \u6570\u636e\u5e93\u8bed\u8a00 \u2013 SQL \u2013 \u7b2c 16 \u90e8\u5206\uff1a\u5c5e\u6027\u56fe\u67e5\u8be2\uff08SQL/PGQ\uff09</li> </ul> <p>\u76f8\u6bd4\u4e8e\u5176\u4ed6\u8bed\u8a00\uff0cSQL \u7684\"\u534a\u8870\u671f\"\u53ef\u4ee5\u8bf4\u662f\u975e\u5e38\u957f\u4e86\u3002<code>SQL</code>\u6709\u4e24\u4e2a\u91cd\u8981\u7684\u6807\u51c6\uff0c\u5206\u522b\u662f<code>SQL92</code>\u548c<code>SQL99</code>\uff0c\u5b83\u4eec\u5206\u522b\u4ee3\u8868\u4e86 92 \u5e74\u548c 99 \u5e74\u9881\u5e03\u7684 SQL \u6807\u51c6\uff0c\u6211\u4eec\u4eca\u5929\u4f7f\u7528\u7684 SQL \u8bed\u8a00\u4f9d\u7136\u9075\u5faa\u8fd9\u4e9b\u6807\u51c6\u3002 \u8981\u77e5\u9053 92 \u5e74\u662f Windows3.1 \u53d1\u5e03\u7684\u65f6\u95f4\uff0c\u5982\u4eca\u8fd8\u6709\u591a\u5c11\u4eba\u8bb0\u5f97\u5b83\uff0c\u4f46\u5982\u679c\u4f60\u4ece\u4e8b\u6570\u636e\u5206\u6790\uff0c\u6216\u8005\u548c\u6570\u636e\u76f8\u5173\u7684\u5de5\u4f5c\uff0c\u4f9d\u7136\u4f1a\u7528\u5230 SQL \u8bed\u8a00\u3002 \u4f5c\u4e3a\u6280\u672f\u548c\u4e92\u8054\u7f51\u884c\u4e1a\u7684\u4ece\u4e1a\u4eba\u5458\uff08\u4e00\u4e2a\u5b66\u4e60 IT \u7684\u4eba\u6765\u8bf4\uff09\uff0c\u6211\u4eec\u603b\u662f\u5e0c\u671b\u80fd\u627e\u5230\u4e00\u4e2a\u901a\u7528\u6027\u5f3a\uff0c\u53d8\u5316\u76f8\u5bf9\u5c11\uff0c\u4e0a\u624b\u76f8\u5bf9\u5bb9\u6613\u7684\u8bed\u8a00\uff0cSQL \u6b63\u662f\u4e3a\u6570\u4e0d\u591a\u7684\uff0c\u53ef\u4ee5\u6ee1\u8db3\u8fd9\u4e09\u4e2a\u6761\u4ef6\u7684\u8bed\u8a00\u3002 \u5165\u95e8 SQL \u5e76\u4e0d\u96be\u3002SQL \u66f4\u50cf\u662f\u4e00\u95e8\u82f1\u8bed\uff0c\u6709\u4e00\u4e9b\u7b80\u5355\u7684\u82f1\u8bed\u5355\u8bcd\uff0c\u5f53\u4f60\u4f7f\u7528\u5b83\u7684\u65f6\u5019\uff0c\u5c31\u597d\u50cf\u5728\u7528\u82f1\u8bed\u4e0e\u6570\u636e\u5e93\u8fdb\u884c\u5bf9\u8bdd\u3002</p>"},{"location":"basic/4.sql/#sql_2","title":"SQL \u6807\u51c6\u7684\u7b26\u5408\u6027","text":"<p>\u63d0\u53ca\u6807\u51c6\uff0c\u5927\u5bb6\u5bb9\u6613\u60f3\u5230\u7684\u4e00\u4e2a\u95ee\u9898\u5c31\u662f\u4ea7\u54c1\u5bf9\u6807\u51c6\u7684\u9075\u5faa\u7a0b\u5ea6\uff0c\u4e5f\u5c31\u662f\u6807\u51c6\u7684\u7b26\u5408\u6027\u5230\u5e95\u5982\u4f55\uff0c\u56e0\u4e3a\u5b83\u4f1a\u5f71\u54cd\u4ee3\u7801\u5728\u4e0d\u540c\u7cfb\u7edf\u4e4b\u95f4\u8fc1\u79fb\u7684\u96be\u5ea6\u3002\u5f88\u9057\u61be\u7684\u662f\uff0cSQL \u6807\u51c6\u56e0\u4e3a\u5b9a\u4e49\u8fc7\u4e8e\u5bbd\u6cdb\u7b49\u6280\u672f\u548c\u975e\u6280\u672f\u539f\u56e0\uff0c\u4e0d\u540c\u4ea7\u54c1\u5bf9\u6807\u51c6\u7684\u7b26\u5408\u7a0b\u5ea6\u5b58\u5728\u5f88\u5927\u7684\u5dee\u5f02\u3002\u5927\u5230\u529f\u80fd\u7279\u6027\uff0c\u5c0f\u5230\u8bed\u6cd5\u8bed\u4e49\u7684\u7ec6\u8282\uff0c\u5728\u4e0d\u540c\u4ea7\u54c1\u4e4b\u95f4\u90fd\u5b58\u5728\u5f88\u591a\u5dee\u5f02\uff0c\u9020\u6210\u5b9e\u9645\u7684\u5e94\u7528\u8fc1\u79fb\u8fdc\u6bd4 C/C++ \u7a0b\u5e8f\u7684\u8fc1\u79fb\u8981\u590d\u6742\u5f88\u591a\u3002\u56e0\u6b64\uff0c\u5c3d\u7ba1\u5f88\u591a\u4ea7\u54c1\u90fd\u53f7\u79f0\u81ea\u5df1\u7b26\u5408 SQL \u6807\u51c6\uff0c\u5e76\u4e0d\u610f\u5473\u7740\u5e94\u7528\u53ef\u4ee5\u5bb9\u6613\u7684\u5728\u5b83\u4eec\u4e4b\u95f4\u5207\u6362\u3002\u9664\u4e86 Oracle\u3001DB2 \u7b49\u7ecf\u5178\u7684\u5546\u4e1a\u4ea7\u54c1\uff0c\u4ee5\u53ca PostgreSQL\u3001MySQL \u7b49\u5f00\u6e90\u4ea7\u54c1\u603b\u4f53\u4e0a\u5bf9 SQL \u6807\u51c6\u7684\u7b26\u5408\u7a0b\u5ea6\u8f83\u9ad8\u4ee5\u5916\uff0c\u5f88\u591a\u4ea7\u54c1\u63d0\u5230\u7684 SQL \u6807\u51c6\uff0c\u6d89\u53ca\u7684\u5185\u5bb9\u5176\u5b9e\u662f SQL92 \u91cc\u5934\u6700\u57fa\u672c\u6216\u6700\u6838\u5fc3\u7684\u4e00\u90e8\u5206\uff08\u5c5e\u4e8e\u5165\u95e8\u7ea7\u7684\u8303\u7574\u3002SQL92 \u672c\u8eab\u662f\u5206\u7ea7\u7684\uff0c\u5305\u62ec\u5165\u95e8\u7ea7\u3001\u8fc7\u6e21\u7ea7\u3001\u4e2d\u95f4\u7ea7\u548c\u5b8c\u5168\u7ea7\uff09\u3002</p> <p>\u5404\u56fd\u901a\u5e38\u4f1a\u6309\u7167 ISO \u6807\u51c6\u548c ANSI \u6807\u51c6\uff08\u8fd9\u4e24\u4e2a\u673a\u6784\u7684\u5f88\u591a\u6807\u51c6\u662f\u5dee\u4e0d\u591a\u7b49\u540c\u7684\uff09\u5236\u5b9a\u81ea\u5df1\u7684\u56fd\u5bb6\u6807\u51c6\u3002\u4e2d\u56fd\u662f ISO \u6807\u51c6\u59d4\u5458\u4f1a\u7684\u6210\u5458\u56fd\uff0c\u4e5f\u7ecf\u5e38\u7ffb\u8bd1\u4e00\u4e9b\u56fd\u9645\u6807\u51c6\u5bf9\u5e94\u7684\u4e2d\u6587\u7248\u3002\u6807\u51c6\u4e3a\u4e86\u907f\u514d\u91c7\u7528\u5177\u4f53\u4ea7\u54c1\u7684\u672f\u8bed\uff0c\u5f80\u5f80\u4f1a\u62bd\u8c61\u51fa\u5f88\u591a\u540d\u8bcd\uff0c\u4ece\u800c\u589e\u52a0\u4e86\u9605\u8bfb\u548c\u7406\u89e3\u7684\u96be\u5ea6\uff0c\u7ffb\u8bd1\u6210\u4e2d\u6587\u4e4b\u540e\u66f4\u5bb9\u6613\u8bcd\u4e0d\u8fbe\u610f\u3002\u5bf9\u4e8e\u6570\u636e\u5e93\u7cfb\u7edf\u5b9e\u73b0\u8005\u548c\u7528\u6237\u800c\u8a00\uff0c\u5f88\u591a\u65f6\u5019\u8fd8\u4e0d\u5982\u76f4\u63a5\u8bfb\u82f1\u6587\u7248\u672c\u4e3a\u597d\u3002</p> <p>\u300a\u4fe1\u606f\u6280\u672f \u6570\u636e\u5e93\u8bed\u8a00 SQL \u7b2c 1 \u90e8\u5206\uff1a\u6846\u67b6\u300b</p> <p>\u300a\u4fe1\u606f\u6280\u672f \u6570\u636e\u5e93\u8bed\u8a00 SQL \u7b2c 2 \u90e8\u5206\uff1a\u57fa\u7840\u300b</p> <p>\u300a\u4fe1\u606f\u5b89\u5168\u6280\u672f \u6570\u636e\u5e93\u7ba1\u7406\u7cfb\u7edf\u5b89\u5168\u6280\u672f\u8981\u6c42\u300b</p> <p>\u4e3a\u4e86\u9a8c\u8bc1\u5177\u4f53\u7684\u4ea7\u54c1\u5bf9\u6807\u51c6\u7684\u9075\u4ece\u7a0b\u5ea6\uff0cNIST \u8fd8\u66fe\u7ecf\u4e13\u95e8\u53d1\u8d77\u4e86\u4e00\u4e2a\u9879\u76ee\uff0c\u6765\u505a\u6807\u51c6\u7b26\u5408\u7a0b\u5ea6\u7684\u6d4b\u8bd5\u96c6\u5408\u3002\u4e0d\u8fc7\uff0cSQL \u6807\u51c6\u5305\u542b\u7684\u5185\u5bb9\u5b9e\u5728\u592a\u591a\u4e86\uff0c\u800c\u4e14\u6709\u5f88\u591a\u7279\u6027\u5bf9\u65b0\u7684 SQL \u4ea7\u54c1\u800c\u8a00\u4e5f\u8d8a\u6765\u8d8a\u4e0d\u91cd\u8981\u4e86\u3002\u4ece SQL99 \u4e4b\u540e\uff0c\u6807\u51c6\u4e2d\u5b9a\u4e49\u5c31\u4e0d\u7b26\u5408\u7a0b\u5ea6\u7684\u518d\u5206\u7ea7\uff0c\u800c\u662f\u6539\u6210\u4e86\u6838\u5fc3\u517c\u5bb9\u6027\u548c\u7279\u6027\u517c\u5bb9\u6027\uff1b\u4e5f\u6ca1\u6709\u673a\u6784\u6765\u63a8\u51fa\u6743\u5a01\u7684 SQL \u6807\u51c6\u7b26\u5408\u7a0b\u5ea6\u7684\u6d4b\u8bd5\u8ba4\u8bc1\u4e86\u3002\u5f00\u6e90\u7684 MySQL \u66fe\u7ecf\u5728 6.0 \u7684\u5f00\u53d1\u8fc7\u7a0b\u4e2d\u8bd5\u56fe\u5927\u5e45\u5ea6\u6539\u5584\u5bf9 SQL \u6807\u51c6\u7684\u7b26\u5408\u7a0b\u5ea6\uff0c\u4e0d\u8fc7\u540e\u6765\u4f3c\u4e4e\u4e0d\u4e86\u4e86\u4e4b\u4e86\u3002\u56fd\u4ea7\u6570\u636e\u5e93\u4f5c\u4e3a\u6570\u636e\u5e93\u9886\u57df\u7684\u540e\u6765\u8005\uff0c\u66fe\u7ecf\u5bf9\u6807\u51c6\u7684\u7b26\u5408\u7a0b\u5ea6\u975e\u5e38\u91cd\u89c6\uff0c\u8fd8\u7ec4\u7ec7\u4e86\u4e13\u95e8\u7684\u673a\u6784\u6765\u505a\u4ea7\u54c1\u7684\u6807\u51c6\u7b26\u5408\u6027\u6d4b\u8bd5\u3002\u5728\u6570\u636e\u5e93\u767e\u79d1\u5168\u4e66\u4e2d\u4e5f\u6709\u5f88\u591a\u6709\u5173\u6807\u51c6\u7684\u7ae0\u8282\u3002</p> <p><code>SQL</code>\uff0c\u6216\u7ed3\u6784\u5316\u67e5\u8be2\u8bed\u8a00\uff0c\u662f\u4e00\u79cd\u7528\u4e8e\u7ba1\u7406\u548c\u64cd\u4f5c\u6570\u636e\u5e93\u4e2d\u6570\u636e\u7684\u5f3a\u5927\u5de5\u5177\u3002\u4e16\u754c\u5404\u5730\u7684\u4f01\u4e1a\u3001\u7ec4\u7ec7\u548c\u4e2a\u4eba\u90fd\u4f7f\u7528\u5b83\u6765\u7ec4\u7ec7\u3001\u5206\u6790\u548c\u7406\u89e3\u5927\u91cf\u4fe1\u606f\u3002</p> <p><code>SQL</code>\u6700\u5f3a\u5927\u7684\u65b9\u9762\u4e4b\u4e00\u662f\u5b83\u80fd\u591f\u4ee5\u591a\u79cd\u65b9\u5f0f\u8fc7\u6ee4\u3001\u6392\u5e8f\u548c\u805a\u5408\u6570\u636e\u3002\u8fd9\u4f7f\u5b83\u6210\u4e3a\u4e00\u4e2a\u975e\u5e38\u901a\u7528\u7684\u5de5\u5177\uff0c\u53ef\u7528\u4e8e\u4ece\u751f\u6210\u62a5\u544a\u5230\u5206\u6790\u5ba2\u6237\u884c\u4e3a\u7684\u5e7f\u6cdb\u4efb\u52a1\u3002</p> <p>\u8981\u7406\u89e3\u4e3a\u4ec0\u4e48\u4ee5\u53ca\u5982\u4f55\u4f7f\u7528<code>SQL</code>\uff0c\u8003\u8651\u4e00\u4e2a\u771f\u5b9e\u7684\u793a\u4f8b\u4f1a\u5f88\u6709\u5e2e\u52a9\u3002\u5047\u8bbe\u60a8\u7ecf\u8425\u4e00\u5bb6\u5c0f\u578b\u5728\u7ebf\u5546\u5e97\uff0c\u5e76\u62e5\u6709\u4e00\u4e2a\u5305\u542b\u6709\u5173\u60a8\u7684\u5ba2\u6237\u3001\u4ea7\u54c1\u548c\u8ba2\u5355\u7684\u4fe1\u606f\u7684\u6570\u636e\u5e93\u3002\u60a8\u60f3\u8981\u5206\u6790\u60a8\u7684\u9500\u552e\u6570\u636e\u4ee5\u66f4\u597d\u5730\u4e86\u89e3\u54ea\u4e9b\u4ea7\u54c1\u5356\u5f97\u597d\uff0c\u54ea\u4e9b\u4ea7\u54c1\u5356\u5f97\u4e0d\u597d\u3002</p> <p>\u4e00\u79cd\u65b9\u6cd5\u662f\u624b\u52a8\u7b5b\u9009\u6570\u636e\u5e93\u4e2d\u7684\u6570\u636e\uff0c\u5bfb\u627e\u6a21\u5f0f\u548c\u8d8b\u52bf\u3002\u4f46\u968f\u7740\u60a8\u7684\u4e1a\u52a1\u589e\u957f\u548c\u60a8\u5fc5\u987b\u7ba1\u7406\u7684\u6570\u636e\u91cf\u589e\u52a0\uff0c\u8fd9\u53d8\u5f97\u8d8a\u6765\u8d8a\u8017\u65f6\u4e14\u5bb9\u6613\u51fa\u9519\u3002</p> <p>\u8fd9\u5c31\u662f<code>SQL</code>\u7684\u7528\u6b66\u4e4b\u5730\u3002\u901a\u8fc7\u4f7f\u7528<code>SQL</code>\uff0c\u60a8\u53ef\u4ee5\u901a\u8fc7\u591a\u79cd\u65b9\u5f0f\u5feb\u901f\u8f7b\u677e\u5730\u8fc7\u6ee4\u3001\u6392\u5e8f\u548c\u805a\u5408\u6570\u636e\u3002\u4f8b\u5982\uff0c\u60a8\u53ef\u4ee5\u4f7f\u7528<code>SQL</code>\u627e\u51fa\u4e0a\u4e2a\u6708\u6536\u5230\u7684\u8ba2\u5355\u6570\u91cf\uff0c\u6216\u8005\u751f\u6210\u4e00\u4efd\u62a5\u544a\uff0c\u663e\u793a\u54ea\u4e9b\u4ea7\u54c1\u7684\u9500\u552e\u989d\u6700\u9ad8\u3002</p> <p>SQL \u4e0e\u5176\u4ed6\u7c7b\u578b\u7684\u7f16\u7a0b\u8bed\u8a00\u4e4b\u95f4\u5b58\u5728\u4e00\u4e9b\u5173\u952e\u5dee\u5f02\u3002\u5176\u4e2d\u6700\u91cd\u8981\u7684\u4e00\u70b9\u662f SQL \u662f\u4e00\u79cd\u58f0\u660e\u6027\u8bed\u8a00\uff0c\u8fd9\u610f\u5473\u7740\u60a8\u544a\u8bc9\u5b83\u60a8\u5e0c\u671b\u5b83\u505a\u4ec0\u4e48\uff08\u4f8b\u5982\u201c\u67e5\u627e\u8fc7\u53bb\u4e00\u4e2a\u6708\u7684\u6240\u6709\u8ba2\u5355\u201d\uff09\uff0c\u800c\u4e0d\u662f\u544a\u8bc9\u5b83\u600e\u4e48\u505a\uff08\u4f8b\u5982\u201c\u904d\u5386\u201d\u6bcf\u4e2a\u8ba2\u5355\u5e76\u68c0\u67e5\u65e5\u671f\u201d\uff09\u3002\u8fd9\u4f7f\u5f97 SQL \u6bd4\u5176\u4ed6\u7f16\u7a0b\u8bed\u8a00\u66f4\u6613\u4e8e\u4f7f\u7528\u548c\u7406\u89e3\u3002</p> <p>\u53e6\u4e00\u4e2a\u5173\u952e\u533a\u522b\u662f SQL \u662f\u4e13\u95e8\u4e3a\u4e0e\u5173\u7cfb\u6570\u636e\u5e93\u4e00\u8d77\u5de5\u4f5c\u800c\u8bbe\u8ba1\u7684\u3002\u8fd9\u610f\u5473\u7740\u5b83\u9488\u5bf9\u8fde\u63a5\u8868\u3001\u8fc7\u6ee4\u6570\u636e\u548c\u805a\u5408\u6570\u636e\u7b49\u4efb\u52a1\u8fdb\u884c\u4e86\u4f18\u5316\u3002</p> <p>\u6bcf\u4e2a\u5173\u7cfb\u578b\u6570\u636e\u5e93\u90fd\u5728\u4e0d\u540c\u7a0b\u5ea6\u4e0a\u5b9e\u73b0 SQL \u6807\u51c6\uff0c\u4f46\u662f\u4e5f\u6709\u81ea\u5df1\u5b9e\u73b0\u7684\u6807\u51c6\uff0c\u4f46\u662f\u5927\u90e8\u5206\u90fd\u662f\u57fa\u672c\u4e00\u81f4\uff0c\u4f46\u662f\u6bcf\u4e2a\u6570\u636e\u5e93\u90fd\u6709\u81ea\u5df1\u7684\u9ad8\u7ea7\u7279\u6027\u548c\u5b9e\u73b0\u6807\u51c6\u3002</p> <p>\u5f53\u5f15\u5165\u5173\u7cfb\u6a21\u578b\u65f6\uff0c\u5173\u7cfb\u6a21\u578b\u5305\u542b\u4e86\u4e00\u79cd\u67e5\u8be2\u6570\u636e\u7684\u65b0\u65b9\u6cd5\uff1aSQL\uff0c\u5b83\u662f\u4e00\u79cd <code>\u58f0\u660e\u5f0f</code> \u7684\u6570\u636e\u67e5\u8be2\u8bed\u8a00\u3002</p> <p>\u5728\u58f0\u660e\u5f0f\u67e5\u8be2\u8bed\u8a00\uff08\u5982 SQL \u6216\u5173\u7cfb\u4ee3\u6570\uff09\u4e2d\uff0c\u4f60\u53ea\u9700\u6307\u5b9a\u6240\u9700\u6570\u636e\u7684\u6a21\u5f0f - \u7ed3\u679c\u5fc5\u987b\u7b26\u5408\u54ea\u4e9b\u6761\u4ef6\uff0c\u4ee5\u53ca\u5982\u4f55\u5c06\u6570\u636e\u8f6c\u6362\uff08\u4f8b\u5982\uff0c\u6392\u5e8f\uff0c\u5206\u7ec4\u548c\u96c6\u5408\uff09 - \u4f46\u4e0d\u5173\u6ce8\u5982\u4f55\u5b9e\u73b0\u8fd9\u4e00\u76ee\u6807\u3002\u6570\u636e\u5e93\u7cfb\u7edf\u7684\u67e5\u8be2\u4f18\u5316\u5668\u51b3\u5b9a\u4f7f\u7528\u54ea\u4e9b\u7d22\u5f15\u548c\u54ea\u4e9b\u8fde\u63a5\u65b9\u6cd5\uff0c\u4ee5\u53ca\u4ee5\u4f55\u79cd\u987a\u5e8f\u6267\u884c\u67e5\u8be2\u7684\u5404\u4e2a\u90e8\u5206\u3002</p> <p>\u58f0\u660e\u5f0f\u67e5\u8be2\u8bed\u8a00\u662f\u8ff7\u4eba\u7684\uff0c\u56e0\u4e3a\u5b83\u901a\u5e38\u6bd4\u547d\u4ee4\u5f0f API \u66f4\u52a0\u7b80\u6d01\u548c\u5bb9\u6613\u3002\u4f46\u66f4\u91cd\u8981\u7684\u662f\uff0c\u5b83\u8fd8\u9690\u85cf\u4e86\u6570\u636e\u5e93\u5f15\u64ce\u7684\u5b9e\u73b0\u7ec6\u8282\uff0c\u8fd9\u4f7f\u5f97\u6570\u636e\u5e93\u7cfb\u7edf\u53ef\u4ee5\u5728\u65e0\u9700\u5bf9\u67e5\u8be2\u505a\u4efb\u4f55\u66f4\u6539\u7684\u60c5\u51b5\u4e0b\u8fdb\u884c\u6027\u80fd\u63d0\u5347\u3002</p> <p>Oracle\uff0cMySQL\uff0cMicroSoft SQL server, PostgreSQL \u662f\u4e0d\u540c\u7ec4\u7ec7\u5bf9\u5173\u7cfb\u578b\u6570\u636e\u5e93\u7684\u5177\u4f53\u5b9e\u73b0\u4ea7\u54c1\uff0c\u4ed6\u4eec\u90fd\u90e8\u5206\u5b9e\u73b0\u4e86 SQL \u6807\u51c6\u3002</p>"},{"location":"basic/4.sql/#sql_3","title":"SQL \u5f00\u53d1\u89c4\u8303","text":"<p>\u5bf9\u4e8e\u5f88\u591a\u7684\u7f16\u7a0b\u8bed\u8a00\u6765\u8bf4\uff0c\u5927\u5bb6\u603b\u6709\u4e2a\u4eba\u7684\u6216\u8005\u901a\u7528\u7684\u4ee3\u7801\u98ce\u683c\uff0c\u5176\u5b9e\u8fd9\u5bf9\u4e8e SQL \u540c\u6837\u4e5f\u4e0d\u4f8b\u5916\u3002\u597d\u7684\u4ee3\u7801\u98ce\u683c\u53ef\u4ee5\u63d0\u9ad8\u4ee3\u7801\u7684\u53ef\u8bfb\u6027\uff0c\u964d\u4f4e\u7ef4\u62a4\u6210\u672c\u3002\u6709\u4e9b\u7f16\u7a0b\u8bed\u8a00(\u5982 Golang)\u5185\u7f6e\u4e86\u683c\u5f0f\u5316\u4ee3\u7801\u547d\u4ee4 gofmt\uff0c\u53ef\u4ee5\u975e\u5e38\u65b9\u4fbf\u7684\u683c\u5f0f\u5316\u4ee3\u7801\u3002\u5bf9\u4e8e\u4ee3\u7801\u7684\u98ce\u683c\uff0c\u5927\u5bb6\u7684\u770b\u6cd5\u603b\u662f\u4e0d\u5c3d\u76f8\u540c\uff0c\u6bcf\u4e2a\u4eba\u53ef\u80fd\u90fd\u6709\u81ea\u5df1\u7684\u98ce\u683c\uff0c\u5982\u4f55\u7f29\u8fdb\uff0c\u600e\u4e48\u53d8\u91cf\u547d\u540d\u7b49\u7b49\u3002\u5f53\u4e00\u79cd\u4ee3\u7801\u89c4\u8303\u5f62\u6210\u4e00\u79cd\u5171\u8bc6\u540e\uff0c\u6211\u60f3\u8fd9\u624d\u80fd\u6700\u5927\u7a0b\u5ea6\u4e0a\u63d0\u9ad8\u4ee3\u7801\u7684\u53ef\u8bfb\u6027\u3001\u53ef\u7ef4\u62a4\u6027\u3002</p> <p>\u5728\u5e7f\u6cdb\u7684\u6570\u636e\u5206\u6790\u5e08\u548c\u5de5\u7a0b\u5e08\u56e2\u961f\u4e2d\u5de5\u4f5c\u65f6\uff0c\u60a8\u662f\u5426\u66fe\u4e3a\u4e0d\u540c\u7684 SQL \u98ce\u683c\u800c\u82e6\u82e6\u6323\u624e\u3002\u4e0a/\u4e0b\u5173\u952e\u5b57\u3001\u524d\u5bfc/\u5c3e\u968f\u9017\u53f7\u3001\u7f29\u8fdb\u3001\u522b\u540d\u89c4\u5219\u7b49\u3002</p> <p>\u968f\u7740\u6a21\u578b\u6570\u91cf\u7684\u589e\u957f\uff0c\u62e5\u6709\u4e00\u81f4\u7684\u98ce\u683c\u53d8\u5f97\u6709\u76ca\uff0c\u4ee5\u7b80\u5316\u4ee3\u7801\u5ba1\u67e5\u3001\u65b0\u6210\u5458\u7684\u5165\u804c\u7b49\u3002SQLfluff \u6765\u62ef\u6551\uff0c\u5b83\u662f SQL \u6587\u4ef6\u7684 CLI linter\u3002\u5b83\u53ef\u4ee5\u7a81\u51fa\u663e\u793a\u5e76\u7ecf\u5e38\u4fee\u590d\u6837\u5f0f\u8fdd\u89c4\u3002</p> <p>dbt \u662f\u53e6\u4e00\u4e2a\u4ee4\u4eba\u60ca\u53f9\u7684\u5de5\u5177\uff0c\u53ef\u4ee5\u7b80\u5316\u6570\u636e\u5efa\u6a21\u3001\u8ddf\u8e2a\u6a21\u578b\u4e4b\u95f4\u7684\u4f9d\u8d56\u5173\u7cfb\u5e76\u51cf\u5c11\u6837\u677f\u4ee3\u7801\u7684\u6570\u91cf\u3002</p> <p>gitlab-sql-style-guide</p> <ul> <li> <p>\u4f18\u70b9\uff1a   1\uff09\u5f15\u5165\u6df7\u5408\u5927\u5c0f\u5199\u6765\u5c06\u5173\u952e\u5b57\u4e0e\u5217\u540d\u548c\u8868\u540d\u5206\u5f00\uff0c\u4f8b\u5982\uff0c\u5c06 SELECT \u5199\u6210\u5927\u5199\uff0c\u5c06 Employee \u5199\u6210\u5927\u5199\uff0c\u4f46\u5982\u679c\u4e0d\u4e00\u81f4\uff0c\u4f8b\u5982 SELECT \u662f\u5927\u5199\u5b57\u6bcd\uff0c\u800c from \u662f\u5c0f\u5199\u5b57\u6bcd\uff0c\u4f7f\u7528\u8fd9\u79cd\u98ce\u683c\u6ca1\u6709\u4efb\u4f55\u597d\u5904\u3002</p> </li> <li> <p>\u7f3a\u70b9\uff1a</p> </li> <li> <p>\u6df7\u5408\u5927\u5c0f\u5199</p> </li> <li>\u6574\u4e2a\u67e5\u8be2\u5199\u5728\u4e00\u884c\u4e0a\uff0c\u4e00\u65e6\u8868\u548c\u5217\u7684\u6570\u91cf\u589e\u52a0\uff0c\u5c31\u4f1a\u53d8\u5f97\u4e0d\u53ef\u8bfb</li> <li>\u6dfb\u52a0\u65b0\u6761\u4ef6\u6216\u5728\u6ca1\u6709\u73b0\u6709\u6761\u4ef6\u7684\u60c5\u51b5\u4e0b\u8fd0\u884c\u6ca1\u6709\u7075\u6d3b\u6027</li> </ul> <p>Read more: https://javarevisited.blogspot.com/2017/01/a-better-way-to-write-sql-queries.html#ixzz8R4AscrEA</p> <p>\u6539\u8fdb\uff1a 1\uff09\u67e5\u8be2\u5206\u4e3a\u591a\u884c\uff0c\u4f7f\u5176\u66f4\u5177\u53ef\u8bfb\u6027</p> <ul> <li>\u95ee\u9898</li> </ul> <p>1\uff09\u6df7\u5408\u5927\u5c0f\u5199</p> <p>2\uff09where \u5b50\u53e5\u4e0a\u7684\u6240\u6709\u6761\u4ef6\u90fd\u5728\u540c\u4e00\u884c\uff0c\u8fd9\u610f\u5473\u7740\u901a\u8fc7\u6ce8\u91ca\u6392\u9664\u5b83\u4eec\u5e76\u4e0d\u90a3\u4e48\u5bb9\u6613\u3002</p> <p>Read more</p> <ol> <li> <p>\u5c06 SQL \u67e5\u8be2\u5206\u6210\u591a\u884c\u4f7f\u5b83\u4eec\u66f4\u5177\u53ef\u8bfb\u6027</p> </li> <li> <p>\u4f7f\u7528\u9002\u5f53\u7684\u7f29\u8fdb\u53ef\u4ee5\u8f7b\u677e\u53d1\u73b0\u6570\u636e\u6e90\uff0c\u5373\u8868\u548c\u8054\u63a5</p> </li> <li> <p>\u5c06\u6761\u4ef6\u653e\u5728\u5355\u72ec\u7684\u884c\u4e0a\u5141\u8bb8\u60a8\u901a\u8fc7\u6ce8\u91ca\u5176\u4e2d\u4e00\u4e2a\u6761\u4ef6\u6765\u8fd0\u884c\u67e5\u8be2\u4f8b\u5982</p> </li> </ol> <pre><code>select e.emp_id, e.emp_name, d.dept_name\n from Employee e\n inner join Department d on e.dept_id = d.dept_id\n where d.dept_name =  'finance'\n-- and e.emp_name like '%A%';\n</code></pre> <p>\u987a\u4fbf\u8bf4\u4e00\u53e5\uff0c\u5982\u679c\u60a8\u559c\u6b22\u5173\u952e\u5b57\u5927\u5199\uff0c\u60a8\u4e5f\u53ef\u4ee5\u7f16\u5199\u76f8\u540c\u7684 SQL \u67e5\u8be2\uff0c\u5982\u4e0b\u6240\u793a\uff0c\u89c4\u5219\u76f8\u540c\uff0c\u4f46\u53ea\u662f\u5173\u952e\u5b57\u5927\u5199\u3002</p> <p>Read more</p>"},{"location":"basic/4.sql/#_1","title":"\u56e2\u961f\u5bf9\u9f50","text":"<p>\u9996\u5148\uff0c\u60a8\u9700\u8981\u4e0e\u56e2\u961f\u4ea4\u8c08\u5e76\u89e3\u91ca\u4e3a\u4ec0\u4e48\u62e5\u6709\u67d0\u4e9b\u98ce\u683c\u89c4\u5219\u5f88\u91cd\u8981\u3002</p> <p>\u8fd9\u4e00\u6b65\u975e\u5e38\u91cd\u8981\uff0c\u56e0\u4e3a\u5982\u679c\u6ca1\u6709\u6e05\u695a\u5730\u4e86\u89e3\u4e3a\u4ec0\u4e48\u9700\u8981 PR\uff0c\u6ca1\u6709\u4eba\u4f1a\u4e50\u4e8e\u770b\u5230 PR \u505c\u7559\u5728\u5ba1\u67e5\u4e2d\u3002</p> <p>\u8fd9\u6b21\u8c08\u8bdd\u7684\u4e00\u4e2a\u597d\u7684\u7ed3\u679c\u662f\u6709\u4e00\u5957\u4f60\u540c\u610f\u9075\u5b88\u7684\u521d\u59cb\u89c4\u5219\u3002\u6b64\u5916\uff0c\u5982\u679c\u5b83\u5f88\u5927\u548c/\u6216\u7531\u591a\u4e2a dbt \u9879\u76ee\u7ec4\u6210\uff0c\u60a8\u53ef\u80fd\u53ea\u60f3\u4e3a\u9879\u76ee\u7684\u67d0\u4e2a\u533a\u57df\u63a8\u51fa\u5b83\u3002</p>"},{"location":"basic/4.sql/#_2","title":"\u96c6\u6210\u5230\u5f00\u53d1\u5de5\u4f5c\u6d41\u7a0b\u4e2d","text":"<p>\u4e0b\u4e00\u6b65\u662f\u5c06 SQLfluff \u96c6\u6210\u5230\u5f00\u53d1\u5de5\u4f5c\u6d41\u4e2d\u3002\u5b9e\u73b0\u5b83\u7684\u6700\u7b80\u5355\u65b9\u6cd5\u662f\u4f7f\u7528\u9884\u63d0\u4ea4\u6302\u94a9\u3002</p> <p>\u5982\u679c\u60a8\u5df2\u7ecf\u5728\u4f7f\u7528\u5b83\u4eec\uff0c\u53ea\u9700\u6dfb\u52a0\u51e0\u4e2a\u65b0\u7684\u94a9\u5b50\u4f1a\u5bb9\u6613\u5f97\u591a sqlfliff fix\uff0csqlfluff lint.</p> <p>\u5426\u5219\uff0c\u60a8\u53ef\u80fd\u9700\u8981\u66f4\u591a\u65f6\u95f4\u6765\u91c7\u7528\u9884\u63d0\u4ea4\u6302\u94a9\u3002\u503c\u5f97\u4e00\u63d0\u7684\u662f\uff0c\u5c3d\u7ba1\u5f3a\u70c8\u63a8\u8350\u6b64\u6b65\u9aa4\uff0c\u4f46\u4e3a\u4e86\u4f7f\u5f00\u53d1\u5de5\u4f5c\u6d41\u7a0b\u66f4\u52a0\u987a\u7545\uff0c\u6b64\u6b65\u9aa4\u53ef\u80fd\u662f\u53ef\u9009\u7684\u3002</p>"},{"location":"basic/4.sql/#cicd","title":"\u96c6\u6210\u5230 CI/CD \u4e2d","text":"<p>\u4e0b\u4e00\u6b65\u662f\u901a\u8fc7\u5c06 SQLfluff \u96c6\u6210\u5230 CI/CD \u4e2d\u6765\u5f3a\u5236\u6267\u884c\u89c4\u5219\u3002</p> <p>\u5b83\u53ef\u4ee5\u4ee5\u8f6f\u6216\u786c\u7684\u65b9\u5f0f\u5b8c\u6210\u3002</p> <p>\u5728\u7b2c\u4e00\u79cd\u60c5\u51b5\u4e0b\uff0c\u5b83\u5e94\u8be5\u53ea\u53d1\u51fa\u8b66\u544a\uff0c\u800c\u4e0d\u662f\u963b\u6b62 PR \u88ab\u5408\u5e76\u3002</p> <p>\u5728\u7b2c\u4e8c\u79cd\u60c5\u51b5\u4e0b\uff0cPR \u5e94\u8be5</p>"},{"location":"basic/4.sql/#sql_4","title":"SQL \u8bed\u6cd5\u548c\u6ce8\u91ca","text":"<pre><code>-- MySQL\u6709\u51e0\u79cd\u6ce8\u91ca\u8bed\u6cd5\n\n-- 1\u3001\u5355\u884c\u6ce8\u91ca\u7b26\"--\"\uff0c--\u6ce8\u91ca\u7b26\u540e\u9700\u8981\u52a0\u4e00\u4e2a\u7a7a\u683c\uff0c\u6ce8\u91ca\u624d\u80fd\u751f\u6548\n/* 2\u3001\u7528C\u8bed\u8a00\u98ce\u683c\u7684\u6ce8\u91ca\u6ce8\u91ca\u8bed\u53e5\u5757 */\n-- 3\u3001\u5355\u884c\u6ce8\u91ca\u7b26\"#\"\uff0c# \u6ce8\u91ca\u7b26\u540e\u76f4\u63a5\u52a0\u6ce8\u91ca\u5185\u5bb9\nSELECT 1+1 from dual;     -- \u6ce8\u91ca\u6587\u5b57\n\nSELECT 1+1 from dual;    # \u6ce8\u91ca\u6587\u5b57\uff0c\u8fd9\u4e2a#\u53f7\u5728MySQL\u4e2d\u4e5f\u662f\u6ce8\u91ca\n/* \u6807\u51c6SQL\u6ce8\u91ca\u91c7\u7528\u4e86C\u8bed\u8a00\u4e2d\u7684\u6ce8\u91ca\u8bed\u6cd5, MySQL\u540c\u6837\u652f\u6301\u8fd9\u79cd\u8bed\u6cd5  */\n-- \u4e0b\u9762\u8fd9\u6bb5\u6ce8\u91ca\u8868\u793a\uff1a\u5f53\u63a5\u6536SQL\u7684Server\u7248\u672c\u5927\u4e8e4.0.001\u65f6\uff0c\u540e\u9762\u7684\u6ce8\u91ca\u6587\u5b57\u5c31\u53ef\u4ee5\u88ab\u8bc6\u522b\u3002\nSELECT /*!40001 SQL_NO_CACHE */  count(*) FROM db_test.test_table\nSELECT SQL_NO_CACHE  count(*) FROM db_test.test_table\n</code></pre>"},{"location":"basic/4.sql/#_3","title":"\u5b57\u7b26\u4e32\u5b57\u9762\u91cf","text":"<p>\u5728\u6807\u51c6<code>SQL</code>\u4e2d\uff0c\u5b57\u7b26\u4e32\u4f7f\u7528\u7684\u662f\u5355\u5f15\u53f7\u62ec\u8d77\u6765\u7684\u3002\u5982\u679c\u5b57\u7b26\u4e32\u672c\u8eab\u4e5f\u5305\u62ec\u5355\u5f15\u53f7\uff0c\u5219\u4f7f\u7528\u4e24\u4e2a\u5355\u5f15\u53f7\uff08\u6ce8\u610f\u3002\u4e0d\u662f\u53cc\u5f15\u53f7\uff0c\u5b57\u7b26\u4e32\u4e2d\u7684\u53cc\u5f15\u53f7\u4e0d\u9700\u8981\u53e6\u5916\u8f6c\u4e49\uff09\u3002</p> <p>\u4f46\u5728\u5176\u5b83\u7684\u6570\u636e\u5e93\u4e2d\u53ef\u80fd\u5b58\u5728\u5bf9 <code>SQL</code> \u7684\u6269\u5c55\uff0c\u6bd4\u5982\u5728 <code>MySQL</code> \u4e2d\u5141\u8bb8\u4f7f\u7528\u5355\u5f15\u53f7\u548c\u53cc\u5f15\u53f7\u4e24\u79cd\u3002</p> <p>MySQL \u53ef\u4ee5\u4f7f\u7528\u5355\u5f15\u53f7\uff08'\uff09\u6216\u8005\u53cc\u5f15\u53f7\uff08\"\uff09\u8868\u793a\u503c\uff0c\u4f46\u662f PG \u53ea\u80fd\u7528\u5355\u5f15\u53f7\uff08'\uff09\u8868\u793a\u503c\uff0cPG \u7684\u53cc\u5f15\u53f7\uff08\"\uff09\u662f\u8868\u793a\u7cfb\u7edf\u6807\u8bc6\u7b26\u7684\uff0c\u6bd4\u5982\u8868\u540d\u6216\u8005\u5b57\u6bb5\u540d\u3002</p> <p>MySQL \u53ef\u4ee5\u4f7f\u7528\u53cd\u5355\u5f15\u53f7\uff08`\uff09\u8868\u793a\u7cfb\u7edf\u6807\u8bc6\u7b26\uff0c\u6bd4\u5982\u8868\u540d\u3001\u5b57\u6bb5\u540d\uff0cPG \u4e5f\u662f\u4e0d\u652f\u6301\u7684\u3002</p>"},{"location":"basic/4.sql/#_4","title":"\u6570\u636e\u5e93\u7684\u521b\u5efa\u4e0e\u5220\u9664","text":"<pre><code>-- \u5efa\u5e93\uff0c\u5728Unix\u4e2d\uff0c\u5e93\u540d\u662f\u4e25\u683c\u533a\u5206\u5927\u5c0f\u7684\uff0c\u5f3a\u70c8\u5efa\u8bae\u5e93\u540d\u7531\u5c0f\u5199\u5b57\u6bcd\u548c\u4e0b\u5212\u7ebf\u7ec4\u6210\nCREATE DATABASE `database_test`  IF NOT EXISTS CHARACTER SET 'utf8mb4' COLLATE 'utf8mb4_0900_ai_ci';\n\n-- \u8bbe\u7f6e\u67d0\u4e2a\u5e93\u53ea\u8bfb\n-- MySQL 8.0.22\u4e2d\u5f15\u5165\u7684READ ONLY\u9009\u9879\u63a7\u5236\u662f\u5426\u5141\u8bb8\u4fee\u6539\u6570\u636e\u5e93\u548c\u5176\u4e2d\u7684\u5bf9\u8c61\u3002\u5141\u8bb8\u7684\u503c\u4e3aDEFAULT\u62160\uff08\u975e\u53ea\u8bfb\uff09\u548c1\uff08\u53ea\u8bfb\uff09\u3002\n-- \u6b64\u9009\u9879\u5bf9\u4e8e\u6570\u636e\u5e93\u8fc1\u79fb\u975e\u5e38\u6709\u7528\uff0c\u56e0\u4e3a\u542f\u7528\u4e86\u53ea\u8bfb\u529f\u80fd\u7684\u6570\u636e\u5e93\u53ef\u4ee5\u8fc1\u79fb\u5230\u53e6\u4e00\u4e2aMySQL\u5b9e\u4f8b\uff0c\u800c\u4e0d\u5fc5\u62c5\u5fc3\u5728\u64cd\u4f5c\u8fc7\u7a0b\u4e2d\u6570\u636e\u5e93\u53ef\u80fd\u4f1a\u53d1\u751f\u66f4\u6539\u3002\n\nALTER DATABASE  `database_test`   READ ONLY = 0 ;\n\n\n-- \u5220\u5e93\nDROP DATABASE database_test;\n\n\n-- \u4fee\u6539\u6570\u636e\u5e93\n-- \u6ce8\u610f\uff1a\u5728 MySQL \u4e2d\uff0c\u6570\u636e\u5e93\u521b\u5efa\u4e4b\u540e\u5e93\u540d\u662f\u65e0\u6cd5\u76f4\u63a5\u4fee\u6539\u7684\u3002\u80fd\u6539\u7684\u53ea\u6709\u5b57\u7b26\u96c6\u7b49\u5c5e\u6027\u3002\n</code></pre>"},{"location":"basic/4.sql/#_5","title":"\u8868\u7684\u521b\u5efa","text":"<pre><code>-- \u6587\u4ef6\u5927\u5c0f\u5199\uff0c\u5728\u4e0d\u540c\u7684\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u7684\u6587\u4ef6\u7cfb\u7edf\uff0c\u662f\u4e0d\u4e00\u6837\u7684\u3002\n-- Linux\u64cd\u4f5c\u7cfb\u7edf\uff0c\u4e25\u683c\u533a\u5206\u5927\u5c0f\u5199\uff0cTest \u548c TEST \u662f\u4e24\u4e2a\u4e0d\u540c\u7684\u6587\u4ef6\u6216\u6587\u4ef6\u5939\u3002\n-- Windows\u64cd\u4f5c\u7cfb\u7edf\uff0c\u4e0d\u533a\u5206\u5927\u5c0f\u5199\uff0c\u65e0\u6cd5\u540c\u65f6\u521b\u5efa Test \u548c TEST \u4e24\u4e2a\u540c\u540d\u7684\u6587\u4ef6\u6216\u6587\u4ef6\u5939\u3002\n\n-- \u5bf9\u4e8eMySQL\u6570\u636e\u5e93\u548c\u8868\uff0c\u8981\u5728\u64cd\u4f5c\u7cfb\u7edf\u521b\u5efa\u4e0e\u5e93\u540d\u548c\u8868\u540d\u76f8\u540c\u7684\u6587\u4ef6\u5939\u6216\u6587\u4ef6\u3002\n\n-- lower_case_file_system \u662f\u4e00\u4e2a\u53ea\u8bfb\u53c2\u6570\uff0c\u65e0\u6cd5\u88ab\u4fee\u6539\uff0c\u8fd9\u4e2a\u53c2\u6570\u662f\u7528\u6765\u544a\u8bc9\u4f60\u5728\u5f53\u524d\u7684\u7cfb\u7edf\u5e73\u53f0\u4e0b\uff0c\u662f\u5426\u5bf9\u6587\u4ef6\u540d\u5927\u5c0f\u5199\u654f\u611f\u3002\n\n-- lower_case_table_names\u662f\u4e00\u4e2aMySQL\u53ef\u914d\u7f6e\u7684\u53c2\u6570\uff0c\u5b83\u7684\u53d6\u503c\u5982\u4e0b\uff1a\n\n-- 0 \u5927\u5c0f\u5199\u654f\u611f\u3002\uff08Unix\uff0cLinux\u9ed8\u8ba4\uff09 \u521b\u5efa\u7684\u5e93\u8868\u5c06\u539f\u6837\u4fdd\u5b58\u5728\u78c1\u76d8\u4e0a\u3002\n-- \u5982 create database TeSt ; \u5c06\u4f1a\u521b\u5efa\u4e00\u4e2aTeSt\u7684\u76ee\u5f55\uff0ccreate table AbCCC \u2026\u5c06\u4f1a\u539f\u6837\u751f\u6210AbCCC.frm\u3002 SQL\u8bed\u53e5\u4e5f\u4f1a\u539f\u6837\u89e3\u6790\u3002\n\n-- 1 \u5927\u5c0f\u5199\u4e0d\u654f\u611f\u3002\uff08Windows\u9ed8\u8ba4\uff09 \u521b\u5efa\u5e93\u8868\u65f6\uff0cMySQL\u5c06\u6240\u6709\u7684\u5e93\u8868\u6587\u4ef6\u8f6c\u6362\u6210\u5c0f\u5199\u5b58\u50a8\u5728\u78c1\u76d8\u4e0a\u3002SQL\u8bed\u53e5\u540c\u6837\u4f1a\u5c06\u5e93\u8868\u540d\u8f6c\u6362\u6210\u5c0f\u5199\u3002\n-- \u5982\u9700\u8981\u67e5\u8be2\u4ee5\u524d\u521b\u5efa\u7684Testtable\uff08\u751f\u6210Testtable.frm\u6587\u4ef6\uff09\uff0c\u5373\u4fbf\u6267\u884cselect * from Testtable\uff0c\u4e5f\u4f1a\u88ab\u8f6c\u6362\u6210select * from testtable\uff0c\u81f4\u4f7f\u62a5\u9519\u8868\u4e0d\u5b58\u5728\u3002\n\n-- \u5217\u540d\uff0c\u7d22\u5f15\u540d\uff0c\u5b58\u50a8\u8fc7\u7a0b\u3001\u51fd\u6570\u53ca\u4e8b\u4ef6\u540d\u79f0\u5728\u4efb\u4f55\u64cd\u4f5c\u7cfb\u7edf\u4e0b\u90fd\u4e0d\u533a\u5206\u5927\u5c0f\u5199\uff0c\u5217\u522b\u540d\u4e5f\u4e0d\u533a\u5206\u5927\u5c0f\u5199\u3002\n\n\n-- \u6700\u4f73\u5b9e\u8df5\uff1a\u5efa\u8bae\u5c06lower_case_table_names\u503c\u7edf\u4e00\u8bbe\u7f6e\u4e3a0\uff0c\u5728\u4ee3\u7801\u4e2d\u5bf9\u5927\u5c0f\u5199\u8fdb\u884c\u4e25\u683c\u533a\u5206\n-- \u5e93\u540d\uff0c\u8868\u540d\uff0c\u5b57\u6bb5\u540d\uff0c\u7edf\u4e00\u7531\u5c0f\u5199\u82f1\u6587\u5b57\u7b26\u548c\u6570\u5b57\u7ec4\u6210\u3002\n\n-- \u5728\u5404\u5bb6\u516c\u53f8\uff0c\u90fd\u5b58\u5728\u5404\u79cd\u8bbe\u8ba1\u89c4\u8303\uff1a\n-- https://support.huaweicloud.com/bestpractice-rds/rds_02_0013.html\n\n\n-- lower_case_table_names \u53c2\u6570\u662f\u5168\u5c40\u7cfb\u7edf\u53d8\u91cf\uff0c\u4e0d\u53ef\u4ee5\u52a8\u6001\u4fee\u6539\uff0c\u60f3\u8981\u53d8\u52a8\u65f6\uff0c\u5fc5\u987b\u5199\u5165\u914d\u7f6e\u6587\u4ef6\u7136\u540e\u91cd\u542f\u6570\u636e\u5e93\u751f\u6548\u3002\n-- \u5982\u679c\u4f60\u7684\u6570\u636e\u5e93\u8be5\u53c2\u6570\u4e00\u5f00\u59cb\u4e3a 0 \uff0c\u73b0\u5728\u60f3\u8981\u6539\u4e3a 1 \uff0c\u8fd9\u79cd\u60c5\u51b5\u8981\u683c\u5916\u6ce8\u610f\uff0c\u56e0\u4e3a\u82e5\u539f\u5b9e\u4f8b\u4e2d\u5b58\u5728\u5927\u5199\u7684\u5e93\u8868\uff0c\u5219\u6539\u4e3a 1 \u91cd\u542f\u540e\uff0c\u8fd9\u4e9b\u5e93\u8868\u5c06\u4f1a\u4e0d\u80fd\u8bbf\u95ee\u3002\n-- \u5982\u679c\u9700\u8981\u5c06 lower_case_table_names \u53c2\u6570\u4ece 0 \u6539\u6210 1 \uff0c\u53ef\u4ee5\u6309\u7167\u4e0b\u9762\u6b65\u9aa4\u4fee\u6539\uff1a\n\n-- 1\u3001\u9996\u5148\u6838\u5b9e\u4e0b\u5b9e\u4f8b\u4e2d\u662f\u5426\u5b58\u5728\u5927\u5199\u7684\u5e93\u53ca\u8868\uff0c\u82e5\u4e0d\u5b58\u5728\u5927\u5199\u7684\u5e93\u8868\uff0c\u5219\u53ef\u4ee5\u76f4\u63a5\u4fee\u6539\u914d\u7f6e\u6587\u4ef6\u7136\u540e\u91cd\u542f\u3002\u82e5\u5b58\u5728\u5927\u5199\u7684\u5e93\u8868\uff0c\u5219\u9700\u8981\u5148\u5c06\u5927\u5199\u7684\u5e93\u8868\u8f6c\u5316\u4e3a\u5c0f\u5199\uff0c\u7136\u540e\u624d\u53ef\u4ee5\u4fee\u6539\u914d\u7f6e\u6587\u4ef6\u91cd\u542f\u3002\n\n-- 2\u3001\u901a\u8fc7 mysqldump \u5907\u4efd\u76f8\u5173\u5e93\uff0c\u5907\u4efd\u5b8c\u6210\u540e\u5220\u9664\u5bf9\u5e94\u5e93\uff0c\u4e4b\u540e\u4fee\u6539\u914d\u7f6e\u6587\u4ef6\u91cd\u542f\uff0c\u6700\u540e\u5c06\u5907\u4efd\u6587\u4ef6\u91cd\u65b0\u5bfc\u5165\u3002\u6b64\u65b9\u6cd5\u7528\u65f6\u8f83\u957f\uff0c\u4e00\u822c\u5f88\u5c11\u7528\u5230\u3002\n\n-- 3\u3001 \u901a\u8fc7 rename \u8bed\u53e5\u4fee\u6539\n\n-- \u5c06\u5927\u5199\u8868\u91cd\u547d\u540d\u4e3a\u5c0f\u5199\u8868\nrename table TEST to test;\n\n-- \u82e5\u5b58\u5728\u5927\u5199\u5e93 \u5219\u9700\u8981\u5148\u521b\u5efa\u5c0f\u5199\u5e93 \u7136\u540e\u5c06\u5927\u5199\u5e93\u91cc\u9762\u7684\u8868\u8f6c\u79fb\u5230\u5c0f\u5199\u5e93\nrename table TESTDB.test_tb to testdb.test_tb;\n\n-- \u5206\u4eab\u4e24\u6761\u53ef\u80fd\u7528\u5230\u7684SQL\n-- \u67e5\u8be2\u5b9e\u4f8b\u4e2d\u6709\u5927\u5199\u5b57\u6bcd\u7684\u8868\nSELECT\n TABLE_SCHEMA,\n TABLE_NAME\nFROM\n information_schema.`TABLES`\nWHERE\n TABLE_SCHEMA NOT IN ( 'information_schema', 'sys', 'mysql', 'performance_schema' )\n AND table_type = 'BASE TABLE'\n AND TABLE_NAME REGEXP BINARY '[A-Z]'\n\n\n-- \u62fc\u63a5SQL \u5c06\u5927\u5199\u5e93\u4e2d\u7684\u8868\u8f6c\u79fb\u5230\u5c0f\u5199\u5e93\nSELECT\n CONCAT( 'rename table TESTDB.', TABLE_NAME, ' to testdb.', TABLE_NAME, ';' )\nFROM\n information_schema.TABLES\nWHERE\n TABLE_SCHEMA = 'TESTDB';\n\n\n-- \u5efa\u8868\n-- \u8868\u540d\uff0c\u5b57\u6bb5\u540d\uff0c\u5b57\u6bb5\u7c7b\u578b\uff0c\u5b57\u6bb5\u7684\u7ea6\u675f\uff0c\u5b57\u6bb5\u7684\u5b57\u7b26\u96c6\uff0c\u5b58\u50a8\u5f15\u64ce\u7b49\nCREATE TABLE `cwd_group` (\n  `id` bigint NOT NULL,\n  `group_name` varchar(255) COLLATE utf8_bin NOT NULL,\n  `lower_group_name` varchar(255) COLLATE utf8_bin NOT NULL,\n  `active` char(1) COLLATE utf8_bin NOT NULL,\n  `local` char(1) COLLATE utf8_bin NOT NULL,\n  `created_date` datetime NOT NULL,\n  `updated_date` datetime NOT NULL,\n  `description` varchar(255) COLLATE utf8_bin DEFAULT NULL,\n  `group_type` varchar(32) COLLATE utf8_bin NOT NULL,\n  `directory_id` bigint NOT NULL,\n  PRIMARY KEY (`id`),\n  UNIQUE KEY `cwd_group_name_dir_id` (`lower_group_name`,`directory_id`),\n  KEY `idx_group_active` (`active`,`directory_id`),\n  KEY `idx_group_dir_id` (`directory_id`)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci;\n\n\nCREATE TABLE Product (\n    product_id        char(4)         NOT NULL,\n    product_name      varchar(100)    NOT NULL,\n    product_type      varchar(32)     NOT NULL,\n    sale_price        integer                 ,\n    purchase_price    integer                 ,\n    regist_date       date                    ,\n    PRIMARY KEY (`product_id`)\n\n) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci;\n\n\n-- \u5728demo\u5e93\u4e0b\u5efa\u8868ChineseCharInfo\uff0c\u6709\u4e24\u5217\uff0c\u5176\u4e2dID\u4e3a\u81ea\u589e\u4e3b\u952e\nCREATE TABLE demo.ChineseCharInfo\n(\n    ID        int              NOT NULL     auto_increment,\n    Hanzi     varchar(10)      NOT NULL,\n    primary   key (ID)\n)\nENGINE=InnoDB auto_increment=1 DEFAULT CHARSET=utf8 COLLATE=utf8_general_ci;\n\n\n-- \u5728demo\u5e93\u4e0b\u5efa\u8868ChinesePinyinInfo\nCREATE TABLE demo.ChinesePinyinInfo\n(\n    ID         INT                  NOT NULL     AUTO_INCREMENT,\n    CharID     INT                  NULL,\n    Pinyin     VARCHAR(10)          NULL,\n    Tone       TINYINT UNSIGNED     NULL,\n\n    primary key (ID),\n    -- \u65b9\u5f0f\u4e00\uff1a\u4e0d\u6307\u5b9a\u5916\u952e\u540d\u79f0\uff0c\u6570\u636e\u5e93\u81ea\u52a8\u751f\u6210\n    FOREIGN KEY (CharID) REFERENCES ChineseCharInfo(ID) ON DELETE CASCADE ON UPDATE CASCADE\n\n    -- \u65b9\u5f0f\u4e8c\uff1a\u6307\u5b9a\u5916\u952e\u540d\u79f0\u4e3a(FK_Name)\n    -- constraint FK_Name foreign key (CharID) references ChineseCharInfo(ID) on delete cascade on update cascade\n)\nENGINE=innodb AUTO_INCREMENT=1 DEFAULT CHARSET=utf8 COLLATE=utf8_general_ci;\n\n-- \u521b\u5efa\u4e00\u4e2a\u4e0e\u539f\u8868\u7ed3\u6784\u4e00\u6837\u7684\u8868\nCREATE TABLE demo.ChineseCharInfobak LIKE demo.ChineseCharInfo\n</code></pre>"},{"location":"basic/4.sql/#_6","title":"\u751f\u6210\u5217","text":"<p>\u5728 SQL \u4e2d\uff0c\u751f\u6210\u5217\uff08Generated Column\uff09\u662f\u6307\u7531\u8868\u4e2d\u5176\u4ed6\u5b57\u6bb5\u8ba1\u7b97\u5f97\u5230\u7684\u5217\uff0c\u56e0\u6b64\u4e5f\u79f0\u4e3a\u8ba1\u7b97\u5217\uff08Computed Column\uff09\u3002</p> <p>\u5728 SQL \u5efa\u8868\u8bed\u53e5\u652f\u6301\u6307\u5b9a\u7684\u751f\u6210\u5217\uff0c\u5217\u7684\u53d6\u503c\u7531\u5176\u5b9a\u4e49\u8ba1\u7b97\u51fa\u6765\u7684\u3002\u6709\u5982\u4e0b\u7279\u70b9\uff1a</p> <ol> <li>\u865a\u62df\u5217\u5b57\u6bb5\u53ea\u8bfb\uff0c\u4e0d\u652f\u6301 INSRET \u548c UPDATE\u3002</li> <li><code>virtual</code>\u548c<code>stored</code>\u4e4b\u95f4\u4e0d\u80fd\u76f8\u4e92\u8f6c\u6362\uff0c\u5fc5\u8981\u65f6\u9700\u8981\u5220\u9664\u91cd\u5efa\u3002</li> <li>\u53ea\u80fd\u5f15\u7528\u672c\u8868\u7684\u975e<code>generated column</code>\u5b57\u6bb5\uff0c\u4e0d\u53ef\u4ee5\u5f15\u7528\u5176\u5b83\u8868\u7684\u5b57\u6bb5\u3002</li> <li>\u652f\u6301\u521b\u5efa\u7d22\u5f15\u3002</li> <li>\u9488\u5bf9<code>virtual</code>\u7c7b\u578b\u7684\u884d\u751f\u5217\u7d22\u5f15\uff0c\u5728<code>insert</code>\u548c<code>update</code>\u64cd\u4f5c\u65f6\u4f1a\u6d88\u8017\u989d\u5916\u7684\u5199\u8d1f\u8f7d\uff0c\u56e0\u4e3a\u66f4\u65b0\u884d\u751f\u5217\u7d22\u5f15\u65f6\u9700\u8981\u5c06\u884d\u751f\u5217\u503c\u8ba1\u7b97\u51fa\u6765\uff0c\u5e76\u7269\u5316\u5230\u7d22\u5f15\u91cc\u3002\u4f46\u5373\u4f7f\u8fd9\u6837\uff0c<code>virtual</code>\u7c7b\u578b\u4e5f\u6bd4<code>stored</code>\u7c7b\u578b\u7684\u884d\u751f\u5217\u597d\uff0c\u6709\u7d22\u5f15\u5c31\u907f\u514d\u4e86\u6bcf\u6b21\u8bfb\u53d6\u6570\u636e\u884c\u65f6\u90fd\u9700\u8981\u8fdb\u884c\u4e00\u6b21\u884d\u751f\u8ba1\u7b97\uff0c\u540c\u65f6<code>stored</code>\u7c7b\u578b\u884d\u751f\u5217\u5b9e\u9645\u5b58\u50a8\u6570\u636e\uff0c\u4f7f\u5f97\u805a\u7c07\u7d22\u5f15\u66f4\u5927\u66f4\u5360\u7a7a\u95f4\u3002</li> </ol> <p>MySQL 5.7 \u5f15\u5165\u4e86\u751f\u6210\u5217\uff0c\u652f\u6301<code>\u865a\u62df</code>\u548c<code>\u5b58\u50a8</code>\u4e24\u79cd\u7c7b\u578b\u7684\u751f\u6210\u5217\u3002</p> <ul> <li>Virtual\uff08\u865a\u62df\uff09\uff1a\u8fd9\u4e2a\u7c7b\u578b\u7684\u5217\u4f1a\u5728\u8bfb\u53d6\u8868\u8bb0\u5f55\u65f6\u81ea\u52a8\u8ba1\u7b97\u6b64\u5217\u7684\u7ed3\u679c\u5e76\u8fd4\u56de\u3002\u9ed8\u8ba4\u521b\u5efa\u7684\u662f<code>VIRTUAL</code>\u751f\u6210\u5217\u3002</li> <li>Stored\uff08\u5b58\u50a8\uff09\uff1a\u8fd9\u4e2a\u7c7b\u578b\u7684\u5217\u4f1a\u5728\u8868\u4e2d\u63d2\u5165\u4e00\u6761\u6570\u636e\u65f6\u81ea\u52a8\u8ba1\u7b97\u5bf9\u5e94\u7684\u503c\uff0c\u5e76\u63d2\u5165\u5230\u8fd9\u4e2a\u5217\u4e2d\uff0c\u90a3\u4e48\u8fd9\u4e2a\u5217\u4f1a\u4f5c\u4e3a\u4e00\u4e2a\u5e38\u89c4\u5217\u5b58\u5728\u8868\u4e2d\u3002</li> </ul> <p>\u9488\u5bf9<code>Virtual</code>\u7c7b\u578b\u7684\u884d\u751f\u5217\u7d22\u5f15\uff0c\u5728<code>insert</code>\u548c<code>update</code>\u64cd\u4f5c\u65f6\u4f1a\u6d88\u8017\u989d\u5916\u7684\u5199\u8d1f\u8f7d\uff0c\u56e0\u4e3a\u66f4\u65b0\u884d\u751f\u5217\u7d22\u5f15\u65f6\u9700\u8981\u5c06\u884d\u751f\u5217\u503c\u8ba1\u7b97\u51fa\u6765\uff0c\u5e76\u7269\u5316\u5230\u7d22\u5f15\u91cc\u3002\u4f46\u5373\u4f7f\u8fd9\u6837\uff0c<code>virtual</code>\u7c7b\u578b\u4e5f\u6bd4<code>stored</code>\u4e86\u6bcf\u6b21\u8bfb\u53d6\u6570\u636e\u884c\u65f6\u90fd\u7c7b\u578b\u7684\u884d\u751f\u5217\u597d\uff0c\u6709\u7d22\u5f15\u5c31\u907f\u514d\u9700\u8981\u8fdb\u884c\u4e00\u6b21\u884d\u751f\u8ba1\u7b97\uff0c\u540c\u65f6<code>stored</code>\u7c7b\u578b\u884d\u751f\u5217\u5b9e\u9645\u5b58\u50a8\u6570\u636e\uff0c\u4f7f\u5f97\u805a\u7c07\u7d22\u5f15\u66f4\u5927\u66f4\u5360\u7a7a\u95f4\u3002\u6ce8\u610f\uff0c\u51fa\u4e8e\u6027\u80fd\u7684\u8003\u8651\uff0c\u9009\u62e9 Virtual \u800c\u4e0d\u662f Stored</p> <pre><code>-- \u901a\u8fc7sidea\u548csideb\u5217\u4e2d\u76f4\u89d2\u4e09\u89d2\u5f62\u7684\u8fb9\u7684\u957f\u5ea6 \uff0c\u5e76\u8ba1\u7b97\u4e0b\u659c\u8fb9\u7684\u957f\u5ea6 sidec\uff08\u5176\u4ed6\u8fb9\u7684\u5e73\u65b9\u548c\u7684\u5e73\u65b9\u6839\uff09\n\n-- \u5efa\u8868\u5b9a\u4e49\u76f4\u89d2\u4e09\u89d2\u5f62\uff08\u957f\u8fb9\uff0c\u77ed\u8fb9\uff0c\u659c\u8fb9\uff08\u659c\u8fb9\u662f\u8ba1\u7b97\u51fa\u6765\u7684\uff09\uff09\nCREATE TABLE triangle (\n  sidea DOUBLE,\n  sideb DOUBLE,\n  sidec DOUBLE AS (SQRT(sidea * sidea + sideb * sideb))\n);\n\n-- \u6d4b\u8bd5\u6570\u636e\nINSERT INTO triangle (sidea, sideb) VALUES(1,1),(3,4),(6,8);\n\n\nmysql&gt; SELECT * FROM triangle;\n+-------+-------+--------------------+\n| sidea | sideb | sidec              |\n+-------+-------+--------------------+\n|     1 |     1 | 1.4142135623730951 |\n|     3 |     4 |                  5 |\n|     6 |     8 |                 10 |\n+-------+-------+--------------------+\n\n\n-- \u8868\u751f\u6210\u5217\u8bed\u6cd5\ncol_name data_type [GENERATED ALWAYS] AS (expr)\n  [VIRTUAL | STORED] [NOT NULL | NULL]\n  [UNIQUE [KEY]] [[PRIMARY] KEY]\n  [COMMENT 'string']\n\n-- \u5176\u4e2d\uff0cGENERATED ALWAYS\u53ef\u4ee5\u7701\u7565\uff1b\n-- AS\u5b9a\u4e49\u4e86\u751f\u6210\u5217\u7684\u8868\u8fbe\u5f0f\uff1b\n-- VIRTUAL\u8868\u793a\u521b\u5efa\u865a\u62df\u751f\u6210\u5217\uff0c\u865a\u62df\u5217\u7684\u503c\u4e0d\u4f1a\u5b58\u50a8\uff0c\u800c\u662f\u5728\u8bfb\u53d6\u65f6BEFORE\u89e6\u53d1\u5668\u4e4b\u540e\u7acb\u5373\u8ba1\u7b97\uff1b\n-- STORED\u8868\u793a\u5b58\u50a8\u751f\u6210\u5217\uff1b\u9ed8\u8ba4\u521b\u5efa\u7684\u662fVIRTUAL\u751f\u6210\u5217\u3002\n\n\n\nCREATE TABLE `iam`.`biz_cloudsign_login`  (\n  `id` bigint(20) NOT NULL AUTO_INCREMENT,\n  `business_system_code` int(11) NOT NULL,\n  `user_department` varchar(50) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci NULL DEFAULT NULL,\n  `employee_num` varchar(36) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci NULL DEFAULT NULL,\n  `user_name` varchar(50) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci NULL DEFAULT NULL,\n  `identity_number` varchar(20) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci NULL DEFAULT NULL,\n  `client_id` varchar(40) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci NULL DEFAULT NULL,\n  `client_ip` varchar(40) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci NOT NULL,\n  `random_num` varchar(50) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci NOT NULL,\n  `cert_id` varchar(36) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci NOT NULL,\n  `encrypted_token` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci NOT NULL,\n  `updated_at` datetime(0) NOT NULL,\n  PRIMARY KEY (`id`) USING BTREE,\n\n) ENGINE = InnoDB AUTO_INCREMENT = 302 CHARACTER SET = utf8mb4 COLLATE = utf8mb4_general_ci ROW_FORMAT = Dynamic;\n\n\n\nSELECT\n    DATE_FORMAT(v.updated_at,   '%Y-%m-%d'),\n    count(DATE_FORMAT(v.updated_at,   '%Y-%m-%d'))\nFROM\n    biz_cloudsign_login v\n    INNER JOIN ( SELECT MAX( id ) 'id' FROM biz_cloudsign_login GROUP BY employee_num,DATE_FORMAT(updated_at, '%Y-%m-%d') ) c ON v.id = c.id\n    GROUP BY DATE_FORMAT(v.updated_at,   '%Y-%m-%d')\n\n\n-- \u5728\u67e5\u8be2\u5b57\u6bb5\u548c\u5206\u7ec4\u5b57\u6bb5\u52a0\u4e0a\u7d22\u5f15\nALTER TABLE `iam`.`biz_cloudsign_login`\nADD INDEX `idx_updated_at`(`updated_at`),\nADD INDEX `idx_employee_num_updated_at`(`employee_num`, `updated_at`);\n\n\n-- \u6709\u65f6\u5019\u9700\u8981\u5bf9\u5b57\u6bb5\u4e0a\u52a0\u51fd\u6570\u7136\u540e\u8fdb\u884cGROUP BY\u3002\u67e5\u770b\u6267\u884c\u8ba1\u5212\uff0c\u53d1\u73b0\u51fa\u73b0 Using temporary\uff0c \u5206\u7ec4\u6761\u4ef6\u5e76\u6ca1\u6709\u8d70\u7d22\u5f15\u3002\n-- \u56e0\u4e3amysql 5.7 \u7684\u51fd\u6570\u4f1a\u5bfc\u81f4\u7d22\u5f15\u5931\u6548\u3002\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u6dfb\u52a0\u4e00\u4e2a\u5197\u4f59\u5b57\u6bb5\u6765\u4fdd\u5b58\u51fd\u6570\u7684\u8ba1\u7b97\u7ed3\u679c\uff0c\u7136\u540e\u6dfb\u52a0\u7d22\u5f15\uff0c\u8fd9\u65f6\u5019\u7684GROUP BY\u5c31\u4f1a\u8d70\u7d22\u5f15\u4e86\u3002\n\n-- \u52a0\u4e2a\u65b0\u5b57\u6bb5\uff0c\u865a\u62df\u5217\u3002\nALTER TABLE `iam`.`biz_cloudsign_login`\nADD COLUMN `update_at_date` date GENERATED ALWAYS AS (date_format(`updated_at`,'%Y-%m-%d')) Virtual NULL AFTER `updated_at`;\n\n-- \u5bf9\u865a\u62df\u5b57\u6bb5\u52a0\u4e0a\u7d22\u5f15\nALTER TABLE `iam`.`biz_cloudsign_login`\nADD INDEX `idx_updated_at`(`update_at_date`),\nADD INDEX `idx_employee_num_updated_at`(`employee_num`, `update_at_date`);\n</code></pre>"},{"location":"basic/4.sql/#_7","title":"\u6570\u636e\u63d2\u5165","text":"<p>SQL \u6807\u51c6\u4e3b\u8981\u63d0\u4f9b\u4e86\u4e24\u79cd\u63d2\u5165\u6570\u636e\u7684\u8bed\u6cd5\uff1a</p> <pre><code>-- \u7b2c\u4e00\u79cd\u8bed\u6cd5\u7528\u4e8e\u5c06\u6307\u5b9a\u7684\u6570\u636e\u63d2\u5165\u76ee\u6807\u8868\nINSERT INTO \u2026 VALUES \u2026\n-- \u7b2c\u4e8c\u79cd\u8bed\u6cd5\u53ef\u4ee5\u5c06\u4e00\u4e2a\u67e5\u8be2\u7ed3\u679c\u63d2\u5165\u76ee\u6807\u8868\nINSERT INTO \u2026 SELECT \u2026\n</code></pre> <p>\u5728 MySQL \u4e2d\u53ef\u4ee5\u4f7f\u7528 INSERT \u8bed\u53e5\u5411\u6570\u636e\u5e93\u5df2\u6709\u7684\u8868\u4e2d\u63d2\u5165\u4e00\u884c\u6216\u8005\u591a\u884c\u5143\u7ec4\u6570\u636e\u3002</p> <pre><code>--\u5355\u6761\u63d2\u5165\nINSERT INTO items(name,city,price,number,picture)  VALUES ('\u8010\u514b\u8fd0\u52a8\u978b','\u5e7f\u5dde',500,1000,'003.jpg');\n\n\n\n--\u6279\u91cf\u63d2\u5165\nINSERT INTO  items(name,city,price,number,picture)\n VALUES\n('\u8010\u514b\u8fd0\u52a8\u978b','\u5e7f\u5dde',500,1000,'003.jpg'),\n('\u8010\u514b\u8fd0\u52a8\u978b2','\u5e7f\u5dde2',500,1000,'002.jpg');\n\n-- 1\u3001\u8981\u6839\u636e\u60c5\u51b5\u8bbe\u7f6e\u4e00\u6b21\u6279\u91cf\u63d2\u5165\u7684\u6570\u636e\u91cf\uff0c\u6570\u636e\u91cf\u5927\uff0c\u5728\u7f51\u7edc\u4e2d\u4f20\u8f93\u7684\u4e8b\u4ef6\u4e5f\u8d8a\u4e45\uff0c\u51fa\u73b0\u95ee\u9898\u7684\u53ef\u80fd\u4e5f\u8d8a\u5927\uff1b\n\n-- 2\u3001\u9664\u4e86\u7f51\u7edc\uff0c\u8fd8\u8981\u770b\u673a\u5668\u914d\u7f6e\uff0cMySQL Server\u914d\u7f6e\u5dee\u4e86\uff0csql\u5199\u5f97\u518d\u597d\uff0c\u6548\u7387\u4e5f\u4e0d\u4f1a\u592a\u9ad8\uff1b\n\n-- 3\u3001\u53e6\u5916\u6279\u91cf\u8fd9\u4e2a\u8bcd\uff0c\u662f\u6307\u4e00\u6b21\u63d2\u5165\u591a\u6761\u6570\u636e\uff0c\u6211\u4eec\u9664\u4e86\u8981\u6ce8\u610f\u6570\u636e\u7684\u6761\u6570\uff0c\u8fd8\u8981\u6ce8\u610f\u4e00\u6761\u6570\u636e\u7684\u5927\u5c0f\uff0c\u4e3e\u4e2a\u4f8b\u5b50\uff1a\u6bd4\u5982\u4e00\u6761\u8bb0\u5f55\u7684\u6570\u636e\u91cf\u67091M\uff0c10\u6761\u8bb0\u5f55\u7684\u6570\u636e\u91cf\u5c3110M\uff0c\u8fd9\u65f6\u4e00\u6b21\u63d2100\u6761\uff0c100M\u6570\u636e\uff0c\u563f\u563f\uff0c\u4f60\u8bd5\u8bd5\u770b\uff01\uff01\u6240\u4ee5\uff0c\u4e00\u6b21\u63d2\u5165\u591a\u5c11\u6570\u636e\uff0c\u4e00\u5b9a\u8981\u7ecf\u8fc7\u591a\u6b21\u6d4b\u8bd5\u540e\u518d\u51b3\u5b9a\uff0c\u522b\u4eba1\u6b21\u63d2100\u6761\u6700\u4f18\uff0c\u4f60\u53ef\u80fd1\u6b21\u63d210\u6761\u624d\u6700\u4f18\uff0c\u6ca1\u6709\u7edd\u5bf9\u7684\u6700\u4f18\u503c\uff08\u6279\u91cf\u63d2\u5165\u672a\u5fc5\u603b\u662f\u6bd4\u5355\u6761\u63d2\u5165\u6548\u7387\u9ad8\uff09\u3002\n\n-- 4\u3001\u6570\u636e\u5e93\u6709\u4e2a\u53c2\u6570\uff0cmax_allowed_packet\uff0c\u4e5f\u5c31\u662f\u6bcf\u4e00\u4e2a\u5305\uff08sql\uff09\u547d\u4ee4\u5927\u5c0f\uff0c\u9ed8\u8ba4\u662f1M\uff0c\u90a3\u4e48sql\u7684\u957f\u5ea6\u5927\u4e8e1M\u5c31\u4f1a\u62a5\u9519\u3002\u4f60\u53ef\u80fd\u4f1a\u8bf4\uff0c\u54b1\u4eec\u628a\u8fd9\u4e2a\u53c2\u6570\u8bbe\u621010M\uff0c100M\u4e0d\u5c31\u884c\u4e86\uff1f\uff1f\uff1f\u5bf9\u5440\uff0c\u6ca1\u6bdb\u75c5\uff0c\u4f46\u4f60\u662fDBA\u5417\uff1f\u4f60\u6709\u6743\u9650\u5417\uff1f\u5373\u4f7f\u8c03\u5927\u8fd9\u4e00\u4e2a\u53c2\u6570\uff0c\u4f60\u8981\u77e5\u9053\u5f71\u54cd\u7684\u53ef\u4e0d\u6b62\u4f60\u8fd9\u4e00\u5f20\u8868\uff0c\u800c\u662f\u6574\u4e2aDB Server\uff0c\u90a3\u5f71\u54cd\u7684\u53ef\u662f\u5f88\u591a\u5e93\uff0c\u5f88\u591a\u8868\u3002\n\n-- 5\u3001\u6279\u91cf\u63d2\u5165\u5e76\u4e0d\u662f\u8d8a\u5feb\u8d8a\u597d\uff0c\u6211\u4eec\u53ef\u80fd\u5e0c\u671b\u8d8a\u5feb\u8d8a\u597d\uff0c\u8fd9\u5f88\u6b63\u5e38\uff0c\u8282\u7701\u65f6\u95f4\u561b\u3002\u4f46\u662f\u6211\u4eec\u4e00\u5b9a\u8981\u77e5\u9053\uff0c\u6570\u636e\u5e93\u5206\u8bfb\u5199\uff0c\u6709\u96c6\u7fa4\uff0c\u8fd9\u5c31\u610f\u5473\u7740\uff0c\u9700\u8981\u540c\u6b65\uff01\uff01\uff01\u5982\u679c\u6709\u5206\u5e93\u5206\u8868\u5206\u533a\u7684\u60c5\u51b5\uff0c\u5982\u679c\u77ed\u65f6\u95f4\u5185\u63d2\u5165\u7684\u6570\u636e\u91cf\u592a\u5927\uff0c\u6570\u636e\u5e93\u540c\u6b65\u53ef\u80fd\u5c31\u4f1a\u6bd4\u8f83\u8ff7\u4e86\uff0c\u8bfb\u5199\u6570\u636e\u4e0d\u4e00\u81f4\u7684\u60c5\u51b5\u5728\u6240\u96be\u514d\u4e86\uff0c\u53ef\u80fd\u4f1a\u56e0\u4e3a\u4e00\u5f20\u8868\u7684\u6279\u91cf\u63d2\u5165\uff0c\u5f71\u54cd\u6574\u4e2aDB\u670d\u52a1\u7ec4\u7684\u540c\u6b65\uff0c\u540c\u65f6\u8fd8\u8981\u8003\u8651\u5e76\u53d1\u95ee\u9898\u3002\n\n--\u5982\u679c\u4f7f\u7528 Oracle \u6570\u636e\u5e93\uff0c\u6211\u4eec\u9700\u8981\u5728\u6267\u884c INSERT \u8bed\u53e5\u4e4b\u540e\u4f7f\u7528 COMMIT \u8bed\u53e5\u63d0\u4ea4\u4fee\u6539\u3000\n</code></pre> <pre><code>-- REPLACE INSERT\u8bed\u53e5\n\n-- REPLACE INTO\u662fINSERT INTO\u7684\u52a0\u5f3a\u7248\uff0c\u65e2\u53ef\u4ee5\u66f4\u65b0\u6570\u636e\u4e5f\u53ef\u4ee5\u63d2\u5165\u6570\u636e\uff1b\n-- \u5728\u5411\u8868\u4e2d\u63d2\u5165\u6570\u636e\u7684\u65f6\u5019\uff0c\u7ecf\u5e38\u9047\u5230\u8fd9\u6837\u7684\u60c5\u51b5\uff1a1. \u9996\u5148\u5224\u65ad\u6570\u636e\u662f\u5426\u5b58\u5728\uff1b 2. \u5982\u679c\u4e0d\u5b58\u5728\uff0c\u5219\u63d2\u5165\uff1b3.\u5982\u679c\u5b58\u5728\uff0c\u5219\u66f4\u65b0\u3002\n\n-- REPLACE INTO\u7528\u4e8e\u5b9e\u65f6\u8986\u76d6\u5199\u5165\u6570\u636e\u3002\u5199\u5165\u6570\u636e\u65f6\uff0c\u4f1a\u5148\u6839\u636e\u4e3b\u952e\u5224\u65ad\u5f85\u5199\u5165\u7684\u6570\u636e\u662f\u5426\u5df2\u7ecf\u5b58\u5728\u4e8e\u8868\u4e2d\uff0c\u5e76\u6839\u636e\u5224\u65ad\u7ed3\u679c\u9009\u62e9\u4e0d\u540c\u7684\u65b9\u5f0f\u5199\u5165\u6570\u636e\uff1a\n\n-- \u4f7f\u7528REPLACE INTO\u65f6\uff0c\u9996\u5148\u4f1a\u6839\u636e\u4e3b\u952e\u6216\u8005\u552f\u4e00\u7d22\u5f15\u67e5\u770b\u8868\u4e2d\u662f\u5426\u6709\u8be5\u6761\u8bb0\u5f55\uff0c\u6709\u7684\u8bdd\u5219\u5148\u5220\u9664\uff0c\u7136\u540e\u63d2\u5165\u6570\u636e\uff1b\u6ca1\u6709\u8be5\u8bb0\u5f55\u5219\u76f4\u63a5\u63d2\u5165\u3002\n\nCREATE TABLE `stu` (\n  `id` int(11) NOT NULL AUTO_INCREMENT,\n  `cid` int(11) NOT NULL,\n  `name` varchar(32) DEFAULT NULL,\n  PRIMARY KEY (`id`),\n  UNIQUE KEY `cid` (`cid`)\n) ENGINE=InnoDB  DEFAULT CHARSET=utf8;\n-- \u5176\u4e2did\u4e3a\u81ea\u589e\u4e3b\u952e\uff0ccid\u4e3a\u552f\u4e00\u7d22\u5f15\u3002\n\n-- \u63d2\u5165\u4e24\u6761\u6570\u636e\nINSERT INTO stu(cid, name) VALUES(1, '1111');\nINSERT INTO stu(cid, name) VALUES(2, '2222');\nREPLACE INTO stu(cid, name) VALUES(3,'3333');\n\n\n-- 1    1   1111\n-- 2    2   2222\n-- 3    3   3333\n\n\nREPLACE INTO stu(cid, name) VALUES(3,'33331');\n-- \u4f7f\u7528REPLACE INTO\u65f6\uff0c\u9996\u5148\u4f1a\u6839\u636e\u4e3b\u952e\u6216\u8005\u552f\u4e00\u7d22\u5f15\u67e5\u770b\u8868\u4e2d\u662f\u5426\u6709\u8be5\u6761\u8bb0\u5f55\uff0c\u6709\u7684\u8bdd\u5219\u5148\u5220\u9664\uff0c\u7136\u540e\u63d2\u5165\u6570\u636e\uff1b\u6ca1\u6709\u8be5\u8bb0\u5f55\u5219\u76f4\u63a5\u63d2\u5165\u3002\n-- \u539f\u5148id\u4e3a3\u7684\u8bb0\u5f55\u53d8\u6210\u4e86id\u4e3a4\u4e86\uff0c\u8bf4\u660e\u539f\u5148id\u4e3a3\u7684\u8bb0\u5f55\u5148\u5220\u9664\u4e86\uff0c\u7136\u540e\u65b0\u63d2\u5165\u4e86id\u4e3a4\uff08id\u81ea\u589e\uff09\u7684\u65b0\u8bb0\u5f55\n\n-- 1    1   1111\n-- 2    2   2222\n-- 4    3   33331\n\n\n--\u518d\u6b21\u6267\u884creplace\uff0cid\u4e3a4\u548ccid\u4e3a2\u7684\u539f\u8bb0\u5f55\u90fd\u5b58\u5728\uff0c\u5219\u88ab\u5220\u9664\u3002\u7136\u540e\u518d\u63d2\u5165\u8fd9\u6761\u65b0\u7eaa\u5f55\nREPLACE INTO stu(id, cid, name) VALUES(4, 2,'42')\n&gt; Affected rows: 3\n&gt; \u67e5\u8be2\u65f6\u95f4: 0.007s\n-- 1    1   1111\n-- 4    2   42\n</code></pre> <pre><code>-- INSERT INTO\u2026SELECT\u2026FROM \u8bed\u53e5\u7528\u4e8e\u5feb\u901f\u5730\u4ece\u4e00\u4e2a\u6216\u591a\u4e2a\u8868\u4e2d\u53d6\u51fa\u6570\u636e\uff0c\u5e76\u5c06\u8fd9\u4e9b\u6570\u636e\u4f5c\u4e3a\u884c\u6570\u636e\u63d2\u5165\u53e6\u4e00\u4e2a\u8868\u4e2d\u3002\n-- SELECT \u5b50\u53e5\u8fd4\u56de\u7684\u662f\u4e00\u4e2a\u67e5\u8be2\u5230\u7684\u7ed3\u679c\u96c6\uff0cINSERT \u8bed\u53e5\u5c06\u8fd9\u4e2a\u7ed3\u679c\u96c6\u63d2\u5165\u6307\u5b9a\u8868\u4e2d\uff0c\u7ed3\u679c\u96c6\u4e2d\u7684\u6bcf\u884c\u6570\u636e\u7684\u5b57\u6bb5\u6570\u3001\u5b57\u6bb5\u7684\u6570\u636e\u7c7b\u578b\u90fd\u5fc5\u987b\u4e0e\u88ab\u64cd\u4f5c\u7684\u8868\u5b8c\u5168\u4e00\u81f4\u3002\n</code></pre> <p>\u6570\u636e\u5e93\u5728\u63d2\u5165\u3001\u66f4\u65b0\u6216\u8005\u5220\u9664\u6570\u636e\u4e4b\u524d\u4f1a\u6267\u884c\u6570\u636e\u7684\u5b8c\u6574\u6027\u68c0\u67e5\u3002\u5982\u679c\u8fdd\u53cd\u7ea6\u675f\uff0c\u5c06\u4f1a\u8fd4\u56de\u9519\u8bef\u4fe1\u606f\uff0c\u800c\u4e0d\u4f1a\u4fee\u6539\u6570\u636e\u3002</p> <p>\u5982\u679c\u6211\u4eec\u5728\u5b9a\u4e49\u8868\u7684\u5b57\u6bb5\u65f6\u6307\u5b9a\u4e86\u9ed8\u8ba4\u503c\uff0c\u4e5f\u53ef\u4ee5\u4f7f\u7528 DEFAULT \u63d2\u5165\u9ed8\u8ba4\u503c</p>"},{"location":"basic/4.sql/#_8","title":"\u6570\u636e\u66f4\u65b0","text":"<p>SQL \u6807\u51c6\u4f7f\u7528 UPDATE \u8bed\u53e5\u66f4\u65b0\u8868\u4e2d\u7684\u6570\u636e\u3002</p> <pre><code>-- UPDATE \u8bed\u53e5\u7684\u57fa\u672c\u8bed\u6cd5\u5982\u4e0b\nUPDATE t\nSET col1 = expr1,\n    col2 = expr2,\n    ...\n    [WHERE condition];\n\n-- \u5176\u4e2d t \u662f\u66f4\u65b0\u64cd\u4f5c\u7684\u76ee\u6807\u8868\uff0cSET \u5b50\u53e5\u6307\u5b9a\u4e86\u9700\u8981\u66f4\u65b0\u7684\u5217\u548c\u66f4\u65b0\u540e\u7684\u503c\uff0c\u591a\u4e2a\u5b57\u6bb5\u4f7f\u7528\u9017\u53f7\u8fdb\u884c\u5206\u9694\u3002\n-- \u5982\u679c\u6307\u5b9a\u4e86 WHERE \u5b50\u53e5\uff0c\u53ea\u6709\u6ee1\u8db3\u6761\u4ef6\u7684\u6570\u636e\u884c\u624d\u4f1a\u88ab\u66f4\u65b0\u3002\u5982\u679c\u6ca1\u6709\u6307\u5b9a\u6761\u4ef6\uff0c\u5c06\u4f1a\u66f4\u65b0\u8868\u4e2d\u7684\u6240\u6709\u6570\u636e\u884c\n\n-- \u66f4\u65b0\u8d75\u4e91\u7684\u6708\u85aa\u548c\u5956\u91d1\nUPDATE emp_devp\nSET salary = salary + 1000,\n    bonus = 8000\nWHERE emp_name = '\u8d75\u4e91';\n</code></pre> <p>MySQL \u6570\u636e\u5e93\u4e2d UPDATE \u8bed\u53e5\u548c SQL \u6807\u51c6\uff08\u4ee5\u53ca\u5176\u4ed6\u6570\u636e\u5e93\uff09\u5b9e\u73b0\u4e0a\u7684\u4e00\u4e2a\u5dee\u5f02\u3002\u5982\u679c\u6211\u4eec\u6ca1\u6709\u6ce8\u610f\u5230\u8fd9\u4e2a\u95ee\u9898\uff0c\u5f88\u53ef\u80fd\u4f1a\u5bfc\u81f4\u610f\u6599\u4e4b\u5916\u7684\u7ed3\u679c\u3002</p> <pre><code>CREATE TABLE t1(\n id int,\n col1 int,\n col2 int\n);\n\nINSERT INTO t1 VALUES (1, 1, 1);\n\nSELECT * FROM t1;\nid|col1|col2|\n--|----|----|\n1|   1|   1|\n\n\n\nUPDATE t1\nSET col1 = col1 + 1,\n   col2 = col1\nWHERE id = 1;\n\nSELECT col1, col2\nFROM t1;\n</code></pre> <p>\u5bf9\u4e8e SQL \u6807\u51c6\u4ee5\u53ca\u5176\u4ed6\u6570\u636e\u5e93\u7684\u5b9e\u73b0\uff0c\u7ed3\u679c\u5206\u522b\u4e3a \u00a02\u00a0 \u548c \u00a01\u3002\u4f46\u662f\u5bf9\u4e8e MySQL\uff0c\u7ed3\u679c\u5206\u522b\u4e3a \u00a02\u00a0 \u548c \u00a02</p> <p>\u5bf9\u4e8e MySQL \u800c\u8a00\uff0c\u5982\u679c UPDATE \u8bed\u53e5\u5728\u8868\u8fbe\u5f0f\u4e2d\uff08col2 = col1\uff09\u4f7f\u7528\u4e86\u524d\u9762\u88ab\u66f4\u65b0\u7684\u5b57\u6bb5\uff08col1\uff09\uff0c\u5c06\u4f1a\u4f7f\u7528\u8be5\u5b57\u6bb5\u88ab\u66f4\u65b0\u540e\u7684\u503c\uff082\uff09\u800c\u4e0d\u662f\u539f\u6765\u7684\u503c\uff081\uff09\u3002</p> <p>\u4e00\u822c\u5728\u7f16\u5199 UPDATE \u8bed\u53e5\u65f6\uff0c\u6211\u4eec\u4e0d\u9700\u8981\u5173\u5fc3\u591a\u4e2a\u5b57\u6bb5\u7684\u66f4\u65b0\u987a\u5e8f\u3002\u4f46\u662f\u7531\u4e8e MySQL \u5b9e\u73b0\u7684\u95ee\u9898\uff0c\u6211\u4eec\u9700\u8981\u6ce8\u610f\u5b83\u4eec\u7684\u8bed\u6cd5\u987a\u5e8f\u3002</p>"},{"location":"basic/4.sql/#_9","title":"\u5173\u8054\u66f4\u65b0","text":"<p>\u6709\u65f6\u5019\u6211\u4eec\u9700\u8981\u7528 b \u8868\u53bb\u66f4\u65b0 a \u8868\u7684\u8bb0\u5f55\uff0c\u5982\u679c\u53ea\u6709\u4e00\u4e2a\u5b57\u6bb5\u90a3\u901a\u5e38\u6211\u4eec\u53ef\u80fd\u5c31<code>update set a.xxx=(select b.xxx from b where a.ib.id)</code>\uff0c\u4f46\u662f\u5b57\u6bb5\u4e00\u591a\uff0c\u663e\u5f97\u5c31\u4e0d\u662f\u7279\u522b\u65b9\u4fbf\u4e86\uff0c\u52a0\u4e0a\u4e0d\u597d\u505a\u9650\u5236\uff0c\u6240\u4ee5\u5c31\u4e86<code>update join</code></p> <pre><code>-- \u4e3b\u8868\nCREATE TABLE `unit` (\n  `unit_id` int(11) NOT NULL AUTO_INCREMENT,\n  `price` decimal(10,2) DEFAULT NULL COMMENT '\u4ef7\u683c\u6307\u6570',\n  `fix_flag` tinyint(1) DEFAULT '0' COMMENT '\u4fee\u590d\u6807\u8bb0'\n) ;\n\n-- \u4fee\u590d\u8868/\u5173\u8054\u66f4\u65b0\u8868\nCREATE TABLE `unit_fix` (\n  `unit_id` int(11) DEFAULT NOT NULL,\n  `price` decimal(10,2) DEFAULT NULL COMMENT '\u4ef7\u683c\u6307\u6570'\n) ;\n\n\n-- \u66f4\u65b0\nUPDATE unit u\nSET u.bid_unit =( SELECT x.price FROM unit_fix x WHERE x.unit_id = u.unit_id ),\n    u.fix_flag = 1\nWHERE\n    u.unit_id IN ( SELECT xx.unit_id FROM unit_fix xx );\n\n\n-- \u5173\u8054\u66f4\u65b0\nUPDATE unit u\nJOIN unit_fix uf ON u.unit_id = uf.unit_id\nSET u.price = uf.price,\n    u.fix_flag = 1\nWHERE\n    uf.tender_id IS NOT NULL;\n\n\n-- \u5199\u6cd5\u4e00\nUPDATE Tab1, Tab2,\nSET Tab1.C2 = Tab2.C2, Tab2.C3 = expression\nWHERE Tab1.C1 = Tab2.C1 AND condition;\n\n-- \u5199\u6cd5\u4e8c\nUPDATE T1,T2\nINNER JOIN T2 ON T1.C1 = T2.C1\nSET T1.C2 = T2.C2,\n      T2.C3 = expression\nWHERE condition\n</code></pre>"},{"location":"basic/4.sql/#_10","title":"\u6570\u636e\u5220\u9664","text":"<p>SQL \u6807\u51c6\u4f7f\u7528 DELETE \u8bed\u53e5\u5220\u9664\u8868\u4e2d\u7684\u6570\u636e\u3002</p> <pre><code>DELETE FROM t\n    [WHERE conditions];\n\n-- \u5176\u4e2d t \u662f\u5220\u9664\u64cd\u4f5c\u7684\u76ee\u6807\u8868\u3002\n-- \u5982\u679c\u6307\u5b9a\u4e86 WHERE \u5b50\u53e5\uff0c\u53ea\u6709\u6ee1\u8db3\u6761\u4ef6\u7684\u6570\u636e\u884c\u624d\u4f1a\u88ab\u5220\u9664\u3002\u5982\u679c\u6ca1\u6709\u6307\u5b9a\u6761\u4ef6\uff0c\u5c06\u4f1a\u5220\u9664\u8868\u4e2d\u6240\u6709\u7684\u6570\u636e\u884c\u3002\n\n\n-- leetcode. 196. Delete Duplicate Emails \u5220\u9664\u8868\u4e2d\u91cd\u590d\u7684\u6570\u636e\n\n-- Person\u8868\u4e2d\u6709ID\uff08\u4e3b\u952e\uff09\u548cEMAIL\u4e24\u5217\uff0c\u5220\u9664email\u91cd\u590d\u7684\u884c\uff0c\u4ec5\u4fdd\u7559id\u6700\u5c0f\u7684\u90a3\u4e00\u884c\nDELETE p from Person p, Person q where p.Id&gt;q.Id AND q.Email=p.Email\n\nDELETE FROM Person\nWHERE Id NOT IN (\n    SELECT Id FROM (\n        SELECT MIN(Id) AS Id\n        FROM Person\n        GROUP BY Email\n    ) AS min_id  -- \u6b64\u5904\u9700\u4f7f\u7528\u522b\u540d\uff0c\u5426\u5219\u4f1a\u53d1\u751f\u62a5\u9519\n);\n</code></pre> <p>\u5982\u679c\u6211\u4eec\u60f3\u8981\u5220\u9664\u8868\u4e2d\u7684\u5168\u90e8\u6570\u636e\uff0c\u6570\u636e\u91cf\u6bd4\u8f83\u5c11\u65f6\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528 DELETE \u8bed\u53e5\uff0c\u4f46\u662f\u8fd9\u79cd\u65b9\u5f0f\u5bf9\u4e8e\u6570\u636e\u91cf\u5f88\u5927\u7684\u8868\u6240\u9700\u7684\u65f6\u95f4\u6bd4\u8f83\u957f\u3002</p> <p>\u6b64\u65f6\uff0c\u6211\u4eec\u53ef\u4ee5\u8003\u8651\u4f7f\u7528\u5feb\u901f\u5220\u9664\u5168\u8868\u6570\u636e\u7684 TRUNCATE \u8bed\u53e5\u3002\u4e5f\u79f0\u4e3a\u622a\u65ad\u8868</p> <pre><code>-- Oracle\u3001MySQL\u3001Microsoft SQL Server\u4ee5\u53caPostgreSQL\nTRUNCATE TABLE emp_devp;\n\n-- SQLite \u6ca1\u6709\u63d0\u4f9b TRUNCATE \u8bed\u53e5\uff0c\u4e0d\u8fc7\u5b83\u5bf9 DELETE \u8bed\u53e5\u8fdb\u884c\u4e86\u4f18\u5316\uff0c\u5982\u679c\u6211\u4eec\u4e0d\u6307\u5b9a WHERE \u5b50\u53e5\uff0c\u5b9e\u9645\u7684\u6548\u679c\u7b49\u540c\u4e8e TRUNCATE \u8bed\u53e5\u3002\n</code></pre> <p>DELETE \u548c TRUNCATE \u8bed\u53e5\u90fd\u53ef\u4ee5\u7528\u4e8e\u5220\u9664\u6570\u636e\uff0c\u4f46\u662f\u8fd9\u4e24\u79cd\u5220\u9664\u65b9\u5f0f\u5b58\u5728\u4e00\u4e9b\u533a\u522b\uff1a</p> <ul> <li> <p>DELETE \u8bed\u53e5\u901a\u8fc7 WHERE \u5b50\u53e5\u5220\u9664\u6307\u5b9a\u7684\u6570\u636e\u884c\uff0c\u5982\u679c\u4e0d\u6307\u5b9a\u8fc7\u6ee4\u6761\u4ef6\u5c06\u4f1a\u5220\u9664\u6240\u6709\u7684\u6570\u636e\u3002DELETE \u5c5e\u4e8e\u6570\u636e\u64cd\u4f5c\u8bed\u8a00\uff08DML\uff09\uff0c\u5220\u9664\u6570\u636e\u540e\u53ef\u4ee5\u9009\u62e9\u63d0\u4ea4\u6216\u8005\u56de\u6eda\uff0c\u5982\u679c\u5220\u9664\u7684\u6570\u636e\u8f83\u591a\u65f6\u901f\u5ea6\u6bd4\u8f83\u6162\u3002</p> </li> <li> <p>TRUNCATE \u8bed\u53e5\u7528\u4e8e\u5feb\u901f\u5220\u9664\u8868\u4e2d\u7684\u6240\u6709\u6570\u636e\uff0c\u5e76\u4e14\u91ca\u653e\u8868\u7684\u5b58\u50a8\u7a7a\u95f4\u3002TRUNCATE \u5c5e\u4e8e\u6570\u636e\u5b9a\u4e49\u8bed\u8a00\uff08DDL\uff09\uff0c\u5220\u9664\u6570\u636e\u65f6\u9ed8\u8ba4\u63d0\u4ea4\uff0c\u65e0\u6cd5\u56de\u6eda\u3002TRUNCATE \u8bed\u53e5\u76f8\u5f53\u4e8e\u5220\u9664\u5e76\u91cd\u5efa\u8868\uff0c\u901a\u5e38\u6267\u884c\u901f\u5ea6\u5f88\u5feb\u3002</p> </li> </ul>"},{"location":"basic/4.sql/#_11","title":"\u5408\u5e76\u6570\u636e","text":"<p>SQL \u6807\u51c6\u4e8e 2003 \u5e74\u589e\u52a0\u4e86\u4e00\u4e2a\u65b0\u7684\u6570\u636e\u64cd\u4f5c\u8bed\u53e5\uff1aMERGE\uff08\u5408\u5e76\uff09\uff0c\u5b83\u53ef\u4ee5\u540c\u65f6\u5b8c\u6210 INSERT \u8bed\u53e5\u548c UPDATE \u8bed\u53e5\uff0c\u751a\u81f3 DELETE \u8bed\u53e5\u7684\u64cd\u4f5c\u3002</p> <p>\u5728 Web \u5e94\u7528\u5f00\u53d1\u8fc7\u7a0b\u4e2d\uff0c\u7ecf\u5e38\u6709\u8fd9\u6837\u4e00\u79cd\u6570\u636e\u5904\u7406\u7684\u9700\u6c42\u6a21\u5f0f\u3002\u5c31\u662f\u9700\u8981\u66f4\u65b0\u6570\u636e\uff0c\u4f46\u6709\u53ef\u80fd\u8fd9\u4e2a\u6570\u636e\u73b0\u5728\u5e76\u4e0d\u5b58\u5728\uff0c\u5c31\u9700\u8981\u5148\u521b\u5efa\u8fd9\u4e2a\u8bb0\u5f55\u3002</p> <p>\u5c31\u662f\u6240\u8c13\u7684 <code>UPDATE OR(IF NOT EXIST) INSERT</code> \u6a21\u5f0f\u3002\u4f20\u7edf\u6807\u51c6\u7684 SQL \u53ea\u6709 UPDATE \u548c INSERT \u6a21\u5f0f\uff0c\u8981\u5b9e\u73b0\u8fd9\u6837\u4e00\u4e2a\u4e1a\u52a1\u9700\u6c42\uff0c\u5c31\u9700\u8981\u5148\u505a\u4e00\u4e2a\u5b58\u5728\u6027\u5224\u65ad\uff0c\u7136\u540e\u6765\u51b3\u5b9a\u4f7f\u7528 UPDATE \u6216\u8005 INSERT\uff0c</p> <p>MERGE \u5176\u5b9e\u5c31\u662f\u4e0d\u5b58\u5728\u5219 INSERT\uff0c\u5b58\u5728\u5219 UPDATE\uff0c\u6240\u4ee5\u53ef\u4ee5\u628a\u5b83\u62c6\u5206\u6210\uff1a</p> <pre><code>UPDATE ... WHERE EXIST (SELECT 1 FROM ... WHERE CONDITION)\nINSERT ... WHERE NOT EXIST(SELECT 1 FROM ... WHERE CONDITION)\n</code></pre> <p>MERGE \u8bed\u53e5\u5c1d\u8bd5\u6839\u636e\u952e\u5b57\u6bb5\u5c06\u6e90\u8868\u4e0e\u76ee\u6807\u8868\u8fdb\u884c\u6bd4\u8f83\uff0c\u7136\u540e\u8fdb\u884c\u4e00\u4e9b\u5904\u7406\u3002 MERGE \u8bed\u53e5\u5b9e\u9645\u4e0a\u5c06 <code>INSERT\uff0cUPDATE\uff0cDELETE</code> \u64cd\u4f5c\u5b8c\u5168\u7ed3\u5408\u5728\u4e00\u8d77\u3002\u5c3d\u7ba1 MERGE \u8bed\u53e5\u6bd4\u7b80\u5355\u7684 INSERT \u6216 UPDATE \u7a0d\u5fae\u590d\u6742\u4e00\u70b9\uff0c\u4f46\u662f\u4e00\u65e6\u60a8\u638c\u63e1\u4e86\u57fa\u672c\u6982\u5ff5\uff0c\u5c31\u53ef\u4ee5\u6bd4\u4f7f\u7528\u5355\u4e2a INSERT \u6216 UPDATE \u66f4\u5bb9\u6613\u5730\u66f4\u9891\u7e41\u5730\u4f7f\u7528\u6b64 SQL MERGE\u3002</p> <p>\u5728\u5178\u578b SQL \u6570\u636e\u4ed3\u5e93\u89e3\u51b3\u65b9\u6848\u4e2d\uff0c\u901a\u5e38\u975e\u5e38\u91cd\u8981\u7684\u4e00\u70b9\u662f\u8981\u7ef4\u62a4\u4ed3\u5e93\u4e2d\u7684\u6570\u636e\u5386\u53f2\u8bb0\u5f55\uff0c\u5e76\u53c2\u8003\u8981\u9988\u9001\u5230 ETL \u5de5\u5177\u7684\u6e90\u6570\u636e\u3002</p> <p>\u6700\u5e38\u89c1\u7684\u7528\u4f8b\u662f\u5c1d\u8bd5\u7ef4\u62a4\u6570\u636e\u4ed3\u5e93\u4e2d\u7684\u5c3a\u5bf8\u53d8\u5316\u7f13\u6162\uff08SCD\uff09\u3002</p> <p>\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u60a8\u9700\u8981\u5c06\u65b0\u8bb0\u5f55\u63d2\u5165\u6570\u636e\u4ed3\u5e93\uff0c\u4ece\u4ed3\u5e93\u4e2d\u5220\u9664\u6216\u6807\u8bb0\u4e0d\u518d\u4f4d\u4e8e\u6e90\u4e2d\u7684\u8bb0\u5f55\uff0c\u5e76\u66f4\u65b0\u4ed3\u5e93\u4e2d\u5df2\u5728\u6e90\u4e2d\u66f4\u65b0\u7684\u8bb0\u5f55\u7684\u503c\u3002</p> <p>\u7f13\u6162\u53d8\u5316\u7ef4\u7684\u63d0\u51fa\u662f\u56e0\u4e3a\u5728\u73b0\u5b9e\u4e16\u754c\u4e2d\uff0c\u7ef4\u5ea6\u7684\u5c5e\u6027\u5e76\u4e0d\u662f\u9759\u6001\u7684\uff0c\u5b83\u4f1a\u968f\u7740\u65f6\u95f4\u7684\u6d41\u901d\u53d1\u751f\u7f13\u6162\u7684\u53d8\u5316\uff0c\u4e0e\u6570\u636e\u589e\u957f\u8f83\u4e3a\u5feb\u901f\u7684\u4e8b\u5b9e\u8868\u76f8\u6bd4\uff0c\u7ef4\u5ea6\u53d8\u5316\u76f8\u5bf9\u7f13\u6162\u3002\u56e0\u6b64\u8fd9\u4e2a\u5c31\u53eb\u505a==\u7f13\u6162\u53d8\u5316\u7ef4==\u3002</p> <p>\u8fd9\u610f\u5473\u7740\u73b0\u5728\u60a8\u53ef\u4ee5\u5c06\u6240\u6709 DML \u8bed\u53e5\uff08INSERT\uff0cUPDATE \u548c DELETE\uff09\u7ec4\u5408\u6210\u4e00\u4e2a\u8bed\u53e5\u3002\u4ece\u6570\u636e\u5904\u7406\u7684\u89d2\u5ea6\u6765\u770b\uff0c\u8fd9\u975e\u5e38\u6709\u5e2e\u52a9\uff0c\u56e0\u4e3a\u5b83\u51cf\u5c11\u4e86\u9488\u5bf9\u4e09\u4e2a\u8bed\u53e5\u4e2d\u7684\u6bcf\u4e2a\u8bed\u53e5\u4ece\u78c1\u76d8\u8fdb\u884c\u7684 I/O \u64cd\u4f5c\uff0c\u73b0\u5728\u4ec5\u4ece\u6e90\u8bfb\u53d6\u4e00\u6b21\u6570\u636e\u3002</p> <p>\u540c\u6837\uff0cMERGE \u8bed\u53e5\u7684\u6027\u80fd\u5728\u5f88\u5927\u7a0b\u5ea6\u4e0a\u53d6\u51b3\u4e8e\u7528\u4e8e\u5339\u914d\u6e90\u8868\u548c\u76ee\u6807\u8868\u7684\u9002\u5f53\u7d22\u5f15\u3002</p> <p>\u9664\u7d22\u5f15\u5916\uff0c\u8fd8\u5fc5\u987b\u4f18\u5316\u8fde\u63a5\u6761\u4ef6\u3002 \u6211\u4eec\u8fd8\u5e94\u8be5\u5c1d\u8bd5\u8fc7\u6ee4\u6e90\u8868\uff0c\u4ee5\u4fbf\u8be5\u8bed\u53e5\u4ec5\u83b7\u53d6\u5fc5\u8981\u7684\u8bb0\u5f55\u4ee5\u6267\u884c\u5fc5\u8981\u7684\u64cd\u4f5c\u3002</p> <pre><code>-- Oracle\u3001Microsoft SQL Server \u4ee5\u53ca PostgreSQL\nMEGRE INTO target_table [AS t_alias]\nUSING source_table [AS s_alias]\nON (conditions)\nWHEN MATCHED THEN\n  UPDATE\n  SET col1 = expr1,\n      col2 = expr2,\n      ...\nWHEN NOT MATCHED THEN\n  INSERT (col1, col2, ...)\n  VALUES (expr1, expr2, ...);\n\n-- \u5176\u4e2d target_table \u662f\u5408\u5e76\u64cd\u4f5c\u7684\u76ee\u6807\u8868\u3002\n-- USING \u5b50\u53e5\u6307\u5b9a\u4e86\u6570\u636e\u6e90\uff0c\u53ef\u4ee5\u662f\u4e00\u4e2a\u8868\u6216\u8005\u67e5\u8be2\u8bed\u53e5\u3002\n-- ON \u5b50\u53e5\u6307\u5b9a\u4e86\u6570\u636e\u5408\u5e76\u7684\u6761\u4ef6\uff0c\u901a\u5e38\u4f7f\u7528\u4e3b\u952e\u6216\u8005\u552f\u4e00\u952e\u76f8\u7b49\u4f5c\u4e3a\u5408\u5e76\u7684\u6761\u4ef6\u3002\n\n-- \u5bf9\u4e8e\u6570\u636e\u6e90\u4e2d\u7684\u6bcf\u6761\u8bb0\u5f55:\n-- \u5982\u679c\u76ee\u6807\u8868\u4e2d\u5b58\u5728\u5339\u914d\u7684\u8bb0\u5f55\u5219\u6267\u884c WHEN MATCHED THEN \u5206\u652f\u7684\u66f4\u65b0\u64cd\u4f5c\uff0c.\n-- \u5982\u679c\u76ee\u6807\u8868\u4e2d\u4e0d\u5b58\u5728\u5339\u914d\u7684\u8bb0\u5f55\u5219\u6267\u884c WHEN NOT MATCHED THEN \u5206\u652f\u7684\u63d2\u5165\u64cd\u4f5c\u3002\n</code></pre> <p>MySQL \u548c SQLite \u6ca1\u6709\u63d0\u4f9b\u6807\u51c6 MERGE \u8bed\u53e5\uff0c\u4e0d\u8fc7\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u4e13\u6709\u7684\u8bed\u6cd5\u5b9e\u73b0\u5408\u5e76\u64cd\u4f5c\u3002</p> <pre><code>-- \u5728MySQL\u6570\u636e\u5e93\u4e2d\uff0c\u5982\u679c\u5728INSERT\u8bed\u53e5\u540e\u9762\u5e26\u4e0aON DUPLICATE KEY UPDATE\u5b50\u53e5\uff0c\u800c\u8981\u63d2\u5165\u7684\u884c\u4e0e\u8868\u4e2d\u73b0\u6709\u8bb0\u5f55\u7684\u60df\u4e00\u7d22\u5f15\u6216\u4e3b\u952e\u4e2d\u4ea7\u751f\u91cd\u590d\u503c\uff0c\u90a3\u4e48\u5c31\u4f1a\u53d1\u751f\u65e7\u884c\u7684\u66f4\u65b0\uff1b\u5982\u679c\u63d2\u5165\u7684\u884c\u6570\u636e\u4e0e\u73b0\u6709\u8868\u4e2d\u8bb0\u5f55\u7684\u552f\u4e00\u7d22\u5f15\u6216\u8005\u4e3b\u952e\u4e0d\u91cd\u590d\uff0c\u5219\u6267\u884c\u65b0\u7eaa\u5f55\u63d2\u5165\u64cd\u4f5c\u3002\u53e6\u5916\uff0cON DUPLICATE KEY UPDATE\u4e0d\u80fd\u5199WHERE\u6761\u4ef6\u3002\n\n-- \u5c31\u662f\u4ece\u6e90\u8868\u62bd\u6570\u5230\u76ee\u6807\u8868\uff0c\u5982\u679c\u503c\u5b58\u5728\u5219\u66f4\u65b0\uff0c\u4e0d\u5b58\u5728\u5219\u63d2\u5165\n\n-- MySQL\n-- MySQL\u4f7f\u7528 ON DUPLICATE KEY UPDATE \u5b50\u53e5\u5408\u5e76\u6570\u636e\uff0c\u63d2\u5165\u6570\u636e\u65f6\u5982\u679c\u4e3b\u952e\u6216\u8005\u552f\u4e00\u7d22\u5f15\u51fa\u73b0\u91cd\u590d\u503c\u5219\u6267\u884c\u66f4\u65b0\u64cd\u4f5c\u3002\u8fd9\u79cd\u4e13\u6709\u8bed\u6cd5\u4e0d\u652f\u6301 DELETE \u5b50\u53e5\u3002\nINSERT INTO emp_devp(emp_id, emp_name, sex, dept_id, manager,hire_date, job_id, salary, bonus, email)\nSELECT emp_id, emp_name, sex, dept_id, manager,hire_date, job_id, salary, bonus, email\nFROM employee s\nWHERE dept_id = 4\nON DUPLICATE KEY UPDATE\n   emp_name = s.emp_name, sex = s.sex,\n   dept_id = s.dept_id, manager = s.manager,\n   hire_date = s.hire_date, job_id = s.job_id,\n   salary = s.salary, bonus = s.bonus,\n   email = s.email;\n\n-- PostgreSQL\u548cSQLite\n-- PostgreSQL \u548c SQLite \u4f7f\u7528 ON CONFLICT(emp_id) DO UPDATE \u5b50\u53e5\u5408\u5e76\u6570\u636e\uff0c\u63d2\u5165\u6570\u636e\u65f6\u5982\u679c emp_id \u51fa\u73b0\u91cd\u590d\u503c\u5219\u6267\u884c\u66f4\u65b0\u64cd\u4f5c\uff0cEXCLUDED \u4ee3\u8868\u4e86\u6570\u636e\u6e90\u4e2d\u7684\u8bb0\u5f55\u3002\u8fd9\u79cd\u4e13\u6709\u8bed\u6cd5\u4e0d\u652f\u6301 DELETE \u5b50\u53e5\u3002\nINSERT INTO emp_devp(emp_id, emp_name, sex, dept_id, manager,hire_date, job_id, salary, bonus, email)\nSELECT emp_id, emp_name, sex, dept_id, manager, hire_date, job_id, salary, bonus, email\nFROM employee s\nWHERE dept_id = 4\nON CONFLICT(emp_id) DO UPDATE\nSET emp_name = EXCLUDED.emp_name, sex = EXCLUDED.sex,\n    dept_id = EXCLUDED.dept_id, manager = EXCLUDED.manager,\n    hire_date = EXCLUDED.hire_date, job_id = EXCLUDED.job_id,\n    salary = EXCLUDED.salary, bonus = EXCLUDED.bonus,\n    email = EXCLUDED.email;\n</code></pre>"},{"location":"basic/4.sql/#_12","title":"\u8fd4\u56de\u6570\u636e","text":"<p>MySQL \u5bf9\u4e8e SQL \u8bed\u53e5\u6267\u884c\u7ed3\u679c\u62a5\u6587\u901a\u5e38\u5206\u4e3a\u4e24\u7c7b Resultset \u548c OK/ERR\uff0c\u9488\u5bf9 DML \u8bed\u53e5\u5219\u8fd4\u56de OK/ERR \u62a5\u6587\uff0c\u5176\u4e2d\u5305\u62ec\u51e0\u4e2a\u5f71\u54cd\u8bb0\u5f55\uff0c\u626b\u63cf\u8bb0\u5f55\u7b49\u5c5e\u6027\u3002\u7c7b\u4f3c PostgreSQL/Oracle \u90fd\u63d0\u4f9b\u4e86<code>returning clause</code>\u652f\u6301 DML(INSERT/UPDATE/DELETE) \u540e\u8ddf <code>RETURNING</code> \u5b50\u53e5\u8fd4\u56de Resultset\u3002</p> <p>\u5728\u67d0\u4e9b\u4f7f\u7528\u573a\u666f\u4e0b\uff0c\u9700\u8981\u5728<code>DML</code>\u64cd\u4f5c\u540e\u8fd4\u56de\u521a\u64cd\u4f5c\u7684\u6570\u636e\u884c\u3002\u5b9e\u73b0\u8fd9\u4e2a\u9700\u6c42\u4e00\u822c\u6709\u4e24\u79cd\u529e\u6cd5\uff1a</p> <ul> <li> <p>\u4e00\u662f\u5728\u5f00\u542f\u4e8b\u52a1\u540e\u5728<code>DML</code>\u8bed\u53e5\u540e\u7d27\u8ddf\u4e00\u6761 SELECT \u8bed\u53e5\u3002</p> </li> <li> <p>\u4e8c\u662f\u4f7f\u7528\u89e6\u53d1\u5668\u7b49\u8f83\u4e3a\u590d\u6742\u7684\u64cd\u4f5c\u5b9e\u73b0\u3002</p> </li> </ul> <p>\u524d\u8005\u4e3b\u8981\u4f1a\u589e\u52a0\u4e00\u6761 SELECT \u8bed\u53e5\u7684\u5f00\u9500\uff0c\u540e\u8005\u5219\u4f1a\u4ee4 SQL \u7684\u5b9e\u73b0\u53d8\u5f97\u66f4\u52a0\u590d\u6742\u5e76\u4e14\u4e0d\u591f\u7075\u6d3b\uff08\u9700\u8981\u521b\u5efa\u89e6\u53d1\u5668\uff09\u3002 \u56e0\u6b64\uff0cRETURNING \u8bed\u6cd5\u7684\u8bbe\u8ba1\u4e3b\u8981\u9488\u5bf9\u8be5\u573a\u666f\u7684\u4f18\u5316\uff0c\u901a\u8fc7\u5728 DML \u8bed\u53e5\u540e\u589e\u52a0 RETURNING \u5173\u952e\u5b57\u53ef\u4ee5\u7075\u6d3b\u9ad8\u6548\u5730\u5b9e\u73b0\u4e0a\u8ff0\u7684\u9700\u6c42\u3002</p> <pre><code>--PostgreSQL\nCREATE TABLE users (firstname text, lastname text, id serial primary key);\n\nINSERT INTO users (firstname, lastname) VALUES ('Joe', 'Cool') RETURNING id;\n\n\nUPDATE products SET price = price * 1.10\n  WHERE price &lt;= 99.99\n  RETURNING name, price AS new_price;\n\nDELETE FROM products\n  WHERE obsoletion_date = 'today'\n  RETURNING *;\n</code></pre> <p>\u4f7f\u7528 RETURNING \u53ef\u4ee5\u907f\u514d\u6267\u884c\u989d\u5916\u7684\u6570\u636e\u5e93\u67e5\u8be2\u6765\u6536\u96c6\u6570\u636e\uff0c\u5e76\u4e14\u5728\u5426\u5219\u96be\u4ee5\u53ef\u9760\u5730\u8bc6\u522b\u4fee\u6539\u7684\u884c\u65f6\u5c24\u5176\u6709\u7528\u3002</p> <pre><code>CREATE TABLE users (\n    firstname text,\n    lastname text,\n    id serial primary key\n);\n\n-- \u5728INSERT INTO\u6216\u8005UPDATE\u7684\u65f6\u5019\u5728\u6700\u540e\u9762\u52a0\u4e0aRETURNING colname\uff0cPostgreSQL\u4f1a\u5728\u63d2\u5165\u6216\u8005\u66f4\u65b0\u6570\u636e\u4e4b\u540e\u4f1a\u8fd4\u56de\u4f60\u6307\u5b9a\u7684\u5b57\u6bb5\u3002\n-- \u5f53\u4f7f\u7528 serial\u5217\u6765\u63d0\u4f9b\u552f\u4e00\u6807\u8bc6\u7b26\u65f6\uff0c RETURNING\u53ef\u4ee5\u8fd4\u56de\u5206\u914d\u7ed9\u65b0\u884c\u7684ID\uff1a\nINSERT INTO users (firstname, lastname) VALUES ('Joe', 'Cool') RETURNING id;\n</code></pre>"},{"location":"basic/4.sql/#_13","title":"\u5916\u952e\u7ea6\u675f\u4e0e\u7ea7\u8054\u64cd\u4f5c","text":"<p>\u5982\u679c DML \u8bed\u53e5\u8fdd\u53cd\u4e86\u5916\u952e\u7ea6\u675f\uff0c\u6570\u636e\u5e93\u4f1a\u8fd4\u56de\u9519\u8bef\u5e76\u53d6\u6d88\u6570\u636e\u64cd\u4f5c\u3002\u4f8b\u5982\uff1a</p> <pre><code>-- \u8fdd\u53cd\u5916\u952e\u7ea6\u675f\uff0c\u804c\u4f4d\u4e0d\u5b58\u5728\nINSERT INTO employee (emp_name, sex, dept_id, manager, hire_date,\n                      job_id, salary, bonus, email, comments,\n                      create_by, create_ts, update_by, update_ts)\nVALUES ('\u9a6c\u8d85', '\u7537', 5, 18, CURRENT_DATE, -- Microsoft SQL Server \u9700\u8981\u66ff\u6362\u8be5\u51fd\u6570\n        11, 6000, NULL, 'machao@shuguo.com', NULL,\n        'Admin', CURRENT_TIMESTAMP, NULL, NULL);\n</code></pre> <p>\u4ee5\u4e0a\u8bed\u53e5\u5728\u63d2\u5165\u6570\u636e\u65f6\u8fdd\u53cd\u4e86\u5916\u952e\u7ea6\u675f\uff0c\u56e0\u4e3a job_id=11 \u7684\u8bb0\u5f55\u5728 job \u8868\u4e2d\u4e0d\u5b58\u5728\uff0c\u6211\u4eec\u4e0d\u80fd\u7ed9\u5458\u5de5\u5206\u914d\u4e00\u4e2a\u4e0d\u5b58\u5728\u7684\u804c\u4f4d\u3002</p>"},{"location":"basic/4.sql/#_14","title":"\u67e5\u8be2\u57fa\u7840","text":"<p>\u4ece\u8868\u4e2d\u9009\u53d6\u7b5b\u9009\u6570\u636e\uff0c\u9700\u8981\u4f7f\u7528 SELECT \u8bed\u53e5\uff0c\u4e5f\u5c31\u662f\u7528\u8868\u4e2d\u9009\u51fa SELECT \u5fc5\u8981\u6570\u636e\u7684\u610f\u601d\u3002\u901a\u8fc7 SELECT \u8bed\u53e5\u67e5\u8be2\u5e76\u9009\u53d6\u5fc5\u8981\u6570\u636e\u7684\u8fc7\u7a0b\u79f0\u4e3a\u67e5\u8be2\uff08query\uff09</p> <pre><code>-- \u67e5\u8be2\u8bed\u53e5\u7684\u57fa\u672c\u7ed3\u6784\n\nselect A1,A2,A3 ... An\nfrom r1,r2,r3 ... rn\nwhere P\n\n-- \u6ce8\u610f\uff1a\u8fd9\u4e2a\u65b9\u6cd5\u53ea\u662f\u7528\u6765\u7406\u89e3SQL\u8bed\u53e5\u7684\u67e5\u8be2\u7ed3\u679c\n-- from \u591a\u4e2a\u5173\u7cfb\u540e\uff0c\u53ef\u4ee5\u7406\u89e3\u4e3a\u6240\u6709\u5173\u7cfb\u7684\u7b1b\u5361\u5c14\u79ef\n-- \u8c13\u8bcdP\u5bf9\u5173\u7cfb\u8fdb\u884c\u8fc7\u6ee4\n-- \u518d\u4ece select \u4e2d\u63d0\u53d6\u9700\u8981\u7684\u5217\n-- \u5b9e\u9645\u4e0a\uff0c\u7ec4\u6210\u7b1b\u5361\u5c14\u79ef\u7684\u65f6\u5019\uff0c\u4f1a\u5c3d\u53ef\u80fd\u5148\u6267\u884c\u8c13\u8bcd\u8fc7\u6ee4\u4e00\u4e9b\u6570\u636e\u540e\uff0c\u518d\u8fdb\u884c\u7b1b\u5361\u5c14\u79ef\n</code></pre>"},{"location":"basic/4.sql/#sql_5","title":"SQL \u67e5\u8be2\u8bed\u53e5\u7684\u6267\u884c\u8fc7\u7a0b","text":"<p>\u5728\u7f16\u5199\u4e86\u5927\u91cf SQL \u811a\u672c\u4e4b\u540e\uff0c\u60a8\u53ef\u80fd\u4f1a\u5728\u6027\u80fd\u65b9\u9762\u8fbe\u5230\u67d0\u79cd\u5f62\u5f0f\u7684\u5e73\u53f0\u671f\u3002\u60a8\u4f7f\u7528\u76f8\u540c\u7684\u7b56\u7565\u63d0\u53d6\u89c1\u89e3\u5e76\u9047\u5230\u76f8\u540c\u7c7b\u578b\u7684\u9519\u8bef\u3002</p> <p>\u5e78\u8fd0\u7684\u662f\uff0c\u60a8\u53ef\u4ee5\u901a\u8fc7\u82b1\u65f6\u95f4\u4e86\u89e3\u5982\u4f55\u8bc4\u4f30 SQL \u4e2d\u7684\u5b50\u53e5\u6765\u6539\u5584\u7f16\u5199\u67e5\u8be2\u7684\u4f53\u9a8c\u3002\u5728\u8fd9\u91cc\uff0c\u6211\u4eec\u8ba8\u8bba SQL \u4e2d\u7684\u6267\u884c\u987a\u5e8f\u5e76\u89e3\u91ca\u5b83\u7684\u91cd\u8981\u6027\u3002</p> <p>\u6267\u884c\u987a\u5e8f\uff1aSQL \u67e5\u8be2\u5728\u8bc4\u4f30\u5b50\u53e5\u65f6\u9075\u5faa\u7279\u5b9a\u7684\u987a\u5e8f\uff0c\u7c7b\u4f3c\u4e8e\u6570\u5b66\u8fd0\u7b97\u9075\u5faa PEMDAS \u6216 BIDMAS \u7684\u65b9\u5f0f\u3002</p> <p>\u4ece\u7528\u6237\u7684\u89d2\u5ea6\u6765\u770b\uff0c\u67e5\u8be2\u4ece\u7b2c\u4e00\u4e2a\u5b50\u53e5\u5f00\u59cb\uff0c\u5230\u6700\u540e\u4e00\u4e2a\u5b50\u53e5\u7ed3\u675f\u3002\u4f46\u662f\uff0c\u67e5\u8be2\u5b9e\u9645\u4e0a\u5e76\u4e0d\u662f\u5728\u6267\u884c\u65f6\u4ece\u4e0a\u5230\u4e0b\u8bfb\u53d6\u7684\u3002</p> <p>\u67e5\u8be2\u4e2d\u5b50\u53e5\u7684\u6267\u884c\u987a\u5e8f\u5982\u4e0b\uff1a</p> <ol> <li> <p>FROM/JOIN\uff1a\u9996\u5148\u6267\u884c FROM \u548c/\u6216 JOIN \u5b50\u53e5\u4ee5\u786e\u5b9a\u611f\u5174\u8da3\u7684\u6570\u636e\u3002</p> </li> <li> <p>\u67e5\u8be2\u6267\u884c\u4ece FROM \u5b50\u53e5\u5f00\u59cb\u3002\u5728\u6b64\u6b65\u9aa4\u4e2d\uff0c\u6570\u636e\u5e93\u7cfb\u7edf\u8bbf\u95ee FROM \u5b50\u53e5\u4e2d\u6307\u5b9a\u7684\u8868\u5e76\u5728\u5b83\u4eec\u4e4b\u95f4\u6267\u884c\u4efb\u4f55\u5fc5\u8981\u7684\u8fde\u63a5\u3002\u8054\u63a5\u6839\u636e\u6307\u5b9a\u7684\u8054\u63a5\u6761\u4ef6\u5408\u5e76\u6765\u81ea\u4e0d\u540c\u8868\u7684\u76f8\u5173\u884c\u3002\u6b64\u6b65\u9aa4\u68c0\u7d22\u5c06\u7528\u4e8e\u8fdb\u4e00\u6b65\u5904\u7406\u7684\u521d\u59cb\u6570\u636e\u96c6\u3002</p> </li> <li> <p>WHERE\uff1a\u6267\u884c WHERE \u5b50\u53e5\uff0c\u8fc7\u6ee4\u6389\u4e0d\u6ee1\u8db3\u7ea6\u675f\u6761\u4ef6\u7684\u8bb0\u5f55\u3002</p> </li> <li> <p>\u8bbf\u95ee\u548c\u8fde\u63a5\u8868\u540e\uff0c\u5c06\u5e94\u7528 WHERE \u5b50\u53e5\u3002WHERE \u5b50\u53e5\u6839\u636e\u6307\u5b9a\u6761\u4ef6\u8fc7\u6ee4\u8fde\u63a5\u8868\u4e2d\u7684\u884c\u3002\u5b83\u5141\u8bb8\u60a8\u6307\u5b9a\u786e\u5b9a\u54ea\u4e9b\u884c\u5e94\u5305\u542b\u5728\u7ed3\u679c\u96c6\u4e2d\u7684\u6761\u4ef6\u3002\u4e0d\u6ee1\u8db3\u6761\u4ef6\u7684\u884c\u5c06\u4ece\u8fdb\u4e00\u6b65\u5904\u7406\u4e2d\u5254\u9664\u3002</p> </li> <li> <p>GROUP BY\uff1a\u6267\u884c GROUP BY \u5b50\u53e5\uff0c\u6839\u636e\u4e00\u5217\u6216\u591a\u5217\u4e2d\u7684\u503c\u5bf9\u6570\u636e\u8fdb\u884c\u5206\u7ec4\u3002</p> </li> <li> <p>HAVING\uff1a\u6267\u884c HAVING \u5b50\u53e5\uff0c\u5220\u9664\u521b\u5efa\u7684\u4e0d\u6ee1\u8db3\u7ea6\u675f\u7684\u5206\u7ec4\u8bb0\u5f55\u3002</p> </li> <li> <p>SELECT\uff1a\u6267\u884c SELECT \u5b50\u53e5\u4ee5\u6d3e\u751f\u6240\u6709\u6240\u9700\u7684\u5217\u548c\u8868\u8fbe\u5f0f\u3002</p> </li> <li> <p>ORDER BY\uff1a\u6267\u884c ORDER BY \u5b50\u53e5\u4ee5\u6309\u5347\u5e8f\u6216\u964d\u5e8f\u5bf9\u6d3e\u751f\u503c\u8fdb\u884c\u6392\u5e8f\u3002</p> </li> <li> <p>LIMIT/OFFSET\uff1a\u6700\u540e\uff0c\u6267\u884c LIMIT \u548c/\u6216 OFFSET \u5b50\u53e5\u4ee5\u4fdd\u7559\u6216\u8df3\u8fc7\u6307\u5b9a\u6570\u91cf\u7684\u884c\u3002</p> </li> </ol> <pre><code>--SQL92\u6807\u51c6\nSELECT DISTINCT ...,...,...(\u5b58\u5728\u805a\u5408\u51fd\u6570)\nFROM ...,...,...(\u591a\u8868\u67e5\u8be2)\nWHERE \u591a\u8868\u7684\u8fde\u63a5\u6761\u4ef6 AND \u4e0d\u5305\u542b\u805a\u5408\u51fd\u6570\u7684\u8fc7\u6ee4\u6761\u4ef6\nGROUP BY ...,...\nHAVING \u5305\u542b\u805a\u5408\u51fd\u6570\u7684\u8fc7\u6ee4\u6761\u4ef6\nORDER BY ...,...(ASC/DESC)\nLIMIT ...,...;\n\n\n--SQL99\u6807\u51c6\nSELECT DISTINCT ...,...,...(\u5b58\u5728\u805a\u5408\u51fd\u6570)             ---&gt;2\nFROM ... (LEFT/RIGHT) JOIN ... ON \u591a\u8868\u7684\u8fde\u63a5\u6761\u4ef6   ---&gt;1\nWHERE \u4e0d\u542b\u805a\u5408\u51fd\u6570\u7684\u8fc7\u6ee4\u6761\u4ef6                         ---&gt;1\nGROUP BY ...,...                                 ---&gt;1\nHAVING \u5305\u542b\u805a\u5408\u51fd\u6570\u7684\u8fc7\u6ee4\u6761\u4ef6                        ---&gt;1\nORDER BY ...,...(ASC/DESC)                              ---&gt;3\nLIMIT ...,...;                                          ---&gt;3\n</code></pre>"},{"location":"basic/4.sql/#exist-in","title":"EXIST \u548c IN \u67e5\u8be2","text":"<pre><code>SELECT  *\nFROM table_name\nWHERE col_name IN (value1, value2,...);\n\n\n-- IN\u67e5\u8be2\u76f8\u5f53\u4e8e\u591a\u4e2a or \u6761\u4ef6\u7684\u53e0\u52a0\uff0c\u6bd4\u8f83\u597d\u7406\u89e3:\u7b49\u4ef7\u4e8e where col_name=value1  or col_name=value2\n\n\n-- \u6bd4\u5982\u8fd9\u6837\u7684IN\u67e5\u8be2\nSELECT * FROM t_user WHERE\n(first_name = 'first_name_1' AND last_name = 'last_name_1') OR\n(first_name = 'first_name_2' AND last_name = 'last_name_2') OR\n(first_name = 'first_name_3' AND last_name = 'last_name_3') OR\n(first_name = 'first_name_4' AND last_name = 'last_name_4') OR\n(first_name = 'first_name_5' AND last_name = 'last_name_5') OR\n(first_name = 'first_name_6' AND last_name = 'last_name_6') OR\n(first_name = 'first_name_7' AND last_name = 'last_name_7');\n\n-- MySQL\u8fd8\u652f\u6301\u591a\u5217IN\u67e5\u8be2\n-- PostgreSQL \u540c\u6837\u4e5f\u652f\u6301\u591a\u5217 IN \u67e5\u8be2\uff0c\u5728\u5b98\u65b9\u6587\u6863\u4e2d\uff0c\u8fd9\u79cd\u5f62\u5f0f\u88ab\u79f0\u4e3a\"\u884c\u6784\u9020\u5668\"\uff0c\u53c2\u89c1\uff1aPostgreSQL\u5b50\u67e5\u8be2\u8868\u8fbe\u5f0f \u3002\u5176\u591a\u5217\u67e5\u8be2\u7684\u8bed\u6cd5\u548c MySQL \u76f8\u540c\nSELECT * FROM t_user WHERE (first_name,last_name) IN (\n    ('first_name_1','last_name_1'),\n    ('first_name_2','last_name_2'),\n    ('first_name_3','last_name_3'),\n    ('first_name_4','last_name_4'),\n    ('first_name_5','last_name_5'),\n    ('first_name_6','last_name_6'),\n    ('first_name_7','last_name_7')\n);\n\n-- IN\u67e5\u8be2\u7684\u5b50\u6761\u4ef6\u8fd4\u56de\u5b57\u6bb5\uff0c\u5fc5\u987b\u8ddf\u67e5\u627e\u5b57\u6bb5\u6570\u91cf\u4e00\u81f4\nSELECT * FROM db_ftstat_smart.dm_org_base_latest WHERE\n       (org_id,org_code) IN\n(SELECT org_id,org_code FROM db_ftstat_smart.dm_org_cas_stat ) ;\n\n-- \u603b\u7684\u6765\u8bf4\uff0cin\u67e5\u8be2\u5c31\u662f\u5148\u5c06\u5b50\u67e5\u8be2\u6761\u4ef6\u7684\u8bb0\u5f55\u5168\u90fd\u67e5\u51fa\u6765\uff0c\u5047\u8bbe\u7ed3\u679c\u96c6\u4e3aB\uff0c\u5171\u6709m\u6761\u8bb0\u5f55\uff0c\u7136\u540e\u518d\u5c06\u5b50\u67e5\u8be2\u6761\u4ef6\u7684\u7ed3\u679c\u96c6\u5206\u89e3\u6210m\u4e2a\uff0c\u518d\u8fdb\u884cm\u6b21\u67e5\u8be2\u3002\n\n-- \u67e5\u627e\u62e5\u6709\u5458\u5de5\u7684\u90e8\u95e8\uff1a\u4e09\u79cd\u65b9\u6cd5\nSELECT *\nFROM department d\nWHERE EXISTS (SELECT 1 FROM employee WHERE dept_id = d.dept_id);\n\nSELECT *\nFROM department d\nWHERE dept_id IN (SELECT dept_id FROM employee);\n\nSELECT *\nFROM department d\nWHERE dept_id = ANY (SELECT dept_id FROM employee);\n</code></pre> <p>\"\u6240\u6709\u7684 x \u90fd\u6ee1\u8db3\u6761\u4ef6 P\" \u6216\u8005 \"\u5b58\u5728\uff08\u81f3\u5c11\u4e00\u4e2a\uff09\u6ee1\u8db3\u6761\u4ef6 P \u7684 x\"\uff0c\u524d\u8005\u79f0\u4e3a\uff1a\"\u5168\u79f0\u91cf\u8bcd\"\uff0c\u540e\u8005\u79f0\u4e3a\"\u5b58\u5728\u91cf\u8bcd\"\uff0c\u5206\u522b\u8bb0\u4f5c \u2200\uff08A \u7684\u4e0b\u5012\uff09\u3001\u2203\uff08E \u7684\u5de6\u5012\uff09\u3002</p> <p>SQL \u4e2d\u7684 <code>EXISTS</code> \u8c13\u8bcd\u5b9e\u73b0\u4e86\u8c13\u8bcd\u903b\u8f91\u4e2d\u7684\u5b58\u5728\u91cf\u8bcd\uff0c\u7136\u800c\u9057\u61be\u7684\u662f\uff0cSQL \u5374\u5e76\u6ca1\u6709\u5b9e\u73b0\u5168\u79f0\u91cf\u8bcd\u3002</p> <p>\u4f46\u662f\u6ca1\u6709\u5168\u79f0\u91cf\u8bcd\u5e76\u4e0d\u7b97\u662f SQL \u7684\u81f4\u547d\u7f3a\u9677\uff0c\u56e0\u4e3a\u5168\u79f0\u91cf\u8bcd\u548c\u5b58\u5728\u91cf\u8bcd\u53ea\u8981\u5b9a\u4e49\u4e86\u4e00\u4e2a\uff0c\u53e6\u4e00\u4e2a\u5c31\u53ef\u4ee5\u88ab\u63a8\u5bfc\u51fa\u6765\u3002</p> <p>EXISTS \u8fd0\u7b97\u7b26\u7528\u4e8e\u5224\u65ad\u5b50\u67e5\u8be2\u7ed3\u679c\u7684\u5b58\u5728\u6027\u3002\u53ea\u8981\u5b50\u67e5\u8be2\u8fd4\u56de\u4e86\u4efb\u4f55\u7ed3\u679c\uff0c\u5c31\u8868\u793a\u6ee1\u8db3\u67e5\u8be2\u6761\u4ef6\uff1b\u5982\u679c\u5b50\u67e5\u8be2\u6ca1\u6709\u8fd4\u56de\u4efb\u4f55\u7ed3\u679c\uff0c\u5c31\u8868\u793a\u4e0d\u6ee1\u8db3\u67e5\u8be2\u6761\u4ef6\u3002</p> <p>\u5728 SQL \u4e2d\uff0c\u4e3a\u4e86\u8868\u8fbe\u5168\u79f0\u91cf\u5316\uff0c\u9700\u8981\u5c06 \"\u6240\u6709\u7684\u884c\u90fd\u6ee1\u8db3\u6761\u4ef6 P\" \u8fd9\u6837\u7684\u547d\u9898\u8f6c\u6362\u6210 \"\u4e0d\u5b58\u5728\u4e0d\u6ee1\u8db3\u6761\u4ef6 P \u7684\u884c\"</p> <pre><code>-- \u5b66\u751f\u6210\u7ee9\u8868\nDROP TABLE IF EXISTS tbl_student_score;\nCREATE TABLE tbl_student_score (\n  id INT(8) unsigned NOT NULL AUTO_INCREMENT COMMENT '\u81ea\u589e\u4e3b\u952e',\n  sno VARCHAR(12) NOT NULL COMMENT '\u5b66\u53f7',\n    subject VARCHAR(5) NOT NULL COMMENT '\u8bfe\u7a0b',\n    score TINYINT(3) NOT NULL COMMENT '\u5206\u6570',\n  PRIMARY KEY (id)\n);\nINSERT INTO tbl_student_score(sno,subject,score) VALUES\n('20190607001','\u6570\u5b66',100),\n('20190607001','\u8bed\u6587',80),\n('20190607001','\u7269\u7406',80),\n('20190608003','\u6570\u5b66',80),\n('20190608003','\u8bed\u6587',95),\n('20190609006','\u6570\u5b66',40),\n('20190609006','\u8bed\u6587',90),\n('20190610011','\u6570\u5b66',80);\n\nSELECT * FROM tbl_student_score;\n\n\n-- \u67e5\u8be2\u51fa\"\u6240\u6709\u79d1\u76ee\u5206\u6570\u90fd\u5728 50 \u5206\u4ee5\u4e0a\u7684\u5b66\u751f\"\n-- 20190607001\u300120190608003\u300120190610011 \u8fd9\u4e09\u4e2a\u5b66\u751f\u6ee1\u8db3\u6761\u4ef6\uff0c\u6211\u4eec\u9700\u8981\u5c06\u8fd9 3 \u4e2a\u5b66\u751f\u67e5\u51fa\u6765\n\n-- \u5c06\u67e5\u8be2\u6761\u4ef6\u201c\u6240\u6709\u79d1\u76ee\u5206\u6570\u90fd\u5728 50 \u5206\u4ee5\u4e0a\u201d \u8f6c\u6362\u6210\u5b83\u7684\u53cc\u91cd\u5426\u5b9a \u201c\u6ca1\u6709\u4e00\u4e2a\u79d1\u76ee\u5206\u6570\u4e0d\u6ee1 50 \u5206\u201d\uff0c\u7136\u540e\u7528 NOT EXISTS \u6765\u8868\u793a\u8f6c\u6362\u540e\u7684\u547d\u9898\n\n-- \u6ca1\u6709\u4e00\u4e2a\u79d1\u76ee\u5206\u6570\u4e0d\u6ee1 50 \u5206\nSELECT DISTINCT sno\nFROM tbl_student_score tss1\nWHERE NOT EXISTS -- \u4e0d\u5b58\u5728\u6ee1\u8db3\u4ee5\u4e0b\u6761\u4ef6\u7684\u884c\n(    SELECT * FROM tbl_student_score tss2\n    WHERE tss2.sno = tss1.sno\n    AND tss2.score &lt; 50    -- \u5206\u6570\u4e0d\u6ee150 \u5206\u7684\u79d1\u76ee\n);\n</code></pre> <p>\u5728\u4f7f\u7528 IN \u548c NOT IN \u65f6\u662f\u65e0\u6cd5\u9009\u53d6\u51fa NULL \u6570\u636e\u7684\u3002</p> <p>\u5b9e\u9645\u7ed3\u679c\u4e5f\u662f\u5982\u6b64\uff0cNULL \u7ec8\u7a76\u8fd8\u662f\u9700\u8981\u4f7f\u7528 IS NULL \u548c IS NOT NULL \u6765\u8fdb\u884c\u5224\u65ad\u3002</p>"},{"location":"basic/4.sql/#with-cte","title":"WITH \u67e5\u8be2\uff08CTE\uff09","text":"<p>\u7531\u4e8e\u4e1a\u52a1\u7684\u5ba2\u89c2\u590d\u6742\u6027\uff0c\u6709\u65f6\u5019\u4f1a\u5199\u51fa\u957f\u8fbe 2000 \u884c\u7684\u5355\u6761 SQL \u8bed\u53e5\uff0c\u5176\u4e2d\u5305\u542b\u5927\u91cf\u7684\u805a\u5408\u548c\u591a\u5c42\u5b50\u67e5\u8be2\u5d4c\u5957\uff0c\u7ef4\u62a4\u6b64\u7c7b SQL \u582a\u79f0\u5f00\u53d1\u4eba\u5458\u7684\u5669\u68a6\u3002</p> <p>CTE \u901a\u7528\u8868\u8fbe\u5f0f(Common table expression)\u7b80\u79f0 CTE\uff0c\u7531 SQL:1999 \u6807\u51c6\u5f15\u5165\u3002\u5b83\u662f\u4e00\u79cd\u66f4\u52a0\u4fbf\u6377\u7684\u590d\u7528\u67e5\u8be2\u7ed3\u679c\u7684\u65b9\u6cd5\u3002</p> <p>\u5b83\u53ef\u4ee5\u6781\u5927\u63d0\u5347\u5f00\u53d1\u4eba\u5458\u548c DBA \u7f16\u5199\u590d\u6742\u4e1a\u52a1\u903b\u8f91 SQL \u7684\u6548\u7387\uff0c\u589e\u5f3a\u4ee3\u7801\u7684\u53ef\u7ef4\u62a4\u6027\u3002</p> <p>\u53ef\u4ee5\u8ba4\u4e3a\u662f\u5728\u5355\u4e2a SELECT\u3001INSERT\u3001UPDATE\u3001DELETE \u6216 CREATE VIEW \u8bed\u53e5\u7684\u6267\u884c\u8303\u56f4\u5185\u5b9a\u4e49\u7684\u4e34\u65f6\u7ed3\u679c\u96c6\u3002</p> <p>CTE \u4e0e\u6d3e\u751f\u8868\u7c7b\u4f3c\uff0c\u5177\u4f53\u8868\u73b0\u5728\u4e0d\u5b58\u50a8\u4e3a\u5bf9\u8c61\uff0c\u5e76\u4e14\u53ea\u5728\u67e5\u8be2\u671f\u95f4\u6709\u6548\u3002\u4e0e\u6d3e\u751f\u8868\u7684\u4e0d\u540c\u4e4b\u5904\u5728\u4e8e\uff0cCTE \u53ef\u81ea\u5f15\u7528\uff0c\u8fd8\u53ef\u5728\u540c\u4e00\u67e5\u8be2\u4e2d\u5f15\u7528\u591a\u6b21\u3002</p> <p>\u5728\u4f7f\u7528\u7f16\u7a0b\u8bed\u8a00\u65f6\uff0c\u6211\u4eec\u901a\u5e38\u4f1a\u5b9a\u4e49\u4e00\u4e9b\u53d8\u91cf\u548c\u51fd\u6570\uff08\u65b9\u6cd5\uff09\u3002\u53d8\u91cf\u53ef\u4ee5\u88ab\u91cd\u590d\u4f7f\u7528\uff1b\u51fd\u6570\uff08\u65b9\u6cd5\uff09\u53ef\u4ee5\u5c06\u4ee3\u7801\u6a21\u5757\u5316\uff0c\u4ece\u800c\u63d0\u9ad8\u7a0b\u5e8f\u7684\u53ef\u8bfb\u6027\u4e0e\u53ef\u7ef4\u62a4\u6027\u3002</p> <p>\u4e0e\u6b64\u7c7b\u4f3c\uff0cSQL \u4e2d\u7684\u901a\u7528\u8868\u8868\u8fbe\u5f0f\u4e5f\u80fd\u591f\u5b9e\u73b0\u67e5\u8be2\u7ed3\u679c\u7684\u6a21\u5757\u5316\u548c\u91cd\u590d\u5229\u7528\uff0c\u7b80\u5316\u590d\u6742\u7684\u8fde\u63a5\u67e5\u8be2\u548c\u5b50\u67e5\u8be2\u3002</p> <pre><code>--CTE\u8bed\u53e5\u5982\u4e0b\n-- cte_name \u6307\u5b9a\u4e86 CTE \u7684\u540d\u79f0\uff0c\u540e\u9762\u662f\u53ef\u9009\u7684\u5b57\u6bb5\u540d\u3002\n-- AS\u5173\u952e\u5b57\u540e\u9762\u7684\u5b50\u67e5\u8be2\u662fCTE \u7684\u5b9a\u4e49\u8bed\u53e5\uff0c\u5b9a\u4e49\u4e86\u5b83\u7684\u8868\u7ed3\u6784\u548c\u6570\u636e\u3002\n-- \u6700\u540e\u7684 SELECT \u662f\u4e3b\u67e5\u8be2\u8bed\u53e5\uff0c\u5b83\u53ef\u4ee5\u5f15\u7528\u524d\u9762\u5b9a\u4e49\u7684 CTE\u3002\u9664\u4e86 SELECT \u4e4b\u5916\uff0c\u4e3b\u67e5\u8be2\u8bed\u53e5\u4e5f\u53ef\u4ee5\u662f INSERT\u3001UPDAT \u6216 DELETE \u7b49\u3002\n\nWITH cte_name(col1, col2, ...) AS (\n subquery\n)\nSELECT * FROM cte_name;\n\nWITH\n  cte1 AS (SELECT a, b FROM table1),\n  cte2 AS (SELECT c, d FROM table2)\nSELECT b, d FROM cte1 JOIN cte2\nWHERE cte1.a = cte2.c;\n\n\n\n-- \u5217\u8868\u4e2d\u7684\u540d\u79f0\u6570\u91cf\u5fc5\u987b\u4e0e\u67e5\u8be2\u7ed3\u679c\u4e2d\u7684\u5b57\u6bb5\u6570\u91cf\u76f8\u540c\nWITH cte (col1, col2) AS\n(\n  SELECT 1, 2\n  UNION ALL\n  SELECT 3, 4\n)\nSELECT * FROM cte;\n\n\n-- \u5b50\u67e5\u8be2\u7684CTE\u5199\u6cd5\n-- CTE \u5c06\u5b50\u67e5\u8be2\u7684\u7ed3\u679c\u96c6\u7528 with \u8bed\u53e5\u63d0\u5230\u6700\u524d\u9762\uff0c\u53d6\u4e00\u4e2a\u522b\u540d\uff0c\u518d\u5728\u540e\u9762\u7684\u8bed\u53e5\u4e2d\u4f7f\u7528\nwith derived(...) as (\n    subquery\n)\nselect ... from derived, table_name1 \u2026\u2026;\n\n\n-- CTE \u53ef\u4ee5\u5f15\u7528\u5176\u4ed6CTE\nwith derived_one as (\n    subquery\n),\nderived_two as (\n    select \u2026\u2026 from derived_one\n)\nselect \u2026\u2026 from derived_one, derived_two \u2026\u2026;\n\n-- \u5728\u540c\u4e00\u4e2a\u8bed\u53e5\u7ea7\u522b\u4e2d\u53ea\u5141\u8bb8\u5b58\u5728\u4e00\u4e2aWITH\u5b50\u53e5\uff0c\u6709\u6548\u7684\u8bed\u6cd5\u683c\u5f0f\u662f\u4e3a\u4e00\u4e2aWITH\u5b50\u53e5\u5b9a\u4e49\u591a\u4e2a\u4ece\u53e5\uff0c\u4f7f\u7528\u9017\u53f7\u8fdb\u884c\u5206\u9694\uff1a\n-- \u5728\u5305\u542bWITH\u5b50\u53e5\u7684\u67e5\u8be2\u4e2d\uff0c\u53ef\u4ee5\u4f7f\u7528CTE\u7684\u540d\u79f0\u8bbf\u95ee\u76f8\u5e94 CTE \u7684\u7ed3\u679c\u96c6\u3002\n-- \u524d\u9762\u5b9a\u4e49\u7684CTE\u53ef\u4ee5\u5728\u5176\u4ed6\u7684CTE\u4e2d\u8fdb\u884c\u5f15\u7528\uff0c\u56e0\u6b64 CTE \u53ef\u4ee5\u57fa\u4e8e\u524d\u9762\u7684 CTE \u8fdb\u884c\u5b9a\u4e49\u3002\n-- \u5f15\u7528\u81ea\u5df1\u7684 CTE \u88ab\u79f0\u4e3a\u9012\u5f52 CTE\u3002\u9012\u5f52 CTE \u7684\u4f7f\u7528\u573a\u666f\u5305\u62ec\u751f\u6210\u5e8f\u5217\uff0c\u904d\u5386\u5c42\u6b21\u6570\u636e\u6216\u6811\u72b6\u7ed3\u6784\u7684\u6570\u636e\u3002\n-- \u901a\u7528\u8868\u8868\u8fbe\u5f0f\u5c5e\u4e8e DML \u8bed\u53e5\u7684\u53ef\u9009\u90e8\u5206\u3002\n\n\n\n\n--\u627e\u51fa\u9884\u7b97\u503c\u6700\u5927\u7684\u7cfb:\u7cfb\u540d\uff0c\u9884\u7b97\n-- \u65b9\u6cd5\u4e00\nselect dept_name , budget\n from department ,\n (SELECT max( budget )as budget FROM department) as max_budget\n\n   where department.budget = max_budget.budget\n\n\n-- \u5148\u7528with\u8bed\u53e5\u67e5\u51fa\u4e00\u4e2a\u4e34\u65f6\u8868 max_budget ( VALUE )\uff0c\n\u8fd9\u91cc\u9762\u5b58\u4e86\u6240\u6709\u7cfb\u91cc\u9762\u7684\u6700\u5927\u7684\u9884\u7b97\u503c\u3002\u518d\u5c06\u8fd9\u4e2a\u8868\u4e0e\u7cfb\u8868\u5173\u8054\u67e5\u8be2\nWITH max_budget (value) AS ( SELECT max( budget ) FROM department ) SELECT\nbudget\nFROM\n    department,\n    max_budget\nWHERE\n    department.budget = max_budget.value\n</code></pre> <p>CTE \u76f8\u8f83\u4e8e\u6d3e\u751f\u8868\u6709 4 \u4e2a\u660e\u663e\u7684\u4f18\u52bf\uff1a</p> <ul> <li>\u66f4\u597d\u7684\u53ef\u8bfb\u6027</li> </ul> <pre><code>    SELECT ...\n    FROM t1 LEFT JOIN ((SELECT ... FROM ...) AS dt JOIN t2 ON ...) ON ...\n\n\n    WITH dt AS (SELECT ... FROM ...)\n    SELECT ...\n    FROM t1 LEFT JOIN (dt JOIN t2 ON ...) ON ...\n</code></pre> <p>\u200b</p> <ul> <li>\u53ef\u4ee5\u88ab\u591a\u6b21\u5f15\u7528</li> </ul> <pre><code>    -- \u4f20\u7edf\u6d3e\u751f\u8868\u5b50\u67e5\u8be2\u5199\u6cd5\uff1a\u6bcf\u4e2a\u5b50\u67e5\u8be2\u90fd\u8981\u5199\u5b8c\u6210SQL\n\n    SELECT ...\n    FROM (SELECT a, b, SUM(c) s FROM t1 GROUP BY a, b) AS d1\n    JOIN (SELECT a, b, SUM(c) s FROM t1 GROUP BY a, b) AS d2 ON d1.b = d2.a;\n\n    -- CTE\u5199\u6cd5\uff1a\u4e00\u6b21\u751f\u6210\uff0c\u591a\u6b21\u5f15\u7528\n\n    WITH d AS (SELECT a, b, SUM(c) s FROM t1 GROUP BY a, b)\n    SELECT ... FROM d AS d1 JOIN d AS d2 ON d1.b = d2.a;\n</code></pre> <p>\u200b</p> <ul> <li>\u53ef\u4ee5\u5f15\u7528\u5176\u4ed6\u7684 CTE</li> </ul> <pre><code>    -- \u4f20\u7edf\u8fd9\u79cd\u4e0d\u884c\uff0c\u4f1a\u62a5\u8868\u4e0d\u5b58\u5728\uff0c\u8981\u7528\u66f4\u590d\u6742\u7684\u5b50\u67e5\u8be2\n    SELECT ...\n    FROM (SELECT ... FROM ...) AS d1, (SELECT ... FROM d1 ...) AS d2 ...\n\n\n    -- \u6d3e\u751f\u8868\u5199\u6cd5\n    WITH d1 AS (SELECT ... FROM ...),\n    d2 AS (SELECT ... FROM d1 ...)\n    SELECT\n    FROM d1, d2 ...\n</code></pre> <ul> <li>\u6027\u80fd\u7684\u63d0\u5347</li> </ul>"},{"location":"basic/4.sql/#cte","title":"\u9012\u5f52 CTE","text":"<p>\u9012\u5f52 CTE \u662f\u4e00\u79cd\u7279\u6b8a\u7684 CTE\uff0c\u5176\u5b50\u67e5\u8be2\u4f1a\u5f15\u7528\u81ea\u5df1\u7684\u540d\u5b57\u3002</p> <p><code>WITH</code>\u5b50\u53e5\u5fc5\u987b\u4ee5<code>WITH RECURSIVE</code>\u5f00\u5934\u3002</p> <p>\u9012\u5f52 CTE \u5b50\u67e5\u8be2\u5305\u62ec\u4e24\u90e8\u5206\uff1a<code>seed\u67e5\u8be2</code>\u548c<code>recursive\u67e5\u8be2</code>\uff0c\u7531<code>UNION[ALL]</code>\u6216<code>UNION DISTINCT</code>\u5206\u9694\u3002</p> <pre><code>-- \u9012\u5f52CTE ,  MySQL\u3001PostgreSQL \u4ee5\u53ca SQLite\nWITH RECURSIVE derived(n) AS (\n SELECT 1\n UNION ALL\n SELECT n + 1 FROM derived WHERE n &lt; 5\n)\n SELECT * FROM derived;\n\n-- \u4ee5\u4e0a\u8bed\u53e5\u7684\u6267\u884c\u7ed3\u679c\u662f\u4e00\u4e2a\u8fde\u7eed\u7684\u6570\u5b57\u5e8f\u5217\uff1a1,2,3,4,5\n\n-- \u5982\u679c\u5728WITH\u5b50\u53e5\u4e2d\u5f15\u7528\u4e86\u81ea\u5df1\uff0cWITH\u5b50\u53e5\u5fc5\u987b\u4f7f\u7528WITH RECURSIVE\u3002\uff08\u5982\u679c\u6ca1\u6709 CTE \u5f15\u7528\u81ea\u5df1\uff0c\u4e5f\u53ef\u4ee5\u4f7f\u7528RECURSIVE\uff0c\u4f46\u4e0d\u5f3a\u5236\u3002\uff09\n\n-- \u9012\u5f52 CTE \u7684\u5b50\u67e5\u8be2\u7531\u4e24\u90e8\u5206\u7ec4\u6210\uff0c\u4e2d\u95f4\u4f7f\u7528UNION [ALL]\u6216\u8005UNION DISTINCT\u8fdb\u884c\u8fde\u63a5\uff1a\n\n-- \u7b2c\u4e00\u4e2aSELECT\u8bed\u53e5\u7528\u4e8e\u751f\u6210\u521d\u59cb\u6570\u636e\u884c\uff0c\u8be5\u8bed\u53e5\u4e0d\u4f1a\u5f15\u7528 CTE \u81ea\u8eab\u3002\n-- \u7b2c\u4e8c\u4e2aSELECT\u8bed\u53e5\u5728\u5b83\u7684FROM\u5b50\u53e5\u4e2d\u5f15\u7528\u4e86 CTE\u81ea\u8eab\uff0c\u901a\u8fc7\u9012\u5f52\u4ea7\u751f\u66f4\u591a\u7684\u7ed3\u679c\u3002\n-- \u5f53\u7b2c\u4e8c\u4e2a\u8bed\u53e5\u4e0d\u4f1a\u4ea7\u751f\u66f4\u591a\u7684\u65b0\u6570\u636e\u65f6\u7ed3\u675f\u9012\u5f52\u3002\u56e0\u6b64\uff0c\u9012\u5f52 CTE\u7531\u4e00\u4e2a\u975e\u9012\u5f52\u7684SELECT\u8bed\u53e5\u548c\u4e00\u4e2a\u9012\u5f52\u7684SELECT\u8bed\u53e5\u7ec4\u6210\u3002\n-- CTE\u6700\u7ec8\u7ed3\u679c\u4e2d\u7684\u5b57\u6bb5\u7c7b\u578b\u7531\u975e\u9012\u5f52\u7684SELECT\u8bed\u53e5\u51b3\u5b9a\uff0c\u6240\u6709\u5b57\u6bb5\u90fd\u53ef\u4ee5\u4e3a\u7a7a\u3002\u67e5\u8be2\u7ed3\u679c\u7684\u5b57\u6bb5\u7c7b\u578b\u4e0e\u9012\u5f52SELECT\u8bed\u53e5\u65e0\u5173\u3002\n-- \u5982\u679c\u9012\u5f52\u90e8\u5206\u548c\u975e\u9012\u5f52\u90e8\u5206\u4f7f\u7528UNION DISTINCT\u8fdb\u884c\u8fde\u63a5\uff0c\u67e5\u8be2\u7ed3\u679c\u5c06\u4f1a\u6392\u9664\u91cd\u590d\u7684\u6570\u636e\u884c\u3002\n-- \u8fd9\u79cd\u65b9\u5f0f\u53ef\u4ee5\u7528\u4e8e\u6267\u884c\u4f20\u9012\u95ed\u5305\uff08transitive closure\uff0c\u4f8b\u5982\u4e24\u4e2a\u5730\u70b9\u4e4b\u95f4\u7684\u4e58\u8f66\u8def\u7ebf\uff09\u7684\u67e5\u8be2\uff0c\u9632\u6b62\u65e0\u9650\u5faa\u73af\u3002\n\n-- \u9012\u5f52\u90e8\u5206\u7684\u6bcf\u6b21\u8fed\u4ee3\u53ea\u9488\u5bf9\u4e0a\u6b21\u8fed\u4ee3\u751f\u6210\u7684\u65b0\u6570\u636e\u884c\u8fdb\u884c\u64cd\u4f5c\u3002\n-- \u5982\u679c\u9012\u5f52\u90e8\u5206\u5305\u542b\u591a\u4e2a\u67e5\u8be2\u5757\uff0c\u8fed\u4ee3\u65f6\u6bcf\u4e2a\u67e5\u8be2\u5757\u7684\u6267\u884c\u987a\u5e8f\u4e0d\u56fa\u5b9a\uff0c\u6bcf\u4e2a\u67e5\u8be2\u5757\u57fa\u4e8e\u5b83\u81ea\u5df1\u524d\u4e00\u6b21\u8fed\u4ee3\u7684\u7ed3\u679c\uff0c\u6216\u8005\u4e0a\u6b21\u8fed\u4ee3\u7ed3\u675f\u540e\u5176\u4ed6\u67e5\u8be2\u5757\u751f\u6210\u7684\u7ed3\u679c\u8fdb\u884c\u64cd\u4f5c\u3002\n\n\n-- \u524d\u9762\u9012\u5f52 CTE \u793a\u4f8b\u4e2d\u7684\u975e\u9012\u5f52\u8bed\u53e5\u5982\u4e0b\uff0c\u5b83\u4f1a\u4ea7\u751f\u4e00\u6761\u521d\u59cb\u5316\u7684\u6570\u636e\uff1a\nSELECT 1\n-- \u5b83\u7684\u9012\u5f52\u90e8\u5206\u5982\u4e0b\uff1a\nSELECT n + 1 FROM cte WHERE n &lt; 5\n-- \u6bcf\u6b21\u8fed\u4ee3\u65f6\uff0cSELECT\u8bed\u53e5\u5c06\u4f1a\u4ea7\u751f\u4e00\u4e2a\u6bd4\u4e0a\u4e00\u6b21\u7ed3\u679c\u4e2d\u7684 n \u5927 1 \u7684\u65b0\u503c\u3002\n-- \u7b2c\u4e00\u6b21\u8fed\u4ee3\u57fa\u4e8e\u521d\u59cb\u503c\uff081\uff09\u8fdb\u884c\u64cd\u4f5c\uff0c\u751f\u6210 1+1=2\uff1b\n-- \u7b2c\u4e8c\u6b21\u8fed\u4ee3\u57fa\u4e8e\u7b2c\u4e00\u6b21\u8fed\u4ee3\u7684\u7ed3\u679c\uff082\uff09\uff0c\u751f\u6210 2+1=3\uff1b\u5982\u6b64\u7b49\u7b49\u3002\n-- \u8fed\u4ee3\u4e00\u76f4\u6267\u884c\u5230\u9012\u5f52\u7ed3\u675f\uff0c\u6b64\u5904\u4e3a n \u7684\u503c\u5927\u4e8e\u6216\u7b49\u4e8e 5\u3002\n-- \u5982\u679c\u9012\u5f52\u90e8\u5206\u4ea7\u751f\u7684\u7ed3\u679c\u6bd4\u975e\u9012\u5f52\u90e8\u5206\u7684\u5b57\u6bb5\u957f\u5ea6\u66f4\u5927\uff0c\u9700\u8981\u5728\u975e\u9012\u5f52\u90e8\u5206\u6307\u5b9a\u4e00\u4e2a\u66f4\u5bbd\u7684\u5b57\u6bb5\u7c7b\u578b\uff0c\u907f\u514d\u6570\u636e\u88ab\u622a\u65ad\u3002\n\n\n\n-- \u5047\u8bbe\u7528\u6811\u5f62\u7ed3\u6784\u6765\u63cf\u8ff0\u4e00\u4e2a\u90e8\u95e8\u7684\u7ec4\u7ec7\u67b6\u6784\n\n-- DDL  \u7528id\u6765\u6807\u8bc6\u4e00\u4e2a\u4eba\uff0c\u7528manager_id\u6765\u8868\u793a\u5411\u4e0a\u4e00\u4e2a\u4eba\u6c47\u62a5\nCREATE TABLE db_test.employees_mgr (\n    id INT PRIMARY KEY NOT NULL,\n    name VARCHAR ( 100 ) NOT NULL,\n    manager_id INT NULL,\n    INDEX ( manager_id ),\n    FOREIGN KEY ( manager_id ) REFERENCES employees_mgr ( id )\n);\n\n\n-- test data\ninsert into db_test.employees_mgr values\n(333, \"Yasmina\", null), /* Yasmina is the CEO (manager_id is null) */\n(198, \"John\", 333),     /* John has id 198 and reports to 333 (Yasmina) */\n(692, \"Tarek\", 333),    /* Tarek has id 692 and reports to 333 (Yasmina) */\n(29, \"Pedro \", 198),    /* Pedro has id 29 and reports to 198 (John) */\n(4610, \"Sarah\", 29);    /* Sarah has id 4610 and reports to 29 (Pedro) */\n\n\n-- \u8981\u67e5\u8be2\u51fa\u5982\u4e0b\u8fd9\u79cd\u6811\u5f62\u7ed3\u679c\n\n+------+---------+--------------------+\n| id   | name    | path               |\n+------+---------+--------------------+\n|  333 | Yasmina | 333                |\n|  198 | John    | 333-&gt;198           |\n|  692 | Tarek   | 333-&gt;692           |\n|   29 | Pedro   | 333-&gt;198-&gt;29       |\n| 4610 | Sarah   | 333-&gt;198-&gt;29-&gt;4610 |\n+------+---------+--------------------+\n5 rows in set (0.00 sec)\nmysql&gt;\n\n\n-- MySQL8.0\u4e2d\u652f\u6301with\u5b50\u53e5\n-- \u901a\u8fc7\u9012\u5f52CTE\u6765\u67e5\u8be2\u7528\u6237\u7684\u5c42\u7ea7\u5173\u7cfb\n-- \u89c4\u5212\u4e00\u4e2aID\uff0cname\uff0cpath\u8fd9\u6837\u7684\u4e00\u4e2a\u5c42\u7ea7\u4e34\u65f6\u8868\n with recursive employee_paths (id, name, path) as (\n     --\u5148\u67e5\u6700\u9876\u5c42\u8282\u70b9\n     select id, name, cast(id as char(200))\n     from db_test.employees_mgr\n     where manager_id is null\n     union all\n     -- \u9012\u5f52\u67e5\u8be2\n     select e.id, e.name, concat(ep.path, '-&gt;', e.id)\n     from employee_paths as ep\n     join db_test.employees_mgr as e\n     on ep.id = e.manager_id\n    )\n     select * from employee_paths;\n</code></pre>"},{"location":"basic/4.sql/#_15","title":"\u67e5\u8be2\u6392\u5e8f","text":"<p>\u7406\u89e3 SQL \u6700\u91cd\u8981\u7684\u4e00\u70b9\u5c31\u662f\u8981\u660e\u767d\u8868\u4e0d\u4fdd\u8bc1\u662f\u6709\u5e8f\u7684\uff0c\u56e0\u4e3a\u8868\u662f\u4e3a\u4e86\u4ee3\u8868\u4e00\u4e2a\u96c6\u5408\uff08\u5982\u679c\u6709\u91cd\u590d\u9879\uff0c\u5219\u662f\u591a\u96c6\uff09\uff0c\u800c\u96c6\u5408\u662f\u65e0\u5e8f\u7684\u3002</p> <p>\u5728 SQL \u4e16\u754c\u4e2d\uff0c\u987a\u5e8f\u4e0d\u662f\u4e00\u7ec4\u6570\u636e\u7684\u56fa\u6709\u5c5e\u6027\u3002\u56e0\u6b64\uff0c\u9664\u975e\u60a8\u4f7f\u7528 <code>order by</code> \u5b50\u53e5\u67e5\u8be2\u60a8\u7684\u6570\u636e\uff0c\u5426\u5219\u60a8\u65e0\u6cd5\u4ece <code>RDBMS</code> \u4fdd\u8bc1\u60a8\u7684\u6570\u636e\u5c06\u6309\u7279\u5b9a\u987a\u5e8f\u8fd4\u56de\u2014\u2014\u751a\u81f3\u4ee5\u4e00\u81f4\u7684\u987a\u5e8f\u8fd4\u56de\u3002</p> <p>\u5728\u5173\u7cfb\u6a21\u578b\u4e2d\uff0c\u6240\u6709\u64cd\u4f5c\u548c\u5173\u7cfb\u90fd\u57fa\u4e8e\u5173\u7cfb\u4ee3\u6570\u548c\u5173\u7cfb(\u96c6\u5408)\u4e2d\u7684\u7ed3\u679c\uff0c\u4f46\u5728<code>SQL</code>\u4e2d\u60c5\u51b5\u7565\u6709\u4e0d\u540c\uff0c\u56e0 SELECT \u67e5\u8be2\u5e76\u4e0d\u4fdd\u8bc1\u8fd4\u56de\u4e00\u4e2a\u771f\u6b63\u7684\u96c6\u5408(\u5373\uff0c\u7531\u552f\u4e00\u884c\u7ec4\u6210\u7684\u65e0\u5e8f\u96c6\u5408)\u3002</p> <p>\u9996\u5148\uff0cSQL \u4e0d\u8981\u6c42\u8868\u5fc5\u987b\u7b26\u5408\u96c6\u5408\u6761\u4ef6\u3002SQL \u8868\u53ef\u4ee5\u6ca1\u6709\u952e\uff0c\u884c\u4e5f\u4e0d\u4e00\u5b9a\u5177\u6709\u552f\u4e00\u6027\uff0c\u5728\u8fd9\u4e9b\u60c5\u51b5\u4e0b\u8868\u90fd\u4e0d\u662f\u96c6\u5408\uff0c\u800c\u662f\u591a\u96c6(multiset)\u6216\u5305(bag)\u3002\u4f46\u5373\u4f7f\u6b63\u5728\u67e5\u8be2\u7684\u8868\u5177\u6709\u4e3b\u952e\u3001\u4e5f\u7b26\u5408\u96c6\u5408\u7684\u6761\u4ef6\uff0c\u9488\u5bf9\u8fd9\u4e2a\u8868\u7684 SELECT \u67e5\u8be2\u4efb\u7136\u53ef\u80fd\u8fd4\u56de\u5305\u542b\u91cd\u590d\u7684\u7ed3\u679c\u3002</p> <p>\u5728\u63cf\u8ff0 SELECT \u67e5\u8be2\u7684\u8f93\u51fa\u65f6\uff0c\u7ecf\u5e38\u4f1a\u4f7f\u7528\u7ed3\u679c\u96c6\u8fd9\u4e2a\u5c5e\u4e8e\uff0c\u4e0d\u8fc7\u7ed3\u679c\u96c6\u5e76\u4e0d\u4e00\u5b9a\u975e\u5f97\u4e25\u683c\u6ee1\u8db3\u6570\u5b66\u610f\u4e49\u4e0a\u7684\u96c6\u5408\u6761\u4ef6\u3002</p> <p>\u5982\u679c\u5728\u67e5\u8be2\u8868\u65f6\u4e0d\u6307\u5b9a<code>ORDER BY</code>\u5b50\u53e5\uff0c\u90a3\u4e48\u867d\u7136\u67e5\u8be2\u53ef\u4ee5\u8fd4\u56de\u4e00\u4e2a\u7ed3\u679c\u8868\uff0c\u4f46 MySQL Server \u53ef\u4ee5\u81ea\u7531\u5730\u6309\u4efb\u610f\u987a\u5e8f\u5bf9\u7ed3\u679c\u4e2d\u7684\u884c\u8fdb\u884c\u6392\u5e8f\u3002\uff08\u6ce8\u610f\uff0c\u8fd9\u4e2a\u4e0d\u4e00\u5b9a\u53ef\u9760\uff09</p> <p>\u4e3a\u4e86\u786e\u4fdd\u7ed3\u679c\u4e2d\u7684\u884c\u6309\u7167\u4e00\u5b9a\u7684\u987a\u5e8f\u8fdb\u884c\u6392\u5e8f\uff0c\u552f\u4e00\u7684\u65b9\u6cd5\u5c31\u662f\u663e\u793a\u5730\u6307\u5b9a\u4e00\u4e2a<code>ORDER BY</code>\u5b50\u53e5\u3002</p> <p><code>SQL</code>\u652f\u6301\u591a\u4e2a\u5b57\u6bb5\u8fdb\u884c<code>ORDER BY</code>\u6392\u5e8f\uff0c\u5404\u5b57\u6bb5\u4e4b\u95f4\u7528\u9017\u53f7\",\"\u9694\u5f00\u3002</p> <pre><code> [ORDER BY {col_name | expr | position}\n      [ASC | DESC], ... [WITH ROLLUP]]\n    [LIMIT {[offset,] row_count | row_count OFFSET offset}]\n\n\n-- ORDER BY\u540e\u9762\u53ef\u4ee5\u63a5\u5217\u540d\uff0c\u522b\u540d\uff0c\u5217\u53f7\uff08\u6570\u5b57\uff09\u3001\u8868\u8fbe\u5f0f\u3001\u51fd\u6570\u3001\u5206\u7ec4\u51fd\u6570\u7b49\n-- \u5982\u679c\u4e0d\u663e\u793a\u6307\u51fa\u662f\u5347\u5e8fASC\u8fd8\u662f\u964d\u5e8fDESC\uff0c\u5219\u9ed8\u8ba4\u4e3a\u662f\u5347\u5e8f\nSELECT * FROM tablename ORDER BY column1,column2,column3 ;\n\n-- \u5982\u679c\u6392\u5e8f\u5b57\u6bb5\u4e2d\u5b58\u5728\u76f8\u540c\u7684\u6570\u636e\uff0c\u90a3\u4e48\u5b83\u4eec\u7684\u6392\u5e8f\u987a\u5e8f\u662f\u968f\u673a\u7684\u3002\u4e3a\u4e86\u8fdb\u4e00\u6b65\u660e\u786e\u8fd9\u4e9b\u6570\u636e\u7684\u6392\u5e8f\u987a\u5e8f\uff0c\u53ef\u4ee5\u4f7f\u7528\u591a\u5217\u6392\u5e8f\u3002\n-- ORDER BY column1,column2         \u8868\u793a\uff1acolumn1\u548ccolumn2\u90fd\u662f\u5347\u5e8f\n-- ORDER BY column1,column2 DESC    \u8868\u793a\uff1acolumn1\u5347\u5e8f\uff0ccolumn2\u964d\u5e8f\n\n\n-- ORDER BY \u8bed\u53e5\u7684\u8bed\u6cd5\u7cd6(syntax sugar)\u3002\u53ef\u4ee5\u7528\u7f16\u53f7 1\uff0c 2 \u6765\u6307\u5b9a\u3002\nSELECT id, firstname FROM students ORDER BY 1,2 ;\n\n\n\n-- \u6392\u5e8f\u7684\u952e\u5e76\u975e\u4e00\u5b9a\u8981\u662f\u67d0\u4e00\u4e2a\u5217\uff0c\u4e5f\u53ef\u4ee5\u662f\u5217\u7ec4\u6210\u7684\u8868\u8fbe\u5f0f\u3002\nSELECT id, firstname FROM students ORDER BY class_id * 1000 +10  ;\n</code></pre>"},{"location":"basic/4.sql/#_16","title":"\u7a7a\u503c\u6392\u5e8f","text":"<p>\u7a7a\u503c\uff08NULL\uff09\u5728\u6570\u636e\u5e93\u4e2d\u8868\u793a\u672a\u77e5\u6216\u8005\u7f3a\u5931\u7684\u6570\u636e\u3002\u5982\u679c\u6392\u5e8f\u7684\u5b57\u6bb5\u4e2d\u5b58\u5728\u7a7a\u503c\u65f6\uff0c\u5e94\u8be5\u5982\u4f55\u5904\u7406\u5462\uff1f</p> <p>\u4e0d\u540c\u6570\u636e\u5e93\u7cfb\u7edf\u5bf9\u4e8e\u7a7a\u503c\u7684\u6392\u5e8f\u4f4d\u7f6e\u91c7\u7528\u4e86\u4e0d\u540c\u7684\u5904\u7406\u65b9\u5f0f\u3002</p> <ul> <li>MySQL\u3001Microsoft SQL Server \u4ee5\u53ca SQLite \u8ba4\u4e3a\u6392\u5e8f\u65f6\u7a7a\u503c\u6700\u5c0f\uff0c\u5347\u5e8f\u6392\u5e8f\u65f6\u7a7a\u503c\u6392\u5728\u6700\u524d\uff0c\u964d\u5e8f\u6392\u5e8f\u65f6\u7a7a\u503c\u6392\u5728\u6700\u540e\u3002</li> </ul> <p>By default, PostgreSQL considers NULL values larger than any non-NULL value</p> <ul> <li>Oracle \u548c PostgreSQL \u8ba4\u4e3a\u6392\u5e8f\u65f6\u7a7a\u503c\u6700\u5927\uff0c\u5347\u5e8f\u6392\u5e8f\u65f6\u7a7a\u503c\u6392\u5728\u6700\u540e\uff0c\u964d\u5e8f\u6392\u5e8f\u65f6\u7a7a\u503c\u6392\u5728\u6700\u524d\u3002</li> </ul> <p>Oracle\u3001PostgreSQL \u4ee5\u53ca SQLite \u652f\u6301\u4f7f\u7528 <code>NULLS FIRST</code> \u548c <code>NULLS LAST</code> \u6307\u5b9a\u7a7a\u503c\u7684\u6392\u5e8f\u4f4d\u7f6e\u3002</p>"},{"location":"basic/4.sql/#_17","title":"\u4e2d\u6587\u6392\u5e8f","text":"<p>\u5728\u521b\u5efa\u6570\u636e\u5e93\u6216\u8005\u8868\u65f6\uff0c\u6211\u4eec\u901a\u5e38\u4f1a\u6307\u5b9a\u4e00\u4e2a\u5b57\u7b26\u96c6\u548c\u6392\u5e8f\u89c4\u5219\u3002\u5b57\u7b26\u96c6\uff08Charset\uff09\u51b3\u5b9a\u4e86\u6570\u636e\u5e93\u80fd\u591f\u5b58\u50a8\u54ea\u4e9b\u5b57\u7b26\uff0c\u6bd4\u5982 ASCII \u5b57\u7b26\u96c6\u53ea\u80fd\u5b58\u50a8\u7b80\u5355\u7684\u82f1\u6587\u3001\u6570\u5b57\u548c\u4e00\u4e9b\u63a7\u5236\u5b57\u7b26\uff0cGB2312 \u5b57\u7b26\u96c6\u53ef\u4ee5\u5b58\u50a8\u4e2d\u6587\uff0cUnicode \u5b57\u7b26\u96c6\u80fd\u591f\u652f\u6301\u4e16\u754c\u4e0a\u7684\u5404\u79cd\u6587\u5b57\u3002</p> <p>\u6392\u5e8f\u89c4\u5219\uff08Collation\uff09\u5b9a\u4e49\u4e86\u5b57\u7b26\u96c6\u4e2d\u5b57\u7b26\u7684\u6392\u5e8f\u987a\u5e8f\uff0c\u5305\u62ec\u662f\u5426\u533a\u5206\u5927\u5c0f\u5199\u3001\u662f\u5426\u533a\u5206\u91cd\u97f3\u7b49\u3002\u5bf9\u4e8e\u4e2d\u6587\u800c\u8a00\uff0c\u6392\u5e8f\u65b9\u5f0f\u4e0e\u82f1\u6587\u6709\u6240\u4e0d\u540c\uff0c\u4e2d\u6587\u901a\u5e38\u9700\u8981\u6309\u7167\u62fc\u97f3\u3001\u504f\u65c1\u90e8\u9996\u6216\u8005\u7b14\u753b\u8fdb\u884c\u6392\u5e8f\u3002</p> <p>\u5982\u679c\u60f3\u8981\u652f\u6301\u4e2d\u6587\u6392\u5e8f\uff0c\u6700\u7b80\u5355\u7684\u65b9\u5f0f\u5c31\u662f\u4f7f\u7528\u652f\u6301\u4e2d\u6587\u6392\u5e8f\u7684\u5b57\u7b26\u96c6\u548c\u6392\u5e8f\u89c4\u5219\u3002\u5982\u679c\u4f7f\u7528\u7684\u5b57\u7b26\u96c6\u548c\u6392\u5e8f\u89c4\u5219\u4e0d\u6ee1\u8db3\u6211\u4eec\u7684\u6392\u5e8f\u9700\u6c42\uff0c\u53ef\u4ee5\u901a\u8fc7\u5176\u4ed6\u65b9\u6cd5\u5b9e\u73b0\u3002</p> <pre><code>-- \u5bf9\u5b57\u7b26\u4e32\u7c7b\u578b\u4e2d\u7684\u4e2d\u6587\u5b57\u6bb5\u6392\u5e8f\n\n--\n</code></pre> <p>\u6700\u8fd1\u505a\u9879\u76ee\u9047\u5230\u4e00\u4e2a\u9700\u6c42\uff1a</p> <p>\u5bf9\u6570\u636e\u6309\u7167\u66f4\u65b0\u65f6\u95f4\u548c\u521b\u5efa\u65f6\u95f4\u8fdb\u884c\u7efc\u5408\u6392\u5e8f\uff0c\u5373\u5bf9\u6570\u636e\u7684\u64cd\u4f5c\u65f6\u95f4\u8fdb\u884c\u6392\u5e8f\uff0c\u4f46\u662f\u6570\u636e\u8868\u4e2d\u6ca1\u6709\u64cd\u4f5c\u65f6\u95f4\u8fd9\u4e2a\u5b57\u6bb5\uff0c\u9700\u8981\u6839\u636e\u66f4\u65b0\u65f6\u95f4\u548c\u521b\u5efa\u65f6\u95f4\u8fdb\u884c\u5904\u7406\u3002\u66f4\u65b0\u65f6\u95f4\u5b58\u5728\u65f6\uff0c\u6309\u7167\u66f4\u65b0\u65f6\u95f4\u6392\u5e8f\uff0c\u66f4\u65b0\u65f6\u95f4\u4e0d\u5b58\u5728\u65f6\uff0c\u4f7f\u7528\u521b\u5efa\u65f6\u95f4\u6392\u5e8f\uff0c\u6700\u540e\u66f4\u65b0\u65f6\u95f4\u548c\u521b\u5efa\u65f6\u95f4\u4e00\u8d77\u6392\u5e8f\u3002</p> <p>\u6392\u5e8f\u4f18\u5316</p> <p>\u6392\u5e8f\u662f blocking \u7684\uff0c\u5b9e\u73b0\u7684\u96be\u70b9\u5c31\u5728\u4e8e\u5185\u5b58\u6d88\u8017\u3002\u5047\u8bbe\u8f93\u5165\u7684\u6570\u636e\u53ef\u4ee5\u5b8c\u5168\u5b58\u653e\u5728\u5185\u5b58\u4e2d\uff0c\u90a3\u6211\u4eec\u76f4\u63a5\u7528\u5feb\u901f\u6392\u5e8f\u5c31\u4e07\u4e8b\u5927\u5409\u4e86\u3002\u5982\u679c\u8fd8\u8981\u7cbe\u76ca\u6c42\u7cbe\uff0c\u90a3\u5c31\u9700\u8981\u770b\u5982\u4f55\u624d\u80fd\u51cf\u5c11\u6bd4\u8f83\u548c\u4ea4\u6362\u7684\u6b21\u6570\uff0c\u66f4\u6709\u751a\u8005\uff0c\u53bb\u8ffd\u6c42 CPU register \u6216\u8005 L1, L2 \u7f13\u5b58\u7684\u5229\u7528\u7387\u3002\u5982\u679c\u6570\u636e\u91cf\u592a\u5927\uff0c\u4e0d\u80fd\u4e00\u6b21\u6027\u5168\u5b58\u653e\u5728\u5185\u5b58\u4e2d\u5462\u3002</p> <p>\u8fd9\u5c31\u9700\u8981\u7528\u5230\u6211\u4eec\u4e0a\u4e00\u671f\u63d0\u5230\u8fc7\u7684 <code>spill to disk</code> \u6280\u5de7\u4e86\uff1a\u9700\u8981\u628a\u6570\u636e\u6682\u5b58\u5230\u6587\u4ef6\u7cfb\u7edf\u4e2d\u3002\u8fd9\u91cc\uff0c\u5c31\u5f15\u51fa\u4eca\u5929\u63d0\u5230\u7684\u7b2c\u4e00\u4e2a\u7b97\u6cd5\uff1a\u5916\u90e8\u5f52\u5e76\u6392\u5e8f(external merge sort)\u3002\u5de5\u7a0b\u4e2d\u8981\u5b9e\u73b0\u4e00\u4e2a\u6b63\u786e\u5e76\u4e14\u9ad8\u6548\u7684\u5916\u90e8\u5f52\u5e76\u6392\u5e8f\u662f\u633a\u6709\u6311\u6218\u7684\uff0c\u6240\u4ee5\u6709\u4e9b\u6570\u636e\u5e93\u7cfb\u7edf\u5728\u6267\u884c\u65f6\u9700\u8981\u6d88\u8017\u5927\u91cf\u7684\u5185\u5b58\u6216\u8005\u5e72\u8106\u8981\u6c42\u52a0\u5165 limit \u8bed\u53e5\u6765\u9650\u5236\u6392\u5e8f\u6570\u91cf\u3002</p>"},{"location":"basic/4.sql/#_18","title":"\u6d3e\u751f\u8868\u548c\u5b50\u67e5\u8be2","text":"<p>\u5728\u6570\u636e\u5e93\u4e2d\uff0c\u6211\u4eec\u7ecf\u5e38\u4f7f\u7528\u5b50\u67e5\u8be2\u548c\u6d3e\u751f\u8868\u6765\u8fdb\u884c\u67e5\u8be2\u3002</p> <p><code>derived table</code>\u4e2d\u6587\u8bd1\u4e3a\u6d3e\u751f\u8868\uff0c\u5173\u4e8e\u6d3e\u751f\u8868\u7684\u542b\u4e49\uff0c\u7ffb\u9605\u4e86 MySQL \u7684\u5b98\u65b9\u624b\u518c\uff0c\u5e76\u6ca1\u6709\u627e\u5230\u76f8\u5bf9\u5e94\u7684\u89e3\u91ca\uff0c\u4e0d\u8fc7\u5728 SQL92 \u6807\u51c6\u4e2d\u6709\u5bf9\u5b83\u8fdb\u884c\u5b9a\u4e49\u3002</p> <p>A derived table is a table derived directly or indirectly from one or more other tables by the evaluation of a .The values of a derived table are derived from the values of the underlying tables when the  is evaluated. <p>\u4e0d\u540c\u6570\u636e\u5e93\u5bf9\u4e8e FROM \u5b50\u53e5\u4e2d\u7684\u5b50\u67e5\u8be2\u79f0\u547c\u4e0d\u540c\u3002\u4f8b\u5982\uff0cMySQL \u79f0\u4e4b\u4e3a\u6d3e\u751f\u8868\uff08Derived Table\uff09\uff0cOracle \u5219\u79f0\u4e4b\u4e3a\u5185\u8054\u89c6\u56fe\uff08Inline View\uff09\u3002</p> <pre><code>-- \u5b50\u67e5\u8be2\n-- \u5728\u53e6\u4e00\u4e2a\u67e5\u8be2(\u5916\u90e8\u67e5\u8be2)\u4e2d\u5d4c\u5957\u53e6\u4e00\u4e2a\u67e5\u8be2\u8bed\u53e5(\u5185\u90e8\u67e5\u8be2)\uff0c\u5e76\u4f7f\u7528\u5185\u90e8\u67e5\u8be2\u7684\u7ed3\u679c\u503c\u4f5c\u4e3a\u5916\u90e8\u67e5\u8be2\u6761\u4ef6\u3002\n-- \u5b50\u67e5\u8be2\u5728where\u4e2d\n-- where\u6761\u4ef6\u6bd4\u5bf9\u7684\u503c\u662f\u4ece\u5176\u4ed6\u8868\u67e5\u51fa\u6765\u7684\u3002\n-- \u5176\u5b9e\u4e0d\u5149\u662f where \uff0cselect \u540e\u9762\u8ddf\u7684\u5b57\u6bb5\u540d\u4e5f\u53ef\u4ee5\u662f\u4ece\u5176\u4ed6\u8868\u4e2d\u67e5\u51fa\u6765\u7684\u3002\n\nSELECT\n       customerNumber, checkNumber, amount\nFROM\n   \u3000\u3000 payments\nWHERE\n \u3000\u3000   amount = (SELECT  MAX(amount) FROMpayments);\n\n\n-- \u6807\u91cf\u5b50\u67e5\u8be2 \uff08\u4e00\u884c\u4e00\u5217\uff09\n-- \u90a3\u4e9b\u53ea\u8fd4\u56de\u4e00\u4e2a\u5355\u4e00\u503c\u7684\u5b50\u67e5\u8be2\u79f0\u4e4b\u4e3a\u6807\u91cf\u5b50\u67e5\u8be2\uff1a\u5b50\u67e5\u8be2\u91cc\u9762\u7684\u67e5\u8be2\u7ed3\u679c\u53ea\u8fd4\u56de\u4e00\u884c\u4e00\u5217\u4e00\u4e2a\u503c\u7684\u60c5\u51b5\u3002\n-- \u5b50\u67e5\u8be2\u53ef\u4ee5\u50cf\u5e38\u91cf\u4e00\u6837\u88ab\u7528\u4e8e SELECT\u3001WHERE\u3001GROUP BY\u3001HAVING \u4ee5\u53ca ORDER BY \u7b49\u5b50\u53e5\u4e2d\u3002\nSELECT (SELECT m1 FROM e1 LIMIT 1);\nSELECT * FROM e1 WHERE m1 = (SELECT MIN(m2) FROM e2);\nSELECT * FROM e1 WHERE m1 &lt; (SELECT MIN(m2) FROM e2);\n\n-- \u8ba1\u7b97\u5458\u5de5\u6708\u85aa\u4e0e\u5e73\u5747\u6708\u85aa\u4e4b\u95f4\u7684\u5dee\u503c\nSELECT emp_name AS \"\u5458\u5de5\u59d3\u540d\", salary AS \"\u6708\u85aa\",\n       salary - (SELECT AVG(salary) FROM employee) AS \"\u5dee\u503c\"\nFROM employee;\n\n\n-- \u884c\u5b50\u67e5\u8be2\uff08\u4e00\u884c\u591a\u5217\uff09\n-- \u987e\u540d\u601d\u4e49\uff0c\u5c31\u662f\u8fd4\u56de\u4e00\u6761\u8bb0\u5f55\u7684\u5b50\u67e5\u8be2\uff0c\u4e0d\u8fc7\u8fd9\u6761\u8bb0\u5f55\u9700\u8981\u5305\u542b\u591a\u4e2a\u5217\uff08\u53ea\u5305\u542b\u4e00\u4e2a\u5217\u5c31\u6210\u4e86\u6807\u91cf\u5b50\u67e5\u8be2\u4e86\uff09\u3002\n-- \u5176\u4e2d\u7684(SELECT m2, n2 FROM e2 LIMIT 1)\u5c31\u662f\u4e00\u4e2a\u884c\u5b50\u67e5\u8be2\n-- \u6574\u6761\u8bed\u53e5\u7684\u542b\u4e49\u5c31\u662f\u8981\u4ece e1 \u8868\u4e2d\u627e\u4e00\u4e9b\u8bb0\u5f55\uff0c\u8fd9\u4e9b\u8bb0\u5f55\u7684 m1 \u548c n1 \u5217\u5206\u522b\u7b49\u4e8e\u5b50\u67e5\u8be2\u7ed3\u679c\u4e2d\u7684 m2 \u548c n2 \u5217\nSELECT * FROM e1 WHERE (m1, n1) = (SELECT m2, n2 FROM e2 LIMIT 1);\n\n-- \u67e5\u627e\u6240\u6709\u4e0e\"\u5b59\u4e7e\"\u5728\u540c\u4e00\u4e2a\u90e8\u95e8\u5e76\u4e14\u804c\u4f4d\u76f8\u540c\u7684\u5458\u5de5\n\n-- Oracle\u3001MySQL\u3001PostgreSQL \u4ee5\u53ca SQLite\nSELECT emp_name, dept_id, job_id\nFROM employee\nWHERE (dept_id, job_id) = (SELECT dept_id, job_id\n                           FROM employee\n                           WHERE emp_name = '\u5b59\u4e7e')\nAND emp_name != '\u5b59\u4e7e';\n\n-- \u5176\u4e2d\uff0c\u5916\u90e8\u67e5\u8be2\u7684 WHERE \u5b50\u53e5\u4e2d\u5305\u542b\u4e00\u4e2a\u884c\u5b50\u67e5\u8be2\uff0c\u8fd4\u56de\u4e86\"\u5b59\u4e7e\"\u6240\u5728\u7684\u90e8\u95e8\u7f16\u53f7\u548c\u804c\u4f4d\u7f16\u53f7\uff0c\u8fd9\u4e24\u4e2a\u503c\u6784\u6210\u4e86\u4e00\u4e2a\u8bb0\u5f55\u3002\n-- \u7136\u540e\uff0c\u5916\u90e8\u67e5\u8be2\u4f7f\u7528\u8be5\u8bb0\u5f55\u4f5c\u4e3a\u6761\u4ef6\u8fdb\u884c\u6570\u636e\u8fc7\u6ee4\uff0cAND \u8fd0\u7b97\u7b26\u7528\u4e8e\u6392\u9664\"\u5b59\u4e7e\"\u81ea\u5df1\u3002\n-- Microsoft SQL Server \u76ee\u524d\u4e0d\u652f\u6301\u884c\u5b50\u67e5\u8be2\u3002\n\n-- \u5217\u5b50\u67e5\u8be2\uff08\u4e00\u5217\u6570\u636e\uff09\n-- \u5217\u5b50\u67e5\u8be2\u81ea\u7136\u5c31\u662f\u67e5\u8be2\u51fa\u4e00\u4e2a\u5217\u7684\u6570\u636e\uff0c\u4e0d\u8fc7\u8fd9\u4e2a\u5217\u7684\u6570\u636e\u9700\u8981\u5305\u542b\u591a\u6761\u8bb0\u5f55\n-- \u5176\u4e2d\u7684(SELECT m2 FROM e2)\u5c31\u662f\u4e00\u4e2a\u5217\u5b50\u67e5\u8be2\uff0c\u8868\u660e\u67e5\u8be2\u51fa e2 \u8868\u7684 m2 \u5217 \u7684\u6240\u6709\u503c\u4f5c\u4e3a\u5916\u5c42\u67e5\u8be2 IN \u8bed\u53e5\u7684\u53c2\u6570\u3002\nSELECT * FROM e1 WHERE m1 IN (SELECT m2 FROM e2);\n\n-- \u8868\u5b50\u67e5\u8be2\uff08\u4e8c\u7ef4\u591a\u884c\u591a\u5217\uff09\n-- \u987e\u540d\u601d\u4e49\uff0c\u5c31\u662f\u5b50\u67e5\u8be2\u7684\u7ed3\u679c\u65e2\u5305\u542b\u5f88\u591a\u6761\u8bb0\u5f55\uff0c\u53c8\u5305\u542b\u5f88\u591a\u4e2a\u5217\n-- \u5bf9\u4e8e\u8fd4\u56de\u591a\u884c\u6570\u636e\u7684\u5b50\u67e5\u8be2\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528 IN \u6216\u8005 NOT IN \u8fd0\u7b97\u7b26\u8fdb\u884c\u6bd4\u8f83\u3002\n-- \u5176\u4e2d\u7684(SELECT m2, n2 FROM e2)\u5c31\u662f\u4e00\u4e2a\u8868\u5b50\u67e5\u8be2\u3001\u6b64SQL\u5fc5\u987b\u8981\u5728m1\uff0cn1\u90fd\u6ee1\u8db3\u7684\u6761\u4ef6\u4e0b\u65b9\u53ef\u6210\u7acb\nSELECT * FROM e1 WHERE (m1, n1) IN (SELECT m2, n2 FROM e2);\n-- \u56e0\u4e3a\u5355\u4e2a\u503c\uff08\u5916\u90e8\u67e5\u8be2\u6761\u4ef6\u4e2d\u7684\u5b57\u6bb5\uff09\u4e0e\u591a\u4e2a\u503c\uff08\u5b50\u67e5\u8be2\u8fd4\u56de\u7684\u591a\u4e2a\u5143\u7ec4\u8bb0\u5f55\uff09\u7684\u6bd4\u8f83\u4e0d\u80fd\u4f7f\u7528\u6bd4\u8f83\u8fd0\u7b97\u7b26\uff08=\u3001!=\u3001&lt;\u3001&lt;=\u3001&gt;\u3001&gt;= \u7b49\uff09\u3002\n\n-- ALL \u8fd0\u7b97\u7b26\u4e0e\u6bd4\u8f83\u8fd0\u7b97\u7b26\uff08=\u3001!=\u3001&lt;\u3001&lt;=\u3001&gt;\u3001&gt;=\uff09\u7684\u7ec4\u5408\u5206\u522b\u8868\u793a\u7b49\u4e8e\u3001\u4e0d\u7b49\u4e8e\u3001\u5c0f\u4e8e\u3001\u5c0f\u4e8e\u6216\u7b49\u4e8e\u3001\u5927\u4e8e\u3001\u5927\u4e8e\u6216\u7b49\u4e8e\u5b50\u67e5\u8be2\u7ed3\u679c\u4e2d\u7684\u5168\u90e8\u6570\u636e\u3002\n\n\n-- From\u5b50\u53e5\u4e2d\u7684\u5b50\u67e5\u8be2\n-- \u6d3e\u751f\u8868\uff08\u5b50\u67e5\u8be2\uff09\n-- FROM\u540e\u9762\u8ddf\u7684\u8868\u662f\u901a\u8fc7\u5176\u4ed6\u67e5\u8be2\u67e5\u51fa\u6765\u7684\uff0c\u8fd9\u79cd\u67e5\u8be2\u53eb\u6d3e\u751f\u8868\uff0c\u6d3e\u751f\u8868\u5fc5\u987b\u8981\u6709\u522b\u540d\uff0c\u4ee5\u4fbf\u7a0d\u540e\u5728\u67e5\u8be2\u4e2d\u5f15\u7528\u5176\u540d\u79f0\u3002\n-- \u8fd9\u79cd\u5b50\u67e5\u8be2\u540e\u8fb9\u7684 AS t \u8868\u660e\u8fd9\u4e2a\u5b50 \u67e5\u8be2\u7684\u7ed3\u679c\u5c31\u76f8\u5f53\u4e8e\u4e00\u4e2a\u540d\u79f0\u4e3a t \u7684\u8868\uff0c\u8fd9\u4e2a\u540d\u53eb t \u7684\u8868\u7684\u5217\u5c31\u662f\u5b50\u67e5\u8be2\u7ed3\u679c\u4e2d\u7684\u5217\uff08m\u548cn\uff09\u3002\n-- \u8fd9\u4e2a\u653e\u5728 FROM \u5b50\u53e5\u4e2d\u7684\u5b50\u67e5\u8be2\u672c\u8d28\u4e0a\u76f8\u5f53\u4e8e\u4e00\u4e2a\u8868\uff0c\u4f46\u53c8\u548c\u6211\u4eec\u5e73\u5e38\u4f7f\u7528\u7684\u8868\u6709\u70b9\u513f\u4e0d\u4e00\u6837\uff0cMySQL \u628a\u8fd9\u79cd\u7531\u5b50\u67e5\u8be2\u7ed3\u679c\u96c6\u7ec4\u6210\u7684\u4e34\u65f6\u8868\u79f0\u4e4b\u4e3a\u6d3e\u751f\u8868\u3002\nSELECT m, n FROM (SELECT m2 + 1 AS m, n2 AS n FROM e2 WHERE m2 &gt; 2) AS t;\n-- \u6d3e\u751f\u8868\u4e5f\u662f\u4ece select \u8bed\u53e5\u4e2d\u8fd4\u56de\u7684\u865a\u62df\u8868\u3002\nSELECT\n    column_list\nFROM\n    (SELECT column_list ... FROM table_1) derived_table_name\nWHERE derived_table_name.c1 &gt; 0;\n\n\n-- \u4e00\u822c\u6765\u8bf4\uff0c\u5b50\u67e5\u8be2\u53ef\u4ee5\u50cf\u666e\u901a\u67e5\u8be2\u4e00\u6837\u5305\u542b\u5404\u79cd\u5b50\u53e5\uff0c\u4f8b\u5982 JOIN\u3001WHERE\u3001GROUP BY \u7b49\uff0c\u751a\u81f3\u53ef\u4ee5\u5d4c\u5957\u5176\u4ed6\u7684\u5b50\u67e5\u8be2\u3002\u4f46\u662f\u9700\u8981\u6ce8\u610f\uff0c\u4e0d\u540c\u6570\u636e\u5e93\u5bf9\u4e8e\u5b50\u67e5\u8be2\u4e2d ORDER BY \u5b50\u53e5\u7684\u5904\u7406\u65b9\u5f0f\u5b58\u5728\u5dee\u5f02\u3002\n\n-- \u901a\u5e38\u6765\u8bf4\uff0c\u5b50\u67e5\u8be2\u4e2d\u7684\u6392\u5e8f\u6ca1\u6709\u5b9e\u9645\u610f\u4e49\uff0c\u4e0d\u4f1a\u5f71\u54cd\u5230\u67e5\u8be2\u7ed3\u679c\u548c\u663e\u793a\u987a\u5e8f\u3002\u53ea\u6709\u5916\u90e8\u67e5\u8be2\u4e2d\u7684 ORDER BY \u5b50\u53e5\u80fd\u591f\u51b3\u5b9a\u6700\u7ec8\u7ed3\u679c\u7684\u663e\u793a\u987a\u5e8f\u3002\n</code></pre>"},{"location":"basic/4.sql/#_19","title":"\u8054\u8868\u67e5\u8be2","text":""},{"location":"basic/4.sql/#_20","title":"\u7b1b\u5361\u5c14\u79ef/\u4ea4\u53c9\u8fde\u63a5","text":"<p>\u7b1b\u5361\u5c14\u79ef\u662f\u6307\u5728\u6570\u5b66\u4e2d\uff0c\u4e24\u4e2a\u96c6\u5408 X \u548c Y \u7684\u7b1b\u5361\u5c13\u79ef\uff08Cartesian product\uff09\uff0c\u53c8\u79f0\u76f4\u79ef\uff0c\u8868\u793a\u4e3a <code>X \u00d7 Y</code>\uff0c\u7b2c\u4e00\u4e2a\u5bf9\u8c61\u662f X \u7684\u6210\u5458\uff0c\u800c\u7b2c\u4e8c\u4e2a\u5bf9\u8c61\u662f Y \u7684\u6240\u6709\u53ef\u80fd\u6709\u5e8f\u5bf9\u7684\u5176\u4e2d\u4e00\u4e2a\u6210\u5458\u3002</p> <p>\u7b1b\u5361\u5c14\u79ef\u53c8\u53eb\u7b1b\u5361\u5c14\u4e58\u79ef\uff0c\u662f\u4e00\u4e2a\u53eb\u7b1b\u5361\u5c14\u7684\u4eba\u63d0\u51fa\u6765\u7684\u3002 \u7b80\u5355\u7684\u8bf4\u5c31\u662f\u4e24\u4e2a\u96c6\u5408\u76f8\u4e58\u7684\u7ed3\u679c\u3002</p> <p>\u5047\u8bbe\u96c6\u5408 A={a, b}\uff0c\u96c6\u5408 B={0, 1, 2}\uff0c\u5219\u4e24\u4e2a\u96c6\u5408\u7684\u7b1b\u5361\u5c14\u79ef\u4e3a{(a, 0), (a, 1), (a, 2), (b, 0), (b, 1), (b, 2)}\u3002</p> <p>\u904d\u5386\u5de6\u8868\u7684\u6bcf\u4e00\u884c\u6570\u636e\uff0c\u7528\u5de6\u8868\u6bcf\u4e00\u884c\u6570\u636e\u5206\u522b\u4e8e\u4e0e\u53f3\u8868\u7684\u6bcf\u4e00\u884c\u6570\u636e\u505a\u5173\u8054</p> <pre><code> SELECT * FROM stu CROSS JOIN class;\n SELECT * FROM stu,class;\n SELECT * FROM stu AS a ,  class AS b JOIN ON 1=1 ;\n -- \u53ef\u4ee5\u770b\u51fa\uff0c\u7b1b\u5361\u5c14\u4e58\u79ef\u7684\u8fd0\u7b97\u91cf\u8d85\u7ea7\u5927\uff0c\u4e00\u822c\u4e0d\u4f1a\u4f7f\u7528\u7b1b\u5361\u5c14\u4e58\u79ef\u505a\u8868\u5173\u8054\u67e5\u8be2\n</code></pre> <p>\u6ce8\u610f</p> <p>\u5728 MySQL \u4e2d\uff0c <code>CROSS JOIN</code> \u7b49\u4ef7\u4e8e <code>INNER JOIN</code> \uff0c \u8fd9\u4e24\u4e2a\u53ef\u4ee5\u4e92\u6362\u4f7f\u7528\u3002\u4f46\u662f\u5728\u6807\u51c6 SQL \u4e2d\uff0c\u8fd9\u4e24\u4e2a\u5e76\u4e0d\u4e00\u6837\u3002</p>"},{"location":"basic/4.sql/#_21","title":"\u81ea\u7136\u8fde\u63a5","text":"<p>\u5bf9\u4e8e\u4e24\u4e2a\u8868\uff0c\u81ea\u7136\u8fde\u63a5\u662f\u5148\u627e\u51fa\u4e24\u4e2a\u8868\u6240\u6709\u5171\u7528\u7684\u5c5e\u6027\uff0c\u7136\u540e\u5728 \u5171\u7528\u5c5e\u6027\u4e0a\u505a\u5339\u914d\uff0c\u627e\u51fa\u76f8\u540c\u7684\u884c\u8fdb\u884c\u8fde\u63a5\u3002\uff08\u4e00\u5b9a\u8981\u6ce8\u610f\u8fde\u63a5\u8c13\u8bcd\u662f\u6240\u6709\u7684\u5171\u6709\u5c5e\u6027\u96c6\u5408\uff0c\u5373\u4e24\u4e2a\u8868\u4e0a\u6240\u6709\u76f8\u540c\u7684\u5217\u540d\uff09</p> <p><code>natural join</code> \u65e0\u9700\u58f0\u660e\u8fde\u63a5\u6761\u4ef6\uff0csql \u6267\u884c\u5668\u4f1a\u81ea\u52a8\u5bfb\u627e\u8fde\u63a5\u7684\u4e24\u4e2a\u8868\u4e2d\u76f8\u540c\u7684\u5b57\u6bb5\u53bb\u751f\u6210\u8fde\u63a5\u6761\u4ef6\uff0c\u7136\u540e\u53d6\u6570\u636e\u7684\u4ea4\u96c6\u3002\u5176\u5b9e\u81ea\u7136\u8fde\u63a5\u5c31\u662f\u81ea\u52a8\u751f\u6210\u8fde\u63a5\u6761\u4ef6\u7684\u5185\u8fde\u63a5\uff0c\u4ed6\u4e5f\u4e0d\u662f\u4ec0\u4e48\u65b0\u7684\u8fde\u63a5\uff0c\u5c31\u662f\u4e00\u4e2a\u4e3a\u4e86\u7b80\u5316\u5199\u6cd5\u7684\u8bed\u6cd5\u7cd6\u800c\u5df2</p> <pre><code>-- \u6807\u51c6SQL\u5199\u6cd5\u4e00\nSELECT user_name,dept_name FROM user NATURAL JOIN dept ;                  --\u76f4\u63a5\u81ea\u7136\u8fde\u63a5\uff0c\u65e0\u9700\u624b\u52a8\u6dfb\u52a0\u8fde\u63a5\u5b57\u6bb5\uff0c\u6267\u884c\u5668\u4f1a\u81ea\u52a8\u627e\u540c\u540d\u7684\u5b57\u6bb5\u3002\n\n-- \u6807\u51c6SQL\u5199\u6cd5\u4e8c\nSELECT user_name,dept_name FROM  user, dept WHERE user.id = dept.id  ...  --\u81ea\u5df1\u624b\u52a8\u6240\u6709\u5171\u6709\u5c5e\u6027\u90fd\u8fde\u63a5\u8d77\u6765\u3002\n\n-- MySQL\u5199\u6cd5\u4e09\n-- select name , id , title from A1 natural join A2 natural join A3\n-- select name , id , title from A1 natural join A2 , A3 where A2.id = A3.id\n-- \u8fd9\u4e24\u4e2a\u5199\u6cd5\u7684\u7ed3\u679c\u53ef\u80fd\u4e0d\u4e00\u6837\uff0c\n-- \u7b2c\u4e00\u4e2a\u53ef\u4ee5\u8ba4\u4e3a\u5c06A1 A2\u8fdb\u884c\u81ea\u7136\u8fde\u63a5\u7684\u7ed3\u679c\uff0c\u518d\u4e0eA3\u8fdb\u884c\u81ea\u7136\u8fde\u63a5\n-- \u7b2c\u4e8c\u4e2a\u53ef\u4ee5\u8ba4\u4e3a\u5c06A1 A2\u8fdb\u884c\u81ea\u7136\u8fde\u63a5\u7684\u7ed3\u679c\uff0c\u518d\u4e0eA3\u8fdb\u884c\u7b49\u503c\u8fde\u63a5\n</code></pre>"},{"location":"basic/4.sql/#_22","title":"\u7b49\u503c\u8fde\u63a5","text":"<p>\u5bf9\u4e24\u4e2a\u8868\uff0c\u7b49\u503c\u8fde\u63a5\u662f\u660e\u786e\u4e00\u7ec4\u5c5e\u6027\u4e0a\u8fdb\u884c\u5339\u914d\u3002\u7136\u540e\u8fdb\u884c\u8fde\u63a5\u3002(\u8fde\u63a5\u8c13\u8bcd\u662f\u5728\u9009\u5b9a\u7684\u5c5e\u6027\u96c6\u5408)\uff0c\u6240\u4ee5\u81ea\u7136\u8fde\u63a5\u662f\u4e00\u79cd\u7279\u6b8a\u7684\u7b49\u503c\u8fde\u63a5\u3002\u8fd9\u79cd\u65b9\u6cd5\u53ef\u80fd\u66f4\u52a0\u901a\u7528\u3002</p> <pre><code>-- \u5728\u8fd9\u4e2a\u4f8b\u5b50\u4e2d\uff0c\u53ea\u5728ID\u4e0a\u8fdb\u884c\u5339\u914d\u3002\u8981\u6c42\u4e24\u4e2a\u8868\u90fd\u8981\u6709ID\u8fd9\u4e2a\u5b57\u6bb5\u3002\n-- \u4f7f\u7528 using \u8bed\u6cd5 \uff0c select ... from T1 join T2 using(id)\nselect user_name,dept_name from user join dept using (id) ;\n\n-- \u4f7f\u7528 join on \u5173\u952e\u5b57\uff0con\u6761\u4ef6\u5141\u8bb8\u5728\u53c2\u4e0e\u8fde\u63a5\u7684\u5173\u7cfb\u4e0a\u8bbe\u7f6e\u8fde\u63a5\u8c13\u8bcd\u3002\nselect  user_name,dept_name from user join dept on user.id = dept.id ;\n\n-- tb1 inner join tb2 on something\n-- \u4e0d\u4fdd\u7559\u672a\u5339\u914d\u7684\u5143\u7ec4\n\nselect  user_name,dept_name from students  left outer join dept on user.id = dept.id ;\n</code></pre>"},{"location":"basic/4.sql/#_23","title":"\u5185\u8fde\u63a5","text":"<p>\u5185\u8fde\u63a5\u5305\u62ec\u81ea\u7136\u8fde\u63a5\uff0c\u4e0d\u7b49\u503c\u8fde\u63a5\u548c\u7b49\u503c\u8fde\u63a5\u3002\u4e0a\u9762\u8fd9\u4e9b\u8fde\u63a5\uff0c\u90fd\u662f\u5e38\u89c4\u8fde\u63a5\uff0c\u90fd\u53ef\u4ee5\u7406\u89e3\u6210\u5185\u8fde\u63a5\uff0c\u4e24\u4e2a\u8868\u4e2d\u7684\u5217\u4e92\u76f8\u5339\u914d\u65f6\uff0c\u53ea\u6309\u7167\u5c11\u7684\u90a3\u4e2a\u8868\u5339\u914d\u3002</p>"},{"location":"basic/4.sql/#_24","title":"\u5916\u8fde\u63a5","text":"<p>\u5de6\u5916\u8fde\u63a5\uff08LEFT OUTER JOIN\uff09\uff1a\u7ed3\u679c\u8868\u4e2d\u9664\u4e86\u5305\u62ec\u6ee1\u8db3\u8fde\u63a5\u6761\u4ef6\u7684\u884c\u5916\uff0c\u8fd8\u5305\u62ec\u5de6\u8868\u7684\u6240\u6709\u884c\u3002</p> <p>\u3010\u4f8b\u3011 \u67e5\u627e\u6240\u6709\u5b66\u751f\u60c5\u51b5\uff0c\u4ee5\u53ca\u4ed6\u4eec\u9009\u4fee\u7684\u8bfe\u7a0b\u53f7\uff0c\u82e5\u5b66\u751f\u672a\u9009\u4fee\u4efb\u4f55\u8bfe\uff0c\u4e5f\u8981\u5305\u62ec\u5176\u60c5\u51b5</p> <p>left \u5de6\u8fb9\u7684\u8868\u4e3a\u4e3b\u8868\uff0cleft \u53f3\u8fb9\u7684\u8868\u4e3a\u4ece\u8868\u3002\u8fd4\u56de\u7ed3\u679c\u884c\u6570\u4ee5 left \u5de6\u8fb9\u7684\u8868\u7684\u884c\u6570\u4e3a\u6700\u540e\u7684\u6570\u636e\u884c\uff0c\u5bf9\u4e8e\u5de6\u8868\u4e2d\u6709\u4e9b\u6570\u636e\u884c\u5728\u53f3\u8868\u4e2d\u627e\u4e0d\u5230\u5b83\u6240\u5339\u914d\u7684\u6570\u636e\u884c\u8bb0\u5f55\u65f6\u5019\uff0c\u8fd4\u56de\u7ed3\u679c\u7684\u65f6\u5019\u8fd9\u4e9b\u884c\u540e\u9762\u901a\u5e38\u4f1a\u4ee5 `null`` \u6765\u586b\u5145\u3002</p> <p>\u672c\u4f8b\u6267\u884c\u65f6\uff0c\u82e5\u6709\u5b66\u751f\u672a\u9009\u4efb\u4f55\u8bfe\u7a0b\uff0c\u5219\u7ed3\u679c\u8868\u4e2d\u76f8\u5e94\u884c\u7684\u8bfe\u7a0b\u53f7\u5b57\u6bb5\u503c\u4e3a NULL\u3002</p> <p>\u53f3\u5916\u8fde\u63a5\uff08RIGHT OUTER JOIN\uff09\uff1a\u7ed3\u679c\u8868\u4e2d\u9664\u4e86\u5305\u62ec\u6ee1\u8db3\u8fde\u63a5\u6761\u4ef6\u7684\u884c\u5916\uff0c\u8fd8\u5305\u62ec\u53f3\u8868\u7684\u6240\u6709\u884c\u3002</p> <p>\u5b8c\u5168\u5916\u8fde\u63a5\uff08FULL OUTER JOIN\uff09\uff1a\u7ed3\u679c\u8868\u4e2d\u9664\u4e86\u5305\u62ec\u6ee1\u8db3\u8fde\u63a5\u6761\u4ef6\u7684\u884c\u5916\uff0c\u8fd8\u5305\u62ec\u4e24\u4e2a\u8868\u7684\u6240\u6709\u884c</p> <p>\u53c2\u8003</p>"},{"location":"basic/4.sql/#_25","title":"\u534a\u8fde\u63a5","text":"<p>\u534a\u8fde\u63a5 <code>SEMI JOIN</code> \u662f\u6307\u5728\u4e24\u8868\u5173\u8054\u65f6\uff0c\u5f53\u7b2c\u4e8c\u4e2a\u8868\u4e2d\u5b58\u5728\u4e00\u4e2a\u6216\u591a\u4e2a\u5339\u914d\u8bb0\u5f55\u65f6\uff0c\u8fd4\u56de\u7b2c\u4e00\u4e2a\u8868\u7684\u8bb0\u5f55\u3002</p> <p>\u6bd4\u5982 <code>IN/EXIST</code> \u5b50\u67e5\u8be2\u3002\u5982\u679c\u6309\u7167 <code>IN/EXIST</code> \u8c13\u8bcd\u7684\u539f\u8bed\u4e49\u53bb\u6267\u884c\uff0c\u5bf9\u5916\u67e5\u8be2\u7684\u6bcf\u884c\u8bb0\u5f55\u90fd\u53bb\u8ba1\u7b97 <code>IN/EXIST</code> \u8c13\u8bcd\u7684\u7ed3\u679c\u3002\u5b50\u67e5\u8be2\u7684\u5185\u5bb9\u5c31\u9700\u8981\u5355\u72ec\u6267\u884c\uff0c\u5728\u5173\u8054\u5b50\u67e5\u8be2\u7684\u60c5\u51b5\u4e0b\uff0c\u5b50\u67e5\u8be2\u9700\u8981\u591a\u6b21\u91cd\u590d\u6267\u884c\uff0c\u6574\u4f53\u7684\u6267\u884c\u6548\u7387\u5f88\u4f4e\u3002\u5b9e\u9645\u4e0a\uff0c\u90e8\u5206\u5b58\u5728\u6027\u95ee\u9898(SPJ \u5b50\u67e5\u8be2)\u7c7b\u4f3c\u4e8e\u5916\u67e5\u8be2\u7684\u591a\u4e2a\u8868\u4e0e\u5b50\u67e5\u8be2\u7684\u591a\u4e2a\u8868(\u4ee5\u4e0b\u7b80\u8ff0\u4e3a\u5916\u8868\u548c\u5185\u8868)\u7684\u8fde\u63a5(JOIN)\u95ee\u9898\uff0c\u80fd\u8fde\u63a5\u4e0a\u8bf4\u660e\u5b58\u5728\u3002</p> <p>\u4f46\u662f\u4e0e\u666e\u901a JOIN \u4e0d\u540c\u7684\u70b9\u5728\u4e8e\uff0c\u5f53\u5916\u8868\u548c\u5185\u8868 JOIN \u7684\u65f6\u5019\uff0c\u5916\u8868\u7684\u6bcf\u884c\u8bb0\u5f55\u90fd\u6709\u53ef\u80fd\u548c\u5185\u8868\u7684\u591a\u884c\u8fde\u63a5\u4e0a\uff0c\u8fd9\u5c31\u5bfc\u81f4\u4e86\u5916\u8868\u884c\u7684\u91cd\u590d\u8bb0\u5f55\uff0c\u4f46\u662f\u6309\u7167\u539f\u8bed\u4e49 IN/EXIST \u5b50\u67e5\u8be2\u53ea\u662f\u5bf9\u5916\u8868\u884c\u4e0a\u8fdb\u884c\u7684\u8fc7\u6ee4\uff0c\u6570\u636e\u53ea\u80fd\u51cf\u5c11\uff0c\u800c\u4e0d\u80fd\u81a8\u80c0\u3002</p> <p>\u4e0e\u666e\u901a JOIN \u4e0d\u540c\uff0c<code>SEMI JOIN</code> \u4e2d\u7b2c\u4e00\u4e2a\u8868\u91cc\u7684\u8bb0\u5f55\u6700\u591a\u53ea\u8fd4\u56de\u4e00\u6b21\u3002<code>SEMI JOIN</code> \u901a\u5e38\u65e0\u6cd5\u76f4\u63a5\u7528 SQL \u8bed\u53e5\u6765\u8868\u793a\uff0c\u800c\u662f\u7531 IN \u6216 EXISTS \u5b50\u67e5\u8be2\u8f6c\u6362\u5f97\u5230\u3002</p> <p>\u534a\u8fde\u63a5\u53ea\u4f1a\u8fd4\u56de\u5de6\u8868\u4e2d\u7684\u6570\u636e\uff0c\u53f3\u8868\u53ea\u7528\u4e8e\u6761\u4ef6\u5224\u65ad\u3002\u53e6\u5916\uff0c\u5373\u4f7f\u53f3\u8868\u4e2d\u5b58\u5728\u591a\u4e2a\u5339\u914d\u7684\u6570\u636e\uff0c\u5de6\u8fb9\u4e2d\u7684\u6570\u636e\u53ea\u8fd4\u56de\u4e00\u6b21\u3002\u534a\u8fde\u63a5\u901a\u5e38\u7528\u4e8e\u5b58\u5728\u6027\u5224\u65ad\uff0c\u4f8b\u5982\u54ea\u4e9b\u987e\u5ba2\u8d2d\u4e70\u4e86\u4ea7\u54c1\uff0c\u800c\u4e0d\u9700\u8981\u77e5\u9053\u4ed6\u4eec\u8d2d\u4e70\u7684\u5177\u4f53\u4ea7\u54c1\u548c\u6570\u91cf\u3002</p> <pre><code>-- \u67e5\u627e\u62e5\u6709\u5458\u5de5\u7684\u90e8\u95e8\nSELECT *\nFROM department d\nWHERE EXISTS (SELECT 1 FROM employee WHERE dept_id = d.dept_id);\n\n-- \u4e5f\u53ef\u4ee5\u7528IN\u67e5\u8be2\nSELECT *\nFROM department d\nWHERE dept_id IN (SELECT dept_id FROM employee);\n\n-- \u4e5f\u53ef\u4ee5\u7528 =ANY \u64cd\u4f5c\u7b26\nSELECT *\nFROM department d\nWHERE dept_id = ANY (SELECT dept_id FROM employee);\n</code></pre> <p>http://mysql.taobao.org/monthly/2024/06/02/</p>"},{"location":"basic/4.sql/#_26","title":"\u53cd\u8fde\u63a5","text":"<p>\u53cd\u8fde\u63a5\u8fd4\u56de\u5de6\u8868\u4e2d\u4e0e\u53f3\u8868\u4e0d\u5339\u914d\u7684\u6570\u636e\u884c\uff0c\u901a\u5e38\u4f53\u73b0\u4e3a <code>NOT EXISTS</code> \u6216\u8005 <code>NOT IN</code> \u5b50\u67e5\u8be2\u3002\u53cd\u8fde\u63a5\u7684\u903b\u8f91\u4e0e\u534a\u8fde\u63a5\u6b63\u597d\u76f8\u53cd\u3002</p> <p>\u53cd\u8fde\u63a5\u53ea\u4f1a\u8fd4\u56de\u5de6\u8868\u4e2d\u7684\u6570\u636e\uff0c\u53f3\u8868\u53ea\u7528\u4e8e\u6761\u4ef6\u5224\u65ad\u3002\u53cd\u67e5\u8be2\u5e38\u89c1\u7684\u5e94\u7528\u5305\u62ec\uff1a\u67e5\u627e\u6ca1\u6709\u5458\u5de5\u7684\u90e8\u95e8\u4fe1\u606f\uff0c\u6216\u8005\u6ca1\u6709\u8d2d\u4e70\u4efb\u4f55\u4ea7\u54c1\u7684\u987e\u5ba2\u4fe1\u606f\u7b49\u3002</p> <pre><code>-- \u67e5\u627e\u6ca1\u6709\u5458\u5de5\u7684\u90e8\u95e8\nSELECT *\nFROM department d\nWHERE NOT EXISTS (SELECT 1 FROM employee WHERE dept_id = d.dept_id);\n</code></pre>"},{"location":"basic/4.sql/#_27","title":"\u4e0d\u7b49\u503c\u8fde\u63a5","text":"<p>\u4e0d\u7b49\u503c\u8fde\u63a5\uff1a\u5728\u8fde\u63a5\u6761\u4ef6\u4f7f\u7528\u9664\u7b49\u4e8e\u8fd0\u7b97\u7b26\u4ee5\u5916\u7684\u5176\u5b83\u6bd4\u8f83\u8fd0\u7b97\u7b26\u6bd4\u8f83\u88ab\u8fde\u63a5\u7684\u5217\u7684\u5217\u503c\u3002\u8fd9\u4e9b\u8fd0\u7b97\u7b26\u5305\u62ec&gt;\u3001&gt;=\u3001&lt;=\u3001&lt;\u3001!&gt;\u3001!&lt;\u548c&lt;&gt;\u3002</p>"},{"location":"basic/4.sql/#_28","title":"\u5206\u7ec4\u67e5\u8be2","text":"<p>\u6807\u51c6 SQL \u89c4\u5b9a\uff0c\u5728\u5bf9\u8868\u8fdb\u884c\u805a\u5408\u67e5\u8be2\u7684\u65f6\u5019\uff0c\u53ea\u80fd\u5728 SELECT \u5b50\u53e5\u4e2d\u5199\u4e0b\u9762 3 \u79cd\u5185\u5bb9\uff1a\u901a\u8fc7 GROUP BY \u5b50\u53e5\u6307\u5b9a\u7684\u805a\u5408\u952e\u3001\u805a\u5408\u51fd\u6570\uff08SUM \u3001AVG \u7b49\uff09\u3001\u5e38\u91cf\u3002</p> <p>\u5728\u6807\u51c6 SQL\uff0c\u6b63\u5e38\u7684\u5982\u679c\u5bf9\u4e00\u4e2a\u8868\u8fdb\u884c\u5206\u7ec4\u67e5\u8be2\uff0c\u5206\u7ec4\u4f1a\u8fdb\u884c\u53bb\u91cd\uff0c\u6bcf\u4e00\u7ec4\u67e5\u8be2\u7684\u7ed3\u679c\u96c6\u5e94\u8be5\u53ea\u6709\u4e00\u884c\u6570\u636e\u3002</p> <p>\u5206\u7ec4\uff0c\u4e3b\u8981\u662f\u4f7f\u7528 <code>GROUP BY</code> \u5b50\u53e5\uff0c\u4e00\u822c\u662f\u6309\u7167 <code>WHERE</code> \u6761\u4ef6\u8fc7\u6ee4\u4e4b\u540e\u7684\u7ed3\u679c\u96c6\u8fdb\u884c\u5206\u7ec4\uff0c <code>GROUP BY</code> \u4e00\u822c\u548c\u805a\u5408\u51fd\u6570\u4e00\u8d77\u4f7f\u7528\u624d\u6709\u610f\u4e49\u3002</p> <p>\u6ce8\u610f\uff0c<code>WHERE</code>\u5b50\u53e5\u53ea\u80fd\u6307\u5b9a\u884c\u7684\u6761\u4ef6\uff0c\u800c\u4e0d\u80fd\u6307\u5b9a\u7ec4\u7684\u6761\u4ef6\u3002</p> <p>\u5f88\u591a\u4eba\u90fd\u77e5\u9053\u805a\u5408\u67e5\u8be2\u7684\u9650\u5236\uff0c\u4f46\u662f\u5f88\u5c11\u6709\u4eba\u80fd\u6b63\u786e\u5730\u7406\u89e3\u4e3a\u4ec0\u4e48\u4f1a\u6709\u8fd9\u6837\u7684\u7ea6\u675f\u3002</p> <p>\u6807\u51c6 SQL \u89c4\u5b9a\uff1a\u5206\u7ec4\u67e5\u8be2\u4e2d\u7684\u8981\u67e5\u8be2\u7684\u5217\u5fc5\u987b\u662f group by \u4e2d\u8981\u5206\u7ec4\u7684\u5217\u6216\u805a\u96c6\u51fd\u6570\u6216\u5e38\u91cf\u3002</p> <p>\u8868 tbl_student_class \u4e2d\u7684 cname \u5b58\u50a8\u7684\u662f\u6bcf\u4f4d\u5b66\u751f\u7684\u73ed\u7ea7\u4fe1\u606f\uff0c\u4f46\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u8fd9\u91cc\u7684 cname \u53ea\u662f\u6bcf\u4e2a\u5b66\u751f\u7684\u5c5e\u6027\uff0c\u5e76\u4e0d\u662f\u5c0f\u7ec4\u7684\u5c5e\u6027\u3002</p> <p>\u800c <code>GROUP BY</code> \u53c8\u662f\u805a\u5408\u64cd\u4f5c\uff0c\u64cd\u4f5c\u7684\u5bf9\u8c61\u5c31\u662f\u7531\u591a\u4e2a\u5b66\u751f\u7ec4\u6210\u7684\u5c0f\u7ec4\uff0c\u56e0\u6b64\uff0c\u5c0f\u7ec4\u7684\u5c5e\u6027\u53ea\u80fd\u662f\u5e73\u5747\u6216\u8005\u603b\u548c\u7b49\u7edf\u8ba1\u6027\u8d28\u7684\u5c5e\u6027</p> <p>\u8be2\u95ee\u6bcf\u4e2a\u5b66\u751f\u7684 cname \u662f\u53ef\u4ee5\u7684\uff0c\u4f46\u662f\u8be2\u95ee\u7531\u6309\u7167\u73ed\u7ea7\u5206\u7ec4\u540e\u7684\u591a\u4e2a\u5b66\u751f\u7ec4\u6210\u7684\u5c0f\u7ec4\u7684 cname \u5c31\u6ca1\u6709\u610f\u4e49\u4e86\u3002</p> <p>\u5bf9\u4e8e\u5c0f\u7ec4\u6765\u8bf4\uff0c\u53ea\u6709\"\u4e00\u5171\u591a\u5c11\u5b66\u751f\"\u6216\u8005\"\u6700\u5927\u5b66\u53f7\u662f\u591a\u5c11\uff1f\"\u8fd9\u6837\u7684\u95ee\u6cd5\u624d\u662f\u6709\u610f\u4e49\u7684\u3002\u5f3a\u884c\u5c06\u9002\u7528\u4e8e\u4e2a\u4f53\u7684\u5c5e\u6027\u5957\u7528\u4e8e\u56e2\u4f53\u4e4b\u4e0a\uff0c\u7eaf\u7cb9\u662f\u4e00\u79cd\u5206\u7c7b\u9519\u8bef\u3002</p> <p><code>GROUP BY</code> \u7684\u4f5c\u7528\u662f\u5c06\u4e00\u4e2a\u4e2a\u5143\u7d20\u5212\u5206\u6210\u82e5\u5e72\u4e2a\u5b50\u96c6\uff0c\u4f7f\u7528 <code>GROUP BY</code> \u805a\u5408\u4e4b\u540e\uff0c<code>SQL</code> \u7684\u64cd\u4f5c\u5bf9\u8c61\u4fbf\u7531 0 \u9636\u7684\"\u884c\"\u53d8\u4e3a\u4e86 1 \u9636\u7684\"\u884c\u7684\u96c6\u5408\"\u3002</p> <p>\u6b64\u65f6\u884c\u7684\u5c5e\u6027\u4fbf\u4e0d\u80fd\u4f7f\u7528\u4e86\u3002SQL \u7684\u4e16\u754c\u5176\u5b9e\u662f\u5c42\u7ea7\u5206\u660e\u7684\u7b49\u7ea7\u793e\u4f1a\uff0c\u5c06\u4f4e\u9636\u6982\u5ff5\u7684\u5c5e\u6027\u7528\u5728\u9ad8\u9636\u6982\u5ff5\u4e0a\u4f1a\u5bfc\u81f4\u79e9\u5e8f\u7684\u6df7\u4e71\uff0c\u8fd9\u662f\u4e0d\u5141\u8bb8\u7684\u3002</p> <p>\u6309\u591a\u5b57\u6bb5\u5206\u7ec4\uff0c\u6240\u6709\u5b57\u6bb5\u503c\u76f8\u540c\u7684\u624d\u80fd\u7b97\u4e00\u7ec4\u3002<code>GROUP BY X, Y</code> \u610f\u601d\u662f\u5c06\u6240\u6709\u5177\u6709\u76f8\u540c X \u5b57\u6bb5\u503c\u548c Y \u5b57\u6bb5\u503c\u7684\u8bb0\u5f55\u653e\u5230\u4e00\u4e2a\u5206\u7ec4\u91cc\u3002</p> <p>\u53c2\u8003</p> <p>\u53c2\u8003 2</p> <pre><code>-- \u67e5\u8be2\u6bcf\u4e2a\u7cfb\u7684\u7537\u6559\u5e08\u5e73\u5747\u5de5\u8d44(\u7cfb\u540d\uff0c\u5e73\u5747\u5de5\u8d44)\n-- where\u8fc7\u6ee4\u51fa\u6240\u6709\u7537\u6559\u5e08\u3002group by\u6309\u7cfb\u5206\u7ec4\uff0c\u805a\u5408\u8ba1\u7b97\u67e5\u51fa\u9700\u8981\u7684\u5217\nselect dept_name ,avg(salary) from instructor  where employe_type=\"male\" group by dept_name\n\n\n-- \u5bf9\u4e8e\u4e0b\u9762\u8fd9\u6837\u7684\u4e24\u4e2a\u8868\uff1a\n\n-- \u9879\u76ee\uff08\u9879\u76ee\u540d\u79f0\uff0c\u9879\u76ee\u7ecf\u7406\uff0c\u4ef7\u683c\uff09\n-- \u6d88\u8d39\uff08\u6d88\u8d39\u6d41\u6c34\u53f7\uff0c\u4f1a\u5458\u624b\u673a\u53f7\uff0c\u9879\u76ee\u540d\u79f0\uff0c\u6d88\u8d39\u91d1\u989d\uff0c\u6d88\u8d39\u65e5\u671f\uff09\n-- \u6bcf\u4e2a\u9879\u76ee\u53ea\u80fd\u6709\u4e00\u4e2a\u9879\u76ee\u7ecf\u7406\uff0c\u4e00\u4e2a\u9879\u76ee\u7ecf\u7406\u53ea\u80fd\u8d1f\u8d23\u4e00\u4e2a\u9879\u76ee\n\n\n-- \u95ee\u9898\uff1a\u7edf\u8ba1\u51fa\u6240\u8d1f\u8d23\u9879\u76ee\u6d88\u8d39\u603b\u91d1\u989d\u5927\u4e8e\u7b49\u4e8e10\u4e07\u7684\u9879\u76ee\u548c\u9879\u76ee\u7ecf\u7406\u4fe1\u606f\n\n\n\nSELECT\n    \u9879\u76ee.\u9879\u76ee\u540d\u79f0,\n    \u9879\u76ee.\u9879\u76ee\u7ecf\u7406,\n    sum( \u6d88\u8d39\u91d1\u989d )\nFROM\n    \u9879\u76ee,\u6d88\u8d39\nWHERE\n    \u9879\u76ee.\u9879\u76ee\u540d\u79f0 = \u6d88\u8d39.\u9879\u76ee\u540d\u79f0\nGROUP BY\n    \u9879\u76ee.\u9879\u76ee\u540d\u79f0 \u9879\u76ee.\u9879\u76ee\u7ecf\u7406\nHAVING\n    sum( \u6d88\u8d39\u91d1\u989d ) &gt; 10000\nORDER BY\n    sum( \u6d88\u8d39\u91d1\u989d ) DESC\n</code></pre>"},{"location":"basic/4.sql/#_29","title":"\u5206\u7ec4\u5408\u8ba1\u5c0f\u8ba1","text":"<p>\u5728 <code>SQL</code> \u4e2d\u53ef\u4ee5\u4f7f\u7528 <code>GROUP BY</code> \u5b50\u53e5\u7684\u6269\u5c55\u9009\u9879\uff1a<code>ROLLUP</code>\u3002<code>ROLLUP</code> \u53ef\u4ee5\u751f\u6210\u6309\u7167\u5c42\u7ea7\u8fdb\u884c\u6c47\u603b\u7684\u7ed3\u679c\uff0c\u7c7b\u4f3c\u4e8e\u8d22\u52a1\u62a5\u8868\u4e2d\u7684\u5c0f\u8ba1\u3001\u5408\u8ba1\u548c\u603b\u8ba1\u3002</p> <pre><code>CREATE TABLE `tbl_ware` (\n  `ware_id` BIGINT(20) UNSIGNED NOT NULL AUTO_INCREMENT COMMENT '\u5546\u54c1id',\n  `ware_name` VARCHAR(100) NOT NULL COMMENT '\u5546\u54c1\u540d\u79f0',\n  `ware_category` VARCHAR(100) NOT NULL COMMENT '\u5546\u54c1\u7c7b\u522b',\n  `sale_unit_price` INT COMMENT '\u9500\u552e\u5355\u4ef7',\n  `purchase_unit_price` INT COMMENT '\u8fdb\u8d27\u5355\u4ef7',\n  `registration_date` DATE COMMENT '\u767b\u8bb0\u65e5\u671f',\n  PRIMARY KEY (`ware_id`) USING BTREE\n) ENGINE=InnoDB COMMENT='\u4ea7\u54c1';\n\nINSERT INTO tbl_ware VALUES\n(1,'T\u6064\u886b','\u8863\u670d',100, 50,'2023-12-15'),\n(2,'\u6253\u5b54\u5668','\u529e\u516c\u7528\u54c1',25, 10,'2023-12-15'),\n(3,'\u8fd0\u52a8T\u6064','\u8863\u670d',150, 50,'2023-12-15'),\n(4,'\u83dc\u5200','\u53a8\u623f\u7528\u5177',75, 30,'2023-12-15'),\n(5,'\u9ad8\u538b\u9505','\u53a8\u623f\u7528\u5177',600, 200,'2023-12-15'),\n(6,'\u53c9\u5b50','\u53a8\u623f\u7528\u5177',7, 3,'2023-12-15'),\n(7,'\u83dc\u677f','\u53a8\u623f\u7528\u5177',98, 30,'2023-12-15'),\n(8,'\u5706\u73e0\u7b14','\u529e\u516c\u7528\u54c1',5, 2,'2023-12-15');\n\n\n-- \u7edf\u8ba1\u6bcf\u4e2a\u7c7b\u522b\u4ea7\u54c1\u7684\u603b\u8fdb\u4ef7\nSELECT ware_category AS '\u5546\u54c1\u7c7b\u522b' , SUM(purchase_unit_price) AS '\u603b\u8fdb\u4ef7' FROM tbl_ware GROUP BY ware_category;\n\n-- \u5982\u679c\u8fd8\u8981\u540c\u65f6\u7edf\u8ba1\u6240\u6709\u603b\u8fdb\u4ef7\uff1a\u4e24\u4e2aSELECT\u7ed3\u679c\u96c6\u8fde\u63a5\u8d77\u6765\nSELECT ware_category AS '\u5546\u54c1\u7c7b\u522b' , SUM(purchase_unit_price) AS '\u603b\u8fdb\u4ef7' FROM tbl_ware GROUP BY ware_category;\nUNION ALL\nSELECT ware_category AS '\u5408\u8ba1' , SUM(purchase_unit_price) AS '\u603b\u8fdb\u4ef7' FROM tbl_ware ;\n\n\n-- \u6700\u540e\u4e00\u884c\u5176\u5b9e\u5c31\u662f\u5408\u8ba1\uff0cWITH ROLLUP \u662f MySQL \u7684\u72ec\u6709\u5199\u6cd5\nSELECT ware_category AS '\u5546\u54c1\u7c7b\u522b' , SUM(purchase_unit_price) AS '\u603b\u8fdb\u4ef7' FROM tbl_ware GROUP BY ware_category WITH ROLLUP;\n</code></pre>"},{"location":"basic/4.sql/#mysql-group-by","title":"MySQL group by \u9690\u5f0f\u6392\u5e8f","text":"<p>\u9690\u5f0f\u6392\u5e8f\u548c\u964d\u5e8f\u7d22\u5f15</p>"},{"location":"basic/4.sql/#_30","title":"\u5206\u7ec4\u539f\u7406\u548c\u4f18\u5316","text":"<p><code>MySQL</code> \u5185\u90e8\u5bf9 <code>GROUP BY</code> \u7684\u5b9e\u73b0\u65b9\u5f0f\u6709\u4e09\u79cd\uff0c\u677e\u6563\u7d22\u5f15\uff0c\u7d27\u51d1\u7d22\u5f15\uff0c\u4e34\u65f6\u6587\u4ef6\uff08\u6587\u4ef6\u6392\u5e8f\uff09\u3002</p> <p>\u5728\u6ca1\u6709\u5408\u9002\u7684\u7d22\u5f15\u53ef\u7528\u7684\u65f6\u5019\uff0c\u901a\u5e38\u5148\u626b\u63cf\u6574\u4e2a\u8868\u63d0\u53d6\u6570\u636e\u5e76\u521b\u5efa\u4e00\u4e2a\u4e34\u65f6\u8868\uff0c\u7136\u540e\u6309\u7167<code>GROUP BY</code>\u6307\u5b9a\u7684\u5217\u8fdb\u884c\u6392\u5e8f\u3002\u5728\u8fd9\u4e2a\u4e34\u65f6\u8868\u91cc\u9762\uff0c\u5bf9\u4e8e\u6bcf\u4e00\u4e2a GROUP \u7684\u6570\u636e\u884c\u6765\u8bf4\u662f\u8fde\u7eed\u5728\u4e00\u8d77\u7684\u3002</p> <p>\u5b8c\u6210\u6392\u5e8f\u4e4b\u540e\uff0c\u5c31\u53ef\u4ee5\u53d1\u73b0\u6240\u6709\u7684 GROUPS\uff0c\u5e76\u53ef\u4ee5\u6267\u884c\u805a\u96c6\u51fd\u6570\uff08aggregate function\uff09\u3002\u53ef\u4ee5\u770b\u5230\uff0c\u5728\u6ca1\u6709\u4f7f\u7528\u7d22\u5f15\u7684\u65f6\u5019\uff0c\u9700\u8981\u521b\u5efa\u4e34\u65f6\u8868\u548c\u6392\u5e8f \u3002\u5728\u6267\u884c\u8ba1\u5212\u4e2d\u901a\u5e38\u53ef\u4ee5\u770b\u5230\"Using temporary; Using filesort\"\u3002</p> <pre><code>explain SELECT city ,count(*) AS 'NUM' FROM user GROUP BY city;\n</code></pre> <p>\u5728 Extra \u5b57\u6bb5\u91cc\u9762\uff0c\u6211\u4eec\u53ef\u4ee5\u770b\u5230\u4ee5\u4e0b\u4fe1\u606f\uff1a</p> <ul> <li>\u7528\u5230\u4e86 Using temporary, \u8868\u793a\u6267\u884c\u65f6\u521b\u5efa\u4e86\u4e00\u4e2a\u5185\u90e8\u4e34\u65f6\u8868\u3002</li> </ul> <p>\u6ce8\u610f\u8fd9\u91cc\u7684\u4e34\u65f6\u8868\u53ef\u80fd\u662f\u5185\u5b58\u4e0a\u7684\u4e34\u65f6\u8868\uff0c\u4e5f\u6709\u53ef\u80fd\u662f\u786c\u76d8\u4e0a\u7684\u4e34\u65f6\u8868\uff0c\u5f53\u7136\uff0c\u5982\u679c\u4e34\u65f6\u8868\u6bd4\u8f83\u5c0f\uff0c\u5c31\u662f\u57fa\u4e8e\u5185\u5b58\u7684\uff0c\u53ef\u4ee5\u80af\u5b9a\u7684\u662f\uff1a\u57fa\u4e8e\u5185\u5b58\u7684\u4e34\u65f6\u8868\u7684\u6027\u80fd\u9ad8\uff0c\u65f6\u95f4\u6d88\u8017\u80af\u5b9a\u8981\u6bd4\u57fa\u4e8e\u786c\u76d8\u7684\u4e34\u65f6\u8868\u7684\u5b9e\u9645\u6d88\u8017\u5c0f\u3002</p> <ul> <li>\u7528\u5230\u4e86 Using filesort\uff0c \u8868\u793a\u6267\u884c\u8fc7\u7a0b\u4e2d\u6ca1\u6709\u4f7f\u7528\u7d22\u5f15\u7684\u6392\u5e8f\uff0c\u800c\u662f\u4f7f\u7528\u4e34\u65f6\u6587\u4ef6\u3002</li> </ul> <p>\"Using filesort\"\u662f MySQL \u7684 EXPLAIN \u8f93\u51fa\u4e2d\u7684\u4e00\u4e2a\u77ed\u8bed\uff0c\u8868\u793a\u67e5\u8be2\u9700\u8981\u4f7f\u7528\u4e34\u65f6\u6587\u4ef6\u5bf9\u7ed3\u679c\u96c6\u8fdb\u884c\u6392\u5e8f\u3002\u8fd9\u53ef\u80fd\u53d1\u751f\u5728\u67e5\u8be2\u5305\u62ec<code>ORDER BY</code>\u5b50\u53e5\u6216<code>GROUP BY</code>\u5b50\u53e5\u65f6\uff0c\u800c\u6570\u636e\u5e93\u65e0\u6cd5\u4f7f\u7528\u7d22\u5f15\u6ee1\u8db3\u6392\u5e8f\u987a\u5e8f\u3002</p> <p>\u4f7f\u7528\u4e34\u65f6\u6587\u4ef6\u5bf9\u5927\u578b\u7ed3\u679c\u96c6\u8fdb\u884c\u6392\u5e8f\u53ef\u80fd\u4f1a\u5bfc\u81f4\u78c1\u76d8 I/O \u548c\u5185\u5b58\u4f7f\u7528\u65b9\u9762\u7684\u6602\u8d35\u5f00\u9500\uff0c\u56e0\u6b64\u6700\u597d\u5c3d\u53ef\u80fd\u907f\u514d\"Using filesort\" </p> <p>\u4e00\u4e9b\u907f\u514d\u6587\u4ef6\u6392\u5e8f\u7684\u7b56\u7565\u5305\u62ec\u4f7f\u7528\u9002\u5f53\u7684\u7d22\u5f15\u4f18\u5316\u67e5\u8be2\uff0c\u9650\u5236\u7ed3\u679c\u96c6\u7684\u5927\u5c0f\u6216\u4fee\u6539\u67e5\u8be2\u4ee5\u4f7f\u7528\u4e0d\u540c\u7684\u6392\u5e8f\u7b97\u6cd5\u3002</p> <p>\u90a3\u4e48 <code>GROUP BY</code> \u8bed\u53e5\u4e3a\u5565\u4f1a\u540c\u65f6\u7528\u5230\u4e34\u65f6\u8868\u548c\u4e34\u65f6\u6587\u4ef6\u6392\u5e8f\u5462\uff1f</p> <p>\u9996\u5148\u770b\u4e0b\u6574\u4e2a\u6267\u884c\u6d41\u7a0b\uff1a</p> <ul> <li>\u5728\u6267\u884c\u8fc7\u7a0b\u4e2d\u9996\u5148\u521b\u5efa\u5185\u5b58\u4e34\u65f6\u8868\uff0c\u8868\u91cc\u6709 city, num \u4e24\u4e2a\u5b57\u6bb5\uff0ccity \u4e3a\u4e3b\u952e\u3002</li> <li>\u626b\u63cf user \u8868\uff0c\u4f9d\u6b21\u53d6\u51fa\u4e00\u884c\u6570\u636e\uff0c\u6570\u636e\u4e2d city \u5b57\u6bb5\u7684\u503c\u4e3a c;</li> <li>\u5982\u679c\u4e34\u65f6\u8868\u4e2d\u6ca1\u6709\u4e3b\u952e\u4e3a c \u7684\u884c\uff0c \u5219\u63d2\u5165\u4e00\u6761\u65b0\u7eaa\u5f55\uff08c \uff0c 1\uff09\uff1b</li> <li>\u5982\u679c\u5b58\u5728\uff0c\u5219\u66f4\u65b0\u8be5\u884c\u4e3a \uff08c, num + 1)\uff1b</li> <li>\u904d\u5386\u5b8c\u540e\uff0c\u518d\u6839\u636e city \u8fdb\u884c\u6392\u5e8f\uff0c\u6700\u540e\u5c06\u7ed3\u679c\u96c6\u8fd4\u56de\u7ed9\u5ba2\u6237\u7aef\u3002</li> </ul>"},{"location":"basic/4.sql/#_31","title":"\u5206\u7ec4\u64cd\u4f5c\u5982\u4f55\u5229\u7528\u7d22\u5f15\uff1f","text":"<p>\u56e0\u4e3a<code>InnoDB</code>\u4f7f\u7528\u57fa\u4e8e<code>B+ tree</code>\u7684\u7d22\u5f15\u7ec4\u7ec7\u8868\uff0c\u56e0\u6b64\u7d22\u5f15\u4e0a\u7684\u5217\u6ee1\u8db3\u5929\u7136\u6709\u5e8f\u6027\uff0c\u5bf9\u4e8e\u7ec4\u5408\u7d22\u5f15\uff0c\u5bf9\u7ec4\u5408\u952e\u503c\u6709\u5e8f\uff1b\u8fd9\u4e2a\u7279\u6027\u53ef\u4ee5\u88ab\u7528\u4e8e\u7d22\u5f15\u626b\u63cf\u4e0d\u540c\u7684<code>group</code>\uff0c\u800c\u4e0d\u9700\u8981\u626b\u63cf\u5168\u90e8\u7684\u7d22\u5f15\u5217\u3002</p> <p>\u56e0\u800c\u4f7f\u7528\u7d22\u5f15\u8fdb\u884c\u5206\u7ec4\u7684\u6700\u91cd\u8981\u7684\u524d\u63d0\u6761\u4ef6\u662f\u6240\u6709<code>GROUP BY</code>\u7684\u53c2\u7167\u5217\uff08\u5206\u7ec4\u4f9d\u636e\u7684\u5217\uff09\u6765\u81ea\u4e8e\u540c\u4e00\u4e2a\u7d22\u5f15\uff0c\u4e14\u7d22\u5f15\u6309\u7167\u987a\u5e8f\u5b58\u50a8\u6240\u6709\u7684 keys\uff08\u5373 BTREE index\uff0c\u800c HASH index \u6ca1\u6709\u987a\u5e8f\u7684\u6982\u5ff5\uff09</p> <ul> <li> <p>\u5728\u677e\u6563\u7d22\u5f15\u626b\u63cf\u65b9\u5f0f\u4e0b\uff0c\u5206\u7ec4\u64cd\u4f5c\u548c\u8303\u56f4\u9884\u6d4b\uff08\u5982\u679c\u6709\u7684\u8bdd\uff09\u4e00\u8d77\u6267\u884c\u5b8c\u6210\u7684\u3002</p> </li> <li> <p>\u5728\u7d27\u51d1\u7d22\u5f15\u626b\u63cf\u65b9\u5f0f\u4e0b\uff0c\u5148\u5bf9\u7d22\u5f15\u6267\u884c\u8303\u56f4\u626b\u63cf\uff08range scan\uff09\uff0c\u518d\u5bf9\u7ed3\u679c\u5143\u7ec4\u8fdb\u884c\u5206\u7ec4\u3002</p> </li> </ul> <p>\u5f53<code>MySQL</code>\u5b8c\u5168\u5229\u7528\u7d22\u5f15\u626b\u63cf\u6765\u5b9e\u73b0<code>GROUP BY</code>\u7684\u65f6\u5019\uff0c\u5e76\u4e0d\u9700\u8981\u626b\u63cf\u6240\u6709\u6ee1\u8db3\u6761\u4ef6\u7684\u7d22\u5f15\u952e\u5373\u53ef\u5b8c\u6210\u5206\u7ec4\u64cd\u4f5c\u7684\u65b9\u5f0f\uff0c\u79f0\u4e3a<code>loose index scan</code>\uff0c\u5b83\u53ef\u4ee5\u6700\u5927\u9650\u5ea6\u7684\u51cf\u5c11\u9700\u8981\u626b\u63cf\u7684<code>ROWS</code>\uff1b</p> <p>\u677e\u6563\u7d22\u5f15\u626b\u63cf\u548c\u7d27\u51d1\u7d22\u5f15\u626b\u63cf\u7684\u6700\u5927\u533a\u522b\u662f\u662f\u5426\u9700\u8981\u626b\u63cf\u6574\u4e2a\u7d22\u5f15\u6216\u8005\u6574\u4e2a\u8303\u56f4\u626b\u63cf </p>"},{"location":"basic/4.sql/#loose-index-scan","title":"\u677e\u6563\u7d22\u5f15(Loose Index Scan)","text":"<p>\u677e\u6563\u7d22\u5f15\u626b\u63cf\u76f8\u5f53\u4e8e<code>Oracle</code>\u4e2d\u7684 \u8df3\u8dc3\u7d22\u5f15\u626b\u63cf\uff08skip index scan\uff09 \uff0c\u5c31\u662f\u4e0d\u9700\u8981\u8fde\u7eed\u626b\u63cf\u7d22\u5f15\u4e2d\u7684\u6bcf\u4e00\u4e2a\u5143\u7ec4\uff0c\u626b\u63cf\u65f6\u4ec5\u8003\u8651\u7d22\u5f15\u4e2d\u7684\u4e00\u90e8\u5206\u3002</p> <ul> <li> <p>\u5f53\u67e5\u8be2\u4e2d\u6ca1\u6709<code>WHERE</code>\u6761\u4ef6\u7684\u65f6\u5019\uff0c\u677e\u6563\u7d22\u5f15\u626b\u63cf\u8bfb\u53d6\u7684\u7d22\u5f15\u5143\u7ec4\u7684\u4e2a\u6570\u548c<code>GROUPS</code>\u7684\u6570\u91cf\u76f8\u540c\u3002</p> </li> <li> <p>\u5982\u679c<code>WHERE</code>\u6761\u4ef6\u5305\u542b\u8303\u56f4\u9884\u6d4b\uff0c\u677e\u6563\u7d22\u5f15\u626b\u63cf\u67e5\u627e\u6bcf\u4e2a<code>GROUP</code>\u4e2d\u7b2c\u4e00\u4e2a\u6ee1\u8db3\u8303\u56f4\u6761\u4ef6\uff0c\u7136\u540e\u518d\u8bfb\u53d6\u6700\u5c11\u53ef\u80fd\u6570\u7684 keys\u3002\u677e\u6563\u7d22\u5f15\u626b\u63cf\u53ea\u9700\u8981\u8bfb\u53d6\u5f88\u5c11\u91cf\u7684\u6570\u636e\u5c31\u53ef\u4ee5\u5b8c\u6210<code>GROUP BY</code>\u64cd\u4f5c\uff0c\u56e0\u800c\u6267\u884c\u6548\u7387\u975e\u5e38\u9ad8\u3002</p> </li> </ul> <p>\u4f7f\u7528\u677e\u6563\u7d22\u5f15\u626b\u63cf\u9700\u8981\u6ee1\u8db3\u4ee5\u4e0b\u6761\u4ef6\uff1a</p> <ol> <li>\u5355\u8868\u67e5\u8be2</li> <li><code>GROUP BY</code>\u6307\u5b9a\u7684\u5206\u7ec4\u5217\u662f\u7d22\u5f15\u7684\u4e00\u4e2a\u6700\u5de6\u524d\u7f00\uff0c\u5e76\u4e14\u6ca1\u6709\u5176\u5b83\u7684\u5217\u3002\u6bd4\u5982\u8868 t1\uff08 c1,c2,c3,c4\uff09\u4e0a\u5efa\u7acb\u4e86\u7d22\u5f15\uff08c1,c2,c3\uff09\u3002\u5982\u679c\u67e5\u8be2\u5305\u542b<code>group by c1,c2</code>\uff0c\u90a3\u4e48\u53ef\u4ee5\u4f7f\u7528\u677e\u6563\u7d22\u5f15\u626b\u63cf\u3002\u4f46\u662f<code>group by c2,c3</code>(\u4e0d\u662f\u7d22\u5f15\u6700\u5de6\u524d\u7f00)\u548c<code>group by c1,c2,c4</code>(c4 \u5b57\u6bb5\u4e0d\u5728\u7d22\u5f15\u4e2d)\u3002</li> <li>\u5982\u679c\u5728\u9009\u62e9\u5217\u8868<code>select list</code>\u4e2d\u5b58\u5728\u805a\u96c6\u51fd\u6570\uff0c\u53ea\u80fd\u4f7f\u7528 <code>min()</code>\u548c<code>max()</code>\u4e24\u4e2a\u805a\u96c6\u51fd\u6570\uff0c\u5e76\u4e14\u6307\u5b9a\u7684\u662f\u540c\u4e00\u5217\uff08\u5982\u679c<code>min()</code>\u548c<code>max()</code>\u540c\u65f6\u5b58\u5728\uff09\u3002\u8fd9\u4e00\u5217\u5fc5\u987b\u5728\u7d22\u5f15\u4e2d\uff0c\u4e14\u7d27\u8ddf\u7740<code>GROUP BY</code>\u6307\u5b9a\u7684\u5217\u3002\u6bd4\u5982<code>select t1,t2,min(t3),max(t3) from t1  group by c1,c2</code>\u3002</li> <li>\u5982\u679c\u67e5\u8be2\u4e2d\u5b58\u5728\u9664\u4e86<code>GROUP BY</code>\u6307\u5b9a\u7684\u5217\u4e4b\u5916\u7684\u7d22\u5f15\u5176\u4ed6\u90e8\u5206\uff0c\u90a3\u4e48\u5fc5\u987b\u4ee5\u5e38\u91cf\u7684\u5f62\u5f0f\u51fa\u73b0\uff08\u9664\u4e86<code>min()</code>\u548c<code>max()</code>\u4e24\u4e2a\u805a\u96c6\u51fd\u6570\uff09\u3002\u6bd4\u5982:</li> </ol> <pre><code>-- \u4e0d\u80fd\u4f7f\u7528\u677e\u6563\u7d22\u5f15\u626b\u63cf\nselect c1,c3 from t1 group by c1,c2;\n-- \u53ef\u4ee5\u4f7f\u7528\u677e\u6563\u7d22\u5f15\u626b\u63cf\nselect c1,c3 from t1 where c3 =  3 group by c1,c2;\n</code></pre> <ol> <li>\u7d22\u5f15\u4e2d\u7684\u5217\u5fc5\u987b\u7d22\u5f15\u6574\u4e2a\u6570\u636e\u5217\u7684\u503c<code>(full column values must be indexed)</code>\uff0c\u800c\u4e0d\u662f\u4e00\u4e2a\u524d\u7f00\u7d22\u5f15\u3002\u6bd4\u5982\uff0c<code>c1 varchar(20), INDEX (c1(10))</code> \u8fd9\u4e2a\u7d22\u5f15\u6ca1\u53d1\u7528\u4f5c\u677e\u6563\u7d22\u5f15\u626b\u63cf\u3002(\u5efa\u524d\u7f00\u7d22\u5f15\uff0c\u4e0e\u4e0a\u9762\u63d0\u5230\u7684\u7d22\u5f15\u7684\u6700\u5de6\u524d\u7f00\u662f\u4e0d\u540c\u7684)</li> </ol> <p>\u5982\u679c\u67e5\u8be2\u80fd\u591f\u4f7f\u7528\u677e\u6563\u7d22\u5f15\u626b\u63cf\uff0c\u90a3\u4e48\u6267\u884c\u8ba1\u5212\u4e2d Etra \u4e2d\u63d0\u793a\"using index for group-by\"</p> <p>\u81ea\u4ece <code>MySQL5.5</code> \u5f00\u59cb\uff0c\u677e\u6563\u7d22\u5f15\u626b\u63cf\u53ef\u4ee5\u4f5c\u7528\u4e8e\u5728<code>SELECT LIST</code>\u4e2d\u5176\u5b83\u5f62\u5f0f\u7684\u805a\u96c6\u51fd\u6570\uff0c\u9664\u4e86<code>MIN()</code>\u548c<code>MAX()</code>\u4e4b\u5916\uff0c\u8fd8\u652f\u6301\uff1a</p> <ol> <li><code>AVG(DISTINCT)</code>, <code>SUM(DISTINCT)</code>\u548c<code>COUNT(DISTINCT)</code>\u53ef\u4ee5\u4f7f\u7528\u677e\u6563\u7d22\u5f15\u626b\u63cf\u3002<code>AVG(DISTINCT)</code>, <code>SUM(DISTINCT)</code>\u53ea\u80fd\u4f7f\u7528\u5355\u4e00\u5217\u4f5c\u4e3a\u53c2\u6570\u3002\u800c<code>COUNT(DISTINCT)</code>\u53ef\u4ee5\u4f7f\u7528\u591a\u5217\u53c2\u6570\u3002</li> <li>\u5728\u67e5\u8be2\u4e2d\u5fc5\u987b\u6ca1\u6709<code>GROUP BY</code>\u548c<code>DISTINCT</code>\u6761\u4ef6\u3002</li> <li>\u4e4b\u524d\u58f0\u660e\u7684\u677e\u6563\u626b\u63cf\u9650\u5236\u6761\u4ef6\u540c\u6837\u8d77\u4f5c\u7528\u3002</li> </ol> <p>\u5728\u5b98\u65b9\u6587\u6863\u4e2d\u63d0\u5230\uff0c\u5f53\u6709<code>GROUP BY</code>\u5b50\u53e5\u65f6\uff0c\u5728\u7279\u5b9a\u7684\u60c5\u51b5\u4e0b\u53ef\u4ee5\u4f7f\u7528\u677e\u6563\u7d22\u5f15\uff0c\u51cf\u5c11\u626b\u63cf\u7684\u6b21\u6570\u3002\u5b98\u65b9\u6587\u6863\u4e2d\u7ed9\u51fa\u4e86\u4ee5\u4e0b\u7684\u4e00\u4e9b\u60c5\u51b5\u53ef\u4ee5\u4f7f\u7528\u5230\u677e\u6563\u7d22\u5f15</p> <pre><code>an index idx(c1,c2,c3) on table t1(c1,c2,c3,c4)\n\nCREATE TABLE `t1` (\n    `c1` int(11) DEFAULT NULL,\n    `c2` int(11) DEFAULT NULL,\n    `c3` int(11) DEFAULT NULL,\n    `c4` int(11) DEFAULT NULL,\n    KEY `idx_g` (`c1`,`c2`,`c3`)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;\n\n-- \u4e0b\u9762\u7684\u67e5\u8be2\u53ef\u4ee5\u4f7f\u7528\u677e\u6563\u7d22\u5f15\u626b\u63cf\nSELECT c1, c2 FROM t1 GROUP BY c1, c2;\nSELECT DISTINCT c1, c2 FROM t1;\nSELECT c1, MIN(c2) FROM t1 GROUP BY c1;\nSELECT c1, c2 FROM t1 WHERE c1 &lt; const GROUP BY c1, c2;\nSELECT MAX(c3), MIN(c3), c1, c2 FROM t1 WHERE c2 &gt; const GROUP BY c1, c2;\nSELECT c2 FROM t1 WHERE c1 &lt; const GROUP BY c1, c2;\nSELECT c1, c2 FROM t1 WHERE c3 = const GROUP BY c1, c2;\n\n\n-- \u4e0b\u9762\u7684\u67e5\u8be2\u4e0d\u80fd\u4f7f\u7528\u677e\u6563\u7d22\u5f15\u626b\u63cf\nSELECT c1, SUM(c2) FROM t1 GROUP BY c1;\nSELECT c1, c2 FROM t1 GROUP BY c2, c3;\nSELECT c1, c3 FROM t1 GROUP BY c1, c2;\n</code></pre> <p>\u4e3a\u4ec0\u4e48\u677e\u6563\u7d22\u5f15\u626b\u63cf\u88ab\u9650\u5236\u6210\u53ea\u80fdMIN()\u548cMAX()\uff0c\u800c\u4e0d\u80fd\u7528\u5176\u4ed6\u7684SUM()\u3001COUNT()\u3001AVG()\u3001DISTINCT()\u7b49\u805a\u5408\u51fd\u6570\u5462\uff1f</p> <ul> <li> <p>\u7d22\u5f15\u662f\u6709\u5e8f\u7684\u3002</p> </li> <li> <p>\u627e\u5230\u67d0\u4e00\u7ec4\u7684\u7b2c\u4e00\u6761\u8bb0\u5f55\u5c31\u662f\u8be5\u7ec4\u7684\u6700\u5c0f\u503c\uff0c</p> </li> <li> <p>\u627e\u5230\u8be5\u7ec4\u7684\u6700\u540e\u4e00\u6761\u8bb0\u5f55\u5c31\u662f\u8be5\u7ec4\u7684\u6700\u5927\u503c\u3002</p> </li> </ul> <p>\u6240\u4ee5\uff0c\u626b\u63cf\u65f6\u53ea\u9700\u8df3\u5230\u6bcf\u4e2a\u7ec4\u7684\u7b2c\u4e00\u884c\u6216\u6700\u540e\u4e00\u884c\uff0c\u6210\u672c\u6781\u4f4e\u3002\u677e\u6563\u7d22\u5f15\u7684\u7279\u6027\u662f\"\u8df3\u8fc7\u7ec4\u5185\u5927\u90e8\u5206\u8bb0\u5f55\"\uff0c\u53ea\u770b\u4e00\u6761\u4ee3\u8868\u6027\u7684\u8bb0\u5f55\uff08\u6bd4\u5982\u7b2c\u4e00\u6761\uff09\u3002</p>"},{"location":"basic/4.sql/#tight-index-scan","title":"\u7d27\u51d1\u7d22\u5f15\u626b\u63cf(Tight Index Scan)","text":"<p>\u7d27\u51d1\u7d22\u5f15\u626b\u63cf\u53ef\u80fd\u662f**\u5168\u7d22\u5f15\u626b\u63cf**\u6216\u8005**\u8303\u56f4\u7d22\u5f15\u626b\u63cf**\uff0c\u5177\u4f53\u4e5f\u8981\u53d6\u51b3\u4e8e\u67e5\u8be2\u6761\u4ef6\u3002</p> <p>\u5f53\u677e\u6563\u7d22\u5f15\u626b\u63cf\u6761\u4ef6\u6ca1\u6709\u6ee1\u8db3\u7684\u65f6\u5019\uff0c<code>GROUP BY</code>\u4ecd\u7136\u6709\u53ef\u80fd\u907f\u514d\u521b\u5efa\u4e34\u65f6\u8868\u3002\u5982\u679c\u5728 <code>WHERE</code> \u6761\u4ef6\u6709\u8303\u56f4\u626b\u63cf\uff0c\u90a3\u4e48\u7d27\u51d1\u7d22\u5f15\u626b\u63cf\u4ec5\u8bfb\u53d6\u6ee1\u8db3\u8fd9\u4e9b\u6761\u4ef6\u7684 keys\uff08\u7d22\u5f15\u5143\u7ec4\uff09\uff0c\u5426\u5219\u6267\u884c\u5168\u7d22\u5f15\u626b\u63cf\u3002</p> <p>\u8fd9\u79cd\u65b9\u5f0f\u8bfb\u53d6\u6240\u6709 <code>WHERE</code> \u6761\u4ef6\u5b9a\u4e49\u7684\u8303\u56f4\u5185\u7684 keys\uff0c\u6216\u8005\u626b\u63cf\u6574\u4e2a\u7d22\u5f15\uff0c\u56e0\u800c\u79f0\u4f5c**\u7d27\u51d1\u7d22\u5f15\u626b\u63cf**\u3002\u5bf9\u4e8e\u7d27\u51d1\u7d22\u5f15\u626b\u63cf\uff0c\u53ea\u6709\u5728\u6240\u6709\u6ee1\u8db3\u8303\u56f4\u6761\u4ef6\u7684 <code>keys</code> \u88ab\u627e\u5230\u4e4b\u540e\u624d\u4f1a\u6267\u884c\u5206\u7ec4\u64cd\u4f5c\u3002</p> <p>\u5982\u679c\u7d27\u51d1\u7d22\u5f15\u626b\u63cf\u8d77\u4f5c\u7528\uff0c\u90a3\u4e48\u5fc5\u987b\u6ee1\u8db3\uff1a</p> <p>\u5728\u67e5\u8be2\u4e2d\u5b58\u5728\u5e38\u91cf\u76f8\u7b49<code>WHERE</code>\u6761\u4ef6\u5b57\u6bb5\uff08\u7d22\u5f15\u4e2d\u7684\u5b57\u6bb5\uff09\uff0c\u4e14\u8be5\u5b57\u6bb5\u5728<code>GROUP BY</code>\u6307\u5b9a\u7684\u5b57\u6bb5\u7684\u524d\u9762\u6216\u8005\u4e2d\u95f4\u3002\u6765\u81ea\u4e8e\u76f8\u7b49\u6761\u4ef6\u7684\u5e38\u91cf\u80fd\u591f\u586b\u5145\u641c\u7d22 keys \u4e2d\u7684 gaps\uff0c\u56e0\u800c\u53ef\u4ee5\u6784\u6210\u4e00\u4e2a\u7d22\u5f15\u7684\u5b8c\u6574\u524d\u7f00\u3002</p> <p>\u7d22\u5f15\u524d\u7f00\u80fd\u591f\u7528\u4e8e\u7d22\u5f15\u67e5\u627e\u3002\u5982\u679c\u8981\u6c42\u5bf9<code>GROUP BY</code>\u7684\u7ed3\u679c\u8fdb\u884c\u6392\u5e8f\uff0c\u5e76\u4e14\u67e5\u627e\u5b57\u6bb5\u7ec4\u6210\u4e00\u4e2a\u7d22\u5f15\u524d\u7f00\uff0c\u90a3\u4e48 MySQL \u540c\u6837\u53ef\u4ee5\u907f\u514d\u989d\u5916\u7684\u6392\u5e8f\u64cd\u4f5c\u3002</p> <pre><code>-- \uff081\uff09SQL\u6267\u884c\u8ba1\u5212 \"Using where; Using index\" \u4f7f\u7528\u7d27\u51d1\u7d22\u5f15\u626b\u63cf\uff0c\u7d22\u5f15\u5217\u8303\u56f4\u67e5\u8be2\nexplain SELECT DISTINCT `c1` FROM t1 WHERE `c2`&gt;'B';\n\n-- \uff082\uff09SQL\u6267\u884c\u8ba1\u5212 \"Using where; Using index for group-by\" \u4f7f\u7528\u677e\u6563\u7d22\u5f15\u626b\u63cf\uff0c\u7d22\u5f15\u5217\u7b49\u503c\u67e5\u8be2\nexplain SELECT DISTINCT `c1` FROM t1 WHERE `c2`='B';\n\n-- \uff083\uff09SQL\u6267\u884c\u8ba1\u5212 \"Using index for group-by\" \u4f7f\u7528\u677e\u6563\u7d22\u5f15\u626b\u63cf\nexplain SELECT MIN(c2) from t1 group by c1;\n\n-- \uff084\uff09SQL\u6267\u884c\u8ba1\u5212 \"Using index\" \u4f7f\u7528min/max\u4e4b\u5916\u7684\u5176\u5b83\u805a\u96c6\u51fd\u6570\uff0c\u5219\u4e0d\u80fd\u4f7f\u7528\u677e\u6563\u7d22\u5f15\u626b\u63cf\uff0c\u4f7f\u7528\u7d27\u51d1\u7d22\u5f15\u626b\u63cf\nexplain SELECT SUM(c2) from t1 group by c1;\n\n-- \uff085\uff09SQL\u6267\u884c\u8ba1\u5212 \"Using index for group-by\" \u4f7f\u7528\u677e\u6563\u7d22\u5f15\u626b\u63cf\uff0c\u6ee1\u8db3\u7d22\u5f15\u524d\u7f00\nexplain SELECT `c1`,`c2` FROM t1 GROUP BY `c1`,`c2`;\n\n-- \uff086\uff09SQL\u6267\u884c\u8ba1\u5212 \"Using where; Using index for group-by\" \u4f7f\u7528\u677e\u6563\u7d22\u5f15\u626b\u63cf\uff0c\u6ee1\u8db3\u7d22\u5f15\u524d\u7f00\u3001\u7d22\u5f15\u5217\u7b49\u503c\u67e5\u8be2\nexplain SELECT `c1`,`c2`,`c3` FROM t1  WHERE c3='C' GROUP BY `c1`,`c2`;\n\n-- \uff087\uff09SQL\u6267\u884c\u8ba1\u5212 \"Using where; Using index for group-by\" \u4f7f\u7528\u677e\u6563\u7d22\u5f15\u626b\u63cf\uff0c\u867d\u7136\u4e0d\u6ee1\u8db3\u7d22\u5f15\u524d\u7f00\uff0c\u4f46\u524d\u7f00\u4e2d\u7684\u5217\u4e3a\u5e38\u91cf\nexplain SELECT `c1`,`c2`,`c3` FROM t1  WHERE c1='C' GROUP BY `c1`,`c2`,`c3`;\n\n-- \uff088\uff09SQL\u6267\u884c\u8ba1\u5212 \"Using index; Using temporary; Using filesort\"\uff0c\u4f7f\u7528\u4e34\u65f6\u8868\uff0c\u4e0d\u6ee1\u8db3\u524d\u7f00\u7d22\u5f15\uff0c\u5206\u7ec4\u65e0\u6cd5\u8d70\u7d22\u5f15\uff0c\u9700\u8981\u4e34\u65f6\u8868\u5e76\u5bf9\u5206\u7ec4\u5185\u5143\u7d20\u6392\u5e8f\nexplain SELECT `c2`,`c3` FROM t1 GROUP BY `c2`,`c3`;\n\n-- \uff089\uff09SQL\u6267\u884c\u8ba1\u5212 \"Using index; Using temporary; Using filesort\"\uff0c\u4f7f\u7528\u4e34\u65f6\u8868\uff0c\u4e0d\u6ee1\u8db3\u524d\u7f00\u7d22\u5f15\uff0c\u5206\u7ec4\u65e0\u6cd5\u8d70\u7d22\u5f15\uff0c\u9700\u8981\u4e34\u65f6\u8868\u5e76\u5bf9\u5206\u7ec4\u5185\u5143\u7d20\u6392\u5e8f\nexplain SELECT `c1`,`c3` FROM t1 GROUP BY `c1`,`c3`;\n\n-- \uff0810\uff09SQL\u6267\u884c\u8ba1\u5212 \"Using where; Using index\"\uff0c\u4f7f\u7528\u7d27\u51d1\u7d22\u5f15\u626b\u63cf\uff0c\u5374\u522b\u4e8e\uff089\uff09\u4f7f\u7528\u4e34\u65f6\u8868\uff0c\u5c3d\u7ba1\u4e0d\u6ee1\u8db3\u524d\u7f00\u7d22\u5f15\uff0c\u4f46\u524d\u7f00\u4e2d\u7684\u5217\u4e3a\u5e38\u91cf\nexplain SELECT `c1`,`c3` FROM t1 WHERE c2='B' GROUP BY `c1`,`c3`;\n</code></pre>"},{"location":"basic/4.sql/#_32","title":"\u5c3d\u91cf\u4f7f\u7528\u5185\u5b58\u8868","text":"<p>\u5982\u679c<code>GROUP BY</code>\u9700\u8981\u7edf\u8ba1\u7684\u6570\u636e\u4e0d\u591a\uff0c\u6211\u4eec\u53ef\u4ee5\u5c3d\u91cf\u53ea\u4f7f\u7528\u5185\u5b58\u4e34\u65f6\u8868\uff1b\u56e0\u4e3a\u5982\u679c<code>GROUP BY</code>\u7684\u8fc7\u7a0b\u56e0\u4e3a\u5185\u5b58\u4e34\u65f6\u8868\u653e\u4e0d\u4e0b\u6570\u636e\uff0c\u4ece\u800c\u7528\u5230\u78c1\u76d8\u4e34\u65f6\u8868\u7684\u8bdd\uff0c\u662f\u6bd4\u8f83\u8017\u65f6\u7684\u3002\u56e0\u6b64\u53ef\u4ee5\u9002\u5f53\u8c03\u5927<code>tmp_table_size</code>\u53c2\u6570\uff0c\u6765\u907f\u514d\u7528\u5230\u78c1\u76d8\u4e34\u65f6\u8868\u3002</p>"},{"location":"basic/4.sql/#sql_big_result","title":"\u4f7f\u7528 SQL_BIG_RESULT \u4f18\u5316","text":"<p>\u5982\u679c\u6570\u636e\u91cf\u5b9e\u5728\u592a\u5927\u600e\u4e48\u529e\u5462\uff1f\u603b\u4e0d\u80fd\u65e0\u9650\u8c03\u5927<code>tmp_table_size</code>\u5427\uff1f\u4f46\u4e5f\u4e0d\u80fd\u773c\u7741\u7741\u770b\u7740\u6570\u636e\u5148\u653e\u5230\u5185\u5b58\u4e34\u65f6\u8868\uff0c\u968f\u7740\u6570\u636e\u63d2\u5165\u53d1\u73b0\u5230\u8fbe\u4e0a\u9650\uff0c\u518d\u8f6c\u6210\u78c1\u76d8\u4e34\u65f6\u8868\u5427\uff1f\u8fd9\u6837\u5c31\u6709\u70b9\u4e0d\u667a\u80fd\u5566\u3002</p> <p>\u56e0\u6b64\uff0c\u5982\u679c\u9884\u4f30\u6570\u636e\u91cf\u6bd4\u8f83\u5927\uff0c\u6211\u4eec\u4f7f\u7528<code>SQL_BIG_RESULT</code>\u8fd9\u4e2a\u63d0\u793a\u76f4\u63a5\u7528\u78c1\u76d8\u4e34\u65f6\u8868\u3002MySQl \u4f18\u5316\u5668\u53d1\u73b0\uff0c\u78c1\u76d8\u4e34\u65f6\u8868\u662f B+\u6811\u5b58\u50a8\uff0c\u5b58\u50a8\u6548\u7387\u4e0d\u5982\u6570\u7ec4\u6765\u5f97\u9ad8\u3002\u56e0\u6b64\u4f1a\u76f4\u63a5\u7528\u6570\u7ec4\u6765\u5b58\u3002</p> <pre><code>SELECT SQL_BIG_RESULT city,count(*) AS num FROM staff GROUP BY city;\n</code></pre>"},{"location":"basic/4.sql/#_33","title":"\u5bf9\u5206\u7ec4\u9650\u5b9a\u6761\u4ef6","text":"<p>\u5bf9\u5206\u7ec4\u7684\u7ed3\u679c\u9650\u5b9a\u67e5\u8be2\u67e5\u8be2\u6761\u4ef6\uff0c\u4f7f\u7528 <code>HAVING</code> \u5b50\u53e5\uff0c\u4e3a\u8981\u5206\u7ec4\u7684\u6807\u51c6\u9650\u5b9a\u6761\u4ef6\u3002\u5373\u5bf9\u5206\u7ec4\u4e4b\u540e\u518d\u5bf9\u6570\u636e\u8fdb\u884c\u8fc7\u6ee4</p> <p>HAVING \u64cd\u4f5c\u7684\u5bf9\u8c61\u662f\u7ec4\uff0c\u90a3\u4e48\u5176\u4f7f\u7528\u7684\u8981\u7d20\u662f\u6709\u4e00\u5b9a\u9650\u5236\u7684\uff0c\u80fd\u591f\u4f7f\u7528\u7684\u8981\u7d20\u6709 3 \u79cd: \u5e38\u6570\u3001\u805a\u5408\u51fd\u6570\u548c\u805a\u5408\u952e \uff0c\u805a\u5408\u952e\u4e5f\u5c31\u662f <code>GROUP BY</code> \u5b50\u53e5\u4e2d\u6307\u5b9a\u7684\u5217\u540d\u3002</p> <p><code>WHERE</code>\u662f\u5728\u5206\u7ec4\uff08\u805a\u5408\uff09\u524d\u5bf9\u8bb0\u5f55\u8fdb\u884c\u7b5b\u9009\uff0c\u800c<code>HAVING</code>\u662f\u5728\u5206\u7ec4\u7ed3\u675f\u540e\u7684\u7ed3\u679c\u91cc\u7b5b\u9009\uff0c\u6700\u540e\u8fd4\u56de\u8fc7\u6ee4\u540e\u7684\u7ed3\u679c\u3002</p> <p><code>HAVING</code>\u5b50\u53e5\u5fc5\u987b\u5199\u5728<code>GROUP BY</code>\u5b50\u53e5\u4e4b\u540e\uff0c\u5176\u5728<code>RDBMS</code>\u5185\u90e8\u7684\u6267\u884c\u987a\u5e8f\u4e5f\u6392\u5728<code>GROUP BY</code>\u5b50\u53e5\u4e4b\u540e\u3002</p> <pre><code>--\u4ec5\u67e5\u8be2\u5e73\u5747\u5de5\u8d44\u5927\u4e8e4000\u7684\u7cfb\uff0c\u5217\u51fa\u8fd9\u6837\u7cfb\u7684\u7cfb\u540d\u548c\u5e73\u5747\u5de5\u8d44\n\nSELECT dept_name ,avg(salary) FROM instructor GROUP BY dept_name HAVING AVG(salary) &gt; 4000;\n\nSELECT user_id  FROM user GROUP BY user_id\n\n-- \u53e6\u5916\u4e00\u79cd\u601d\u8def\uff0c\u628a\u6240\u6709\u7cfb\u7684\u5e73\u5747\u5de5\u8d44\u67e5\u51fa\u6765\uff0c\u518d\u4ece\u8fd9\u4e2a\u7ed3\u679c\u91cc\u9762\u67e5\u5e73\u5747\u5de5\u8d44\u5927\u4e8e4000\u7684\nSELECT   dept_name , avg(salary) FROM ( SELECT dept_name ,avg(salary)  FROM instructor GROUP BY dept_name ) WHERE AVG(salary) &gt; 4000;\n</code></pre> <p>\u53c2\u8003</p>"},{"location":"basic/4.sql/#_34","title":"\u53bb\u91cd\u67e5\u8be2","text":"<p>\u6309\u7167<code>SQL</code>\u6807\u51c6\uff0c<code>DISTINCT</code>\u662f\u4e00\u79cd\u7528\u4e8e\u53bb\u9664<code>SELECT</code>\u8bed\u53e5\u8fd4\u56de\u7ed3\u679c\u4e2d\u91cd\u590d\u884c\u7684\u5173\u952e\u5b57\u3002\u5728\u4f7f\u7528<code>SELECT</code>\u8bed\u53e5\u67e5\u8be2\u6570\u636e\u65f6\uff0c\u5982\u679c\u7ed3\u679c\u96c6\u4e2d\u5305\u542b\u91cd\u590d\u7684\u884c\uff0c\u53ef\u4ee5\u4f7f\u7528<code>SELECT DISTINCT</code>\u8bed\u53e5\u6765\u53bb\u9664\u8fd9\u4e9b\u91cd\u590d\u7684\u884c</p> <pre><code>-- distinct\u652f\u6301\u5355\u5217\u3001\u591a\u5217\u7684\u53bb\u91cd\u65b9\u5f0f\n\nSELECT name FROM users;                 --\u8fd4\u56de\u4e00\u4e2a\u5305\u542b\u91cd\u590d\u884c\u7684\u7ed3\u679c\u96c6\nSELECT DISTINCT name FROM users;        --\u53bb\u9664\u91cd\u590d\u7684\u884c\n-- \u9700\u8981\u6ce8\u610f\u7684\u662f\uff0cDISTINCT \u5173\u952e\u5b57\u4f1a\u5bf9\u67e5\u8be2\u7684\u6027\u80fd\u4ea7\u751f\u4e00\u5b9a\u7684\u5f71\u54cd\uff0c\u56e0\u4e3a\u5b83\u9700\u8981\u5bf9\u7ed3\u679c\u96c6\u8fdb\u884c\u6392\u5e8f\u548c\u53bb\u91cd\u7684\u64cd\u4f5c\u3002\u56e0\u6b64\uff0c\u5728\u4f7f\u7528 DISTINCT \u5173\u952e\u5b57\u65f6\u9700\u8981\u8c28\u614e\uff0c\u5c3d\u53ef\u80fd\u5730\u4f7f\u7528\u7d22\u5f15\u6765\u4f18\u5316\u67e5\u8be2\uff0c\u4ee5\u63d0\u9ad8\u67e5\u8be2\u7684\u6027\u80fd\u3002\n\nSELECT DISTINCT columns FROM table_name WHERE where_conditions;   --DISTINCT\u7528\u6cd5\n-- \u6309\u7167SQL\u6807\u51c6\uff0cDISTINCT\u5b50\u53e5\u5c06\u6240\u6709NULL\u503c\u89c6\u4e3a\u76f8\u540c\u7684\u503c\uff0c\u5982\u679c\u5217\u5177\u6709NULL\u503c\uff0c\u5e76\u4e14\u5bf9\u8be5\u5217\u4f7f\u7528DISTINCT\u5b50\u53e5\uff0cMySQL\u5c06\u4fdd\u7559\u4e00\u4e2aNULL\u503c\uff0c\u5e76\u5220\u9664\u5176\u5b83\u7684NULL\u503c\u3002\n\n\n\n-- \u591a\u5217\u7684\u53bb\u91cd\u5219\u662f\u6839\u636e\u6307\u5b9a\u7684\u53bb\u91cd\u7684\u5217\u4fe1\u606f\u6765\u8fdb\u884c\uff0c\u5373\u53ea\u6709\u6240\u6709\u6307\u5b9a\u7684\u5217\u4fe1\u606f\u90fd\u76f8\u540c\uff0c\u624d\u4f1a\u88ab\u8ba4\u4e3a\u662f\u91cd\u590d\u7684\u4fe1\u606f\u3002\nSELECT DISTINCT column1,column2 FROM table_name WHERE where_conditions;\n\n\n-- \u8fd9\u6761\u8bed\u53e5\u4e2d\u7684 DISTINCT \u8868\u793a\u8fd4\u56de\u4e0d\u540c\u90e8\u95e8 id \u548c\u6027\u522b\u7684\u7ec4\u5408\u503c\u3002\nSELECT DISTINCT dept_id, sex FROM employee;\n\n-- GROUP BY\u4e5f\u53ef\u4ee5\u8fbe\u5230\u540c\u6837\u7684\u6548\u679c\nSELECT dept_id, sexFROM employee GROUP BY dept_id, sex;\n</code></pre> <pre><code>-- \u6240\u6709\u5217\u90fd\u76f8\u540c\uff0c\u624d\u88ab\u8ba4\u4e3a\u662f\u91cd\u590d\u7684\u3002\nSELECT DISTINCT * FROM TABLE\n\n-- \u4e24\u6761\u8bb0\u5f55\u4e4b\u95f4\u4e4b\u540e\u53ea\u6709\u90e8\u5206\u5b57\u6bb5\u7684\u503c\u662f\u6709\u91cd\u590d\u7684\uff0c\u4f46\u662f\u4e3b\u952e\u552f\u4e00\nSELECT * FROM TABLE WHERE ID IN (SELECT MAX(ID) FROM TABLE GROUP BY [\u53bb\u9664\u91cd\u590d\u7684\u5b57\u6bb5\u540d\u5217\u8868,....])\n</code></pre> <p><code>GROUP BY</code>\u4e3b\u8981\u7684\u4f7f\u7528\u573a\u666f\u662f\u5728\u5206\u7ec4\u805a\u5408\u3002\u5177\u4f53\u6765\u8bf4\uff0c<code>GROUP BY</code>\u5b50\u53e5\u901a\u5e38\u7528\u4e8e\u5c06\u67e5\u8be2\u7ed3\u679c\u6309\u7167\u4e00\u4e2a\u6216\u591a\u4e2a\u5217\u8fdb\u884c\u5206\u7ec4\uff0c\u7136\u540e\u5bf9\u6bcf\u4e2a\u7ec4\u8fdb\u884c\u805a\u5408\u8ba1\u7b97\u3002</p> <p>\u4f8b\u5982\uff0c\u5047\u8bbe\u4e00\u4e2a\u8868\u5b58\u50a8\u4e86\u6bcf\u4e2a\u4eba\u7684\u59d3\u540d\u3001\u5e74\u9f84\u548c\u6240\u5728\u57ce\u5e02\uff0c\u53ef\u4ee5\u4f7f\u7528<code>GROUP BY</code>\u5b50\u53e5\u6309\u7167\u57ce\u5e02\u5bf9\u4eba\u8fdb\u884c\u5206\u7ec4\uff0c\u5e76\u8ba1\u7b97\u6bcf\u4e2a\u57ce\u5e02\u7684\u5e73\u5747\u5e74\u9f84\u6216\u4eba\u53e3\u6570\u91cf\u7b49\u7edf\u8ba1\u4fe1\u606f\u3002</p> <p><code>GROUP BY</code>\u5b50\u53e5\u901a\u5e38\u4e0e\u805a\u5408\u51fd\u6570\uff08\u4f8b\u5982 COUNT\u3001SUM\u3001AVG\u3001MAX \u548c MIN\uff09\u4e00\u8d77\u4f7f\u7528\uff0c\u4ee5\u8ba1\u7b97\u6bcf\u4e2a\u7ec4\u7684\u805a\u5408\u503c\u3002\u4f8b\u5982\uff0c\u53ef\u4ee5\u4f7f\u7528 <code>GROUP BY</code> \u5b50\u53e5\u548c <code>COUNT</code> \u51fd\u6570\u6765\u8ba1\u7b97\u6bcf\u4e2a\u57ce\u5e02\u4e2d\u7684\u4eba\u6570\u3002</p> <p>\u4f46\u662f\uff0c\u9664\u4e86\u5206\u7ec4\u805a\u5408\uff0c<code>GROUP BY</code>\u8fd8\u53ef\u4ee5\u7528\u6765\u8fdb\u884c\u6570\u636e\u53bb\u91cd</p> <p>\u9700\u8981\u6ce8\u610f\u7684\u662f\uff1aGROUP BY \u5b50\u53e5\u4f1a\u5bf9\u7ed3\u679c\u96c6\u8fdb\u884c\u6392\u5e8f\uff0c\u56e0\u6b64\u53ef\u80fd\u4f1a\u5bfc\u81f4\u4f7f\u7528\u4e34\u65f6\u6587\u4ef6\u6392\u5e8f\u3002\u5982\u679c\u67e5\u8be2\u4e2d\u5305\u542b ORDER BY \u5b50\u53e5\uff0c\u4f7f\u7528\u4e0d\u5f53\u4f1a\u4ea7\u751f\u4e34\u65f6\u6587\u4ef6\u6392\u5e8f\uff0c\u5bb9\u6613\u4ea7\u751f\u6162 SQL \u95ee\u9898\u3002</p> <p>MySQL \u67e5\u8be2\u53bb\u91cd\u7684\u5c0f\u7ed3</p> <ul> <li> <p>\u5728\u8bed\u4e49\u76f8\u540c\uff0c\u6709\u7d22\u5f15\u7684\u60c5\u51b5\u4e0b\uff0cgroup by \u548c distinct \u6548\u7387\u76f8\u540c\uff1b   group by \u548c distinct \u90fd\u80fd\u4f7f\u7528\u7d22\u5f15\uff0c\u800c\u7d22\u5f15\u5929\u7136\u6709\u5e8f\uff0c\u53ef\u4ee5\u907f\u514d\u6392\u5e8f\uff0c\u56e0\u6b64\u4e8c\u8005\u6548\u7387\u76f8\u540c\uff1b\u6b64\u60c5\u51b5\u4e0b\uff0cgroup by \u548c distinct \u8fd1\u4e4e\u7b49\u4ef7\uff0cdistinct \u53ef\u4ee5\u88ab\u770b\u505a\u662f\u7279\u6b8a\u7684 group by\uff1b</p> </li> <li> <p>\u5728\u8bed\u4e49\u76f8\u540c\uff0c\u65e0\u7d22\u5f15\u7684\u60c5\u51b5\u4e0b\uff0cdistinct \u6548\u7387\u9ad8\u4e8e group by\uff1b   \u539f\u56e0\u662f distinct \u548c group by \u90fd\u4f1a\u8fdb\u884c\u5206\u7ec4\u64cd\u4f5c\uff0c\u4f46 group by \u5728 Mysql8.0 \u4e4b\u524d\u4f1a\u8fdb\u884c\u9690\u5f0f\u6392\u5e8f\uff0c\u5bfc\u81f4\u89e6\u53d1 filesort\uff0c\u6267\u884c\u6548\u7387\u66f4\u4f4e\uff1b   \u4ece Mysql8.0 \u5f00\u59cb\uff0cMysql \u5c31\u5220\u9664\u4e86\u9690\u5f0f\u6392\u5e8f\uff1b\u6240\u4ee5 Mysql8.0 \u540e\uff0c\u6b64\u65f6\u5728\u8bed\u4e49\u76f8\u540c\uff0c\u65e0\u7d22\u5f15\u7684\u60c5\u51b5\u4e0b\uff0cgroup by \u548c distinct \u7684\u6267\u884c\u6548\u7387\u4e5f\u662f\u8fd1\u4e4e\u7b49\u4ef7\u7684\uff1b</p> </li> <li> <p>\u66f4\u63a8\u8350\u4f7f\u7528 group by\uff1b   group by \u8bed\u4e49\u66f4\u4e3a\u6e05\u6670\uff0c\u53ef\u5bf9\u6570\u636e\u8fdb\u884c\u66f4\u4e3a\u590d\u6742\u7684\u4e00\u4e9b\u5904\u7406\uff1bgroup by \u7684\u4f7f\u7528\u7075\u6d3b\u6027\u66f4\u9ad8\uff0cgroup by \u80fd\u6839\u636e\u5206\u7ec4\u60c5\u51b5\uff0c\u5bf9\u6570\u636e\u8fdb\u884c\u66f4\u4e3a\u590d\u6742\u7684\u5904\u7406\uff0c\u4f8b\u5982\u901a\u8fc7 having \u5bf9\u6570\u636e\u8fdb\u884c\u8fc7\u6ee4\uff0c\u6216\u901a\u8fc7\u805a\u5408\u51fd\u6570\u5bf9\u6570\u636e\u8fdb\u884c\u8fd0\u7b97\uff1b</p> </li> </ul>"},{"location":"basic/4.sql/#_35","title":"\u5206\u7ec4\u53bb\u91cd\u7684\u5173\u7cfb\u548c\u533a\u522b","text":""},{"location":"basic/4.sql/#_36","title":"\u96c6\u5408\u67e5\u8be2","text":"<pre><code>-- SQL\u8bed\u53e5\u4e2d\u5b58\u57283\u4e2a\u8457\u540d\u7684\u91cf\u8bcd\uff0cSOME ALL \u548c ANY\n-- ALL\uff1a\u53ea\u6709\u5f53\u5176\u6240\u6709\u6570\u636e\u90fd\u6ee1\u8db3\u6761\u4ef6\u65f6\uff0c\u6761\u4ef6\u624d\u6210\u7acb\n-- ANY\uff1a\u53ea\u8981\u6709\u4e00\u6761\u6570\u636e\u6ee1\u8db3\u6761\u4ef6\uff0c\u6761\u4ef6\u5c31\u6210\u7acb\n-- SOME\uff1a\u5176\u4e2d\u5b58\u5728\u4e00\u4e9b\u6570\u636e\u6ee1\u8db3\u6761\u4ef6\uff0c\u4f5c\u7528\u548cAny\u5927\u81f4\u76f8\u540c \u5e38\u89c4\u7684\u4f7f\u7528\u4e2d\u770b\u4f5c\u4e00\u81f4\u5373\u53ef\n\n-- AS \u66f4\u540d\u7684\u7528\u5904\uff1a\u7ed9\u67e5\u8be2\u7ed3\u679c\u7684\u5217\u540d\u6539\u4e00\u4e2a\u540d\u5b57\uff0c\u7ed9\u8981\u67e5\u8be2\u7684\u8868\u6539\u4e00\u4e2a\u540d\u5b57\u3002\u5c24\u5176\u662f\u5728\u540c\u4e00\u4e2a\u8868\u4e2d\u8fdb\u884c\u6bd4\u8f83\u3002\n\n-- \u6559\u5e08\u8868  instructor(ID, name, dept_name, salary)\n-- \u627e\u51fa\u6ee1\u8db3\u4e0b\u9762\u6761\u4ef6\u7684\u6240\u6709\u6559\u5e08\u7684\u59d3\u540d\uff1a\u4ed6\u4eec\u7684\u5de5\u8d44\u6bd4 Biology \u7cfb\u6559\u5e08\u7684\u6700\u4f4e\u5de5\u8d44\u8981\u9ad8\n\n-- \u65b9\u6cd5\u4e00\n-- \u5c06\u4e00\u4e2a\u8868\u548c\u5b83\u81ea\u5df1\u8fdb\u884c\u7b1b\u5361\u5c14\u79ef\u8fd0\u7b97\uff0c\u7136\u540e\u518d\u8fc7\u6ee4\nselect distinct T.name from instructor as T, instructor as S where T.salary &gt; S.salary and S.dep_tname='Biology';\n\n-- &gt;some \u6bd4\u8f83:  \u81f3\u5c11\u6bd4\u96c6\u5408\u4e2d\u67d0\u4e00\u4e2a\u503c\u8981\u5927\n-- \u5927\u4e8esome\u5c31\u662f\uff1a\u6bd4\u6700\u5c0f\u7684\u8fd8\u8981\u5927\n-- \u5c0f\u4e8esome\u5c31\u662f\uff0c\u6bd4\u6700\u5927\u7684\u8fd8\u8981\u5c0f\n--\u65b9\u6cd5\u4e8c\n--\u7b49\u4ef7\u4e0a\u9762\u7684\u5199\u6cd5\uff0c\u4f7f\u7528 &gt; some \u683c\u5f0f\u5224\u65ad\uff0c\u5b50\u67e5\u8be2\u67e5\u51fa Biology \u7cfb\u6240\u6709\u7684\u5de5\u8d44\u7ec4\u6210\u96c6\u5408\u3002\u518d\u7528 &gt;some \u6bd4\u8f83\nselect name from instructor where salary &gt; some (select salary from instructor where dep_tname='Biology' );\n\n\n\n-- \u627e\u51fa\u6ee1\u8db3\u4e0b\u9762\u6761\u4ef6\u7684\u6240\u6709\u6559\u5e08\u7684\u59d3\u540d\uff1a\u4ed6\u4eec\u7684\u5de5\u8d44\u6bd4 Biology \u7cfb\u6bcf\u4e2a\u6559\u5e08\u7684\u6700\u9ad8\u5de5\u8d44\u8981\u9ad8\n\n-- \u65b9\u6cd5\u4e00\uff1a\u5b50\u67e5\u8be2\u4e2d\u627e\u51faBiology\u7cfb\u7684\u6700\u9ad8\u5de5\u8d44\nselect name from instructor where salary &gt;  (select MAX(salary) from instructor where dep_tname='Biology'  );\n\n-- \u65b9\u6cd5\u4e8c\uff1a\u5927\u4e8e\u6240\u6709\n-- &gt;all \u6bd4\u8f83\uff0c\u6bd4\u96c6\u5408\u4e2d\u7684\u6240\u6709\u503c\u90fd\u5927\u3002\nselect name from instructor where salary &gt; all (select salary from instructor where dep_tname='Biology' );\n\n-- \u627e\u51fa\u5e73\u5747\u5de5\u8d44\u6700\u9ad8\u7684\u7cfb\n\n-- \u6309\u7cfb\u540d\u5206\u7ec4\uff0c\u8ba1\u7b97\u6bcf\u4e2a\u7cfb\u7684\u5e73\u5747\u5de5\u8d44\uff0c\u5e76\u5c06\u7ed3\u679c\u6309\u7167\u5e73\u5747\u5de5\u8d44\u4ece\u9ad8\u5230\u4f4e\u6392\u5e8f\u3002\u6700\u540e\uff0c\u53ea\u8fd4\u56de\u6392\u5e8f\u7ed3\u679c\u4e2d\u7684\u7b2c\u4e00\u884c\uff0c\u5373\u5e73\u5747\u6210\u7ee9\u6700\u9ad8\u7684\u90a3\u4e2a\u7cfb\u3002\n\nSELECT\n  dept_name,\n  AVG(salary) AS avg_salary\nFROM\n  instructor\nGROUP BY\n  dept_name\nORDER BY\n  avg_salary DESC\nLIMIT\n  1;\n\n\n-- \u65b9\u6cd5\uff1a\u5148\u67e5\u51fa\u6240\u6709\u7cfb\u7684\u5e73\u5747\u5de5\u8d44\u505a\u4e3a\u4e00\u4e2a\u96c6\u5408\uff0c\u518d\u5728\u6240\u6709\u7cfb\u7684\u5e73\u5747\u7684\u5de5\u8d44\u91cc\u9762\u6bd4\u8f83\uff0c\u627e\u51fa\u6700\u5927\u503c\u3002\nselect dept_name from instructor group by dept_name having avg(salary) &gt;=all (select avg(salary) from instructor group by deptname);\n</code></pre>"},{"location":"basic/4.sql/#_37","title":"\u96c6\u5408\u8fd0\u7b97","text":"<p>SQL \u9762\u5411\u96c6\u5408\u7279\u6027\u6700\u660e\u663e\u7684\u4f53\u73b0\u5c31\u662f UNION\uff08\u5e76\u96c6\u8fd0\u7b97\uff09\u3001INTERSECT\uff08\u4ea4\u96c6\u8fd0\u7b97\uff09\u548c EXCEPT/MINUS\uff08\u5dee\u96c6\u8fd0\u7b97\uff09\u3002</p> <p>\u8fd9\u4e9b\u96c6\u5408\u8fd0\u7b97\u7b26\u7684\u4f5c\u7528\u90fd\u662f\u5c06\u4e24\u4e2a\u96c6\u5408\u5e76\u6210\u4e00\u4e2a\u96c6\u5408\uff0c\u56e0\u6b64\u9700\u8981\u6ee1\u8db3\u4ee5\u4e0b\u6761\u4ef6\uff1a</p> <ul> <li>\u4e24\u8fb9\u7684\u96c6\u5408\u4e2d\u5b57\u6bb5\u7684\u6570\u91cf\u548c\u987a\u5e8f\u5fc5\u987b\u76f8\u540c\uff1b</li> <li>\u4e24\u8fb9\u7684\u96c6\u5408\u4e2d\u5bf9\u5e94\u5b57\u6bb5\u7684\u7c7b\u578b\u5fc5\u987b\u5339\u914d\u6216\u517c\u5bb9\u3002</li> </ul> <p>\u5177\u4f53\u6765\u8bf4\uff0c<code>UNION</code> \u548c <code>UNION ALL</code> \u7528\u4e8e\u8ba1\u7b97\u4e24\u4e2a\u96c6\u5408\u7684\u5e76\u96c6\uff0c\u8fd4\u56de\u51fa\u73b0\u5728\u7b2c\u4e00\u4e2a\u67e5\u8be2\u7ed3\u679c\u6216\u8005\u7b2c\u4e8c\u4e2a\u67e5\u8be2\u7ed3\u679c\u4e2d\u7684\u6570\u636e\u3002\u5b83\u4eec\u7684\u533a\u522b\u5728\u4e8e <code>UNION</code> \u6392\u9664\u4e86\u7ed3\u679c\u4e2d\u7684\u91cd\u590d\u6570\u636e\uff0c<code>UNION ALL</code> \u4fdd\u7559\u4e86\u91cd\u590d\u6570\u636e\u3002</p> <p><code>SQL</code> \u4e2d\u7684\u5173\u7cfb\u6982\u5ff5\u6765\u81ea\u6570\u5b66\u4e2d\u7684\u96c6\u5408\u7406\u8bba\uff0c\u56e0\u6b64 <code>UNION</code>\u3001<code>INTERSECT</code> \u548c <code>EXCEPT</code> \u5206\u522b\u6765\u81ea\u96c6\u5408\u8bba\u4e2d\u7684<code>\u5e76\u96c6\uff08$\\cup$\uff09</code>\u3001<code>\u4ea4\u96c6\uff08$\\cap$\uff09</code>\u548c<code>\u5dee\u96c6\uff08$\\setminus$\uff09</code>\u8fd0\u7b97\u3002\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u96c6\u5408\u7406\u8bba\u4e2d\u7684\u96c6\u5408\u4e0d\u5141\u8bb8\u5b58\u5728\u91cd\u590d\u7684\u6570\u636e\uff0c\u4f46\u662f <code>SQL</code> \u5141\u8bb8\u3002</p> <p>\u56e0\u6b64\uff0c<code>SQL</code> \u4e2d\u7684\u96c6\u5408\u4e5f\u88ab\u79f0\u4e3a\u591a\u91cd\u96c6\u5408\uff08multiset\uff09\uff1b\u591a\u91cd\u96c6\u5408\u4e0e\u96c6\u5408\u7406\u8bba\u4e2d\u7684\u96c6\u5408\u90fd\u662f\u65e0\u5e8f\u7684\uff0c\u4f46\u662f <code>SQL</code> \u53ef\u4ee5\u901a\u8fc7 <code>ORDER BY</code> \u5b50\u53e5\u5bf9\u67e5\u8be2\u7ed3\u679c\u8fdb\u884c\u6392\u5e8f\u3002</p> <pre><code>-- \u5e76\u96c6\uff08union\uff09\n\n-- \u5e76\u96c6 union \u81ea\u52a8\u53bb\u91cd(\u6548\u7387\u5f88\u4f4e)\uff0c\u5c06\u4e24\u4e2a\u7ed3\u679c\u96c6\u6c42\u5e76\u96c6\uff0c\u5982\u679c\u60f3\u5408\u5e76\u6ca1\u6709\u523b\u610f\u8981\u5220\u9664\u91cd\u590d\u884c\u3002\u53ef\u4ee5\u4fdd\u7559\u91cd\u590d\uff0c\u5219\u4f7f\u7528union all\n\n-- UNION \u5fc5\u987b\u7531\u4e24\u6761\u6216\u4e24\u6761\u4ee5\u4e0a\u7684 SELECT \u8bed\u53e5\u7ec4\u6210\uff0c\u8bed\u53e5\u4e4b\u95f4\u7528\u5173\u952e\u5b57 UNION \u5206\u9694\uff08\u56e0\u6b64\uff0c\u5982\u679c\u7ec4\u54084\u6761 SELECT \u8bed\u53e5\uff0c\u5c06\u8981\u4f7f\u75283\u4e2aUNION \u5173\u952e\u5b57\uff09\u3002\n-- UNION \u4e2d\u7684\u6bcf\u4e2a\u67e5\u8be2\u5fc5\u987b\u5305\u542b\u76f8\u540c\u7684\u5217\u3001\u8868\u8fbe\u5f0f\u6216\u805a\u96c6\u51fd\u6570\uff08\u4e0d\u8fc7\u5404\u4e2a\u5217\u4e0d\u9700\u8981\u4ee5\u76f8\u540c\u7684\u6b21\u5e8f\u5217\u51fa\uff09\u3002\n-- \u5217\u6570\u636e\u7c7b\u578b\u5fc5\u987b\u517c\u5bb9\uff1a\u7c7b\u578b\u4e0d\u5fc5\u5b8c\u5168\u76f8\u540c\uff0c\u4f46\u5fc5\u987b\u662fDBMS\u53ef\u4ee5\u9690\u542b\u5730\u8f6c\u6362\u7684\u7c7b\u578b\uff08\u4f8b\u5982\uff0c\u4e0d\u540c\u7684\u6570\u503c\u7c7b\u578b\u6216\u4e0d\u540c\u7684\u65e5\u671f\u7c7b\u578b\uff09\u3002\n\n-- \u627e\u51fa\u57282009\u5e74\u79cb\u5b63\u6216\u57282010\u5e74\u6625\u5b63\u5f00\u8bfe\u7684\u8bfe\u7a0b\u4fe1\u606f\n(select course_id from section where semester='Fall' and year=2009) union (select course_id from section where semester='Spring' and year=2010);\n\n-- \u4e5f\u7b49\u4ef7\u4e8e\u4e0b\u9762\u8fd9\u6761\u67e5\u8be2\nselect course_id from section where (semester='Fall' and year=2009) or (semester='Spring' and year=2010);\n\n\n\n-- \u4ea4\u96c6\uff08intersect all\uff09\n\n-- \u4ea4\u96c6 intersect all\n-- \u627e\u51fa\u57282009\u5e74\u79cb\u5b63\u548c2010\u5e74\u6625\u5b63\u540c\u65f6\u5f00\u8bfe\u7684\u8bfe\u7a0b\u4fe1\u606f\n(select course_id from section where semester='Fall' and year=2009) intersect all (select course_id from section where semester='Spring' and year=2010);\n\n\n-- \u5dee\u8fd0\u7b97 (expect)\n-- EXCEPT \u5b50\u53e5/\u8fd0\u7b97\u7b26\u7528\u4e8e\u5c06\u4e24\u4e2a SELECT \u8bed\u53e5\u7ed3\u5408\u5728\u4e00\u8d77\uff0c\u5e76\u8fd4\u56de\u7b2c\u4e00\u4e2a SELECT \u8bed\u53e5\u7684\u7ed3\u679c\u4e2d\u90a3\u4e9b\u4e0d\u5b58\u5728\u4e8e\u7b2c\u4e8c\u4e2a SELECT \u8bed\u53e5\u7ed3\u679c\u7684\u8bb0\u5f55\n-- \u627e\u51fa\u57282009\u5e74\u79cb\u5b63\u5f00\u8bfe\uff0c2010\u5e74\u6625\u5b63\u6ca1\u5f00\u8bfe\u7684\u8bfe\u7a0b\u4fe1\u606f\n(select course_id from section where semester='Fall' and year=2009) expect (select course_id from section where semester='Spring' and year=2010);\n\n\n\n-- \u96c6\u5408\u6210\u5458\u8d44\u683c\u6d4b\u8bd5  in \uff0c\u6d4b\u8bd5\u5143\u7ec4\u662f\u5426\u662f\u96c6\u5408\u4e2d\u7684\u6210\u5458\u3002\u96c6\u5408\u4e00\u822c\u662f\u7531select\u67e5\u51fa\u6765\u7684\u3002\u7528\u4e8e\u7b5b\u51fa\u5728\u96c6\u5408\u4e2d\u7684\u5143\u7d20\u3002\n\n-- \u627e\u51fa\u57282009\u5e74\u79cb\u5b63\u548c2010\u5e74\u6625\u5b63\u540c\u65f6\u5f00\u8bfe\u7684\u8bfe\u7a0b\u4fe1\u606f\n-- in\u5173\u952e\u5b57\u7528\u4e8e\u6d4b\u8bd5\u5173\u7d20\u662f\u5426\u662f\u96c6\u5408\u4e2d\u7684\u6210\u5458\u3002\u5bf9\u4e8e\u8fd9\u4e2a\u4f8b\u5b50\uff0c3\u4e2a\u67e5\u8be2\u6761\u4ef6\uff1a1\u3001\u79cb\u5b63\uff1b2\u30012009\u5b66\u671f\uff0c3\u3001\u8bfe\u7a0bid\u5fc5\u987b2010\u5e74\u6625\u5b63\u5f00\u8bfe\u7684\u8bfe\u7a0bid\u4e00\u6837\u3002\n-- \u4f7f\u7528in\u5173\u952e\u5b57\u6765\u63cf\u8ff0\u8fd9\u4e2a\u67e5\u8be2\u3002\nselect course_id from section where semester='Fall' and year=2009 and course_id in (select course_id from section where semester='Spring' and year=2010);\n\n\n-- \u96c6\u5408\u6210\u5458\u8d44\u683c\u6d4b\u8bd5 not in \uff0c\u6d4b\u8bd5\u5143\u7ec4\u662f\u5426\u662f\u96c6\u5408\u4e2d\u7684\u6210\u5458\u3002\u7528\u4e8e\u7b5b\u51fa\u4e0d\u5728\u96c6\u5408\u4e2d\u7684\u5143\u7d20\u3002\n</code></pre>"},{"location":"basic/4.sql/#_38","title":"\u884c\u8f6c\u5217/\u5217\u8f6c\u884c","text":"<p>\u884c\u5217\u8f6c\u6362\u5728\u505a\u62a5\u8868\u5206\u6790\u65f6\u662f\u7ecf\u5e38\u9047\u5230\u7684</p> <ul> <li> <p>\u884c\u8f6c\u5217\uff1a\u5c06\u591a\u884c\u6570\u636e\u8f6c\u6362\u6210\u4e00\u884c\u663e\u793a\uff0c\u6216\u5c06\u4e00\u5217\u6570\u636e\u8f6c\u6362\u6210\u591a\u5217\u663e\u793a\u3002</p> </li> <li> <p>\u5217\u8f6c\u884c\uff1a\u5c06\u4e00\u884c\u6570\u636e\u8f6c\u6362\u6210\u591a\u884c\u663e\u793a\uff0c\u6216\u5c06\u591a\u5217\u6570\u636e\u8f6c\u6362\u6210\u4e00\u5217\u663e\u793a\u3002</p> </li> </ul> <pre><code>create table rowtocolumn (name string, subject string, result bigint);\ninsert into table rowtocolumn values\n('\u5f20\u4e09' , '\u8bed\u6587' , 74),\n('\u5f20\u4e09' , '\u6570\u5b66' , 83),\n('\u5f20\u4e09' , '\u7269\u7406' , 93),\n('\u674e\u56db' , '\u8bed\u6587' , 74),\n('\u674e\u56db' , '\u6570\u5b66' , 84),\n('\u674e\u56db' , '\u7269\u7406' , 94);\n</code></pre>"},{"location":"basic/4.sql/#sql-null-default","title":"SQL \u4e2d\u7684 null \u548c DEFAULT","text":"<p>\u6839\u636e ANSI SQL-92 \u89c4\u8303\uff0c<code>NULL</code>\u65e2\u4e0d\u662f\u7a7a\u5b57\u7b26\u4e32(\u5bf9\u4e8e\u5b57\u7b26\u6216\u65e5\u671f\u65f6\u95f4\u6570\u636e\u7c7b\u578b)\uff0c\u4e5f\u4e0d\u662f\u96f6\u503c(\u5bf9\u4e8e\u6570\u5b57\u6570\u636e\u7c7b\u578b)\u3002</p> <p>\u4e3a\u4e86\u786e\u4fdd\u6240\u6709 null \u88ab\u7edf\u4e00\u5904\u7406\uff0cANSI SQL-92 \u89c4\u8303\u89c4\u5b9a\u6240\u6709\u6570\u636e\u7c7b\u578b\u7684 null \u5fc5\u987b\u662f\u76f8\u540c\u7684\u3002</p> <p>\u5728 postgresql 14 \u4e2d\u6216\u66f4\u65e9\u7684\u7248\u672c\uff0c\u552f\u4e00\u6027\u7ea6\u675f\u5c06 null \u4e0e null \u89c6\u4e3a\u662f\u4e0d\u76f8\u540c\u7684\u3002\u8fd9\u4e0e sql \u6807\u51c6\u662f\u76f8\u540c\u7684\uff0c\u7b80\u800c\u8a00\u4e4b\uff0cnull \u8868\u793a unknown\u3002\u56e0\u800c\uff0cnull \u503c\u4e5f\u5c31\u4e0d\u8fdd\u53cd\u552f\u4e00\u6027\u7ea6\u675f\u3002</p> <p>\u5bf9\u4e8e\u7ed9\u5b9a\u8bb0\u5f55\uff0c\u5f53\u5c5e\u6027\u6ca1\u6709\u8981\u5b58\u50a8\u7684\u6570\u636e\u65f6\uff0c\u5b83\u7531 SQL \u503c NULL \u8868\u793a\u3002NULL \u4e0d\u662f\u4e00\u4e2a\u300c\u503c\u300d\uff0c\u800c\u662f\u300c\u6ca1\u6709\u503c\u300d\u3002</p> <ul> <li> <p>Oracle \u5c06 NULL \u548c\u7a7a\u5b57\u7b26\u4e32\u90fd\u5f53\u4f5c NULL \u6765\u5904\u7406\u3002Oracle \u9700\u8981\u4e00\u4e2a byte \u6765\u5b58\u50a8 NULL\u3002</p> </li> <li> <p>PostgreSQL \u5c06 NULL \u548c\u7a7a\u5b57\u7b26\u4e32\u5206\u5f00\u5904\u7406\uff0cNULL \u662f NULL\uff0c\u7a7a\u5b57\u7b26\u4e32\u662f\u7a7a\u5b57\u7b26\u4e32\u3002PostgreSQL \u4e0d\u9700\u8981\u7a7a\u95f4\u6765\u5b58\u50a8 NULL\u3002</p> </li> <li> <p>SQL Server \u4e5f\u662f\u5c06 NULL \u548c\u7a7a\u5b57\u7b26\u4e32\u5206\u5f00\u5904\u7406\uff0cNULL \u662f NULL\uff0c\u7a7a\u5b57\u7b26\u4e32\u662f\u7a7a\u5b57\u7b26\u4e32\u3002SQL Server \u4e0d\u9700\u8981\u7a7a\u95f4\u6765\u5b58\u50a8 NULL\u3002</p> </li> </ul> <p>NULL \u548c\u7a7a\u5b57\u7b26\u4e32\u4e0a\u7684\u552f\u4e00\u6027\u7ea6\u675f</p> <ul> <li> <p>Oracle \u4e2d\uff0c\u5177\u6709\u552f\u4e00\u6027\u7ea6\u675f\u7684\u5217\uff0c\u53ef\u4ee5\u5305\u542b\u4efb\u610f\u6570\u91cf\u7684 NULL \u548c\u7a7a\u5b57\u7b26\u4e32\uff1b</p> </li> <li> <p>SQLServer \u4e2d\uff0c\u53ea\u662f\u5141\u8bb8\u6709\u4e00\u4e2a NULL\u3001\u4e00\u4e2a\u7a7a\u5b57\u7b26\u4e32\u3002</p> </li> <li> <p>\u5bf9\u4e8e NULL\uff0cPostgreSQL \u7684\u5904\u7406\u65b9\u5f0f\u7c7b\u4f3c Oracle\uff0c\u800c\u5bf9\u4e8e\u7a7a\u5b57\u7b26\u4e32\uff0cPostgreSQL \u7684\u5904\u7406\u65b9\u5f0f\u7c7b\u4f3c SQLServer\u3002</p> </li> <li> <p>MySQL \uff0c\u552f\u4e00\u7d22\u5f15\u521b\u5efa\u4e00\u4e2a\u7ea6\u675f\uff0c\u4f7f\u5f97\u7d22\u5f15\u4e2d\u7684\u6240\u6709\u503c\u90fd\u5fc5\u987b\u662f\u4e0d\u540c\u7684\u3002\u5982\u679c\u5c1d\u8bd5\u6dfb\u52a0\u4e00\u4e2a\u952e\u503c\u4e0e\u73b0\u6709\u884c\u5339\u914d\u7684\u65b0\u884c\uff0c\u5219\u4f1a\u53d1\u751f\u9519\u8bef\u3002\u5982\u679c\u5728\u552f\u4e00\u7d22\u5f15\u4e2d\u4e3a\u5217\u6307\u5b9a\u524d\u7f00\u503c\uff0c\u5219\u5217\u503c\u5728\u524d\u7f00\u957f\u5ea6\u5185\u5fc5\u987b\u662f\u552f\u4e00\u7684\u3002\u552f\u4e00\u7d22\u5f15\u5141\u8bb8\u5305\u542b\u7a7a\u503c\u7684\u5217\u6709\u591a\u4e2a\u7a7a\u503c\u3002</p> </li> </ul> <p>NULL</p> <p>\u5728 SQL \u4e2d\u5efa\u8868\uff0c\u6bcf\u4e2a\u5b57\u6bb5\u540e\u9762\u90fd\u52a0\u4e0a NULL \u6216 NOT NULL \u4fee\u9970\u7b26\u6765\u6307\u5b9a\u8be5\u5b57\u6bb5\u662f\u5426\u53ef\u4ee5\u4e3a\u7a7a(NULL)\uff0c\u8fd8\u662f\u8bf4\u5fc5\u987b\u586b\u4e0a\u6570\u636e(NOT NULL)\u3002</p> <p>MySQL \u9ed8\u8ba4\u60c5\u51b5\u4e0b\u6307\u5b9a\u5b57\u6bb5\u4e3a NULL \u4fee\u9970\u7b26\uff0c\u5982\u679c\u4e00\u4e2a\u5b57\u6bb5\u6307\u5b9a\u4e3a NOT NULL\uff0cMySQL \u5219\u4e0d\u5141\u8bb8\u5411\u8be5\u5b57\u6bb5\u63d2\u5165\u7a7a\u503c(\u8fd9\u91cc\u9762\u8bf4\u7684\u7a7a\u503c\u90fd\u4e3a NULL)\uff0c\u56e0\u4e3a\u8fd9\u662f\"\u89c4\u5b9a\"\u3002</p> <p>\u4f46\u662f\u5728\u81ea\u589e\u5217\u548c TIMESTAMP \u5b57\u6bb5\u4e2d\uff0c\u8fd9\u4e2a\u89c4\u5219\u5e76\u4e0d\u9002\u7528\u3002\u5411\u8fd9\u4e9b\u5b57\u6bb5\u4e2d\u63d2\u5165 NULL \u503c\u5c06\u4f1a\u5bfc\u81f4\u63d2\u5165\u4e0b\u4e00\u4e2a\u81ea\u52a8\u589e\u52a0\u7684\u503c\u6216\u8005\u5f53\u524d\u7684\u65f6\u95f4\u6233\u3002</p> <p>\u5728 MySQL \u4e2d null \u4e0d\u80fd\u4f7f\u7528\u4efb\u4f55\u8fd0\u7b97\u7b26\u4e0e\u5176\u4ed6\u5b57\u6bb5\u6216\u8005\u53d8\u91cf\uff08\u51fd\u6570\u3001\u5b58\u50a8\u8fc7\u7a0b\uff09\u8fdb\u884c\u8fd0\u7b97\u3002\u82e5\u4f7f\u7528\u8fd0\u7b97\u6570\u636e\u5c31\u53ef\u80fd\u4f1a\u6709\u95ee\u9898\u3002</p> <p>\u5728\u5199 SQL \u6761\u4ef6\u8bed\u53e5\u65f6\u7ecf\u5e38\u7528\u5230 \u4e0d\u7b49\u4e8e != \u7684\u7b5b\u9009\u6761\u4ef6\u3002</p> <p>\u6b64\u65f6\u8981\u6ce8\u610f\u6b64\u6761\u4ef6\u4f1a\u5c06\u5b57\u6bb5\u4e3a Null \u7684\u6570\u636e\u4e5f\u5f53\u505a\u6ee1\u8db3\u4e0d\u7b49\u4e8e\u7684\u6761\u4ef6\u800c\u5c06\u6570\u636e\u7b5b\u9009\u6389\u3002\uff08\u4e5f\u5c31\u662f\u8bf4\u4f1a\u5ffd\u7565\u8fc7\u6ee4\u6389\u4e3a null \u7684\u6570\u636e\uff0c\u5bfc\u81f4\u6570\u636e\u4e0d\u51c6\u786e\uff09\u3002</p>"},{"location":"basic/4.sql/#_39","title":"\u5143\u6570\u636e\u67e5\u8be2","text":"<pre><code>-- \u5217\u51fa\u6a21\u5f0f\u4e2d\u7684\u6240\u6709\u8868\n    SELECT table_name\n    FROM information_schema.tables\n    WHERE table_schema = 'dbo'\n\n--\u5217\u51fa\u8868\u4e2d\u7684\u5217\n   SELECT column_name, data_type, ordinal_position\n    FROM information_schema.columns\n    WHERE table_schema = 'dbo'\n    AND table_name   = 'EMP'\n--\u5217\u51fa\u8868\u7684\u7d22\u5f15\u5217\n    SELECT a.name table_name,\n        b.name index_name,\n        d.name column_name,\n        c.index_column_id\n    FROM sys.tables a,\n        sys.indexes b,\n        sys.index_columns c,\n        sys.columns d\n    WHERE a.object_id = b.object_id\n         AND b.object_id = c.object_id\n         AND b.index_id  = c.index_id\n         AND c.object_id = d.object_id\n         AND c.column_id = d.column_id\n         AND a.name      = 'EMP'\n--5.4 \u5217\u51fa\u8868\u7684\u7ea6\u675f\n     SELECT a.table_name,\n         a.constraint_name,\n         b.column_name,\n         a.constraint_type\n     FROM information_schema.table_constraints a,\n          information_schema.key_column_usage b\n     WHERE a.table_name      = 'EMP'\n           AND a.table_schema    = 'dbo'\n           AND a.table_name      = b.table_name\n           AND a.table_schema    = b.table_schema\n           AND a.constraint_name = b.constraint_name\n\n--\u5217\u51fa\u6ca1\u6709\u76f8\u5e94\u7d22\u5f15\u7684\u5916\u952e\n    SELECT\n    fkeys.table_name,\n    fkeys.constraint_name,\n    fkeys.column_name,\n    ind_cols.index_name\nFROM\n    (\n    SELECT\n        a.object_id,\n        d.column_id,\n        a.NAME table_name,\n        b.NAME constraint_name,\n        d.NAME column_name\n    FROM\n        sys.TABLES a\n        JOIN sys.foreign_keys b ON ( a.NAME = 'EMP' AND a.object_id = b.parent_object_id )\n        JOIN sys.foreign_key_columns c ON ( b.object_id = c.constraint_object_id )\n        JOIN sys.COLUMNS d ON ( c.constraint_column_id = d.column_id AND a.object_id = d.object_id )\n    ) fkeys\n    LEFT JOIN (\n    SELECT\n        a.NAME index_name,\n        b.object_id,\n        b.column_id\n    FROM\n        sys.indexes a,\n        sys.index_columns b\n    WHERE\n        a.index_id = b.index_id\n    ) ind_cols ON ( fkeys.object_id = ind_cols.object_id AND fkeys.column_id = ind_cols.column_id )\nWHERE\n    ind_cols.index_name IS NULL\n</code></pre>"},{"location":"basic/4.sql/#_40","title":"\u8fd0\u7b97\u7b26","text":"<p>\u6570\u636e\u5e93\uff0c\u9664\u4e86\u6570\u636e\u7684\u5b58\u53d6\u4e4b\u5916\uff0c\u8fd8\u652f\u6301\u5404\u79cd\u8fd0\u7b97\uff0c\u4e3b\u8981\u5305\u62ec \u7b97\u6570\u8fd0\u7b97 \u548c \u903b\u8f91\u8fd0\u7b97 \u3002</p> \u7b97\u6570\u8fd0\u7b97\u7b26 \u4f5c\u7528 + \u52a0\u6cd5 - \u51cf\u6cd5 * \u4e58\u6cd5 / \u6216 DIV \u9664\u6cd5 % \u6216 MOD \u53d6\u4f59 \u8fd0\u7b97\u7b26 = \u7b49\u4e8e &lt;&gt;, != &gt; &lt; &gt;= &lt;= BETWEEN NOT BETWEEN IN \u5224\u65ad\u64cd\u4f5c\u6570\u662f\u5426\u4e3a IN \u5217\u8868\u4e2d\u7684\u4e00\u4e2a\u503c NOT IN &lt;=&gt; \u5b89\u5168\u7684\u7b49\u4e8e LIKE <p>\u903b\u8f91\u8fde\u63a5\u8bcd</p> <p>\u6c49\u8bed\u91cc\u7684\u6216\u3001\u4e14\u3001\u975e</p> \u903b\u8f91\u8fd0\u7b97\u7b26 NOT \u6216 \uff01 \u8868\u793a\u903b\u8f91\u975e AND \u6216 &amp;&amp; \u8868\u793a\u903b\u8f91\u4e0e\u8fd0\u7b97 OR \u6216 || &lt; &gt;= <p>\u8fd0\u7b97\u7b26\u4f18\u5148\u7ea7</p> \u4f18\u5148\u7ea7\u7531\u4f4e\u5230\u9ad8\u6392\u5217 \u8fd0\u7b97\u7b26 \u542b\u4e49 1 =(\u8d4b\u503c\u8fd0\u7b97\uff09\u3001:= 2 II\u3001OR 3 XOR 4 &amp;&amp;\u3001AND 5 NOT 6 BETWEEN\u3001CASE\u3001WHEN\u3001THEN\u3001ELSE 7 =(\u6bd4\u8f83\u8fd0\u7b97\uff09\u3001&lt;=&gt;\u3001&gt;=\u3001&gt;\u3001&lt;=\u3001&lt;\u3001&lt;&gt;\u3001!=\u3001 IS\u3001LIKE\u3001REGEXP\u3001IN 8 | 9 &amp; 10 &lt;&lt;\u3001&gt;&gt; 11 -(\u51cf\u53f7\uff09\u3001+(\u52a0\u53f7) 12 *\u3001/\u3001% *\u3001/\u3001% 13 ^ 14 -(\u8d1f\u53f7\uff09\u3001\u301c\uff08\u4f4d\u53cd\u8f6c\uff09 15 ! <p>\u8fd0\u7b97\u7b26\u7684\u4f18\u5148\u7ea7\u51b3\u5b9a\u4e86\u4e0d\u540c\u7684\u8fd0\u7b97\u7b26\u5728\u8868\u8fbe\u5f0f\u4e2d\u8ba1\u7b97\u7684\u5148\u540e\u987a\u5e8f\uff0c\u4e00\u822c\u60c5\u51b5\u4e0b\uff0c\u7ea7\u522b\u9ad8\u7684\u8fd0\u7b97\u7b26\u4f18\u5148\u8fdb\u884c\u8ba1\u7b97\uff0c\u5982\u679c\u7ea7\u522b\u76f8\u540c\uff0cMySQL \u6309\u8868\u8fbe\u5f0f\u7684\u987a\u5e8f\u4ece\u5de6\u5230\u53f3\u4f9d\u6b21\u8ba1\u7b97\uff0c\u5728\u65e0\u6cd5\u786e\u5b9a\u4f18\u5148\u7ea7\u7684\u60c5\u51b5\u4e0b\uff0c\u53ef\u4ee5\u4f7f\u7528\u5706\u62ec\u53f7\"()\"\u6765\u6539\u53d8\u4f18\u5148\u7ea7\uff0c\u5e76\u4e14\u8fd9\u6837\u4f1a\u4f7f\u8ba1\u7b97\u8fc7\u7a0b\u66f4\u52a0\u6e05\u6670\u3002</p> <p><code>Select * from users where id=1 and 1=1;</code> \u8fd9\u6761\u8bed\u53e5\u4e3a\u4ec0\u4e48\u80fd\u591f\u9009\u62e9\u51fa id=1 \u7684\u5185\u5bb9\uff0cand 1=1 \u5230\u5e95\u8d77\u4f5c\u7528\u4e86\u6ca1\u6709\uff1f</p> <p>\u4e09\u4e2a\u6761\u4ef6\u7528 and \u548c or \u8fdb\u884c\u8fde\u63a5\u3002\u5728 sql \u4e2d\uff0c\u6211\u4eec and \u7684\u8fd0\u7b97\u4f18\u5148\u7ea7\u5927\u4e8e or \u7684\u5143\u7b97\u4f18\u5148\u7ea7\u3002</p> <p>\u5bf9\u4e8e MySQL \u4e09\u5927\u6570\u636e\u7c7b\u578b\uff0c\u6570\u503c\u7c7b\u578b\uff0c\u5b57\u7b26\uff0c\u65f6\u95f4</p> <p>\u5f53\u4e24\u4e2a\u4e0d\u540c\u7c7b\u578b\u7684\u6570\u636e\u8fdb\u884c\u8fd0\u7b97\u65f6\uff0c\u4e3a\u4e86\u4f7f\u5f97\u5b83\u4eec\u80fd\u591f\u517c\u5bb9\uff0cMySQL \u53ef\u80fd\u4f1a\u6267\u884c\u9690\u5f0f\u7684\u6570\u636e\u7c7b\u578b\u8f6c\u6362\u3002\u4f8b\u5982\uff0cMySQL \u5728\u9700\u8981\u65f6\u4f1a\u81ea\u52a8\u5c06\u5b57\u7b26\u4e32\u8f6c\u6362\u4e3a\u6570\u5b57\uff0c\u53cd\u4e4b\u4ea6\u7136\u3002</p> <ul> <li>\u5982\u679c\u4efb\u610f\u4e00\u4e2a\u53c2\u6570\u4e3a NULL\uff0c\u6bd4\u8f83\u8fd0\u7b97\u7b26\u7684\u7ed3\u679c\u4e3a NULL\uff0c&lt;=&gt; \u76f8\u7b49\u6bd4\u8f83\u8fd0\u7b97\u7b26\u9664\u5916\u3002NULL &lt;=&gt; NULL \u7684\u8fd0\u7b97\u7ed3\u679c\u4e3a true\uff0c\u4e0d\u9700\u8981\u8fdb\u884c\u7c7b\u578b\u8f6c\u6362\u3002</li> <li>\u5982\u679c\u4e24\u4e2a\u53c2\u6570\u90fd\u662f\u5b57\u7b26\u4e32\uff0c\u6267\u884c\u5b57\u7b26\u4e32\u6bd4\u8f83\u3002</li> </ul>"},{"location":"basic/4.sql/#_41","title":"\u51fd\u6570","text":"<p>SQL \u4e3b\u8981\u7684\u529f\u80fd\u5c31\u662f\u5bf9\u6570\u636e\u8fdb\u884c\u5904\u7406\u548c\u5206\u6790\u3002\u4e3a\u4e86\u63d0\u9ad8\u6570\u636e\u5904\u7406\u7684\u6548\u7387\uff0cSQL \u4e3a\u6211\u4eec\u63d0\u4f9b\u4e86\u8bb8\u591a\u9884\u5b9a\u4e49\u7684\u529f\u80fd\u6a21\u5757\uff0c\u4e5f\u5c31\u662f\u51fd\u6570\uff08Function\uff09\u3002</p> <p>SQL \u51fd\u6570\u662f\u4e00\u79cd\u5177\u6709\u67d0\u79cd\u6570\u636e\u5904\u7406\u529f\u80fd\u7684\u6a21\u5757\uff0c\u5b83\u53ef\u4ee5\u63a5\u6536\u96f6\u4e2a\u6216\u591a\u4e2a\u8f93\u5165\u503c\uff0c\u5e76\u4e14\u8fd4\u56de\u4e00\u4e2a\u8f93\u51fa\u503c\u3002SQL \u4e2d\u7684\u51fd\u6570\u4e3b\u8981\u5206\u4e3a\u4ee5\u4e0b\u4e24\u79cd\u7c7b\u578b\uff1a</p> <ul> <li>\u6807\u91cf\u51fd\u6570\uff08Scalar Function\uff09\uff0c\u9488\u5bf9\u6bcf\u4e2a\u8f93\u5165\u53c2\u6570\u8fd4\u56de\u4e00\u4e2a\u8f93\u51fa\u7ed3\u679c\u3002\u4f8b\u5982 ABS(x)\u51fd\u6570\u53ef\u4ee5\u8ba1\u7b97 x \u7684\u7edd\u5bf9\u503c\u3002</li> <li>\u805a\u5408\u51fd\u6570\uff08Aggregate Function\uff09\uff0c\u57fa\u4e8e\u4e00\u7ec4\u8f93\u5165\u53c2\u6570\u8fdb\u884c\u6c47\u603b\u5e76\u8fd4\u56de\u4e00\u4e2a\u7ed3\u679c\u3002\u4f8b\u5982 AVG(x)\u51fd\u6570\u53ef\u4ee5\u8ba1\u7b97\u4e00\u7ec4\u6570\u636e\u7684\u5e73\u5747\u503c\u3002</li> </ul>"},{"location":"basic/4.sql/#_42","title":"\u6570\u5b66\u51fd\u6570","text":"<pre><code>ABS(x)                              -- \u8fd4\u56dex\u7684\u7edd\u5bf9\u503c\n\nBIN(x)                              -- \u8fdb\u5236\u8f6c\u8f6c\uff1a\u8fd4\u56dex\u7684\u4e8c\u8fdb\u5236\uff08OCT\u8fd4\u56de\u516b\u8fdb\u5236\uff0cHEX\u8fd4\u56de\u5341\u516d\u8fdb\u5236\uff09\uff0c\u5176\u4e2dx\u4e3a\u6b63\u6574\u6570\nCONV(N,from_base,to_base)           -- \u8fdb\u5236\u8f6c\u6362\uff1a\u6570\u5b57\u6309\u7167\u8fdb\u5236\u4e92\u8f6c\uff1aN\u4e3a\u8981\u88ab\u8f6c\u6362\u7684\u6570\u5b57\uff0c\u539f\u59cb\u8fdb\u5236\uff0c\u76ee\u6807\u8fdb\u5236\n\nCEILING(x)                          -- \u5411\u4e0a\u53d6\u6574:\u8fd4\u56de\u5927\u4e8ex\u7684\u6700\u5c0f\u6574\u6570\u503c\nFLOOR(x)                            -- \u5411\u4e0b\u53d6\u6574\uff1a\u8fd4\u56de\u5c0f\u4e8ex\u7684\u6700\u5927\u6574\u6570\u503c\n\nEXP(x)                              -- \u8fd4\u56de\u503ce\uff08\u81ea\u7136\u5bf9\u6570\u7684\u5e95\uff09\u7684x\u6b21\u65b9\nLN(x)                               -- \u8fd4\u56dex\u7684\u81ea\u7136\u5bf9\u6570\nLOG(x,y)                            -- \u8fd4\u56dex\u7684\u4ee5y\u4e3a\u5e95\u7684\u5bf9\u6570\n\nGREATEST(x1,x2,...,xn)              -- \u8fd4\u56de\u96c6\u5408\u4e2d\u6700\u5927\u7684\u503c\nLEAST(x1,x2,...,xn)                 -- \u8fd4\u56de\u96c6\u5408\u4e2d\u6700\u5c0f\u7684\u503c\n\nMOD(x,y)                            -- \u8fd4\u56dex/y\u7684\u6a21\uff08\u4f59\u6570\uff09\nPI()                                -- \u8fd4\u56depi\u7684\u503c\uff08\u5706\u5468\u7387\uff09\nRAND()                              -- \u8fd4\u56de0\u52301\u5185\u7684\u968f\u673a\u503c,\u53ef\u4ee5\u901a\u8fc7\u63d0\u4f9b\u4e00\u4e2a\u53c2\u6570(\u79cd\u5b50)\u4f7fRAND()\u968f\u673a\u6570\u751f\u6210\u5668\u751f\u6210\u4e00\u4e2a\u6307\u5b9a\u7684\u503c\u3002\nROUND(x,y)                          -- \u8fd4\u56de\u53c2\u6570x\u7684\u56db\u820d\u4e94\u5165\u7684\u6709y\u4f4d\u5c0f\u6570\u7684\u503c\nSIGN(x)                             -- \u8fd4\u56de\u4ee3\u8868\u6570\u5b57x\u7684\u7b26\u53f7\u7684\u503c\nSQRT(x)                             -- \u8fd4\u56de\u4e00\u4e2a\u6570\u7684\u5e73\u65b9\u6839\nTRUNCATE(x,y)                       -- \u8fd4\u56de\u6570\u5b57x\u622a\u77ed\u4e3ay\u4f4d\u5c0f\u6570\u7684\u7ed3\u679c\n\n-- \u6570\u5b66\u51fd\u6570\uff0c\u56e0\u4e3a\u5176\u64cd\u4f5c\u5f97\u90fd\u662f\u6570\u5b57\uff0c\u5efa\u8bae\u4ec5\u4f5c\u7528\u4e8e\u6570\u5b57\u7c7b\u578b\u7684\u5b57\u6bb5\u6216\u5e38\u91cf\u4e0a\n</code></pre>"},{"location":"basic/4.sql/#_43","title":"\u805a\u5408\u51fd\u6570","text":"<p><code>Aggregate Function</code>\u7ffb\u8bd1\u6210\u805a\u5408\u51fd\u6570\uff0c\u4ece\u591a\u884c\u8f93\u5165\u8ba1\u7b97\u5355\u4e2a\u7ed3\u679c\u884c\u3002\u8fd4\u56de\u7684\u7ed3\u679c\u662f\u57fa\u4e8e\u884c\u7ec4\u800c\u4e0d\u662f\u5355\u884c\uff08\u4e0e single row funtion \u5355\u884c\u51fd\u6570\u7684\u533a\u522b\uff09\u3002</p> <p>\u5b83\u53ef\u4ee5\u51fa\u73b0\u5728\u9009\u62e9\u5217\u8868\u3001order by \u5b50\u8bed\u3001having \u5b50\u8bed\u4e2d\u3002</p> <p>\u901a\u5e38\u6211\u4eec\u89c1\u5230\u7684 select \u5206\u7ec4\u5b57\u6bb5, sum() from \u8868\u540d group by \u5206\u7ec4\u5b57\u6bb5 [having ...]\u5f62\u5f0f\u7684\u5206\u7ec4\u6c47\u603b SQL\uff0c\u5176\u4e2d\u7684 SUM \u51fd\u6570\u5c31\u662f\u805a\u5408\u51fd\u6570\uff0c\u5e38\u7528\u7684\u805a\u5408\u51fd\u6570\u8fd8\u6709 COUNT\u3001AVG\u3001MAX\u3001MIN \u7b49\u3002</p> <p>\u805a\u5408\u51fd\u6570\u6709\u65f6\u4e5f\u88ab\u79f0\u4e3a\u6c47\u603b\u51fd\u6570\u3001\u5206\u7ec4\u51fd\u6570\u3002</p> <p>\u805a\u96c6\u51fd\u6570\u662f\u4ee5\u503c\u7684\u4e00\u4e2a\u96c6\u5408\u4e3a\u8f93\u5165\u3001\u8fd4\u56de\u5355\u4e2a\u503c\u7684\u51fd\u6570\uff0c\u6807\u51c6 SQL \u63d0\u4f9b\u4e86\u4e94\u4e2a\u56fa\u6709\u7684\u805a\u96c6\u51fd\u6570\uff1a</p> <ul> <li>\u5e73\u5747\u503c avg</li> <li>\u6700\u5c0f\u503c min</li> <li>\u6700\u5927\u503c max</li> <li>\u603b\u548c sum</li> <li>\u8ba1\u6570 count</li> </ul> <pre><code>--\u67e5\u8be2Biology\u7cfb\u7684\u5e73\u5747\u5de5\u8d44\nselect avg(salary) from instructor where dept_name='Biology'\n</code></pre>"},{"location":"basic/4.sql/#_44","title":"\u5b57\u7b26\u4e32\u51fd\u6570","text":"<p>\u5b57\u7b26\u51fd\u6570\u7528\u4e8e\u5b57\u7b26\u6570\u636e\u7684\u5904\u7406\uff0c\u4f8b\u5982\u5b57\u7b26\u4e32\u7684\u62fc\u63a5\u3001\u5927\u5c0f\u5199\u8f6c\u6362\u3001\u5b50\u4e32\u7684\u67e5\u627e\u548c\u66ff\u6362\u7b49\u3002</p> <pre><code>ASCII(char)                             -- \u8fd4\u56de\u5b57\u7b26\u7684ASCII\u7801\u503c      select ASCII(\"a\") \u2014\u2014&gt; 97\n\n-- \u8fde\u63a5\u5b57\u7b26\u4e32\nCONCAT(s1,s2...,sn)                     -- \u5c06s1,s2...,s\u7b49\u591a\u4e2a\u5b57\u7b26\u4e32\u62fc\u63a5\u8fde\u63a5\u6210\u4e00\u4e2a\u5b57\u7b26\u4e32  select CONCAT(\"a\",\"b\",\"c\"); \u2014\u2014&gt; abc\n                                        -- Oracle\u4e2d\u7684CONCAT\u51fd\u6570\u4e00\u6b21\u53ea\u80fd\u8fde\u63a5\u4e24\u4e2a\u5b57\u7b26 Oracle\u548cPostgreSQL\u4e5f\u63d0\u4f9b\u4e86\u8fde\u63a5\u8fd0\u7b97\u7b26\uff08||\uff09\uff0cMicrosoft SQL Server\u4f7f\u7528\u52a0\u53f7\uff08+\uff09\u4f5c\u4e3a\u8fde\u63a5\u8fd0\u7b97\u7b26\u3002\n-- MySQL\u3001Microsoft SQL Server\u4ee5\u53caPostgreSQL\nCONCAT_WS(sep,s1,s2...,sn)              -- \u5c06s1,s2...,sn\u8fde\u63a5\u6210\u5b57\u7b26\u4e32\uff0c\u5e76\u7528sep\u5b57\u7b26\u95f4\u9694   select CONCAT_WS(\"-\",\"a\",\"b\",\"c\") \u2014\u2014&gt; a-b-c\n\n-- \u67e5\u627e\u5b50\u4e32\nSUBSTRING(s, n, m)                      -- \u51fd\u6570\u8fd4\u56de\u5b57\u7b26\u4e32s\u4e2d\u4ece\u4f4d\u7f6en\u5f00\u59cb\u7684m\u4e2a\u5b57\u7b26\u7684\u5b50\u4e32\u3002 SELECT SUBSTRING('\u6570\u636e\u5e93', 1, 2); \u2014\u2014&gt; \u6570\u636e\nFIELD(str,str1,str2,str3,...)           -- \u8fd4\u56destr\u5728(str1,str2,str3,...)\u4e2d\u51fa\u73b0\u7684\u4f4d\u7f6e\uff0c SELECT FIELD('Bb', 'Aa', 'Bb', 'Cc', 'Dd', 'Ff');\nPOSITION(substr,str)                    -- \u8fd4\u56de\u5b50\u4e32substr\u5728\u5b57\u7b26\u4e32str\u4e2d\u7b2c\u4e00\u6b21\u51fa\u73b0\u7684\u4f4d\u7f6e\n\n-- \u83b7\u53d6\u5b50\u4e32\n-- MySQL\u3001Microsoft SQL Server\u4ee5\u53caPostgreSQL\u63d0\u4f9b\u4e86LEFT(s, n)\u548cRIGHT(s, n)\u51fd\u6570\uff0c\u5206\u522b\u7528\u4e8e\u8fd4\u56de\u5b57\u7b26\u4e32\u5f00\u5934\u548c\u7ed3\u5c3e\u7684n\u4e2a\u5b57\u7b26\u3002\n\n-- \u5b50\u4e32\u67e5\u627e\u4e0e\u66ff\u6362\nINSERT(str,x,y,instr)                   -- \u5c06\u5b57\u7b26\u4e32str\u4ece\u7b2cx\u4f4d\u7f6e\u5f00\u59cb\uff0cy\u4e2a\u5b57\u7b26\u957f\u7684\u5b50\u4e32\u66ff\u6362\u4e3a\u5b57\u7b26\u4e32instr\uff0c\u8fd4\u56de\u7ed3\u679c\n\nFIND_IN_SET(str,list)                   -- \u5206\u6790\u9017\u53f7\u5206\u9694\u7684list\u5217\u8868\uff0c\u5982\u679c\u53d1\u73b0str\uff0c\u8fd4\u56destr\u5728list\u4e2d\u7684\u4f4d\u7f6e  SELECT FIND_IN_SET('b','a,b,c,d');\n\n-- \u5927\u5c0f\u5199\u8f6c\u6362\nLCASE(str)\u6216LOWER(str)                  -- \u8fd4\u56de\u5c06\u5b57\u7b26\u4e32str\u4e2d\u6240\u6709\u5b57\u7b26\u6539\u53d8\u4e3a\u5c0f\u5199\u540e\u7684\u7ed3\u679c\nLEFT(str,x)                             -- \u8fd4\u56de\u5b57\u7b26\u4e32str\u4e2d\u6700\u5de6\u8fb9\u7684x\u4e2a\u5b57\u7b26\n\n\n\n-- \u5b57\u7b26\u4e32\u957f\u5ea6\n-- \u5b57\u7b26\u4e32\u7684\u957f\u5ea6\u53ef\u4ee5\u6309\u7167\u4e24\u79cd\u65b9\u5f0f\u8fdb\u884c\u8ba1\u7b97\uff1a\u5b57\u7b26\u6570\u91cf\u548c\u5b57\u8282\u6570\u91cf\u3002\n-- CHAR_LENGTH(s)\u51fd\u6570\u7528\u4e8e\u8ba1\u7b97\u5b57\u7b26\u4e32\u4e2d\u7684\u5b57\u7b26\u6570\u91cf\n-- OCTET_LENGTH(s)\u51fd\u6570\u7528\u4e8e\u8ba1\u7b97\u5b57\u7b26\u4e32\u5305\u542b\u7684\u5b57\u8282\u6570\u91cf\u3002\n-- \u5b57\u7b26\u4e32\u201c\u6570\u636e\u5e93\u201d\u5305\u542b3\u4e2a\u5b57\u7b26\uff0c\u5728UTF-8\u7f16\u7801\u4e2d\u5360\u75289\u4e2a\u5b57\u8282\u3002MySQL\u548cPostgreSQL\u5b9e\u73b0\u4e86\u8fd9\u4e24\u4e2a\u6807\u51c6\u51fd\u6570\u3002\nSELECT CHAR_LENGTH('\u6570\u636e\u5e93'), OCTET_LENGTH('\u6570\u636e\u5e93');  --3 9\nLENGTH(str)                             -- \u8fd4\u56de\u5b57\u7b26\u4e32str\u7684\u5b57\u8282\u6570(\u5b57\u8282\u6570)   select length(_utf8 '\u4e2d'); \u2014\u2014&gt; 3\nCHAR_LENGTH(str)                        -- \u8fd4\u56de\u5b57\u7b26\u4e32\u7684\u5b57\u7b26\u6570\u91cf(\u5b57\u7b26\u4e2a\u6570)   select  char_length(_utf8 '\u4e2d') \u2014\u2014&gt; 1\nBIT_LENGTH(str)                         -- \u8fd4\u56de\u5b57\u7b26\u4e32\u7684\u6bd4\u7279\u957f\u5ea6\n\n-- \u622a\u65ad\u5b57\u7b26\u4e32\n\n-- LTRIM(s)\u51fd\u6570\u53ef\u4ee5\u5220\u9664\u5b57\u7b26\u4e32\u5f00\u5934\u7684\u7a7a\u683c\uff0cRTRIM(s)\u51fd\u6570\u53ef\u4ee5\u5220\u9664\u5b57\u7b26\u4e32\u5c3e\u90e8\u7684\u7a7a\u683c\uff0c\u8fd9\u4e24\u4e2a\u51fd\u6570\u662fTRIM\u51fd\u6570\u7684\u7b80\u5316\u7248\nLTRIM(str)                              -- \u4ece\u5b57\u7b26\u4e32str\u4e2d\u5207\u6389\u5f00\u5934\u7684\u7a7a\u683c\nRTRIM(str)                              -- \u8fd4\u56de\u5b57\u7b26\u4e32str\u5c3e\u90e8\u7684\u7a7a\u683c\n\n\nQUOTE(str)                              -- \u7528\u53cd\u659c\u6760\u8f6c\u4e49str\u4e2d\u7684\u5355\u5f15\u53f7\nREPEAT(str,srchstr,rplcstr)             -- \u8fd4\u56de\u5b57\u7b26\u4e32str\u91cd\u590dx\u6b21\u7684\u7ed3\u679c\nREVERSE(str)                            -- \u8fd4\u56de\u98a0\u5012\u5b57\u7b26\u4e32str\u7684\u7ed3\u679c\nREPLACE(str,old_string,new_string);     -- REPLACE()\u51fd\u6570\u6709\u4e09\u4e2a\u53c2\u6570\uff0c\u5b83\u5c06string\u4e2d\u7684old_string\u66ff\u6362\u4e3anew_string\u5b57\u7b26\u4e32\u3002\nRIGHT(str,x)                            -- \u8fd4\u56de\u5b57\u7b26\u4e32str\u4e2d\u6700\u53f3\u8fb9\u7684x\u4e2a\u5b57\u7b26\n\nSTRCMP(s1,s2)                           -- \u6bd4\u8f83\u5b57\u7b26\u4e32s1\u548cs2\nTRIM(str)                               -- \u53bb\u9664\u5b57\u7b26\u4e32\u9996\u90e8\u548c\u5c3e\u90e8\u7684\u6240\u6709\u7a7a\u683c\nUCASE(str)\u6216UPPER(str)                  -- \u8fd4\u56de\u5c06\u5b57\u7b26\u4e32str\u4e2d\u6240\u6709\u5b57\u7b26\u8f6c\u53d8\u4e3a\u5927\u5199\u540e\u7684\u7ed3\u679c\n\n\nselect length(_utf8 '\u20ac'), char_length(_utf8 '\u20ac')\n--&gt; 3, 1\n\n\n\nmysql&gt; SET @dolphin:='\u6d77\u8c5a';\nQuery OK, 0 rows affected (0.01 sec)\n\nmysql&gt; SELECT LENGTH(@dolphin), CHAR_LENGTH(@dolphin);\n+------------------+-----------------------+\n| LENGTH(@dolphin) | CHAR_LENGTH(@dolphin) |\n+------------------+-----------------------+\n|                6 |                     2 |\n+------------------+-----------------------+\n1 row in set (0.00 sec)\n</code></pre>"},{"location":"basic/4.sql/#_45","title":"\u65e5\u671f\u65f6\u95f4\u51fd\u6570","text":"<pre><code>NOW()\n-- NOW()\u51fd\u6570\u8fd4\u56de\u5f53\u524d\u7684\u65e5\u671f\u548c\u65f6\u95f4\uff0c\u5305\u62ec\u5e74\u6708\u65e5\u65f6\u5206\u79d2\u3002\u4f8b\u5982\uff1a2024-01-05 07:31:28\u3002\n\nCURRENT_TIMESTAMP()\n-- CURRENT_TIMESTAMP()\u51fd\u6570\u8fd4\u56de\u5f53\u524d\u7684\u65e5\u671f\u548c\u65f6\u95f4\uff0c\u5305\u62ec\u5e74\u6708\u65e5\u65f6\u5206\u79d2\u3002\u4f8b\u5982\uff1a2024-01-05 07:31:28\u3002\n-- \u4e0eNOW()\u51fd\u6570\u7c7b\u4f3c\uff0c\u4f46\u662fCURRENT_TIMESTAMP()\u662f\u6807\u51c6SQL\u8bed\u6cd5\uff0c\u800cNOW()\u662fMySQL\u7279\u6709\u7684\u51fd\u6570\u3002\n-- \u4e5f\u53ef\u4ee5\u7528\u53d8\u91cfCURRENT_TIMESTAMP\u8868\u793a\u5f53\u524d\u65e5\u671f\u548c\u65f6\u95f4\n\n-- \u8bbe\u7f6e\u5b57\u6bb5\u5c5e\u6027\u4e3a\u65f6\u95f4\u6233\u7c7b\u578b\uff0c\u4e14\u628a\u9ed8\u8ba4\u503c\u8bbe\u7f6e\u6210CURRENT_TIMESTAMP\u7684\u60c5\u51b5\u4e0b\u3002\u5982\u679c\u4f60\u8bbe\u7f6e\u4e86\u65f6\u95f4\u968f\u5f53\u524d\u65f6\u95f4\u6233\u66f4\u65b0\uff08 ON UPDATE CURRENT_TIMESTAMP\uff09\uff0c\u90a3\u4e48\u5f53\u4f60\u66f4\u65b0\u5b57\u6bb5\u65f6\uff0c\u53ea\u6709\u5b57\u6bb5\u503c\u53d1\u751f\u53d8\u5316\u4e86\uff0c\u4f60\u7684\u65f6\u95f4\u5b57\u6bb5\u624d\u4f1a\u53d8\u4e3aUPDATE\u64cd\u4f5c\u65f6\u7684\u65f6\u95f4\n\nCREATE TABLE t1 (\n  ts TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,\n  dt DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP\n);\n\n\nSYSDATE()\n-- SYSDATE()\u51fd\u6570\u8fd4\u56de\u5f53\u524d\u7684\u65e5\u671f\u548c\u65f6\u95f4\uff0c\u4e0eNOW()\u51fd\u6570\u7c7b\u4f3c\uff0c\u5305\u62ec\u5e74\u6708\u65e5\u65f6\u5206\u79d2\u3002\u4f8b\u5982\uff1a2024-01-05 07:31:28\u3002\n-- \u4f46\u662fSYSDATE()\u51fd\u6570\u5728\u6bcf\u6b21\u8c03\u7528\u65f6\u4f1a\u4ece\u64cd\u4f5c\u7cfb\u7edf\u83b7\u53d6\u5f53\u524d\u65f6\u95f4\uff0c\u800cNOW()\u51fd\u6570\u5728\u8fde\u63a5\u5efa\u7acb\u65f6\u83b7\u53d6\u4e00\u6b21\uff0c\u5e76\u5728\u8fde\u63a5\u671f\u95f4\u8fd4\u56de\u76f8\u540c\u7684\u503c\u3002\n\nselect now(), sysdate(),sleep(3), now(),sysdate();\n2019-12-29 23:49:27 2019-12-29 23:49:27 0   2019-12-29 23:49:27 2019-12-29 23:49:30\n\n\n\nCURDATE()\n-- CURDATE()\u51fd\u6570\u8fd4\u56de\u5f53\u524d\u7684\u65e5\u671f\uff0c\u53ea\u5305\u62ec\u5e74\u6708\u65e5\uff0c\u4e0d\u5305\u62ec\u65f6\u95f4\u3002\u4f8b\u5982\uff1a2024-01-05\u3002\n\n\nCURRENT_DATE()\n-- CURRENT_DATE()\u51fd\u6570\u8fd4\u56de\u5f53\u524d\u7684\u65e5\u671f\uff0c\u53ea\u5305\u62ec\u5e74\u6708\u65e5\uff0c\u4e0d\u5305\u62ec\u65f6\u95f4\u3002\u4f8b\u5982\uff1a2024-01-05\u3002\n\n\u5176\u8fd4\u56de\u503c\u7684\u683c\u5f0f\u4e3a \u2018YYYY-MM-DD\u2019\uff0c\u5176\u4e2d \u2018YYYY\u2019 \u8868\u793a\u5e74\u4efd\uff0c\u2018MM\u2019 \u8868\u793a\u6708\u4efd\uff0c\u2018DD\u2019 \u8868\u793a\u65e5\u671f\u3002\n\n\nCURTIME()\n-- CURTIME()\u51fd\u6570\u8fd4\u56de\u5f53\u524d\u7684\u65f6\u95f4\uff0c\u53ea\u5305\u62ec\u65f6\u5206\u79d2\uff0c\u4e0d\u5305\u62ec\u65e5\u671f\u3002\u4f8b\u5982\uff1a07:31:28\u3002\n\nCURRENT_TIME():\n-- CURRENT_TIME()\u51fd\u6570\u8fd4\u56de\u5f53\u524d\u7684\u65f6\u95f4\uff0c\u53ea\u5305\u62ec\u65f6\u5206\u79d2\uff0c\u4e0d\u5305\u62ec\u65e5\u671f\u3002\u4f8b\u5982\uff1a07:31:28\u3002\n\n\n-- \u5f53\u524d\u65e5\u671f\uff1a2022-05-27\nselect DATE(CURRENT_TIME)\n\n-- sysdate() \u65e5\u671f\u65f6\u95f4\u51fd\u6570\u8ddf now() \u7c7b\u4f3c\u3002\u4e00\u822c\u5f88\u5c11\u7528\u5230\n-- \u4e0d\u540c\u4e4b\u5904\u5728\u4e8e\uff1anow() \u5728\u6267\u884c\u5f00\u59cb\u65f6\u503c\u5c31\u5f97\u5230\u4e86\uff0c sysdate() \u5728\u51fd\u6570\u6267\u884c\u65f6\u52a8\u6001\u5f97\u5230\u503c\u3002\n\n\n\n-- \u67e5\u8be2\u4e00\u5929\nselect * from \u8868\u540d where to_days(\u65f6\u95f4\u5b57\u6bb5\u540d) = to_days(now());\nselect * from \u8868\u540d where date(\u65f6\u95f4\u5b57\u6bb5\u540d) = curdate();\n\n--\u6628\u5929\nselect * from \u8868\u540d where to_days( now( ) ) - to_days( \u65f6\u95f4\u5b57\u6bb5\u540d) &lt;= 1;\n\n--7\u5929\nselect * from \u8868\u540d where date_sub(curdate(), interval 7 day) &lt;= date(\u65f6\u95f4\u5b57\u6bb5\u540d);\n\n--\u672c\u5468\u5185\nselect * from \u8868\u540d where \u65f6\u95f4\u5b57\u6bb5\u540d between current_date()-7 and sysdate();\n\n--\u8fd130\u5929\nselect * from \u8868\u540d where date_sub(curdate(), interval 30 day) &lt;= date(\u65f6\u95f4\u5b57\u6bb5\u540d);\nselect * from tbl_name where to_days(now()) - to_days(date_col) &lt;= 30;\n\n--\u672c\u6708\nselect * from \u8868\u540d where date_format( \u65f6\u95f4\u5b57\u6bb5\u540d, '%Y%m' ) = date_format(curdate( ) , '%Y%m' )\n\n-- \u67e5\u8be2\u4e00\u4e2a\u6708\nselect * from table where date_sub(curdate(), interval 1 month) &lt;= date(column_time);\n\n-- \u4e0a\u4e00\u6708\nselect * from \u8868\u540d where period_diff( date_format( now( ) , '%Y%m' ) , date_format( \u65f6\u95f4\u5b57\u6bb5\u540d, '%Y%m' ) ) =1\n</code></pre> <p>\u5176\u4ed6\u51fd\u6570</p> <pre><code>-- \u5f53\u524dMySQL\u7248\u672c  5.7.26-log\nselect version()\n\n-- \u5b57\u7b26\u4e32\u957f\u5ea6\uff1a 3 \uff0c3 \uff0c1   length\u8fd4\u56de\u5b57\u8282\u957f\u5ea6\uff0cchar_length\u8fd4\u56de\u5b57\u7b26\u6570\u91cf\nselect length(\"\u6211\") , length(\"\u4f60\") , char_length(\"\u4f60\");\n\n-- \u65e5\u671f\u683c\u5f0f\u5316  2019-12-27\nselect date_format(now(),'%y-%m-%d');\n\n\n\n-- md5\u52a0\u5bc6:8a6f60827608e7f1ae29d1abcecffc3a\nselect md5(\"andyqian\");\n-- \u5b57\u7b26\u4e32\u62fc\u63a5 andyqian\nselect concat(\"andy\",\"qian\");\n\n-- if\u51fd\u6570\u5224\u65ad\n\nselect t.name,if(t.weight&lt;80,'\u6b63\u5e38','\u80a5\u80d6') \u4f53\u91cd from t_customer t\n</code></pre> <p>\u53c2\u8003</p>"},{"location":"basic/4.sql/#_46","title":"\u89e6\u53d1\u5668","text":"<p>\u89e6\u53d1\u5668\u662f\u6bcf\u5f53\u53d1\u751f\u4e0e\u8868\u76f8\u5173\u7684\u4e8b\u4ef6\u65f6\u81ea\u52a8\u8c03\u7528\u7684\u51fd\u6570\u3002\u4e8b\u4ef6\u53ef\u4ee5\u662f\u4ee5\u4e0b\u4efb\u4f55\u4e00\u79cd\uff1aINSERT\uff0cUPDATE\uff0cDELETE \u6216 TRUNCATE\u3002</p> <p>\u89e6\u53d1\u5668\u662f\u7ed1\u5b9a\u5230\u8868\u7684\u7279\u6b8a\u7684\u7528\u6237\u81ea\u5b9a\u4e49\u51fd\u6570\u3002\u89e6\u53d1\u5668\u548c\u7528\u6237\u81ea\u5b9a\u4e49\u51fd\u6570\u7684\u4e0d\u540c\u4e4b\u5904\u5728\u4e8e\u89e6\u53d1\u4e8b\u4ef6(\u5f53\u8868\u53d1\u751f\u53d8\u5316\u65f6)\u53d1\u751f\u65f6\u4f1a\u81ea\u52a8\u8c03\u7528\u3002</p> <p>\u89e6\u53d1\u5668\u4e00\u65e6\u7531\u67d0\u7528\u6237\u5b9a\u4e49\uff0c\u4efb\u4f55\u7528\u6237\u5bf9\u89e6\u53d1\u5668\u89c4\u5b9a\u7684\u6570\u636e\u8fdb\u884c\u66f4\u65b0\u64cd\u4f5c\uff0c\u5747\u81ea\u52a8\u6fc0\u6d3b\u76f8\u5e94\u7684\u89e6\u53d1\u5668\u91c7\u53d6\u5e94\u5bf9\u63aa\u65bd\u3002</p> <p>\u89e6\u53d1\u5668\u672c\u8d28\u4e0a\u662f\u4e00\u6761 SQL \u8bed\u53e5\uff0c\u5f53\u5bf9\u6570\u636e\u5e93\u4e2d\u7684\u8868\u505a\u66f4\u65b0\u64cd\u4f5c\u65f6\uff0c\u5b83\u81ea\u52a8\u88ab\u7cfb\u7edf\u6267\u884c\u3002</p> <p>\u89e6\u53d1\u5668\u4e09\u8981\u7d20\uff1a</p> <ul> <li> <p>\u4e8b\u4ef6\uff1a\u5f15\u8d77\u89e6\u53d1\u5668\u52a8\u4f5c\u7684\u4e8b\u4ef6\uff0c\u901a\u5e38\u662f\u66f4\u65b0\u64cd\u4f5c\u3002</p> </li> <li> <p>\u6761\u4ef6\uff1a\u89e6\u53d1\u5668\u5c06\u6d4b\u8bd5\u6761\u4ef6\u662f\u5426\u6ee1\u8db3\u3002\u5982\u679c\u6761\u4ef6\u6ee1\u8db3\uff0c\u5c31\u6267\u884c\u76f8\u5e94\u7684\u64cd\u4f5c\uff0c\u5426\u5219\u4ec0\u4e48\u4e5f\u4e0d\u505a\u3002</p> </li> <li> <p>\u52a8\u4f5c\uff1a\u5982\u679c\u89e6\u53d1\u5668\u6d4b\u8bd5\u6ee1\u8db3\u9884\u8ba2\u7684\u6761\u4ef6\uff0c\u5c31\u7531 DBMS \u6267\u884c\u8fd9\u4e9b\u52a8\u4f5c\u3002\u8fd9\u4e9b\u52a8\u4f5c\u53ef\u4ee5\u662f\u4e00\u7cfb\u5217\u5bf9\u6570\u636e\u5e93\u7684\u64cd\u4f5c</p> </li> </ul> <pre><code>-- \u521b\u5efa\u89e6\u53d1\u5668\u7684\u8bed\u6cd5\n\nCREATE [DEFINER = user] TRIGGER trigger_name tirgger_time trigger_event\nON tbl_name FOR EACH ROW\nBEGIN\n    trigger_stmt\nEND\n\n-- trigger_name\uff1a\u89e6\u53d1\u5668\u7684\u540d\u79f0\n-- tirgger_time\uff1a\u89e6\u53d1\u65f6\u673a\uff0c\u4e3aBEFORE\u6216\u8005AFTER\n-- rigger_event\uff1a\u89e6\u53d1\u4e8b\u4ef6\uff0c\u4e3aINSERT\u3001DELETE\u6216\u8005UPDATE\n-- tb_name\uff1a\u8868\u793a\u5efa\u7acb\u89e6\u53d1\u5668\u7684\u8868\u660e\uff0c\u5c31\u662f\u5728\u54ea\u5f20\u8868\u4e0a\u5efa\u7acb\u89e6\u53d1\u5668\n-- trigger_stmt\uff1a\u89e6\u53d1\u5668\u7684\u52a8\u4f5c\u7a0b\u5e8f\u4f53\uff0c\u53ef\u4ee5\u662f\u4e00\u6761SQL\u8bed\u53e5\u6216\u8005\u662f\u7528BEGIN\u548cEND\u5305\u542b\u7684\u591a\u6761\u8bed\u53e5\n</code></pre>"},{"location":"basic/4.sql/#_47","title":"\u5b58\u50a8\u8fc7\u7a0b","text":""},{"location":"basic/4.sql/#_48","title":"\u6d41\u7a0b\u63a7\u5236\u8bed\u53e5","text":"\u8bed\u53e5 <code>CASE</code> <code>IF()</code> <code>IFNULL()</code> <code>NULLIF()</code>"},{"location":"basic/4.sql/#_49","title":"\u7a97\u53e3\u51fd\u6570","text":"<p>\u7a97\u53e3\u51fd\u6570\uff08Window Function\uff09\u662f <code>SQL2003</code> \u6807\u51c6\u4e2d\u5b9a\u4e49\u7684\u4e00\u9879\u65b0\u7279\u6027\uff0c\u5e76\u5728 <code>SQL2011</code> \u548c <code>SQL2016</code> \u4e2d\u53c8\u52a0\u4ee5\u5b8c\u5584\uff0c\u6dfb\u52a0\u4e86\u82e5\u5e72\u5904\u62d3\u5c55\u3002\u7a97\u53e3\u51fd\u6570\u4e5f\u88ab\u79f0\u4e3a\u8054\u673a\u5206\u6790\u5904\u7406\uff08OLAP\uff09\u51fd\u6570\uff0c\u5728 <code>Oracle</code> \u4e2d\u4e5f\u79f0\u5206\u6790\u51fd\u6570\uff08Analytic Function\uff09\u3002</p> <p>\u7a97\u53e3\u51fd\u6570\u4e0d\u540c\u4e8e\u6211\u4eec\u719f\u6089\u7684\u666e\u901a\u51fd\u6570\u548c\u805a\u5408\u51fd\u6570\uff0c\u5b83\u4e3a\u6bcf\u884c\u6570\u636e\u8fdb\u884c\u4e00\u6b21\u8ba1\u7b97\uff1a\u8f93\u5165\u591a\u884c\uff08\u4e00\u4e2a\u7a97\u53e3\uff09\u3001\u8fd4\u56de\u4e00\u4e2a\u503c\u3002\u5728\u62a5\u8868\u7b49\u5206\u6790\u578b\u67e5\u8be2\u4e2d\uff0c\u7a97\u53e3\u51fd\u6570\u80fd\u4f18\u96c5\u5730\u8868\u8fbe\u67d0\u4e9b\u9700\u6c42\uff0c\u53d1\u6325\u4e0d\u53ef\u66ff\u4ee3\u7684\u4f5c\u7528\u3002</p> <p>\u5927\u90e8\u5206\u6570\u636e\u5e93\uff0c\u5c24\u5176\u662f\u5546\u4e1a\u6570\u636e\u5e93\u90fd\u652f\u6301 SQL \u6807\u51c6\u4e2d\u5b9a\u4e49\u7684\u90e8\u5206\u7a97\u53e3\u51fd\u6570\uff0c\u4f46\u662f MySQL \u4e00\u76f4\u6ca1\u6709\u652f\u6301\u8fd9\u4e2a\u7279\u6027\u3002\u7a97\u53e3\u51fd\u6570\u5728 MySQL \u793e\u533a\u4e00\u76f4\u547c\u58f0\u5f88\u9ad8\uff0c\u5374\u4e00\u76f4\u6ca1\u6709\u88ab\u5b9e\u73b0\uff0c\u76f4\u5230 MairaDB 10.2 \u548c MySQL8.0 \u624d\u54cd\u5e94\u4e86\u5ba2\u6237\u7684\u9700\u6c42\uff0c\u5b9e\u73b0\u4e86\u90e8\u5206\u7a97\u53e3\u51fd\u6570\u3002\u3000 <code>Oracle 11g</code> \u3001 <code>SQL Server 2008</code> \u3001 <code>DB2 9.7</code> \u3001 <code>PostgreSQL 8.4</code> \u90fd\u652f\u6301\u7a97\u53e3\u51fd\u6570\u3002</p> <p><code>MySQL8</code> \u5f00\u59cb\u652f\u6301\u7a97\u53e3\u51fd\u6570\uff0c\u5305\u62ec <code>rank()</code>\u3001<code>lag()</code> \u548c <code>ntile()</code> \u7b49\u975e\u805a\u5408\u7a97\u53e3\u51fd\u6570\u3002\u4ee5\u53ca\u90e8\u5206\u805a\u5408\u51fd\u6570\u73b0\u5728\u53ef\u4ee5\u7528\u4f5c\u7a97\u53e3\u51fd\u6570\uff0c\u4f8b\u5982\uff1a<code>sum()</code>\u548c <code>avg()</code>\u3002</p> <p>\u7a97\u53e3\u51fd\u6570(Window Function)\uff0c\u53c8\u88ab\u53eb\u505a\u5206\u6790\u51fd\u6570(Analytics Function)\uff0c\u901a\u5e38\u5728\u9700\u8981\u5bf9\u6570\u636e\u8fdb\u884c\u5206\u7ec4\u6c47\u603b\u8ba1\u7b97\u65f6\u4f7f\u7528\uff0c\u56e0\u6b64\u4e0e\u805a\u5408\u51fd\u6570\u6709\u4e00\u5b9a\u7684\u76f8\u4f3c\u6027\u3002\u4f46\u4e0e\u805a\u5408\u51fd\u6570\u4e0d\u540c\u7684\u662f\uff0c\u805a\u5408\u51fd\u6570\u901a\u8fc7\u5bf9\u6570\u636e\u8fdb\u884c\u5206\u7ec4\uff0c\u4ec5\u80fd\u591f\u8f93\u51fa\u5206\u7ec4\u6c47\u603b\u7ed3\u679c\uff0c\u800c\u539f\u59cb\u6570\u636e\u5219\u65e0\u6cd5\u5c55\u73b0\u5728\u7ed3\u679c\u4e2d\u3002\u800c\u7a97\u53e3\u51fd\u6570\u5219\u53ef\u4ee5\u540c\u65f6\u5c06\u539f\u59cb\u6570\u636e\u548c\u805a\u96c6\u5206\u6790\u7ed3\u679c\u540c\u65f6\u663e\u793a\u51fa\u6765\u3002</p> <p>\u901a\u5e38\u60c5\u51b5\u4e0b\uff0cSQL \u64cd\u4f5c\u6570\u636e\u662f\u57fa\u4e8e\u540c\u884c (row) \u6216\u8005\u540c\u5217(column)\u7684\u3002\u65e0\u8bba\u662f <code>WHERE</code> \u6761\u4ef6\u8fd8\u662f\u8fd8\u662f\u51fd\u6570\u805a\u5408\uff0c\u9ed8\u8ba4\u90fd\u662f\u540c\u4e00\u884c\u7684\u4e0d\u540c\u5217\uff0c\u6216\u8005\u662f\u540c\u4e00\u5217\u7684\u4e0d\u540c\u884c\u8fdb\u884c\u3002\u800c\u73b0\u5b9e\u7684\u6570\u636e\u5206\u6790\u9700\u6c42\u5f88\u5927\u4e00\u90e8\u5206\u90fd\u662f\u8981\u57fa\u4e8e\"\u524d\u56e0\u540e\u679c\"\u7684\uff0c\u56e0\u6b64\u5728\u6570\u636e\u6574\u5408\u7684\u64cd\u4f5c\u8fc7\u7a0b\u4e2d\uff0c\u5c31\u65e0\u6cd5\u907f\u514d\u8981\u9762\u5bf9\"\u4f4d\u79fb\"\u7684\u903b\u8f91\u5904\u7406\uff0c\u6240\u8c13\u4f4d\u79fb\u5c31\u662f\u53c2\u8003\u70b9\u548c\u89c2\u5bdf\u70b9\u7684\u504f\u79fb\u91cf\u3002\u6bd4\u5982\uff0c\u6211\u4eec\u5728\u505a\u7559\u5b58\u5206\u6790\u65f6\uff0c\u901a\u5e38\u4f1a\u975e\u5e38\u5173\u6ce8\u65e5\u6ce8\u518c\u7528\u6237\u7684\u7559\u5b58\u7387\uff0c\u4f8b\u5982 1-7 \u65e5\u7559\u5b58\u7387\uff08\u5982\u4e0b\u8868\uff09\uff0c\u4e5f\u5c31\u662f\u7528\u6237\u6ce8\u518c\u540e\u8fc7 1 \u5929\u30012 \u5929....\u5230\u7b2c 7 \u5929\u91cc\uff0c\u6bcf\u4e00\u5929\u8fd8\u5269\u591a\u5c11\u6bd4\u4f8b\u7684\u6d3b\u8dc3\uff08\u5373\u6709\u8fc7\u767b\u5f55\u6216\u6d4f\u89c8\uff09\u7528\u6237\u91cf\u3002</p> <p>\u7a97\u53e3\u51fd\u6570\u51fa\u73b0\u5728 SELECT \u5b50\u53e5\u7684\u8868\u8fbe\u5f0f\u5217\u8868\u4e2d\uff0c\u5b83\u6700\u663e\u8457\u7684\u7279\u70b9\u5c31\u662f OVER \u5173\u952e\u5b57\u3002\u8bed\u6cd5\u5b9a\u4e49\u5982\u4e0b\uff1a</p> <pre><code>--DDL\nCREATE TABLE `tbl_ware` (\n  `ware_id` BIGINT(20) UNSIGNED NOT NULL AUTO_INCREMENT COMMENT '\u5546\u54c1id',\n  `ware_name` VARCHAR(100) NOT NULL COMMENT '\u5546\u54c1\u540d\u79f0',\n  `ware_category` VARCHAR(100) NOT NULL COMMENT '\u5546\u54c1\u7c7b\u522b',\n    `sale_unit_price` INT COMMENT '\u9500\u552e\u5355\u4ef7',\n    `purchase_unit_price` INT COMMENT '\u8fdb\u8d27\u5355\u4ef7',\n    `registration_date` DATE COMMENT '\u7b49\u7ea7\u65e5\u671f',\n  PRIMARY KEY (`ware_id`) USING BTREE\n) ENGINE=InnoDB COMMENT='\u4ea7\u54c1';\n\n-- DML\nINSERT INTO tbl_ware VALUES\n(1,'T\u6064\u886b','\u8863\u670d',100, 50,'2023-12-15'),\n(2,'\u6253\u5b54\u5668','\u529e\u516c\u7528\u54c1',25, 10,'2023-12-15'),\n(3,'\u8fd0\u52a8T\u6064','\u8863\u670d',150, 50,'2023-12-15'),\n(4,'\u83dc\u5200','\u53a8\u623f\u7528\u5177',75, 30,'2023-12-15'),\n(5,'\u9ad8\u538b\u9505','\u53a8\u623f\u7528\u5177',600, 200,'2023-12-15'),\n(6,'\u53c9\u5b50','\u53a8\u623f\u7528\u5177',7, 3,'2023-12-15'),\n(7,'\u83dc\u677f','\u53a8\u623f\u7528\u5177',98, 30,'2023-12-15'),\n(8,'\u5706\u73e0\u7b14','\u529e\u516c\u7528\u54c1',5, 2,'2023-12-15');\n\n\n-- \u6309\u552e\u4ef7\u4ece\u9ad8\u5230\u4f4e\u8fdb\u884c\u6392\u540d\uff1a\u666e\u901a\u6392\u5e8f\nSELECT * FROM tbl_ware ORDER BY sale_unit_price DESC;\n\n-- \u6309\u552e\u4ef7\u4ece\u9ad8\u5230\u4f4e\u8fdb\u884c\u6392\u540d\uff1a\u7a97\u53e3\u51fd\u6570\nSELECT *, RANK() OVER(ORDER BY sale_unit_price DESC) AS ranking FROM tbl_ware;\n\n\n\n-- \u5bf9 tbl_ware \u6309\u7c7b\u522b\u8fdb\u884c\u5206\u7ec4\uff0c\u7136\u540e\u7ec4\u5185\u6309\u552e\u4ef7\u4ece\u9ad8\u5230\u4f4e\u8fdb\u884c\u6392\u540d\n-- PARTITION BY \u5bf9\u8868\u7684\u6a2a\u5411\u8fdb\u884c\u5206\u7ec4\uff0c\u7c7b\u4f3c GROUP BY \uff0c\u4f46\u4e0d\u5177\u5907\u805a\u5408\u529f\u80fd\uff1a \u901a\u8fc7 PARTITION BY \u5206\u7ec4\u540e\u7684\u8bb0\u5f55\u96c6\u5408\u79f0\u4e3a\u300c\u7a97\u53e3\u300d\uff0c\u4ee3\u8868\u8303\u56f4\u3002\u8fd9\u4e5f\u662f\u300c\u7a97\u53e3\u51fd\u6570\u300d\u540d\u79f0\u7684\u7531\u6765\n-- ORDER BY \u5219\u51b3\u5b9a\u4e86\u5206\u7ec4\u540e\u7684\u7ec4\u5185\u6392\u5e8f\uff1a\u7eb5\u5411\u6392\u5e8f\u7684\u89c4\u5219\uff0c\u4e0e SELECT \u5b50\u53e5\u672b\u5c3e\u7684 ORDER BY \u5b50\u53e5\u5b8c\u5168\u76f8\u540c\nSELECT *, RANK() OVER(PARTITION BY ware_category ORDER BY sale_unit_price DESC) AS ranking FROM tbl_ware;\n\n\n\n\n\nwindow_function (expression) [null_treatment]  OVER (\n   [ PARTITION BY part_list ]\n   [ ORDER BY order_list ]\n   [ { ROWS | RANGE } BETWEEN frame_start AND frame_end ] )\n\n-- window_function \u662f\u7a97\u53e3\u51fd\u6570\u7684\u540d\u79f0\n-- expression \u662f\u7a97\u53e3\u51fd\u6570\u64cd\u4f5c\u7684\u5bf9\u8c61\uff0c\u53ef\u4ee5\u662f\u5b57\u6bb5\u6216\u8005\u8868\u8fbe\u5f0f\uff1b\n-- OVER \u5b50\u53e5\u5305\u542b\u4e09\u4e2a\u90e8\u5206\uff1a\u5206\u533a\uff08PARTITION BY\uff09\u3001\u6392\u5e8f\uff08ORDER BY\uff09\u4ee5\u53ca\u7a97\u53e3\u5927\u5c0f\uff08frame_clause\uff09\n\n\nSELECT  SUM(amount) AS sum_amount\nFROM sales_data WHERE saledate = '2019-01-01';\n\nselect saledate, product, sum(amount) over() as sum_amount\nfrom sales_data\nwhere saledate = '2019-01-01'\n</code></pre> <p>\u7a97\u53e3\u51fd\u6570 window_function \u53ef\u4ee5\u5206\u4e3a\u4ee5\u4e0b 3 \u7c7b\uff1a</p> <ul> <li> <p>\u805a\u5408\uff08Aggregate\uff09\uff1aAVG(), COUNT(), MIN(), MAX(), SUM()...</p> </li> <li> <p>\u53d6\u503c\uff08Value\uff09\uff1aFIRST_VALUE(), LAST_VALUE(), LEAD(), LAG()...</p> </li> <li> <p>\u6392\u5e8f\uff08Ranking\uff09\uff1aRANK(), DENSE_RANK(), ROW_NUMBER(), NTILE()...</p> </li> </ul> <p>\u5176\u4e2d\u5305\u62ec\u4ee5\u4e0b\u53ef\u9009\u9879\uff1a</p> <ul> <li> <p>PARTITION BY \u8868\u793a\u5c06\u6570\u636e\u5148\u6309 part_list \u8fdb\u884c\u5206\u533a\uff0c\u4f5c\u7528\u7c7b\u4f3c\u4e8e GROUP BY \u5206\u7ec4\uff1b\u5982\u679c\u6307\u5b9a\u4e86\u5206\u533a\u9009\u9879\uff0c\u7a97\u53e3\u51fd\u6570\u5c06\u4f1a\u5206\u522b\u9488\u5bf9\u6bcf\u4e2a\u5206\u533a\u5355\u72ec\u8fdb\u884c\u5206\u6790\uff08\u76f8\u540c\u7684\u5206\u4e3a\u4e00\u4e2a\u533a\uff0c\u7136\u540e\u5bf9\u6bcf\u4e2a\u5206\u533a\u91cc\u9762\u7684\u503c\u662f\u4f7f\u7528 window_function \u8fdb\u884c\u8ba1\u7b97\uff09\u3002</p> </li> <li> <p>ORDER BY \u8868\u793a\u5c06\u5404\u4e2a\u5206\u533a\u5185\u7684\u6570\u636e\u6309 order_list \u8fdb\u884c\u6392\u5e8f</p> </li> <li> <p>FRAME \uff0c\u8868\u793a\u5f53\u524d\u7a97\u53e3\u5305\u542b\u54ea\u4e9b\u6570\u636e\u3002\u6ed1\u52a8\u7a97\u53e3\u6709\u4e24\u79cd\u6307\u5b9a\u8303\u56f4\u7684\u65b9\u5f0f\uff0c\u4e00\u79cd\u662f\u57fa\u4e8e\u884c\uff0c\u4e00\u79cd\u662f\u57fa\u4e8e\u8303\u56f4\u3002</p> </li> <li> <p>ROWS \u9009\u62e9\u524d\u540e\u51e0\u884c\uff0c\u4f8b\u5982 ROWS BETWEEN 3 PRECEDING AND 3 FOLLOWING \u8868\u793a\u5f80\u524d 3 \u884c\u5230\u5f80\u540e 3 \u884c\uff0c\u4e00\u5171 7 \u884c\u6570\u636e\uff08\u6216\u5c0f\u4e8e 7 \u884c\uff0c\u5982\u679c\u78b0\u5230\u4e86\u8fb9\u754c\uff09</p> </li> <li> <p>RANGE \u9009\u62e9\u6570\u636e\u8303\u56f4\uff0c\u4f8b\u5982 RANGE BETWEEN 3 PRECEDING AND 3 FOLLOWING \u8868\u793a\u6240\u6709\u503c\u5728 [c-3,c+3] \u8fd9\u4e2a\u8303\u56f4\u5185\u7684\u884c\uff0cc \u4e3a\u5f53\u524d\u884c\u7684\u503c</p> </li> <li> <p>ROWS \u548c RANGE \u7684\u8303\u56f4\u8fb9\u754c\u4e5f\u53ef\u4ee5\u7528 CURRENT ROW</p> </li> </ul> <p>Frame \u5b9a\u4e49\u5e76\u975e\u6240\u6709\u7a97\u53e3\u51fd\u6570\u90fd\u9002\u7528\uff0c\u6bd4\u5982 ROW_NUMBER()\u3001RANK()\u3001LEAD() \u7b49\u3002\u8fd9\u4e9b\u51fd\u6570\u603b\u662f\u5e94\u7528\u4e8e\u6574\u4e2a\u5206\u533a\uff0c\u800c\u975e\u5f53\u524d Frame\u3002</p> <pre><code>SELECT dealer_id, emp_name, sales,\n       ROW_NUMBER() OVER (PARTITION BY dealer_id ORDER BY sales) AS rank,\n       AVG(sales) OVER (PARTITION BY dealer_id) AS avgsales\nFROM sales\n</code></pre> <p>\u7a97\u53e3</p> <p>row_number() \u5219\u5728\u6392\u5e8f\u76f8\u540c\u65f6\u4e0d\u91cd\u590d\uff0c\u4f1a\u6839\u636e\u987a\u5e8f\u6392\u5e8f\u3002</p> <p>rank()\u6392\u5e8f\u76f8\u540c\u65f6\u4f1a\u91cd\u590d\uff0c\u603b\u6570\u4e0d\u4f1a\u53d8 \uff0c\u610f\u601d\u662f\u4f1a\u51fa\u73b0 1\u30011\u30013 \u8fd9\u6837\u7684\u6392\u5e8f\u7ed3\u679c\uff1b</p> <p>dense_rank() \u6392\u5e8f\u76f8\u540c\u65f6\u4f1a\u91cd\u590d\uff0c\u603b\u6570\u4f1a\u51cf\u5c11\uff0c\u610f\u601d\u662f\u4f1a\u51fa\u73b0 1\u30011\u30012 \u8fd9\u6837\u7684\u6392\u5e8f\u7ed3\u679c\u3002</p> <p>\u60f3\u770b\u5404\u4e2a department \u5185\u90e8\u6536\u5165\u6700\u591a\u7684\u4eba\uff0c\u8fd9\u65f6\u5019\u4e0d\u80fd\u5168\u8868 order by \u4e86</p> <p>SQL \u6807\u51c6\u652f\u6301 4 \u79cd\u7528\u4e8e\u6392\u540d\u8ba1\u7b97\u7684\u7a97\u53e3\u51fd\u6570\u3002\u5b83\u4eec\u662f\uff1aROW_NUMBER\u3001NTILE\u3001RANK \u548c DENSE_RANK\u3002\u5728\u6807\u51c6\u4e2d\uff0c\u524d\u4e24\u8005\u662f\u4e00\u7c7b\uff0c\u540e\u4e24\u8005\u662f\u53e6\u4e00\u7c7b\u3002</p> <p>ROW_NUMBER \u51fd\u6570\u6839\u636e\u6307\u5b9a\u7684\u987a\u5e8f\uff0c\u4ece 1 \u5f00\u59cb\u8ba1\u7b97\u8fde\u7eed\u7684\u884c\u53f7\u3002NTILE \u51fd\u6570\u628a\u7a97\u53e3\u5206\u533a\u91cc\u7684\u6570\u636e\u884c\u5206\u6210\u6570\u91cf\u5927\u81f4\u76f8\u7b49\u7684\u5757\uff08\u6839\u636e\u8f93\u5165\u7684\u5757\u6570\u548c\u6307\u5b9a\u7684\u7a97\u53e3\u6392\u5e8f\uff09\u3002</p> <p>ROW_NUMBER</p> <ul> <li> <p>\u529f\u80fd\uff1a\u7528\u4e8e\u5b9e\u73b0\u5206\u533a\u5185\u8bb0\u5f55\u7f16\u53f7</p> </li> <li> <p>\u8bed\u6cd5\uff1arow_number() over (partition by col1 order by col2)</p> </li> <li> <p>\u793a\u4f8b\uff1a\u7edf\u8ba1\u6bcf\u4e2a\u90e8\u95e8\u85aa\u8d44\u6700\u9ad8\u7684\u524d\u4e24\u540d</p> </li> </ul> <pre><code>select\n  empno,\n  ename,\n  salary,\n  deptno,\n  row_number() over (partition by deptno order by salary desc) as numb\nfrom\n  db_emp.tb_emp;\n\n--\u6b64\u65f6\u4e3a\u6392\u540d,\u8981\u6c42\u53d6\u524d\u4e24\u540d,\u4f5c\u4e3a\u4e34\u65f6\u8868t\u518d\u5957\u4e00\u5c42\u67e5\u8be2\u5373\u53ef\n\nselect\n*\nfrom\n    (select\n          empno,\n          ename,\n          salary,\n          deptno,\n          row_number() over (partition by deptno order by salary desc) as numb\n    from\n      db_emp.tb_emp) t\nwhere t.numb &lt; 3;\n</code></pre> <p>RANK</p> <ul> <li> <p>\u529f\u80fd\uff1a\u7528\u4e8e\u5b9e\u73b0\u5206\u533a\u5185\u6392\u540d\u7f16\u53f7[\u4f1a\u7559\u7a7a\u4f4d]</p> </li> <li> <p>\u4e0e row_number \u7684\u533a\u522b\uff1a</p> </li> <li> <p>row_number\uff1a\u5982\u679c\u6392\u5e8f\u65f6\u6570\u503c\u76f8\u540c\uff0c\u7ee7\u7eed\u7f16\u53f7</p> </li> <li> <p>rank\uff1a\u5982\u679c\u6392\u5e8f\u65f6\u6570\u503c\u76f8\u540c\uff0c\u7f16\u53f7\u76f8\u540c\uff0c\u4f46\u7559\u4e0b\u7a7a\u4f4d</p> </li> <li> <p>\u8bed\u6cd5\uff1arank() over (partition by col1 order by col2)</p> </li> <li> <p>\u793a\u4f8b\uff1a\u7edf\u8ba1\u6bcf\u4e2a\u90e8\u95e8\u85aa\u8d44\u6392\u540d</p> </li> </ul> <pre><code>select\n  empno,\n  ename,\n  salary,\n  deptno,\n  rank() over (partition by deptno order by salary desc) as numb\nfrom\n  db_emp.tb_emp;\n</code></pre> <pre><code>USE db_test;\nDROP TABLE IF EXISTS  student ;\n\nCREATE TABLE  student (\n    name VARCHAR(20) NOT NULL,\n    subject VARCHAR(20) NOT NULL,\n    score INT NOT NULL\n) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;\n\ninsert into student(name,subject,score)\n    values\n(\"\u5c0f\u660e\",\"\u8bed\u6587\",66),\n(\"\u5c0f\u660e\",\"\u6570\u5b66\",67),\n(\"\u5c0f\u660e\",\"\u82f1\u8bed\",69),\n(\"\u5c0f\u7ea2\",\"\u8bed\u6587\",65),\n(\"\u5c0f\u7ea2\",\"\u6570\u5b66\",99),\n(\"\u5c0f\u7ea2\",\"\u82f1\u8bed\",88),\n(\"\u5c0f\u5f3a\",\"\u8bed\u6587\",60),\n(\"\u5c0f\u5f3a\",\"\u6570\u5b66\",72),\n(\"\u5c0f\u5f3a\",\"\u82f1\u8bed\",92);\n\n\n-- \u8ba1\u7b97\u6bcf\u4e2a\u5b66\u751f\u81ea\u5df1\u7684\u5404\u79d1\u6392\u540d\uff08\u7ec4\u5185\u6392\u5e8f\uff09\nSELECT name, subject, score,\n      row_number() OVER (partition BY name ORDER BY score DESC) as n\nFROM student ;\n\n\n\n\n--\u6bcf\u4e2a\u79d1\u76ee\u6700\u9ad8\u7684\u6210\u7ee9\u4ee5\u53ca\u5bf9\u5e94\u7684\u540c\u5b66\u548c\u79d1\u76ee\n\nSELECT name, subject, score FROM (\n    SELECT name, subject, score,\n      ROW_NUMBER() OVER (PARTITION BY subject ORDER BY score  ) AS n\nFROM student ) AS top WHERE top.n &lt;2\n\n\n\n--\u601d\u8def\u5206\u6790\uff0c\u9996\u5148\u6309\u7167\u79d1\u76ee\u5206\u7ec4\u5e76\u805a\u5408\u6c42\u6700\u5927\u503c\u3002\u5c06\u5176\u7ed3\u679c\u96c6\u4e0e\u539f\u8868\u5173\u8054\uff0c\u67e5\u51fa\u540c\u5b66\u540d\u79f0\u5373\u53ef\u3002\n\n    SELECT\n        b.name,\n        b.subject,\n        b.score\n    FROM\n        (\n            SELECT\n                subject,\n                MAX(score) AS score\n                FROM\n                    student\n                GROUP BY\n                    subject\n        ) a\n    JOIN student b ON a.subject = b.subject\n    AND a.score = b.score\n</code></pre>"},{"location":"basic/4.sql/#_50","title":"\u7a97\u53e3\u51fd\u6570\u548c\u805a\u5408\u51fd\u6570\u7684\u533a\u522b","text":"<p>\u7a97\u53e3\u51fd\u6570\u4ec5\u4ec5\u53ea\u4f1a\u5c06\u7ed3\u679c\u9644\u52a0\u5230\u5f53\u524d\u7684\u7ed3\u679c\u4e0a\uff0c\u5b83\u4e0d\u4f1a\u5bf9\u5df2\u6709\u7684\u884c\u6216\u5217\u505a\u4efb\u4f55\u4fee\u6539\u3002</p> <p>\u800c Group By \u7684\u505a\u6cd5\u5b8c\u5168\u4e0d\u540c\uff1a\u5bf9\u4e8e\u5404\u4e2a Group \u5b83\u4ec5\u4ec5\u4f1a\u4fdd\u7559\u4e00\u884c\u805a\u5408\u7ed3\u679c\u3002</p> <p>\u56e0\u4e3a SQL \u53ca\u5173\u7cfb\u4ee3\u6570\u90fd\u662f\u4ee5 multi-set \u4e3a\u57fa\u7840\u5b9a\u4e49\u7684\uff0c\u7ed3\u679c\u96c6\u672c\u8eab\u5e76\u6ca1\u6709\u987a\u5e8f\u53ef\u8a00\uff0cORDER BY \u4ec5\u4ec5\u662f\u6700\u7ec8\u5448\u73b0\u7ed3\u679c\u7684\u987a\u5e8f\u3002</p> <p>MySQL \u5b98\u7f51</p> <p>\u53c2\u8003</p> <p>\u53c2\u8003</p> <p>\u53c2\u8003</p> <p>\u53c2\u8003</p>"},{"location":"basic/4.sql/#sql_6","title":"SQL \u7684\u601d\u7ef4\u65b9\u5f0f","text":"<p>SQL \u672c\u8eab\u662f\u4e00\u79cd DSL\uff08\u9886\u57df\u63cf\u8ff0\u8bed\u8a00\uff09\uff0c\u5b83\u7531\u6570\u5b66\u5bb6\uff08\u65e9\u671f\u8ba1\u7b97\u673a\u6280\u672f\u5927\u90fd\u662f\u7531\u9886\u57df\u5e94\u7528\u4e2d\u7684\u6570\u5b66\u4e13\u5bb6\u4e3b\u5bfc\u7684\uff09\u53d1\u660e\u7528\u6765\u8868\u8fbe\u6570\u636e\u67e5\u8be2\u7684\u63cf\u8ff0\u6027\u8bed\u8a00\u3002\u4e00\u822c\u5730\uff0c\u5927\u5b66\u8ba1\u7b97\u673a\u8bfe\u7a0b\u4e2d\uff0c\u90fd\u8bbe\u6709\u6570\u636e\u5e93\u57fa\u7840\u3001\u6570\u636e\u5e93\u539f\u7406\u8fd9\u7c7b\u8bfe\u7a0b\uff0c\u5176\u4e2d\u4f1a\u6709\u975e\u5e38\u957f\u7684\u7bc7\u5e45\u4ecb\u7ecd SQL \u8bed\u8a00\uff0c\u4ecb\u7ecd select\u3001update\u3001insert\u3001delete\uff0c\u90fd\u662f\u975e\u5e38\u6807\u51c6\u7684\u901a\u7528\u8bed\u6cd5\uff0c\u53ea\u662f\u5927\u5b66\u8001\u5e08\u901a\u5e38\u4e0d\u4f1a\u8ddf\u4f60\u8bf4\uff0c\u5b9e\u9645\u5de5\u7a0b\u4e2d\u4f7f\u7528\u5230\u7684 SQL \u8981\u6bd4\u6559\u7a0b\u4e2d\u7684\u590d\u6742\u5f97\u591a\u3002</p> <p>\u4e3a\u4ec0\u4e48\u53ea\u662f select\u3001update\u3001insert\u3001delete\uff0c\u56e0\u4e3a\u6211\u4eec\u5728\u4f7f\u7528\u6570\u636e\u65f6\uff0c\u4ece\u6570\u636e\u8868\u4e2d\u67e5\u8be2\u6570\u636e\u3001\u4fee\u6539\u5220\u9664\u8868\u4e2d\u6570\u636e\u3001\u5f80\u8868\u4e2d\u6dfb\u52a0\u6570\u636e\u7b49\u64cd\u4f5c\u3002</p> <p>\u6570\u5b66\u5bb6\u5f88\u65e9\u4ee5\u524d\u5c31\u628a\u5e2e\u6211\u4eec\u628a\u6570\u636e\u4f7f\u7528\u7684\u64cd\u4f5c\u9700\u6c42\u5f52\u7eb3\u597d\u4e86\u3002</p> <p>DML Data Manipulate language\uff0c\u6570\u636e\u64cd\u4f5c\u8bed\u8a00\u3002\u4e0a\u9762\u63d0\u5230\u7684\u90fd\u662f\uff0c\u6bd4\u8f83\u6807\u51c6\u5316\u3002\u5e02\u9762\u4e0a\u7684\u591a\u4e2a\u4e0d\u540c\u7684\u6570\u636e\u5e93\u4ea7\u54c1\u4e0a\u8fd0\u884c DML\uff0c\u8bed\u6cd5\u90fd\u6bd4\u8f83\u63a5\u8fd1\uff0c\u6709\u65f6\u8fd8\u901a\u7528\uff08mssql \u7684\u8bed\u6cd5\u7279\u6b8a\u7b26\u53f7\u6bd4\u8f83\u591a\uff09\u3002</p> <p>DDL Data Define language\uff0c\u6570\u636e\u5b9a\u4e49\u8bed\u8a00\u3002\u4e0a\u9762\u63d0\u5230\u4e86\u6570\u636e\u64cd\u4f5c\u8bed\u8a00\uff0c\u5176\u4e2d \u6570\u636e \u662f\u88ab\u64cd\u4f5c\u7684\u5bf9\u8c61\u3002\u8fd9\u4e9b\u5bf9\u8c61\u7684\u5c5e\u6027\uff08\u8868\u7ed3\u6784\u3001\u5b57\u6bb5\u7684\u6570\u636e\u7c7b\u578b\u3001\u7269\u7406\u7279\u6027\u7b49\uff09\u4f7f\u7528 DDL \u6765\u5b9a\u4e49\u3002\u6240\u4ee5\uff0c\u4f7f\u7528\u6570\u636e\u524d\uff0c\u9700\u8981\u5728\u6570\u636e\u5e93\u4e2d\u4f7f\u7528 DDL \uff0c\u521b\u5efa\u76f8\u5173\u7684\u73af\u5883\uff08\u8868\uff09\uff0c\u7136\u540e\u624d\u53ef\u80fd\u4f7f\u7528 DML\uff08DML \u6240\u64cd\u4f5c\u7684\u8868\u3001\u89c6\u56fe\u548c\u5b57\u6bb5\u90fd\u9700\u8981\u5b9e\u9645\u4e0a\u5df2\u7ecf\u5b58\u5728\u7684\uff09\u3002\u4e0d\u540c\u7684\u6570\u636e\u5e93\u8fd8\u63d0\u4f9b\u4e86\u4e0d\u540c\u7684\u73af\u5883 DDL\uff0c\u5982\u8868\u7a7a\u95f4\u7ef4\u62a4\u7b49\uff0c\u89c6\u5177\u4f53\u7279\u5b9a\u7684\u6570\u636e\u5e93\u800c\u5b9a\u3002</p> <p>\u67d0\u79cd\u5b9a\u4e49\u4e0a\uff0cSQL \u4e0e javascript\u3001python \u7b49\u811a\u672c\u8bed\u8a00\u7684\u6027\u8d28\u662f\u4e00\u81f4\u7684\uff0c\u9700\u8981\u8fd0\u884c\u73af\u5883\u628a\u5b83\u89e3\u91ca\u5e76\u7f16\u8bd1\u6210\u66f4\u4f4e\u5c42\u6b21\u7684\u4ee3\u7801\u6765\u6267\u884c\u903b\u8f91\u3002\u8fd0\u884c SQL \u7684\u73af\u5883\uff08\u6570\u636e\u5e93\uff09\u672c\u8eab\u5c31\u53ef\u4ee5\u770b\u6210\u662f\u4e00\u4e2a\u5e26\u6709\u5927\u91cf\u6570\u636e\u73af\u5883\u53d8\u91cf\u7684\u8d85\u7ea7 runtime\uff0c\u8fd9\u4e9b\u6570\u636e\u73af\u5883\u53d8\u91cf\uff08\u8868\uff09\u7684\u503c\uff08\u8868\u4e2d\u7684\u6570\u636e\uff09\u662f\u4e8b\u5148\u9884\u7f6e\uff08\u4ece\u5176\u5b83\u5730\u65b9\u8fc1\u79fb\u8fc7\u6765\u6216\u8005\u4e0d\u65ad\u79ef\u7d2f\u66f4\u65b0\uff08CRUD\uff09\u6240\u5f62\u6210\u7684\u72b6\u6001\uff09\u3002</p> <p>\u5173\u7cfb\u578b\u6570\u636e\u5e93\uff0c\u6709\u4e00\u79cd\u53eb<code>execute plan</code>\uff08\u6267\u884c\u8ba1\u5212\uff09\u7684\u4e1c\u897f\uff0c\u6709\u4e9b\u6570\u636e\u5e93\u8fd8\u63d0\u4f9b\u4e86<code>select * from ... for explain</code>\u7684\u8bed\u6cd5\uff0c\u6765\u76f4\u63a5\u5f97\u5230\u5b83\u3002</p> <p>\u5b83\u53ef\u4ee5\u628a\u4e00\u4e2a\u5b8c\u6574\u7684 SQL \u5206\u89e3\u591a\u4e2a\u7ea7\u8054\u5d4c\u5957\u7684\u6b65\u9aa4\uff0c\u4f7f\u7528\u4e00\u4e2a\u591a\u4e8e 2 \u4e2a\u8868\u6216\u8005\u89c6\u56fe\u5173\u8054\u7684\u67e5\u8be2\uff0c\u5c31\u53ef\u4ee5\u975e\u5e38\u8f83\u660e\u663e\u7684\u770b\u5230\u6267\u884c\u8ba1\u5212\u4e2d\u7684\u987a\u5e8f\u3002</p> <p>\u6267\u884c\u8ba1\u5212\u5e76\u4e0d\u53ea\u662f\u6570\u636e\u64cd\u4f5c\u8fc7\u7a0b\u7684\u53ef\u89c6\u5316\uff0c\u5b83\u8fd8\u662f\u6570\u636e\u5e93\u5c06 SQL \u7f16\u8bd1\u6210\u4f4e\u5c42\u6b21\u6570\u636e\u8bbf\u95ee\u4ee3\u7801\u7684\u9ad8\u7ea7\u53ef\u89c6\u5316\u89c6\u56fe\u3002\u6545\u800c\uff0c\u8fd9\u4e2a\u6267\u884c\u8ba1\u5212\u662f\u6570\u636e\u5e93\u4e13\u7528\u7684\uff08\u4e0d\u540c\u7684\u6570\u636e\u5e93\uff0c\u6240\u751f\u6210\u7684\u6267\u884c\u8ba1\u5212\u4e0d\u540c\uff0c\u5373\u4f7f\u540c\u4e00\u4e2a SQL\uff0c\u5728\u8868\u6570\u636e\u5927\u5c0f\u4e0d\u540c\u65f6\u6240\u4ea7\u751f\u7684\u6267\u884c\u8ba1\u5212\u90fd\u53ef\u80fd\u4e0d\u4e00\u6837\u3002\u8fd9\u4e0e\u6570\u636e\u5e93\u5185\u90e8\u5f15\u64ce\u7684\u5b9e\u73b0\u6709\u5173\uff09\u3002\u4e5f\u56e0\u6b64\uff0c\u6267\u884c\u8ba1\u5212\u5728 SQL \u8c03\u4f18\u65f6\u975e\u5e38\u6709\u7528\uff0c\u76f8\u5f53\u4e8e\u4e00\u4e2a\u903b\u8f91\u8fc7\u7a0b\u7684\u6b65\u9aa4\u5316\u5206\u89e3\u3002\u901a\u8fc7\u6539\u53d8\u8fd9\u4e2a\u6267\u884c\u8ba1\u5212\uff0c\u6216\u8005\u62c6\u89e3 SQL \u6765\u5f97\u5230\u5176\u4ed6\u60f3\u8981\u7684\u6267\u884c\u8ba1\u5212\uff08\u9700\u8981\u975e\u5e38\u4e30\u5bcc\u7684\u7ecf\u9a8c\u79ef\u7d2f\uff09\u3002\u5982\u679c\u6709\u524d\u7aef\u57fa\u7840\u7684\u540c\u5b66\uff0c\u6d4f\u89c8\u5668\u6709 DOM inspector\uff0c\u6267\u884c\u8ba1\u5212\u5c31\u7c7b\u4f3c\u4e8e SQL \u7684 inspector\uff0c\u7528\u6765\u89c2\u5bdf SQL \u6700\u7ec8\u6267\u884c\u7684\u8fc7\u7a0b\u3002</p> <p>\u5728\u5927\u6570\u636e\u4ea7\u54c1\uff0c\u4e0a\u9762\u6240\u8bf4\u7684\u6267\u884c\u8ba1\u5212\u540c\u6837\u5b58\u5728\uff0cSQL \u88ab\u76f4\u767d\u7684\u7f16\u8bd1\u6210 java \u7a0b\u5e8f\u3002\u53ef\u80fd\u56e0\u4e3a oracle \u7684\u9ad8\u5e02\u5360\u7387\u539f\u56e0\uff0chivesql \u4e0e oracle \u7684 SQL \u5b9e\u73b0\u517c\u5bb9\u6027\u975e\u5e38\u9ad8\uff0c\u5982\u679c\u6709\u57fa\u4e8e oracle \u5b9e\u73b0\u7684 OLAP \u578b\u5206\u6790\u5e94\u7528\uff0c\u5b58\u50a8\u8fc7\u7a0b\u8fc1\u79fb\u6210\u672c\u4f1a\u4f4e\u5f88\u591a\u3002</p> <p><code>select ... from ... [where ...]</code> \u4ece\u67d0\u6570\u636e\u6e90\uff08\u8fd9\u91cc\u6307\u5177\u4f53\u7684\u6570\u636e\u96c6\uff09\u83b7\u53d6\u76ee\u6807\u4fe1\u606f\uff08\u5177\u4f53\u7684\u5c5e\u6027\uff09\uff0c\u5f53\u7136\u4e5f\u53ef\u4ee5\u6dfb\u52a0\u8fc7\u6ee4\u6761\u4ef6</p> <p><code>update ... set ... [where] ...]</code> \u5bf9\u76ee\u6807\u6570\u636e\u8fdb\u884c\u4fee\u6539\u3002\u8fd9\u91cc\u9690\u85cf\u4e86\u4e00\u4e2a\u6982\u5ff5\uff0c\u76ee\u6807\u6570\u636e\u96c6\u3002 \u7ecf\u9a8c\u521d\u6d45\u7684\uff0c\u5173\u6ce8 <code>set \u2026</code>\uff08\u8981\u5982\u4f55\u4fee\u6539\uff09 \u7ecf\u9a8c\u4e30\u5bcc\uff0c\u4e00\u822c\u66f4\u4e60\u60ef\u4e8e\u5148\u5173\u6ce8 <code>update \u2026 [where \u2026]</code> (\u8981\u4fee\u6539\u4ec0\u4e48\uff0c\u4e3a\u4ec0\u4e48\u4fee\u6539) \u66f4\u9ad8\u7ea7\u522b\u7684\u95ee\u9898\u3002</p> <p><code>delete from ... [where ...]</code> \u4e0e update \u7684\u903b\u8f91\u7c7b\u4f3c\u3002</p> <p><code>insert into ... (values(...) | select ... from [where ...])</code> insert into \u6709\u4e24\u4e2a\u91cd\u8981\u7684\u4f46\u975e\u5e38\u4e0d\u540c\u7684\u573a\u666f\u3002</p> <ul> <li>\u5728\u529f\u80fd\u5e94\u7528\u7cfb\u7edf\u4e2d\uff0c\u6700\u5e38\u89c1\u7684\u662f insert into ... values(...)\uff0c\u5b9e\u73b0\u5411\u7cfb\u7edf\u91cc\u6dfb\u52a0\u4e1a\u52a1\u6570\u636e\uff08\u975e\u5e38\u91cd\u8981\u7684\u6570\u636e\u751f\u4ea7\u65b9\u5f0f\uff09\uff1b</li> <li>\u5728\u6570\u636e\u5f00\u53d1\u9886\u57df\uff0c\u901a\u5e38\u6240\u9700\u8981\u7684\u6570\u636e\u5df2\u7ecf\u5b58\u5728\u7cfb\u7edf\u4e2d\u7684\u67d0\u4e2a\u4f4d\u7f6e\uff0c\u8fd9\u65f6\u5f80\u5f80\u4f7f\u7528\u7684\u662f <code>insert into ... select ... from ...[where ...]</code>\u3002</li> </ul> <p><code>merge into</code> insert into \u4e0e update \u7684\u7ed3\u5408\u4f53\u3002\u9664 merge \u5916\uff0c\u8fd8\u6709\u8bf8\u5982 update set [where \u2026] [delete \u2026] \u8fd9\u79cd\u53d8\u79cd\u3002</p> <p>\u5148\u629b\u5f00\u5bb9\u6613\u641e\u6df7\u4e71\u7684\u53d8\u79cd\uff0c\u5b83\u5bf9\u7b80\u5316\u95ee\u9898\u7406\u89e3\u6ca1\u6709\u5e2e\u52a9\u3002\u6211\u4eec\u7684\u76ee\u7684\u662f\u4ece\u4e0a\u9762\u7684\u8bed\u6cd5\u6765\u63d0\u70bc\u5e2e\u52a9\u7406\u89e3\u3001\u4ece\u800c\u5f62\u6210\u5bb9\u6613\u7406\u89e3\u3001\u8bb0\u5fc6\u3001\u4f7f\u7528\u7684\u6a21\u5f0f\uff0c\u8fd9\u624d\u662f\u4e3b\u8981\u77db\u76fe\u3002</p> <p>select\u3001update\u3001delete\u3001insert\uff0c\u53ef\u4ee5\u5206\u4e3a \u6570\u636e\u72b6\u6001\u53d1\u751f\u53d8\u5316\uff08\u4fee\u6539\u3001\u5220\u9664\u3001\u63d2\u5165\uff09\u3001**\u6570\u636e\u72b6\u6001\u4e0d\u4f1a\u53d1\u751f\u53d8\u5316\uff08\u67e5\u8be2\uff09**\u4e24\u5927\u7c7b\u3002</p> <p>\u53ef\u4ee5\u8fdb\u4e00\u6b65\u7684\u62bd\u8c61\u6210\u4e0b\u56fe\u7684\u5f62\u5f0f\u3002</p> <p>\u67e5\u8be2\u662f\u786e\u5b9a\u6570\u636e\u6e90\u3001\u76ee\u6807\u96c6\u7684\u8fc7\u7a0b\uff0c\u589e\u5220\u6539\u4e3a\u5bf9\u76ee\u6807\u96c6\u7684\u4e8c\u6b21\u52a0\u5de5\u3002\u6709\u65f6\u53ef\u80fd\u4f1a\u89c9\u5f97\u4e8c\u6b21\u52a0\u5de5\u65f6\u975e\u5e38\u82b1\u8d39\u7cbe\u529b\uff0c\u5176\u5b9e\u67e5\u8be2\u624d\u662f\u91cd\u70b9\uff0c\u5728\u8fd9\u4e2a\u786e\u5b9a\u6570\u636e\u6e90\u4e0e\u76ee\u6807\u96c6\u7684\u8fc7\u7a0b\u4e2d\uff0c\u5f80\u5f80\u6d89\u53ca\u4e1a\u52a1\u95ee\u9898\u7684\u7406\u89e3\u3001\u5206\u6790\uff0c\u52a0\u5de5\u53ea\u662f\u9644\u5e26\u7684\u64cd\u4f5c\u9700\u6c42\u3002\u672c\u8282\u6240\u8bf4\u7684\u601d\u7ef4\u65b9\u5f0f\uff0c\u4ee5\u53ca\u540e\u6587\u6240\u8981\u8c08\u7684\u5185\u5bb9\uff0c\u90fd\u662f\u56f4\u7ed5\u8fd9\u4e2a\u90e8\u5206\u3002</p> <p>\u719f\u6089\u6570\u636e\u5f00\u53d1\u7684\u4eba\uff0c\u53ef\u80fd\u90fd\u4f1a\u6709\u8fd9\u79cd\u7ecf\u5386\uff0cSQL \u4e0d\u7ba1\u518d\u600e\u4e48\u957f\uff0c\u5b83\u7684\u4ee3\u7801\u91cf\u5176\u5b9e\u975e\u5e38\u5c11\u7684\u3002\u82e5\u4e1a\u52a1\u95ee\u9898\u7684\u7406\u89e3\u4e0d\u51c6\u786e\uff0c\u7f16\u5199\u7684\u67e5\u8be2\u7f3a\u6f0f\u6761\u4ef6\uff0c\u90a3\u4e48\u67e5\u9519\u5e76\u7f16\u5199\u51fa\u6b63\u786e\u7684 SQL \u6240\u82b1\u8d39\u7684\u65f6\u95f4\uff0c\u5f80\u5f80\u6bd4\u7f16\u5199\u51fa\u539f\u6765\u90a3\u4e2a\u4e3a\u4e86\u4efb\u52a1\u800c\u51d1\u6570\u7684 SQL \u6240\u82b1\u65f6\u95f4\u8981\u591a\u5f88\u591a\u3002\u4e00\u4e9b\u6b7b\u8981\u9762\u5b50\u7684\u4eba\u59cb\u7ec8\u4e0d\u80af\u627f\u8ba4\u8fd9\u4e00\u70b9\u3002</p>"},{"location":"basic/5.relation/","title":"\u5173\u7cfb\u6a21\u578b","text":"<p>\u4efb\u4f55\u5b66\u79d1\u7684\u4e13\u4e1a\u4eba\u58eb\u90fd\u9700\u8981\u77e5\u9053\u81ea\u5df1\u6240\u5728\u4e13\u4e1a\u7684\u57fa\u7840\u3002\u6240\u4ee5\uff0c\u5982\u679c\u4f60\u662f\u6570\u636e\u5e93\u9886\u57df\u7684\u4e13\u5bb6\uff0c\u5c31\u9700\u8981\u77e5\u9053\u5173\u7cfb\u6a21\u578b\uff0c\u56e0\u4e3a\u5b83\u662f\u6570\u636e\u5e93\u9886\u57df\u7684\u57fa\u7840\uff08\u81f3\u5c11\u662f\u57fa\u7840\u7684\u4e3b\u4f53\uff09\u3002\u5f53\u4eca\u4e0d\u8bba\u662f\u5546\u4e1a\u5316\u7684\u5e94\u7528\u57f9\u8bad\u8fd8\u662f\u5b66\u672f\u5316\u7684\u7406\u8bba\u8bfe\u7a0b\uff0c\u4efb\u4f55\u8bfe\u7a0b\u90fd\u81f3\u5c11\u63d0\u5230\u5173\u7cfb\u6a21\u578b\u7684\u5185\u5bb9\uff0c\u4f46\u662f\u5927\u591a\u6570\u6559\u5b66\u4ece\u7ed3\u679c\u4e0a\u770b\u90fd\u5f88\u7cdf\u3002</p> <p>\u53ef\u4ee5\u786e\u5b9a\u7684\u662f\uff0c\u6570\u636e\u5e93\u9886\u57df\u4e2d\u7684\u5927\u591a\u6570\u4eba\u5e76\u6ca1\u6709\u5f88\u597d\u5730\u7406\u89e3\u5173\u7cfb\u6a21\u578b\u3002\u9020\u6210\u8fd9\u79cd\u60c5\u5f62\u7684\u53ef\u80fd\u539f\u56e0\u5305\u62ec\uff1a</p> <ul> <li> <p>\u8131\u79bb\u5b9e\u8df5\u7684\u5173\u7cfb\u6a21\u578b\u6559\u5b66\u3002\u5c31\u662f\u8bf4\uff0c\u81f3\u5c11\u5bf9\u4e8e\u521d\u5b66\u8005\uff0c\u7406\u89e3\u5173\u7cfb\u6a21\u578b\u77e5\u8bc6\u7684\u5173\u8054\u6027\u6216\u5173\u7cfb\u6a21\u578b\u6240\u8981\u89e3\u51b3\u7684\u95ee\u9898\u662f\u5f88\u96be\u7684\u3002</p> </li> <li> <p>\u6388\u8bfe\u7684\u6559\u5e08\u672c\u8eab\u5e76\u6ca1\u6709\u5145\u5206\u7406\u89e3\u6216\u610f\u8bc6\u5230\u5173\u7cfb\u6a21\u578b\u77e5\u8bc6\u5185\u5bb9\u7684\u91cd\u8981\u6027\u3002</p> </li> <li> <p>\u5728\u5b9e\u8df5\u4e2d\u66f4\u53ef\u80fd\u5b58\u5728\u7684\u95ee\u9898\uff1a\u5c31\u6839\u672c\u6ca1\u6559\u5173\u7cfb\u6a21\u578b\uff0c\u6388\u8bfe\u4e2d\u53d6\u800c\u4ee3\u4e4b\u7684\u662f SQL \u8bed\u8a00\uff0c\u6216\u8005 SQL \u8bed\u8a00\u7684\u4e00\u4e9b\u65b9\u8a00\uff08\u6bd4\u5982 Oracle \u7684 SQL \u65b9\u8a00\uff09\u3002</p> </li> </ul> <p>SQL \u8bed\u8a00\u3001\u6570\u636e\u5e93\u548c\u5173\u7cfb\u6a21\u578b\u4e09\u8005\u7ecf\u5e38\u88ab\u6df7\u6dc6\u3002\u6570\u636e\u5e93\u7684\u529f\u80fd\u4e3b\u8981\u662f\u5b58\u50a8\u6570\u636e\uff0c\u8fd9\u4e9b\u6570\u636e\u7b26\u5408\u5bf9\u73b0\u5b9e\u4e16\u754c\u4e00\u90e8\u5206\u6240\u5efa\u7acb\u7684\u7279\u5b9a\u6a21\u578b\u3002</p> <p>\u76f8\u5e94\u5730\uff0c\u6570\u636e\u5e93\u5fc5\u987b\u63d0\u4f9b\u53ef\u9760\u7684\u57fa\u7840\u8bbe\u65bd\uff08infrastructure\uff09\uff0c\u65e0\u8bba\u4f55\u65f6\u90fd\u80fd\u591f\u8ba9\u591a\u4e2a\u7528\u6237\u4f7f\u7528\u540c\u4e00\u4e9b\u6570\u636e\uff0c\u4e14\u5728\u6570\u636e\u88ab\u4fee\u6539\u65f6\u4e0d\u7834\u574f\u6570\u636e \u5b8c\u6574\u6027\u3002\u8fd9\u8981\u6c42\u6570\u636e\u5e93\u80fd\u591f\u5904\u7406\u6765\u81ea\u4e0d\u540c\u7528\u6237\u7684 \u201c \u8d44\u6e90\u4e89\u7528\uff08contention \uff09 \u201d \uff0c\u5e76\u80fd\u5728\u4e8b\u52a1\uff08transaction\uff09\u5904\u7406\u8fc7\u7a0b\u4e2d\u9047\u5230\u673a\u5668\u6545\u969c\u7b49\u6781\u7aef\u60c5\u51b5\u4e0b\u4e5f\u4fdd\u6301\u6570\u636e\u4e00\u81f4\u6027\u3002</p> <p>\u7ed3\u6784\u5316\u67e5\u8be2\u8bed\u8a00\uff08Structured Query Language\uff0cSQL\uff09\u65e0\u975e\u662f\u4e00\u79cd\u8bed\u8a00\uff0c\u867d\u7136\u5b83\u4e0e\u6570\u636e\u5e93\u5173\u7cfb\u5bc6\u5207\u3002\u5c06 SQL \u8bed\u8a00\u548c\u5173\u7cfb\u6570\u636e\u5e93\u7b49\u540c\u89c6\u4e4b\uff0c\u6216\u8005\u66f4\u7cdf\u2014\u2014\u4e0e\u5173\u7cfb\u7406\u8bba\u7b49\u540c\u89c6\u4e4b\uff0c\u90fd\u662f\u9519\u8bef\u7684\u3002\u8fd9\u79cd\u9519\u8bef\u5c31\u597d\u6bd4\u5c06\u638c\u63e1\u4e86\u7535\u5b50\u8868\u8f6f\u4ef6\u6216\u6587\u5b57\u5904\u7406\u8f6f\u4ef6\u89c6\u4e3a\u638c\u63e1\u4e86 \u201c \u4fe1\u606f\u6280\u672f \u201d \u3002</p> <p>\u5b9e\u9645\u4e0a \uff0c\u6709\u4e9b\u8f6f\u4ef6\u4ea7\u54c1\u5e76\u975e\u6570\u636e\u5e93\uff0c\u4f46\u5b83\u4eec\u4e5f\u652f\u6301 SQL</p> <p>\u7b80\u800c\u8a00\u4e4b\uff0c\u5173\u7cfb\u7406\u8bba\u652f\u6301\u6211\u4eec\u901a\u8fc7\u4e00\u7ec4\u5173\u7cfb\u8fd0\u7b97\u7b26\u6765\u641c\u5bfb\u6ee1\u8db3\u67d0\u4e9b\u6761\u4ef6\u7684\u6570\u636e\uff0c\u8fd9\u4e9b\u5173\u7cfb\u8fd0\u7b97\u7b26\u51e0\u4e4e\u652f\u6301\u4efb\u4f55\u57fa\u672c\u67e5\u8be2\u3002</p> <p>\u5173\u952e\u5728\u4e8e\uff0c\u5173\u7cfb\u7406\u8bba\u6709\u4e25\u683c\u7684\u6570\u5b66\u57fa\u7840\uff0c\u6211\u4eec\u5b8c\u5168\u53ef\u4ee5\u76f8\u4fe1\u540c\u4e00\u7ed3\u679c\u53ef\u7531\u4e0d\u540c\u7684\u5173\u7cfb\u8868\u8fbe\u5f0f\u6765\u83b7\u5f97\uff0c\u6b63\u5982\u5728\u7b97\u672f\u4e2d 246/369 \u5b8c\u5168\u7b49\u4e8e \u2154 \u4e00\u6837\u3002</p> <p>\u5173\u7cfb\u7406\u8bba\u53ea\u5173\u5fc3\u5982\u4f55\u6839\u636e\u67e5\u8be2\u6761\u4ef6\u53d6\u5f97\u6b63\u786e\u7684\u6570\u636e\u96c6\uff1b\u800c\u5bf9\u6211\u4eec\u8fd9\u4e9b\u5b9e\u8df5\u8005\uff08\u800c\u975e\u7406\u8bba\u5bb6\uff09\u800c\u8a00\uff0c\u5173\u7cfb\u64cd\u4f5c\u9636\u6bb5\u53ea\u8d1f\u8d23\u51c6\u786e\u65e0\u8bef\u5730\u627e\u51fa\u5c5e\u4e8e\u6700\u7ec8\u6570\u636e\u96c6\u7684\u8bb0\u5f55\uff0c\u800c\u4e0d\u540c\u884c\u7684\u76f8\u540c\u5b57\u6bb5\u7684\u5173\u7cfb\u5e76\u4e0d\u662f\u5728\u8fd9\u4e2a\u9636\u6bb5\u5904\u7406\uff0c\u800c\u662f\u5b8c\u5168\u5c5e\u4e8e\u6392\u5e8f\u64cd\u4f5c\u3002</p> <p>\u5173\u7cfb\u7406\u8bba\u5e76\u4e0d\u6d89\u53ca\u5404\u79cd\u7edf\u8ba1\u529f\u80fd\uff08\u4f8b\u5982\u767e\u5206\u4f4d\u6570\u7b49\uff09\uff0c\u800c\u8fd9\u4e9b\u7edf\u8ba1\u529f\u80fd\u7ecf\u5e38\u51fa\u73b0\u5728\u4e0d\u540c\u7684 \u201c SQL \u65b9\u8a00\uff08dialect \uff09 \u201d \u5f53\u4e2d\u3002\u5173\u7cfb\u7406\u8bba\u6240\u7814\u7a76\u7684\u662f\u96c6\u5408\uff08set\uff09\uff0c\u4f46\u5e76\u4e0d\u6d89\u53ca\u5982\u4f55\u4e3a\u8fd9\u4e9b\u96c6\u5408\u6392\u5e8f\u3002\u5c3d\u7ba1\u6709\u8bb8\u591a\u5173\u4e8e\u6392\u5e8f\u7684\u6570\u5b66\u7406\u8bba\uff0c\u4f46\u5b83\u4eec\u90fd\u4e0e\u5173\u7cfb\u7406\u8bba\u65e0\u5173\u3002</p> <p>\u5f53 SQL \u5f15\u64ce\u5904\u7406\u67e5\u8be2\u65f6\uff0c\u4f1a\u7528\u4f18\u5316\u5668\u627e\u51fa\u6267\u884c\u67e5\u8be2\u6700\u9ad8\u6548\u7684\u65b9\u5f0f\u3002\u6b64\u65f6\u5173\u7cfb\u7406\u8bba\u53c8\u53ef\u4ee5\u5927\u6709\u4f5c\u4e3a\u4e86\uff0c\u4f18\u5316\u5668\u501f\u52a9\u5173\u7cfb\u7406\u8bba\uff0c\u5bf9\u5f00\u53d1\u8005\u63d0\u4f9b\u7684\u8bed\u4e49\u65e0\u8bef\u7684\u539f\u59cb\u67e5\u8be2\u8fdb\u884c\u6709\u6548\u7684\u7b49\u4ef7\u53d8\u6362\uff0c\u5373\u4f7f\u539f\u59cb\u67e5\u8be2\u7f16\u5199\u5f97\u76f8\u5f53\u7b28\u62d9\u3002</p>"},{"location":"basic/5.relation/#_2","title":"\u539f\u7406\u800c\u975e\u4ea7\u54c1","text":"<p>\"\u4e3a\u4ec0\u4e48\u4f60\u4f5c\u4e3a\u6570\u636e\u5e93\u9886\u57df\u4e13\u4e1a\u4eba\u5458\u9700\u8981\u61c2\u5f97\u5173\u7cfb\u6a21\u578b\" \u8fd9\u4e2a\u95ee\u9898\u662f\u503c\u5f97\u82b1\u65f6\u95f4\u53bb\u641e\u6e05\u695a\u7684\u3002\u539f\u56e0\u662f\uff1a\u5173\u7cfb\u6a21\u578b\u4e0d\u662f\u7279\u5b9a\u7684\u4ea7\u54c1\uff1b\u76f8\u53cd\uff0c\u5b83\u5173\u6ce8\u4e8e\u539f\u7406\u3002</p> <p>\u8fd9\u91cc\u7684\u539f\u7406\u6307\u7684\u662f\u4ec0\u4e48\uff1f\u8fd9\u91cc\u6709\u4e00\u4e2a\u5b9a\u4e49\uff08\u6765\u6e90\u4e8e\u300aChambers Twentieth Century Dictionary\u300b\uff09\u3002</p> <p>\"\u539f\u7406\uff1a\u57fa\u7840\u7684\u3001\u81ea\u7136\u672c\u8d28\u7684\u3001\u7406\u8bba\u57fa\u7840\u7684\u6e90\u5934\uff0c\u6839\u672c\uff0c\u672c\u6e90\uff1a\u5176\u4ed6\u8bfe\u9898\u5f97\u4ee5\u5efa\u7acb\u6216\u53d1\u5c55\u7684\u57fa\u7840\u4e8b\u5b9e\u3002\"</p> <p>\u5173\u4e8e\u539f\u7406\u7684\u5173\u952e\u5728\u4e8e\uff1a\u539f\u7406\u5177\u6709\u666e\u9002\u6027\u3001\u7a33\u5b9a\u6027\u3002\u76f8\u53cd\uff0c\u4ea7\u54c1\u548c\u6280\u672f\uff08\u4ee5\u53ca SQL \u8bed\u8a00\uff09\u603b\u662f\u5728\u6539\u53d8\u2014\u2014\u800c\u539f\u7406\u4e0d\u53d8\u3002\u4e3e\u4f8b\u6765\u8bf4\uff0c\u5047\u8bbe\u4f60\u61c2 Oracle\uff1b\u4e8b\u5b9e\u4e0a\uff0c\u53ef\u4ee5\u5047\u8bbe\u4f60\u662f Oracle \u4e13\u5bb6\u3002\u800c\u5982\u679c\u4f60\u4ec5\u4ec5\u61c2\u5f97 Oracle\uff0c\u90a3\u4e48\u4f60\u7684\u77e5\u8bc6\u5c31\u4e0d\u4e00\u5b9a\u662f\u53ef\u79fb\u690d\u7684\uff0c\u6bd4\u5982 DB2 \u6216 SQL Server \u73af\u5883\uff08\u751a\u81f3\u6709\u53ef\u80fd\u4f1a\u963b\u788d\u4f60\u5728\u65b0\u73af\u5883\u4e2d\u7684\u8fdb\u6b65\uff09\u3002\u4f46\u662f\u5982\u679c\u4f60\u61c2\u5f97\u5e95\u5c42\u539f\u7406\uff08\u4e5f\u5c31\u662f\u8bf4\uff0c\u5982\u679c\u4f60\u61c2\u5f97\u5173\u7cfb\u6a21\u578b\uff09\uff0c\u90a3\u4e48\u4f60\u5c31\u638c\u63e1\u4e86\u53ef\u79fb\u690d\u7684\u77e5\u8bc6\u548c\u6280\u5de7\uff1a\u8fd9\u4e9b\u77e5\u8bc6\u548c\u6280\u5de7\u53ef\u4ee5\u5e94\u7528\u4e8e\u4efb\u4f55\u73af\u5883\uff0c\u6c38\u4e0d\u8fc7\u65f6\u3002</p> <p>\u70ed\u8877\u4e8e\u5b9e\u8df5\u800c\u4e0d\u8981\u7406\u8bba\u7684\u4eba\u597d\u50cf\u4e00\u4e2a\u6c34\u624b\u767b\u4e0a\u4e86\u4e00\u53ea\u6ca1\u6709\u8235\u548c\u7f57\u76d8\u7684\u8239\uff0c\u4ed6\u62ff\u4e0d\u51c6\u8be5\u5f80\u54ea\u91cc\u822a\u884c\u3002\u5b9e\u8df5\u5e94\u8be5</p> <p>\u59cb\u7ec8\u4ee5\u597d\u7684\u7406\u8bba\u4e3a\u57fa\u7840\u3002</p> <p>\u4ec0\u4e48\u662f\u6570\u636e\u5e93\uff1f\u6570\u636e\u5e93\uff08database\uff09\u53ef\u4ee5\u7b80\u5355\u7684\u8ba4\u4e3a\u662f\u4e00\u4e2a\u6570\u636e\u96c6\u5408\uff0c\u8fd9\u4e9b\u6570\u636e\u4e92\u76f8\u5173\u8054\uff0c\u6620\u5c04\u4e86\u771f\u5b9e\u4e16\u754c\u7684\u4e00\u4e9b\u6570\u636e\u6a21\u578b\uff0c\u4f8b\u5982\u4e00\u4e2a\u73ed\u7ea7\uff08class\uff09\u91cc\u7684\u5b66\u751f\uff08student\uff09\uff0c\u5b66\u751f\u4f1a\u9009\u8bfe\uff08student-lesson\uff09\uff0c\u8001\u5e08\u4f1a\u4e0a\u8bfe\uff08teacher-lesson\uff09\uff0c\u5b66\u751f\u4f1a\u6709\u8003\u8bd5\u6210\u7ee9\uff08student-grade\uff09\uff0c\u5b83\u4eec\u76f8\u4e92\u5173\u8054\u76f8\u4e92\u5f71\u54cd\u3002</p> <p>\u5728\u6570\u636e\u5e93\u7684\u4e0a\u5c42\uff0c\u6709\u63d0\u4f9b\u7ed9\u7528\u6237\u67e5\u8be2\u6570\u636e\u7684\u8bed\u8a00\uff0c\u6700\u5e38\u89c1\u7684\u5373 SQL\uff08Structured Query Language\uff09\uff0c\u8fd9\u95e8\u8bfe\u7a0b\u4e3b\u8981\u4e13\u6ce8\u4e8e\u5982\u4f55\u5b9e\u73b0\u4e00\u4e2a\u529f\u80fd\u5b8c\u5907\u7684\u6570\u636e\u5e93\u7cfb\u7edf\u3002</p> <p>1970 \u5e74\u4ee3\uff0c\u6570\u636e\u5b58\u50a8\u5e76\u6ca1\u6709\u7edf\u4e00\u7684\u6982\u5ff5\u548c\u5b9e\u73b0\uff0c\u6bcf\u4e2a\u5e94\u7528\u90fd\u9700\u8981\u81ea\u5df1\u53bb\u5b9e\u73b0\u4e00\u5957\u6570\u636e\u5b58\u50a8\u7684\u65b9\u6848\uff0c\u8fd9\u975e\u5e38\u4e0d\u5229\u4e8e\u5e94\u7528\u548c\u7a0b\u5e8f\u7684\u79fb\u690d\u3002\u4e8e\u662f Ted Codd \u5728 1970 \u5e74\u63d0\u51fa\u4e86\u5173\u7cfb\u6a21\u578b\uff08relational model\uff09\u7684\u6982\u5ff5\uff0c\u4e3b\u8981\u6709\u4ee5\u4e0b\u4e09\u4e2a\u5173\u952e\u70b9\uff1a</p> <ul> <li> <p>\u6570\u636e\u5b58\u50a8\u5728\u7b80\u5355\u7684\u6570\u636e\u7ed3\u6784\u4e2d</p> </li> <li> <p>\u80fd\u591f\u901a\u8fc7\u9ad8\u7ea7\u8bed\u8a00\u8bbf\u95ee\u6570\u636e\u5e93</p> </li> <li> <p>\u7269\u7406\u5b58\u50a8\u7684\u7ec6\u8282\u4ea4\u7ed9\u6570\u636e\u5e93\u7ba1\u7406\u7cfb\u7edf\u5b9e\u73b0</p> </li> </ul> <p>\u6570\u636e\u6a21\u578b\uff08data model\uff09\u6307\u7684\u662f\u63cf\u8ff0\u6570\u636e\u5e93\u4e2d\u6570\u636e\u7684\u6982\u5ff5\u96c6\u5408\uff0c\u5e38\u89c1\u7684\u6570\u636e\u6a21\u578b\u6709\u4ee5\u4e0b\u51e0\u79cd\uff1a</p> <ul> <li>Relational: \u5927\u591a\u6570 DBMS \u4e3a\u5173\u7cfb\u578b\u6570\u636e\u5e93</li> <li>Key/Value, Graph, Document, Column-family : NoSQL \u6570\u636e\u5e93\uff08\u5217\u7c07\u6570\u636e\u5e93\u5982 RocksDB\uff09</li> <li>Array/Matrix: Machine Learning \u4f1a\u4f7f\u7528</li> <li>Hierarchical: \u5c42\u6b21\u6a21\u578b\uff08\u4e0d\u7528\u4e86\uff09</li> <li>Network: \u7f51\u72b6\u6a21\u578b\uff08\u4e0d\u7528\u4e86\uff09</li> </ul> <p>\u5176\u4e2d relational \u662f\u6700\u5e38\u89c1\u3001\u5e94\u7528\u6700\u5e7f\u6cdb\u7684\u5173\u7cfb\u6a21\u578b\uff0c\u5927\u591a\u6570\u5e38\u89c1\u7684\u6570\u636e\u5e93\u7cfb\u7edf\u4f8b\u5982 MySQL\u3001PostgreSQL\u3001Oracle \u90fd\u662f\u5173\u7cfb\u6a21\u578b\uff1bK/V\u3001Graph\u3001Document\u3001Column Family \u5c5e\u4e8e NoSQL \u7c7b\u578b\uff0c\u4f8b\u5982 rocksdb\u3001neo4j\u3001MongoDB\u3001Redis\uff1bArray/Matrix \u5e38\u7528\u4e8e\u673a\u5668\u5b66\u4e60\u9886\u57df\uff0c\u4f8b\u5982 TileDB\uff1bHierarchical \u548c Network \u5206\u522b\u4ee3\u8868\u5c42\u6b21\u548c\u7f51\u72b6\u6a21\u578b\uff0c\u662f\u5f88\u53e4\u8001\u7684\u6570\u636e\u6a21\u578b\u4e86\uff0c\u76ee\u524d\u5df2\u7ecf\u8fc7\u65f6\u3002</p>"},{"location":"basic/5.relation/#_3","title":"\u5173\u7cfb\u6a21\u578b\u57fa\u672c\u903b\u8f91\u6982\u5ff5","text":"\u5b9e\u4f53 <p>\u5b9e\u4f53\u662f\u73b0\u5b9e\u4e16\u754c\u4e2d\u53ef\u4ee5\u533a\u5206\u4e8e\u5176\u4ed6\u5bf9\u8c61\u7684\u4e00\u4e2a\u4e8b\u7269\u6216\u5bf9\u8c61\uff0c\u6bcf\u4e2a\u5b9e\u4f53\u6709\u4e00\u7ec4\u6027\u8d28\uff0c\u5176\u4e2d\u4e00\u4e9b\u6027\u8d28\u7684\u503c\u53ef\u4ee5\u552f\u4e00\u6807\u8bc6\u4e00\u4e2a\u5b9e\u4f53\u3002 \u5b9e\u4f53\u662f\u9996\u8981\u7684\u6570\u636e\u5bf9\u8c61\uff0c\u5e38\u7528\u4e8e\u8868\u793a\u4e00\u4e2a\u4eba\u3001\u5730\u65b9\u3001\u67d0\u6837\u4e8b\u7269\u6216\u67d0\u4e2a\u4e8b\u4ef6\u3002\u4e00\u4e2a\u7279\u5b9a\u7684\u5b9e\u4f53\u88ab\u79f0\u4e3a\u5b9e\u4f53\u5b9e\u4f8b\uff08entity instance \u6216 entity occurrence\uff09\u3002 \u4f8b\u5982\u6bcf\u4e2a\u4eba\u5c31\u662f\u4e00\u4e2a\u5b9e\u4f53\uff0c\u4eba\u6709\u59d3\u540d\uff0c\u6027\u522b\uff0c\u5e74\u9f84\uff0c\u8eab\u4efd\u8bc1\u7b49\u5c5e\u6027\u3002\u8eab\u4efd\u8bc1\u53f7\u5c31\u53ef\u4ee5\u552f\u4e00\u6807\u8bc6\u4e00\u4e2a\u4eba\u3002\u53ef\u4ee5\u7b80\u5355\u628a\u4e00\u4e2a\u5b9e\u4f53\u7b49\u4ef7\u8ba4\u4e3a\u4e00\u884c\u6570\u636e\u3002 </p> <pre><code> - \u5b9e\u4f53\u5c5e\u6027\uff1a\u5b9e\u4f53\u901a\u8fc7\u4e00\u7ec4\u5c5e\u6027\u6765\u8868\u793a\uff0c\u5c5e\u6027\u662f\u5b9e\u4f53\u96c6\u4e2d\u7684\u6bcf\u4e2a\u5b9e\u4f53\u90fd\u62e5\u6709\u63cf\u8ff0\u6027\u4fe1\u606f\uff0c\u6bd4\u5982\u6bcf\u4e2astudent\u5b9e\u4f53\u90fd\u6709 student_id\uff0csex\uff0cname\uff0cage\u7b49\u5c5e\u6027\u3002&lt;br&gt;\n - \u7b80\u5355\u5c5e\u6027\uff1a\u4e0d\u53ef\u4ee5\u8fdb\u4e00\u6b65\u62c6\u5206\u7684\u5c5e\u6027\uff0c\u4f8b\u5982\uff1astudent\u5b9e\u4f53\u7684sex\u5c5e\u6027\u53ea\u80fd\u662fmale\u6216female\u3002&lt;br&gt;\n - \u590d\u5408\u5c5e\u6027\uff1a\u53ef\u4ee5\u8fdb\u4e00\u6b65\u62c6\u5206\u7684\u5c5e\u6027\uff0c\u4f8b\u5982\uff1astudent\u5b9e\u4f53\u7684name\u5c5e\u6027\u53ef\u4ee5\u8fdb\u4e00\u6b65\u62c6\u5206\u4e3a\uff1afirst_name\u548clast_name\u4e24\u4e2a\u5b50\u5c5e\u6027\u3002&lt;br&gt;\n - \u5355\u503c\u5c5e\u6027\uff1a\u6bcf\u4e2a\u7279\u5b9a\u5b9e\u4f53\u4e2d\u7684\u67d0\u4e2a\u5c5e\u6027\u53ea\u6709\u4e00\u4e2a\u503c\u3002\u5373student\u8868\u4e2d\u4efb\u4f55\u4e00\u4e2a\u884c\u7684sex\u5217\u90fd\u53ea\u80fd\u662f\u4e00\u4e2a\u503c\uff0cmale\u548cfemale\u3002&lt;br&gt;\n - \u591a\u503c\u5c5e\u6027\uff1a\u6bcf\u4e2a\u7279\u5b9a\u5b9e\u4f53\u4e2d\u7684\u67d0\u4e2a\u5c5e\u6027\u53ef\u80fd\u6709\u591a\u4e2a\u503c\u3002\u5373student\u8868\u4e2d\u4efb\u4f55\u4e00\u4e2a\u884c\u7684phone_number\u5217\u53ef\u80fd\u6709\u591a\u4e2a\u503c\uff0c\u4e00\u4e2a\u5b66\u751f\u6709\u591a\u4e2a\u7535\u8bdd\u53f7\u7801\u3002&lt;br&gt;\n - \u6d3e\u751f\u5c5e\u6027\uff1a\u8fd9\u7c7b\u5c5e\u6027\u7684\u503c\u53ef\u4ee5\u4ece\u522b\u7684\u76f8\u5173\u5c5e\u6027\u6216\u5b9e\u4f53\u6d3e\u751f\u51fa\u6765\uff08\u4e5f\u5c31\u662f\u53ef\u901a\u8fc7\u522b\u7684\u5c5e\u6027\u8ba1\u7b97\u51fa\u6765\uff09\u3002\u5373\u5e74\u9f84\u662f\u901a\u8fc7\u5f53\u524d\u65f6\u95f4\u548c\u51fa\u751f\u65e5\u671f\u8ba1\u7b97\u51fa\u6765\u7684\u3002&lt;br&gt;\n</code></pre> \u5b9e\u4f53\u96c6 <p>\u5b9e\u4f53\u96c6\uff1a\u662f\u76f8\u540c\u7c7b\u578b\u5373\u5177\u6709\u76f8\u540c\u5c5e\u6027\u7684\u5b9e\u4f53\u96c6\u5408\uff0c\u4f8b\u5982\uff1a\u5b9e\u4f53\u96c6 student \u53ef\u4ee5\u7528\u6765\u6807\u8bc6\u5927\u5b66\u4e2d\u6240\u6709\u5b66\u751f\u7684\u96c6\u5408\u3002\u53ef\u4ee5\u7b80\u5355\u7684\u628a\u5b9e\u4f53\u96c6\u7b49\u4ef7\u8ba4\u4e3a\u662f\u4e00\u5f20\u8868\u3002 \u5728\u6570\u636e\u5e93\u5efa\u6a21\u8fc7\u7a0b\u4e2d\uff0c</p> \u8054\u7cfb <p>\u8054\u7cfb\uff1a\u5b9e\u4f53\u4e0e\u5b9e\u4f53\u4e4b\u95f4\u76f8\u4e92\u5173\u8054\uff0c\u5b58\u5728\u5173\u8054\u5173\u7cfb\uff0c\u4f8b\u5982\uff1astudent \u5b9e\u4f53\u4e0e insructor \u5b9e\u4f53\u4e4b\u95f4\u5b58\u5728\u5173\u7cfb\uff0c\u8868\u793a\u6559\u5e08\u662f\u5b66\u751f\u7684\u5bfc\u5e08\u3002\u5173\u7cfb\u8868\u793a\u4e00\u4e2a\u6216\u591a\u4e2a\u5b9e\u4f53\u4e4b\u95f4\u7684\u8054\u7cfb\u3002\u5173\u7cfb\u4f9d\u8d56\u4e8e\u5b9e\u4f53\uff0c\u4e00\u822c\u6ca1\u6709\u7269\u7406\u6982\u5ff5\u4e0a\u7684\u5b58\u5728\u3002\u5173\u7cfb\u6700\u5e38\u7528\u6765\u8868\u793a\u5b9e\u4f53\u4e4b\u95f4\uff0c\u4e00\u5bf9\u4e00\uff0c\u4e00\u5bf9\u591a\uff0c\u591a\u5bf9\u591a\u7684\u5bf9\u5e94\u3002\u5173\u7cfb\u7684\u6784\u56fe\u662f\u4e00\u4e2a\u83f1\u5f62\uff0c\u5173\u7cfb\u7684\u540d\u79f0\u4e00\u822c\u4e3a\u52a8\u8bcd</p> \u8054\u7cfb\u96c6 <p>\u8054\u7cfb\u96c6\uff1a\u76f8\u540c\u7c7b\u578b\u8054\u7cfb\u7684\u96c6\u5408\uff0c\u4f8b\u5982\uff1astudent \u4e0e insructor \u8fd9\u4e24\u4e2a\u5b9e\u4f53\u96c6\u4e2d\u7684\u591a\u4e2a\u6559\u5e08\u4e0e\u591a\u4e2a\u5b66\u751f\u4e4b\u95f4\u5b58\u5728\u5bfc\u5e08-\u5b66\u751f\u5173\u7cfb\uff08advisor\uff09\u3002\u6bcf\u4e2a\u5b9e\u4f53\u96c6\u53ef\u4ee5\u53c2\u4e0e\u591a\u4e2a\u8054\u7cfb\u96c6\u3002</p> <pre><code> - \u8054\u7cfb\u96c6\u7684\u5ea6\uff1a\u53c2\u4e0e\u8054\u7cfb\u96c6\u7684\u5b9e\u4f53\u96c6\u7684\u6570\u91cf\u79f0\u4e3a\u5ea6\uff0c\u6211\u4eec\u5e38\u89c1\u7684\u662f\u4e8c\u5143\u8054\u7cfb\u96c6\uff0c\u662f\u6d89\u53ca\u4e24\u4e2a\u5b9e\u4f53\u7684\u8054\u7cfb\u96c6\u3002\u5ea6\u4e3a3\u3002&lt;br&gt;\n - \u53c2\u4e0e\uff1a\u5982\u679c\u5b9e\u4f53\u96c6\u4e2d\u7684\u6bcf\u4e2a\u5b9e\u4f53\u90fd\u53c2\u4e0e\u5230\u8054\u7cfb\u96c6\u4e2d\uff0c\u5219\u79f0\u4e3a\u5b8c\u5168\u53c2\u4e0e\uff0c\u5982\u679c\u53ea\u6709\u90e8\u5206\u5b9e\u4f53\u53c2\u4e0e\u5230\u8054\u7cfb\u4e2d\uff0c\u79f0\u4e3a\u90e8\u5206\u53c2\u4e0e\u3002&lt;br&gt;\n</code></pre> \u6620\u5c04\u57fa\u6570 <p>\u6620\u5c04\u57fa\u6570\uff08\u57fa\u6570\u6bd4\u7387\uff09\uff1a\u8868\u793a\u4e00\u4e2a\u5b9e\u4f53\u901a\u8fc7\u8054\u7cfb\u96c6\u53ef\u80fd\u5173\u8054\u7684\u5b9e\u4f53\u4e2a\u6570\u3002</p> <pre><code> - \u4e00\u5bf9\u4e00\uff1aA\u5b9e\u4f53\u96c6\u4e2d\u7684\u4e00\u4e2a\u5b9e\u4f53\u6700\u591a\u4e0eB\u5b9e\u4f53\u96c6\u4e2d\u4e00\u4e2a\u5b9e\u4f53\u5173\u8054\uff0cB\u5b9e\u4f53\u96c6\u4e2d\u7684\u4e00\u4e2a\u5b9e\u4f53\u6700\u591a\u4e0eA\u5b9e\u4f53\u96c6\u4e2d\u4e00\u4e2a\u5b9e\u4f53\u5173\u8054\u3002**\u6bcf\u4e2a\u5b66\u751f\u53ea\u80fd\u6709\u4e00\u4e2a\u8001\u5e08\uff0c\u6bcf\u4e2a\u8001\u5e08\u53ea\u80fd\u6709\u4e00\u4e2a\u5b66\u751f\u3002**&lt;br&gt;\n - \u4e00\u5bf9\u591a\uff1aA\u5b9e\u4f53\u96c6\u4e2d\u7684\u4e00\u4e2a\u5b9e\u4f53\u53ef\u80fd\u4e0eB\u5b9e\u4f53\u96c6\u4e2d\u4efb\u610f\u4e2a\u5b9e\u4f53\u5173\u8054\uff0cB\u5b9e\u4f53\u96c6\u4e2d\u7684\u4e00\u4e2a\u5b9e\u4f53\u6700\u591a\u4e0eA\u5b9e\u4f53\u96c6\u4e2d\u4e00\u4e2a\u5b9e\u4f53\u5173\u8054\u3002**\u6bcf\u4e2a\u5b66\u751f\u53ef\u4ee5\u6709\u4efb\u610f\u4e2a\u8001\u5e08\uff0c\u6bcf\u4e2a\u8001\u5e08\u53ea\u80fd\u6709\u4e00\u4e2a\u5b66\u751f\u3002**&lt;br&gt;\n - \u591a\u5bf9\u4e00\uff1a**\u591a\u4e2a\u5b66\u751f\u5bf9\u5e94\u4e00\u4e2a\u8001\u5e08\u3002**&lt;br&gt;\n - \u591a\u5bf9\u591a\uff1a**\u591a\u4e2a\u5b66\u751f\u5bf9\u5e94\u591a\u4e2a\u8001\u5e08\u3002**&lt;br&gt;\n</code></pre> <p>???+ \u8868 - \u5728\u5173\u7cfb\u6570\u636e\u5e93\u4e2d\uff0c\u8868\u4e5f\u88ab\u53eb\u505a\u5173\u7cfb\uff0c\u5b83\u662f\u4e00\u79cd\u884c\u5217\u5f62\u5f0f\u7684\u4e8c\u7ef4\u8868\u3002\u5176\u5b9e\u5c31\u662f\u4e00\u7cfb\u5217\u4e8c\u7ef4\u6570\u7ec4\u7684\u96c6\u5408\uff0c\u7528\u4e8e\u5b58\u50a8\u5404\u79cd\u4fe1\u606f\u3002 - \u5173\u7cfb\u6a21\u578b\u4e2d\u7528 \u5143\u7ec4 \u6307\u4ee3 \u884c \uff0c\u7528 \u5c5e\u6027 \u6307\u4ee3 \u5217\u3002</p> <ul> <li>\u7528 \u5173\u7cfb\u5b9e\u4f8b \u6307\u4ee3\u4e00\u4e2a\u5173\u7cfb\u4e2d\u7684\u7279\u5b9a\u5b9e\u4f8b\uff0c\u4e5f\u5c31\u662f\u4e00\u884c\u6570\u636e\u3002 - \u5bf9\u4e8e\u5173\u7cfb\u4e2d\u7684\u6bcf\u4e2a\u5c5e\u6027\u7684\u53d6\u503c\u8303\u56f4\uff0c\u79f0\u4e3a\u8be5\u5c5e\u6027\u7684\u57df\uff0c\u5bf9\u4e8e\u57df\u4e2d\u7684\u5143\u7d20\uff0c\u5982\u679c\u662f\u4e0d\u53ef\u518d\u5206\u7684\u5355\u5143\uff0c\u5219\u79f0\u4e3a\u4e3a\u8fd9\u4e2a\u57df\u662f**\u539f\u5b50\u6027**\u7684\u3002</li> </ul>"},{"location":"basic/5.relation/#_4","title":"\u5173\u7cfb\u6a21\u578b\u57fa\u7840","text":"<p>\u5173\u7cfb\u6a21\u578b\u662f\u903b\u8f91\u6a21\u578b\u4e2d\u7684\u4e00\u79cd\uff0c\u4e5f\u662f\u73b0\u5728\u666e\u904d\u4f7f\u7528\u7684\u4e00\u79cd\u3002\u5176\u7531\u5b9e\u4f53\u3001\u5c5e\u6027\u548c\u5173\u7cfb\u4e09\u8005\u6784\u6210\u3002\u5176\u53ef\u4ee5\u4f7f\u7528\u4e00\u5f20\u4e8c\u7ef4\u8868\u8fdb\u884c\u5173\u7cfb\u5448\u73b0\u3002</p> <p>\u5173\u7cfb\u6a21\u578b\uff08Relational model\uff09\u7531 E.F.Codd \u535a\u58eb\u4e8e 1970 \u5e74\u63d0\u51fa\uff0c\u4ee5\u96c6\u5408\u8bba\u4e2d\u7684\u5173\u7cfb\u6982\u5ff5\u4e3a\u57fa\u7840\uff1b\u65e0\u8bba\u662f\u73b0\u5b9e\u4e16\u754c\u4e2d\u7684\u5b9e\u4f53\u5bf9\u8c61\u8fd8\u662f\u5b83\u4eec\u4e4b\u95f4\u7684\u8054\u7cfb\u90fd\u4f7f\u7528\u5173\u7cfb\u8868\u793a\u3002</p> <p>\u6211\u4eec\u5728\u6570\u636e\u5e93\u7cfb\u7edf\u4e2d\u770b\u5230\u7684\u5173\u7cfb\u5c31\u662f\u4e8c\u7ef4\u8868\uff08Table\uff09\uff0c\u7531\u884c\uff08Row\uff09\u548c\u5217\uff08Column\uff09\u7ec4\u6210\u3002\u56e0\u6b64\uff0c\u4e5f\u53ef\u4ee5\u8bf4\u5173\u7cfb\u8868\u662f\u7531\u884c\u6784\u6210\u7684\u96c6\u5408\u3002</p> <p>\u5173\u7cfb\u6a21\u578b\u7531 \u6570\u636e\u7ed3\u6784\u3001\u6570\u636e\u64cd\u4f5c\u548c\u5b8c\u6574\u6027\u7ea6\u675f \u4e09\u90e8\u5206\u6784\u6210:</p> <ul> <li>\u6784\u9020\u673a\u5236\uff08\u6570\u636e\u7ed3\u6784\uff09\uff1a\u5176\u4e2d\u6570\u636e\u7ed3\u6784\u662f\u6307\u6570\u636e\u81ea\u8eab\u7684\u7ec4\u7ec7\u5f62\u5f0f\uff0c\u5173\u7cfb\u6a21\u578b\u4e2d\u7684\u6570\u636e\u7ed3\u6784\u5c31\u662f\u5173\u7cfb\u8868\uff0c\u5305\u62ec\u57fa\u7840\u8868\u3001\u6d3e\u751f\u8868\uff08\u67e5\u8be2\u7ed3\u679c\uff09\u548c\u865a\u62df\u8868\uff08\u89c6\u56fe\uff09\uff1b</li> <li>\u64cd\u4f5c\u673a\u5236\uff08\u6570\u636e\u64cd\u4f5c\uff09\uff1a\u6570\u636e\u64cd\u4f5c\u662f\u6307\u5bf9\u6570\u636e\u8fdb\u884c\u7684**\u589e\u5220\u6539\u67e5**\u7684\u5404\u79cd\u8bbf\u95ee\u64cd\u4f5c\uff0c\u800c\u5bf9\u6570\u636e\u7684\u67e5\u8be2\u662f\u8be5\u6a21\u578b\u4e2d\u6700\u4e3a\u91cd\u8981\u7684\u64cd\u4f5c\uff1b</li> <li>\u7ea6\u675f\u673a\u5236\uff08\u6570\u636e\u7ea6\u675f\uff09\uff1a\u5b8c\u6574\u6027\u7ea6\u675f\u7528\u4e8e\u7ef4\u62a4\u6570\u636e\u7684\u5b8c\u6574\u6027\u6216\u8005\u6ee1\u8db3\u4e1a\u52a1\u7ea6\u675f\u7684\u9700\u6c42\u3002</li> </ul> <p>\u4f5c\u4e3a\u6570\u636e\u5e93\u7684\u4e00\u79cd\u6570\u636e\u6a21\u578b\uff0c\u5173\u7cfb\u6a21\u578b\u63d0\u4f9b\u4e86\u4e00\u7ec4\u5b8c\u6574\u6027\u89c4\u5219\u6216\u9650\u5236\u3002\u5b8c\u6574\u6027\u7ea6\u675f\u7528\u4e8e\u786e\u5b9a\u5173\u7cfb\u6570\u636e\u5e93\u91cc\u6570\u636e\u7684\u51c6\u786e\u6027\u548c\u4e00\u81f4\u6027\u3002</p> <p>\u5728\u5173\u7cfb\u578b\u6570\u636e\u5e93\u91cc\uff0c\u5b8c\u6574\u6027\u7ea6\u675f\u5305\u62ec\u57df\u5b8c\u6574\u6027\u3001\u5b9e\u4f53\u5b8c\u6574\u6027\u3001\u5f15\u7528\u5b8c\u6574\u6027\u4ee5\u53ca\u7528\u6237\u5b9a\u4e49\u5b8c\u6574\u6027\u3002</p> <ul> <li> <p>\u5173\u7cfb\u6c38\u8fdc\u4e5f\u4e0d\u4f1a\u5305\u542b\u91cd\u590d\u7684\u5143\u7ec4\u3002\u8fd9\u4e00\u6027\u8d28\u662f\u6210\u7acb\u7684\uff0c\u56e0\u4e3a\u4e3b\u4f53\u7684\u5b9a\u4e49\u662f\u5143\u7ec4\u7684\u96c6\u5408\uff0c\u800c\u6570\u5b66\u4e0a\u7684\u96c6\u5408\u4e0d\u5305\u542b\u91cd\u590d\u5143\u7d20\u3002\u7136\u800c <code>SQL</code> \u4e0d\u662f\u8fd9\u6837\u7684\uff0c\u4e00\u822c\u60c5\u51b5\u4e0b SQL \u8868\u5141\u8bb8\u5305\u542b\u91cd\u590d\u884c\uff08SQL \u5141\u8bb8\u65e0\u4e3b\u952e\uff09\u3002</p> </li> <li> <p>\u5173\u7cfb\u4e2d\u7684\u5143\u7ec4\u5176\u5b9e\u662f\u6ca1\u6709\u987a\u5e8f\u7684\uff08\u8fd9\u4e2a\u5728\u6570\u5b66\u7684\u96c6\u5408\u8bba\u4e2d\u4e5f\u662f\u6210\u7acb\u7684\uff0c{a,b,c}\u548c{c,b,a}\u662f\u540c\u4e00\u4e2a\u96c6\u5408\uff09\uff0c\u5bf9\u5e94\u5230 SQL \u548c\u5173\u7cfb\u578b\u6570\u636e\u5e93\u4e0a\uff0c\u8868\u7684 SELECT \u67e5\u8be2\u4e0d\u4fdd\u8bc1\u6709\u5e8f\uff0c\u751a\u81f3\u4e0d\u4fdd\u8bc1\u6bcf\u6b21\u67e5\u8be2\u7684\u8fd4\u56de\u7ed3\u679c\u96c6\u90fd\u662f\u540c\u6837\u7684\u987a\u5e8f\u3002</p> </li> <li> <p>\u5173\u7cfb\u7684\u5c5e\u6027\u4e5f\u6ca1\u6709\u4ece\u5de6\u5230\u53f3\u7684\u987a\u5e8f\uff0c\u5728\u5173\u7cfb\u578b\u6570\u636e\u5e93\u7406\u8bba\u4e2d\uff0c\u5728\u4efb\u4f55\u8868\u4e2d\u5bf9\u884c\u5217\u7684\u987a\u5e8f\u5e76\u6ca1\u6709\u4e25\u683c\u7684\u6982\u5ff5\u3002\u4e00\u4e2a\u8868\u5c31\u662f\u4e00\u4e2a\u6570\u636e\u96c6\uff0c\u800c\u6570\u636e\u96c6\u662f\u6ca1\u6709\u987a\u5e8f\u800c\u8a00\u7684\u3002\u4e5f\u6ca1\u6709 ANSI \u548c ISO SQL \u6807\u51c6\u6765\u5b9a\u4e49\u884c\u5217\u987a\u5e8f\u3002\uff08\u4f46\u662f\u5177\u4f53\u6570\u636e\u5e93\u5b9e\u73b0\u5728\u7269\u7406\u5b58\u50a8\u4e0a\uff0c\u5c5e\u6027\u662f\u6709\u987a\u5e8f\u7684\u3002\uff09</p> </li> </ul>"},{"location":"basic/5.relation/#_5","title":"\u6570\u636e","text":"<p>\u6570\u636e\u7ed3\u6784\u662f\u63cf\u8ff0\u4e00\u4e2a\u6570\u636e\u6a21\u578b\u6027\u8d28\u6700\u91cd\u8981\u7684\u65b9\u9762\u3002\u5177\u4f53\u6765\u8bf4\uff0c\u5b83\u63cf\u8ff0\u4e86\u4e24\u7c7b\u5185\u5bb9\uff1a</p> <p>\u4e00\u662f\u6570\u636e\u5e93\u5bf9\u8c61\u7684\u7c7b\u578b\u3001\u5185\u5bb9\u7b49\uff08\u4e00\u4e2a\u6a21\u578b\u4e2d\u6709\u4ec0\u4e48\u6837\u7684\u5bf9\u8c61\uff0c\u5bf9\u8c61\u7684\u5185\u5bb9\u662f\u4ec0\u4e48\uff09\uff0c\u6bd4\u5982\uff0c\u5173\u7cfb\u6a21\u578b\u6709\u5173\u7cfb\uff0c\u5c5e\u6027\uff0c\u57df\uff08\u5c5e\u6027\u7684\u53d6\u503c\u8303\u56f4\uff09\u7b49\u5bf9\u8c61\u3002</p> <p>\u4e8c\u662f\u6570\u636e\u4e4b\u95f4\u8054\u7cfb\u6709\u5173\u7684\u5bf9\u8c61\u3002</p> <p>\u603b\u4e4b\uff0c\u6570\u636e\u7ed3\u6784\u662f\u5bf9\u8c61\u7c7b\u578b\u7684\u96c6\u5408\u3002\uff08\u8868\u3001\u89c6\u56fe\u90fd\u662f\u5bf9\u8c61\uff0c\u4ed6\u4eec\u662f\u4e0d\u540c\u7684\u7c7b\u578b\uff09</p> <p>\u6570\u636e\u64cd\u4f5c\u662f\u5728\u5bf9\u8c61\u7684\u5b9e\u4f8b\u4e0a\u5141\u8bb8\u8fdb\u884c\u7684\u64cd\u4f5c\u7684\u96c6\u5408\u3002\u6bd4\u5982\uff0c\u5728\u8868\u4e0a\u5141\u8bb8\u8fdb\u884c\u67e5\u8be2\u3001\u5220\u9664\u7b49\u64cd\u4f5c\u3002</p> <p>\u6570\u636e\u7684\u5b8c\u6574\u6027\u7ea6\u675f\u6761\u4ef6\u662f\u4e00\u7ec4\u89c4\u5219\uff0c\u8fd9\u7ec4\u89c4\u5219\u5bf9\u6570\u636e\u53ca\u5176\u5173\u7cfb\u8d77\u5230\u5236\u7ea6\u7684\u4f5c\u7528\u3002\u6570\u636e\u6a21\u578b\u5e94\u8be5\u89c4\u5b9a\u8fd9\u6837\u7684\u4e00\u7ec4\u89c4\u5219\uff0c\u4ee5\u4fdd\u8bc1\u6570\u636e\u7684\u6b63\u786e\u3001\u6709\u6548\u3001\u76f8\u5bb9\uff0c\u5e76\u63d0\u4f9b\u5b9a\u4e49\u89c4\u5219\u7684\u673a\u5236\u3002</p>"},{"location":"basic/5.relation/#_6","title":"\u5b8c\u6574\u6027\u7ea6\u675f","text":"<p>\u5b8c\u6574\u6027\u7ea6\u675f\u7528\u4e8e\u7ef4\u62a4\u6570\u636e\u7684\u5b8c\u6574\u6027\u6216\u8005\u6ee1\u8db3\u4e1a\u52a1\u7ea6\u675f\u7684\u9700\u6c42\uff0c\u5305\u62ec**\u5b9e\u4f53\u5b8c\u6574\u6027\uff08\u4e3b\u952e\u7ea6\u675f\uff09\u3001**\u53c2\u7167\u5b8c\u6574\u6027\uff08\u5916\u952e\u7ea6\u675f\uff09**\u4ee5\u53ca**\u7528\u6237\u5b9a\u4e49\u7684\u5b8c\u6574\u6027\uff08\u975e\u7a7a\u7ea6\u675f\u3001\u552f\u4e00\u7ea6\u675f\u3001\u68c0\u67e5\u7ea6\u675f\u548c\u9ed8\u8ba4\u503c\uff09\u3002</p> <p>\u6570\u636e\u5e93\u7684\u5b8c\u6574\u6027\u6307\u6570\u636e\u7684\u6b63\u786e\u6027(correctness)\u548c\u76f8\u5bb9\u6027(compat-ability)\u3002\u4e3a\u4e86\u7ef4\u62a4\u6570\u636e\u7684\u5b8c\u6574\u6027\u548c\u4e00\u81f4\u6027\uff0c\u6216\u8005\u4e3a\u4e86\u5b9e\u73b0\u4e1a\u52a1\u9700\u6c42\uff0cSQL \u6807\u51c6\u5b9a\u4e49\u4e86\u5b8c\u6574\u6027\u7ea6\u675f\u3002</p> <ul> <li>\u6b63\u786e\u6027\uff1a\u6307\u6570\u636e\u7b26\u5408\u73b0\u5b9e\u8bed\u4e49\u3002</li> <li>\u76f8\u5bb9\u6027\uff1a\u6307\u540c\u4e00\u5bf9\u8c61\u5728\u4e0d\u540c\u5173\u7cfb\u8868\u4e2d\u7684\u6570\u636e\u662f\u7b26\u5408\u903b\u8f91\u7684\u3002</li> </ul> <p>\u4e3a\u4e86\u7ef4\u62a4\u6570\u636e\u5e93\u7684\u5b8c\u6574\u6027\uff0c\u6570\u636e\u5e93\u7ba1\u7406\u7cfb\u7edf(DBMS)\u5fc5\u987b\u5b9e\u73b0\u5982\u4e0b\u529f\u80fd\uff1a</p> <ul> <li> <p>\u5b9a\u4e49\u5b8c\u6574\u6027\u7ea6\u675f   \u5728 SQL \u6807\u51c6\u4e2d\u5b9a\u4e49\u4e86\u4e00\u7cfb\u5217\u5b9a\u4e49\u5b8c\u6574\u6027\u7ea6\u675f\u7684\u8bed\u53e5\u3002</p> </li> <li> <p>\u5b8c\u6574\u6027\u68c0\u67e5   \u68c0\u67e5\u6570\u636e\u662f\u5426\u7b26\u5408\u5b8c\u6574\u6027\u7ea6\u675f\u6761\u4ef6\u7684\u673a\u5236\u6210\u4e3a\u5b8c\u6574\u6027\u68c0\u67e5\u3002\u5b8c\u6574\u6027\u68c0\u67e5\u901a\u5e38\u5728 INSERT\u3001UPDATE\u3001DELETE \u8bed\u53e5\u6267\u884c\u540e\u5f00\u59cb\u68c0\u67e5\uff0c\u4e5f\u53ef\u5728\u4e8b\u52a1\u63d0\u4ea4\u65f6\u68c0\u67e5\u3002</p> </li> <li> <p>\u8fdd\u7ea6\u5904\u7406   \u5728 DBMS \u53d1\u73b0\u7528\u6237\u7684\u64cd\u4f5c\u8fdd\u80cc\u4e86\u5b8c\u6574\u6027\u7ea6\u675f\u6761\u4ef6\uff0c\u5c06\u91c7\u53d6\u4e00\u5b9a\u7684\u64cd\u4f5c\u3002</p> </li> </ul> <p>\u5173\u7cfb\u6570\u636e\u5e93\u7ba1\u7406\u7cfb\u7edf\u4f7f\u5f97\u5b8c\u6574\u6027\u63a7\u5236\u6210\u4e3a\u5176\u6838\u5fc3\u652f\u6301\u7684\u529f\u80fd\uff0c\u4ece\u800c\u80fd\u4e3a\u6240\u6709\u7528\u6237\u548c\u5e94\u7528\u63d0\u4f9b\u4e00\u81f4\u7684\u6570\u636e\u5e93\u5b8c\u6574\u6027\u3002</p>"},{"location":"basic/5.relation/#_7","title":"\u57df\u5b8c\u6574\u6027/\u7528\u6237\u5b9a\u4e49\u5b8c\u6574\u6027","text":"<p>\u7528\u6237\u5b9a\u4e49\u5b8c\u6574\u6027\uff0c\u6709\u65f6\u5019\u4e5f\u53eb\u57df\u540d\u5b8c\u6574\u6027\u3002</p> <ul> <li>\u975e\u7a7a\u7ea6\u675f\uff08NOT NULL\uff09\uff0c\u7528\u4e8e\u786e\u4fdd\u5b57\u6bb5\u4e0d\u4f1a\u51fa\u73b0\u7a7a\u503c\u3002\u4f8b\u5982\u5b66\u751f\u4fe1\u606f\u8868\u4e2d\uff0c\u5b66\u751f\u7684\u59d3\u540d\u3001\u51fa\u751f\u65e5\u671f\u3001\u6027\u522b\u7b49\u4e00\u5b9a\u8981\u6709\u6570\u636e\u3002</li> <li>\u552f\u4e00\u7ea6\u675f\uff08UNIQUE\uff09\uff0c\u7528\u4e8e\u786e\u4fdd\u5b57\u6bb5\u4e2d\u7684\u503c\u4e0d\u4f1a\u91cd\u590d\u3002\u4f8b\u5982\u6bcf\u4e2a\u5b66\u751f\u7684\u8eab\u4efd\u8bc1\u3001\u624b\u673a\u53f7\u7b49\u9700\u8981\u552f\u4e00\u3002</li> <li>\u68c0\u67e5\u7ea6\u675f\uff08CHECK\uff09\u53ef\u4ee5\u5b9a\u4e49\u66f4\u591a\u7684\u4e1a\u52a1\u89c4\u5219\u3002\u4f8b\u5982\uff0c\u6027\u522b\u7684\u53d6\u503c\u53ea\u80fd\u4e3a\u201c\u7537\u201d\u6216\u201c\u5973\u201d\uff0c\u7528\u6237\u540d\u5fc5\u987b\u5927\u5199\u7b49\uff1b</li> <li>\u9ed8\u8ba4\u503c\uff08DEFAULT\uff09\u7528\u4e8e\u4e3a\u5b57\u6bb5\u63d0\u4f9b\u9ed8\u8ba4\u7684\u6570\u636e\u3002\u4f8b\u5982\uff0c\u73a9\u5bb6\u6ce8\u518c\u65f6\u7684\u7ea7\u522b\u9ed8\u8ba4\u4e3a\u4e00\u7ea7\u3002</li> </ul> <p>\u57df\u5b8c\u6574\u6027\uff0c\u662f\u6307\u7ed9\u5b9a\u5217\u7684\u53d6\u503c\u8303\u56f4\uff08\u5373\u8f93\u5165\u7684\u6709\u6548\u6027\uff09\uff0c\u6bd4\u5982\u6027\u522b\u53d6\u503c\u5e94\u4e3a\u7537\u6216\u5973\u3002</p> <p>\u5f3a\u5236\u57df\u6709\u6548\u6027\u7684\u65b9\u6cd5\u6709\uff1a</p> <ul> <li>\u9650\u5236\u6570\u636e\u7c7b\u578b\uff08\u901a\u8fc7\u6570\u636e\u7c7b\u578b\uff09: \u5efa\u8868\u65f6\u6307\u5b9a\u5b57\u6bb5\u7684\u6570\u636e\u7c7b\u578b\uff0c\u81ea\u7136\u800c\u7136\u5c31\u9650\u5236\u4e86\u5b57\u6bb5\u7684\u53d6\u503c\u8303\u56f4\u3002</li> <li>\u65ad\u8a00\uff08\u901a\u8fc7 CHECK \u7ea6\u675f\u548c\u89c4\u5219\uff09\uff1acheck \u7ea6\u675f\uff0c\u6307\u5b9a\u67d0\u4e2a\u5b57\u6bb5\u7684\u53d6\u503c\u8303\u56f4\u3002\u4f8b\u5982\u7528\u6237\u540d\u5fc5\u987b\u5927\u5199\u3001\u4f59\u989d\u4e0d\u80fd\u5c0f\u4e8e\u96f6\u7b49\u3002</li> <li>\u9ed8\u8ba4\u503c\u3002</li> </ul> <pre><code>CREATE TABLE student (\n        stuno CHAR(11) PRIMARY KEY ,\n        stuname VARCHAR(20) ,\n        stuage SMALLINT,\n        stusex CHAR(1) CHECK (stusex in ('F','M'))  /* check\u7ea6\u675f\uff0c\u6307\u5b9a\u8303\u56f4 */\n        schno CHAR(3)  REFERENCES school(schno) ON CASCADE DELETE\n\n)\n\n\n\n-- \u5b58\u50a8\u4e86\u6b63\u5e38\u4ef7\u53ca\u6298\u6263\u4ef7\uff0c\u60a8\u60f3\u786e\u4fdd\u6298\u6263\u4ef7\u4f4e\u4e8e\u6b63\u5e38\u4ef7\nCREATE TABLE products (\n    no INTEGER,\n    name TEXT,\n    price NUMERIC CHECK (price &gt; 0),\n    discounted_price NUMERIC CHECK (discounted_price &gt; 0),\n    CHECK (price &gt; discounted_price)\n);\n\n\n\n-- \u975e\u7a7a\u7ea6\u675f\nCREATE TABLE t_nn(\n  id INT NOT NULL,\n  c1 VARCHAR(10)\n);\n\n-- Oracle\u3001MySQL\nALTER TABLE t_nn MODIFY c1 VARCHAR(10) NOT NULL;\n-- SQL Server\nALTER TABLE t_nn ALTER COLUMN c1 VARCHAR(10) NOT NULL;\n-- PostgreSQL\nALTER TABLE t_nn ALTER COLUMN c1 SET NOT NULL;\n\n-- SQLite \u4e0d\u652f\u6301\u4fee\u6539\u5b57\u6bb5\u7684\u7ea6\u675f\n\n-- \u5176\u4e2d\uff0cid \u5728\u521b\u5efa\u8868\u65f6\u6307\u5b9a\u4e86\u975e\u7a7a\u7ea6\u675f\uff1bc1 \u5b57\u6bb5\u901a\u8fc7 ALTER TABLE \u8bed\u53e5\u589e\u52a0\u4e86\u975e\u7a7a\u7ea6\u675f\uff0c\u6ce8\u610f\u4e0d\u540c\u6570\u636e\u5e93\u7684\u8bed\u6cd5\u5b9e\u73b0\u3002\n</code></pre> <p>\u73b0\u5728\u4e92\u8054\u7f51\u4e1a\u52a1\u7cfb\u7edf\u4e2d\uff0c\u6570\u636e\u5e93\u5f80\u5f80\u662f\u74f6\u9888\uff0c\u5b57\u6bb5\u9650\u5236\uff0c\u5f80\u5f80\u53ef\u4ee5\u5728\u524d\u7aef\u6821\u9a8c\u5b8c\u6210\uff0c\u5916\u952e\u7ea6\u675f\uff0c\u5b9e\u4f53\u5b8c\u6574\u6027\u7b49\uff0c\u53ef\u4ee5\u5728\u540e\u7aef\u5b8c\u6210\uff0c\u4e0d\u4e00\u5b9a\u8981\u5b8c\u5168\u4f9d\u8d56\u6570\u636e\u5e93\u7684\u5404\u79cd\u7ea6\u675f\u3002\u8fd9\u6837\u53ef\u4ee5\u6709\u6548\u51cf\u5c11\u6570\u636e\u5e93\u8ba1\u7b97\u5224\u65ad\u7684\u538b\u529b\u3002</p>"},{"location":"basic/5.relation/#_8","title":"\u5b9e\u4f53\u5b8c\u6574\u6027","text":"<p>\u5b9e\u4f53\uff08Entity\uff09\u662f\u4e00\u4e2a\u6570\u636e\u5bf9\u8c61\uff0c\u662f\u6307\u5ba2\u89c2\u5b58\u5728\u5e76\u53ef\u4ee5\u76f8\u4e92\u533a\u5206\u7684\u4e8b\u7269\uff0c\u5982\u4e00\u4e2a\u6559\u5e08\u3001\u4e00\u4e2a\u5b66\u751f\u6216\u4e00\u4e2a\u96c7\u5458\u7b49\u3002\u4e00\u4e2a\u5b9e\u4f53\u5728\u6570\u636e\u5e93\u4e2d\u8868\u73b0\u4e3a\u8868\u4e2d\u7684\u4e00\u6761\u8bb0\u5f55\u3002\u901a\u5e38\u60c5\u51b5\u4e0b\uff0c\u5b83\u5fc5\u987b\u9075\u5b88\u5b9e\u4f53\u5b8c\u6574\u6027\u89c4\u5219\u3002</p> <p>\u5b9e\u4f53\u5b8c\u6574\u6027\uff0c\u662f\u6307\u4f7f\u7528 \u4e3b\u952e \u6765\u552f\u4e00\u5730\u6807\u8bc6\u4e00\u4e2a\u5b9e\u4f53\u3002</p> <p>\u5728\u5173\u7cfb\u6570\u636e\u5e93\u4e2d\uff0c\u4e00\u6761\u8bb0\u5f55\u4ee3\u8868\u4e00\u4e2a\u5b9e\u4f53\u3002\u800c\u5b9e\u4f53\u662f\u53ef\u4ee5\u76f8\u4e92\u533a\u5206\u3001\u8bc6\u522b\u7684\uff0c\u4e5f\u5373\u5b83\u4eec\u5e94\u5177\u6709\u67d0\u79cd\u552f\u4e00\u6027\u6807\u8bc6\uff08\u8be5\u6807\u8bc6\u4e0d\u80fd\u53d6\u76f8\u540c\u7684\u503c\uff0c\u4e5f\u4e0d\u80fd\u4e3a\u7a7a\uff09\u3002</p> <p>\u5b9e\u4f53\u5b8c\u6574\u6027\u5f3a\u5236\u8868\u7684\u6807\u8bc6\u7b26\u5217\u6216\u4e3b\u952e\u7684\u5b8c\u6574\u6027\uff08\u901a\u8fc7\u7d22\u5f15\u3001UNIQUE \u7ea6\u675f\u3001PRIMARY KEY \u7ea6\u675f\u6216 IDENTITY \u5c5e\u6027\uff09\u3002</p> <ul> <li>\u4e3b\u952e\u7ea6\u675f\uff08Primary Key\uff09\uff0c\u7528\u4e8e\u552f\u4e00\u6807\u8bc6\u8868\u4e2d\u7684\u6bcf\u4e00\u884c\u6570\u636e\u3002\u4f8b\u5982\u5b66\u751f\u4fe1\u606f\u8868\u4e2d\uff0c\u5b66\u53f7\u901a\u5e38\u4f5c\u4e3a\u4e3b\u952e\u3002\u4e3b\u952e\u5b57\u6bb5\u4e0d\u80fd\u4e3a\u7a7a\u5e76\u4e14\u552f\u4e00\uff0c\u6bcf\u4e2a\u8868\u53ef\u4ee5\u6709\u4e14\u53ea\u80fd\u6709\u4e00\u4e2a\u4e3b\u952e\u3002</li> </ul> <p>\u5b9e\u4f53\u5b8c\u6574\u6027\u68c0\u67e5\u548c\u8fdd\u7ea6\u5904\u7406 \u4f7f\u7528 PRIMARY KEY \u77ed\u8bed\u5b9a\u4e49\u5173\u7cfb\u7684\u4e3b\u7801\u540e\u3002\u6bcf\u5f53\u7528\u6237\u63d2\u5165\u6216\u66f4\u65b0\u8bb0\u5f55\u65f6\uff0cDBMS \u90fd\u4f1a\u81ea\u52a8\u8fdb\u884c\u5b9e\u4f53\u5b8c\u6574\u6027\u68c0\u67e5\uff1a</p> <ul> <li>\u68c0\u67e5\u4e3b\u7801\u662f\u5426\u552f\u4e00\uff0c\u82e5\u4e0d\u552f\u4e00\u4fbf\u62d2\u7edd\u63d2\u5165\u6216\u4fee\u6539\u3002</li> <li>\u68c0\u67e5\u4e3b\u7801\u7684\u5404\u4e2a\u5c5e\u6027\u662f\u5426\u4e3a\u7a7a\uff0c\u82e5\u5b58\u5728\u4e3a\u7a7a\u4fbf\u62d2\u7edd\u63d2\u5165\u6216\u4fee\u6539\u3002</li> </ul>"},{"location":"basic/5.relation/#_9","title":"\u5f15\u7528\u5b8c\u6574\u6027","text":"<p>\u5f15\u7528\u5b8c\u6574\u6027/\u53c2\u7167\u5b8c\u6574\u6027\uff0c\u5c31\u662f\u5b9a\u4e49\u5916\u952e\u4e0e\u4e3b\u952e\u4e4b\u95f4\u7684\u5f15\u7528\u89c4\u5219\u3002</p> <p>\u53c2\u7167\u7684\u5b8c\u6574\u6027\u8981\u6c42**\u5173\u7cfb\u4e2d\u4e0d\u5141\u8bb8\u5f15\u7528\u4e0d\u5b58\u5728\u7684\u5b9e\u4f53**\u3002\u4e5f\u79f0\u5f15\u7528\u5b8c\u6574\u6027\uff0c\u53c2\u7167\u5b8c\u6574\u6027\u63cf\u8ff0\u4e86\u5b9e\u4f53\u95f4\u7684\u8054\u7cfb\u3002\u53c2\u7167\u5b8c\u6574\u6027\u4e00\u822c\u662f\u6307\u591a\u4e2a\u5b9e\u4f53\u8868\u4e4b\u95f4\u7684\u5f15\u7528\u5173\u7cfb\u3002</p> <p>\u53c2\u7167\u5b8c\u6574\u6027\u89c4\u5219\u5176\u5b9e\u5c31\u63cf\u8ff0\u4e86\u5916\u952e\u7684\u5b9a\u4e49\u3002\u8fd9\u4e2a\u89c4\u5219\u5b9e\u9645\u4e0a\u662f\u8bf4\uff1a\u5982\u4f55 B \u53c2\u7167 A\uff0c\u90a3\u4e48 A \u5fc5\u987b\u5b58\u5728\u3002</p> <ul> <li>\u5916\u952e\u7ea6\u675f\uff08Foreign Key\uff09\uff0c\u7528\u4e8e\u5efa\u7acb\u4e24\u4e2a\u8868\u4e4b\u95f4\u7684\u53c2\u7167\u5b8c\u6574\u6027\u3002\u4f8b\u5982\u5b66\u751f\u5c5e\u4e8e\u73ed\u7ea7\uff0c\u5b66\u751f\u4fe1\u606f\u8868\u4e2d\u7684\u73ed\u7ea7\u5b57\u6bb5\u662f\u4e00\u4e2a\u5916\u952e\uff0c\u5f15\u7528\u4e86\u73ed\u7ea7\u8868\u7684\u4e3b\u952e\u3002\u5bf9\u4e8e\u5916\u952e\u5f15\u7528\uff0c\u88ab\u5f15\u7528\u7684\u6570\u636e\u5fc5\u987b\u5b58\u5728\uff1b\u5b66\u751f\u4e0d\u53ef\u80fd\u5c5e\u4e8e\u4e00\u4e2a\u4e0d\u5b58\u5728\u7684\u73ed\u7ea7\u3002</li> </ul> <pre><code>-- \u90e8\u95e8\u8868\nCREATE TABLE dept(\n     department_id    INTEGER NOT NULL PRIMARY KEY,\n     department_name  CHARACTER VARYING(30) NOT NULL\n    ) ;\n-- \u5458\u5de5\u8868\nCREATE TABLE emp(\n     employee_id    INTEGER NOT NULL PRIMARY KEY,\n     first_name     CHARACTER VARYING(20),\n     last_name      CHARACTER VARYING(25) NOT NULL,\n     salary         NUMERIC(8,2),\n     manager_id     INTEGER,\n     department_id  INTEGER,\n     CONSTRAINT     fk_emp_dept  FOREIGN KEY (department_id) REFERENCES dept(department_id)\n    ) ;\n\n-- \u5916\u952e\u7ea6\u675f\u4e2d\u88ab\u5f15\u7528\u7684\u8868\u79f0\u4e3a\u7236\u8868\uff08dept\uff09\uff0c\u5916\u952e\u6240\u5728\u7684\u8868\u79f0\u4e3a\u5b50\u8868\uff08emp\uff09\u3002\n\n-- \u5916\u952e\u7ea6\u675f fk_emp_manager \u5f15\u7528\u4e86 emp \u8868\u81ea\u8eab\uff0c\u7528\u4e8e\u7ef4\u62a4\u5458\u5de5\u548c\u7ecf\u7406\u4e4b\u95f4\u7684\u8054\u7cfb\u3002\u5982\u679c emp \u4e2d\u5df2\u7ecf\u5b58\u5728\u6570\u636e\uff0c\u5fc5\u987b\u6ee1\u8db3\u8be5\u5916\u952e\u7ea6\u675f\u7684\u6761\u4ef6\uff0c\u5426\u5219\u65e0\u6cd5\u6dfb\u52a0\u8be5\u7ea6\u675f\u3002\nALTER TABLE emp ADD CONSTRAINT fk_emp_manager   FOREIGN KEY (manager_id)  REFERENCES emp(employee_id)\n    ;\n\n\n\nCONSTRAINT constraint_name\nFOREIGN KEY (column_name)\nREFERENCES parent_name(column_name)\nON DELETE [NO ACTION|RESTRICT|CASCADE|SET NULL|SET DEFAULT]\nON UPDATE [NO ACTION|RESTRICT|CASCADE|SET NULL|SET DEFAULT];\n\n-- NO ACTION \u8868\u793a\u5982\u679c\u7236\u8868\u4e0a\u7684 DELETE \u6216\u8005 UPDATE \u64cd\u4f5c\u8fdd\u53cd\u5916\u952e\u7ea6\u675f\uff0c\u8fd4\u56de\u9519\u8bef\uff1b\u5728\u4e8b\u52a1\u63d0\u4ea4\uff08COMMIT\uff09\u65f6\u68c0\u67e5\u3002\n-- ESTRICT \u8868\u793a\u5982\u679c\u7236\u8868\u4e0a\u7684 DELETE \u6216\u8005 UPDATE \u64cd\u4f5c\u8fdd\u53cd\u5916\u952e\u7ea6\u675f\uff0c\u8fd4\u56de\u9519\u8bef\uff1b\u5728\u8bed\u53e5\u6267\u884c\u65f6\u7acb\u5373\u68c0\u67e5\u3002\n-- CASCADE \u8868\u793a\u5982\u679c\u7236\u8868\u4e0a\u6267\u884c DELETE \u6216\u8005 UPDATE \u64cd\u4f5c\uff0c\u7ea7\u8054\u5220\u9664\u6216\u8005\u66f4\u65b0\u5b50\u8868\u4e0a\u7684\u8bb0\u5f55\u3002\n-- SET NULL \u5982\u679c\u7236\u8868\u4e0a\u6267\u884c DELETE \u6216\u8005 UPDATE \u64cd\u4f5c\uff0c\u5c06\u5b50\u8868\u4e2d\u7684\u5916\u952e\u5b57\u6bb5\u8bbe\u7f6e\u4e3a NULL\u3002\n-- SET DEFAULT \u5982\u679c\u7236\u8868\u4e0a\u6267\u884c DELETE \u6216\u8005 UPDATE \u64cd\u4f5c\uff0c\u5c06\u5b50\u8868\u4e2d\u7684\u5916\u952e\u5b57\u6bb5\u8bbe\u7f6e\u4e3a\u9ed8\u8ba4\u503c\u3002\n\n\n-- Oracle \u4e0d\u652f\u6301\u4efb\u4f55\u5916\u952e\u7684\u7ea7\u8054\u66f4\u65b0\u64cd\u4f5c\uff1bMySQL \u4e2d\u7684 NO ACTION \u548c RESTRICT \u6548\u679c\u76f8\u540c\uff0c\u90fd\u662f\u5728\u8bed\u53e5\u6267\u884c\u65f6\u7acb\u5373\u68c0\u67e5\u3002\n</code></pre> <p>\u65ad\u8a00</p> <p>\u5728 SQL \u4e2d\u53ef\u4ee5\u4f7f\u7528\u6570\u636e\u5b9a\u4e49\u8bed\u8a00\u4e2d\u7684<code>CREATE ASSERTION</code>\u8bed\u53e5\uff0c\u901a\u8fc7\u58f0\u660e\u6027\u65ad\u8a00(declarative assertions)\u6765\u5236\u5b9a\u66f4\u5177\u4e00\u822c\u6027\u7684\u7ea6\u675f\u3002</p> <p>\u5728\u65ad\u8a00\u521b\u7acb\u540e\uff0c\u4efb\u4f55\u5bf9\u65ad\u8a00\u4e2d\u6240\u6d89\u53ca\u7684\u5173\u7cfb\u7684\u64cd\u4f5c\u90fd\u4f1a\u89e6\u53d1 DBMS \u5bf9\u65ad\u8a00\u7684\u68c0\u67e5\uff0c\u4efb\u4f55\u4f7f\u65ad\u8a00\u4e0d\u4e3a\u771f\u503c\u7684\u64cd\u4f5c\u90fd\u4f1a\u88ab\u62d2\u7edd\u6267\u884c\u3002</p> <pre><code>CREATE ASSERTION &lt;\u65ad\u8a00\u540d&gt; &lt;CHECK\u5b50\u53e5&gt;\n\n-- \u793a\u4f8b\uff0c\u9650\u5236\u4e00\u95e8\u8bfe\u6700\u591a60\u4e2a\u5b66\u751f\u9009\u4fee\nCREATE ASSERTION ASSE_SC_CNUM2\n    CHECK (60 &gt;= ALL(SELECT COUNT(*) FROM SC GROUP BY cno, term))\n</code></pre> <p>\u5728\u65e5\u5e38\u4e1a\u52a1\u5f00\u53d1\u4e2d\uff0c\u4f1a\u7ecf\u5e38\u9047\u5230\u9700\u8981\u4fdd\u8bc1\u552f\u4e00\u6027\u7684\u6570\u636e\u4e1a\u52a1\uff0c\u5982\u7528\u6237\u6ce8\u518c\u4e1a\u52a1\u3002</p> <p>\u4e00\u822c\u6ce8\u518c\u4e1a\u52a1\u4e2d\u5141\u8bb8\u7528\u6237\u4ee5\u624b\u673a\u53f7\u6216 email \u6ce8\u518c\u8d26\u53f7\uff0c\u4e14\u9700\u8981\u4fdd\u8bc1\u552f\u4e00\uff0c\u4e0d\u5141\u8bb8\u91cd\u590d\u6ce8\u518c\u3002\u5f53\u7528\u6237\u8f93\u5165\u624b\u673a\u53f7\u6216 email \u767b\u5f55\u65f6\uff0c\u7a0b\u5e8f\u4f1a\u5224\u5b9a\u8f93\u5165\u4fe1\u606f\u7684\u5b58\u5728\u4e0e\u5426\u6027\uff0c\u5b58\u5728\u5219\u8d70\u767b\u5f55\uff0c\u4e0d\u5b58\u5728\u5219\u8d70\u6ce8\u518c\u3002\u800c\u4fdd\u8bc1\u552f\u4e00\u6027\u5c31\u4e0d\u4ec5\u4ec5\u9700\u8981\u5728\u7a0b\u5e8f\u7aef\u505a\u5224\u65ad\uff0c\u8fd8\u9700\u8981 MySQL \u7684\u552f\u4e00\u7d22\u5f15\u53bb\u505a\u6700\u540e\u4e00\u9053\u9632\u7ebf\u3002</p> <p>\u7ea6\u675f\u662f\u4e1a\u52a1\u68c0\u67e5\uff0c\u6bd4\u65b9\u8bf4\u975e\u7a7a\u7ea6\u675f\uff0ccheck \u7ea6\u675f\uff0c\u90a3\u662f\u68c0\u67e5\u5b57\u6bb5\u662f\u5426\u975e\u7a7a\uff0c\u662f\u5426\u7b26\u5408 check\u3002</p> <p>\u7d22\u5f15\u662f\u4e00\u79cd\u6570\u636e\u7ed3\u6784, rowid \u4e0e\u5b57\u6bb5\u503c\u7684\u952e\u503c\u5bf9. \u4e24\u4e2a\u4e1c\u897f\u7684\u6548\u679c\u662f\u4e00\u6837\u3002</p> <p>\u5728\u5efa\u7acb\u552f\u4e00\u7ea6\u675f\u65f6\uff0c\u4f1a\u81ea\u52a8\u521b\u5efa\u4e00\u4e2a\u552f\u4e00\u7d22\u5f15\u3002\u5e76\u4e14\uff0c\u5931\u6548\u8be5\u7ea6\u675f\u65f6\uff0c\u7d22\u5f15\u81ea\u52a8\u5220\u9664\u3002</p> <p>\u800c\u521b\u5efa\u552f\u4e00\u7d22\u5f15\u5219\u4e0d\u4f1a\u81ea\u52a8\u521b\u5efa\u552f\u4e00\u7ea6\u675f\u3002\u56e0\u6b64\u5728\u5efa\u8868\u65f6\uff0c\u5982\u679c\u8981\u521b\u5efa\u552f\u4e00\u7d22\u5f15\uff0c\u6700\u597d\u5148\u5efa\u552f\u4e00\u7d22\u5f15\u518d\u521b\u5efa\u552f\u4e00\u7ea6\u675f\u3002\u8fd9\u6837\u7684\u8bdd\uff0c\u5728\u8fdb\u884c\u5927\u6279\u91cf\u6570\u636e\u63d2\u5165\u65f6\uff0c\u53ef\u4ee5\u5148\u5931\u6548\u7ea6\u675f\uff0c\u63d2\u5165\u5b8c\u6210\u540e\u518d\u8fdb\u884c\u7d22\u5f15\u91cd\u5efa\u3002</p> <p>\u7ea6\u675f\u4e3b\u8981\u662f\u4e3a\u4e86\u4fdd\u8bc1\u6570\u636e\u7684\u5b8c\u6574\u6027\uff0c\u7d22\u5f15\u4e3b\u8981\u662f\u4e3a\u4e86\u8f85\u52a9\u67e5\u8be2\u3002</p> <p>\u552f\u4e00\u7d22\u5f15\u7528\u4e8e\u9650\u5236\u7d22\u5f15\u5b57\u6bb5\u503c\u7684\u552f\u4e00\u6027\uff0c\u6216\u8005\u662f\u591a\u4e2a\u5b57\u6bb5\u7ec4\u5408\u503c\u7684\u552f\u4e00\u6027\u3002CREATE UNIQUE INDEX \u521b\u5efa\u552f\u4e00\u7d22\u5f15\u3002</p> <p>\u552f\u4e00\u7ea6\u675f\u53ef\u4ee5\u662f\u5355\u4e2a\u5b57\u6bb5\uff0c\u4e5f\u53ef\u4ee5\u662f\u591a\u4e2a\u5b57\u6bb5\u7684\u7ec4\u5408\uff0c\u8bbe\u7f6e\u552f\u4e00\u7ea6\u675f\u540e\uff0cINSERT \u6216 UPDATE \u65f6\u5982\u679c\u8868\u4e2d\u552f\u4e00\u952e\u5b57\u6bb5\u4e2d\u5df2\u5b58\u5728\u8be5\u6570\u636e\uff0c\u5219\u62d2\u7edd\u8be5\u884c\u6570\u636e\u7684 INSERT \u6216 UPDATE\u3002\u4f46\u662f\u6570\u636e\u5e93\u4e2d NULL \u5e76\u4e0d\u7b49\u4e8e NULL\uff0c\u6240\u4ee5\u552f\u4e00\u952e\u4e2d\u5982\u679c\u6ca1\u6709 NOT NULL \u7ea6\u675f\uff0c\u5219\u53ef\u4ee5\u5728\u552f\u4e00\u952e\u4e2d INSERT \u6216 UPDATE \u4efb\u610f\u591a\u4e2a NULL\u3002</p> <p>\u5728 MySQL \u4e2d\uff0c\u552f\u4e00\u7d22\u5f15\u6811\u662f\u4e00\u4e2a\u975e\u805a\u7c07\u7d22\u5f15\uff0c\u6bcf\u6b21\u63d2\u5165\u6570\u636e\u65f6\uff0c\u90fd\u4f1a\u5728\u552f\u4e00\u7d22\u5f15\u6811\u4e0a\u8fdb\u884c\u904d\u5386\u67e5\u627e\u8be5\u63d2\u5165\u503c\u662f\u5426\u552f\u4e00\uff0c\u8fd9\u4e5f\u5c31\u662f\u4e3a\u4ec0\u4e48\u4f1a\u5f71\u54cd insert \u7684\u901f\u5ea6\uff0c\u56e0\u4e3a\u591a\u4e00\u6b65\u904d\u5386\u5224\u65ad\u552f\u4e00\u6027\u3002</p> <p>\u5982\u679c\u4f60\u60f3\u5411\u8868\u4e2d\u589e\u52a0\u552f\u4e00\u7ea6\u675f\uff0c\u5fc5\u987b\u8981\u8003\u8651\u8868\u4e2d\u5df2\u5b58\u5728\u7684\u6570\u636e\u53ef\u80fd\u5b58\u5728\u91cd\u590d\u6570\u636e\u3002\u91cd\u590d\u7684\u6570\u636e\u6709\u4e24\u79cd\u7406\u89e3\u65b9\u5f0f\uff1a</p> <ul> <li> <p>\u65b9\u5f0f\u4e00\uff1a\u4e25\u683c\u610f\u4e49\u4e0a\u7684\u552f\u4e00\uff0cNULL \u4e0d\u7b49\u4e8e NULL\uff0c\u5373(1,NULL)\u548c(1,NULL)\u4e0d\u662f\u91cd\u590d\u6570\u636e\u3002</p> </li> <li> <p>\u65b9\u5f0f\u4e8c\uff1a\u975e\u4e25\u683c\u610f\u4e49\u4e0a\u7684\u552f\u4e00\uff0cNULL \u7b49\u4e8e NULL\uff0c\u5373(1,NULL)\u548c(1,NULL)\u662f\u91cd\u590d\u6570\u636e\u3002</p> </li> </ul> <p>\u6240\u4ee5\u5411\u8868\u4e2d\u589e\u52a0\u552f\u4e00\u7ea6\u675f\u5fc5\u987b\u8981\u5220\u9664\u8fd9\u4e9b\u91cd\u590d\u6570\u636e\uff0c\u6216\u8005\u5c06\u91cd\u590d\u6570\u636e\u5220\u9664\u5230\u552f\u4e00\u3002</p> <ul> <li> <p>\u60c5\u51b5\u4e00\uff1a\u5220\u9664\u4e25\u683c\u610f\u4e49\u4e0a\u7684\u91cd\u590d</p> </li> <li> <p>\u7b2c\u4e00\u6b65\uff1a\u6e05\u7a7a\u6d4b\u8bd5\u8868\uff0c\u5199\u5165\u4e00\u4e9b\u6d4b\u8bd5\u6570\u636e\u3002</p> </li> </ul> \u7801 <p>\u7801\u662f\u6570\u636e\u7cfb\u7edf\u4e2d\u7684\u6700\u57fa\u672c\u7684\u6982\u5ff5\u3002\u6240\u8c13\u7801\u5c31\u662f\u80fd\u552f\u4e00\u6807\u8bc6\u5b9e\u4f53\u7684\u5c5e\u6027\uff0c\u5b83\u662f\u6574\u4e2a\u5b9e\u4f53\u96c6\u7684\u6027\u8d28\uff0c\u800c\u4e0d\u662f\u5355\u4e2a\u5b9e\u4f53\u7684\u6027\u8d28\u3002</p> <p>\u4e00\u4e2a\u5143\u7ec4\u7684\u5c5e\u6027\u503c\u5fc5\u987b\u662f\u80fd\u591f\u552f\u4e00\u533a\u5206\u5143\u7ec4\u7684\uff0c\u6362\u53e5\u8bdd\u8bf4\uff0c\u4e00\u4e2a\u5173\u7cfb\u4e2d\u6ca1\u6709\u4e24\u4e2a\u5143\u7ec4\u5728\u6240\u6709\u5c5e\u6027\u4e0a\u7684\u53d6\u503c\u90fd\u76f8\u540c\u3002\u5373\u8868\u4e2d\u6ca1\u6709\u5b8c\u5168\u91cd\u590d\u7684\u884c\u3002</p> <ul> <li> <p>\u8d85\u7801\uff1a\u4e00\u4e2a\u6216\u591a\u4e2a\u5c5e\u6027\u7684\u96c6\u5408\uff0c\u8fd9\u4e9b\u5c5e\u6027\u53ef\u4ee5\u4f7f\u6211\u4eec\u5728\u4e00\u4e2a\u5173\u7cfb\u4e2d\u552f\u4e00\u6807\u8bc6\u4e00\u4e2a\u5143\u7ec4\uff0c\u8fd9\u4e2a\u5c5e\u6027\u96c6\u5408\u88ab\u79f0\u4e3a\u8d85\u7801\uff08super key\uff09\uff0c\u5982\u679cK\u662f\u8d85\u7801\uff0c\u90a3\u4e48K\u7684\u4efb\u610f\u8d85\u96c6\u4e5f\u662f\u8d85\u7801\u3002</p> </li> <li> <p>\u5019\u9009\u7801\uff1a\u5b58\u5728\u8fd9\u6837\u5f97\u4e00\u4e9b\u8d85\u7801\uff0c\u5373\u4ed6\u4eec\u5f97\u4efb\u610f\u771f\u5b50\u96c6\u90fd\u4e0d\u80fd\u6210\u4e3a\u8d85\u7801\u3002\u8fd9\u6837\u7684\u6700\u5c0f\u8d85\u7801\u79f0\u4e3a\u5019\u9009\u7801\uff08candidate key\uff09</p> </li> <li> <p>\u4e3b\u7801\uff1a\u4e3b\u7801\uff08primary key\uff0c\u4e2d\u6587\u53c8\u79f0\u4e3b\u952e\uff09\u662f\u88ab\u6570\u636e\u5e93\u8bbe\u8ba1\u8005\u88ab\u9009\u4e2d\u7684\uff0c\u4e3b\u8981\u7528\u6765\u5728\u4e00\u4e2a\u5173\u7cfb\u4e2d\u533a\u5206\u4e0d\u540c\u5143\u7ec4\u7684\u5019\u9009\u7801\u3002</p> </li> <li> <p>\u5916\u7801\uff1a\u5916\u7801\uff08foregin key\uff0c\u4e2d\u6587\u53c8\u79f0\u5916\u952e\uff09\uff0c\u5047\u8bbe\u5728\u67d0\u4e2a\u8868R1\u4e2d\u5b58\u5728\u4e00\u4e2a\u5c5e\u6027\uff0c\u8fd9\u4e2a\u5c5e\u6027\u662f\u53e6\u5916\u4e00\u4e2a\u8868R2\u7684\u4e3b\u952e\u3002\u5219\u8fd9\u4e2a\u5c5e\u6027\u5728R1\u4e0a\u88ab\u79f0\u4e3a\u53c2\u7167R2\u7684\u5916\u7801\uff08\u5916\u952e\uff09\u3002        \u5916\u7801\u7528\u4e8e\u8868\u793a\u4e24\u4e2a\u6216\u591a\u4e2a\u5b9e\u4f53\u95f4\u7684\u5173\u8054\u5173\u7cfb\u3002\u5916\u7801\u5b9e\u9645\u4e0a\u662f\u5173\u7cfb\u4e2d\u7684\u4e00\u4e2a\u6216\u591a\u4e2a\u5c5e\u6027\uff0c\u8fd9\u4e9b\u5c5e\u6027\u5f15\u7528\u5176\u4ed6\u5173\u7cfb\u7684\u4e3b\u7801\u6216\uff08\u5019\u9009\u7801\uff09</p> </li> </ul> \u51fd\u6570\u4f9d\u8d56 <p>\u8bbe\u4e00\u4e2a\u5173\u7cfb\u4e3a R(U)\uff0cX \u548c Y \u4e3a\u5c5e\u6027\u96c6 U \u4e0a\u7684\u5b50\u96c6\uff0c\u82e5\u5bf9\u4e8e X \u4e0a\u7684\u6bcf\u4e2a\u503c\u90fd\u6709 Y \u4e0a\u7684\u4e00\u4e2a\u552f\u4e00\u503c\u4e0e\u4e4b\u5bf9\u5e94\uff0c\u5219\u79f0 X \u548c Y \u5177\u6709\u51fd\u6570\u4f9d\u8d56\u5173\u7cfb\uff0c\u5e76\u79f0 X \u51fd\u6570\u51b3\u5b9a Y\uff0c\u6216\u79f0 Y \u51fd\u6570\u4f9d\u8d56\u4e8e X\uff0c\u8bb0\u4f5c X\u2192Y\uff0c\u79f0 X \u4e3a\u51b3\u5b9a\u56e0\u7d20\u3002</p> <pre><code> \u6570\u636e\u4f9d\u8d56\u662f\u4e00\u4e2a\u5173\u7cfb\u5185\u90e8\u5c5e\u6027\u4e0e\u5c5e\u6027\u4e4b\u95f4\u7684\u4e00\u79cd\u7ea6\u675f\u5173\u7cfb\u3002\u8fd9\u79cd\u7ea6\u675f\u5173\u7cfb\u662f\u901a\u8fc7\u5c5e\u6027\u95f4\u503c\u7684\u76f8\u7b49\u4e0e\u5426\u4f53\u73b0\u51fa\u6765\u7684\u6570\u636e\u95f4\u7684\u76f8\u5173\u8054\u7cfb\u3002\n\n \u51fd\u6570\u4f9d\u8d56\u6307\u7684\u662f\u5728\u6570\u636e\u5e93\u4e2d\uff0c\u5404\u79cd\u4e0d\u540c\u5c5e\u6027\uff08\u6216\u8005\u5c5e\u6027\u96c6\u5408\uff09\u5173\u7cfb\u95f4\u7684\u4e00\u79cd\"\u7ea6\u675f\"\uff0c\u4e5f\u53ef\u4ee5\u770b\u4f5c\u5c5e\u6027\u4e4b\u95f4\u7684\u4e00\u79cd\u6620\u5c04\uff0c\u4e5f\u662f\u4e00\u79cd\"\u4f9d\u8d56\u6027\"\uff0c\u5b58\u5728\"\u5f53\u4e14\u4ec5\u5f53\"\u7684\u524d\u63d0\u3002\n\n \u82e5\u5728\u4e00\u5f20\u8868\u4e2d\uff0c\u5728\u5c5e\u6027\uff08\u6216\u5c5e\u6027\u7ec4\uff09X\u7684\u503c\u786e\u5b9a\u7684\u60c5\u51b5\u4e0b\uff0c\u5fc5\u5b9a\u80fd\u786e\u5b9a\u5c5e\u6027Y\u7684\u503c\uff0c\u90a3\u4e48\u5c31\u53ef\u4ee5\u8bf4Y\u51fd\u6570\u4f9d\u8d56\u4e8eX\uff0c\u5199\u4f5c X \u2192 Y\u3002\n\n \u4e5f\u5c31\u662f\u8bf4\uff0c\u5728\u6570\u636e\u8868\u4e2d\uff0c\u4e0d\u5b58\u5728\u4efb\u610f\u4e24\u6761\u8bb0\u5f55\uff0c\u5b83\u4eec\u5728X\u5c5e\u6027\uff08\u6216\u5c5e\u6027\u7ec4\uff09\u4e0a\u7684\u503c\u76f8\u540c\uff0c\u800c\u5728Y\u5c5e\u6027\u4e0a\u7684\u503c\u4e0d\u540c\u3002\u8fd9\u4e5f\u5c31\u662f\u201c\u51fd\u6570\u4f9d\u8d56\u201d\u540d\u5b57\u7684\u7531\u6765\u3002\n</code></pre> \u90e8\u5206\u51fd\u6570\u4f9d\u8d56 <p>\u8bbe\u4e00\u4e2a\u5173\u7cfb\u4e3a R(U)\uff0cX \u548c Y \u4e3a\u5c5e\u6027\u96c6 U \u4e0a\u7684\u5b50\u96c6\uff0c\u82e5\u5bf9\u4e8e X \u4e0a\u7684\u6bcf\u4e2a\u503c\u90fd\u6709 Y \u4e0a\u7684\u4e00\u4e2a\u552f\u4e00\u503c\u4e0e\u4e4b\u5bf9\u5e94\uff0c\u5219\u79f0 X \u548c Y \u5177\u6709\u51fd\u6570\u4f9d\u8d56\u5173\u7cfb\uff0c\u5e76\u79f0 X \u51fd\u6570\u51b3\u5b9a Y\uff0c\u6216\u79f0 Y \u51fd\u6570\u4f9d\u8d56\u4e8e X\uff0c\u8bb0\u4f5c X\u2192Y\uff0c\u79f0 X \u4e3a\u51b3\u5b9a\u56e0\u7d20\u3002</p> \u4f20\u9012\u51fd\u6570\u4f9d\u8d56 <p>\u8bbe\u4e00\u4e2a\u5173\u7cfb\u4e3a R(U)\uff0cX \u548c Y \u4e3a\u5c5e\u6027\u96c6 U \u4e0a\u7684\u5b50\u96c6\uff0c\u82e5\u5bf9\u4e8e X \u4e0a\u7684\u6bcf\u4e2a\u503c\u90fd\u6709 Y \u4e0a\u7684\u4e00\u4e2a\u552f\u4e00\u503c\u4e0e\u4e4b\u5bf9\u5e94\uff0c\u5219\u79f0 X \u548c Y \u5177\u6709\u51fd\u6570\u4f9d\u8d56\u5173\u7cfb\uff0c\u5e76\u79f0 X \u51fd\u6570\u51b3\u5b9a Y\uff0c\u6216\u79f0 Y \u51fd\u6570\u4f9d\u8d56\u4e8e X\uff0c\u8bb0\u4f5c X\u2192Y\uff0c\u79f0 X \u4e3a\u51b3\u5b9a\u56e0\u7d20\u3002</p> \u7b2c\u4e00\u8303\u5f0f <p>\u7b2c\u4e00\u8303\u5f0f\u6700\u597d\u7406\u89e3\uff0c\u5982\u679c\u4e00\u4e2a\u5173\u7cfb\u4e2d\u7684\u6240\u6709\u5c5e\u6027\u7684\u57df\u90fd\u662f\u539f\u5b50\u7684\uff0c\u90a3\u4e48\u8fd9\u4e2a\u5173\u7cfb\u5c5e\u4e8e\u7b2c\u4e00\u8303\u5f0f\u3002\uff08\u5c5e\u6027\u4e0d\u53ef\u62c6\u5206\uff09\u3002 \u5728\u5f53\u524d\u7684\u4efb\u4f55\u5173\u7cfb\u6570\u636e\u5e93\u7ba1\u7406\u7cfb\u7edf RDBMS \u4e2d\uff0c\u8bbe\u8ba1\u51fa\u4e0d\u7b26\u5408\u7b2c\u4e00\u8303\u5f0f\u7684\u6570\u636e\u5e93\u90fd\u662f\u4e0d\u53ef\u80fd\u7684\u3002\u56e0\u4e3a\u8fd9\u4e9b DBMS \u4e0d\u5141\u8bb8\u4f60\u628a\u6570\u636e\u5e93\u8868\u7684\u4e00\u5217\u518d\u5206\u6210\u4e8c\u5217\u6216\u591a\u5217\u3002</p> <pre><code>```SQL\n\uff08\u5b66\u53f7\uff0c\u59d3\u540d\uff0c\u7cfb\u540d\uff0c\u7cfb\u4e3b\u4efb\uff0c\u8bfe\u7a0b\u540d\uff0c\u5206\u6570\uff09\n \u4e3b\u7801\uff08\u5b66\u53f7\uff0c\u8bfe\u7a0b\u540d\uff09\n\n-- \u5bf9\u4e8e\uff08\u5b66\u53f7\uff0c\u8bfe\u540d\uff09 \u2192 \u59d3\u540d\uff0c\u6709 \u5b66\u53f7 \u2192 \u59d3\u540d\uff0c\u5b58\u5728\u975e\u4e3b\u5c5e\u6027 \u59d3\u540d \u5bf9\u7801\uff08\u5b66\u53f7\uff0c\u8bfe\u540d\uff09\u7684\u90e8\u5206\u51fd\u6570\u4f9d\u8d56\u3002\n-- \u5bf9\u4e8e\uff08\u5b66\u53f7\uff0c\u8bfe\u540d\uff09 \u2192 \u7cfb\u540d\uff0c\u6709 \u5b66\u53f7 \u2192 \u7cfb\u540d\uff0c\u5b58\u5728\u975e\u4e3b\u5c5e\u6027 \u7cfb\u540d \u5bf9\u7801\uff08\u5b66\u53f7\uff0c\u8bfe\u540d\uff09\u7684\u90e8\u5206\u51fd\u6570\u4f9d\u8d56\u3002\n-- \u5bf9\u4e8e\uff08\u5b66\u53f7\uff0c\u8bfe\u540d\uff09 \u2192 \u7cfb\u4e3b\u4efb\uff0c\u6709 \u5b66\u53f7 \u2192 \u7cfb\u4e3b\u4efb\uff0c\u5b58\u5728\u975e\u4e3b\u5c5e\u6027 \u7cfb\u4e3b\u4efb \u5bf9\u7801\uff08\u5b66\u53f7\uff0c\u8bfe\u540d\uff09\u7684\u90e8\u5206\u51fd\u6570\u4f9d\u8d56\u3002\n```\n</code></pre> \u7b2c\u4e8c\u8303\u5f0f <p>\u975e\u4e3b\u5c5e\u6027\uff08\u9664\u4e3b\u7801\u4ee5\u5916\u7684\u6240\u6709\u5c5e\u6027\uff09</p> <pre><code>\u6d88\u9664\u4e86\u975e\u4e3b\u5c5e\u6027\u5bf9\u4e8e\u4e3b\u7801\u7684\u90e8\u5206\u51fd\u6570\u4f9d\u8d56\u3002\u5224\u65ad\u7684\u4f9d\u636e\u5b9e\u9645\u4e0a\u5c31\u662f\u770b\u6570\u636e\u8868\u4e2d\u662f\u5426\u5b58\u5728\u975e\u4e3b\u5c5e\u6027\u5bf9\u4e8e\u4e3b\u7801\u7684\u90e8\u5206\u51fd\u6570\u4f9d\u8d56\u3002\n\n```SQL\n\u9009\u8bfe\uff08\u5b66\u53f7\uff0c\u8bfe\u540d\uff0c\u5206\u6570\uff09 \u4e3b\u7801\uff08\u5b66\u53f7\uff0c\u8bfe\u540d\uff09\n\u5b66\u751f\uff08\u5b66\u53f7\uff0c\u59d3\u540d\uff0c\u7cfb\u540d\uff0c\u7cfb\u4e3b\u4efb\uff09 \u4e3b\u7801\uff08\u5b66\u53f7\uff09\n\n-- \u4e3b\u7801\u4e3a\u4e00\u4e2a\u5c5e\u6027\u65f6\uff0c\u4e0d\u5b58\u5728\u975e\u4e3b\u5c5e\u6027\u5bf9\u4e3b\u7801\u7684\u90e8\u5206\u51fd\u6570\u4f9d\u8d56\u3002\n-- \u4f46\u662f\u5b58\u5728\u4f20\u9012\u51fd\u6570\u4f9d\u8d56\u3002\n```\n\n\uff08\u5b66\u53f7\uff0c\u5b66\u751f\u59d3\u540d\u3001\u5e74\u9f84\u3001\u6027\u522b\u3001\u8bfe\u7a0b\u3001\u8bfe\u7a0b\u5b66\u5206\u3001\u7cfb\u522b\u3001\u5b66\u79d1\u6210\u7ee9\uff0c\u7cfb\u529e\u5730\u5740\u3001\u7cfb\u529e\u7535\u8bdd )\n</code></pre> \u7b2c\u4e09\u8303\u5f0f"},{"location":"basic/5.relation/#er","title":"ER \u5b9e\u4f53\u8054\u7cfb\u56fe","text":"<p>\u5b9e\u4f53\u8054\u7cfb\u56fe\uff08E-R diagram\uff09ERD \u53ef\u4ee5\u7528\u56fe\u5f62\u5316\u8868\u793a\u6570\u636e\u5e93\u7684\u5168\u5c40\u903b\u8f91\u7ed3\u6784\u3002</p>"},{"location":"basic/5.relation/#_10","title":"\u5f62\u5f0f\u5316\u5173\u7cfb\u67e5\u8be2","text":"<p>\u5173\u7cfb\u4ee3\u6570\u662f\u4e00\u79cd\u8fc7\u7a0b\u5316\u67e5\u8be2\u8bed\u8a00\u3002\u5b83\u5305\u542b\u4e00\u4e2a\u8fd0\u7b97\u7684\u96c6\u5408\u3002\u8fd9\u4e9b\u8fd0\u7b97\u4ee5\u4e00\u4e2a\u6216\u591a\u4e2a\u5173\u7cfb\u505a\u4e3a\u8f93\u5165\uff0c\u4ea7\u751f\u4e00\u4e2a\u65b0\u5173\u7cfb\u505a\u4e3a\u7ed3\u679c\u3002</p> <p>\u5173\u7cfb\u4ee3\u6570\u672c\u8d28\u4e0a\u662f SQL \u5728\u6570\u5b66\u4e0a\u7684\u8868\u793a\uff0c\u5b83\u548c SQL \u7684\u8868\u8fbe\u80fd\u529b\u662f\u5b8c\u5168\u7b49\u4ef7\u7684\u3002\u56e0\u6b64\u53ef\u4ee5\u8bf4\u53ea\u6709\u5b66\u61c2\u4e86\u5173\u7cfb\u4ee3\u6570\uff0c\u624d\u80fd\u5728\u6570\u5b66\u5c42\u9762\u7406\u89e3 SQL\u3001\u624d\u6709\u53ef\u80fd\u5199\u51fa\u7b26\u5408\u903b\u8f91\u7684 SQL \u8bed\u53e5\u3002</p> <p>\u5173\u7cfb\u6f14\u7b97\u5219\u548c\u5173\u7cfb\u4ee3\u6570\u76f8\u53cd\uff0c\u5b83\u66f4\u50cf\u662f\u4e00\u6574\u201c\u5757\u201d\u6570\u636e\u5728\u5404\u79cd\u6761\u4ef6\u7684\u7ea6\u675f\u4e0b\uff0c\u50cf\u6d0b\u8471\u4e00\u6837\u8d8a\u53d8\u8d8a\u201c\u5c0f\u201d\u7684\u8fc7\u7a0b\uff0c\u56e0\u6b64\u5b66\u61c2\u4e86\u5173\u7cfb\u6f14\u7b97\uff0c\u6709\u52a9\u4e8e\u7406\u89e3 SQL \u662f\u5982\u4f55\u88ab\u6267\u884c\u7684\u3002</p> <p>\u5173\u7cfb\u6570\u636e\u8bed\u8a00\u53ef\u4ee5\u5206\u4e3a\u4e09\u7c7b: \u5173\u7cfb\u4ee3\u6570\u3001\u5173\u7cfb\u6f14\u7b97\u548c\u4ecb\u4e8e\u5173\u7cfb\u4ee3\u6570\u4e0e\u5173\u7cfb\u6f14\u7b97\u4e4b\u95f4\u7684\u8bed\u8a00 SQL\u3002\u5173\u7cfb\u4ee3\u6570\u7684\u8fd0\u7b97\u5bf9\u8c61\u662f\u5173\u7cfb\uff0c\u8fd0\u7b97\u7ed3\u679c\u4e5f\u662f\u5173\u7cfb\u3002</p> <p>\u5173\u7cfb\u4ee3\u6570\u7528\u5230\u7684\u8fd0\u7b97\u7b26\u5305\u62ec\u56db\u7c7b:\u96c6\u5408\u8fd0\u7b97\u7b26\u3001\u4e13\u95e8\u7684\u5173\u7cfb\u8fd0\u7b97\u7b26\u3001\u7b97\u672f\u6bd4\u8f83\u8fd0\u7b97\u7b26\u548c\u903b\u8f91\u8fd0\u7b97\u7b26\u3002\u5176\u4e2d\u6bd4\u8f83\u8fd0\u7b97\u7b26\u548c\u903b\u8f91\u8fd0\u7b97\u7b26\u662f\u7528\u6765\u8f85\u52a9\u8fd0\u7b97\u7684\u4e13\u95e8\u5173\u7cfb\u8fd0\u7b97\u7b26</p> <p>\u57fa\u672c\u8fd0\u7b97\uff1a</p> <ul> <li> <p>\u9009\u62e9\u8fd0\u7b97\uff1a\u5bf9\u5e94 SELECT \u6761\u4ef6\u67e5\u8be2\uff0c\u9009\u62e9\u8fd0\u7b97\u9009\u51fa\u6765\u7ed9\u5b9a\u8c13\u8bcd\u7684\u5143\u7ec4\u3002\u5b83\u5bf9\u5e94\u4e8e SQL \u4e2d\u7684 WHERE \u5b50\u53e5\u3002\u6309\u7167\u6307\u5b9a\u7684\u6761\u4ef6\u7b5b\u9009\u51fa\u6ee1\u8db3\u6761\u4ef6\u7684\u5143\u7ec4\uff08\u884c\uff09\u3002</p> </li> <li> <p>\u7b26\u53f7\uff1a\u03c3</p> </li> <li>\u8868\u8fbe\u5f0f\uff1a\u03c3_F\u200b(R)</li> <li> <p>\u903b\u8f91\uff1a\u4ece\u5173\u7cfb R \u4e2d\u9009\u62e9\u4f7f\u5f97\u903b\u8f91\u8868\u8fbe\u5f0f F \u4e3a\u771f\u7684\u6240\u6709\u5143\u7ec4 t\u3002</p> </li> <li> <p>\u9009\u62e9\u8fd0\u7b97\u662f\u4ece\u5173\u7cfb\u7684\u6c34\u5e73\u65b9\u5411\u8fdb\u884c\u7684\uff0c\u5373\u5b83\u8fc7\u6ee4\u6389\u4e0d\u6ee1\u8db3\u6761\u4ef6\u7684\u884c\u3002</p> </li> <li>\u9009\u62e9\u8fd0\u7b97\u7684\u7ed3\u679c\u4ecd\u7136\u662f\u4e00\u4e2a\u5173\u7cfb\uff0c\u8fd9\u610f\u5473\u7740\u7ed3\u679c\u53ef\u4ee5\u4f5c\u4e3a\u53e6\u4e00\u4e2a\u8fd0\u7b97\u7684\u8f93\u5165\u3002</li> <li> <p>\u9009\u62e9\u8fd0\u7b97\u4e0d\u4f1a\u6539\u53d8\u5143\u7ec4\u7684\u5c5e\u6027\uff0c\u5b83\u53ea\u662f\u7b80\u5355\u5730\u5305\u542b\u6216\u6392\u9664\u6574\u4e2a\u5143\u7ec4\u3002</p> </li> <li> <p>\u6295\u5f71\u8fd0\u7b97\uff1a\u5bf9\u5e94\u4e8e SQL \u4e2d\u7684 SELECT \u8bed\u53e5\uff08\u7279\u5b9a\u5217\u7684\u9009\u62e9\uff09\u3002\u6295\u5f71\u7528\u4e8e\u63d0\u53d6\u5173\u7cfb\u4e2d\u7684\u7279\u5b9a\u5217\uff0c\u5e76\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u5173\u7cfb\uff0c\u8be5\u5173\u7cfb\u4ec5\u5305\u542b\u6307\u5b9a\u7684\u5217\u3002</p> </li> <li> <p>\u96c6\u5408\u5e76\u8fd0\u7b97: \u5bf9\u5e94 UNION \u67e5\u8be2\uff0c - \u7b26\u53f7\uff1a\u222a - \u8868\u8fbe\u5f0f\uff1a\u03c3_F\u200b(R) - \u903b\u8f91\uff1a\u4ece\u5173\u7cfb R \u4e2d\u9009\u62e9\u4f7f\u5f97\u903b\u8f91\u8868\u8fbe\u5f0f F \u4e3a\u771f\u7684\u6240\u6709\u5143\u7ec4 t\u3002</p> <p>R\u548cS\u7684\u5e76\uff0cR\u222aS\uff0c\u662f\u5728R\u6216S\u6216\u4e24\u8005\u4e2d\u7684\u5143\u7d20\u7684\u96c6\u5408</p> </li> </ul> <p>\uf06e \u4e00\u4e2a\u5143\u7d20\u5728\u5e76\u96c6\u4e2d\u53ea\u51fa\u73b0\u4e00\u6b21   \uf06e R \u548c S \u5fc5\u987b\u540c\u7c7b\u578b\uff08\u5c5e\u6027\u96c6\u76f8\u540c\u3001\u6b21\u5e8f\u76f8\u540c\uff0c\u4f46\u5c5e\u6027\u540d   \u53ef\u4ee5\u4e0d\u540c\uff09</p> <ul> <li>\u96c6\u5408\u5dee\u8fd0\u7b97\uff1a</li> <li>\u7b1b\u5361\u5c14\u79ef\u8fd0\u7b97\uff1a</li> </ul> <p>\\Sigma</p>"},{"location":"basic/5.relation/#_11","title":"\u6570\u636e\u5e93\u5bf9\u8c61","text":"<p>\u6570\u636e\u5e93\u5bf9\u8c61\u662f\u6570\u636e\u5e93\u7684\u7ec4\u6210\u90e8\u5206\uff0c\u662f\u6307\u5728\u6570\u636e\u5e93\u4e2d\u53ef\u4ee5\u901a\u8fc7 SQL \u8fdb\u884c\u64cd\u4f5c\u548c\u4f7f\u7528\u7684\u5bf9\u8c61\u3002</p> <p>\u6570\u636e\u5e93\u4e2d\u7684\u57fa\u672c\u5bf9\u8c61\u662f\u8868\uff08TABLE\uff09\u3002\u4f46\u662f\u9664\u4e86\u8868\u4ee5\u5916\uff0c\u6570\u636e\u5e93\u4e2d\u8fd8\u6709\u5f88\u591a\u5176\u4ed6\u7684\u5bf9\u8c61\uff0c\u4f8b\u5982\u7d22\u5f15\uff08INDEX\uff09\u3001\u89c6\u56fe\uff08VIEW\uff09\u3001\u5b58\u50a8\u8fc7\u7a0b\u3001\u89e6\u53d1\u5668\uff08Trigger\uff09\u3001\u6e38\u6807\u3001\u51fd\u6570\uff0c\u7b49\u3002</p> <p>\u8fd9\u4e9b\u6570\u636e\u5e93\u5bf9\u8c61\u5bf9\u4e8e\u63d0\u9ad8\u6570\u636e\u67e5\u8be2\u7684\u6548\u7387\u3001\u63d0\u5347\u6570\u636e\u7684\u5b89\u5168\u6027\u4e0e\u5b8c\u6574\u6027\u4ee5\u53ca\u5b9e\u73b0\u6570\u636e\u64cd\u4f5c\u4ee3\u7801\u7684\u5171\u4eab\u6027\u548c\u6570\u636e\u64cd\u4f5c\u7684\u7075\u6d3b\u6027\u7b49\u65b9\u9762\u8d77\u5230\u4e86\u826f\u597d\u7684\u8f85\u52a9\u4f5c\u7528\u3002\u5728\u8fd9\u91cc\u5c06\u5bf9\u6570\u636e\u5e93\u4e2d\u7684\u90e8\u5206\u5bf9\u8c61\uff1a\u7d22\u5f15\u3001\u89c6\u56fe\u3001\u5b58\u50a8\u8fc7\u7a0b\u3001\u89e6\u53d1\u5668\u8fdb\u884c\u8be6\u7ec6\u4ecb\u7ecd\u3002</p> <p>\u8868</p> <p>\u5728\u5173\u7cfb\u6570\u636e\u5e93\u4e2d\uff0c\u8868\u4e5f\u88ab\u53eb\u505a\u5173\u7cfb\uff0c\u5b83\u662f\u4e00\u79cd\u884c\u5217\u5f62\u5f0f\u7684\u4e8c\u7ef4\u8868\u3002\u5176\u5b9e\u5c31\u662f\u4e00\u7cfb\u5217\u4e8c\u7ef4\u6570\u7ec4\u7684\u96c6\u5408\uff0c\u7528\u4e8e\u5b58\u50a8\u5404\u79cd\u4fe1\u606f\u3002</p> <p>\u89c6\u56fe</p> <p>SQL \u5141\u8bb8\u901a\u8fc7\u67e5\u8be2\u6765\u5b9a\u4e49\u201c\u865a\u5173\u7cfb\u201d\u3002\u5b83\u5728\u6982\u5ff5\u4e0a\u5305\u542b\u67e5\u8be2\u7684\u7ed3\u679c\uff0c \u89c6\u56fe\u662f\u4e00\u79cd\u865a\u5173\u7cfb\uff0c\u5b83\u5728\u6982\u5ff5\u4e0a\u5305\u542b\u67e5\u8be2\u7684\u7ed3\u679c\uff0c\u7c7b\u4f3c\u4e00\u79cd\u5b50\u67e5\u8be2\u7684\u4e2d\u95f4\u8868\u6216\u8005\u67d0\u4e2a\u8868\u7684\u5b50\u8868\uff0c\u5b83\u5728\u9700\u8981\u7684\u65f6\u5019\u624d\u4f1a\u88ab\u8ba1\u7b97\u3002\u865a\u5173\u7cfb\u5e76\u4e0d\u9884\u5148\u8ba1\u7b97\u5e76\u5b58\u50a8\uff0c\u800c\u662f\u8bf7\u6c42\u865a\u5173\u7cfb\u7684\u65f6\u5019\u53bb\u6267\u884c\u67e5\u8be2\u8ba1\u7b97\u51fa\u6765\u3002</p> <p>\u6570\u636e\u5e93\u4e2d\u4ec5\u5b58\u653e\u4e86\u89c6\u56fe\u7684\u5b9a\u4e49\uff0c\u4e0d\u5b58\u653e\u89c6\u56fe\u5bf9\u5e94\u7684\u6570\u636e\u3002\u4e5f\u5c31\u662f\u8bf4\u89c6\u56fe\u5e76\u4e0d\u5b58\u653e\u6570\u636e\u3002\u901a\u8fc7\u89c6\u56fe\u770b\u5230\u7684\u6570\u636e\u5b9e\u9645\u4e0a\u662f\u6267\u884c\u89c6\u56fe\u5b9a\u4e49\u65f6\u7684\u6570\u636e\u67e5\u8be2\u547d\u4ee4\u800c\u67e5\u8be2\u51fa\u7684\u5b58\u653e\u5728\u57fa\u672c\u8868\u4e2d\u7684\u6570\u636e\u3002</p> <p>\u540c\u4e00\u5f20\u57fa\u672c\u8868\uff0c\u6839\u636e\u4e0d\u540c\u7528\u6237\u7684\u9700\u6c42\uff0c\u53ef\u4ee5\u521b\u5efa\u4e0d\u540c\u7684\u89c6\u56fe\u3002</p> <p>\u89c6\u56fe\u7684\u4e3b\u8981\u529f\u80fd\uff1a</p> <p>\uff081\uff09\u89c6\u56fe\u80fd\u591f\u7b80\u5316\u7528\u6237\u7684\u64cd\u4f5c\u3002\u5bf9\u4e8e\u57fa\u672c\u8868\u4e2d\u7684\u4e00\u4e9b\u9700\u8981\u9891\u7e41\u64cd\u4f5c\u7684\u6570\u636e\uff0c\u901a\u8fc7\u5b9a\u4e49\u89c6\u56fe\uff0c\u53ef\u4ee5\u5b9e\u73b0\u7b80\u5355\u5730\u6309\u89c6\u56fe\u540d\u5c31\u53ef\u4ee5\u5bf9\u5176\u8fdb\u884c\u8bbf\u95ee\uff0c\u800c\u4e0d\u9700\u8981\u518d\u5199\u4f17\u591a\u67e5\u8be2\u547d\u4ee4\u3002</p> <p>\uff082\uff09\u89c6\u56fe\u80fd\u591f\u4f7f\u7528\u6237\u4ece\u591a\u79cd\u89d2\u5ea6\u770b\u5f85\u540c\u4e00\u6570\u636e\u3002\u56e0\u4e3a\u4e0d\u540c\u7528\u6237\u4f7f\u7528\u540c\u4e00\u6570\u636e\u5e93\u65f6\uff0c\u6240\u5b9a\u4e49\u7684\u89c6\u56fe\u4e0d\u540c\uff0c\u770b\u5230\u7684\u6570\u636e\u4e5f\u4e0d\u540c\u3002</p> <p>\uff083\uff09\u89c6\u56fe\u80fd\u591f\u5b9e\u73b0\u6570\u636e\u7684\u903b\u8f91\u72ec\u7acb\u6027\u3002\u6570\u636e\u7684\u903b\u8f91\u72ec\u7acb\u6027\u662f\u6307\u5f53\u6570\u636e\u5e93\u7684\u903b\u8f91\u7ed3\u6784\u53d1\u751f\u6539\u53d8\u65f6\uff08\u6bd4\u5982\u7ed9\u57fa\u672c\u8868\u6dfb\u52a0\u4e86\u65b0\u7684\u5b57\u6bb5\uff09\uff0c\u7528\u6237\u548c\u5e94\u7528\u7a0b\u5e8f\u53ef\u4ee5\u4e0d\u53d7\u5f71\u54cd\u5730\u7ee7\u7eed\u4f7f\u7528\u6570\u636e\u3002</p> <p>\uff084\uff09\u89c6\u56fe\u80fd\u591f\u5bf9\u673a\u5bc6\u6570\u636e\u63d0\u4f9b\u5b89\u5168\u4fdd\u62a4\u3002\u5728\u7528\u6237\u67e5\u8be2\u6570\u636e\u5e93\u7684\u6570\u636e\u65f6\uff0c\u53ea\u63d0\u4f9b\u5fc5\u8981\u7684\u6570\u636e\u89c6\u56fe\uff0c\u9632\u6b62\u672a\u7ecf\u8bb8\u53ef\u7684\u7528\u6237\u8bbf\u95ee\u654f\u611f\u6570\u636e\u3002</p> <pre><code>-- \u89c6\u56fe\u7684\u5b9a\u4e49\uff0c\u5176\u4e2d query expression \u662f\u4efb\u610f\u5408\u6cd5\u7684\u67e5\u8be2\u8868\u8fbe\u5f0f\ncreate view view_name(column1,column2 ...) as &lt;query expression&gt;\n\n\n-- \u5217\u51faPhysics\u7cfb\u57282009\u5e74\u79cb\u5b63\u5b66\u671f\u5f00\u8bbe\u7684\u6240\u6709\u8bfe\u7a0b\u6bb5\ncreate view physics_fall_2009 as\n    select course, course_id, sec_id, building, room_number\n        from course, section\n    where course.course_id = section.course_id\n        and course.dept_name = 'Physics'\n        and course.semester = 'Fall'\n        and course.year = '2009'\n\n\n\n-- \u7269\u5316\u89c6\u56fe\uff08Materialization VIEW\uff09\n-- \u7531\u4e8e\u89c6\u56fe\u4e2d\u7684\u6570\u636e\u662f\u4ece\u8868\u4e2d\u67e5\u8be2\u51fa\u6765\u7684\uff0c\u6240\u4ee5\u4e00\u65e6\u8868\u4e2d\u7684\u6570\u636e\u53d1\u751f\u6539\u53d8\uff0c\u89c6\u56fe\u5c31\u4f1a\u8fc7\u671f\uff0c\u6240\u4ee5\u89c6\u56fe\u4e2d\u7684\u6570\u636e\u4e5f\u8981\u53d1\u751f\u6539\u53d8\u3002\n-- \u8fd9\u6837\u7684\u89c6\u56fe\u79f0\u4e3a\u7269\u5316\u89c6\u56fe\uff08materialized view\uff09\n\n-- \u7269\u5316\u89c6\u56fe\u7ef4\u62a4(materialized view maintenance)\n-- \u4fdd\u6301\u89c6\u56fe\u7269\u5316\u4e00\u76f4\u5728\u6700\u65b0\u72b6\u6001\u7684\u8fc7\u7a0b\u79f0\u4e3a\u7269\u5316\u89c6\u56fe\u7ef4\u62a4\uff0c\u7269\u5316\u89c6\u56fe\u7ef4\u62a4\u7684\u7b56\u7565\u5927\u6982\u6709\u51e0\u79cd\uff1a\n--  1. \u6bcf\u5f53\u6570\u636e\u53d8\u66f4\u65f6\u5c31\u8fdb\u884c\u89c6\u56fe\u7269\u5316\n--  2. \u5468\u671f\u6027\u7684\u8fdb\u884c\u89c6\u56fe\u7269\u5316\n--  3. \u5f53\u9700\u8981\u8bbf\u95ee\u89c6\u56fe\u65f6\u624d\u8fdb\u884c\u89c6\u56fe\u7269\u5316\n\n\n-- \u5f53\u5b9a\u4e49\u89c6\u56fe\u7684\u65f6\u5019\uff0c\u4e00\u822c\u6765\u8bf4\u6570\u636e\u5e93\u53ea\u4f1a\u5b58\u50a8\u8be5\u89c6\u56fe\u5b9a\u4e49\u7684\u67e5\u8be2\u8bed\u53e5\u3002\u4e0e\u6b64\u76f8\u53cd\uff0c\u7269\u5316\u89c6\u56fe\u662f\u4e00\u4e2a\u5176\u5185\u5bb9\u5df2\u8ba1\u7b97\u5e76\u5b58\u50a8\u7684\u89c6\u56fe\u3002\n-- \u7269\u5316\u89c6\u56fe\u5e26\u6765\u4e86\u5197\u4f59\u6570\u636e\uff0c\u56e0\u4e3a\u5176\u5185\u5bb9\u53ef\u4ee5\u901a\u8fc7\u89c6\u56fe\u5b9a\u4e49\u548c\u8868\u4e2d\u7684\u6570\u636e\u6765\u67e5\u8be2\u5f97\u5230\u3002\n\n-- MySQL\u7684\u89c6\u56fe\u4e0d\u662f\u4e00\u79cd\u7269\u5316\u89c6\u56fe\uff0c\u5b83\u76f8\u5f53\u4e8e\u4e00\u4e2a\u865a\u62df\u8868\uff0c\u5b83\u672c\u8eab\u5e76\u4e0d\u5b58\u50a8\u6570\u636e\uff0c\u5b83\u662f\u4f5c\u4e3a\u4e00\u4e2aselect\u8bed\u53e5\u4fdd\u5b58\u5728\u6570\u636e\u5b57\u5178\u4e2d\u7684\u3002\n-- \u901a\u8fc7\u89c6\u56fe\uff0c\u53ef\u4ee5\u5c55\u73b0\u57fa\u8868\u7684\u90e8\u5206\u6570\u636e\uff1b\u89c6\u56fe\u6570\u636e\u6765\u81ea\u5b9a\u4e49\u89c6\u56fe\u7684\u67e5\u8be2\u4e2d\u4f7f\u7528\u7684\u8868\uff0c\u4f7f\u7528\u89c6\u56fe\u52a8\u6001\u751f\u6210\u3002\n-- \u8fd9\u5e26\u6765\u7684\u95ee\u9898\u662f\u4f7f\u7528\u89c6\u56fe\u5e76\u4e0d\u80fd\u5c06\u5e38\u7528\u6570\u636e\u5206\u79bb\u51fa\u6765\uff0c\u4f18\u5316\u67e5\u8be2\u901f\u5ea6\u3002\n-- \u4e14\u64cd\u4f5c\u89c6\u56fe\u7684\u5f88\u591a\u547d\u4ee4\u90fd\u4e0e\u666e\u901a\u8868\u4e00\u6837\uff0c\u8fd9\u4f1a\u5bfc\u81f4\u5728\u4e1a\u52a1\u4ee3\u7801\u4e2d\u65e0\u6cd5\u901a\u8fc7sql\u533a\u5206\u8868\u548c\u89c6\u56fe\uff0c\u4f7f\u4ee3\u7801\u53d8\u5f97\u590d\u6742\u3002\n\n\n-- \u5b9e\u73b0\u89c6\u56fe\u7684\u65b9\u5f0f\u6709\u4e24\u79cd\uff0c\u5206\u522b\u4e3a\u5408\u5e76\u7b97\u6cd5\u548c\u4e34\u65f6\u8868\u7b97\u6cd5\n\n-- \u5408\u5e76\u7b97\u6cd5\u662f\u6307\u67e5\u8be2\u89c6\u56fe\u65f6\u5c06\u89c6\u56fe\u5b9a\u4e49\u7684sql\u5408\u5e76\u5230\u67e5\u8be2sql\u4e2d\uff0c\u6bd4\u5982create view v1 as select * from user where sex=m;\n-- \u5f53\u6211\u4eec\u8981\u67e5\u8be2\u89c6\u56fe\u65f6\uff0cmysql\u4f1a\u5c06select id,name from v1;\u5408\u5e76\u6210select id,name from user where sex=m\u2026\u2026;\n\n-- \u4e34\u65f6\u8868\u7b97\u6cd5\u662f\u5148\u5c06\u89c6\u56fe\u67e5\u51fa\u6765\u7684\u6570\u636e\u4fdd\u5b58\u5230\u4e00\u4e2a\u4e34\u65f6\u8868\u4e2d\uff0c\u67e5\u8be2\u7684\u65f6\u5019\u67e5\u8fd9\u4e2a\u4e34\u65f6\u8868\u3002\u4e0d\u7ba1\u662f\u5408\u5e76\u7b97\u6cd5\u548c\u4e34\u65f6\u8868\u7b97\u6cd5\u90fd\u4f1a\u5e26\u6765\u989d\u5916\u7684\u5f00\u9500\u3002\n-- \u4e14\u5982\u679c\u4f7f\u7528\u4e34\u65f6\u8868\u540e\u4f1a\u4f7fmysql\u7684\u4f18\u5316\u53d8\u5f97\u5f88\u56f0\u96be\uff0c\u6bd4\u5982\u7d22\u5f15\u3002\n-- \u5f88\u591a\u4eba\u672c\u672b\u5012\u7f6e\uff0c\u590d\u6742\u7684SQL\u8bed\u53e5\u90fd\u662f\u7531\u4e8e\u6570\u636e\u5e93\u8868\u7ed3\u6784\u8bbe\u8ba1\u4e0d\u5408\u7406\u9020\u6210\u7684\uff0c\u4e0d\u53bb\u53cd\u601d\u4e3a\u4ec0\u4e48\u8fd9\u4e48\u8bbe\u8ba1\u3002\n</code></pre>"},{"location":"basic/6.sql_practice/","title":"6. SQL\u9898\u76ee\u7ec3\u4e60","text":""},{"location":"basic/6.sql_practice/#sql","title":"\u4e3a\u4ec0\u4e48\u4f60\u5fc5\u987b\u5199\u597dSQL?","text":"<p>\u5728\u6211\u4eec\u5de5\u4f5c\u4e2d\uff0c\u65e0\u8bba\u662f\u4e1a\u52a1\u4eba\u5458\uff0c\u8fd8\u662f\u5f00\u53d1\u4eba\u5458\uff0c\u6216\u662f\u7ba1\u7406\u8005\uff0c\u5982\u4eca\uff0c\u51e0\u4e4e\u6bcf\u4e2a\u4eba\u90fd\u5fc5\u987b\u4f7f\u7528\u67d0\u79cd\u5f62\u5f0f\u7684\u6570\u636e\uff0c\u56e0\u4e3a\u6570\u636e\u6bd5\u7adf\u662f\u4fe1\u606f\u7684\u5448\u73b0\uff0c\u8981\u83b7\u53d6\u4fe1\u606f\u5fc5\u987b\u5f97\u4f9d\u8d56\u6570\u636e\uff0c\u800c\u8fd9\u4e9b\u6570\u636e\u901a\u5e38\u662f\u4ee5\u7535\u5b50\u8868\u683c\u6216\u662f\u6570\u636e\u5e93\u7684\u5f62\u5f0f\u5b58\u653e\u3002\u00a0\u00a0 \u00a0 \u00a0 \u00a0</p> <p>\u73b0\u72b61\uff1a\u4ece\u4e1a\u52a1\u4eba\u5458\u89c6\u89d2\u6765\u770b\uff0c\u5728\u4f01\u4e1a\u91cc\u9762\uff0c\u6211\u4eec\u5f53\u524d\u7684\u73b0\u72b6\u5c31\u662f\uff0c\u4e1a\u52a1\u4eba\u5458\u60f3\u8981\u770b\u54ea\u4e9b\u6570\u636e\u5f97\u4f9d\u8d56\u5f00\u53d1\u4eba\u5458\u4ece\u6570\u636e\u5e93\u4e2d\u63d0\u53d6\u6570\u636e\uff0c\u800c\u8fd9\u4e00\u8fc7\u7a0b\u9700\u8981\u6f2b\u957f\u7684\u7b49\u5f85\uff0c\u5f71\u54cd\u5de5\u4f5c\u6548\u7387\uff0c\u5982\u679c\u6211\u4eec\u61c2\u7b80\u5355\u7684SQL\uff0c\u81ea\u5df1\u80fd\u4ece\u6570\u636e\u5e93\u63d0\u53d6\u6570\u636e\uff0c\u90a3\u4e48\u5de5\u4f5c\u6548\u7387\u5c31\u4f1a\u6709\u5927\u7684\u63d0\u5347\uff0c\u5728\u540c\u6837\u7684\u5c97\u4f4d\u4e2d\u80fd\u591f\u8131\u9896\u800c\u51fa\u00a0 \u00a0 \u00a0 \u00a0</p> <p>\u73b0\u72b62\uff1a\u4ece\u6570\u636e\u5206\u6790\u5e08\u89c6\u89d2\u6765\u770b\uff0c\u4e60SQL\u51e0\u4e4e\u6210\u4e3a\u6570\u5206\u5fc5\u5907\u7684\u6280\u80fd\uff0c\u5982\u679c\u8fd9\u4e2a\u6280\u80fd\u4e0d\u8fbe\u6807\uff0c\u57fa\u672c\u4e0a\u5f88\u96be\u901a\u8fc7\u9762\u8bd5\uff0c\u800c\u4e14\u8fd1\u51e0\u5e74SQL\u9762\u8bd5\u7684\u9898\u76ee\u4e5f\u8d8a\u6765\u8d8a\u96be\uff0c\u8981\u60f3\u901a\u8fc7\u9762\u8bd5\u51e0\u4e4e\u6210\u4e3a\u6570\u636e\u5206\u6790\u5e08\u5fc5\u987b\u4e14\u6df1\u5ea6\u638c\u63e1\u7684\u6280\u80fd\u3002\u00a0 \u00a0\u00a0 \u00a0 </p> <p>\u73b0\u72b63\uff1a\u4ece\u6570\u636e\u5f00\u53d1\u8005\u89d2\u5ea6\u6765\u770b\uff0c\u5bf9\u4e8e\u6570\u636e\u5f00\u53d1\u8005\u6765\u8bb2\uff0c\u5178\u578b\u7684\u50cf\u6570\u4ed3\u540c\u5b66\uff0c\u57fa\u672c\u5929\u5929\u4e0eSQL\u6253\u4ea4\u9053\uff0c\u8fd9\u91cc\u5176\u5b9e\u4e0e\u6570\u636e\u5206\u6790\u5c97\u4f4d\u6709\u4ea4\u53c9\u7684\u90e8\u5206\uff0c\u5bf9\u4e8eSQL\u7684\u638c\u63e1\u4e0d\u8a00\u800c\u55bb\u3002</p> <p>SQL\u8bed\u6cd5\u5f88\u7b80\u5355\uff0c\u4f46\u51e0\u4e4e\u6ca1\u51e0\u4e2a\u4eba\u5199\u7684\u5f88\u597d</p> <p>\u8fd9\u91cc\u4e0d\u5f97\u4e0d\u63d0\u56fd\u5185\u8bed\u8a00\u7684\u9119\u89c6\u94fe\uff0c\u5728\u5927\u591a\u6570\u7a0b\u5e8f\u5458\u773c\u91cc\uff0c\u4ed6\u4eec\u8ba4\u4e3aSQL\u79f0\u4e0d\u4e0a\u4e00\u95e8\u8bed\u8a00\uff0c\u56e0\u4e3a\u95e8\u69db\u592a\u4f4e\uff0c\u8bed\u6cd5\u5f88\u7b80\u5355\u5c31\u51e0\u4e2a\u547d\u4ee4\u5c31\u80fd\u641e\u5b9a\uff0c\u4e0d\u9700\u8981\u4e13\u95e8\u5b66\uff0c\u6216\u662f\u6210\u4e3a\u4e00\u79cd\u5c97\u4f4d\u3002\u6709\u8fd9\u79cd\u8ba4\u8bc6\u7684\u5f80\u5f80\u90fd\u4e0d\u662f\u4ece\u4e8b\u6570\u636e\u76f8\u5173\u7684\u4eba\u5458\uff0c\u4ed6\u4eec\u5b9e\u9645\u5de5\u4f5c\u4e2d\u4f7f\u7528SQL\u8bed\u8a00\u4e5f\u5f88\u7b80\u5355\uff0c\u5c31\u662f\u7b80\u5355\u7684\u589e\u5220\u6539\u67e5\uff0c\u751a\u81f3\u6709\u65f6\u5019\u9762\u8bd5\u95ee\u4ed6\u4eec\u5206\u7ec4TOPN\u7684\u95ee\u9898\u90fd\u4f1a\u96be\u5012\u4e00\u5927\u7247\uff0c\u800c\u5bf9\u4ece\u4e8b\u6570\u636e\u5f00\u53d1\u6216\u6570\u636e\u5206\u6790\u5e08\u6765\u8bb2\uff0c\u5206\u7ec4TOPN\u95ee\u9898\u5374\u5f88\u7b80\u5355\uff0c\u8fd9\u5c31\u662f\u5e73\u65f6\u5de5\u4f5c\u65b9\u5411\u7684\u4e0d\u540c\u5e26\u6765\u7684\u8bef\u533a\u3002\u4e0d\u540c\u7684\u5c97\u4f4d\u6709\u4e0d\u540c\u7684\u5de5\u4f5c\u65b9\u5411\u548c\u91cd\u70b9\uff0c\u6211\u4eec\u4e0d\u80fd\u4ee5\u8bed\u8a00\u7b80\u5355\u7a0b\u5ea6\u6765\u533a\u5206\u5c97\u4f4d\u7684\u4f18\u52a3\uff0c\u6216\u6709\u9119\u89c6\u5fc3\u91cc\uff0c\u56e0\u4e3a\u6bd5\u7adf\u8bed\u8a00\u53ea\u662f\u4e00\u79cd\u5de5\u5177\uff0c\u800c\u7a0b\u5e8f\u5458\u6700\u91cd\u8981\u7684\u8fd8\u662f\u903b\u8f91\u601d\u7ef4\u80fd\u529b\uff0c\u5982\u679c\u6211\u62ff\u8bed\u6cd5\u6bd4\u8f83\u7b80\u5355\u7684\u8bed\u8a00\u6bd4\u5982SQL\u53bb\u5904\u7406\u590d\u6742\u7684\u4e1a\u52a1\u903b\u8f91\uff0c\u5176\u5b9e\u672a\u5fc5\u5c31\u662f\u4e00\u4ef6\u7b80\u5355\u7684\u4e8b\u60c5\uff0c\u4ed6\u80cc\u540e\u9700\u8981\u7684\u662f\u6570\u636e\u5904\u7406\u7684\u903b\u8f91\u601d\u7ef4\u53ca\u4e1a\u52a1\u77e5\u8bc6\uff0c\u5176\u5b9e\u6b64\u65f6SQL\u4ec5\u4ec5\u53ea\u662f\u4e2a\u5de5\u5177\u3002</p> <p>\u5728\u56fd\u5916Data Science\u9762\u8bd5\u4e2d\uff0c\u5bf9SQL\u7684\u8003\u5bdf\uff0c\u5176\u5b9e\u8981\u6c42\u5f88\u9ad8\uff0c\u5f88\u591a\u516c\u53f8\u8981\u6c42\u5fc5\u987b\u719f\u7ec3\u638c\u63e1SQL\u76f8\u5173\u57fa\u7840\u8bed\u6cd5\uff0c\u5e76\u5177\u5907\u6781\u5f3a\u7684\u6570\u636e\u5904\u7406\u601d\u7ef4\u903b\u8f91\uff0c\u5f88\u591a\u9762\u8bd5\u8005\u4e5f\u5728SQL\u8003\u5bdf\u73af\u8282\u683d\u4e86\u8ddf\u5934\u3002\u5728\u4f17\u591a\u6c42\u804c\u8005\u4e2d\uff0c\u6211\u4eec\u5206\u6790\u5176\u539f\u56e0\uff0c\u8fd9\u4e9b\u6c42\u804c\u8005\u5e76\u4e0d\u662f\u4e0d\u61c2SQL\u8bed\u6cd5\uff0c\u800c\u662f\u7f3a\u4e4f\u6570\u636e\u5206\u6790\u7684\u601d\u7ef4\u80fd\u529b\uff0c\u7f3a\u4e4f\u5fc5\u8981\u7684\u5b9e\u6218\u6280\u5de7\u3002\u751a\u81f3\u6211\u4eec\u7ecf\u5e38\u8ddf\u5f88\u591a\u7ecf\u9a8c\u4e30\u5bcc\u6570\u4ed3\u5f00\u53d1\u540c\u5b66\u53bb\u804a\uff0c\u4ed6\u4eec\u5728\u7528SQL\u89e3\u51b3\u5b9e\u9645\u4e1a\u52a1\u95ee\u9898\u65f6\uff0c\u90fd\u662f\u8fd9\u6837\u7684\u5904\u7406\u903b\u8f91\uff0c\u9047\u5230\u8981\u5206\u6790\u7684\u6307\u6807\uff0c\u5148\u5206\u6790\u6307\u6807\u7684\u542b\u4e49\uff0c\u641e\u6e05\u695a\u903b\u8f91\u53ca\u9700\u8981\u53d6\u6570\u7684\u6e90\u8868\u540e\uff0c\u5c31\u5f00\u59cb\u50cf\u5957\u516c\u5f0f\u822c\u627e\u5404\u79cd\u5185\u7f6e\u7684\u51fd\u6570\u53bb\u5957\uff0c\u770b\u770b\u54ea\u79cd\u51fd\u6570\u80fd\u5e2e\u6211\u89e3\u51b3\u4e1a\u52a1\u95ee\u9898\uff0c\u50cf\u6781\u4e86\u67d0\u4e9b\u8bed\u8a00\u5f00\u53d1\u8005\u53bb\u5bfb\u627eAPI\u7684\u8fc7\u7a0b\u3002\u4f46\u4f5c\u4e3a\u6210\u719f\u7684\u5f00\u53d1\u8005\u6765\u8bf4\uff0c\u6211\u4eec\u5728\u5904\u7406\u6570\u636e\u95ee\u9898\u6216\u5199\u4ee3\u7801\u65f6\u662f\u8fd9\u6837\u5417\uff1f\u8fd9\u91cc\u6211\u4eec\u5148\u6253\u4e2a\u95ee\u53f7\uff0c\u7559\u7ed9\u8bfb\u8005\u81ea\u5df1\u4f53\u4f1a\u3002\u5018\u82e5\u6211\u4eec\u7684\u4e1a\u52a1\u903b\u8f91\u7a0d\u5fae\u590d\u6742\u4e9b\uff0c\u5957\u7528\u51fd\u6570\u6216API\u5957\u4e0d\u52a8\u4e86\u600e\u4e48\u529e\uff1f\u4e1a\u52a1\u4e0d\u505a\u4e86\u5417\uff1f\u53bb\u8ddf\u4e1a\u52a1\u6495\u903c\u5417\uff1f\u54c8\u54c8\uff0c\u6211\u60f3\u529e\u6cd5\u603b\u6bd4\u56f0\u96be\u591a\u3002\u8fd9\u4e5f\u5c31\u662f\u6211\u4eec\u6240\u8bf4\u7684\u5de5\u4f5c\u4e86\u597d\u591a\u5e74\uff0c\u4f60\u53d1\u73b0\u6ca1\u51e0\u4e2a\u4eba\u4f1a\u628aSQL\u5199\u7684\u5f88\u597d\uff0c\u5b9e\u9645\u4e0a\u5462\uff1f\u9047\u5230\u590d\u6742\u7684\u4e1a\u52a1\u903b\u8f91\u6216\u9762\u8bd5\u9898\u4e5f\u4f1a\u51c9\u51c9\u3002\u3002\u3002\u3002\u3002\u3002\u5f53\u7136\u5b9e\u5728\u4e0d\u884c\u4e86\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u6362\u8bed\u8a00\u5b9e\u73b0\u561b\uff0c\u603b\u4e4b\u529e\u6cd5\u603b\u6bd4\u56f0\u96be\u591a\u3002\u6700\u540e\uff0c\u5bf9\u4e8e\u4e00\u4e2a\u6210\u719f\u7684SQLer\uff0c\u4e0d\u4ec5\u4ec5\u53ea\u662f\u505c\u7559\u5728\u5b9e\u73b0\u4e1a\u52a1\u903b\u8f91\u7684\u89d2\u5ea6\uff0c\u66f4\u91cd\u8981\u7684\u4e00\u70b9\u8fd8\u8981\u4ece\u5e95\u5c42\u6267\u884c\u5f15\u64ce\u7684\u89d2\u5ea6\u53bb\u7406\u89e3SQL\u6267\u884c\u8fc7\u7a0b\uff0c\u770b\u61c2\u6267\u884c\u8ba1\u5212\uff0c\u5e76\u80fd\u5199\u51fa\u6027\u80fd\u8f83\u9ad8\u7684SQL\u3002 \u00a0</p>"},{"location":"basic/6.sql_practice/#sql_1","title":"SQL\u9898\u76ee\u7ec3\u4e60","text":"<pre><code>--\u521b\u5efa\u8868student\ncreate table student(\n    name varchar(10),\n    kecheng varchar(10),\n    fengshu int\n)\n\n--\u63d2\u5165\u6570\u636e\u5230\u8868student\u4e2d\ninsert into student values('\u5f20\u4e09','\u8bed\u6587',81);\ninsert into student values('\u5f20\u4e09','\u6570\u5b66',75);\ninsert into student values('\u674e\u56db','\u8bed\u6587',76);\ninsert into student values('\u674e\u56db','\u6570\u5b66',90);\ninsert into student values('\u738b\u4e94','\u8bed\u6587',81);\ninsert into student values('\u738b\u4e94','\u6570\u5b66',100);\ninsert into student values('\u738b\u4e94','\u82f1\u8bed',90);\n\n\n-- \u67e5\u8be2\u51fa\u6bcf\u95e8\u8bfe\u90fd\u5927\u4e8e80\u5206\u7684\u5b66\u751f\u59d3\u540d\n\n-- \u56e0\u4e3a\u4e00\u4e2a\u5b66\u751f\u6709\u591a\u95e8\u8bfe\u7a0b\uff0c\u53ef\u80fd\u6240\u6709\u8bfe\u7a0b\u90fd\u5927\u4e8e80\u5206\uff0c\u53ef\u80fd\u6709\u4e9b\u8bfe\u7a0b\u5927\u4e8e80\u5206\uff0c\u53e6\u5916\u4e00\u4e9b\u8bfe\u7a0b\u5c11\u4e8e80\u5206\uff0c\u4e5f\u53ef\u80fd\u6240\u6709\u8bfe\u7a0b\u90fd\u5c0f\u4e8e80\u5206\u3002\n-- \u90a3\u4e48\u6211\u4eec\u8981\u67e5\u627e\u51fa\u6240\u6709\u5927\u4e8e80\u5206\u7684\u8bfe\u7a0b\u7684\u5b66\u751f\u59d3\u540d\uff0c\u6211\u4eec\u53ef\u4ee5\u53cd\u5411\u601d\u8003\uff0c\u627e\u51fa\u8bfe\u7a0b\u5c0f\u4e8e80\u5206(\u53ef\u4ee5\u627e\u51fa\u6709\u4e00\u4e9b\u8bfe\u7a0b\u5c0f\u4e8e80\u5206\uff0c\u6240\u6709\u8bfe\u7a0b\u5c0f\u4e8e80\u5206\u7684\u5b66\u751f)\u7684\u5b66\u751f\u59d3\u540d\u518d\u6392\u9664\u8fd9\u4e9b\u5b66\u751f\u5269\u4f59\u7684\u5c31\u662f\u6240\u6709\u8bfe\u7a0b\u90fd\u5927\u4e8e80\u5206\u7684\u5b66\u751f\u59d3\u540d\u4e86\u3002 \n\nselect distinct name from student where name not in (select distinct name from student where fengshu&lt;=80);\n\n/* not in */ \nSELECT DISTINCT A.name FROM student A WHERE A.name not in(SELECT Distinct S.name FROM student S WHERE S.score &lt;80);\n\n/* not exists */ \nSELECT DISTINCT A.name From student A  where not exists (SELECT 1 From student S Where  S.score &lt;80 AND S.name =A.name);\n</code></pre>"},{"location":"basic/6.sql_practice/#sql_2","title":"SQL\u6848\u4f8b\u9898","text":"<pre><code>-- \u5efa\u5e93\nCREATE DATABASE `emp`;\n\n-- \u6253\u5f00\u5e93\nUSE emp;\n\n-- \u90e8\u95e8\u4fe1\u606f\u8868(\u90e8\u95e8\u7f16\u53f7\uff0c\u90e8\u95e8\u540d\u79f0\uff0c\u4f4d\u7f6e)\nCREATE TABLE `dept`( \n    `deptno` INT(2) NOT NULL, \n    `dname` VARCHAR(14), \n    `loc` VARCHAR(13), \n    CONSTRAINT pk_dept PRIMARY KEY(deptno) \n    ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;\n\n-- \u5458\u5de5\u4fe1\u606f\u8868\uff08\u5458\u5de5\u7f16\u53f7\uff0c\u5458\u5de5\u59d3\u540d\uff0c\u5de5\u4f5c\u804c\u4f4d\uff0c\u4e0a\u7ea7\u9886\u5bfc\uff0c\u5165\u804c\u65e5\u671f\uff0c\u6708\u85aa\uff0c\u6d25\u8d34\uff0c\u90e8\u95e8\u7f16\u53f7\uff09\nCREATE TABLE `emp` ( \n    `empno` int(4) NOT NULL PRIMARY KEY, \n    `ename` VARCHAR(10), \n    `job` VARCHAR(9), \n    `mgr` int(4), \n    `hiredate` DATE, \n    `sal` float(7,2), \n    `comm` float(7,2), \n    `deptno` int(2), \n    CONSTRAINT fk_deptno FOREIGN KEY(deptno) REFERENCES dept(deptno) \n    ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;\n\n-- \u85aa\u6c34\u7b49\u7ea7\u4fe1\u606f\u8868\uff08\u7b49\u7ea7\uff0c\u6700\u4f4e\u85aa\u6c34\uff0c\u6700\u9ad8\u85aa\u6c34\uff09\nCREATE TABLE `salgrade` ( \n    `grade` int, \n    `losal` int, \n    `hisal` int \n    ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;\n\n\n-- \u6570\u636e\nINSERT INTO dept VALUES (10,'ACCOUNTING','NEW YORK'); \nINSERT INTO dept VALUES (20,'RESEARCH','DALLAS');\nINSERT INTO dept VALUES (30,'SALES','CHICAGO'); \nINSERT INTO dept VALUES (40,'OPERATIONS','BOSTON');\nINSERT INTO emp VALUES (7369,'SMITH','CLERK',7902,'1980-12-17',800,NULL,20); \nINSERT INTO emp VALUES (7499,'ALLEN','SALESMAN',7698,'1981-02-20',1600,300,30); \nINSERT INTO emp VALUES (7521,'WARD','SALESMAN',7698,'1981-02-22',1250,500,30); \nINSERT INTO emp VALUES (7566,'JONES','MANAGER',7839,'1981-04-02',2975,NULL,20);\nINSERT INTO emp VALUES (7654,'MARTIN','SALESMAN',7698,'1981-09-28',1250,1400,30); \nINSERT INTO emp VALUES (7698,'BLAKE','MANAGER',7839,'1981-05-01',2850,NULL,30); \nINSERT INTO emp VALUES (7782,'CLARK','MANAGER',7839,'1981-06-09',2450,NULL,10); \nINSERT INTO emp VALUES (7788,'SCOTT','ANALYST',7566,'1987-07-13',3000,NULL,20); \nINSERT INTO emp VALUES (7839,'KING','PRESIDENT',NULL,'1981-11-07',5000,NULL,10); \nINSERT INTO emp VALUES(7844,'TURNER','SALESMAN',7698,'1981-09-08',1500,0,30); \nINSERT INTO emp VALUES (7876,'ADAMS','CLERK',7788,'1987-07-13',1100,NULL,20); \nINSERT INTO emp VALUES (7900,'JAMES','CLERK',7698,'1981-12-03',950,NULL,30); \nINSERT INTO emp VALUES (7902,'FORD','ANALYST',7566,'1981-12-03',3000,NULL,20); \nINSERT INTO emp VALUES (7934,'MILLER','CLERK',7782,'1982-01-23',1300,NULL,10);\nINSERT INTO salgrade VALUES (1,700,1200); \nINSERT INTO salgrade VALUES (2,1201,1400); \nINSERT INTO salgrade VALUES (3,1401,2000); \nINSERT INTO salgrade VALUES (4,2001,3000); \nINSERT INTO salgrade VALUES (5,3001,9999);\n</code></pre> <pre><code>-- 1. \u5217\u51fa\u4e0e\"SCOTT\"\u4ece\u4e8b\u76f8\u540c\u5de5\u4f5c\u7684\u6240\u6709\u5458\u5de5\u53ca\u90e8\u95e8\u540d\u79f0\u3002\n\n-- \u83b7\u53d6SCOTT\u7684\u5de5\u4f5c  \nSELECT job FROM emp WHERE ename='SCOTT'\n\n-- \u5173\u8054\u90e8\u95e8\u8868\uff0c\u83b7\u53d6\u90e8\u95e8\u540d\u79f0\uff0c\u67e5\u51fa\uff08\u5458\u5de5\uff0c\u90e8\u95e8\uff09    \nSELECT e.ename, d.dname FROM emp e, dept d WHERE e.job =( SELECT job FROM emp WHERE ename = 'SCOTT' ) AND e.ename&lt;&gt;'SCOTT' AND e.deptno=d.deptno\n\n\n-- 2. \u5217\u51fa\u516c\u53f8\u5404\u4e2a\u5de5\u8d44\u7b49\u7ea7\u96c7\u5458\u7684\u6570\u91cf\u3001\u5e73\u5747\u5de5\u8d44\u3002\nSELECT s.grade,count(*),avg(e.sal) FROM emp e LEFT JOIN salgrade s ON e.sal BETWEEN s.losal AND s.hisal GROUP BY s.grade ;\n\n-- 3. \u5217\u51fa\u85aa\u91d1\u9ad8\u4e8e\u5728\u90e8\u95e830\u5de5\u4f5c\u7684\u6240\u6709\u5458\u5de5\u7684\u85aa\u91d1\u7684\u5458\u5de5\u59d3\u540d\u548c\u85aa\u91d1\u3001\u90e8\u95e8\u540d\u79f0\u3002\nselect ename,sal,d.dname,d.deptno from emp e left join dept d on e.deptno = d.deptno where e.sal &gt; (select max(sal) from emp where deptno = 30);\n\n-- 4. \u5217\u51fa\u5728\u6bcf\u4e2a\u90e8\u95e8\u5de5\u4f5c\u7684\u5458\u5de5\u6570\u91cf\u3001\u5e73\u5747\u5de5\u8d44\u548c\u5e73\u5747\u670d\u52a1\u671f\u9650\u3002\nselect count(*),avg(sal),avg(year(now())-year(hiredate)) from emp group by deptno;\n\n-- 5. \u5217\u51fa\u6240\u6709\u5458\u5de5\u7684\u59d3\u540d\u3001\u90e8\u95e8\u540d\u79f0\u548c\u5de5\u8d44\u3002\nselect e.ename,d.dname,e.sal from emp e left join dept d on d.deptno = e.deptno;\n\n-- 6. \u5217\u51fa\u6240\u6709\u90e8\u95e8\u7684\u8be6\u7ec6\u4fe1\u606f\u548c\u90e8\u95e8\u4eba\u6570\nselect d.*,count(e.ename) from dept d left join emp e on e.deptno = d.deptno group by d.deptno;\n\n-- 7. \u5217\u51fa\u5404\u79cd\u5de5\u4f5c\u7684\u6700\u4f4e\u5de5\u8d44\u53ca\u4ece\u4e8b\u6b64\u5de5\u4f5c\u7684\u96c7\u5458\u59d3\u540d\u3002\nselect t.job ,a.ename , t.minsal from emp a left join (select e.job as job , min(e.sal) as minsal from emp e group by e.job) t on a.job = t.job;\n\n-- 8. \u5217\u51fa\u5404\u4e2a\u90e8\u95e8\u7684MANAGER(\u7ecf\u7406)\u7684\u6700\u4f4e\u85aa\u91d1\u3001\u59d3\u540d\u3001\u90e8\u95e8\u540d\u79f0\u3001\u90e8\u95e8\u4eba\u6570\u3002\nselect a.mm,c.ename,c.job,b.dname,b.cc from (select d.deptno,min(sal) mm from emp e left join dept d on e.deptno = d.deptno where job = 'MANAGER' group by deptno) a left join (select d.deptno,d.dname,count(*) cc from emp e left join dept d on e.deptno = d.deptno group by d.deptno) b on a.deptno = b.deptno left join emp c on c.sal = a.mm and b.deptno = c.deptno ;\n\n-- 9. \u5217\u51fa\u6240\u6709\u5458\u5de5\u7684\u5e74\u5de5\u8d44\uff0c\u6240\u5728\u90e8\u95e8\u540d\u79f0\uff0c\u6309\u5e74\u85aa\u4ece\u4f4e\u5230\u9ad8\u6392\u5e8f\u3002\nselect empno,ename,sal * 12 ,d.dname from emp left join dept d on d.deptno = emp.deptno order by sal * 12 asc;\n\n-- 10. \u67e5\u51fa\u67d0\u4e2a\u5458\u5de5\u7684\u4e0a\u7ea7\u4e3b\u7ba1\u53ca\u6240\u5728\u90e8\u95e8\u540d\u79f0\uff0c\u5e76\u8981\u6c42\u51fa\u8fd9\u4e9b\u4e3b\u7ba1\u4e2d\u7684\u6708\u85aa\u8d85\u8fc73000\n\n-- 11. \u6c42\u51fa\u90e8\u95e8\u540d\u79f0\u4e2d\uff0c\u5e26\"S\"\u5b57\u7b26\u7684\u90e8\u95e8\u5458\u5de5\u7684\u3001\u5de5\u8d44\u5408\u8ba1\u3001\u90e8\u95e8\u4eba\u6570\u3002\n\n-- 12. \u7ed9\u4efb\u804c\u65e5\u671f\u8d85\u8fc730\u5e74\u6216\u8005\u572887\u5e74\u96c7\u4f63\u7684\u96c7\u5458\u52a0\u85aa\uff0c\u52a0\u85aa\u539f\u5219\uff1a10\u90e8\u95e8\u589e\u957f10%\uff0c20\u90e8\u95e8\u589e\u957f20%\uff0c 30\u90e8\u95e8\u589e\u957f30%\uff0c\u4f9d\u6b21\u7c7b\u63a8\u3002\n\n-- 13. \u5217\u51fa\u81f3\u5c11\u6709\u4e00\u4e2a\u5458\u5de5\u7684\u6240\u6709\u90e8\u95e8\u7684\u4fe1\u606f\u3002\nselect  DISTINCT d.* from dept d join emp e on d.deptno = e.deptno; \n\n-- 14. \u5217\u51fa\u6708\u85aa\u6bd4JAMES\u4f4e\u7684\u6240\u6709\u5458\u5de5\u3002\nselect * from emp where sal &lt; (select sal from emp where ename = 'JAMES')\n\n-- 15. \u5217\u51fa\u6240\u6709\u5458\u5de5\u7684\u59d3\u540d\u4ee5\u53ca\u5176\u76f4\u63a5\u4e0a\u7ea7\u7684\u59d3\u540d\u3002\nselect a.empno,a.ename as 'e_name',b.ename as 'm_name' from emp a left join emp b on a.mgr = b.empno;\n\n-- 16. \u5217\u51fa\u53d7\u96c7\u65e5\u671f\u65e9\u4e8e\u5176\u76f4\u63a5\u4e0a\u7ea7\u7684\u6240\u6709\u5458\u5de5\u7684\u7f16\u53f7\u3001\u59d3\u540d\uff0c\u90e8\u95e8\u540d\u79f0\u3002\n-- 17. \u5217\u51fa\u90e8\u95e8\u540d\u79f0\u548c\u8fd9\u4e9b\u90e8\u95e8\u7684\u5458\u5de5\u4fe1\u606f\uff0c\u540c\u65f6\u5217\u51fa\u90a3\u4e9b\u6ca1\u6709\u5458\u5de5\u7684\u90e8\u95e8\u3002\n-- 18. \u5217\u51fa\u6240\u6709\"CLERK(\u804c\u5458)\"\u7684\u59d3\u540d\u4ee5\u53ca\u90e8\u95e8\u540d\u79f0\uff0c\u90e8\u95e8\u7684\u4eba\u6570\u3002\n-- 19. \u5217\u51fa\u6700\u4f4e\u85aa\u91d1\u5927\u4e8e1500\u7684\u5404\u79cd\u5de5\u4f5c\u4ee5\u53ca\u4ece\u4e8b\u6b64\u5de5\u4f5c\u7684\u5168\u90e8\u96c7\u5458\u4eba\u6570\u3002\n-- 20. \u5217\u51fa\u5728\u90e8\u95e8\"SALES\"\u5de5\u4f5c\u7684\u5458\u5de5\u7684\u59d3\u540d\uff0c\u5047\u5b9a\u4e0d\u77e5\u9053\u9500\u552e\u90e8\u7684\u90e8\u95e8\u7f16\u53f7\u3002\n-- 21. \u5217\u51fa\u85aa\u91d1\u9ad8\u4e8e\u516c\u53f8\u5e73\u5747\u85aa\u91d1\u7684\u6240\u6709\u5458\u5de5\uff0c\u6240\u5728\u90e8\u95e8\uff0c\u4e0a\u7ea7\u9886\u5bfc\uff0c\u516c\u53f8\u7684\u5de5\u8d44\u7b49\u7ea7\u3002\n-- 22. \u5217\u51fa\u81f3\u5c11\u6709\u4e00\u4e2a\u5458\u5de5\u7684\u6240\u6709\u90e8\u95e8\u7f16\u53f7\u3001\u540d\u79f0\uff0c\u5e76\u7edf\u8ba1\u51fa\u8fd9\u4e9b\u90e8\u95e8\u7684\u5e73\u5747\u5de5\u8d44\u3001\u6700\u4f4e\u5de5\u8d44\u3001\u6700\u9ad8\u5de5 \u8d44\u3002\n-- 23. \u5217\u51fa\u85aa\u91d1\u6bd4\u201cSMITH\u201d\u6216\u201cALLEN\u201d\u591a\u7684\u6240\u6709\u5458\u5de5\u7684\u7f16\u53f7\u3001\u59d3\u540d\u3001\u90e8\u95e8\u540d\u79f0\u3001\u5176\u9886\u5bfc\u59d3\u540d\u3002\n-- 24. \u5217\u51fa\u6240\u6709\u5458\u5de5\u7684\u7f16\u53f7\u3001\u59d3\u540d\u53ca\u5176\u76f4\u63a5\u4e0a\u7ea7\u7684\u7f16\u53f7\u3001\u59d3\u540d\uff0c\u663e\u793a\u7684\u7ed3\u679c\u6309\u9886\u5bfc\u5e74\u5de5\u8d44\u7684\u964d\u5e8f\u6392\u5217\u3002\n-- 25. \u5217\u51fa\u53d7\u96c7\u65e5\u671f\u65e9\u4e8e\u5176\u76f4\u63a5\u4e0a\u7ea7\u7684\u6240\u6709\u5458\u5de5\u7684\u7f16\u53f7\u3001\u59d3\u540d\u3001\u90e8\u95e8\u540d\u79f0\u3001\u90e8\u95e8\u4f4d\u7f6e\u3001\u90e8\u95e8\u4eba\u6570\u3002\n-- 26. \u5217\u51fa\u90e8\u95e8\u540d\u79f0\u548c\u8fd9\u4e9b\u90e8\u95e8\u7684\u5458\u5de5\u4fe1\u606f\uff08\u6570\u91cf\u3001\u5e73\u5747\u5de5\u8d44\uff09\uff0c\u540c\u65f6\u5217\u51fa\u90a3\u4e9b\u6ca1\u6709\u5458\u5de5\u7684\u90e8\u95e8\u3002\n-- 27. \u5217\u51fa\u6240\u6709\u201cCLERK\u201d\uff08\u529e\u4e8b\u5458\uff09\u7684\u59d3\u540d\u53ca\u5176\u90e8\u95e8\u540d\u79f0\uff0c\u90e8\u95e8\u7684\u4eba\u6570\uff0c\u5de5\u8d44\u7b49\u7ea7\u3002\n-- 28. \u5217\u51fa\u6700\u4f4e\u85aa\u91d1\u5927\u4e8e1500\u7684\u5404\u79cd\u5de5\u4f5c\u53ca\u6b64\u4ece\u4e8b\u6b64\u5de5\u4f5c\u7684\u5168\u90e8\u96c7\u5458\u4eba\u6570\u53ca\u6240\u5728\u90e8\u95e8\u540d\u79f0\u3001\u4f4d\u7f6e\u3001\u5e73\u5747\u5de5 \u8d44\u3002\n-- 29. \u5217\u51fa\u5728\u90e8\u95e8\u201cSALES\u201d\uff08\u9500\u552e\u90e8\uff09\u5de5\u4f5c\u7684\u5458\u5de5\u7684\u59d3\u540d\u3001\u57fa\u672c\u5de5\u8d44\u3001\u96c7\u4f63\u65e5\u671f\u3001\u90e8\u95e8\u540d\u79f0\uff0c\u5047\u5b9a\u4e0d\u77e5\u9053 \u9500\u552e\u90e8\u7684\u90e8\u95e8\u7f16\u53f7\u3002\n-- 30. \u5217\u51fa\u85aa\u91d1\u9ad8\u4e8e\u516c\u53f8\u5e73\u5747\u85aa\u91d1\u7684\u6240\u6709\u5458\u5de5\uff0c\u6240\u5728\u90e8\u95e8\uff0c\u4e0a\u7ea7\u9886\u5bfc\uff0c\u516c\u53f8\u7684\u5de5\u8d44\u7b49\u7ea7\u3002\n-- 31. \u5217\u51fa\u4e0e\u201cSCOTT\u201d\u4ece\u4e8b\u76f8\u540c\u5de5\u4f5c\u7684\u6240\u6709\u5458\u5de5\u53ca\u90e8\u95e8\u540d\u79f0\uff0c\u90e8\u95e8\u4eba\u6570\u3002\n-- 32. \u67e5\u8be2dept\u8868\u7684\u7ed3\u6784\n-- 33. \u68c0\u7d22emp\u8868\uff0c\u7528is a \u8fd9\u4e2a\u5b57\u7b26\u4e32\u6765\u8fde\u63a5\u5458\u5de5\u59d3\u540d\u548c\u5de5\u79cd\u4e24\u4e2a\u5b57\u6bb5\n-- 34. \u68c0\u7d22emp\u8868\u4e2d\u6709\u63d0\u6210\u7684\u5458\u5de5\u59d3\u540d\u3001\u6708\u6536\u5165\u53ca\u63d0\u6210\u3002\n</code></pre> <pre><code>-- DDL\n\n-- \u5b66\u751f\u8868\n-- Student(SId,Sname,Sage,Ssex)\n-- SId \u5b66\u751f\u7f16\u53f7,Sname \u5b66\u751f\u59d3\u540d,Sage \u51fa\u751f\u5e74\u6708,Ssex \u5b66\u751f\u6027\u522b\n\n-- \u8bfe\u7a0b\u8868\n-- Course(CId,Cname,TId)\n-- CId \u8bfe\u7a0b\u7f16\u53f7,Cname \u8bfe\u7a0b\u540d\u79f0,TId \u6559\u5e08\u7f16\u53f7\n\n-- \u6559\u5e08\u8868\n-- Teacher(TId,Tname)\n-- TId \u6559\u5e08\u7f16\u53f7,Tname \u6559\u5e08\u59d3\u540d\n\n-- \u6210\u7ee9\u8868\n-- SC(SId,CId,score)\n-- SId \u5b66\u751f\u7f16\u53f7,CId \u8bfe\u7a0b\u7f16\u53f7,score \u5206\u6570\n\ncreate table Student(sid varchar(10),sname varchar(10),sage datetime,ssex nvarchar(10));  \ninsert into Student values('01' , '\u8d75\u96f7' , '1990-01-01' , '\u7537');  \ninsert into Student values('02' , '\u94b1\u7535' , '1990-12-21' , '\u7537');  \ninsert into Student values('03' , '\u5b59\u98ce' , '1990-05-20' , '\u7537');  \ninsert into Student values('04' , '\u674e\u4e91' , '1990-08-06' , '\u7537');  \ninsert into Student values('05' , '\u5468\u6885' , '1991-12-01' , '\u5973');  \ninsert into Student values('06' , '\u5434\u5170' , '1992-03-01' , '\u5973');  \ninsert into Student values('07' , '\u90d1\u7af9' , '1989-07-01' , '\u5973');  \ninsert into Student values('08' , '\u738b\u83ca' , '1990-01-20' , '\u5973');  \ncreate table Course(cid varchar(10),cname varchar(10),tid varchar(10));  \ninsert into Course values('01' , '\u8bed\u6587' , '02');  \ninsert into Course values('02' , '\u6570\u5b66' , '01');  \ninsert into Course values('03' , '\u82f1\u8bed' , '03');  \ncreate table Teacher(tid varchar(10),tname varchar(10));  \ninsert into Teacher values('01' , '\u5f20\u4e09');  \ninsert into Teacher values('02' , '\u674e\u56db');  \ninsert into Teacher values('03' , '\u738b\u4e94');  \ncreate table SC(sid varchar(10),cid varchar(10),score decimal(18,1));  \ninsert into SC values('01' , '01' , 80);  \ninsert into SC values('01' , '02' , 90);  \ninsert into SC values('01' , '03' , 99);  \ninsert into SC values('02' , '01' , 70);  \ninsert into SC values('02' , '02' , 60);  \ninsert into SC values('02' , '03' , 80);  \ninsert into SC values('03' , '01' , 80);  \ninsert into SC values('03' , '02' , 80);  \ninsert into SC values('03' , '03' , 80);  \ninsert into SC values('04' , '01' , 50);  \ninsert into SC values('04' , '02' , 30);  \ninsert into SC values('04' , '03' , 20);  \ninsert into SC values('05' , '01' , 76);  \ninsert into SC values('05' , '02' , 87);  \ninsert into SC values('06' , '01' , 31);  \ninsert into SC values('06' , '03' , 34);  \ninsert into SC values('07' , '02' , 89);  \ninsert into SC values('07' , '03' , 98);\n\n\n\n-- 1. \u67e5\u8be2\u201c01\u201d\u8bfe\u7a0b\u6bd4\u201c02\u201d\u8bfe\u7a0b\u6210\u7ee9\u9ad8\u7684\u6240\u6709\u5b66\u751f\u7684\u5b66\u53f7\uff1b\nselect distinct t1.sid as sidfrom   \n    (select * from sc where cid='01')t1  \nleft join   \n    (select * from sc where cid='02')t2  \non t1.sid=t2.sid  \nwhere t1.score&gt;t2.score\n\n-- 2. \u67e5\u8be2\u5e73\u5747\u6210\u7ee9\u5927\u4e8e60\u5206\u7684\u540c\u5b66\u7684\u5b66\u53f7\u548c\u5e73\u5747\u6210\u7ee9\uff1b\nselect   \n    sid  \n    ,avg(score)  \nfrom sc  \ngroup by sid  \nhaving avg(score)&gt;60\n\n-- 3. \u67e5\u8be2\u6240\u6709\u540c\u5b66\u7684\u5b66\u53f7\u3001\u59d3\u540d\u3001\u9009\u8bfe\u6570\u3001\u603b\u6210\u7ee9\nselect  \n    student.sid as sid  \n    ,sname  \n    ,count(distinct cid) course_cnt  \n    ,sum(score) as total_score  \nfrom student  \nleft join sc  \non student.sid=sc.sid  \ngroup by sid,sname\n\n-- 4. \u67e5\u8be2\u59d3\u201c\u674e\u201d\u7684\u8001\u5e08\u7684\u4e2a\u6570\uff1b\nselect  \n    count(distinct tid) as teacher_cnt  \nfrom teacher  \nwhere tname like '\u674e%'\n\n-- 5. \u67e5\u8be2\u6ca1\u5b66\u8fc7\u201c\u5f20\u4e09\u201d\u8001\u5e08\u8bfe\u7684\u540c\u5b66\u7684\u5b66\u53f7\u3001\u59d3\u540d\uff1b\nselect  \n    sid,sname  \nfrom student  \nwhere sid not in   \n    (  \n        select  \n            sc.sid  \n        from teacher  \n        left join course  \n            on teacher.tid=course.tid  \n        left join sc  \n            on course.cid=sc.cid  \n        where teacher.tname='\u5f20\u4e09'  \n    )\n\n-- 6. \u67e5\u8be2\u5b66\u8fc7\u201c01\u201d\u5e76\u4e14\u4e5f\u5b66\u8fc7\u7f16\u53f7\u201c02\u201d\u8bfe\u7a0b\u7684\u540c\u5b66\u7684\u5b66\u53f7\u3001\u59d3\u540d\uff1b\nselect  \n    t.sid as sid  \n    ,sname  \nfrom   \n    (  \n        select  \n            sid  \n            ,count(if(cid='01',score,null)) as count1  \n            ,count(if(cid='02',score,null)) as count2  \n        from sc  \n        group by sid  \n        having count(if(cid='01',score,null))&gt;0 and count(if(cid='02',score,null))&gt;0  \n    )t  \nleft join student  \n    on t.sid=student.sid\n\n-- 7. \u67e5\u8be2\u5b66\u8fc7\u201c\u5f20\u4e09\u201d\u8001\u5e08\u6240\u6559\u7684\u8bfe\u7684\u540c\u5b66\u7684\u5b66\u53f7\u3001\u59d3\u540d\uff1b\nselect  \n    student.sid  \n    ,sname  \nfrom   \n    (  \n        select  \n            distinct cid   \n        from course  \n        left join teacher   \n        on course.tid=teacher.tid  \n        where teacher.tname='\u5f20\u4e09'  \n    )course  \nleft join sc   \n    on course.cid=sc.cid  \nleft join student  \n    on sc.sid=student.sid  \ngroup by student.sid,sname\n\n-- 8. \u67e5\u8be2\u8bfe\u7a0b\u7f16\u53f7\u201c01\u201d\u7684\u6210\u7ee9\u6bd4\u8bfe\u7a0b\u7f16\u53f7\u201c02\u201d\u8bfe\u7a0b\u4f4e\u7684\u6240\u6709\u540c\u5b66\u7684\u5b66\u53f7\u3001\u59d3\u540d\uff1b\nselect  \n    t1.sid,sname  \nfrom   \n    (  \n        select distinct t1.sid as sid  \n        from   \n            (select * from sc where cid='01')t1  \n        left join   \n            (select * from sc where cid='02')t2  \n        on t1.sid=t2.sid  \n        where t1.score&gt;t2.score  \n    )t1  \nleft join student  \n    on t1.sid=student.sid\n\n-- 9. \u67e5\u8be2\u6240\u6709\u8bfe\u7a0b\u6210\u7ee9\u5c0f\u4e8e60\u5206\u7684\u540c\u5b66\u7684\u5b66\u53f7\u3001\u59d3\u540d\uff1b\nselect  \n    t1.sid,sname  \nfrom   \n    (  \n        select  \n            sid,max(score)  \n        from sc  \n        group by sid  \n        having max(score&lt;60)  \n    )t1  \nleft join student  \n    on t1.sid=student.sid\n\n-- 10. \u67e5\u8be2\u6ca1\u6709\u5b66\u5168\u6240\u6709\u8bfe\u7684\u540c\u5b66\u7684\u5b66\u53f7\u3001\u59d3\u540d\uff1b\nselect  \n    t1.sid,sname  \nfrom   \n    (  \n        select  \n            count(cid),sid  \n        from sc  \n        group by sid  \n        having count(cid) &lt; (select count(distinct cid) from course)  \n    )t1  \nleft join student  \n    on t1.sid=student.sid\n\n-- 11. \u67e5\u8be2\u81f3\u5c11\u6709\u4e00\u95e8\u8bfe\u4e0e\u5b66\u53f7\u4e3a\u201c01\u201d\u7684\u540c\u5b66\u6240\u5b66\u76f8\u540c\u7684\u540c\u5b66\u7684\u5b66\u53f7\u548c\u59d3\u540d\uff1b\nselect  \n    distinct sc.sid  \nfrom   \n    (  \n        select  \n            cid  \n        from sc  \n        where sid='01'  \n    )t1  \nleft join sc  \n    on t1.cid=sc.cid\n\n-- 12. \u67e5\u8be2\u548c\"01\"\u53f7\u7684\u540c\u5b66\u5b66\u4e60\u7684\u8bfe\u7a0b\u5b8c\u5168\u76f8\u540c\u7684\u5176\u4ed6\u540c\u5b66\u7684\u5b66\u53f7\u548c\u59d3\u540d\n#\u6ce8\u610f\u662f\u548c'01'\u53f7\u540c\u5b66\u8bfe\u7a0b\u5b8c\u5168\u76f8\u540c\u4f46\u975e\u5b66\u4e60\u8bfe\u7a0b\u6570\u76f8\u540c\u7684,\u8fd9\u91cc\u6211\u7528\u5de6\u8fde\u63a5\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898select  \n    t1.sid,sname  \nfrom  \n    (  \n        select  \n            sc.sid  \n            ,count(distinct sc.cid)  \n        from   \n            (  \n                select  \n                    cid  \n                from sc  \n                where sid='01'  \n            )t1 #\u9009\u51fa01\u7684\u540c\u5b66\u6240\u5b66\u7684\u8bfe\u7a0b  \n        left join sc  \n            on t1.cid=sc.cid  \n        group by sc.sid  \n        having count(distinct sc.cid)= (select count(distinct cid) from sc where sid = '01')  \n    )t1  \nleft join student  \n    on t1.sid=student.sid  \nwhere t1.sid!='01'\n\n-- 13. \u628a\u201cSC\u201d\u8868\u4e2d\u201c\u5f20\u4e09\u201d\u8001\u5e08\u6559\u7684\u8bfe\u7684\u6210\u7ee9\u90fd\u66f4\u6539\u4e3a\u6b64\u8bfe\u7a0b\u7684\u5e73\u5747\u6210\u7ee9\uff1b\n-- \u6682\u8df3\u8fc7update\u9898\u76ee\n\n\n-- 14. \u67e5\u8be2\u6ca1\u5b66\u8fc7\"\u5f20\u4e09\"\u8001\u5e08\u8bb2\u6388\u7684\u4efb\u4e00\u95e8\u8bfe\u7a0b\u7684\u5b66\u751f\u59d3\u540d\nselect   \n    sname  \nfrom student  \nwhere sid not in  \n    (  \n        select  \n            distinct sid  \n        from sc  \n        left join course  \n            on sc.cid=course.cid  \n        left join teacher  \n            on course.tid=teacher.tid   \n        where tname='\u5f20\u4e09'  \n    )\n\n-- 15. \u67e5\u8be2\u4e24\u95e8\u53ca\u5176\u4ee5\u4e0a\u4e0d\u53ca\u683c\u8bfe\u7a0b\u7684\u540c\u5b66\u7684\u5b66\u53f7\uff0c\u59d3\u540d\u53ca\u5176\u5e73\u5747\u6210\u7ee9\nselect  \n    t1.sid,sname,avg_score  \nfrom   \n    (  \n        select  \n            sid,count(if(score&lt;60,cid,null)),avg(score) as avg_score  \n        from sc  \n        group by sid  \n        having count(if(score&lt;60,cid,null)) &gt;=2  \n    )t1  \nleft join student  \n    on t1.sid=student.sid\n\n-- 16. \u68c0\u7d22\"01\"\u8bfe\u7a0b\u5206\u6570\u5c0f\u4e8e60\uff0c\u6309\u5206\u6570\u964d\u5e8f\u6392\u5217\u7684\u5b66\u751f\u4fe1\u606f\nselect   \n    sid,if(cid='01',score,100)from sc  \nwhere if(cid='01',score,100)&lt;60  \norder by if(cid='01',score,100) desc\n\n-- 17. \u6309\u5e73\u5747\u6210\u7ee9\u4ece\u9ad8\u5230\u4f4e\u663e\u793a\u6240\u6709\u5b66\u751f\u7684\u5e73\u5747\u6210\u7ee9\nselect sid,avg(score)  \nfrom sc  \ngroup by sid  \norder by avg(score) desc\n\n-- 18. \u67e5\u8be2\u5404\u79d1\u6210\u7ee9\u6700\u9ad8\u5206\u3001\u6700\u4f4e\u5206\u548c\u5e73\u5747\u5206\uff1a\u4ee5\u5982\u4e0b\u5f62\u5f0f\u663e\u793a\uff1a\u8bfe\u7a0bID\uff0c\u8bfe\u7a0bname\uff0c\u6700\u9ad8\u5206\uff0c\u6700\u4f4e\u5206\uff0c\u5e73\u5747\u5206\uff0c\u53ca\u683c\u7387\nselect  \n    sc.cid  \n    ,cname  \n    ,max(score) as max_score  \n    ,min(score) as min_score  \n    ,avg(score) as avg_score  \n    ,count(if(score&gt;=60,sid,null))/count(sid) as pass_rate  \n from sc   \n left join course  \n    on sc.cid=course.cid  \n group by sc.cid\n\n-- 19. \u6309\u5404\u79d1\u5e73\u5747\u6210\u7ee9\u4ece\u4f4e\u5230\u9ad8\u548c\u53ca\u683c\u7387\u7684\u767e\u5206\u6570\u4ece\u9ad8\u5230\u4f4e\u987a\u5e8f\n#\u8fd9\u91cc\u5148\u6309\u7167\u5e73\u5747\u6210\u7ee9\u6392\u5e8f\uff0c\u518d\u6309\u7167\u53ca\u683c\u767e\u5206\u6570\u6392\u5e8f\uff0c  \nselect   \n    cid  \n    ,avg(score) as avg_score  \n    ,count(if(score&gt;=60,sid,null))/count(sid) as pass_rate  \nfrom sc  \ngroup by cid  \norder by avg_score,pass_rate desc\n\n-- 20. \u67e5\u8be2\u5b66\u751f\u7684\u603b\u6210\u7ee9\u5e76\u8fdb\u884c\u6392\u540d\nselect  \n    sid  \n    ,sum(score) as sum_score  \nfrom sc  \ngroup by sid  \norder by sum_score desc\n\n-- 21. \u67e5\u8be2\u4e0d\u540c\u8001\u5e08\u6240\u6559\u4e0d\u540c\u8bfe\u7a0b\u5e73\u5747\u5206\u4ece\u9ad8\u5230\u4f4e\u663e\u793a\nselect  \n    tid  \n    ,avg(score) as avg_score  \nfrom course  \nleft join sc  \n    on course.cid=sc.cid  \ngroup by tid  \norder by avg_score desc\n\n-- 22. \u67e5\u8be2\u6240\u6709\u8bfe\u7a0b\u7684\u6210\u7ee9\u7b2c2\u540d\u5230\u7b2c3\u540d\u7684\u5b66\u751f\u4fe1\u606f\u53ca\u8be5\u8bfe\u7a0b\u6210\u7ee9\nselect  \n    sid,rank_num,score,cid  \nfrom  \n    (  \n        select  \n            rank() over(partition by cid order by score desc) as rank_num  \n            ,sid  \n            ,score  \n            ,cid  \n        from sc  \n    )t  \nwhere rank_num in (2,3)\n\n-- 23. \u7edf\u8ba1\u5404\u79d1\u6210\u7ee9\u5404\u5206\u6570\u6bb5\u4eba\u6570\uff1a\u8bfe\u7a0b\u7f16\u53f7,\u8bfe\u7a0b\u540d\u79f0,[100-85],[85-70],[70-60],[0-60]\u53ca\u6240\u5360\u767e\u5206\u6bd4\nselect  \n    sc.cid  \n    ,cname  \n    ,count(if(score between 85 and 100,sid,null))/count(sid)  \n    ,count(if(score between 70 and 85,sid,null))/count(sid)  \n    ,count(if(score between 60 and 70,sid,null))/count(sid)  \n    ,count(if(score between 0 and 60,sid,null))/count(sid)  \nfrom sc  \nleft join course  \n    on sc.cid=course.cid  \ngroup by sc.cid,cname\n\n-- 24. \u67e5\u8be2\u5b66\u751f\u5e73\u5747\u6210\u7ee9\u53ca\u5176\u540d\u6b21\nselect  \n    sid  \n    ,avg_score  \n    ,rank() over (order by avg_score desc)  \nfrom   \n    (  \n        select  \n            sid  \n            ,avg(score) as avg_score  \n        from sc  \n        group by sid  \n    )t\n\n-- 25. \u67e5\u8be2\u5404\u79d1\u6210\u7ee9\u524d\u4e09\u540d\u7684\u8bb0\u5f55\nselect  \n    sid,cid,rank1from   \n    (  \n        select  \n            cid  \n            ,sid  \n            ,rank() over(partition by cid order by score desc) as rank1  \n        from sc  \n    )twhere rank1&lt;=3\n\n-- 26. \u67e5\u8be2\u6bcf\u95e8\u8bfe\u7a0b\u88ab\u9009\u4fee\u7684\u5b66\u751f\u6570\nselect  \n    count(sid)  \n    ,cid  \nfrom sc  \ngroup by cid\n\n-- 27. \u67e5\u8be2\u51fa\u53ea\u9009\u4fee\u4e86\u4e00\u95e8\u8bfe\u7a0b\u7684\u5168\u90e8\u5b66\u751f\u7684\u5b66\u53f7\nselect  \n    sid  \nfrom sc  \ngroup by sid  \nhaving count(cid) =1\n\n-- 28. \u67e5\u8be2\u7537\u751f\u3001\u5973\u751f\u4eba\u6570\nselect  \n    ssex  \n    ,count(distinct sid)  \nfrom student          \ngroup by ssex\n\n-- 29. \u67e5\u8be2\u540d\u5b57\u4e2d\u542b\u6709\"\u98ce\"\u5b57\u7684\u5b66\u751f\u4fe1\u606f\nselect  \n    sid,sname  \nfrom student  \nwhere sname like '%\u98ce%'\n\n-- 30. \u67e5\u8be2\u540c\u540d\u540c\u6027\u5b66\u751f\u540d\u5355\uff0c\u5e76\u7edf\u8ba1\u540c\u540d\u4eba\u6570\nselect  \n    ssex  \n    ,sname  \n    ,count(sid)  \nfrom student  \ngroup by ssex,sname  \nhaving count(sid)&gt;=2\n\n-- 31. \u67e5\u8be21990\u5e74\u51fa\u751f\u7684\u5b66\u751f\u540d\u5355(\u6ce8\uff1aStudent\u8868\u4e2dSage\u5217\u7684\u7c7b\u578b\u662fdatetime)\nselect  \n    sid,sname,sage  \nfrom student  \nwhere year(sage)=1990\n\n-- 32. \u67e5\u8be2\u6bcf\u95e8\u8bfe\u7a0b\u7684\u5e73\u5747\u6210\u7ee9\uff0c\u7ed3\u679c\u6309\u5e73\u5747\u6210\u7ee9\u5347\u5e8f\u6392\u5217\uff0c\u5e73\u5747\u6210\u7ee9\u76f8\u540c\u65f6\uff0c\u6309\u8bfe\u7a0b\u53f7\u964d\u5e8f\u6392\u5217\nselect  \n    cid,avg(score) as avg_score  \nfrom sc  \ngroup by cid  \norder by avg_score,cid desc\n\n-- 33. \u67e5\u8be2\u4e0d\u53ca\u683c\u7684\u8bfe\u7a0b\uff0c\u5e76\u6309\u8bfe\u7a0b\u53f7\u4ece\u5927\u5230\u5c0f\u6392\u5217\nselect  \n    cid,sid,score  \nfrom sc  \nwhere score&lt;60  \norder by cid desc,sid\n\n-- 34. \u67e5\u8be2\u8bfe\u7a0b\u7f16\u53f7\u4e3a\"01\"\u4e14\u8bfe\u7a0b\u6210\u7ee9\u572860\u5206\u4ee5\u4e0a\u7684\u5b66\u751f\u7684\u5b66\u53f7\u548c\u59d3\u540d\uff1b\nselect  \n    sid,cid,score  \nfrom sc  \nwhere cid='01' and score&gt;60\n\n-- 35. \u67e5\u8be2\u9009\u4fee\u201c\u5f20\u4e09\u201d\u8001\u5e08\u6240\u6388\u8bfe\u7a0b\u7684\u5b66\u751f\u4e2d\uff0c\u6210\u7ee9\u6700\u9ad8\u7684\u5b66\u751f\u59d3\u540d\u53ca\u5176\u6210\u7ee9\nselect  \n    sc.sid,sname,cname,score  \nfrom sc  \nleft join course  \n    style=\"font-weight: 600;\"&gt;=course.cid  \nleft join teacher  \n    style=\"font-weight: 600;\"&gt;=teacher.tid  \nleft join student  \n    style=\"font-weight: 600;\"&gt;=student.sid  \nwhere tname='\u5f20\u4e09'  \norder by score desc  \nlimit 1;\n\n-- 36. \u67e5\u8be2\u6bcf\u95e8\u529f\u8bfe\u6210\u7ee9\u6700\u597d\u7684\u524d\u4e24\u540d\nselect  \n    cid,sid,rank1  \nfrom   \n    (  \n        select  \n            cid  \n            ,sid  \n            ,rank() over(partition by cid order by score desc) as rank1  \n        from sc   \n    )t  \nwhere rank1 &lt;=2\n\n-- 37. \u7edf\u8ba1\u6bcf\u95e8\u8bfe\u7a0b\u7684\u5b66\u751f\u9009\u4fee\u4eba\u6570\uff08\u8d85\u8fc75\u4eba\u7684\u8bfe\u7a0b\u624d\u7edf\u8ba1\uff09\u3002\u8981\u6c42\u8f93\u51fa\u8bfe\u7a0b\u53f7\u548c\u9009\u4fee\u4eba\u6570\uff0c\u67e5\u8be2\u7ed3\u679c\u6309\u4eba\u6570\u964d\u5e8f\u6392\u5217\uff0c\u82e5\u4eba\u6570\u76f8\u540c\uff0c\u6309\u8bfe\u7a0b\u53f7\u5347\u5e8f\u6392\u5217\nselect  \n    cid  \n    ,count(sid) as cnt  \nfrom sc  \ngroup by cid  \nhaving cnt&gt;=5  \norder by count(sid) desc,cid\n\n-- 38. \u68c0\u7d22\u81f3\u5c11\u9009\u4fee\u4e24\u95e8\u8bfe\u7a0b\u7684\u5b66\u751f\u5b66\u53f7\nselect  \n    sid  \n    ,count(cid)  \nfrom sc  \ngroup by sid  \nhaving count(cid)&gt;=2\n\n-- 39. \u67e5\u8be2\u9009\u4fee\u4e86\u5168\u90e8\u8bfe\u7a0b\u7684\u5b66\u751f\u4fe1\u606f\nselect  \n    sid  \n    ,count(cid)  \nfrom sc  \ngroup by sid  \nhaving count(cid)=(select count(distinct cid) from sc)\n\n-- 40. \u67e5\u8be2\u5404\u5b66\u751f\u7684\u5e74\u9f84\nselect  \n    sid,sname,year(curdate())-year(sage) as sage  \nfrom student\n\n-- 41. \u67e5\u8be2\u672c\u5468\u8fc7\u751f\u65e5\u7684\u5b66\u751f\nselect  \n    sid,sname,sage  \nfrom student  \nwhere weekofyear(sage)=weekofyear(curdate())\n\n-- 42. \u67e5\u8be2\u4e0b\u5468\u8fc7\u751f\u65e5\u7684\u5b66\u751f\nselect   \n    sid,sname,sage  \nfrom student  \nwhere weekofyear(sage) = weekofyear(date_add(curdate(),interval 1 week))\n\n-- 43 \u67e5\u8be2\u672c\u6708\u8fc7\u751f\u65e5\u7684\u5b66\u751f\nselect  \n    sid,sname,sage  \nfrom student  \nwhere month(sage) = month(curdate())\n\n-- 44. \u67e5\u8be2\u4e0b\u6708\u8fc7\u751f\u65e5\u7684\u5b66\u751f\nselect  \n    sid,sname,sage  \nfrom student  \nwhere month(date_sub(sage,interval 1 month)) = month(curdate())\n</code></pre>"},{"location":"basic/7.MySQL%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/","title":"7. MySQL\u6570\u636e\u7c7b\u578b","text":""},{"location":"basic/7.MySQL%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/#_1","title":"\u524d\u8a00","text":"<p>\u6bcf\u79cd\u7f16\u7a0b\u8bed\u8a00\u90fd\u6709\u81ea\u5df1\u7684\u6570\u636e\u6a21\u578b\uff0c\u8fd9\u4e9b\u6570\u636e\u6a21\u578b\u4e92\u4e0d\u76f8\u540c\uff0c\u800c\u4e14\u901a\u5e38\u6709\u76f8\u5f53\u5927\u7684\u5dee\u5f02\u3002</p> <p>\u591a\u6570\u7f16\u7a0b\u8bed\u8a00\u5904\u7406\u6570\u636e\u6240\u9075\u5faa\u7684\u57fa\u672c\u539f\u5219\u662f\uff0c\u6bcf\u4e2a\u7a0b\u5e8f\u90fd\u53ef\u4ee5\u8bbf\u95ee\u6211\u4eec\u7528\u4e8e\u8868\u793a\u5b58\u50a8\u533a\u57df\u7684\"\u6846\"\u3002\u6bcf\u4e2a\u6846\u90fd\u5177\u6709\u4e00\u4e2a\u7c7b\u578b\uff0c\u6bd4\u5982 int \u6216 char\u3002\u6846\u4e2d\u53ef\u4ee5\u5b58\u50a8\u7c7b\u578b\u5bf9\u5e94\u7684\u503c\uff0c\u901a\u5e38\u5c06\u53ef\u4ee5\u5b58\u50a8\u5230\u8fd9\u4e9b\u6846\u4e2d\u7684\u503c\u79f0\u4e3a\u6570\u636e\u5bf9\u8c61\u3002</p> <p>\u6211\u4eec\u8fd8\u8981\u4e3a\u8fd9\u4e9b\u6846\u547d\u540d\u3002\u4e00\u822c\u6765\u8bf4\uff0c\u6846\u7684\u540d\u79f0\u53ef\u4ee5\u662f\u4efb\u4f55\u6307\u793a\u8be5\u6846\u7684\u8868\u8ff0\u6027\u8bcd\u8bed\u3002\u6211\u4eec\u901a\u5e38\u4f1a\u5c06\u6846\u7684\u540d\u79f0\u89c6\u4f5c\u8be5\u7a0b\u5e8f\u7684\u53d8\u91cf\uff0c\u4e0d\u8fc7\u60c5\u51b5\u5e76\u975e\u5b8c\u5168\u5982\u6b64\u3002</p> <p>\u4f8b\u5982\uff0c\u5982\u679c x \u662f\u9012\u5f52\u51fd\u6570 F \u7684\u5c40\u90e8\u53d8\u91cf\uff0c\u90a3\u4e48\u5c31\u53ef\u80fd\u4f1a\u6709\u5f88\u591a\u540d\u4e3a x \u7684\u6846\uff0c\u6bcf\u4e2a x \u90fd\u4e0e\u5bf9 F \u7684\u4e0d\u540c\u8c03\u7528\u76f8\u5173\u8054\u3002\u8fd9\u6837\u7684\u8bdd\uff0c\u8fd9\u79cd\u6846\u7684\u771f\u5b9e\u540d\u79f0\u5c31\u662f x \u4e0e\u5bf9 F \u7684\u67d0\u6b21\u8c03\u7528\u7684\u7ec4\u5408\u3002</p> <p>C \u8bed\u8a00\u4e2d\u7684\u591a\u6570\u6570\u636e\u7c7b\u578b\u90fd\u662f\u6211\u4eec\u719f\u6089\u7684\uff1a\u6574\u6570\u3001\u6d6e\u70b9\u6570\u3001\u5b57\u7b26\u3001\u6570\u7ec4\u3001\u7ed3\u6784\u548c\u6307\u9488\u3002\u8fd9\u4e9b\u90fd\u662f\u9759\u6001\u7684\u6982\u5ff5\u3002</p> <p>\u7c7b\u578b\u7cfb\u7edf\u5305\u542b\u6574\u6570\u8fd9\u6837\u7684\u57fa\u672c\u7c7b\u578b\u4ee5\u53ca\u4e00\u4e9b\u7c7b\u578b\u6784\u6210\u89c4\u5219\uff08type-formation rule\uff09\uff0c\u5229\u7528\u8fd9\u4e9b\u89c4\u5219\uff0c\u6211\u4eec\u53ef\u4ee5\u7528\u5df2\u77e5\u7684\u7c7b\u578b\u9010\u6b65\u6784\u5efa\u66f4\u4e3a\u590d\u6742\u7684\u7c7b\u578b\u3002</p>"},{"location":"basic/7.MySQL%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/#_2","title":"\u6570\u636e\u7c7b\u578b\u6982\u8ff0","text":"<p>MySQL \u652f\u6301\u4ee5\u4e0b\u51e0\u79cd\u7c7b\u522b\u7684 SQL \u6570\u636e\u7c7b\u578b\uff1a</p> <ul> <li>\u6570\u503c\u7c7b\u578b numeric types</li> <li>\"\u65e5\u671f\u548c\u65f6\u95f4\"\u7c7b\u578b date and time types</li> <li>\u5b57\u7b26\u4e32\uff08\u5b57\u7b26\u548c\u5b57\u8282\uff09\u7c7b\u578b string (character and byte) types</li> <li>\u7a7a\u95f4\u7c7b\u578b spatial types</li> <li>JSON \u6570\u636e\u7c7b\u578b</li> </ul> <p>\u6570\u636e\u7c7b\u578b\u7684\u63cf\u8ff0\u4f7f\u7528\u4e86\u4ee5\u4e0b\u7ea6\u5b9a\uff1a</p> <ul> <li>\u5bf9\u4e8e\u6574\u578b\uff08integer\uff09\uff0c<code>int(M)</code> \u4e2d M \u8868\u793a\u6700\u5927\u7684**\u663e\u793a\u5bbd\u5ea6**\uff08display width\uff09\uff1b</li> <li>\u5bf9\u4e8e\u6d6e\u70b9\u578b\uff08floating-point\uff09\u548c\u5b9a\u70b9\u578b\uff08fixed-point\uff09\u7c7b\u578b\uff0c<code>M</code> \u8868\u793a\u53ef\u88ab\u5b58\u50a8\u6570\u5b57\u7684\u603b\u4e2a\u6570\uff08the precision\uff09\uff1b</li> <li>\u5bf9\u4e8e\u5b57\u7b26\u4e32\u7c7b\u578b\uff0c<code>varchar(M)</code> \u4e2d M \u662f\u5b57\u7b26\u4e32\u4e2d\u7684\u5b57\u7b26\u6570\u91cf\u3002\u53e6\u5916\uff0c<code>M</code> \u7684\u6700\u5927\u5141\u8bb8\u503c\u53d6\u51b3\u4e8e\u5177\u4f53\u7684\u6570\u636e\u7c7b\u578b\u548c\u5b57\u7b26\u7f16\u7801\u3002</li> <li><code>D</code> \u5e94\u7528\u4e8e\u6d6e\u70b9\u578b\u548c\u5b9a\u70b9\u578b\uff0c\u5b83\u8868\u793a\u5c0f\u6570\u70b9\u540e\u53ef\u5b58\u5728\u591a\u5c11\u4e2a\u6570\u5b57\uff08the scale\uff09\u3002\u53ef\u80fd\u7684\u6700\u5927\u503c\u4e3a 30\uff0c\u4f46\u4e0d\u5e94\u5927\u4e8e <code>M</code>-2\u3002</li> <li><code>fsp</code> \u5e94\u7528\u4e8e TIME\u3001DATETIME \u548c TIMESTAMP \u7c7b\u578b\uff0c\u5b83\u8868\u793a\u5c0f\u6570\u7684\u7cbe\u5ea6\uff08\u5373\u6beb\u79d2\u3001\u5fae\u79d2\uff09\uff0c\u5373\u5c0f\u6570\u70b9\u540e\u6570\u5b57\u7684\u4e2a\u6570\u3002<code>fsp</code> \u7684\u53d6\u503c\u8303\u56f4\u4e3a [0, 6]\uff0c\u5176\u4e2d 0 \u8868\u793a\u6ca1\u6709\u5c0f\u6570\u3002\u82e5\u7f3a\u7701\uff08\u5373\u4e0d\u4f20\u9012\u8be5\u53c2\u6570\uff09\uff0c\u9ed8\u8ba4\u7cbe\u5ea6\u4e3a 0\uff08\u4e0e SQL \u6807\u51c6\u7684\u9ed8\u8ba4\u503c 6 \u4e0d\u540c\uff0c\u4e3b\u8981\u4e3a\u4e86\u517c\u5bb9 MySQL \u65e7\u7248\u672c\uff09\u3002</li> <li>\u65b9\u62ec\u53f7\uff08[]\uff09\u8868\u793a\u7c7b\u578b\u5b9a\u4e49\u7684\u53ef\u9009\u90e8\u5206\u3002</li> </ul>"},{"location":"basic/7.MySQL%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/#_3","title":"\u6570\u503c\u7c7b\u578b","text":"<p>MySQL \u652f\u6301 SQL \u6807\u51c6\u4e2d\u6240\u6709\u6570\u503c\u6570\u636e\u7c7b\u578b\uff0c\u5305\u62ec\uff1a</p> <ul> <li>\u7cbe\u786e\u6570\u503c\u7c7b\u578b\uff08INTEGER\u3001SMALLINT\u3001DECIMAL \u548c NUMERIC\uff09</li> <li>\u8fd1\u4f3c\u6570\u503c\u7c7b\u578b\uff08FLOAT\u3001REAL \u548c DOUBLE PRECISION\uff09</li> </ul> <p>\u5173\u952e\u5b57 INT \u662f INTEGER \u7684\u522b\u540d\uff0c\u5173\u952e\u5b57 DEC \u548c FIXED \u662f DECIMAL \u7684\u522b\u540d\u3002</p> <p>MySQL \u5c06 DOUBLE \u89c6\u4e3a <code>DOUBLE PRECISION</code> \u7684\u522b\u540d\uff08\u4e00\u79cd\u975e\u6807\u51c6\u6269\u5c55\uff09\u3002</p> <p>\u9664\u975e\u542f\u7528 <code>SQL</code> \u7684 REAL_AS_FLOAT \u6a21\u5f0f\uff0c\u5426\u5219 MySQL \u4e5f\u628a <code>REAL</code> \u89c6\u4e3a <code>DOUBLE PRECISION</code> \u7684\u522b\u540d\uff08\u4e00\u79cd\u975e\u6807\u51c6\u53d8\u4f53\uff09\u3002</p>"},{"location":"basic/7.MySQL%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/#_4","title":"\u7cbe\u786e\u6574\u578b","text":"<p>MySQL \u652f\u6301 SQL \u6807\u51c6\u7684\u6574\u578b\u7c7b\u578b\uff1aINTEGER\uff08\u6216 INT\uff09\u548c SMALLINT\u3002\u4e0d\u80fd\u5b58\u5c0f\u6570\u4f4d\u3002</p> <p>\u4f5c\u4e3a\u6807\u51c6 <code>SQL</code> \u7684\u6269\u5c55\uff0c<code>MySQL</code> \u4e5f\u652f\u6301\u8fd9\u4e9b\u6574\u578b\u7c7b\u578b\uff1a<code>TINYINT</code>\u3001<code>MEDIUMINT</code> \u548c <code>BIGINT</code>\u3002\u4ee5\u4e0b\u8868\u683c\u5c55\u793a\u4e86\u6bcf\u79cd\u6574\u578b\u7c7b\u578b\u6240\u9700\u7684\u5b58\u50a8\u7a7a\u95f4\u548c\u53d6\u503c\u8303\u56f4\u3002</p> \u7c7b\u578b \u5360\u7528\u5b58\u50a8 (Bytes) \u6709\u7b26\u53f7\u53d6\u503c\u8303\u56f4 \u65e0\u7b26\u53f7\u53d6\u503c\u8303\u56f4 \u7528\u9014\u5907\u6ce8 TINYINT 1 (-128 , 127) (0 , 255) \u5c0f\u6574\u6570\u503c SMALLINT 2 (-32768 , 32767) (0 , 65535) \u5927\u6574\u6570\u503c MEDIUMINT 3 (-8388608 , 8388607) (0 , 16777215) \u5927\u6574\u6570\u503c INT 4 (-2147483648 , 2147483647) (0 , 4294967295) \u5927\u6574\u6570\u503c BIGINT 8 (-2^63 , 2^63-1) (0 , 2^64-1\uff09 \u8d85\u5927\u6574\u6570\u503c <ul> <li>TINYINT \u5728\u5f00\u53d1\u4e2d\uff0c\u53ef\u4ee5\u4f7f\u7528 TINYINT \u7c7b\u578b\u7684\u5b57\u6bb5\u6765\u5b58\u50a8\u4e00\u4e9b\u72b6\u6001\u6807\u8bc6\u6216\u5e03\u5c14\u503c\u7b49\u4fe1\u606f\uff0c\u56e0\u4e3a\u4f7f\u7528 TINYINT \u7c7b\u578b\u80fd\u591f\u6709\u6548\u5730\u964d\u4f4e\u5b58\u50a8\u7a7a\u95f4\u7684\u5360\u7528\u3002</li> <li>SMALLINT \u901a\u5e38\u7528\u4e8e\u9700\u8981\u8f83\u5c0f\u6574\u6570\u503c\u7684\u60c5\u51b5\uff0c\u5982\u7edf\u8ba1\u6570\u636e\u3001\u8ba1\u7b97\u7b49\u3002\u5728\u5b9e\u9645\u5f00\u53d1\u4e2d\u5e38\u5e38\u7528\u4e8e\u5b58\u50a8\u72b6\u6001\u7801\u3001\u6570\u91cf\u7b49\u6570\u636e\u3002\u4f8b\u5982\uff0c\u5728\u4e00\u4e2a\u7535\u5546\u7f51\u7ad9\u4e2d\uff0c\u53ef\u4ee5\u4f7f\u7528 SMALLINT \u7c7b\u578b\u6765\u5b58\u50a8\u8ba2\u5355\u7684\u72b6\u6001\u7801\uff0c\u5982 0\uff1a\u5f85\u4ed8\u6b3e\uff0c1\uff1a\u5df2\u5b8c\u6210\uff0c2\uff1a\u5df2\u53d6\u6d88\u7b49\u3002</li> <li>MEDIUMINT \u5728\u5b9e\u9645\u5f00\u53d1\u4e2d\uff0cMEDIUMINT \u53ef\u4ee5\u7528\u4e8e\u5b58\u50a8\u4e00\u4e9b\u4e2d\u7b49\u89c4\u6a21\u7684\u6570\u636e\uff0c\u4f8b\u5982\u5728\u4e00\u4e2a\u535a\u5ba2\u7cfb\u7edf\u4e2d\uff0c\u53ef\u4ee5\u4f7f\u7528 MEDIUMINT \u7c7b\u578b\u6765\u5b58\u50a8\u6587\u7ae0\u7684\u6d4f\u89c8\u91cf\u6216\u8bc4\u8bba\u6570\u91cf\u3002</li> <li>INT \u6570\u636e\u7c7b\u578b\u901a\u5e38\u662f\u5b58\u50a8\u6574\u6570\u503c\u7684\u9996\u9009\u7c7b\u578b\uff0c\u4f8b\u5982\u7528\u6237 ID\u3001\u5e74\u9f84\u3001\u8ba2\u5355\u6570\u91cf\u3001\u91d1\u989d\u7b49\u3002\u5728\u5b9e\u9645\u5f00\u53d1\u4e2d\uff0cINT \u4e5f\u53ef\u4ee5\u7528\u4e8e\u5b58\u50a8\u4e00\u4e9b\u8f83\u5927\u89c4\u6a21\u7684\u6570\u636e\uff0c\u5982\u6d4f\u89c8\u6b21\u6570\u3001\u559c\u6b22\u6b21\u6570\u7b49\u3002</li> </ul> <pre><code>CREATE  TABLE demo_test (\n    id INT(11)  NOT NULL AUTO_INCREMENT,\n    a  INT(11)  NOT NULL,\n    b  INT(11)  UNSIGNED ZEROFILL NOT NULL,\n    PRIMARY KEY (`id`)\n);\n\n-- \u6570\u5b57\u6570\u636e\u7c7b\u578b\u65e2\u53ef\u4ee5 UNSIGNED \u5c5e\u6027\u4fee\u9970\uff0c\u4e5f\u5141\u8bb8\u4f7f\u7528 SIGNED \u5c5e\u6027\u3002\u9ed8\u8ba4\u662f SIGNED \u6709\u7b26\u53f7\u7684\uff0c\u53ef\u4e3a\u8d1f\u7684\u3002\n\n-- \u5bf9\u4e8eINTEGER\u7c7b\u578b\uff0c\u62ec\u53f7\u4e2d\u7684\u6570\u5b57\u79f0\u4e3a\u5b57\u6bb5\u7684\u663e\u793a\u5bbd\u5ea6\u3002\u663e\u793a\u5bbd\u5ea6\u5e76\u4e0d\u5f71\u54cd\u53ef\u4ee5\u5b58\u50a8\u5728\u8be5\u5217\u4e2d\u7684\u6700\u5927\u503c\u3002INT(5) \u548c INT(11)\u53ef\u4ee5\u5b58\u50a8\u76f8\u540c\u7684\u6700\u5927\u503c\uff0c\u90fd\u662fINT\u6700\u5927\u503c\u3002\n-- int(11)\u8868\u793a\u663e\u793a\u5bbd\u5ea6\uff0c\u5f53\u5217\u8bbe\u7f6e\u4e3aUNSIGNED ZEROFILL\u65f6\uff0cINT(11)\u624d\u6709\u610f\u4e49\uff0c\u5176\u8868\u793a\u7684\u610f\u601d\u4e3a\u5982\u679c\u8981\u5b58\u50a8\u7684\u6570\u5b57\u5c11\u4e8e11\u4e2a\u5b57\u7b26\uff0c\u5219\u8fd9\u4e9b\u6570\u5b57\u5c06\u5728\u5de6\u4fa7\u8865\u96f6\u3002\n-- \u5bf9\u4e8eMySQL 8.0.17\uff0cINT\u7c7b\u578b\u7684\u5217\u5bbd\u5ea6\u5c5e\u6027\u5df2\u7ecf\u88abdeprecated\n\n-- SERIAL \u662f BIGINT UNSIGNED NOT NULL AUTO_INCREMENT UNIQUE \u7684\u522b\u540d\u3002\n\n\n\nINSERT INTO demo_a(a,b) VALUES(1, 1);\n-- \u67e5\u8be2\u65f6\uff0c\u663e\u793a\u7684\u5bbd\u5ea6\u662f11\u4f4d\u6570\nmysql&gt; SELECT * FROM demo_a;\n+----+---+-------------+\n| id | a | b           |\n+----+---+-------------+\n|  1 | 1 | 00000000001 |\n+----+---+-------------+\n1 row in set (0.18 sec)\n</code></pre>"},{"location":"basic/7.MySQL%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/#_5","title":"\u5b9a\u70b9\u578b\u7c7b\u578b\uff08\u7cbe\u786e\u503c\uff09","text":"<p>DECIMAL \u548c NUMERIC \u7c7b\u578b\u80fd\u5b58\u50a8\u7cbe\u786e\u7684\u6570\u503c\u6570\u636e\u3002\u53ef\u4ee5\u5b58\u5c0f\u6570\u4f4d\u3002\u8fd9\u4e9b\u7c7b\u578b\u9002\u7528\u4e8e\u91cd\u89c6\u7cbe\u786e\u5ea6\u7684\u9700\u6c42\uff0c\u5982\u8d27\u5e01\u6570\u636e\u3002</p> \u7c7b\u578b \u5360\u7528\u5b58\u50a8 (Bytes) \u6709\u7b26\u53f7\u53d6\u503c\u8303\u56f4 \u65e0\u7b26\u53f7\u53d6\u503c\u8303\u56f4 \u8bf4\u660e\u5907\u6ce8 float 4 bytes \u5355\u7cbe\u5ea6\u6d6e\u70b9\u6570 double 8 bytes \u53cc\u7cbe\u5ea6\u6d6e\u70b9\u6570 decimal \u5b9a\u70b9\u578b <pre><code>-- \u6d6e\u70b9\u7c7b\u578b\u548c\u5b9a\u70b9\u7c7b\u578b\u90fd\u53ef\u4ee5\u7528 TYPE(M, D)\u6765\u8868\u793a\uff0c\u5176\u4e2dM\u79f0\u4e3a\u7cbe\u5ea6\uff0c\u8868\u793a\u603b\u5171\u7684\u4f4d\u6570\uff1bD\u79f0\u4e3a\u6807\u5ea6\uff0c\u8868\u793a\u5c0f\u6570\u7684\u4f4d\u6570\u3002\n-- FLOAT(7,4) \u8868\u793a -999.9999\n-- \u4e0d\u8bba\u662f\u5b9a\u70b9\u8fd8\u662f\u6d6e\u70b9\u7c7b\u578b\uff0c\u5982\u679c\u7528\u6237\u6307\u5b9a\u7684\u7cbe\u5ea6\u8d85\u51fa\u7cbe\u5ea6\u8303\u56f4\uff0c\u5219\u4f1a\u56db\u820d\u4e94\u5165\u8fdb\u884c\u5904\u7406\u3002\n-- FLOAT \u548c DOUBLE \u5728\u4e0d\u6307\u5b9a\u7cbe\u5ea6\u65f6\uff0c\u9ed8\u8ba4\u4f1a\u6309\u7167\u5b9e\u9645\u7684\u7cbe\u5ea6\uff08\u7531\u8ba1\u7b97\u673a\u786c\u4ef6\u548c\u64cd\u4f5c\u7cfb\u7edf\u51b3\u5b9a\uff09\uff0cDECIMAL \u5982\u679c\u4e0d\u6307\u5b9a\u7cbe\u5ea6\uff0c\u9ed8\u8ba4\u4e3a\uff0810\uff0c0\uff09\u3002\n-- DOUBLE \u5b9e\u9645\u4e0a\u662f\u4ee5\u5b57\u7b26\u4e32\u7684\u5f62\u5f0f\u5b58\u653e\u7684\uff0cDECIMAL \u53ef\u80fd\u7684\u6700\u5927\u53d6\u503c\u8303\u56f4\u4e0e DOUBLE \u76f8\u540c\uff0c\u4f46\u662f\u6709\u6548\u7684\u53d6\u503c\u8303\u56f4\u7531 M \u548c D \u51b3\u5b9a\u3002\u5982\u679c\u6539\u53d8 M \u800c\u56fa\u5b9a D\uff0c\u5219\u53d6\u503c\u8303\u56f4\u5c06\u968f M \u7684\u53d8\u5927\u800c\u53d8\u5927\u3002\n\n-- \u6d6e\u70b9\u6570\u76f8\u5bf9\u4e8e\u5b9a\u70b9\u6570\u7684\u4f18\u70b9\u662f\u5728\u957f\u5ea6\u4e00\u5b9a\u7684\u60c5\u51b5\u4e0b\uff0c\u6d6e\u70b9\u6570\u80fd\u591f\u8868\u793a\u66f4\u5927\u7684\u8303\u56f4\uff1b\u7f3a\u70b9\u662f\u4f1a\u5f15\u8d77\u7cbe\u5ea6\u95ee\u9898\u3002\n-- \u5728MySQL\u4e2d\uff0c\u5b9a\u70b9\u6570\u4ee5\u5b57\u7b26\u4e32\u5f62\u5f0f\u5b58\u50a8\uff0c\u5728\u5bf9\u7cbe\u5ea6\u8981\u6c42\u6bd4\u8f83\u9ad8\u7684\u65f6\u5019\uff08\u5982\u8d27\u5e01\u3001\u79d1\u5b66\u6570\u636e\uff09\uff0c\u4f7f\u7528 DECIMAL \u7684\u7c7b\u578b\u6bd4\u8f83\u597d\uff0c\u53e6\u5916\u4e24\u4e2a\u6d6e\u70b9\u6570\u8fdb\u884c\u51cf\u6cd5\u548c\u6bd4\u8f83\u8fd0\u7b97\u65f6\u4e5f\u5bb9\u6613\u51fa\u95ee\u9898\uff0c\u6240\u4ee5\u5728\u4f7f\u7528\u6d6e\u70b9\u6570\u65f6\u9700\u8981\u6ce8\u610f\uff0c\u5e76\u5c3d\u91cf\u907f\u514d\u505a\u6d6e\u70b9\u6570\u6bd4\u8f83\u3002\n</code></pre>"},{"location":"basic/7.MySQL%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/#_6","title":"\u6574\u6570\u5b57\u6bb5\u8bbe\u8ba1","text":"<p>\u5728\u771f\u5b9e\u4e1a\u52a1\u573a\u666f\u4e2d\uff0c\u6574\u578b\u7c7b\u578b\u6700\u5e38\u89c1\u7684\u5c31\u662f\u5728\u4e1a\u52a1\u4e2d\u7528\u6765\u8868\u793a\u67d0\u4ef6\u7269\u54c1\u7684\u6570\u91cf\u3002\u4f8b\u5982\u7535\u5546\u4e1a\u52a1\u4e2d\u7684\u4ea7\u54c1\u8868\u7684\u9500\u552e\u6570\u91cf\uff0c\u4ea7\u54c1\u7684\u5e93\u5b58\u6570\u91cf\u3001\u8d2d\u4e70\u6b21\u6570\u7b49\u3002</p>"},{"location":"basic/7.MySQL%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/#_7","title":"\u81ea\u589e\u5217","text":"<pre><code>CREATE TABLE animals (\n     id MEDIUMINT NOT NULL AUTO_INCREMENT,\n     name CHAR(30) NOT NULL,\n     PRIMARY KEY (id)\n);\n\nINSERT INTO animals (name) VALUES\n    ('dog'),('cat'),('penguin'),\n    ('lax'),('whale'),('ostrich');\n\nSELECT * FROM animals;\n+----+---------+\n| id | name    |\n+----+---------+\n|  1 | dog     |\n|  2 | cat     |\n|  3 | penguin |\n|  4 | lax     |\n|  5 | whale   |\n|  6 | ostrich |\n+----+---------+\n</code></pre>"},{"location":"basic/7.MySQL%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/#uuid","title":"\u81ea\u589e\u4e3b\u952e\u8fd8\u662f UUID \u4e3b\u952e","text":"<p>UUID \u662f\u8bbe\u8ba1\u6210\u4e00\u4e2a\u65f6\u95f4\u548c\u7a7a\u95f4\u4e0a\u5168\u5c40\u552f\u4e00\u7684\u6570\u5b57\u3002\u4e24\u6b21\u8c03\u7528 <code>UUID()</code> \u51fd\u6570\u4f1a\u4ea7\u751f\u4e0d\u540c\u7684\u503c\u3002</p> <p>\u8fd4\u56de\u7684\u662f\u662f 128 \u4f4d\u7684\u6570\u5b57\uff0c</p>"},{"location":"basic/7.MySQL%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/#_8","title":"\u6570\u636e\u6ea2\u51fa","text":"<p>MySQL \u4e2d\u7684\u5404\u79cd\u6570\u503c\u7c7b\u578b\u90fd\u6709\u53d6\u503c\u8303\u56f4\uff0c\u6240\u4ee5\u63d2\u5165\u8fc7\u5927\u7684\u503c\u80af\u5b9a\u5b58\u5728\u6ea2\u51fa\u3002MySQL \u5982\u4f55\u5904\u7406\u6ea2\u51fa\uff0c\u53d6\u51b3\u4e8e<code>sql_mode</code>\uff1a</p> <ul> <li>\u5982\u679c\u662f\u4e25\u683c\u6a21\u5f0f\uff0c\u5904\u7406\u6ea2\u51fa\u60c5\u51b5\u76f4\u63a5\u62a5\u9519\uff0c\u4e0e\u6807\u51c6 SQL \u7684\u5904\u7406\u65b9\u5f0f\u4e00\u81f4\u3002</li> </ul> <p>-</p>"},{"location":"basic/7.MySQL%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/#_9","title":"\u5b57\u7b26\u548c\u5b57\u7b26\u4e32\u7c7b\u578b","text":"<p>\u5b57\u7b26\u7c7b\u578b\u5305\u62ec CHAR\u3001VARCHAR\u3001BINARY\u3001VARBINARY\u3001BLOB\u3001TEXT\u3001ENUM\u3001SET\u3002</p> <ul> <li> <p>\u5bf9\u4e8e\u5b57\u7b26\u4e32\u5217\uff08CHAR\u3001VARCHAR\u3001TEXT\uff09\uff0cMySQL \u4ee5\u5b57\u7b26\u6570\u91cf\u4e3a\u5355\u4f4d\u58f0\u660e\u957f\u5ea6\u3002</p> </li> <li> <p>\u5bf9\u4e8e\u4e8c\u8fdb\u5236\u4e32\uff08BINARY\u3001VARBINARY\u3001BLOB\uff09\uff0cMySQL \u4ee5\u5b57\u8282\u6570\u4e3a\u5355\u4f4d\u58f0\u660e\u957f\u5ea6\u3002</p> </li> <li> <p>\u5b57\u8282\uff1a\u5b57\u8282\u662f\u8ba1\u7b97\u673a\u4e2d\u7684\u5b58\u50a8\u5355\u4f4d\uff1a<code>1GB=1024MB\uff0c1MB=1024KB\uff0c1KB=1024Byte\uff0c1Byte=8Bit</code>\u3002\u5176\u4e2d\u7684<code>Byte</code>\u5c31\u662f\u5b57\u8282\u3002</p> </li> <li> <p>\u5b57\u7b26(character)\uff1a\u53ef\u4ee5\u7406\u89e3\u4e3a\u4e00\u4e2a\u6570\u5b57\u3001\u5b57\u6bcd\u3001\u6c49\u5b57\u3001\u6807\u70b9\u7b26\u53f7\uff0c\u6bd4\u5982\uff1a\u6570\u5b57 1 \u662f\u4e00\u4e2a\u5b57\u7b26\uff0c\u6570\u5b57 9 \u4e5f\u662f\u4e00\u4e2a\u5b57\u7b26\uff0c\u4f46\u662f\u6570\u5b57 10 \u5c31\u662f\u4e24\u4e2a\u5b57\u7b26\uff1b\u5b57\u6bcd a \u5c31\u662f\u4e00\u4e2a\u5b57\u7b26\uff0c\u5b57\u6bcd B \u4e5f\u662f\u4e00\u4e2a\u5b57\u7b26\uff0c\u5b57\u6bcd aB \u5c31\u662f\u4e24\u4e2a\u5b57\u7b26\uff1b\u6c49\u5b57\u4f60\u4e5f\u662f\u4e00\u4e2a\u5b57\u7b26\uff0c\u6c49\u5b57\u6211\u4e5f\u662f\u4e00\u4e2a\u5b57\u7b26\uff0c\u6c49\u5b57\u4f60\u6211\u5c31\u662f\u4e24\u4e2a\u5b57\u7b26\uff1b\u6807\u70b9\u7b26\u53f7?\u662f\u4e00\u4e2a\u5b57\u7b26\uff0c\u6807\u70b9\u7b26\u53f7!\u4e5f\u662f\u4e00\u4e2a\u5b57\u7b26\uff0c\u5f53\u7136\u8fd9\u91cc\u7684\u6807\u70b9\u7b26\u53f7\u6709\u5168\u89d2\u548c\u534a\u89d2\u4e4b\u5206\uff0c\u4f46\u662f\u4e0d\u7ba1\u5168\u89d2\u8fd8\u662f\u534a\u89d2\uff0c\u5b83\u4eec\u90fd\u662f\u5c5e\u4e8e\u4e0d\u540c\u7684\u5b57\u7b26\uff0c\u4e5f\u5c31\u662f\u8bf4\u534a\u89d2\u7684?\u548c\u5168\u89d2\u7684\uff1f\u662f\u4e24\u4e2a\u4e0d\u540c\u7684\u5b57\u7b26\u3002</p> </li> </ul> \u6570\u636e\u7c7b\u578b \u7c7b\u578b M \u53d6\u503c\u8303\u56f4 M \u542b\u4e49 \u8bf4\u660e\u5907\u6ce8 \u5b9a\u957f\u5b57\u7b26\u4e32 CHAR(M) 0-255 \u8868\u793a\u5b57\u6bb5\u6240\u80fd\u5bb9\u7eb3\u6700\u5927\u5b57\u7b26\u6570\u91cf \u56fa\u5b9a\u957f\u5ea6\u975e\u4e8c\u8fdb\u5236\u5b57\u7b26\u4e32\uff1a\u5b57\u7b26\u6570\u91cf\u548c\u5b58\u50a8\u90fd\u662f\u56fa\u5b9a\u7684 \u53d8\u957f\u5b57\u7b26\u4e32 VARCHAR(M) (0, 65535] \u8868\u793a\u5b57\u6bb5\u6240\u80fd\u5bb9\u7eb3\u6700\u5927\u5b57\u7b26\u6570\u91cf \u53d8\u957f\u975e\u4e8c\u8fdb\u5236\u5b57\u7b26\u4e32\uff1a\u5b57\u7b26\u8d8a\u591a\uff0c\u5b58\u50a8\u5360\u7528\u8d8a\u591a <p>\u5728 MySQL \u4e2d\uff0c\"\u53d8\u957f\"\u6307\u7684\u662f\u5b58\u50a8\u5728\u6570\u636e\u5e93\u4e2d\u7684\u6570\u636e\u957f\u5ea6\u662f\u6839\u636e\u6570\u636e\u5b9e\u9645\u957f\u5ea6\u6765\u53d8\u5316\u7684\uff1b\u800c\"\u5b9a\u957f\"\u5219\u6307\u6570\u636e\u5b58\u50a8\u5728\u6570\u636e\u5e93\u4e2d\u65f6\u6709\u56fa\u5b9a\u7684\u957f\u5ea6\uff0c\u5728\u5360\u7528\u7a7a\u95f4\u4e0a\u6bd4\u8f83\u521a\u6027\u3002</p> <p>\u5177\u4f53\u6765\u8bf4\uff0c\u5728 MySQL \u4e2d\uff0cVARBINARY \u548c VARCHAR \u90fd\u662f**\u53d8\u957f\u6570\u636e\u7c7b\u578b**\uff0c\u5b58\u50a8\u7684\u6570\u636e\u957f\u5ea6\u662f\u53ef\u53d8\u7684\uff0c\u56e0\u6b64\u5728\u5b58\u50a8\u6570\u636e\u65f6\u4e0d\u9700\u8981\u9884\u7559\u7a7a\u95f4\uff08\u9664\u4e86\u4e00\u4e9b\u989d\u5916\u7684\u5b58\u50a8\u5f00\u9500\uff09\uff0c\u4ece\u800c\u8282\u7701\u4e86\u5b58\u50a8\u7a7a\u95f4\u3002</p> <p>\u800c\u5728\u5b58\u50a8\u5b9a\u957f\u6570\u636e\u65f6\uff0c\u53ef\u4ee5\u4f7f\u7528 BINARY \u548c CHAR \u7b49\u6570\u636e\u7c7b\u578b\uff0c\u8fd9\u4e9b\u7c7b\u578b\u7684\u6570\u636e\u957f\u5ea6\u662f\u56fa\u5b9a\u7684\uff0c\u65e0\u8bba\u5b9e\u9645\u5b58\u50a8\u7684\u6570\u636e\u957f\u5ea6\u662f\u591a\u5c11\uff0c\u6240\u5360\u7528\u7684\u7a7a\u95f4\u4e00\u76f4\u662f\u56fa\u5b9a\u7684\u3002\u53e6\u5916\uff0c\u901a\u5e38\u60c5\u51b5\u4e0b\uff0c\u53d8\u957f\u6570\u636e\u7c7b\u578b\u66f4\u9002\u5408\u7528\u4e8e\u5b58\u50a8\u6587\u672c\u6570\u636e\uff0c\u800c\u5b9a\u957f\u6570\u636e\u7c7b\u578b\u5219\u66f4\u9002\u5408\u7528\u4e8e\u5b58\u50a8\u4e8c\u8fdb\u5236\u6570\u636e\uff0c\u5982\u97f3\u9891\u3001\u89c6\u9891\u3001\u56fe\u50cf\u7b49\u3002</p> <ul> <li>\u5728 MySQL5.0 \u4ee5\u540e\u7684\u7248\u672c\u4e2d\uff0cM \u8868\u793a\u5f53\u524d\u5b57\u6bb5\u7684\u5b57\u7b26\u96c6\u7f16\u7801\u4e0b\uff0c\u5b57\u7b26\u7684\u4e2a\u6570\uff0c\u4e5f\u53eb\u5217\u957f\u5ea6\u3002\u5bf9\u4e8e\u4e0d\u540c\u7684\u5b57\u7b26\u96c6\u7f16\u7801\uff0c\u5355\u4e2a\u5b57\u7b26\u6240\u5360\u7528\u7684\u7a7a\u95f4\u53ef\u80fd\u6709\u6240\u4e0d\u540c\u3002</li> <li>row size limit \u9650\u5236\uff1a\u65e0\u8bba\u4ec0\u4e48\u5b57\u7b26\u96c6\uff0c\u65e0\u8bba\u4ec0\u4e48\u7c7b\u578b\u7684\u5b57\u7b26\u4e32\uff0c\u8868\u4e2d\u7684\u4e00\u884c\u6570\u636e\u7684\u6240\u6709\u5217\u52a0\u5728\u4e00\u8d77\u6700\u5b57\u8282\u5927\u957f\u5ea6\u9650\u5236\u4e3a<code>65535</code>\u4e2a byte\u3002\uff08blob \u548c text \u7c7b\u578b\u7684\u5217\u53ea\u5360\u7528 9-12 \u4e2a bytes\uff0c\u56e0\u4e3a\u5b83\u4eec\u662f\u5355\u72ec\u5b58\u50a8\u7684\uff09</li> </ul> <p>\u5bf9\u4e8e\u5217\u5bbd\u7684\u9650\u5236\uff1a</p> <ul> <li>MySQL Server \u5c42\u5bf9\u5355\u8868\u652f\u6301\u6700\u591a 4096 \u5217\uff08\u53c2\u8003\uff09\uff0cInnoDB \u5f15\u64ce\u5c42\u6700\u591a\u652f\u6301 1017 \u5217\u3002\uff08\u53c2\u8003\uff09</li> <li>\u5982\u679c\u8868\u53ea\u6709\u4e00\u4e2a utf8mb4 \u7f16\u7801\u7684 VARCHAR \u5217\uff0c\u5217\u6700\u5927\u5b57\u7b26\u957f\u5ea6\u4e3a 65535/4 = 16383</li> <li>MySQL \u5185\u90e8\u89c4\u5b9a\uff0c\u8868\u5185\u6240\u6709\u5217\u52a0\u5728\u4e00\u8d77\u5360\u7528\u7684\u5b57\u8282\u6570\u4e0d\u80fd\u5927\u4e8e 65535 \uff0c\u4e0d\u7ba1\u4efb\u4f55\u5b58\u50a8\u5f15\u64ce\uff0c\u90fd\u4e0d\u80fd\u8d85\u8fc7\u8fd9\u4e2a\u8303\u56f4\uff0c\u5373\u5b58\u50a8\u5f15\u64ce\u652f\u6301\u4e00\u884c\u5b58\u50a8\u66f4\u957f\u7684\u6570\u636e\u3002</li> <li> <p>\u5bf9\u4e8e InnoDB \u5f15\u64ce\uff0c\u5217\u5bbd\u8fd8\u53d6\u51b3\u4e8e innodb_page_size\uff0c\u5bf9\u4e8e 4K,8K,16K \u548c 32K \u7684\u9875\u9762\u5927\u5c0f\uff0c\u9650\u5236\u4e00\u6761\u8bb0\u5f55\u6700\u591a\u4f7f\u7528\u534a\u4e2a\u9875\u9762\uff0c64K \u9875\u9762\u6bd4 16KB \u9875\u9762\u9650\u5236\u7a0d\u5c0f\u4e00\u4e9b\u3002\u53c2\u8003</p> </li> <li> <p>\u5bf9\u4e8e\u4e0d\u540c\u7684\u5b57\u7b26\u96c6\u7684\u5b57\u6bb5\uff0cvarchar \u7c7b\u578b\u7684\u5217\u6700\u5927\u5b57\u7b26\u6570\u91cf\u5982\u4e0b\uff1a</p> </li> </ul> \u5b57\u7b26\u96c6 \u5355\u4e2a\u5b57\u7b26\u5360\u7528\u5b57\u8282\u6570 VARCHAR \u6700\u5927\u5217\u957f\u5ea6\u7684\u53d6\u503c\u8303\u56f4(\u5b57\u7b26\u4e2a\u6570) \u80fd\u5426\u4e2d\u6587 ascii 1 byte (0, 65535] \u4e0d\u80fd latin1 1 byte (0, 65535] \u4e0d\u80fd binary 1 byte (0, 65535] \u4e0d\u80fd utf8 3 byte (0, 21845] \u53ef\u4ee5 utf8mb4 4 byte (0, 16383] \u53ef\u4ee5 <ul> <li>\u5047\u8bbe\u5728 latin1 \u5b57\u7b26\u96c6\u4e0b\u3002\u63d2\u5165\u503c\u5360\u7528\u60c5\u51b5\u5982\u4e0b\uff1a</li> </ul> \u63d2\u5165\u503c CHAR(4)\u5b58\u5165\u503c CHAR(4)\u5360\u636e\u7a7a\u95f4 VARCHAR(4)\u5b58\u5165\u503c VARCHAR(4)\u5360\u636e\u7a7a\u95f4 <code>''</code>(\u7a7a\u5b57\u7b26\u4e32) <code>'    '</code> 4 bytes <code>''</code> 1 byte <code>'ab'</code> <code>'ab  '</code> 4 bytes <code>'ab'</code> 3 bytes <code>'abcd'</code> <code>'abcd'</code> 4 bytes <code>'abcd'</code> 5 bytes <code>'abcdefgh'</code> <code>'abcd'</code> 4 bytes <code>'abcd'</code> 5 bytes <ul> <li>\u5bf9\u4e8e\u5b9a\u957f\u5b57\u7b26\u4e32\uff0c\u65e0\u8bba\u63d2\u5165\u8fc7\u957f\u6216\u8fc7\u77ed\uff0c\u90fd\u8981\u5360\u636e\u56fa\u5b9a\u957f\u5ea6\u7684\u5b57\u7b26\u6570\u91cf\u548c\u5b58\u50a8\u7a7a\u95f4\uff0c\u8fc7\u77ed\u4f1a\u5728\u53f3\u8fb9\u8865\u7a7a\u5b57\u7b26\uff0c\u8fc7\u957f\u4f1a\u622a\u53d6\u3002</li> <li>\u5bf9\u4e8e\u53d8\u957f\u5b57\u7b26\u4e32\uff0c\u5b9e\u9645\u5b58\u5165\u591a\u5c11\uff0c\u5c31\u5360\u7528\u591a\u5c11\u3002\u5b58\u50a8\u8d85\u8fc7\u7684\uff0c\u53ef\u80fd\u4f1a\u62a5\u9519\uff08\u53d6\u51b3\u4e8e\u662f\u5426\u8bbe\u7f6e\u4e3a\u4e25\u683c\u6a21\u5f0f\uff09\u6216\u8005\u622a\u53d6\u3002</li> </ul> <pre><code>CREATE TABLE vc (v VARCHAR(4), c CHAR(4));\nINSERT INTO vc VALUES ('12', '12');\nINSERT INTO vc VALUES ('ab  ', 'ab  ');\nINSERT INTO vc VALUES ('123456', '123456'); --\u8fd9\u884c\u4f1a\u62a5\u9519:Data to long...\nSELECT CONCAT('(', v, ')'), CONCAT('(', c, ')') FROM vc;\n\n\n\n\n\n\n-- \u5217\u5bbd\u9650\u5236\n\n-- \u5bf9\u4e8e\u8fd9\u6837\u7684\u5efa\u8868\u8bed\u53e5\uff0c\u76f4\u63a5\u62a5\u9519\n-- ERROR 1118 (42000): Row size too large. The maximum row size for the used table type, not counting BLOBs, is 65535\nCREATE TABLE t (\n    a VARCHAR(10000),\n    b VARCHAR(10000),\n    c VARCHAR(10000),\n    d VARCHAR(10000),\n    e VARCHAR(10000),\n    f VARCHAR(10000),\n    g VARCHAR(6000)\n) ENGINE=InnoDB CHARACTER SET latin1;\n\n\nCREATE TABLE t (\n    a VARCHAR(10000),\n    b VARCHAR(10000),\n    c VARCHAR(10000),\n    d VARCHAR(10000),\n    e VARCHAR(10000),\n    f VARCHAR(10000),\n    g TEXT(6000)\n) ENGINE=InnoDB CHARACTER SET latin1;\n</code></pre>"},{"location":"basic/7.MySQL%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/#mysql-varchar255-varchar256","title":"MySQL \u4e3a\u4ec0\u4e48\u5efa\u8bae\u5b9a\u4e49 varchar(255) \u800c\u4e0d\u662f varchar(256)","text":"<p>\u6211\u4eec\u5728\u5b9a\u4e49\u4e00\u4e2a\u5b57\u6bb5<code>varchar(n)</code>\u7684\u65f6\u5019\uff0c\u6570\u636e\u5e93\u5728\u5e95\u5c42\u8981\u77e5\u9053\u8fd9\u4e2a\u5b57\u6bb5\u7684\u6700\u5927\u957f\u5ea6\u662f\u591a\u5c11\u3002\u8fd9\u4e2a\u6709\u70b9\u50cf\u5143\u6570\u636e\u3002</p> <ul> <li> <p>\u6211\u4eec\u5b9a\u4e49\u4e3a varchar(1)\uff0c\u90a3\u4e48\u4ed6\u5c31\u77e5\u9053\u8fd9\u4e2a\u5b57\u6bb5\u7684\u6700\u5927\u957f\u5ea6\u4e3a 1\uff0c\u5e95\u5c42\u8981\u8bb0\u5f55\u597d\u8fd9\u4e2a 1\uff1b</p> </li> <li> <p>\u6211\u4eec\u5b9a\u4e49\u4e3a varchar(255)\uff0c\u90a3\u4e48\u4ed6\u5c31\u77e5\u9053\u8fd9\u4e2a\u5b57\u6bb5\u7684\u6700\u5927\u957f\u5ea6\u4e3a 255\uff0c\u5e95\u5c42\u8981\u8bb0\u5f55\u597d\u8fd9\u4e2a 255\uff1b</p> </li> <li> <p>\u6211\u4eec\u5b9a\u4e49\u4e3a varchar(256)\uff0c\u90a3\u4e48\u4ed6\u5c31\u77e5\u9053\u8fd9\u4e2a\u5b57\u6bb5\u7684\u6700\u5927\u957f\u5ea6\u4e3a 256\uff0c\u5e95\u5c42\u8981\u8bb0\u5f55\u597d\u8fd9\u4e2a 256\uff1b</p> </li> </ul> <p>\u6570\u636e\u5728\u5e95\u5c42\u5b58\u50a8\u7684\u65f6\u5019\uff0c\u5b83\u4e0d\u662f\u76f4\u63a5\u628a 1 \u6216 255 \u8fd9\u6837\u7684\u6574\u6570\u76f4\u63a5\u4ee5\u5341\u8fdb\u5236\u7684\u65b9\u5f0f\u5b58\u50a8\u7684\uff0c\u5b83\u662f\u628a 1 \u548c 255 \u8fd9\u6837\u7684\u6574\u6570\u8f6c\u6362\u4e3a\u4e8c\u8fdb\u5236\u7684\u65b9\u5f0f\u6765\u5b58\u50a8\u7684\uff0c\u5168\u90e8\u90fd\u662f 0 \u6216 1 \u7684\u65b9\u5f0f\u6765\u5b58\u50a8\u3002</p> <p>\u5173\u4e8e\u5b57\u6bb5\u6700\u5927\u957f\u5ea6\u6807\u8bc6\u7684\u5143\u6570\u636e\uff0c\u5982\u679c\u662f 255\uff0c\u7528 tinyint \u6765\u6807\u8bc6\uff0c\u5143\u6570\u636e\u5360\u7528\u4e00\u4e2a\u5b57\u8282\u3002\u5982\u679c\u8d85\u8fc7 255\uff0c\u8981\u7528 smallint \u6765\u6807\u8bc6\uff0c\u5143\u6570\u636e\u5360\u7528\u4e24\u4e2a\u5b57\u8282\u3002</p> <p>\u5f53\u5b9e\u9645\u957f\u5ea6\u5927\u4e8e 255 \u7684\u65f6\u5019\uff0cvarchar \u53d8\u957f\u5b57\u6bb5\u6700\u5927\u957f\u5ea6\u9700\u8981\u7528\u4e24\u4e2a\u5b57\u8282\u5b58\u50a8\u63cf\u8ff0\uff0c\u4e5f\u5c31\u610f\u5473\u7740\u6bcf\u4e00\u884c\u6570\u636e\u90fd\u4f1a\u589e\u52a0 1 \u4e2a\u5b57\u8282\uff0c\u6240\u4ee5\u5728\u6211\u4eec\u7684\u6570\u636e\u957f\u5ea6\u4e0d\u53ef\u80fd\u8d85\u8fc7 255 \u7684\u60c5\u51b5\u4e0b\uff0c\u6211\u4eec\u5c3d\u91cf\u4e0d\u8981\u521b\u5efa\u8d85\u8fc7 255 \u957f\u5ea6\u7684 varchar \u7c7b\u578b\u7684\u5b57\u6bb5\u3002</p> <p>\u5f53\u6211\u4eec\u5b9a\u4e49\u4e00\u4e2a varchar(255)\u7684\u5b57\u6bb5\u65f6\uff0c\u5b83\u771f\u5b9e\u4f7f\u7528\u7684\u7a7a\u95f4\u662f 256\uff08255+1\uff09\u5b57\u8282\uff1b\uff08\u6ce8\u610f\uff0c\u5b57\u6bb5\u975e\u7a7a\uff0clatin1 \u7f16\u7801\uff09</p> <p>\u5f53\u6211\u4eec\u5b9a\u4e49\u4e00\u4e2a varchar(256)\u7684\u5b57\u6bb5\u65f6\uff0c\u5b83\u771f\u5b9e\u4f7f\u7528\u7684\u7a7a\u95f4\u662f 258\uff08256+2\uff09\u5b57\u8282</p> <pre><code>--\u9a8c\u8bc1\n\n\n-- \u8bd5\u7740\u521b\u5efa\u4e00\u4e2a\u5b57\u6bb5\u957f\u5ea6\u8d85\u8fc7mysql\u9650\u5236\u7684\u8868\uff0c\u4ece\u7cfb\u7edf\u63d0\u793a\u77e5\u9053\uff0c\u5217\u957f\u5ea6\u4e0d\u80fd\u8d85\u8fc765535\nmysql&gt; create table test_varchar_length(v varchar(65536) not null) CHARSET=latin1;\nERROR 1074 (42000): Column length too big for column 'v' (max = 65535); use BLOB or TEXT instead\n\n-- \u521b\u5efa\u4e00\u4e2a\u5b57\u6bb5\u957f\u5ea6\u5c0f\u4e8emax, 65534\u7684\u8868\uff0c\u7ee7\u7eed\u5931\u8d25\nmysql&gt; create table test_varchar_length(v varchar(65534) not null) CHARSET=latin1;\nERROR 1118 (42000): Row size too large. The maximum row size for the used table type, not counting BLOBs, is 65535. This includes storage overhead, check the manual. You have to change some columns to TEXT or BLOBs\n\n-- \u521b\u5efa\u4e00\u4e2a65533\u7684\u8868\uff0c65533+2=65535(max), \u6210\u529f\nmysql&gt; create table test_varchar_length(v varchar(65533) not null) CHARSET=latin1;\nQuery OK, 0 rows affected (0.05 sec)\n</code></pre>"},{"location":"basic/7.MySQL%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/#varchar","title":"varchar \u53d8\u957f\u4e3a\u4ec0\u4e48\u4e0d\u662f\u8d8a\u5927\u8d8a\u597d\uff1f","text":"<p>varchar(10) \u548c VARCHAR(1000) \u90fd\u662f\u53d8\u957f\uff0c\u53cd\u6b63\u4e0d\u989d\u5916\u5360\u7528\u5b58\u50a8\uff0c\u4e3a\u4ec0\u4e48\u4e0d\u662f\u8d8a\u5927\u8d8a\u597d\uff0c\u7701\u5f97\u4ee5\u540e\u8981\u52a0\u957f\u53c8\u8981\u6539\u53d8\u5b57\u6bb5\u5b9a\u4e49\u3002</p> <ul> <li>\u7b2c\u4e00\u4e2a\u539f\u56e0\uff0c\u5b58\u50a8\u5b57\u6bb5\u65f6\uff0c\u5b57\u6bb5\u6700\u5927\u5b57\u7b26\u957f\u5ea6\u8fd9\u4e2a\u5143\u6570\u636e\u4e5f\u8981\u5360\u4e0d\u540c\u7a7a\u95f4\uff0c\u4e0a\u9762\u8bf4\u7684 255 \u548c 256 \u533a\u522b\uff0c\u907f\u514d\u6d6a\u8d39</li> <li>\u5b57\u6bb5\u957f\u5ea6\u662f\u6570\u636e\u5e93\u4e00\u79cd\u7ea6\u675f\uff0c\u53ef\u4ee5\u4fdd\u8bc1\u8fdb\u5165\u6570\u636e\u5e93\u7684\u6570\u636e\u7b26\u5408\u957f\u5ea6\u8981\u6c42\uff0c\u5b9a\u4e49\u5408\u7406\u7684\u5b57\u6bb5\u957f\u5ea6\u53ef\u4ee5\u51cf\u5c11\u4e00\u90e8\u4efd\u975e\u6cd5\u6570\u636e\u8fdb\u5165\u3002</li> </ul>"},{"location":"basic/7.MySQL%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/#_10","title":"\u957f\u6587\u672c\u7c7b\u578b","text":"<p>TEXT \u662f\u4e00\u4e2a\u80fd\u591f\u5b58\u50a8\u5927\u91cf\u7684\u6570\u636e\u7684\u5927\u5bf9\u8c61\uff0c\u6709\u56db\u79cd\u7c7b\u578b\uff1aTINYTEXT, TEXT, MEDIUMTEXT, LONGTEXT, \u4e0d\u540c\u7c7b\u578b\u5b58\u50a8\u7684\u503c\u8303\u56f4\u4e0d\u540c</p> <p>TEXT \u503c\u88ab\u89c6\u4e3a\u975e\u4e8c\u8fdb\u5236\u5b57\u7b26\u4e32\uff08\u5b57\u7b26\u4e32\uff09\u3002\u5b83\u4eec\u5177\u6709 binary \u4ee5\u5916\u7684\u5b57\u7b26\u96c6\uff0c\u5e76\u6839\u636e\u5b57\u7b26\u96c6\u7684\u6821\u5bf9\u65b9\u5f0f\u5bf9\u503c\u8fdb\u884c\u6392\u5e8f\u548c\u6bd4\u8f83\u3002</p> <p>BLOB \u662f\u4e8c\u8fdb\u5236\u5927\u5bf9\u8c61\uff0c\u53ef\u5bb9\u7eb3\u53ef\u53d8\u6570\u636e\u91cf\u3002\u56db\u79cd BLOB \u7c7b\u578b\u662f TINYBLOB \u3001 BLOB \u3001 MEDIUMBLOB \u548c LONGBLOB</p> <p>BLOB \u503c\u88ab\u89c6\u4e3a\u4e8c\u8fdb\u5236\u5b57\u7b26\u4e32\uff08\u5b57\u8282\u5b57\u7b26\u4e32\uff09\u3002\u5b83\u4eec\u5177\u6709 binary \u5b57\u7b26\u96c6\u548c\u6821\u5bf9\uff0c\u6bd4\u8f83\u548c\u6392\u5e8f\u57fa\u4e8e\u5217\u503c\u4e2d\u5b57\u8282\u7684\u6570\u503c\u3002</p>"},{"location":"basic/7.MySQL%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/#_11","title":"\u65e5\u671f\u548c\u65f6\u95f4\u7c7b\u578b","text":"<p>MySQL \u63d0\u4f9b\u4e86\u591a\u79cd\u5b58\u50a8\u65f6\u6001 \uff08\u4e0e\u65f6\u95f4\u76f8\u5173\u7684\uff09\u503c\u7684\u6570\u636e\u7c7b\u578b\u3002\u4e3b\u8981\u6709 YEAR\u3001TIME\u3001DATE\u3001DATETIME\u3001TIMESTAMP \u7b49\u3002</p> <p>\u6bcf\u4e2a\u65f6\u95f4\u7c7b\u578b\u5747\u62e5\u6709\u5404\u81ea\u5408\u6cd5\u7684\u53d6\u503c\u8303\u56f4\uff0c\u4ee5\u53ca\u4e00\u4e2a<code>\u96f6\u503c</code>\uff0c\u5373\u5f53\u4f60\u6307\u5b9a\u4e00\u4e2a MySQL \u65e0\u6cd5\u8868\u8fbe\u7684\u975e\u6cd5\u503c\u65f6\u4f1a\u88ab\u66ff\u6362\u4e3a\u8be5\u503c\u3002TIMESTAMP \u548c DATETIME \u6570\u636e\u7c7b\u578b\u62e5\u6709\u7279\u6b8a\u7684\u81ea\u52a8\u66f4\u65b0\u80fd\u529b\u3002</p> \u6570\u636e\u7c7b\u578b \u53d6\u503c\u8303\u56f4 \u5b58\u50a8\u7a7a\u95f4 \u96f6\u503c <code>YEAR</code> 1 byte 1 byte 0000 <code>DATE</code> 3 bytes 3 bytes <code>'0000-00-00'</code> <code>TIME</code> 3 bytes 3 bytes + fractional seconds storage <code>'00:00:00'</code> <code>DATETIME</code> 8 bytes 5 bytes + fractional seconds storage <code>'0000-00-00 00:00:00'</code> <code>TIMESTAMP</code> 4 bytes 4 bytes + fractional seconds storage <code>'0000-00-00 00:00:00'</code>"},{"location":"basic/7.MySQL%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/#_12","title":"\u4e8c\u8fdb\u5236\u7c7b\u578b","text":"<p>MySQL \u652f\u6301\u4e24\u7c7b\u5b57\u7b26\u578b\u6570\u636e\uff1a\u6587\u672c\u5b57\u7b26\u4e32\u548c\u4e8c\u8fdb\u5236\u5b57\u7b26\u4e32\u3002\u4e8c\u8fdb\u5236\u5b57\u7b26\u4e32\u7c7b\u578b\u6709\u65f6\u5019\u4e5f\u76f4\u63a5\u88ab\u79f0\u4e3a<code>\u4e8c\u8fdb\u5236\u7c7b\u578b</code>\u3002</p> <p>BINARY \u548c VARBINARY \u7c7b\u4f3c\u4e8e CHAR \u548c VARCHAR\uff0c\u53ea\u662f\u5b83\u4eec\u5b58\u50a8\u7684\u662f<code>\u4e8c\u8fdb\u5236\u5b57\u7b26\u4e32</code>\u3002\u8fd9\u610f\u5473\u7740\u5b83\u4eec\u62e5\u6709<code>binary</code>\u5b57\u7b26\u96c6\u548c\u6392\u5e8f\u89c4\u5219\u3002</p> <p>\u7b80\u5355\u8bf4\uff0c\u4e8c\u8fdb\u5236\u5b57\u7b26\u4e32\u9002\u7528\u4e8e\u5b58\u50a8\u90a3\u4e9b\u7a0b\u5e8f\u5458\u8ba4\u4e3a\u662f\"\u539f\u59cb\u5b57\u8282\"\u7684\u6570\u636e\uff0c \u800c\u5b57\u7b26\u4e32\u9002\u5408\u5b58\u50a8\u6587\u672c\u3002</p> <ul> <li> <p>BINARY (M)\u4e3a\u56fa\u5b9a\u957f\u5ea6\u7684\u4e8c\u8fdb\u5236\u5b57\u7b26\u4e32\uff0cM \u8868\u793a\u6700\u591a\u80fd\u5b58\u50a8\u7684\u5b57\u8282\u6570\uff0c\u53d6\u503c\u8303\u56f4\u662f 0~255 \u4e2a\u5b57\u7b26\u3002\u5982\u679c\u672a\u6307\u5b9a(M)\uff0c\u8868\u793a\u53ea\u80fd\u5b58\u50a8 1 \u4e2a\u5b57\u8282\u3002\u4f8b\u5982 BINARY (8)\uff0c\u8868\u793a\u6700\u591a\u80fd\u5b58\u50a8 8 \u4e2a\u5b57\u8282\uff0c\u5982\u679c\u5b57\u6bb5\u503c\u4e0d\u8db3(M)\u4e2a\u5b57\u8282\uff0c\u5c06\u5728\u53f3\u8fb9\u586b\u5145'0'\u4ee5\u8865\u9f50\u6307\u5b9a\u957f\u5ea6\u3002</p> </li> <li> <p>VARBINARY (M)\u4e3a\u53ef\u53d8\u957f\u5ea6\u7684\u4e8c\u8fdb\u5236\u5b57\u7b26\u4e32\uff0cM \u8868\u793a\u6700\u591a\u80fd\u5b58\u50a8\u7684\u5b57\u8282\u6570\uff0c\u603b\u5b57\u8282\u6570\u4e0d\u80fd\u8d85\u8fc7\u884c\u7684\u5b57\u8282\u957f\u5ea6\u9650\u5236 65535\uff0c\u53e6\u5916\u8fd8\u8981\u8003\u8651\u989d\u5916\u5b57\u8282\u5f00\u9500\uff0cVARBINARY \u7c7b\u578b\u7684\u6570\u636e\u9664\u4e86\u5b58\u50a8\u6570\u636e\u672c\u8eab\u5916\uff0c\u8fd8\u9700\u8981 1 \u6216 2 \u4e2a\u5b57\u8282\u6765\u5b58\u50a8\u6570\u636e\u7684\u5b57\u8282\u6570\u3002VARBINARY \u7c7b\u578b\u5fc5\u987b\u6307\u5b9a(M)\uff0c\u5426\u5219\u62a5\u9519\u3002</p> </li> </ul> <pre><code>CREATE TABLE t1 (\n    a CHAR(4) BINARY,\n    b VARCHAR(255)  BINARY,\n    c BINARY(4)\n);\n\n INSERT INTO t1 VALUES(\"\u5c1a\u65b9\u5b9d\u5251\",\"ABCD\",\"abc\");\n\n SELECT * FROM t1;\n</code></pre> <p>\u6ce8\u610f\uff0c<code>char binary</code> \u548c <code>varchar binary</code> \u5e76\u4e0d\u662f\u4e8c\u8fdb\u5236\u4e32\uff0c\u5b83\u4eec\u672c\u8d28\u4e0a\u8fd8\u662f <code>\u6587\u672c\u5b57\u7b26\u4e32</code> \u3002\u540e\u9762\u7684<code>binary</code>\u5c5e\u6027\u53ea\u662f\u7528\u4e8e\u4fee\u9970\u5176\u6392\u5e8f\u89c4\u5219</p> <pre><code>-- \u5bf9\u4e8e\u9ed8\u8ba4\u5730utf8mb4\u5b57\u7b26\u96c6\n\nCHAR(5) BINARY ;  --\u8fd9\u4e2a\u662f\u6587\u672c\u5b57\u7b26\u4e32\uff0cbinary\u53ea\u662f\u7528\u4e8e\u4fee\u9970\u6392\u5e8f\u89c4\u5219\uff0c\u7b49\u4ef7\u4e8e\u4e0b\u9762\u7684\u5b8c\u6574\u663e\u5f0f\u5b9a\u4e49\nCHAR(5) CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;\n\n\n\nBINARY(5) ;  --\u8fd9\u4e2a\u662f\u4e8c\u8fdb\u5236\u4e32\uff0c\u5b58\u4e865\u5b57\u8282\u4f4d\u7684\u4e8c\u8fdb\u5236\u6570\u636e\n</code></pre>"},{"location":"basic/7.MySQL%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/#_13","title":"\u679a\u4e3e\u7c7b\u578b","text":""},{"location":"basic/7.MySQL%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/#_14","title":"\u7a7a\u95f4\u7c7b\u578b","text":""},{"location":"basic/7.MySQL%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/#json","title":"JSON \u7c7b\u578b","text":"<p>Table Schema \u5c31\u662f\u5f3a\u4e00\u81f4\u7684\uff0c\u7ea6\u675f\u5f00\u53d1\u4e0d\u8981\u4e71\u641e\uff0cjson \u8fd9\u79cd\u5f31\u7ea6\u675f\u7684\u5c31\u662f\u5f00\u540e\u95e8\uff0c\u65f6\u95f4\u4e00\u957f json \u5b57\u6bb5\u5c31\u6210\u4e86\u4e0b\u6c34\u9053 MySQL JSON \u5f88\u5783\u573e\uff0c5.7 \u7cfb\u5217\u90fd\u6709\u6027\u80fd\u95ee\u9898\uff0c\u6d4b\u8bd5 8.0 \u597d\u5f88\u591a\u3002\u5f3a\u70c8\u5efa\u4e49\u5927\u5bb6\uff0c\u4f7f\u7528\u524d\u538b\u6d4b\u4e00\u4e0b</p>"},{"location":"basic/7.MySQL%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/#_15","title":"\u5e03\u5c14\u7c7b\u578b","text":"<p>\u5927\u591a\u6570\u7f16\u7a0b\u8bed\u8a00\u90fd\u5305\u62ec\u5e03\u5c14\u578b\uff08 BOOL \u578b\u3001 BOOLEAN \u578b\uff09\u8fd9\u79cd\u6570\u636e\u7c7b\u578b\u3002\u5f53\u7136\uff0cSQL \u8bed\u8a00\u91cc\u4e5f\u6709\u3002SQL-99 \u91cc\u5c06\u5e03\u5c14\u578b\u5b9a\u4e49\u4e3a\u53ef\u4ee5\u7531\u7528\u6237\u76f4\u63a5\u64cd\u4f5c\u7684\u6570\u636e\u7c7b\u578b\u3002\u6b64\u5916\uff0c\u5728 WHERE \u5b50\u53e5\u7b49\u5730\u65b9\u8fdb\u884c\u6761\u4ef6\u5224\u65ad\u65f6\u4e5f\u7ecf\u5e38\u4f1a\u7528\u5230\u5e03\u5c14\u578b\u7684\u8fd0\u7b97\u3002</p> <p>\u867d\u7136 boolean \u578b\u662f SQL \u6807\u51c6\u7684\u6570\u636e\u7c7b\u578b\uff0c\u4f46\u5f88\u591a\u6570\u636e\u5e93\u90fd\u6ca1\u6709\u63d0\u4f9b boolean \u7c7b\u578b\uff0c\u7406\u7531\u662f\u8fd9\u4e2a\u6570\u636e\u7c7b\u578b\u592a\u5bb9\u6613\u4ee3\u66ff\u4e86\uff0c\u6ca1\u6709\u5fc5\u8981\u4e13\u95e8\u7528\u4e00\u4e2a\u6570\u636e\u7c7b\u578b\u3002\u6bd4\u5982\u7528 char(1)\u6216\u8005 tinyint \u7b49\u3002</p> <p>MySQL \u4e2d\uff0c\u6709 boolean \u7c7b\u578b\uff0c\u4f46\u8fd9\u4e2a\u7c7b\u578b\u662f tinyint(1)\u7684\u540c\u4e49\u8bcd\uff0c\u5c31\u662f\u8bf4 boolean \u4e5f\u662f\u7528\u6570\u503c\u5b58\u50a8\u7684\u3002\u963f\u91cc\u7684\u6570\u636e\u5e93\u8bbe\u8ba1\u89c4\u8303\u4e5f\u662f\u8981\u6c42\u4f7f\u7528 tinyint(1)\u5b58\u50a8 boolean \u7c7b\u578b\u3002\u5728\u4f7f\u7528\u65f6\uff0c\u53ef\u4ee5\u4f7f\u7528 0 \u6216 1 \u6765\u4ee3\u66ff False \u6216 True\uff0c\u4e5f\u53ef\u4ee5\u4f7f\u7528\u5173\u952e\u5b57 TRUE \u6216 FALSE \u6765\u8868\u793a True \u6216 False</p> <pre><code>CREATE TABLE example (\n    id INT PRIMARY KEY,\n    is_active TINYINT(1)\n);\nINSERT INTO example (id, is_active) VALUES (1, 1);  -- \u5728\u63d2\u5165\u65f6\uff0c\u4f7f\u75281\u8868\u793a\u771f\u503c\u3002\nSELECT * FROM example WHERE is_active = TRUE;       -- \u5728\u67e5\u8be2\u65f6\uff0c\u4f7f\u7528\u4e86TRUE\u5173\u952e\u5b57\u6765\u4ee3\u66ff1\u3002\n\n-- \u4f7f\u75281\u62160\u6765\u4ee3\u8868True\u6216False\uff0c\u800c\u4e0d\u662f\u4f7f\u7528\u5176\u4ed6\u6570\u5b57\u3002\u867d\u7136TINYINT\u7c7b\u578b\u53ef\u4ee5\u5b58\u50a8-128\u5230127\u4e4b\u95f4\u7684\u6574\u6570\uff0c\u4f46\u662f\u5728\u4f7f\u7528TINYINT(1)\u8868\u793a\u5e03\u5c14\u7c7b\u578b\u65f6\uff0c\u5efa\u8bae\u53ea\u4f7f\u75281\u62160\u6765\u8868\u793aTrue\u6216False\u3002\n-- \u6ce8\u610f\u5728\u4f7f\u7528ORM\u6846\u67b6\u65f6\uff0c\u53ef\u80fd\u9700\u8981\u8fdb\u884c\u7279\u6b8a\u5904\u7406\uff0c\u4ee5\u4fbf\u6b63\u786e\u5730\u5904\u7406TINYINT(1)\u7c7b\u578b\u7684\u6570\u636e\u3002\u6709\u4e9bORM\u6846\u67b6\u53ef\u80fd\u4f1a\u5c06TINYINT(1)\u7c7b\u578b\u7684\u6570\u636e\u8f6c\u6362\u4e3a\u5e03\u5c14\u7c7b\u578b\uff0c\u800c\u6709\u4e9b\u5219\u53ef\u80fd\u4f1a\u5c06\u5176\u8f6c\u6362\u4e3a\u6574\u6570\u7c7b\u578b\u3002\u56e0\u6b64\uff0c\u5728\u4f7f\u7528ORM\u6846\u67b6\u65f6\uff0c\u9700\u8981\u4ed4\u7ec6\u67e5\u770b\u6587\u6863\uff0c\u4ee5\u786e\u4fdd\u6b63\u786e\u5730\u5904\u7406TINYINT(1)\u7c7b\u578b\u7684\u6570\u636e\u3002\n</code></pre> <p>\u6570\u636e\u5e93\u4e2d\u7684 boolean \u5b57\u6bb5\uff0c\u4ee5\u4ec0\u4e48\u65b9\u5f0f\u547d\u540d\uff1f\u901a\u5e38\u4f1a\u8981\u6c42 boolean \u503c\u4ee5 is \u5f00\u5934\uff0c\u6bd4\u5982\u963f\u91cc\u7684\u6570\u636e\u5e93\u8bbe\u8ba1\u89c4\u8303\u5f3a\u5236\u8981\u6c42 boolean \u578b\u4ee5 is_\u5f00\u5934\uff0c\u6bd4\u5982 is_deleted\u3002</p>"},{"location":"basic/7.MySQL%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/#mysql-null","title":"MySQL \u4e2d\u7684 NULL \u503c","text":"<p>\u5927\u591a\u6570\u7f16\u7a0b\u8bed\u8a00\u90fd\u662f\u57fa\u4e8e\u4e8c\u503c\u903b\u8f91\u7684\uff0c\u5373\u903b\u8f91\u771f\u503c\u53ea\u6709\u771f\u548c\u5047\u4e24\u4e2a\u3002\u800c SQL \u8bed\u8a00\u5219\u91c7\u7528\u4e00\u79cd\u7279\u522b\u7684\u903b\u8f91\u4f53\u7cfb\u2014\u2014\u4e09\u503c\u903b\u8f91\uff0c\u5373\u903b\u8f91\u771f\u503c\u9664\u4e86\u771f\u548c\u5047\uff0c\u8fd8\u6709\u7b2c\u4e09\u4e2a\u503c\u201c\u4e0d\u786e\u5b9a\u201d\u3002</p> <p>\u4f5c\u4e3a\u8ba1\u7b97\u673a\u57fa\u7840\u7684\u5e03\u5c14\u4ee3\u6570\u662f\u4e8c\u503c\u903b\u8f91\u7684\uff0c\u6211\u4eec\u5728\u4e2d\u5c0f\u5b66\u91cc\u5b66\u7684\u6570\u5b66\u548c\u903b\u8f91\u5b66\u4e5f\u662f\u57fa\u4e8e\u4e8c\u503c\u903b\u8f91\u7684\uff0c\u5173\u7cfb\u6a21\u578b\u7406\u8bba\u57fa\u7840\u4e4b\u4e00\u7684\u8c13\u8bcd\u903b\u8f91\u4e5f\u662f\u4e8c\u503c\u903b\u8f91\u7684\u3002</p> <p>\u5728\u4e8c\u503c\u903b\u8f91\u7684\u5e94\u7528\u5982\u6b64\u5e7f\u6cdb\u7684\u60c5\u51b5\u4e0b\uff0c\u4e3a\u4ec0\u4e48\u5173\u7cfb\u6570\u636e\u5e93\u7684\u4e16\u754c\u7279\u7acb\u72ec\u884c\uff0c\u9009\u62e9\u4e86\u4e09\u503c\u903b\u8f91\u8fd9\u6837\u98ce\u683c\u8fe5\u5f02\u7684\u903b\u8f91\u4f53\u7cfb\u5462\uff1f</p> <p>\u5173\u7cfb\u6570\u636e\u5e93\u91cc\u5f15\u8fdb\u4e86 <code>NULL</code> \uff0c\u6240\u4ee5\u4e0d\u5f97\u4e0d\u540c\u65f6\u5f15\u8fdb\u7b2c\u4e09\u4e2a\u503c\u3002\u8fd9\u6837\u7684\u4e09\u503c\u903b\u8f91\u4e00\u6b21\u6b21\u5730\u8fdd\u80cc\u5e38\u8bc6\uff0c\u6df1\u6df1\u5730\u56f0\u6270\u7740\u6570\u636e\u5e93\u5de5\u7a0b\u5e08\u4eec\u3002</p> <p>SQL \u91cc\u53ea\u5b58\u5728\u4e00\u79cd <code>NULL</code> \u3002\u7136\u800c\u5728\u8ba8\u8bba <code>NULL</code> \u65f6\uff0c\u6211\u4eec\u4e00\u822c\u90fd\u4f1a\u5c06\u5b83\u5206\u6210\u4e24\u79cd\u7c7b\u578b\u6765\u601d\u8003\u3002</p> <p>\u4e24\u79cd <code>NULL</code> \u5206\u522b\u6307\u7684\u662f\u201c\u672a\u77e5\u201d\uff08unknown\uff09 \u548c\u201c\u4e0d\u9002\u7528\u201d\uff08notapplicable, inapplicable\uff09\u3002</p> <p>\u4ee5\u201c\u4e0d\u77e5\u9053\u6234\u58a8\u955c\u7684\u4eba\u773c\u775b\u662f\u4ec0\u4e48\u989c\u8272\u201d\u8fd9\u79cd\u60c5\u51b5\u4e3a\u4f8b\uff0c\u8fd9\u4e2a\u4eba\u7684\u773c\u775b\u80af\u5b9a\u662f\u6709\u989c\u8272\u7684\uff0c\u4f46\u662f\u5982\u679c\u4ed6\u4e0d\u6458\u6389\u773c\u955c\uff0c\u522b\u4eba\u5c31\u4e0d\u77e5\u9053\u4ed6\u7684\u773c\u775b\u662f\u4ec0\u4e48\u989c\u8272\u3002</p> <p>\u8fd9\u5c31\u53eb\u4f5c\u672a\u77e5\u3002\u800c\u201c\u4e0d\u77e5\u9053\u51b0\u7bb1\u7684\u773c\u775b\u662f\u4ec0\u4e48\u989c\u8272\u201d\u5219\u5c5e\u4e8e\u201c\u4e0d\u9002\u7528\u201d\u3002\u56e0\u4e3a\u51b0\u7bb1\u6839\u672c\u5c31\u6ca1\u6709\u773c\u775b\uff0c\u6240\u4ee5\u201c\u773c\u775b\u7684\u989c\u8272\u201d\u8fd9\u4e00\u5c5e\u6027\u5e76\u4e0d\u9002\u7528\u4e8e\u51b0\u7bb1\u3002</p> <p>\u201c\u51b0\u7bb1\u7684\u773c\u775b\u7684\u989c\u8272\u201d\u8fd9\u79cd\u8bf4\u6cd5\u548c\u201c\u5706\u7684\u4f53\u79ef\u201d\u201c\u7537\u6027\u7684\u5206\u5a29\u6b21\u6570\u201d\u4e00\u6837\uff0c\u90fd\u662f\u6ca1\u6709\u610f\u4e49\u7684\u3002\u5e73\u65f6\uff0c\u6211\u4eec\u4e60\u60ef\u4e86\u8bf4\u201c\u4e0d\u77e5\u9053\u201d\uff0c\u4f46\u662f\u201c\u4e0d\u77e5\u9053\u201d\u4e5f\u5206\u5f88\u591a\u79cd\u3002</p> <p>\u201c\u4e0d\u9002\u7528\u201d\u8fd9\u79cd\u60c5\u51b5\u4e0b\u7684 NULL \uff0c\u5728\u8bed\u4e49\u4e0a\u66f4\u63a5\u8fd1\u4e8e\u201c\u65e0\u610f\u4e49\u201d\uff0c\u800c\u4e0d\u662f\u201c\u4e0d\u786e\u5b9a\u201d\u3002</p> <p>\u8fd9\u91cc\u603b\u7ed3\u4e00\u4e0b\uff1a\u201c\u672a\u77e5\u201d\u6307\u7684\u662f\u201c\u867d\u7136\u73b0\u5728\u4e0d\u77e5\u9053\uff0c\u4f46\u52a0\u4e0a\u67d0\u4e9b\u6761\u4ef6\u540e\u5c31\u53ef\u4ee5\u77e5\u9053\u201d\uff1b\u800c\u201c\u4e0d\u9002\u7528\u201d\u6307\u7684\u662f\u201c\u65e0\u8bba\u600e\u4e48\u52aa\u529b\u90fd\u65e0\u6cd5\u77e5\u9053\u201d\u3002</p> <p>Codd \u66fe\u7ecf\u8ba4\u4e3a\u5e94\u8be5\u4e25\u683c\u5730\u533a\u5206\u4e24\u79cd\u7c7b\u578b\u7684 NULL \uff0c\u5e76\u63d0\u5021\u5728\u5173\u7cfb\u6570\u636e\u5e93\u4e2d\u4f7f\u7528\u56db\u503c\u903b\u8f91\u3002</p> <p>\u4e0d\u77e5\u9053\u662f\u5e78\u8fd0\u8fd8\u662f\u4e0d\u5e78\uff08\u7b14\u8005\u8ba4\u4e3a\u80af\u5b9a\u662f\u5e78\u8fd0\uff09\uff0c\u4ed6\u7684\u8fd9\u4e2a\u60f3\u6cd5\u5e76\u6ca1\u6709\u5f97\u5230\u5e7f\u6cdb\u652f\u6301\uff0c\u73b0\u5728\u6240\u6709\u7684 DBMS \u90fd\u5c06\u4e24\u79cd\u7c7b\u578b\u7684 NULL \u5f52\u4e3a\u4e86\u4e00\u7c7b\u5e76\u91c7\u7528\u4e86\u4e09\u503c\u903b\u8f91\u3002</p> <p>\u4f46\u662f\u4ed6\u7684\u8fd9\u79cd\u5206\u7c7b\u65b9\u6cd5\u672c\u8eab\u8fd8\u662f\u6709\u5f88\u591a\u4f18\u70b9\u7684\uff0c\u56e0\u6b64\u540e\u6765\u4f9d\u7136\u6709\u5f88\u591a\u5b66\u8005\u652f\u6301\u3002</p> <p>\u4e09\u503c\u903b\u8f91\u901a\u8fc7\u5bfc\u5165\u7b2c\u4e09\u4e2a\u771f\u503c\uff0c\u4ece\u8bed\u4e49\u5b66\u7684\u89d2\u5ea6\u5bf9\u4e8c\u503c\u903b\u8f91\u53d1\u8d77\u4e86\u6311\u6218\uff1b\u800c\u76f4\u89c9\u4e3b\u4e49\u903b\u8f91\u4ece\u8bed\u6cd5\u5b66\u7684\u89d2\u5ea6\u5bf9\u4e8c\u503c\u903b\u8f91\u53d1\u8d77\u4e86\u6311\u6218\u3002\u81ea\u6b64\u4ee5\u6467\u67af\u62c9\u673d\u4e4b\u52bf\u4e00\u626b\u5341\u4e5d\u4e16\u7eaa\u540e\u671f\u4ee5\u6765\u903b\u8f91\u5b66\u505c\u6ede\u4e0d\u524d\u7684\u9634\u973e\uff0c\u975e\u53e4\u5178\u903b\u8f91\u5b66\u8fce\u6765\u4e86\u767e\u82b1\u9f50\u653e\u7684\u6625\u5929\u3002</p> <p>\u4e8c\u503c\u539f\u7406\u7684\u610f\u601d\u662f\u201c\u4e00\u4e2a\u547d\u9898\u5fc5\u7136\u6709\u771f\u5047\u201d\u3002\u867d\u7136\u4e8c\u503c\u539f\u7406\u975e\u5e38\u7b80\u6d01\uff0c\u4f46\u662f\u5bf9\u4e8e\u6211\u4eec\u4eba\u7c7b\u800c\u8a00\uff0c\u5e76\u4e0d\u80fd\u90a3\u4e48\u8f7b\u6613\u5730\u8ba4\u540c\u5b83\u3002</p> <p>\u5728\u8fd9\u4e2a\u5145\u6ee1\u4e0d\u786e\u5b9a\u6027\u7684\u4e16\u754c\u91cc\uff0c\u65e0\u6cd5\u5224\u65ad\u771f\u5047\u7684\u547d\u9898\u96be\u9053\u4e0d\u662f\u6709\u5f88\u591a\u5417\uff08\u4f8b\u5982\u201c\u795e\u662f\u5b58\u5728\u7684\u201d\u201c\u5b58\u5728\u6b7b\u540e\u7684\u4e16\u754c\u201d\u201c\u6740\u4eba\u662f\u7f6a\u6076\u7684\u201d\uff09\u3002</p> <p>\u5728\u67d0\u6b21\u6f14\u8bb2\u4f1a\u4e0a\uff0c\u4ed6\u8bf4\u51fa\u4e86\u81ea\u5df1\u7684\u4e00\u4e2a\u89c2\u70b9\u2014\u2014\u201c\u5728\u5706\u5468\u7387 \u03c0 \u7684\u5c0f\u6570\u90e8\u5206\uff0c9 \u5c06\u91cd\u590d\u51fa\u73b0 10 \u6b21\u201d\u8fd9\u4e2a\u547d\u9898\u65e0\u6cd5\u5224\u65ad\u771f\u5047\u3002</p> <p>\u6709\u4e00\u4f4d\u542c\u4f17\u8fd9\u6837\u53cd\u9a73\uff1a\u201c\u4e5f\u8bb8\u6211\u4eec\u4eba\u7c7b\u65e0\u6cd5\u5224\u65ad\uff0c\u4f46\u662f\u795e\u80af\u5b9a\u77e5\u9053\u5b83\u7684\u771f\u5047\u201d\u3002\u8bb2\u53f0\u4e0a\u7684\u5e03\u52b3\u5a01\u5c14\u8fd9\u6837\u56de\u7b54\uff1a \u201c\u4f46\u662f\uff0c\u6211\u4eec\u6ca1\u6709\u4ed6\u8001\u4eba\u5bb6\u7684\u7535\u8bdd\u53f7\u7801\u554a\u201d\u3002</p> <p>\u6211\u4eec\u4eba\u7c7b\u548c\u795e\u4e2d\u65ad\u4e86\u8054\u7cfb\u2014\u2014\u5e03\u52b3\u5a01\u5c14\u548c\u5362\u5361\u897f\u7ef4\u8328\u90fd\u751f\u6d3b\u5728\u8fd9\u6837\u4e00\u4e2a\u6697\u6de1\u7684\u65f6\u671f\u3002\u4eba\u7c7b\u548c\u795e\u5931\u53bb\u4e86\u8054\u7cfb\u4e4b\u540e\uff0c\u53ea\u80fd\u4ee5\u6709\u9650\u7684\u8ba4\u77e5\u6d3b\u5728\u6709\u9650\u7684\u4e16\u754c\u91cc\u3002</p> <p>\u65e2\u7136\u5982\u6b64\uff0c\u591a\u51fa\u4e00\u79cd\u4e0e\u4eba\u7c7b\u6709\u9650\u7684\u8ba4\u77e5\u76f8\u79f0\u5e76\u4e14\u80fd\u591f\u9002\u5f53\u5730\u63cf\u8ff0\u8fd9\u4e2a\u5145\u6ee1\u672a\u77e5\u7684\u4e16\u754c\u7684\u65b0\u7684\u903b\u8f91\u5b66\uff0c\u96be\u9053\u4e0d\u662f\u4e00\u4ef6\u597d\u4e8b\u5417\uff1f</p> <p>\u6570\u636e\u5e93\u7684\u4f7f\u7528\u8005\u5f53\u7136\u662f\u4eba\u7c7b\uff0c\u800c\u4e0d\u662f\u795e\u3002\u56e0\u6b64\uff0c\u6570\u636e\u7684\u8868\u8fbe\u65b9\u5f0f\u4e5f\u5e94\u8be5\u57fa\u4e8e\u6709\u9650\u800c\u4e14\u4e0d\u5b8c\u5584\u7684\u4eba\u7c7b\u7684\u8ba4\u77e5\uff0c\u800c\u4e0d\u662f\u795e\u7684\u5b8c\u7f8e\u65e0\u7f3a\u7684\u8ba4\u77e5\u3002</p> <p>\u8fd9\u5c31\u662f\u5173\u7cfb\u6570\u636e\u5e93\u91c7\u7528\u4e09\u503c\u903b\u8f91\u7684\u539f\u56e0\u3002</p> <p>\u5728 SQL \u4e2d\u5efa\u8868\uff0c\u6bcf\u4e2a\u5b57\u6bb5\u540e\u9762\u90fd\u53ef\u4ee5\u52a0\u4e0a NULL \u6216 NOT NULL \u4fee\u9970\u7b26\u6765\u6307\u5b9a\u8be5\u5b57\u6bb5\u662f\u5426\u53ef\u4ee5\u4e3a\u7a7a(NULL)\u3002MySQL \u9ed8\u8ba4\u60c5\u51b5\u4e0b\u6307\u5b9a\u5b57\u6bb5\u4e3a NULL \u4fee\u9970\u7b26\u3002</p> <p>\u5982\u679c\u4e00\u4e2a\u5b57\u6bb5\u6307\u5b9a\u4e3a NOT NULL\uff0cMySQL \u5219\u4e0d\u5141\u8bb8\u5411\u8be5\u5b57\u6bb5\u63d2\u5165\u7a7a\u503c(\u8fd9\u91cc\u9762\u8bf4\u7684\u7a7a\u503c\u90fd\u4e3a NULL)\u3002\u5728\u6807\u51c6 SQL \u4e2d\u4e5f\u53ef\u4ee5\u79f0\u4e3a NOT NULL \u7ea6\u675f\u3002</p> <p>SQL92 \u6807\u51c6\u4e2d\u5b9a\u4e49\u4e86 NULL \u4e0d\u4e0e\u4efb\u4f55\u503c\u76f8\u7b49, NULL \u53ea\u662f\u4ee3\u8868 missing values</p> <p>\u4f46\u662f\u5728\u81ea\u589e\u5217\u548c TIMESTAMP \u5b57\u6bb5\u4e2d\uff0c\u8fd9\u4e2a\u89c4\u5219\u5e76\u4e0d\u9002\u7528\u3002\u5411\u8fd9\u4e9b\u5b57\u6bb5\u4e2d\u63d2\u5165 NULL \u503c\u5c06\u4f1a\u5bfc\u81f4\u63d2\u5165\u4e0b\u4e00\u4e2a\u81ea\u52a8\u589e\u52a0\u7684\u503c\u6216\u8005\u5f53\u524d\u7684\u65f6\u95f4\u6233\u3002</p> <p>NULL \u4e0d\u662f\u4e00\u4e2a\u300c\u503c\u300d\uff0c\u800c\u662f\u300c\u6ca1\u6709\u503c\u300d\u3002</p> <ul> <li> <p>\u5224\u65ad\u662f\u5426\u4e3a NULL \u53ea\u80fd\u7528<code>where name is null</code>\u6216 <code>where name is not null</code> \u8fd9\u79cd\u8bed\u53e5\u3002</p> </li> <li> <p>\u5728 MySQL \u4e2d\u5c06 null \u4e0e\u5176\u4ed6\u5b57\u6bb5\u6216\u8005\u53d8\u91cf\uff08\u51fd\u6570\u3001\u5b58\u50a8\u8fc7\u7a0b\uff09\u8fdb\u884c\u7b97\u672f\u8fd0\u7b97\u6216\u903b\u8f91\u8fd0\u7b97\uff0c\u7ed3\u679c\u603b\u662f NULL</p> </li> <li>count \u8ba1\u6570\uff0cCOUNT(*)\uff1a\u4e0d\u7ba1\u5b57\u6bb5\u4e3a\u4ec0\u4e48\uff0c\u8ba1\u7b97\u5b58\u5728\u7684\u884c\uff0cCOUNT(column_name)\uff1a\u7ed3\u679c\u4e0d\u5305\u542b\u5b57\u6bb5\u4e3a NULL \u7684\u8bb0\u5f55\u3002</li> <li>\u6392\u5e8f\uff0c<code>ASC</code>\u65f6\uff0cNULL \u503c\u5728\u6240\u6709\u5176\u4ed6\u503c\u4e4b\u524d\uff0c<code>DESC</code>\u65f6\uff0cNULL \u503c\u5728\u6240\u6709\u5176\u4ed6\u503c\u4e4b\u540e\u3002\u8bf7\u6ce8\u610f\u4e0e\u67e5\u8be2\u4e2d\u7684\u8303\u56f4\u5339\u914d\u533a\u5206\uff0c\u8fd9\u53ea\u662f\u4e00\u79cd\u7ea6\u5b9a\uff0c\u5e76\u4e0d\u662f\u56e0\u4e3a NULL \u66f4\u5c0f</li> </ul> <p>\u9664\u4e86\u4e0a\u9762\u4f7f\u7528\u7684\u56f0\u60d1\uff0cNULL \u503c\u8fc7\u591a\u4f1a\u5f71\u54cd\u7edf\u8ba1\u4fe1\u606f\uff0c\u53ef\u80fd\u5f71\u54cd\u6267\u884c\u8ba1\u5212\u3002MySQL \u5f88\u4e0d\u8d1f\u8d23\u7684\u628a\u5bf9 NULL \u503c\u7684\u7edf\u8ba1\u65b9\u5f0f\u4ea4\u7ed9\u4e86\u7528\u6237 innodb_stats_method, \u9ed8\u8ba4\u503c\u662f nulls_equal</p> <p>Specifies how InnoDB index statistics collection code should treat NULLs. Possible values are NULLS_EQUAL (default), NULLS_UNEQUAL and NULLS_IGNORED</p> <ul> <li>\u5f53\u53d8\u91cf\u8bbe\u7f6e\u4e3a nulls_equal \u65f6\uff0c\u6240\u6709 NULL \u503c\u90fd\u88ab\u89c6\u4e3a\u76f8\u540c(\u5373\uff0c\u5b83\u4eec\u90fd\u5f62\u6210\u4e00\u4e2a value group)</li> <li>\u5f53\u53d8\u91cf\u8bbe\u7f6e\u4e3a nulls_unequal \u65f6\uff0cNULL \u503c\u4e0d\u88ab\u89c6\u4e3a\u76f8\u540c\u3002\u76f8\u53cd\uff0c\u6bcf\u4e2a NULL value \u5f62\u6210\u4e00\u4e2a\u5355\u72ec\u7684 value group, \u5927\u5c0f\u4e3a 1</li> <li>\u5f53\u53d8\u91cf\u8bbe\u7f6e\u4e3a nulls_ignored \u65f6\uff0c\u5c06\u5ffd\u7565 NULL \u503c</li> </ul> <p>\u963f\u91cc\u4e5f\u6709\u8fc7\u4e00\u7bc7\u6587\u7ae0\uff0c\u8bb2 unique \u7d22\u5f15\u6709 NULL \u503c\u5bfc\u81f4\u4e3b\u5907\u5ef6\u8fdf\uff0c\u611f\u5174\u8da3\u7684\u53ef\u4ee5\u770b\u770b</p> <p>\u5728\u5199 SQL \u6761\u4ef6\u8bed\u53e5\u65f6\u5173\u4e8e\u5b57\u6bb5\u5224\u65ad\u6216\u6392\u5e8f\u65f6\uff0c\u8981\u6ce8\u610f\u8003\u8651\u5b57\u6bb5\u4e2d\u53ef\u80fd\u4e3a NULL \u7684\u60c5\u51b5\u3002</p> <ul> <li>\u4e00\u822c\u5f3a\u70c8\u5efa\u8bae\u4e3a\u4e1a\u52a1\u5b57\u6bb5\u8bbe\u7f6e\u4e3a not null \uff0c \u5982\u679c\u63d2\u5165\u65f6\u6ca1\u6709\u503c\uff0c\u53ef\u4ee5\u8bbe\u7f6e\u4e3a\u7a7a\u5b57\u7b26\u4e32\u6216\u4e1a\u52a1\u5b57\u6bb5\u7684\u96f6\u503c\u3002\u6700\u9a9a\u7684\u662f\u6709\u4eba\uff0c\u7ed9\u4e00\u4e2a\u5b57\u6bb5\u8d4b\u503c 'NULL', \u6ce8\u610f\u662f\u5b57\u7b26\u4e32 'NULL' \u4e0d\u662f NULL</li> </ul> <pre><code>-- \u793a\u4f8b\n\nmysql&gt; select 1 is  null  , 1 is not null , 1 and null , 1 = null , 1 &gt; null , 1 + null  , null = null , null is null ;\n+------------+---------------+------------+----------+----------+----------+-------------+--------------+\n| 1 is  null | 1 is not null | 1 and null | 1 = null | 1 &gt; null | 1 + null | null = null | null is null |\n+------------+---------------+------------+----------+----------+----------+-------------+--------------+\n|          0 |             1 |       NULL |     NULL |     NULL |     NULL |        NULL |            1 |\n+------------+---------------+------------+----------+----------+----------+-------------+--------------+\n1 row in set (0.00 sec)\n\nmysql&gt;\n\n mysql&gt; select length(''), length(null), length(0), length('0');\n +------------+--------------+-----------+-------------+\n | length('') | length(null) | length(0) | length('0') |\n +------------+--------------+-----------+-------------+\n |          0 |         NULL |         1 |           1 |\n +------------+--------------+-----------+-------------+\n 1 row in set (0.00 sec)\n</code></pre> <p>\u53c2\u8003</p>"},{"location":"basic/7.MySQL%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/#_16","title":"\u9009\u62e9\u6b63\u786e\u7684\u6570\u636e\u7c7b\u578b","text":"<p>\u9009\u62e9\u7684\u539f\u5219\u662f\uff1a</p> <ul> <li> <p>\u66f4\u5c0f\u7684\u66f4\u597d\uff1a\u66f4\u5c0f\u7684\u6570\u636e\u7c7b\u578b\u901a\u5e38\u66f4\u5feb\uff0c\u56e0\u4e3a\u5b83\u4eec\u5360\u7528\u66f4\u5c11\u7684\u78c1\u76d8\u3001\u5185\u5b58\u548c CPU \u7f13\u5b58\uff0c\u5e76\u4e14\u5904\u7406\u65f6\u9700\u8981\u7684 CPU \u5468\u671f\u4e5f\u66f4\u5c11\u3002</p> </li> <li> <p>\u5c3d\u91cf\u907f\u514d NULL\uff1a</p> </li> <li> <p>\u6574\u5f62\u6bd4\u5b57\u7b26\u64cd\u4f5c\u4ee3\u4ef7\u66f4\u4f4e\u3002</p> </li> <li> <p>\u4fdd\u5b58\u65e5\u671f\u683c\u5f0f\u65f6\uff0c\u8981\u9009\u7528 MySQL \u5185\u7f6e\u7684\u65e5\u5fd7\u683c\u5f0f\uff08TimeStamp, DateTime\uff09\uff0c\u800c\u4e0d\u4f7f\u7528\u5b57\u7b26\u4e32\u3002</p> </li> <li> <p>\u5c0f\u6570\u70b9\u7684\u4fdd\u5b58\u5982\u4f55\u6709\u6d89\u53ca\u5230\u8fd0\u7b97\uff0c\u7528 float \u548c double \u53ef\u80fd\u4f1a\u7cbe\u5ea6\u4e0d\u51c6\uff0c\u53ef\u4ee5\u8003\u8651\u5c06\u5c0f\u6570\u4e58\u4e8e\u76f8\u5e94\u7684\u500d\u6570\uff0c\u7136\u540e\u7528 BIGINT \u6765\u5b58\u50a8\u3002</p> </li> <li> <p>\u5f53\u6570\u636e\u5b58\u50a8\u7684\u662f\u5b57\u7b26\uff0c\u4e14\u957f\u5ea6\u662f\u4e00\u4e2a\u56fa\u5b9a\u533a\u95f4\u5b9a\u503c\u7684\u8bdd\u5c31\u53ef\u4ee5\u8003\u8651\u4f7f\u7528 char \u6765\u8fdb\u884c\u5b58\u50a8\uff0c\u5982\u679c\u5b57\u7b26\u957f\u5ea6\u662f\u672a\u77e5\u7684\u4e14\u957f\u5ea6\u53d8\u5316\u7279\u522b\u660e\u663e\u7684\u8bdd\uff0c\u8fd9\u4e2a\u65f6\u5019\u6700\u597d\u4f7f\u7528 varchar \u6765\u5b58\u50a8\u3002\u4f46\u662f\u4e0d\u7ba1\u4f7f\u7528\u7684\u662f\u54ea\u79cd\u5b57\u6bb5\u6765\u8fdb\u884c\u5b58\u50a8\uff0c\u90fd\u4e0d\u8981\u628a\u5b57\u6bb5\u7684\u521d\u59cb\u957f\u5ea6\u8bbe\u7f6e\u4e3a\u6700\u5927\u5316\uff0c\u5e94\u8be5\u662f\u6839\u636e\u4e1a\u52a1\u9700\u6c42\u6765\u5b58\u50a8\u6700\u5408\u9002\u7684\u957f\u5ea6\u5b57\u6bb5\u3002</p> </li> <li> <p>\u6570\u636e\u5e93\u8bbe\u8ba1\u8fc7\u7a0b\u4e2d\u5c3d\u91cf\u4f7f\u7528 int \u6765\u4f5c\u4e3a\u5b57\u6bb5\u7c7b\u578b\uff0c\u56e0\u4e3a\u5728\u6240\u6709\u7684\u6570\u636e\u7c7b\u578b\u4e2d int \u4e0d\u7ba1\u662f\u5b58\u50a8\u7a7a\u95f4\u8fd8\u662f\u6267\u884c\u901f\u5ea6\u65b9\u9762\u90fd\u662f\u6700\u597d\u7684\u3002\u4f8b\u5982\uff1a\u5982\u679c\u4e1a\u52a1\u4e2d\u5b58\u50a8\u7684\u90fd\u662f\u6570\u636e\u7684\u8bdd\u800c\u4e14\u957f\u5ea6\u4e0d\u662f\u7279\u522b\u957f\u7684\u8bdd\uff0c\u5c31\u53ef\u4ee5\u8003\u8651\u4f7f\u7528 int \u6765\u8fdb\u884c\u5b58\u50a8\uff0c\u6216\u8005\u4e1a\u52a1\u4e2d\u8981\u5bf9\u6570\u636e\u8fdb\u884c\u6392\u5e8f\u7684\u65f6\u5019\u9700\u8981\u4f7f\u7528\u67d0\u4e00\u6807\u8bc6\u6743\u91cd\u4e4b\u7c7b\u7684\uff0c\u4e5f\u53ef\u4ee5\u4f7f\u7528 tinyint \u6765\u8fdb\u884c\u5b58\u50a8\u3002\u4f46\u662f\u4e0d\u8981\u56e0\u4e3a int \u9ad8\u6548\uff0c\u800c\u6709\u610f\u8bc6\u7684\u628a\u6240\u6709\u5b57\u6bb5\u90fd\u8bbe\u8ba1\u6210 int \u6765\u5904\u7406\uff0c\u6700\u7ec8\u8fd8\u662f\u8981\u6839\u636e\u4e1a\u52a1\u7684\u5177\u4f53\u9700\u6c42\u6765\u8bbe\u8ba1\u76f8\u5e94\u7684\u5b57\u6bb5\u3002</p> </li> </ul>"},{"location":"basic/7.MySQL%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/#innodb","title":"InnoDB \u6570\u636e\u884c\u683c\u5f0f","text":"<p>InnoDB \u5b58\u50a8\u5f15\u64ce\u548c\u5927\u591a\u6570\u6570\u636e\u5e93\u4e00\u6837\uff0c\u8bb0\u5f55\u662f\u4ee5\u884c\u7684\u5f62\u5f0f\u5b58\u50a8\u7684\uff0c\u8fd9\u610f\u5473\u7740\u9875\u4e2d\u4fdd\u5b58\u7740\u8868\u4e2d\u4e00\u884c\u884c\u7684\u6570\u636e\u3002\u6570\u636e\u4e00\u884c\u4e00\u884c\u7684\u5b58\u50a8\u5728\u9875\u4e2d\u3002\u4e00\u9875\u5b58\u6ee1\u4e86\uff0c\u9a6c\u4e0a\u5230\u4e0b\u4e00\u9875\u3002</p> <p>\u5728 InnoDB 1.0.X \u4e4b\u524d\uff0cInnoDB \u5b58\u50a8\u5f15\u64ce\u63d0\u4f9b\u4e86 <code>Compact</code> \u548c <code>Redundant</code> \u4e24\u79cd\u683c\u5f0f\u6765\u5b58\u653e\u884c\u8bb0\u5f55\u6570\u636e\u3002</p> <p><code>Redundant</code> \u662f mysql5.0 \u7248\u672c\u4e4b\u524d\u7684\u884c\u8bb0\u5f55\u5b58\u50a8\u65b9\u5f0f\uff0c\u4e4b\u540e\u4ecd\u7136\u652f\u6301\u8fd9\u4e2a\u683c\u5f0f\u662f\u4e3a\u4e86\u517c\u5bb9\u4e4b\u524d\u7248\u672c\u7684\u683c\u5f0f\uff0c5.1 \u4e4b\u540e\u5f88\u5c11\u7528\u5230\u4e86\u3002</p> <p>\u56e0\u4e3a <code>Compact</code> \u7684\u7ed3\u6784\u8bbe\u8ba1\u6bd4\u5b83\u597d\u5f97\u591a\uff0c<code>Compact</code> \u683c\u5f0f\u6d88\u8017\u7684\u78c1\u76d8\u7a7a\u95f4\u548c\u5907\u4efd\u8017\u65f6\u66f4\u5c0f\uff0cRedundant \u76f8\u6bd4\u4e4b\u4e0b\u5927\u4e86\u4e00\u4e9b\u3002compact \u683c\u5f0f\u66f4\u9002\u7528\u4e8e\u5927\u591a\u6570\u7684\u4e1a\u52a1\u573a\u666f\u3002</p> <p>\u5728 InnoDB 1.0.X \u7248\u672c\u5f00\u59cb\u53c8\u5f15\u5165\u4e86\u65b0\u7684\u6587\u4ef6\u683c\u5f0f(file format)\uff0c\u4ee5\u524d\u652f\u6301 Compact \u548c Redundant \u683c\u5f0f\u79f0\u4e3a Antelope \u6587\u4ef6\u683c\u5f0f\uff0c\u65b0\u5f15\u5165\u7684\u6587\u4ef6\u683c\u5f0f\u79f0\u4e3a Barracuda \u6587\u4ef6\u683c\u5f0f\u3002</p> <p>Barracuda \u6587\u4ef6\u683c\u5f0f\u4e0b\u62e5\u6709\u4e24\u79cd\u65b0\u7684\u884c\u8bb0\u5f55\u683c\u5f0f\uff1aCompressed \u548c Dynamic\uff0c\u540c\u65f6\uff0cBarracuda \u6587\u4ef6\u683c\u5f0f\u4e5f\u5305\u62ec\u4e86 Antelope \u6240\u6709\u7684\u6587\u4ef6\u683c\u5f0f\u3002\u8fd9\u6837 Barracuda \u6587\u4ef6\u683c\u5f0f\u652f\u6301 4 \u79cd row_format\uff1a</p> <pre><code>Redundant\u3001Compact\u3001Compressed\u3001Dynamic\n</code></pre> <p>\u6240\u8c13 <code>Row Format</code> \u884c\u683c\u5f0f\u662f\u6307\u6570\u636e\u8bb0\u5f55(\u6216\u8005\u79f0\u4e4b\u4e3a\u884c)\u5728\u78c1\u76d8\u4e2d\u7684\u7269\u7406\u5b58\u50a8\u65b9\u5f0f\uff1a</p> <p>\u5177\u4f53\u5730\uff0c\u5bf9\u4e8e InnoDB \u5b58\u50a8\u5f15\u64ce\u800c\u8a00\uff0c\u5e38\u89c1\u7684\u884c\u683c\u5f0f\u7c7b\u578b\u6709\u5982\u4e0b\u56db\u79cd\uff1aCompact\u3001Redundant\u3001Dynamic \u548c Compressed</p> <pre><code>-- \u914d\u7f6e\u6587\u4ef6\u6307\u5b9a InnoDB \u8868\u7684\u9ed8\u8ba4\u6587\u4ef6\u683c\u5f0f\u30025.7\u548c8.0\u7684 innodb_default_row_format \u9ed8\u8ba4\u503c\u90fd\u662f\u662f DYNAMIC\nshow variables like 'innodb_default_row_format';\n\n-- \u7528\u6237\u53ef\u4ee5\u5728\u5efa\u8868\u65f6\uff0c\u663e\u793a\u6307\u5b9a\u8868\u7684 row format\uff0c\u4e5f\u53ef\u4ee5\u662f\u5176\u4ed6\u683c\u5f0f\nCREATE TABLE t1 (c1 INT) ROW_FORMAT=DYNAMIC;\n</code></pre> <p>\u73b0\u5728\u57fa\u672c\u4e0a\u90fd\u662f <code>Barracuda</code> \u683c\u5f0f\u3002<code>Dynamic</code> \u548c <code>Compact</code> \u57fa\u672c\u662f\u7c7b\u4f3c\u7684\uff0c\u4f46\u662f\u5b83\u4eec\u5728\u884c\u6ea2\u51fa\u6570\u636e\u7684\u5904\u7406\u4e0a\u5374\u5b8c\u5168\u4e0d\u540c\uff1a</p> <p>\u8868\u7684\u884c\u683c\u5f0f\u51b3\u5b9a\u4e86\u5b83\u7684\u6bcf\u884c\u6570\u636e\u662f\u600e\u4e48\u7269\u7406\u5b58\u50a8\u7684\uff0c\u5176\u5bf9\u67e5\u8be2\u548c DML \u64cd\u4f5c\u4e5f\u662f\u6709\u5f71\u54cd\u3002\u6bcf\u4e2a\u78c1\u76d8\u9875\u5b58\u7684\u884c\u6570\u8d8a\u591a\uff0c\u67e5\u8be2\u548c\u7d22\u5f15\u7684\u67e5\u627e\u5c31\u8d8a\u5feb\uff0c\u7f13\u51b2\u6c60\u9700\u8981\u7684\u5185\u5b58\u4e5f\u8d8a\u5c11\uff0c\u540c\u65f6\u4e5f\u80fd\u51cf\u5c11\u66f4\u65b0\u6570\u636e\u7684 I/O\u3002</p> <p>\u6bcf\u4e2a\u8868\u7684\u6570\u636e\u90fd\u88ab\u5206\u6210\u591a\u4e2a\u9875\uff0c\u8fd9\u4e9b\u9875\u90fd\u5b58\u5728 B-tree \u7d22\u5f15\u7684\u6811\u6570\u636e\u7ed3\u6784\u4e2d\u3002\u8868\u6570\u636e\u548c\u975e\u4e3b\u952e\u7d22\u5f15\u90fd\u7528\u8fd9\u79cd\u6570\u636e\u7ed3\u6784\u3002\u4fdd\u5b58\u4e86\u6574\u4e2a\u8868\u6570\u636e\u7684 B-tree \u7d22\u5f15\u53eb\u505a\u805a\u7c07\u7d22\u5f15\uff0c\u5b83\u662f\u6839\u636e\u8868\u7684\u4e3b\u952e\u6765\u8fdb\u884c\u7ec4\u7ec7\u7684\u3002\u805a\u7c07\u7d22\u5f15\u6811\u7684\u8282\u70b9\u4fdd\u5b58\u4e86\u4e00\u884c\u7684\u6240\u6709\u5217\u7684\u503c\uff0c\u975e\u4e3b\u952e\u7d22\u5f15\u7684\u8282\u70b9\u53ea\u5305\u542b\u7d22\u5f15\u5217\u548c\u4e3b\u952e\u5217\u7684\u503c\u3002</p> <p>\u53d8\u957f\u5217\u5728 B-\u6811\u7d22\u5f15\u8282\u70b9\u7684\u5b58\u50a8\u7b56\u7565\u4e0d\u592a\u4e00\u6837\uff0c\u5982\u679c\u957f\u5ea6\u8d85\u8fc7\u4e86 B-\u6811\u9875\u7684\u957f\u5ea6\uff0c\u5219\u5b83\u4eec\u4f1a\u4fdd\u5b58\u5728\u5355\u72ec\u7533\u8bf7\u7684\u78c1\u76d8\u9875\u4e2d\uff0c\u5373\u6ea2\u51fa\u9875\u3002\u8fd9\u4e9b\u5217\u4e5f\u53eb\u505a off-page \u5217\u3002off-page \u5217\u7684\u503c\u4fdd\u5b58\u5728\u591a\u4e2a\u6ea2\u51fa\u9875\u4e2d\uff0c\u8fd9\u4e9b\u6ea2\u51fa\u9875\u4f7f\u7528\u5355\u72ec\u7684\u94fe\u8868\u8fde\u63a5\u5728\u4e00\u8d77\uff0c\u6bcf\u4e2a\u5217\u90fd\u6709\u5b83\u81ea\u5df1\u7684\u6ea2\u51fa\u9875\u94fe\u8868\u3002\u4e3a\u4e86\u907f\u514d\u6d6a\u8d39\u7a7a\u95f4\u6216\u8005\u8bfb\u53d6\u989d\u5916\u7684\u9875\u6570\u636e\uff0c\u5f53\u5217\u957f\u5ea6\u8d85\u8fc7 B-\u6811\u9875\u5927\u5c0f\u65f6\uff0c\u4f1a\u5c06\u53d8\u957f\u5217\u7684\u90e8\u5206\u524d\u7f00\u4e32\u4fdd\u5b58\u5728 B-\u6811\u79cd\u3002</p> <p>InnoDB \u5b58\u50a8\u5f15\u64ce\u652f\u6301\u56db\u79cd\u884c\u683c\u5f0f\uff1a REDUNDANT, COMPACT, DYNAMIC, COMPRESSED\u3002</p> \u884c\u683c\u5f0f \u7d27\u51d1\u7684\u5b58\u50a8\u7279\u6027 \u538b\u7f29\u652f\u6301 REDUNDANT COMPACT DYNAMIC COMPRESSED"},{"location":"basic/7.MySQL%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/#redundant","title":"REDUNDANT","text":"<p>REDUNDANT format \u63d0\u4f9b\u4e86\u5bf9\u8001\u7248\u672c MySQL \u7684\u517c\u5bb9\u6027\u3002</p>"},{"location":"basic/7.MySQL%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/#compact","title":"COMPACT","text":"<p>\u5bf9\u4e8e\u50cf varchar\uff0c varbinary\uff0ctext\uff0cblob\uff0cjson \u4ee5\u53ca\u4ed6\u4eec\u7684\u5404\u79cd\u7c7b\u578b\u7684**\u53ef\u53d8\u957f\u5ea6\u5b57\u6bb5**\uff0c\u9700\u8981\u5c06\u4ed6\u4eec\u5230\u5e95\u5360\u7528\u591a\u5c11\u5b57\u8282\u5b58\u50a8\u8d77\u6765\uff0c\u8fd9\u6837\u5c31\u7701\u53bb\u4e86\u5217\u6570\u636e\u4e4b\u95f4\u7684\u8fb9\u754c\u5b9a\u4e49\uff0cMySQL \u5c31\u53ef\u4ee5\u5206\u6e05\u695a\u54ea\u4e9b\u6570\u636e\u5c5e\u4e8e\u8fd9\u4e00\u5217\uff0c\u90a3\u4e9b\u4e0d\u5c5e\u4e8e\u3002Compact \u884c\u683c\u5f0f\u5b58\u50a8\uff0c\u5f00\u5934\u5c31\u662f\u53d8\u957f\u5b57\u6bb5\u957f\u5ea6\u5217\u8868\uff0c\u8fd9\u4e2a\u5217\u8868\u5305\u62ec**\u6570\u636e\u4e0d\u4e3a NULL**\u7684\u6bcf\u4e2a**\u53ef\u53d8\u957f\u5ea6\u5b57\u6bb5**\u7684\u957f\u5ea6\uff0c\u5e76\u6309\u7167\u5217\u7684\u987a\u5e8f**\u9006\u5e8f**\u6392\u5217\u3002</p>"},{"location":"basic/7.MySQL%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/#_17","title":"\u6570\u636e\u7c7b\u578b\u8f6c\u6362","text":""},{"location":"basic/7.MySQL%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/#_18","title":"\u81ea\u5b9a\u4e49\u6570\u636e\u7c7b\u578b","text":"<p>\u7528\u6237\u5b9a\u4e49\u6570\u636e\u7c7b\u578b\u5e76\u4e0d\u662f\u771f\u6b63\u7684\u6570\u636e\u7c7b\u578b\uff0c\u5b83\u53ea\u662f\u63d0\u4f9b\u4e86\u4e00\u79cd\u63d0\u9ad8\u6570\u636e\u5e93\u5185\u90e8\u5143\u7d20\u548c\u57fa\u672c\u6570\u636e\u7c7b\u578b\u4e4b\u95f4\u4e00\u81f4\u6027\u7684\u673a\u5236\u3002</p> <p>\u5728 MySQL \u4e2d\uff0c\u6570\u636e\u7c7b\u578b\u7528\u4e8e\u5b9a\u4e49\u5217\u7684\u7c7b\u578b\u548c\u5c5e\u6027\u3002MySQL \u63d0\u4f9b\u4e86\u4e00\u4e9b\u57fa\u672c\u6570\u636e\u7c7b\u578b\uff0c\u5982\u6574\u6570\u3001\u5b57\u7b26\u3001\u65e5\u671f\u7b49\u3002\u4f46\u5728\u67d0\u4e9b\u60c5\u51b5\u4e0b\uff0c\u8fd9\u4e9b\u57fa\u672c\u6570\u636e\u7c7b\u578b\u53ef\u80fd\u4e0d\u8db3\u4ee5\u6ee1\u8db3\u6211\u4eec\u7684\u9700\u6c42\u3002</p> <p>\u81ea\u5b9a\u4e49\u6570\u636e\u7c7b\u578b\u5141\u8bb8\u6211\u4eec\u521b\u5efa\u81ea\u5df1\u7684\u6570\u636e\u7c7b\u578b\uff0c\u4ee5\u4fbf\u66f4\u597d\u5730\u6ee1\u8db3\u7279\u5b9a\u4e1a\u52a1\u9700\u6c42\u3002\u901a\u8fc7\u81ea\u5b9a\u4e49\u6570\u636e\u7c7b\u578b\uff0c\u6211\u4eec\u53ef\u4ee5\u5c06\u4e00\u7ec4\u76f8\u5173\u7684\u6570\u636e\u548c\u64cd\u4f5c\u5c01\u88c5\u5728\u4e00\u4e2a\u5355\u4e00\u7684\u6570\u636e\u7c7b\u578b\u4e2d\uff0c\u5e76\u5c06\u5176\u4f5c\u4e3a\u5217\u7684\u6570\u636e\u7c7b\u578b\u4f7f\u7528\u3002</p>"},{"location":"basic/8.MySQL%E5%AD%97%E7%AC%A6%E9%9B%86%E5%92%8C%E6%8E%92%E5%BA%8F%E8%A7%84%E5%88%99/","title":"8. MySQL\u5b57\u7b26\u96c6\u548c\u6392\u5e8f\u89c4\u5219","text":""},{"location":"basic/8.MySQL%E5%AD%97%E7%AC%A6%E9%9B%86%E5%92%8C%E6%8E%92%E5%BA%8F%E8%A7%84%E5%88%99/#_1","title":"\u5b57\u7b26","text":"<p>\u5b57\u7b26\uff08Charcter\uff09\u662f\u6587\u5b57\u4e0e\u7b26\u53f7\u7684\u603b\u79f0\uff0c\u5305\u62ec\u6587\u5b57\u3001\u56fe\u5f62\u7b26\u53f7\u3001\u6570\u5b66\u7b26\u53f7\u7b49\u300226\u4e2a\u82f1\u6587\u5b57\u6bcd\u5c5e\u4e8e\u5b57\u7b26\uff0c\u6bcf\u4e2a\u6c49\u5b57\u4e5f\u5c5e\u4e8e\u4e00\u4e2a\u5b57\u7b26\u3002</p> <p>\u4f17\u6240\u5468\u77e5\uff0c\u8ba1\u7b97\u673a\u5e95\u5c42\u5904\u7406\u7684\u90fd\u662f\u4e8c\u8fdb\u5236\u6570\u5b57\u3002\u8ba1\u7b97\u673a\u53ea\u80fd\u5904\u7406\u6570\u5b57\uff0c\u5982\u679c\u8981\u5904\u7406\u6587\u672c\uff0c\u5c31\u5fc5\u987b\u5148\u628a\u6587\u672c\u8f6c\u6362\u4e3a\u6570\u5b57\u624d\u80fd\u5904\u7406\u3002</p> <p>\u6700\u65e9\u7684\u8ba1\u7b97\u673a\u5728\u8bbe\u8ba1\u65f6\u91c7\u75288\u4e2a\u4e8c\u8fdb\u5236\u6bd4\u7279\u4f4d\uff08bit\uff09\u4f5c\u4e3a\u4e00\u4e2a\u5b57\u8282\uff08byte\uff09\u3002</p> <p>\u6240\u4ee5\uff0c\u4e00\u4e2a\u5b57\u8282\u80fd\u8868\u793a\u7684\u6700\u5927\u7684\u6574\u6570\u5c31\u662f255\uff08\u4e8c\u8fdb\u523611111111=\u5341\u8fdb\u5236255\uff09\uff0c\u5982\u679c\u8981\u8868\u793a\u66f4\u5927\u7684\u6574\u6570\uff0c\u5c31\u5fc5\u987b\u7528\u66f4\u591a\u7684\u5b57\u8282\u3002</p> <p>\u6bd4\u5982\uff1a\u4e24\u4e2a\u5b57\u8282\u53ef\u4ee5\u8868\u793a\u7684\u6700\u5927\u6574\u6570\u662f65535\uff0c\u56db\u4e2a\u5b57\u8282\u53ef\u4ee5\u8868\u793a\u7684\u6700\u5927\u6574\u6570\u662f4294967295\u3002</p>"},{"location":"basic/8.MySQL%E5%AD%97%E7%AC%A6%E9%9B%86%E5%92%8C%E6%8E%92%E5%BA%8F%E8%A7%84%E5%88%99/#_2","title":"\u5b57\u7b26\u7f16\u7801\u548c\u5b57\u7b26\u96c6","text":"<p>\u5b57\u7b26\u96c6 </p> <p>\u5728\u4eba\u7c7b\u65e5\u5e38\u751f\u6d3b\u4e2d\uff0c\u6709\u6570\u5b66\u4e0a\u7684\u5404\u79cd\u6570\u5b66\u8fd0\u7b97\u7b26\uff0c\u53e4\u5e0c\u814a\u6570\u5b66\u7b26\u53f7\uff0c\u4e5f\u6709\u5404\u56fd\u65e5\u5e38\u8bed\u8a00\uff1a\u62c9\u4e01\u6587\uff0c\u82f1\u6587\uff0c\u4e2d\u6587\uff0c\u65e5\u6587\uff0c\u97e9\u6587\u7b49\u7b49\u3002</p> <p>\u751a\u81f3\u8fd8\u6709\u7e41\u4f53\u4e2d\u6587\u5b57\uff0c\u4ee5\u53ca\u4ee4\u4eba\u5934\u75bc\u7684\u4e2d\u6587\u751f\u50fb\u5b57\u3002</p> <p>\u5b57\u7b26\u96c6\u5b57\u9762\u4e0a\u7684\u7406\u89e3\u5c31\u662f\u5b57\u7b26\u7684\u96c6\u5408\uff0c\u662f**\u4e00\u4e2a\u81ea\u7136\u8bed\u8a00\u6587\u5b57\u7cfb\u7edf\u652f\u6301\u7684\u6240\u6709\u5b57\u7b26\u7684\u96c6\u5408**\u3002\u8fd9\u4e2a\u96c6\u5408\u79f0\u4e3a\u5b57\u7b26\u96c6\u3002</p> <p>\u4e5f\u5c31\u662f\u8bf4\uff0c\u6211\u4eec\u53ef\u4ee5 \u4eba\u4e3a\u7684\u6839\u636e\u67d0\u79cd\u89c4\u5219\u5f52\u7eb3\u4e00\u4e9b\u6211\u4eec\u4f7f\u7528\u7684\u6587\u5b57/\u7b26\u53f7\uff0c\u8fd9\u4e9b\u6587\u5b57/\u7b26\u53f7\u7684\u96c6\u5408\u5c31\u79f0\u4e3a\u4e00\u4e2a\u5b57\u7b26\u96c6 \uff0c\u5e76\u4e14\u53ef\u4ee5\u6839\u636e\u4e0d\u540c\u7684\u89c4\u5219\u5212\u5206\u6210\u4e0d\u540c\u7684\u5b57\u7b26\u96c6\u3002</p>"},{"location":"basic/8.MySQL%E5%AD%97%E7%AC%A6%E9%9B%86%E5%92%8C%E6%8E%92%E5%BA%8F%E8%A7%84%E5%88%99/#_3","title":"\u5b57\u7b26\u7f16\u7801","text":"<p>\u4e8c\u8fdb\u5236\uff08binary\uff09</p> <p>binary \u4f17\u6240\u5468\u77e5\uff0c\u8ba1\u7b97\u673a\u5e95\u5c42\u5b58\u50a8\u548c\u5904\u7406\u6570\u636e\u53ea\u662f\u4e00\u5927\u5806\u4e8c\u8fdb\u5236\u76840\u548c1</p> <p>\u5982\u679c\u8981\u60f3\u8ba9\u8ba1\u7b97\u673a\u8bc6\u522b\u6211\u4eec\u4eba\u7c7b\u7684\u6587\u5b57\u3001\u7b26\u53f7\u3001\u6570\u5b57\uff0c\u5c31\u9700\u8981\u4e00\u4e2a\u8f6c\u6362\u89c4\u5219\uff0c\u628a\u6211\u4eec\u4eba\u7c7b\u4f7f\u7528\u7684\u5404\u79cd\u5b57\u7b26\u8f6c\u6362\u6210\u8ba1\u7b97\u673a\u8ba4\u8bc6\u7684\u4e8c\u8fdb\u5236\uff0c\u4e5f\u5c31\u662f0\u548c1\u3002</p> <p>\u5b57\u7b26\u96c6\u548c\u4e8c\u8fdb\u5236\u7684\u6620\u5c04\u7f16\u7801\u89c4\u5219\u5c31\u79f0\u4e3a \u5b57\u7b26\u7f16\u7801\u89c4\u5219 \u3002\u63a5\u4e0b\u6765\u7b80\u5355\u4ecb\u7ecd\u4e00\u4e0b\u51e0\u79cd\u65e9\u671f\u7684\u7f16\u7801\u89c4\u5219\uff1a</p> <p>\u7531\u4e8e\u5386\u53f2\u7684\u539f\u56e0\uff0c\u65e9\u671f\u4e00\u822c\u8ba4\u4e3a\u5b57\u7b26\u96c6\u548c\u5b57\u7b26\u7f16\u7801\u662f\u540c\u4e49\u8bcd\uff0c\u5e76\u4e0d\u9700\u8981\u8fdb\u884c\u4e25\u683c\u533a\u5206\u3002</p> <p>\u56e0\u6b64\u5728\u50cfASCII\u8fd9\u6837\u7684\u7b80\u5355\u5b57\u7b26\u96c6\u4e3a\u4ee3\u8868\u7684\u4f20\u7edf\u5b57\u7b26\u7f16\u7801\u6a21\u578b\u4e2d\uff0c\u8fd9\u4e24\u4e2a\u6982\u5ff5\u7684\u542b\u4e49\u51e0\u4e4e\u662f\u7b49\u540c\u7684\u3002</p>"},{"location":"basic/8.MySQL%E5%AD%97%E7%AC%A6%E9%9B%86%E5%92%8C%E6%8E%92%E5%BA%8F%E8%A7%84%E5%88%99/#ascii","title":"ASCII\u7f16\u7801","text":"<p>\u7531\u4e8e\u8ba1\u7b97\u673a\u662f\u7f8e\u56fd\u4eba\u53d1\u660e\u7684\u3002\u56e0\u6b64\uff0c\u6700\u65e9\u53ea\u6709127\u4e2a\u82f1\u6587\u5b57\u7b26\u88ab\u7f16\u7801\u5230\u8ba1\u7b97\u673a\u91cc\uff0c\u4e5f\u5c31\u662f\u5927\u5c0f\u5199\u82f1\u6587\u5b57\u6bcd\u3001\u963f\u62c9\u4f2f\u6570\u5b57\u548c\u4e00\u4e9b\u7b26\u53f7\uff0c\u8fd9\u4e2a\u7f16\u7801\u8868\u88ab\u79f0\u4e3a ASCII\u7f16\u7801(\u7f8e\u56fd\u4fe1\u606f\u4e92\u6362\u6807\u51c6\u4ee3\u7801) \u3002</p> <p>\u5728 ASCII \u7f16\u7801\u89c4\u8303\u4e2d\uff1a\u5927\u5199\u5b57\u6bcd A \u7684\u7f16\u7801\u662f65\uff0c\u5c0f\u5199\u5b57\u6bcd z \u7684\u7f16\u7801\u662f122\u3002</p> <p>ASCII\u7801\u4e00\u5171\u89c4\u5b9a\u4e86128\u4e2a\u5b57\u7b26\u7684\u7f16\u7801\uff08\u5305\u62ec32\u4e2a\u4e0d\u80fd\u6253\u5370\u51fa\u6765\u7684\u63a7\u5236\u7b26\u53f7\uff09\uff0c\u6bd4\u5982\u7a7a\u683c SPACE \u7684 ASCII \u7801\u662f32\uff08\u4e8c\u8fdb\u5236\u8868\u793a\u4e3a 00100000\uff09\uff0c\u5927\u5199\u7684\u5b57\u6bcd A \u7684ASCII \u7801\u662f65\uff08\u4e8c\u8fdb\u5236\u8868\u793a\u4e3a 01000001\uff09\u3002\u8fd9128\u4e2a\u7b26\u53f7\u53ea\u9700\u8981\u5360\u7528\u4e86\u4e00\u4e2a\u5b57\u8282\u7684\u540e\u97627\u4f4d\uff0c\u6700\u524d\u9762\u7684\u4e00\u4f4d\u7edf\u4e00\u89c4\u5b9a\u4e3a0\u3002</p> <p>ASCII\u5b57\u7b26\u96c6\u6700\u5927\u7684\u7f3a\u70b9\u5c31\u662f\u53ea\u80fd\u663e\u793a26\u4e2a\u57fa\u672c\u62c9\u4e01\u5b57\u6bcd\u3001\u963f\u62c9\u4f2f\u6570\u5b57\u548c\u82f1\u5f0f\u7684\u6807\u70b9\u7b26\u53f7\uff0c\u4ee5\u53ca\u63a7\u5236\u5b57\u7b26\uff08\u56de\u8f66\u952e\u3001\u9000\u683c\u3001\u6362\u884c\u952e\u7b49\uff09\uff0c\u56e0\u6b64\u53ea\u80fd\u7528\u4e8e\u663e\u793a\u73b0\u4ee3\u7f8e\u56fd\u82f1\u8bed\u3002</p> <p>https://www.ascii-code.com/</p> <p>https://www.cs.cmu.edu/~pattis/15-1XX/common/handouts/ascii.html</p> <p>https://zhongwenzidian.18dao.cn/node/20707</p> <p>\u4f46\u662f\u8981\u5904\u7406\u4e2d\u6587\u663e\u7136\u4e00\u4e2a\u5b57\u8282\u662f\u4e0d\u591f\u7684\uff0c\u81f3\u5c11\u9700\u8981\u4e24\u4e2a\u5b57\u8282\uff0c\u800c\u4e14\u8fd8\u4e0d\u80fd\u548cASCII\u7f16\u7801\u51b2\u7a81\uff0c\u6240\u4ee5\uff0c\u4e2d\u56fd\u5236\u5b9a\u4e86GB2312\u7f16\u7801\uff0c\u7528\u6765\u628a\u4e2d\u6587\u7f16\u8fdb\u53bb\u3002</p> <p>\u5168\u4e16\u754c\u6709\u4e0a\u767e\u79cd\u8bed\u8a00\uff0c\u65e5\u672c\u628a\u65e5\u6587\u7f16\u5230Shift_JIS\u91cc\uff0c\u97e9\u56fd\u628a\u97e9\u6587\u7f16\u5230Euc-kr\u91cc\uff0c\u5404\u56fd\u6709\u5404\u56fd\u7684\u6807\u51c6\uff0c\u5c31\u4f1a\u4e0d\u53ef\u907f\u514d\u5730\u51fa\u73b0\u51b2\u7a81\uff0c\u7ed3\u679c\u5c31\u662f\uff0c\u5728\u591a\u8bed\u8a00\u6df7\u5408\u7684\u6587\u672c\u4e2d\uff0c\u663e\u793a\u51fa\u6765\u4f1a\u6709\u4e71\u7801\u3002</p>"},{"location":"basic/8.MySQL%E5%AD%97%E7%AC%A6%E9%9B%86%E5%92%8C%E6%8E%92%E5%BA%8F%E8%A7%84%E5%88%99/#unicode","title":"Unicode\u5b57\u7b26\u96c6","text":"<p>\u5728\u4e2d\u56fd\u53d1\u5c55\u51fa\u4ee5\u4e0a\u5b57\u7b26\u96c6\u5408\u5b57\u7b26\u7f16\u7801\u7684\u540c\u65f6\uff0c\u8ba1\u7b97\u673a\u4e5f\u5728\u4e16\u754c\u5404\u4e2a\u56fd\u5bb6\u8fc5\u901f\u666e\u53ca\u548c\u53d1\u5c55\u7740\uff0c\u6bcf\u4e2a\u56fd\u5bb6\u4e3a\u4e86\u4f7f\u8ba1\u7b97\u673a\u80fd\u591f\u663e\u793a\u5f53\u5730\u8bed\u8a00\u548c\u7b26\u53f7\uff0c\u4e5f\u7eb7\u7eb7\u8bbe\u8ba1\u51fa\u4e86\u5404\u79cd\u5b57\u7b26\u96c6\u548c\u5b57\u7b26\u7f16\u7801\u89c4\u5219\u3002</p> <p>\u6bcf\u4e2a\u56fd\u5bb6\u641e\u4e00\u5957\uff0c\u5728\u81ea\u5df1\u56fd\u5bb6\u4f7f\u7528\u6ca1\u95ee\u9898\uff0c\u4f46\u968f\u7740\u4e92\u8054\u7f51\u7684\u5174\u8d77\uff0c\u4f7f\u5f97\u5404\u4e2a\u56fd\u5bb6\u7684\u8ba1\u7b97\u673a\u90fd\u63a5\u5165\u5230\u4e92\u8054\u7f51\uff0c\u4fe1\u606f\u7684\u4ea4\u6d41\u548c\u901a\u4fe1\u8d8a\u6765\u8d8a\u591a\uff0c\u4f46\u7531\u4e8e\u7f16\u7801\u89c4\u5219\u4e0d\u540c\uff0c\u5f88\u5feb\u5c31\u51fa\u73b0\u4e86\u4e0d\u517c\u5bb9\u7684\u4e71\u7801\u73b0\u8c61\u3002</p> <p>\u4e3a\u4e86\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\uff0c\u8feb\u5207\u9700\u8981\u4e00\u4e2a\u7edf\u4e00\u7684\u5b57\u7b26\u96c6\uff0c\u80fd\u591f\u6db5\u76d6\u4e16\u754c\u5404\u4e2a\u56fd\u5bb6\u7684\u6587\u5b57\u548c\u7b26\u53f7\uff0c\u8fd9\u4e2a\u5b57\u7b26\u96c6\u5c31\u662fUnicode\u5b57\u7b26\u96c6\u3002</p> <p>Unicode\u5b57\u7b26\u96c6\u6bcf\u5e74\u90fd\u5728\u4fee\u8ba2\u548c\u66f4\u65b0\u4e2d\uff0c\u6301\u7eed\u4e0d\u65ad\u5730\u7eb3\u5165\u65b0\u7684\u6587\u5b57\u548c\u5b57\u7b26\u3002</p> <p>Unicode\u5b57\u7b26\u96c6\u7f16\u7801\u662f\u7531\u4e00\u4e2a\u540d\u4e3aUnicode\u5b66\u672f\u5b66\u4f1a(Unicode Consortium)\u7684\u673a\u6784\u5236\u8ba2\u7684\u5b57\u7b26\u7f16\u7801\u7cfb\u7edf\uff0c\u652f\u6301\u73b0\u4eca\u4e16\u754c\u5404\u79cd\u4e0d\u540c\u8bed\u8a00\u7684\u4e66\u9762\u6587\u672c\u7684\u4ea4\u6362\u3001\u5904\u7406\u53ca\u663e\u793a\u3002</p> <p>Unicode \u6e90\u4e8e\u4e00\u4e2a\u5f88\u7b80\u5355\u7684\u60f3\u6cd5\uff1a\u5c06\u5168\u4e16\u754c\u6240\u6709\u7684\u5b57\u7b26\u5305\u542b\u5728\u4e00\u4e2a\u96c6\u5408\u91cc\uff0c\u8ba1\u7b97\u673a\u53ea\u8981\u652f\u6301\u8fd9\u4e00\u4e2a\u5b57\u7b26\u96c6\uff0c\u5c31\u80fd\u663e\u793a\u6240\u6709\u7684\u5b57\u7b26\uff0c\u518d\u4e5f\u4e0d\u4f1a\u6709\u4e71\u7801\u4e86\u3002</p> <p>\u5b83\u4ece 0 \u5f00\u59cb\uff0c\u4e3a\u6bcf\u4e2a\u7b26\u53f7\u6307\u5b9a\u4e00\u4e2a\u7f16\u53f7\uff0c\u8fd9\u53eb\u505a\u201c\u7801\u70b9\u201d\uff08code point\uff09\u3002\u6bd4\u5982\uff0c\u7801\u70b9 0 \u7684\u7b26\u53f7\u5c31\u662f null\uff08\u8868\u793a\u6240\u6709\u4e8c\u8fdb\u5236\u4f4d\u90fd\u662f 0\uff09\u3002</p> <p>\u8be5\u7f16\u7801\u4e8e1990\u5e74\u5f00\u59cb\u7814\u53d1\uff0c1994\u5e74\u6b63\u5f0f\u516c\u5e03\u3002\u6700\u65b0\u7684Unicode\u7248\u672c\u662f14.0.0\uff0c\u5171\u5305\u542b\u4e86 144697 \u4e2a\u5b57\u7b26\u3002</p> <p>http://www.unicode.org/versions/Unicode14.0.0/</p>"},{"location":"basic/8.MySQL%E5%AD%97%E7%AC%A6%E9%9B%86%E5%92%8C%E6%8E%92%E5%BA%8F%E8%A7%84%E5%88%99/#unicode_1","title":"Unicode\u5b57\u7b26\u7f16\u7801\u7684\u4f18\u7f3a\u70b9","text":"<p>Unicode\u5b57\u7b26\u7f16\u7801\u7684\u4f18\u70b9\u662f\u80fd\u8986\u76d6\u4e16\u754c\u4e0a\u4efb\u4f55\u4e00\u79cd\u8bed\u8a00\u6240\u7528\u7684\u6587\u5b57\u7b26\u53f7\uff0c\u4f46\u7f3a\u70b9\u4e5f\u5f88\u660e\u663e\uff0c\u6211\u4eec\u5e38\u7528\u7684\u6587\u5b57\u5b57\u7b26\u90fd\u662f\u91c7\u75282\u4e2a\u5b57\u828216\u4f4d\u7f16\u7801\uff0c\u8fd9\u5728\u8fdb\u884c\u5b57\u7b26\u5b58\u50a8\u548c\u7f51\u7edc\u4f20\u8f93\u65f6\uff0c\u6d88\u8017\u7684\u8d44\u6e90\u662f\u6bd4\u8f83\u5927\u7684\u3002</p> <p>\u4f8b\u5982\uff0c\u5982\u679c\u4e00\u4e2a\u4ec5\u5305\u542b\u57fa\u672c7\u4f4dASCII\u5b57\u7b26\u7684Unicode\u6587\u4ef6\uff0c\u5982\u679c\u6bcf\u4e2a\u5b57\u7b26\u90fd\u4f7f\u75282\u5b57\u8282\u7684Unicode\u7f16\u7801\u4f20\u8f93\uff0c\u5176\u7b2c\u4e00\u5b57\u8282\u76848\u4f4d\u59cb\u7ec8\u4e3a0\uff0c\u8fd9\u5c31\u9020\u6210\u4e86\u6bd4\u8f83\u5927\u7684\u6d6a\u8d39\u3002</p> <p>\u4e3a\u4e86\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\uff0c\u8282\u7701\u5b58\u50a8\u7a7a\u95f4\u3001\u63d0\u9ad8\u7f51\u7edc\u4f20\u8f93\u6548\u7387\uff0c\u63d0\u51fa\u4e86Unicode\u8f6c\u6362\u683c\u5f0f\uff08Unicode Transformation Format\uff09\uff0c\u7b80\u79f0UTF\u3002</p> <p>UTF-32\u3001UTF-16\u3001UTF-8\u90fd\u662f\u4e3a\u4e86\u8f6c\u6362Unicode\u7801\u6240\u5236\u5b9a\u7684\u5404\u79cd\u8f6c\u6362\u65b9\u6848\u3002</p>"},{"location":"basic/8.MySQL%E5%AD%97%E7%AC%A6%E9%9B%86%E5%92%8C%E6%8E%92%E5%BA%8F%E8%A7%84%E5%88%99/#utf","title":"UTF\u7f16\u7801","text":"<p>UTF-8 \u662f\u4e00\u4e2a\u5b57\u7b26\u7f16\u7801\u7cfb\u7edf\u3002\u5b83\u53ef\u4ee5\u8ba9\u4f60\u5c06\u5b57\u7b26\u8868\u793a\u4e3a ASCII \u6587\u672c\uff0c\u540c\u65f6\u8fd8\u5141\u8bb8\u4f7f\u7528\u56fd\u9645\u5b57\u7b26\uff0c\u5982\u4e2d\u6587\u5b57\u7b26\u3002</p> <p>\u622a\u81f3 2020 \u5e74\u4ee3\u4e2d\u671f\uff0cUTF-8 \u662f\u6700\u6d41\u884c\u7684\u7f16\u7801\u7cfb\u7edf\u4e4b\u4e00\u3002</p>"},{"location":"basic/8.MySQL%E5%AD%97%E7%AC%A6%E9%9B%86%E5%92%8C%E6%8E%92%E5%BA%8F%E8%A7%84%E5%88%99/#_4","title":"\u6587\u672c\u6587\u4ef6\u548c\u4e8c\u8fdb\u5236\u6587\u4ef6","text":"<p>\u6570\u636e\u5728\u8ba1\u7b97\u673a\u4e2d\u5b58\u50a8\u5728\u7269\u7406\u4e0a\u662f\u4e8c\u8fdb\u5236\u7684\uff0c\u6240\u4ee5\u6587\u672c\u6587\u4ef6\u4e0e\u4e8c\u8fdb\u5236\u6587\u4ef6\u7684\u533a\u522b\u5e76\u4e0d\u662f\u7269\u7406\u4e0a\u7684\uff0c\u800c\u662f\u903b\u8f91\u4e0a\u7684\u3002\u8fd9\u4e24\u8005\u53ea\u662f\u5728\u7f16\u7801\u5c42\u6b21\u4e0a\u6709\u5dee\u5f02\u3002</p> <p>\u7b80\u5355\u6765\u8bf4\uff0c\u6587\u672c\u6587\u4ef6\u662f\u57fa\u4e8e\u5b57\u7b26\u7f16\u7801\u7684\u6587\u4ef6\uff0c\u5e38\u89c1\u7684\u7f16\u7801\u6709ASCII\u7f16\u7801\uff0cUNICODE\u7f16\u7801\u7b49\u7b49\u3002</p> <p>\u4e8c\u8fdb\u5236\u6587\u4ef6\u662f\u57fa\u4e8e\u503c\u7f16\u7801\u7684\u6587\u4ef6\uff0c\u4f60\u53ef\u4ee5\u6839\u636e\u5177\u4f53\u5e94\u7528\uff0c\u6307\u5b9a\u67d0\u4e2a\u503c\u662f\u4ec0\u4e48\u610f\u601d\uff08\u8fd9\u6837\u4e00\u4e2a\u8fc7\u7a0b\uff0c\u53ef\u4ee5\u770b\u4f5c\u662f\u81ea\u5b9a\u4e49\u7f16\u7801\uff09</p> <p>\u5b57\u7b26\u5b58\u50a8\u5230\u6587\u4ef6\u65f6\uff0c\u6839\u636e\u4f7f\u7528\u7684\u5b57\u7b26\u96c6\u627e\u5230\u8fd9\u4e2a\u5b57\u7b26\u5728\u8fd9\u4e2a\u5b57\u7b26\u96c6\u4e2d\u7684\u5b57\u7b26\u503c\uff0c\u7136\u540e\u6839\u636e\u6307\u5b9a\u7684\u7f16\u7801\u65b9\u5f0f\u5c06\u8fd9\u4e2a\u5b57\u7b26\u503c\u7f16\u7801\u4e3a\u4e8c\u8fdb\u5236\u5b57\u8282\u5f62\u5f0f\u5b58\u50a8\u5230\u6587\u4ef6\u4e2d\uff0c\u5e38\u89c1\u7684\u7f16\u7801\u65b9\u5f0f\u6709 ASCII\u3001UNICODE\u3001UTF-8 \u7b49\uff1b\u6307\u5b9a\u7f16\u7801\u65b9\u5f0f\u540e\uff0c\u6bcf\u4e2a\u5b57\u8282\uff08\u4e5f\u53ef\u4ee5\u662f\u6bcf\u4e24\u4e2a\u3001\u4e09\u4e2a\u5b57\u8282\uff09\u6240\u8868\u793a\u7684\u5b57\u7b26\u662f\u4e00\u6837\u7684\uff0c\u4efb\u4f55\u7a0b\u5e8f\u90fd\u53ef\u4ee5\u6b63\u786e\u8bfb\u53d6\u3002\u4e8c\u8fdb\u5236\u6587\u4ef6\u662f\u81ea\u5b9a\u4e49\u7f16\u7801\u7684\uff0c\u4e5f\u5c31\u662f\u8bf4\uff0c\u4f60\u53ef\u4ee5\u6839\u636e\u5177\u4f53\u7a0b\u5e8f\u6307\u5b9a\u6bcf\u4e2a\u5b57\u8282\uff08\u6216\u8005\u6bcf\u4e24\u4e2a\u3001\u4e09\u4e2a\u5b57\u8282\uff09\u4ee3\u8868\u4ec0\u4e48\u610f\u601d\u3002\u4f8b\u5982\uff0cA \u7a0b\u5e8f\u662f\u56fe\u50cf\u7f16\u8f91\u5668\uff0c\u6307\u5b9a 01001111 \u4ee3\u8868\u7ea2\u8272\uff0cB \u7a0b\u5e8f\u662f\u89c6\u9891\u64ad\u653e\u5668\uff0c\u5b83\u628a 01001111 \u7406\u89e3\u4e3a\u5feb\u8fdb\uff0c\u663e\u7136\u662f\u4e0d\u5bf9\u7684\u3002\u6240\u4ee5\uff0c\u5b57\u7b26\u6587\u4ef6\u662f\u901a\u7528\u7684\uff0c\u4efb\u4f55\u7a0b\u5e8f\u53ea\u8981\u6309\u7167\u5bf9\u5e94\u7684\u7f16\u7801\u65b9\u5f0f\u6253\u5f00\u90fd\u53ef\u4ee5\u6b63\u786e\u663e\u793a</p>"},{"location":"basic/8.MySQL%E5%AD%97%E7%AC%A6%E9%9B%86%E5%92%8C%E6%8E%92%E5%BA%8F%E8%A7%84%E5%88%99/#mysql","title":"MySQL\u4e2d\u7684\u5b57\u7b26\u96c6","text":"<p>character set \u3002\u60f3\u8981\u628a\u5404\u79cd\u4eba\u7c7b\u53ef\u4ee5\u7406\u89e3\u7684\u5b57\u7b26\u5b58\u50a8\u5230\u8ba1\u7b97\u673a\u4e2d\uff0c\u5c31\u9700\u8981\u5efa\u7acb\u5b57\u7b26\u4e0e\u4e8c\u8fdb\u5236\u6570\u5b57\u7684\u6620\u5c04\u5173\u7cfb\u3002</p> <p>\u5b57\u7b26\u96c6\u5c31\u662f\u8fd9\u6837\u7684\u4e00\u79cd\u6620\u5c04\u5173\u7cfb\uff0c\u4e0d\u540c\u7684\u5b57\u7b26\u96c6\u8868\u793a\u7684\u5b57\u7b26\u6570\u91cf\u4e0d\u540c\uff0c\u5b57\u7b26\u96c6\u8d8a\u5927\uff0c\u6240\u80fd\u8868\u793a\u7684\u5b57\u7b26\u8d8a\u591a\uff0c\u9700\u8981\u5360\u7528\u7684\u4e8c\u8fdb\u5236\u4f4d\u66f4\u591a\uff0c\u9700\u8981\u7684\u78c1\u76d8\u7a7a\u95f4\u5c31\u8d8a\u5927\u3002</p> <p>\u5728 MySQL \u4e2d\uff0c\u5b57\u7b26\u96c6\u7684\u6982\u5ff5\u548c\u7f16\u7801\u65b9\u6848\u88ab\u770b\u505a\u662f\u540c\u4e49\u8bcd\uff0c\u4e00\u4e2a\u5b57\u7b26\u96c6\u662f\u4e00\u4e2a\u8f6c\u6362\u8868\u548c\u4e00\u4e2a\u7f16\u7801\u65b9\u6848\u7684\u7ec4\u5408\u3002</p> <p>\u6211\u4eec\u53ef\u4ee5\u4e3a MySQL \u670d\u52a1\u5668\u3001\u6570\u636e\u5e93\u3001\u8868\u3001\u5b57\u7b26\u7c7b\u578b\u7684\u5b57\u6bb5\u4ee5\u53ca\u5b57\u7b26\u4e32\u5e38\u91cf\u6307\u5b9a\u4e00\u4e2a\u5b57\u7b26\u96c6\uff08Character Set\uff09\u548c\u6392\u5e8f\u89c4\u5219\uff08Collation\uff09\u3002</p> <p>MySQL \u4e2d\u6240\u652f\u6301\u7684\u5b57\u7b26\u96c6\u5b58\u5728 <code>information.CHARACTER_SETS</code> \u8868\u4e2d\uff0c\u5176\u4e2d  utf8mb4  \u5b57\u7b26\u96c6\u517c\u5bb9\u6027\u6700\u597d\uff0c\u5b83\u53ef\u4ee5\u5b58\u5404\u79cd\u8bed\u8a00\u7684\u5b57\u7b26\uff0c\u5305\u62ec emoji \u8868\u60c5\u7b49\u3002</p> <p>MySQL\u7684utf8\u5e76\u4e0d\u662f\u771f\u6b63\u610f\u4e49\u4e0a\u7684utf8\uff0cMySQL\u7684utf8\u53ea\u652f\u6301\u6700\u957f\u4e09\u4e2a\u5b57\u8282\uff0c\u6240\u4ee5Emoji \u8868\u60c5\u548c\u6709\u4e9b\u751f\u50fb\u5b57\u4ee5\u53ca\u4efb\u4f55\u65b0\u589e\u7684 Unicode \u5b57\u7b26\u7b49\u5982\u679c\u8d85\u8fc7\u4e09\u4e2a\u5b57\u8282\u7528utf8\u5b57\u7b26\u96c6\u4fdd\u5b58\u662f\u4f1a\u62a5\u9519\u7684\u3002</p> <p>MySQL \u4e2d\u7684 <code>utf8mb4</code> \u5b57\u7b26\u96c6\u5c31\u662f MySQL \u5bf9 Unicode \u5b57\u7b26\u96c6\u7684\u5177\u4f53\u5b9e\u73b0\uff0c\u53c2\u8003</p> <p>MySQL 8.0 \u5f00\u59cb\uff0c\u9ed8\u8ba4\u5b57\u7b26\u96c6\u88ab\u6539\u4e3a utf8mb4\uff0c\u800c\u4e0d\u662f\u4e4b\u524d\u7684 latin1 \uff0cutf8mb4 \u4e2d\u7684\u4e00\u4e2a\u5b57\u7b26\u6700\u591a\u5360\u7528 4 \u4e2a\u5b57\u8282\u3002</p> <pre><code>-- \u67e5\u770bMySQL\u652f\u6301\u7684\u6240\u6709\u5b57\u7b26\u96c6\u79cd\u7c7b\nSHOW CHARACTER SET;\nselect * from information_schema.character_sets;\n\n-- \u67e5\u770b\u5f53\u524dMySQL Server\u914d\u7f6e\u7684\u5404\u79cd\u5c42\u9762\u7684\u5b57\u7b26\u96c6\nshow VARIABLES like \"%character_set%\"\n\n\n\n-- \u5efa\u5e93\u6307\u5b9a\u5e93\u7ea7\u522b\u7684\u5b57\u7b26\u96c6\uff0c\u5982\u679c\u4e0d\u6307\u5b9a\uff0c\u9ed8\u8ba4\u4f1a\u4ececharacter_set_database\u8fd9\u4e2a\u53d8\u91cf\u7ee7\u627f\nCREATE schema qhdata_inspect DEFAULT charset utf8mb4 collate utf8mb4_general_ci;\n\n-- \u5efa\u8868\u6307\u5b9a\u8868\u7ea7\u522b\u7684\u5b57\u7b26\u96c6\uff0c\u4e5f\u53ef\u4ee5\u5bf9\u5b57\u6bb5\u8bbe\u7f6e\u5b57\u7b26\u96c6\n\n-- MySQL \u5b57\u7b26\u96c6\u548c\u6392\u5e8f\u89c4\u5219\u7684\u4f18\u5148\u7ea7\u522b\u4e3a\u5b57\u6bb5\u7ea7\u522b\u5927\u4e8e\u8868\u7ea7\u522b\uff0c\u8868\u7ea7\u522b\u5927\u4e8e\u6570\u636e\u5e93\u7ea7\u522b\uff0c\u6570\u636e\u5e93\u7ea7\u522b\u5927\u4e8e\u670d\u52a1\u5668\u7ea7\u522b\u3002\nCREATE TABLE  IF NOT EXISTS demo.test(\n        `org_name` VARCHAR(20) NOT NULL CHARACTER SET utf8mb4  COLLATE utf8mb4_general_ci  ,\n        `create_time` DATETIME DEFAULT CURRENT_TIMESTAMP,        \n)\nENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;\n\n\n-- MySQL \u4e2d\u7684\u5b57\u7b26\u4e32\u5e38\u91cf\u4e5f\u6709\u5b57\u7b26\u96c6\u548c\u6392\u5e8f\u89c4\u5219\u3002\u4f8b\u5982\uff0c\u4ee5\u4e0b\u5b57\u7b26\u4e32\u5e38\u91cf\u4f7f\u7528\u76f8\u540c\u7684\u5b57\u7b26\u96c6\uff1a\nSELECT '\u6570\u636e\u5e93';\nSELECT _utf8mb4'\u6570\u636e\u5e93';\nSELECT _utf8mb4'\u6570\u636e\u5e93' COLLATE utf8mb4_0900_ai_ci;\n\n\n\n--\u4fee\u6539\u8868\u7684\u5b57\u7b26\u96c6\u548c\u5b57\u6bb5\u7684\u5b57\u7b26\u96c6\n\n-- \u5bf9\u5df2\u5b58\u5728\u7684\u8868\u4fee\u6539\u5b57\u7b26\u96c6\uff0c\u53ea\u662f\u4fee\u6539\u4e86\u540e\u7eed\u65b0\u589e\u5217\u7684\u9ed8\u8ba4\u5b57\u7b26\u96c6\u3002\u5bf9\u4e8e\u5df2\u5b58\u5728\u7684\u5217\u5b57\u7b26\u96c6\uff0c\u5e76\u6ca1\u6709\u6539\u53d8\u3002\nALTER TABLE emoji_test CHARSET utf8mb4;\n\n-- \u6b63\u786e\u4fee\u6539\u5217\u5b57\u7b26\u96c6\u7684\u547d\u4ee4\u5e94\u8be5\u4f7f\u7528 ALTER TABLE ... CONVERT TO...\u8fd9\u6837\u624d\u80fd\u5c06\u4e4b\u524d\u7684\u5217 a \u5b57\u7b26\u96c6\u4ece UTF8 \u4fee\u6539\u4e3a UTF8MB4\nALTER TABLE emoji_test CONVERT TO CHARSET utf8mb4;\n\n\n--LENGTH(column) \u51fd\u6570\u8fd4\u56de\u4ee5\u5b57\u8282\u4e3a\u5355\u4f4d\u7684\u5b57\u7b26\u4e32\u957f\u5ea6\uff0c\u591a\u5b57\u8282\u5b57\u7b26\u96c6\u4e2d\u5b57\u7b26\u5360\u7528\u7684\u5b57\u8282\u6570\u53ef\u80fd\u4e0d\u540c\n--CHAR_LENGTH(column) \u51fd\u6570\u8fd4\u56de\u4ee5\u5b57\u7b26\u4e3a\u5355\u4f4d\u7684\u5b57\u7b26\u4e32\u957f\u5ea6\u3002\n</code></pre>"},{"location":"basic/8.MySQL%E5%AD%97%E7%AC%A6%E9%9B%86%E5%92%8C%E6%8E%92%E5%BA%8F%E8%A7%84%E5%88%99/#_5","title":"\u6392\u5e8f\u89c4\u5219","text":"<p>\u5728 SQL \u4e2d\uff0c\u7ecf\u5e38\u6709\u6392\u5e8f\u6216\u6bd4\u8f83\u7b49\u573a\u666f\u3002</p> <p>collation\uff0c\u68c0\u9a8c\u89c4\u5219\uff0c\u53c8\u79f0\u4e3a\u6392\u5e8f\u89c4\u5219\uff0c\u4e00\u822c\u662f\u7528\u4e8e\u6bd4\u8f83\u5b57\u7b26\u7684\u4e00\u5957\u89c4\u5219\uff0c\u5373\u5b57\u7b26\u7684\u6392\u5e8f\u89c4\u5219\u3002\u6bd4\u5982\u6709\u7684\u89c4\u5219\u533a\u5206\u5927\u5c0f\u5199\uff0c\u6709\u7684\u5219\u65e0\u89c6\u3002</p> <p>\u4e16\u754c\u4e0a\u7684\u6587\u5b57\u5f88\u591a\uff0c\u6240\u4ee5\u624d\u4f1a\u6709\u201c\u4e0d\u533a\u5206\u97f3\u8c03\u201d\u7684\u8981\u6c42\uff0c\u8fd9\u65f6\u5019e\u3001\u0113\u3001\u00e9\u3001\u011b\u3001\u00e8\u5c31\u662f\u7b49\u4ef7\u7684\u3002</p> <p>\u90a3\u4e48\u5047\u8bbe\u6211\u4eec\u8981\u8fdb\u884c\u62fc\u97f3\u67e5\u627e\uff0c\u53ea\u8981\u6309e\u53bb\u627e\u5c31\u53ef\u4ee5\u5168\u90e8\u5217\u51fa\u6765\uff0c\u5f88\u65b9\u4fbf\u3002\u751a\u81f3\uff0c\u5b83\u4eec\u4e5f\u548c\u00ea\u3001\u00eb\u4e5f\u662f\u7b49\u4ef7\u7684\uff0c\u8fd9\u6837\u5c31\u66f4\u65b9\u4fbf\u4e86\u3002</p> <p>\u6bcf\u79cd\u5b57\u7b26\u96c6\u90fd\u53ef\u80fd\u6709\u591a\u79cd\u68c0\u9a8c\u89c4\u5219\uff0c\u5e76\u4e14\u90fd\u6709\u4e00\u4e2a\u9ed8\u8ba4\u7684\u68c0\u9a8c\u89c4\u5219(information_schema. CHARACTER_SETS.DEFAULT_COLLATE_NAME)</p> <pre><code>SHOW COLLATION WHERE Charset = 'utf8mb4';\n\nselect * from information_schema.COLLATIONS;\n</code></pre> <p>\u6bcf\u4e2a\u6821\u9a8c\u89c4\u5219\u53ea\u80fd\u7528\u4e8e\u4e00\u4e2a\u5b57\u7b26\u96c6\uff0c\u56e0\u6b64\u5b57\u7b26\u96c6\u4e0e\u6821\u9a8c\u89c4\u5219\u662f\u4e00\u5bf9\u591a\u7684\u5173\u7cfb\u3002</p> <p>MySQL\u5b57\u7b26\u96c6\u548c\u6392\u5e8f\u89c4\u5219\u4f18\u5148\u7ea7\uff1aMySQL \u5b57\u7b26\u96c6\u548c\u6392\u5e8f\u89c4\u5219\u7684\u4f18\u5148\u7ea7\u522b\u4e3a\u5b57\u6bb5\u7ea7\u522b\u5927\u4e8e\u8868\u7ea7\u522b\uff0c\u8868\u7ea7\u522b\u5927\u4e8e\u6570\u636e\u5e93\u7ea7\u522b\uff0c\u6570\u636e\u5e93\u7ea7\u522b\u5927\u4e8e\u670d\u52a1\u5668\u7ea7\u522b\u3002</p> <p>\u6821\u9a8c\u89c4\u5219\u5b58\u50a8\u5728 information_schema.COLLATIONS \u8868\u4e2d\u3002\u5bf9\u4e8e utf8mb4 \u5b57\u7b26\u96c6\uff0c\u4e00\u822c\u5efa\u8bae\u4f7f\u7528  utf8mb4_general_ci \u6392\u5e8f\u89c4\u5219\u3002\u53c2\u8003</p> <ul> <li> <p>\u6392\u5e8f\u89c4\u5219\u547d\u540d\u60ef\u4f8b\uff1a\u5b57\u7b26\u96c6\u540d_\u5bf9\u5e94\u7684\u8bed\u8a00\u6392\u5e8f\u89c4\u5219_Unicode\u7248\u672c_ai/as/ci/cs/ks/bin</p> </li> <li> <p>\u5b57\u7b26\u96c6\u540d\uff1a\u8fd9\u4e2a\u5f88\u597d\u7406\u89e3\uff0c\u8868\u793a\u6392\u5e8f\u89c4\u5219\u5c5e\u4e8e\u5bf9\u5e94\u7684\u5b57\u7b26\u96c6\u3002\u4e0d\u540c\u5b57\u7b26\u96c6\u4e4b\u95f4\u7684\u5b57\u6bb5\u80af\u5b9a\u662f\u65e0\u6cd5\u6bd4\u8f83\u7684\u3002</p> </li> <li> <p>\u5bf9\u5e94\u8bed\u8a00\u7684\u6392\u5e8f\u89c4\u5219\uff1a\u6bd4\u5982utf8mb4_zh_0900_as_cs\u4e2d\u7684zh\u5c31\u662f\u8868\u793a\u6c49\u5b57\u7684\u6392\u5e8f\u89c4\u5219\uff0c\u5b83\u89c4\u5b9a\u5b57\u6bb5\u6309\u7167\u4e2d\u6587\u62fc\u97f3\u8fdb\u884c\u6392\u5e8f\u3002</p> </li> <li> <p>\u5982\u679c\u662funicode\u5b57\u7b26\u96c6\uff0c\u90a3\u4e48\u53ef\u80fd\u4f1a\u6709unicode\u7248\u672c\u6807\u8bc6\uff0c\u6bd4\u5982MySQL8.x\u4e2d\u7684_0900_ai_ci\u6392\u5e8f\u89c4\u5219\u4e2d\u76840900\u5c31\u662f\u8868\u793a\u89c4\u5219\u57fa\u4e8eUnicode 9.0</p> </li> <li> <p>\u6392\u5e8f\u540e\u7f00\uff0c\u53ef\u4ee5\u7528\u4e8e\u8868\u793a\u662f\u5426\u533a\u5206\u5927\u5c0f\u5199\uff0c\u662f\u5426\u533a\u5206\u53e3\u97f3\u7b49\u7b49\uff0c\u5bf9\u4e8e\u4e2d\u6587\u57fa\u672c\u4e0a\u53ef\u4ee5\u5ffd\u7565\u3002</p> </li> </ul> <p>\u5e38\u89c1utf8mb4\u5b57\u7b26\u96c6\u4e2d\u7684\u6392\u5e8f\u89c4\u5219\uff1a</p> <ul> <li> <p>utf8mb4_unicode_ci is based on the official Unicode rules for universal sorting and comparison, which sorts accurately in a wide range of languages.</p> </li> <li> <p>utf8mb4_general_ci is a simplified set of sorting rules which aims to do as well as it can while taking many short-cuts designed to improve speed. It does not follow the Unicode rules and will result in undesirable sorting or comparison in some situations, such as when using particular languages or characters.</p> </li> </ul> <p>https://stackoverflow.com/questions/766809/whats-the-difference-between-utf8-general-ci-and-utf8-unicode-ci</p> <p>MySQL 8.0 \u9ed8\u8ba4\u4f7f\u7528 utf8mb4 \u5b57\u7b26\u96c6\uff0c\u9ed8\u8ba4\u7684\u6392\u5e8f\u89c4\u5219\u4e3a utf8mb4_0900_ai_ci\uff0c\u8868\u793a\u4e0d\u533a\u5206\u91cd\u97f3\u548c\u5927\u5c0f\u5199\u3002</p> <pre><code>-- \u5bf9\u4e8eMySQL8.0\u7684\u9ed8\u8ba4utf8mb4\u5b57\u7b26\u96c6\u548cutf8mb4_0900_ai_ci\u9ed8\u8ba4\u6392\u5e8f\u89c4\u5219\u3002\u6267\u884c\u5982\u4e0b\u67e5\u8be2\uff1a\n\n\nSELECT 'a'  = 'A' ;                                     /*\u7ed3\u679c\u662f1*/\nSELECT 'a' COLLATE utf8mb4_zh_0900_as_cs  = 'A' ;       /*--\u7ed3\u679c\u662f0*/\n\n-- \u56e0\u4e3autf8mb4_0900_ai_ci\u9ed8\u8ba4\u4e0d\u533a\u5206\u82f1\u6587\u5927\u5c0f\u5199\uff0c\u6240\u4ee5\u5b83\u8ba4\u4e3a\"a\"\u548c\"A\"\u662f\u76f8\u7b49\u7684\u4e24\u4e2a\u5b57\u7b26\u3002\n</code></pre>"},{"location":"basic/8.MySQL%E5%AD%97%E7%AC%A6%E9%9B%86%E5%92%8C%E6%8E%92%E5%BA%8F%E8%A7%84%E5%88%99/#_6","title":"\u4e2d\u6587\u5b57\u6bb5\u6392\u5e8f","text":"<pre><code>-- \u5bf9\u4e8e\u4e2d\u6587\u800c\u8a00\uff0c\u6392\u5e8f\u65b9\u5f0f\u4e0e\u82f1\u6587\u6709\u6240\u4e0d\u540c\uff1b\u4e2d\u6587\u901a\u5e38\u9700\u8981\u6309\u7167\u62fc\u97f3\u3001\u504f\u65c1\u90e8\u9996\u6216\u8005\u7b14\u753b\u6570\u8fdb\u884c\u6392\u5e8f\u3002\n\n-- MySQL8.0\u4e2d\uff0c\u9ed8\u8ba4\u4f7f\u7528utf8mb4\u5b57\u7b26\u96c6\uff0c\u8fd9\u4e2a\u5b57\u7b26\u96c6\u9ed8\u8ba4\u4f7f\u7528\u7684\u6392\u5e8f\u89c4\u5219\u662f utf8mb4_0900_ai_ci \uff0c\u5b83\u9ed8\u8ba4\u662f\u5bf9\u4e8e\u4e2d\u6587\u6309\u7167\u504f\u65c1\u90e8\u9996\u8fdb\u884c\u6392\u5e8f\u3002\n\nSELECT emp_name FROM employee ORDER BY emp_name;\n\n\nemp_name  |\n----------|\n\u5173\u5174      |\n\u5173\u5e73      |\n\u5173\u7fbd      |\n\u5218\u5907      |\n\u5468\u4ed3      |\n\u5b59\u4e2b\u9b1f    |\n\u5b59\u4e7e      |\n\u5b59\u5c1a\u9999    |\n\u5e9e\u7edf      |\n\u5ed6\u5316      |\n...\n\n\n-- \u53ef\u4ee5\u5728\u67e5\u8be2\u65f6\u6307\u5b9a\u6392\u5e8f\u89c4\u5219\uff0cselect\u4e2d\u7684collate\u5b50\u53e5\u53ef\u4ee5\u7528\u5728 order by\u5b50\u53e5\uff0cgroup by\u3001having\u3001\u805a\u96c6\u51fd\u6570\u3001\u522b\u540d\u7b49\n-- \u5bf9\u4e8e utf8mb4 \u5b57\u7b26\u96c6\uff0c\u5982\u679c\u8bbe\u7f6e utf8mb4_zh_0900_as_cs \u6392\u5e8f\u89c4\u5219\uff0c\u90a3\u4e48\u5c31\u53ef\u4ee5\u6309\u7167\u4e2d\u6587\u62fc\u97f3\u8fdb\u884c\u6392\u5e8f\u3002\n\nSELECT emp_name FROM employee ORDER BY emp_name collate 'utf8mb4_zh_0900_as_cs';\nemp_name |\n----------|\n\u9093\u829d      |\n\u6cd5\u6b63      |\n\u5173\u5e73      |\n\u5173\u5174      |\n\u5173\u7fbd      |\n\u9ec4\u6743      |\n\u9ec4\u5fe0      |\n\u7b80\u96cd      |\n\u848b\u742c      |\n\u5ed6\u5316      |\n...\n\n\n-- \u4e5f\u53ef\u4ee5\u5c06\u6570\u636e\u8f6c\u6362\u4e3a\u5176\u4ed6\u652f\u6301\u7279\u5b9a\u6392\u5e8f\u89c4\u5219\u7684\u5b57\u7b26\u96c6\uff0c\u4f8b\u5982 gbk \u5b57\u7b26\u96c6\u9ed8\u8ba4\u7684 gbk_chinese_ci \u6392\u5e8f\u89c4\u5219\u5c31\u662f\u6309\u7167\u62fc\u97f3\u8fdb\u884c\u6392\u5e8f\uff1a\nSELECT emp_name FROM employee  ORDER BY convert(emp_name using gbk);\n</code></pre>"},{"location":"basic/8.MySQL%E5%AD%97%E7%AC%A6%E9%9B%86%E5%92%8C%E6%8E%92%E5%BA%8F%E8%A7%84%E5%88%99/#_7","title":"\u5e38\u89c1\u5b57\u7b26\u96c6\u548c\u5b57\u7b26\u7f16\u7801","text":"<p>MySQL\u5b57\u7b26\u96c6\u8bbe\u7f6e\u5927\u6982\u5206\u4e3a\u4e24\u7c7b\uff1a</p> <ul> <li>\u521b\u5efa\u5bf9\u8c61\u7684\u9ed8\u8ba4\u503c\u3002\u7ea7\u522b\u4f9d\u6b21\u4ece\u9ad8\u5230\u4f4e\uff0c\u4f4e\u7ea7\u522b\u5982\u679c\u672a\u6307\u5b9a\uff0c\u81ea\u52a8\u7ee7\u627f\u9ad8\u7ea7\u522b\u3002</li> </ul> \u7ea7\u522b \u914d\u7f6e\u53c2\u6570 \u662f\u5426\u53ef\u914d\u7f6e \u662f\u5426\u53ef\u521b\u5efa\u65f6\u6307\u5b9a \u5efa\u8bae\u503c Server <code>character_set_server</code> \u53ef \u4e0d\u53ef \u5efa\u8bae\u5728/etc/my.cnf\u914d\u7f6e\u4e3autf8mb4\uff0c\u521b\u5efa\u65f6\u4e0d\u5355\u72ec\u6307\u5b9a Database <code>character_set_database</code> \u53ef \u53ef\u4ee5 \u5efa\u8bae\u5728/etc/my.cnf\u914d\u7f6e\u4e3autf8mb4\uff0c\u521b\u5efa\u65f6\u4e0d\u5355\u72ec\u6307\u5b9a Table \u9ed8\u8ba4\u7ee7\u627f\u5e93\u5b57\u7b26\u96c6 \u4e0d \u53ef\u4ee5 \u5efa\u8bae\u76f4\u63a5\u7ee7\u627f\u4e0a\u7ea7\uff0c\u7279\u6b8a\u60c5\u51b5\u53ef\u4ee5\u5355\u72ec\u6307\u5b9a Collum \u9ed8\u8ba4\u7ee7\u627f\u8868\u5b57\u7b26\u96c6 \u4e0d \u53ef\u4ee5 \u5efa\u8bae\u76f4\u63a5\u7ee7\u627f\u4e0a\u7ea7 <ul> <li></li> </ul> <p>utf8\u5b57\u7b26\u96c6\u4e0b\u9ed8\u8ba4\u7684\u6bd4\u8f83\u89c4\u5219\u662futf8_general_ci\uff0c\u65e5\u5e38\u4e2d\u4f1a\u7528\u5230\u7684\u6709<code>utf8_general_ci</code>\uff0c<code>utf8_unicode_ci</code>\uff0c<code>utf8_bin</code>\u4e09\u79cd\u6bd4\u8f83\u89c4\u5219\uff0c\u5176\u4ed6\u6bd4\u8f83\u89c4\u5219\u57fa\u672c\u5f88\u5c11\u4f1a\u7528\uff0c\u4e0b\u9762\u7b80\u5355\u4e86\u89e3\u4e0b\u8fd9\u4e09\u79cd\u6bd4\u8f83\u89c4\u5219\u7684\u5f02\u540c\u3002</p> <p>\u9996\u5148utf8_bin\u7684\u6bd4\u8f83\u65b9\u6cd5\u5176\u5b9e\u5c31\u662f\u76f4\u63a5\u5c06\u6240\u6709\u5b57\u7b26\u770b\u4f5c\u4e8c\u8fdb\u5236\u4e32\uff0c\u7136\u540e\u4ece\u6700\u9ad8\u4f4d\u5f80\u6700\u4f4e\u4f4d\u6bd4\u5bf9\u3002\u6240\u4ee5\u5f88\u663e\u7136\u5b83\u662f\u533a\u5206\u5927\u5c0f\u5199\u7684\u3002\u800cutf8_general_ci\u548cutf8_unicode_ci\u662f\u4e0d\u533a\u5206\u5927\u5c0f\u5199\u7684\u3002</p> <p>utf8_general_ci\u548cutf8_unicode_ci\u5bf9\u4e2d\u3001\u82f1\u6587\u6765\u8bf4\u6ca1\u6709\u5b9e\u8d28\u7684\u5dee\u522b\u3002utf8_unicode_ci\u7684\u6700\u4e3b\u8981\u7684\u7279\u8272\u662f\u652f\u6301\u6269\u5c55\uff0c\u5373\u5f53\u628a\u4e00\u4e2a\u5b57\u6bcd\u770b\u4f5c\u4e0e\u5176\u5b83\u5b57\u6bcd\u7ec4\u5408\u76f8\u7b49\u65f6\u3002\u4f8b\u5982\uff0c\u5728\u5fb7\u8bed\u548c\u4e00\u4e9b\u5176\u5b83\u8bed\u8a00\u4e2d\u2018\u00df'\u7b49\u4e8e\u2018ss'</p> <p>utf8_general_ci\u662f\u4e00\u4e2a\u9057\u7559\u7684\u6bd4\u8f83\u89c4\u5219\uff0c\u4e0d\u652f\u6301\u6269\u5c55\u3002\u5b83\u4ec5\u80fd\u591f\u5728\u5b57\u7b26\u4e4b\u95f4\u8fdb\u884c\u9010\u4e2a\u6bd4\u8f83\u3002\u8fd9\u610f\u5473\u7740utf8_general_ci\u6bd4\u8f83\u89c4\u5219\u8fdb\u884c\u7684\u6bd4\u8f83\u901f\u5ea6\u5f88\u5feb\uff0c\u4f46\u662f\u4e0eutf8_unicode_ci\u76f8\u6bd4\uff0c\u6bd4\u8f83\u6b63\u786e\u6027\u8f83\u5dee\u3002</p> <pre><code># \u521b\u5efa\u8868 \u6307\u5b9a\u5217\u4e3a\u4e0d\u540c\u7684\u6392\u5e8f\u89c4\u5219\nmysql&gt; create table utf8_test (\n    -&gt; col_general varchar(20) CHARACTER SET utf8 COLLATE utf8_general_ci,\n    -&gt; col_unicode varchar(20) CHARACTER SET utf8 COLLATE utf8_unicode_ci,\n    -&gt; col_bin varchar(20) CHARACTER SET utf8 COLLATE utf8_bin\n    -&gt; ) ENGINE=InnoDB DEFAULT CHARSET=utf8;\n\n # \u63d2\u5165\u6570\u636e\uff0c\u6bcf\u884c\u6570\u636e\u5404\u4e2a\u5b57\u6bb5\u503c\u4e00\u6837\n mysql&gt; select * from utf8_test;\n+-------------+-------------+---------+\n| col_general | col_unicode | col_bin |\n+-------------+-------------+---------+\n| MySQL       | MySQL       | MySQL   |\n| mysql       | mysql       | mysql   |\n| A           | A           | A       |\n| a           | a           | a       |\n| aA          | aA          | aA      |\n+-------------+-------------+---------+\n# \u67e5\u8be2\nmysql&gt; select * from utf8_test where col_general='mysql';\n+-------------+-------------+---------+\n| col_general | col_unicode | col_bin |\n+-------------+-------------+---------+\n| MySQL       | MySQL       | MySQL   |\n| mysql       | mysql       | mysql   |\n+-------------+-------------+---------+\nmysql&gt; select * from utf8_test where col_unicode='MySQL';\n+-------------+-------------+---------+\n| col_general | col_unicode | col_bin |\n+-------------+-------------+---------+\n| MySQL       | MySQL       | MySQL   |\n| mysql       | mysql       | mysql   |\n+-------------+-------------+---------+\n# \u9a8c\u8bc1\uff0c\u53ea\u6709utf8_bin\u7c7b\u578b\u7684\u5b57\u6bb5\u533a\u5206\u5927\u5c0f\u5199\nmysql&gt; select * from utf8_test where col_bin='mysql';       \n+-------------+-------------+---------+\n| col_general | col_unicode | col_bin |\n+-------------+-------------+---------+\n| mysql       | mysql       | mysql   |\n+-------------+-------------+---------+\n# \u6392\u5e8f \u53d1\u73b0\u4e0d\u540c\u6392\u5e8f\u89c4\u5219\u5bf9\u987a\u5e8f\u6709\u5f71\u54cd\nmysql&gt; select * from utf8_test order by col_general;\n+-------------+-------------+---------+\n| col_general | col_unicode | col_bin |\n+-------------+-------------+---------+\n| A           | A           | A       |\n| a           | a           | a       |\n| aA          | aA          | aA      |\n| MySQL       | MySQL       | MySQL   |\n| mysql       | mysql       | mysql   |\n+-------------+-------------+---------+\nmysql&gt; select * from utf8_test order by col_bin;\n+-------------+-------------+---------+\n| col_general | col_unicode | col_bin |\n+-------------+-------------+---------+\n| A           | A           | A       |\n| MySQL       | MySQL       | MySQL   |\n| a           | a           | a       |\n| aA          | aA          | aA      |\n| mysql       | mysql       | mysql   |\n+-------------+-------------+---------+\n</code></pre>"},{"location":"basic/8.MySQL%E5%AD%97%E7%AC%A6%E9%9B%86%E5%92%8C%E6%8E%92%E5%BA%8F%E8%A7%84%E5%88%99/#_8","title":"\u5173\u4e8e\u5b57\u7b26\u96c6\u548c\u6392\u5e8f\u89c4\u5219\u5efa\u8bae","text":"<p>\u5bf9\u4e8eMySQL 5.7\u7248\u672c\uff0c\u4e00\u822c\u60c5\u51b5\u4e0b\u5efa\u8bae\u5c06\u5b57\u7b26\u96c6\u6539\u4e3autf8\uff0c\u6bd4\u8f83\u89c4\u5219\u9009\u62e9\u9ed8\u8ba4\u7684utf8_general_ci\u3002</p> <p>utf8_general_ci\u76f8\u5bf9\u4e8eutf8_unicode_ci\u6765\u8bf4\u6821\u5bf9\u901f\u5ea6\u5feb\uff0c\u4f46\u662f\u5982\u679c\u4f60\u7684\u5e94\u7528\u6709\u5fb7\u8bed\u3001\u6cd5\u8bed\u6216\u8005\u4fc4\u8bed\uff0c\u5efa\u8bae\u4f7f\u7528utf8_unicode_ci\u3002</p> <p>\u5982\u679c\u67d0\u4e2a\u8868\u6216\u5217\u5b57\u6bb5\u8981\u6c42\u533a\u5206\u5927\u5c0f\u5199\uff0c\u53ef\u4ee5\u5355\u72ec\u6307\u5b9a\u8be5\u8868\u6216\u5b57\u6bb5\u4f7f\u7528utf8_bin\u6bd4\u8f83\u89c4\u5219\u3002</p> <p>https://cloud.tencent.com/developer/article/1630141</p>"},{"location":"basic/8.MySQL%E5%AD%97%E7%AC%A6%E9%9B%86%E5%92%8C%E6%8E%92%E5%BA%8F%E8%A7%84%E5%88%99/#padding","title":"\u5b57\u7b26padding","text":"<p>\u6392\u5e8f\u89c4\u5219\u4e2d\uff0c\u6709\u4e2a\u586b\u5145\u5c5e\u6027\u3002</p>"},{"location":"basic/8.MySQL%E5%AD%97%E7%AC%A6%E9%9B%86%E5%92%8C%E6%8E%92%E5%BA%8F%E8%A7%84%E5%88%99/#_9","title":"\u8ba1\u7b97\u4e2d\u7684\u5e38\u89c1\u4e2d\u6587\u5b57\u7b26\u96c6","text":""},{"location":"basic/8.MySQL%E5%AD%97%E7%AC%A6%E9%9B%86%E5%92%8C%E6%8E%92%E5%BA%8F%E8%A7%84%E5%88%99/#gb2312-80","title":"GB2312-80 \u5b57\u7b26\u96c6","text":"<p><code>GB/T 2312</code> \u6216 <code>GB 2312-80</code> \u662f \u4e2d\u56fd\u56fd\u5bb6\u6807\u51c6\u7b80\u4f53\u4e2d\u6587\u5b57\u7b26\u96c6 \uff0c\u5168\u79f0\u300a\u4fe1\u606f\u4ea4\u6362\u7528\u6c49\u5b57\u7f16\u7801\u5b57\u7b26\u96c6\u00b7\u57fa\u672c\u96c6\u300b\uff0c\u53c8\u79f0 GB0\uff0c\u7531\u4e2d\u56fd\u56fd\u5bb6\u6807\u51c6\u603b\u5c40\u53d1\u5e03\uff0c\u4e8e 1981 \u5e74 5 \u6708 1 \u65e5\u5b9e\u65bd\u3002</p> <p><code>GB/T 2312</code> \u7f16\u7801\u901a\u884c\u4e8e\u4e2d\u56fd\u5927\u9646\uff1b\u65b0\u52a0\u5761\u7b49\u5730\u4e5f\u91c7\u7528\u6b64\u7f16\u7801\u3002\u4e2d\u56fd\u5927\u9646\u51e0\u4e4e\u6240\u6709\u7684\u4e2d\u6587\u7cfb\u7edf\u548c\u56fd\u9645\u5316\u7684\u8f6f\u4ef6\u90fd\u652f\u6301 <code>GB 2312</code>\u3002</p> <p><code>GB/T 2312</code> \u6807\u51c6\u5171\u6536\u5f55 6763 \u4e2a\u6c49\u5b57\uff0c\u5176\u4e2d\u4e00\u7ea7\u6c49\u5b57 3755 \u4e2a\uff0c\u4e8c\u7ea7\u6c49\u5b57 3008 \u4e2a\uff1b\u540c\u65f6\u6536\u5f55\u4e86\u5305\u62ec\u62c9\u4e01\u5b57\u6bcd\u3001\u5e0c\u814a\u5b57\u6bcd\u3001\u65e5\u6587\u5e73\u5047\u540d\u53ca\u7247\u5047\u540d\u5b57\u6bcd\u3001\u4fc4\u8bed\u897f\u91cc\u5c14\u5b57\u6bcd\u5728\u5185\u7684 682 \u4e2a\u5b57\u7b26\u3002</p> <p><code>GB/T 2312</code> \u7684\u51fa\u73b0\uff0c\u57fa\u672c\u6ee1\u8db3\u4e86\u6c49\u5b57\u7684\u8ba1\u7b97\u673a\u5904\u7406\u9700\u8981\uff0c\u5b83\u6240\u6536\u5f55\u7684\u6c49\u5b57\u5df2\u7ecf\u8986\u76d6\u4e2d\u56fd\u5927\u964699.75% \u7684\u4f7f\u7528\u9891\u7387\u3002\u5bf9\u4e8e\u4eba\u540d\u3001\u53e4\u6c49\u8bed\u7b49\u751f\u50fb\u5b57\uff0cGB 2312 \u4e0d\u80fd\u5904\u7406\uff0c\u8fd9\u5bfc\u81f4\u4e86\u540e\u6765 GBK \u53ca GB 18030 \u6c49\u5b57\u5b57\u7b26\u96c6\u7684\u51fa\u73b0\u3002</p> <p>GB/T 2312 \u5bf9\u4efb\u610f\u4e00\u4e2a\u56fe\u5f62\u5b57\u7b26\u90fd\u91c7\u7528\u4e24\u4e2a\u5b57\u8282\u8868\u793a\uff0c\u5e76\u5bf9\u6240\u6536\u6c49\u5b57\u8fdb\u884c\u4e86\"\u5206\u533a\"\u5904\u7406\uff0c\u6bcf\u533a\u542b\u6709 94 \u4e2a\u6c49\u5b57\uff0f\u7b26\u53f7\uff0c\u5206\u522b\u5bf9\u5e94\u7b2c\u4e00\u5b57\u8282\u548c\u7b2c\u4e8c\u5b57\u8282\u3002\u8fd9\u79cd\u8868\u793a\u65b9\u5f0f\u4e5f\u79f0\u4e3a**\u533a\u4f4d\u7801**\u3002</p> <ul> <li>01-09 \u533a\u4e3a\u7279\u6b8a\u7b26\u53f7\u3002</li> <li>16-55 \u533a\u4e3a\u4e00\u7ea7\u6c49\u5b57\uff0c\u6309\u62fc\u97f3\u6392\u5e8f\u3002</li> <li>56-87 \u533a\u4e3a\u4e8c\u7ea7\u6c49\u5b57\uff0c\u6309\u90e8\u9996\uff0f\u7b14\u753b\u6392\u5e8f\u3002</li> <li>10-15 \u533a\u53ca 88-94 \u533a\u5219\u672a\u6709\u7f16\u7801\u3002</li> </ul> <p>GB/T 2312 \u7684\u7f16\u7801\u8303\u56f4\u4e3a 2121H-777EH\uff0c\u4e0e ASCII \u6709\u91cd\u53e0\uff0c\u901a\u884c\u65b9\u6cd5\u662f\u5c06 GB \u7801\u4e24\u4e2a\u5b57\u8282\u7684\u6700\u9ad8\u4f4d\u7f6e 1 \u4ee5\u793a\u533a\u522b\u3002</p>"},{"location":"basic/8.MySQL%E5%AD%97%E7%AC%A6%E9%9B%86%E5%92%8C%E6%8E%92%E5%BA%8F%E8%A7%84%E5%88%99/#gbk","title":"GBK\u5b57\u7b26\u96c6","text":"<p>GBK \u5373\u6c49\u5b57\u5185\u7801\u6269\u5c55\u89c4\u8303\uff0cK \u4e3a\u6c49\u8bed\u62fc\u97f3 Kuo Zhan\uff08\u6269\u5c55\uff09\u4e2d\u201c\u6269\u201d\u5b57\u7684\u58f0\u6bcd\u3002\u82f1\u6587\u5168\u79f0 Chinese Internal Code Specification\u3002<code>GBK</code>\u5171\u6536\u5165 21886 \u4e2a\u6c49\u5b57\u548c\u56fe\u5f62\u7b26\u53f7\uff0c\u5305\u62ec\uff1a</p> <ul> <li>GB 2312 \u4e2d\u7684\u5168\u90e8\u6c49\u5b57\u3001\u975e\u6c49\u5b57\u7b26\u53f7\u3002</li> <li>BIG5 \u4e2d\u7684\u5168\u90e8\u6c49\u5b57\u3002</li> <li>\u4e0e ISO 10646 \u76f8\u5e94\u7684\u56fd\u5bb6\u6807\u51c6 GB 13000 \u4e2d\u7684\u5176\u5b83 CJK \u6c49\u5b57\uff0c\u4ee5\u4e0a\u5408\u8ba1 20902 \u4e2a\u6c49\u5b57\u3002</li> <li>\u5176\u5b83\u6c49\u5b57\u3001\u90e8\u9996\u3001\u7b26\u53f7\uff0c\u5171\u8ba1 984 \u4e2a\u3002</li> </ul> <p>GBK \u5411\u4e0b\u4e0e GB 2312 \u5b8c\u5168\u517c\u5bb9\uff0c\u5411\u4e0a\u652f\u6301 ISO 10646 \u56fd\u9645\u6807\u51c6\uff0c\u5728\u524d\u8005\u5411\u540e\u8005\u8fc7\u6e21\u8fc7\u7a0b\u4e2d\u8d77\u5230\u7684\u627f\u4e0a\u542f\u4e0b\u7684\u4f5c\u7528\u3002</p> <p>GBK \u91c7\u7528\u53cc\u5b57\u8282\u8868\u793a\uff0c\u603b\u4f53\u7f16\u7801\u8303\u56f4\u4e3a 8140-FEFE \u4e4b\u95f4\uff0c\u9996\u5b57\u8282\u5728 81-FE \u4e4b\u95f4\uff0c\u5c3e\u5b57\u8282\u5728 40-FE \u4e4b\u95f4\uff0c\u5254\u9664 XX7F \u4e00\u6761\u7ebf\u3002GBK \u7f16\u7801\u533a\u5206\u4e09\u90e8\u5206\uff1a \u6c49\u5b57\u533a\u3000\u5305\u62ec - GBK/2\uff1a0XBOA1-F7FE, \u6536\u5f55 GB 2312 \u6c49\u5b57 6763 \u4e2a\uff0c\u6309\u539f\u5e8f\u6392\u5217\uff1b GBK/3\uff1a0X8140-AOFE\uff0c\u6536\u5f55 CJK \u6c49\u5b57 6080 \u4e2a\uff1b GBK/4\uff1a0XAA40-FEAO\uff0c\u6536\u5f55 CJK \u6c49\u5b57\u548c\u589e\u8865\u7684\u6c49\u5b57 8160 \u4e2a\u3002 \u56fe\u5f62\u7b26\u53f7\u533a\u3000\u5305\u62ec GBK/1\uff1a0XA1A1-A9FE\uff0c\u9664 GB 2312 \u7684\u7b26\u53f7\u5916\uff0c\u8fd8\u589e\u8865\u4e86\u5176\u5b83\u7b26\u53f7 GBK/5\uff1a0XA840-A9AO\uff0c\u6269\u9664\u975e\u6c49\u5b57\u533a\u3002 \u7528\u6237\u81ea\u5b9a\u4e49\u533a GBK \u533a\u57df\u4e2d\u7684\u7a7a\u767d\u533a\uff0c\u7528\u6237\u53ef\u4ee5\u81ea\u5df1\u5b9a\u4e49\u5b57\u7b26\u3002</p>"},{"location":"basic/8.MySQL%E5%AD%97%E7%AC%A6%E9%9B%86%E5%92%8C%E6%8E%92%E5%BA%8F%E8%A7%84%E5%88%99/#gb18030","title":"GB18030\u5b57\u7b26\u96c6","text":"<p><code>GB 18030</code> \u662f\u4e2d\u56fd\u653f\u5e9c\u89c4\u5b9a\u7684\u4e2d\u6587\u6587\u5b57\u96c6\u548c\u7f16\u7801\u6807\u51c6\u3002\u66f4\u65b0 2022 \u652f\u6301\u6269\u5c55\u5b57\u7b26\uff0c\u81ea 2023 \u5e74 8 \u6708 1 \u65e5\u8d77\u751f\u6548\u3002</p> <p><code>GB18030</code>\u7f16\u7801\u91c7\u7528\u5355\u5b57\u8282\u3001\u53cc\u5b57\u8282\u3001\u56db\u5b57\u8282\u5206\u6bb5\u7f16\u7801\u65b9\u6848\uff0c\u5177\u4f53\u7801\u4f4d\u89c1\u4e0b\u6587\u3002GB18030\u5411\u4e0b\u517c\u5bb9GBK\u548cGB2312\u7f16\u7801\u3002</p> <p>\u56fd\u5bb6\u6807\u51c6<code>GB18030-2005</code>\u300a\u4fe1\u606f\u6280\u672f \u4e2d\u6587\u7f16\u7801\u5b57\u7b26\u96c6\u300b\u662f\u6211\u56fd\u7ee7<code>GB2312-1980</code>\u548c<code>GB13000-1993</code>\u4e4b\u540e\u6700\u91cd\u8981\u7684\u6c49\u5b57\u7f16\u7801\u6807\u51c6\uff0c\u662f\u6211\u56fd\u8ba1\u7b97\u673a\u7cfb\u7edf\u5fc5\u987b\u9075\u5faa\u7684\u57fa\u7840\u6027\u6807\u51c6\u4e4b\u4e00\u3002</p> <p><code>GB18030</code>\u6709\u4e24\u4e2a\u7248\u672c\uff1a<code>GB18030-2000</code>\u548c<code>GB18030-2005</code>\u3002</p> <ul> <li> <p><code>GB18030-2000</code>\u662fGBK\u7684\u53d6\u4ee3\u7248\u672c\uff0c\u5b83\u7684\u4e3b\u8981\u7279\u70b9\u662f\u5728GBK\u57fa\u7840\u4e0a\u589e\u52a0\u4e86CJK\u7edf\u4e00\u6c49\u5b57\u6269\u5145A\u7684\u6c49\u5b57\u3002</p> </li> <li> <p><code>GB18030-2005</code>\u7684\u4e3b\u8981\u7279\u70b9\u662f\u5728<code>GB18030-2000</code>\u57fa\u7840\u4e0a\u589e\u52a0\u4e86CJK\u7edf\u4e00\u6c49\u5b57\u6269\u5145B\u7684\u6c49\u5b57\u3002</p> </li> <li> <p><code>GB18030-2022</code>\u300a\u4fe1\u606f\u6280\u672f-\u4e2d\u6587\u7f16\u7801\u5b57\u7b26\u96c6\u300b\u662f\u5f53\u524d\u6700\u65b0\u7248\u672c\uff0c\u4e3a\u56fd\u5bb6\u5e02\u573a\u76d1\u7763\u7ba1\u7406\u603b\u5c40\u548c\u56fd\u5bb6\u6807\u51c6\u5316\u7ba1\u7406\u59d4\u5458\u4f1a\u4e8e2022\u5e747\u670819\u65e5\u53d1\u5e03\u30012023\u5e748\u67081\u65e5\u5b9e\u65bd\u3002</p> <p>\u6b64\u7248\u672c\u5728\u4fdd\u7559\u603b\u4f53\u7ed3\u6784\u7684\u57fa\u7840\u4e0a\uff0c\u4ece\u6761\u6587\u5f3a\u5236\u6539\u4e3a\u5168\u6587\u5f3a\u5236\uff0c\u4f46\u589e\u52a0\u4e86\u300c\u5b9e\u73b0\u7684\u7ea7\u522b\u300d\u4e00\u7ae0\uff0c\u5b9a\u4e49\u4e86\u4e09\u4e2a\u5b9e\u73b0\u7ea7\u522b\uff0c\u5e76\u8981\u6c42\u300c\u4efb\u4f55\u672c\u6587\u4ef6\u4f7f\u7528\u7684\u4ea7\u54c1\u5747\u5e94\u6ee1\u8db3\u5b9e\u73b0\u7ea7\u522b1\u300d\uff0c\u4e0e\u4e0a\u4e00\u7248\u7684\u300c\u90e8\u5206\u5f3a\u5236\u300d\u76f8\u6bd4\uff0c\u5b9e\u9645\u8981\u6c42\u300c\u589e\u52a0\u56db\u5b57\u8282\u7f16\u7801\u90e8\u5206\u7684CJK\u7edf\u4e00\u6c49\u5b57\u300d\u7684 66 \u5b57\u3002\u53e6\u5916\uff0c\u8be5\u7248\u672c\u5b8c\u6574\u8986\u76d6 2013 \u5e74\u53d1\u5e03\u7684\u300a\u901a\u7528\u89c4\u8303\u6c49\u5b57\u8868\u300b\uff0c\u5728\u8d44\u6599\u6027\u9644\u5f55E\u4e2d\u660e\u786e\u4e86\u300a\u901a\u7528\u89c4\u8303\u6c49\u5b57\u8868\u300b8105 \u4e2a\u6c49\u5b57\u7684\u4ee3\u7801\u4f4d\u7f6e\uff0c\u5e76\u89c4\u5b9a\u8981\u901a\u8fc7\u300c\u5b9e\u73b0\u7ea7\u522b2\u300d\u6765\u652f\u6301\u3002</p> </li> </ul> <p>\u76f8\u5bf9\u4e8e GB18030-2005 \u7248\u672c\uff0c\u5b83\u505a\u4e86\u8f83\u591a\u7684\u4fee\u6539\uff0c\u6700\u5178\u578b\u7684\u662f\u53c8\u589e\u52a0\u4e86\u4e0d\u5c11\u6c49\u5b57\u3002</p> <ul> <li> <p>\u603b\u6570\u4ece 70195 \u589e\u52a0\u5230\u4e86 87887 \u4e2a\uff0c\u5e76\u4e14\u7ec8\u4e8e\u8986\u76d6\u4e86\u300a\u901a\u7528\u89c4\u8303\u6c49\u5b57\u8868\u300b \u7684\u5168\u90e8\u6c49\u5b57\u3002</p> </li> <li> <p>\u5c11\u6570\u6c11\u65cf\u6587\u79cd\u4ece 6 \u79cd\u589e\u52a0\u5230\u4e86 10 \u79cd</p> </li> <li> <p>\u6807\u51c6\u4e5f\u4ece\u90e8\u5206\u5f3a\u5236\u53d8\u6210\u4e86\u5168\u6587\u5f3a\u5236</p> </li> <li> <p>\u6709\u4e09\u79cd\u5b9e\u73b0\u7ea7\u522b\u7684\u8981\u6c42\uff1a</p> <ul> <li> <p>\u5bf9\u4e8e\u6240\u6709\u5177\u5907\u4e2d\u6587\u4fe1\u606f\u5904\u7406\u80fd\u529b\u7684\u4ea7\u54c1\u90fd\u5f97\u652f\u6301\u7ea7\u522b\u4e00\uff0c\u5305\u542b 27584 \u4e2a\u6c49\u5b57</p> </li> <li> <p>\u64cd\u4f5c\u7cfb\u7edf\u3001 \u6570\u636e\u5e93\u3001\u4e2d\u95f4\u4ef6\u7b49\u57fa\u7840\u8f6f\u4ef6\u7684\uff0c\u81f3\u5c11\u8981\u652f\u6301\u5230\u7ea7\u522b\u4e8c\uff0c\u6bd4\u7ea7\u522b\u4e00\u589e\u52a0\u4e86\u300a\u901a\u7528\u89c4\u8303\u6c49\u5b57\u8868\u300b\u4e2d\u7684 196 \u4e2a\u6c49\u5b57</p> </li> <li> <p>GB/T 4754 \u300a\u56fd\u6c11\u7ecf\u6d4e\u884c\u4e1a\u5206\u7c7b\u300b\u4e2d\u6240\u6709\u884c\u4e1a\u9886\u57df\u7528\u4e8e\u653f\u52a1\u670d\u52a1\u548c\u516c\u5171\u670d\u52a1\u7684\u4fe1\u606f\u6280\u672f\u4ea7\u54c1\u548c\u4fe1\u606f\u5316\u7cfb\u7edf\u5168\u9762\u5f3a\u5236\u6267\u884c\u5b9e\u73b0\u7ea7\u522b\u4e09\uff0c\u5305\u542b\u672c\u6807\u51c6\u5185\u5168\u90e887887\u4e2a\u6c49\u5b57\u3002</p> </li> </ul> </li> </ul> <p>GB18030-2022 \u65b0\u6807\u51c6\u652f\u6301\u7684\u6c49\u5b57\u6709\u5f88\u591a\uff0c\u5982\uff1a</p> <pre><code>0x82359334  U+9FCF \u9fcf\n0x82359339  U+9FD4 \u9fd4 \uff08\u6211\u7684\u65e7\u7535\u8111\u8fd8\u662f\u663e\u793a\u4e0d\u51fa\u6765\uff09\n</code></pre>"},{"location":"basic/8.MySQL%E5%AD%97%E7%AC%A6%E9%9B%86%E5%92%8C%E6%8E%92%E5%BA%8F%E8%A7%84%E5%88%99/#_10","title":"\u5168\u89d2\u534a\u89d2","text":"<p>\u5168\u89d2\u7b26\u53f7\u662f\u53cc\u5b57\u8282\u4e2d\u6587\u7f16\u7801\u7684\u5386\u53f2\u9057\u7559\u95ee\u9898\u3002\u5f53\u5e74\u5728\u7eaf\u6587\u672c\u7684\u754c\u9762\u4e2d\uff0c\u4e3a\u4e86\u8ba9\u897f\u6587\u548c\u4e2d\u65e5\u97e9\u7684\u65b9\u5757\u5b57\u5bf9\u9f50\uff0c\u5c31\u8ba9\u897f\u6587\u5b57\u6bcd\u3001\u6570\u5b57\u548c\u6807\u70b9\u4e5f\u5360\u7528\u4e00\u4e2a\u6c49\u5b57\u7684\u89c6\u89c9\u7a7a\u95f4\uff0c\u5e76\u4f7f\u7528 2 \u4e2a\u5b57\u8282\u5b58\u50a8\u3002\u540e\u6765\uff0c\u5176\u4e2d\u7684\u4e00\u4e9b\u5168\u89d2\u5b57\u7b26\u56e0\u4e3a\u6bd4\u8f83\u6709\u7528\uff0c\u5c31\u5f97\u5230\u4e86\u5e7f\u6cdb\u5e94\u7528\uff08\u6bd4\u5982\u5168\u89d2\u7684\u9017\u53f7\u300c\uff0c\u300d\u3001\u95ee\u53f7\u300c\uff1f\u300d\u3001\u611f\u53f9\u53f7\u300c\uff01\u300d\u3001\u7a7a\u683c\u300c\u3000\u300d\u7b49\uff09\uff0c\u4e13\u7528\u4e8e\u4e2d\u65e5\u97e9\u6587\u672c\uff0c\u6210\u4e3a\u4e86\u6807\u51c6\u7684\u4e2d\u65e5\u97e9\u6807\u70b9\u5b57\u7b26\u3002\u800c\u5176\u5b83\u7684\u8bb8\u591a\u5168\u89d2\u7b26\u53f7\u5931\u53bb\u4e86\u4ef7\u503c\uff0c\u56e0\u4e3a\u6211\u4eec\u73b0\u5728\u5f88\u5c11\u9700\u8981\u8ba9\u7eaf\u6587\u672c\u7684\u4e2d\u6587\u548c\u897f\u6587\u5b57\u5b57\u5bf9\u9f50\u4e86\uff0c\u5c31\u5f88\u5c11\u518d\u7528\u4e86\u3002</p> <p>\u53e6\u5916\u9700\u8981\u8bf4\u660e\u7684\u662f\uff1a\u73b0\u5728\u5168\u7403\u6587\u672c\u7f16\u7801\u7684\u4e8b\u5b9e\u6807\u51c6\u662f UTF-8 \u7b49\u57fa\u4e8e Unicode \u5b57\u7b26\u96c6\u7684\u7f16\u7801\u683c\u5f0f\u3002Unicode \u5438\u7eb3\u4e86\u8bb8\u591a\u9057\u7559\u5b57\u7b26\uff0c\u5e76\u4e14\u4e3a\u4e86\u517c\u5bb9\u6027\u800c\u4fdd\u7559\u4e86\u6240\u6709\u5b57\u7b26\u3002\u6240\u4ee5\u8fd9\u4e9b\u6ca1\u4ec0\u4e48\u7528\u7684\u5168\u89d2\u5b57\u7b26\u4e5f\u7559\u4e0b\u6765\u4e86\u3002\u800c\u56fd\u5bb6\u6807\u51c6\u4e5f\u4ecd\u5728\u8981\u6c42\u5b57\u4f53\u548c\u8f6f\u4ef6\u652f\u6301\u8fd9\u4e9b\u5168\u89d2\u5b57\u7b26\u3002</p> <p>\u7b2c\u4e00\u70b9\u5927\u591a\u6570\u670b\u53cb\u90fd\u660e\u767d\uff0c\u4e5f\u6700\u76f4\u63a5\uff0c\u90a3\u5c31\u662f\u4f7f\u7528\u5168\u89d2\u548c\u534a\u89d2\u6253\u51fa\u7684\u5b57\u7684\u5f62\u72b6\u662f\u4e0d\u4e00\u6837\u7684\u3002</p> <p>\u7b2c\u4e8c\u70b9\u662f\u5b57\u7b26\u5b58\u50a8\u4e0a\u7684\u533a\u522b\uff0c\u5728\u5168\u89d2\u72b6\u6001\u4e0b\uff0c\u6211\u4eec\u8f93\u5165\u4e00\u4e2a\u5b57\u6bcd\u6240\u5360\u7684\u5b57\u7b26\u662f\u4e24\u4e2a\uff1b\u800c\u5728\u534a\u89d2\u72b6\u6001\u4e0b\uff0c\u6211\u4eec\u8f93\u5165\u4e00\u4e2a\u5b57\u6bcd\u6240\u5360\u7684\u5b57\u7b26\u53ea\u6709\u4e00\u4e2a\u3002\u8f93\u5165\u6c49\u5b57\u4e24\u8005\u6240\u5360\u7684\u5b57\u7b26\u90fd\u662f\u4e24\u4e2a\u3002</p> <pre><code>\u534a\u89d2\u8f93\u5165\uff1a\u81ea\u7531 \u4e4b\u8def ddd\n\u5168\u89d2\u8f93\u5165\uff1a\u81ea\u7531\u3000\u4e4b\u8def\uff44\uff44\uff44\n</code></pre> <p>\u4e0a\u9762\u7ed9\u51fa\u4e86\u4e00\u4e2a\u5217\u5b50\uff0c\u6211\u4eec\u660e\u663e\u53ef\u4ee5\u770b\u51fa\u5728\u5168\u89d2\u548c\u534a\u89d2\u6a21\u5f0f\u4e0b\uff0c\u5b57\u6bcd\u548c\u7a7a\u683c\u7b49\u897f\u6587\u5b57\u7b26\u4e4b\u95f4\u7684\u533a\u522b\uff0c\u800c\u4e2d\u6587\u5b57\u7b26\u5219\u6ca1\u533a\u522b\u3002</p> <p>\u5176\u5b9e\u6709\u4e9b\u5b57\u7b26\u7f16\u7801\u76f8\u5173\u77e5\u8bc6\u7684\u540c\u5b66\u53ef\u4ee5\u5f88\u6e05\u695a\u7684\u770b\u51fa\uff1a\u5168\u89d2\u5b57\u7b26\u548c\u534a\u89d2\u5b57\u7b26\u5728\u5b57\u7b26\u96c6\u4e2d\u5c31\u662f\u4e24\u4e2a\u7801\u70b9\u4e0d\u540c\u7684\u5b57\u7b26\uff0c\u4ed6\u4eec\u8868\u793a\u7684\u542b\u4e49\u76f8\u540c\uff0c\u4f46\u662f\u5c55\u793a\u7684\u6548\u679c\u6709\u5dee\u5f02\u3002\u8fd9\u4e2a\u5dee\u5f02\u8981\u4e48\u4f53\u73b0\u5728\u5f62\u72b6\u4e0a\uff0c\u8981\u4e48\u4f53\u73b0\u5728\u5b57\u7b26\u5bbd\u5ea6\u4e0a\u3002</p> <p>https://www.zhihu.com/question/19605819/answer/12355856</p> <p>\u5168\u89d2\u5b57\u7b26\u548c\u534a\u89d2\u5b57\u7b26\u7684\u533a\u522b\u4e3b\u8981\u4f53\u73b0\u5728\u4ee5\u4e0b\u51e0\u4e2a\u65b9\u9762\uff1a</p> <ul> <li>\u5bbd\u5ea6\uff1a\u5168\u89d2\u5b57\u7b26\u7684\u5bbd\u5ea6\u662f\u534a\u89d2\u5b57\u7b26\u7684\u4e24\u500d\u3002</li> <li>\u7f16\u7801\uff1a\u5168\u89d2\u5b57\u7b26\u4f7f\u7528\u4e24\u5b57\u8282\u7f16\u7801\uff0c\u800c\u534a\u89d2\u5b57\u7b26\u4f7f\u7528\u4e00\u5b57\u8282\u7f16\u7801\u3002</li> <li>\u5e94\u7528\uff1a\u5168\u89d2\u5b57\u7b26\u901a\u5e38\u7528\u4e8e\u8868\u793a\u6c49\u5b57\u3001\u65e5\u6587\u5047\u540d\u3001\u97e9\u6587\u8c1a\u6587\uff0c\u4ee5\u53ca\u4e00\u4e9b\u7279\u6b8a\u7b26\u53f7\uff0c\u800c\u534a\u89d2\u5b57\u7b26\u901a\u5e38\u7528\u4e8e\u8868\u793a\u82f1\u6587\u5b57\u6bcd\u3001\u6570\u5b57\u3001\u4ee5\u53ca\u4e00\u4e9b\u7279\u6b8a\u7b26\u53f7\u3002</li> </ul> <p>\u5168\u89d2\u5b57\u7b26\u548c\u534a\u89d2\u5b57\u7b26\u5728\u4e0d\u540c\u7684\u573a\u5408\u6709\u4e0d\u540c\u7684\u4f7f\u7528\u8981\u6c42\u3002\u4f8b\u5982\uff0c\u5728\u4e2d\u6587\u8f93\u5165\u6cd5\u4e2d\uff0c\u901a\u5e38\u4f7f\u7528\u5168\u89d2\u5b57\u7b26\u6765\u8f93\u5165\u6c49\u5b57\uff0c\u800c\u4f7f\u7528\u534a\u89d2\u5b57\u7b26\u6765\u8f93\u5165\u82f1\u6587\u5b57\u6bcd\u548c\u6570\u5b57\u3002\u5728\u4e00\u4e9b\u7f16\u7a0b\u8bed\u8a00\u4e2d\uff0c\u5168\u89d2\u5b57\u7b26\u548c\u534a\u89d2\u5b57\u7b26\u4e5f\u6709\u4e0d\u540c\u7684\u542b\u4e49\u3002</p>"},{"location":"basic/8.MySQL%E5%AD%97%E7%AC%A6%E9%9B%86%E5%92%8C%E6%8E%92%E5%BA%8F%E8%A7%84%E5%88%99/#base64","title":"base64\u7f16\u7801","text":"<p>Base64 \u662f\u4e00\u79cd\u7f16\u7801\u65b9\u5f0f\uff0c\u6700\u65e9\u51fa\u73b0\u5728\u7535\u5b50\u90ae\u4ef6\u4f20\u8f93\u534f\u8bae\u4e2d\u3002\u7535\u5b50\u90ae\u4ef6\u95ee\u4e16\u4e4b\u521d\uff0c\u4f20\u9012\u6d88\u606f\u65f6\u53ea\u652f\u6301 ASCII \u5b57\u7b26\uff0c\u540e\u6765\u968f\u7740\u7535\u5b50\u90ae\u4ef6\u7684\u5e7f\u6cdb\u4f7f\u7528\uff0c\u4f20\u9012\u975eASCII\u5b57\u7b26\u5185\u5bb9\u7684\u9700\u6c42\u589e\u52a0\uff0c\u4f8b\u5982\uff1a\u4f20\u8f93\u4e2d\u6587\u3001\u4f20\u8f93\u6587\u4ef6\uff08\u56fe\u7247\u3001\u89c6\u9891\uff09\u3002</p> <p>\u4e3a\u89e3\u51b3\u8fd9\u4e00\u95ee\u9898\uff0c\u6700\u597d\u7684\u65b9\u6848\u662f\u5728\u4e0d\u6539\u53d8\u4f20\u8f93\u534f\u8bae\u7684\u57fa\u7840\u4e0a\uff0c\u505a\u4e00\u79cd\u6269\u5c55\u65b9\u6848\u6765\u652f\u6301\u975eASCII\u5185\u5bb9\u4f20\u8f93\uff0c\u628a\u975e ASCII \u5b57\u7b26\u7528ASCII\u6765\u8868\u793a\uff0cBase64\u7f16\u7801\u5e94\u8fd0\u800c\u751f\u3002</p> <p>Base64\u7684\u7f16\u7801\u539f\u7406</p> <p>Base64\u7684\u539f\u7406\u6bd4\u8f83\u7b80\u5355\uff0c\u6bcf\u5f53\u6211\u4eec\u4f7f\u7528Base64\u65f6\u90fd\u4f1a\u5148\u5b9a\u4e49\u4e00\u4e2a\u7c7b\u4f3c\u8fd9\u6837\u7684\u6570\u7ec4\uff1a</p> <pre><code>['A', 'B', 'C', ... 'a', 'b', 'c', ... '0', '1', ... '+', '/']\n</code></pre> <p>\u4e0a\u9762\u5c31\u662fBase64\u7684\u7d22\u5f15\u8868\uff0c\u5b57\u7b26\u9009\u7528\u4e86\"A-Z\u3001a-z\u30010-9\u3001+\u3001/\" \u4e00\u517164\u4e2a\u53ef\u6253\u5370\u5b57\u7b26\uff0c\u8fd9\u662f\u6807\u51c6\u7684Base64\u534f\u8bae\u89c4\u5b9a\u3002</p> <p>\u5728\u65e5\u5e38\u4f7f\u7528\u4e2d\u6211\u4eec\u8fd8\u4f1a\u770b\u5230\"=\"\u6216\"==\"\u53f7\u51fa\u73b0\u5728Base64\u7684\u7f16\u7801\u7ed3\u679c\u4e2d\uff0c\"=\"\u5728\u6b64\u662f\u4f5c\u4e3a\u586b\u5145\u5b57\u7b26\u51fa\u73b0\uff0c\u540e\u9762\u4f1a\u8bb2\u5230\u3002</p> <p>Base64\u7f16\u7801\u7684\u76ee\u6807\u662f\u5c06\u4efb\u4f55\u4e8c\u8fdb\u5236\u6570\u636e\u7f16\u7801\u4e3a\u7eaf\u6587\u672c\uff0c\u5176\u57fa\u672c\u539f\u7406\u662f\u5c06\u4e09\u4e2a\u5b57\u8282\u7684\u4e8c\u8fdb\u5236\u6570\u636e\u7f16\u7801\u4e3a\u56db\u4e2a\u5b57\u7b26\u3002</p>"},{"location":"basic/9.mysql_architecture/","title":"9. MySQL\u903b\u8f91\u67b6\u6784\u548c\u6027\u80fd\u4f18\u5316\u6982\u8ff0","text":""},{"location":"basic/9.mysql_architecture/#mysql","title":"MySQL \u903b\u8f91\u67b6\u6784","text":"<p>MySQL \u903b\u8f91\u67b6\u6784\u6574\u4f53\u5206\u4e3a\u4e09\u5c42\uff1a</p> <ul> <li>\u8fde\u63a5\u5c42\uff1a\u6700\u4e0a\u5c42\u4e3a\u5ba2\u6237\u7aef\u5c42\uff0c\u5e76\u975e MySQL \u6240\u72ec\u6709\uff0c\u8bf8\u5982\uff1a\u8fde\u63a5\u5904\u7406\u3001\u6388\u6743\u8ba4\u8bc1\u3001\u5b89\u5168\u7b49\u529f\u80fd\u5747\u5728\u8fd9\u4e00\u5c42\u5904\u7406\u3002</li> <li>\u4e2d\u95f4\u5c42\uff1aMySQL \u5927\u591a\u6570\u6838\u5fc3\u670d\u52a1\u5747\u5728\u4e2d\u95f4\u8fd9\u4e00\u5c42\uff0c\u5305\u62ec\u67e5\u8be2\u89e3\u6790\u3001\u5206\u6790\u3001\u4f18\u5316\u3001\u7f13\u5b58\u3001\u5185\u7f6e\u51fd\u6570(\u6bd4\u5982\uff1a\u65f6\u95f4\u3001\u6570\u5b66\u3001\u52a0\u5bc6\u7b49\u51fd\u6570)\u3002\u6240\u6709\u7684\u8de8\u5b58\u50a8\u5f15\u64ce\u7684\u529f\u80fd\u4e5f\u5728\u8fd9\u4e00\u5c42\u5b9e\u73b0\uff1a\u5b58\u50a8\u8fc7\u7a0b\u3001\u89e6\u53d1\u5668\u3001\u89c6\u56fe\u7b49\u3002</li> <li>\u5b58\u50a8\u5f15\u64ce\u5c42\uff1a\u6700\u4e0b\u5c42\u4e3a\u5b58\u50a8\u5f15\u64ce\uff0c\u5176\u8d1f\u8d23 MySQL \u4e2d\u7684\u6570\u636e\u5b58\u50a8\u548c\u63d0\u53d6\u3002\u548c Linux \u4e2d\u7684\u6587\u4ef6\u7cfb\u7edf\u7c7b\u4f3c\uff0c\u6bcf\u79cd\u5b58\u50a8\u5f15\u64ce\u90fd\u6709\u5176\u4f18\u52bf\u548c\u52a3\u52bf\u3002\u4e2d\u95f4\u7684\u670d\u52a1\u5c42\u901a\u8fc7 API \u4e0e\u5b58\u50a8\u5f15\u64ce\u901a\u4fe1\uff0c\u8fd9\u4e9b API \u63a5\u53e3\u5c4f\u853d\u4e86\u4e0d\u540c\u5b58\u50a8\u5f15\u64ce\u95f4\u7684\u5dee\u5f02\u3002</li> </ul> <p>MySQL Server \u662f\u4e00\u4e2a\u5355\u8fdb\u7a0b\u591a\u7ebf\u7a0b\u7684\u670d\u52a1\u7a0b\u5e8f\uff0c\u5728 MySQL Server \u4e0a \u7528 ps -ef | grep mysqld \u5c31\u80fd\u770b\u5230\u5176\u7cfb\u7edf\u8fdb\u7a0b ID \u4e86\u3002</p> <p>MySQL \u8bf7\u6c42\u5904\u7406\u6d41\u7a0b</p> <ol> <li>\u5ba2\u6237\u7aef\u5411 MySQL \u670d\u52a1\u5668\u53d1\u9001\u4e00\u6761\u67e5\u8be2\u8bf7\u6c42\u3002</li> <li>\u670d\u52a1\u5668\u9996\u5148\u68c0\u67e5\u67e5\u8be2\u7f13\u5b58\uff0c\u5982\u679c\u547d\u4e2d\u7f13\u5b58\uff0c\u5219\u7acb\u523b\u8fd4\u56de\u5b58\u50a8\u5728\u7f13\u5b58\u4e2d\u7684\u7ed3\u679c\u3002\u5426\u5219\u8fdb\u5165\u4e0b\u4e00\u9636\u6bb5\u3002</li> <li>\u670d\u52a1\u5668\u8fdb\u884c SQL \u89e3\u6790\u3001\u9884\u5904\u7406\u3001\u518d\u7531\u4f18\u5316\u5668\u751f\u6210\u5bf9\u5e94\u7684\u6267\u884c\u8ba1\u5212\u3002</li> <li>MySQL \u6839\u636e\u6267\u884c\u8ba1\u5212\uff0c\u8c03\u7528\u5b58\u50a8\u5f15\u64ce\u7684 API \u6765\u6267\u884c\u67e5\u8be2\u3002</li> <li>\u5c06\u7ed3\u679c\u8fd4\u56de\u7ed9\u5ba2\u6237\u7aef\uff0c\u540c\u65f6\u7f13\u5b58\u67e5\u8be2\u7ed3\u679c\u3002</li> </ol> <p>\u6bcf\u4e00\u4e2a\u5ba2\u6237\u7aef\u53d1\u8d77\u4e00\u4e2a\u65b0\u7684\u8bf7\u6c42\u90fd\u7531\u670d\u52a1\u5668\u7aef\u7684 \u8fde\u63a5/\u7ebf\u7a0b\u5904\u7406\u5de5\u5177 \u8d1f\u8d23\u63a5\u6536\u5ba2\u6237\u7aef\u7684\u8bf7\u6c42\uff0c\u5e76\u5728\u670d\u52a1\u7aef\u5185\u5b58\u4e2d\u5f00\u8f9f\u4e00\u4e2a\u65b0\u7684\u5185\u5b58\u7a7a\u95f4\uff0c\u751f\u6210\u4e00\u4e2a\u65b0\u7684\u7ebf\u7a0b\u3002</p> <p>\u5f53\u6bcf\u4e00\u4e2a\u7528\u6237\u8fde\u63a5\u5230\u670d\u52a1\u5668\u7aef\u7684\u65f6\u5019\u5c31\u4f1a\u5728\u8fdb\u7a0b\u5730\u5740\u7a7a\u95f4\u91cc\u751f\u6210\u4e00\u4e2a\u65b0\u7684\u7ebf\u7a0b\u7528\u4e8e\u54cd\u5e94\u5ba2\u6237\u7aef\u8bf7\u6c42\uff0c\u7528\u6237\u53d1\u8d77\u7684\u67e5\u8be2\u8bf7\u6c42\u90fd\u5728\u7ebf\u7a0b\u7a7a\u95f4\u5185\u8fd0\u884c\uff0c\u7ed3\u679c\u4e5f\u5728\u8fd9\u91cc\u9762\u7f13\u5b58\u5e76\u8fd4\u56de\u7ed9\u670d\u52a1\u5668\u7aef\u3002</p> <p>\u7ebf\u7a0b\u7684\u91cd\u7528\u548c\u9500\u6bc1\u90fd\u662f\u7531 \u8fde\u63a5/\u7ebf\u7a0b\u5904\u7406\u7ba1\u7406\u5668 \u5b9e\u73b0\u7684\u3002</p> <p>\u7efc\u4e0a\u6240\u8ff0\uff1a\u7528\u6237\u53d1\u8d77\u8bf7\u6c42\uff0c\u8fde\u63a5/\u7ebf\u7a0b\u5904\u7406\u5668\u5f00\u8f9f\u5185\u5b58\u7a7a\u95f4\uff0c\u5f00\u59cb\u63d0\u4f9b\u67e5\u8be2\u7684\u673a\u5236\u3002</p> <p>\u7528\u6237\u603b\u662f\u5e0c\u671b MySQL \u80fd\u591f\u83b7\u5f97\u66f4\u9ad8\u7684\u67e5\u8be2\u6027\u80fd\uff0c\u6700\u597d\u7684\u529e\u6cd5\u662f\u5f04\u6e05\u695a MySQL \u662f\u5982\u4f55\u4f18\u5316\u548c\u6267\u884c\u67e5\u8be2\u7684\u3002</p> <p>\u4e00\u65e6\u7406\u89e3\u4e86\u8fd9\u4e00\u70b9\uff0c\u5c31\u4f1a\u53d1\u73b0\uff1a\u5f88\u591a\u7684\u67e5\u8be2\u4f18\u5316\u5de5\u4f5c\u5b9e\u9645\u4e0a\u5c31\u662f\u9075\u5faa\u4e00\u4e9b\u539f\u5219\u8ba9 MySQL \u7684\u4f18\u5316\u5668\u80fd\u591f\u6309\u7167\u9884\u60f3\u7684\u5408\u7406\u65b9\u5f0f\u8fd0\u884c\u800c\u5df2\u3002</p> <p>\u4ee5 MySQL \u4e3a\u4f8b\uff0c\u6570\u636e\u5e93\u5728\u6267\u884c<code>SQL</code>\u8bed\u53e5\u65f6\uff0c\u9700\u8981\u7ecf\u5386 7 \u4e2a\u6b65\u9aa4\uff1a</p> <ul> <li> <p>\u8bcd\u6cd5\u5206\u6790\uff1a\u5c06<code>SQL</code>\u8bed\u53e5\u5206\u89e3\u6210\u4e00\u4e2a\u4e2a<code>token</code>\uff08\u5173\u952e\u5b57\u3001\u6807\u8bc6\u7b26\u3001\u8fd0\u7b97\u7b26\uff0c\u5e38\u91cf\u7b49\uff09\uff0c\u7136\u540e\u5bf9<code>token</code>\u8fdb\u884c\u5206\u7c7b\u548c\u89e3\u6790\uff0c\u751f\u6210\u76f8\u5e94\u7684\u6570\u636e\u7ed3\u6784\u3002</p> </li> <li> <p>\u8bed\u6cd5\u5206\u6790\uff1a\u6839\u636e<code>SQL</code>\u8bed\u6cd5\u68c0\u6d4b\u89c4\u5219\u68c0\u67e5\u8bed\u6cd5\u662f\u5426\u6b63\u786e\uff0c\u5e76\u751f\u6210\u8bed\u6cd5\u6811\u3002\u6bd4\u5982\u68c0\u67e5<code>SELECT</code>\u5173\u952e\u5b57\u662f\u5426\u5199\u9519\u3002</p> </li> <li> <p>\u8bed\u4e49\u5206\u6790\uff1a\u904d\u5386\u8bed\u6cd5\u6811\uff0c\u786e\u5b9a\u8868\u548c\u5217\u7b49\u4fe1\u606f\uff0c\u540c\u65f6\u68c0\u67e5\u8bed\u4e49\u7684\u6b63\u786e\u6027\u3002\u6bd4\u5982\u68c0\u67e5\u8868\u662f\u5426\u5b58\u5728\uff0c\u5217\u662f\u5426\u5b58\u5728\uff0c\u662f\u5426\u6709\u6743\u9650\u7b49\u3002</p> <pre><code>      - \u6bd4\u5982\u5728\u8bed\u6cd5\u6811\u7684\u6295\u5f71\u4e2d\u9047\u5230\"*\"\uff0c\u8bed\u4e49\u5206\u6790\u5668\u5c31\u77e5\u9053\u9700\u8981\u628a\u5b83\u5c55\u5f00\uff0c\u8fd9\u4e2a\u5c55\u5f00\u7684\u8fc7\u7a0b\u5c31\u9700\u8981\u53bb\u7cfb\u7edf\u5b57\u5178\u8868\u4e2d\u627e\u5230\u8be5\u4e1a\u52a1\u8868\u6240\u5bf9\u5e94\u7684\u5217\u5c5e\u6027\u7684\u4fe1\u606f\uff0c\u7528\u8fd9\u4e9b\u5217\u5c5e\u6027\u4fe1\u606f\u628a\"*\"\u66ff\u6362\u6389\u3002\n</code></pre> </li> <li> <p>\u4f18\u5316\u5904\u7406\uff1a\u4f7f\u7528\u4f18\u5316\u5668\u5bf9<code>SQL</code>\u8bed\u53e5\u8fdb\u884c\u5904\u7406\u548c\u4f18\u5316\uff0c\u6bd4\u5982\u6267\u884c\u8ba1\u5212\u3001\u7d22\u5f15\u7b49\u3002\u67e5\u8be2\u91cd\u5199</p> </li> <li> <p>\u6267\u884c\u8ba1\u5212\uff1a\u4f7f\u7528\u6267\u884c\u8ba1\u5212\u751f\u6210\u5668\u751f\u6210<code>SQL</code>\u8bed\u53e5\u7684\u6267\u884c\u8ba1\u5212\uff0c\u6bd4\u5982\u6570\u636e\u7684\u8bbf\u95ee\u65b9\u5f0f\uff0c\u7d22\u5f15\u7684\u4f7f\u7528\u65b9\u5f0f\u7b49\u3002</p> </li> <li> <p>\u5f15\u64ce\u6267\u884c\uff1a\u5c06\u6267\u884c\u8ba1\u5212\u53d1\u9001\u7ed9\u76f8\u5e94\u7684\u6570\u636e\u5e93\u5f15\u64ce\u8fdb\u884c\u5904\u7406\uff0c\u6267\u884c\u8ba1\u5212\u88ab\u7ffb\u8bd1\u6210\u5e95\u5c42\u7684\u64cd\u4f5c\u6307\u4ee4\uff0c\u6267\u884c\u6570\u636e\u626b\u63cf\u3001\u7d22\u5f15\u67e5\u627e\u3001\u6392\u5e8f\u3001\u5206\u7ec4\u7b49\u64cd\u4f5c\u3002</p> </li> <li> <p>\u8fd4\u56de\u6570\u636e\uff1a\u5c06\u6267\u884c\u7ed3\u679c\u8fd4\u56de\u7ed9\u5ba2\u6237\u7aef\uff0c\u6bd4\u5982\u67e5\u8be2\u7ed3\u679c\u96c6\u6216\u64cd\u4f5c\u7ed3\u679c\u3002</p> </li> </ul> <p>\u5728\u8fd9\u91cc\uff0c\u6211\u4eec\u7c97\u66b4\u7684\u628a\u6267\u884c\u8fc7\u7a0b\u7406\u89e3\u6210\u4e24\u6b65\uff0c\u5373\uff1a\u5148\u7f16\u8bd1<code>SQL</code>\u8bed\u6cd5\u7ed3\u6784\uff081-3 \u6b65\uff09\uff0c\u518d\u6267\u884c SQL \u8bed\u53e5\uff084-7 \u6b65\uff09\u3002</p> <p>\u4e00\u4e2a\u67e5\u8be2\u8bed\u53e5\u5728\u4e0d\u540c\u7684\u9636\u6bb5\uff0c\u751f\u6210\u7684\u6811\u662f\u4e0d\u540c\u7684\uff0c\u8fd9\u4e9b\u6811\u7684\u987a\u5e8f\u5e94\u8be5\u662f\u5148\u751f\u6210\u8bed\u6cd5\u6811\uff0c\u7136\u540e\u5f97\u5230\u67e5\u8be2\u6811\uff0c\u6700\u7ec8\u5f97\u5230\u8ba1\u5212\u6811\uff0c\u8ba1\u5212\u6811\u5c31\u662f\u6211\u4eec\u8bf4\u7684\u6267\u884c\u8ba1\u5212\u3002</p> <p>\u67e5\u8be2\u6811\u5c31\u662f\u67e5\u8be2\u4f18\u5316\u5668\u7684\u8f93\u5165\uff0c\u7ecf\u8fc7\u903b\u8f91\u4f18\u5316\u548c\u7269\u7406\u4f18\u5316\uff0c\u6700\u7ec8\u4ea7\u751f\u4e00\u9897\u6700\u4f18\u7684\u8ba1\u5212\u6811\uff0c\u800c\u6211\u4eec\u8981\u505a\u7684\u5c31\u4f1a\u770b\u770b\u67e5\u8be2\u4f18\u5316\u5668\u662f\u5982\u4f55\u4ea7\u751f\u8fd9\u68f5\u6700\u4f18\u7684\u8ba1\u5212\u6811\u7684\u3002</p> <p>\u6b63\u5e38\u60c5\u51b5\u4e0b\uff0c\u7528\u6237\u8f93\u5165\u7684\u53c2\u6570\u4f1a\u76f4\u63a5\u53c2\u4e0e SQL \u8bed\u6cd5\u7684\u7f16\u8bd1\uff0c\u800c\u9884\u7f16\u8bd1\u5219\u662f\u5148\u6784\u5efa\u8bed\u6cd5\u6811\uff0c\u786e\u5b9a SQL \u8bed\u6cd5\u7ed3\u6784\u4ee5\u540e\uff0c\u518d\u62fc\u63a5\u7528\u6237\u7684\u53c2\u6570\u3002</p>"},{"location":"basic/9.mysql_architecture/#_1","title":"\u5ba2\u6237\u7aef/\u670d\u52a1\u7aef\u901a\u4fe1\u534f\u8bae","text":"<p>\u4e00\u822c\u6765\u8bf4\uff0c\u4e0d\u9700\u8981\u53bb\u7406\u89e3 MySQL \u901a\u4fe1\u534f\u8bae\u7684\u5185\u90e8\u5b9e\u73b0\u7ec6\u8282\uff0c\u53ea\u9700\u8981\u5927\u81f4\u7406\u89e3\u901a\u4fe1\u534f\u8bae\u662f\u5982\u4f55\u5de5\u4f5c\u7684\u3002</p> <p>MySQL \u5ba2\u6237\u7aef/\u670d\u52a1\u7aef \u901a\u4fe1\u534f\u8bae\u662f\u201c\u534a\u53cc\u5de5\u201d\u7684\uff1a\u5728\u4efb\u4e00\u65f6\u523b\uff0c\u8981\u4e48\u662f\u670d\u52a1\u5668\u5411\u5ba2\u6237\u7aef\u53d1\u9001\u6570\u636e\uff0c\u8981\u4e48\u662f\u5ba2\u6237\u7aef\u5411\u670d\u52a1\u5668\u53d1\u9001\u6570\u636e\uff0c\u8fd9\u4e24\u4e2a\u52a8\u4f5c\u4e0d\u80fd\u540c\u65f6\u53d1\u751f\u3002</p> <p>\u8fd9\u79cd\u534f\u8bae\u8ba9 MySQL \u901a\u4fe1\u7b80\u5355\u5feb\u901f\uff0c \u4f46\u662f\u4e5f\u4ece\u5f88\u591a\u5730\u65b9\u9650\u5236\u4e86 MySQL\u3002\u4e00\u4e2a\u660e\u663e\u7684\u9650\u5236\u662f\uff0c \u8fd9\u610f\u5473\u7740\u6ca1\u6cd5\u8fdb\u884c\u6d41\u91cf\u63a7\u5236\u3002</p> <p>\u4e00\u65e6\u4e00\u7aef\u5f00\u59cb\u53d1\u9001\u6d88\u606f\uff0c\u53e6\u4e00\u7aef\u8981\u63a5\u6536\u5b8c\u6574\u4e2a\u6d88\u606f\u624d\u80fd\u54cd\u5e94\u5b83\uff0c\u6240\u4ee5\u6211\u4eec\u65e0\u6cd5\u4e5f\u65e0\u987b\u5c06\u4e00\u4e2a\u6d88\u606f\u5207\u6210\u5c0f\u5757\u72ec\u7acb\u53d1\u9001\uff0c\u4e5f\u6ca1\u6709\u529e\u6cd5\u8fdb\u884c\u6d41\u91cf\u63a7\u5236\u3002</p> <p>\u5ba2\u6237\u7aef\u63d0\u4ea4\u4e00\u4e2a SQL \u8bf7\u6c42\u7ed9\u670d\u52a1\u5668\u65f6\u662f\u76f4\u63a5\u7528\u4e00\u4e2a\u5355\u72ec\u7684\u6570\u636e\u5305\u53d1\u9001\u7684\uff0c\u6240\u4ee5\u5f53\u67e5\u8be2\u8bed\u53e5\u5f88\u957f\u7684\u65f6\u5019\uff0c\u6bd4\u5982\u4e00\u6b21\u6027\u63d0\u4ea4\u63d2\u5165\u5927\u91cf\u6570\u636e\u65f6\uff0c\u9700\u8981\u6ce8\u610f\u63a7\u5236 <code>max_allowed_packet</code> \u53c2\u6570\u3002</p> <pre><code># max_allowed_packet\u8868\u793a\u670d\u52a1\u5668\u6240\u80fd\u5904\u7406\u7684\u8bf7\u6c42\u5305\u7684\u6700\u5927\u503c\u3002\u9ed8\u8ba4\u662f64MB\uff0c\u6700\u5927\u503c\u662f1GB\u3002MySQL 8.0\u5355\u4e2apacket\u53ef\u4ee5\u5141\u8bb8\u7684\u6700\u5927\u503c\u662f1GB\n# \u5ba2\u6237\u7aef\u548c\u670d\u52a1\u7aef\u90fd\u6709\u81ea\u5df1\u7684max_allowed_packet\u53d8\u91cf\uff0c\u6240\u4ee5\u8981\u8c03\u8282\u6b64\u53c2\u6570\u65f6\uff0c\u5fc5\u987b\u540c\u65f6\u589e\u52a0server\u7aef\u548cclient\u7aef\u7684\u914d\u7f6e\u53d8\u91cf\u3002\nmax_allowed_packet=64MB\n\n\n# \u6bcf\u4e2a\u5ba2\u6237\u7aef\u7ebf\u7a0b\u90fd\u5173\u8054\u4e86 1 \u4e2a\u8fde\u63a5\u7f13\u51b2\u533a\uff08connection buffer\uff09\u548c 1 \u4e2a\u7ed3\u679c\u96c6\u7f13\u51b2\u533a\uff08result buffer\uff09\u3002\n# \u8fd9 2 \u4e2a\u7f13\u51b2\u533a\u7684\u521d\u59cb\u5927\u5c0f\u90fd\u7531 net_buffer_length \u63a7\u5236\uff0c\u9700\u8981\u65f6\u6700\u5927\u53ef\u4ee5\u81ea\u52a8\u589e\u957f\u5230\u4e0d\u8d85\u8fc7 max_allowed_packet\u3002\n# \u6bcf\u6761 SQL \u8bed\u53e5\u6267\u884c\u5b8c\u6210\u540e\uff0c\u7ed3\u679c\u96c6\u7f13\u51b2\u533a\u90fd\u4f1a\u81ea\u52a8\u6062\u590d\u5230 net_buffer_length \u6307\u5b9a\u7684\u5927\u5c0f\u3002\n\n# \u4e00\u822c\u60c5\u51b5\u4e0b\uff0c\u4e0d\u5e94\u8be5\u4fee\u6539 net_buffer_length \u7684\u503c\uff0c\u5982\u679c\u8fd9\u4e2a\u503c\u8bbe\u7f6e\u5f97\u975e\u5e38\u5c0f\uff0c\u4f60\u53ef\u4ee5\u628a\u5b83\u4fee\u6539\u4e3a\u5ba2\u6237\u7aef\u53d1\u9001\u7684 SQL \u8bed\u53e5\u9884\u671f\u7684\u957f\u5ea6\u3002\n# \u5982\u679c SQL \u8bed\u53e5\u957f\u5ea6\u8d85\u8fc7\u8fd9\u4e2a\u503c\uff0c\u8fde\u63a5\u7f13\u51b2\u533a\u8fd8\u4f1a\u81ea\u52a8\u589e\u957f\u3002net_buffer_length \u7684\u6700\u5927\u503c\u4e3a 1048576\uff081M\uff09\u3002\n</code></pre> <p>MySQL \u662f C/S \u7ed3\u6784\uff0cclient \u4e0e server \u4e4b\u95f4\u7684\u901a\u4fe1\u9700\u8981\u9075\u5faa\u7ea6\u5b9a\u7684\u89c4\u5219\uff0cC/S \u4e4b\u95f4\u901a\u4fe1\u7684\u6700\u5c0f\u5355\u5143\u5c31\u662f packet\uff0c\u901a\u4fe1\u7ea6\u5b9a\u7684\u89c4\u5219\u5c31\u662f packet \u7684\u7ed3\u6784\u3002</p> <p>\u4e00\u4e2a\u4f20\u8f93\u7684\u5305\uff08a communication packet \uff09\u4ee3\u8868\u7740\uff1a</p> <ul> <li>\u5ba2\u6237\u7aef\u53d1\u9001\u5230 mysql \u670d\u52a1\u7aef\u7684\u5355\u4e2a SQL STATEMENT</li> <li>\u670d\u52a1\u7aef\u53d1\u9001\u5230\u5ba2\u6237\u7aef\u7684\u5355\u884c\u6570\u636e</li> <li>master \u53d1\u5f80 slave \u7684\u4e00\u4e2a binary log event</li> </ul> <p>\u4f46\u662f\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u5982\u679c\u67e5\u8be2\u5b9e\u5728\u662f\u592a\u5927\uff0c\u670d\u52a1\u7aef\u4f1a\u62d2\u7edd\u63a5\u6536\u66f4\u591a\u6570\u636e\u5e76\u629b\u51fa\u5f02\u5e38\u3002\u5f53\u670d\u52a1\u5668\u6536\u5230\u5927\u4e8e max_allowed_packet \u5b57\u8282\u7684\u4fe1\u606f\u5305\u65f6\uff0c\u5c06\u53d1\"\u4fe1\u606f\u5305\u8fc7\u5927\"\u9519\u8bef\uff0c\u5e76\u5173\u95ed\u8fde\u63a5\u3002</p> <p>\u4e8e\u67d0\u4e9b\u5ba2\u6237\u7aef\uff0c\u5982\u679c\u901a\u4fe1\u4fe1\u606f\u5305\u8fc7\u5927\uff0c\u5728\u6267\u884c\u67e5\u8be2\u671f\u95f4\uff0c\u53ef\u80fd\u4f1a\u9047\u5230\"\u4e22\u5931\u4e0e MySQL \u670d\u52a1\u5668\u7684\u8fde\u63a5\"\u9519\u8bef\u3002</p> <p>\u4e0e\u4e4b\u76f8\u53cd\u7684\u662f\uff0c\u670d\u52a1\u5668\u54cd\u5e94\u7ed9\u7528\u6237\u7684\u6570\u636e\u901a\u5e38\u4f1a\u5f88\u591a\uff0c\u7531\u591a\u4e2a\u6570\u636e\u5305\u7ec4\u6210\u3002\u5f53\u670d\u52a1\u5668\u54cd\u5e94\u5ba2\u6237\u7aef\u8bf7\u6c42\u65f6\uff0c\u5ba2\u6237\u7aef\u5fc5\u987b\u5b8c\u6574\u7684\u63a5\u6536\u6574\u4e2a\u8fd4\u56de\u7ed3\u679c\uff0c\u800c\u4e0d\u80fd\u7b80\u5355\u7684\u53ea\u53d6\u524d\u9762\u51e0\u6761\u7ed3\u679c\uff0c\u7136\u540e\u8ba9\u670d\u52a1\u5668\u505c\u6b62\u53d1\u9001\u3002</p> <p>\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u5ba2\u6237\u7aef\u82e5\u63a5\u6536\u5b8c\u6574\u7684\u7ed3\u679c\uff0c\u7136\u540e\u53d6\u524d\u9762\u51e0\u6761\u9700\u8981\u7684\u7ed3\u679c\uff0c\u6216\u8005\u63a5\u6536\u5b8c\u51e0\u6761\u7ed3\u679c\u540e\u5c31\"\u7c97\u66b4\"\u5730\u65ad\u5f00\u8fde\u63a5\uff0c\u90fd\u4e0d\u662f\u597d\u4e3b\u610f\u3002</p> <p>\u56e0\u800c\u5728\u5b9e\u9645\u5f00\u53d1\u4e2d\uff0c\u5c3d\u91cf\u4fdd\u6301\u67e5\u8be2\u7b80\u5355\u4e14\u53ea\u8fd4\u56de\u5fc5\u9700\u7684\u6570\u636e\uff0c\u51cf\u5c0f\u901a\u4fe1\u95f4\u6570\u636e\u5305\u7684\u5927\u5c0f\u548c\u6570\u91cf\u662f\u4e00\u4e2a\u975e\u5e38\u597d\u7684\u4e60\u60ef\u3002</p> <p>\u8fd9\u4e5f\u662f\u67e5\u8be2\u4e2d\u5c3d\u91cf\u907f\u514d\u4f7f\u7528 SELECT * \u4ee5\u53ca\u52a0\u4e0a LIMIT \u9650\u5236\u7684\u539f\u56e0\u4e4b\u4e00\u3002</p> <p>\u5f15\u81ea\u300a\u9ad8\u6027\u80fd MySQL\u300b\u3002</p> <p>\u5f53\u5ba2\u6237\u7aef\u4ece\u670d\u52a1\u5668\u53d6\u6570\u636e\u65f6\uff0c\u770b\u8d77\u6765\u662f\u4e00\u4e2a\u62c9\u6570\u636e\u7684\u8fc7\u7a0b\uff0c\u4f46\u5b9e\u9645\u4e0a\u662f MySQL \u5728\u5411\u5ba2\u6237\u7aef\u63a8\u9001\u6570\u636e\u7684\u8fc7\u7a0b\u3002\u5ba2\u6237\u7aef\u4e0d\u65ad\u5730\u63a5\u6536\u4ece\u670d\u52a1\u5668\u63a8\u9001\u7684\u6570\u636e\uff0c\u5ba2\u6237\u7aef\u4e5f\u6ca1\u6cd5\u8ba9\u670d\u52a1\u5668\u505c\u4e0b\u6765\u3002</p> <p>InnoDB \u7684\u6570\u636e\u662f\u4fdd\u5b58\u5728\u4e3b\u952e\u7d22\u5f15\u4e0a\u7684\uff0c\u6240\u4ee5\u5168\u8868\u626b\u63cf\u5b9e\u9645\u4e0a\u662f\u76f4\u63a5\u626b\u63cf\u8868\u7684\u4e3b\u952e\u7d22\u5f15\uff0c\u5bf9\u4e8e\u5355\u8868\u8d85\u8fc7\u7cfb\u7edf\u5185\u5b58\u7684\u60c5\u51b5\uff0c\u67e5\u8be2\u4f1a\u4e0d\u4f1a\u628a\u6570\u636e\u90fd\u8bfb\u5230\u5185\u5b58\u4e2d\u5bfc\u81f4\u7cfb\u7edf\u5185\u5b58\u8017\u5c3d\u5462\uff1f</p> <p>\u663e\u7136\u4e0d\u4f1a\uff0c\u5b9e\u9645\u4e0a\u670d\u52a1\u7aef\u5e76\u4e0d\u9700\u8981\u4fdd\u5b58\u4e00\u4e2a\u5b8c\u6574\u7684\u7ed3\u679c\u96c6\u3002\u53d6\u6570\u636e\u548c\u53d1\u6570\u636e\u7684\u6d41\u7a0b\u662f\u8fd9\u6837\u7684\uff1a</p> <ul> <li> <p>\u83b7\u53d6\u4e00\u884c\uff0c\u5199\u5230 net_buffer \u4e2d\u3002\u8fd9\u5757\u5185\u5b58\u7684\u5927\u5c0f\u662f\u7531\u53c2\u6570 net_buffer_length \u5b9a\u4e49\u7684\uff0c\u9ed8\u8ba4\u662f 16k\u3002</p> </li> <li> <p>\u91cd\u590d\u83b7\u53d6\u884c\uff0c\u76f4\u5230 net_buffer \u5199\u6ee1\uff0c\u8c03\u7528\u7f51\u7edc\u63a5\u53e3\u53d1\u51fa\u53bb\u3002</p> </li> <li> <p>\u5982\u679c\u53d1\u9001\u6210\u529f\uff0c\u5c31\u6e05\u7a7a net_buffer\uff0c\u7136\u540e\u7ee7\u7eed\u53d6\u4e0b\u4e00\u884c\uff0c\u5e76\u5199\u5165 net_buffer\u3002</p> </li> <li> <p>\u5982\u679c\u53d1\u9001\u51fd\u6570\u8fd4\u56de EAGAIN \u6216 WSAEWOULDBLOCK\uff0c\u5c31\u8868\u793a\u672c\u5730\u7f51\u7edc\u6808\uff08socket send buffer\uff09\u5199\u6ee1\u4e86\uff0c\u8fdb\u5165\u7b49\u5f85\u3002\u76f4\u5230\u7f51\u7edc\u6808\u91cd\u65b0\u53ef\u5199\uff0c\u518d\u7ee7\u7eed\u53d1\u9001\u3002</p> </li> </ul> <p>\u4e00\u4e2a\u67e5\u8be2\u5728\u53d1\u9001\u8fc7\u7a0b\u4e2d\uff0c\u5360\u7528\u7684 MySQL \u5185\u90e8\u7684\u5185\u5b58\u6700\u5927\u5c31\u662f net_buffer_length \u8fd9\u4e48\u5927\uff0c\u5e76\u4e0d\u4f1a\u8fbe\u5230 200G\uff1b</p> <p>socket send buffer \u4e5f\u4e0d\u53ef\u80fd\u8fbe\u5230 200G\uff08\u9ed8\u8ba4\u5b9a\u4e49/proc/sys/net/core/wmem_default\uff09\uff0c\u5982\u679c socket send buffer \u88ab\u5199\u6ee1\uff0c\u5c31\u4f1a\u6682\u505c\u8bfb\u6570\u636e\u7684\u6d41\u7a0b\u3002</p> <p>\u4e5f\u5c31\u662f\u8bf4\uff0cMySQL \u662f \u8fb9\u8bfb\u8fb9\u53d1\u7684\uff0c\u8fd9\u4e2a\u6982\u5ff5\u5f88\u91cd\u8981\u3002\u8fd9\u5c31\u610f\u5473\u7740\uff0c\u5982\u679c\u5ba2\u6237\u7aef\u63a5\u6536\u5f97\u6162\uff0c\u4f1a\u5bfc\u81f4 MySQL \u670d\u52a1\u7aef\u7531\u4e8e\u7ed3\u679c\u53d1\u4e0d\u51fa\u53bb\uff0c\u8fd9\u4e2a\u4e8b\u52a1\u7684\u6267\u884c\u65f6\u95f4\u53d8\u957f\u3002</p>"},{"location":"basic/9.mysql_architecture/#mysql_1","title":"MySQL \u63d2\u4ef6\u4f53\u7cfb","text":"<p>MySQL \u73b0\u5728\u5f88\u591a\u6a21\u5757\u90fd\u662f\u901a\u8fc7<code>plugin</code>\u7684\u65b9\u5f0f\u8fde\u63a5\u5230 MySQL \u6838\u5fc3\u4e2d\u7684\uff0c\u9664\u4e86\u5927\u5bb6\u719f\u6089\u7684\u5b58\u50a8\u5f15\u64ce\u90fd\u662f<code>Plugin</code>\u4e4b\u5916\uff0cMySQL \u8fd8\u652f\u6301\u5176\u4ed6\u7c7b\u578b\u7684<code>plugin</code>\u3002</p> <pre><code>select  * from information_schema.plugins  -- where plugin_name like \"%daemon%\";\n</code></pre>"},{"location":"basic/9.mysql_architecture/#_2","title":"\u5bc6\u7801\u5f3a\u5ea6\u63d2\u4ef6","text":"<p>\u5728 MySQL \u5b98\u65b9\u6587\u6863\u4e2d\uff0c<code>The Password Validation Component</code> \u5e94\u8be5\u7ffb\u8bd1\u4e3a\u7ec4\u4ef6\u66f4\u4e3a\u5408\u9002\uff0c\u4e0d\u8fc7\u5b9e\u9645\u4e0a\u90fd\u5dee\u4e0d\u591a\uff0c\u8fd9\u91cc\u6211\u4eec\u5c31\u4e0d\u505a\u8fc7\u591a\u8d58\u8ff0\u3002</p>"},{"location":"basic/9.mysql_architecture/#_3","title":"\u514b\u9686\u63d2\u4ef6","text":""},{"location":"basic/9.mysql_architecture/#_4","title":"\u8fde\u63a5\u5668/\u8fde\u63a5\u7ba1\u7406","text":"<p>\u8fde\u63a5\u5668\u8d1f\u8d23\u8ddf\u5ba2\u6237\u7aef\u5efa\u7acb\u8fde\u63a5\u3001\u83b7\u53d6\u6743\u9650\u3001\u7ef4\u6301\u548c\u7ba1\u7406\u8fde\u63a5\u3002</p> <p>\u5ba2\u6237\u7aef\u4f7f\u7528\u547d\u4ee4\u884c\u767b\u9646\u65f6\u8fde\u63a5\u547d\u4ee4\uff1a<code>mysql -h${ip} -P${port} -u${user} -p${password}</code></p> <p>\u5728\u5b8c\u6210 TCP \u4e09\u6b21\u63e1\u624b\u4e4b\u540e\uff0c\u8fde\u63a5\u5668\u5c31\u8981\u5f00\u59cb\u8ba4\u8bc1\u8eab\u4efd\u8fdb\u884c\u8d26\u5bc6\u6821\u9a8c\uff0c\u6821\u9a8c\u901a\u8fc7\u4e4b\u540e\uff0c\u8fde\u63a5\u5668\u4f1a\u5230\u6743\u9650\u8868\u91cc\u67e5\u8be2\u62e5\u6709\u7684\u6743\u9650\u4e4b\u540e\u5728\u8fd9\u4e2a\u8fde\u63a5\u91cc\u7684\u6743\u9650\u5224\u65ad\uff0cSQL \u6267\u884c\u7684\u6743\u9650\u90fd\u4f9d\u8d56\u4e8e\u6b64\u65f6\u8bfb\u53d6\u7684\u6743\u9650\u3002</p> <p>\u8fd9\u5c31\u610f\u5473\u7740\uff0c\u4e00\u4e2a\u7528\u6237\u6210\u529f\u5efa\u7acb\u8fde\u63a5\u540e\uff0c\u5373\u4f7f\u4f60\u7528\u7ba1\u7406\u5458\u8d26\u53f7\u5bf9\u8fd9\u4e2a\u7528\u6237\u7684\u6743\u9650\u505a\u4e86\u4fee\u6539\uff0c\u4e5f\u4e0d\u4f1a\u5f71\u54cd\u5df2\u7ecf\u5b58\u5728\u8fde\u63a5\u7684\u6743\u9650\u3002\u4fee\u6539\u5b8c\u6210\u540e\uff0c\u53ea\u6709\u518d\u65b0\u5efa\u7684\u8fde\u63a5\u624d\u4f1a\u4f7f\u7528\u65b0\u7684\u6743\u9650\u8bbe\u7f6e\u3002</p> <p>MySQL \u5ba2\u6237\u7aef\uff0c\u5f53\u4f7f\u7528\u9ed8\u8ba4\u53c2\u6570\u8fde\u63a5\u7684\u65f6\u5019\uff0cMySQL \u5ba2\u6237\u7aef\u4f1a\u63d0\u4f9b\u4e00\u4e2a\u672c\u5730\u5e93\u540d\u548c\u8868\u540d\u8865\u5168\u7684\u529f\u80fd\u3002</p> <p>\u4e3a\u4e86\u5b9e\u73b0\u8fd9\u4e2a\u529f\u80fd\uff0c\u5ba2\u6237\u7aef\u5728\u8fde\u63a5\u6210\u529f\u540e\uff0c\u9700\u8981\u591a\u505a\u4e00\u4e9b\u64cd\u4f5c\uff1a</p> <ul> <li>\u6267\u884c show databases\uff1b</li> <li>\u5207\u5230 db1 \u5e93\uff0c\u6267\u884c show tables\uff1b</li> <li>\u628a\u8fd9\u4e24\u4e2a\u547d\u4ee4\u7684\u7ed3\u679c\u7528\u4e8e\u6784\u5efa\u4e00\u4e2a\u672c\u5730\u7684\u54c8\u5e0c\u8868\u3002</li> </ul> <p>\u5728\u8fd9\u4e9b\u64cd\u4f5c\u4e2d\uff0c\u6700\u82b1\u65f6\u95f4\u7684\u5c31\u662f\u7b2c\u4e09\u6b65\u5728\u672c\u5730\u6784\u5efa\u54c8\u5e0c\u8868\u7684\u64cd\u4f5c\u3002\u6240\u4ee5\uff0c\u5f53\u4e00\u4e2a\u5e93\u4e2d\u7684\u8868\u4e2a\u6570\u975e\u5e38\u591a\u7684\u65f6\u5019\uff0c\u8fd9\u4e00\u6b65\u5c31\u4f1a\u82b1\u6bd4\u8f83\u957f\u7684\u65f6\u95f4\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c\u611f\u77e5\u5230\u7684\u8fde\u63a5\u8fc7\u7a0b\u6162\uff0c\u5176\u5b9e\u5e76\u4e0d\u662f\u8fde\u63a5\u6162\uff0c\u4e5f\u4e0d\u662f\u670d\u52a1\u7aef\u6162\uff0c\u800c\u662f\u5ba2\u6237\u7aef\u6162\u3002</p> <p>\u5982\u679c\u5728\u8fde\u63a5\u547d\u4ee4\u4e2d\u52a0\u4e0a -A\uff0c\u5c31\u53ef\u4ee5\u5173\u6389\u8fd9\u4e2a\u81ea\u52a8\u8865\u5168\u7684\u529f\u80fd\uff0c\u7136\u540e\u5ba2\u6237\u7aef\u5c31\u53ef\u4ee5\u5feb\u901f\u8fd4\u56de\u4e86\u3002</p> <p>\u8fd9\u91cc\u81ea\u52a8\u8865\u5168\u7684\u6548\u679c\u5c31\u662f\uff0c\u4f60\u5728\u8f93\u5165\u5e93\u540d\u6216\u8005\u8868\u540d\u7684\u65f6\u5019\uff0c\u8f93\u5165\u524d\u7f00\uff0c\u53ef\u4ee5\u4f7f\u7528 Tab \u952e\u81ea\u52a8\u8865\u5168\u8868\u540d\u6216\u8005\u663e\u793a\u63d0\u793a\u3002\u5b9e\u9645\u4f7f\u7528\u4e2d\uff0c\u5982\u679c\u4f60\u81ea\u52a8\u8865\u5168\u529f\u80fd\u7528\u5f97\u5e76\u4e0d\u591a\uff0c\u5efa\u8bae\u6bcf\u6b21\u4f7f\u7528\u7684\u65f6\u5019\u90fd\u9ed8\u8ba4\u52a0 -A\u3002</p> <p>MySQL \u5ba2\u6237\u7aef\u53d1\u9001\u8bf7\u6c42\u540e\uff0c\u63a5\u6536\u670d\u52a1\u7aef\u8fd4\u56de\u7ed3\u679c\u7684\u65b9\u5f0f\u6709\u4e24\u79cd\uff1a</p> <p>\u4e00\u79cd\u662f\u672c\u5730\u7f13\u5b58\uff0c\u4e5f\u5c31\u662f\u5728\u672c\u5730\u5f00\u4e00\u7247\u5185\u5b58\uff0c\u5148\u628a\u7ed3\u679c\u5b58\u8d77\u6765\u3002\u5982\u679c\u4f60\u7528 API \u5f00\u53d1\uff0c\u5bf9\u5e94\u7684\u5c31\u662f mysql_store_result \u65b9\u6cd5\u3002 \u53e6\u4e00\u79cd\u662f\u4e0d\u7f13\u5b58\uff0c\u8bfb\u4e00\u4e2a\u5904\u7406\u4e00\u4e2a\u3002\u5982\u679c\u4f60\u7528 API \u5f00\u53d1\uff0c\u5bf9\u5e94\u7684\u5c31\u662f mysql_use_result \u65b9\u6cd5\u3002 MySQL \u5ba2\u6237\u7aef\u9ed8\u8ba4\u91c7\u7528\u7b2c\u4e00\u79cd\u65b9\u5f0f\uff0c\u800c\u5982\u679c\u52a0\u4e0a\u2013quick \u53c2\u6570\uff0c\u5c31\u4f1a\u4f7f\u7528\u7b2c\u4e8c\u79cd\u4e0d\u7f13\u5b58\u7684\u65b9\u5f0f\u3002</p> <p>\u91c7\u7528\u4e0d\u7f13\u5b58\u7684\u65b9\u5f0f\u65f6\uff0c\u5982\u679c\u672c\u5730\u5904\u7406\u5f97\u6162\uff0c\u5c31\u4f1a\u5bfc\u81f4\u670d\u52a1\u7aef\u53d1\u9001\u7ed3\u679c\u88ab\u963b\u585e\uff0c\u56e0\u6b64\u4f1a\u8ba9\u670d\u52a1\u7aef\u53d8\u6162\u3002</p> <p>\u4e3a\u4ec0\u4e48\u8981\u7ed9\u8fd9\u4e2a\u53c2\u6570\u53d6\u540d\u53eb\u4f5c quick \u5462\uff1f</p> <p>\u8fd9\u662f\u56e0\u4e3a\u4f7f\u7528\u8fd9\u4e2a\u53c2\u6570\u53ef\u4ee5\u8fbe\u5230\u4ee5\u4e0b\u4e09\u70b9\u6548\u679c\uff1a</p> <p>\u7b2c\u4e00\u70b9\uff0c\u8df3\u8fc7\u8868\u540d\u81ea\u52a8\u8865\u5168\u529f\u80fd\u3002</p> <p>\u7b2c\u4e8c\u70b9\uff0cmysql_store_result \u9700\u8981\u7533\u8bf7\u672c\u5730\u5185\u5b58\u6765\u7f13\u5b58\u67e5\u8be2\u7ed3\u679c\uff0c\u5982\u679c\u67e5\u8be2\u7ed3\u679c\u592a\u5927\uff0c\u4f1a\u8017\u8d39\u8f83\u591a\u7684\u672c\u5730\u5185\u5b58\uff0c\u53ef\u80fd\u4f1a\u5f71\u54cd\u5ba2\u6237\u7aef\u672c\u5730\u673a\u5668\u7684\u6027\u80fd\uff1b</p> <p>\u7b2c\u4e09\u70b9\uff0c\u662f\u4e0d\u4f1a\u628a\u6267\u884c\u547d\u4ee4\u8bb0\u5f55\u5230\u672c\u5730\u7684\u547d\u4ee4\u5386\u53f2\u6587\u4ef6\u3002 \u2013quick \u53c2\u6570\u7684\u610f\u601d\uff0c\u662f\u8ba9\u5ba2\u6237\u7aef\u53d8\u5f97\u66f4\u5feb\u3002</p>"},{"location":"basic/9.mysql_architecture/#mysql_2","title":"MySQL \u8fde\u63a5\u7ebf\u7a0b\u6a21\u578b","text":"<p>MySQL \u662f\u4e00\u4e2a \u5355\u8fdb\u7a0b\u591a\u7ebf\u7a0b \u7684\u8f6f\u4ef6\uff0c\u542f\u52a8\u4e00\u4e2a MySQL \u5b9e\u4f8b\uff0c\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u4f1a\u4f7f\u7528 mysqld \u8fd9\u4e2a\u53ef\u6267\u884c\u6587\u4ef6\u6765\u542f\u52a8\u4e00\u4e2a mysqld \u8fdb\u7a0b\u3002</p> <p><code>mysqld</code>\u901a\u8fc7\u521b\u5efa\u591a\u4e2a\u7ebf\u7a0b\u6765\u670d\u52a1\u4e8e\u4e0d\u540c\u7684\u7528\u6237\u8fde\u63a5\u3002\u901a\u5e38\u60c5\u51b5\u4e0b\uff0c\u968f\u7740\u7528\u6237\u8fde\u63a5\u6570\u7684\u589e\u52a0\uff0cMySQL \u5185\u90e8\u7528\u4e8e\u5904\u7406\u7528\u6237\u8fde\u63a5\u7684\u7ebf\u7a0b\u4e5f\u4f1a\u540c\u6b65\u7684\u589e\u52a0\uff0c\u5728\u4e00\u5b9a\u8303\u56f4\u5185\uff0c\u589e\u52a0\u7528\u6237\u5e76\u53d1\u8fde\u63a5\uff0c\u5bf9\u63d0\u9ad8\u7cfb\u7edf\u7684\u541e\u5410\u91cf\u6709\u4e00\u5b9a\u7684\u5e2e\u52a9\uff0c\u7136\u800c\u7528\u6237\u5e76\u53d1\u8fde\u63a5\u6570\u8d85\u8fc7\u67d0\u4e2a\u9608\u503c\uff0cMySQL \u7684\u6027\u80fd\u53cd\u800c\u4f1a\u964d\u4f4e\u3002</p> <p>\u6bcf\u4e2a\u7ebf\u7a0b\u81f3\u5c11\u6709\u4e24\u4e2a\u552f\u4e00\u6807\u8bc6\u7b26\uff1a \u4e00\u4e2a\u662f\u64cd\u4f5c\u7cfb\u7edf\u7ebf\u7a0b ID\uff0c \u53e6\u4e00\u4e2a\u662f MySQL \u5185\u90e8\u7ebf\u7a0b ID\u3002</p> <ul> <li>THREAD_ID: MySQL \u5185\u90e8\u7684\u7ebf\u7a0bID\uff0cMySQL\u6570\u636e\u5e93\u5185\u90e8\u5206\u914d\u7ed9\u6bcf\u4e2a\u7ebf\u7a0b\u7684\u552f\u4e00\u6807\u8bc6\u7b26\u3002</li> <li>PROCESSLIST_ID: \u8fde\u63a5 ID\uff0c\u6bcf\u4e2a\u524d\u53f0\u7ebf\u7a0b\u90fd\u6709\u4e00\u4e2a\u6307\u5b9a\u7684 PROCESSLIST_ID \u8fde\u63a5\u6807\u8bc6\u7b26\u3002\u6211\u4eec\u5e73\u65f6 kill processlist_id \u5c31\u662f\u8fd9\u4e2a</li> <li>THREAD_OS_ID: \u64cd\u4f5c\u7cfb\u7edf\u7ebf\u7a0b ID</li> </ul> <p>\u4e0a\u8ff0 ID \u5747\u53ef\u4ee5\u901a\u8fc7 <code>performance_schema.threads</code> \u67e5\u8be2\u3002\u5bf9\u4e8e\u64cd\u4f5c\u7cfb\u7edf\u7ebf\u7a0b ID \u53ef\u4ee5\u901a\u8fc7\u7cfb\u7edf\u76f8\u5173\u5de5\u5177\u67e5\u770b\uff0c \u5982\u5728<code>Linux</code>\u7cfb\u7edf\u4e2d\u53ef\u4f7f\u7528<code>ps -eLf</code>\u547d\u4ee4\u67e5\u770b\u3002</p> <p>\u6211\u4eec\u6253\u5f00 htop \u6216 top \u65f6\uff0c\u5982\u679c\u67e5\u770b\u4ee5\u7ebf\u7a0b\u65b9\u5f0f\u67e5\u770b\uff0c\u5c31\u53ef\u4ee5\u770b\u5230\u5f88\u591a <code>mysqld</code> \u7ebf\u7a0b\u3002\u8fd9\u4e9b\u5c31\u662f\u7528\u4e8e\u5904\u7406\u5ba2\u6237\u7aef\u8fde\u63a5\u800c\u521b\u5efa\u7684\u7ebf\u7a0b\u3002</p>"},{"location":"basic/9.mysql_architecture/#mysql_3","title":"MySQL \u7ebf\u7a0b\u7ba1\u7406","text":"<p>MySQL \u662f\u4e00\u4e2a\u5355\u8fdb\u7a0b\u591a\u7ebf\u7a0b\u7684\u7a0b\u5e8f\uff0c\u6839\u636e <code>type</code> \u53ef\u4ee5\u5206\u4e3a <code>BACKGROUND</code> \u548c <code>FOREGROUND</code> \u7ebf\u7a0b\u3002\u53ef\u901a\u8fc7 <code>performance_schema.threads</code> \u8868\u67e5\u770b\u3002</p> <p>\u4f7f\u7528 htop \u4e5f\u53ef\u4ee5\u770b\u5230 MySQL \u670d\u52a1\u7684\u5404\u4e2a\u7ebf\u7a0b\u3002</p>"},{"location":"basic/9.mysql_architecture/#_5","title":"\u540e\u53f0\u7ebf\u7a0b","text":"thread/innodb/srv_master_thread srv_master_thread \u662f\u6700\u91cd\u8981\u7684\u540e\u53f0\u4e3b\u7ebf\u7a0b\uff0c\u4e3b\u8981\u8d1f\u8d23\u5c06\u7f13\u51b2\u6c60\u4e2d\u7684\u6570\u636e\u5f02\u6b65\u5237\u65b0\u5230\u78c1\u76d8\uff0c\u4fdd\u8bc1\u6570\u636e\u7684\u4e00\u81f4\u6027\uff0c\u5305\u62ec\u810f\u9875\u7684\u5237\u65b0\u3001\u5408\u5e76\u63d2\u5165\u7f13\u51b2\u3001UNDO \u9875\u7684\u56de\u6536\u7b49\u3002"},{"location":"basic/9.mysql_architecture/#_6","title":"\u524d\u53f0\u7ebf\u7a0b","text":"<p>MySQL \u5904\u7406\u7528\u6237\u8fde\u63a5\u7684\u90fd\u662f\u524d\u53f0\u7ebf\u7a0b\u3002\u53ef\u4ee5\u4f7f\u7528\u5982\u4e0b\u8bed\u53e5\u67e5\u770b\uff1a</p> <pre><code>select * from `performance_schema`.threads where type='FOREGROUND';\n\nSELECT * FROM `information_schema`.PROCESSLIST;\n\n\nSELECT \n    THREAD_ID AS 'MySQL\u7ebf\u7a0bID',\n    THREAD_OS_ID AS '\u64cd\u4f5c\u7cfb\u7edf\u7ebf\u7a0bID',\n    NAME AS  'NAME',\n    IF(TYPE = 'BACKGROUND', 'YES', '') AS \"\u662f\u5426\u540e\u53f0\u7ebf\u7a0b\" ,\n    PROCESSLIST_ID AS  \"\u8fde\u63a5ID\"\nFROM performance_schema.threads;\n</code></pre> <p>MySQL \u5185\u90e8\u5904\u7406\u7528\u6237\u8fde\u63a5\u7684\u7ebf\u7a0b\u8c03\u5ea6\u65b9\u5f0f\u7531 <code>thread_handling</code> \u53c2\u6570\u63a7\u5236\u3002\u4e25\u683c\u6765\u8bf4\u6709\u4e09\u79cd\uff1a</p> <ul> <li><code>no-threads</code>\uff0c\u5355\u7ebf\u7a0b\u5904\u7406\u6240\u6709\u7528\u6237\u8fde\u63a5\uff0c\u4e00\u822c\u5728\u8c03\u8bd5\u65f6\u4f7f\u7528\u3002</li> <li><code>one-thread-per-connection</code> \uff0c \u591a\u7ebf\u7a0b\u5904\u7406\u7528\u6237\u8fde\u63a5\uff0c\u4e00\u4e2a\u7ebf\u7a0b\u5bf9\u5e94\u4e00\u4e2a\u7528\u6237\u8fde\u63a5\uff0c\u4e5f\u662f <code>MySQL Community Server</code> \u9ed8\u8ba4\u7684\u8fde\u63a5\u5904\u7406\u65b9\u5f0f\u3002\u4e3b\u8981\u7531 <code>thread_handling</code> \u53c2\u6570\u914d\u7f6e\u3002</li> <li><code>Thread pool</code>, \u5728 Percona\uff0cMariaDB\uff0cOracle MySQL \u4f01\u4e1a\u7248\uff0c\u963f\u91cc\u4e91 polarDB\uff0c\u817e\u8baf\u6570\u636e\u5e93\u4e2d\u63d0\u4e2d\uff0c\u63d0\u4f9b\u4e86 \u7ebf\u7a0b\u6c60 \u7279\u6027\u3002</li> </ul> <p>\u5728 <code>one-thread-per-connection</code> \u60c5\u51b5\u4e0b\uff0c\u6bcf\u4e2a\u8fde\u63a5\u5206\u914d\u4e00\u4e2a\u7ebf\u7a0b\uff0c\u5f53\u5ba2\u6237\u7aef\u548c MySQL \u670d\u52a1\u5668\u5efa\u7acb TCP \u8fde\u63a5\u4e4b\u540e\uff0cMySQL \u670d\u52a1\u5668\u5c31\u4f1a\u7ed9\u8fd9\u4e2a\u8fde\u63a5\u5206\u914d\u4e00\u4e2a\u7ebf\u7a0b\uff0c\u5f53\u8fd9\u4e2a\u8fde\u63a5\u6536\u5230 SQL \u65f6\uff0c\u5bf9\u5e94\u7684\u7ebf\u7a0b\u5c31\u6267\u884c\u8fd9\u4e2a SQL\uff0c\u800c\u5f53 SQL \u6267\u884c\u7ed3\u675f\u540e\uff0c\u8fd9\u4e2a\u7ebf\u7a0b\u5c31\u53bb Sleep\uff0c\u7b49\u5f85\u5ba2\u6237\u7aef\u7684\u65b0\u8bf7\u6c42\u3002\u8fd9\u4e2a\u7ebf\u7a0b\u4f1a\u4e00\u76f4\u5b58\u6d3b\uff0c\u76f4\u5230\u5ba2\u6237\u7aef\u9000\u51fa\u767b\u5f55\u6216\u7ebf\u7a0b\u8d85\u65f6\u65ad\u5f00\uff08\u7531 wait_timeout \u6216 interactive_timeout \u53c2\u6570\u63a7\u5236\uff0c\uff09\uff0c\u5e76\u5173\u95ed\u8fde\u63a5\uff0c\u8fd9\u4e2a\u7ebf\u7a0b\u624d\u4f1a\u9000\u51fa\uff08\u6216\u8005\u8fdb\u5165 MySQL \u7684 ThreadCache\uff09\u3002</p> <p>\u8d85\u65f6\u53c2\u6570\uff0c\u8be6\u89c1 https://zhuanlan.zhihu.com/p/82554484</p> <p>MySQL \u8fde\u63a5\u65b9\u5f0f\u6709\u5f88\u591a\u79cd\uff0c\u533a\u5206 Unix \u7cfb\u7edf \u548c Windows \u7cfb\u7edf\u4ee5\u53ca\u901a\u7528\u7684\u8fde\u63a5\u65b9\u5f0f\uff0c\u5728\u8fd9\u91cc\u4ec5\u8bf4\u4e24\u79cd\u65b9\u5f0f\uff1a</p> <ul> <li> <p>\u4e00\u79cd\u4e3a <code>unix domain socket</code></p> </li> <li> <p>\u53e6\u5916\u4e00\u79cd\u4e3a\u57fa\u4e8e <code>tcp/ip</code> \u534f\u8bae\uff0c\u4e00\u822c\u6211\u4eec\u5982\u679c\u8fdc\u7a0b\u8bbf\u95ee\u6570\u636e\u5e93\u80af\u5b9a\u662f\u57fa\u4e8e <code>tcp/ip</code> \u7684\uff0c\u4f46\u662f\u5982\u679c\u6211\u4eec\u5728\u672c\u673a\u767b\u5f55\u5c31\u4f1a\u5206\u4e3a\u4f7f\u7528 socket \u8fd8\u662f tcp/ip\u3002</p> </li> </ul> <pre><code>Copysocket\uff1amysql -uroot -p\ntcp/ip\uff1amysql -h127.0.0.1 -uroot -p\n</code></pre> <p>\u5f53\u6570\u636e\u5e93\u670d\u52a1\u5668\u548c\u5e94\u7528\u670d\u52a1\u5668\u4f4d\u4e8e\u4e0d\u540c\u7684\u4e3b\u673a\u65f6\u5c31\u8981\u4f7f\u7528 tcp/ip \u7684\u65b9\u5f0f\u5efa\u7acb\u8fde\u63a5\u3002\u6bcf\u4e00\u4e2a\u8fde\u63a5\u5728\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u5360\u7528\u4e00\u4e2a\u7ebf\u7a0b\u6765\u7ef4\u62a4\u3002</p> <p>\u5efa\u7acb\u8fde\u63a5\u4e5f\u5206\u4e3a\u4e24\u7c7b\uff1a\u77ed\u8fde\u63a5**\u548c**\u957f\u8fde\u63a5\uff1a</p> <p>\u77ed\u8fde\u63a5</p> <p>\u6240\u8c13\u77ed\u8fde\u63a5\u5c31\u662f\u6307\u5e94\u7528\u7a0b\u5e8f\u548c\u6570\u636e\u5e93\u901a\u4fe1\u5b8c\u6bd5\u4e4b\u540e\u8fde\u63a5\u5173\u95ed\u3002\u8fd9\u79cd\u8fde\u63a5\u6bcf\u6b21\u7684\u64cd\u4f5c\u5c31\u662f\uff1a</p> <pre><code>\u53d1\u51fa\u8bf7\u6c42---&gt;\u5efa\u7acb\u8fde\u63a5---&gt;\u64cd\u4f5c\u6570\u636e---&gt;\u91ca\u653e\u8fde\u63a5\n</code></pre> <p>\u8fd9\u6837\u505a\u7684\u95ee\u9898\u662f\uff1a</p> <ol> <li> <p>\u9891\u7e41\u7684\u5efa\u7acb / \u91ca\u653e\u8fde\u63a5\u5bf9\u6570\u636e\u5e93\u6765\u8bf4\u589e\u52a0\u4e86\u7cfb\u7edf\u8d1f\u62c5\uff0c\u9891\u7e41\u521b\u5efa/\u9500\u6bc1\u7ebf\u7a0b**\u589e\u52a0\u6570\u636e\u5e93\u670d\u52a1\u5668 CPU \u4e0a\u4e0b\u6587\u5207\u6362\u5f00\u9500\uff0c\u5f71\u54cd\u6570\u636e\u5e93\u670d\u52a1\u5668\u6027\u80fd\u3002**\uff1b</p> </li> <li> <p>\u5e94\u7528\u7a0b\u5e8f\u6bcf\u6b21\u64cd\u4f5c\u6570\u636e\u5e93\u7684\u8fc7\u7a0b\u5c06\u4f1a\u53d8\u5f97\u5f88\u6162\uff0ctcp \u4e09\u6b21\u63e1\u624b\u56db\u6b21\u65ad\u5f00\u8981\u65f6\u95f4\u5f00\u9500\u7684\uff1b</p> </li> <li> <p>\u5e94\u7528\u7cfb\u7edf\u6bcf\u6b21\u5efa\u7acb\u8fde\u63a5\u90fd\u8981\u5360\u7528\u4e00\u4e2a\u7aef\u53e3\uff0c\u9891\u7e41\u7684\u5efa\u7acb/\u91ca\u653e\uff0c\u6bcf\u4e2a\u88ab\u91ca\u653e\u7684\u8fde\u63a5\u5728\u53d1\u51fa\u91ca\u653e\u8bf7\u6c42\u4e4b\u540e\u5e76\u4e0d\u662f\u9a6c\u4e0a\u5c31\u6267\u884c\uff0c\u5fc5\u987b\u7ecf\u5386\u4e00\u4e2a FIN \u9636\u6bb5\u7684\u7b49\u5f85\u76f4\u5230\u786e\u8ba4\u4e3a\u6b62\u3002\u6240\u4ee5\u5728\u6bcf\u79d2\u51e0\u5343\u6b21\u6570\u636e\u5e93\u8bf7\u6c42\u7684\u65f6\u5019\uff0c\u5e94\u7528\u670d\u52a1\u5668\u7aef\u53e3\u5f88\u6709\u53ef\u80fd\u88ab\u6d88\u8017\u5b8c\u3002</p> </li> </ol> <p>\u957f\u8fde\u63a5</p> <p>\u957f\u8fde\u63a5\u5373\u5728\u5efa\u7acb\u8fde\u63a5\u540e\u4e00\u76f4\u6253\u5f00\uff0c\u76f4\u5230\u5e94\u7528\u7a0b\u5e8f\u5173\u95ed\u624d\u91ca\u653e\u3002\u4f7f\u7528\u957f\u8fde\u63a5\u7684\u597d\u5904\u662f\u51cf\u5c11\u6bcf\u6b21\u521b\u5efa\u8fde\u63a5\u5e26\u6765\u7684\u5f00\u9500\u3002</p> <p>\u5bf9\u4e8e\u5ba2\u6237\u7aef\u6765\u8bf4\u7ef4\u6301\u957f\u8fde\u63a5\u7684\u597d\u5904\u4e0d\u8a00\u81ea\u660e\uff0c\u4f46\u662f\u5bf9\u4e8e\u6570\u636e\u5e93\u670d\u52a1\u5668\u6765\u8bf4\uff0c\u8fc7\u591a\u7684\u957f\u8fde\u63a5\u5219\u662f\u707e\u96be\u3002</p> <p>\u5982\u679c\u6ee5\u7528\u957f\u8fde\u63a5\u7684\u8bdd\uff0c\u53ef\u80fd\u4f1a\u4f7f\u7528\u8fc7\u591a\u7684 MySQL \u670d\u52a1\u5668\u8fde\u63a5\u3002\u73b0\u4ee3\u7684\u64cd\u4f5c\u7cfb\u7edf\u53ef\u4ee5\u62e5\u6709\u51e0\u5343\u4e2a MySQL \u8fde\u63a5\uff0c\u4f46\u5f88\u6709\u53ef\u80fd\u7edd\u5927\u90e8\u5206\u90fd\u662f\u7761\u7720\uff08sleep\uff09\u72b6\u6001\u7684\uff0c\u8fd9\u6837\u7684\u5de5\u4f5c\u65b9\u5f0f\u4e0d\u591f\u9ad8\u6548\uff0c\u800c\u4e14\u8fde\u63a5\u5360\u636e\u5185\u5b58\uff0c\u4e5f\u4f1a\u5bfc\u81f4\u5185\u5b58\u7684\u6d6a\u8d39\u3002</p> <p>MYSQL \u7684 TCP \u8fde\u63a5\u652f\u6301\u957f\u8fde\u63a5\uff0c\u6240\u4ee5\u6bcf\u6b21\u64cd\u4f5c\u5b8c\u6570\u636e\u5e93\uff0c\u53ef\u4ee5\u4e0d\u5fc5\u76f4\u63a5\u5173\u6389\u8fde\u63a5\uff0c\u800c\u662f\u7b49\u5f85\u4e0b\u6b21\u4f7f\u7528\u7684\u65f6\u5019\u5728\u590d\u7528\u8fd9\u4e2a\u8fde\u63a5\u3002</p> <p>\u6240\u6709\u7684 Socket \u957f\u8fde\u63a5\u90fd\u662f\u901a\u8fc7 TCP \u81ea\u5e26\u7684 ping \u6765\u7ef4\u6301\u5fc3\u8df3(TCP \u4fdd\u6d3b)\uff0c\u4ece\u800c\u4fdd\u6301\u8fde\u63a5\u72b6\u6001\uff0c\u800c\u6211\u4eec\u719f\u6089\u7684<code>websocket</code>,\u4e5f\u6b63\u662f\u901a\u8fc7 TCP \u7684\u5fc3\u8df3\u6765\u7ef4\u6301\u8fde\u63a5\u4e0d\u88ab\u4e2d\u65ad\u3002</p> <p>\u8fde\u63a5\u6c60</p> <p>\u957f\u8fde\u63a5\u7684\u597d\u5904\u8fd9\u4e48\u5927\uff0c\u81ea\u7136\u5927\u5bb6\u90fd\u7528\u957f\u8fde\u63a5\u3002\u6162\u6162\u5c31\u641e\u51fa\u4e00\u5957\u957f\u8fde\u63a5\u7ef4\u62a4\u7684\u5de5\u5177 - \u6570\u636e\u5e93\u8fde\u63a5\u6c60\u3002</p> <p>\u8bbe\u8ba1\u8fde\u63a5\u6c60\u4e5f\u6ca1\u6709\u591a\u4e48\u590d\u6742\uff0c\u5927\u81f4\u7684\u6b65\u9aa4\u5c31\u662f\uff1a</p> <ol> <li>\u521d\u59cb\u5316\u8fde\u63a5\uff1b</li> <li>\u4e1a\u52a1\u53d6\u51fa\u8fde\u63a5\uff1b</li> <li>\u4e1a\u52a1\u53d1\u9001\u8bf7\u6c42\uff1b</li> <li>\u653e\u56de\u8fde\u63a5\u3002</li> </ol> <p>\u9664\u4e86\u4e0a\u9762\u7684\u57fa\u672c\u529f\u80fd\u4ee5\u5916\uff0c\u8fd8\u8981\u5904\u7406\u5e76\u53d1\u95ee\u9898\uff0c\u591a\u6570\u636e\u5e93\u670d\u52a1\u5668\u548c\u591a\u7528\u6237\uff0c\u4e8b\u52a1\u5904\u7406\uff0c\u8fde\u63a5\u6c60\u7684\u914d\u7f6e\u4e0e\u7ef4\u62a4\u3002</p> <p>\u5927\u6982\u5c31\u8fd9\u4e9b\u529f\u80fd\u3002\u6709\u4e86\u8fde\u63a5\u6c60\uff08\u5728\u670d\u52a1\u7aef\uff0c\u6709\u65f6\u5019\u53eb\u7ebf\u7a0b\u6c60\uff09\u4e4b\u540e\uff0c\u8fde\u63a5\u7684\u5efa\u7acb\u548c\u91ca\u653e\u8ddf\u4e1a\u52a1\u5c31\u6ca1\u6709\u5173\u7cfb\uff0c\u4ea4\u7ed9\u4ea4\u63a5\u6c60\u6765\u7ef4\u62a4\u3002</p> <p>\u53c2\u8003</p> <p>\u5bf9\u6b64\uff0c\u7814\u53d1\u5de5\u7a0b\u5e08\u3001\u7cfb\u7edf\u8fd0\u7ef4\u5de5\u7a0b\u5e08\u3001DBA \u9700\u8981\u4fdd\u6301\u6c9f\u901a\uff0c\u786e\u5b9a\u5408\u7406\u7684\u8fde\u63a5\u7b56\u7565\uff0c\u5343\u4e07\u4e0d\u8981\u4e0d\u5047\u601d\u7d22\u5c31\u91c7\u7528\u957f\u8fde\u63a5\u3002</p> <p>MySQL \u7684\u6700\u5927\u8fde\u63a5\u6570\u7531 <code>max_connections</code> \u53c2\u6570\u63a7\u5236\uff0c\u5728 5.7 \u548c 8.0 \u4e2d\u9ed8\u8ba4\u662f 151\uff0c\u6700\u5927\u53ef\u4ee5\u8fbe\u5230 16384\uff082^14\uff09\u3002</p> <p>\u5bf9\u4e8e\u6d77\u91cf\u8fde\u63a5\u7684\u6570\u636e\u5e93\uff0c\u5982\u679c\u8bbe\u7f6e\u7684\u592a\u5c0f\uff0c\u8fde\u63a5\u6ee1\u4e86\u4e4b\u540e\u540e\u9762\u7684\u65b0\u8fde\u63a5\u5c31\u4f1a\u62a5<code>too many connections</code>\u3002</p> <p>MySQL Server \u5176\u5b9e\u9ed8\u8ba4\u5141\u8bb8\u7684\u6700\u5927\u5ba2\u6237\u7aef\u8fde\u63a5\u6570\u4e3a max_connections + 1 \uff0c\u8fd9\u5176\u4e2d\u989d\u5916\u53ef\u4ee5\u767b\u9646\u7684 1 \u4e00\u4e2a\u8fde\u63a5\u4ec5\u4ec5\u5141\u8bb8\u62e5\u6709 super \u6743\u9650\u7684\u7528\u6237\u8fdb\u884c\u8fde\u63a5\u3002</p> <p>MySQL \u5982\u6b64\u8bbe\u8ba1\u5176\u5b9e\u662f\u4e3a\u4e86\u5f53\u6570\u636e\u5e93\u51fa\u73b0\u8fde\u63a5\u6570\u6253\u6ee1\u7684\u60c5\u51b5\u4e0b\uff0c\u53ef\u4ee5\u4f7f\u7528\u540c\u65f6\u62e5\u6709 super\u3001process \u6743\u9650\u7684\u9ad8\u6743\u9650\u6570\u636e\u5e93\u8d26\u53f7\u767b\u9646\u6570\u636e\u5e93\uff0c\u5c06\u95ee\u9898\u4f1a\u8bdd\u6216\u8005\u4e00\u4e9b\u7a7a\u95f2\u8fde\u63a5\u8fdb\u884c kill\uff0c\u7d27\u6025\u5904\u7406\u6545\u969c\u3002\u6240\u4ee5\u901a\u5e38\u907f\u514d\u8ba9\u4e1a\u52a1\u8d26\u53f7\u5177\u5907 super \u548c process \u7684\u7ba1\u7406\u6743\u9650\u3002</p> <p>\u5728 MySQL8.0 \u91cc\uff0c\u5219\u5f15\u5165\u4e86 admin port \u7684\u6982\u5ff5\uff0c\u987e\u540d\u601d\u4e49\uff0c\u5c31\u662f\u5355\u72ec\u5f00\u4e00\u4e2a\u7aef\u53e3\u7ed9\u7ba1\u7406\u5458\u7528\uff0c\u8be5\u7279\u6027\u4ece 8.0.14 \u5f00\u59cb\u5f15\u5165\u3002\u8fd9\u4e2a\u9700\u8981\u5355\u72ec\u8bbe\u7f6e\u3002 \u53ef\u4ee5\u8bf4\u8fd9\u662f\u4e2a\u5bf9\u8fd0\u7ef4\u975e\u5e38\u6709\u7528\uff0c\u5173\u952e\u65f6\u5019\u53ef\u4ee5\u6551\u547d\u7684\u7279\u6027\u3002\u8fd9\u4e2a feature \u7531 facebook \u8d21\u732e\u7ed9\u4e0a\u6e38\u3002\u4e3b\u8981\u5305\u62ec\u4ee5\u4e0b\u51e0\u4e2a\u53c2\u6570\u8bbe\u7f6e\uff1a</p> <pre><code># admin_address: \u7528\u4e8e\u6307\u5b9a\u7ba1\u7406\u5458\u53d1\u8d77tcp\u8fde\u63a5\u7684\u4e3b\u673a\u5730\u5740\uff0c\u53ef\u4ee5\u662fipv4,ipv6, \u6216\u8005Host name\u7b49\u7b49\uff0c\u4f46\u53ea\u80fd\u63a5\u53d7\u4e00\u4e2aip\u5730\u5740\n# admin_port: \u662f\u7ba1\u7406\u5458\u7528\u6765\u8fde\u63a5\u7684\u7aef\u53e3\u53f7\uff0c\u9ed8\u8ba4\u662f33062\u3002\u6ce8\u610f\u5982\u679cadmin_address\u6ca1\u6709\u8bbe\u7f6e\u7684\u8bdd\uff0c\u8fd9\u4e2a\u7aef\u53e3\u53f7\u662f\u65e0\u6548\u7684\n# create_admin_listener_thread: \u662f\u5426\u521b\u5efa\u4e00\u4e2a\u5355\u72ec\u7684listener\u7ebf\u7a0b\u6765\u76d1\u542cadmin\u7684\u94fe\u63a5\u8bf7\u6c42\uff0c\u9ed8\u8ba4\u503c\u662f\u5173\u95ed\u7684\uff0c\u5373\u4f1a\u4f7f\u7528\u5df2\u6709\u7684\u76d1\u542c\u7ebf\u7a0b\u53bb\u76d1\u542cadmin\u8fde\u63a5\u3002\u8be5\u53c2\u6570\u540c\u6837\u9700\u8981admin_address\u6253\u5f00, \u5426\u5219\u6ca1\u6709\u4efb\u4f55\u5f71\u54cd\n\n# \u901a\u5e38\u5efa\u8bae\u8fd9\u6837\u8bbe\u7f6e\u3002\u8ba9mysql\u5185\u90e8\u5355\u72ec\u5f00\u542f\u4e00\u4e2alistener\u7ebf\u7a0b\u6765\u76d1\u542c127.0.0.0\u3002\u7d27\u6025\u60c5\u51b5\u8fde\u63a5\u7528\u6ee1\u4e86\uff0c\u53ef\u4ee5\u5728\u670d\u52a1\u5668\u4e0a\u672c\u5730\u7528\u7ba1\u7406\u7aef\u53e3\u8fde\u63a5\u3002\nadmin_address='localhost'\ncreate_admin_listener_thread=1\n\n\nmysql -u root -P 33062 --protocol tcp -p'zhtj6668182'\n</code></pre> <p>\u57fa\u4e8e\u6b64\uff0c\u6570\u636e\u5e93\u8d26\u53f7\u6743\u9650\u4e00\u5b9a\u8981\u505a\u597d\u660e\u786e\u7684\u89c4\u5212\uff0c\u4e1a\u52a1\u8d26\u53f7\u4ec5\u4ec5\u62e5\u6709\u5bf9\u5e94\u4e1a\u52a1\u6570\u636e\u5e93\u7684\u8bfb\u5199\u6743\u9650\u3001\u9ad8\u6743\u9650\u6570\u636e\u5e93\u8d26\u53f7\u7528\u4e8e\u8fd0\u7ef4\u7ba1\u7406\u3002</p> <p>MySQL \u5b98\u7f51\u7ed9\u51fa\u4e86\u4e00\u4e2a\u6700\u5927\u8fde\u63a5\u6570\u63a8\u8350\u8ba1\u7b97\u65b9\u5f0f\uff0c<code>Max_used_connections / max_connections * 100% \u2248 85%</code></p> <p>MySQL \u7684 \u72b6\u6001\u53d8\u91cf \u663e\u793a MySQL \u670d\u52a1\u5b9e\u4f8b\u7684\u8fd0\u884c\u72b6\u6001\u4fe1\u606f\uff0c\u8fd9\u4e9b\u72b6\u6001\u4fe1\u606f\u662f\u52a8\u6001\u7684\uff0c\u5305\u62ec MySQL \u670d\u52a1\u5668\u8fde\u63a5\u7684\u4f1a\u8bdd\u72b6\u6001\u3001\u53d8\u91cf\u4fe1\u606f\u7b49\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u72b6\u6001\u53d8\u91cf\u90fd\u662f\u4ee5\u5927\u5199\u5b57\u6bcd\u5f00\u5934\u3002</p> <pre><code>show status;\nshow session status;\nshow global status;\n</code></pre> \u72b6\u6001\u53d8\u91cf \u542b\u4e49 Connections \u72b6\u6001\u53d8\u91cf\uff1aMySQL \u670d\u52a1\u4ece\u521d\u59cb\u5316\u5f00\u59cb\u6210\u529f\u5efa\u7acb\u8fde\u63a5\u7684\u6570\u91cf\uff0c\u8be5\u503c\u4e0d\u65ad\u7d2f\u52a0 Max_used_connections \u72b6\u6001\u53d8\u91cf\uff1aMySQL \u670d\u52a1\u4ece\u542f\u52a8\u5f00\u59cb\uff0c\u540c\u4e00\u65f6\u523b\u5e76\u53d1\u8fde\u63a5\u7684\u6700\u5927\u503c\uff0c\u5982\u679c\u8be5\u503c\u5f88\u5927\uff0c\u5219\u6709\u53ef\u80fd\u7cfb\u7edf\u5e76\u53d1\u8f83\u9ad8\uff0c\u53ef\u4ee5\u8003\u8651\u8c03\u5927 max_connections Connection_errors_max_connections \u72b6\u6001\u53d8\u91cf\uff1a\u5f53 MySQL \u7684\u6700\u5927\u5e76\u53d1\u8fde\u63a5\u6570\u8d85\u8fc7\u8bbe\u7f6e\u7684 max_connections \u53d8\u91cf\u7684\u503c\uff0c\u88ab\u62d2\u7edd\u7684\u6b21\u6570\u4f1a\u8bb0\u5f55\u5230\u8fd9\u4e2a\u72b6\u6001\u503c\u91cc Threads_connected \u72b6\u6001\u53d8\u91cf\uff1a MySQL server \u5f53\u524d\u6253\u5f00\u7684\u8fde\u63a5\u6570"},{"location":"basic/9.mysql_architecture/#_7","title":"\u63a7\u5236\u53c2\u6570","text":"\u914d\u7f6e \u542b\u4e49 max_connections \u914d\u7f6e\u53c2\u6570\uff1a<code>MySQL server</code>\u5c42\u9762\u5bf9\u4e8e\u8fde\u63a5\u6570\u7684\u9650\u5236\u3002**\u603b\u7684\u6240\u6709\u8d26\u53f7\u4e00\u8d77**\u6700\u5927\u7684\u53ef\u8fde\u63a5\u7684\u6570\u91cf\uff0c\u9ed8\u8ba4 151\uff0c\u6700\u5927\u503c\u4e3a 100000 max_user_connections \u914d\u7f6e\u53c2\u6570\uff1a\u4ee3\u8868\u5141\u8bb8\u5355\u4e2a\u7528\u6237\u7684\u8fde\u63a5\u6570\u6700\u5927\u503c\uff0c\u5373\u5e76\u53d1\u503c\u3002\u9ed8\u8ba4\u4e3a 0\uff0c\u8868\u793a\u4e0d\u9650\u5236 wait_timeout \u914d\u7f6e\u53c2\u6570\uff1a\u5373 MySQL \u957f\u8fde\u63a5(\u975e\u4ea4\u4e92\u5f0f)\u7684\u6700\u5927\u751f\u547d\u65f6\u957f\uff0c\u9ed8\u8ba4\u662f 8 \u5c0f\u65f6\uff0c\u6839\u636e\u4e1a\u52a1\u7279\u70b9\u914d\u7f6e interactive_timeout \u914d\u7f6e\u53c2\u6570\uff1a\u5373 MySQL \u957f\u8fde\u63a5\u957f\u8fde\u63a5(\u4ea4\u4e92\u5f0f)\u7684\u6700\u5927\u751f\u547d\u65f6\u957f\uff0c\u9ed8\u8ba4\u662f 8 \u5c0f\u65f6\uff0c\u6839\u636e\u4e1a\u52a1\u7279\u70b9\u914d\u7f6e connect_timeout \u914d\u7f6e\u53c2\u6570\uff1a\u83b7\u53d6 MySQL \u8fde\u63a5\u662f\u591a\u6b21\u63e1\u624b\u7684\u7ed3\u679c\uff0c\u9664\u4e86\u7528\u6237\u540d\u548c\u5bc6\u7801\u7684\u5339\u914d\u6821\u9a8c\u5916\uff0c\u8fd8\u6709 IP-&gt;HOST-&gt;DNS-&gt;IP \u9a8c\u8bc1\uff0c\u4efb\u4f55\u4e00\u6b65\u90fd\u53ef\u80fd\u56e0\u4e3a\u7f51\u7edc\u95ee\u9898\u5bfc\u81f4\u7ebf\u7a0b\u963b\u585e\u3002\u4e3a\u4e86\u9632\u6b62\u7ebf\u7a0b\u6d6a\u8d39\u5728\u4e0d\u5fc5\u8981\u7684\u6821\u9a8c\u7b49\u5f85\u4e0a\uff0c\u8d85\u8fc7 connect_timeout \u7684\u8fde\u63a5\u8bf7\u6c42\u5c06\u4f1a\u88ab\u62d2\u7edd\u3002\u9ed8\u8ba4\u662f 10 \u79d2"},{"location":"basic/9.mysql_architecture/#_8","title":"\u7ebf\u7a0b\u7f13\u5b58","text":"<p>\u7ebf\u7a0b\u7f13\u5b58\u5b9e\u73b0\u5728<code>MySQL server</code>\u7aef\u3002\u5f53\u5ba2\u6237\u7aef\u65ad\u5f00\u4e4b\u540e\uff0c\u670d\u52a1\u5668\u5904\u7406\u6b64\u5ba2\u6237\u7684\u7ebf\u7a0b\u5c06\u4f1a\u7f13\u5b58\u8d77\u6765\u4ee5\u54cd\u5e94\u4e0b\u4e00\u4e2a\u5ba2\u6237\u7aef\u7684\u8fde\u63a5\uff08\u800c\u4e0d\u662f\u76f4\u63a5\u9500\u6bc1\u7ebf\u7a0b\uff0c\u5f53\u7136\u524d\u63d0\u662f\u7f13\u5b58\u6570\u672a\u8fbe\u4e0a\u9650\uff09\u3002</p> <p>\u7f13\u5b58\u7684\u7ebf\u7a0b\u6570\u91cf\u7531 thread_cache_size \u5927\u5c0f\u51b3\u5b9a\u3002</p> <p>\u5f53\u670d\u52a1\u5668\u4e0d\u65ad\u6709\u5927\u91cf\u8fde\u63a5\u521b\u5efa\u3001\u5173\u95ed\u7684\u573a\u666f\u4e0b\uff0c\u4f7f\u7528\u7ebf\u7a0b\u7f13\u5b58\u80fd\u591f\u91cd\u7528\u7f13\u5b58\u8d77\u6765\u7684\u7ebf\u7a0b\uff0c\u907f\u514d\u4e86\u5927\u91cf\u8fde\u63a5\u7ebf\u7a0b\u7684\u53cd\u590d\u521b\u5efa\u9500\u6bc1\u5e26\u6765\u7684 CPU \u4e0a\u4e0b\u6587\u5207\u6362\u6027\u80fd\u6d88\u8017\uff0c\u4f46\u662f\u4ecd\u7136\u65e0\u6cd5\u89e3\u51b3\u9ad8\u8fde\u63a5\u6570\u5e26\u6765\u7684\u7ebf\u7a0b\u6570\u8fc7\u9ad8\u7684\u95ee\u9898\u3002</p> <p>\u5982\u679c\u662f\u77ed\u8fde\u63a5\uff0c\u9002\u5f53\u8bbe\u7f6e\u5927\u4e00\u70b9\u3002\u56e0\u4e3a\u77ed\u8fde\u63a5\u5f80\u5f80\u9700\u8981\u4e0d\u505c\u521b\u5efa\uff0c\u4e0d\u505c\u9500\u6bc1\uff0c\u5982\u679c\u5927\u4e00\u70b9\uff0c\u8fde\u63a5\u7ebf\u7a0b\u90fd\u5904\u4e8e\u53d6\u7528\u72b6\u6001\uff0c\u4e0d\u9700\u8981\u91cd\u65b0\u521b\u5efa\u548c\u9500\u6bc1\uff0c\u6240\u4ee5\u5bf9\u6027\u80fd\u80af\u5b9a\u662f\u6bd4\u8f83\u5927\u7684\u63d0\u5347\u3002 \u5bf9 \u4e8e\u957f\u8fde\u63a5\uff0c\u4e0d\u80fd\u4fdd\u8bc1\u8fde\u63a5\u7684\u7a33\u5b9a\u6027\uff0c\u6240\u4ee5\u8bbe\u7f6e\u8fd9\u53c2\u6570\u8fd8\u662f\u6709\u4e00\u5b9a\u5fc5\u8981\uff0c\u53ef\u80fd\u8fde\u63a5\u6c60\u7684\u95ee\u9898\uff0c\u4f1a\u5bfc\u81f4\u8fde\u63a5\u6570\u636e\u5e93\u7684\u4e0d\u7a33\u5b9a\u6027\uff0c\u4e5f\u4f1a\u51fa\u73b0\u9891\u7e41\u7684\u521b\u5efa\u548c\u9500\u6bc1\uff0c\u4f46\u8fd9\u4e2a\u60c5\u51b5\u6bd4\u8f83\u5c11\uff0c\u5982\u679c\u662f\u957f\u8fde\u63a5\uff0c\u53ef\u4ee5\u8bbe\u7f6e\u6210\u5c0f\u4e00\u70b9\uff0c\u4e00\u822c\u5728 50-100 \u5de6\u53f3\u3002</p> <pre><code># \u67e5\u770b\u7ebf\u7a0b\u7f13\u5b58\u5927\u5c0f\nshow global variables like 'thread_cache_size';\n\n\n# thread_stack: \u6bcf\u4e2a\u8fde\u63a5\u7ebf\u7a0b\u88ab\u521b\u5efa\u65f6\uff0cMySQL\u7ed9\u5b83\u5206\u914d\u7684\u5185\u5b58\u5927\u5c0f\u3002\u5f53MySQL\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u8fde\u63a5\u7ebf\u7a0b\u65f6\uff0c\u9700\u8981\u7ed9\u5b83\u5206\u914d\u4e00\u5b9a\u5927\u5c0f\u7684\u5185\u5b58\u5806\u6808\u7a7a\u95f4\uff0c\u4ee5\u4fbf\u5b58\u653e\u5ba2\u6237\u7aef\u7684\u8bf7\u6c42\u7684Query\u53ca\u81ea\u8eab\u7684\u5404\u79cd\u72b6\u6001\u548c\u5904\u7406\u4fe1\u606f\u3002\n# Thread Stack \u9ed8\u8ba4\u503c\uff08192KB\uff09\u8db3\u591f\u6b63\u5e38\u8fd0\u884c\u3002\u5982\u679c\u7ebf\u7a0b\u5806\u6808\u5927\u5c0f\u592a\u5c0f\uff0c\u5219\u4f1a\u9650\u5236\u670d\u52a1\u5668\u53ef\u4ee5\u5904\u7406\u7684SQL\u8bed\u53e5\u7684\u590d\u6742\u6027\uff0c\u5b58\u50a8\u8fc7\u7a0b\u7684\u9012\u5f52\u6df1\u5ea6\u4ee5\u53ca\u5176\u4ed6\u6d88\u8017\u5185\u5b58\u7684\u64cd\u4f5c\u3002\n# \u4e00\u822c\u60c5\u51b5\u4e0b\u90fd\u80fd\u6b63\u5e38\u4f7f\u7528\uff0c\u4f46\u662f\u5f53\u67e5\u8be2\u8bed\u53e5\u6216\u8005\u5b58\u50a8\u8fc7\u7a0b\u590d\u6742\u65f6\u4f1a\u62a5Threadstack overrun\uff08\u8d85\u9650\uff09\u9519\u8bef\uff0c\u6b64\u65f6\u53ea\u8981\u4fee\u6539\u589e\u52a0\u9ed8\u8ba4\u914d\u7f6e\u5c31\u53ef\u4ee5\u4e86\nshow VARIABLES like 'thread_stack'\n\n# \u7cfb\u7edf\u542f\u52a8\u5230\u73b0\u5728\u5171\u63a5\u53d7\u5230\u5ba2\u6237\u7aef\u7684\u8fde\u63a5\u6b21\u6570\nshow status like 'connections'\n\n\n# \u53ef\u4ee5\u901a\u8fc7\u5982\u4e0b\u51e0\u4e2aMySQL\u72b6\u6001\u503c\u6765\u9002\u5f53\u8c03\u6574\u7ebf\u7a0b\u6c60\u7684\u5927\u5c0f\nshow global status like 'Threads_%';\n</code></pre> \u914d\u7f6e \u542b\u4e49 Threads_cached \u72b6\u6001\u53d8\u91cf\uff1a\u5f53\u524d\u7ebf\u7a0b\u6c60\u4e2d\u7f13\u5b58\u6709\u591a\u5c11\u7a7a\u95f2\u7ebf\u7a0b Threads_connected \u72b6\u6001\u53d8\u91cf\uff1a\u5f53\u524d\u7684\u8fde\u63a5\u6570 ( \u56e0\u4e3a\u4e00\u4e2a\u8fde\u63a5\u5c31\u9700\u8981\u4e00\u4e2a\u7ebf\u7a0b\uff0c\u6240\u4ee5\u4e5f\u53ef\u4ee5\u770b\u6210\u5f53\u524d\u88ab\u4f7f\u7528\u7684\u7ebf\u7a0b\u6570 ) Threads_created \u72b6\u6001\u53d8\u91cf\uff1a\u5f00\u542f\u4ee5\u6765\u7d2f\u8ba1\u5df2\u7ecf\u521b\u5efa\u8fc7\u7684\u7ebf\u7a0b\u603b\u6570 Threads_running \u72b6\u6001\u53d8\u91cf\uff1a\u5f53\u524d\u6fc0\u6d3b\u7684\u7ebf\u7a0b\u6570 ( Threads_connected \u4e2d\u7684\u7ebf\u7a0b\u6709\u4e9b\u53ef\u80fd\u5904\u4e8e\u4f11\u7720\u72b6\u6001 )"},{"location":"basic/9.mysql_architecture/#_9","title":"\u4e3b\u673a\u7f13\u5b58","text":"<p>MySQL \u670d\u52a1\u4f1a\u5728\u5185\u5b58\u4e2d\u7ef4\u62a4 <code>host cache</code> \uff0c<code>host cache</code> \u5305\u542b\u5f88\u591a\u5173\u4e8e**\u5ba2\u6237\u7aef**\u7684\u4fe1\u606f\uff1aIP\uff0c\u5730\u5740\uff0c\u4e3b\u673a\u540d\uff0c\u548c\u9519\u8bef\u4fe1\u606f\u3002</p> <p><code>host cache</code> \u7684\u5185\u5bb9\u662f\u516c\u5f00\u7684\uff0c\u53ef\u4ee5\u7528 <code>select</code> \u8bed\u53e5\u8fdb\u884c\u67e5\u8be2\uff0c\u4ee5\u4fbf\u8bca\u65ad\u5f53\u524d\u7684\u8fde\u63a5\u95ee\u9898.</p> <pre><code>select * from performance_schema.host_cache ;\n</code></pre> <p>\u63d0\u793a\uff1a</p> <p>host cache \u4ec5\u7528\u4e8e\u975e localhost \u7684 tcp \u8fde\u63a5\uff1a\u5bf9\u4e8e loopback \u73af\u56de\u5730\u5740\u7684 tcp \u8fde\u63a5\uff0c\u6216\u8005 socket file \u8fde\u63a5\uff0c\u547d\u540d\u7ba1\u9053\uff0c\u5171\u4eab\u5185\u5b58\u7b49\u3002</p> <p>\u6267\u884c flush hosts \u53ef\u4ee5\u5237\u65b0 host_cache\uff0c\u5237\u65b0\u540e\u4f1a\u6e05\u9664\u5185\u5b58\u4e2d\u7684\u4e3b\u673a\u7f13\u5b58</p> <ol> <li> <p>\u5f53\u6709\u4e00\u4e2a\u65b0\u7684\u5ba2\u6237\u7aef\u8fde\u63a5\u8fdb\u6765\u65f6\uff0cMySQL Server \u4f1a\u4e3a\u8fd9\u4e2a IP \u5728 host cache \u4e2d\u5efa\u7acb\u4e00\u4e2a\u65b0\u7684\u8bb0\u5f55\uff0c\u5305\u62ec IP\uff0c\u4e3b\u673a\u540d\u548c client lookup validation flag\uff0c\u5206\u522b\u5bf9\u5e94 host_cache \u8868\u4e2d\u7684 IP\uff0cHOST \u548c HOST_VALIDATED \u8fd9\u4e09\u5217\u3002\u7b2c\u4e00\u6b21\u5efa\u7acb\u8fde\u63a5\u56e0\u4e3a\u53ea\u6709 IP\uff0c\u6ca1\u6709\u4e3b\u673a\u540d\uff0c\u6240\u4ee5 HOST \u5c06\u8bbe\u7f6e\u4e3a NULL\uff0cHOST_VALIDATED \u5c06\u8bbe\u7f6e\u4e3a FALSE\u3002</p> </li> <li> <p>MySQL Server \u68c0\u6d4b HOST_VALIDATED \u7684\u503c\uff0c\u5982\u679c\u4e3a FALSE\uff0c\u5b83\u4f1a\u8bd5\u56fe\u8fdb\u884c**DNS \u53cd\u5411\u89e3\u6790**\uff0c\u5982\u679c\u89e3\u6790\u6210\u529f\uff0c\u5b83\u5c06\u66f4\u65b0 HOST \u7684\u503c\u4e3a\u4e3b\u673a\u540d\uff0c\u5e76\u5c06 HOST_VALIDATED \u503c\u8bbe\u4e3a TRUE\u3002\u5982\u679c\u6ca1\u6709\u89e3\u6790\u6210\u529f\uff0c\u5224\u65ad\u5931\u8d25\u7684\u539f\u56e0\u662f\u6c38\u4e45\u7684\u8fd8\u662f\u4e34\u65f6\u7684\uff0c\u5982\u679c\u662f\u6c38\u4e45\u7684\uff0c\u5219 HOST \u7684\u503c\u4f9d\u65e7\u4e3a NULL\uff0c\u4e14\u5c06 HOST_VALIDATED \u7684\u503c\u8bbe\u7f6e\u4e3a TRUE\uff0c\u540e\u7eed\u8fde\u63a5\u4e0d\u518d\u8fdb\u884c\u89e3\u6790\uff0c\u5982\u679c\u8be5\u539f\u56e0\u662f\u4e34\u65f6\u7684\uff0c\u5219 HOST_VALIDATED \u4f9d\u65e7\u4e3a FALSE\uff0c\u540e\u7eed\u8fde\u63a5\u4f1a\u518d\u6b21\u8fdb\u884c DNS \u89e3\u6790\u3002</p> </li> </ol> <p>\u89e3\u6790\u6210\u529f\u7684\u6807\u5fd7\u5e76\u4e0d\u53ea\u662f\u901a\u8fc7 IP\uff0c\u83b7\u53d6\u5230\u4e3b\u673a\u540d\u5373\u53ef\uff0c\u8fd9\u53ea\u662f\u5176\u4e2d\u4e00\u6b65\uff0c\u8fd8\u6709\u4e00\u6b65\u662f\u901a\u8fc7\u89e3\u6790\u540e\u7684\u4e3b\u673a\u540d\u6765\u53cd\u5411\u89e3\u6790\u4e3a IP\uff0c\u5224\u65ad\u8be5 IP \u662f\u5426\u4e0e\u539f IP \u76f8\u540c\uff0c\u5982\u679c\u76f8\u540c\uff0c\u624d\u5224\u65ad\u4e3a\u89e3\u6790\u6210\u529f\uff0c\u624d\u80fd\u66f4\u65b0 host cache \u4e2d\u7684\u4fe1\u606f\u3002</p> <p>\u7f3a\u70b9\uff1a\u5f53\u6709\u4e00\u4e2a\u65b0\u7684\u5ba2\u6237\u7aef\u8fde\u63a5\u8fdb\u6765\u65f6\uff0cMySQL Server \u90fd\u8981\u5efa\u7acb\u4e00\u4e2a\u65b0\u7684\u8bb0\u5f55\uff0c\u5982\u679c DNS \u89e3\u6790\u5f88\u6162\uff0c\u65e0\u7591\u4f1a\u5f71\u54cd\u6027\u80fd\u3002\u5982\u679c\u88ab\u5141\u8bb8\u8bbf\u95ee\u7684\u4e3b\u673a\u5f88\u591a\uff0c\u4e5f\u4f1a\u5f71\u54cd\u6027\u80fd\uff0c\u8fd9\u4e2a\u4e0e host_cache_size \u6709\u5173\uff0c\u8fd9\u4e2a\u53c2\u6570\u662f 5.6.5 \u5f15\u5165\u7684\u30025.6.8 \u4e4b\u524d\u9ed8\u8ba4\u662f 128,5.6.8 \u4e4b\u540e\u9ed8\u8ba4\u662f-1,\u57fa\u4e8e max_connections \u7684\u503c\u52a8\u6001\u8c03\u6574\u3002\u6240\u4ee5\u5982\u679c\u88ab\u5141\u8bb8\u8bbf\u95ee\u7684\u4e3b\u673a\u5f88\u591a\uff0c\u57fa\u4e8e LRU \u7b97\u6cd5\uff0c\u5148\u524d\u5efa\u7acb\u7684\u8fde\u63a5\u53ef\u80fd\u4f1a\u88ab\u6324\u6389\uff0c\u8fd9\u4e9b\u4e3b\u673a\u91cd\u65b0\u8fdb\u6765\u65f6\uff0c\u4f1a\u518d\u6b21\u8fdb\u884c DNS \u67e5\u8be2\u3002</p> <p>\u4f18\u70b9\uff1a\u901a\u5e38\u60c5\u51b5\u4e0b\uff0c\u4e3b\u673a\u540d\u662f\u4e0d\u53d8\u7684\uff0c\u800c IP \u662f\u591a\u53d8\u7684\u3002\u5982\u679c\u4e00\u4e2a\u5ba2\u6237\u7aef\u7684 IP \u7ecf\u5e38\u53d8\u5316\uff0c\u90a3\u57fa\u4e8e IP \u7684\u6388\u6743\u5c06\u662f\u4e00\u4e2a\u7e41\u7410\u7684\u8fc7\u7a0b\u3002\u56e0\u4e3a\u4f60\u5f88\u96be\u786e\u5b9a IP \u4ec0\u4e48\u65f6\u5019\u53d8\u5316\u3002\u800c\u57fa\u4e8e\u4e3b\u673a\u540d\uff0c\u53ea\u9700\u4e00\u6b21\u6388\u6743\u3002\u800c\u4e14\uff0c\u57fa\u4e8e host cache \u4e2d\u7684\u5931\u8d25\u4fe1\u606f\uff0c\u53ef\u5728\u4e00\u5b9a\u7a0b\u5ea6\u4e0a\u963b\u6b62\u5916\u754c\u7684\u66b4\u529b\u7834\u89e3\u653b\u51fb\u3002</p> <p>\u53c2\u8003</p>"},{"location":"basic/9.mysql_architecture/#mysql_4","title":"MySQL \u7ebf\u7a0b\u6c60","text":"<p>\u5728\u7ebf\u7a0b\u6c60\u65b9\u6848\u4e0b\uff0c\u901a\u5e38\u5728 MySQL server \u670d\u52a1\u7aef\u5b9e\u73b0\uff0cMySQL \u901a\u8fc7\u9884\u5148\u521b\u5efa\u4e00\u5b9a\u6570\u91cf\u7684\u7ebf\u7a0b\uff0c\u5728\u76d1\u542c\u5230\u6709\u65b0\u7684\u8bf7\u6c42\u65f6\uff0c\u7ebf\u7a0b\u6c60\u76f4\u63a5\u4ece\u73b0\u6709\u7684\u7ebf\u7a0b\u4e2d\u5206\u914d\u4e00\u4e2a\u7ebf\u7a0b\u6765\u63d0\u4f9b\u670d\u52a1\uff0c\u670d\u52a1\u7ed3\u675f\u540e\u8fd9\u4e2a\u7ebf\u7a0b\u4e0d\u4f1a\u76f4\u63a5\u9500\u6bc1\uff0c\u800c\u662f\u53c8\u53bb\u5904\u7406\u5176\u4ed6\u7684\u8bf7\u6c42\u3002</p> <p>\u8fd9\u6837\u5c31\u907f\u514d\u4e86\u7ebf\u7a0b\u548c\u5185\u5b58\u5bf9\u8c61\u9891\u7e41\u521b\u5efa\u548c\u9500\u6bc1\uff0c\u51cf\u5c11\u4e86\u4e0a\u4e0b\u6587\u5207\u6362\uff0c\u63d0\u9ad8\u4e86\u8d44\u6e90\u5229\u7528\u7387\uff0c\u4ece\u800c\u5728\u4e00\u5b9a\u7a0b\u5ea6\u4e0a\u63d0\u9ad8\u4e86\u7cfb\u7edf\u7684\u6027\u80fd\u548c\u7a33\u5b9a\u6027\u3002</p> <p>\u7ebf\u7a0b\u6c60\u6280\u672f\u9650\u5236\u4e86\u5e76\u53d1\u7ebf\u7a0b\u6570\uff0c\u76f8\u5f53\u4e8e\u9650\u5236\u4e86 MySQL \u7684 runing \u7ebf\u7a0b\u6570\uff0c\u65e0\u8bba\u7cfb\u7edf\u76ee\u524d\u6709\u591a\u5c11\u8fde\u63a5\u6216\u8005\u8bf7\u6c42\uff0c\u8d85\u8fc7\u6700\u5927\u8bbe\u7f6e\u7684\u7ebf\u7a0b\u6570\u7684\u90fd\u9700\u8981\u6392\u961f\uff0c\u8ba9\u7cfb\u7edf\u4fdd\u6301\u9ad8\u6027\u80fd\u6c34\u5e73\uff0c\u4ece\u800c\u9632\u6b62 DB \u51fa\u73b0\u96ea\u5d29\uff0c\u5bf9\u5e95\u5c42 DB \u8d77\u5230\u4fdd\u62a4\u4f5c\u7528\u3002</p> <p>\u5f00\u542f\u7ebf\u7a0b\u6c60\u540e\uff0c\u6c60\u4e2d\u4f1a\u591a\u4e2a\u7ebf\u7a0b\u7ec4\uff0c\u6bcf\u4e2a\u7ec4\u5185\u7684\u5404\u4e2a\u7ebf\u7a0b\u662f\u88ab\u590d\u7528\u7684\uff0c\u591a\u4e2a\u8fde\u63a5\u8f6e\u6d41\u88ab\u5c11\u91cf\u5de5\u4f5c\u7ebf\u7a0b\u5904\u7406\u3002</p> <p>\u7ebf\u7a0b\u6c60\u89e3\u51b3\u7684\u6838\u5fc3\u95ee\u9898\u5c31\u662f\u8d44\u6e90\u7ba1\u7406\u95ee\u9898\u3002\u5728\u5e76\u53d1\u73af\u5883\u4e0b\uff0c\u7cfb\u7edf\u4e0d\u80fd\u591f\u786e\u5b9a\u5728\u4efb\u610f\u65f6\u523b\u4e2d\uff0c\u6709\u591a\u5c11\u4efb\u52a1\u9700\u8981\u6267\u884c\uff0c\u6709\u591a\u5c11\u8d44\u6e90\u9700\u8981\u6295\u5165\u3002\u8fd9\u79cd\u4e0d\u786e\u5b9a\u6027\u5c06\u5e26\u6765\u4ee5\u4e0b\u82e5\u5e72\u95ee\u9898\uff1a</p> <ul> <li>\u9891\u7e41\u7533\u8bf7/\u9500\u6bc1\u8d44\u6e90\u548c\u8c03\u5ea6\u8d44\u6e90\uff0c\u5c06\u5e26\u6765\u989d\u5916\u7684\u6d88\u8017\uff0c\u53ef\u80fd\u4f1a\u975e\u5e38\u5de8\u5927\u3002</li> <li>\u5bf9\u8d44\u6e90\u65e0\u9650\u7533\u8bf7\u7f3a\u5c11\u6291\u5236\u624b\u6bb5\uff0c\u6613\u5f15\u53d1\u7cfb\u7edf\u8d44\u6e90\u8017\u5c3d\u7684\u98ce\u9669\u3002</li> <li>\u7cfb\u7edf\u65e0\u6cd5\u5408\u7406\u7ba1\u7406\u5185\u90e8\u7684\u8d44\u6e90\u5206\u5e03\uff0c\u4f1a\u964d\u4f4e\u7cfb\u7edf\u7684\u7a33\u5b9a\u6027\u3002</li> </ul> <p>\u4e3a\u89e3\u51b3\u8d44\u6e90\u5206\u914d\u8fd9\u4e2a\u95ee\u9898\uff0c\u7ebf\u7a0b\u6c60\u91c7\u7528\u4e86\u201c\u6c60\u5316\u201d\uff08Pooling\uff09\u601d\u60f3\u3002\u6c60\u5316\uff0c\u987e\u540d\u601d\u4e49\uff0c\u662f\u4e3a\u4e86\u6700\u5927\u5316\u6536\u76ca\u5e76\u6700\u5c0f\u5316\u98ce\u9669\uff0c\u800c\u5c06\u8d44\u6e90\u7edf\u4e00\u5728\u4e00\u8d77\u7ba1\u7406\u7684\u4e00\u79cd\u601d\u60f3\u3002</p> <p>Thread pool\uff0c\u5728 Percona\uff0cMariaDB\uff0cOracle MySQL \u4f01\u4e1a\u7248\uff0c\u4ee5\u53ca\u963f\u91cc\u4e91 polarDB \u4e2d\u63d0\u4e2d\uff0c\u63d0\u4f9b\u4e86**\u7ebf\u7a0b\u6c60**\u7279\u6027\u3002</p> <p>\u53ef\u4ee5\u601d\u8003\u4e00\u4e0b\uff0c\u7ebf\u7a0b\u6c60\u548c\u7ebf\u7a0b\u6c60\u6709\u4ec0\u4e48\u533a\u522b\u5462\uff1f\u7ebf\u7a0b\u6c60\u548c\u7ebf\u7a0b\u6c60\u6709\u4ec0\u4e48\u533a\u522b\u5462\uff1f</p> <ul> <li>\u76d1\u542c</li> </ul>"},{"location":"basic/9.mysql_architecture/#mysql_5","title":"MySQL \u8fde\u63a5\u6c60","text":"<p>MySQL \u8fde\u63a5\u6c60\uff0c\u8fde\u63a5\u6c60\u901a\u5e38\u5b9e\u73b0\u5728 client \u7aef\uff0c\u662f\u6307\u5e94\u7528(\u5ba2\u6237\u7aef)\u9884\u5148\u521b\u5efa\u4e00\u5b9a\u7684\u8fde\u63a5\uff0c\u5229\u7528\u8fd9\u4e9b\u8fde\u63a5\u670d\u52a1\u4e8e\u5ba2\u6237\u7aef\u6240\u6709\u7684 DB \u8bf7\u6c42\u3002\u5982\u679c\u67d0\u4e00\u4e2a\u65f6\u523b\uff0c\u7a7a\u95f2\u7684\u8fde\u63a5\u6570\u5c0f\u4e8e DB \u7684\u8bf7\u6c42\u6570\uff0c\u5219\u9700\u8981\u5c06\u8bf7\u6c42\u6392\u961f\uff0c\u7b49\u5f85\u7a7a\u95f2\u8fde\u63a5\u5904\u7406\u3002</p> <p>\u901a\u8fc7\u8fde\u63a5\u6c60\u7684\u8fde\u63a5\u590d\u7528\uff0c\u907f\u514d\u8fde\u63a5\u7684\u9891\u7e41\u521b\u5efa\u548c\u91ca\u653e\uff0c\u4ece\u800c\u51cf\u5c11\u8bf7\u6c42\u7684\u5e73\u5747\u54cd\u5e94\u65f6\u95f4\uff0c\u5e76\u4e14\u5728\u8bf7\u6c42\u7e41\u5fd9\u65f6\uff0c\u901a\u8fc7\u8bf7\u6c42\u6392\u961f\uff0c\u53ef\u4ee5\u7f13\u51b2\u5e94\u7528\u5bf9 DB \u7684\u51b2\u51fb\u3002\u5e38\u89c1\u7684 MySQL \u8fde\u63a5\u6c60 Tomcat\u3001WildFly(JBoss)\u3001 c3p0\u3001 Druid \u7b49\u3002</p> <p>\u5728\u5f88\u591a\u516c\u53f8\uff0c\u6709\u4e0d\u5c11\u7a0b\u5e8f\u5458\u5199\u4ee3\u7801\uff0c\u61d2\u5f97\u7528\u6570\u636e\u5e93\u8fde\u63a5\u6c60\uff0c\u6240\u4ee5\u5c31\u5728\u6bcf\u6b21\u6570\u636e\u64cd\u4f5c\u65f6\uff0c\u4e34\u65f6\u8fde\u63a5\u6570\u636e\u5e93\uff0c\u4f7f\u7528\u5b8c\u540e\u76f4\u63a5\u5173\u95ed\uff0c\u8fd9\u663e\u7136\u4e0d\u597d\u3002</p> <p>MySQL \u7ebf\u7a0b\u6c60\u4e0e\u8fde\u63a5\u6c60</p>"},{"location":"basic/9.mysql_architecture/#_10","title":"\u7ebf\u7a0b\u5904\u7406\u548c\u7ebf\u7a0b\u4e8b\u52a1","text":"<pre><code>-- \u67e5\u770b\u6240\u6709\u8fde\u63a5\u7ebf\u7a0b\uff0c\u5176\u4e2dID\u4e3a\u7ebf\u7a0bID\nSELECT * FROM information_schema.`PROCESSLIST`\n\n-- \u5728MySQL\u4e2d\u6709\u4e24\u4e2akill\u547d\u4ee4\uff1a\n-- \u4e00\u4e2a\u662fkill query +\u7ebf\u7a0bid\uff0c\u8868\u793a\u7ec8\u6b62\u8fd9\u4e2a\u7ebf\u7a0b\u4e2d\u6b63\u5728\u6267\u884c\u7684\u8bed\u53e5\uff1b\n-- \u4e00\u4e2a\u662fkill connection +\u7ebf\u7a0bid\uff0c\u8fd9\u91ccconnection\u53ef\u7f3a\u7701\uff0c\u8868\u793a\u65ad\u5f00\u8fd9\u4e2a\u7ebf\u7a0b\u7684\u8fde\u63a5\uff0c\u5f53\u7136\u5982\u679c\u8fd9\u4e2a\u7ebf\u7a0b\u6709\u8bed\u53e5\u6b63\u5728\u6267\u884c\uff0c\u4e5f\u662f\u8981\u5148\u505c\u6b62\u6b63\u5728\u6267\u884c\u7684\u8bed\u53e5\u7684\u3002\n\n-- \u7ecf\u5e38\u9047\u5230\u4f7f\u7528\u4e86kill\u547d\u4ee4\uff0c\u5374\u6ca1\u80fd\u65ad\u5f00\u8fd9\u4e2a\u8fde\u63a5\u3002\u518d\u6267\u884cshow processlist\u547d\u4ee4\uff0c\u770b\u5230\u8fd9\u6761\u8bed\u53e5\u7684Command\u5217\u663e\u793a\u7684\u662fKilled\n\n\n-- \u5927\u591a\u6570\u60c5\u51b5\u4e0b\uff0ckill query/connection \u547d\u4ee4\u662f\u6709\u6548\u7684\u3002\u6bd4\u5982\uff0c\u6267\u884c\u4e00\u4e2a\u67e5\u8be2\u7684\u8fc7\u7a0b\u4e2d\uff0c\u53d1\u73b0\u6267\u884c\u65f6\u95f4\u592a\u4e45\uff0c\u8981\u653e\u5f03\u7ee7\u7eed\u67e5\u8be2\uff0c\u8fd9\u65f6\u5c31\u53ef\u4ee5\u7528 kill query \u547d\u4ee4\uff0c\u7ec8\u6b62\u8fd9\u6761\u67e5\u8be2\u8bed\u53e5\u3002\u8fd8\u6709\u4e00\u79cd\u60c5\u51b5\u662f\uff0c\u8bed\u53e5\u5904\u4e8e\u9501\u7b49\u5f85\u7684\u65f6\u5019\uff0c\u76f4\u63a5\u4f7f\u7528 kill \u547d\u4ee4\u4e5f\u662f\u6709\u6548\u7684\u3002\n\n\n-- 1\u3001\u8d85\u5927\u4e8b\u52a1\u6267\u884c\u671f\u95f4\u88ab kill\u3002\u8fd9\u65f6\u5019\uff0c\u56de\u6eda\u64cd\u4f5c\u9700\u8981\u5bf9\u4e8b\u52a1\u6267\u884c\u671f\u95f4\u751f\u6210\u7684\u6240\u6709\u65b0\u6570\u636e\u7248\u672c\u505a\u56de\u6536\u64cd\u4f5c\uff0c\u8017\u65f6\u5f88\u957f\u3002\u5927\u67e5\u8be2\u56de\u6eda\u3002\u5982\u679c\u67e5\u8be2\u8fc7\u7a0b\u4e2d\u751f\u6210\u4e86\u6bd4\u8f83\u5927\u7684\u4e34\u65f6\u6587\u4ef6\uff0c\u52a0\u4e0a\u6b64\u65f6\u6587\u4ef6\u7cfb\u7edf\u538b\u529b\u5927\uff0c\u5220\u9664\u4e34\u65f6\u6587\u4ef6\u53ef\u80fd\u9700\u8981\u7b49\u5f85 IO \u8d44\u6e90\uff0c\u5bfc\u81f4\u8017\u65f6\u8f83\u957f\u3002\n\n\n-- 2\u3001DDL \u547d\u4ee4\u6267\u884c\u5230\u6700\u540e\u9636\u6bb5\uff0c\u5982\u679c\u88ab kill\uff0c\u9700\u8981\u5220\u9664\u4e2d\u95f4\u8fc7\u7a0b\u7684\u4e34\u65f6\u6587\u4ef6\uff0c\u4e5f\u53ef\u80fd\u53d7 IO \u8d44\u6e90\u5f71\u54cd\u8017\u65f6\u8f83\u4e45\u3002\n\n-- \u67e5\u770b\u4e8b\u52a1\u6267\u884c\u60c5\u51b5\uff0c\u5176\u4e2dtrx_id\u4e3a\u4e8b\u52a1ID\uff0ctrx_mysql_thread_id\u4e3a\u7ebf\u7a0bID\nSELECT * FROM information_schema.INNODB_TRX;\n\n\n-- \u751f\u4ea7\u73af\u5883\u8f83\u5e38\u89c1\u7684\u60c5\u51b5\u662f\uff0c\u7531\u4e8e\u6ca1\u6709\u6b63\u786e\u914d\u7f6eJDBC\u7b49\u9a71\u52a8\uff0c\u5bfc\u81f4\u4e1a\u52a1\u4ee3\u7801\u5df2\u7ecf\u8d85\u65f6\u9000\u51fa\u4e86\u4e0e\u6570\u636e\u5e93\u7684\u4ea4\u4e92\uff0c\u4f46\u662f\u6570\u636e\u5e93\u91cc\u4f9d\u65e7\u8fd0\u884c\u7740\u53d1\u8d77\u7684SQL\uff0c\u5982\u679c\u9891\u7e41\u53d1\u8d77\u91cd\u8bd5\uff0c\u5219\u6162SQL\u4f1a\u8d8a\u6765\u8d8a\u591a\uff0c\u5bfc\u81f4\u6570\u636e\u5e93\u8d1f\u8f7d\u9ad8\uff0c\u5f71\u54cd\u7a33\u5b9a\u6027\u53ca\u53ef\u7528\u6027\u3002\u56e0\u6b64\uff0c\u5efa\u8bae\u8bbe\u7f6e\u53c2\u6570max_execution_time\u6765\u89e3\u51b3\u8fd9\u79cd\u60c5\u51b5\u3002\u4f46\u662f\uff0c\u7531\u4e8e\u751f\u4ea7\u73af\u5883\u7684\u590d\u6742\u6027\uff0c\u9700\u8981\u8ddf\u5f00\u53d1\u4eba\u5458\u5148\u534f\u5546\uff0c\u53e6\u5916\uff0c\u8fd9\u4e2a\u503c\u53ef\u80fd\u9700\u8981\u8bbe\u7f6e\u7684\u76f8\u5bf9\u5927\u4e00\u4e9b\uff0c\u907f\u514d\u5f71\u54cd\u4e1a\u52a1\u3002\u603b\u4e4b\u6765\u8bf4\u662f\u8c28\u614e\u4f7f\u7528\u3002\n</code></pre> <p>\u6536\u5230 kill \u4ee5\u540e\uff0c\u7ebf\u7a0b\u505a\u4ec0\u4e48\uff1f</p> <p>\u5728\u5168\u5c40\u9501\u548c\u8868\u9501\u4e2d\uff0c\u5f53\u5bf9\u4e00\u4e2a\u8868\u505a\u589e\u5220\u6539\u67e5\u64cd\u4f5c\u65f6\uff0c\u4f1a\u5728\u8868\u4e0a\u52a0 MDL \u8bfb\u9501\u3002\u6240\u4ee5\uff0csession B \u867d\u7136\u5904\u4e8e blocked \u72b6\u6001\uff0c\u4f46\u8fd8\u662f\u62ff\u7740\u4e00\u4e2a MDL \u8bfb\u9501\u7684\u3002</p> <p>\u5982\u679c\u7ebf\u7a0b\u88ab kill \u7684\u65f6\u5019\uff0c\u5c31\u76f4\u63a5\u7ec8\u6b62\uff0c\u90a3\u4e4b\u540e\u8fd9\u4e2a MDL \u8bfb\u9501\u5c31\u6ca1\u673a\u4f1a\u88ab\u91ca\u653e\u4e86\u3002\u8fd9\u6837\u770b\u6765\uff0ckill \u5e76\u4e0d\u662f\u9a6c\u4e0a\u505c\u6b62\u7684\u610f\u601d\uff0c\u800c\u662f\u544a\u8bc9\u6267\u884c\u7ebf\u7a0b\u8bf4\uff0c\u8fd9\u6761\u8bed\u53e5\u5df2\u7ecf\u4e0d\u9700\u8981\u7ee7\u7eed\u6267\u884c\u4e86\uff0c\u53ef\u4ee5\u5f00\u59cb\u201c\u6267\u884c\u505c\u6b62\u7684\u903b\u8f91\u4e86\u201d\u3002</p> <p>\u5176\u5b9e\uff0c\u8fd9\u8ddf Linux \u7684 kill \u547d\u4ee4\u7c7b\u4f3c\uff0ckill -N pid \u5e76\u4e0d\u662f\u8ba9\u8fdb\u7a0b\u76f4\u63a5\u505c\u6b62\uff0c\u800c\u662f\u7ed9\u8fdb\u7a0b\u53d1\u4e00\u4e2a\u4fe1\u53f7\uff0c\u7136\u540e\u8fdb\u7a0b\u5904\u7406\u8fd9\u4e2a\u4fe1\u53f7\uff0c\u8fdb\u5165\u7ec8\u6b62\u903b\u8f91\u3002\u53ea\u662f\u5bf9\u4e8e MySQL \u7684 kill \u547d\u4ee4\u6765\u8bf4\uff0c\u4e0d\u9700\u8981\u4f20\u4fe1\u53f7\u91cf\u53c2\u6570\uff0c\u5c31\u53ea\u6709\u201c\u505c\u6b62\u201d\u8fd9\u4e2a\u547d\u4ee4\u3002</p> <ol> <li> <p>\u4e00\u4e2a\u8bed\u53e5\u6267\u884c\u8fc7\u7a0b\u4e2d\u6709\u591a\u5904\u201c\u57cb\u70b9\u201d\uff0c\u5728\u8fd9\u4e9b\u201c\u57cb\u70b9\u201d\u7684\u5730\u65b9\u5224\u65ad\u7ebf\u7a0b\u72b6\u6001\uff0c\u5982\u679c\u53d1\u73b0\u7ebf\u7a0b\u72b6\u6001\u662f THD::KILL_QUERY\uff0c\u624d\u5f00\u59cb\u8fdb\u5165\u8bed\u53e5\u7ec8\u6b62\u903b\u8f91\uff1b</p> </li> <li> <p>\u5982\u679c\u5904\u4e8e\u7b49\u5f85\u72b6\u6001\uff0c\u5fc5\u987b\u662f\u4e00\u4e2a\u53ef\u4ee5\u88ab\u5524\u9192\u7684\u7b49\u5f85\uff0c\u5426\u5219\u6839\u672c\u4e0d\u4f1a\u6267\u884c\u5230\u201c\u57cb\u70b9\u201d\u5904\uff1b</p> </li> <li> <p>\u8bed\u53e5\u4ece\u5f00\u59cb\u8fdb\u5165\u7ec8\u6b62\u903b\u8f91\uff0c\u5230\u7ec8\u6b62\u903b\u8f91\u5b8c\u5168\u5b8c\u6210\uff0c\u662f\u6709\u4e00\u4e2a\u8fc7\u7a0b\u7684\u3002</p> </li> </ol>"},{"location":"basic/9.mysql_architecture/#_11","title":"\u67e5\u8be2\u7f13\u5b58","text":"<p>MySQL \u7684\u67e5\u8be2\uff0c\u4e3b\u8981\u5904\u7406\u8fc7\u7a0b\u90fd\u662f\u4ece\u786c\u76d8\u4e2d\u8bfb\u53d6\u6570\u636e\u52a0\u8f7d\u5230\u5185\u5b58\uff0c\u7136\u540e\u901a\u8fc7\u7f51\u7edc\u53d1\u7ed9\u5ba2\u6237\u7aef\uff0c</p> <p>MySQL \u4ee5\u524d\u6709\u4e00\u4e2a\u67e5\u8be2\u7f13\u5b58 Query Cache\uff0c\u4ece MySQL8.0 \u5f00\u59cb\uff0c\u4e0d\u518d\u4f7f\u7528\u8fd9\u4e2a\u67e5\u8be2\u7f13\u5b58\uff0c\u968f\u7740\u6280\u672f\u7684\u8fdb\u6b65\uff0c\u7ecf\u8fc7\u65f6\u95f4\u7684\u8003\u9a8c\uff0cMySQL \u7684\u5de5\u7a0b\u56e2\u961f\u53d1\u73b0\u542f\u7528\u7f13\u5b58\u7684\u597d\u5904\u5e76\u4e0d\u591a\u3002\u6240\u4ee5\u5728 8.0 \u4e2d\u79fb\u9664\u4e86\u8fd9\u4e2a\u7279\u6027\u3002</p> <p>\u5728\u89e3\u6790\u4e00\u4e2a\u67e5\u8be2\u8bed\u53e5\u524d\uff0c\u5982\u679c\u67e5\u8be2\u7f13\u5b58\u662f\u6253\u5f00\u7684\uff0c\u90a3\u4e48 MySQL \u4f1a\u68c0\u67e5\u8fd9\u4e2a\u67e5\u8be2\u8bed\u53e5\u662f\u5426\u547d\u4e2d\u67e5\u8be2\u7f13\u5b58\u4e2d\u7684\u6570\u636e\u3002\u5982\u679c\u5f53\u524d\u67e5\u8be2\u6070\u597d\u547d\u4e2d\u67e5\u8be2\u7f13\u5b58\uff0c\u5728\u68c0\u67e5\u4e00\u6b21\u7528\u6237\u6743\u9650\u540e\u76f4\u63a5\u8fd4\u56de\u7f13\u5b58\u4e2d\u7684\u7ed3\u679c\u3002</p> <p>\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u67e5\u8be2\u4e0d\u4f1a\u88ab\u89e3\u6790\uff0c\u4e5f\u4e0d\u4f1a\u751f\u6210\u6267\u884c\u8ba1\u5212\uff0c\u66f4\u4e0d\u4f1a\u6267\u884c\u3002</p> <p>MySQL \u5c06\u7f13\u5b58\u5b58\u653e\u5728\u4e00\u4e2a\u5f15\u7528\u8868\uff08\u4e0d\u8981\u7406\u89e3\u6210 table\uff0c\u53ef\u4ee5\u8ba4\u4e3a\u662f\u7c7b\u4f3c\u4e8e HashMap \u7684\u6570\u636e\u7ed3\u6784\uff09\uff0c\u901a\u8fc7\u4e00\u4e2a\u54c8\u5e0c\u503c\u7d22\u5f15\uff0c\u8fd9\u4e2a\u54c8\u5e0c\u503c\u901a\u8fc7\u67e5\u8be2\u672c\u8eab\u3001\u5f53\u524d\u8981\u67e5\u8be2\u7684\u6570\u636e\u5e93\u3001\u5ba2\u6237\u7aef\u534f\u8bae\u7248\u672c\u53f7\u7b49\u4e00\u4e9b\u53ef\u80fd\u5f71\u54cd\u7ed3\u679c\u7684\u4fe1\u606f\u8ba1\u7b97\u5f97\u6765\u3002</p> <p>\u6240\u4ee5\u4e24\u4e2a\u67e5\u8be2\u5728\u4efb\u4f55\u5b57\u7b26\u4e0a\u7684\u4e0d\u540c\uff08\u4f8b\u5982\uff1a\u7a7a\u683c\u3001\u6ce8\u91ca\uff09\uff0c\u90fd\u4f1a\u5bfc\u81f4\u7f13\u5b58\u4e0d\u4f1a\u547d\u4e2d\u3002\u5982\u679c\u67e5\u8be2\u4e2d\u5305\u542b\u4efb\u4f55\u7528\u6237\u81ea\u5b9a\u4e49\u51fd\u6570\u3001\u5b58\u50a8\u51fd\u6570\u3001\u7528\u6237\u53d8\u91cf\u3001\u4e34\u65f6\u8868\u3001mysql \u5e93\u4e2d\u7684\u7cfb\u7edf\u8868\uff0c\u5176\u67e5\u8be2\u7ed3\u679c\u90fd\u4e0d\u4f1a\u88ab\u7f13\u5b58\u3002</p> <p>\u6bd4\u5982\u51fd\u6570 NOW() \u6216\u8005 CURRENT_DATE() \u4f1a\u56e0\u4e3a\u4e0d\u540c\u7684\u67e5\u8be2\u65f6\u95f4\uff0c\u8fd4\u56de\u4e0d\u540c\u7684\u67e5\u8be2\u7ed3\u679c\u3002\u518d\u6bd4\u5982\u5305\u542b CURRENT_USER \u6216\u8005 CONNECION_ID() \u7684\u67e5\u8be2\u8bed\u53e5\u4f1a\u56e0\u4e3a\u4e0d\u540c\u7684\u7528\u6237\u800c\u8fd4\u56de\u4e0d\u540c\u7684\u7ed3\u679c\uff0c\u5c06\u8fd9\u6837\u7684\u67e5\u8be2\u7ed3\u679c\u7f13\u5b58\u8d77\u6765\u6ca1\u6709\u4efb\u4f55\u7684\u610f\u4e49\u3002</p> <p>\u65e2\u7136\u662f\u7f13\u5b58\uff0c\u5c31\u4f1a\u5931\u6548\uff0c\u90a3\u67e5\u8be2\u7f13\u5b58\u4f55\u65f6\u5931\u6548\u5462\uff1f</p> <p>MySQL \u7684\u67e5\u8be2\u7f13\u5b58\u7cfb\u7edf\u4f1a\u8ddf\u8e2a\u67e5\u8be2\u4e2d\u6d89\u53ca\u7684\u6bcf\u4e2a\u8868\uff0c\u5982\u679c\u8fd9\u4e9b\u8868\uff08\u6570\u636e\u6216\u7ed3\u6784\uff09\u53d1\u751f\u53d8\u5316\uff0c\u90a3\u4e48\u548c\u8fd9\u5f20\u8868\u76f8\u5173\u7684\u6240\u6709\u7f13\u5b58\u6570\u636e\u90fd\u5c06\u5931\u6548\u3002</p> <p>\u6b63\u56e0\u4e3a\u5982\u6b64\uff0c\u5728\u4efb\u4f55\u7684\u5199\u64cd\u4f5c\u65f6\uff0cMySQL \u5fc5\u987b\u5c06\u5bf9\u5e94\u8868\u7684\u6240\u6709\u7f13\u5b58\u90fd\u8bbe\u7f6e\u4e3a\u5931\u6548\u3002\u5982\u679c\u67e5\u8be2\u7f13\u5b58\u975e\u5e38\u5927\u6216\u8005\u788e\u7247\u5f88\u591a\uff0c\u8fd9\u4e2a\u64cd\u4f5c\u5c31\u53ef\u80fd\u5e26\u6765\u5f88\u5927\u7684\u7cfb\u7edf\u6d88\u8017\uff0c\u751a\u81f3\u5bfc\u81f4\u7cfb\u7edf\u50f5\u6b7b\u4e00\u4f1a\u513f\u3002</p> <p>\u800c\u4e14\u67e5\u8be2\u7f13\u5b58\u5bf9\u7cfb\u7edf\u7684\u989d\u5916\u6d88\u8017\u4e5f\u4e0d\u4ec5\u4ec5\u5728\u5199\u64cd\u4f5c\uff0c\u8bfb\u64cd\u4f5c\u4e5f\u4e0d\u4f8b\u5916\uff1a</p> <ol> <li>\u4efb\u4f55\u7684\u67e5\u8be2\u8bed\u53e5\u5728\u5f00\u59cb\u4e4b\u524d\u90fd\u5fc5\u987b\u7ecf\u8fc7\u68c0\u67e5\uff0c\u5373\u4f7f\u8fd9\u6761 SQL \u8bed\u53e5\u6c38\u8fdc\u4e0d\u4f1a\u547d\u4e2d\u7f13\u5b58</li> <li>\u5982\u679c\u67e5\u8be2\u7ed3\u679c\u53ef\u4ee5\u88ab\u7f13\u5b58\uff0c\u90a3\u4e48\u6267\u884c\u5b8c\u6210\u540e\uff0c\u4f1a\u5c06\u7ed3\u679c\u5b58\u5165\u7f13\u5b58\uff0c\u4e5f\u4f1a\u5e26\u6765\u989d\u5916\u7684\u7cfb\u7edf\u6d88\u8017</li> </ol> <p>\u9996\u5148\uff0c\u67e5\u8be2\u7f13\u5b58\u7684\u6548\u679c\u53d6\u51b3\u4e8e\u7f13\u5b58\u7684\u547d\u4e2d\u7387\uff0c\u53ea\u6709\u547d\u4e2d\u7f13\u5b58\u7684\u67e5\u8be2\u6548\u679c\u624d\u80fd\u6709\u6539\u5584\uff0c\u56e0\u6b64\u65e0\u6cd5\u9884\u6d4b\u5176\u6027\u80fd\u3002</p> <p>\u5176\u6b21\uff0c\u67e5\u8be2\u7f13\u5b58\u7684\u53e6\u4e00\u4e2a\u5927\u95ee\u9898\u662f\u5b83\u53d7\u5230\u5355\u4e2a\u4e92\u65a5\u9501\u7684\u4fdd\u62a4\u3002\u5728\u5177\u6709\u591a\u4e2a\u5185\u6838\u7684\u670d\u52a1\u5668\u4e0a\uff0c\u5927\u91cf\u67e5\u8be2\u4f1a\u5bfc\u81f4\u5927\u91cf\u7684\u4e92\u65a5\u9501\u4e89\u7528\u3002</p> <p>\u901a\u8fc7\u57fa\u51c6\u6d4b\u8bd5\u53d1\u73b0\uff0c\u5927\u591a\u6570\u5de5\u4f5c\u8d1f\u8f7d\u6700\u597d\u7981\u7528\u67e5\u8be2\u7f13\u5b58\uff085.6 \u7684\u9ed8\u8ba4\u8bbe\u7f6e\uff09\uff1aquery_cache_type = 0</p> <p>\u5982\u679c\u4f60\u8ba4\u4e3a\u4f1a\u4ece\u67e5\u8be2\u7f13\u5b58\u4e2d\u83b7\u5f97\u597d\u5904\uff0c\u8bf7\u6309\u7167\u5b9e\u9645\u60c5\u51b5\u8fdb\u884c\u6d4b\u8bd5\u3002</p> <ul> <li>\u6570\u636e\u5199\u7684\u8d8a\u591a\uff0c\u597d\u5904\u8d8a\u5c11</li> <li>\u7f13\u51b2\u6c60\u4e2d\u5bb9\u7eb3\u7684\u6570\u636e\u8d8a\u591a\uff0c\u597d\u5904\u8d8a\u5c11</li> <li>\u67e5\u8be2\u8d8a\u590d\u6742\uff0c\u626b\u63cf\u8303\u56f4\u8d8a\u5927\uff0c\u5219\u8d8a\u53d7\u76ca</li> </ul> <p>\u6700\u540e\u7684\u5fe0\u544a\u662f\u4e0d\u8981\u8f7b\u6613\u6253\u5f00\u67e5\u8be2\u7f13\u5b58\uff0c\u7279\u522b\u662f\u5199\u5bc6\u96c6\u578b\u5e94\u7528\u3002</p> <p>\u5982\u679c\u4f60\u5b9e\u5728\u662f\u5fcd\u4e0d\u4f4f\uff0c\u53ef\u4ee5\u5c06 query_cache_type \u8bbe\u7f6e\u4e3a DEMAND\uff0c\u8fd9\u65f6\u53ea\u6709\u52a0\u5165 SQL_CACHE \u7684\u67e5\u8be2\u624d\u4f1a\u8d70\u7f13\u5b58\uff0c\u5176\u4ed6\u67e5\u8be2\u5219\u4e0d\u4f1a\uff0c\u8fd9\u6837\u53ef\u4ee5\u975e\u5e38\u81ea\u7531\u5730\u63a7\u5236\u54ea\u4e9b\u67e5\u8be2\u9700\u8981\u88ab\u7f13\u5b58\u3002</p> <p>\u5bf9\u4e8e\u4e00\u4e9b\u70ed\u70b9\u6570\u636e\uff0c\u73b0\u5728\u6bd4\u8f83\u6d41\u884c\u7684\u505a\u6cd5\u662f\u5f15\u5165\u5916\u90e8\u7684\u7f13\u5b58\u4e2d\u95f4\u4ef6\uff0c\u6bd4\u5982 redis \u7b49\uff0c\u8fd9\u4e2a\u4ee5\u540e\u5c55\u5f00\u518d\u8bb2\u3002</p>"},{"location":"basic/9.mysql_architecture/#_12","title":"\u8bed\u6cd5\u89e3\u6790\u548c\u67e5\u8be2\u5904\u7406","text":"<p>MySQL \u901a\u8fc7\u5173\u952e\u5b57\u5c06 SQL \u8bed\u53e5\u8fdb\u884c\u89e3\u6790\uff0c\u5e76\u751f\u6210\u4e00\u9897\u5bf9\u5e94\u7684\u89e3\u6790\u6811\u3002\u8fd9\u4e2a\u8fc7\u7a0b\u89e3\u6790\u5668\u4e3b\u8981\u901a\u8fc7\u8bed\u6cd5\u89c4\u5219\u6765\u9a8c\u8bc1\u548c\u89e3\u6790\u3002</p> <p>\u6bd4\u5982 SQL \u4e2d\u662f\u5426\u4f7f\u7528\u4e86\u9519\u8bef\u7684\u5173\u952e\u5b57\u6216\u8005\u5173\u952e\u5b57\u7684\u987a\u5e8f\u662f\u5426\u6b63\u786e\u7b49\u7b49\u3002\u9884\u5904\u7406\u5219\u4f1a\u6839\u636e MySQL \u89c4\u5219\u8fdb\u4e00\u6b65\u68c0\u67e5\u89e3\u6790\u6811\u662f\u5426\u5408\u6cd5\u3002\u6bd4\u5982\u68c0\u67e5\u8981\u67e5\u8be2\u7684\u6570\u636e\u8868\u548c\u6570\u636e\u5217\u662f\u5426\u5b58\u5728\u7b49\u7b49\u3002</p> <p>SQL \u89e3\u6790\u4e0e\u4f18\u5316\u662f\u5c5e\u4e8e\u7f16\u8bd1\u5668\u7f16\u8bd1\u539f\u7406\u65b9\u9762\u7684\u77e5\u8bc6\uff0c\u4e0e C \u8bed\u8a00\u8fd9\u7c7b\u7f16\u7a0b\u8bed\u8a00\u7684\u89e3\u6790\u4e0a\u662f\u7c7b\u4f3c\u7684\u3002SQL \u89e3\u6790\u4e3b\u8981\u5305\u542b\uff1a\u8bcd\u6cd5\u5206\u6790\u3001\u8bed\u4e49\u8bed\u6cd5\u5206\u6790\u3001\u4f18\u5316\u548c\u6267\u884c\u4ee3\u7801\u751f\u6210\u3002</p> <ul> <li> <p>\u8bcd\u6cd5\u5206\u6790 Lexical Analysis\uff1a\u5c06\u7528\u6237\u8f93\u5165\u7684 SQL \u8bed\u53e5\u62c6\u89e3\u6210\u5355\u8bcd(Token)\u5e8f\u5217\uff0c\u5e76\u8bc6\u522b\u51fa\u5173\u952e\u5b57\u3001\u6807\u8bc6\u3001\u5e38\u91cf\u7b49\u3002</p> </li> <li> <p>\u8bed\u6cd5\u5206\u6790 Syntax Analysis\uff1a\u5206\u6790\u5668\u5bf9\u8bcd\u6cd5\u5206\u6790\u5668\u89e3\u6790\u51fa\u6765\u7684\u5355\u8bcd(Token)\u5e8f\u5217\u5728\u8bed\u6cd5\u4e0a\u662f\u5426\u6ee1\u8db3 SQL \u8bed\u6cd5\u89c4\u5219\u3002\u6784\u5efa\u4e00\u9897\u8bed\u6cd5\u5206\u6790\u6811\u3002</p> </li> <li> <p>\u8bed\u4e49\u5206\u6790 Semantic Analysis\uff1a\u8bed\u4e49\u5206\u6790\u662f SQL \u89e3\u6790\u8fc7\u7a0b\u7684\u4e00\u4e2a\u903b\u8f91\u9636\u6bb5\uff0c\u4e3b\u8981\u4efb\u52a1\u662f\u5728\u8bed\u6cd5\u6b63\u786e\u7684\u57fa\u7840\u4e0a\u8fdb\u884c\u4e0a\u4e0b\u6587\u6709\u5173\u6027\u8d28\u7684\u5ba1\u67e5\uff0c\u5728 SQL \u89e3\u6790\u8fc7\u7a0b\u4e2d\u8be5\u9636\u6bb5\u5b8c\u6210\u8868\u540d\u3001\u64cd\u4f5c\u7b26\u3001\u7c7b\u578b\u7b49\u5143\u7d20\u7684\u5408\u6cd5\u6027\u5224\u65ad\uff0c\u540c\u65f6\u68c0\u6d4b\u8bed\u4e49\u4e0a\u7684\u4e8c\u4e49\u6027\u3002</p> </li> </ul> <p>SQL \u89e3\u6790\u7531\u8bcd\u6cd5\u5206\u6790\u548c\u8bed\u6cd5\u3001\u8bed\u4e49\u5206\u6790\u4e24\u4e2a\u90e8\u5206\u7ec4\u6210\u3002\u8bcd\u6cd5\u5206\u6790\u4e3b\u8981\u662f\u628a\u8f93\u5165\u8f6c\u5316\u6210\u82e5\u5e72\u4e2a Token\uff0c\u5176\u4e2d Token \u5305\u542b key \u548c\u975e key\u3002\u6bd4\u5982\uff0c\u4e00\u4e2a\u7b80\u5355\u7684 SQL \u5982\u4e0b\u6240\u793a\uff1a</p> <pre><code>SELECT age FROM user\n</code></pre>"},{"location":"basic/9.mysql_architecture/#_13","title":"\u67e5\u8be2\u4f18\u5316","text":"<p>\u7ecf\u8fc7\u524d\u9762\u7684\u6b65\u9aa4\u751f\u6210\u7684\u8bed\u6cd5\u6811\u88ab\u8ba4\u4e3a\u662f\u5408\u6cd5\u7684\u4e86\uff0c\u5e76\u4e14\u7531\u4f18\u5316\u5668\u5c06\u5176\u8f6c\u5316\u6210\u67e5\u8be2\u8ba1\u5212\u3002</p>"},{"location":"basic/9.mysql_architecture/#_14","title":"\u4f18\u5316\u5668\u6982\u8ff0","text":"<p>\u4e3a\u4ec0\u4e48\u6570\u636e\u5e93\u8981\u8fdb\u884c\u67e5\u8be2\u4f18\u5316\uff1f\u201d</p> <p>\u4e0d\u6b62\u662f\u6570\u636e\u5e93\u8981\u8fdb\u884c\u4f18\u5316\uff0c\u57fa\u672c\u4e0a\u6240\u6709\u7684\u7f16\u7a0b\u8bed\u8a00\u5728\u7f16\u8bd1\u7684\u65f6\u5019\u90fd\u8981\u4f18\u5316\u3002</p> <p>\u6bd4\u5982\u5728\u7f16\u8bd1 C \u8bed\u8a00\u7684\u65f6\u5019\uff0c\u53ef\u4ee5\u901a\u8fc7\u7f16\u8bd1\u9009\u9879 -o \u6765\u6307\u5b9a\u8fdb\u884c\u54ea\u4e2a\u7ea7\u522b\u7684\u4f18\u5316\uff0c\u53ea\u662f\u67e5\u8be2\u6570\u636e\u5e93\u7684\u67e5\u8be2\u4f18\u5316\u548c C \u8bed\u8a00\u7684\u4f18\u5316\u8fd8\u6709\u4e9b\u533a\u522b\u3002</p> <p>C \u8bed\u8a00\u662f\u8fc7\u7a0b\u5316\u8bed\u8a00\uff0c\u5df2\u7ecf\u6307\u5b9a\u597d\u4e86\u9700\u8981\u6267\u884c\u7684\u6bcf\u4e00\u4e2a\u6b65\u9aa4\uff1b\u4f46 SQL \u662f\u63cf\u8ff0\u6027\u8bed\u8a00\uff0c\u53ea\u6307\u5b9a\u4e86 WHAT\uff0c\u800c\u6ca1\u6709\u6307\u5b9a HOW \u3002\u8fd9\u6837\u5b83\u7684\u4f18\u5316\u7a7a\u95f4\u5c31\u5927\u4e86\u3002</p> <p>\u67e5\u8be2\u4f18\u5316\u7684\u52a8\u673a\uff1f</p> <p>\u540c\u4e00\u6761\u67e5\u8be2\u53ef\u4ee5\u8f6c\u6362\u4e3a\u591a\u4e2a\u903b\u8f91\u7b49\u4ef7\u7684\u6267\u884c\u8ba1\u5212\uff0c\u9996\u5148\u8fd9\u4e9b\u4e0d\u540c\u7684\u903b\u8f91\u6267\u884c\u8ba1\u5212\u5728\u6267\u884c\u6548\u7387\u4e0a\u5b58\u5728\u5dee\u5f02\uff0c\u5176\u6b21\u540c\u4e00\u4e2a\u903b\u8f91\u7b97\u5b50\u5728\u6570\u636e\u5e93\u4e2d\u6709\u591a\u79cd\u4e0d\u540c\u7684\u7269\u7406\u5b9e\u73b0\u65b9\u5f0f\uff0c\u800c\u4e0d\u540c\u573a\u666f\u4e0b\u4e0d\u540c\u7684\u7269\u7406\u5b9e\u73b0\u65b9\u5f0f\u7684\u6548\u7387\u4e5f\u5b58\u5728\u5dee\u5f02\u3002\u6240\u4ee5\u67e5\u8be2\u4f18\u5316\u7684\u6838\u5fc3\u76ee\u7684\u5176\u5b9e\u5c31\u662f \u627e\u5230\u6027\u80fd\u66f4\u597d\u7684\u6267\u884c\u8ba1\u5212</p> <p>\u67e5\u8be2\u4f18\u5316\u7684\u8f93\u5165\u4e3a\u67e5\u8be2\u6811\uff0c\u5bf9\u67e5\u8be2\u6811\u4f9d\u6b21\u4ece \u903b\u8f91 \u548c \u7269\u7406 \u4e24\u4e2a\u5c42\u9762\u8fdb\u884c\u4f18\u5316\uff0c\u6700\u7ec8\u8f93\u51fa\u662f\u67e5\u8be2\u7684\u7269\u7406\u6267\u884c\u8ba1\u5212\u3002</p> <p>\u67e5\u8be2\u4f18\u5316\u4e3b\u8981\u6709\u4e09\u4e2a\u91cd\u8981\u7684\u8fc7\u7a0b\uff1a</p> <ul> <li>\u903b\u8f91\u4f18\u5316   \u903b\u8f91\u4f18\u5316\u7684\u8f93\u5165\u662f\u67e5\u8be2\u6811\uff0c\u8f93\u51fa\u662f\u7ecf\u8fc7\u903b\u8f91\u4f18\u5316\u540e\u7684\u67e5\u8be2\u6811\u3002\u903b\u8f91\u4f18\u5316\u662f\u627e\u51fa\u4e0e\u67e5\u8be2\u7b49\u4ef7\u4f46\u6267\u884c\u6548\u7387\u66f4\u9ad8\u7684\u5173\u7cfb\u4ee3\u6570\u8868\u8fbe\u5f0f\u3002   \u5b9e\u73b0\u903b\u8f91\u4f18\u5316\u7684\u65b9\u6cd5\u4e3b\u8981\u662f \u67e5\u8be2\u91cd\u5199 \uff0c\u6839\u636e\u7279\u5b9a\u7684\u91cd\u5199\u89c4\u5219\u5bf9\u67e5\u8be2\u6811\u505a\u903b\u8f91\u7b49\u4ef7\u53d8\u5316\u3002</li> <li> <p>\u4ee3\u4ef7\u4f30\u8ba1   \u7ecf\u8fc7\u903b\u8f91\u4f18\u5316\u8fc7\u7a0b\uff0c\u53ef\u4ee5\u5f97\u5230\u57fa\u4e8e\u7b49\u4ef7\u89c4\u5219\u91cd\u5199\u8fc7\u7684\u903b\u8f91\u6267\u884c\u8ba1\u5212\u3002\u5c06\u903b\u8f91\u6267\u884c\u6267\u884c\u8f6c\u6362\u4e3a\u5b9e\u9645\u6267\u884c\u7684\u7269\u7406\u8ba1\u5212\u524d\uff0c\u8fd8\u9700\u8981\u786e\u8ba4\u5404\u79cd\u5177\u4f53\u5b9e\u73b0\u65b9\u5f0f\uff1a   \u6bd4\u5982\uff0c\u4e24\u8868\u8fde\u63a5\u65f6\u5e94\u8be5\u5177\u4f53\u91c7\u7528\u4f55\u79cd\u8fde\u63a5\u7b97\u6cd5\uff0c\u591a\u8868\u8fde\u63a5\u65f6\u8fd8\u9700\u8981\u786e\u5b9a\u8868\u4e4b\u95f4\u7684\u8fde\u63a5\u987a\u5e8f\u3002</p> </li> <li> <p>\u7269\u7406\u4f18\u5316   \u7269\u7406\u5c42\u9762\u7684\u4f18\u5316\u5219\u662f\u679a\u4e3e\u5404\u79cd\u7269\u7406\u6267\u884c\u8ba1\u5212\uff0c\u6839\u636e\u4ee3\u4ef7\u4f30\u8ba1\u6a21\u578b\u62e9\u51fa\u4ee3\u4ef7\u6700\u5c0f\u7684\u7269\u7406\u6267\u884c\u8ba1\u5212.</p> </li> </ul> <p>\u5173\u7cfb\u6f14\u7b97\u662f\u7eaf\u63cf\u8ff0\u6027\u7684\u8bed\u8a00\uff0c\u5173\u7cfb\u4ee3\u6570\u5305\u542b\u4e86\u4e00\u4e9b\u57fa\u672c\u7684\u5173\u7cfb\u64cd\u4f5c\uff0cSQL \u4e3b\u8981\u501f\u9274\u7684\u662f\u5173\u7cfb\u6f14\u7b97\uff0c\u4e5f\u5305\u542b\u4e86\u5173\u7cfb\u4ee3\u6570\u7684\u4e00\u90e8\u5206\u7279\u70b9\u3002</p> <p>\u5173\u7cfb\u4ee3\u6570\u6709\u6295\u5f71\u3001\u9009\u62e9\u3001\u8fde\u63a5\u3001\u5e76\u96c6\u3001\u5dee\u96c6\uff0c\u91cd\u547d\u540d\uff0c\u4e00\u5171 6 \u4e2a\u57fa\u672c\u64cd\u4f5c\u3002\u53e6\u5916\uff0c\u7ed3\u5408\u5b9e\u9645\u5e94\u7528\u5728\u8fd9\u4e9b\u57fa\u672c\u64cd\u4f5c\u4e4b\u4e0a\u53c8\u6269\u5c55\u51fa\u4e86\u5916\u8fde\u63a5\u3001\u534a\u8fde\u63a5\u3001\u805a\u96c6\u64cd\u4f5c\u3001\u5206\u7ec4\u64cd\u4f5c\u7b49\u3002</p> <p>SQL \u8bed\u53e5\u867d\u7136\u662f\u63cf\u8ff0\u6027\u7684\uff0c\u4f46\u662f\u6211\u4eec\u53ef\u4ee5\u628a\u5b83\u8f6c\u5316\u6210\u4e00\u4e2a\u5173\u7cfb\u4ee3\u6570\u8868\u8fbe\u5f0f\u3002\u800c\u5173\u7cfb\u4ee3\u6570\u4e2d\u53c8\u6709\u4e00\u4e9b\u7b49\u4ef7\u7684\u89c4\u5219\uff0c\u8fd9\u6837\u6211\u4eec\u5c31\u80fd\u7ed3\u5408\u8fd9\u4e9b\u7b49\u4ef7\u89c4\u5219\u5bf9\u5173\u7cfb\u4ee3\u6570\u8868\u8fbe\u5f0f\u8fdb\u884c\u7b49\u4ef7\u7684\u8f6c\u6362\u3002\u8fdb\u884c\u7b49\u4ef7\u8f6c\u6362\u7684\u76ee\u7684\u662f\u627e\u5230\u6027\u80fd\u66f4\u597d\u7684\u4ee3\u6570\u8868\u8fbe\u5f0f\u3002</p> <p>\u6570\u636e\u5e93\u6709\u54ea\u4e9b\u65b9\u6cd5\u6765\u5b9e\u73b0\u4e00\u4e2a\u5de6\u5916\u8fde\u63a5\u5462\uff1f \u5b83\u53ef\u4ee5\u7528\u5d4c\u5957\u5faa\u73af\u8fde\u63a5\u3001\u54c8\u5e0c\u8fde\u63a5\u3001\u5f52\u5e76\u8fde\u63a5\u7b49\u3002</p> <ul> <li>\u5185\u8fde\u63a5\u3001\u5916\u8fde\u63a5\u662f\u8fde\u63a5\u64cd\u4f5c\u3002\u8fd9\u4e9b\u5c31\u662f \u903b\u8f91\u64cd\u4f5c\u7b26</li> <li>\u5d4c\u5957\u5faa\u73af\u8fde\u63a5\u3001\u5f52\u5e76\u8fde\u63a5\uff0c\u54c8\u5e0c\u8fde\u63a5\u7b49\u3002\u8fd9\u4e9b\u5c31\u662f \u7269\u7406\u64cd\u4f5c\u7b26\u3002</li> </ul> <p>\u6bd4\u5982 TableScan\uff0c\u53ea\u662f\u8bf4\u660e\u4e86\u8fd9\u4e2a\u64cd\u4f5c\u7b26\u6240\u8981\u505a\u7684\u5c31\u662f\u8bfb\u53d6\u67d0\u4e2a\u8868\u7684\u6570\u636e\uff0c\u8fd9\u5c31\u662f\u903b\u8f91\u64cd\u4f5c\u7b26\u3002</p> <p>\u800c\u5bf9\u5e94\u7684\u7269\u7406\u64cd\u4f5c\u7b26\u5219\u540c\u65f6\u8868\u660e\u4e86\u5e94\u8be5\u7528\u4ec0\u4e48\u65b9\u6cd5\u6765\u5b9e\u73b0\u8fd9\u4e2a\u529f\u80fd\uff0c\u6bd4\u5982 SequentialTableScan(\u5168\u8868\u626b\u63cf)\u5c31\u662f TableScan \u7684\u4e00\u4e2a\u7269\u7406\u5b9e\u73b0\uff0c\u6307\u660e\u4e86\u901a\u8fc7\u626b\u63cf\u5168\u8868\u6765\u5f97\u5230\u6570\u636e\u3002\u800c\u5982\u679c\u7528 <code>BTreeIndexScan</code> \u5c31\u8868\u660e\u901a\u8fc7\u8bfb\u53d6\u8be5\u8868\u7684 BTree \u7d22\u5f15\u6765\u8bfb\u53d6\u6570\u636e(\u5efa\u7acb\u5728\u76f8\u5e94\u5c5e\u6027\u5df2\u5efa\u7acb BTree \u7d22\u5f15\u7684\u524d\u63d0\u4e0b)\u3002</p> <p>\u6bd4\u5982 GroupByOperator\uff0c\u6709\u4ec0\u4e48\u6837\u5bf9\u5e94\u7684\u7269\u7406\u64cd\u4f5c\u7b26\u5462\uff1f</p> <p>\u65b9\u6cd5\u4e00\uff0c\u901a\u8fc7\u5efa\u7acb Hash \u8868\u6765\u5b9e\u73b0 GroupBy(HashGroupByOperator)\uff1b</p> <p>\u65b9\u6cd5\u4e8c\uff0c\u901a\u8fc7\u5bf9\u5b50\u8282\u70b9\u7684\u8f93\u5165\u7684 key \u5c5e\u6027\u8fdb\u884c\u6392\u5e8f\uff0c\u7136\u540e\u5bf9\u4e8e\u76f8\u540c key \u8fdb\u884c\u805a\u5408\u64cd\u4f5c\u518d\u8f93\u51fa(SortGroupByOperator)</p> <p>\u4f18\u5316\u5668\u4f5c\u4e3a\u6570\u636e\u5e93\u7684\u5927\u8111\uff0c\u4e5f\u9700\u8981\u5efa\u7acb\u4ee3\u4ef7\u6a21\u578b\uff0c\u5bf9\u7269\u7406\u64cd\u4f5c\u7b26\u8ba1\u7b97\u4ee3\u4ef7\uff0c\u7136\u540e\u7b5b\u9009\u51fa\u6700\u4f18\u7684\u7269\u7406\u64cd\u4f5c\u7b26\u6765\u3002</p> <p>\u56e0\u6b64\uff0c\u57fa\u4e8e\u4ee3\u4ef7\u7684\u4f18\u5316\u662f\u5efa\u7acb\u5728\u7269\u7406\u64cd\u4f5c\u7b26\u4e0a\u7684\u4f18\u5316\uff0c\u6240\u4ee5\u4e5f\u53eb\u7269\u7406\u4f18\u5316\u3002\u7269\u7406\u4f18\u5316\u5c31\u662f\u5efa\u7acb\u5728\u7269\u7406\u64cd\u4f5c\u7b26\u4e0a\u7684\u4f18\u5316\u3002</p>"},{"location":"basic/9.mysql_architecture/#_15","title":"\u67e5\u8be2\u7b97\u5b50","text":"<p>SQL \u67e5\u8be2\u7684\u6267\u884c\u8fc7\u7a0b\uff0c\u5c31\u50cf\u5de5\u5382\u7684\u52a0\u5de5\u6d41\u6c34\u7ebf\uff0c\u52a0\u5de5\u8fc7\u7a0b\u4e2d\u7684\u6bcf\u4e00\u79cd\u5de5\u5e8f\u90fd\u5bf9\u5e94\u4e00\u79cd\u8fd0\u7b97\u3002</p> <p>\u8fd9\u4e9b\u8fd0\u7b97\u53ef\u4ee5\u88ab\u62bd\u8c61\u4e3a\u5173\u7cfb\u4ee3\u6570\u8fd0\u7b97\uff0c\u67e5\u8be2\u7b97\u5b50 \u662f\u6307\u8fd9\u4e9b\u5173\u7cfb\u4ee3\u6570\u8fd0\u7b97\u3002\u6bcf\u79cd\u67e5\u8be2\u7b97\u5b50\u53ef\u80fd\u5b58\u5728\u4e0d\u540c\u7684\u7269\u7406\u5b9e\u73b0\u65b9\u5f0f\uff0c\u4e0d\u540c\u5b9e\u73b0\u65b9\u5f0f\u9002\u5408\u4e0d\u540c\u7684\u573a\u666f\u3002</p> \u67e5\u8be2\u7b97\u5b50 \u5b9e\u73b0\u65b9\u5f0f \u6392\u5e8f\u7b97\u5b50 \u5185\u5b58\u6392\u5e8f\u3001\u5916\u90e8\u5f52\u5e76\u6392\u5e8f \u9009\u62e9\u7b97\u5b50 \u7ebf\u6027\u626b\u63cf\u3001\u7d22\u5f15\u626b\u63cf \u8fde\u63a5\u7b97\u5b50 \u5d4c\u5957\u5faa\u73af\u8fde\u63a5\u3001\u5757\u5d4c\u5957\u5faa\u73af\u8fde\u63a5\u3001\u7d22\u5f15\u5d4c\u5957\u5faa\u73af\u8fde\u63a5\u3001\u6392\u5e8f\u5f52\u5e76\u8fde\u63a5\u3001\u54c8\u5e0c\u8fde\u63a5 \u53bb\u91cd\u7b97\u5b50\u3001\u805a\u96c6\u7b97\u5b50\u3001\u96c6\u5408\u7b97\u5b50 \u6392\u5e8f\u3001\u54c8\u5e0c <p>\u591a\u6570\u60c5\u51b5\u4e0b\uff0c\u4e00\u6761\u67e5\u8be2\u53ef\u4ee5\u6709\u5f88\u591a\u79cd\u6267\u884c\u65b9\u5f0f\uff0c\u6700\u540e\u90fd\u8fd4\u56de\u76f8\u5e94\u7684\u7ed3\u679c\u3002\u4f18\u5316\u5668\u7684\u4f5c\u7528\u5c31\u662f\u627e\u5230\u8fd9\u5176\u4e2d\u6700\u597d\u7684\u6267\u884c\u8ba1\u5212\u3002</p> <p>MySQL \u91c7\u7528\u4e86\u57fa\u4e8e\u5f00\u9500\u6210\u672c\u7684\u4f18\u5316\u5668\uff0c\u4ee5\u786e\u5b9a\u5904\u7406\u67e5\u8be2\u7684\u6700\u89e3\u65b9\u5f0f\uff0c\u4e5f\u5c31\u662f\u8bf4\u6267\u884c\u67e5\u8be2\u4e4b\u524d\uff0c\u90fd\u4f1a\u5148\u9009\u62e9\u4e00\u6761\u81ea\u4ee5\u4e3a\u6700\u4f18\u7684\u65b9\u6848\uff0c\u7136\u540e\u6267\u884c\u8fd9\u4e2a\u65b9\u6848\u6765\u83b7\u53d6\u7ed3\u679c\u3002</p> <p>\u5728\u5f88\u591a\u60c5\u51b5\u4e0b\uff0cMySQL \u80fd\u591f\u8ba1\u7b97\u6700\u4f73\u7684\u53ef\u80fd\u67e5\u8be2\u8ba1\u5212\uff0c\u4f46\u5728\u67d0\u4e9b\u60c5\u51b5\u4e0b\uff0cMySQL \u6ca1\u6709\u5173\u4e8e\u6570\u636e\u7684\u8db3\u591f\u4fe1\u606f\uff0c\u6216\u8005\u662f\u63d0\u4f9b\u592a\u591a\u7684\u76f8\u5173\u6570\u636e\u4fe1\u606f\uff0c\u4f30\u6d4b\u5c31\u4e0d\u90a3\u4e48\u53cb\u597d\u4e86\u3002</p> <p>\u5bf9\u4e8e\u4e00\u4e9b\u6267\u884c\u8d77\u6765\u5341\u5206\u8017\u8d39\u6027\u80fd\u7684\u8bed\u53e5\uff0cMySQL \u8fd8\u662f\u4f9d\u636e\u4e00\u4e9b\u89c4\u5219\uff0c\u7aed\u5c3d\u5168\u529b\u7684\u628a\u8fd9\u4e2a\u5f88\u7cdf\u7cd5\u7684\u8bed\u53e5\u8f6c\u6362\u6210\u67d0\u79cd\u53ef\u4ee5\u6bd4\u8f83\u9ad8\u6548\u6267\u884c\u7684\u5f62\u5f0f\uff0c\u8fd9\u4e2a\u8fc7\u7a0b\u4e5f\u53ef\u4ee5\u88ab\u79f0\u4f5c\u67e5\u8be2\u91cd\u5199\u3002</p> <p>\u5b83\u5c1d\u8bd5\u9884\u6d4b\u4e00\u4e2a\u67e5\u8be2\u4f7f\u7528\u67d0\u79cd\u6267\u884c\u8ba1\u5212\u65f6\u7684\u6210\u672c\uff0c\u5e76\u9009\u62e9\u5176\u4e2d\u6210\u672c\u6700\u5c0f\u7684\u4e00\u4e2a\u3002</p> <p>\u57fa\u4e8e\u6210\u672c\u7684\u4f18\u5316\u5668\u5c06\u679a\u4e3e\u53ef\u80fd\u7684\u6267\u884c\u8ba1\u5212\uff0c\u5e76\u4e3a\u6bcf\u4e2a\u8ba1\u5212\u5206\u914d\u6210\u672c\uff0c\u6210\u672c\u662f\u6267\u884c\u8be5\u8ba1\u5212\u6240\u9700\u7684\u65f6\u95f4\u548c\u8d44\u6e90\u7684\u4f30\u8ba1\u503c\u3002</p> <p>\u4e00\u65e6\u8fd9\u4e9b\u53ef\u80fd\u6027\u88ab\u5217\u4e3e\u51fa\u6765\uff0c\u4f18\u5316\u5668\u5c31\u4f1a\u9009\u62e9\u6210\u672c\u6700\u4f4e\u7684\u8ba1\u5212\u5e76\u5c06\u5176\u4ea4\u4ed8\u6267\u884c\u3002\u867d\u7136\u6210\u672c\u6a21\u578b\u901a\u5e38\u88ab\u8bbe\u8ba1\u4e3a\u6700\u5927\u5316\u541e\u5410\u91cf\uff08\u5373\u6bcf\u79d2\u67e5\u8be2\uff09\uff0c\u4f46\u5b83\u4e5f\u53ef\u4ee5\u88ab\u8bbe\u8ba1\u4e3a\u652f\u6301\u5176\u4ed6\u671f\u671b\u6307\u6807\u7684\u67e5\u8be2\u884c\u4e3a\uff0c\u4f8b\u5982\u6700\u5c0f\u5316\u5ef6\u8fdf\uff08\u5373\u68c0\u7d22\u7b2c\u4e00\u884c\u7684\u65f6\u95f4\uff09\u6216\u6700\u5c0f\u5316\u5185\u5b58\u4f7f\u7528\u3002</p> <p>CBO(Cost-Based Optimization)</p> <p>CBO: Cost-Based Optimization \u4e5f\u5373\"\u57fa\u4e8e\u4ee3\u4ef7\u7684\u4f18\u5316\u5668\"\uff0c\u8be5\u4f18\u5316\u5668\u901a\u8fc7\u6839\u636e\u4f18\u5316\u89c4\u5219\u5bf9\u5173\u7cfb\u8868\u8fbe\u5f0f\u8fdb\u884c\u8f6c\u6362\uff0c\u751f\u6210\u591a\u4e2a\u6267\u884c\u8ba1\u5212\uff0c\u7136\u540e CBO \u4f1a\u901a\u8fc7\u6839\u636e\u7edf\u8ba1\u4fe1\u606f(Statistics)\u548c\u4ee3\u4ef7\u6a21\u578b(Cost Model)\u8ba1\u7b97\u5404\u79cd\u53ef\u80fd\u201c\u6267\u884c\u8ba1\u5212\u201d\u7684\u201c\u4ee3\u4ef7\u201d\uff0c\u5373 COST\uff0c\u4ece\u4e2d\u9009\u7528 COST \u6700\u4f4e\u7684\u6267\u884c\u65b9\u6848\uff0c\u4f5c\u4e3a\u5b9e\u9645\u8fd0\u884c\u65b9\u6848\u3002</p> <p>CBO \u4f9d\u8d56\u6570\u636e\u5e93\u5bf9\u8c61\u7684\u7edf\u8ba1\u4fe1\u606f\uff0c\u7edf\u8ba1\u4fe1\u606f\u7684\u51c6\u786e\u4e0e\u5426\u4f1a\u5f71\u54cd CBO \u505a\u51fa\u6700\u4f18\u7684\u9009\u62e9\u3002</p> <p>\u4ee5 Oracle \u6570\u636e\u5e93\u4e3a\u4f8b\uff0c\u7edf\u8ba1\u4fe1\u606f\u5305\u62ec SQL \u6267\u884c\u8def\u5f84\u7684 I/O\u3001\u7f51\u7edc\u8d44\u6e90\u3001CPU \u7684\u4f7f\u7528\u60c5\u51b5\u3002</p> <p>\u76ee\u524d\u5404\u5927\u6570\u636e\u5e93\u548c\u5927\u6570\u636e\u8ba1\u7b97\u5f15\u64ce\u90fd\u503e\u5411\u4e8e\u4f7f\u7528 CBO\uff0c\u4f8b\u5982\u4ece Oracle 10g \u5f00\u59cb\uff0cOracle \u5df2\u7ecf\u5f7b\u5e95\u653e\u5f03 RBO\uff0c\u8f6c\u800c\u4f7f\u7528 CBO\uff1b\u800c Hive \u5728 0.14 \u7248\u672c\u4e2d\u4e5f\u5f15\u5165\u4e86 CBO\u3002</p>"},{"location":"basic/9.mysql_architecture/#_16","title":"\u7b97\u5b50\u843d\u76d8","text":"<p>\u4efb\u4f55\u8ba1\u7b97\u90fd\u9700\u8981\u8017\u8d39\u5185\u5b58\u7a7a\u95f4\uff0c\u5dee\u522b\u5728\u4e8e\u591a\u5c11\u800c\u5df2\uff0c\u5bf9\u4e8e\u5982\u679c\u8017\u8d39\u5185\u5b58\u8fc7\u591a\uff0c\u4f1a\u5bfc\u81f4\u5176\u4ed6\u4f5c\u4e1a\u8fd0\u884c\u5185\u5b58\u7a7a\u95f4\u4e0d\u8db3\uff0c\u5bfc\u81f4\u4f5c\u4e1a\u4e0d\u7a33\u5b9a\uff0c\u56e0\u6b64\u9700\u8981\u5bf9\u67e5\u8be2\u8bed\u53e5\u7684\u4f5c\u4e1a\u5185\u5b58\u4f7f\u7528\u8fdb\u884c\u9650\u5236\uff0c\u4fdd\u8bc1\u4f5c\u4e1a\u8fd0\u884c\u7684\u7a33\u5b9a\u6027\u3002</p> <p>\u5047\u5982\u4f5c\u4e1a\u60f3\u8981\u4f7f\u7528500M\u5185\u5b58\uff0c\u4f46\u5b9e\u9645\u4e0a\u56e0\u4e3a\u5185\u5b58\u9650\u5236\u6700\u7ec8\u53ea\u5206\u914d\u5230300M\u5185\u5b58\uff0c\u5219\u9700\u8981\u628a\u4e34\u65f6\u4e0d\u7528\u7684\u6570\u636e\u5199\u5230\u78c1\u76d8\u4e0a\uff0c\u5185\u5b58\u4e2d\u53ea\u4fdd\u7559\u6b63\u5728\u4f7f\u7528\u7684\u6570\u636e\uff0c\u8fd9\u5c31\u662f\u4e2d\u95f4\u6570\u636e\u843d\u76d8\u7684\u7531\u6765\u3002\u5f53\u53d1\u751f\u4e2d\u95f4\u6570\u636e\u843d\u76d8\u65f6\uff0c\u79f0\u4e4b\u4e3a\u7b97\u5b50\u4e0b\u76d8\u3002\u7b97\u5b50\u843d\u76d8\u7a7a\u95f4\u592a\u5927\u9664\u4e86\u4f1a\u5bf9\u67e5\u8be2\u6027\u80fd\u6709\u8f83\u5927\u5f71\u54cd\uff0c\u8fd8\u6709\u53ef\u80fd\u5bfc\u81f4\u6570\u636e\u5e93\u53ea\u8bfb\u751a\u81f3\u78c1\u76d8\u6ee1</p>"},{"location":"basic/9.mysql_architecture/#_17","title":"\u706b\u5c71\u6a21\u578b","text":"<p>SQL \u4f5c\u4e3a\u4e00\u9879\u56fe\u7075\u5956\u7ea7\u522b\u7684\u53d1\u660e\uff0c\u5176\u91cd\u8981\u610f\u4e49\u4e0d\u5355\u5355\u662f\u53d1\u660e\u4e86\u4e00\u79cd\u53ef\u4ee5\u7528\u4f5c\u6570\u636e\u67e5\u8be2\u7684\u8bed\u8a00\uff0c \u66f4\u91cd\u8981\u7684\u4e00\u70b9\u662f\u53d1\u660e\u4e86\u5173\u7cfb\u4ee3\u6570(Relation Algebra)\u8fd9\u4e00\u5de5\u5177\uff0c \u4f7f\u5f97\u8ba1\u7b97\u673a\u7406\u89e3\u548c\u5904\u7406\u67e5\u8be2\u7684\u8bed\u4e49\u66f4\u52a0\u65b9\u4fbf\u3002SQL \u67e5\u8be2\u8bed\u53e5\u7684\u4f18\u5316\u4e5f\u662f\u57fa\u4e8e\u5173\u7cfb\u4ee3\u6570\u8fd9\u4e00\u6a21\u578b\u3002</p> <p>\u6240\u8c13\u5173\u7cfb\u4ee3\u6570\uff0c\u662f SQL \u4ece\u8bed\u53e5\u5230\u6267\u884c\u8ba1\u5212\u7684\u4e00\u79cd\u4e2d\u95f4\u8868\u793a\u3002\u9996\u5148\u5b83\u4e0d\u662f\u5355\u7eaf\u7684\u62bd\u8c61\u8bed\u6cd5\u6811(AST)\uff0c \u800c\u662f\u4e00\u79cd\u7ecf\u8fc7\u8fdb\u4e00\u6b65\u5904\u7406\u5f97\u5230\u7684\u4e2d\u95f4\u8868\u793a(\u53ef\u4ee5\u7c7b\u6bd4\u4e00\u822c\u7f16\u7a0b\u8bed\u8a00\u7684 IR)\u3002SQL \u4f18\u5316\u7684\u672c\u8d28\u662f\u5bf9\u5173\u7cfb\u4ee3\u6570\u7684\u4f18\u5316\u3002</p> <p>\u706b\u5c71\u6a21\u578b\u4f5c\u4e3a\u7ecf\u5178\u7684\u67e5\u8be2\u6267\u884c\u6a21\u578b\u88ab\u8bf8\u5982 <code>Oracle</code>\u3001<code>MySQL</code> \u7b49\u4e3b\u6d41\u5173\u7cfb\u6570\u636e\u5e93\u91c7\u7528\u3002</p> <p>\u706b\u5c71\u6a21\u578b\u662f\u4e00\u79cd\u57fa\u4e8e\u7b97\u5b50\u7684\u6267\u884c\u6a21\u578b\u3002\u5b83\u5c06\u4e00\u4e2aSQL\u67e5\u8be2\u5206\u89e3\u6210\u4e00\u7cfb\u5217\u7684\u7b97\u5b50\uff08Operator\uff09\uff0c\u6bcf\u4e2a\u7b97\u5b50\u4ee3\u8868\u4e00\u4e2a\u7279\u5b9a\u7684\u64cd\u4f5c\uff0c\u5982\u9009\u62e9\u3001\u6295\u5f71\u3001\u8fde\u63a5\u7b49\u3002\u8fd9\u4e9b\u7b97\u5b50\u6309\u7167\u4e00\u5b9a\u7684\u987a\u5e8f\u6784\u6210\u4e00\u4e2a\u6811\u72b6\u7ed3\u6784\uff0c\u79f0\u4e3a**\u67e5\u8be2\u8ba1\u5212\u6811**\u3002\u6bcf\u4e2a <code>Operator</code> \u90fd\u63d0\u4f9b\u4e00\u4e2a\u63a5\u53e3 <code>Next()</code>\uff0c\u8c03\u7528\u8be5\u63a5\u53e3\u4f1a\u8fd4\u56de\u8be5\u7b97\u5b50\u4ea7\u751f/\u5904\u7406\u7684\u4e00\u884c\u6570\u636e\uff08Tuple\uff09\u3002\u901a\u8fc7\u5728\u67e5\u8be2\u6811\u6839\u8282\u70b9\u81ea\u9876\u5411\u4e0b\u5730\u8c03\u7528 Next()\uff0c\u6570\u636e\u81ea\u5e95\u5411\u4e0a\u5730\u88ab\u62c9\u53d6\u5904\u7406\uff0c\u56e0\u800c\u706b\u5c71\u6a21\u578b\u4e5f\u79f0\u4e3a\u62c9\u53d6\u6267\u884c\u6a21\u578b\uff08Pull Based\uff09\u3002</p> <p>\u6838\u5fc3\u601d\u60f3\uff1a</p> <ul> <li>\u7b97\u5b50\u94fe\u5f0f\u8c03\u7528: \u6bcf\u4e2a\u7b97\u5b50\u90fd\u6709\u4e00\u4e2anext()\u65b9\u6cd5\uff0c\u5f53\u8c03\u7528next()\u65f6\uff0c\u7b97\u5b50\u4f1a\u4ece\u4e0b\u6e38\u7b97\u5b50\u83b7\u53d6\u4e00\u6761\u6570\u636e\uff0c\u5e76\u5bf9\u5176\u8fdb\u884c\u5904\u7406\uff0c\u7136\u540e\u8fd4\u56de\u7ed9\u4e0a\u6e38\u7b97\u5b50\u3002</li> <li>\u6570\u636e\u6d41\u9a71\u52a8: \u7b97\u5b50\u4e4b\u95f4\u901a\u8fc7\u6570\u636e\u6d41\u8fdb\u884c\u6570\u636e\u4f20\u9012\uff0c\u6570\u636e\u6d41\u662f\u6570\u636e\u5728\u7b97\u5b50\u94fe\u4e2d\u7684\u6d41\u52a8\u8def\u5f84\u3002\u6570\u636e\u4ece\u5e95\u5411\u4e0a\u6d41\u52a8\uff0c\u6bcf\u4e2a\u7b97\u5b50\u53ea\u5173\u6ce8\u81ea\u5df1\u7684\u5904\u7406\u903b\u8f91\uff0c\u800c\u4e0d\u9700\u8981\u5173\u5fc3\u6574\u4e2a\u67e5\u8be2\u7684\u6267\u884c\u8fc7\u7a0b\u3002</li> </ul>"},{"location":"basic/9.mysql_architecture/#_18","title":"\u4f18\u5316\u5668\u548c\u67e5\u8be2\u6210\u672c","text":"<p>\u4e00\u822c\u6765\u8bf4\u4e00\u4e2a sql \u67e5\u8be2\u53ef\u4ee5\u6709\u4e0d\u540c\u7684\u6267\u884c\u65b9\u6848\uff0c\u53ef\u4ee5\u9009\u62e9\u8d70\u67d0\u4e2a\u7d22\u5f15\u8fdb\u884c\u67e5\u8be2\uff0c\u4e5f\u53ef\u4ee5\u9009\u62e9\u5168\u8868\u626b\u63cf\u3002</p> <p>SQL \u4f18\u5316\u5668\uff0c\u5176\u4e2d\u6700\u91cd\u8981\u7684\u4e00\u4e2a\u7ec4\u4ef6\u662f\u67e5\u8be2\u4f18\u5316\u5668\uff0c\u662f\u6570\u636e\u5e93\u7cfb\u7edf\u7684\u91cd\u8981\u7ec4\u6210\u90e8\u5206\u3002\u7279\u522b\u662f\u5bf9\u4e8e\u73b0\u4ee3\u5927\u6570\u636e\u7cfb\u7edf\uff0c\u6267\u884c\u8ba1\u5212\u7684\u641c\u7d22\u7a7a\u95f4\u5f02\u5e38\u5e9e\u5927\uff0c\u7814\u7a76\u4eba\u5458\u7814\u7a76\u4e86\u8bb8\u591a\u65b9\u6cd5\u5bf9\u6267\u884c\u8ba1\u5212\u7a7a\u95f4\u8fdb\u884c\u88c1\u526a\uff0c\u4ee5\u51cf\u5c11\u641c\u7d22\u7a7a\u95f4\u7684\u4ee3\u4ef7\u3002</p> <p>\u5728\u5f53\u4eca\u6570\u636e\u5e93\u7cfb\u7edf\u9886\u57df\uff0c\u67e5\u8be2\u4f18\u5316\u5668\u53ef\u4ee5\u8bf4\u662f\u5fc5\u5907\u7ec4\u4ef6\uff0c\u4e0d\u7ba1\u662f\u5173\u7cfb\u578b\u6570\u636e\u5e93\u7cfb\u7edf Oracle\u3001MySQL\uff0c\u6d41\u5904\u7406\u9886\u57df\u7684 Flink\u3001Storm\uff0c\u6279\u5904\u7406\u9886\u57df\u7684 Hive\u3001Spark SQL\uff0c\u8fd8\u662f\u6587\u672c\u641c\u7d22\u9886\u57df\u7684 Elasticsearch \u7b49\uff0c\u90fd\u4f1a\u5185\u5d4c\u4e00\u4e2a\u67e5\u8be2\u4f18\u5316\u5668\u3002</p> <p>\u6709\u7684\u6570\u636e\u5e93\u7cfb\u7edf\u4f1a\u91c7\u7528\u81ea\u7814\u7684\u4f18\u5316\u5668\uff0c\u800c\u6709\u7684\u5219\u4f1a\u91c7\u7528\u5f00\u6e90\u7684\u67e5\u8be2\u4f18\u5316\u5668\u63d2\u4ef6\uff0c\u6bd4\u5982 Apache Calcite \u5c31\u662f\u4e00\u4e2a\u4f18\u79c0\u7684\u5f00\u6e90\u67e5\u8be2\u4f18\u5316\u5668\u63d2\u4ef6\u3002\u800c\u50cf Oracle \u6570\u636e\u5e93\u7684\u67e5\u8be2\u4f18\u5316\u5668\uff0c\u5219\u662f Oracle \u516c\u53f8\u81ea\u7814\u7684\u4e00\u4e2a\u6838\u5fc3\u7ec4\u4ef6\uff0c\u8d1f\u8d23\u89e3\u6790 SQL\uff0c\u5176\u76ee\u7684\u662f\u6309\u7167\u4e00\u5b9a\u7684\u539f\u5219\u6765\u83b7\u53d6\u76ee\u6807 SQL \u5728\u5f53\u524d\u60c5\u5f62\u4e0b\u6267\u884c\u7684\u6700\u9ad8\u6548\u6267\u884c\u8def\u5f84\u3002</p> <p>\u53c2\u8003</p> <p>\u67e5\u8be2\u4f18\u5316\u5668 \u5219\u4f1a\u6bd4\u8f83\u5e76\u9009\u62e9\u5176\u4e2d\u6210\u672c\u6700\u4f4e\u7684\u65b9\u6848\u53bb\u6267\u884c\u67e5\u8be2\u3002</p> <p>\u67e5\u8be2\u5904\u7406\u7684\u4ee3\u4ef7\u4e3b\u8981\u662f\u6307\u67e5\u8be2\u5bf9\u5404\u79cd\u8ba1\u7b97\u8d44\u6e90\u7684\u6d88\u8017\uff0c\u5305\u62ec\u78c1\u76d8 I/O \u5360\u7528\u3001\u6267\u884c\u67e5\u8be2\u6240\u7528\u7684 CPU \u65f6\u95f4\uff0c\u5982\u679c\u662f\u5206\u5e03\u5f0f\u6570\u636e\u5e93\u7684\u8bdd\u8fd8\u9700\u8981\u8003\u8651\u6570\u636e\u901a\u4fe1\u4ee3\u4ef7</p> <p>\u5728\u5927\u578b\u6570\u636e\u5e93\u7cfb\u7edf\u4e2d\uff0c\u78c1\u76d8 I/O \u4ee3\u4ef7\u662f\u6700\u4e3b\u8981\u7684\u4ee3\u4ef7\uff0c\u53ef\u4ee5**\u4f7f\u7528\u78c1\u76d8 I/O**\u7684\u5757\u6570\u4f5c\u4e3a\u4ee3\u4ef7\u5ea6\u91cf\u7684\u6307\u6807\u3002</p> <p>\u67e5\u8be2\u6210\u672c\u5206\u5927\u4f53\u4e3a\u4e24\u79cd\uff1a</p> <ul> <li> <p>I/O \u6210\u672c\uff1a\u78c1\u76d8\u8bfb\u5199\u7684\u5f00\u9500\u3002\u4e00\u4e2a\u67e5\u8be2\u6216\u4e00\u4e2a\u5199\u5165\uff0c\u90fd\u8981\u4ece\u78c1\u76d8\u4e2d\u8bfb\u5199\u6570\u636e\uff0c\u8981\u4e00\u5b9a\u7684 IO \u5f00\u9500\u3002</p> </li> <li> <p>CPU \u6210\u672c\uff1a\u5173\u8054\u67e5\u8be2\uff0c\u6761\u4ef6\u67e5\u627e\uff0c\u90fd\u8981 CPU \u6765\u8fdb\u884c\u8ba1\u7b97\u5224\u65ad\uff0c\u4e00\u5b9a\u7684\u8ba1\u7b97\u5f00\u9500\u3002</p> </li> </ul> <p>MySQL \u4f7f\u7528\u7684<code>InnoDB</code>\u5f15\u64ce\u4f1a\u628a\u6570\u636e\u548c\u7d22\u5f15\u90fd\u5b58\u50a8\u5230\u78c1\u76d8\u4e0a\uff0c\u5f53\u67e5\u8be2\u7684\u65f6\u5019\u9700\u8981\u5148\u628a\u6570\u636e\u5148\u52a0\u8f7d\u5230\u5185\u5b58\u4e2d\u5728\u8fdb\u884c\u4e0b\u4e00\u6b65\u64cd\u4f5c\uff0c\u8fd9\u4e2a\u52a0\u8f7d\u7684\u65f6\u95f4\u5c31\u662f<code>I/O</code>\u6210\u672c\u3002</p> <p>\u5f53\u6570\u636e\u88ab\u52a0\u8f7d\u5230\u5185\u5b58\u4e2d\u540e\uff0cCPU \u4f1a\u8ba1\u7b97\u67e5\u8be2\u6761\u4ef6\u5339\u914d\uff0c\u5bf9\u6570\u636e\u6392\u5e8f\u7b49\u7b49\u64cd\u4f5c\uff0c\u8fd9\u4e00\u6b65\u6240\u6d88\u8017\u7684\u65f6\u95f4\u5c31\u662f CPU \u6210\u672c\u3002</p> <p>\u4f46\u662f\u67e5\u8be2\u4f18\u5316\u5668\u5e76\u4e0d\u4f1a\u771f\u6b63\u7684\u53bb\u6267\u884c sql\uff0c\u53ea\u4f1a\u53bb\u6839\u636e\u4f18\u5316\u7684\u7ed3\u679c\u53bb\u9884\u4f30\u4e00\u4e2a\u6210\u672c\u3002</p> <p>InnoDB \u5f15\u64ce\u89c4\u5b9a\u8bfb\u53d6\u4e00\u4e2a\u9875\u9762\u82b1\u8d39\u7684\u6210\u672c\u9ed8\u8ba4\u7ea6\u662f 0.25\uff0c\u8bfb\u53d6\u4ee5\u53ca\u68c0\u6d4b\u4e00\u6761\u8bb0\u5f55\u662f\u5426\u7b26\u5408\u641c\u7d22\u6761\u4ef6\u7684\u6210\u672c\u9ed8\u8ba4\u7ea6\u662f 0.1\u3002</p> <p>\u4e3a\u4ec0\u4e48\u90fd\u662f\u7ea6\u5462\uff0c\u56e0\u4e3a MySQL \u5185\u90e8\u7684\u8ba1\u7b97\u6210\u672c\u6bd4\u8f83\u590d\u6742\u8fd9\u91cc\u63d0\u53d6\u4e86\u4e24\u4e2a\u4e3b\u8981\u7684\u8ba1\u7b97\u53c2\u6570\u3002</p> <pre><code>## MySQL server \u5c42\u9762\u7684\u5404\u79cd\u5f00\u9500\nmysql&gt; select * from mysql.server_cost;\n+------------------------------+------------+---------------------+---------+---------------+\n| cost_name                    | cost_value | last_update         | comment | default_value |\n+------------------------------+------------+---------------------+---------+---------------+\n| disk_temptable_create_cost   |       NULL | 2021-09-24 14:47:20 | NULL    |            20 |\n| disk_temptable_row_cost      |       NULL | 2021-09-24 14:47:20 | NULL    |           0.5 |\n| key_compare_cost             |       NULL | 2021-09-24 14:47:20 | NULL    |          0.05 |\n| memory_temptable_create_cost |       NULL | 2021-09-24 14:47:20 | NULL    |             1 |\n| memory_temptable_row_cost    |       NULL | 2021-09-24 14:47:20 | NULL    |           0.1 |\n| row_evaluate_cost            |       NULL | 2021-09-24 14:47:20 | NULL    |           0.1 |\n+------------------------------+------------+---------------------+---------+---------------+\n6 rows in set (0.00 sec)\n\nmysql&gt;\n\n## MySQL \u5b58\u50a8\u5f15\u64ce\u5c42\u9762\u7684\u5404\u79cd\u5f00\u9500\nmysql&gt; select * from mysql.engine_cost;\n+-------------+-------------+------------------------+------------+---------------------+---------+---------------+\n| engine_name | device_type | cost_name              | cost_value | last_update         | comment | default_value |\n+-------------+-------------+------------------------+------------+---------------------+---------+---------------+\n| default     |           0 | io_block_read_cost     |       NULL | 2021-09-24 14:47:20 | NULL    |             1 |\n| default     |           0 | memory_block_read_cost |       NULL | 2021-09-24 14:47:20 | NULL    |          0.25 |\n+-------------+-------------+------------------------+------------+---------------------+---------+---------------+\n2 rows in set (0.00 sec)\n\nmysql&gt;\n</code></pre> <p>\u5728 MySQL \u53ef\u4ee5\u901a\u8fc7\u67e5\u8be2\u5f53\u524d\u4f1a\u8bdd\u7684<code>last_query_cost</code>\u7684\u503c\u6765\u5f97\u5230\u5176\u8ba1\u7b97\u5f53\u524d\u67e5\u8be2\u7684\u6210\u672c\u3002</p> <pre><code>\u00a0mysql&gt; select * from t_message limit 10;\n\u00a0...\u7701\u7565\u7ed3\u679c\u96c6\n\u00a0\n\u00a0mysql&gt; show status like 'last_query_cost';\n\u00a0+-----------------+-------------+\n\u00a0| Variable_name \u00a0 | Value \u00a0 \u00a0 \u00a0 |\n\u00a0+-----------------+-------------+\n\u00a0| Last_query_cost | 6391.799000 |\n\u00a0+-----------------+-------------+\n\u00a0\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\n</code></pre> <p>\u793a\u4f8b\u4e2d\u7684\u7ed3\u679c\u8868\u793a\u4f18\u5316\u5668\u8ba4\u4e3a\u5927\u6982\u9700\u8981\u505a 6391 \u4e2a\u6570\u636e\u9875\u7684\u968f\u673a\u67e5\u627e\u624d\u80fd\u5b8c\u6210\u4e0a\u9762\u7684\u67e5\u8be2\u3002</p> <p>\u8fd9\u4e2a\u7ed3\u679c\u662f\u6839\u636e\u4e00\u4e9b\u5217\u7684\u7edf\u8ba1\u4fe1\u606f\u8ba1\u7b97\u5f97\u6765\u7684\uff0c\u8fd9\u4e9b\u7edf\u8ba1\u4fe1\u606f\u5305\u62ec\uff1a\u6bcf\u5f20\u8868\u6216\u8005\u7d22\u5f15\u7684\u9875\u9762\u4e2a\u6570\u3001\u7d22\u5f15\u7684\u57fa\u6570\u3001\u7d22\u5f15\u548c\u6570\u636e\u884c\u7684\u957f\u5ea6\u3001\u7d22\u5f15\u7684\u5206\u5e03\u60c5\u51b5\u7b49\u7b49\u3002</p> <p>\u6709\u975e\u5e38\u591a\u7684\u539f\u56e0\u4f1a\u5bfc\u81f4<code>MySQL</code>\u9009\u62e9\u9519\u8bef\u7684\u6267\u884c\u8ba1\u5212\uff0c\u6bd4\u5982\u7edf\u8ba1\u4fe1\u606f\u4e0d\u51c6\u786e\u3001\u4e0d\u4f1a\u8003\u8651\u4e0d\u53d7\u5176\u63a7\u5236\u7684\u64cd\u4f5c\u6210\u672c\uff08\u7528\u6237\u81ea\u5b9a\u4e49\u51fd\u6570\u3001\u5b58\u50a8\u8fc7\u7a0b\uff09\u3002</p> <p>MySQL \u8ba4\u4e3a\u7684\u6700\u4f18\u8ddf\u6211\u4eec\u60f3\u7684\u4e0d\u4e00\u6837\uff08\u6211\u4eec\u5e0c\u671b\u6267\u884c\u65f6\u95f4\u5c3d\u53ef\u80fd\u77ed\uff0c\u4f46 MySQL \u9009\u62e9\u5b83\u8ba4\u4e3a\u6210\u672c\u5c0f\u7684\uff0c\u4f46\u6210\u672c\u5c0f\u5e76\u4e0d\u610f\u5473\u7740\u6267\u884c\u65f6\u95f4\u77ed\uff09\u7b49\u7b49\u3002</p>"},{"location":"basic/9.mysql_architecture/#_19","title":"\u4f18\u5316\u5668\u8ffd\u8e2a","text":"<p>MySQL \u4f18\u5316\u5668\u53ef\u4ee5\u751f\u6210<code>explain</code>\u6267\u884c\u8ba1\u5212\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u6267\u884c\u8ba1\u5212\u67e5\u770b\u662f\u5426\u4f7f\u7528\u4e86\u7d22\u5f15\uff0c\u4f7f\u7528\u4e86\u54ea\u79cd\u7d22\u5f15\uff1f</p> <p>\u4f46\u662f\u5b83\u53ea\u80fd\u5c55\u793a<code>SQL</code>\u8bed\u53e5\u7684\u6267\u884c\u8ba1\u5212\uff0c\u65e0\u6cd5\u5c55\u793a\u4e3a\u4ec0\u4e48\u4e00\u4e9b\u5176\u4ed6\u7684\u6267\u884c\u8ba1\u5212\u672a\u88ab\u9009\u62e9\uff0c\u6bd4\u5982\u8bf4\u660e\u660e\u6709\u7d22\u5f15\uff0c\u4f46\u662f\u4e3a\u4ec0\u4e48\u67e5\u8be2\u65f6\u672a\u4f7f\u7528\u7d22\u5f15\u7b49\u3002</p> <p>\u597d\u5728 MySQL \u63d0\u4f9b\u4e86\u4e00\u4e2a\u597d\u7528\u7684\u5de5\u5177<code>optimizer trace</code>\uff08\u4f18\u5316\u5668\u8ffd\u8e2a\uff09\uff0c\u53ef\u4ee5\u5e2e\u52a9\u6211\u4eec\u67e5\u770b\u4f18\u5316\u5668\u751f\u6210\u6267\u884c\u8ba1\u5212\u7684\u6574\u4e2a\u8fc7\u7a0b\uff0c\u4ee5\u53ca\u505a\u51fa\u7684\u5404\u79cd\u51b3\u7b56\uff0c\u5305\u62ec\u8bbf\u95ee\u8868\u7684\u65b9\u6cd5\u3001\u5404\u79cd\u5f00\u9500\u8ba1\u7b97\u3001\u5404\u79cd\u8f6c\u6362\u7b49\u3002</p> <p>\u4f17\u6240\u5468\u77e5\uff0cMySQL \u662f\u57fa\u4e8e\u6210\u672c\u7684\u4f18\u5316\u5668\uff08CBO\uff09\uff0c\u6bcf\u4e2a\u6267\u884c\u8ba1\u5212\u7684\u6210\u672c\u5927\u81f4\u53cd\u5e94\u4e86\u8be5\u8ba1\u5212\u67e5\u8be2\u6240\u9700\u8981\u7684\u8d44\u6e90\u3002</p> <p>CBO \u9009\u62e9\u76ee\u6807 SQL \u6267\u884c\u8ba1\u5212\u7684\u5224\u65ad\u539f\u5219\u662f\u6210\u672c\uff0c\u4ece\u76ee\u6807 SQL \u7684\u8bf8\u591a\u6267\u884c\u8ba1\u5212\u4e2d\u9009\u53d6\u6210\u672c\u503c\u6700\u5c0f\u7684\u6267\u884c\u8def\u5f84\u4e3a\u5176\u6267\u884c\u8ba1\u5212\uff0c\u5404\u6267\u884c\u8def\u5f84\u7684\u6210\u672c\u503c\u662f\u6839\u636e\u76ee\u6807 SQL \u4e2d\u6d89\u53ca\u5230\u7684\u8868\u3001\u7d22\u5f15\u3001\u5217\u7b49\u76f8\u5173\u5bf9\u8c61\u7684\u7edf\u8ba1\u4fe1\u606f\u8ba1\u7b97\u51fa\u6765\u7684\uff0c\u5b9e\u9645\u53cd\u5e94\u6267\u884c\u76ee\u6807 SQL \u6240\u8981\u6d88\u8017\u7684 I/O\u3001CPU \u548c\u7f51\u7edc\u8d44\u6e90\u7684\u4e00\u4e2a\u4f30\u8ba1\u503c\u3002</p> <p>\u4f18\u5316\u5668\u4f1a\u4e3a\u6bcf\u4e2a\u64cd\u4f5c\u6807\u4e0a\u6210\u672c\uff0c\u8fd9\u4e9b\u6210\u672c\u7684\u57fa\u51c6\u5355\u4f4d\u6216\u6700\u5c0f\u503c\u662f\u4ece\u78c1\u76d8\u8bfb\u53d6\u968f\u673a\u6570\u636e\u9875\u7684\u6210\u672c\uff0c\u5176\u4ed6\u64cd\u4f5c\u7684\u6210\u672c\u90fd\u662f\u5b83\u7684\u500d\u6570\u3002\u6240\u4ee5\u4f18\u5316\u5668\u53ef\u4ee5\u6839\u636e\u6bcf\u4e2a\u6267\u884c\u8ba1\u5212\u7684\u6240\u6709\u64cd\u4f5c\u4e3a\u5176\u8ba1\u7b97\u51fa\u603b\u7684\u6210\u672c\uff0c\u7136\u540e\u4ece\u4f17\u591a\u6267\u884c\u8ba1\u5212\u4e2d\uff0c\u9009\u53d6\u6210\u672c\u6700\u5c0f\u7684\u6765\u6700\u7ec8\u6267\u884c\u3002</p> <pre><code>CREATE TABLE `user` (\n    `id` int NOT NULL AUTO_INCREMENT COMMENT '\u4e3b\u952e',\n    `name` varchar(100) NOT NULL COMMENT '\u59d3\u540d',\n    `gender` tinyint NOT NULL COMMENT '\u6027\u522b',\n    PRIMARY KEY (`id`),\n    KEY `idx_name` (`name`),\n    KEY `idx_gender_name` (`gender`,`name`)\n) ENGINE=InnoDB COMMENT='\u7528\u6237\u8868';\n\nINSERT INTO  user(id,name,gender)  VALUES\n    (1,'\u5c0f\u660e',1),\n    (2,'\u5c0f\u9ec4',1),\n    (3,'\u5173\u7fbd',1),\n    (4,'\u5f20\u98de',0),\n    (5,'\u66f9\u64cd',1),\n    (6,'\u5218\u5907',0),\n    (7,'\u5b59\u609f\u7a7a',1),\n    (8,'\u6797\u51b2',1),\n    (9,'\u674e\u767d',0),\n    (19,'\u674e\u56db',1),\n    (10,'\u5c0f\u5f3a',1),\n    (11,'\u5218\u5a75',1),\n    (12,'\u8d75\u82b8',1),\n    (13,'\u60e0\u6708',1),\n    (14,'\u666f\u9038',1),\n    (15,'\u5c0f\u9ec4',1),\n    (16,'\u601d\u5cf0',1),\n    (17,'\u4f0f\u5c14\u6cf0',1),\n    (18,'\u96e8\u679c',1),\n    (20,'\u8d1d\u591a\u82ac',1),\n    (21,'\u5c0f\u660e',1),\n    (22,'\u5c0f\u660e',1),\n    (23,'\u5c0f\u660e',1),\n    (24,'\u5c0f\u660e',1),\n    (25,'\u5c0f\u660e',1),\n    (26,'\u5c0f\u660e',1),\n    (27,'\u5c0f\u660e',1),\n    (28,'\u5c0f\u660e',1);\n\n--\u8fd9\u6761\u8bed\u53e5\u7528\u7684\u662f`idx_gender_name`\u8fd9\u4e2a\u8054\u5408\u7d22\u5f15\nexplain select * from user  where gender=1 and name='\u5c0f\u660e';\n\n--\u8fd9\u6761\u8bed\u53e5\u7528\u7684\u662f`idx_name`\u8fd9\u4e2a\u7d22\u5f15\nexplain select * from user  where gender=0 and name='\u5f20\u4e09';\n\n\n-- \u540c\u4e00\u6761SQL\u56e0\u4e3a\u4f20\u53c2\u4e0d\u540c\uff0c\u800c\u4f7f\u7528\u4e86\u4e0d\u540c\u7684\u7d22\u5f15\u3002\n-- \u5230\u8fd9\u91cc\uff0c\u4f7f\u7528\u73b0\u6709\u5de5\u5177\uff0c\u6211\u4eec\u5df2\u7ecf\u65e0\u6cd5\u6392\u67e5\u5206\u6790\uff0cMySQL\u4f18\u5316\u5668\u4e3a\u4ec0\u4e48\u4f7f\u7528\u4e86(name)\u4e0a\u7684\u7d22\u5f15\uff0c\u800c\u6ca1\u6709\u4f7f\u7528(gender,name)\u4e0a\u7684\u8054\u5408\u7d22\u5f15\u3002\n</code></pre> <p>\u76f8\u5173\u53d8\u91cf</p> <pre><code>mysql&gt; show variables like '%optimizer_trace%';\n+------------------------------+----------------------------------------------------------------------------+\n| Variable_name                | Value                                                                      |\n+------------------------------+----------------------------------------------------------------------------+\n| optimizer_trace              | enabled=off,one_line=off                                                   |\n| optimizer_trace_features     | greedy_search=on,range_optimizer=on,dynamic_range=on,repeated_subselect=on |\n| optimizer_trace_limit        | 1                                                                          |\n| optimizer_trace_max_mem_size | 1048576                                                                    |\n| optimizer_trace_offset       | -1                                                                         |\n+------------------------------+----------------------------------------------------------------------------+\n5 rows in set (0.00 sec)\nmysql&gt;\n\n-- \u53ef\u7528SET\u8bed\u53e5\u64cd\u4f5c\uff0c\u7528\u5982\u4e0b\u547d\u4ee4\u5373\u53ef\u6253\u5f00OPTIMIZER TRACE\nSET OPTIMIZER_TRACE=\"enabled=on\",END_MARKERS_IN_JSON=on;\n-- \u5373\u4f7f\u5168\u5c40\u5f00\u542fOPTIMIZER_TRACE\uff0c\u6bcf\u4e2aSession\u4e5f\u53ea\u80fd\u8ddf\u8e2a\u5b83\u81ea\u5df1\u6267\u884c\u7684\u8bed\u53e5\nSET GLOBAL OPTIMIZER_TRACE=\"enabled=on\",END_MARKERS_IN_JSON=on;\n-- \u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u7531\u4e8eoptimizer_trace_offset=-1\uff0coptimizer_trace_limit=1\uff0c\u8bb0\u5f55\u6700\u8fd1\u7684\u4e00\u6761SQL\u8bed\u53e5\uff0c\u5c55\u793a\u65f6\uff0c\u6bcf\u6b21\u5c55\u793a1\u6761\u6570\nSET optimizer_trace_offset=&lt;OFFSET&gt;, optimizer_trace_limit=&lt;LIMIT&gt;\n\n\n-- \u5f00\u542fOPTIMIZER_TRACE\u529f\u80fd\uff0c\u5e76\u8bbe\u7f6e\u8981\u5c55\u793a\u7684\u6570\u636e\u6761\u76ee\u6570\nSET OPTIMIZER_TRACE=\"enabled=on\",END_MARKERS_IN_JSON=on;\nSET optimizer_trace_offset=-30, optimizer_trace_limit=30;\n\n\n-- \u53d1\u9001\u4f60\u60f3\u8981\u5206\u6790\u7684SQL\u8bed\u53e5\n-- SELECT * FROM users;\n\n-- \u67e5\u770b\u5206\u6790\u7ed3\u679c\nSELECT * FROM INFORMATION_SCHEMA.OPTIMIZER_TRACE limit 30;\n</code></pre> <p>optimizer_trace</p> <ul> <li> <p>enabled\uff1a\u542f\u7528/\u7981\u7528 optimizer_trace \u529f\u80fd\u3002\u9ed8\u8ba4\u5173\u95ed\uff0c\u4e5f\u5efa\u8bae\u5173\u95ed\uff0c\u56e0\u4e3a\u5b83\u4f1a\u4ea7\u751f\u989d\u5916\u7684\u6027\u80fd\u5f00\u9500\u3002\u6839\u636e\u76f8\u5173\u8bc4\u6d4b\uff0c\u5f53\u6253\u5f00<code>optimizer trace</code>\u65f6\uff0c\u7ea6\u6709\u4e0d\u5230 10%\u7684\u6027\u80fd\u4e0b\u964d\u3002</p> </li> <li> <p>one_line\uff1a\u51b3\u5b9a\u4e86\u8ddf\u8e2a\u4fe1\u606f\u7684\u5b58\u50a8\u65b9\u5f0f\uff0c\u4e3a on \u8868\u793a\u4f7f\u7528\u5355\u884c\u5b58\u50a8\uff0c\u5426\u5219\u4ee5 JSON \u6811\u7684\u6807\u51c6\u5c55\u793a\u5f62\u5f0f\u5b58\u50a8\u3002</p> </li> </ul> <p>\u5728 Optimizer Trace \u7684\u8f93\u51fa\u4e2d\uff0c\u4e3b\u8981\u5206\u4e3a\u4e09\u4e2a\u90e8\u5206:</p> <ul> <li>join_preparation SQL \u51c6\u5907\u9636\u6bb5</li> </ul> <p>\u5b8c\u6210 SQL \u7684\u51c6\u5907\u5de5\u4f5c\uff0c\u5728\u8fd9\u4e2a\u9636\u6bb5\uff0cSQL \u8bed\u53e5\u4f1a\u88ab\u683c\u5f0f\u5316\u8f93\u51fa\uff0c\u901a\u914d\u7b26*\u4f1a\u88ab\u5177\u4f53\u5b57\u6bb5\u4ee3\u66ff\uff0c\u4f46\u4e0d\u4f1a\u8fdb\u884c\u7b49\u4ef7\u6539\u5199\u52a8\u4f5c\u3002</p> <ul> <li>join_optimization SQL \u4f18\u5316\u9636\u6bb5</li> </ul> <p>\u5b8c\u6210 SQL \u8bed\u53e5\u7684\u903b\u8f91\u4e0e\u7269\u7406\u4f18\u5316\u7684\u8fc7\u7a0b\uff0c\u8fd9\u5176\u4e2d\u7684\u4f18\u5316\u6b65\u9aa4\u6bd4\u8f83\u591a\u3002\u5728\u5c55\u5f00\u5177\u4f53\u5185\u5bb9\u4e4b\u524d\uff0c\u5148\u89e3\u91ca\u4e0b\u201dselect #\u201d\u7684\u95ee\u9898\u3002\u5728\u8f93\u51fa\u4e2d\u7ecf\u5e38\u4f1a\u770b\u5230\u6709\u201dselect#:N\u201d\u7684\u5b57\u6837\uff0c\u5b83\u8868\u793a\u5f53\u524d\u8ddf\u8e2a\u7684\u7ed3\u6784\u4f53\u662f\u5c5e\u4e8e\u7b2c\u51e0\u4e2a SELECT\u3002\u5982\u679c\u8bed\u53e5\u4e2d\u4f7f\u7528\u591a\u4e2a SELECT \u8bed\u53e5\u62fc\u63a5\uff08\u5982 UNION\uff09\u6216\u8005\u6709\u5d4c\u5957\u5b50\u67e5\u8be2\u4e2d\u6709 SELECT\uff0c\u4f1a\u4ea7\u751f\u591a\u4e2a\u5e8f\u53f7\u3002</p> <ul> <li>join_execution SQL \u6267\u884c\u9636\u6bb5</li> </ul>"},{"location":"basic/9.mysql_architecture/#_20","title":"\u7edf\u8ba1\u6570\u636e","text":"<p>\u65e2\u7136\u662f\u57fa\u4e8e\u7edf\u8ba1\u6570\u636e\u6765\u8fdb\u884c\u6807\u8bb0\u6210\u672c\uff0c\u5c31\u603b\u4f1a\u6709\u6837\u672c\u65e0\u6cd5\u6b63\u786e\u53cd\u6620\u6574\u4f53\u7684\u60c5\u51b5\uff0c\u8fd9\u4e5f\u662f MySQL \u4f18\u5316\u5668\u6709\u65f6\u505a\u51fa\u9519\u8bef\u4f18\u5316\u7684\u91cd\u8981\u539f\u56e0\u4e4b\u4e00\u3002</p> <p>MySQL \u7edf\u8ba1\u4fe1\u606f\u662f\u6307\u6570\u636e\u5e93\u901a\u8fc7\u91c7\u6837\u3001\u7edf\u8ba1\u51fa\u6765\u7684\u8868\u3001\u7d22\u5f15\u7684\u76f8\u5173\u4fe1\u606f\uff0c\u4f8b\u5982\uff0c\u8868\u7684\u8bb0\u5f55\u6570\u3001\u805a\u96c6\u7d22\u5f15 page \u4e2a\u6570\u3001\u5b57\u6bb5\u7684 Cardinality....\u3002</p> <p>MySQL \u5728\u751f\u6210\u6267\u884c\u8ba1\u5212\u65f6\uff0c\u9700\u8981\u6839\u636e\u7d22\u5f15\u7684\u7edf\u8ba1\u4fe1\u606f\u8fdb\u884c\u4f30\u7b97\uff0c\u8ba1\u7b97\u51fa\u6700\u4f4e\u4ee3\u4ef7\uff08\u6216\u8005\u8bf4\u662f\u6700\u5c0f\u5f00\u9500\uff09\u7684\u6267\u884c\u8ba1\u5212\uff0cMySQL \u652f\u6301\u6709\u9650\u7684\u7d22\u5f15\u7edf\u8ba1\u4fe1\u606f\uff0c\u56e0\u5b58\u50a8\u5f15\u64ce\u4e0d\u540c\u800c\u7edf\u8ba1\u4fe1\u606f\u6536\u96c6\u7684\u65b9\u5f0f\u4e5f\u4e0d\u540c\u3002</p> <p>\u5728MySQL\u4e2d\uff0c\"index dives\"\u548c\"index statistics\"\u662f\u4f18\u5316\u5668\u5728\u8fdb\u884c\u67e5\u8be2\u8ba1\u5212\u9009\u62e9\u65f6\u4f7f\u7528\u7684\u4e24\u79cd\u4e0d\u540c\u7684\u7edf\u8ba1\u4fe1\u606f\u83b7\u53d6\u65b9\u5f0f\u3002</p> <p>1.Index Dives\uff1a\u8fd9\u662f\u4e00\u79cd\u52a8\u6001\u7684\u7edf\u8ba1\u4fe1\u606f\u6536\u96c6\u65b9\u5f0f\u3002\u5f53\u4f18\u5316\u5668\u9700\u8981\u51b3\u5b9a\u662f\u5426\u4f7f\u7528\u67d0\u4e2a\u7d22\u5f15\u65f6\uff0c\u5b83\u4f1a\"\u6f5c\u5165\"\u8fd9\u4e2a\u7d22\u5f15\uff0c\u4e5f\u5c31\u662f\u5b9e\u9645\u8bfb\u53d6\u7d22\u5f15\u7684\u90e8\u5206\u9875\u9762\u6765\u83b7\u53d6\u7edf\u8ba1\u4fe1\u606f\u3002\u8fd9\u79cd\u65b9\u5f0f\u83b7\u53d6\u7684\u7edf\u8ba1\u4fe1\u606f\u662f\u5b9e\u65f6\u7684\uff0c\u4f46\u662f\u4f1a\u6d88\u8017\u4e00\u4e9b\u8d44\u6e90\u3002</p> <p>2.Index Statistics\uff1a\u8fd9\u662f\u4e00\u79cd\u9759\u6001\u7684\u7edf\u8ba1\u4fe1\u606f\u6536\u96c6\u65b9\u5f0f\u3002MySQL\u4f1a\u5b9a\u671f\u6536\u96c6\u548c\u5b58\u50a8\u7d22\u5f15\u7684\u7edf\u8ba1\u4fe1\u606f\uff0c\u4f18\u5316\u5668\u5728\u9700\u8981\u7684\u65f6\u5019\u76f4\u63a5\u4f7f\u7528\u8fd9\u4e9b\u5b58\u50a8\u7684\u7edf\u8ba1\u4fe1\u606f\u3002\u8fd9\u79cd\u65b9\u5f0f\u83b7\u53d6\u7684\u7edf\u8ba1\u4fe1\u606f\u53ef\u80fd\u5e76\u4e0d\u662f\u5b9e\u65f6\u7684\uff0c\u4f46\u662f\u5f00\u9500\u8f83\u5c0f\u3002</p> <p>\u6839\u636e\u7edf\u8ba1\u6570\u636e\u662f\u5426\u53ef\u4ee5\u6301\u4e45\u5316\uff0cMySQL \u63d0\u4f9b\u4e86\u4e24\u79cd\u7edf\u8ba1\u65b9\u5f0f\uff1a</p> <ul> <li> <p>\u7edf\u8ba1\u6570\u636e\u5b58\u50a8\u5728\u78c1\u76d8\u4e0a\u3002</p> </li> <li> <p>\u7edf\u8ba1\u6570\u636e\u5b58\u50a8\u5728\u5185\u5b58\u4e2d\uff0c\u5f53\u670d\u52a1\u5668\u5173\u95ed\u65f6\u8fd9\u4e9b\u8fd9\u4e9b\u7edf\u8ba1\u6570\u636e\u5c31\u90fd\u88ab\u6e05\u9664\u6389\u4e86\u3002</p> </li> </ul> <p>MySQL \u7ed9\u6211\u4eec\u63d0\u4f9b\u4e86\u7cfb\u7edf\u53d8\u91cf innodb_stats_persistent \u6765\u63a7\u5236\u5230\u5e95\u91c7\u7528\u54ea\u79cd\u65b9\u5f0f\u53bb\u5b58\u50a8\u7edf\u8ba1\u6570\u636e\u3002</p> <pre><code># \u5728MySQL 5.6.6\u4e4b\u524d\uff0cinnodb_stats_persistent\u7684\u503c\u9ed8\u8ba4\u662fOFF\uff0cInnoDB\u7684\u7edf\u8ba1\u6570\u636e\u9ed8\u8ba4\u662f\u5b58\u50a8\u5230\u5185\u5b58\u7684\ninnodb_stats_persistent=OFF\n# \u5728MySQL 5.6.6\u4e4b\u540e\uff0cinnodb_stats_persistent\u7684\u503c\u9ed8\u8ba4\u662fON\uff0cInnoDB\u7684\u7edf\u8ba1\u6570\u636e\u9ed8\u8ba4\u662f\u5b58\u50a8\u5230\u78c1\u76d8\u4e2d\ninnodb_stats_persistent=ON\n</code></pre> <ul> <li>mysql.innodb_table_stats   \u5b58\u50a8\u4e86\u8868\u7684\u603b\u884c\u6570\uff0c\u4e3b\u952e<code>clustered index</code>\u4e0a page \u6570\uff0c\u975e\u4e3b\u952e\u7d22\u5f15\u7684 page \u603b\u6570\u3002</li> </ul> <p>InnoDB \u9ed8\u8ba4\u662f\u4ee5\u8868\u4e3a\u5355\u4f4d\u6765\u6536\u96c6\u548c\u5b58\u50a8\u7edf\u8ba1\u6570\u636e\u7684\uff0c\u4e5f\u5c31\u662f\u8bf4\u6211\u4eec\u53ef\u4ee5\u628a\u67d0\u4e9b\u8868\u7684\u7edf\u8ba1\u6570\u636e\uff08\u4ee5\u53ca\u8be5\u8868\u7684\u7d22\u5f15\u7edf\u8ba1\u6570\u636e\uff09\u5b58\u50a8\u5728\u78c1\u76d8\u4e0a\uff0c\u628a\u53e6\u4e00\u4e9b\u8868\u7684\u7edf\u8ba1\u6570\u636e\u5b58\u50a8\u5728\u5185\u5b58\u4e2d\u3002</p> <p>\u6211\u4eec\u53ef\u4ee5\u5728\u521b\u5efa\u548c\u4fee\u6539\u8868\u7684\u65f6\u5019\u901a\u8fc7\u6307\u5b9a(STATS_PERSISTENT,STATS_AUTO_RECALC,STATS_SAMPLE_PAGES)\u5c5e\u6027\u6765\u6307\u660e\u8be5\u8868\u7684\u7edf\u8ba1\u6570\u636e\u5b58\u50a8\u65b9\u5f0f\uff0c\u4ee5\u53ca\u5176\u4ed6\u5c5e\u6027\u3002</p> <pre><code>CREATE TABLE table1 (...) Engine=InnoDB, STATS_PERSISTENT = (1|0);\nALTER TABLE table2 Engine=InnoDB, STATS_PERSISTENT = (1|0);\n</code></pre> <p>\u6301\u4e45\u5316\u7684\u7edf\u8ba1\u6570\u636e\u5b58\u50a8\u5728 <code>mysql.innodb_index_stats</code> \u548c <code>mysql.innodb_table_stats</code> \u4e2d\uff1a</p> <ul> <li>database_name \u6570\u636e\u5e93\u540d</li> <li>table_name \u8868\u540d</li> <li>last_update \u672c\u6761\u8bb0\u5f55\u6700\u540e\u66f4\u65b0\u65f6\u95f4</li> <li>n_rows \u8868\u4e2d\u8bb0\u5f55\u7684\u6761\u6570</li> <li>clustered_index_size \u8868\u7684\u805a\u7c07\u7d22\u5f15\u5360\u7528\u7684\u9875\u9762\u6570\u91cf</li> <li>sum_of_other_index_sizes \u8868\u7684\u5176\u4ed6\u7d22\u5f15\u5360\u7528\u7684\u9875\u9762\u6570\u91cf</li> </ul> <p>\u5728 InnoDB \u5b58\u50a8\u5f15\u64ce\u4e0b\uff0c\u5176\u5bf9\u8868\u4e2d\u8bb0\u5f55\u6570\u91cf\u7684\u7edf\u8ba1\u503c n_rows \u662f\u4e0d\u51c6\u786e\u7684\u3002\u5176\u7edf\u8ba1\u65b9\u6cd5\u662f\u5148\u901a\u8fc7\u7b97\u6cd5\u9009\u53d6\u82e5\u5e72\u4e2a(\u805a\u7c07\u7d22\u5f15\u7684)\u53f6\u5b50\u8282\u70b9\u9875\u9762\uff0c\u7136\u540e\u8ba1\u7b97\u53f6\u5b50\u8282\u70b9\u9875\u9762\u4e2d\u8bb0\u5f55\u6570\u91cf\u7684\u5747\u503c\uff0c\u6700\u540e\u5c06\u5747\u503c\u4e58\u4ee5(\u805a\u7c07\u7d22\u5f15\u7684)\u53f6\u5b50\u8282\u70b9\u7684\u6570\u91cf\u5f97\u5230 n_rows \u503c\u3002\u6545\u5176\u4e0d\u662f\u4e00\u4e2a\u7cbe\u786e\u503c\uff0c\u800c\u662f\u4e00\u4e2a\u4f30\u8ba1\u503c\u3002</p> <p>\u5728\u8ba1\u7b97\u5747\u503c\u8fc7\u7a0b\u4e2d\uff0c\u5982\u679c\u9009\u53d6\u7684\u53f6\u5b50\u8282\u70b9\u8d8a\u591a\uff0c\u5219 n_rows \u503c\u8d8a\u51c6\u786e\u3002\u6545\u5728 MySQL \u4e2d\uff0c\u53ef\u901a\u8fc7\u7cfb\u7edf\u53d8\u91cf<code>innodb_stats_persistent_sample_pages</code>\u6765\u8bbe\u7f6e\u5728\u8ba1\u7b97\u6c38\u4e45\u6027\u7684\u7edf\u8ba1\u6570\u636e\u65f6\u7edf\u8ba1\u8fc7\u7a0b\u6240\u9700\u7684\u9875\u9762\u91c7\u6837\u6570\u91cf\u3002\u663e\u7136<code>innodb_stats_persistent_sample_pages</code>\u503c\u8d8a\u5927\uff0c\u7edf\u8ba1\u8fc7\u7a0b\u6240\u9700\u8017\u65f6\u4e5f\u5c31\u8d8a\u591a\u3002</p>"},{"location":"basic/9.mysql_architecture/#_21","title":"\u66f4\u65b0\u7edf\u8ba1\u6570\u636e","text":"<p>\u5f53\u7cfb\u7edf\u53d8\u91cf innodb_stats_auto_recalc \u503c\u4e3a ON\uff0c\u5373\u53ef\u5b9e\u73b0\u7edf\u8ba1\u6570\u636e\u7684\u81ea\u52a8\u66f4\u65b0\u3002\u5177\u4f53\u5730\uff0c\u4e00\u822c\u5f53\u8868\u4e2d\u53d8\u5316\u7684\u8bb0\u5f55\u6570\u8d85\u8fc7\u4e00\u5b9a\u9608\u503c\uff0cMySQL \u4f1a\u81ea\u52a8\u5f00\u59cb\u91cd\u65b0\u8fdb\u884c\u7edf\u8ba1\u3002\u53ea\u4e0d\u8fc7\u8be5\u7edf\u8ba1\u662f\u5f02\u6b65\u7684\uff0c\u6240\u4ee5\u5373\u4f7f\u6ee1\u8db3\u91cd\u65b0\u7edf\u8ba1\u7684\u6761\u4ef6\u4e5f\u4e0d\u4f1a\u7acb\u5373\u5f00\u59cb\u8ba1\u7b97\uff0c\u6709\u53ef\u80fd\u4f1a\u5ef6\u8fdf\u51e0\u79d2\u624d\u5f00\u59cb</p> <p>\u524d\u9762\u6211\u4eec\u8bf4\u4e86\uff0c\u7edf\u8ba1\u6570\u636e\u662f\u4ee5\u8868\u4e3a\u5355\u4f4d\u8fdb\u884c\u7edf\u8ba1\u7684\uff0c\u6545\u6211\u4eec\u8fd8\u53ef\u4ee5\u901a\u8fc7 STATS_AUTO_RECALC \u5c5e\u6027\u6765\u663e\u5f0f\u5730\u8bbe\u7f6e\u8868\u662f\u5426\u81ea\u52a8\u66f4\u65b0\u7edf\u8ba1\u6570\u636e\u3002\u5177\u4f53\u5730\uff0c\u5f53\u503c\u4e3a 0 \u610f\u4e3a\u4e0d\u4f1a\u8fdb\u884c\u81ea\u52a8\u66f4\u65b0\uff1b\u5f53\u503c\u4e3a 1 \u610f\u4e3a\u4f1a\u8fdb\u884c\u81ea\u52a8\u66f4\u65b0\u3002\u66f4\u591a\u5730\uff0c\u6211\u4eec\u4e00\u822c\u5f88\u5c11\u4f1a\u5728\u5efa\u8868\u65f6\u6307\u5b9a\u8be5\u5c5e\u6027\uff0c\u5219\u8be5\u8868\u5c31\u9ed8\u8ba4\u4f7f\u7528\u6211\u4eec\u4e0a\u9762\u63d0\u5230\u7684\u7cfb\u7edf\u53d8\u91cf innodb_stats_auto_recalc \u7684\u914d\u7f6e</p>"},{"location":"basic/9.mysql_architecture/#_22","title":"\u4f18\u5316\u5668\u914d\u7f6e","text":"<ol> <li>\u4e0d\u6539\u53d8\u8bed\u4e49\u7684\u60c5\u51b5\u4e0b\uff0c\u91cd\u5199 sql\u3002\u91cd\u5199\u540e\u7684 sql \u66f4\u7b80\u5355\uff0c\u66f4\u65b9\u4fbf\u5236\u5b9a\u6267\u884c\u8ba1\u5212\u3002</li> <li>\u6839\u636e\u6210\u672c\u5206\u6790\uff0c\u5236\u5b9a\u6267\u884c\u8ba1\u5212\u3002</li> </ol> <pre><code>SELECT @@optimizer_switch;\n\nindex_merge=on,\nindex_merge_union=on,\nindex_merge_sort_union=on,\nindex_merge_intersection=on,\nengine_condition_pushdown=on\nindex_condition_pushdown=on,\nmrr=on,\nmrr_cost_based=on,\nblock_nested_loop=on,\nbatched_key_access=off,\nmaterialization=on,\nsemijoin=on,\nloosescan=on,\nfirstmatch=on,\nduplicateweedout=on,\nsubquery_materialization_cost_based=on,\nuse_index_extensions=on,\ncondition_fanout_filter=on,\nderived_merge=on,\nuse_invisible_indexes=off,\nskip_scan=on,\nhash_join=on\n\n\n-- \u4fee\u6539\u4f18\u5316\u5668\nSET [GLOBAL|SESSION] optimizer_switch='command[,command]...';\n\n-- command\u8bed\u6cd5\u5982\u4e0b\uff1a\n-- default          --\u91cd\u7f6e\u4e3a\u9ed8\u8ba4\n-- opt_name=default --\u9009\u9879\u9ed8\u8ba4\n-- opt_name=off     --\u5173\u6389\u67d0\u9879\u4f18\u5316\n-- opt_name=on      --\u5f00\u542f\u67d0\u9879\u4f18\u5316\n</code></pre>"},{"location":"basic/9.mysql_architecture/#mysql_6","title":"MySQL\u4f18\u5316\u5668\u6d41\u7a0b","text":"<p>\u524d\u9762\u4e00\u5927\u5806\u662f\u6570\u636e\u5e93\u4f18\u5316\u5668\u7406\u8bba\uff0c</p> <ul> <li> <p>\u903b\u8f91\u4f18\u5316\uff1a\u5bf9\u67e5\u8be2\u505a\u903b\u8f91\u7b49\u4ef7\u53d8\u6362\uff0c\u4f8b\u5982semi-join\u3001\u5b50\u67e5\u8be2\u89e3\u5173\u8054\u3001\u8c13\u8bcd\u4e0b\u63a8\u3001\u89c6\u56fe\u5408\u5e76\u3001\u5de6\u8fde\u63a5\u8f6c\u5185\u8fde\u63a5\u3001\u7b49\u503c\u63a8\u5bfc\u7b49\u3002\u5bf9\u67e5\u8be2\u505a\u7b49\u4ef7\u53d8\u6362\u540e\uff0c\u67e5\u8be2\u751f\u6210\u66f4\u4f18\u7684\u6267\u884c\u8ba1\u5212\uff0c\u6709\u66f4\u591a\u7684\u8ba1\u5212\u9009\u62e9\u3002</p> </li> <li> <p>\u521d\u59cb\u7684\u4f18\u5316\u5206\u6790</p> </li> </ul> <p>\u5bf9\u8868\u5404\u4e2a\u53ef\u80fd\u7684\u8bbf\u95ee\u8def\u5f84\u505a\u4e00\u4e2a\u626b\u63cf\u884c\u6570\u548c\u4ee3\u4ef7\u5206\u6790\u3002\u626b\u63cf\u884c\u6570\u548c\u4ee3\u673a\u7684\u5206\u6790\uff0c\u53ef\u4ee5\u5e2e\u52a9\u540e\u7eed\u9009\u62e9\u5408\u9002\u7684\u57fa\u8868\u8def\u5f84\uff0c\u6709\u521d\u59cb\u7684Join\u8868\u6392\u5e8f\u5e2e\u52a9\u80fd\u591f\u5feb\u901f\u526a\u679d\uff0c\u540e\u7eed\u5728Join\u6761\u4ef6\u5173\u8054\u7d22\u5f15\u548c\u5e38\u91cf\u7d22\u5f15\u4e4b\u95f4\u505a\u9009\u62e9\u3002\u540c\u65f6\u4f1a\u5206\u6790\u51faConst Table\u3002Const Table\u662f\u6307\u5728\u8868\u6761\u4ef6\u4e0a\u6709primary key\u6216\u8005unique key\u7b49\u503c\u8bbf\u95ee\u7684\u8868\uff0c\u4ece\u7ea6\u675f\u6761\u4ef6\u4e0a\u786e\u8ba4\u6700\u591a\u53ea\u4f1a\u83b7\u53d6\u4e00\u884c\u6570\u636e\u3002Const Table\u5728\u4f18\u5316\u671f\u95f4\u5c31\u4f1a\u6267\u884c\uff0c\u83b7\u53d6\u8981\u8bbf\u95ee\u7684\u6570\u636e\uff0c\u76f8\u5173\u7684\u5217\u5728\u540e\u7eed\u4f18\u5316\u4e2d\u5373\u53ef\u4f5c\u4e3a\u5e38\u91cf\uff0c\u4f7f\u540e\u7eed\u4f18\u5316\u53ef\u4ee5\u66f4\u52a0\u51c6\u786e\u3002\u540c\u65f6\u5982\u679cConst Table\u4e0a\u4e0d\u5b58\u5728\u6ee1\u8db3\u6761\u4ef6\u7684\u6570\u636e\u884c\uff0c\u5728\u4f18\u5316\u671f\u95f4\u5c31\u53ef\u4ee5\u88ab\u53d1\u73b0\uff0c\u4ece\u800c\u8df3\u8fc7\u540e\u7eed\u7684\u4f18\u5316\u548c\u6267\u884c\u8fc7\u7a0b\u3002</p>"},{"location":"basic/9.mysql_architecture/#optimizer-hints","title":"Optimizer Hints","text":"<p>\u4f18\u5316\u5668\u662f\u5173\u7cfb\u6570\u636e\u5e93\u7684\u91cd\u8981\u6a21\u5757\uff0c\u5b83\u51b3\u5b9a SQL \u6267\u884c\u8ba1\u5212\u7684\u597d\u574f\u3002\u4f46\u662f\uff0c\u4f18\u5316\u5668\u7684\u5f71\u54cd\u56e0\u7d20\u5f88\u591a\uff0c\u7531\u4e8e\u6570\u636e\u53d8\u5316\u548c\u4f30\u8ba1\u51c6\u786e\u6027\u7b49\u56e0\u7d20\uff0c\u5b83\u4e0d\u80fd\u603b\u662f\u4ea7\u51fa\u6700\u4f18\u7684\u6267\u884c\u8ba1\u5212 \u3002\u9009\u62e9\u4e86\u4e0d\u540c\u7684\u6267\u884c\u8ba1\u5212\uff0c\u6267\u884c\u6548\u679c\u5dee\u5f02\u53ef\u80fd\u975e\u5e38\u5927\uff0c\u751a\u81f3\u8fbe\u5230\u6570\u91cf\u7ea7\u5dee\u5f02\uff0c\u53ef\u80fd\u5bf9\u751f\u4ea7\u7cfb\u7edf\u4ea7\u751f\u4e25\u91cd\u5f71\u54cd\u3002\u867d\u7136\u5b66\u672f\u548c\u4e1a\u754c\u957f\u671f\u81f4\u529b\u4e8e\u4f18\u5316\u5668\u7684\u6539\u8fdb\uff0c\u4f46\u5bf9\u4e8e\u4e1a\u52a1\u7cfb\u7edf\u800c\u8a00\uff0c\u5728\u4f18\u5316\u5668\u72af\u9519\u7684\u65f6\u5019\uff0c\u9700\u8981\u6709\u4e00\u4e9b\u76f4\u63a5\u6709\u6548\u7684\u5e72\u9884\u529e\u6cd5\u3002</p> <p>Optimizer Hints (\u4e0b\u6587\u7b80\u79f0 Hints ) \u662f\u4e00\u5957\u5e72\u9884\u4f18\u5316\u5668\u7684\u5b9e\u7528\u673a\u5236\uff0c\u4e0d\u540c\u6570\u636e\u5e93\u5382\u5546\u90fd\u6709\u5404\u81ea\u7684\u5b9e\u73b0\u65b9\u5f0f\u3002Oracle \u53ef\u80fd\u662f\u5c06 Hints \u673a\u5236\u53d1\u6325\u5230\u6781\u81f4\u7684\u6570\u636e\u5e93\u5927\u5382\u3002\u800c\u5373\u4f7f\u50cf PostgreSQL \u8fd9\u6837\u62d2\u7edd hints \u7684\u5b66\u9662\u6d3e\u6570\u636e\u5e93\uff0c\u201c\u6c11\u95f4\u201d\u4e5f\u81ea\u53d1\u641e\u4e86\u4e2a pg_hint_plan \u63d2\u4ef6 \uff0c\u8ba9\u5927\u5bb6\u80fd\u591f\u5c3d\u5feb\u5730\u89e3\u51b3\u6267\u884c\u8ba1\u5212\u8d70\u9519\u7684\u95ee\u9898\u3002</p> <p>Hints \u7684\u5e72\u9884\u65b9\u5f0f\u662f\u5411\u4f18\u5316\u5668\u63d0\u4f9b\u73b0\u6210\u7684\u4f18\u5316\u51b3\u7b56\uff0c\u4ece\u800c\u7f29\u5c0f\u6267\u884c\u8ba1\u5212\u7684\u9009\u62e9\u8303\u56f4\u3002\u901a\u5e38\u5728\u4eba\u4e3a\u5e72\u9884\u4f18\u5316\u5668\u65f6\uff0c\u53ea\u9700\u8981\u5728\u5173\u952e\u51b3\u7b56\u70b9\u63d0\u4f9b\u5177\u4f53\u51b3\u7b56\uff0c\u5c31\u53ef\u4ee5\u89c4\u907f\u9519\u8bef\u7684\u6267\u884c\u8ba1\u5212\uff1b\u5f53\u7136\u4e5f\u53ef\u4ee5\u63d0\u4f9b\u6240\u6709\u51b3\u7b56\uff0c\u8fd9\u6837\u53ef\u4ee5\u4ea7\u751f\u786e\u5b9a\u7684\u6267\u884c\u8ba1\u5212\u3002</p> <p>\u5728\u4f7f\u7528 hints \u7684\u65f6\u5019\uff0c\u6709\u4e00\u4e2a\u975e\u5e38\u91cd\u8981\u7684\u6982\u5ff5\uff0c\u5c31\u662f\u6807\u5b9a\u88ab\u5e72\u9884\u5bf9\u8c61\uff0c\u4e5f\u5c31\u662f\u8bf4\u4f18\u5316\u51b3\u7b56\u662f\u5982\u4f55\u5339\u914d\u7684\u3002\u7136\u540e\u624d\u662f\u65bd\u4ee5\u5177\u4f53\u52a8\u4f5c\uff0c\u5f71\u54cd\u4f18\u5316\u5668\u7684\u884c\u4e3a\u3002\u4ece\u8fd9\u4e2a\u89c6\u89d2\u6765\u770b\uff0c hints \u4e5f\u662f\u4e00\u5957\u652f\u6301\u201c\u5339\u914d-\u52a8\u4f5c\u201d\u7684\u89c4\u5219\u7cfb\u7edf\u3002</p>"},{"location":"basic/9.mysql_architecture/#_23","title":"\u4f18\u5316\u5668\u8ffd\u8e2a","text":"<p>\u5f53\u770b\u4e00\u4e2aSQL\u8bed\u53e5\u7684\u6267\u884c\u8ba1\u5212\u540e\uff0c\u540e\u7eed\u8fdb\u4e00\u6b65\u53ef\u4ee5\u5f00\u542f<code>OPTIMIZER_TRACE</code>\uff0c\u57fa\u4e8e<code>OPTIMIZER_TRACE</code>\u6355\u83b7\u7684\u4fe1\u606f\uff0c\u53bb\u505a\u66f4\u7ec6\u81f4\u7684\u8ffd\u8e2a\u5206\u6790\u3002</p> <pre><code>mysql&gt; show variables like 'Optimizer_trace%';\n+------------------------------+----------------------------------------------------------------------------+\n| Variable_name                | Value                                                                      |\n+------------------------------+----------------------------------------------------------------------------+\n| optimizer_trace              | enabled=off,one_line=off                                                   |\n| optimizer_trace_features     | greedy_search=on,range_optimizer=on,dynamic_range=on,repeated_subselect=on |\n| optimizer_trace_limit        | 1                                                                          |\n| optimizer_trace_max_mem_size | 1048576                                                                    |\n| optimizer_trace_offset       | -1                                                                         |\n+------------------------------+----------------------------------------------------------------------------+\n5 rows in set (0.00 sec)\n\nmysql&gt;\n</code></pre> <p>optimizer_trace</p> <ul> <li>enabled\uff1a\u542f\u7528/\u7981\u7528optimizer_trace\u529f\u80fd</li> <li>one_line\uff1a\u51b3\u5b9a\u4e86\u8ddf\u8e2a\u4fe1\u606f\u7684\u5b58\u50a8\u65b9\u5f0f\uff0c\u4e3aon\u8868\u793a\u4f7f\u7528\u5355\u884c\u5b58\u50a8\uff0c\u5426\u5219\u4ee5json\u6811\u7684\u6807\u51c6\u5c55\u793a\u5f62\u5f0f\u5b58\u50a8</li> </ul> <p>optimizer_trace_features</p> <p>\u8be5\u53d8\u91cf\u4e2d\u5b58\u50a8\u4e86\u8ddf\u8e2a\u4fe1\u606f\u4e2d\u53ef\u63a7\u7684\u6253\u5370\u9879\uff0c\u53ef\u4ee5\u901a\u8fc7\u8c03\u6574\u8be5\u53d8\u91cf\uff0c\u63a7\u5236\u5728<code>INFORMATION_SCHEMA.OPTIMIZER_TRACE</code>\u8868\u4e2d\u7684trace\u5217\u9700\u8981\u6253\u5370\u7684JSON\u9879\u548c\u4e0d\u9700\u8981\u6253\u5370\u7684JSON\u9879\u3002\u9ed8\u8ba4\u6253\u5f00\u8be5\u53c2\u6570\u4e0b\u7684\u6240\u6709\u9879\u3002</p> <ul> <li>greedy_search\uff1a \u5bf9\u4e8e\u6709N\u4e2a\u8868\u7684join\u64cd\u4f5c\uff0c\u53ef\u80fd\u4ea7\u751fN\u7684\u9636\u4e58\u7684\u67e5\u8be2\u8ba1\u5212\u8def\u5f84\u3002\u5982\u679c\u7981\u7528\uff0c\u5219\u4e0d\u8ddf\u8e2a\u8d2a\u5a6a\u641c\u7d22</li> <li>range_optimizer\uff1a range\u4f18\u5316\uff0c\u5982\u679c\u7981\u7528\uff0c\u5219\u4e0d\u4f1a\u8ddf\u8e2a\u8303\u56f4\u4f18\u5316\u5668</li> <li>dynamic_range\uff1a <code>dynamic range optimizer</code>\uff0c\u5982\u679c\u5173\u95ed\u8be5\u9009\u9879\u7684\u8bdd\uff0c\u53ea\u6709\u7b2c\u4e00\u6b21\u8c03\u7528<code>JOIN_TAB::SQL_SELECT</code>\u624d\u88ab\u8ddf\u8e2a</li> <li>repeated_subselect \uff1a\u5b50\u67e5\u8be2\uff0c\u5982\u679c\u5173\u95ed\u7684\u8bdd\uff0c\u53ea\u6709\u7b2c\u4e00\u6b21\u8c03\u7528<code>Item_subselect</code>\u624d\u88ab\u8ddf\u8e2a</li> </ul> <p>optimizer_trace_max_mem_size - optimizer_trace\u5185\u5b58\u7684\u5927\u5c0f\uff0c\u5982\u679c\u8ddf\u8e2a\u4fe1\u606f\u8d85\u8fc7\u8fd9\u4e2a\u5927\u5c0f\uff0c\u4fe1\u606f\u5c06\u4f1a\u88ab\u622a\u65ad</p> <p>optimizer_trace_limit - optimizer_trace_limit\uff0c\u7ea6\u675f\u8ddf\u8e2a\u4fe1\u606f\u5b58\u50a8\u7684\u4e2a\u6570</p> <p>optimizer_trace_offset - optimizer_trace_offset\uff0c\u7ea6\u675f\u504f\u79fb\u91cf</p>"},{"location":"basic/9.mysql_architecture/#_24","title":"\u4e0b\u63a8","text":"<p>\u8ba1\u7b97\u4e0b\u63a8\u662f\u6570\u636e\u5e93\u4f18\u5316\u5668\u4f18\u5316\u67e5\u8be2\u6027\u80fd\u7684\u4e00\u79cd\u5e38\u89c1\u624b\u6bb5\uff0c\u65e9\u671f\u7684\u6570\u636e\u5e93\u7cfb\u7edf\u63d0\u53ca\u7684\u8ba1\u7b97\u4e0b\u63a8\u4e00\u822c\u662f\u6307\u8c13\u8bcd\u4e0b\u63a8\uff0c\u5176\u7406\u8bba\u6e90\u81ea\u5173\u7cfb\u4ee3\u6570\u7406\u8bba\u3002</p> <p>2000 \u5e74\u4ee5\u540e\uff0c\u968f\u7740 Oracle RAC \u7684\u76db\u884c\u4ee5\u53ca\u4e00\u4f17\u5f00\u6e90\u5206\u5e03\u5f0f\u6570\u636e\u5e93\u7684\u5d1b\u8d77\uff0c\u5b58\u7b97\u5206\u79bb\u7684\u6982\u5ff5\u9010\u6b65\u6d41\u884c\uff0c\u8ba1\u7b97\u4e0b\u63a8\u7684\u6db5\u76d6\u8303\u56f4\u7531\u6b64\u4ece\u57fa\u672c\u7684\u8c13\u8bcd+\u6295\u5f71\u4e0b\u63a8\u5ef6\u4f38\u5230\u4e86\u6570\u636e\u5e93\u6240\u652f\u6301\u7684\u4e00\u5207\u53ef\u80fd\u8ba1\u7b97\u7684\u4e0b\u63a8\uff08JOIN\u3001\u805a\u5408\u3001\u5b8c\u6574 query\u3001\u90e8\u5206 query \u7b49\uff09\u3002</p> <p>\u5bf9\u4e8e\u5355\u673a\u6570\u636e\u5e93\u6765\u8bf4\uff0c\u5c24\u5176\u662f MySQL \u8fd9\u79cd\u91c7\u7528\u7ecf\u5178\u706b\u5c71\u6a21\u578b\u7684\u5173\u7cfb\u578b\u6570\u636e\u5e93\uff0c\u6700\u5e38\u89c1\u7684\u5c31\u662f\u8c13\u8bcd\u4e0b\u63a8\u3001\u6295\u5f71\u4e0b\u63a8\uff0c\u901a\u5e38\u5728\u67e5\u8be2\u4f18\u5316\u7684 RBO \u9636\u6bb5\u5b8c\u6210\uff08\u6709\u7684\u4e0b\u63a8\u5728 CBO \u9636\u6bb5\uff09\uff0c\u901a\u8fc7\u5c06 Filter \u548c Project \u7b97\u5b50\u5728\u62bd\u8c61\u8bed\u6cd5\u6811\uff08AST\uff09\u4e2d\u5411\u4e0b\u79fb\u52a8\uff0c\u63d0\u524d\u5bf9\u884c/\u5217\u8fdb\u884c\u88c1\u526a\uff0c\u51cf\u5c11\u540e\u7eed\u8ba1\u7b97\u7684\u6570\u636e\u91cf\u3002</p> <p>\u5f53\u7136\uff0cMySQL \u4e2d\u4e0d\u4ec5\u4ec5\u662f\u8c13\u8bcd\u4e0b\u63a8\u3001\u6295\u5f71\u4e0b\u63a8\uff0c\u8fd8\u6709\u6761\u4ef6\u4e0b\u63a8\u3001ICP \u7b49\u3002</p> <p>\u4e0b\u63a8\u662f\u67e5\u8be2\u6539\u5199\u7684\u4e00\u9879\u91cd\u8981\u4f18\u5316\u3002\u67e5\u8be2\u4e0b\u63a8\u4e0d\u4ec5\u53ef\u4ee5\u964d\u4f4e\u6570\u636e\u7684 IO\uff0c\u800c\u4e14\u80fd\u591f\u8282\u7701\u5185\u5b58\uff0c\u51cf\u5c11 CPU \u7684\u8ba1\u7b97\u91cf\u7b49\uff0c\u7279\u522b\u662f\u5bf9\u4e8e\u5206\u5e03\u5f0f\u7684\u6570\u636e\u5904\u7406\u60c5\u5883\u4e2d\uff0c\u67e5\u8be2\u4e0b\u63a8\u80fd\u591f\u5bf9\u67e5\u8be2\u6027\u80fd\u6709\u4e00\u4e2a\u663e\u8457\u7684\u63d0\u5347\u3002</p> <p>\u67e5\u8be2\u4e0b\u63a8\u53ef\u4ee5\u4ece\u4e24\u4e2a\u4e24\u4e2a\u65b9\u9762\u6765\u7406\u89e3\uff1a\u4ece\u903b\u8f91\u4f18\u5316\u7684\u89d2\u5ea6\u6765\u770b\uff0c\u67e5\u8be2\u4e0b\u63a8\u5c5e\u4e8e\u662f\u5c06\u903b\u8f91\u67e5\u8be2\u6811\u4e2d\u7684\u4e00\u4e9b\u8282\u70b9\u4e0b\u63a8\u5230\u53f6\u5b50\u7ed3\u70b9\u6216\u63a5\u8fd1\u53f6\u5b50\u7ed3\u70b9\uff0c\u5373\u66f4\u63a5\u8fd1\u6570\u636e\u6e90\u7684\u5730\u65b9\uff0c\u4ece\u800c\u4f7f\u5f97\u4e0a\u5c42\u8282\u70b9\u7684\u64cd\u4f5c\u6240\u6d89\u53ca\u5230\u7684\u6570\u636e\u91cf\u5927\u5927\u51cf\u5c11\uff0c\u63d0\u9ad8\u6570\u636e\u5904\u7406\u6548\u7387</p>"},{"location":"basic/9.mysql_architecture/#_25","title":"\u6d3e\u751f\u6761\u4ef6\u4e0b\u63a8","text":"<p>MySQL 8.0.22 \u53ca\u66f4\u9ad8\u7248\u672c\u652f\u6301\u7b26\u5408\u6761\u4ef6\u7684\u5b50\u67e5\u8be2\u7684\u6d3e\u751f\u6761\u4ef6\u4e0b\u63a8\u3002</p> <p>\u5bf9\u4e8e\u5982</p> <pre><code>SELECT * FROM (SELECT i\uff0cj FROM t1) AS dt WHERE i &gt; constant\n</code></pre> <p>\u5728\u8bb8\u591a\u60c5\u51b5\u4e0b\uff0c\u53ef\u4ee5\u5c06\u5916\u90e8<code>WHERE</code>\u6761\u4ef6\u4e0b\u63a8\u5230\u6d3e\u751f\u8868\uff0c\u76f8\u5f53\u4e8e\u6539\u5199\u6210\u5982\u4e0b SQL</p> <pre><code>SELECT * FROM (SELECT i, j FROM t1 WHERE i &gt; constant) AS dt\n</code></pre> <p>\u8fd9\u51cf\u5c11\u4e86\u6d3e\u2f63\u8868\u8fd4\u56de\u7684\u2f8f\u6570\uff0c\u4ece\u2f7d\u52a0\u5feb\u67e5\u8be2\u7684\u901f\u5ea6\u3002</p> <p>\u6d3e\u751f\u6761\u4ef6\u4e0b\u63a8\u4e00\u53e5\u8bdd\u7406\u89e3\u5373\u4e3a\uff1a\u5916\u67e5\u8be2\u4e0e\u6d3e\u751f\u8868\u76f8\u5173\u7684\u6761\u4ef6\u4f1a\u88ab\u63a8\u5165\u5230\u6d3e\u751f\u8868\u4e2d\u4f5c\u4e3a\u6761\u4ef6\uff0c\u4ee5\u51cf\u5c11\u5904\u7406\u7684\u6570\u636e\u884c\u6570\uff0c\u52a0\u901f\u67e5\u8be2\u901f\u5ea6</p> <p>https://dev.mysql.com/doc/refman/8.0/en/derived-condition-pushdown-optimization.html</p> <p>\u5f53\u6d3e\u751f\u8868\u65e0\u6cd5\u5408\u5e76\u5230\u5916\u90e8\u67e5\u8be2\u4e2d\u65f6\uff08\u4f8b\u5982\uff1a\u5982\u679c\u6d3e\u751f\u8868\u4f7f\u7528\u805a\u5408\uff09\uff0c\u5c06\u5916\u90e8 WHERE \u6761\u4ef6\u4e0b\u63a8\u5230\u6d3e\u751f\u8868\u5e94\u8be5\u4f1a\u51cf\u5c11\u9700\u8981\u5904\u7406\u7684\u884c\u6570\uff0c\u4ece\u800c\u52a0\u5feb\u67e5\u8be2\u7684\u6267\u884c\u3002</p>"},{"location":"basic/9.mysql_architecture/#_26","title":"\u7d22\u5f15\u4e0b\u63a8","text":"<p>ICP</p>"},{"location":"basic/9.mysql_architecture/#_27","title":"\u8c13\u8bcd\u4e0b\u63a8","text":"<p>\u6570\u636e\u5e93\u4e2d\u6709\u4e2a\u6982\u5ff5\u53eb \u8c13\u8bcd\u4e0b\u63a8 </p> <p>\u5728\u73b0\u4ee3\u6570\u636e\u5e93\u7cfb\u7edf\u4e2d\uff0c\u7528\u6237\u573a\u666f\u7684SQL\u67e5\u8be2\u5f80\u5f80\u590d\u6742\u591a\u6837\uff0c\u6d89\u53ca\u591a\u4e2a\u8868\u7684\u8fde\u63a5\u3001\u5b50\u67e5\u8be2\u4ee5\u53ca\u5404\u79cd\u805a\u5408\u64cd\u4f5c\u3002\u8fd9\u79cd\u590d\u6742\u6027\u4f7f\u5f97\u67e5\u8be2\u6027\u80fd\u4f18\u5316\u53d8\u5f97\u5c24\u4e3a\u91cd\u8981\u3002\u5728\u8fd9\u4e00\u80cc\u666f\u4e0b\uff0c\u8c13\u8bcd\u4e0b\u63a8\uff08Predicate Pushdown\uff09\u4f5c\u4e3a\u4e00\u79cd\u91cd\u8981\u7684\u542f\u53d1\u5f0f\u4f18\u5316\u89c4\u5219\uff0c\u88ab\u5e7f\u6cdb\u5e94\u7528\u4e8e\u4f18\u5316\u5668\u7684\u67e5\u8be2\u6a21\u5757\u4e2d\u3002\u5b83\u7684\u6838\u5fc3\u601d\u60f3\u662f\u5c06\u67e5\u8be2\u6761\u4ef6\uff08\u5373\u8c13\u8bcd\uff09\u5c3d\u53ef\u80fd\u65e9\u5730\u5e94\u7528\u4e8e\u6570\u636e\u6e90\uff0c\u4ee5\u51cf\u5c11\u540e\u7eed\u64cd\u4f5c\u7684\u6570\u636e\u91cf\u3002\u7b80\u800c\u8a00\u4e4b\uff0c\u5c31\u662f\u5728\u5c3d\u65e9\u7684\u9636\u6bb5\u5bf9\u6570\u636e\u8fdb\u884c\u7b5b\u9009\uff0c\u4ee5\u907f\u514d\u4e0d\u5fc5\u8981\u7684\u6570\u636e\u5904\u7406\uff0c\u4ece\u800c\u63d0\u9ad8\u67e5\u8be2\u6027\u80fd\u3002</p> <p>\u5982\u679c\u4e00\u4e2a\u8c13\u8bcd\u5728\u6267\u884c\u8ba1\u5212\u4e2d\u5373\u4f7f\u5904\u5728\u4e0d\u540c\u7684\u4f4d\u7f6e\u4e5f\u4e0d\u6539\u53d8\u6267\u884c\u7ed3\u679c\uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u5c3d\u91cf\u628a\u5b83\u4fdd\u6301\u5728\u4e0b\u5c42(\u5c3d\u91cf\u9760\u8fd1\u5b58\u50a8\u5c42)\uff0c\u56e0\u4e3a\u5b83\u6709\"\u8fc7\u6ee4\"\u7684\u4f5c\u7528\u3002\u5728\u4e0b\u5c42\u7ed3\u70b9\u628a\u6570\u636e\u8fc7\u6ee4\u6389\uff0c\u6709\u52a9\u4e8e\u964d\u4f4e\u4e0a\u5c42\u7ed3\u70b9\u7684\u8ba1\u7b97\u91cf\u3002\u5f53\u7136\u5bf9\u4e8e\u4e00\u4e9b\u6bd4\u8f83\u6267\u7740\u7684\u8c13\u8bcd<code>SQL</code>\u7684\u4e66\u5199\u8005\u628a\u5b83\u5b89\u6392\u5728\u4e86\u4e0a\u5c42\uff0c\u6211\u4eec\u5728\u751f\u6210\u6267\u884c\u8ba1\u5212\u7684\u65f6\u5019\u5c31\u53ef\u4ee5\u8003\u8651\u662f\u5426\u80fd\u628a\u5b83\u63a8\u4e0b\u53bb\u3002\u8fd9\u5c31\u9700\u8981\u8fdb\u884c\u7504\u522b\uff0c\u54ea\u4e9b\u8c13\u8bcd\u662f\u53ef\u4ee5\u63a8\u4e0b\u53bb\u7684\uff0c\u800c\u54ea\u4e9b\u8c13\u8bcd\u662f\u65e0\u6cd5\u63a8\u4e0b\u53bb\u7684\u3002</p> <ul> <li>\u8fc7\u6ee4\u6761\u4ef6\uff1a\u5904\u5728 WHERE \u5173\u952e\u5b57\u540e\u9762\u7684\u7ea6\u675f\u6761\u4ef6\u662f\u8fc7\u6ee4\u6761\u4ef6\u3002</li> <li>\u8fde\u63a5\u6761\u4ef6\uff1a\u5904\u5728 ON \u5173\u952e\u5b57\u540e\u9762\u7684\u7ea6\u675f\u6761\u4ef6\u662f\u8fde\u63a5\u6761\u4ef6\u3002</li> </ul> <p>\u5982\u679c\u4e24\u4e2a\u8868\u8981\u505a\u7684\u662f\u5185\u8fde\u63a5\uff0c\u5b9e\u9645\u4e0a\u5b83\u662f\u65e0\u9700\u533a\u5206\u8fde\u63a5\u6761\u4ef6\u8fd8\u662f\u8fc7\u6ee4\u6761\u4ef6\u7684\u3002\u56e0\u4e3a\u5373\u4f7f\u662f\u5904\u5728 ON \u5173\u952e\u5b57\u540e\u9762\u7684\u8fde\u63a5\u6761\u4ef6\uff0c\u4e5f\u53ea\u6709\u8fc7\u6ee4\u7684\u4f5c\u7528\uff0c\u5185\u8fde\u63a5\u4e0d\u4f1a\u53bb\u8865 NULL \u503c\uff0c\u6240\u4ee5\u5728\u5185\u8fde\u63a5\u7684\u65f6\u5019\u8fc7\u6ee4\u6761\u4ef6\u548c\u8fde\u63a5\u6761\u4ef6\u662f\u7b49\u4ef7\u7684\u3002</p> <p>\u8c13\u8bcd\u4e0b\u63a8\u7684\u57fa\u672c\u601d\u60f3\u662f\u5c06\u8fc7\u6ee4\u8868\u8fbe\u5f0f\u5c3d\u53ef\u80fd\u79fb\u52a8\u81f3\u9760\u8fd1\u6570\u636e\u6e90\u7684\u4f4d\u7f6e\uff0c\u4ee5\u4f7f\u771f\u6b63\u6267\u884c\u65f6\u80fd\u76f4\u63a5\u8df3\u8fc7\u65e0\u5173\u7684\u6570\u636e\u3002\u7528\u5728 SQL \u4f18\u5316\u4e0a\u6765\u8bf4\uff0c\u5c31\u662f\u5148\u8fc7\u6ee4\u518d\u505a\u805a\u5408\u7b49\u64cd\u4f5c\u3002</p> <p><code>predicate push down</code> \u7ffb\u8bd1\u4e3a\u8c13\u8bcd\u4e0b\u63a8\uff0c\u8fd9\u4e2a\u7ffb\u8bd1\u5f88\u51c6\u786e\uff0c\u660e\u786e\u7684\u544a\u8bc9\u4e86\u6211\u4eec\u8fd9\u4e2a\u64cd\u4f5c\u662f\u4e00\u4e2a\u4ec0\u4e48\u52a8\u4f5c\u3002</p> <p><code>predicate\uff08\u8c13\u8bcd\uff09</code>\u5373\u6761\u4ef6\u8868\u8fbe\u5f0f\uff0c\u5728 SQL \u4e2d\uff0c\u8c13\u8bcd\u5c31\u662f\u8fd4\u56de<code>boolean</code>\u503c\u5373<code>true</code>\u6216<code>false</code>\u7684\u51fd\u6570\uff0c\u6216\u662f\u9690\u5f0f\u8f6c\u6362\u4e3a<code>bool</code>\u7684\u51fd\u6570\u3002</p> <p><code>SQL</code>\u4e2d\u7684\u8c13\u8bcd\u4e3b\u8981\u6709 <code>LIKE\u3001BETWEEN\u3001IS NULL\u3001IS NOT NULL\u3001IN\u3001EXISTS</code>\u3002\u5176\u7ed3\u679c\u4e3a\u5e03\u5c14\u503c\uff0c\u5373<code>true</code>\u6216<code>false</code>\u3002</p> <p><code>predicate pushdown</code>\u662f\u5c06 SQL \u8bed\u53e5\u4e2d\u7684\u90e8\u5206\u8bed\u53e5( predicates \u8c13\u8bcd\u90e8\u5206) \u53ef\u4ee5\u88ab \"pushed\" \u4e0b\u63a8\u5230\u6570\u636e\u6e90\u6216\u8005\u9760\u8fd1\u6570\u636e\u6e90\u7684\u90e8\u5206\u3002</p> <p>\u901a\u8fc7\u5c3d\u65e9\u8fc7\u6ee4\u6389\u6570\u636e\uff0c\u8fd9\u79cd\u5904\u7406\u65b9\u5f0f\u80fd\u5927\u5927\u51cf\u5c11\u6570\u636e\u5904\u7406\u7684\u91cf\uff0c\u964d\u4f4e\u8d44\u6e90\u6d88\u8017\uff0c\u5728\u540c\u6837\u7684\u670d\u52a1\u5668\u73af\u5883\u4e0b\uff0c\u6781\u5927\u5730\u51cf\u5c11\u4e86\u67e5\u8be2/\u5904\u7406\u65f6\u95f4\u3002</p> <p>\u5728<code>Hive SQL</code>\u548c<code>Spark SQL</code>\u7b49\u4e00\u7cfb\u5217<code>SQL ON Hadoop</code>\u7684\u89e3\u6790\u8bed\u6cd5\u6811\u65f6\u90fd\u5728\u8c13\u8bcd\u4e0b\u63a8\u65b9\u9762\u4f5c\u51fa\u4e86\u4f18\u5316\uff0c\u5176\u5b9e\u5728\u4f7f\u7528<code>SQL</code>\u7684\u8fc7\u7a0b\uff0c\u6211\u4eec\u5fc3\u4e2d\u8bb0\u4f4f\u8fd9\u662f\u4e00\u79cd\u5c06\u8fc7\u6ee4\u5c3d\u53ef\u80fd\u5728\u9760\u8fd1\u6570\u636e\u6e90\uff08\u53d6\u6570\u636e\uff09\u7684\u65f6\u5019\u5b8c\u6210\u7684\u4e00\u79cd\u64cd\u4f5c\uff0c\u662f\u6570\u636e\u5e93\u7684\u4e00\u79cd\u7ecf\u5178\u7684\u4f18\u5316\u624b\u6bb5\u3002</p> <p>\u5728\u4f20\u7edf\u6570\u636e\u5e93\u7684\u67e5\u8be2\u7cfb\u7edf\u4e2d\u8c13\u8bcd\u4e0b\u63a8\u4f5c\u4e3a\u4f18\u5316\u624b\u6bb5\u5f88\u65e9\u5c31\u51fa\u73b0\u4e86\uff0c\u8c13\u8bcd\u4e0b\u63a8\u7684\u76ee\u7684\u5c31\u662f\u901a\u8fc7\u5c06\u4e00\u4e9b\u8fc7\u6ee4\u6761\u4ef6\u5c3d\u53ef\u80fd\u7684\u5728\u6700\u5e95\u5c42\u6267\u884c\u53ef\u4ee5\u51cf\u5c11\u6bcf\u4e00\u5c42\u4ea4\u4e92\u7684\u6570\u636e\u91cf\uff0c\u4ece\u800c\u63d0\u5347\u6027\u80fd\u3002\u4f8b\u5982\u4e0b\u9762\u8fd9\u4e2a\u4f8b\u5b50\uff1a</p> <pre><code>select count(1) from A Join B on A.id = B.id where A.a &gt; 10 and B.b &lt; 100;\n\n-- \u5bf9\u4e8e\u8fd9\u4e2aSQL\u8bed\u53e5\uff0c\u5728MySQL\u5185\u90e8\uff0c\u5927\u6982\u53ef\u4ee5\u6709\u4e24\u79cd\u65b9\u5f0f\u6267\u884c\uff0c\u4e00\u79cd\u662f\u5206\u522b\u5bf9A\u548cB\u5168\u8868\u626b\u63cf\u5e76\u5173\u8054\u67e5\u8be2\u51fa\u7ed3\u679c\u96c6\uff0c\u518d\u5bf9\u7ed3\u679c\u96c6\u5206\u522b\u8fdb\u884c\u6309\u7167 where \u6761\u4ef6\u8fc7\u6ee4\uff0c\u6700\u7ec8\u5f97\u51fa\u7ed3\u679c\u3002\u663e\u7136\u8fd9\u4e2a\u6548\u7387\u4e0d\u9ad8\uff0c\u8868\u5173\u8054\u7684\u5f00\u9500\u662f\u5f88\u5927\u7684\u3002\n\n-- \u7b2c\u4e8c\u79cd\u65b9\u5f0f\uff0c\u5148\u5206\u522b\u5bf9\u4e24\u4e2a\u8868\u6309\u7167where\u67e5\u627e\u540e\uff0c\u5206\u522b\u751f\u6210\u4e34\u65f6\u7684\u7ed3\u679c\u96c6\uff0c\u7136\u540e\u518d\u5173\u8054\u67e5\u8be2\uff0c\u53ef\u4ee5\u5927\u5927\u964d\u4f4eJoin\u64cd\u4f5c\u7684\u8f93\u5165\u6570\u636e\u91cf\u3002\u4f18\u5316\u540e\u7684SQL\u5982\u4e0b\uff1a\n\nselect count(1) from (select *  from A  where a&gt;10)A1 Join (select *  from B  where b&lt;100)B1 on A1.id = B1.id;\n\n-- \u65e0\u8bba\u662f\u884c\u5f0f\u5b58\u50a8\u8fd8\u662f\u5217\u5f0f\u5b58\u50a8\uff0c\u90fd\u53ef\u4ee5\u5728\u5c06\u8fc7\u6ee4\u6761\u4ef6\u5728\u8bfb\u53d6\u4e00\u6761\u8bb0\u5f55\u4e4b\u540e\u6267\u884c\u4ee5\u5224\u65ad\u8be5\u8bb0\u5f55\u662f\u5426\u9700\u8981\u8fd4\u56de\u7ed9\u8c03\u7528\u8005\uff0c\u5728Parquet\u505a\u4e86\u66f4\u8fdb\u4e00\u6b65\u7684\u4f18\u5316\uff0c\u4f18\u5316\u7684\u65b9\u6cd5\u65f6\u5bf9\u6bcf\u4e00\u4e2aRow Group\u7684\u6bcf\u4e00\u4e2aColumn Chunk\u5728\u5b58\u50a8\u7684\u65f6\u5019\u90fd\u8ba1\u7b97\u5bf9\u5e94\u7684\u7edf\u8ba1\u4fe1\u606f\n</code></pre>"},{"location":"basic/9.mysql_architecture/#rewrite","title":"\u67e5\u8be2\u91cd\u5199 REWRITE","text":"<p>\u67e5\u8be2\u91cd\u5199(query rewrite)\uff1a\u6309\u7167\u4e00\u7cfb\u5217\u5173\u7cfb\u4ee3\u6570\u8868\u8fbe\u5f0f\u7684\u7b49\u4ef7\u89c4\u5219\uff0c\u5bf9\u67e5\u8be2\u7684\u5173\u7cfb\u4ee3\u6570\u8868\u8fbe\u5f0f\u8fdb\u884c\u7b49\u4ef7\u8f6c\u6362\uff0c\u4ece\u800c\u63d0\u9ad8\u67e5\u8be2\u6267\u884c\u6548\u7387\u3002</p> <p>\u5173\u7cfb\u8868\u8fbe\u5f0f\u7684\u7b49\u4ef7\uff08equivalent\uff09\uff1a\u5bf9\u4e8e\u4e24\u4e2a\u5173\u7cfb\u4ee3\u6570\u8868\u8fbe\u5f0f\uff0c\u5982\u679c\u4f7f\u7528\u76f8\u540c\u7684\u5173\u7cfb\u5bf9\u8868\u8fbe\u5f0f\u4e2d\u7684\u5173\u7cfb\u8fdb\u884c\u66ff\u6362\uff0c\u603b\u80fd\u5f97\u5230\u5b8c\u5168\u76f8\u540c\u7684\u7ed3\u679c\uff0c\u5219\u79f0\u8fd9\u4e24\u4e2a\u5173\u7cfb\u8868\u8fbe\u5f0f\u7b49\u4ef7</p> <p>\u57fa\u4e8e\u5173\u7cfb\u4ee3\u6570\u7b49\u4ef7\u89c4\u5219\u505a\u7b49\u4ef7\u53d8\u6362\u7684\u4f18\u5316\uff0c\u5c31\u662f\u57fa\u4e8e\u89c4\u5219\u7684\u4f18\u5316\u3002</p> <p>\u5728\u5185\u6838\u4e2d\u8981\u5b9e\u73b0\u8fd9\u4e9b\u6539\u5199\u7b97\u6cd5\u662f\u6781\u5177\u6311\u6218\u6027\u7684\u3002\u5728\u4e1a\u52a1\u5c42\u6539\u5199 SQL \u5f88\u7b80\u5355\uff0c\u56e0\u4e3a\u6211\u4eec\u7684\u4efb\u52a1\u53ea\u662f\u6539\u5bf9\u4e00\u6761\u5df2\u77e5\u7684 SQL\u3002\u5728\u5185\u6838\u5c42\u6539\u5199\u975e\u5e38\u56f0\u96be\uff0c\u56e0\u4e3a\u6211\u4eec\u7684\u4efb\u52a1\u662f\u7ed9\u5b9a\u4efb\u610f\u4e00\u6761 SQL\uff0c\u5982\u679c\u53ef\u4ee5\u6539\u5199\u8981\u5c3d\u53ef\u80fd\u7684\u6539\u5199\uff0c\u540c\u65f6\u6539\u5199\u5fc5\u987b\u662f\u6b63\u786e\u7684\u3002\u8fd9\u5176\u5b9e\u5bf9\u6539\u5199\u7b97\u6cd5\u63d0\u51fa\u4e86\u4e24\u70b9\u8981\u6c42\uff1a</p> <ul> <li>\u6b63\u786e\uff1a\u6539\u5199\u540e\u7684<code>SQL</code>\u8bed\u4e49\u4e0d\u80fd\u6539\u53d8\u3002</li> <li>\u5b8c\u5907\uff1a\u53ef\u4ee5\u6539\u5199\u7684<code>SQL</code>\u8981\u80fd\u591f\u6539\u5199\u3002</li> </ul> <p>\u6b63\u786e\u6027\u975e\u5e38\u5bb9\u6613\u7406\u89e3\uff0c\u5982\u679c\u4e00\u4e2a\u6539\u5199\u7684\u7ed3\u679c\u662f\u9519\u8bef\u7684\uff0c\u8fd9\u5bf9\u4e1a\u52a1\u7684\u4ef7\u503c\u5b8c\u5168\u662f\u8d1f\u9762\u7684\u3002\u5b8c\u5907\u6027\u540c\u6837\u91cd\u8981\uff0c\u5b83\u8981\u6c42\u4e00\u4e2a\u6539\u5199\u7b97\u6cd5\u5177\u6709\u8f83\u597d\u7684\u901a\u7528\u6027\uff0c\u4e0d\u80fd\u53ea\u5904\u7406\u4e00\u4e9b\u7b80\u5355\u7684\u573a\u666f\uff0c\u800c\u4e0d\u5904\u7406\u590d\u6742\u7684\u573a\u666f\u3002\u901a\u7528\u6027\u5dee\u5bf9\u4e1a\u52a1\u7684\u4ef7\u503c\u662f\u6709\u9650\u7684\u3002\u5f53\u7136\uff0c\u6211\u4eec\u5f88\u96be\u628a\u4e00\u4e2a\u6539\u5199\u7b97\u6cd5\u505a\u5230\u5b8c\u5168\u7684\u5b8c\u5907\u3002\u56e0\u4e3a\u603b\u6709\u4e00\u4e9b\u975e\u5e38\u590d\u6742\u7684\u60c5\u5f62\u662f\u5f88\u96be\u5904\u7406\u7684\uff0c\u5f3a\u884c\u6539\u5199\u53ef\u80fd\u4f1a\u5f15\u5165\u6b63\u786e\u6027\u95ee\u9898\u3002\u5728\u5b9e\u73b0\u4e00\u4e2a\u6539\u5199\u7b97\u6cd5\u7684\u8fc7\u7a0b\u4e2d\uff0c\u6211\u4eec\u4f1a\u5728\u786e\u4fdd\u6b63\u786e\u7684\u524d\u63d0\u4e0b\uff0c\u5c3d\u53ef\u80fd\u7684\u505a\u5230\u5b8c\u5907\u3002</p> <p>\u8fd9\u4e2a\u9636\u6bb5\uff0c\u4e3b\u8981\u662f\u5bf9\u539f\u6765\u7684\u8bed\u6cd5\u6811\u8fdb\u884c\u7b49\u4ef7\u8bed\u4e49\u7684\u91cd\u5199\uff0c\u901a\u5e38\u662f\u6839\u636e\u9884\u5148\u5b9a\u4e49\u597d\u7684\u89c4\u5219\u6765\u8fdb\u884c\u91cd\u5199\uff0c\u4f18\u5316\u6389\u4e00\u4e9b\u65e0\u6548\u6216\u8005\u65e0\u610f\u4e49\u7684\u64cd\u4f5c\u3002\u6362\u53e5\u8bdd\u8bf4\uff0c\u6709\u65f6\u5019\u7a0b\u5e8f\u5458\u5199\u7684 SQL \u901a\u5e38\u662f\u7ed3\u679c\u5bfc\u5411\u7684\uff0c\u5e76\u4e0d\u4e13\u95e8\u9488\u5bf9\u6267\u884c\u53bb\u4f18\u5316\uff0c\u800c\u4e14\uff0c\u5f88\u591a\u65f6\u5019\u8fd8\u4f1a\u6709\u610f\u65e0\u610f\u5f15\u5165\u65e0\u610f\u4e49\u7684\u64cd\u4f5c\u3002</p> <pre><code>SELECT\n    class.name AS class_name,\n    student.name AS student_name, \n    student.id AS student_id\nFROM\n    class, student\nWHERE   \n    class.id = student.class_id AND   \n    student.name = 'ZhangSan';\n</code></pre> <p>\u4e0a\u8ff0\u8bed\u53e5\u8fd4\u56de\u8fd9\u4e2a\u5b66\u6821\u6240\u6709\u53eb ZhangSan \u7684\u5b66\u751f\u7684\u59d3\u540d\uff0c\u5b66\u53f7\uff0c\u4ee5\u53ca\u73ed\u7ea7\u3002</p> <p>\u6211\u4eec\u81ea\u4e0b\u800c\u4e0a\u5730\u6765\u770b\u3002\u9996\u5148\u6267\u884c\u8ba1\u5212\u8981\u6c42\u626b\u63cf\u5168\u8868 class \u548c\u8868 student\uff0c\u7136\u540e\u5bf9\u5176\u8fdb\u884c Join\uff0cjoin \u6761\u4ef6\u662f class.id = student.class_id\u3002</p> <p>join \u5b8c\u4e4b\u540e\uff0c\u5bf9\u4e8e tuple \u8fdb\u884c filter\uff0cfilter \u6761\u4ef6\u662f student.name = 'ZhangSan'\u3002\u6700\u540e\uff0c\u5bf9\u4e8e filter \u540e\u7684 tuple\uff0c\u8fdb\u884c projection\uff0c\u53ea\u6709 3 \u4e2a column \u4f5c\u4e3a\u8f93\u51fa class.name, student.name \u548c student.id\u3002</p>"},{"location":"basic/9.mysql_architecture/#_28","title":"\u6295\u5f71\u4e0b\u63a8","text":"<p><code>Projections push down</code>\u3002\u901a\u8fc7\u628a\u7528\u5230\u7684\u54ea\u4e9b column \u5f80\u4e0b\u63a8\u9001\u76f4\u5230\u53f6\u8282\u70b9\u7684 table scan\uff0c\u53ef\u4ee5\u51cf\u5c11\u626b\u63cf\u540e\u6570\u636e\u7684\u5927\u5c0f\uff0c\u540c\u65f6\u4e5f\u53ef\u4ee5\u63d0\u5347\u626b\u63cf\u901f\u5ea6\u3002</p>"},{"location":"basic/9.mysql_architecture/#_29","title":"\u5916\u8fde\u63a5\u6d88\u9664","text":"<p>\u5916\u8fde\u63a5\u6d88\u9664\u7684\u610f\u4e49\uff1a</p> <p>1 \u67e5\u8be2\u4f18\u5316\u5668\u5728\u5904\u7406\u5916\u8fde\u63a5\u64cd\u4f5c\u65f6\u6240\u9700\u6267\u884c\u7684\u64cd\u4f5c\u548c\u65f6\u95f4\u591a\u4e8e\u5185\u8fde\u63a5 2 \u5916\u8fde\u63a5\u6d88\u9664\u540e\uff0c\u4f18\u5316\u5668\u5728\u9009\u62e9\u591a\u8868\u8fde\u63a5\u987a\u5e8f\u65f6\uff0c\u53ef\u4ee5\u6709\u66f4\u591a\u66f4\u7075\u6d3b\u7684\u9009\u62e9\uff0c\u4ece\u800c\u53ef\u4ee5\u9009\u62e9\u66f4\u597d\u7684\u8868\u8fde\u63a5\u987a\u5e8f\uff0c\u52a0\u5feb\u67e5\u8be2\u6267\u884c\u7684\u901f\u5ea6 3 \u8868\u7684\u4e00\u4e9b\u8fde\u63a5\u7b97\u6cd5\uff08\u5982\u5757\u5d4c\u5957\u8fde\u63a5\u548c\u7d22\u5f15\u5faa\u73af\u8fde\u63a5\u7b49\uff09\u5728\u5c06\u89c4\u6a21\u5c0f\u7684\u6216\u7b5b\u9009\u6761\u4ef6\u6700\u4e25\u683c\u7684\u8868\u4f5c\u4e3a\u201c\u5916\u8868\u201d\uff08\u653e\u5728\u8fde\u63a5\u987a\u5e8f\u7684\u6700\u524d\u9762\uff0c\u662f\u591a\u5c42\u5faa\u73af\u4f53\u7684\u5916\u5faa\u73af\u5c42\uff09\uff0c\u53ef\u4ee5\u51cf\u5c11\u4e0d\u5fc5\u8981\u7684I/O\u5f00\u9500\uff0c\u80fd\u52a0\u5feb\u7b97\u6cd5\u6267\u884c\u7684\u901f\u5ea6</p> <p>\u5916\u8fde\u63a5\u64cd\u4f5c\u53ef\u5206\u4e3a\u5de6\u5916\u8fde\u63a5\uff0c\u53f3\u5916\u8fde\u63a5\u548c\u5168\u5916\u8fde\u63a5\u3002\u8fde\u63a5\u8fc7\u7a0b\u4e2d\uff0c\u5916\u8fde\u63a5\u5de6\u53f3\u987a\u5e8f\u4e0d\u80fd\u53d8\u6362\uff0c\u8fd9\u9650\u5236\u4e86\u4f18\u5316\u5668\u5bf9\u8fde\u63a5\u987a\u5e8f\u7684\u9009\u62e9\u3002</p> <p>\u8003\u8651 L \u4e0e R \u7684\u5de6\u5916\u8fde\u63a5 <code>L LEFT JOIN R ON L.ID = R.ID</code>\u3002\u5982\u679c L \u4e2d\u7684\u4e00\u884c\u6ca1\u6709\u4e0e R \u4e2d\u7684\u4efb\u610f\u4e00\u884c\u8fde\u63a5\u6210\u529f\uff0c\u90a3\u4e48\u8fde\u63a5\u7ed3\u679c\u4f1a\u5bf9 R \u7684\u5217\u8865\u7a7a\u8f93\u51fa\u3002</p> <p>\u53ef\u4ee5\u770b\u5230\u5de6\u5916\u8fde\u63a5\u7684\u7ed3\u679c\u662f\u5185\u8fde\u63a5\u7684\u8d85\u96c6\uff0c\u5b83\u4e3b\u8981\u589e\u52a0\u4e86R\u8868\u8865\u7a7a\u4ea7\u751f\u7684\u884c\u3002</p> <p>\u8003\u8651<code>L LEFT JOIN R</code>\u7684\u7ed3\u679c\uff0c\u5047\u5982\u5b58\u5728\u8fc7\u6ee4\u6761\u4ef6<code>R.C2 = 'XXX'</code>\uff0c\u90a3\u4e48\u8865\u7a7a\u4ea7\u751f\u7684\u884c\u4f1a\u88ab\u8fc7\u6ee4\u6389\uff0c\u5916\u8fde\u63a5\u548c\u5185\u8fde\u63a5\u4ea7\u751f\u7684\u7ed3\u679c\u96c6\u662f\u5b8c\u5168\u76f8\u540c\u7684\u3002</p> <pre><code>SELECT L.ID, L.C1, R.C2 FROM L LEFT JOIN R ON L.ID = R.ID WHERE R.C2 = 'XXX';\n/*\u5916\u8fde\u63a5\u6d88\u9664*/\nSELECT L.ID, L.C1, R.C2 FROM L, R WHERE L.ID = R.ID AND R.C2 = 'XXX';\n\n-- \u6b64\u65f6\uff0c\u4f18\u5316\u5668\u7684\u67e5\u8be2\u91cd\u5199\u529f\u80fd\u53ef\u4ee5\u5c06\u5916\u8fde\u63a5\u6539\u5199\u4e3a\u5185\u8fde\u63a5\u3002\u8fd9\u6709\u52a9\u4e8e\u4f18\u5316\u5668\u8003\u8651\u66f4\u591a\u7684join\u987a\u5e8f\u548c\u7b97\u6cd5\u3002\n</code></pre> <p>\u5728\u5916\u8fde\u63a5\u67e5\u8be2\u4e2d\uff0c\u6307\u5b9a\u7684WHERE\u5b50\u53e5\u4e2d\u5305\u542b\u88ab\u9a71\u52a8\u8868\u4e2d\u7684\u5217\u4e0d\u4e3aNULL\u503c\u7684\u6761\u4ef6\u79f0\u4e4b\u4e3a\u7a7a\u503c\u62d2\u7edd\u6761\u4ef6\u3002</p> <p><code>WHERE cno IS NOT NULL</code>\u8fd9\u6837\u7684\u6761\u4ef6\u53ef\u4ee5\u8ba9\u5916\u8fde\u63a5\u548c\u5185\u8fde\u63a5\u7684\u7ed3\u679c\u76f8\u540c\uff0c\u56e0\u4e3a\u8fd9\u4e2a\u7ea6\u675f\u6761\u4ef6\u662f\u4e25\u683c strict \u7684\u3002\"\u4e25\u683c\"\u7684\u7cbe\u786e\u5b9a\u4e49\u662f\uff0c\u5bf9\u4e8e\u4e00\u4e2a\u8868\u8fbe\u5f0f\uff0c\u5982\u679c\u8f93\u5165\u53c2\u6570\u662f NULL \u503c\uff0c\u90a3\u4e48\u8f93\u51fa\u4e5f\u4e00\u5b9a\u662f NULL \u503c\uff0c\u5c31\u53ef\u4ee5\u8bf4\u8fd9\u4e2a\u8868\u8fbe\u5f0f\u662f\u4e25\u683c\u7684\u3002</p> <p>\u4ece SQL \u8bed\u4e49\u7684\u89d2\u5ea6\u51fa\u53d1\uff0c\u5bf9\u4e8e\u4e00\u4e2a\u8868\u8fbe\u5f0f\uff0c\u5982\u679c\u8f93\u5165\u53c2\u6570\u662f NULL \u503c\uff0c\u8f93\u51fa\u7ed3\u679c\u662f NULL \u503c\u6216\u8005 FALSE\uff0c\u90a3\u4e48\u5c31\u53ef\u4ee5\u8ba4\u4e3a\u8fd9\u4e2a\u8868\u8fbe\u5f0f\u662f\u4e25\u683c\u7684\u3002\u5982\u679c\u5728\u7ea6\u675f\u6761\u4ef6\u91cc\u6709\u8fd9\u79cd\u4e25\u683c\u7684\u8868\u8fbe\u5f0f\uff0c\u7531\u4e8e\u8f93\u5165\u662f NULL \u503c\uff0c\u8f93\u51fa\u662f NULL \u503c\u6216\u8005 FALSE\uff0c\u90a3\u4e48\u542b\u6709 NULL \u503c\u7684\u5143\u7ec4\u5c31\u4f1a\u88ab\u8fc7\u6ee4\u6389\u3002</p> <p>\u5728\u5916\u8fde\u63a5\u6d88\u9664\u4e2d\uff0c\u6211\u4eec\u79f0 R.C2 = 'XXX' \u8fd9\u6837\u7684\u6761\u4ef6\u4e3a==\u7a7a\u503c\u62d2\u7edd\u6761\u4ef6==\u3002</p> <p>\u5b9e\u73b0\u5916\u8fde\u63a5\u6d88\u9664\u6700\u5927\u7684\u6311\u6218\u5728\u4e8e\uff1a\u7ed9\u5b9a\u4efb\u610f\u4e00\u4e2a\u8868\u8fbe\u5f0f\uff0c\u6211\u4eec\u53ef\u4ee5\u51c6\u786e\u5730\u5224\u5b9a\u51fa\u5b83\u662f\u5426\u662f\u4e00\u4e2a==\u7a7a\u503c\u62d2\u7edd\u6761\u4ef6==</p> <ul> <li>R.C2 \u51fa\u73b0 <code>&gt;</code>, <code>&lt;</code>, <code>==</code>, <code>IS NOT NULL</code> \u7b49\u5224\u65ad\u8868\u8fbe\u5f0f\u7684\u4e00\u4fa7\u3002\u8fd9\u7c7b\u8868\u8fbe\u5f0f\u4e00\u4fa7\u53c2\u6570\u4e3a<code>NULL</code>\u65f6\uff0c\u5224\u65ad\u7ed3\u679c\u5fc5\u7136\u4e3a<code>unknown/false</code>\uff0c\u6240\u4ee5\u5b83\u4eec\u662f\u7a7a\u503c\u62d2\u7edd\u6761\u4ef6\u3002</li> </ul> <p>\u5916\u8fde\u63a5\u6d88\u9664\u5c31\u662f\u5c06\u4e00\u4e2a<code>outer join</code>\u8f6c\u6362\u6210<code>inner join</code></p> <p>\u56e0\u4e3a\u8fd9\u4e2a\u67e5\u8be2\u7684\u7ed3\u679c\u4e2d\u4e0d\u53ef\u80fd\u51fa\u73b0 R \u4e3a <code>NULL</code> \u7684\u884c\uff0c\u5047\u8bbe\u6709\u8fd9\u6837\u7684\u884c\uff0c\u5b83\u4e5f\u4e00\u5b9a\u4f1a\u88ab where R.C2 = 'XXX' \u8fc7\u6ee4\u6389\u3002\u8fd9\u4f7f\u5f97\u4f7f\u7528 <code>outer join</code> \u548c\u4f7f\u7528 <code>inner join</code> \u7684\u6548\u679c\u7b49\u4ef7\u3002</p> <p>\u5916\u8fde\u63a5\u6d88\u9664\u6700\u7ec8\u76ee\u7684\u662f\u7ed9\u4f18\u5316\u5668\u5e26\u6765\u66f4\u591a\u7684\u7075\u6d3b\u6027\uff0c<code>inner join</code> \u53ef\u4ee5\u9009\u62e9\u7684\u4f18\u5316\u8def\u5f84\u6bd4 <code>outer join</code> \u591a\u5f97\u591a\u3002</p> <p>\u4f18\u5316\u5668\u5728\u9009\u62e9\u591a\u8868\u8fde\u63a5\u987a\u5e8f\u65f6\uff0c\u53ef\u4ee5\u6709\u66f4\u591a\u66f4\u7075\u6d3b\u7684\u9009\u62e9\uff0c\u4ece\u800c\u53ef\u4ee5\u9009\u62e9\u66f4\u597d\u7684\u8868\u8fde\u63a5\u987a\u5e8f\uff0c\u52a0\u5feb\u67e5\u8be2\u6267\u884c\u7684\u901f\u5ea6\uff1b\u8868\u7684\u4e00\u4e9b\u8fde\u63a5\u7b97\u6cd5\uff08\u5982\u5757\u5d4c\u5957\u8fde\u63a5\u548c\u7d22\u5f15\u5faa\u73af\u8fde\u63a5\u7b49\uff09\u3002\u53ef\u4ee5\u51cf\u5c11\u4e0d\u5fc5\u8981\u7684 I/O \u5f00\u9500\uff0c\u80fd\u52a0\u5feb\u7b97\u6cd5\u6267\u884c\u7684\u901f\u5ea6\u3002</p> <p>\u5916\u8fde\u63a5\u6d88\u9664\u603b\u7ed3:</p> <ul> <li>\u6ce8\u610f\u5916\u8fde\u63a5\u4e0e\u5185\u8fde\u63a5\u7684\u8bed\u4e49\u5dee\u522b\uff1b</li> <li>\u5916\u8fde\u63a5\u4f18\u5316\u7684\u6761\u4ef6\uff1a\u7a7a\u503c\u62d2\u7edd\uff1b</li> <li>\u5916\u8fde\u63a5\u4f18\u5316\u7684\u672c\u8d28\uff1a\u8bed\u4e49\u4e0a\u662f\u5916\u8fde\u63a5\uff0c\u4f46 WHER \u6761\u4ef6\u4f7f\u5f97\u5916\u8fde\u63a5\u53ef\u4ee5\u8715\u5316\u4e3a\u5185\u8fde\u63a5\u3002</li> </ul>"},{"location":"basic/9.mysql_architecture/#_30","title":"\u8fde\u63a5\u6d88\u9664","text":"<p>\u8fde\u63a5\u6d88\u9664\uff0c\u53bb\u6389\u4e0d\u5fc5\u8981\u7684\u8fde\u63a5\u5bf9\u8c61\uff0c\u5219\u51cf\u5c11\u4e86\u8fde\u63a5\u64cd\u4f5c\u3002</p> <p>\u8fde\u63a5\u6d88\u9664\u7684\u6761\u4ef6\uff0c\u65e0\u56fa\u5b9a\u6a21\u5f0f\uff0c\u5177\u4f53\u95ee\u9898\u5177\u4f53\u5904\u7406\u3002</p> <pre><code>CREATE TABLE t1(a1 INT UNIQUE, b1 VARCHAR(255) );\nCREATE TABLE t1(a2 INT UNIQUE, b2 VARCHAR(255) );\nCREATE TABLE t1(a3 INT UNIQUE, b3 VARCHAR(255) );\n\n\n-- \u552f\u4e00\u952e/\u4e3b\u952e\u4f5c\u4e3a\u8fde\u63a5\u6761\u4ef6\uff0c\u4e09\u8868\u5185\u8fde\u63a5\u53ef\u4ee5\u53bb\u6389\u4e2d\u95f4\u8868\uff08mysql\u4f18\u5316\u5668\u4e0d\u652f\u6301\uff0c\u9700\u4eba\u5de5\u53bb\u6389\uff09\n\n--\u53ef\u4ee5\u770b\u5230\u8fd9\u4e2a\u8bed\u53e5\u4e2d\u7684t2\u8868\u4ec5\u4ec5\u4f5c\u4e3a\u8fde\u63a5\u6761\u4ef6\uff0c\u67e5\u8be2\u76ee\u6807\u5217\u6ca1\u6709t2\u7684\u5217\uff0c\u5b83\u5c5e\u4e8e\u591a\u4f59\u7684\u5bf9\u8c61\uff0c\u4f46\u662f\u4f18\u5316\u5668\u4f9d\u7136\u53bb\u8fde\u63a5\u5b83\u3002\nselect t1.*,t3.* from t1 join t2 on (a1=a2) join t3 on (a2=a3) limit 1;\n\n-- \u53ef\u4ee5\u4eba\u5de5\u6539\u5199\u6210\u5982\u4e0b\nselect t1.*,t3.* from t1 join t3 on (a1=a3) limit 1;\n</code></pre>"},{"location":"basic/9.mysql_architecture/#_31","title":"\u8fde\u63a5\u987a\u5e8f\u4ea4\u6362","text":"<p>SQL \u8bed\u53e5\u4e2d\u4f1a\u6307\u5b9a\u8868\u7684\u5177\u4f53\u987a\u5e8f\uff0c\u6709\u4e00\u4e9b\u7b80\u5355\u7684\u60c5\u51b5\uff0c\u901a\u8fc7\u89c2\u5bdf\u5c31\u80fd\u770b\u51fa\u4ea4\u6362\u987a\u5e8f\u4e4b\u540e\u4ecd\u7136\u7b49\u4ef7\uff0c\u4f8b\u5982\uff1a</p> <ul> <li>\u5185\u8fde\u63a5 \u4ea4\u6362\u5185\u8fde\u63a5\u7684\u4e24\u4e2a\u8868\u7684\u8fde\u63a5\u987a\u5e8f\uff0c\u901a\u5e38\u800c\u8a00\u4e0d\u4f1a\u5f71\u54cd\u6267\u884c\u7ed3\u679c</li> <li>\u5de6\u5916\u8fde\u63a5 \u4ea4\u6362\u5de6\u5916\u8fde\u63a5\u7684\u4e24\u4e2a\u8868\u7684\u8fde\u63a5\u987a\u5e8f\u800c\u4e14\u628a\u5de6\u5916\u8fde\u63a5\u6539\u53d8\u6210\u53f3\u5916\u8fde\u63a5\uff0c\u90a3\u4e48\u4e5f\u4e0d\u4f1a\u5f71\u54cd\u6267\u884c\u7ed3\u679c</li> </ul>"},{"location":"basic/9.mysql_architecture/#sql","title":"\u67e5\u770b\u4f18\u5316\u5668\u91cd\u5199\u540e\u7684 SQL","text":"<p>SQL \u8bed\u53e5\u5728\u88ab\u670d\u52a1\u5668\u6267\u884c\u65f6\uff0c\u5e76\u4e0d\u4e00\u5b9a\u5c31\u4f1a\u6309\u7167\u6211\u4eec\u5199\u7684\u987a\u5e8f\u6267\u884c\uff0cMySQL \u4f18\u5316\u5668\u4f1a\u91cd\u5199 SQL\uff0c\u5982\u4f55\u624d\u80fd\u770b\u5230\u4f18\u5316\u5668\u91cd\u5199\u540e\u7684 SQL \u5462\uff1f\u8fd9\u5c31\u8981\u7528\u5230 explain extended \u548c show warnings \u4e86\u3002</p> <p>explain extended sql \u8bed\u53e5\uff0c\u7136\u540e show warnings \u67e5\u770b\u3002</p> <p>explain extended \u4f1a\u8f93\u51fa sql \u7684\u6267\u884c\u8ba1\u5212\uff0c\u67e5\u8be2\u8bb0\u5f55\u7684\u65b9\u5f0f(\u5168\u8868\u626b\u63cf\u3001\u5168\u7d22\u5f15\u626b\u63cf\u3001\u7d22\u5f15\u8303\u56f4\u626b\u63cf\u7b49)\u3001\u662f\u5426\u7528\u4e0a\u7d22\u5f15</p> <p>show warnings \u4f1a\u770b\u5230\u4f18\u5316\u5668\u91cd\u5199\u540e\u7684 sql</p>"},{"location":"basic/9.mysql_architecture/#_32","title":"\u6761\u4ef6\u5316\u7b80","text":"<p>\u6211\u4eec\u7f16\u5199\u7684\u67e5\u8be2\u8bed\u53e5\u7684 where \u641c\u7d22\u6761\u4ef6\u672c\u8d28\u4e0a\u662f\u4e00\u4e2a\u8868\u8fbe\u5f0f\uff0c\u8fd9\u4e9b\u8868\u8fbe\u5f0f\u53ef\u80fd\u6bd4\u8f83\u7e41\u6742\uff0c\u6216\u8005\u4e0d\u80fd\u9ad8\u6548\u7684\u6267\u884c\uff0cMySQL \u7684\u67e5\u8be2\u4f18\u5316\u5668\u4f1a\u4e3a\u6211\u4eec\u7b80\u5316\u8fd9\u4e9b\u8868\u8fbe\u5f0f\u3002</p> <p>\u79fb\u9664\u4e0d\u5fc5\u8981\u7684\u62ec\u53f7</p> <p>\u6709\u65f6\u5019\u8868\u8fbe\u5f0f\u91cc\u6709\u8bb8\u591a\u65e0\u7528\u7684\u62ec\u53f7\uff0c\u6bd4\u5982\u8fd9\u6837\u4e00\u6761 sql \u6761\u4ef6\uff1a</p> <pre><code>\u00a0((a = 5 AND b = c) OR ((a &gt; c) AND (c &lt; 5)))\n\u00a0\n\u00a0# \u4f18\u5316\u5668\u5c31\u4f1a\u5bf9\u5176\u8fdb\u884c\u4f18\u5316\u6210\u4e0b\u9762\u8fd9\u6837\n\u00a0\n\u00a0(a = 5 and b = c) OR (a &gt; c AND c &lt; 5)\n</code></pre> <p>\u5e38\u91cf\u4f20\u9012</p> <pre><code>\u00a0a = 5 AND b &gt; a \u5c31\u53ef\u4ee5\u88ab\u8f6c\u6362\u4e3a\uff1a a = 5 AND b &gt; 5\n</code></pre> <p>\u5b50\u67e5\u8be2\u4f18\u5316</p> <p>\u6211\u4eec\u67e5\u8be2\u4e2d\u7684 select \u5217 from \u8868 \u4e2d\uff0c\u6709\u65f6\u5019\uff0c\u5217\u548c\u8868\u53ef\u80fd\u662f\u6211\u4eec\u5176\u4ed6\u67e5\u8be2\u4e2d\u51fa\u6765\u7684\u3002\u8fd9\u79cd\u5217\u548c\u8868\u662f\u7528 select \u8bed\u53e5\u8868\u73b0\u51fa\u6765\u7684\u5c31\u53eb\u5b50\u67e5\u8be2\u3002\u5916\u5c42 select \u5c31\u53eb\u5916\u5c42\u67e5\u8be2\u3002</p> <ul> <li>SELECT \u5b50\u53e5</li> </ul> <pre><code>\u00a0SELECT (SELECT m1 FROM e1 LIMIT 1);\n</code></pre> <ul> <li>FROM \u5b50\u53e5</li> </ul> <pre><code>\u00a0-- \u5b50\u67e5\u8be2\u540e\u8fb9\u7684 AS t \u8868\u660e\u8fd9\u4e2a\u5b50 \u67e5\u8be2\u7684\u7ed3\u679c\u5c31\u76f8\u5f53\u4e8e\u4e00\u4e2a\u540d\u79f0\u4e3a t \u7684\u8868\uff0c\u8fd9\u4e2a\u540d\u53eb t \u7684\u8868\u7684\u5217\u5c31\u662f\u5b50\u67e5\u8be2\u7ed3\u679c\u4e2d\u7684\u5217\uff08m\u548cn\uff09\u3002\n\u00a0-- \u8fd9\u4e2a\u653e\u5728 FROM \u5b50\u53e5\u4e2d\u7684\u5b50\u67e5\u8be2\u672c\u8d28\u4e0a\u76f8\u5f53\u4e8e\u4e00\u4e2a\u8868\uff0c\u4f46\u53c8\u548c\u6211\u4eec\u5e73\u5e38\u4f7f\u7528\u7684\u8868\u6709\u70b9\u513f\u4e0d\u4e00\u6837\uff0cMySQL \u628a\u8fd9\u79cd\u7531\u5b50\u67e5\u8be2\u7ed3\u679c\u96c6\u7ec4\u6210\u7684\u8868\u79f0\u4e4b\u4e3a\u6d3e\u751f\u8868\u3002\n\u00a0SELECT m, n FROM (SELECT m2 + 1 AS m, n2 AS n FROM e2 WHERE m2 &gt; 2) AS t;\n</code></pre> <ul> <li>WHERE \u6216 ON \u5b50\u53e5</li> </ul> <pre><code>\u00a0-- \u6700\u5e38\u89c1\u7684\u67e5\u8be2\uff1a\u6574\u4e2a\u67e5\u8be2\u8bed\u53e5\u7684\u610f\u601d\u5c31\u662f\u6211\u4eec\u60f3\u627e e1 \u8868\u4e2d\u7684\u67d0\u4e9b\u8bb0\u5f55\uff0c\u8fd9 \u4e9b\u8bb0\u5f55\u7684 m1 \u5217\u7684\u503c\u80fd\u5728 e2 \u8868\u7684 m2 \u5217\u627e\u5230\u5339\u914d\u7684\u503c\u3002\n\u00a0SELECT * FROM e1 WHERE m1 IN (SELECT m2 FROM e2);\n</code></pre> <p>\u5b50\u67e5\u8be2\u5206\u7c7b</p> <ul> <li>\u6807\u91cf\u5b50\u67e5\u8be2 \uff08\u4e00\u884c\u4e00\u5217\uff09</li> </ul> <pre><code>\u00a0-- \u90a3\u4e9b\u53ea\u8fd4\u56de\u4e00\u4e2a\u5355\u4e00\u503c\u7684\u5b50\u67e5\u8be2\u79f0\u4e4b\u4e3a\u6807\u91cf\u5b50\u67e5\u8be2\uff1a\u5b50\u67e5\u8be2\u91cc\u9762\u7684\u67e5\u8be2\u7ed3\u679c\u53ea\u8fd4\u56de\u4e00\u884c\u4e00\u5217\u4e00\u4e2a\u503c\u7684\u60c5\u51b5\u3002\n\u00a0SELECT * FROM (SELECT m1 FROM e1 LIMIT 1);\n\u00a0SELECT * FROM e1 WHERE m1 = (SELECT MIN(m2) FROM e2);\n\u00a0SELECT * FROM e1 WHERE m1 &lt; (SELECT MIN(m2) FROM e2);\n\u00a0\n\n\n-- \u67e5\u8be2\u51fa\u9500\u552e\u5355\u4ef7\u9ad8\u4e8e\u5e73\u5747\u9500\u552e\u5355\u4ef7\u7684\u5546\u54c1:\u5b50\u67e5\u8be2\u53ea\u8fd4\u56de\u4e00\u4e2a\u503c(\u5e73\u5747\u5355\u4ef7)\nSELECT product_id, product_name, sale_price\n FROM Product\nWHERE sale_price &gt; (SELECT AVG(sale_price)FROM Product);\n\n\n\n-- \u6807\u91cf\u5b50\u67e5\u8be2\u7684\u4e66\u5199\u4f4d\u7f6e\u5e76\u4e0d\u4ec5\u4ec5\u5c40\u9650\u4e8e WHERE \u5b50\u53e5\u4e2d\uff0c\u901a\u5e38\u4efb\u4f55\u53ef\u4ee5\u4f7f\u7528\u5355\u4e00\u503c\u7684\u4f4d\u7f6e\u90fd\u53ef\u4ee5\u4f7f\u7528\u3002\n-- \u4e5f\u5c31\u662f\u8bf4\uff0c\u80fd\u591f\u4f7f\u7528\u5e38\u6570\u6216\u8005\u5217\u540d\u7684\u5730\u65b9\uff0c\u65e0\u8bba\u662f SELECT \u5b50\u53e5\u3001GROUP BY \u5b50\u53e5\u3001HAVING \u5b50\u53e5\uff0c\u8fd8\u662fORDER BY \u5b50\u53e5\uff0c\u51e0\u4e4e\u6240\u6709\u7684\u5730\u65b9\u90fd\u53ef\u4ee5\u4f7f\u7528\u3002\n</code></pre> <ul> <li>\u884c\u5b50\u67e5\u8be2\uff08\u4e00\u884c\u591a\u5217\uff09</li> </ul> <pre><code>\u00a0-- \u987e\u540d\u601d\u4e49\uff0c\u5c31\u662f\u8fd4\u56de\u4e00\u6761\u8bb0\u5f55\u7684\u5b50\u67e5\u8be2\uff0c\u4e0d\u8fc7\u8fd9\u6761\u8bb0\u5f55\u9700\u8981\u5305\u542b\u591a\u4e2a\u5217\uff08\u53ea\u5305\u542b\u4e00\u4e2a\u5217\u5c31\u6210\u4e86\u6807\u91cf\u5b50\u67e5\u8be2\u4e86\uff09\u3002\n\u00a0-- \u5176\u4e2d\u7684(SELECT m2, n2 FROM e2 LIMIT 1)\u5c31\u662f\u4e00\u4e2a\u884c\u5b50\u67e5\u8be2\n\u00a0-- \u6574\u6761\u8bed\u53e5\u7684\u542b\u4e49\u5c31\u662f\u8981\u4ece e1 \u8868\u4e2d\u627e\u4e00\u4e9b\u8bb0\u5f55\uff0c\u8fd9\u4e9b\u8bb0\u5f55\u7684 m1 \u548c n1 \u5217\u5206\u522b\u7b49\u4e8e\u5b50\u67e5\u8be2\u7ed3\u679c\u4e2d\u7684 m2 \u548c n2 \u5217\n\u00a0SELECT * FROM e1 WHERE (m1, n1) = (SELECT m2, n2 FROM e2 LIMIT 1);\n</code></pre> <ul> <li>\u5217\u5b50\u67e5\u8be2</li> </ul> <pre><code>\u00a0-- \u5217\u5b50\u67e5\u8be2\u81ea\u7136\u5c31\u662f\u67e5\u8be2\u51fa\u4e00\u4e2a\u5217\u7684\u6570\u636e\uff0c\u4e0d\u8fc7\u8fd9\u4e2a\u5217\u7684\u6570\u636e\u9700\u8981\u5305\u542b\u591a\u6761\u8bb0\u5f55\n\u00a0-- \u5176\u4e2d\u7684(SELECT m2 FROM e2)\u5c31\u662f\u4e00\u4e2a\u5217\u5b50\u67e5\u8be2\uff0c\u8868\u660e\u67e5\u8be2\u51fa e2 \u8868\u7684 m2 \u5217 \u7684\u6240\u6709\u503c\u4f5c\u4e3a\u5916\u5c42\u67e5\u8be2 IN \u8bed\u53e5\u7684\u53c2\u6570\u3002\n\u00a0SELECT * FROM e1 WHERE m1 IN (SELECT m2 FROM e2);\n</code></pre> <ul> <li>\u8868\u5b50\u67e5\u8be2\uff08\u4e8c\u7ef4\u591a\u884c\u591a\u5217\uff09</li> </ul> <pre><code>\u00a0-- \u987e\u540d\u601d\u4e49\uff0c\u5c31\u662f\u5b50\u67e5\u8be2\u7684\u7ed3\u679c\u65e2\u5305\u542b\u5f88\u591a\u6761\u8bb0\u5f55\uff0c\u53c8\u5305\u542b\u5f88\u591a\u4e2a\u5217\n\u00a0-- \u5176\u4e2d\u7684(SELECT m2, n2 FROM e2)\u5c31\u662f\u4e00\u4e2a\u8868\u5b50\u67e5\u8be2\u3001\u6b64sql\u5fc5\u987b\u8981\u5728m1\uff0cn1\u90fd\u6ee1\u8db3\u7684\u6761\u4ef6\u4e0b\u65b9\u53ef\u6210\u7acb\n\u00a0SELECT * FROM e1 WHERE (m1, n1) IN (SELECT m2, n2 FROM e2);\n</code></pre> <ul> <li>\u4e0d\u76f8\u5173\u5b50\u67e5\u8be2</li> </ul> <p>\u5982\u679c\u5b50\u67e5\u8be2\u53ef\u4ee5\u5355\u72ec\u8fd0\u884c\u51fa\u7ed3\u679c\uff0c\u800c\u4e0d\u4f9d\u8d56\u4e8e\u5916\u5c42\u67e5\u8be2\u7684\u503c\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u628a\u8fd9\u4e2a\u5b50\u67e5\u8be2\u79f0\u4e4b\u4e3a\u4e0d\u76f8\u5173\u5b50\u67e5\u8be2\u3002\u6211\u4eec\u524d\u8fb9\u4ecb\u7ecd\u7684\u90a3\u4e9b\u5b50\u67e5\u8be2\u5168\u90e8\u90fd\u53ef\u4ee5\u770b\u4f5c\u4e0d\u76f8\u5173\u5b50\u67e5\u8be2\u3002</p> <ul> <li>\u76f8\u5173\u5b50\u67e5\u8be2</li> </ul> <p>\u5982\u679c\u5b50\u67e5\u8be2\u7684\u6267\u884c\u9700\u8981\u4f9d\u8d56\u4e8e\u5916\u5c42\u67e5\u8be2\u7684\u503c\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u628a\u8fd9\u4e2a\u5b50\u67e5\u8be2\u79f0\u4e4b\u4e3a\u76f8\u5173\u5b50\u67e5\u8be2\u3002</p> <pre><code>-- \u5728\u666e\u901a\u5b50\u67e5\u8be2\u4e2d\uff0c\u6267\u884c\u987a\u5e8f\u662f\u7531\u5185\u5230\u5916\uff0c\u5148\u6267\u884c\u5185\u90e8\u67e5\u8be2\u518d\u6267\u884c\u5916\u90e8\u67e5\u8be2\u3002\u5185\u90e8\u67e5\u8be2\u7684\u6267\u884c\u4e0d\u4f9d\u8d56\u4e8e\u5916\u90e8\u67e5\u8be2\uff0c\u4e14\u5185\u90e8\u67e5\u8be2\u53ea\u5904\u7406\u4e00\u6b21\uff0c\u5916\u90e8\u67e5\u8be2\u57fa\u4e8e\u5185\u90e8\u67e5\u8be2\u8fd4\u56de\u503c\u518d\u8fdb\u884c\u67e5\u8be2\uff0c\u5c31\u67e5\u8be2\u5b8c\u6bd5\u4e86\u3002\n\n\n-- \u5bf9\u4e8e\u5916\u90e8\u67e5\u8be2\u8fd4\u56de\u7684\u6bcf\u4e00\u884c\u6570\u636e\uff0c\u5185\u90e8\u67e5\u8be2\u90fd\u8981\u6267\u884c\u4e00\u6b21\u3002\n-- \u5728\u5173\u8054\u5b50\u67e5\u8be2\u4e2d\u662f\u4fe1\u606f\u6d41\u662f\u53cc\u5411\u7684\u3002\u5916\u90e8\u67e5\u8be2\u7684\u6bcf\u884c\u6570\u636e\u4f20\u9012\u4e00\u4e2a\u503c\u7ed9\u5b50\u67e5\u8be2\uff0c\u7136\u540e\u5b50\u67e5\u8be2\u4e3a\u6bcf\u4e00\u884c\u6570\u636e\u6267\u884c\u4e00\u6b21\u5e76\u8fd4\u56de\u5b83\u7684\u8bb0\u5f55\u3002\u7136\u540e\uff0c\u5916\u90e8\u67e5\u8be2\u6839\u636e\u8fd4\u56de\u7684\u8bb0\u5f55\u505a\u51fa\u51b3\u7b56\u3002\n-- \u800c\u5728\u5173\u8054\u5b50\u67e5\u8be2\u4e2d\uff0c\u4fe1\u606f\u4f20\u64ad\u662f\u53cc\u5411\u800c\u4e0d\u662f\u5355\u5411\u7684\u3002\u5185\u90e8\u67e5\u8be2\u5229\u7528\u5173\u8054\u5b50\u67e5\u8be2\u6d89\u53ca\u5916\u90e8\u67e5\u8be2\u63d0\u4f9b\u7684\u4fe1\u606f\uff0c\u5916\u90e8\u67e5\u8be2\u4e5f\u4f1a\u6839\u636e\u5185\u90e8\u67e5\u8be2\u8fd4\u56de\u7684\u8bb0\u5f55\u8fdb\u884c\u51b3\u7b56\u3002\u5185\u90e8\u67e5\u8be2\u7684\u6267\u884c\u4f9d\u8d56\u4e8e\u5916\u90e8\u67e5\u8be2\uff0c\u4e0d\u80fd\u5355\u72ec\u6267\u884c\u3002\n\n\n-- \u68c0\u7d22\u5de5\u8d44\u5927\u4e8e\u540c\u804c\u4f4d\u7684\u5e73\u5747\u5de5\u8d44\u7684\u5458\u5de5\u4fe1\u606f\u3002\n\n-- \u5458\u5de5\u591a\uff0c\u800c\u76f8\u5e94\u7684\u804c\u4f4d\uff08\u5982\u9500\u552e\u5458\u3001\u7ecf\u7406\u3001\u90e8\u95e8\u7ecf\u7406\u7b49\uff09\u5c11\uff0c\u56e0\u6b64\u9996\u5148\u60f3\u5230\u7684\u601d\u8def\u662f\u5bf9\u804c\u4f4d\u5206\u7ec4\uff0c\u8fd9\u6837\u5c31\u80fd\u5206\u522b\u5f97\u5230\u5404\u4e2a\u804c\u4f4d\u7684\u5e73\u5747\u5de5\u8d44\uff0c\u518d\u6bd4\u8f83\u6bcf\u4e2a\u4eba\u7684\u5de5\u8d44\u548c\u4ed6\u5bf9\u5e94\u804c\u4f4d\u7684\u5e73\u5747\u5de5\u8d44\uff0c\u5927\u4e8e\u5219\u88ab\u7b5b\u9009\u51fa\u6765\u3002\n</code></pre> <p>\u53c2\u8003</p> <p></p>"},{"location":"basic/9.mysql_architecture/#mysql_7","title":"\u5b50\u67e5\u8be2\u5728 MySQL \u4e2d\u662f\u600e\u4e48\u6267\u884c\u7684","text":"<p>\u5e38\u89c4\u60f3\u8c61\u601d\u7ef4\u4e2d\u5b50\u67e5\u8be2\u7684\u6267\u884c\u65b9\u5f0f\uff08\u975e\u5b9e\u9645\uff09</p> <pre><code>\u00a0-- \u4e0d\u76f8\u5173\u5b50\u67e5\u8be2\n\u00a0SELECT * FROM s1 WHERE order_note IN (SELECT order_note FROM s2 WHERE order_no = 'a');\n\n-- \u5bf9\u4e8e\u8fd9\u6837\u4e00\u4e2a\u67e5\u8be2\nSELECT * FROM t1 WHERE t1.a IN (SELECT t2.b FROM t2 WHERE id &lt; 10);\n\n\n-- \u6211\u4eec\u53ef\u80fd\u4f1a\u8ba4\u4e3a\u8fd9\u6837\u6267\u884c\u7684\n--SELECT t2.b FROM t2 WHERE id &lt; 10;\n-- \u7ed3\u679c:1,2,3,4,5,6,7,8,9\n-- select * from t1 where t1.a in(1,2,3,4,5,6,7,8,9);\n\n-- \u5b9e\u9645\u4e0a\u5728MySQL\u5185\u90e8\uff0c\u4f18\u5316\u5668\u53ef\u80fd\u4f1a\u6539\u5199\u6210\u5982\u4e0bSQL\nselect * from t1 where exists(select b from t2 where id &lt; 10 and t1.a=t2.b);\n\n-- \u4e0d\u76f8\u5173\u5b50\u67e5\u8be2\u53d8\u6210\u4e86\u5173\u8054\u5b50\u67e5\u8be2\uff08select_type:DEPENDENT SUBQUERY\uff09\uff0c\u5b50\u67e5\u8be2\u9700\u8981\u6839\u636e b \u6765\u5173\u8054\u5916\u8868 t1\uff0c\u56e0\u4e3a\u9700\u8981\u5916\u8868\u7684 t1 \u5b57\u6bb5\uff0c\u6240\u4ee5\u5b50\u67e5\u8be2\u662f\u6ca1\u6cd5\u5148\u6267\u884c\u7684\u3002\u6267\u884c\u6d41\u7a0b\u5982\u4e0b\uff1a\n\n-- 1\u3001\u626b\u63cf t1\uff0c\u4ece t1 \u53d6\u51fa\u4e00\u884c\u6570\u636e R\uff1b\n-- 2\u3001\u4ece\u6570\u636e\u884c R \u4e2d\uff0c\u53d6\u51fa\u5b57\u6bb5 a \u6267\u884c\u5b50\u67e5\u8be2\uff0c\u5982\u679c\u5f97\u5230\u7ed3\u679c\u4e3a TRUE\uff0c\u5219\u628a\u8fd9\u884c\u6570\u636e R \u653e\u5230\u7ed3\u679c\u96c6\uff1b\n-- 3\u3001\u91cd\u590d 1\u30012 \u76f4\u5230\u7ed3\u675f\u3002\n\n-- \u603b\u7684\u626b\u63cf\u884c\u6570\u4e3a 100+100*9=1000\uff08\u8fd9\u662f\u7406\u8bba\u503c\uff0c\u5b9e\u9645\u503c\u4e3a 964\uff0c\u600e\u4e48\u6765\u7684\u4e00\u76f4\u6ca1\u60f3\u660e\u767d\uff0c\u770b\u89c4\u5f8b\u662f\u5b50\u67e5\u8be2\u7ed3\u679c\u96c6\u6bcf\u591a\u4e00\u884c\uff0c\u603b\u626b\u63cf\u884c\u6570\u5c31\u4f1a\u5c11\u51e0\u884c\uff09\u3002\n\u00a0\n\u00a0-- \u6211\u4eec\u60f3\u8c61\u4e2d\u7684\u53ef\u80fd\u662f\u628a\u5b50\u67e5\u8be2\u91cc\u9762\u7684\u8fd9\u4e2a\u7ed3\u679c\u96c6\u67e5\u51fa\u6765\u653e\u5230\u5185\u5b58\u4e2d\uff0c\u7136\u540e\u505a\u4e3a\u5916\u5c42\u67e5\u8be2\u7684\u6761\u4ef6\u8fdb\u884c\u67e5\u8be2\u3002\u53ef\u80fd\u4f1a\u5bfc\u81f4\u4e24\u4e2a\u95ee\u9898\uff1a\n\u00a0-- 1.\u5b50\u67e5\u8be2\u7684\u7ed3\u679c\u96c6\u592a\u591a\uff0c\u53ef\u80fd\u5185\u5b58\u4e2d\u90fd\u653e\u4e0d\u4e0b\u3002\n\u00a0-- 2.\u5bf9\u4e8e\u5916\u5c42\u67e5\u8be2\u6765\u8bf4\uff0c\u5982\u679c\u5b50\u67e5\u8be2\u7684\u7ed3\u679c\u96c6\u592a\u591a\uff0c\u90a3\u5c31\u610f\u5473\u7740IN\u5b50\u53e5\u4e2d\u7684\u53c2\u6570\u7279\u522b\u591a\uff0c\u7531\u4e8eorder_note\u4e0d\u662f\u7d22\u5f15\u5217\uff0c\u6bcf\u4e2aIN\u8bed\u53e5\u7684\u6761\u4ef6\u90fd\u4f1a\u5168\u8868\u626b\u63cf\u8fdb\u884c\u904d\u5386\u3002\n\u00a0\n\u00a0-- \u7ed3\u679c\u96c6\u8fc7\u591a\u7684\u5904\u7406\u65b9\u6848\n\u00a0-- IN\u5b50\u53e5\u4e2d\u7684\u7ed3\u679c\u96c6\u53ef\u80fd\u5b58\u5728\u7740\u5927\u91cf\u7684\u91cd\u590d\u5b57\u6bb5\u3002\u8fd9\u4e9b\u5b57\u6bb5\u5bf9\u4e8e\u83b7\u53d6\u6700\u540e\u7684\u67e5\u8be2\u7ed3\u679c\u800c\u8a00\uff0c\u90fd\u662f\u6d6a\u8d39\u8d44\u6e90\u7684\u65e0\u7528\u529f\uff0c\u56e0\u6b64\uff0c\u7ed3\u679c\u96c6\u8fc7\u591a\u7684\u7b2c\u4e00\u4e2a\u5904\u7406\u65b9\u6848\uff0c\u5c31\u662f\u8003\u8651\u53bb\u91cd\u3002\n\u00a0-- \u5982\u679c\u7ed3\u679c\u96c6\u4e2d\u786e\u5b9e\u8fc7\u5927\uff0c\u5bfc\u81f4\u5373\u4f7f\u7ed3\u679c\u53bb\u91cd\u540e\uff0c\u5185\u5b58\u5b58\u653e\u4ecd\u7136\u6709\u538b\u529b\uff0c\u56e0\u6b64\u8f6c\u5b58\u5230\u78c1\u76d8\u5f53\u4e2d\u3002\n\u00a0\n\u00a0-- order_note\u4e0d\u662f\u7d22\u5f15\uff0c\u4f60\u600e\u4e48\u6ef4\u8fd8\u80fd\u8ba9\u4ed6\u4e0d\u8fdb\u884c\u5168\u8868\u626b\u63cf\u4e0d\u6210\uff1f\u5f53\u7136\uff0c\u76f4\u63a5\u52a0\u7d22\u5f15\u662f\u4e0d\u6210\u7684\u3002\u4f46\u662f\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u7269\u5316\u8868\u7684\u65b9\u5f0f\u5bf9sql\u8fdb\u884c\u6539\u9020\uff0c\u7531\u4f18\u5316\u5668\u518d\u6b21\u5224\u65ad\u662f\u5426\u4f7f\u7528\u5168\u8868\u626b\u63cf\u3002\n\u00a0-- \u5f53IN\u7684\u7ed3\u679c\u96c6\u8fc7\u5927\u65f6\uff0c\u6211\u4eec\u4f1a\u5c06IN\u5b50\u53e5\u5347\u7ea7\u4e3a\u7269\u5316\u8868\u3002\u5347\u7ea7\u6d41\u7a0b\u5982\u4e0b\uff1a\n\u00a0\n\u00a0-- 1.\u8be5\u4e34\u65f6\u8868\u7684\u5217\u5c31\u662f\u5b50\u67e5\u8be2\u7ed3\u679c\u96c6\u4e2d\u7684\u5217\u3002\n\u00a0-- 2.\u5199\u5165\u4e34\u65f6\u8868\u7684\u8bb0\u5f55\u4f1a\u88ab\u53bb\u91cd\uff0c\u4e34\u65f6\u8868\u4e5f\u662f\u4e2a\u8868\uff0c\u53ea\u8981\u4e3a\u8868\u4e2d\u8bb0\u5f55\u7684\u6240\u6709\u5217\u5efa\u7acb\u4e3b\u952e\u6216\u8005\u552f\u4e00\u7d22\u5f15\u3002\n\u00a0\n\u00a0-- \u7269\u5316\u8868\u662f\u57fa\u4e8e\u78c1\u76d8\u7684\u4e48\uff1f\u4e0d\uff0c\u8fd9\u4e2a\u8868\u5728\u4e0d\u662f\u7279\u522b\u5927\u7684\u65f6\u5019\u662f\u57fa\u4e8e\u5185\u5b58\u7684\u3002\n\u00a0-- \u4e00\u822c\u60c5\u51b5\u4e0b\u5b50\u67e5\u8be2\u7ed3\u679c\u96c6\u4e0d\u4f1a\u5927\u7684\u79bb\u8c31\uff0c\u6240\u4ee5\u4f1a\u4e3a\u5b83\u5efa\u7acb\u57fa\u4e8e\u5185\u5b58\u7684\u4f7f\u7528 Memory \u5b58\u50a8\u5f15\u64ce\u7684\u4e34\u65f6\u8868\uff0c\u800c\u4e14\u4f1a\u4e3a\u8be5\u8868\u5efa\u7acb\u54c8\u5e0c\u7d22\u5f15\u3002\n\u00a0-- \u5982\u679c\u5b50\u67e5\u8be2\u7684\u7ed3\u679c\u96c6\u975e\u5e38\u5927\uff0c\u8d85\u8fc7\u4e86\u7cfb\u7edf\u53d8\u91cf tmp_table_size \u6216\u8005 max_heap_table_size\uff0c\u4e34\u65f6\u8868\u4f1a\u8f6c\u800c\u4f7f\u7528\u57fa\u4e8e\u78c1\u76d8\u7684\u5b58\u50a8\u5f15\u64ce\u6765\u4fdd\u5b58\u7ed3\u679c\u96c6\u4e2d\u7684\u8bb0\u5f55\uff0c\u7d22\u5f15\u7c7b\u578b\u4e5f\u5bf9\u5e94\u8f6c\u53d8\u4e3a B+\u6811\u7d22\u5f15\u3002\n\n\n\n--\u7269\u5316\u8868\u8f6c\u8fde\u63a5\n-- \u5f53\u6211\u4eec\u628a\u5b50\u67e5\u8be2\u8fdb\u884c\u7269\u5316\u4e4b\u540e\uff0c\u5047\u8bbe\u5b50\u67e5\u8be2\u7269\u5316\u8868\u7684\u540d\u79f0\u4e3a materialized_table\uff0c\u8be5\u7269\u5316\u8868\u5b58\u50a8\u7684\u5b50\u67e5\u8be2\u7ed3\u679c\u96c6\u7684\u5217\u4e3a m_val\uff0c\u90a3\u4e48\u8fd9\u4e2a\u67e5\u8be2\u5c31\u76f8\u5f53\u4e8e\u8868 s1 \u548c\u5b50\u67e5\u8be2\u7269\u5316\u8868 materialized_table \u8fdb\u884c\u5185\u8fde\u63a5\u3002\n\u00a0SELECT s1.* FROM s1 INNER JOIN materialized_table ON order_note = m_val\n\n\u00a0-- \u9a71\u52a8\u8868\u7b97\u6cd5\u00a0\n</code></pre> <p>ANY/ALL \u5b50\u67e5\u8be2\u4f18\u5316</p> <p>\u5982\u679c ANY/ALL \u5b50\u67e5\u8be2\u662f\u4e0d\u76f8\u5173\u5b50\u67e5\u8be2\u7684\u8bdd\uff0c \u5b83\u4eec\u5728\u5f88\u591a\u573a\u5408\u90fd\u80fd\u8f6c\u6362\u6210\u6211\u4eec\u719f\u6089\u7684\u65b9\u5f0f\u53bb\u6267\u884c\uff1a</p> <pre><code>&lt; ANY (SELECT inner_expr ...)   &lt; (SELECT MAX(inner_expr) ...)  --\u5c0f\u4e8e\u4efb\u4f55\u4e00\u4e2a\uff0c\u7b49\u4ef7\u4e8e\u5c0f\u4e8e\u6700\u5927\u7684\n&gt; ANY (SELECT inner_expr ...)   &gt; (SELECT MIN(inner_expr) ...)  --\u5927\u4e8e\u4efb\u4f55\u4e00\u4e2a\uff0c\u7b49\u4ef7\u4e8e\u5927\u4e8e\u6700\u5c0f\u7684\n&lt; ALL (SELECT inner_expr ...)   &lt; (SELECT MIN(inner_expr) ...)  --\u5c0f\u4e8e\u6240\u6709\u7684\uff0c\u7b49\u4ef7\u4e8e\u5c0f\u4e8e\u6700\u5c0f\u7684\n&gt; ALL (SELECT inner_expr ...)   &gt; (SELECT MAX(inner_expr) ...)  --\u5927\u4e8e\u6240\u6709\u7684\uff0c\u7b49\u4ef7\u4e8e\u5927\u4e8e\u6700\u5927\u7684\n</code></pre>"},{"location":"basic/9.mysql_architecture/#in-exists","title":"IN \u548c EXISTS \u533a\u522b","text":"<p>SQL \u7684\u4fdd\u7559\u5b57\u4e2d\uff0c\u6709\u5f88\u591a\u90fd\u88ab\u5f52\u4e3a\u8c13\u8bcd\u4e00\u7c7b\u3002\u4f8b\u5982\uff0c<code>=</code>,<code>&lt;</code>,<code>&gt;</code>,<code>&lt;&gt;</code> \u7b49\u6bd4\u8f83\u8c13\u8bcd\uff0c\u4ee5\u53ca <code>BETWEEN</code> \u3001<code>LIKE</code> \u3001<code>IN</code> \u3001<code>IS NULL</code> \u7b49\u3002</p> <p>\u8c13\u8bcd\u662f\u4e00\u79cd\u7279\u6b8a\u7684\u51fd\u6570\uff0c\u8fd4\u56de\u503c\u662f\u771f\u503c\u3002 \u524d\u9762\u63d0\u5230\u7684\u6bcf\u4e2a\u8c13\u8bcd\uff0c\u8fd4\u56de\u503c\u90fd\u662f <code>true</code> \u3001 <code>false</code> \u6216\u8005 <code>unknown</code> \uff08\u4e00\u822c\u7684\u8c13\u8bcd\u903b\u8f91\u91cc\u6ca1\u6709 <code>unknown</code> \uff0c\u4f46\u662f <code>SQL</code> \u91c7\u7528\u7684\u662f\u4e09\u503c\u903b\u8f91\uff0c\u56e0\u6b64\u5177\u6709\u4e09\u79cd\u771f\u503c\uff09\u3002 \u8c13\u8bcd\u903b\u8f91\u63d0\u4f9b\u8c13\u8bcd\u662f\u4e3a\u4e86\u5224\u65ad\u547d\u9898\uff08\u53ef\u4ee5\u7406\u89e3\u6210\u9648\u8ff0\u53e5\uff09\u7684\u771f\u5047\uff0c\u800c\u5728\u5173\u7cfb\u6570\u636e\u5e93\u91cc\uff0c\u8868\u4e2d\u7684\u4e00\u884c\u6570\u636e\u53ef\u4ee5\u770b\u4f5c\u662f\u4e00\u4e2a\u547d\u9898\u3002</p> <p>\u8868\u5e38\u5e38\u88ab\u8ba4\u4e3a\u662f\u884c\u7684\u96c6\u5408\uff0c\u4f46\u4ece\u8c13\u8bcd\u903b\u8f91\u7684\u89c2\u70b9\u770b\uff0c\u4e5f\u53ef\u4ee5\u8ba4\u4e3a\u662f\u547d\u9898\u7684\u96c6\u5408\uff08\u4e5f\u5c31\u662f\u63cf\u8ff0\u6bcf\u4e00\u884c\u8bb0\u5f55\u9648\u8ff0\u53e5\u7684\u96c6\u5408\uff09\u3002</p> <p>\u4e00\u8a00\u4ee5\u853d\u4e4b\uff0c\u8c13\u8bcd\u7684\u4f5c\u7528\u5c31\u662f\"\u5224\u65ad\u662f\u5426\u5b58\u5728\u6ee1\u8db3\u67d0\u79cd\u6761\u4ef6\u7684\u8bb0\u5f55\"\u3002\u5982\u679c\u5b58\u5728\u8fd9\u6837\u7684\u8bb0\u5f55\u5c31\u8fd4\u56de\u771f<code>TRUE</code> \uff0c\u5982\u679c\u4e0d\u5b58\u5728\u5c31\u8fd4\u56de\u5047<code>FALSE</code></p> <p>\u4e5f\u5c31\u662f\u8bf4\uff0c\u6211\u4eec\u5e73\u65f6\u4f7f\u7528\u7684 <code>WHERE</code> \u5b50\u53e5\uff0c\u5176\u5b9e\u4e5f\u53ef\u4ee5\u770b\u6210\u662f\u7531\u591a\u4e2a\u8c13\u8bcd\u7ec4\u5408\u800c\u6210\u7684\u65b0\u8c13\u8bcd\u3002\u53ea\u6709\u80fd\u8ba9 <code>WHERE</code> \u5b50\u53e5\u7684\u8fd4\u56de\u503c\u4e3a\u771f\u7684\u547d\u9898\uff0c\u624d\u80fd\u4ece\u8868\uff08\u547d\u9898\u7684\u96c6\u5408\uff09\u4e2d\u67e5\u8be2\u5230\u3002</p> <p>\u4e0d\u7ba1\u5b50\u67e5\u8be2\u662f\u76f8\u5173\u7684\u8fd8\u662f\u4e0d\u76f8\u5173\u7684\uff0c \u90fd\u53ef\u4ee5\u628a <code>IN</code> \u5b50\u67e5\u8be2\u5c1d\u8bd5\u8f6c\u4e3a <code>EXISTS</code> \u5b50\u67e5\u8be2\u5176\u5b9e\u5bf9\u4e8e\u4efb\u610f\u4e00\u4e2a <code>IN</code> \u5b50\u67e5\u8be2\u6765\u8bf4\uff0c \u90fd\u53ef\u4ee5\u88ab\u8f6c\u4e3a <code>EXISTS</code> \u5b50\u67e5\u8be2</p> <p>\u901a\u7528\u7684\u4f8b\u5b50\u5982\u4e0b\uff1a</p> <pre><code>outer_expr IN (SELECT inner_expr FROM ... WHERE subquery_where)\n-- \u53ef\u4ee5\u88ab\u8f6c\u6362\u4e3a\uff1a\nEXISTS (SELECT inner_expr FROM ... WHERE subquery_where AND outer_expr=inner_expr)\n\n\n--\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c \u5982\u679c IN \u5b50\u67e5\u8be2\u4e0d\u6ee1\u8db3\u8f6c\u6362\u4e3a semi-join \u7684\u6761\u4ef6\uff0c \u53c8\u4e0d\u80fd\u8f6c\u6362\u4e3a\u7269\u5316\u8868\u6216\u8005\u8f6c\u6362\u4e3a\u7269\u5316\u8868\u7684\u6210\u672c\u592a\u5927\uff0c \u90a3\u4e48\u5b83\u5c31\u4f1a\u88ab\u8f6c\u6362\u4e3a EXISTS \u67e5\u8be2\u3002\n</code></pre> <p>\u5728 <code>MySQL5.5</code> \u4ee5\u53ca\u4e4b\u524d\u7684\u7248\u672c\u6ca1\u6709\u5f15\u8fdb <code>semi-join</code> \u548c\u7269\u5316\u7684\u65b9\u5f0f\u4f18\u5316\u5b50\u67e5\u8be2\u65f6\uff0c\u4f18\u5316\u5668\u90fd\u4f1a\u628a <code>IN</code> \u5b50\u67e5\u8be2\u8f6c\u6362\u4e3a <code>EXISTS</code> \u5b50\u67e5\u8be2\uff0c\u6240\u4ee5\u5f53\u65f6\u597d\u591a\u58f0\u97f3\u90fd\u662f\u5efa\u8bae\u5927\u5bb6\u628a\u5b50\u67e5\u8be2\u8f6c\u4e3a\u8fde\u63a5\uff0c\u4e0d\u8fc7\u968f\u7740 <code>MySQL</code> \u7684\u53d1\u5c55\uff0c\u6700\u8fd1\u7684\u7248\u672c\u4e2d\u5f15\u5165\u4e86\u975e\u5e38\u591a\u7684\u5b50\u67e5\u8be2\u4f18\u5316\u7b56\u7565\uff0c\u5185\u90e8\u7684\u8f6c\u6362\u5de5\u4f5c\u4f18\u5316\u5668\u4f1a\u4e3a\u5927\u5bb6\u81ea\u52a8\u5b9e\u73b0\u3002</p> <p>https://blog.csdn.net/weixin_47184173/article/details/117411011</p> <p>\u4e3a\u4ec0\u4e48 300 \u7684\u5e76\u53d1\u80fd\u628a\u652f\u6301\u6700\u5927\u8fde\u63a5\u6570 4000 \u6570\u636e\u5e93\u538b\u6b7b\uff1f</p>"},{"location":"basic/9.mysql_architecture/#_33","title":"\u5982\u4f55\u5904\u7406\u67e5\u8be2\uff1f","text":"<p>\u6709\u65f6\u5019\uff0c\u5404\u79cd\u67e5\u8be2\u8bed\u53e5\u7ecf\u5e38\u4f1a\u76f4\u63a5\u67e5\u8be2\u8d85\u5927\u8868\uff0c\u751a\u81f3\u5355\u8868\u5c31\u8d85\u8fc7\u6574\u4e2a\u670d\u52a1\u5668\u7684\u6240\u6709\u7269\u7406\u5185\u5b58\u4e86\u3002\u90a3\u4f1a\u4e0d\u4f1a\u4e00\u4e0b\u5b50\u5c31\u6253\u6302 MySQL \u5462\uff1f</p> <p>\u663e\u7136\u4e0d\u4f1a\u3002\u5ba2\u6237\u7aef\u6267\u884c\u67e5\u8be2\u8981\u6c42\u8fd4\u56de\u7684\u7ed3\u679c\u96c6\u662f\u5f88\u666e\u904d\u7684\u60c5\u51b5\u3002</p>"},{"location":"basic/9.mysql_architecture/#mysql_8","title":"MySQL \u7ebf\u7a0b\u72b6\u6001","text":"\u72b6\u6001 \u542b\u4e49 <code>After create</code> \u5f53\u7ebf\u7a0b\u5728\u521b\u5efa\u8868\u7684\u51fd\u6570\u672b\u5c3e\u521b\u5efa\u8868\uff08\u5305\u62ec\u5185\u90e8\u4e34\u65f6\u8868\uff09\u65f6\uff0c\u4f1a\u53d1\u751f\u8fd9\u79cd\u60c5\u51b5\u3002\u5373\u4f7f\u7531\u4e8e\u67d0\u4e9b\u9519\u8bef\u800c\u65e0\u6cd5\u521b\u5efa\u8868\uff0c\u4e5f\u4f1a\u4f7f\u7528\u6b64\u72b6\u6001 altering table \u670d\u52a1\u5668\u6b63\u5728\u6267\u884c\u5c31\u5730 ALTER TABLE Analyzing \u7ebf\u7a0b\u6b63\u5728\u8ba1\u7b97 MyISAM \u8868\u952e\u5206\u5e03\uff08\u4f8b\u5982\uff0cfor ANALYZE TABLE\uff09\u3002 checking permissions \u7ebf\u7a0b\u6b63\u5728\u68c0\u67e5\u670d\u52a1\u5668\u662f\u5426\u5177\u6709\u6267\u884c\u8bed\u53e5\u6240\u9700\u7684\u6743\u9650 Checking table \u8be5\u7ebf\u7a0b\u6b63\u5728\u6267\u884c\u8868\u68c0\u67e5\u64cd\u4f5c cleaning up \u8be5\u7ebf\u7a0b\u5df2\u7ecf\u5904\u7406\u4e86\u4e00\u4e2a\u547d\u4ee4\uff0c\u5e76\u51c6\u5907\u91ca\u653e\u5185\u5b58\u5e76\u91cd\u7f6e\u67d0\u4e9b\u72b6\u6001\u53d8\u91cf <code>closing tables</code> committing alter table to storage engine converting HEAP to MyISAM copy to tmp table Copying to group table Copying to tmp table <code>Copying to tmp table on disk</code> Creating index Creating sort index creating table <code>Creating tmp table</code>"},{"location":"dev/01.mysql%E5%AF%BC%E5%BA%93/","title":"\u5bfc\u5165\u5bfc\u51fa\u6982\u8ff0","text":"<p>\u5728\u5f88\u591a\u573a\u666f\uff0c\u6211\u4eec\u9700\u8981\u4e34\u65f6\u5feb\u901f\u7684\u5bf9MySQL server\u4e2d\u7684\u6570\u636e\u8fdb\u884c\u5bfc\u5165\u5bfc\u51fa\u3002</p> <p>mysqldump\u662fMySQL\u81ea\u5e26\u7684\u5bfc\u51fa\u6570\u636e\u5de5\u5177\uff0c\u5373mysql\u6570\u636e\u5e93\u4e2d\u5907\u4efd\u5de5\u5177\uff0c\u7528\u4e8e\u5c06MySQL\u670d\u52a1\u5668\u4e2d\u7684\u6570\u636e\u5e93\u4ee5\u6807\u51c6\u7684sql\u8bed\u8a00\u7684\u65b9\u5f0f\u5bfc\u51fa\uff0c\u5e76\u4fdd\u5b58\u5230\u6587\u4ef6\u4e2d\u3002</p> <p>mysqldump\u662f\u4e00\u4e2a\u5ba2\u6237\u7aef\u903b\u8f91\u5907\u4efd\u7684\u5de5\u4f5c\uff0c\u5907\u4efd\u7684SQL\u6587\u4ef6\u53ef\u4ee5\u5728\u5176\u4ed6MySQL\u670d\u52a1\u5668\u4e0a\u8fdb\u884c\u8fd8\u539f\u3002</p>"},{"location":"dev/02.%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AE%BE%E8%AE%A1/","title":"\u6570\u636e\u5e93\u8bbe\u8ba1","text":""},{"location":"dev/02.%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AE%BE%E8%AE%A1/#_2","title":"\u6982\u8ff0","text":"<p>\u6570\u636e\u5e93\u8bbe\u8ba1\u5c5e\u4e8e\u7cfb\u7edf\u8bbe\u8ba1\u7684\u8303\u7574\uff0c\u901a\u5e38\u628a\u4f7f\u7528\u6570\u636e\u5e93\u7684\u7cfb\u7edf\u79f0\u4e3a\u6570\u636e\u5e93\u5e94\u7528\u7cfb\u7edf\uff0c\u628a\u5bf9\u6570\u636e\u5e93\u5e94\u7528\u7cfb\u7edf\u7684\u8bbe\u8ba1\u6210\u4e3a\u6570\u636e\u5e93\u8bbe\u8ba1\u3002</p> <p>\u6309\u7167\u8f6f\u4ef6\u5de5\u7a0b\u5bf9\u7cfb\u7edf\u751f\u547d\u5468\u671f\u7684\u5b9a\u4e49\uff0c\u8f6f\u4ef6\u751f\u547d\u5468\u671f\u5206\u4e3a 6 \u4e2a\u9636\u6bb5\uff1a</p> <ul> <li> <p>\u5236\u5b9a\u8ba1\u5212</p> </li> <li> <p>\u9700\u6c42\u5206\u6790</p> </li> <li> <p>\u7cfb\u7edf\u8bbe\u8ba1</p> </li> <li> <p>\u7a0b\u5e8f\u7f16\u5236</p> </li> <li> <p>\u6d4b\u8bd5\u4ee5\u53ca\u8fd0\u884c\u7ef4\u62a4</p> </li> </ul> <p>\u5728\u6570\u636e\u5e93\u8bbe\u8ba1\u4e2d\uff0c\u4e5f\u53c2\u7167\u8fd9\u79cd\u5212\u5206\uff0c\u5212\u5206\u6570\u636e\u5e93\u5e94\u7528\u7cfb\u7edf\u7684\u751f\u547d\u5468\u671f\uff1a</p> <ul> <li> <p>\u6570\u636e\u5e93\u89c4\u5212</p> </li> <li> <p>\u9700\u6c42\u63cf\u8ff0\u4e0e\u5206\u6790</p> </li> <li> <p>\u6570\u636e\u5e93\u4e0e\u5e94\u7528\u7a0b\u5e8f\u8bbe\u8ba1</p> </li> <li> <p>\u6570\u636e\u5e93\u8bbe\u8ba1\u4e0e\u5b9e\u73b0</p> </li> <li> <p>\u6d4b\u8bd5</p> </li> <li> <p>\u8fd0\u884c\u7ef4\u62a4</p> </li> </ul>"},{"location":"dev/02.%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AE%BE%E8%AE%A1/#_3","title":"\u6570\u636e\u5e93\u8bbe\u8ba1","text":"<p>\u6570\u636e\u5e93\u8bbe\u8ba1\u662f\u5bf9\u6570\u636e\u8fdb\u884c\u7ec4\u7ec7\u548c\u7ed3\u6784\u5316\u7684\u8fc7\u7a0b\uff0c\u5173\u952e\u95ee\u9898\u662f\u6570\u636e\u6a21\u578b\u7684\u8bbe\u8ba1\u3002\u4e00\u4e2a\u826f\u597d\u7684\u8bbe\u8ba1\u5bf9\u4e8e\u6570\u636e\u5e93\u7cfb\u7edf\u81f3\u5173\u91cd\u8981\uff0c\u5b83\u53ef\u4ee5\u51cf\u5c11\u7cfb\u7edf\u4e2d\u7684\u6570\u636e\u5197\u4f59\u3001\u786e\u4fdd\u6570\u636e\u7684\u4e00\u81f4\u6027\u548c\u5b8c\u6574\u6027\uff0c\u540c\u65f6\u6613\u4e8e\u7ef4\u62a4\u548c\u6269\u5c55\u3002</p> <p>\u6570\u636e\u5e93\u8bbe\u8ba1\u662f\u6307\u5bf9\u4e8e\u4e00\u4e2a\u7ed9\u5b9a\u7684\u5e94\u7528\u73af\u5883\uff0c\u6784\u9020\uff08\u8bbe\u8ba1\uff09\u4f18\u5316\u7684\u6570\u636e\u5e93\u903b\u8f91\u6a21\u5f0f\u548c\u7269\u7406\u7ed3\u6784\uff0c\u5e76\u636e\u6b64\u5efa\u7acb\u6570\u636e\u5e93\u53ca\u5176\u5e94\u7528\u7cfb\u7edf\uff0c\u4f7f\u4e4b\u80fd\u591f\u6709\u6548\u5730\u5b58\u50a8\u548c\u7ba1\u7406\u6570\u636e\uff0c\u6ee1\u8db3\u5404\u79cd\u7528\u6237\u7684\u5e94\u7528\u9700\u6c42\uff0c\u5305\u62ec\u4fe1\u606f\u7ba1\u7406\u8981\u6c42\u548c\u6570\u636e\u64cd\u4f5c\u8981\u6c42\u3002</p> <p>\u6570\u636e\u5e93\u8bbe\u8ba1\u7684\u76ee\u6807 \uff1a\u662f\u4e3a\u7528\u6237\u548c\u5404\u79cd\u5e94\u7528\u7cfb\u7edf\u63d0\u4f9b\u4e00\u4e2a\u4fe1\u606f\u57fa\u7840\u8bbe\u65bd\u548c\u9ad8\u6548\u7387\u7684\u8fd0\u884c\u73af\u5883 \u3002</p> <p>\u6570\u636e\u5e93\u8bbe\u8ba1\u7684\u57fa\u672c\u4efb\u52a1 \uff1a\u662f\u6839\u636e\u7528\u6237\u7684\u4fe1\u606f\u9700\u6c42\u3001\u5904\u7406\u9700\u6c42\u548c\u6570\u636e\u5e93\u7684\u652f\u6301\u73af\u5883(\u5305\u62ec\u786c\u4ef6\u3001\u64cd\u4f5c\u7cfb\u7edf\u548c DBMS)\uff0c\u8bbe\u8ba1\u51fa\u6570\u636e\u5e93\u6a21\u5f0f(\u5305\u62ec\u5916\u6a21\u5f0f\u3001\u903b\u8f91\u6a21\u5f0f\u548c\u5185\u6a21\u5f0f)\u53ca\u5176\u5178\u578b\u7684\u5e94\u7528\u7a0b\u5e8f\u3002</p> <p>\u6211\u4eec\u5728\u8bbe\u8ba1\u6570\u636e\u8868\u7684\u65f6\u5019\uff0c\u8981\u8003\u8651\u5f88\u591a\u95ee\u9898\u3002\u6bd4\u5982\uff1a</p> <ul> <li> <p>\u7528\u6237\u90fd\u9700\u8981\u4ec0\u4e48\u6570\u636e?\u9700\u8981\u5728\u6570\u636e\u8868\u4e2d\u4fdd\u5b58\u54ea\u4e9b\u6570\u636e\uff1f</p> </li> <li> <p>\u5982\u4f55\u4fdd\u8bc1\u6570\u636e\u8868\u4e2d\u6570\u636e\u7684\u6b63\u786e\u6027\uff0c\u5f53\u63d2\u5165\u3001\u5220\u9664\u3001\u66f4\u65b0\u7684\u65f6\u5019\u8be5\u8fdb\u884c\u600e\u6837\u7684\u7ea6\u675f\u68c0\u67e5?</p> </li> <li> <p>\u5982\u4f55\u964d\u4f4e\u6570\u636e\u8868\u7684\u6570\u636e\u5197\u4f59\u5ea6 \uff0c\u4fdd\u8bc1\u6570\u636e\u8868\u4e0d\u4f1a\u56e0\u4e3a\u7528\u6237\u91cf\u7684\u589e\u957f\u800c\u8fc5\u901f\u6269\u5f20?</p> </li> <li> <p>\u5982\u4f55\u8ba9\u8d1f\u8d23\u6570\u636e\u5e93\u7ef4\u62a4\u7684\u4eba\u5458\u66f4\u65b9\u4fbf\u5730\u4f7f\u7528\u6570\u636e\u5e93?</p> </li> <li> <p>\u4f7f\u7528\u6570\u636e\u5e93\u7684\u5e94\u7528\u573a\u666f\u4e5f\u5404\u4e0d\u76f8\u540c\uff0c\u53ef\u4ee5\u8bf4\u9488\u5bf9\u4e0d\u540c\u7684\u60c5\u51b5\uff0c\u8bbe\u8ba1\u51fa\u6765\u7684\u6570\u636e\u8868\u53ef\u80fd \u5343\u5dee\u4e07\u522b \u3002</p> </li> </ul> <p>\u73b0\u5b9e\u60c5\u51b5\u4e2d\uff0c\u9762\u4e34\u7684\u573a\u666f:</p> <p>\u5f53\u6570\u636e\u5e93\u8fd0\u884c\u4e86\u4e00\u6bb5\u65f6\u95f4\u4e4b\u540e\uff0c\u6211\u4eec\u624d\u53d1\u73b0\u6570\u636e\u8868\u8bbe\u8ba1\u7684\u6709\u95ee\u9898\u3002\u91cd\u65b0\u8c03\u6574\u6570\u636e\u8868\u7684\u7ed3\u6784\uff0c\u5c31\u9700\u8981\u505a\u6570\u636e\u8fc1\u79fb\uff0c\u8fd8\u6709\u53ef\u80fd\u5f71\u54cd\u7a0b\u5e8f\u7684\u4e1a\u52a1\u903b\u8f91\uff0c\u4ee5\u53ca\u7f51\u7ad9\u6b63\u5e38\u7684\u8bbf\u95ee\u3002</p> <p>\u5982\u679c\u662f\u7cdf\u7cd5\u7684\u6570\u636e\u5e93\u8bbe\u8ba1\u53ef\u80fd\u4f1a\u9020\u6210\u4ee5\u4e0b\u95ee\u9898:</p> <ul> <li> <p>\u6570\u636e\u5197\u4f59\u3001\u4fe1\u606f\u91cd\u590d\uff0c\u5b58\u50a8\u7a7a\u95f4\u6d6a\u8d39</p> </li> <li> <p>\u6570\u636e\u66f4\u65b0\u3001\u63d2\u5165\u3001\u5220\u9664\u7684\u5f02\u5e38</p> </li> <li> <p>\u65e0\u6cd5\u6b63\u786e\u8868\u793a\u4fe1\u606f</p> </li> <li> <p>\u4e22\u5931\u6709\u6548\u4fe1\u606f</p> </li> <li> <p>\u7a0b\u5e8f\u6027\u80fd\u5dee</p> </li> </ul> <p>\u826f\u597d\u7684\u6570\u636e\u5e93\u8bbe\u8ba1\u5219\u6709\u4ee5\u4e0b\u4f18\u70b9:</p> <ul> <li> <p>\u8282\u7701\u6570\u636e\u7684\u5b58\u50a8\u7a7a\u95f4</p> </li> <li> <p>\u80fd\u591f\u4fdd\u8bc1\u6570\u636e\u7684\u5b8c\u6574\u6027</p> </li> <li> <p>\u65b9\u4fbf\u8fdb\u884c\u6570\u636e\u5e93\u5e94\u7528\u7cfb\u7edf\u7684\u5f00\u53d1</p> </li> </ul> <p>\u603b\u4e4b\uff0c\u5f00\u59cb\u8bbe\u7f6e\u6570\u636e\u5e93\u7684\u65f6\u5019\uff0c\u6211\u4eec\u5c31\u9700\u8981\u91cd\u89c6\u6570\u636e\u8868\u7684\u8bbe\u8ba1\u3002\u4e3a\u4e86\u5efa\u7acb \u5197\u4f59\u8f83\u5c0f\u3001\u7ed3\u6784\u5408\u7406 \u7684\u6570\u636e\u5e93\uff0c\u8bbe\u8ba1\u6570\u636e\u5e93\u65f6\u5fc5\u987b\u9075\u5faa\u4e00\u5b9a\u7684\u89c4\u5219\u3002</p> <ul> <li> <p>\u7528\u6237\u9700\u6c42\u5206\u6790</p> </li> <li> <p>\u4ea7\u51fa\uff1a\u9700\u6c42\u8bf4\u660e\u6587\u6863\uff0c\u6570\u636e\u5b57\u5178\u548c\u6570\u636e\u6d41\u56fe</p> </li> <li> <p>\u6982\u5ff5\u7ed3\u6784\u8bbe\u8ba1</p> </li> <li> <p>\u903b\u8f91\u7ed3\u6784\u8bbe\u8ba1</p> </li> <li> <p>\u7269\u7406\u7ed3\u6784\u8bbe\u8ba1</p> </li> <li> <p>\u6570\u636e\u5e93\u5b9e\u65bd\u9636\u6bb5</p> </li> <li> <p>\u6570\u636e\u5e93\u8fd0\u884c\u548c\u7ef4\u62a4\u9636\u6bb5</p> </li> </ul>"},{"location":"dev/02.%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AE%BE%E8%AE%A1/#er","title":"ER \u56fe","text":"<p>\u5b9e\u4f53\u5173\u7cfb\u56fe\uff08\uff08Entity-Relationship Diagram\uff09\uff09\u4e5f\u88ab\u79f0\u4e3a ERD\u3001ER \u56fe\u3001\u5b9e\u4f53\u8054\u7cfb\u6a21\u578b\u3001\u5b9e\u4f53\u8054\u7cfb\u6a21\u5f0f\u56fe\u6216 ER \u6a21\u578b\uff0c\u662f\u4e00\u79cd\u7528\u4e8e\u6570\u636e\u5e93\u8bbe\u8ba1\u7684\u7ed3\u6784\u56fe\u3002\u5b83\u63cf\u8ff0\u4e86\u6570\u636e\u5e93\u4e2d\u7684\u5b9e\u4f53\u4ee5\u53ca\u8fd9\u4e9b\u5b9e\u4f53\u4e4b\u95f4\u7684\u5173\u7cfb\u3002ERD \u5305\u62ec**\u5b9e\u4f53**\u3001**\u5c5e\u6027**\u4ee5\u53ca**\u5173\u7cfb**\u4e09\u4e2a\u90e8\u5206\u3002</p> <p>\u4e00\u5e45 ERD \u5305\u542b\u4e0d\u540c\u7684\u7b26\u53f7\u548c\u8fde\u63a5\u7b26\uff0c\u7528\u4e8e\u663e\u793a\u4e24\u4e2a\u91cd\u8981\u7684\u4fe1\u606f\uff1a \u7cfb\u7edf\u8303\u56f4\u5185\u7684\u4e3b\u8981\u5b9e\u4f53\uff0c\u4ee5\u53ca\u8fd9\u4e9b\u5b9e\u4f53\u4e4b\u95f4\u7684\u76f8\u4e92\u5173\u7cfb</p> <p>E-R \u56fe\u53eb\u5b9e\u4f53\u8054\u7cfb\u56fe\uff0c\u7528\u56fe\u5f62\u5316\u8868\u793a\u6570\u636e\u5e93\u7684\u5168\u5c40\u903b\u8f91\u7ed3\u6784\u3002</p> <ul> <li> <p>\u5728 ER \u6a21\u578b\u4e2d\uff0c\u5b9e\u4f53\u663e\u793a\u4e3a \u5706\u89d2\u77e9\u5f62 \uff0c\u5176\u540d\u79f0\u4f4d\u4e8e\u4e0a\u65b9\uff0c\u5176\u5c5e\u6027\u5217\u5728\u5b9e\u4f53\u5f62\u72b6\u7684\u4e3b\u4f53\u4e2d\u3002\u5b9e\u4f53\u4ee3\u8868\u4e86\u4e00\u79cd\u5bf9\u8c61\u6216\u8005\u6982\u5ff5\u3002\u4f8b\u5982\uff0c\u5458\u5de5\u3001\u90e8\u95e8\u548c\u804c\u4f4d\u90fd\u53ef\u4ee5\u79f0\u4e3a\u5b9e\u4f53\u3002</p> </li> <li> <p>\u5206\u6210\u4e24\u90e8\u5206\u7684\u77e9\u5f62 \u4ee3\u8868\u5b9e\u4f53\u96c6\uff0c \u9634\u5f71\u90e8\u5206 \u662f\u5b9e\u4f53\u96c6\u540d\u5b57\uff0c\u7b2c\u4e8c\u90e8\u5206\u5305\u62ec\u5b9e\u4f53\u96c6\u5c5e\u6027\uff0c\u4e3b\u7801\u5c5e\u6027\u5e26\u4e0b\u5212\u7ebf\u3002\u5c5e\u6027\u8868\u793a\u5b9e\u4f53\u7684\u67d0\u79cd\u7279\u6027\uff0c\u4f8b\u5982\u5458\u5de5\u62e5\u6709\u59d3\u540d\u3001\u6027\u522b\u3001\u5de5\u8d44\u3001\u6240\u5728\u90e8\u95e8\u7b49\u5c5e\u6027\u3002</p> </li> <li> <p>\u83f1\u5f62 \u4ee3\u8868\u8054\u7cfb\u96c6\u3002</p> </li> <li> <p>\u672a\u5206\u5272\u7684\u77e9\u5f62 \u4ee3\u8868\u8054\u7cfb\u96c6\u7684\u5c5e\u6027\u3002</p> </li> <li> <p>\u8054\u7cfb\u96c6\u4e0e\u5176\u5c5e\u6027\u4ee5 \u865a\u7ebf \u8fde\u63a5\u3002</p> </li> <li> <p>\u7ebf\u6bb5 \u5c06\u5b9e\u4f53\u96c6\u4e0e\u8054\u7cfb\u96c6\u8fde\u63a5\u3002</p> </li> </ul> <p>\u8be6\u7ec6\u53ef\u4ee5\u53c2\u8003visual-paradigm</p> <p>\u8fdb\u4e00\u6b65\u6765\u8bf4\uff0cERD \u53ef\u4ee5\u6309\u7167\u62bd\u8c61\u5c42\u6b21\u5206\u4e3a\u4e09\u79cd\uff1a</p> <ul> <li>\u6982\u5ff5 ERD\uff0c\u5373\u6982\u5ff5\u6570\u636e\u6a21\u578b\u3002\u63cf\u8ff0\u7cfb\u7edf\u4e2d\u5b58\u5728\u7684\u4e1a\u52a1\u5bf9\u8c61\u4ee5\u53ca\u5b83\u4eec\u4e4b\u95f4\u7684\u8054\u7cfb\uff0c\u4e00\u822c\u7ed9\u4e1a\u52a1\u5206\u6790\u4eba\u5458\u4f7f\u7528\u3002\u4e0a\u56fe\u5c31\u662f\u4e00\u4e2a\u6982\u5ff5 ERD\u3002</li> <li>\u903b\u8f91 ERD\uff0c\u5373\u903b\u8f91\u6570\u636e\u6a21\u578b\u3002\u5bf9\u6982\u5ff5\u6570\u636e\u6a21\u578b\u8fdb\u4e00\u6b65\u7684\u5206\u89e3\u548c\u7ec6\u5316\uff0c\u8f6c\u6362\u4e3a\u5173\u7cfb\u6a21\u578b\u3002\u540c\u65f6\uff0c\u8fd8\u9700\u8981\u5f15\u5165\u89c4\u8303\u5316\u8fc7\u7a0b\uff0c\u5bf9\u5173\u7cfb\u6a21\u5f0f\u8fdb\u884c\u4f18\u5316\u3002</li> <li>\u7269\u7406 ERD\uff0c\u5373\u7269\u7406\u6570\u636e\u6a21\u578b\u3002\u7269\u7406 ERD \u662f\u9488\u5bf9\u5177\u4f53\u6570\u636e\u5e93\u7684\u8bbe\u8ba1\u63cf\u8ff0\uff0c\u9700\u8981\u4e3a\u6bcf\u5217\u6307\u5b9a\u7c7b\u578b\u3001\u957f\u5ea6\u3001\u53ef\u5426\u4e3a\u7a7a\u7b49\u5c5e\u6027\uff0c\u4e3a\u8868\u589e\u52a0\u4e3b\u952e\u3001\u5916\u952e\u4ee5\u53ca\u7d22\u5f15\u7b49</li> </ul>"},{"location":"dev/02.%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AE%BE%E8%AE%A1/#_4","title":"\u6570\u636e\u6d41\u56fe","text":"<p>\u4ece\u539f\u7406\u4e0a\u8bb2\uff0c\u53ea\u8981\u7eb8\u8db3\u591f\u5927\uff0c\u4e00\u4e2a\u8f6f\u4ef6\u7cfb\u7edf\u7684\u5206\u6790\u6a21\u578b\u5c31\u53ef\u4ee5\u753b\u5728\u4e00\u5f20\u7eb8\u4e0a\u3002\u7136\u800c\uff0c\u4e00\u4e2a\u590d\u6742\u7684\u8f6f\u4ef6\u7cfb\u7edf\u53ef\u80fd\u6d89\u53ca\u4e0a\u767e\u4e2a\u52a0\u5de5\u548c\u4e0a\u767e\u4e2a\u6570\u636e\u6d41\uff0c\u751a\u81f3\u66f4\u591a\u3002</p> <p>\u5982\u679c\u5c06\u5b83\u4eec\u753b\u5728\u4e00\u5f20\u56fe\u4e0a\uff0c\u5219\u4f1a\u5341\u5206\u590d\u6742\uff0c\u4e0d\u6613\u9605\u8bfb\uff0c\u4e5f\u4e0d\u6613\u7406\u89e3\u3002\u56e0\u6b64\uff0c\u6839\u636e\u81ea\u9876\u5411\u4e0b\u9010\u5c42\u5206\u89e3\u7684\u601d\u60f3\uff0c\u53ef\u4ee5\u5c06\u6570\u636e\u6d41\u56fe\u6309\u7167\u5c42\u6b21\u7ed3\u6784\u6765\u7ed8\u5236\u3002</p> <p>DFD \u4e2d\u4f7f\u7528\u7ea7\u522b\u6216\u5c42\u6765\u8868\u793a\u6709\u5173\u7cfb\u7edf\u6216\u8fc7\u7a0b\u7684\u6e10\u8fdb\u5f0f\u8be6\u7ec6\u7a0b\u5ea6\u3002\u8fd9\u4e9b\u7ea7\u522b\u5305\u62ec\uff1a</p> <p>\u7ea7\u522b 0\uff1a\u4e5f\u79f0\u4e3a\"\u4e0a\u4e0b\u6587\u56fe\"\uff0c\u8fd9\u662f\u6700\u9ad8\u7ea7\u522b\uff0c\u5b83\u4ec5\u5305\u542b\u4e00\u4e2a\u6d41\u7a0b\u8282\u70b9\uff08\"\u6d41\u7a0b 0\"\uff09\uff0c\u5b83\u6982\u62ec\u4e86\u4e0e\u5916\u90e8\u5b9e\u4f53\u76f8\u5173\u7684\u6574\u4e2a\u7cfb\u7edf\u7684\u529f\u80fd\u3002</p> <ul> <li>\u6240\u6709\u5916\u90e8\u5b9e\u4f53\u4ee5\u53ca\u8fdb\u51fa\u5b83\u4eec\u7684\u4e3b\u8981\u6570\u636e\u6d41\u90fd\u663e\u793a\u5728\u4e0a\u4e0b\u6587\u56fe\u4e0a\u3002</li> <li>\u8be5\u56fe\u4e0d\u5305\u542b\u4efb\u4f55\u6570\u636e\u5b58\u50a8\u3002</li> <li>\u4e0a\u4e0b\u6587\u56fe\u4e2d\u7684\u8fdb\u7a0b\u540d\u79f0\u5e94\u8be5\u662f\u4fe1\u606f\u7cfb\u7edf\u7684\u540d\u79f0\u3002\u4f8b\u5982\uff0c\u8bc4\u5206\u7cfb\u7edf\u3001\u8ba2\u5355\u5904\u7406\u7cfb\u7edf\u3001\u6ce8\u518c\u7cfb\u7edf\u3002</li> </ul> <p>\u7ea7\u522b 1\uff1a\u4ecd\u7136\u662f\u7cfb\u7edf\u7684\u76f8\u5bf9\u5bbd\u6cdb\u7684\u89c6\u56fe\uff0c\u4f46\u5305\u542b\u5b50\u6d41\u7a0b\u548c\u66f4\u591a\u7ec6\u8282\u3002</p> <p>\u7ea7\u522b 2\uff1a\u63d0\u4f9b\u66f4\u591a\u7ec6\u8282\uff0c\u5e76\u6839\u636e\u9700\u8981\u7ee7\u7eed\u5206\u89e3\u5b50\u6d41\u7a0b\u3002</p> <p>\u7ea7\u522b 3\uff1a\u867d\u7136\u8fd9\u79cd\u8be6\u7ec6\u7a0b\u5ea6\u5e76\u4e0d\u5e38\u89c1\uff0c\u4f46\u590d\u6742\u7cfb\u7edf\u53ef\u4ee5\u4ece\u8be5\u7ea7\u522b\u7684\u8868\u793a\u4e2d\u53d7\u76ca\u3002</p> <p>\u6570\u636e\u6d41\u56fe (DFD) \u7528\u4e8e\u8868\u793a\u4e1a\u52a1\u4fe1\u606f\u7cfb\u7edf\u4e2d\u7684\u6570\u636e\u6d41\uff0c\u5b83\u8868\u8fbe\u4e86\u7cfb\u7edf\u4e2d\u7684\u636e\u4f20\u4ece\u8f93\u5165\u5230\u5b58\u50a8\u95f4\u6240\u6d89\u53ca\u7684\u7a0b\u5e8f\u3002</p> <p>\u6570\u636e\u6d41\u56fe\u53ef\u4ee5\u5206\u4e3a \u903b\u8f91\u5f62 \u548c \u7269\u7406\u5f62 \u3002</p> <ul> <li> <p>\u903b\u8f91\u6570\u636e\u6d41\u56fe\u63cf\u8ff0\u4e86\u7528\u4ee5\u5b8c\u6210\u67d0\u4e1a\u52a1\u529f\u80fd\u6240\u6d89\u53ca\u7684\u3001\u4e1a\u52a1\u5c42\u9762\u7684\u6570\u636e\u6d41\u52a8</p> </li> <li> <p>\u7269\u7406\u6570\u636e\u6d41\u56fe\u63cf\u8ff0\u7cfb\u7edf\u5c42\u9762\u7684\u6570\u636e\u6d41\u52a8\u3002</p> </li> </ul> <p>\u6570\u636e\u6d41\u56fe\u4e2d\u7684\u5404\u79cd\u89c4\u5219\uff1a</p> <ul> <li> <p>\u7a0b\u5e8f\uff1a \u7a0b\u5e8f\u8868\u793a\u5bf9\u6570\u636e\u7684\u5904\u7406\u8fc7\u7a0b\uff0c\u5b83\u53ef\u4ee5\u63a5\u6536\u8f93\u5165\uff0c\u5e76\u4ea7\u751f\u8f93\u51fa\uff0c\u6bcf\u4e2a\u7a0b\u5e8f\u90fd\u6709\u4e00\u4e2a\u540d\u79f0\u6765\u6807\u8bc6\u5b83\u6240\u6267\u884c\u7684\u529f\u80fd\uff0c\u6bd4\u5982\uff1a\u7533\u8bf7\u4ed8\u6b3e\uff0c\u8ba1\u7b97\u4f63\u91d1\u7b49\u3002\u7528 \u5706\u89d2\u77e9\u5f62 \u8868\u793a\u3002</p> </li> <li> <p>\u6570\u636e\u5b58\u50a8: \u8868\u793a\u6682\u65f6\u5b58\u50a8\u7684\u6570\u636e , \u6570\u636e\u5b58\u50a8\u7684\u7c92\u5ea6\u662f\u4ee5\u8868\u4e3a\u5355\u4f4d\u3002\u7528 \u534a\u6846\u77e9\u5f62 \u8868\u793a\u3002</p> </li> <li> <p>\u6570\u636e\u5b58\u50a8\u5fc5\u987b\u4ee5\u6570\u636e\u6d41\u8fde\u63a5\u5230\u7a0b\u5e8f\u3002</p> </li> <li> <p>\u6bcf\u4e2a\u6570\u636e\u5b58\u50a8\u5fc5\u987b\u81f3\u5c11\u6709\u4e00\u4e2a\u8f93\u5165\u6570\u636e\u6d41\u548c\u81f3\u5c11\u4e00\u4e2a\u8f93\u51fa\u6570\u636e\u6d41\uff08\u5373\u4f7f\u8f93\u51fa\u6570\u636e\u6d41\u662f\u4e00\u4e2a\u786e\u8ba4\u8baf\u606f\uff09\u3002</p> </li> <li> <p>\u65b9\u5411\uff1a\u6d41\u5411\u6587\u4ef6\u7684\u6570\u636e\u6d41 \u8868\u793a \u5411\u6587\u4ef6\u5185\u5199\u5165\u5185\u5bb9 , \u4ece\u6587\u4ef6\u6d41\u51fa\u7684\u6570\u636e\u6d41 \u8868\u793a \u4ece\u6587\u4ef6\u8bfb\u53d6\u5185\u5bb9 ;</p> </li> <li> <p>\u5916\u90e8\u5b9e\u4f53(\u5b9e\u4f53)\uff1a \u8f6f\u4ef6\u7cfb\u7edf\u4e4b\u5916\u7684\u4eba\u5458/\u7ec4\u7ec7\uff0c\u5b9e\u4f53\u7528 \u76f4\u89d2\u77e9\u5f62 \u8868\u793a\u3002</p> </li> <li> <p>\u6570\u636e\u6d41\uff1a \u6570\u636e\u6d41\u662f\u6570\u636e\u4ece\u4fe1\u606f\u7cfb\u7edf\u7684\u4e00\u4e2a\u90e8\u5206\u79fb\u52a8\u5230\u53e6\u4e00\u4e2a\u90e8\u5206\u7684\u8def\u5f84\u3002</p> </li> <li> <p>\u5e26\u8f93\u5165\u7bad\u5934\u7684\u76f4\u7ebf\u5373\u4e3a \u8f93\u5165\u6570\u636e\u6d41</p> </li> <li> <p>\u5e26\u8f93\u5165\u7bad\u5934\u7684\u76f4\u7ebf\u5373\u4e3a \u8f93\u5165\u6570\u636e\u6d41</p> </li> <li> <p>\u7531\u4e8e\u6bcf\u4e2a\u7a0b\u5e8f\u90fd\u5c06\u6570\u636e\u4ece\u4e00\u79cd\u5f62\u6001\u8f6c\u6362\u4e3a\u53e6\u4e00\u79cd\u5f62\u6001\uff0c\u6545\u6bcf\u4e2a\u7a0b\u5e8f\u5fc5\u987b\u81f3\u5c11\u6709\u4e00\u4e2a\u8f93\u5165\u6570\u636e\u6d41\u548c\u4e00\u4e2a\u8f93\u51fa\u6570\u636e\u6d41\u3002</p> </li> <li> <p>\u6570\u636e\u6d41\u56fe\u7684\u4e00\u5927\u539f\u5219\u662f\u6570\u636e\u4e0d\u80fd\u81ea\u884c\u8f6c\u6362\u6210\u53e6\u4e00\u5f62\u6001\uff0c\u6570\u636e\u5fc5\u987b\u7ecf\u7531\u67d0\u7a0b\u5e8f\u7684\u5904\u7406\u624d\u53ef\u88ab\u5206\u53d1\u81f3\u7cfb\u7edf\u7684\u67d0\u4e2a\u90e8\u4efd\u3002\u901a\u8fc7\u8fd9\u6761\u89c4\u5219\uff0c\u6211\u4eec\u53ef\u4ee5\u975e\u5e38\u5bb9\u6613\u5730\u8bc6\u522b\u51fa\u9519\u8bef\u753b\u6cd5\u3002</p> </li> </ul>"},{"location":"dev/02.%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AE%BE%E8%AE%A1/#uml","title":"UML \u56fe","text":"<p>UML \u662f <code>Unified Model Language</code> \u7684\u7f29\u5199\uff0c\u4e2d\u6587\u662f \u7edf\u4e00\u5efa\u6a21\u8bed\u8a00 \uff0c\u662f\u7531\u4e00\u6574\u5957\u56fe\u8868\u7ec4\u6210\u7684\u6807\u51c6\u5316\u5efa\u6a21\u8bed\u8a00\u3002</p> <p>\u5728\u8f6f\u4ef6\u5f00\u53d1\u4e2d\uff0c\u5f53\u7cfb\u7edf\u89c4\u6a21\u6bd4\u8f83\u590d\u6742\u65f6\uff0c\u9700\u8981\u7528\u56fe\u5f62\u62bd\u8c61\u5730\u6765\u8868\u8fbe\u590d\u6742\u7684\u6982\u5ff5\uff0c\u8ba9\u6574\u4e2a\u8f6f\u4ef6\u8bbe\u8ba1\u66f4\u5177\u6709\u53ef\u8bfb\u6027\uff0c\u53ef\u7406\u89e3\u6027\uff0c\u4ee5\u4fbf\u5c3d\u65e9\u53d1\u73b0\u8f6f\u4ef6\u8bbe\u8ba1\u65f6\u5b58\u5728\u7684\u6f5c\u5728\u95ee\u9898\uff0c\u4ece\u800c\u964d\u4f4e\u5f00\u53d1\u98ce\u9669\u3002\u540c\u65f6\uff0c\u4e5f\u6781\u5927\u5730\u65b9\u4fbf\u4e86\u4e1a\u52a1\u4eba\u5458\u4e0e\u5f00\u53d1\u4eba\u5458\u4e4b\u95f4\u7684\u4ea4\u6d41\u3002</p> <p>UML \u63d0\u4f9b\u4e86\u6781\u5bcc\u8868\u8fbe\u80fd\u529b\u7684\u5efa\u6a21\u8bed\u8a00\uff0c\u53ef\u4ee5\u8ba9\u8f6f\u4ef6\u5f00\u53d1\u8fc7\u7a0b\u4e2d\u7684\u4e0d\u540c\u4eba\u5458\u5206\u522b\u5f97\u5230\u81ea\u5df1\u611f\u5174\u8da3\u7684\u4fe1\u606f\u3002</p> <p>Page-Jones \u5728\u300aFundamental Object-Oriented Design in UML\u300b \u4e00\u4e66\u4e2d\u603b\u7ed3\u4e86 UML \u7684\u4e3b\u8981\u76ee\u7684\uff0c\u5982\u4e0b\uff1a</p> <ul> <li>\u4e3a\u7528\u6237\u63d0\u4f9b\u73b0\u6210\u7684\u3001\u6709\u8868\u73b0\u529b\u7684\u53ef\u89c6\u5316\u5efa\u6a21\u8bed\u8a00\uff0c\u4ee5\u4fbf\u4ed6\u4eec\u5f00\u53d1\u548c\u4ea4\u6362\u6709\u610f\u4e49\u7684\u6a21\u578b\u3002</li> <li>\u4e3a\u6838\u5fc3\u6982\u5ff5\u63d0\u4f9b\u53ef\u6269\u5c55\u6027 (Extensibility) \u548c\u7279\u6b8a\u5316 (Specialization) \u673a\u5236\u3002</li> <li>\u72ec\u7acb\u4e8e\u7279\u5b9a\u7684\u7f16\u7a0b\u8bed\u8a00\u548c\u5f00\u53d1\u8fc7\u7a0b\u3002</li> <li>\u4e3a\u4e86\u89e3\u5efa\u6a21\u8bed\u8a00\u63d0\u4f9b\u4e00\u4e2a\u6b63\u5f0f\u7684\u57fa\u7840\u3002</li> <li>\u9f13\u52b1\u9762\u5411\u5bf9\u8c61\u5de5\u5177\u5e02\u573a\u7684\u53d1\u5c55\u3002</li> <li>\u652f\u6301\u66f4\u9ad8\u5c42\u6b21\u7684\u5f00\u53d1\u6982\u5ff5\uff0c\u5982\u534f\u4f5c\uff0c\u6846\u67b6\uff0c\u6a21\u5f0f\u548c\u7ec4\u4ef6\u3002</li> <li>\u6574\u5408\u6700\u4f73\u7684\u5de5\u4f5c\u65b9\u6cd5 (Best Practices)\u3002</li> </ul> <p>UML \u56fe\u5206\u4e3a\u7ed3\u6784\u56fe\u548c\u884c\u4e3a\u56fe\uff1a</p> <ul> <li> <p>\u7ed3\u6784\u56fe\u5206\u4e3a\u7c7b\u56fe\u3001\u8f6e\u5ed3\u56fe\u3001\u7ec4\u4ef6\u56fe\u3001\u7ec4\u5408\u7ed3\u6784\u56fe\u3001\u5bf9\u8c61\u56fe\u3001\u90e8\u7f72\u56fe\u3001\u5305\u56fe\u3002</p> </li> <li> <p>\u884c\u4e3a\u56fe\u53c8\u5206\u6d3b\u52a8\u56fe\u3001\u7528\u4f8b\u56fe\u3001\u72b6\u6001\u673a\u56fe\u548c\u4ea4\u4e92\u56fe\u3002</p> </li> <li> <p>\u4ea4\u4e92\u56fe\u53c8\u5206\u4e3a\u5e8f\u5217\u56fe\u3001\u65f6\u5e8f\u56fe\u3001\u901a\u8baf\u56fe\u3001\u4ea4\u4e92\u6982\u89c8\u56fe\u3002</p> </li> </ul>"},{"location":"dev/02.%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AE%BE%E8%AE%A1/#_5","title":"\u8303\u5f0f\u548c\u53cd\u8303\u5f0f","text":"<p>SQL \u662f\u4e00\u95e8\u58f0\u660e\u5f0f\u7684\u7f16\u7a0b\u8bed\u8a00\uff0c\u5c31\u50cf Lisp\u3001Haskell \u6216\u8005 XSLT\u3002SQL \u4f7f\u7528\u96c6\u5408\uff08set\uff09\u4f5c\u4e3a\u6839\u672c\u7684\u6570\u636e\u7ed3\u6784\uff0c\u800c\u9762\u5411\u5bf9\u8c61\u7684\u8bed\u8a00\u4f7f\u7528\u7684\u662f\u5bf9\u8c61\uff08object\uff09\u3002\u53d7\u8fc7\u4f20\u7edf\u57f9\u8bad\u7684\u8f6f\u4ef6\u5f00\u53d1\u4eba\u5458\u88ab\u6240\u8c13\u7684\"\u963b\u6297\u5931\u914d\"\u6240\u963b\u788d\uff0c\u56e0\u6b64\u5f88\u591a\u7a0b\u5e8f\u5458\u8f6c\u800c\u4f7f\u7528\u73b0\u6210\u7684\u9762\u5411\u5bf9\u8c61\u7684\u5e93\uff0c\u4ee5\u6b64\u6765\u907f\u514d\u5b66\u4e60\u5982\u4f55\u9ad8\u6548\u5730\u4f7f\u7528 SQL</p>"},{"location":"dev/02.%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AE%BE%E8%AE%A1/#_6","title":"\u8303\u5f0f","text":"<p>\u89c4\u8303\u5316\uff08Normalization\uff09\u662f\u6570\u636e\u5e93\u8bbe\u8ba1\u7684\u4e00\u7cfb\u5217\u539f\u7406\u548c\u6280\u672f\uff0c\u4e3b\u8981\u7528\u4e8e\u51cf\u5c11\u8868\u4e2d\u6570\u636e\u7684\u5197\u4f59\uff0c\u589e\u52a0\u5b8c\u6574\u6027\u548c\u4e00\u81f4\u6027\u3002</p> <p>\u6211\u4eec\u5728\u8bbe\u8ba1\u5173\u7cfb\u578b\u6570\u636e\u5e93\u6a21\u578b\u7684\u65f6\u5019\uff0c\u9700\u8981\u5bf9\u5173\u7cfb\u5185\u90e8\u5404\u4e2a\u5c5e\u6027\u4e4b\u95f4\u8054\u7cfb\u7684\u5408\u7406\u5316\u7a0b\u5ea6\u8fdb\u884c\u5b9a\u4e49\u3002</p> <p>\u8fd9\u5c31\u6709\u4e86\u4e0d\u540c\u7b49\u7ea7\u7684\u89c4\u8303\u8981\u6c42\uff0c\u8fd9\u4e9b\u89c4\u8303\u8981\u6c42\u88ab\u79f0\u4e3a\u8303\u5f0f\uff08NF\uff09\u3002\u4f60\u53ef\u4ee5\u628a\u8303\u5f0f\u7406\u89e3\u4e3a\uff0c\u4e00\u5f20\u6570\u636e\u8868\u7684\u8bbe\u8ba1\u7ed3\u6784\u9700\u8981\u6ee1\u8db3\u7684\u67d0\u79cd\u8bbe\u8ba1\u6807\u51c6\u7684\u7ea7\u522b\u3002</p> <p>\u5728\u5173\u7cfb\u578b\u6570\u636e\u5e93\u4e2d\uff0c\u5173\u4e8e\u6570\u636e\u8868\u8bbe\u8ba1\u7684\u57fa\u672c\u539f\u5219\u3001\u89c4\u5219\u5c31\u79f0\u4e3a\u8303\u5f0f\u3002\u53ef\u4ee5\u7406\u89e3\u4e3a\uff0c\u4e00\u5f20\u6570\u636e\u8868\u7684\u8bbe\u8ba1\u7ed3\u6784\u9700\u8981\u6ee1\u8db3\u7684\u67d0\u79cd\u8bbe\u8ba1\u6807\u51c6\u7684\u7ea7\u522b\u3002\u8981\u60f3\u8bbe\u8ba1\u4e00\u4e2a\u7ed3\u6784\u5408\u7406\u7684\u5173\u7cfb\u578b\u6570\u636e\u5e93\uff0c\u5fc5\u987b\u6ee1\u8db3\u4e00\u5b9a\u7684\u8303\u5f0f\u3002</p> <p>\u8303\u5f0f\u7684\u82f1\u6587\u540d\u79f0\u662f Normal Form\uff0c\u7b80\u79f0 NF\u3002\u5b83\u662f\u82f1\u56fd\u4eba E.F.Codd \u5728\u4e0a\u4e2a\u4e16\u7eaa 70 \u5e74\u4ee3\u63d0\u51fa\u5173\u7cfb\u6570\u636e\u5e93\u6a21\u578b\u540e\u603b\u7ed3\u51fa\u6765\u7684\u3002\u8303\u5f0f\u662f\u5173\u7cfb\u6570\u636e\u5e93\u7406\u8bba\u7684\u57fa\u7840\uff0c\u4e5f\u662f\u6211\u4eec\u5728\u8bbe\u8ba1\u6570\u636e\u5e93\u7ed3\u6784\u8fc7\u7a0b\u4e2d\u6240\u8981\u9075\u5faa\u7684 \u89c4\u5219\u548c\u6307\u5bfc\u65b9\u6cd5\u3002</p> <p>\u76ee\u524d\u5173\u7cfb\u578b\u6570\u636e\u5e93\u4e00\u5171\u6709 6 \u79cd\u8303\u5f0f\uff0c\u6309\u7167\u8303\u5f0f\u7ea7\u522b\uff0c\u4ece\u4f4e\u5230\u9ad8\u5206\u522b\u662f\uff1a</p> <ul> <li> <p>1NF\uff08\u7b2c\u4e00\u8303\u5f0f\uff09</p> </li> <li> <p>2NF\uff08\u7b2c\u4e8c\u8303\u5f0f\uff09</p> </li> <li> <p>3NF\uff08\u7b2c\u4e09\u8303\u5f0f\uff09</p> </li> <li> <p>BCNF\uff08\u5df4\u65af - \u79d1\u5fb7\u8303\u5f0f\uff09</p> </li> <li> <p>4NF\uff08\u7b2c\u56db\u8303\u5f0f\uff09</p> </li> <li> <p>5NF\uff08\u7b2c\u4e94\u8303\u5f0f\uff0c\u53c8\u53eb\u505a\u5b8c\u7f8e\u8303\u5f0f\uff09</p> </li> </ul> <p>\u6570\u636e\u5e93\u7684\u8303\u5f0f\u8bbe\u8ba1\u8d8a\u9ad8\u9636\uff0c\u5197\u4f59\u5ea6\u5c31\u8d8a\u4f4e\uff0c\u540c\u65f6\u9ad8\u9636\u7684\u8303\u5f0f\u4e00\u5b9a\u7b26\u5408\u4f4e\u9636\u8303\u5f0f\u7684\u8981\u6c42\uff0c\u6bd4\u5982\u6ee1\u8db3 2NF \u7684\u4e00\u5b9a\u6ee1\u8db3 1NF\uff0c\u6ee1\u8db3 3NF \u7684\u4e00\u5b9a\u6ee1\u8db3 2NF\uff0c\u4f9d\u6b21\u7c7b\u63a8\u3002</p> <p>\u4e00\u822c\u6765\u8bf4\u6570\u636e\u8868\u7684\u8bbe\u8ba1\u5e94\u5c3d\u91cf\u6ee1\u8db3 3NF\u3002\u4f46\u4e5f\u4e0d\u7edd\u5bf9\uff0c\u6709\u65f6\u5019\u4e3a\u4e86\u63d0\u9ad8\u67d0\u4e9b\u67e5\u8be2\u6027\u80fd\uff0c\u6211\u4eec\u8fd8\u9700\u8981\u7834\u574f\u8303\u5f0f\u89c4\u5219\uff0c\u4e5f\u5c31\u662f\u53cd\u89c4\u8303\u5316\u3002</p> <p>1NF \u6307\u7684\u662f\u6570\u636e\u5e93\u8868\u4e2d\u7684\u4efb\u4f55\u5c5e\u6027\u90fd\u662f\u539f\u5b50\u6027\u7684\uff0c\u4e0d\u53ef\u518d\u5206\u3002</p> <p>\u8fd9\u5f88\u597d\u7406\u89e3\uff0c\u6211\u4eec\u5728\u8bbe\u8ba1\u67d0\u4e2a\u5b57\u6bb5\u7684\u65f6\u5019\uff0c\u5bf9\u4e8e\u5b57\u6bb5 X \u6765\u8bf4\uff0c\u5c31\u4e0d\u80fd\u628a\u5b57\u6bb5 X \u62c6\u5206\u6210\u5b57\u6bb5 X-1 \u548c\u5b57\u6bb5 X-2\u3002\u4e8b\u5b9e\u4e0a\uff0c\u4efb\u4f55\u7684 DBMS \u90fd\u4f1a\u6ee1\u8db3\u7b2c\u4e00\u8303\u5f0f\u7684\u8981\u6c42\uff0c\u4e0d\u4f1a\u5c06\u5b57\u6bb5\u8fdb\u884c\u62c6\u5206\u3002</p> <p>\u53cd\u8303\u5f0f\u662f\u4e00\u79cd\u8bd5\u56fe\u89e3\u51b3\u95ee\u9898\u7684\u65b9\u6cd5\uff0c\u4f46\u901a\u5e38\u4f1a\u540c\u65f6\u5f15\u53d1\u522b\u7684\u95ee\u9898\u3002\u4e00\u822c\u6765\u8bf4\uff0c\u6570\u636e\u4ed3\u5e93\uff08Data Warehouse\uff09\u548c\u5728\u7ebf\u5206\u6790\u7cfb\u7edf\uff08OLAP\uff09\u4f1a\u8f83\u591a\u4f7f\u7528\u5230\u53cd\u89c4\u8303\u5316\u7684\u6280\u672f\uff0c\u56e0\u4e3a\u5b83\u4eec\u4ee5\u590d\u6742\u67e5\u8be2\u548c\u62a5\u8868\u5206\u6790\u4e3a\u4e3b\u3002</p> <p>\u903b\u8f91\u6570\u636e\u5e93\u8bbe\u8ba1\u53cd\u6a21\u5f0f</p> <p>\u5728\u4f60\u5f00\u59cb\u7f16\u7801\u4e4b\u524d\uff0c\u9700\u8981\u51b3\u5b9a\u6570\u636e\u5e93\u91cc\u5b58\u50a8\u4ec0\u4e48\u4fe1\u606f\u4ee5\u53ca\u6700\u4f73\u7684\u6570\u636e\u7ec4\u7ec7\u65b9\u5f0f\u548c\u5185\u5728\u5173\u8054\u65b9\u5f0f\u3002\u8fd9\u5305\u542b\u4e86\u5982\u4f55\u8bbe\u8ba1\u6570\u636e\u5e93\u7684\u8868\u3001\u5b57\u6bb5\u548c\u5173\u7cfb\u3002</p> <p>\u7269\u7406\u6570\u636e\u5e93\u8bbe\u8ba1\u53cd\u6a21\u5f0f</p> <p>\u5728\u77e5\u9053\u4e86\u9700\u8981\u5b58\u50a8\u54ea\u4e9b\u6570\u636e\u4e4b\u540e\uff0c\u4f7f\u7528\u4f60\u6240\u77e5\u7684 RDBMS \u6280\u672f\u7279\u6027\u5c3d\u53ef\u80fd\u9ad8\u6548\u5730\u5b9e\u73b0\u6570\u636e\u7ba1\u7406\u3002\u8fd9\u5305\u542b\u4e86\u5b9a\u4e49\u8868\u548c\u7d22\u5f15\uff0c\u4ee5\u53ca\u9009\u62e9\u6570\u636e\u7c7b\u578b\u3002\u4f60\u4e5f\u8981\u4f7f\u7528 SQL \u7684 DDL \u8bed\u53e5\uff0c\u6bd4\u5982<code>CREATE TABLE</code>\u8bed\u53e5\u3002</p> <p>\u67e5\u8be2\u53cd\u6a21\u5f0f</p> <p>\u4f60\u9700\u8981\u5411\u6570\u636e\u5e93\u4e2d\u6dfb\u52a0\u7136\u540e\u83b7\u53d6\u6570\u636e\u3002SQL \u7684\u67e5\u8be2\u662f\u4f7f\u7528\"\u6570\u636e\u64cd\u4f5c\u8bed\u8a00\"\u6765\u5b8c\u6210\uff0c\u6bd4\u5982 SELECT \u3001 UPDATE \u548c DELETE \u8bed\u53e5\u3002</p> <p>\u5e94\u7528\u7a0b\u5e8f\u5f00\u53d1\u53cd\u6a21\u5f0f</p> <p>SQL \u5e94\u8be5\u4f1a\u7528\u5728\u4f7f\u7528 C++\u3001Java\u3001Php\u3001Python \u6216\u8005 Ruby \u7b49\u8bed\u8a00\u6784\u5efa\u7684\u5e94\u7528\u7a0b\u5e8f\u4e2d\u3002\u5728\u5e94\u7528\u7a0b\u5e8f\u4e2d\u4f7f\u7528 SQL \u7684\u65b9\u5f0f\u6709\u597d\u6709\u574f\uff0c\u8be5\u90e8\u5206\u5185\u5bb9\u63cf\u8ff0\u4e86\u4e00\u4e9b\u5e38\u89c1\u9519\u8bef\u3002</p>"},{"location":"dev/02.%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AE%BE%E8%AE%A1/#_7","title":"\u591a\u503c\u5c5e\u6027","text":"<p>\u5c06\u6570\u636e\u5e93\u4e2d\u539f\u6765\u5b58\u50a8\u5355\u4e00\u7528\u6237\u6807\u8bc6\u7684\u5b57\u6bb5\u6539\u6210\u4f7f\u7528\u9017\u53f7\u5206\u9694\u7684\u7528\u6237\u6807\u8bc6\u5217\u8868\uff0c\u4f3c\u4e4e\u662f\u4e00\u4e2a\u5f88\u7b80\u5355\u4e14\u5408\u7406\u7684\u89e3\u51b3\u65b9\u6848\u3002</p> <p>\u7a0b\u5e8f\u5458\u901a\u5e38\u4f7f\u7528\u9017\u53f7\u5206\u9694\u7684\u5217\u8868\u6765\u907f\u514d\u5728\u591a\u5bf9\u591a\u7684\u5173\u7cfb\u4e2d\u521b\u5efa\u4ea4\u53c9\u8868\uff0c\u6211\u5c06\u8fd9\u79cd\u8bbe\u8ba1\u65b9\u5f0f\u5b9a\u4e49\u4e3a\u4e00\u79cd\u53cd\u6a21\u5f0f\uff0c\u79f0\u4e3a\u4e71\u7a7f\u9a6c\u8def\uff08Jaywalking\uff09\uff0c\u56e0\u4e3a\u4e71\u7a7f\u9a6c\u8def\u4e5f\u662f\u907f\u514d\u8fc7\u5341\u5b57\u8def\u53e3\u7684\u4e00\u79cd\u65b9\u5f0f\u3002</p> <p>\u8bbe\u8ba1\u4e00\u4e2a\u5355\u503c\u8868\u5217\u662f\u975e\u5e38\u7b80\u5355\u7684\uff1a\u4f60\u53ef\u4ee5\u9009\u62e9\u4e00\u4e2a SQL \u7684\u5185\u7f6e\u6570\u636e\u7c7b\u578b\uff0c\u4ee5\u8be5\u7c7b\u578b\u6765\u5b58\u50a8\u8fd9\u4e2a\u8868\u9879\u7684\u6570\u636e\uff0c\u6bd4\u5982\u6574\u578b\u3001\u65e5\u671f\u7c7b\u578b\u6216\u8005\u5b57\u7b26\u4e32\u3002\u4f46\u662f\u5982\u4f55\u624d\u80fd\u505a\u5230\u5728\u4e00\u5217\u4e2d\u5b58\u50a8\u4e00\u7cfb\u5217\u76f8\u5173\u6570\u636e\u7684\u96c6\u5408\u5462\uff1f</p> <p>\u5f88\u81ea\u7136\uff0c\u4f7f\u7528 VARCHAR \u7c7b\u578b\u5b57\u6bb5\uff0c\u5e76\u7528\u9017\u53f7\u5206\u9694\u5bf9\u5e94\u7684\u6570\u636e\u3002</p> <p>\u9009\u62e9\u5408\u9002\u7684\u5206\u9694\u7b26</p> <p>\u5982\u679c\u5b58\u50a8\u4e00\u4e2a\u5b57\u7b26\u4e32\u5217\u8868\u800c\u4e0d\u662f\u6570\u5b57\u5217\u8868\uff0c\u5217\u8868\u4e2d\u7684\u67d0\u4e9b\u6761\u76ee\u53ef\u80fd\u4f1a\u5305\u542b\u5206\u9694\u7b26\u3002\u4f7f\u7528\u9017\u53f7\u4f5c\u4e3a\u5206\u9694\u7b26\u53ef\u80fd\u4f1a\u6709\u95ee\u9898\u3002\u5f53\u7136\uff0c\u4f60\u5230\u65f6\u5019\u53ef\u4ee5\u518d\u6362\u4e00\u4e2a\u5b57\u7b26\uff0c\u4f46\u4f60\u80fd\u786e\u4fdd\u8fd9\u4e2a\u65b0\u5b57\u7b26\u6c38\u8fdc\u4e0d\u4f1a\u51fa\u73b0\u5728\u6761\u76ee\u4e2d\u5417\uff1f</p> <p>\u5217\u8868\u957f\u5ea6\u9650\u5236</p> <p>\u4f60\u80fd\u5728\u4e00\u4e2a VARCHAR(30) \u7684\u7ed3\u6784\u4e2d\u5b58\u591a\u5c11\u6570\u636e\u5462\uff1f\u8fd9\u4f9d\u8d56\u4e8e\u6bcf\u4e2a\u6761\u76ee\u7684\u957f\u5ea6\u3002\u5982\u679c\u6bcf\u4e2a\u6761\u76ee\u53ea\u6709 2 \u4e2a\u5b57\u7b26\u957f\uff0c\u90a3\u4f60\u80fd\u5b58 10 \u4e2a\u6761\u76ee\uff08\u5305\u62ec\u9017\u53f7\uff09\u3002\u4f46\u5982\u679c\u6bcf\u4e2a\u6761\u76ee\u7684\u957f\u5ea6\u4e3a 6\uff0c\u4f60\u5c31\u53ea\u80fd\u5b58 4 \u4e2a\u4e86\u3002</p> <p>\u4f60\u600e\u80fd\u786e\u5b9a VARCHAR(30) \u80fd\u591f\u652f\u6301\u4f60\u672a\u6765\u6240\u9700\u7684\u6700\u957f\u5217\u8868\u5462\uff1f\u591a\u957f\u624d\u591f\u957f\uff1f</p> <p>\u5408\u7406\u4f7f\u7528\u53cd\u6a21\u5f0f</p> <p>\u51fa\u4e8e\u6027\u80fd\u4f18\u5316\u7684\u8003\u91cf\uff0c\u53ef\u80fd\u5728\u6570\u636e\u5e93\u7684\u7ed3\u6784\u4e2d\u9700\u8981\u4f7f\u7528\u53cd\u89c4\u8303\u5316\u7684\u8bbe\u8ba1\u3002\u5c06\u5217\u8868\u5b58\u50a8\u4e3a\u4ee5\u9017\u53f7\u5206\u9694\u7684\u5b57\u7b26\u4e32\u5c31\u662f\u53cd\u89c4\u8303\u5316\u7684\u4e00\u4e2a\u5b9e\u4f8b\u3002</p> <p>\u5e94\u7528\u7a0b\u5e8f\u53ef\u80fd\u4f1a\u9700\u8981\u9017\u53f7\u5206\u9694\u7684\u8fd9\u79cd\u5b58\u50a8\u683c\u5f0f\u7684\u6570\u636e\uff0c\u4e5f\u53ef\u80fd\u6ca1\u5fc5\u8981\u83b7\u53d6\u5217\u8868\u4e2d\u7684\u5355\u72ec\u9879\u3002</p> <p>\u540c\u6837\uff0c\u5982\u679c\u5e94\u7528\u7a0b\u5e8f\u63a5\u6536\u7684\u6e90\u6570\u636e\u662f\u6709\u9017\u53f7\u5206\u9694\u7684\u683c\u5f0f\uff0c\u800c\u4f60\u53ea\u9700\u8981\u5b58\u50a8\u548c\u4f7f\u7528\u5b83\u4eec\u5e76\u4e14\u4e0d\u5bf9\u5176\u505a\u4efb\u4f55\u4fee\u6539\uff0c\u5b8c\u5168\u6ca1\u5fc5\u8981\u5206\u5f00\u5176\u4e2d\u7684\u503c\u3002</p>"},{"location":"dev/02.%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AE%BE%E8%AE%A1/#_8","title":"\u6811\u5f62\u7ed3\u6784","text":"<p>\u5728\u7a0b\u5e8f\u5f00\u53d1\u4e2d\uff0c\u6211\u4eec\u5e38\u9047\u5230\u7528\u6811\u578b\u7ed3\u6784\u6765\u8868\u793a\u67d0\u4e9b\u6570\u636e\u95f4\u7684\u5173\u7cfb\uff0c\u5982\u4f01\u4e1a\u7684\u7ec4\u7ec7\u67b6\u6784\u3001\u5546\u54c1\u7684\u5206\u7c7b\u3001\u64cd\u4f5c\u680f\u76ee\u7b49\uff0c\u76ee\u524d\u7684\u5173\u7cfb\u578b\u6570\u636e\u5e93\u90fd\u662f\u4ee5\u4e8c\u7ef4\u8868\u7684\u5f62\u5f0f\u8bb0\u5f55\u5b58\u50a8\u6570\u636e\uff0c\u800c\u6811\u578b\u7ed3\u6784\u7684\u6570\u636e\u5982\u9700\u5b58\u5165\u4e8c\u7ef4\u8868\u5c31\u5fc5\u987b\u8fdb\u884c Schema \u8bbe\u8ba1\u3002</p> <p>\u5b58\u5728\u9012\u5f52\u5173\u7cfb\u7684\u6570\u636e\u5f88\u5e38\u89c1\uff0c\u6570\u636e\u5e38\u4f1a\u50cf\u6811\u6216\u8005\u4ee5\u5c42\u7ea7\u65b9\u5f0f\u7ec4\u7ec7\u3002</p> <p>\u5728\u6811\u5f62\u7ed3\u6784\u4e2d\uff0c\u5b9e\u4f8b\u88ab\u79f0\u4e3a\u8282\u70b9\uff08node\uff09\u3002\u6bcf\u4e2a\u8282\u70b9\u6709\u591a\u4e2a\u5b50\u8282\u70b9\u548c\u4e00\u4e2a\u7236\u8282\u70b9\u3002\u6700\u4e0a\u5c42\u7684\u8282\u70b9\u53eb\u6839\uff08root\uff09\u8282\u70b9\uff0c\u5b83\u6ca1\u6709\u7236\u8282\u70b9\u3002\u6700\u5e95\u5c42\u7684\u6ca1\u6709\u5b50\u8282\u70b9\u7684\u8282\u70b9\u53eb\u53f6\uff08leaf\uff09\u3002\u800c\u4e2d\u95f4\u7684\u8282\u70b9\u7b80\u5355\u5730\u79f0\u4e3a\u975e\u53f6\uff08nonleaf\uff09\u8282\u70b9\u3002</p> <p>\u5728\u5c42\u7ea7\u6570\u636e\u4e2d\uff0c\u4f60\u53ef\u80fd\u9700\u8981\u67e5\u8be2\u4e0e\u6574\u4e2a\u96c6\u5408\u6216\u5176\u5b50\u96c6\u76f8\u5173\u7684\u7279\u5b9a\u5bf9\u8c61\uff0c\u4f8b\u5982\u4e0b\u8ff0\u6811\u5f62\u6570\u636e\u7ed3\u6784\uff1a</p> <ul> <li>\u7ec4\u7ec7\u67b6\u6784\u56fe\u3002\u804c\u5458\u4e0e\u7ecf\u7406\u7684\u5173\u7cfb\u662f\u5178\u578b\u7684\u6811\u5f62\u7ed3\u6784\u6570\u636e\uff0c\u51fa\u73b0\u5728\u65e0\u6570\u7684 SQL \u4e66\u7c4d\u4e0e\u8bba\u9898\u4e2d\u3002</li> </ul> <p>\u5728\u7ec4\u7ec7\u67b6\u6784\u56fe\u4e2d\uff0c\u6bcf\u4e2a\u804c\u5458\u6709\u4e00\u4e2a\u7ecf\u7406\uff0c\u5728\u6811\u7ed3\u6784\u4e2d\u8868\u73b0\u4e3a\u804c\u5458\u7684\u7236\u8282\u70b9\u3002\u540c\u65f6\uff0c\u7ecf\u7406\u4e5f\u662f\u4e00\u4e2a\u804c\u5458\u3002</p> <ul> <li>\u8bdd\u9898\u578b\u8ba8\u8bba\u3002\u6b63\u5982\u5f15\u8a00\u4e2d\u4ecb\u7ecd\u7684\uff0c\u6811\u5f62\u7ed3\u6784\u4e5f\u80fd\u7528\u6765\u8868\u793a\u56de\u590d\u8bc4\u8bba\u7684\u8bc4\u8bba\u94fe\u3002\u5728\u8fd9\u79cd\u6811\u4e2d\uff0c\u8bc4\u8bba\u7684\u5b50\u8282\u70b9\u662f\u5b83\u7684\u56de\u590d\u3002</li> </ul>"},{"location":"dev/02.%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AE%BE%E8%AE%A1/#_9","title":"\u90bb\u63a5\u8868","text":"<p>\u5728\u5f88\u591a\u4e66\u7c4d\u6216\u6587\u7ae0\u4e2d\uff0c\u6700\u5e38\u89c1\u7684\u7b80\u5355\u89e3\u51b3\u65b9\u6848\u662f\u6dfb\u52a0 parent_id \u5b57\u6bb5\u6765\u786e\u5b9a\u6811\u7684\u7236\u5b50\u5173\u7cfb\u3002\u8fd9\u6837\u7684\u8bbe\u8ba1\u53eb\u505a\u90bb\u63a5\u8868\u3002</p> <pre><code>-- \u5047\u8bbe\u7528\u6811\u5f62\u7ed3\u6784\u6765\u63cf\u8ff0\u4e00\u4e2a\u90e8\u95e8\u7684\u7ec4\u7ec7\u67b6\u6784\n\n-- DDL  \u7528id\u6765\u6807\u8bc6\u4e00\u4e2a\u4eba\uff0c\u7528manager_id\u6765\u8868\u793a\u5411\u4e0a\u4e00\u4e2a\u4eba\u6c47\u62a5\nCREATE TABLE db_test.employees_mgr (\n    id INT PRIMARY KEY NOT NULL,\n    name VARCHAR ( 100 ) NOT NULL,\n    manager_id INT NULL,\n    INDEX ( manager_id ),\n    FOREIGN KEY ( manager_id ) REFERENCES employees_mgr ( id )\n);\n\n\n-- test data\ninsert into db_test.employees_mgr values\n(333, \"Yasmina\", null), /* Yasmina is the CEO (manager_id is null) */\n(198, \"John\", 333),     /* John has id 198 and reports to 333 (Yasmina) */\n(692, \"Tarek\", 333),    /* Tarek has id 692 and reports to 333 (Yasmina) */\n(29, \"Pedro \", 198),    /* Pedro has id 29 and reports to 198 (John) */\n(4610, \"Sarah\", 29);    /* Sarah has id 4610 and reports to 29 (Pedro) */\n\n\n\n-- \u67e5\u8be2\u4e00\u4e2a\u8282\u70b9\u7684\u6240\u6709\u540e\u4ee3\u6216\u6240\u6709\u7236\u8282\u70b9\u3002\n-- \u8981\u67e5\u8be2\u51fa\u5982\u4e0b\u8fd9\u79cd\u6811\u5f62\u6548\u679c\uff1a\u67e5\u51fa\u6bcf\u4e2a\u4eba\u7684\u6c47\u62a5\u5bf9\u8c61\n\n+------+---------+--------------------+\n| id   | name    | path               |\n+------+---------+--------------------+\n|  333 | Yasmina | 333                |\n|  198 | John    | 333-&gt;198           |\n|  692 | Tarek   | 333-&gt;692           |\n|   29 | Pedro   | 333-&gt;198-&gt;29       |\n| 4610 | Sarah   | 333-&gt;198-&gt;29-&gt;4610 |\n+------+---------+--------------------+\n5 rows in set (0.00 sec)\nmysql&gt;\n\n\n-- MySQL8.0\u4e2d\u652f\u6301with\u5b50\u53e5\n-- \u901a\u8fc7recursive\u9012\u5f52CTE\u6765\u67e5\u8be2\u7528\u6237\u7684\u5c42\u7ea7\u5173\u7cfb\n-- \u89c4\u5212\u4e00\u4e2aID\uff0cname\uff0cpath\u8fd9\u6837\u7684\u4e00\u4e2a\u5c42\u7ea7\u4e34\u65f6\u8868\n\nwith recursive employee_paths (id, name, path) as (\n     -- \u5148\u67e5\u6700\u9876\u5c42\u8282\u70b9\n     select id, name, cast(id as char(200))\n     from db_test.employees_mgr\n     where manager_id is null\n     union all\n     -- \u9012\u5f52\u67e5\u8be2\n     select e.id, e.name, concat(ep.path, '-&gt;', e.id)\n     from employee_paths as ep\n     join db_test.employees_mgr as e\n     on ep.id = e.manager_id\n    )\n     select * from employee_paths;\n</code></pre> <p>\u8fd9\u79cd\u65b9\u6848\u7684\u4f18\u70b9\u5f88\u660e\u663e\uff1a\u7ed3\u6784\u7b80\u5355\u6613\u61c2\uff0c\u7531\u4e8e\u4e92\u76f8\u4e4b\u95f4\u7684\u5173\u7cfb\u53ea\u7531\u4e00\u4e2a parent_id \u7ef4\u62a4\uff0c\u6240\u4ee5\u589e\u5220\u6539\u90fd\u662f\u975e\u5e38\u5bb9\u6613\uff0c\u53ea\u9700\u8981\u6539\u52a8\u548c\u4ed6\u76f4\u63a5\u76f8\u5173\u7684\u8bb0\u5f55\u5c31\u53ef\u4ee5\u3002</p> <p>\u7f3a\u70b9\u5f53\u7136\u4e5f\u662f\u975e\u5e38\u7684\u7a81\u51fa\uff1a\u7531\u4e8e\u76f4\u63a5\u5730\u8bb0\u5f55\u4e86\u8282\u70b9\u4e4b\u95f4\u7684\u7ee7\u627f\u5173\u7cfb\uff0c\u56e0\u6b64\u5bf9 Tree \u7684\u4efb\u4f55 CRUD \u64cd\u4f5c\u90fd\u5c06\u662f\u4f4e\u6548\u7684\uff0c\u8fd9\u4e3b\u8981\u5f52\u6839\u4e8e\u9891\u7e41\u7684\u201c\u9012\u5f52\u201d\u64cd\u4f5c\uff0c\u9012\u5f52\u8fc7\u7a0b\u4e0d\u65ad\u5730\u8bbf\u95ee\u6570\u636e\u5e93\uff0c\u6bcf\u6b21\u6570\u636e\u5e93 IO \u90fd\u4f1a\u6709\u65f6\u95f4\u5f00\u9500\u3002\u4e3e\u4e2a\u4f8b\u5b50\uff0c\u5982\u679c\u60f3\u8981\u8fd4\u56de\u6240\u6709\u8282\u70b9\uff0c\u4e5f\u5c31\u662f\u67d0\u4e2a\u4eba\u7684\u6240\u6709\u5b50\u5b59\u8282\u70b9\uff0c\u770b\u4f3c\u5f88\u7b80\u5355\u7684\u64cd\u4f5c\uff0c\u5c31\u9700\u8981\u7528\u5230\u4e00\u5806\u9012\u5f52\u3002</p> <p>\u5408\u7406\u5730\u4f7f\u7528\u53cd\u8303\u5f0f\uff0c\u5f53\u7136\uff0c\u8fd9\u79cd\u65b9\u6848\u5e76\u975e\u6ca1\u6709\u7528\u6b66\u4e4b\u5730\uff0c\u5728\u6811\u7684\u5c42\u7ea7\u6bd4\u8f83\u5c11\u7684\u65f6\u5019\u5c31\u975e\u5e38\u5b9e\u7528\u3002\u8fd9\u79cd\u65b9\u6cd5\u7684\u4f18\u70b9\u662f\u5b58\u50a8\u7684\u4fe1\u606f\u5c11\uff0c\u67e5\u76f4\u63a5\u4e0a\u53f8\u548c\u76f4\u63a5\u4e0b\u5c5e\u7684\u65f6\u5019\u5f88\u65b9\u4fbf\uff0c\u7f3a\u70b9\u662f\u591a\u7ea7\u67e5\u8be2\u7684\u65f6\u5019\u5f88\u8d39\u52b2\u3002\u6240\u4ee5\u5f53\u53ea\u9700\u8981\u7528\u5230\u76f4\u63a5\u4e0a\u4e0b\u7ea7\u5173\u7cfb\u7684\u65f6\u5019\uff0c\u7528\u8fd9\u79cd\u65b9\u6cd5\u8fd8\u662f\u4e0d\u9519\u7684\uff0c\u53ef\u4ee5\u8282\u7701\u5f88\u591a\u7a7a\u95f4\u3002</p>"},{"location":"dev/02.%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AE%BE%E8%AE%A1/#_10","title":"\u7269\u5316\u8def\u5f84\u8868","text":"<p>\u90bb\u63a5\u8868\u7684\u7f3a\u70b9\u4e4b\u4e00\u662f\u4ece\u6811\u4e2d\u83b7\u53d6\u4e00\u4e2a\u7ed9\u5b9a\u8282\u70b9\u7684\u6240\u6709\u7956\u5148\u7684\u5f00\u9500\u5f88\u5927\u3002\u8def\u5f84\u679a\u4e3e\u7684\u8bbe\u8ba1\u901a\u8fc7\u5c06\u6240\u6709\u7956\u5148\u7684\u4fe1\u606f\u8054\u5408\u6210\u4e00\u4e2a\u5b57\u7b26\u4e32\uff0c\u5e76\u4fdd\u5b58\u4e3a\u6bcf\u4e2a\u8282\u70b9\u7684\u4e00\u4e2a\u5c5e\u6027\uff0c\u5f88\u5de7\u5999\u5730\u89e3\u51b3\u4e86\u8fd9\u4e2a\u95ee\u9898\u3002</p> <p>\u8def\u5f84\u679a\u4e3e\u662f\u4e00\u4e2a\u7531\u8fde\u7eed\u7684\u76f4\u63a5\u5c42\u7ea7\u5173\u7cfb\u7ec4\u6210\u7684\u5b8c\u6574\u8def\u5f84\u3002\u5982 /usr/local/lib \u7684 UNIX \u8def\u5f84\u662f\u6587\u4ef6\u7cfb\u7edf\u7684\u4e00\u4e2a\u8def\u5f84\u679a\u4e3e\uff0c\u5176\u4e2d usr \u662f local \u7684\u7236\u4eb2\uff0c\u8fd9\u4e5f\u5c31\u610f\u5473\u7740 usr \u662f lib \u7684\u7956\u5148\u3002</p> <p>\u5728 Comments \u8868\u4e2d\uff0c\u6211\u4eec\u4f7f\u7528\u7c7b\u578b\u4e3a VARCHAR \u7684 path \u5b57\u6bb5\u6765\u4ee3\u66ff\u539f\u6765\u7684 parent_id \u5b57\u6bb5\u3002 \u8fd9\u4e2a path \u5b57\u6bb5\u6240\u5b58\u50a8\u7684\u5185\u5bb9\u4e3a\u5f53\u524d\u8282\u70b9\u7684\u6700\u9876\u5c42\u7684\u7956\u5148\u5230\u5b83\u81ea\u5df1\u7684\u5e8f\u5217\uff0c\u5c31\u50cf UNIX \u7684\u8def\u5f84\u4e00\u6837\uff0c\u4f60\u751a\u81f3\u53ef\u4ee5\u4f7f\u7528'/'\u4f5c\u4e3a\u8def\u5f84\u4e2d\u7684\u5206\u5272\u7b26\u3002</p> <p>\u7269\u5316\u8def\u5f84\u5176\u5b9e\u66f4\u52a0\u5bb9\u6613\u7406\u89e3\uff0c\u5176\u5b9e\u5c31\u662f\u5728\u521b\u5efa\u8282\u70b9\u65f6\uff0c\u5c06\u8282\u70b9\u7684\u5b8c\u6574\u8def\u5f84\u8fdb\u884c\u8bb0\u5f55\u3002</p> <pre><code>-- \u67e5\u8be2\u67d0\u4e00\u8282\u70b9\u4e0b\u7684\u6240\u6709\u5b50\u8282\u70b9:\uff08\u4ee5Fruit\u4e3a\u4f8b\uff09\nSET @path = (SELECT path FROM pathTree WHERE node_name = 'Fruit');\nSELECT * FROM pathTree WHERE path like CONCAT(@path,'/%');\n\n-- \u5982\u4f55\u67e5\u8be2\u76f4\u5c5e\u5b50\u8282\u70b9\uff1f\u9700\u8981\u91c7\u7528MySQL\u7684\u6b63\u5219\u8868\u8fbe\u5f0f\u67e5\u8be2\uff1a\nSET @path = (SELECT path FROM pathTree WHERE node_name = 'Fruit');\nSELECT * FROM pathTree WHERE path REGEXP CONCAT(@path,'/','[0-9]$');\n\n-- \u67e5\u8be2\u4efb\u610f\u8282\u70b9\u7684\u6240\u6709\u4e0a\u7ea7\uff1a\uff08\u4ee5Yellow\u4e3a\u4f8b\uff09\uff1a\nSET @path = (SELECT path FROM pathTree WHERE node_name = 'Yellow');\nSELECT * FROM pathTree WHERE @path LIKE CONCAT(path, '%') AND path &lt;&gt; @path;\n\n-- \u63d2\u5165\u65b0\u589e\u6570\u636e\uff1a\nSET @parent_path = ( SELECT path FROM pathTree WHERE node_name = 'Fruit');\nINSERT INTO pathtree (path,node_name) VALUES (CONCAT(@parent_path,'/',LAST_INSERT_ID()+1),'White')\n</code></pre> <p>\u6b64\u65b9\u6848\u7684\u7f3a\u70b9\u662f\u6811\u7684\u5c42\u7ea7\u592a\u6df1\u6709\u53ef\u80fd\u4f1a\u8d85\u8fc7 PATH \u5b57\u6bb5\u7684\u957f\u5ea6\uff0c\u6240\u4ee5\u5176\u80fd\u652f\u6301\u7684\u6700\u5927\u6df1\u5ea6\u5e76\u975e\u65e0\u9650\u7684\u3002</p> <p>\u5982\u679c\u5c42\u7ea7\u6570\u91cf\u662f\u786e\u5b9a\u7684\uff0c\u53ef\u4ee5\u518d\u5c06\u6240\u6709\u7684\u5217\u90fd\u5c55\u5f00\uff0c\u6bd4\u8f83\u9002\u7528\u4e8e\u4e8e\u7c7b\u4f3c\u884c\u653f\u533a\u5212\u3001\u751f\u7269\u5206\u7c7b\u6cd5\uff08\u754c\u3001\u95e8\u3001\u7eb2\u3001\u76ee\u3001\u79d1\u3001\u5c5e\u3001\u79cd\uff09\u8fd9\u4e9b\u5c42\u7ea7\u786e\u5b9a\u7684\u5185\u5bb9\u3002</p>"},{"location":"dev/02.%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AE%BE%E8%AE%A1/#_11","title":"\u95ed\u5305\u8868","text":"<p>\u6bd4\u5982\uff0c\u5730\u7406\u533a\u57df\u3001\u4f4d\u7f6e\u4fe1\u606f\u5b58\u50a8\uff0c\u5730\u7406\u4fe1\u606f\u6309\u7167\u5c42\u7ea7\u5212\u5206\uff0c\u4f1a\u5206\u4e3a\u5f88\u591a\u5c42\u7ea7\uff0c\u5c31\u62ff\u4e2d\u56fd\u7684\u884c\u653f\u533a\u57df\u5212\u5206\u4e3a\u4f8b\uff0c\u7b80\u5355\u7684\u7701-\u5e02-\u53bf-\u9547-\u6751\u5c31\u8981\u4e94\u4e2a\u7ea7\u522b\u3002</p> <p>\u5982\u679c\u7cfb\u7edf\u6d89\u53ca\u5230\u8de8\u5883\u7684\u56fd\u9645\u8d38\u6613\uff0c\u90a3\u4e48\u5b58\u50a8\u7684\u5730\u7406\u4fe1\u606f\u5c42\u7ea7\u4f1a\u66f4\u52a0\u6df1\u3002</p> <p>\u95ed\u5305\u8868\u7531<code>Closure Table</code>\u7ffb\u8bd1\u800c\u6765\uff0c\u901a\u8fc7\u7236\u8282\u70b9\u3001\u5b50\u8282\u70b9\u3001\u4e24\u8282\u70b9\u8ddd\u79bb\u6765\u63cf\u8ff0\u4e00\u68f5\u6811\u7a7a\u95f4\u6362\u65f6\u95f4\u7684\u601d\u60f3\u3002</p> <p><code>Closure Table</code>\uff0c\u4e00\u79cd\u66f4\u4e3a\u5f7b\u5e95\u7684\u5168\u8def\u5f84\u7ed3\u6784\uff0c\u5206\u522b\u8bb0\u5f55\u8def\u5f84\u4e0a\u76f8\u5173\u7ed3\u70b9\u7684\u5168\u5c55\u5f00\u5f62\u5f0f\u3002\u80fd\u660e\u6670\u4efb\u610f\u4e24\u7ed3\u70b9\u5173\u7cfb\u800c\u65e0\u987b\u591a\u4f59\u67e5\u8be2\uff0c\u7ea7\u8054\u5220\u9664\u548c\u7ed3\u70b9\u79fb\u52a8\u4e5f\u5f88\u65b9\u4fbf\u3002\u4f46\u662f\u5b83\u7684\u5b58\u50a8\u5f00\u9500\u4f1a\u5927\u4e00\u4e9b\uff0c\u9664\u4e86\u8868\u793a\u7ed3\u70b9\u7684 Meta \u4fe1\u606f\uff0c\u8fd8\u9700\u8981\u4e00\u5f20\u4e13\u7528\u7684\u5173\u7cfb\u8868\u3002</p> <p>\u95ed\u5305\u8868\uff0c\u5b83\u8bb0\u5f55\u4e86\u6811\u4e2d\u6240\u6709\u8282\u70b9\u7684\u5173\u7cfb\uff0c\u4e0d\u4ec5\u4ec5\u53ea\u662f\u76f4\u63a5\u7236\u5b50\u5173\u7cfb\uff0c\u5b83\u9700\u8981\u4f7f\u7528\u4e24\u5f20\u8868\uff0c\u9664\u4e86\u8282\u70b9\u8868\u672c\u8eab\u4e4b\u5916\uff0c\u8fd8\u9700\u8981\u4f7f\u7528\u4e00\u5f20\u5173\u7cfb\u8868\uff0c\u7528\u6765\u5b58\u50a8\u7956\u5148\u8282\u70b9\u548c\u540e\u4ee3\u8282\u70b9\u4e4b\u95f4\u7684\u5173\u7cfb\uff08\u540c\u65f6\u589e\u52a0\u4e00\u884c\u8282\u70b9\u6307\u5411\u81ea\u8eab\uff09,\u5e76\u4e14\u6839\u636e\u9700\u8981\uff0c\u53ef\u4ee5\u589e\u52a0\u4e00\u4e2a\u5b57\u6bb5\uff0c\u8868\u793a\u6df1\u5ea6\u3002</p> <pre><code>CREATE TABLE `village` (\n    `code` VARCHAR(255) PRIMARY KEY,\n    `name` VARCHAR(255),\n    `streetCode` VARCHAR(255) REFERENCES `street` (`code`) ON DELETE SET NULL ON UPDATE CASCADE,\n    `provinceCode` VARCHAR(255) REFERENCES `province` (`code`) ON DELETE SET NULL ON UPDATE CASCADE,\n    `cityCode` VARCHAR(255) REFERENCES `city` (`code`) ON DELETE SET NULL ON UPDATE CASCADE,\n    `areaCode` VARCHAR(255) REFERENCES `area` (`code`) ON DELETE SET NULL ON UPDATE CASCADE\n\n);\n\n-- \u90e8\u95e8\u4fe1\u606f\u8868\nCREATE TABLE `departments` (\n  `id` int NOT NULL COMMENT 'ID',\n  `name` varchar(50) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci DEFAULT NULL COMMENT '\u90e8\u95e8\u540d\u79f0',\n  `parent_id` int DEFAULT NULL COMMENT '\u7236ID',\n  PRIMARY KEY (`id`)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci COMMENT='\u90e8\u95e8\u8868';\n\n-- \u90e8\u95e8\u4fe1\u606f\u95ed\u5305\u8868\nCREATE TABLE `departments_closure_table` (\n  `ancestor` int NOT NULL COMMENT '\u7956\u5148\u8282\u70b9',\n  `descendant` int NOT NULL COMMENT '\u540e\u4ee3\u8282\u70b9',\n  PRIMARY KEY (`ancestor`,`descendant`),\n  KEY `fk_descendant` (`descendant`),\n  CONSTRAINT `fk_ancestor` FOREIGN KEY (`ancestor`) REFERENCES `departments` (`id`) ON DELETE RESTRICT ON UPDATE RESTRICT,\n  CONSTRAINT `fk_descendant` FOREIGN KEY (`descendant`) REFERENCES `departments` (`id`) ON DELETE RESTRICT ON UPDATE RESTRICT\n) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci COMMENT='\u90e8\u95e8\u4fe1\u606f\u95ed\u5305\u8868';\n\n\n-- \u586b\u5145\u90e8\u95e8\u8868\nINSERT INTO `hytto_cs`.`departments`(`id`, `name`, `parent_id`) VALUES (1, '\u96c6\u56e2\u603b\u90e8', NULL);\nINSERT INTO `hytto_cs`.`departments`(`id`, `name`, `parent_id`) VALUES (2, '\u534e\u5317\u603b\u90e8', 1);\nINSERT INTO `hytto_cs`.`departments`(`id`, `name`, `parent_id`) VALUES (3, '\u534e\u5357\u603b\u90e8', 1);\nINSERT INTO `hytto_cs`.`departments`(`id`, `name`, `parent_id`) VALUES (4, '\u534e\u4e1c\u603b\u90e8', 1);\nINSERT INTO `hytto_cs`.`departments`(`id`, `name`, `parent_id`) VALUES (5, '\u534e\u4e2d\u603b\u90e8', 1);\nINSERT INTO `hytto_cs`.`departments`(`id`, `name`, `parent_id`) VALUES (6, '\u534e\u897f\u603b\u90e8', 1);\nINSERT INTO `hytto_cs`.`departments`(`id`, `name`, `parent_id`) VALUES (7, '\u5317\u4eac\u5b50\u516c\u53f8', 2);\nINSERT INTO `hytto_cs`.`departments`(`id`, `name`, `parent_id`) VALUES (8, '\u5929\u6d25\u5b50\u516c\u53f8', 2);\nINSERT INTO `hytto_cs`.`departments`(`id`, `name`, `parent_id`) VALUES (9, '\u6cb3\u5317\u5b50\u516c\u53f8', 2);\nINSERT INTO `hytto_cs`.`departments`(`id`, `name`, `parent_id`) VALUES (10, '\u5e7f\u4e1c\u5b50\u516c\u53f8', 3);\nINSERT INTO `hytto_cs`.`departments`(`id`, `name`, `parent_id`) VALUES (11, '\u5e7f\u897f\u5b50\u516c\u53f8', 3);\nINSERT INTO `hytto_cs`.`departments`(`id`, `name`, `parent_id`) VALUES (12, '\u6d77\u5357\u5b50\u516c\u53f8', 3);\nINSERT INTO `hytto_cs`.`departments`(`id`, `name`, `parent_id`) VALUES (13, '\u56db\u5ddd\u5b50\u516c\u53f8', 6);\nINSERT INTO `hytto_cs`.`departments`(`id`, `name`, `parent_id`) VALUES (14, '\u91cd\u5e86\u5b50\u516c\u53f8', 6);\nINSERT INTO `hytto_cs`.`departments`(`id`, `name`, `parent_id`) VALUES (15, '\u8d35\u5dde\u5b50\u516c\u53f8', 6);\nINSERT INTO `hytto_cs`.`departments`(`id`, `name`, `parent_id`) VALUES (16, '\u4e91\u5357\u5b50\u516c\u53f8', 6);\nINSERT INTO `hytto_cs`.`departments`(`id`, `name`, `parent_id`) VALUES (17, '\u6210\u90fd\u529e\u4e8b\u5904', 13);\nINSERT INTO `hytto_cs`.`departments`(`id`, `name`, `parent_id`) VALUES (18, '\u5e7f\u5143\u529e\u4e8b\u5904', 13);\nINSERT INTO `hytto_cs`.`departments`(`id`, `name`, `parent_id`) VALUES (19, '\u96c5\u5b89\u529e\u4e8b\u5904', 13);\nINSERT INTO `hytto_cs`.`departments`(`id`, `name`, `parent_id`) VALUES (20, '\u7ef5\u9633\u529e\u4e8b\u5904', 13);\n\n\n-- \u586b\u5145\u95ed\u5305\u4fe1\u606f\u8868\nINSERT INTO departments_closure_table (ancestor, descendant, depth)\nWITH RECURSIVE cte AS (\n  SELECT id as ancestor, id as descendant, 0 as depth\n  FROM departments\n  UNION ALL\n  SELECT cte.ancestor, departments.id, cte.depth + 1\n  FROM cte\n  JOIN departments ON cte.descendant = departments.parent_id\n)\nSELECT ancestor, descendant, depth\nFROM cte\nWHERE ancestor != descendant;\n\n\n\n\n-- \u6309\u7167\u90e8\u95e8ID\u5347\u5e8f\u8fdb\u884c\u5206\u9875\u67e5\u8be2\uff0c\u6bcf\u9875\u663e\u793a5\u4e2a\u90e8\u95e8\nSELECT d.*\nFROM departments AS d\nJOIN departments_closure_table AS ct ON d.id = ct.descendant\nWHERE ct.ancestor = 1 -- \u6839\u90e8\u95e8\u7684ID\nORDER BY d.id\nLIMIT 0, 5;\n</code></pre>"},{"location":"dev/02.%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AE%BE%E8%AE%A1/#_12","title":"\u4e3b\u952e","text":"<p>\u6bcf\u4e2a\u4e86\u89e3\u6570\u636e\u5e93\u8bbe\u8ba1\u7684\u4eba\u90fd\u77e5\u9053\uff0c\u4e3b\u952e\u5bf9\u4e8e\u4e00\u5f20\u8868\u6765\u8bf4\u662f\u4e00\u4e2a\u5f88\u91cd\u8981\uff0c\u751a\u81f3\u5fc5\u9700\u7684\u90e8\u5206\u3002\u8fd9\u786e\u5b9e\u662f\u4e8b\u5b9e\uff0c\u4e3b\u952e\u662f\u597d\u7684\u6570\u636e\u5e93\u8bbe\u8ba1\u7684\u4e00\u90e8\u5206\u3002\u4e3b\u952e\u662f\u6570\u636e\u5e93\u786e\u4fdd\u6570\u636e\u884c\u5728\u6574\u5f20\u8868\u4e2d\u552f\u4e00\u6027\u7684\u4fdd\u969c\uff0c\u5b83\u662f\u5b9a\u4f4d\u5230\u4e00\u6761\u8bb0\u5f55\u5e76\u4e14\u786e\u4fdd\u4e0d\u4f1a\u91cd\u590d\u5b58\u50a8\u7684\u903b\u8f91\u673a\u5236\u3002\u4e3b\u952e\u4e5f\u540c\u65f6\u53ef\u4ee5\u88ab\u5916\u952e\u5f15\u7528\u6765\u5efa\u7acb\u8868\u4e0e\u8868\u4e4b\u95f4\u7684\u5173\u7cfb\u3002</p> <p>\u96be\u70b9\u662f\u9009\u62e9\u54ea\u4e00\u5217\u4f5c\u4e3a\u4e3b\u952e\u3002\u5927\u591a\u6570\u8868\u4e2d\u7684\u6bcf\u4e2a\u5c5e\u6027\u7684\u503c\u90fd\u6709\u53ef\u80fd\u88ab\u5f88\u591a\u884c\u4f7f\u7528\u3002\u4f8b\u5982\u4e00\u4e2a\u4eba\u7684\u59d3\u548c\u540d\u5c31\u4e00\u5b9a\u4f1a\u5728\u8868\u4e2d\u91cd\u590d\u51fa\u73b0\uff0c\u5373\u4f7f\u7535\u5b50\u90ae\u4ef6\u5730\u5740\u6216\u8005\u7f8e\u56fd\u793e\u4fdd\u7f16\u53f7\u6216\u8005\u7a0e\u5355\u7f16\u53f7\u4e5f\u4e0d\u80fd\u4fdd\u8bc1\u7edd\u5bf9\u4e0d\u4f1a\u91cd\u590d\u3002</p> <p>\u5728\u8fd9\u6837\u7684\u8868\u4e2d\uff0c\u9700\u8981\u5f15\u5165\u4e00\u4e2a\u5bf9\u4e8e\u8868\u7684\u57df\u6a21\u578b\u65e0\u610f\u4e49\u7684\u65b0\u5217\u6765\u5b58\u50a8\u4e00\u4e2a\u4f2a\u503c\u3002\u8fd9\u4e00\u5217\u88ab\u7528\u4f5c\u8fd9\u5f20\u8868\u7684\u4e3b\u952e\uff0c\u4ece\u800c\u901a\u8fc7\u5b83\u6765\u786e\u5b9a\u8868\u4e2d\u7684\u4e00\u6761\u8bb0\u5f55\uff0c\u5373\u4fbf\u5176\u4ed6\u7684\u5217\u5141\u8bb8\u51fa\u73b0\u9002\u5f53\u7684\u91cd\u590d\u9879\u3002\u8fd9\u79cd\u7c7b\u578b\u7684\u4e3b\u952e\u5217\u6211\u4eec\u901a\u5e38\u79f0\u5176\u4e3a<code>\u4f2a\u4e3b\u952e</code>\u6216\u8005<code>\u4ee3\u7406\u952e</code>\u3002</p> <p>\u5927\u591a\u6570\u7684\u6570\u636e\u5e93\u63d0\u4f9b\u4e00\u79cd\u548c\u5f53\u524d\u5904\u7406\u4e8b\u52a1\u65e0\u5173\u7684\u5e95\u5c42\u65b9\u6848\uff0c\u6765\u786e\u4fdd\u6bcf\u6b21\u90fd\u80fd\u751f\u6210\u5168\u5c40\u552f\u4e00\u7684\u4e00\u4e2a\u6574\u6570\u4f5c\u4e3a\u4f2a\u4e3b\u952e\uff0c\u5373\u4f7f\u5ba2\u6237\u7aef\u6b64\u65f6\u6b63\u53d1\u8d77\u5e76\u53d1\u64cd\u4f5c\u3002</p> <p>\u4e00\u5f20\u6ca1\u6709\u4e3b\u952e\u7684\u8868\u5c31\u597d\u50cf\u4f60\u7684 MP3 \u64ad\u653e\u5217\u8868\u91cc\u6ca1\u6709\u6b4c\u540d\u4e00\u6837\u3002\u4f60\u4f9d\u7136\u53ef\u4ee5\u542c\u6b4c\uff0c\u4f46\u65e0\u6cd5\u627e\u5230\u60f3\u542c\u7684\u90a3\u9996\u6b4c\uff0c\u4e5f\u6ca1\u529e\u6cd5\u786e\u4fdd\u64ad\u653e\u5217\u8868\u4e2d\u6ca1\u6709\u91cd\u590d\u7684\u6b4c\u66f2\u3002</p> <p>\u4f2a\u4e3b\u952e\u76f4\u5230 SQL:2003 \u624d\u6210\u4e3a\u4e00\u4e2a\u6807\u51c6\uff0c\u56e0\u800c\u6bcf\u4e2a\u6570\u636e\u5e93\u90fd\u4f7f\u7528\u81ea\u5df1\u7279\u6709\u7684 SQL \u6269\u5c55\u6765\u5b9e\u73b0\u4f2a\u4e3b\u952e\uff0c\u751a\u81f3\u4e0d\u540c\u6570\u636e\u5e93\u4e2d\u5bf9\u4e8e\u4f2a\u4e3b\u952e\u90fd\u6709\u4e0d\u540c\u7684\u540d\u79f0\uff08\u4e0d\u540c\u7684\u8868\u8ff0\uff09</p> \u540d\u79f0 \u6570\u636e\u5e93 AUTO_INCREMENT MySQL GENERATOR Firebird, InterBase IDENTITY DB2 Derby, Microsoft SQL Server, Sybase ROWID SQLite SEQUENCE DB2 Firebird, Informix, Ingres, Oracle, PostgreSQL SERIAL MySQL, PostgreSQL <p>\u867d\u7136\u5404\u5bb6\u6570\u636e\u5e93\u4ea7\u54c1\u7684\u4f2a\u4e3b\u952e\u53eb\u6cd5\u4e0d\u540c\uff0c\u4f46\u662f\u7ed9\u4f2a\u4e3b\u952e\u6307\u6d3e\u7684\u5217\u540d\uff0c\u786e\u662f\u51fa\u5947\u7684\u4e00\u81f4\uff0c\u90a3\u5c31\u662f id\u3002</p>"},{"location":"dev/02.%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AE%BE%E8%AE%A1/#_13","title":"\u5916\u952e","text":"<p>\u5173\u7cfb\u6570\u636e\u5e93\u7684\u8bbe\u8ba1\u57fa\u672c\u4e0a\u53ef\u4ee5\u8bf4\u5c31\u662f\u5173\u4e8e\u6bcf\u5f20\u72ec\u7acb\u8868\u4e4b\u95f4\u7684\u5173\u7cfb\u7684\u8bbe\u8ba1\u3002\u5f15\u7528\u5b8c\u6574\u6027\u662f\u5408\u7406\u7684\u6570\u636e\u5e93\u8bbe\u8ba1\u548c\u64cd\u4f5c\u7684\u975e\u5e38\u91cd\u8981\u7684\u4e00\u90e8\u5206\u3002</p> <p>\u5f53\u4e00\u5217\u6216\u8005\u591a\u5217\u58f0\u660e\u4e86\u5916\u952e\u7ea6\u675f\u540e\uff0c\u8fd9\u4e9b\u5217\u4e2d\u7684\u6570\u636e\u5fc5\u987b\u5728\u5176\u7236\u8868\uff08\u5373\u6240\u5f15\u7528\u7684\u8868\uff09\u7684\u4e3b\u952e\u5217\u6216\u8005\u552f\u4e00\u5b57\u6bb5\u7684\u5217\u4e2d\u5b58\u5728\u3002</p> <p><code>\u7269\u7406\u5916\u952e</code>\u662f\u6211\u4eec\u5b66\u4e60\u6570\u636e\u5e93\u539f\u7406\u548c\u8bbe\u8ba1\u65f6\u90fd\u4f1a\u9047\u5230\u7684\u7ae0\u8282\uff0c\u5b83\u7684\u4e3b\u8981\u4f18\u52bf\u662f\u53ef\u4ee5\u901a\u8fc7\u6570\u636e\u5e93\u5b9e\u73b0\u5f3a\u5236\u7684 Referential Integrity\uff0c\u5373\u5f15\u7528\u5b8c\u6574\u6027\u3002\u4f46\u8fd9\u6837\u7684\u5b8c\u6574\u6027\u4f7f\u7528\u903b\u8f91\u5916\u952e\u4e5f\u5b8c\u5168\u80fd\u5b9e\u73b0\uff0c\u6709\u4eba\u8ba4\u4e3a\u903b\u8f91\u5916\u952e\u7531\u4e8e\u5b8c\u5168\u4f9d\u8d56\u4e1a\u52a1\u4ee3\u7801\u6240\u4ee5\u65e0\u6cd5\u771f\u6b63\u4fdd\u8bc1\u5b8c\u6574\u6027\uff0c\u4f46\u8fd9\u5176\u5b9e\u662f\u4e2a\u4f2a\u547d\u9898\uff0c\u56e0\u4e3a\u7269\u7406\u5916\u952e\u4e5f\u662f\u7531\u300c\u4eba\u300d\u6765\u8bbe\u7f6e\u7684\uff0c\u4f60\u53ea\u80fd\u4fdd\u8bc1\u8bbe\u7f6e\u8fc7\u7684\u7269\u7406\u5916\u952e\u80fd\u4fdd\u8bc1\u5f15\u7528\u5b8c\u6574\u6027\uff0c\u81f3\u4e8e\u90a3\u4e9b\u6ca1\u8003\u8651\u5230\u7684\u3001\u8bbe\u8ba1\u9519\u8bef\u7684\u6570\u636e\u5173\u8054\u5173\u7cfb\u4ecd\u7136\u662f\u7269\u7406\u5916\u952e\u65e0\u6cd5\u89e3\u51b3\u7684\uff0c\u5728\u8fd9\u4e00\u70b9\u4e0a\u7269\u7406\u5916\u952e\u548c\u903b\u8f91\u5916\u952e\u662f\u6ca1\u6709\u5b9e\u8d28\u533a\u522b\u7684\u3002\u800c\u5b9e\u9645\u4e0a\u5f53\u4eca\u7684\u4e91\u539f\u751f\u67b6\u6784\u5728\u6570\u636e\u5c42\u9762\u8ffd\u6c42\u7684\u662f\u5206\u5e03\u5f0f\u548c\u6700\u7ec8\u4e00\u81f4\u6027\uff0c\u5355\u4e2a DB \u5b58\u50a8\u6240\u6709\u6570\u636e\u7684\u65f6\u4ee3\u65e9\u5df2\u8fc7\u53bb\uff0c\u6570\u636e\u5728\u670d\u5df2\u52a1\u95f4\u6d41\u8f6c\u7ecf\u662f\u5e38\u6001\uff0c\u6b64\u5916\u56fd\u5185\u573a\u666f\u4e0b\u5f88\u591a\u6570\u636e\u4e5f\u4e0d\u88ab\u5141\u8bb8\u76f4\u63a5\u7269\u7406\u5220\u9664\uff0c\u7269\u7406\u5916\u952e\u7684\u4f5c\u7528\u5728\u73b0\u4ee3\u67b6\u6784\u4e0b\u53d8\u5f97\u5fae\u4e4e\u5176\u5fae\u3002\u7269\u7406\u5916\u952e\u4e0d\u662f\u94f6\u5f39\uff0c\u5b83\u751a\u81f3\u90fd\u6ca1\u6709\u6210\u4e3a\u94f6\u5f39\u7684\u5b9e\u529b\u3002</p> <p>\u8bf4\u5230\u52a3\u52bf\uff0c\u7269\u7406\u5916\u952e\u5728\u73b0\u4ee3\u540e\u7aef\u67b6\u6784\u4e2d\u7684\u7f3a\u70b9\u5df2\u7ecf\u8d8a\u53d1\u660e\u663e\u3002\u5206\u573a\u666f\u5206\u6790\u5982\u4e0b\uff1a</p> <ul> <li> <p>\u5bf9\u4e8e\u4f20\u7edf\u4f01\u4e1a\u5e94\u7528\uff0c\u4ea4\u4ed8\u540e\u51e0\u4e4e\u6ca1\u6709\u5927\u9762\u79ef\u8fed\u4ee3\uff0c\u4f7f\u7528\u7269\u7406\u5916\u952e\u662f\u65e0\u53ef\u539a\u975e\u7684\uff0c\u8fd9\u4e5f\u662f\u5bf9\u4f20\u7edf\u8f6f\u4ef6\u5f00\u53d1\u6a21\u5f0f\u548c\u67b6\u6784\u7684\u4f20\u627f\u3002\u4f46\u73b0\u5728\u6709\u8d8a\u6765\u8d8a\u591a\u7684\u4f01\u4e1a\u9009\u62e9\u4f7f\u7528 SaaS \u6216\u81ea\u4e3b\u8fdb\u884c\u7814\u53d1\u548c\u7ef4\u62a4\uff0c\u8fd9\u4e5f\u5c31\u610f\u5473\u7740\u4ea7\u54c1\u7684\u8fed\u4ee3\u4f1a\u6bd4\u6b64\u524d\u9891\u7e41\u5f97\u591a\uff0c\u8fdb\u800c\u53d8\u4e3a\u4e0b\u6587\u63d0\u5230\u7684\u6d41\u91cf\u5c0f\u4f46\u8fed\u4ee3\u9891\u7e41\u7684\u9879\u76ee\u3002</p> </li> <li> <p>\u73a9\u5177\u578b\u9879\u76ee\u7528\u4e0d\u7528\u5916\u952e\u90fd\u6ca1\u6709\u533a\u522b\u3002</p> </li> <li> <p>\u5927\u6d41\u91cf\u9879\u76ee\u4f7f\u7528\u7269\u7406\u5916\u952e\u65e0\u7591\u662f\u5728\u57cb\u5751\uff0c\u629b\u5f00\u9887\u53d7\u4e89\u8bae\u7684\u6027\u80fd\u95ee\u9898\u4e0d\u8c08\uff0c\u7269\u7406\u5916\u952e\u65e0\u6cd5\u6ee1\u8db3\u5206\u5e93\u5206\u8868\u3001\u5355\u5143\u5316\u7b49\u73b0\u4ee3\u67b6\u6784\u8bbe\u8ba1\u7684\u9700\u8981\uff0c\u751a\u81f3\u5728\u8fd9\u4e9b\u67b6\u6784\u4e0b\u8fd8\u4f1a\u6210\u4e3a\u7d2f\u8d58\u8981\u989d\u5916\u82b1\u8d39\u65f6\u95f4\u6539\u9020\u6389\u3002</p> </li> <li> <p>\u5c0f\u6d41\u91cf\u9879\u76ee\u7684\u8fed\u4ee3\u901f\u5ea6\u53ef\u4e0d\u6162\uff0c\u9886\u57df\u6a21\u578b\u5f88\u96be\u7a33\u5b9a\u4e0b\u6765\uff0c\u800c\u4f7f\u7528\u4e86\u7269\u7406\u5916\u952e\u4e5f\u5c31\u610f\u5473\u7740\u7cfb\u7edf\u662f\u57fa\u4e8e\u6570\u636e\u5e93\u8fdb\u884c\u7684\u5efa\u6a21\uff0c\u90a3\u4e48\u5f53\u524d\u7684\u7269\u7406\u5916\u952e\u8bbe\u8ba1\u8fdf\u65e9\u6709\u4e00\u5929\u8981\u9762\u4e34\u53d8\u66f4\uff0c\u8fd9\u6240\u5e26\u6765\u7684\u7ef4\u62a4\u6210\u672c\uff08\u6539\u8868\u56f0\u96be\u3001\u4e1a\u52a1\u62c6\u5206\u548c\u805a\u5408\u56f0\u96be\u7b49\uff09\u662f\u5de8\u5927\u7684\uff0c\u8fd9\u4e5f\u662f\u4e3a\u4ec0\u4e48\u73b0\u5728\u5f88\u5c11\u6709\u4eba\u4f7f\u7528\u5b58\u50a8\u8fc7\u7a0b\u7684\u539f\u56e0\u3002</p> </li> </ul> <p>\u5728\u4eba\u5458\u804c\u8d23\u4e0a\uff0cDBA \u4e0e\u4e1a\u52a1\u5f3a\u8026\u5408\u672c\u8eab\u5c31\u662f\u4e0d\u5408\u7406\u7684\uff0c\u8fd9\u548c\u4e3a\u4ec0\u4e48\u8981\u505a\u524d\u540e\u7aef\u5206\u79bb\u662f\u4e00\u4e2a\u9053\u7406\uff0c\u8fd9\u4e5f\u662f\u4e3a\u4ec0\u4e48\u5f53\u4eca\u5f88\u591a\u4e92\u8054\u7f51\u516c\u53f8\u4f1a\u9009\u62e9\u4e00\u540d DBA \u5bf9\u63a5\u4e00\u4e2a\u540e\u7aef\u5927\u7ec4\u751a\u81f3\u4e8b\u4e1a\u90e8\u7684\u539f\u56e0\uff0cDBA \u7684\u804c\u8d23\u5df2\u7ecf\u4e0b\u6c89\u5230\u66f4\u6838\u5fc3\u7684\u6570\u636e\u5e93\u7a33\u5b9a\u6027\u548c\u6027\u80fd\u63d0\u5347\u4e0a\u3002\u800c\u5728\u67b6\u6784\u4e2d\u7684\u5206\u5c42\u804c\u8d23\u4e0a\uff0c\u5728\u6301\u4e45\u5c42\u8026\u5408\u4e1a\u52a1\u903b\u8f91\u662f\u975e\u5e38\u4e0d\u660e\u667a\u7684\uff0c\u56e0\u4e3a\u8fd9\u610f\u5473\u7740\u4f60\u7684\u67b6\u6784\u4f1a\u4e25\u91cd\u4f9d\u8d56\u67d0\u4e2a\u6570\u636e\u5e93\u9009\u578b\u751a\u81f3\u67d0\u4e2a\u7279\u5b9a\u7248\u672c\u6570\u636e\u5e93\u7684\u529f\u80fd\uff0c\u9886\u57df\u6a21\u578b\u4e0e\u6570\u636e\u6a21\u578b\u7684\u8026\u5408\u4e5f\u4f1a\u4ea7\u751f\u5f88\u591a\u4eba\u5669\u68a6\u4e2d\u7684\u4e00\u4e2a Service \u5c42\u8d70\u5929\u4e0b\u7684\u60c5\u51b5\uff0c\u4e1a\u52a1\u903b\u8f91\u5f88\u96be\u505a\u8fdb\u4e00\u6b65\u7684\u62bd\u8c61\u548c\u62c6\u5206\uff0c\u81f3\u4e8e\u8bfb\u5199\u6a21\u578b\u5206\u79bb\u3001CQRS \u4e5f\u5c31\u662f\u66f4\u4e0d\u53ef\u80fd\u7684\u4e8b\u60c5\u4e86\u3002</p> <p>\u5728\u67b6\u6784\u4e2d\u7684\u5206\u5c42\u804c\u8d23\u4e0a\uff0c\u5728\u6301\u4e45\u5c42\u8026\u5408\u4e1a\u52a1\u903b\u8f91\u662f\u975e\u5e38\u4e0d\u660e\u667a\u7684\uff0c\u56e0\u4e3a\u8fd9\u610f\u5473\u7740\u4f60\u7684\u67b6\u6784\u4f1a\u4e25\u91cd\u4f9d\u8d56\u67d0\u4e2a\u6570\u636e\u5e93\u9009\u578b\u751a\u81f3\u67d0\u4e2a\u7279\u5b9a\u7248\u672c\u6570\u636e\u5e93\u7684\u529f\u80fd\uff0c\u9886\u57df\u6a21\u578b\u4e0e\u6570\u636e\u6a21\u578b\u7684\u8026\u5408\u4e5f\u4f1a\u4ea7\u751f\u5f88\u591a\u4eba\u5669\u68a6\u4e2d\u7684\u4e00\u4e2a Service \u5c42\u8d70\u5929\u4e0b\u7684\u60c5\u51b5\uff0c\u4e1a\u52a1\u903b\u8f91\u5f88\u96be\u505a\u8fdb\u4e00\u6b65\u7684\u62bd\u8c61\u548c\u62c6\u5206\uff0c\u81f3\u4e8e\u8bfb\u5199\u6a21\u578b\u5206\u79bb\u3001CQRS \u4e5f\u5c31\u662f\u66f4\u4e0d\u53ef\u80fd\u7684\u4e8b\u60c5\u4e86\u3002</p> <p>\u4f7f\u7528\u7269\u7406\u5916\u952e\u80fd\u5e26\u6765\u6536\u76ca\u975e\u5e38\u6709\u9650\uff0c\u4f46\u9690\u6027\u6210\u672c\uff08\u53ea\u8981\u4e1a\u52a1\u8fd8\u5728\u53d1\u5c55\uff0c\u90a3\u672a\u6765\u65e9\u665a\u4f1a\u53d8\u4e3a\u663e\u6027\u6210\u672c\uff09\u5374\u975e\u5e38\u9ad8\uff0c\u5176\u672c\u8eab\u53c8\u53ef\u4ee5\u88ab\u903b\u8f91\u5916\u952e\u6240\u66ff\u4ee3</p>"},{"location":"dev/02.%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AE%BE%E8%AE%A1/#eav","title":"EAV \u6a21\u578b","text":"<p>\u5047\u8bbe\u8981\u505a\u4e00\u4e2a\u7535\u5546\u7684\u5546\u54c1\u7ba1\u7406\uff0c\u6709\u4e00\u5f20\u5546\u54c1\u8868\u3002\u6211\u4eec\u5148\u5356\u4e00\u4e9b\u8863\u670d\uff0c\u9700\u8981\u7ba1\u7406\u8863\u670d\u7684\u5c3a\u7801\u3001\u989c\u8272\u3001\u6b3e\u5f0f\u7b49\u4fe1\u606f\uff0c\u6709\u4e00\u5929\u9700\u8981\u5356\u7535\u8111\u4e86\uff0c\u7535\u8111\u9700\u8981 \u4e3b\u677f\u3001CPU\u3001\u663e\u5361\u3001\u5185\u5b58\u3001\u786c\u76d8\u3001\u6563\u70ed \u7b49\u4fe1\u606f\uff0c\u8fc7\u51e0\u5929\u53c8\u9700\u8981\u5356\u624b\u673a\u4e86\uff0c\u624b\u673a\u6709 \u989c\u8272\u3001\u7248\u672c\u3001\u5b58\u50a8\u5bb9\u91cf\u3001\u5957\u9910\u7c7b\u578b\u7b49\u7b49\u4fe1\u606f\uff0c\u6570\u636e\u5e93\u5982\u4f55\u8bbe\u8ba1\uff1f</p> <p>\u65b9\u6848\u4e00\uff1a\u65b0\u589e\u5b57\u6bb5 \u6bcf\u6b21\u65b0\u589e\u5546\u54c1\uff0c\u9700\u8981\u652f\u6301\u4e0d\u540c\u7684\u4fe1\u606f\u7684\u8bdd\u5c31\u4e0d\u505c\u7684\u52a0\u5b57\u6bb5\u3002</p> <p>ID Name \u5c3a\u7801 \u989c\u8272 \u6b3e\u5f0f \u4e3b\u677f CPU \u663e\u5361 \u5185\u5b58 \u5b58\u50a8 \u6563\u70ed \u7248\u672c \u5957\u9910\u7c7b\u578b 1 T \u6064 M \u767d\u8272 \u559c\u7f8a\u7f8a NULL NULL NULL NULL NULL NULL NULL NULL 2 \u5916\u661f\u4eba\u7535\u8111 NULL NULL NULL A i99 RTX8090 32G 2T \u6c34\u51b7 NULL \u952e\u9f20\u5957\u88c5 3 \u9999\u8549\u624b\u673a NULL \u4e94\u5f69\u6591\u6593\u9ed1 NULL NULL \u6653\u9f99 999 NULL 12G 512G \u98ce\u6247 Pro Plus MAX \u788e\u5c4f\u9669\u5957\u9910</p> <p>\u8fd9\u6837\u4f1a\u9020\u6210\u4ee5\u4e0b\u95ee\u9898\uff1a</p> <ul> <li>\u5b9e\u73b0\u6210\u672c\u9ad8\uff0c\u6bcf\u6b21\u6dfb\u52a0\u5546\u54c1\u90fd\u9700\u8981\u8fdb\u884c\u524d\u540e\u7aef\u5f00\u53d1\u3001\u8c03\u8bd5\uff0c\u6d6a\u8d39\u65f6\u95f4\u548c\u4eba\u529b\u3002</li> <li>\u9700\u8981\u52a8\u6001\u53d8\u66f4\u8868\u7ed3\u6784\uff0c\u5728\u751f\u4ea7\u73af\u5883\u4e2d\u5b89\u5168\u6027\u592a\u4f4e\u3002</li> <li>\u6d6a\u8d39\u8d44\u6e90\uff0c\u6570\u636e\u5e93\u7684\u5b57\u6bb5\u53ef\u80fd\u4f1a\u8d8a\u6765\u8d8a\u591a\uff0c\u800c\u5f88\u591a\u5b57\u6bb5\u5927\u90e8\u5206\u5546\u54c1\u90fd\u662f\u4e0d\u9700\u8981\u7684\uff0c\u9700\u8981\u8bbe\u7f6e\u4e3a NULL\uff0c\u5bfc\u81f4\u5185\u5b58\u5927\u91cf\u6d6a\u8d39\u3002</li> <li>\u6269\u5c55\u80fd\u529b\u4e00\u822c\uff0c\u6709\u4e0a\u9650\u3002</li> </ul> <p>Entity-Attribute-Value (wiki)\u662f\u4e00\u79cd\u6570\u636e\u6a21\u578b\uff0c\u7528\u4e8e\u4ee5\u8282\u7701\u7a7a\u95f4\u7684\u65b9\u5f0f\u5bf9\u5b9e\u4f53\u8fdb\u884c\u7f16\u7801\u3002</p> <ul> <li>Entity\uff1a\u5b9e\u4f53\uff0c\u4ee3\u8868\u4e00\u4e2a\u4e1a\u52a1\u5bf9\u8c61\uff0c\u6bd4\u5982\u4e0a\u9762\u7684\u4f8b\u5b50\u91cc\u7684\u5546\u54c1\u3002</li> <li>Attribute\uff1a\u5bf9\u8c61\u7684\u5c5e\u6027\uff0c\u5c5e\u6027\u5e76\u4e0d\u662f\u4f5c\u4e3a\u5b9e\u4f53\u5355\u72ec\u7684\u4e00\u5217\u6765\u8fdb\u884c\u5b58\u653e\uff0c\u800c\u662f\u5b58\u50a8\u5728\u4e00\u7ec4\u5355\u72ec\u7684\u6570\u636e\u5e93\u8868\u4e2d\u3002</li> <li>Value\uff1a\u6307\u7279\u5b9a\u5c5e\u6027\u6240\u5173\u8054\u7684\u503c\u3002</li> </ul> <p>\u5728\u73b0\u4ee3\u9762\u5411\u5bf9\u8c61\u7684\u7f16\u7a0b\u6a21\u578b\u4e2d\uff0c\u4e0d\u540c\u7684\u5bf9\u8c61\u7c7b\u578b\u53ef\u80fd\u662f\u76f8\u8fde\u7684\u3002\u6bd4\u5982\uff0c\u591a\u4e2a\u5bf9\u8c61\u90fd\u53ef\u80fd\u662f\u4ece\u540c\u4e00\u4e2a\u57fa\u7c7b\u6d3e\u751f\u800c\u6765\uff0c\u5b83\u4eec\u65e2\u662f\u5b9e\u9645\u5b50\u7c7b\u7684\u5b9e\u4f8b\uff0c\u4e5f\u540c\u65f6\u662f\u7236\u7c7b\u7684\u5b9e\u4f8b\u3002\u6211\u4eec\u53ef\u80fd\u60f3\u4ec5\u4f7f\u7528\u4e00\u5f20\u8868\u6765\u5b58\u50a8\u6240\u6709\u8fd9\u4e9b\u4e0d\u540c\u7c7b\u578b\u7684\u5bf9\u8c61\uff0c\u8fd9\u6837\u80fd\u65b9\u4fbf\u8fdb\u884c\u6bd4\u8f83\u548c\u8ba1\u7b97\u3002\u4f46\u6211\u4eec\u4e5f\u9700\u8981\u5c06\u4e0d\u540c\u7684\u5b50\u7c7b\u5206\u5f00\u5b58\u50a8\uff0c\u56e0\u4e3a\u6bcf\u4e2a\u5b50\u7c7b\u90fd\u6709\u4e00\u4e9b\u7279\u6b8a\u7684\u5c5e\u6027\uff0c\u548c\u5176\u4ed6\u7684\u5b50\u7c7b\u751a\u81f3\u7236\u7c7b\u90fd\u4e0d\u80fd\u5171\u7528\u3002</p>"},{"location":"dev/02.%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AE%BE%E8%AE%A1/#_14","title":"\u591a\u5217\u5c5e\u6027","text":""},{"location":"dev/02.%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AE%BE%E8%AE%A1/#_15","title":"\u8bbe\u8ba1\u89c4\u7ea6","text":"<p>\u6570\u636e\u5e93\u8bbe\u8ba1\u548c\u5efa\u6a21\u662f\u4e00\u4e9b\u5f88\u5c11\u5f97\u5230\u5e94\u6709\u5173\u6ce8\u7684\u4e3b\u9898\uff0c\u5c24\u5176\u662f\u5728\u9879\u76ee\u5f00\u59cb\u65f6\uff0c\u4f46\u662f\u4e00\u65e6\u4e8b\u60c5\u5931\u53bb\u63a7\u5236\uff0c\u95ee\u9898\u4f1a\u53d8\u5f97\u975e\u5e38\u68d8\u624b\u3002</p> <p>\u5728\u8bbe\u8ba1\u6570\u636e\u5e93\u6280\u672f\u65b9\u6848\u65f6\uff0c\u6211\u4eec\u662f\u6709\u81ea\u5df1\u7684\u8bbe\u8ba1\u7406\u5ff5\u6216\u8005\u539f\u5219\uff0c\u8fd8\u662f\u66f4\u591a\u4f9d\u636e\u76f4\u89c9\u53bb\u8bbe\u8ba1\uff1f\u662f\u5426\u66fe\u7ecf\u61ca\u6094\u7ebf\u4e0a\u53d1\u751f\u8fc7\u7684\u4e00\u6b21\u4f4e\u7ea7\u6545\u969c\uff1f\u662f\u5426\u601d\u8003\u8fc7\u600e\u6837\u624d\u80fd\u907f\u514d\uff1f\u8bbe\u8ba1\u89c4\u8303\u7684\u4ef7\u503c\u5728\u4e8e\u63d0\u4f9b\u4e86\u4e00\u4efd\u5de5\u4f5c\u68c0\u67e5\u6e05\u5355\uff0c\u6211\u4eec\u4e0d\u65ad\u4ece\u9519\u8bef\u4e2d\u79ef\u7d2f\u6709\u6548\u7ecf\u9a8c\uff0c\u6307\u5bfc\u672a\u6765\u7684\u5de5\u4f5c\u3002</p> <p>\u662f\u5426\u4f7f\u7528\u9884\u7559\u5b57\u6bb5\uff1f</p> <p>\u5728\u9879\u76ee\u4ea4\u4ed8\u524d\uff0c\u9700\u6c42\u4e0d\u65ad\u5728\u53d8\uff0c\u5982\u4f55\u5728\u9700\u6c42\u6539\u53d8\u7684\u540c\u65f6\u5c3d\u53ef\u80fd\u51cf\u5c11\u5bf9\u8868\u7ed3\u6784\u7684\u4fee\u6539\u662f\u6211\u4eec\u73b0\u5728\u8003\u8651\u7684\u95ee\u9898\u3002\u5bf9\u4e8e\u4e00\u822c\u60c5\u51b5\u800c\u8a00\uff0c\u5728\u8bbe\u8ba1\u7684\u65f6\u5019\u6211\u4eec\u53ef\u4ee5\u9002\u5f53\u6dfb\u52a0\u4e00\u4e9b\u9884\u7559\u7684\u5b57\u6bb5\uff0c\u9700\u6c42\u6539\u53d8\u7684\u65f6\u5019\u53ef\u4ee5\u7528\u4e0a\uff0c\u6216\u8005\u8bf4\u662f\u6dfb\u52a0\u4e0d\u8db3\u7684\u5b57\u6bb5\u3002</p> <p>\u5728\u6570\u636e\u8868\u4e2d\uff0c\u4e0d\u4ec5\u8bbe\u8ba1\u4e86\u5f53\u524d\u6240\u9700\u8981\u7684\u5b57\u6bb5\uff0c\u800c\u4e14\u8fd8\u5728\u5176\u4e2d\u7559\u51fa\u51e0\u4e2a\u5b57\u6bb5\u4f5c\u4e3a\u5907\u7528\u3002\u6bd4\u65b9\u8bf4\uff0c\u8bbe\u8ba1\u4e86\u4e00\u4e2a\u4eba\u5458\u8868\uff08Person\uff09\uff0c\u5176\u4e2d\u5df2\u7ecf\u6dfb\u52a0\u4e86\u5404\u79cd\u5fc5\u8981\u7684\u5b57\u6bb5\uff0c\u5305\u62ec\u59d3\u540d\uff08Name\uff09\u3001\u6027\u522b\uff08Sex\uff09\u3001\u51fa\u751f\u5e74\u6708\u65e5\uff08birthday\uff09\u7b49\u7b49\u3002\u5927\u529f\u544a\u6210\u4e4b\u540e\uff0c\u5ffd\u7136\u60f3\u5230\uff0c\u5c06\u6765\u7cfb\u7edf\u4e2d\u5e94\u8be5\u8fd8\u4f1a\u6709\u5f88\u591a\u5176\u5b83\u4e0e\u4eba\u76f8\u5173\u7684\u5185\u5bb9\u5427\uff0c\u6bd4\u65b9\u8bf4\u6bd5\u4e1a\u9662\u6821\uff0c\u6bd4\u65b9\u8bf4\u5de5\u4f5c\u5355\u4f4d\u7b49\u7b49\uff0c\u5c3d\u7ba1\u73b0\u5728\u6839\u672c\u4e0d\u9700\u8981\u586b\u5199\uff0c\u4ee5\u540e\u53ef\u80fd\u8fd8\u662f\u4f1a\u7528\u5230\u7684\u5427\u3002\u62cd\u8111\u888b\u4e00\u9879\uff0c\u90a3\u5c31\u52a0\u5165 5 \u4e2a varchar2 \u578b\u7684\u5b57\u6bb5\uff0c\u5206\u522b\u53eb\u505a Text1\u3001Text2\u2026\u2026Text5\uff0c\u7136\u540e\u53c8\u60f3\uff0c\u5e94\u8be5\u8fd8\u6709\u4e00\u4e9b\u65e5\u671f\u578b\u7684\u5b57\u6bb5\u9700\u8981\u5907\u7528\uff0c\u5c31\u53c8\u5efa\u7acb\u4e86\u4e09\u4e2a date \u578b\u7684\u5b57\u6bb5\uff0c\u5206\u522b\u8d77\u540d\u53eb\u505a date1\u3001date2\u3001date3\u3002</p> <p>\u3010\u89e3\u51b3\u65b9\u6848\u3011</p> <p>\u5176\u5b9e\u4e0a\u9762\u7684\u8fd9\u79cd\u8bbe\u8ba1\u65b9\u5f0f\u5c31\u662f\u4e00\u79cd\u201c\u8fc7\u5ea6\u8bbe\u8ba1\u201d\uff0c\u6211\u4eec\u5e94\u8be5\u505a\u7684\u5c31\u662f\u201c\u6309\u9700\u8bbe\u8ba1\u201d\u3002\u56e0\u6b64\u8981\u7981\u6b62\u5728\u8868\u4e2d\u5efa\u7acb\u9884\u7559\u5b57\u6bb5\uff0c\u7406\u7531\u5982\u4e0b\uff1a</p> <p>1.\u65e0\u6cd5\u51c6\u786e\u7684\u77e5\u9053\u9884\u7559\u5b57\u6bb5\u7684\u7c7b\u578b\uff0c\u6240\u4ee5\u65e0\u6cd5\u9009\u62e9\u5408\u9002\u7684\u7c7b\u578b\u3002</p> <p>2.\u65e0\u6cd5\u51c6\u786e\u7684\u77e5\u9053\u9884\u7559\u5b57\u6bb5\u4e2d\u6240\u5b58\u50a8\u7684\u5185\u5bb9\uff0c\u9884\u7559\u5b57\u6bb5\u7684\u547d\u540d\u5f88\u96be\u505a\u5230\u89c1\u540d\u8bc6\u4e49</p> <p>3.\u540e\u671f\u7ef4\u62a4\u9884\u7559\u5b57\u6bb5\u6240\u8981\u7684\u6210\u672c\uff0c\u540c\u589e\u52a0\u4e00\u4e2a\u5b57\u6bb5\u6240\u9700\u8981\u7684\u6210\u672c\u662f\u76f8\u540c\u7684\u3002\u5bf9\u9884\u7559\u5b57\u6bb5\u7c7b\u578b\u7684\u4fee\u6539\uff0c\u4f1a\u5bf9\u8868\u8fdb\u884c\u9501\u5b9a\u3002\uff08\u4fee\u6539\u4e00\u4e2a\u5b57\u6bb5\u7684\u6210\u672c\uff0c\u5927\u4e8e\u65b0\u589e\u5b57\u6bb5\uff09\u3002</p> <p>\u63a8\u8350\u89e3\u51b3\u529e\u6cd5\u662f\uff0c\u5f53\u9700\u8981\u589e\u52a0\u76f8\u5173\u7684\u4fe1\u606f\u7684\u65f6\u5019\uff1a</p> <p>\u5982\u679c\u6570\u91cf\u5f88\u5c11\uff0c\u800c\u4e14\u4fe1\u606f\u7684\u6027\u8d28\u4e0e\u539f\u8868\u5bc6\u5207\u76f8\u5173\uff0c\u90a3\u4e48\u5c31\u53ef\u4ee5\u76f4\u63a5\u5728\u539f\u8868\u4e0a\u589e\u52a0\u5b57\u6bb5\uff0c\u5e76\u5c06\u76f8\u5173\u7684\u6570\u636e\u66f4\u65b0\u8fdb\u53bb\uff1b \u5982\u679c\u6570\u91cf\u8f83\u5927\uff0c\u6216\u8005\u5e76\u975e\u662f\u539f\u8868\u5bf9\u8c61\u81f3\u5173\u91cd\u8981\u7684\u5c5e\u6027\uff0c\u90a3\u4e48\u5c31\u53ef\u4ee5\u65b0\u589e\u4e00\u4e2a\u8868\uff0c\u7136\u540e\u901a\u8fc7\u952e\u503c\u8fde\u63a5\u8d77\u6765\uff1b \u5bf9\u4e8e\u8868\u7684\u6570\u636e\u7684\u5b58\u50a8\u4f4d\u7f6e\u6240\u5bfc\u81f4\u7684\u6027\u80fd\u95ee\u9898\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u5728\u7279\u5b9a\u65f6\u95f4\u5bf9\u6570\u636e\u5e93\u7684\u6570\u636e\u8fdb\u884c\u91cd\u7ec4\u6765\u89e3\u51b3\uff0c\u800c\u8fd9\u9879\u5de5\u4f5c\u5bf9\u4e8e\u957f\u671f\u8fd0\u884c\u7684\u6570\u636e\u5e93\u6765\u8bf4\uff0c\u4e5f\u662f\u9700\u8981\u5b9a\u671f\u8fdb\u884c\u7684\u3002</p>"},{"location":"dev/03.%E5%9C%A8%E7%BA%BFDDL/","title":"3.\u5728\u7ebfDDL","text":""},{"location":"dev/03.%E5%9C%A8%E7%BA%BFDDL/#ddl","title":"DDL \u53d8\u66f4","text":"<p>DDL\uff08Data Definition Language\uff09\u662f\u6570\u636e\u5e93\u5185\u90e8\u7684\u5bf9\u8c61\u8fdb\u884c\u521b\u5efa\u3001\u5220\u9664\u3001\u4fee\u6539\u7684\u64cd\u4f5c\u8bed\u8a00\uff0c\u4e3b\u8981\u5305\u62ec\uff1a\u52a0\u51cf\u5217\u3001\u66f4\u6539\u5217\u7c7b\u578b\u3001\u52a0\u51cf\u7d22\u5f15\u7b49\u7c7b\u578b\u3002</p> <p>\u6570\u636e\u5e93\u7684\u6a21\u5f0f(schema)\u4f1a\u968f\u7740\u4e1a\u52a1\u7684\u53d1\u5c55\u4e0d\u65ad\u53d8\u5316\uff0c\u5982\u679c\u6ca1\u6709\u9ad8\u6548\u7684 DDL \u529f\u80fd\uff0c\u6bcf\u4e00\u6b21\u53d8\u66f4\u90fd\u6709\u53ef\u80fd\u5f71\u54cd\u4e1a\u52a1\uff0c\u751a\u81f3\u4ea7\u751f\u6545\u969c\u3002</p> <p>\u5728\u6570\u636e\u5e93\u7684\u53d1\u5c55\u5386\u53f2\u4e2d\uff0cDDL (Data Definition Language) \u64cd\u4f5c\u4e00\u76f4\u662f\u4e00\u4e2a\u91cd\u8981\u7684\u6311\u6218\u3002\u5728\u4e3b\u6d41\u5546\u4e1a\u6570\u636e\u5e93\u7684\u65e9\u671f\u7248\u672c\u4e2d\uff0c\u4f20\u7edf\u7684 DDL \u64cd\u4f5c\uff0c\u5f80\u5f80\u90fd\u9700\u8981\u5bf9\u6570\u636e\u8868\u8fdb\u884c\u9501\u5b9a\uff0c\u4ee5\u9632\u6b62\u5728\u64cd\u4f5c\u8fc7\u7a0b\u4e2d\u53d1\u751f\u6570\u636e\u4e0d\u4e00\u81f4\u3002</p> <p>\u8fd9\u79cd\u9501\u5b9a\u64cd\u4f5c\u4f1a\u5bfc\u81f4\u6570\u636e\u5e93\u5728 DDL \u64cd\u4f5c\u671f\u95f4\u65e0\u6cd5\u63d0\u4f9b\u670d\u52a1\uff0c\u5bf9\u4e8e\u9700\u8981 7*24 \u8fd0\u884c\u7684\u5927\u578b\u73b0\u4ee3\u5e94\u7528\u6765\u8bf4\uff0c\u8fd9\u662f\u96be\u4ee5\u63a5\u53d7\u7684\u3002</p> <p>\u4e3a\u4e86\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\uff0cORACLE \u81ea 9i \u5f15\u5165 <code>Online Table Redefinition</code>\uff0cMySQL \u81ea 5.6 \u5f15\u5165 <code>OnlineDDL</code>\uff0c\u90fd\u65e8\u5728\u663e\u8457\u51cf\u5c11\uff08\u6216\u6d88\u9664\uff09\u66f4\u6539\u6570\u636e\u5e93\u5bf9\u8c61\u6240\u9700\u7684\u5e94\u7528\u7a0b\u5e8f\u505c\u673a\u65f6\u95f4\uff08\u8be5\u7279\u6027\u4ee5\u4e0b\u7edf\u79f0 OnlineDDL\uff09\u3002</p> <p>MySQL \u5728 8.0 \u4ee5\u524d\u5c31\u5df2\u7ecf\u652f\u6301 Online DDL\uff0c\u5728\u6267\u884c\u65f6\u80fd\u591f\u4e0d\u963b\u585e\u5176\u5b83 DML\uff08Insert/Update/Delete\uff09\u64cd\u4f5c\uff0c\u4f46\u8bb8\u591a\u91cd\u8981\u7684 DDL \u64cd\u4f5c\uff0c\u5982\u52a0\u51cf\u5217\u7b49\uff0c\u4ecd\u65e7\u9700\u8981\u7b49\u5f85\u5f88\u957f\u65f6\u95f4\uff08\u6839\u636e\u6570\u636e\u91cf\u7684\u5927\u5c0f\uff09\u624d\u4f1a\u751f\u6548\u3002</p> <p>DDL \u53d8\u66f4\u662f\u5e94\u7528\u7248\u672c\u90e8\u7f72\u8fc7\u7a0b\u4e2d\u7684\u5e38\u89c1\u64cd\u4f5c\uff0c\u5728\u6838\u5fc3\u4e1a\u52a1\u7cfb\u7edf\u4e2d DDL \u64cd\u4f5c\u4e0d\u80fd\u4fdd\u8bc1\u5728\u7ebf\u5b8c\u6210\uff0c\u662f\u4f1a\u5f71\u54cd\u4e1a\u52a1 7x24 \u5c0f\u65f6\u7684\u3002</p> <p>\u6700\u5e38\u89c1\u7684\u64cd\u4f5c\u83ab\u8fc7\u4e8e\u5728\u7ebf\u52a0\u4e00\u4e2a\u5b57\u6bb5\u6216\u8005\u7d22\u5f15\uff0c\u5982\u679c\u6570\u636e\u91cf\u6bd4\u8f83\u5927\u7684\u8bdd\uff0c\u4f34\u968f\u800c\u6765\u7684\u5f80\u5f80\u662f\u957f\u65f6\u95f4\u7684\u7b49\u5f85\uff0c\u64cd\u4f5c\u671f\u95f4\u5bf9\u8868\u7684\u8bbf\u95ee\u90fd\u4f1a\u4e0d\u53ef\u7528\uff0c\u6240\u4ee5\u4e00\u822c\u53ea\u80fd\u7b49\u5230\u51cc\u6668\u64cd\u4f5c\uff0c\u7b80\u76f4\u5c31\u662f\u68a6\u9b47\u4e00\u822c\u7684\u5b58\u5728\u3002</p>"},{"location":"dev/03.%E5%9C%A8%E7%BA%BFDDL/#_1","title":"\u53d1\u5c55\u5386\u7a0b","text":"<p>\u5728 <code>MySQL 5.5</code> \u7248\u672c\u4e2d\u5c31\u52a0\u5165\u4e86 <code>INPLACE DD</code>L \u65b9\u5f0f\uff0c\u4f46\u662f\u56e0\u4e3a\u5b9e\u73b0\u7684\u95ee\u9898\uff0c\u4f9d\u7136\u4f1a\u963b\u585e <code>INSERT</code>\u3001<code>UPDATE</code>\u3001<code>DELETE</code> \u64cd\u4f5c\uff0c\u8fd9\u4e5f\u662f <code>MySQL</code> \u65e9\u671f\u7248\u672c\u957f\u671f\u88ab\u5410\u69fd\u7684\u539f\u56e0\u4e4b\u4e00\u3002</p> <p>\u5728 <code>MySQL 5.6</code> \u4e2d\uff0c\u5b98\u65b9\u5f00\u59cb\u652f\u6301\u66f4\u591a\u7684 <code>ALTER TABLE</code> \u7c7b\u578b\u64cd\u4f5c\u6765\u907f\u514d\u6570\u636e\u62f7\u8d1d\uff0c\u540c\u65f6\u652f\u6301\u4e86\u5728\u7ebf\u4e0a DDL \u7684\u8fc7\u7a0b\u4e2d\u4e0d\u963b\u585e DML \u64cd\u4f5c\uff0c\u771f\u6b63\u610f\u4e49\u4e0a\u7684\u5b9e\u73b0\u4e86 <code>Online DDL</code>\u3002</p> <p>\u5728 <code>MySQL 8.0</code> \u8fdb\u4e00\u6b65\u5f15\u5165\u4e86 Instant \u7b97\u6cd5\uff0c\u8fd9\u662f DDL \u64cd\u4f5c\u7684\u4e00\u4e2a\u91cd\u5927\u7a81\u7834\u3002<code>Instant DDL</code> \u5141\u8bb8\u7acb\u5373\u6267\u884c\u67d0\u4e9b DDL \u64cd\u4f5c\uff0c\u5982\u5c3e\u90e8\u6dfb\u52a0\u5b57\u6bb5\u3001\u4fee\u6539\u5b57\u6bb5\u540d\u3001\u4fee\u6539\u8868\u540d\u7b49\u7b49\uff0c\u5747\u65e0\u9700\u9501\u5b9a\u8868\u6216\u590d\u5236\u6570\u636e\u3002</p>"},{"location":"dev/03.%E5%9C%A8%E7%BA%BFDDL/#mysql-ddl","title":"MySQL DDL \u7684\u6ce8\u610f\u4e8b\u9879","text":"<p><code>MySQL</code> \u5728\u5927\u8868\u4e0a\u7684 DDL \u4f1a\u5e26\u6765\u8017\u65f6\u8f83\u4e45\u3001\u8d1f\u8f7d\u8f83\u9ad8\u3001\u989d\u5916\u7a7a\u95f4\u5360\u7528\u3001MDL\u3001\u4e3b\u4ece\u540c\u6b65\u5ef6\u65f6\u7b49\u60c5\u51b5\u3002\u9700\u8981\u7279\u522b\u5f15\u8d77\u91cd\u89c6\u3002</p> <ul> <li> <p>DDL \u6240\u9700\u65f6\u95f4   DDL \u7684\u6267\u884c\u65f6\u95f4\uff0c\u548c\u5f88\u591a\u56e0\u7d20\u76f8\u5173\uff0c\u5982\u679c\u9700\u8981\u6bd4\u8f83\u7cbe\u786e\u7684\u65f6\u95f4\u9884\u4f30\uff0c\u5efa\u8bae\u5728\u6d4b\u8bd5\u73af\u5883\u63d0\u524d\u505a\u6d4b\u8bd5\u3002   \u53ef\u4ee5\u65b0\u5efa\u4e00\u4e2a\u6d4b\u8bd5\u5b9e\u4f8b\uff0c\u5c06\u5907\u4efd\u6570\u636e\u5bfc\u51fa\u5230\u6d4b\u8bd5\u5b9e\u4f8b\uff0c\u6267\u884c DDL \u64cd\u4f5c\uff0c\u5224\u65ad\u6267\u884c\u65f6\u95f4\uff0c\u4f5c\u4e3a\u5bf9\u7ebf\u4e0a\u6267\u884c\u7684\u4e00\u4e2a\u4f30\u8ba1\u3002\u4f46\u662f\u8bf7\u6ce8\u610f\uff0c\u8be5\u4f30\u8ba1\u4ecd\u7136\u53ef\u80fd\u4e0d\u51c6\u786e\uff0c\u56e0\u4e3a\u7ebf\u4e0a\u5b9e\u4f8b\u7684\u8d1f\u8f7d\u53ef\u80fd\u4f1a\u6bd4\u6d4b\u8bd5\u5b9e\u4f8b\u9ad8\u3002</p> </li> <li> <p>\u8d1f\u8f7d   \u6240\u6709\u65b9\u5f0f\u5bf9\u5927\u8868\u505a DDL \u90fd\u4f1a\u589e\u52a0\u8d1f\u8f7d\uff0c\u53ea\u662f\u7a0b\u5ea6\u7684\u4e0d\u540c\uff0c\u4e3b\u8981\u4e3a IO \u7684\u8d1f\u8f7d\u3002\u5982\u679c\u662f IO \u4f7f\u7528\u975e\u5e38\u9ad8\u7684\u5b9e\u4f8b\uff0c\u5efa\u8bae\u5728 IO \u8f83\u5c0f\u7684\u65f6\u95f4\u6bb5\u6267\u884c DDL \u64cd\u4f5c\u3002   \u5982\u679c Online DDL \u6267\u884c\u5931\u8d25\uff0c\u5219\u56de\u6eda\u6709\u53ef\u80fd\u4f1a\u662f\u4e00\u9879\u6602\u8d35\u7684\u64cd\u4f5c\uff1b</p> </li> <li> <p>\u989d\u5916\u7a7a\u95f4\u5360\u7528   copy\u3001inplace rebuild-table\u3001gh-ost\u3001pt-online-schema-change\uff0c\u90fd\u4f1a\u5c06\u8868\u5b8c\u6574\u590d\u5236\u4e00\u4efd\u51fa\u6765\u518d\u505a DDL \u53d8\u66f4\uff0c\u56e0\u6b64\u4f1a\u4f7f\u7528\u548c\u539f\u8868\u7a7a\u95f4\u4e00\u6837\u5927\uff08\u751a\u81f3\u66f4\u5927\uff0c\u5982\u679c\u662f\u52a0\u5217\u7684\u64cd\u4f5c\u7684\u8bdd\uff09\u7684\u989d\u5916\u7a7a\u95f4\uff0c\u53e6\u5916\u8fd8\u4f1a\u751f\u6210\u5927\u91cf\u7684\u4e34\u65f6\u65e5\u5fd7\u3002\u8981\u7279\u522b\u6ce8\u610f\u5269\u4f59\u7a7a\u95f4\uff0c\u786e\u4fdd\u7a7a\u95f4\u5145\u88d5\uff0c\u4e0d\u7136\u53ef\u80fd\u5bfc\u81f4 DDL \u8fc7\u7a0b\u4e2d\u78c1\u76d8\u5199\u6ee1\u3002</p> </li> <li> <p>\u4e34\u65f6\u65e5\u5fd7\u6587\u4ef6\u5927\u5c0f(innodb_online_alter_log_max_size)\uff0c\u5f53 DDL \u6267\u884c\u8fc7\u7a0b\u5f53\u4e2d\u5141\u8bb8\u5e76\u53d1\u6267\u884c DML \u64cd\u4f5c\u65f6\u7684\u65e5\u5fd7\u5927\u5c0f\u9700\u6c42\u3002   \u4e34\u65f6\u6392\u5e8f\u6587\u4ef6\u5927\u5c0f(tmpdir)\uff0c\u5f53 DDL \u6267\u884c\u8fc7\u7a0b\u4e2d\u8868\u9700\u8981 rebuild \u65f6\u4e34\u65f6\u6392\u5e8f\u6587\u4ef6\u662f\u653e\u5728 tmpdir \u6307\u5b9a\u7684\u8def\u5f84\u4e0b\u7684\uff0c\u9700\u8981\u4fdd\u8bc1\u8be5\u8def\u5f84\u4e0b\u7684\u78c1\u76d8\u7a7a\u95f4\u5145\u8db3\u3002   \u4e34\u65f6\u6392\u5e8f\u6587\u4ef6\u90fd\u8db3\u591f\u5bb9\u7eb3\u6240\u6709\u4e8c\u7ea7\u7d22\u5f15\u4ee5\u53ca\u805a\u7c07\u7d22\u5f15\u7684\u4e3b\u952e\u5217\uff0c\u6700\u7ec8\u5408\u5e76\u5230\u65b0\u8868\u6216\u7d22\u5f15\u540e\uff0c\u4e34\u65f6\u6392\u5e8f\u6587\u4ef6\u4f1a\u88ab\u5220\u9664\u3002   \u5728 MySQL5.7.11 \u53ca\u4e4b\u540e\u7248\u672c\u5f53\u4e2d\u65b0\u589e\u7cfb\u7edf\u53c2\u6570(innodb_tmpdir)\u4e13\u95e8\u7528\u6765\u6307\u5b9a Online DDL \u4ea7\u751f\u6392\u5e8f\u6587\u4ef6\u7684\u8def\u5f84\u3002   \u4e34\u65f6\u4e2d\u95f4\u8868\u6587\u4ef6\u5927\u5c0f\u5f53\u6709\u4e9b DDL \u6267\u884c\u8fc7\u7a0b\u4e2d\u8868\u9700\u8981 rebuild \u65f6\u4f1a\u5728\u5f53\u524d\u8868\u6240\u5728\u8def\u5f84\u4e0b\u4ea7\u751f\u4e34\u65f6\u4e2d\u95f4\u8868\u6587\u4ef6\uff0c\u4e34\u65f6\u4e2d\u95f4\u8868\u6587\u4ef6\u5927\u5c0f\u53ef\u80fd\u9700\u8981\u4e0e\u539f\u8868\u5927\u5c0f\u4e00\u81f4\uff0c\u5728 DDL \u6267\u884c\u8fc7\u7a0b\u5f53\u4e2d\u4ea7\u751f\u3002</p> </li> </ul>"},{"location":"dev/03.%E5%9C%A8%E7%BA%BFDDL/#mdl","title":"MDL \u9501","text":"<p>\u6240\u6709\u65b9\u5f0f\u505a DDL \u5747\u4f1a\u4ea7\u751f MDL\uff08metadata lock\uff09\u3002\u9664\u4e86 copy \u6a21\u5f0f\u4f1a\u6709\u6301\u7eed\u6027\u7684\u9501\uff08DDL \u7684\u6574\u4e2a\u8fc7\u7a0b\u671f\u95f4\u65e0\u6cd5\u5411\u8be5\u8868\u5199\u5165\u4efb\u4f55\u6570\u636e\uff09\u4e4b\u5916\uff0c\u5176\u4ed6\u65b9\u5f0f\u7684 MDL \u5747\u4e3a\u77ed\u6682\u7684\u9501\u3002</p>"},{"location":"dev/03.%E5%9C%A8%E7%BA%BFDDL/#ddl_1","title":"DDL \u8bed\u6cd5","text":"<pre><code>ALTER TABLE tbl_name\n    [alter_specification [, alter_specification] ...]\n    [partition_options]\n\nalter_specification:\n    table_options\n  | ADD [COLUMN] col_name column_definition\n        [FIRST | AFTER col_name]\n  | ADD [COLUMN] (col_name column_definition,...)\n  ....\n  | ALGORITHM [=] {DEFAULT|INSTANT|INPLACE|COPY}\n\n --\u5907\u6ce8:\n -- 1.DEFAULT\uff1aMySQL\u81ea\u5df1\u9009\u62e9\u9501\u5b9a\u8d44\u6e90\u6700\u5c11\u7684\u65b9\u5f0f\n -- 2.INSTANT\uff1a\u53ea\u9700\u8981\u66f4\u65b0\u6570\u636e\u5b57\u5178\u4e2d\u7684\u5143\u6570\u636e, \u5f88\u5feb\u5b8c\u6210\n -- 3.INPLACE\uff1a\u6b64\u53d8\u66f4\u7531InnoDB\u5f15\u64ce\u72ec\u7acb\u5b8c\u6210, \u4e0d\u9700\u8981\u4f7f\u7528Redo log\u7b49, \u53ef\u4ee5\u8282\u7701\u5f00\u9500\n -- 4.COPY\uff1a\u6b64\u53d8\u66f4\u4f1a\u91cd\u5efa\u805a\u7c07\u7d22\u5f15, \u6267\u884cDDL\u7684\u65f6\u5019\u4f1a\u521b\u5efa\u4e34\u65f6\u8868\n</code></pre>"},{"location":"dev/03.%E5%9C%A8%E7%BA%BFDDL/#mysql-ddl_1","title":"MySQL DDL \u5404\u79cd\u7b97\u6cd5","text":""},{"location":"dev/03.%E5%9C%A8%E7%BA%BFDDL/#copy","title":"copy \u7b97\u6cd5","text":"<p>\u8fd9\u662f\u65e9\u671f\u8f83\u7b80\u5355\u8f83\u4f4e\u7ea7\u7684\u5b9e\u73b0\u65b9\u6cd5\uff0c<code>MySQL</code> \u4f1a\u5728\u5185\u90e8\u5efa\u7acb\u4e00\u4e2a\u65b0\u7684\u4e34\u65f6\u8868\uff0c\u628a\u6e90\u8868\u7684\u6240\u6709\u6570\u636e\u5199\u5165\u5230\u4e34\u65f6\u8868\uff0c\u5728\u6b64\u671f\u95f4\u65e0\u6cd5\u5bf9\u6e90\u8868\u8fdb\u884c\u6570\u636e\u5199\u5165\u3002</p> <p><code>MySQL</code> \u5728\u5b8c\u6210\u4e34\u65f6\u8868\u7684\u5199\u5165\u4e4b\u540e\uff0c\u7528\u4e34\u65f6\u8868\u66ff\u6362\u6389\u6e90\u8868\u3002\u8fd9\u4e2a\u7b97\u6cd5\u4e3b\u8981\u88ab\u65e9\u671f\uff08MySQL&lt;=5.5\uff09\u7248\u672c\u6240\u4f7f\u7528\u3002</p> <p>MySQL \u5185\u90e8\u5177\u4f53\u5b9e\u73b0\u6b65\u9aa4\u5982\u4e0b\uff1a</p> <ol> <li>\u6309\u7167\u8868 A \u7684\u5b9a\u4e49\u65b0\u5efa\u4e00\u4e2a\u4e34\u65f6\u8868 B</li> <li>\u5bf9\u8868 A \u52a0\u8bfb\u9501\uff0c\u4e0d\u5141\u8bb8\u6267\u884c DML\uff08\u671f\u95f4\u8868 A \u53ea\u8bfb\uff09</li> <li>\u5728\u4e34\u65f6\u8868 B \u4e0a\u6267\u884c DDL \u6307\u5b9a\u7684\u64cd\u4f5c\uff08\u6bd4\u5982\u589e\u52a0\u548c\u5220\u9664\u5217\u7b49\uff09</li> <li>\u9010\u884c\u67e5\u51fa\u5c06\u8868 A \u4e2d\u7684\u6570\u636e\u67e5\u51fa\u6765\u5e76\u63d2\u5165\u5230\u8868 B</li> <li>\u5220\u9664\u8868 A</li> <li>\u5c06\u8868 B \u91cd\u547d\u540d\u4e3a A</li> </ol> <p>\u5728 2-4 \u7684\u8fc7\u7a0b\u4e2d\uff0c\u5982\u679c\u8868 A \u6570\u636e\u91cf\u6bd4\u8f83\u5927\uff0c\u62f7\u8d1d\u5230\u8868 B \u7684\u8fc7\u7a0b\u4f1a\u6d88\u8017\u5927\u91cf\u65f6\u95f4\uff0c\u5e76\u5360\u7528\u989d\u5916\u7684\u5b58\u50a8\u7a7a\u95f4\u3002\u6b64\u5916\uff0c\u7531\u4e8e DDL \u64cd\u4f5c\u5360\u7528\u4e86\u8868 A \u7684\u8bfb\u9501\uff0c\u6240\u4ee5\u8868 A \u4e0a\u7684 DDL \u548c DML \u90fd\u5c06\u963b\u585e\u65e0\u6cd5\u63d0\u4f9b\u670d\u52a1\u3002</p> <pre><code>ALTER TABLE table1 ADD COLUMN column1 int ALGORITHM=COPY;\n</code></pre>"},{"location":"dev/03.%E5%9C%A8%E7%BA%BFDDL/#inplace","title":"inplace \u7b97\u6cd5","text":"<p>\u5f53\u8868\u53d1\u751f DDL \u64cd\u4f5c\uff0c\u53ef\u80fd\u4f1a\u51fa\u73b0\u8be5\u8868\u683c\u6570\u5206\u949f\u751a\u81f3\u6570\u5c0f\u65f6\u4e0d\u53ef\u8bbf\u95ee\uff0c\u6027\u80fd\u53ca\u54cd\u5e94\u5f02\u5e38\uff0c\u4e3a\u4e86\u6709\u6548\u6539\u5584\u8fd9\u4e2a\u60c5\u51b5\uff0cMySQL \u5728 5.6.7 \u7248\u672c\u63a8\u51fa\u4e86<code>Online DDL</code>\u65b0\u7279\u6027\u3002</p> <p>\u6211\u4eec\u5e38\u8bf4\u7684 <code>Online DDL</code>\uff0c\u5176\u5b9e\u662f\u4ece DML \u64cd\u4f5c\u7684\u89d2\u5ea6\u63cf\u8ff0\u7684\uff0c\u5982\u679c DDL \u64cd\u4f5c\u4e0d\u963b\u585e DML\uff0c\u90a3\u4e48\u8fd9\u4e2a DDL \u5c31\u662f <code>Online</code> \u7684\u3002</p> <p>\u5728<code>Online DDL</code>\u4e2d\uff0c\u4e5f\u5305\u542b\u4e86<code>copy</code>\u8ddf<code>nplace</code>\u4e24\u79cd\u65b9\u5f0f\uff0c\u5bf9\u4e8e\u4e0d\u652f\u6301<code>Online DDL</code>\u7684<code>DDL SQL</code>\uff0c\u5219\u91c7\u7528 COPY \u65b9\u5f0f\uff1b\u5bf9\u4e8e\u652f\u6301 Online DDL \u7684 DDL SQL\uff0c\u5219\u91c7\u7528 Inplace \u65b9\u5f0f\uff0c\u8fd9\u91cc\u7684 Inplace \u53c8\u533a\u5206\u4e3a 2 \u7c7b\uff1a\u662f\u5426\u9700\u8981 rebuild \u8868\u683c\uff0c\u5224\u65ad\u6807\u51c6\u4e3a\uff1a\u662f\u5426\u4fee\u6539\u884c\u8bb0\u5f55\u683c\u5f0f\u3002</p> <ul> <li>\u5982\u679c\u4fee\u6539\u4e86\u884c\u8bb0\u5f55\u683c\u5f0f\uff0c\u5219\u9700\u8981 rebuild \u8868\u683c\uff0c\u6bd4\u5982\u4fee\u6539\u5217\u7c7b\u578b\u3001\u589e\u51cf\u5217\u7b49\uff1b</li> <li>\u5982\u679c\u6ca1\u6709\u4fee\u6539\u884c\u8bb0\u5f55\u683c\u5f0f\uff0c\u4ec5\u4fee\u6539\u8868\u7684\u5143\u6570\u636e\uff0c\u5219\u4e0d\u9700\u8981 rebuild \u8868\u683c\uff0c\u4ec5\u4fee\u6539\u5143\u6570\u636e metadata\uff0c\u6bd4\u5982\u5220\u9664\u7d22\u5f15\u3001\u8bbe\u7f6e\u9ed8\u8ba4\u503c\u53ca\u91cd\u547d\u540d\u5217\u540d\u7b49\u3002</li> </ul> <p>\u5b83\u7684\u8fc7\u7a0b\u548c\u4e0a\u9762\u7684 Copy \u7b97\u6cd5\u6709\u4e9b\u4e0d\u540c:</p> <ol> <li><code>Online DDL</code> \u8fc7\u7a0b\u4e2d\uff0c\u4ece\u8868 A \u63d0\u53d6 B+\u6811\uff0c\u5e76\u5b58\u50a8\u5230\u4e00\u4e2a\u4e2d\u95f4\u6587\u4ef6 tmp-file\uff0c\u800c\u4e0d\u662f\u4e2d\u95f4\u8868 tmp-A</li> <li>\u6b65\u9aa4 1 \u6267\u884c\u8fc7\u7a0b\u4e2d\uff0c\u5bf9\u8868 A \u7684\u5199\u5165\uff0c\u90fd\u4f1a\u8bb0\u5f55\u5230 row log \u4e2d</li> <li>\u6b65\u9aa4 1 \u6267\u884c\u5b8c\u6bd5\u540e\uff0c\u5bf9 tmp-file \u5e94\u7528\u6240\u6709\u7684 row log\uff0c\u5f97\u5230\u4e00\u4e2a\u4e0e\u8868 A \u6570\u636e\u76f8\u540c\u7684\u6570\u636e\u6587\u4ef6</li> <li>\u5229\u7528\u6570\u636e\u6587\u4ef6 tmp-file \u66ff\u6362\u8868 A \u7684\u6570\u636e\u6587\u4ef6\u5373\u53ef\u3002</li> </ol> <p>\u5e38\u7528\u7684 DDL \u90fd\u9ed8\u8ba4\u4f7f\u7528\u8fd9\u4e2a\u7b97\u6cd5\u3002inplace \u7b97\u6cd5\u5305\u542b\u4e24\u7c7b\uff1a<code>inplace-no-rebuild</code> \u548c <code>inplace-rebuild</code>\uff0c\u4e24\u8005\u7684\u4e3b\u8981\u5dee\u5f02\u5728\u4e8e\u662f\u5426\u9700\u8981\u91cd\u5efa\u6e90\u8868\u3002</p> <p>\u5b58\u50a8\u5f15\u64ce\u5c42\"\u5c31\u5730\"\u91cd\u5efa\u8868\uff0c\u867d\u7136\u4e0d\u963b\u585e DML \u64cd\u4f5c\uff0c\u4f46\u5bf9\u4e8e\u5927\u8868\u53d8\u66f4\u53ef\u80fd\u5bfc\u81f4\u957f\u65f6\u95f4\u7684\u4e3b\u4ece\u4e0d\u4e00\u81f4\u3002\u5bf9\u6b64\u7c7b DDL \u8bed\u53e5\uff0c\u5982\u679c\u60f3\u4f7f DDL \u8fc7\u7a0b\u66f4\u52a0\u53ef\u63a7\uff0c\u4e14\u5bf9\u4ece\u5e93\u5ef6\u8fdf\u6bd4\u8f83\u654f\u611f\uff0c\u5efa\u8bae\u4f7f\u7528\u7b2c\u4e09\u65b9\u5728\u7ebf\u6539\u8868\u5de5\u5177 ptosc \u5b8c\u6210\u3002</p>"},{"location":"dev/03.%E5%9C%A8%E7%BA%BFDDL/#instant-ddl","title":"INSTANT DDL","text":""},{"location":"dev/04.MySQL%E8%BF%9E%E8%A1%A8%E6%9F%A5%E8%AF%A2%E7%AE%97%E6%B3%95/","title":"\u8fde\u63a5\u67e5\u8be2","text":"<p>\u4e3a\u4ec0\u4e48\u6570\u636e\u5e93\u9700\u8981\u652f\u6301 JOIN\u3002\u8fd9\u4e2a\u95ee\u9898\uff0c\u751a\u81f3\u53ef\u4ee5\u518d\u9000\u4e00\u6b65\u5230\u4e3a\u4ec0\u4e48\u6570\u636e\u5e93\u9700\u8981\u6709\u591a\u4e2a\u8868\uff1f\u5176\u5b9e\u7b54\u6848\u5f88\u7b80\u5355\uff0c\u4e0a\u6587\u90fd\u63d0\u5230\u4e86\uff1a\u56e0\u4e3a\u73b0\u5b9e\u4e2d\u7684\u4e8b\u7269\u5c31\u662f\u590d\u6742\uff0c\u591a\u6837\u7684\u3002\u591a\u4e2a\u8868\u4e4b\u95f4\u7684\u5173\u7cfb\u80fd\u65b9\u4fbf\u5730\u548c\u73b0\u5b9e\u4e16\u754c\u7684\u4e8b\u7269\u6620\u5c04\u8d77\u6765\uff0c\u5e76\u4e14\u8fd9\u79cd\u6620\u5c04\u66f4\u76f4\u89c2\uff0c\u66f4\u80fd\u591f\u8ba9\u4eba\u63a5\u53d7\u3002\u5c31\u50cf\u9762\u5411\u5bf9\u8c61\u7f16\u7a0b\u4e00\u6837\uff0c\u6050\u6015\u6211\u4eec\u90fd\u4e0d\u80fd\u60f3\u8c61\u5982\u679c\u9762\u5411\u5bf9\u8c61\u7f16\u7a0b\u53ea\u80fd\u521b\u5efa\u4e00\u79cd\u7c7b\u578b\u7684\u5bf9\u8c61\u5427\u3002</p> <p>\u9664\u4e86\u65b9\u4fbf\u6620\u5c04\u5b9e\u7269\uff0c\u4e1a\u52a1\u903b\u8f91\u540c\u6837\u9700\u8981JOIN\u3002\u4e3e\u4e2a\u4f8b\u5b50\uff0c\u5047\u8bbe\u73b0\u5728\u6709\u4e2a\u7b80\u5355\u7684\u7535\u5546\u7cfb\u7edf\u6709\u4e70\u5bb6\uff0c\u5356\u5bb6\u548c\u8ba2\u5355\u4e09\u5f20\u8868\uff0c\u6570\u636e\u79d1\u5b66\u5bb6\u60f3\u8981\u67e5\u8be2 2018 \u5e74\uff0c\u5bf9\u4e8e\u4e0a\u6d77\u5ba2\u6237\u7684\u9500\u552e\u989d\u6700\u9ad8\u7684\u524d 3 \u4f4d\u5356\u5bb6\u4fe1\u606f\u3002\u8fd9\u4e48\u4e00\u4e2a\u7b80\u5355\u7684\u67e5\u8be2\u5176\u5b9e\u5c31\u7528\u5230\u4e86\u6bcf\u4e2a\u8868\u91cc\u7684\u4fe1\u606f\uff0c\u9700\u8981\u4ece\u4e70\u5bb6\u8868\u91cc\u5f97\u5230\u5356\u5bb6\u4fe1\u606f\uff0c\u4ece\u4e70\u5bb6\u8868\u91cc\u5f97\u5230\u5730\u5740\u662f\u4e0a\u6d77\u7684\u4e70\u5bb6 ID\uff0c\u7136\u540e\u5bf9\u8ba2\u5355\u8868\u4ee5\u5356\u5bb6 ID \u505a\u7ec4\u961f\u805a\u5408\uff0c\u6700\u540e\u5bf9\u9500\u552e\u603b\u989d\u8fdb\u884c\u6392\u5e8f\u5e76\u53d6\u524d\u4e09</p> <p>\u5199\u8fc7\u6216\u8005\u5b66\u8fc7 SQL \u7684\u4eba\u5e94\u8be5\u90fd\u77e5\u9053 <code>left join</code>\uff0c\u77e5\u9053 <code>left join</code> \u7684\u5b9e\u73b0\u7684\u6548\u679c\uff0c\u5c31\u662f\u4fdd\u7559\u5de6\u8868\u7684\u5168\u90e8\u4fe1\u606f\uff0c\u7136\u540e\u628a\u53f3\u8868\u5f80\u5de6\u8868\u4e0a\u62fc\u63a5\uff0c\u5982\u679c\u62fc\u4e0d\u4e0a\u5c31\u662f null\u3002</p> <p>\u9664\u4e86 <code>left join</code> \u4ee5\u5916\uff0c\u8fd8\u6709 <code>inner join</code>\u3001<code>outer join</code>\u3001<code>right join</code>\uff0c\u8fd9\u4e9b\u4e0d\u540c\u7684 join \u80fd\u8fbe\u5230\u7684\u4ec0\u4e48\u6837\u7684\u6548\u679c\uff0c\u5927\u5bb6\u5e94\u8be5\u90fd\u4e86\u89e3\u4e86\uff0c\u5982\u679c\u4e0d\u4e86\u89e3\u7684\u53ef\u4ee5\u770b\u770b\u7f51\u4e0a\u7684\u5e16\u5b50\u6216\u8005\u968f\u4fbf\u4e00\u672c SQL \u4e66\u90fd\u6709\u8bb2\u7684\u3002</p> <p>\u5c1d\u8bd5\u60f3\u4e00\u60f3\uff0c\u5982\u679c\u4f60\u662fMySQL\u5f00\u53d1\u8005\uff0c\u4f60\u4f1a\u600e\u4e48\u505a\u8fde\u8868\u67e5\u8be2\u7684\uff0c\u5177\u4f53\u5e94\u8be5\u7528\u4ec0\u4e48\u7b97\u6cd5\u5b9e\u73b0\u3002\u662f\u4e00\u6b21\u6027\u628a\u4e24\u4e2a\u8868\u5168\u90e8load\u5230\u5185\u5b58\uff0c\u518d\u53bb\u8fdb\u884c\u5173\u8054\u5339\u914d\u5417\uff1f</p> <p>MySQL \u7684 join \u6709\u8bf8\u591a\u89c4\u5219\uff0c\u53ef\u80fd\u7a0d\u6709\u4e0d\u614e\uff0c\u53ef\u80fd\u4e00\u4e2a\u4e0d\u597d\u7684 join \u8bed\u53e5\u4e0d\u4ec5\u4f1a\u5bfc\u81f4\u5bf9\u67d0\u4e00\u5f20\u8868\u7684\u5168\u8868\u67e5\u8be2\uff0c\u8fd8\u6709\u53ef\u80fd\u4f1a\u5f71\u54cd\u6570\u636e\u5e93\u7684\u7f13\u5b58\uff0c\u5bfc\u81f4\u5927\u90e8\u5206\u70ed\u70b9\u6570\u636e\u90fd\u88ab\u66ff\u6362\u51fa\u53bb\uff0c\u62d6\u7d2f\u6574\u4e2a\u6570\u636e\u5e93\u6027\u80fd\u3002</p> <p>join \u4e3b\u8981\u6709 <code>Nested Loop</code>\u3001<code>Hash Join</code>\u3001<code>Merge Join</code> \u8fd9\u4e09\u79cd\u65b9\u5f0f\uff0c\u6211\u4eec\u8fd9\u91cc\u53ea\u8bb2\u6700\u666e\u904d\u7684\uff0c\u4e5f\u662f\u6700\u597d\u7684\u7406\u89e3\u7684 <code>Nested Loop join</code> \u3002</p> <p><code>Nested Loop join</code> \u7ffb\u8bd1\u8fc7\u6765\u5c31\u662f \u5d4c\u5957\u5faa\u73af\u8fde\u63a5 \u7684\u610f\u601d\uff0c\u90a3\u4ec0\u4e48\u53c8\u662f\u5d4c\u5957\u5faa\u73af\u5462\uff1f\u5d4c\u5957\u5927\u5bb6\u5e94\u8be5\u90fd\u80fd\u7406\u89e3\uff0c\u5c31\u662f\u4e00\u5c42\u5957\u4e00\u5c42\uff1b\u90a3\u5faa\u73af\u5462\uff0c\u4f60\u53ef\u4ee5\u7406\u89e3\u6210\u662f for \u5faa\u73af\u3002</p> <p><code>Nested Loop</code> \u91cc\u9762\u53c8\u6709\u4e09\u79cd\u7ec6\u5206\u7684\u8fde\u63a5\u65b9\u5f0f\uff0c\u5206\u522b\u662f <code>Simple Nested-Loop Join</code>\u3001Index Nested-Loop Join\u3001Block Nested-Loop Join\uff0c\u63a5\u4e0b\u6765\u6211\u4eec\u5c31\u5206\u522b\u53bb\u770b\u4e00\u4e0b\u8fd9\u4e09\u79cd\u7ec6\u5206\u7684\u8fde\u63a5\u65b9\u5f0f\u3002</p> <p>\u5728\u6b63\u5f0f\u5f00\u59cb\u4e4b\u524d\uff0c\u5148\u4ecb\u7ecd\u4e24\u4e2a\u6982\u5ff5\uff1a</p> <p>MySQL\u7684\u8fde\u63a5\u67e5\u8be2\u6d89\u53ca\u5230\u4e24\u5f20\u8868\u7684\u5173\u8054\uff0c\u65e2\u7136\u6d89\u53ca\u5230\u4e24\u5f20\u8868\u7684\u5173\u8054\u90a3\u4e48\u5c31\u9700\u8981\u4e00\u5b9a\u7684\u7b97\u6cd5\u6765\u7ec4\u7ec7\u6570\u636e\u3002\u5173\u8054\u7684\u4e24\u5f20\u8868\uff0c\u4e00\u4e2a\u53eb\u505a\u9a71\u52a8\u8868\uff0c\u4e00\u4e2a\u53eb\u505a\u88ab\u9a71\u52a8\u8868\u3002 \u2003 \u73b0\u5728\u6709\u4e86\u4e24\u5f20\u8868\uff0c\u603b\u8981\u6709\u4e00\u5f20\u8868\u5148\u88ab\u67e5\u8be2\uff0c\u7136\u540e\u4ee5\u6b64\u7ed3\u679c\u518d\u53bb\u5173\u8054\u53e6\u4e00\u5f20\u8868\u3002\u8fd9\u4e2a\u7b2c\u4e00\u5f20\u8868\u5c31\u88ab\u79f0\u4e3a \u9a71\u52a8\u8868\uff08\u4e5f\u53eb\u5916\u8868\uff0c\u4e3b\u8868\uff09 \uff0c\u7b2c\u4e8c\u5f20\u8868\u5c31\u79f0\u4e3a \u88ab\u9a71\u52a8\u8868\uff08\u4e5f\u53eb\u5185\u8868\uff0c\u526f\u8868\uff09 \uff0c\u4e00\u822c\u6211\u4eec\u90fd\u8981\u4ee5\u67e5\u8be2\u7ed3\u679c\u96c6\u76f8\u5bf9\u5c0f\u7684\u90a3\u5f20\u8868\u4f5c\u4e3a\u9a71\u52a8\u8868\u3002</p> <p>\u9a71\u52a8\u8868\u7684\u9009\u62e9</p> <p>\u4e00\u4e2a\u8868\u7684\u67e5\u8be2\u7ed3\u679c\u96c6\u4e3b\u8981\u662f\u901a\u8fc7where\u6761\u4ef6\u9884\u4f30\u8fd4\u56de\u7684\u6761\u6570\u548c\u8be5\u8868\u9700\u8981\u8fd4\u56de\u7684\u5b57\u6bb5\u6765\u8fdb\u884c\u8ba1\u7b97\u3002\u5f53\u7136\uff0c\u9884\u4f30\u8fd4\u56de\u6761\u6570\u4e0d\u4f1a\u771f\u6b63\u53bb\u505a\u67e5\u8be2\u52a8\u4f5c\uff0c\u5982\u679c\u6761\u4ef6\u6709\u7d22\u5f15\uff0c\u90a3\u4e48\u53ef\u4ee5\u6839\u636e\u7d22\u5f15\u6765\u9884\u4f30\u6761\u6570\uff1b \u5982\u679c\u6ca1\u6cd5\u7528\u7d22\u5f15\uff0c\u6216\u8005\u76f4\u63a5\u6ca1\u6709\u6761\u4ef6\uff0c\u5c31\u8ba4\u4e3a\u662f\u5168\u8868\u3002\u4e0d\u8fc7\u67e5\u8be2\u4f18\u5316\u5668\u6700\u7ec8\u4f1a\u57fa\u4e8e\u6210\u672c\u8ba1\u7b97\u6765\u8fdb\u884c\u8bc4\u4f30\uff0c\u50cf\u6392\u5e8f\u3001\u56de\u8868\u7b49\u90fd\u4f1a\u5bf9\u6210\u672c\u6709\u5f71\u54cd\uff0c\u6700\u7ec8SQL\u5982\u4f55\u6267\u884c\u8fd8\u662f\u8981\u770b\u67e5\u8be2\u4f18\u5316\u5668\u5982\u4f55\u6289\u62e9\u3002</p> <p>\u5177\u4f53\u67e5\u8be2\u7b97\u6cd5\uff1a</p> <ul> <li>\u9a71\u52a8\u8868\uff0c\u5728\u4e00\u6b21\u8fde\u63a5\u67e5\u8be2\u4e2d\uff0c\u5148\u4ece \u9a71\u52a8\u8868 \u4e2d\u9010\u884c\u53d6\u51fa\u6570\u636e\u3002</li> <li>\u7136\u540e\u6839\u636e\u8fde\u63a5\u5b57\u6bb5\uff0c\u53bb\u76f8\u5e94\u7684 \u88ab\u9a71\u52a8\u8868 \u4e2d\u9010\u884c\u67e5\u8be2\u5339\u914d\u3002</li> <li>\u5c06\u67e5\u8be2\u5230\u7684\u7ed3\u679c\u8f93\u51fa\u3002</li> </ul> <p>\u4e00\u4e2a\u662f\u9a71\u52a8\u8868\uff0c\u90a3\u53e6\u4e00\u4e2a\u5c31\u53ea\u80fd\u662f\u975e\u9a71\u52a8\u8868\u4e86\uff0c\u5728 join \u7684\u8fc7\u7a0b\u4e2d\uff0c\u5176\u5b9e\u5c31\u662f\u4ece\u9a71\u52a8\u8868\u91cc\u9762\u4f9d\u6b21\uff08\u6ce8\u610f\u7406\u89e3\u8fd9\u91cc\u9762\u7684\u4f9d\u6b21\uff09\u53d6\u51fa\u6bcf\u4e00\u4e2a\u503c\uff0c\u7136\u540e\u53bb\u975e\u9a71\u52a8\u8868\u91cc\u9762\u8fdb\u884c\u5339\u914d\uff0c\u90a3\u5177\u4f53\u662f\u600e\u4e48\u5339\u914d\u7684\u5462\uff1f\u8fd9\u5c31\u662f\u6211\u4eec\u63a5\u4e0b\u6765\u8bb2\u7684\u8fd9\u4e09\u79cd\u8fde\u63a5\u65b9\u5f0f\u3002</p>"},{"location":"dev/04.MySQL%E8%BF%9E%E8%A1%A8%E6%9F%A5%E8%AF%A2%E7%AE%97%E6%B3%95/#simple-nested-loop-join","title":"Simple Nested-Loop Join","text":"<p>Simple Nested-Loop Join \u662f\u8fd9\u4e09\u79cd\u65b9\u6cd5\u91cc\u9762\u6700\u7b80\u5355\uff0c\u6700\u597d\u7406\u89e3\uff0c\u4e5f\u662f\u6700\u7b26\u5408\u5927\u5bb6\u8ba4\u77e5\u7684\u4e00\u79cd\u8fde\u63a5\u65b9\u5f0f\uff0c\u73b0\u5728\u6709\u4e24\u5f20\u8868 t1 \u548c t2 \uff0c\u6211\u4eec\u8ba9 table t1 join table t2\uff0c\u5982\u679c\u662f\u7528\u7b2c\u4e00\u79cd\u8fde\u63a5\u65b9\u5f0f\u53bb\u5b9e\u73b0\u7684\u8bdd\uff0c\u4f1a\u662f\u600e\u4e48\u53bb\u5339\u914d\u7684\u5462\uff1f</p> <pre><code>//\u4f2a\u4ee3\u7801\u8868\u793a\u5982\u4e0b\uff1a\nList&lt;Row&gt; result = new ArrayList&lt;&gt;();\nfor(Row r1 in List&lt;Row&gt; t1){\n    for(Row r2 in List&lt;Row&gt; t2){\n        if(r1.id = r2.tid){\n            result.add(r1.join(r2));\n        }\n    }\n}\n</code></pre> <p>\u8fd9\u79cd join \u4f1a\u4ece\u9a71\u52a8\u8868 t1 \u4e2d \u4f9d\u6b21\u53d6\u51fa \u6bcf\u4e00\u4e2a\u503c\u3002\uff08\u5728\u7b2c\u4e00\u4e2a\u5faa\u73af\u4e2d\uff09</p> <p>\u7136\u540e\u53bb\u975e\u9a71\u52a8\u8868 t2 \u4e2d\u4ece \u4e0a\u5f80\u4e0b\u4f9d\u6b21\u5339\u914d \uff0c\u7136\u540e\u628a\u5339\u914d\u5230\u7684\u503c\u8fdb\u884c\u8fd4\u56de\uff0c\u6700\u540e\u628a\u6240\u6709\u8fd4\u56de\u503c\u8fdb\u884c\u5408\u5e76\uff0c\u8fd9\u6837\u6211\u4eec\u5c31\u67e5\u627e\u5230\u4e86 t1 left join t2 \u7684\u7ed3\u679c\u3002</p> <p>\u8fde\u63a5\u53cc\u65b9\u5728\u8fde\u63a5\u5b57\u6bb5\u4e0a\u90fd\u6ca1\u6709\u7d22\u5f15\uff0c\u6240\u4ee5\u6b64\u7b97\u6cd5\u6ca1\u6709\u4ec0\u4e48\u5957\u8def\uff0c\u4ece\u9a71\u52a8\u8868\u53d6\u51fa\u8bb0\u5f55\uff0c\u6309\u7167join\u7684\u6761\u4ef6\u5728\u88ab\u9a71\u52a8\u8868\u4e2d\u67e5\u8be2\uff0c\u627e\u5230\u53ef\u8fde\u63a5\u7684\u8bb0\u5f55\uff0c\u628a\u6570\u636e\u8fde\u63a5\u5e76\u8fd4\u56de\u3002</p> <p>\u5229\u7528\u8fd9\u79cd\u65b9\u6cd5\uff0c\u5982\u679c  t1 \u6709 100 \u884c\uff0ct2 \u6709 100 \u884c\uff0c\u603b\u5171\u9700\u8981\u6267\u884c 100 x 100 = 10000 \u6b21\u67e5\u627e</p> <p>\u8fd9\u79cd\u66b4\u529b\u5339\u914d\u65b9\u5f0f\u7684\u6548\u7387\u662f\u5f88\u4f4e\u7684\uff0c\u5bf9\u6570\u636e\u5e93\u7684\u5f00\u9500\u6bd4\u8f83\u5927\uff0c\u5c24\u5176\u662f\u88ab\u9a71\u52a8\u8868\u3002\u6bcf\u4e00\u6b21\u626b\u63cf\u5176\u5b9e\u5c31\u662f\u4ece\u786c\u76d8\u4e2d\u8bfb\u53d6\u6570\u636e\u52a0\u8f7d\u5230\u5185\u5b58\u4e2d,\u4e5f\u5c31\u662f\u4e00\u6b21IO\uff0c\u76ee\u524dIO\u662f\u6700\u5927\u7684\u74f6\u9888\u3002</p> <pre><code>-- \u5728\u5b9e\u9645 inner join \u4e2d\uff0c\u4f18\u5316\u5668\u4f1a\u81ea\u52a8\u9009\u53d6\u6570\u91cf\u5c0f\u7684\u8868\u505a\u4e3a\u9a71\u52a8\u8868\n-- \u9a71\u52a8\u8868\u662f t2\uff0c\u88ab\u9a71\u52a8\u8868\u662f t1\n-- \u5148\u6267\u884c\u67e5\u627e\u7684\u5c31\u662f\u9a71\u52a8\u8868(\u6267\u884c\u8ba1\u5212\u7ed3\u679c\u7684id\u5982\u679c\u4e00\u6837\u5219\u6309\u4ece\u4e0a\u5230\u4e0b\u987a\u5e8f\u6267\u884csql);\n\n\n-- \u4f18\u5316\u5668\u4e00\u822c\u4f1a\u4f18\u5148\u9009\u62e9\u5c0f\u8868\u505a\u9a71\u52a8\u8868\u3002\u6240\u4ee5\u4f7f\u7528 inner join \u65f6\uff0c\u6392\u5728\u524d\u9762\u7684\u8868\u5e76\u4e0d\u4e00\u5b9a\u5c31\u662f\u9a71\u52a8\u8868\u3002\n-- \u4f7f\u7528\u4e86 NLJ \u7b97\u6cd5\u3002\u4e00\u822c join \u8bed\u53e5\u4e2d\uff0c\u5982\u679c\u6267\u884c\u8ba1\u5212 Extra \u4e2d\u672a\u51fa\u73b0 Using join buffer \u5219\u8868\u793a\u4f7f\u7528\u7684 join \u7b97\u6cd5\u662f NLJ\nselect * from t1 inner join t2 on t1.id=t2.tid\n\n-- \u4ece\u8868 t2 \u4e2d\u8bfb\u53d6\u4e00\u884c\u6570\u636e(\u5982\u679ct2\u8868\u6709\u67e5\u8be2\u8fc7\u6ee4\u6761\u4ef6\u7684\uff0c\u4f1a\u4ece\u8fc7\u6ee4\u7ed3\u679c\u91cc\u53d6\u51fa\u4e00\u884c\u6570\u636e);\n</code></pre>"},{"location":"dev/04.MySQL%E8%BF%9E%E8%A1%A8%E6%9F%A5%E8%AF%A2%E7%AE%97%E6%B3%95/#index-nested-loop-join","title":"Index Nested-Loop Join","text":"<p>Index Nested-Loop Join  \u7ffb\u8bd1\u6210\u4e2d\u6587\u53eb \u7d22\u5f15\u5d4c\u5957\u5faa\u73af\u8fde\u63a5\u67e5\u8be2</p> <p>join \u67e5\u8be2\u7684\u4f18\u5316\u601d\u8def\u5c31\u662f\u5c0f\u8868\u9a71\u52a8\u5927\u8868\uff0c\u800c\u4e14\u5728\u5927\u8868\u4e0a\u521b\u5efa\u7d22\u5f15(\u4e5f\u5c31\u662f\u88ab\u9a71\u52a8\u8868\u521b\u5efa\u7d22\u5f15)\uff0c\u5982\u679c\u9a71\u52a8\u8868\u521b\u5efa\u4e86\u7d22\u5f15\uff0cMySQL\u662f\u4e0d\u4f1a\u4f7f\u7528\u7684\u3002</p> <p>\u8fd9\u4e2aIndex\u662f\u8981\u6c42\u975e\u9a71\u52a8\u8868\u4e0a\u8981\u6709\u7d22\u5f15\uff0c\u6709\u4e86\u7d22\u5f15\u4ee5\u540e\u5bf9\u4e8e\u5916\u8868\u7684\u67e5\u8be2\u53ef\u4ee5\u51cf\u5c11\u67e5\u8be2\u6b21\u6570\uff0c\u5339\u914d\u6b21\u6570\u51cf\u5c11\u4e86\u5c31\u53ef\u4ee5\u63d0\u9ad8\u67e5\u8be2\u7684\u6548\u7387\u4e86\u3002</p> <p>\u7d22\u5f15\u5d4c\u5957\u5faa\u73af\u8fde\u63a5\u662f\u57fa\u4e8e\u7d22\u5f15\u8fdb\u884c\u8fde\u63a5\u7684\u7b97\u6cd5\uff0c\u7d22\u5f15\u662f\u57fa\u4e8e\u5185\u5c42\u7684\u88ab\u9a71\u52a8\u8868\u7684\uff0c\u901a\u8fc7\u5916\u5c42\u8868\u5339\u914d\u6761\u4ef6\u76f4\u63a5\u4e0e\u5185\u5c42\u8868\u7d22\u5f15\u5217\u8fdb\u884c\u5339\u914d\uff0c\u907f\u514d\u548c\u5185\u5c42\u8868\u7684\u6bcf\u6761\u8bb0\u5f55\u8fdb\u884c\u6bd4\u8f83\uff0c\u4ece\u800c\u5229\u7528\u7d22\u5f15\u7684\u67e5\u8be2\u51cf\u5c11\u4e86\u5bf9\u5185\u5c42\u8868\u7684\u5339\u914d\u6b21\u6570\uff0c\u4f18\u52bf\u6781\u5927\u7684\u63d0\u5347\u4e86join\u7684\u6027\u80fd\uff1a</p> <p>\u539f\u6765\u7684\u5339\u914d\u6b21\u6570 = \u5916\u5c42\u8868\u884c\u6570 * \u5185\u5c42\u8868\u884c\u6570 \u4f18\u5316\u540e\u7684\u5339\u914d\u6b21\u6570= \u5916\u5c42\u8868\u7684\u884c\u6570 * \u5185\u5c42\u8868\u7d22\u5f15\u7684\u9ad8\u5ea6</p> <ol> <li>\u4f7f\u7528\u573a\u666f\uff1a\u53ea\u6709\u5185\u5c42\u8868join\u7684\u5217\u6709\u7d22\u5f15\u65f6\uff0c\u624d\u80fd\u7528\u5230Index Nested-LoopJoin\u8fdb\u884c\u8fde\u63a5\u3002</li> <li>\u7531\u4e8e\u7528\u5230\u7d22\u5f15\uff0c\u5982\u679c\u7d22\u5f15\u662f\u8f85\u52a9\u7d22\u5f15\uff0c\u5e76\u4e14\u8fd4\u56de\u7684\u6570\u636e\u8fd8\u5305\u62ec\u5185\u5c42\u8868\u7684\u5176\u4ed6\u6570\u636e\uff0c\u5219\u4f1a\u56de\u5185\u5c42\u8868\u67e5\u8be2\u6570\u636e\uff0c\u591a\u4e86\u4e00\u4e9bIO\u64cd\u4f5c\u3002</li> </ol> <pre><code>select * from t1 straight_join t2 on (t1.a=t2.a);\n\n-- \u88ab\u9a71\u52a8\u8868t2\u7684\u5b57\u6bb5a\u4e0a\u6709\u7d22\u5f15\uff0cjoin\u8fc7\u7a0b\u7528\u4e0a\u4e86\u8fd9\u4e2a\u7d22\u5f15\n\n-- \u4ece\u8868t1\u4e2d\u8bfb\u5165\u4e00\u884c\u6570\u636e R\uff1b\n-- \u4ece\u6570\u636e\u884cR\u4e2d\uff0c\u53d6\u51faa\u5b57\u6bb5\u5230\u8868t2\u91cc\u53bb\u67e5\u627e\uff1b\n-- \u53d6\u51fa\u8868t2\u4e2d\u6ee1\u8db3\u6761\u4ef6\u7684\u884c\uff0c\u8ddfR\u7ec4\u6210\u4e00\u884c\uff0c\u4f5c\u4e3a\u7ed3\u679c\u96c6\u7684\u4e00\u90e8\u5206\uff1b\n-- \u91cd\u590d\u6267\u884c\u6b65\u9aa41\u52303\uff0c\u76f4\u5230\u8868t1\u7684\u672b\u5c3e\u5faa\u73af\u7ed3\u675f\u3002\n</code></pre>"},{"location":"dev/04.MySQL%E8%BF%9E%E8%A1%A8%E6%9F%A5%E8%AF%A2%E7%AE%97%E6%B3%95/#block-nested-loop-join","title":"Block Nested Loop Join","text":"<p>BNL\u662f\u57fa\u4e8e\u5757\u7684\u5d4c\u5957\u5faa\u73af\u8fde\u63a5 Block Nested Loop Join \u7b97\u6cd5\uff08BNL\uff09\uff0c\u5177\u4f53\u5b9e\u73b0\u5927\u6982\u5982\u4e0b\uff1a</p> <p>\u628a\u9a71\u52a8\u8868\u7684\u6570\u636e\u8bfb\u5165\u5230 join_buffer \u4e2d\uff0c\u7136\u540e\u626b\u63cf\u88ab\u9a71\u52a8\u8868\uff0c\u628a\u88ab\u9a71\u52a8\u8868\u6bcf\u4e00\u884c\u53d6\u51fa\u6765\u8ddf join_buffer \u4e2d\u7684\u6570\u636e\u505a\u5bf9\u6bd4\u3002</p> <pre><code>explain select * from t1 inner join t2 on t1.b= t2.b;\n--\u67e5\u8be2\u8ba1\u5212\u4e2d\u7684 extra \u7684\u7c7b\u578b\u662f Using join buffer (Block Nested Loop) \u5219\u8bf4\u660e\u4f7f\u7528\u4e86BNL\u7b97\u6cd5\n\n-- \u8fd9\u6bb5sql\u7684\u5927\u81f4\u6d41\u7a0b\u5982\u4e0b:\n-- 1.\u628a t2 \u7684\u6240\u6709\u6570\u636e\u653e\u5165\u5230 join_buffer \u4e2d\n-- 2.\u628a\u8868 t1 \u4e2d\u6bcf\u4e00\u884c\u53d6\u51fa\u6765\uff0c\u8ddf join_buffer \u4e2d\u7684\u6570\u636e\u505a\u5bf9\u6bd4 \n-- 3. \u8fd4\u56de\u6ee1\u8db3 join \u6761\u4ef6\u7684\u6570\u636e\n\n-- \u4e00\u6b21\u5229\u7528join_buffer_size\u7f13\u5b58\u8db3\u591f\u591a\u7684\u8bb0\u5f55\uff0c\u6bcf\u6b21\u904d\u5386\u5185\u8868\u65f6\uff0c\u6bcf\u6761\u5185\u8868\u8bb0\u5f55\u4e0e\u8fd9\u4e00\u6279\u6570\u636e\u8fdb\u884c\u6761\u4ef6\u5224\u65ad\uff0c\u8fd9\u6837\u5c31\u51cf\u5c11\u4e86\u626b\u63cf\u5185\u8868\u7684\u6b21\u6570\uff0c\u5982\u679c\u5185\u8868\u6bd4\u8f83\u5927\uff0c\u95f4\u63a5\u5c31\u7f13\u89e3\u4e86IO\u7684\u8bfb\u538b\u529b\u3002\n</code></pre> <p>\u6574\u4e2a\u8fc7\u7a0b\u5bf9\u8868 t1 \u548c t2 \u90fd\u505a\u4e86\u4e00\u6b21\u5168\u8868\u626b\u63cf\uff0c\u56e0\u6b64\u626b\u63cf\u7684\u603b\u884c\u6570\u4e3a10000(\u8868 t1 \u7684\u6570\u636e\u603b\u91cf) + 100(\u8868 t2 \u7684\u6570\u636e\u603b\u91cf) = 10100\u3002</p> <p>\u5e76\u4e14 join_buffer \u5e95\u5c42\u662f\u4e00\u4e2a\u65e0\u5e8f\u6570\u7ec4\uff0c\u91cc\u7684\u6570\u636e\u662f\u65e0\u5e8f\u7684\uff0c\u56e0\u6b64\u5bf9\u8868 t1 \u4e2d\u7684\u6bcf\u4e00\u884c\uff0c\u90fd\u8981\u505a 100 \u6b21\u5224\u65ad\uff0c\u6240\u4ee5\u5185\u5b58\u4e2d\u7684\u5224\u65ad\u6b21\u6570\u662f 100 * 10000= 100 \u4e07\u6b21\u3002</p> <p>\u8fd9\u4e2a\u4f8b\u5b50\u91cc\u8868 t2 \u624d 100 \u884c\uff0c\u8981\u662f\u8868 t2 \u4e5f\u670910000\u6761\u8bb0\u5f55\uff0c\u662f\u4e2a\u5927\u8868\uff0cjoin_buffer \u653e\u4e0d\u4e0b\u600e\u4e48\u529e\u5462?</p> <p>join_buffer \u7684\u5927\u5c0f\u662f\u7531\u53c2\u6570 join_buffer_size \u8bbe\u5b9a\u7684\uff0c\u9ed8\u8ba4\u503c\u662f 256k\u3002\u5982\u679c\u653e\u4e0d\u4e0b\u8868 t2 \u7684\u6240\u6709\u6570\u636e\u8bdd\uff0c\u7b56\u7565\u5f88\u7b80\u5355\uff0c \u5c31\u662f\u5206\u6bb5\u653e\u3002</p> <p>\u6bd4\u5982 t2 \u8868\u6709 1000 \u884c\u8bb0\u5f55\uff0c join_buffer \u4e00\u6b21\u53ea\u80fd\u653e 800 \u884c\u6570\u636e\uff0c\u90a3\u4e48\u6267\u884c\u8fc7\u7a0b\u5c31\u662f\u5148\u5f80 join_buffer \u91cc\u653e 800 \u884c\u8bb0\u5f55\uff0c\u7136 \u540e\u4ece t1 \u8868\u91cc\u53d6\u6570\u636e\u8ddf join_buffer \u4e2d\u6570\u636e\u5bf9\u6bd4\u5f97\u5230\u90e8\u5206\u7ed3\u679c\u3002</p> <p>\u7136\u540e\u6e05\u7a7a join_buffer \uff0c\u518d\u653e\u5165 t2 \u8868\u5269\u4f59 200 \u884c\u8bb0\u5f55\uff0c\u518d \u6b21\u4ece t1 \u8868\u91cc\u53d6\u6570\u636e\u8ddf join_buffer \u4e2d\u6570\u636e\u5bf9\u6bd4\u3002\u6240\u4ee5\u5c31\u591a\u626b\u4e86\u4e00\u6b21 t1 \u8868\u3002</p> <p>\u88ab\u9a71\u52a8\u8868\u7684\u5173\u8054\u5b57\u6bb5\u6ca1\u7d22\u5f15\u4e3a\u4ec0\u4e48\u8981\u9009\u62e9\u4f7f\u7528 BNL \u7b97\u6cd5\u800c\u4e0d\u4f7f\u7528 Nested-Loop Join \u5462?</p> <p>\u9488\u5bf9\u8fd9\u79cd\u60c5\u51b5\uff0c\u5982\u679c\u4f7f\u7528 Nested-Loop Join \u7b97\u6cd5\uff0c\u90a3\u4e48\u626b\u63cf\u884c\u6570\u4e3a 100 * 10000 = 100\u4e07\u6b21\uff0c\u8fd9\u4e2a\u662f\u78c1\u76d8\u626b\u63cf\u3002</p> <p>\u5f88\u663e\u7136\uff0c\u7528BNL\u78c1\u76d8\u626b\u63cf\u6b21\u6570\u5c11\u5f88\u591a\uff0c\u76f8\u6bd4\u4e8e\u78c1\u76d8\u626b\u63cf\uff0cBNL\u7684\u5185\u5b58\u8ba1\u7b97\u4f1a\u5feb\u5f97\u591a\u3002 \u56e0\u6b64MySQL\u5bf9\u4e8e\u88ab\u9a71\u52a8\u8868\u7684\u5173\u8054\u5b57\u6bb5\u6ca1\u7d22\u5f15\u7684\u5173\u8054\u67e5\u8be2\uff0c\u4e00\u822c\u90fd\u4f1a\u4f7f\u7528 BNL \u7b97\u6cd5\u3002</p> <p>\u5982\u679c\u6709\u7d22\u5f15\u4e00\u822c\u9009\u62e9 NLJ \u7b97\u6cd5\uff0c\u6709 \u7d22\u5f15\u7684\u60c5\u51b5\u4e0b NLJ \u7b97\u6cd5\u6bd4 BNL\u7b97\u6cd5\u6027\u80fd\u66f4\u9ad8</p> <p>\u4eceMySQL-8.0.20\u5f00\u59cb\uff0cBNL\u5df2\u7ecf\u88ab\u79fb\u9664\u3002\u4f7f\u7528hash join\u66ff\u4ee3\u4e4b\u3002</p> <p>\u603b\u7ed3</p> <ul> <li>\u5d4c\u5957\u5faa\u73af\u8fde\u63a5\uff08NJL\uff09\u7b97\u6cd5**\u662f\u9a71\u52a8\u8868\u548c\u88ab\u9a71\u52a8\u8868\u5747\u5728**\u78c1\u76d8\u4e2d\u8fdb\u884c\u5339\u914d\uff0c\u78c1\u76d8\u8bfb\u5199\u6027\u80fd\u5dee\u3002</li> <li>\u57fa\u4e8e\u5757\u7684\u5d4c\u5957\u5faa\u73af\u8fde\u63a5\uff08BNL\uff09\u7b97\u6cd5\uff0c\u5f15\u5165\u4e86\u4e00\u4e2ajoin_buffer\u7684\u5185\u5b58\u533a\u57df\uff0c\u4f7f\u5f97\u5927\u91cf\u7684\u8ba1\u7b97\u632a\u5230\u5185\u5b58\u4e2d\u8fdb\u884c\uff0c\u5185\u5b58\u6027\u80fd\u8fdc\u8fdc\u5927\u4e8e\u78c1\u76d8\uff0c\u6240\u4ee5\u6574\u4f53\u6027\u80fd\u63d0\u5347\u6bd4\u8f83\u5927\u3002</li> <li>\u6574\u4f53\u601d\u8def\u8fd8\u662f\u7528\u5185\u5b58\u64cd\u4f5c\u66ff\u4ee3\u78c1\u76d8\u64cd\u4f5c\u4ee5\u63d0\u9ad8\u6027\u80fd\u3002</li> <li>\u8868\u8fde\u63a5\u5b57\u6bb5\u6709\u7d22\u5f15\u7684SQL\u626b\u63cf\u7684\u884c\u6570\u8fdc\u8fdc\u5c0f\u4e8e\u8868\u8fde\u63a5\u5b57\u6bb5\u7684\u626b\u63cf\u884c\u6570\uff0c\u6240\u4ee5**\u8868\u8fde\u63a5\u5c3d\u91cf\u7ed9\u8fde\u63a5\u5b57\u6bb5\u52a0\u7d22\u5f15\u3002**</li> <li>\u4f7f\u7528\u5c0f\u8868\u9a71\u52a8\u5927\u8868\uff0c\u53ef\u4ee5\u4f7f\u7528 straight_join \u6307\u5b9a\u9a71\u52a8\u8868\uff08\u5176\u5b9e\u6709\u4e9b\u9e21\u808b\u7684\uff0cinner join MySQL\u7684\u67e5\u8be2\u4f18\u5316\u5668\u4f1a\u81ea\u52a8\u9009\u62e9\u5c0f\u8868\u505a\u9a71\u52a8\uff0cleft join \u548c right join \u5b9e\u9645\u5df2\u7ecf\u6307\u5b9a\u4e86\u9a71\u52a8\u8868\uff09</li> <li>\u5c3d\u53ef\u80fd\u8ba9\u4f18\u5316\u5668\u53bb\u5224\u65ad\uff0c\u56e0\u4e3a\u5927\u90e8\u5206\u60c5\u51b5\u4e0bmysql\u4f18\u5316\u5668\u662f\u6bd4\u4eba\u8981\u806a\u660e\u7684\u3002\u4f7f\u7528 straight_join \u4e00\u5b9a\u8981\u614e\u91cd\uff0c\u56e0\u4e3a\u5927\u90e8\u5206\u60c5\u51b5\u4e0b\u4eba\u4e3a\u6307\u5b9a\u7684\u6267\u884c\u987a\u5e8f\u5e76\u4e0d\u4e00\u5b9a\u4f1a\u6bd4\u4f18\u5316\u5f15\u64ce\u8981\u9760\u8c31\u3002</li> </ul>"},{"location":"dev/04.MySQL%E8%BF%9E%E8%A1%A8%E6%9F%A5%E8%AF%A2%E7%AE%97%E6%B3%95/#hash-join","title":"Hash join","text":"<p>MySQL \u4ee5\u524d\u4e00\u76f4\u88ab\u4eba\u8bdf\u75c5\u6ca1\u6709\u5b9e\u73b0 <code>HashJoin</code>\uff0c\u5728 MySQL 8.0.18 \u5df2\u7ecf\u5e26\u4e0a\u4e86\u8fd9\u4e2a\u529f\u80fd\uff0c\u4ee4\u4eba\u6b23\u559c\u3002</p> <p>\u6709\u65f6\u5019\u5728\u60f3\uff0cMySQL \u4e3a\u4ec0\u4e48\u4e00\u76f4\u4e0d\u652f\u6301 <code>HashJoin</code> \u5462\uff1f\u6211\u60f3\u53ef\u80fd\u662f\u56e0\u4e3a MySQL \u591a\u7528\u4e8e\u7b80\u5355\u7684 OLTP \u573a\u666f\uff0c\u5e76\u4e14\u5728\u4e92\u8054\u7f51\u5e94\u7528\u5c45\u591a\uff0c\u9700\u6c42\u6ca1\u90a3\u4e48\u7d27\u6025\u3002</p> <p>\u53e6\u4e00\u65b9\u9762\u53ef\u80fd\u662f\u56e0\u4e3a\u4ee5\u524d\u5b8c\u5168\u9760\u793e\u533a\uff0c\u8fd9\u79cd\u6f14\u8fdb\u901f\u5ea6\u6bd5\u7adf\u6709\u9650\uff0cOracle \u6536\u8d2d MySQL \u540e\uff0cMySQL \u7684\u53d1\u7248\u6f14\u8fdb\u901f\u5ea6\u660e\u663e\u52a0\u5feb\u4e86\u5f88\u591a\u3002</p> <p>\u901a\u5e38\u60c5\u51b5\u4e0b\uff0c<code>hash join</code> \u6548\u7387\u6bd4 <code>nested loop join</code> \u5feb\uff08\u5f53 join \u4e2d\u7684\u67d0\u4e00\u5f20\u8868\u6570\u636e\u91cf\u5c0f\uff0c\u53ef\u4ee5\u5b8c\u5168\u7f13\u5b58\u5230\u5185\u5b58\u4e2d\u65f6\uff0c<code>hash join</code> \u6548\u7387\u662f\u6700\u597d\u7684\uff09\u3002</p> <p>\u5148\u7b80\u5355\u4ecb\u7ecd\u4e00\u4e0b\u54c8\u5e0c\u8868\u8fd9\u79cd\u6570\u636e\u7ed3\u6784</p> <p>\u54c8\u5e0c\u8868\uff08Hash Table\uff09\u4e5f\u53eb\u505a\u6563\u5217\u8868\uff0c\u6839\u636e\u5173\u952e\u7801\u503c\uff08key value\uff09\u53ef\u4ee5\u5feb\u901f\u5b58\u53d6\u8bbf\u95ee\u7684\u4e00\u79cd\u7a7a\u95f4\u6362\u65f6\u95f4\u7684\u6570\u636e\u7ed3\u6784\u3002</p> <p>\u5b83\u901a\u8fc7\u628a**\u5173\u952e\u7801\u503c\u901a\u8fc7\u6620\u5c04\u51fd\u6570\u8ba1\u7b97\u5230\u8868\u4e2d\u4e00\u4e2a\u4f4d\u7f6e\u6765\u8bbf\u95ee\u8bb0\u5f55\uff0c\u53ef\u4ee5\u52a0\u5feb\u67e5\u627e\u901f\u5ea6**\u3002\u8fd9\u4e2a\u6620\u5c04\u51fd\u6570\u53eb\u505a\u54c8\u5e0c\u51fd\u6570\uff08Hash Function\uff09\uff0c\u5b58\u653e\u8bb0\u5f55\u7684\u6570\u7ec4\u53eb\u505a\u54c8\u5e0c\u8868\uff08\u6216\u6563\u5217\u8868\uff09\u3002</p> <p>\u4e3e\u4e2a\u4f8b\u5b50\u6bd4\u5982\u6211\u4eec\u60f3\u60f3\u572814\u4ebf\u4e2a\u8eab\u4efd\u8bc1\u53f7\u7801\u4e2d\u627e\u51fa\u5176\u4e2d\u4e00\u4e2a\u8eab\u4efd\u8bc1\u53f7\uff0c\u6211\u4eec\u80af\u5b9a\u4e0d\u53ef\u80fd\u4e00\u4e2a\u4e2a\u53bb\u627e\uff0c\u800c\u6211\u4eec\u53ef\u4ee5\u5c0614\u4ebf\u6761\u6570\u636e\u5b58\u653e\u5728\u54c8\u5e0c\u8868\u4e2d\uff0c\u7136\u540e\u6839\u636e\u54c8\u5e0c\u8868\u7ed3\u6784\u5c31\u53ef\u4ee5\u5feb\u901f\u627e\u5230\u8981\u627e\u7684\u6570\u636e\u3002</p> <p>\u6240\u4ee5\u54c8\u5e0c\u8868\u5c31\u662f\u8fd9\u79cd\u80fd\u591f\u901a\u8fc7\u7ed9\u5b9a\u7684\u5173\u952e\u5b57\u7684\u503c\u76f4\u63a5\u8bbf\u95ee\u5230\u5177\u4f53\u5bf9\u5e94\u7684\u503c\u7684\u4e00\u4e2a\u6570\u636e\u7ed3\u6784\u3002\u4e5f\u5c31\u662f\u8bf4\u628a\u5173\u952e\u5b57\u6620\u5c04\u5230\u4e00\u4e2a\u8868\u4e2d\u7684\u4f4d\u7f6e\u6765\u76f4\u63a5\u8bbf\u95ee\u8bb0\u5f55\uff0c\u4ee5\u52a0\u5feb\u8bbf\u95ee\u901f\u5ea6\u3002</p> <p>\u6570\u7ec4\u7684\u7279\u70b9\u662f\uff1a\u5bfb\u5740\u5bb9\u6613\uff0c\u63d2\u5165\u548c\u5220\u9664\u56f0\u96be\uff1b</p> <p>\u800c\u94fe\u8868\u7684\u7279\u70b9\u662f\uff1a\u5bfb\u5740\u56f0\u96be\uff0c\u63d2\u5165\u548c\u5220\u9664\u5bb9\u6613\u3002</p> <p>\u54c8\u5e0c\u8868\u4f18\u7f3a\u70b9</p> <ul> <li>\u4f18\u70b9\uff1a\u4e0d\u8bba\u54c8\u5e0c\u8868\u4e2d\u6709\u591a\u5c11\u6570\u636e\uff0c\u67e5\u627e\u3001\u63d2\u5165\u3001\u5220\u9664\uff08\u6709\u65f6\u5305\u62ec\u5220\u9664\uff09\u53ea\u9700\u8981\u63a5\u8fd1\u5e38\u91cf\u7684\u65f6\u95f4\u5373O(1)\u7684\u65f6\u95f4\u7ea7\u3002\u5b9e\u9645\u4e0a\uff0c\u8fd9\u53ea\u9700\u8981\u51e0\u6761\u673a\u5668\u6307\u4ee4\u3002</li> </ul> <p>\u54c8\u5e0c\u8868\u8fd0\u7b97\u5f97\u975e\u5e38\u5feb\uff0c\u5728\u8ba1\u7b97\u673a\u7a0b\u5e8f\u4e2d\uff0c\u5982\u679c\u9700\u8981\u5728\u4e00\u79d2\u79cd\u5185\u67e5\u627e\u4e0a\u5343\u6761\u8bb0\u5f55\u901a\u5e38\u4f7f\u7528\u54c8\u5e0c\u8868\u3002\u54c8\u5e0c\u8868\u7684\u901f\u5ea6\u660e\u663e\u6bd4\u6811\u5feb\uff0c\u6811\u7684\u64cd\u4f5c\u901a\u5e38\u9700\u8981O(N)\u7684\u65f6\u95f4\u7ea7\u3002\u54c8\u5e0c\u8868\u4e0d\u4ec5\u901f\u5ea6\u5feb\uff0c\u7f16\u7a0b\u5b9e\u73b0\u4e5f\u76f8\u5bf9\u5bb9\u6613\u3002</p> <p>\u5982\u679c\u4e0d\u9700\u8981\u6709\u5e8f\u904d\u5386\u6570\u636e\uff0c\u5e76\u4e14\u53ef\u4ee5\u63d0\u524d\u9884\u6d4b\u6570\u636e\u91cf\u7684\u5927\u5c0f\u3002\u90a3\u4e48\u54c8\u5e0c\u8868\u5728\u901f\u5ea6\u548c\u6613\u7528\u6027\u65b9\u9762\u662f\u65e0\u4e0e\u4f26\u6bd4\u7684\u3002</p> <ul> <li>\u7f3a\u70b9\uff1a\u5b83\u662f\u57fa\u4e8e\u6570\u7ec4\u7684\uff0c\u6570\u7ec4\u521b\u5efa\u540e\u96be\u4e8e\u6269\u5c55\uff0c\u67d0\u4e9b\u54c8\u5e0c\u8868\u88ab\u57fa\u672c\u586b\u6ee1\u65f6\uff0c\u6027\u80fd\u4e0b\u964d\u5f97\u975e\u5e38\u4e25\u91cd\uff0c\u6240\u4ee5\u7a0b\u5e8f\u5458\u5fc5\u987b\u8981\u6e05\u695a\u8868\u4e2d\u5c06\u8981\u5b58\u50a8\u591a\u5c11\u6570\u636e\uff08\u6216\u8005\u51c6\u5907\u597d\u5b9a\u671f\u5730\u628a\u6570\u636e\u8f6c\u79fb\u5230\u66f4\u5927\u7684\u54c8\u5e0c\u8868\u4e2d\uff0c\u8fd9\u662f\u4e2a\u8d39\u65f6\u7684\u8fc7\u7a0b\uff09\u3002</li> </ul> <p>\u867d\u7136<code>hash join</code>\u9002\u7528\u4e8e\u7b49\u503cjoin\uff0c\u4f46\u662f<code>MySQL 8.0.20\u53ca</code>\u66f4\u9ad8\u7248\u672c\u4e2d\uff0c\u53d6\u6d88\u4e86\u5bf9\u7b49\u6761\u4ef6\u7684\u7ea6\u675f\uff0c\u53ef\u4ee5\u5168\u9762\u652f\u6301<code>on-equi-join</code>\uff0c<code>Semijoin</code>\uff0c<code>Antijoin</code>\uff0c<code>Left outer join</code>/<code>Right outer join</code>\u3002</p> <p>HashJoin \u662f\u9488\u5bf9 equal-join \u573a\u666f\u7684\u4f18\u5316\u3002\u5176\u57fa\u672c\u601d\u60f3\u662f\uff0c\u5c06\u5916\u8868\u6570\u636e load \u5230\u5185\u5b58\uff0c\u5e76\u6839\u636e key \u5efa\u7acb hash \u8868\uff0c\u8fd9\u6837\u53ea\u9700\u8981\u904d\u5386\u4e00\u904d\u5185\u8868\uff0c\u5c31\u53ef\u4ee5\u5b8c\u6210 join \u64cd\u4f5c\uff0c\u8f93\u51fa\u5339\u914d\u7684\u8bb0\u5f55\u3002</p> <p>\u5982\u679c\u6570\u636e\u80fd\u5168\u90e8 load \u5230\u5185\u5b58\u5f53\u7136\u597d\uff0c\u903b\u8f91\u4e5f\u7b80\u5355\uff0c\u4e00\u822c\u79f0\u8fd9\u79cd join \u4e3a**CHJ(Classic Hash Join)**\uff0c\u4e4b\u524dMariaDB\u5c31\u5df2\u7ecf\u5b9e\u73b0\u4e86\u8fd9\u79cd<code>HashJoin</code>\u7b97\u6cd5\u3002\u5982\u679c\u6570\u636e\u4e0d\u80fd\u5168\u90e8 load \u5230\u5185\u5b58\uff0c\u5c31\u9700\u8981\u5206\u6279 load \u8fdb\u5185\u5b58\uff0c\u7136\u540e\u5206\u6279 join\u3002</p> <p>\u7ecf\u5178 <code>HashJoin</code> \u4e3b\u8981\u6709\u4e24\u4e2a\u6b65\u9aa4\uff1a\u9009\u62e9 hash \u8868\uff0c\u626b\u63cf\u8be5\u8868\u5e76\u521b\u5efa hash \u8868\uff1b\u5c06\u53e6\u4e00\u4e2a\u4f5c\u4e3a probe \u8868\uff0c\u626b\u63cf\u6bcf\u4e00\u884c\u6570\u636e\uff0c\u7136\u540e\u5728 hash \u8868\u4e2d\u627e\u5bfb\u5bf9\u5e94\u7684\u6ee1\u8db3\u6761\u4ef6\u7684\u8bb0\u5f55\u3002\u5ffd\u7565\u5185\u5b58\u548c CPU \u65f6\u95f4\uff0c\u5b83\u7684\u6210\u672c\u662f\uff1a</p> <p>Cost(HJ) = Read(M) + Read(N)</p> <p><code>Hash Join</code> \u9700\u8981\u628a\u8868\u653e\u5230\u5185\u5b58\u4e2d\uff0c\u5982\u679c\u5185\u5b58\u4e0d\u591f\u600e\u4e48\u529e\uff1f\u4e3a\u4e86\u5904\u7406\u8fd9\u79cd\u60c5\u51b5\uff0c\u53c8\u8bde\u751f\u4e00\u4e9b <code>Hash Join</code> \u7684\u53d8\u79cd\uff0c\u6bd4\u5982 <code>Grace Hash Join</code> \u3002\u7b80\u5355\u8bf4\u662f\u901a\u8fc7\u5206\u533a\u65b9\u5f0f\u5b9e\u73b0\uff0c\u6839\u636e\u5173\u8054\u5b57\u6bb5\u5c06\u4e24\u4e2a\u8868\u7684\u6570\u636e\u5206\u533a\uff0c\u7136\u540e\u5bf9\u540c\u4e00\u5206\u533a\u7684\u6570\u636e\u518d\u8fdb\u884c\u539f\u751f <code>Hash join</code> \u7684 build \u4e0e probe \u8fc7\u7a0b\uff0c\u6700\u540e\u5c06\u6240\u6709\u5206\u533a\u7684\u6570\u636e\u5408\u5e76\u6210\u6700\u540e\u7684\u7ed3\u679c\u96c6\u3002\u5f53\u7136\u5728\u5b9e\u9645\u4e2d\u4f1a\u66f4\u590d\u6742\uff0c\u6bd4\u5982\u5728\u5927\u6570\u636e\u91cf\u7684\u60c5\u51b5\u4e0b\uff0c\u6709\u6982\u7387\u51fa\u73b0\u4e0d\u540c\u6570\u636e\u7684 HASH \u503c\u5374\u662f\u76f8\u540c\u7684\u95ee\u9898</p>"},{"location":"dev/04.MySQL%E8%BF%9E%E8%A1%A8%E6%9F%A5%E8%AF%A2%E7%AE%97%E6%B3%95/#basic-hash-joinin-memory-hash-join","title":"Basic Hash Join\uff08In-memory Hash Join\uff09","text":"<p>\u5185\u5b58\u80fd\u591f\u5b58\u50a8\u5916\u8868\u65f6\uff0c\u53ef\u4ee5\u76f4\u63a5\u4f9d\u8d56\u5185\u5b58\u6267\u884c<code>Basic Hash Join</code>\uff0c\u6240\u4ee5\u53c8\u88ab\u79f0\u4e3a<code>In-memory Hash Join</code>\u3002\u6267\u884cHash Join\u4e00\u822c\u5305\u62ec\u4e24\u4e2a\u8fc7\u7a0b\uff0c\u521b\u5efahash\u8868\u7684build\u8fc7\u7a0b\uff0c\u548c\u63a2\u6d4bhash\u8868\u7684probe\u8fc7\u7a0b\u3002</p> <ul> <li> <p>build\u8fc7\u7a0b\uff1a\u904d\u5386\u5916\u8868\uff0c\u4ee5\u8fde\u63a5\u6761\u4ef6\u4e3akey\uff0c\u4ee5\u67e5\u8be2\u9700\u8981\u7684\u5217\u4f5c\u4e3avalue\uff0c\u521b\u5efahash\u8868\u3002</p> </li> <li> <p>probe\u8fc7\u7a0b\uff1a\u9010\u884c\u904d\u5386\u5185\u8868\uff0c\u5bf9\u4e8e\u5185\u8868\u7684\u6bcf\u884c\u8bb0\u5f55\uff0c\u6839\u636e\u8fde\u63a5\u6761\u4ef6\u8ba1\u7b97hash\u503c\uff0c\u5e76\u5728hash\u8868\u4e2d\u67e5\u627e\u3002\u5982\u679c\u5339\u914d\u5230\u5916\u8868\u7684\u8bb0\u5f55\uff0c\u5219\u8f93\u51fa\uff0c\u5426\u5219\u8df3\u8fc7\uff0c\u76f4\u5230\u904d\u5386\u5b8c\u6210\u6240\u6709\u5185\u8868\u7684\u8bb0\u5f55\u3002</p> </li> </ul>"},{"location":"dev/04.MySQL%E8%BF%9E%E8%A1%A8%E6%9F%A5%E8%AF%A2%E7%AE%97%E6%B3%95/#on-disk-hash-join","title":"On-disk Hash Join","text":"<pre><code>-- \u4ee5\u8fd9\u6bb5SQL\u4e3a\u4f8b\nSELECT\n  given_name, country_name\nFROM\n  persons JOIN countries ON persons.country_id = countries.country_id;\n\n-- \u5728\u6784\u5efahash\u8868\u65f6\uff0cmysql \u5c06 join \u4e2d\u7684\u67d0\u4e00\u5f20\u6570\u636e\u8868\u7684\u6570\u636e\u7f13\u5b58\u5230\u6b64 hash \u8868\u4e2d\u3002\u901a\u5e38\u60c5\u51b5\u4e0b\uff0c\u4f18\u5316\u5668\u4f1a\u9009\u62e9\u6570\u636e\u91cf\u8f83\u5c0f\u7684\u8868\u6765\u6784\u5efa hash \u8868\uff08\u56e0\u4e3a\u8fd9\u6837\u5728\u5185\u5b58\u4e2d\u9700\u8981\u7f13\u5b58\u7684\u6570\u636e\u91cf\u76f8\u5bf9\u8f83\u5c0f\uff09\u3002 \n-- hash\u8868\u4f7f\u7528 join \u4f7f\u7528\u7684 join \u4e2d\u7684\u6b64\u8868\u4f7f\u7528\u7684\u6761\u4ef6\u4f5c\u4e3a hash key.\n</code></pre> <p>Hash join \u4e0d\u9700\u8981\u7d22\u5f15\u7684\u652f\u6301\u3002\u5927\u591a\u6570\u60c5\u51b5\u4e0b\uff0chash join \u6bd4\u4e4b\u524d\u7684 Block Nested-Loop \u7b97\u6cd5\u5728\u6ca1\u6709\u7d22\u5f15\u65f6\u7684\u7b49\u503c\u8fde\u63a5\u66f4\u52a0\u9ad8\u6548\u3002</p> <pre><code>-- \u521b\u5efa\u4e09\u5f20\u6d4b\u8bd5\u8868\nCREATE TABLE t1 (c1 INT, c2 INT);\nCREATE TABLE t2 (c1 INT, c2 INT);\nCREATE TABLE t3 (c1 INT, c2 INT);\n\n-- \u4f7f\u7528EXPLAIN FORMAT=TREE\u547d\u4ee4\u53ef\u4ee5\u770b\u5230\u6267\u884c\u8ba1\u5212\u4e2d\u7684 hash join\nEXPLAIN FORMAT=TREE  SELECT *  FROM t1  JOIN t2  ON t1.c1=t2.c1\n\n-- \u5fc5\u987b\u4f7f\u7528 EXPLAIN \u547d\u4ee4\u7684 FORMAT=TREE \u9009\u9879\u624d\u80fd\u770b\u5230\u8282\u70b9\u4e2d\u7684 hash join\u3002\n-- \u53e6\u5916\uff0cEXPLAIN ANALYZE\u547d\u4ee4\u4e5f\u53ef\u4ee5\u663e\u793a hash join \u7684\u4f7f\u7528\u4fe1\u606f\u3002\u8fd9\u4e5f\u662fMySQL8.0.18\u7248\u672c\u540e\u65b0\u589e\u7684\u4e00\u4e2a\u529f\u80fd\u3002\n\n-- \u591a\u4e2a\u8868\u4e4b\u95f4\u4f7f\u7528\u7b49\u503c\u8fde\u63a5\u7684\u7684\u67e5\u8be2\u4e5f\u4f1a\u8fdb\u884c\u8fd9\u79cd\u4f18\u5316\nSELECT * \n    FROM t1\n    JOIN t2 \n        ON (t1.c1 = t2.c1 AND t1.c2 &lt; t2.c2)\n    JOIN t3 \n        ON (t2.c1 = t3.c1);\n\n-- \u67e5\u770b\u6267\u884c\u8ba1\u5212\n EXPLAIN FORMAT=TREE Qurey;\n\n-- \u9ed8\u8ba4\u914d\u7f6e\u65f6\uff0cMySQL \u6240\u6709\u53ef\u80fd\u7684\u60c5\u51b5\u4e0b\u90fd\u4f1a\u4f7f\u7528 hash join\u3002\u540c\u65f6\u63d0\u4f9b\u4e86\u4e24\u79cd\u63a7\u5236\u662f\u5426\u4f7f\u7528 hash join \u7684\u65b9\u6cd5\n-- \u5728\u5168\u5c40\u6216\u8005\u4f1a\u8bdd\u7ea7\u522b\u8bbe\u7f6e\u670d\u52a1\u5668\u7cfb\u7edf\u53d8\u91cf optimizer_switch \u4e2d\u7684 hash_join=on \u6216\u8005 hash_join=off \u9009\u9879\u3002\u9ed8\u8ba4\u4e3a hash_join=on\u3002\n-- \u5728\u8bed\u53e5\u7ea7\u522b\u4e3a\u7279\u5b9a\u7684\u8fde\u63a5\u6307\u5b9aSQLHint\u4f18\u5316\u5668\u63d0\u793a\u4f7f\u7528 HASH_JOIN \u6216\u8005 NO_HASH_JOIN\n\n\n-- \u53ef\u4ee5\u901a\u8fc7\u7cfb\u7edf\u53d8\u91cf join_buffer_size \u63a7\u5236 hash join \u5141\u8bb8\u4f7f\u7528\u7684\u5185\u5b58\u6570\u91cf\uff1bhash join \u4e0d\u4f1a\u4f7f\u7528\u8d85\u8fc7\u8be5\u53d8\u91cf\u8bbe\u7f6e\u7684\u5185\u5b58\u6570\u91cf\u3002\n-- \u5982\u679c hash join \u6240\u9700\u7684\u5185\u5b58\u8d85\u8fc7\u8be5\u9608\u503c\uff0cMySQL \u5c06\u4f1a\u5728\u78c1\u76d8\u4e2d\u6267\u884c\u64cd\u4f5c\u3002\n-- \u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u5982\u679c hash join \u65e0\u6cd5\u5728\u5185\u5b58\u4e2d\u5b8c\u6210\uff0c\u5e76\u4e14\u6253\u5f00\u7684\u6587\u4ef6\u6570\u91cf\u8d85\u8fc7\u7cfb\u7edf\u53d8\u91cf open_files_limit \u7684\u503c\uff0c\u8fde\u63a5\u64cd\u4f5c\u53ef\u80fd\u4f1a\u5931\u8d25\u3002\n\n-- \u63a5\u4e0b\u6765\u6211\u4eec\u6bd4\u8f83\u4e00\u4e0b hash join \u548c block nested loop \u7684\u6027\u80fd\uff0c\u9996\u5148\u5206\u522b\u4e3a t1\u3001t2 \u548c t3 \u751f\u6210 1000000 \u6761\u8bb0\u5f55\uff1a\n\n\nset join_buffer_size=2097152000;\n\nSET @@cte_max_recursion_depth = 99999999;\n\nINSERT INTO t1\n-- INSERT INTO t2\n-- INSERT INTO t3\nWITH RECURSIVE t AS (\n  SELECT 1 AS c1, 1 AS c2\n  UNION ALL\n  SELECT t.c1 + 1, t.c1 * 2\n    FROM t\n   WHERE t.c1 &lt; 1000000\n)\nSELECT *\n  FROM t;\n</code></pre> <ul> <li> <p>\u518d\u589e\u52a0\u4e00\u4e2a Oracle 12c \u4e2d\u65e0\u7d22\u5f15\u65f6 hash join \u7ed3\u679c\uff1a1.282 s\u3002</p> </li> <li> <p>\u518d\u589e\u52a0\u4e00\u4e2a PostgreSQL 11.5 \u4e2d\u65e0\u7d22\u5f15\u65f6 hash join \u7ed3\u679c\uff1a6.234 s\u3002</p> </li> <li> <p>\u518d\u589e\u52a0\u4e00\u4e2a SQL 2017 \u4e2d\u65e0\u7d22\u5f15\u65f6 hash join \u7ed3\u679c\uff1a5.207 s\u3002</p> </li> </ul>"},{"location":"dev/04.MySQL%E8%BF%9E%E8%A1%A8%E6%9F%A5%E8%AF%A2%E7%AE%97%E6%B3%95/#_2","title":"\u5b9e\u4f8b","text":"<pre><code>-- \u5efa\u8868t2\nCREATE TABLE `t2` (\n  `id` int(11) NOT NULL,\n  `a` int(11) DEFAULT NULL,\n  `b` int(11) DEFAULT NULL,\n  PRIMARY KEY (`id`),\n  KEY `a` (`a`)\n) ENGINE=InnoDB;\n\n\n-- t2\u7684\u5b58\u50a8\u8fc7\u7a0b\uff0c\u63d2\u5165\u6570\u636e\ndelimiter ;;\ncreate procedure idata()\nbegin\n  declare i int;\n  set i=1;\n  while(i&lt;=1000)do\n    insert into t2 values(i, i, i);\n    set i=i+1;\n  end while;\nend;;\n\ndelimiter ;\n\ncall idata();\n\n\n-- \u5efa\u8868t1\ncreate table t1 like t2;\ninsert into t1 (select * from t2 where id&lt;=100)\n\n\n-- t1\u7684\u5b58\u50a8\u8fc7\u7a0b\uff0c\u63d2\u5165\u6570\u636e\ndelimiter ;;\ncreate procedure idata2()\nbegin\n  declare i int;\n  set i=2000;\n  while(i&lt;=3000)do\n    insert into t1 values(i, i, i);\n    set i=i+1;\n  end while;\nend;;\n\ndelimiter ;\n\ncall idata2();\n\n\n\n\n-- t1 \u7684\u6570\u636e  1-100  2000-3000  \u4e00\u5171\u662f1101\u6761\u6570\u636e\n-- t2 \u7684\u6570\u636e  1-1000            \u4e00\u5171\u662f1000\u6761\u6570\u636e\n\n-- \u76f4\u63a5\u591a\u8868\u67e5\u8be2\uff0c\u7b1b\u5361\u5c14\u79ef\uff1a1101*1000 \u6761\u6570\u636e\uff0c\u5f88\u5c11\u6709\u8fd9\u6837\u7684\u67e5\u8be2\nselect *  from t1 , t2   \n</code></pre>"},{"location":"dev/05.MySQL-insert%E8%AF%AD%E6%B3%95/","title":"5.insert\u8bed\u6cd5","text":"<p>\u5728 MySQL \u4e2d\u53ef\u4ee5\u4f7f\u7528 INSERT \u8bed\u53e5\u5411\u6570\u636e\u5e93\u5df2\u6709\u7684\u8868\u4e2d\u63d2\u5165\u4e00\u884c\u6216\u8005\u591a\u884c\u5143\u7ec4\u6570\u636e\u3002</p> <pre><code>--\u5355\u6761\u63d2\u5165\nINSERT INTO items(name,city,price,number,picture)  VALUES ('\u8010\u514b\u8fd0\u52a8\u978b','\u5e7f\u5dde',500,1000,'003.jpg');\n\n\n\n--\u6279\u91cf\u63d2\u5165\nINSERT INTO  items(name,city,price,number,picture) \n VALUES\n('\u8010\u514b\u8fd0\u52a8\u978b','\u5e7f\u5dde',500,1000,'003.jpg'),\n('\u8010\u514b\u8fd0\u52a8\u978b2','\u5e7f\u5dde2',500,1000,'002.jpg');\n\n-- 1\u3001\u8981\u6839\u636e\u60c5\u51b5\u8bbe\u7f6e\u4e00\u6b21\u6279\u91cf\u63d2\u5165\u7684\u6570\u636e\u91cf\uff0c\u6570\u636e\u91cf\u5927\uff0c\u5728\u7f51\u7edc\u4e2d\u4f20\u8f93\u7684\u4e8b\u4ef6\u4e5f\u8d8a\u4e45\uff0c\u51fa\u73b0\u95ee\u9898\u7684\u53ef\u80fd\u4e5f\u8d8a\u5927\uff1b\n\n-- 2\u3001\u9664\u4e86\u7f51\u7edc\uff0c\u8fd8\u8981\u770b\u673a\u5668\u914d\u7f6e\uff0cMySQL Server\u914d\u7f6e\u5dee\u4e86\uff0csql\u5199\u5f97\u518d\u597d\uff0c\u6548\u7387\u4e5f\u4e0d\u4f1a\u592a\u9ad8\uff1b\n\n-- 3\u3001\u53e6\u5916\u6279\u91cf\u8fd9\u4e2a\u8bcd\uff0c\u662f\u6307\u4e00\u6b21\u63d2\u5165\u591a\u6761\u6570\u636e\uff0c\u6211\u4eec\u9664\u4e86\u8981\u6ce8\u610f\u6570\u636e\u7684\u6761\u6570\uff0c\u8fd8\u8981\u6ce8\u610f\u4e00\u6761\u6570\u636e\u7684\u5927\u5c0f\uff0c\u4e3e\u4e2a\u4f8b\u5b50\uff1a\u6bd4\u5982\u4e00\u6761\u8bb0\u5f55\u7684\u6570\u636e\u91cf\u67091M\uff0c10\u6761\u8bb0\u5f55\u7684\u6570\u636e\u91cf\u5c3110M\uff0c\u8fd9\u65f6\u4e00\u6b21\u63d2100\u6761\uff0c100M\u6570\u636e\uff0c\u563f\u563f\uff0c\u4f60\u8bd5\u8bd5\u770b\uff01\uff01\u6240\u4ee5\uff0c\u4e00\u6b21\u63d2\u5165\u591a\u5c11\u6570\u636e\uff0c\u4e00\u5b9a\u8981\u7ecf\u8fc7\u591a\u6b21\u6d4b\u8bd5\u540e\u518d\u51b3\u5b9a\uff0c\u522b\u4eba1\u6b21\u63d2100\u6761\u6700\u4f18\uff0c\u4f60\u53ef\u80fd1\u6b21\u63d210\u6761\u624d\u6700\u4f18\uff0c\u6ca1\u6709\u7edd\u5bf9\u7684\u6700\u4f18\u503c\uff08\u6279\u91cf\u63d2\u5165\u672a\u5fc5\u603b\u662f\u6bd4\u5355\u6761\u63d2\u5165\u6548\u7387\u9ad8\uff09\u3002\n\n-- 4\u3001\u6570\u636e\u5e93\u6709\u4e2a\u53c2\u6570\uff0cmax_allowed_packet\uff0c\u4e5f\u5c31\u662f\u6bcf\u4e00\u4e2a\u5305\uff08sql\uff09\u547d\u4ee4\u5927\u5c0f\uff0c\u9ed8\u8ba4\u662f1M\uff0c\u90a3\u4e48sql\u7684\u957f\u5ea6\u5927\u4e8e1M\u5c31\u4f1a\u62a5\u9519\u3002\u4f60\u53ef\u80fd\u4f1a\u8bf4\uff0c\u54b1\u4eec\u628a\u8fd9\u4e2a\u53c2\u6570\u8bbe\u621010M\uff0c100M\u4e0d\u5c31\u884c\u4e86\uff1f\uff1f\uff1f\u5bf9\u5440\uff0c\u6ca1\u6bdb\u75c5\uff0c\u4f46\u4f60\u662fDBA\u5417\uff1f\u4f60\u6709\u6743\u9650\u5417\uff1f\u5373\u4f7f\u8c03\u5927\u8fd9\u4e00\u4e2a\u53c2\u6570\uff0c\u4f60\u8981\u77e5\u9053\u5f71\u54cd\u7684\u53ef\u4e0d\u6b62\u4f60\u8fd9\u4e00\u5f20\u8868\uff0c\u800c\u662f\u6574\u4e2aDB Server\uff0c\u90a3\u5f71\u54cd\u7684\u53ef\u662f\u5f88\u591a\u5e93\uff0c\u5f88\u591a\u8868\u3002\n\n-- 5\u3001\u6279\u91cf\u63d2\u5165\u5e76\u4e0d\u662f\u8d8a\u5feb\u8d8a\u597d\uff0c\u6211\u4eec\u53ef\u80fd\u5e0c\u671b\u8d8a\u5feb\u8d8a\u597d\uff0c\u8fd9\u5f88\u6b63\u5e38\uff0c\u8282\u7701\u65f6\u95f4\u561b\u3002\u4f46\u662f\u6211\u4eec\u4e00\u5b9a\u8981\u77e5\u9053\uff0c\u6570\u636e\u5e93\u5206\u8bfb\u5199\uff0c\u6709\u96c6\u7fa4\uff0c\u8fd9\u5c31\u610f\u5473\u7740\uff0c\u9700\u8981\u540c\u6b65\uff01\uff01\uff01\u5982\u679c\u6709\u5206\u5e93\u5206\u8868\u5206\u533a\u7684\u60c5\u51b5\uff0c\u5982\u679c\u77ed\u65f6\u95f4\u5185\u63d2\u5165\u7684\u6570\u636e\u91cf\u592a\u5927\uff0c\u6570\u636e\u5e93\u540c\u6b65\u53ef\u80fd\u5c31\u4f1a\u6bd4\u8f83\u8ff7\u4e86\uff0c\u8bfb\u5199\u6570\u636e\u4e0d\u4e00\u81f4\u7684\u60c5\u51b5\u5728\u6240\u96be\u514d\u4e86\uff0c\u53ef\u80fd\u4f1a\u56e0\u4e3a\u4e00\u5f20\u8868\u7684\u6279\u91cf\u63d2\u5165\uff0c\u5f71\u54cd\u6574\u4e2aDB\u670d\u52a1\u7ec4\u7684\u540c\u6b65\uff0c\u540c\u65f6\u8fd8\u8981\u8003\u8651\u5e76\u53d1\u95ee\u9898\uff0c\u54c8\u54c8\u54c8\u3002\u3000\n</code></pre> <pre><code>-- REPLACE INSERT\u8bed\u53e5\n-- \u5728\u5411\u8868\u4e2d\u63d2\u5165\u6570\u636e\u7684\u65f6\u5019\uff0c\u7ecf\u5e38\u9047\u5230\u8fd9\u6837\u7684\u60c5\u51b5\uff1a1. \u9996\u5148\u5224\u65ad\u6570\u636e\u662f\u5426\u5b58\u5728\uff1b 2. \u5982\u679c\u4e0d\u5b58\u5728\uff0c\u5219\u63d2\u5165\uff1b3.\u5982\u679c\u5b58\u5728\uff0c\u5219\u66f4\u65b0\u3002\n-- \u4f7f\u7528REPLACE INTO\u65f6\uff0c\u9996\u5148\u4f1a\u6839\u636e\u4e3b\u952e\u6216\u8005\u552f\u4e00\u7d22\u5f15\u67e5\u770b\u8868\u4e2d\u662f\u5426\u6709\u8be5\u6761\u8bb0\u5f55\uff0c\u6709\u7684\u8bdd\u5219\u5148\u5220\u9664\uff0c\u7136\u540e\u63d2\u5165\u6570\u636e\uff1b\u6ca1\u6709\u8be5\u8bb0\u5f55\u5219\u76f4\u63a5\u63d2\u5165\u3002\n\nCREATE TABLE `stu` (\n  `id` int(11) NOT NULL AUTO_INCREMENT,\n  `cid` int(11) NOT NULL,\n  `name` varchar(32) DEFAULT NULL,\n  PRIMARY KEY (`id`),\n  UNIQUE KEY `cid` (`cid`)\n) ENGINE=InnoDB  DEFAULT CHARSET=utf8;\n-- \u5176\u4e2did\u4e3a\u81ea\u589e\u4e3b\u952e\uff0ccid\u4e3a\u552f\u4e00\u7d22\u5f15\u3002\n\n-- \u63d2\u5165\u4e24\u6761\u6570\u636e\nINSERT INTO stu(cid, name) VALUES(1, '1111');\nINSERT INTO stu(cid, name) VALUES(2, '2222');\nREPLACE INTO stu(cid, name) VALUES(3,'3333');\n\n\n-- 1    1   1111\n-- 2    2   2222\n-- 3    3   3333\n\n\nREPLACE INTO stu(cid, name) VALUES(3,'33331'); \n-- \u4f7f\u7528REPLACE INTO\u65f6\uff0c\u9996\u5148\u4f1a\u6839\u636e\u4e3b\u952e\u6216\u8005\u552f\u4e00\u7d22\u5f15\u67e5\u770b\u8868\u4e2d\u662f\u5426\u6709\u8be5\u6761\u8bb0\u5f55\uff0c\u6709\u7684\u8bdd\u5219\u5148\u5220\u9664\uff0c\u7136\u540e\u63d2\u5165\u6570\u636e\uff1b\u6ca1\u6709\u8be5\u8bb0\u5f55\u5219\u76f4\u63a5\u63d2\u5165\u3002\n-- \u539f\u5148id\u4e3a3\u7684\u8bb0\u5f55\u53d8\u6210\u4e86id\u4e3a4\u4e86\uff0c\u8bf4\u660e\u539f\u5148id\u4e3a3\u7684\u8bb0\u5f55\u5148\u5220\u9664\u4e86\uff0c\u7136\u540e\u65b0\u63d2\u5165\u4e86id\u4e3a4\uff08id\u81ea\u589e\uff09\u7684\u65b0\u8bb0\u5f55\n\n-- 1    1   1111\n-- 2    2   2222\n-- 4    3   33331\n\n\n--\u518d\u6b21\u6267\u884creplace\uff0cid\u4e3a4\u548ccid\u4e3a2\u7684\u539f\u8bb0\u5f55\u90fd\u5b58\u5728\uff0c\u5219\u88ab\u5220\u9664\u3002\u7136\u540e\u518d\u63d2\u5165\u8fd9\u6761\u65b0\u7eaa\u5f55\nREPLACE INTO stu(id, cid, name) VALUES(4, 2,'42')\n&gt; Affected rows: 3\n&gt; \u67e5\u8be2\u65f6\u95f4: 0.007s\n\n-- 1    1   1111\n-- 4    2   42\n</code></pre> <pre><code>-- INSERT INTO\u2026SELECT\u2026FROM \u8bed\u53e5\u7528\u4e8e\u5feb\u901f\u5730\u4ece\u4e00\u4e2a\u6216\u591a\u4e2a\u8868\u4e2d\u53d6\u51fa\u6570\u636e\uff0c\u5e76\u5c06\u8fd9\u4e9b\u6570\u636e\u4f5c\u4e3a\u884c\u6570\u636e\u63d2\u5165\u53e6\u4e00\u4e2a\u8868\u4e2d\u3002\n\n-- SELECT \u5b50\u53e5\u8fd4\u56de\u7684\u662f\u4e00\u4e2a\u67e5\u8be2\u5230\u7684\u7ed3\u679c\u96c6\uff0cINSERT \u8bed\u53e5\u5c06\u8fd9\u4e2a\u7ed3\u679c\u96c6\u63d2\u5165\u6307\u5b9a\u8868\u4e2d\uff0c\u7ed3\u679c\u96c6\u4e2d\u7684\u6bcf\u884c\u6570\u636e\u7684\u5b57\u6bb5\u6570\u3001\u5b57\u6bb5\u7684\u6570\u636e\u7c7b\u578b\u90fd\u5fc5\u987b\u4e0e\u88ab\u64cd\u4f5c\u7684\u8868\u5b8c\u5168\u4e00\u81f4\u3002\n</code></pre> <pre><code>-- \u5728MySQL\u6570\u636e\u5e93\u4e2d\uff0c\u5982\u679c\u5728insert\u8bed\u53e5\u540e\u9762\u5e26\u4e0aON DUPLICATE KEY UPDATE \u5b50\u53e5\uff0c\u800c\u8981\u63d2\u5165\u7684\u884c\u4e0e\u8868\u4e2d\u73b0\u6709\u8bb0\u5f55\u7684\u60df\u4e00\u7d22\u5f15\u6216\u4e3b\u952e\u4e2d\u4ea7\u751f\u91cd\u590d\u503c\uff0c\u90a3\u4e48\u5c31\u4f1a\u53d1\u751f\u65e7\u884c\u7684\u66f4\u65b0\uff1b\u5982\u679c\u63d2\u5165\u7684\u884c\u6570\u636e\u4e0e\u73b0\u6709\u8868\u4e2d\u8bb0\u5f55\u7684\u552f\u4e00\u7d22\u5f15\u6216\u8005\u4e3b\u952e\u4e0d\u91cd\u590d\uff0c\u5219\u6267\u884c\u65b0\u7eaa\u5f55\u63d2\u5165\u64cd\u4f5c\u3002\u53e6\u5916\uff0cON DUPLICATE KEY UPDATE\u4e0d\u80fd\u5199where\u6761\u4ef6\u3002\n</code></pre>"},{"location":"foundmental/1.MySQL%E5%8D%8F%E8%AE%AE%E5%88%86%E6%9E%90%E4%B8%8E%E6%8A%93%E5%8C%85%E6%A6%82%E8%BF%B0/","title":"MySQL \u534f\u8bae\u5206\u6790","text":""},{"location":"foundmental/1.MySQL%E5%8D%8F%E8%AE%AE%E5%88%86%E6%9E%90%E4%B8%8E%E6%8A%93%E5%8C%85%E6%A6%82%E8%BF%B0/#_1","title":"\u80cc\u666f","text":"<p>\u4f5c\u4e3a DBA \uff0c\u5728\u65e5\u5e38\u8fd0\u7ef4\u5de5\u4f5c\u4e2d\uff0c\u5e38\u5e38\u4f1a\u88ab\u5f00\u53d1\u540c\u5b66\u95ee\u5230\u7c7b\u4f3c\u4e0b\u9762\u7684\u8fd9\u4e9b\u95ee\u9898\uff1a</p> <ul> <li>\u6211\u7684\u8fd9\u6761\u6570\u636e\u4e0d\u77e5\u9053\u88ab\u8c01\u6539\u4e86\uff0c\u80fd\u5e2e\u6211\u67e5\u4e00\u4e0b\u5417\uff1f</li> <li>\u80fd\u5e2e\u6211\u67e5\u67e5\u8fd9\u5f20\u8868\u90fd\u6709\u8c01\u5728\u8bbf\u95ee\u5417\uff1f</li> <li>\u6628\u5929\u67d0\u4e2a\u65f6\u95f4\u76d1\u63a7\u6709\u4e2a\u5c16\u523a\uff0c\u80fd\u5e2e\u5fd9\u770b\u770b\u6267\u884c\u4e86\u54ea\u4e9b SQL \u5417\uff1f</li> <li>\u67d0\u4e00\u4e2a SQL \u8bed\u53e5\u4e2d\u6709\u624b\u673a\u53f7\u3001\u8eab\u4efd\u8bc1\u53f7\uff0c\u6216\u8005\u5bc6\u7801\u660e\u6587\u7b49\u654f\u611f\u4fe1\u606f\uff0c\u8fd9\u4e2a\u8bed\u53e5\u662f\u8c01\u5728\u6267\u884c\uff1f</li> <li>\u67d0\u4e00\u5f20\u8868\u4e2d\u5b58\u50a8\u4e86\u624b\u673a\u53f7\u3001\u5bc6\u7801\u7b49\u660e\u6587\u4fe1\u606f\uff0c\u53c8\u662f\u8c01\u5728\u8bfb\u5199\u8fd9\u5f20\u8868\u5462\uff1f</li> </ul> <p>\u9762\u5bf9\u8fd9\u4e9b\u95ee\u9898\uff0c\u6211\u4eec\u4f1a\u60f3\u65b9\u8bbe\u6cd5\u53bb\u627e\u627e\u6162\u65e5\u5fd7\uff0c\u6216\u8005\u67e5\u8be2\u65e5\u5fd7\uff0c\u751a\u81f3\u5206\u6790 binlog \uff0c\u8fd0\u6c14\u597d\u7684\u8bdd\u53ef\u4ee5\u627e\u5230\u4e00\u4e9b\u7ebf\u7d22\uff0c\u4f46\u5927\u591a\u6570\u65f6\u5019\u90fd\u4e0d\u5c3d\u4eba\u610f\u3002\u8be6\u7ec6\u7684\u8bbf\u95ee\u4fe1\u606f\uff0c\u5e26\u7528\u6237\u540d\u3001\u5ba2\u6237\u7aef IP \u7684\u53ea\u6709\u6162\u65e5\u5fd7\u4f1a\u8bb0\u5f55\uff0c\u751f\u4ea7\u73af\u5883\u53c8\u4e0d\u53ef\u80fd\u628a\u6240\u6709 SQL \u90fd\u8bb0\u5f55\u4e0b\u6765\uff0c\u90a3\u4f1a\u6781\u5927\u7684\u62d6\u6162\u7cfb\u7edf\u6027\u80fd\uff0c\u751a\u81f3\u6709\u51e0\u7387\u4f1a\u5e26\u6765\u6545\u969c\uff0c\u56e0\u6b64\u8fd9\u6210\u4e3a\u4e86\u4e00\u4e2a\u8ba9 DBA \u5934\u75bc\u7684\u95ee\u9898\u3002</p> <p>\u90a3\u4e48\uff0c\u600e\u4e48\u83b7\u53d6\u5230\u6570\u636e\u5168\u91cf\u7684\u8bbf\u95ee\u65e5\u5fd7\u5462\uff0c\u6211\u4eec\u6765\u5206\u6790\u4e00\u4e0b\u5e38\u89c1\u7684\u4e00\u4e9b\u65b9\u6cd5\uff1a</p> <ul> <li>\u4ece Server \u7aef\u8bb0\u5f55</li> </ul> <p>\u5c31\u662f\u524d\u9762\u63d0\u5230\u7684\uff0c\u901a\u8fc7\u6162\u65e5\u5fd7\u3001\u67e5\u8be2\u65e5\u5fd7\u6765\u8bb0\u5f55\u3002\u4f18\u7f3a\u70b9\u4e5f\u5f88\u660e\u663e\uff0c\u4f18\u70b9\u5c31\u662f\u8bb0\u5f55\u7684\u4fe1\u606f\u51c6\u786e\uff0c\u5f00\u542f\u7b80\u5355\uff1b\u7f3a\u70b9\u5c31\u662f\u4f1a\u5360\u7528\u7cfb\u7edf\u6027\u80fd\uff0c\u540c\u65f6\u5e26\u6765\u98ce\u9669\uff0c\u8fd9\u79cd\u5b9e\u73b0\u65b9\u5f0f\u901a\u5e38\u6709\u51e0\u79cd\u65b9\u6848\uff1a</p> <pre><code># General log\uff1a\u8fd9\u79cd\u65b9\u6848\u53ef\u4ee5\u8bb0\u5f55\u6240\u6709\u8bbf\u95ee\u65e5\u5fd7\uff0c\u4f46\u65e5\u5fd7\u5185\u5bb9\u532e\u4e4f\uff0c\u53ea\u5305\u62ec\u4e86 Query \u8bed\u53e5\uff0c\u800c\u7f3a\u5c11\u4e86\u8bbf\u95ee IP \uff0c\u7528\u6237\u540d\u7b49\u4fe1\u606f\uff0c\u5e76\u4e14\u5982\u679c\u7ebf\u4e0a\u90fd\u6253\u5f00\u8fd9\u4e2a\u65e5\u5fd7\u6587\u4ef6\uff0c\u5bf9 MySQL \u6027\u80fd\u7684\u51b2\u51fb\u5f88\u5927\uff0c\u5bb9\u6613\u4ea7\u751f\u6545\u969c\uff0c\u6240\u4ee5\u5f88\u96be\u5b9e\u73b0\u6211\u4eec\u7684\u9700\u6c42\u3002\n\n# Slow log\uff1a\u5c06 long_query_time \u53c2\u6570\u8bbe\u7f6e\u4e3a 0 \uff0c\u5373\u53ef\u8bb0\u5f55\u6240\u6709 MySQL Server \u7aef\u6267\u884c\u7684 SQL \u8bed\u53e5\uff0c\u7528\u6237\u540d\u3001\u5ba2\u6237\u7aef IP \u3001\u6267\u884c\u65f6\u95f4\u7b49\u4fe1\u606f\u5747\u6709\u8bb0\u5f55\uff0c\u4f46\u662f\u5e26\u6765\u7684\u95ee\u9898\u4e0e\u5f00\u542f General log \u76f8\u540c\uff0c\u751f\u4ea7\u73af\u5883\u4e0d\u53ef\u80fd\u4e00\u76f4\u5f00\u542f\u3002\n\n# Audit plugin\uff1aMySQL\u793e\u533a\u7248\u5b98\u65b9\u5e76\u6ca1\u6709\u63d0\u4f9b\u4e25\u683c\u610f\u4e49\u4e0a\u7684\u5ba1\u8ba1\u65e5\u5fd7\u3002\u5e38\u89c1\u7684\u5ba1\u8ba1\u63d2\u4ef6\u6709 MariaDB Audit Plugin\u3001Percona Audit Log Plugin\u3001McAfee MySQL Audit Plugin \u4e09\u79cd\u3002\n</code></pre> <ul> <li>\u4ece\u5ba2\u6237\u7aef\u8bb0\u5f55</li> </ul> <p>\u5ba2\u6237\u7aef\u53d1\u8d77\u8bf7\u6c42\u548c\u6536\u5230\u54cd\u5e94\u65f6\uff0c\u80fd\u591f\u8bb0\u5f55\u81ea\u5df1\u53d1\u51fa\u7684 SQL \u8bf7\u6c42\uff0c\u7ed3\u679c\u96c6\u4ee5\u53ca\u54cd\u5e94\u65f6\u95f4\uff0c\u4f46\u6211\u4eec\u77e5\u9053\uff0c\u5ba2\u6237\u7aef\u4f17\u591a\uff0c\u6c47\u603b\u8d77\u6765\u662f\u4e00\u4e2a\u95ee\u9898\uff0c\u4e5f\u4e0d\u80fd\u4fdd\u8bc1\u6bcf\u53f0\u673a\u5668\u6267\u884c SQL \u7684\u65f6\u5e8f\u6027\u3002\u66f4\u4e0d\u80fd\u4f53\u73b0 Server \u7aef\u7684\u771f\u5b9e\u6267\u884c\u65f6\u95f4\uff0c\u7f51\u7edc\u5f00\u9500\u3001\u5ba2\u6237\u7aef\u7a0b\u5e8f\u5904\u7406\u8017\u65f6\u7b49\u56e0\u7d20\u6ca1\u6cd5\u6392\u9664\u3002</p> <ul> <li>MySQL \u4e2d\u95f4\u5c42\u8bb0\u5f55</li> </ul> <p>\u901a\u8fc7\u4e2d\u95f4\u5c42\u65e5\u5fd7\u8ffd\u52a0\u7684\u65b9\u5f0f\uff0c\u8bb0\u5f55\u6240\u6709\u5bf9\u4e8e\u5e95\u5c42\u6570\u636e\u5e93\u7684\u8bf7\u6c42\uff1b\u4f46\u8fd9\u79cd\u65b9\u5f0f\u53d7\u9650\u4e8e\u4e2d\u95f4\u5c42\u7684\u7279\u6027\uff0c\u5e76\u4e14 MySQL \u548c\u4e2d\u95f4\u5c42\u7684\u5173\u7cfb\u5f80\u5f80\u662f\u591a\u5bf9\u591a\uff0c\u4e5f\u5b58\u5728\u4e00\u4e2a\u6c47\u603b\u7684\u95ee\u9898\uff0c\u540c\u65f6\u4e5f\u4f1a\u589e\u52a0\u989d\u5916\u5f00\u9500\u3002\u66f4\u52a0\u91cd\u8981\u7684\u662f\uff0c\u5728\u6211\u4eec\u4f7f\u7528\u7684 MySQL \u67b6\u6784\u4e2d\uff0c\u6ca1\u6709\u4e2d\u95f4\u5c42\u8fd9\u4e2a\u6a21\u5757\uff0c\u6240\u4ee5\u8fd9\u79cd\u65b9\u6848\u5c31\u5df2\u7ecf\u88ab\u6392\u9664\u5728\u5916\u3002</p> <p>\u7f51\u7edc\u65c1\u8def\u6293\u53d6\uff1a\u8fd9\u662f\u4e00\u79cd\u5e38\u89c1\u7684 SQL \u5ba1\u8ba1\u624b\u6bb5\uff0c\u5bf9\u670d\u52a1\u662f\u975e\u5165\u4fb5\u5f0f\u7684\uff0c\u901a\u8fc7\u7f51\u7edc\u6293\u5305\u6765\u83b7\u53d6\u5bf9\u4e8e\u6570\u636e\u5e93\u7684\u5168\u91cf\u8bbf\u95ee\u65e5\u5fd7\u3002\u8fd9\u79cd\u65b9\u5f0f\u65e2\u4e0d\u4f1a\u5bf9\u670d\u52a1\u9020\u6210\u4efb\u4f55\u5f71\u54cd\uff0c\u540c\u65f6\u4e5f\u53ef\u4ee5\u63a7\u5236\u5bf9\u4e8e\u670d\u52a1\u5668\u8d44\u6e90\u7684\u5360\u7528\uff0c\u51c6\u786e\u6027\u4e5f\u6709\u4e00\u5b9a\u4fdd\u969c\u3002</p>"},{"location":"foundmental/1.MySQL%E5%8D%8F%E8%AE%AE%E5%88%86%E6%9E%90%E4%B8%8E%E6%8A%93%E5%8C%85%E6%A6%82%E8%BF%B0/#_2","title":"\u6982\u8ff0","text":"<p>\u672c\u6587\u4e0d\u8ba8\u8bba\u8bed\u8a00\u5c42, \u4e3b\u8981\u9610\u8ff0 <code>MySQL Client/Server</code> \u7684\u901a\u4fe1\u534f\u8bae\uff0c\u4e86\u89e3\u4e86\u6574\u4e2a\u901a\u4fe1\u534f\u8bae\u4e4b\u540e, \u65e0\u8bba\u662f\u9488\u5bf9\u4ec0\u4e48\u7f16\u7a0b\u8bed\u8a00\uff0c\u54ea\u6015\u662f\u81ea\u5df1\u5f00\u53d1\u7684\u65b0\u7f16\u7a0b\u8bed\u8a00\uff0c\u4e5f\u90fd\u53ef\u4ee5\u81ea\u884c\u5b9e\u73b0\u4e00\u4e2a MySQL \u9a71\u52a8\uff0c\u57fa\u4e8e MySQL \u9a71\u52a8\u53ef\u4ee5\u5728\u4e0a\u5c42\u505a\u66f4\u591a\u81ea\u5b9a\u4e49\u7684\u4e8b\u60c5\u3002\u4f8b\u5982\u5b9e\u73b0 MySQL \u6570\u636e\u5230 Redis\u3001ElasticSearch\u3001MongoDB \u7b49\u7684\u6570\u636e\u540c\u6b65\u3001\u5f00\u53d1 MySQL Proxy \u7b49\u3002</p> <p>MySQL \u901a\u4fe1\u534f\u8bae\u662f\u4e00\u4e2a**\u6709\u72b6\u6001\u534f\u8bae**\uff0c\u4e3b\u8981\u7528\u4e8e MySQL \u5ba2\u6237\u7aef\u4e0e\u670d\u52a1\u5668\u4e4b\u95f4\u7684\u901a\u4fe1\u3002\u8fd9\u4e2a\u534f\u8bae\u5728 MySQL \u5ba2\u6237\u7aef\u8fde\u63a5\u5668\uff08\u5982 Connector/C\u3001Connector/J \u7b49\uff09\u3001MySQL Proxy \u4ee5\u53ca\u4e3b\u4ece\u590d\u5236\u4e2d\u90fd\u6709\u5b9e\u73b0\u3002\u8be5\u534f\u8bae\u7684\u7279\u6027\u5305\u62ec\uff1a\u652f\u6301 SSL\u3001\u538b\u7f29\u548c\u8ba4\u8bc1\u7b49\u529f\u80fd\u3002</p> <p>\u6b64\u5916\uff0cMySQL \u901a\u4fe1\u534f\u8bae\u8fd8\u652f\u6301\u591a\u79cd\u8fdb\u7a0b\u95f4\u901a\u4fe1\u65b9\u5f0f\uff0c\u4f8b\u5982\u7ba1\u9053\u3001\u547d\u540d\u7ba1\u9053\u3001\u5171\u4eab\u5185\u5b58\u3001TCP/IP \u5957\u63a5\u5b57\u548c UNIX \u57df\u5957\u63a5\u5b57\u7b49\u3002</p> <p>MySQL \u5ba2\u6237\u7aef\u548c\u670d\u52a1\u5668\u4e4b\u95f4\u7684\u901a\u4fe1\u600e\u4e48\u5b9e\u73b0\uff1f\u534f\u8bae\u7279\u5f81\u6709\u54ea\u4e9b\uff1f</p> <ul> <li> <p>MySQL \u5ba2\u6237\u7aef\u548c\u670d\u52a1\u5668\u4e4b\u95f4\u7684\u4f20\u8f93\u5c42\u901a\u4fe1\u662f\u57fa\u4e8e TCP \u534f\u8bae\u5b9e\u73b0\u7684\uff0c\u5e94\u7528\u5c42\u662f\u7531 MySQL \u81ea\u5df1\u7684\u5e94\u7528\u534f\u8bae MySQL \u534f\u8bae\u3002\u4ee5\u4e0b\u662f MySQL \u534f\u8bae\u7684\u4e00\u4e9b\u7279\u5f81\uff1a</p> </li> <li> <p>\u57fa\u4e8e\u8bf7\u6c42-\u54cd\u5e94\u6a21\u578b\uff1a\u901a\u4fe1\u8fc7\u7a0b\u4e2d\uff0c\u5ba2\u6237\u7aef\u53d1\u9001\u8bf7\u6c42\u5230\u670d\u52a1\u5668\uff0c\u670d\u52a1\u5668\u8fdb\u884c\u5904\u7406\u540e\u8fd4\u56de\u54cd\u5e94\u7ed9\u5ba2\u6237\u7aef\u3002</p> </li> <li> <p>\u4e8c\u8fdb\u5236\u534f\u8bae\uff1aMySQL \u534f\u8bae\u4f7f\u7528\u4e8c\u8fdb\u5236\u683c\u5f0f\u8fdb\u884c\u4f20\u8f93\uff0c\u6bcf\u4e2a\u6570\u636e\u62a5\u6587\u90fd\u5305\u542b\u4e86\u7279\u5b9a\u7684\u5b57\u6bb5\u7ed3\u6784\u4ee5\u53ca\u76f8\u5e94\u7684\u6570\u636e\u7c7b\u578b\u3002</p> </li> <li> <p>\u6570\u636e\u62a5\u6587\u683c\u5f0f\uff1a\u6570\u636e\u62a5\u6587\u7531\u56fa\u5b9a\u957f\u5ea6\u7684\u62a5\u5934\u548c\u53ef\u53d8\u957f\u5ea6\u7684\u6709\u6548\u8f7d\u8377\uff08payload\uff09\u7ec4\u6210\u3002\u62a5\u5934\u5305\u542b\u4e86\u534f\u8bae\u7248\u672c\u3001\u8fde\u63a5 ID\u3001\u6570\u636e\u957f\u5ea6\u7b49\u4fe1\u606f\u3002</p> </li> <li> <p>\u591a\u7ebf\u7a0b\u652f\u6301\uff1aMySQL \u534f\u8bae\u652f\u6301\u591a\u4e2a\u7ebf\u7a0b\u5728\u540c\u4e00\u4e2a\u8fde\u63a5\u4e0a\u5e76\u53d1\u6267\u884c\u591a\u4e2a\u67e5\u8be2\u3002\u670d\u52a1\u5668\u4f1a\u4e3a\u6bcf\u4e2a\u7ebf\u7a0b\u5206\u914d\u4e00\u4e2a\u7ebf\u7a0b ID\u3002</p> </li> <li> <p>\u957f\u8fde\u63a5\uff1aMySQL \u534f\u8bae\u652f\u6301\u957f\u8fde\u63a5\uff0c\u5373\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u5668\u4e4b\u95f4\u7684\u8fde\u63a5\u53ef\u4ee5\u4fdd\u6301\u5f00\u653e\u72b6\u6001\uff0c\u51cf\u5c11\u4e86\u8fde\u63a5\u548c\u65ad\u5f00\u8fde\u63a5\u7684\u5f00\u9500\u3002</p> </li> <li> <p>SQL \u8bed\u53e5\u652f\u6301\uff1aMySQL \u534f\u8bae\u53ef\u4ee5\u53d1\u9001 SQL \u8bed\u53e5\uff08\u5982\u67e5\u8be2\u8bed\u53e5\u3001\u4e8b\u52a1\u8bed\u53e5\u7b49\uff09\u5230\u670d\u52a1\u5668\u6267\u884c\uff0c\u5e76\u63a5\u6536\u670d\u52a1\u5668\u8fd4\u56de\u7684\u7ed3\u679c\u96c6\u3002</p> </li> <li> <p>\u9519\u8bef\u5904\u7406\uff1aMySQL \u534f\u8bae\u652f\u6301\u670d\u52a1\u5668\u8fd4\u56de\u9519\u8bef\u4fe1\u606f\uff0c\u5305\u62ec\u9519\u8bef\u4ee3\u7801\u548c\u9519\u8bef\u63cf\u8ff0\uff0c\u4ee5\u4fbf\u5ba2\u6237\u7aef\u5904\u7406\u5f02\u5e38\u60c5\u51b5\u3002</p> </li> <li> <p>\u5b89\u5168\u8fde\u63a5\uff1aMySQL \u534f\u8bae\u652f\u6301\u901a\u8fc7 <code>SSL/TLS</code> \u8fdb\u884c\u901a\u4fe1\u52a0\u5bc6\uff0c\u4fdd\u62a4\u4f1a\u8bdd\u6570\u636e\u7684\u5b89\u5168\u6027\u3002</p> </li> <li> <p>\u5e7f\u6cdb\u4f7f\u7528 flag \u6807\u8bb0\u4f4d\uff1a\u5728\u63e1\u624b\u9636\u6bb5\u7684\u767b\u5f55\u8bf7\u6c42\u54cd\u5e94\u62a5\u6587\u4e2d\u5305\u542b\u4e86\u670d\u52a1\u7aef\u80fd\u529bflag\u5b57\u6bb5\uff0c\u4ee5\u53ca\u4e1a\u52a1\u901a\u8baf\u4e2d\u7684\u6570\u636e\u62a5\u6587\u4e2d\u4e5f\u53ef\u4ee5\u5305\u542b\u670d\u52a1\u5668\u72b6\u6001flag\u6807\u8bb0\u4f4d\u3002</p> </li> </ul>"},{"location":"foundmental/1.MySQL%E5%8D%8F%E8%AE%AE%E5%88%86%E6%9E%90%E4%B8%8E%E6%8A%93%E5%8C%85%E6%A6%82%E8%BF%B0/#_3","title":"\u6570\u636e\u5305\u683c\u5f0f","text":"<p>MySQL\u7684\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u7aef\u4ea4\u4e92\u662f\u4ee5\u6570\u636e\u5305(Packet) \u4e3a\u5355\u4f4d\u8fdb\u884c\u7684, \u6bcf\u4e2a\u5305\u7684\u5927\u5c0f\u957f\u5ea6\u6709\u9650\u5236, \u6700\u957f\u4e3a 2^24 -1 \u4e2a\u5b57\u8282(\u5373 16MB)\u3002<code>max_allowed_packet</code> \u8868\u793a MySQL Server \u6216\u8005\u5ba2\u6237\u7aef\u63a5\u6536\u7684 packet \u7684\u6700\u5927\u5927\u5c0f\uff0cpacket \u5373\u6570\u636e\u5305\uff0cMySQL Server \u548c\u5ba2\u6237\u7aef\u4e0a\u90fd\u6709\u8fd9\u4e2a\u9650\u5236\u3002\u6ce8\u610f\uff0c\u8fd9\u91cc\u8bf4\u7684\u6570\u636e\u5305\u5927\u5c0f\u662f\u6307 MySQL \u5e94\u7528\u5c42\u5bf9\u6570\u636e\u7684\u7ea6\u5b9a\uff0c\u5728\u7f51\u7edc\u534f\u8bae\u5c01\u88c5\u4e2d\uff0cTCP \u5c42\u548c IP \u5c42\u5404\u81ea\u90fd\u6709\u5404\u81ea\u7684\u5355\u4e2a\u6570\u636e\u62a5\u6587\u9650\u5236\uff0c\u5373 MTU \u548c MSS \u7b49\u3002</p> <p>\u82e5\u5305\u957f\u5ea6\u8fc7\u5927, \u5219\u5ba2\u6237\u7aef\u9700\u8981\u81ea\u884c\u5c06\u5305\u5206\u7247, \u4f7f\u5f97\u6bcf\u6bb5\u7684\u957f\u5ea6\u5728 MySQL \u5305\u7684\u6700\u5927\u957f\u5ea6\u4e4b\u4e0b, MySQL Packet \u7531 Header \u548c Body \u7ec4\u6210, Header \u5305\u542b\u4e24\u4e2a\u5b57\u6bb5: \u5305\u957f\u5ea6(payload_length)\u3001\u5e8f\u5217\u53f7(sequence_id), Body \u5219\u662f\u5305\u7684\u4e3b\u4f53\u90e8\u5206, \u5b83\u7684\u957f\u5ea6\u7531 Header \u4e2d\u7684 payload_length \u5b57\u6bb5\u6307\u793a, \u5305\u957f\u5ea6\u5b57\u6bb5\u56fa\u5b9a\u4f7f\u7528 int&lt;3&gt; \u7c7b\u578b, \u5e8f\u5217\u53f7\u56fa\u5b9a\u4f7f\u7528 int&lt;1&gt; \u7c7b\u578b, \u5f53\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u7aef\u5f00\u59cb\u4ea4\u4e92\u65f6, \u7531\u5ba2\u6237\u7aef\u521d\u59cb\u5316 0 \u5e8f\u5217\u53f7, \u4e4b\u540e\u6bcf\u6b21\u4ea4\u4e92, \u6570\u636e\u53d1\u51fa\u65b9\u90fd\u57fa\u4e8e\u524d\u4e00\u4e2a sequence_id \u589e\u4e00, sequence_id \u4e0d\u662f\u6052\u5b9a\u552f\u4e00\u7684, \u5f53\u4ea4\u4e92\u6b21\u6570\u8db3\u591f\u591a\u540e, \u5b83\u4f1a\u91cd\u65b0\u56de\u5230 0\u3002</p> \u540d\u79f0 \u6570\u636e\u7c7b\u578b \u5360\u7528\u7a7a\u95f4 \u89e3\u6790 Packet Length\uff08payload_length\uff09 int&lt;3&gt; 3byte \u5305\u957f sequence_id int&lt;1&gt; \u5305\u5e8f\u53f7 payload <p>\u56e0\u4e3a\u524d\u4e09\u4e2a\u5b57\u8282\u6700\u5927\u53ea\u80fd\u8868\u8fbe16M\u7684\u957f\u5ea6\uff0c\u8fd9\u662f\u4e09\u4e2a\u5b57\u8282\u8868\u8fbe\u65e0\u7b26\u53f7\u6574\u578b\u7684\u6781\u9650\uff0c\u6240\u4ee5\uff0c\u6bcf\u6b21\u5ba2\u6237\u7aef\u53ef\u4ee5\u63a5\u53d7\u5230\u7684\u5355\u4e2a\u6700\u5927\u6570\u636e\u5305\u4e3a16M+4\u4e2a\u5b57\u8282\u3002</p> <p>\u5bf9\u4e8e<code>payload</code>\u90e8\u5206\u5927\u4e8e\u7b49\u4e8e16MB\u7684\uff0cMySQL\u4f1a\u5c06\u6570\u636e\u8fdb\u884c\u5207\u5206\uff0c\u6bcf16MB\u4e3a\u4e00\u90e8\u5206\uff0c\u7136\u540e\u5c06\u5207\u5206\u7684\u6570\u636e\u6309\u7167\u6570\u636e\u5305\u7684\u683c\u5f0f\u5c01\u88c5\uff0c\u8fdb\u884c\u53d1\u9001\uff0c\u76f4\u5230\u5207\u5206\u7684\u6570\u636e\u90e8\u5206\u957f\u5ea6\u5c0f\u4e8e16MB\u3002</p>"},{"location":"foundmental/1.MySQL%E5%8D%8F%E8%AE%AE%E5%88%86%E6%9E%90%E4%B8%8E%E6%8A%93%E5%8C%85%E6%A6%82%E8%BF%B0/#_4","title":"\u901a\u8baf\u8fc7\u7a0b","text":"<p>\u5728\u5b9e\u9645\u5e94\u7528\u4e2d\uff0c\u57fa\u4e8eTCP\u7684\u8fde\u63a5\u662f\u6700\u5e7f\u6cdb\u7684\uff0c\u8fd9\u91cc\u6211\u4eec\u4f7f\u7528 Wireshark \u5de5\u5177\u5728\u5ba2\u6237\u7aef\u6765\u6293\u53d6\u5e76\u5206\u6790 MySQL \u534f\u8bae\u3002</p> <p>MySQL \u5ba2\u6237\u7aef\u548c\u670d\u52a1\u7aef\u7684\u4ea4\u4e92\u8fc7\u7a0b\u4e3b\u8981\u5206\u4e3a\u4e24\u4e2a\u9636\u6bb5\uff1a\u8fde\u63a5\u5efa\u7acb\u9636\u6bb5\uff08\u6216\u8005\u6709\u7684\u4eba\u4e5f\u53eb\u63e1\u624b\u8ba4\u8bc1\u9636\u6bb5\uff0c\u5b98\u7f51\u6587\u6863\u53ebConnection Phase\uff09\u548c\u547d\u4ee4\u6267\u884c\u9636\u6bb5\uff08Command Phase\uff09\u3002</p> <p>\u63e1\u624b\u8ba4\u8bc1\u9636\u6bb5\u5728\u5ba2\u6237\u7aef\u4e0e\u670d\u52a1\u5668\u5efa\u7acb\u8fde\u63a5\u540e\u8fdb\u884c\uff08\u5373\u5728\u4e09\u6b21\u63e1\u624b\u540e\u8fdb\u884c\uff09\uff0c\u6574\u4f53\u4ea4\u4e92\u8fc7\u7a0b\u5982\u4e0b\uff1a</p> <p>1\uff09\u670d\u52a1\u5668 ===&gt; \u5ba2\u6237\u7aef\uff1a\u63e1\u624b\u521d\u59cb\u5316\u6d88\u606f\uff1b\u7531 MySQL \u670d\u52a1\u5668\u4e3b\u52a8\u53d1\u9001\u4e00\u4e2a\u8ba4\u8bc1\u7684\u63e1\u624b\u6570\u636e\u5305\uff1b</p> <p>2\uff09\u5ba2\u6237\u7aef ===&gt; \u670d\u52a1\u7aef\uff1a\u767b\u9646\u8ba4\u8bc1\u6d88\u606f\uff1b\u5ba2\u6237\u7aef\u6536\u5230\u63e1\u624b\u6570\u636e\u5305\u540e\uff0c\u5c06\u7528\u6237\u7684\u4fe1\u606f\uff08\u7528\u6237\u540d\u3001\u5bc6\u7801\u3001\u6570\u636e\u5e93\u7b49\u4fe1\u606f\uff09\u6253\u5305\u53d1\u9001\u7ed9 MySQL \u670d\u52a1\u5668\uff1b</p> <p>3\uff09\u670d\u52a1\u7aef ===&gt; \u5ba2\u6237\u7aef\uff1a\u8ba4\u8bc1\u7ed3\u679c\u6d88\u606f\uff1bMySQL \u670d\u52a1\u7aef\u8ba4\u8bc1\uff0c\u8fd4\u56de\u8ba4\u8bc1\u7ed3\u679c\u7ed9\u5ba2\u6237\u7aef\uff1b</p> <p>\u8ba4\u8bc1\u6210\u529f\uff1a\u5982\u679c\u670d\u52a1\u5668\u901a\u8fc7\u8ba4\u8bc1\uff0c\u5219\u53d1\u9001\u4e00\u4e2a Ok_pack \u5305\u7ed9\u5ba2\u6237\u7aef\uff1b</p> <p>\u8ba4\u8bc1\u5931\u8d25\uff1a\u5982\u679c\u670d\u52a1\u5668\u6ca1\u6709\u901a\u8fc7\u8ba4\u8bc1\uff0c\uff0c\u5219\u53d1\u9001\u4e00\u4e2a error_pack \u5305\uff1b</p> <p>\u6ce8\u610f\uff1a\u6b64\u5904\u63e1\u624b\u548c\u4e09\u6b21\u63e1\u624b\u4e0d\u662f\u4e00\u56de\u4e8b\uff1b</p> <p>\u95ee\u9898\u4e00\uff1aMySQL \u5ba2\u6237\u7aef\u4e0e\u670d\u52a1\u5668\u8fde\u63a5\u8fc7\u7a0b\u4e2d\uff0c\u8fdb\u884c\u4e86 TCP/IP \u7684\u4e09\u6b21\u63e1\u624b\u540e\uff0c\u4e3a\u4ec0\u4e48\u8fd8\u9700\u8981\u63e1\u624b\u8ba4\u8bc1\u9636\u6bb5\uff0c\u8fd9\u4e24\u6b21\u63e1\u624b\u5206\u522b\u8d77\u7740\u4ec0\u4e48\u6837\u7684\u4f5c\u7528\uff1f</p> <p>\u8fdb\u884c TCP/IP \u4e09\u6b21\u63e1\u624b\u662f\u4e3a\u4e86\u786e\u4fdd\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u5668\u7684\u4f20\u8f93\u5c42\u6b63\u786e\u5efa\u7acbTCP\u8fde\u63a5\uff0c\u5e76\u534f\u5546\u4f20\u8f93\u5c42\u4f7f\u7528\u7684\u7aef\u53e3\u548c\u901a\u4fe1\u534f\u8bae\u3002\u901a\u8fc7\u4e09\u6b21\u63e1\u624b\uff0c\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u5668\u80fd\u591f\u786e\u8ba4\u53cc\u65b9\u7684\u53d1\u9001\u548c\u63a5\u6536\u80fd\u529b\uff0c\u5e76\u907f\u514d\u7531\u4e8e\u7f51\u7edc\u95ee\u9898\u5bfc\u81f4\u7684\u8fde\u63a5\u9519\u8bef\u3002\u7136\u800c\uff0c\u4ec5\u4ec5\u8fdb\u884c TCP/IP \u4e09\u6b21\u63e1\u624b\u5e76\u4e0d\u80fd\u4fdd\u8bc1\u5ba2\u6237\u7aef\u7684\u8eab\u4efd\u662f\u53ef\u4fe1\u7684\u3002\u56e0\u6b64\uff0c\u5728\u5efa\u7acb\u4e86\u53ef\u9760\u7684\u8fde\u63a5\u4e4b\u540e\uff0c\u8fd8\u9700\u8981\u8fdb\u884c\u63e1\u624b\u8ba4\u8bc1\u9636\u6bb5\u3002\u5728\u8fd9\u4e2a\u9636\u6bb5\uff0c\u5ba2\u6237\u7aef\u9700\u8981\u5411\u670d\u52a1\u5668\u63d0\u4f9b\u8eab\u4efd\u9a8c\u8bc1\u4fe1\u606f\uff0c\u5982\u7528\u6237\u540d\u3001\u5bc6\u7801\u7b49\uff0c\u4ee5\u8bc1\u660e\u81ea\u5df1\u7684\u8eab\u4efd\u3002\u670d\u52a1\u5668\u4f1a\u9a8c\u8bc1\u5ba2\u6237\u7aef\u63d0\u4f9b\u7684\u8eab\u4efd\u9a8c\u8bc1\u4fe1\u606f\uff0c\u5e76\u51b3\u5b9a\u662f\u5426\u5141\u8bb8\u8be5\u5ba2\u6237\u7aef\u5efa\u7acb\u8fde\u63a5\u3002\u8fd9\u4e2a\u6240\u8c13\u7684\u63e1\u624b\u9636\u6bb5\uff0c\u662fMySQL\u534f\u8bae\u5185\u4e2d\u5b9a\u4e49\u7684\u7684\u63e1\u624b</p> <p>\u95ee\u9898\u4e8c\uff1a\u5728\u63e1\u624b\u8ba4\u8bc1\u9636\u6bb5\uff0c\u4e3a\u4ec0\u4e48\u670d\u52a1\u5668\u4f1a\u4e3b\u52a8\u53d1\u9001\u4e00\u4e2a\u8ba4\u8bc1\u7684\u63e1\u624b\u6570\u636e\u5305\uff1f</p> <p>\u8fde\u63a5\u5efa\u7acb\u9636\u6bb5\u4e3b\u8981\u7684\u5de5\u4f5c\u662f\uff1a\u8eab\u4efd\u8ba4\u8bc1\u5efa\u7acb\u8fde\u63a5\u3002\u8fd9\u4e2a\u63e1\u624b\u6570\u636e\u5305\u5305\u542b\u4e86\u670d\u52a1\u5668\u7528\u4e8e\u8eab\u4efd\u9a8c\u8bc1\u7684\u4fe1\u606f\uff0c\u5982\uff1a\u534f\u8bae\u7248\u672c\u53f7\u3001\u670d\u52a1\u5668\u7248\u672c\u53f7\u3001\u670d\u52a1\u5668\u6743\u80fd\u6807\u5fd7\u7b49\uff08\u5373\u63e1\u624b\u521d\u59cb\u5316\u62a5\u6587\u4e2d\u7684\u4fe1\u606f\uff09\uff0c\u5176\u4e2d\u6700\u4e3b\u8981\u662f\u52a0\u5bc6\u968f\u673a\u6570\uff08Salt\u52a0\u76d0\uff09\u3002\u8fd9\u4e9b\u4fe1\u606f\u7528\u4e8e\u544a\u8bc9\u5ba2\u6237\u7aef\u670d\u52a1\u5668\u7684\u8eab\u4efd\u548c\u6240\u4f7f\u7528\u7684\u534f\u8bae\u7248\u672c\uff0c\u4ee5\u4fbf\u5ba2\u6237\u7aef\u80fd\u591f\u8fdb\u884c\u6b63\u786e\u7684\u8eab\u4efd\u9a8c\u8bc1\u548c\u540e\u7eed\u7684\u901a\u4fe1\u3002</p> <p>\u5728\u63e1\u624b\u8fc7\u7a0b\u4e2d\uff0c\u5ba2\u6237\u7aef\u4e5f\u4f1a\u53d1\u9001\u81ea\u5df1\u7684\u8eab\u4efd\u9a8c\u8bc1\u4fe1\u606f\uff0c\u5982\uff1a\u7528\u6237\u540d\u3001\u6570\u636e\u5e93\u540d\u548c\u5bc6\u7801\uff08\u628a\u660e\u6587\u5bc6\u7801\u901a\u8fc7\u76d0\u503c\u6765\u52a0\u5bc6\u540e\uff0c\u518d\u53d1\u56de\u7ed9\u670d\u52a1\u5668\uff09\u7b49\uff0c\u6765\u8bc1\u660e\u81ea\u5df1\u7684\u8eab\u4efd\u3002\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u5668\u4e4b\u95f4\u4f1a\u8fdb\u884c\u53cc\u5411\u7684\u8eab\u4efd\u9a8c\u8bc1\uff0c\u786e\u4fdd\u8fde\u63a5\u7684\u5b89\u5168\u6027\u3002</p> <p>When you connect to a MySQL server, you should use a password. The password is not transmitted as cleartext over the connection.</p> <p>\u7b80\u5355\u8bf4\uff0c\u5728\u8fde\u63a5\u9636\u6bb5\uff0c\u5ba2\u6237\u63d0\u4f9b\u8eab\u4efd\u8ba4\u8bc1\u65f6\uff1a\u5ba2\u6237\u7aef\u4f1a\u57fa\u4e8e\u670d\u52a1\u7aef\u53d1\u9001\u7684\u76d0\u503c\u5bf9\u660e\u6587\u5bc6\u7801\u8fdb\u884c\u52a0\u5bc6\uff0c\u6700\u540e\u5c06\u52a0\u5bc6\u540e\u7684\u7ed3\u679c\u53d1\u9001\u7ed9\u670d\u52a1\u7aef\uff0c\u5e76\u4e0d\u4f1a\u76f4\u63a5\u53d1\u9001\u660e\u6587\u5bc6\u7801\u3002</p> <p>\u5ba2\u6237\u7aef\u6536\u5230<code>random string</code>\u540e\uff0c\u4f7f\u7528hash\u5bf9\u5bc6\u7801\u52a0\u5bc6\uff0c\u8fc7\u7a0b\u5982\u4e0b\uff1a</p> <ul> <li>\u7b2c\u4e00\u6b65\uff0c\u5c06\u5bc6\u7801hash\uff0c\u5f97\u5230hash\u503c<code>hash_stage1</code>; <code>eg.hash_stage1=sha1(\"password\")</code>; </li> <li>\u7b2c\u4e8c\u6b65\uff0c\u4e8c\u6b21hash\uff0c\u5f97\u5230<code>hash_stage2</code>; <code>eg. hash_stage2=sha1(hash_stage1)</code>;</li> <li>\u7b2c\u4e09\u6b65\uff0c\u5c06\u5bc6\u7801\u4e8c\u6b21hash\u5f97\u5230\u7684\u503c\u4e0e<code>random string</code>\u8fdb\u884chash\uff0c\u5f97\u5230<code>hash_stage3</code>; <code>eg. hash_stage3=sha1(\"randomstring\",hash_stage2)</code>;</li> <li>\u7b2c\u56db\u6b65\uff0c\u5f02\u6216\u5904\u7406\u51c6\u5907\u53d1\u9001\u7ed9\u670d\u52a1\u5668\u7aef\uff0c\u5f97\u5230<code>reply=xor(hash_stage1,hash_stage3)</code>;</li> </ul> <p>\u670d\u52a1\u5668\u7aef\u6536\u5230reply\u540e\u540c\u6837\u8fdb\u884chash\u8fd0\u7b97\uff0c\u8fc7\u7a0b\u5982\u4e0b\uff1a</p> <ul> <li> <p>\u7b2c\u4e00\u6b65\uff0c\u5c06\u4fdd\u5b58\u7684hash\u5f62\u5f0f\u7684\u5bc6\u7801<code>hashpassword</code>\u4e0e<code>random string</code>\u8fdb\u884chash\uff0c\u5f97\u5230<code>server_hash_stage1=sha1(\"randomstring\",\"hashpassword\")</code>;</p> </li> <li> <p>\u7b2c\u4e8c\u6b65\uff0c\u5c06\u5ba2\u6237\u7aef\u53d1\u9001\u7684reply\u4e0e\u521a\u624d\u5f97\u5230\u7684hash\u503c\u8fdb\u884c\u5f02\u6216\u8fd0\u7b97\uff0c\u5f97\u5230<code>xor_value\uff1b eg. xor_value=xor(reply,server_hash_stage1)</code>;</p> </li> <li> <p>\u7b2c\u4e09\u6b65\uff0c\u5c06\u5f97\u5230\u7684\u5f02\u6216\u503c\u8fdb\u884chash\uff0c\u5f97\u5230<code>server_hash_stage2</code>\uff1b <code>eg. server_hash_stage2=sha1(server_hash_stage1)</code>;</p> </li> <li> <p>\u7b2c\u56db\u6b65\uff0c\u9a8c\u8bc1\uff0c\u5c06\u6700\u540e\u5f97\u5230\u7684hash\u503c<code>server_hash_stage2</code>\u4e0e\u4fdd\u5b58\u7684\u5bc6\u7801<code>hashpassword</code>\u8fdb\u884c\u6bd4\u8f83\u3002<code>eg.  server_hash_stage2==hashpassword</code>\uff0c\u76f8\u7b49\u5219\u9a8c\u8bc1\u901a\u8fc7\u3002</p> </li> </ul> <p>https://www.cnblogs.com/ivictor/p/17953165</p>"},{"location":"foundmental/1.MySQL%E5%8D%8F%E8%AE%AE%E5%88%86%E6%9E%90%E4%B8%8E%E6%8A%93%E5%8C%85%E6%A6%82%E8%BF%B0/#_5","title":"\u8fde\u63a5\u5efa\u7acb\u9636\u6bb5","text":"<p>MySQL \u8fde\u63a5\u7684\u65b9\u5f0f\u6709\u591a\u79cd, \u6bd4\u5982 TCP/IPv4\u3001TCP/IPv6\u3001UNIX domain sockets \u7b49, \u6211\u4eec\u4ee5 TCP \u8fde\u63a5\u4e3a\u4f8b\u6765\u8ba8\u8bba\u8fde\u63a5\u5efa\u7acb\u8fc7\u7a0b\uff1a</p> <p></p> <p>\u4e3b\u8981\u4ea4\u4e92\u8fc7\u7a0b\u5982\u4e0b\uff1a</p> <ul> <li>TCP\u4e09\u6b21\u63e1\u624b\uff0c\u8fd9\u91cc\u5c31\u4e0d\u505a\u8fc7\u591a\u8d58\u8ff0\uff0c\u4e00\u53e5\u8bdd\uff1a\u4efb\u4f55\u57fa\u4e8eTCP\u7684\u5e94\u7528\u90fd\u8981\u7ecf\u5386\u8fd9\u4e2a\u8fc7\u7a0b\u3002</li> <li>MySQL\u534f\u8bae\uff1a\u670d\u52a1\u5668 -&gt; \u5ba2\u6237\u7aef \uff0c\u63e1\u624b\u521d\u59cb\u5316\u6d88\u606f\uff08Initial HandShake Packet\uff09\u3002\u5b98\u7f51\u6587\u6863\u53eb Protocol::Handshake \uff0c\u5728 Wireshark\u4e2d\u6293\u5230\u62a5\u6587\u53eb Server Greeting\u3002\u521d\u6b21\u63e1\u624b\u4ece\u670d\u52a1\u5668\u5411\u5ba2\u6237\u7aef\u53d1\u9001<code>Protocol::Handshake</code>\u6570\u636e\u5305\u5f00\u59cb\u3002\u5728\u8fd9\u4e4b\u540e\uff0c\u5ba2\u6237\u7aef\u53ef\u4ee5\u9009\u62e9\u4f7f\u7528<code>Protocol::SSLRequest</code>\u6570\u636e\u5305\u8bf7\u6c42\u5efa\u7acbSSL\u8fde\u63a5\uff0c\u7136\u540e\u5ba2\u6237\u7aef\u53d1\u9001<code>Protocol::HandshakeResponse</code>\u6570\u636e\u5305\u3002\u8fd9\u91cc\u6211\u4eec\u5ffd\u7565SSL\u8fc7\u7a0b\uff08\u5047\u5b9a\u5ba2\u6237\u7aef\u4e0d\u8bf7\u6c42SSL\u8fde\u63a5\uff09\uff0c\u56e0\u4e3a\u6570\u636e\u5e93\u5efa\u7acbSSL\u8fde\u63a5\u5f00\u9500\u633a\u5927\u7684\uff0c\u5b9e\u9645\u751f\u4ea7\u4e2d\u4e5f\u5f88\u5c11\u8fd9\u6837\u505a\u3002MySQL\u7684\u901a\u4fe1\u662f\u5426\u52a0\u5bc6\uff0c\u662f\u7531\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u7aef\u5171\u540c\u534f\u5546\u662f\u5426\u5f00\u542f\u7684\uff0c\u5ba2\u6237\u7aef\u4e0e\u670d\u52a1\u7aef\u90fd\u5904\u4e8e\u9ed8\u8ba4\u914d\u7f6e\u4e0b\u7684\u8bdd\uff0c\u6709\u4e9b\u7c7b\u4f3c\u4e8e StartTls\u3002</li> <li>MySQL\u534f\u8bae\uff1a\u5ba2\u6237\u7aef -&gt; \u670d\u52a1\u5668\uff1a\u767b\u9646\u8bf7\u6c42\u8ba4\u8bc1\u6d88\u606f\uff08Handshake Response Packet\uff09\u3002\u5b98\u7f51\u6587\u6863\u53eb  Protocol::HandshakeResponse\uff0c\u5728 Wireshark\u4e2d\u6293\u5230\u62a5\u6587\u53eb Login Request\u3002\u5ba2\u6237\u7aef\u89e3\u6790\u9996\u5305\u540e\uff0c\u4f1a\u53d1\u9001<code>Protocol::HandshakeResponse</code>\u6570\u636e\u5305\uff0c\u6570\u636e\u5305\u4e2d\u643a\u5e26\u80fd\u529b\u4ea4\u6362\u4fe1\u606f\uff0c\u8981\u767b\u5f55\u7684\u7528\u6237\u7b49, \u5728\u8fd9\u4e2a\u9636\u6bb5</li> <li>MySQL\u534f\u8bae\uff1a\u670d\u52a1\u5668 -&gt; \u5ba2\u6237\u7aef\uff1a\u8ba4\u8bc1\u7ed3\u679c\u6d88\u606f </li> </ul>"},{"location":"foundmental/1.MySQL%E5%8D%8F%E8%AE%AE%E5%88%86%E6%9E%90%E4%B8%8E%E6%8A%93%E5%8C%85%E6%A6%82%E8%BF%B0/#_6","title":"\u529f\u80fd\u534f\u5546","text":"<p>\u4e3a\u4e86\u5141\u8bb8\u65e7\u5ba2\u6237\u7aef\u8fde\u63a5\u5230\u65b0\u670d\u52a1\u5668\uff0c<code>Protocol::Handshake</code>\u5305\u542bMySQL\u670d\u52a1\u5668\u7248\u672c\u5373\u670d\u52a1\u5668\u7684\u529f\u80fd\u6807\u5fd7\u3002</p> <p>\u5ba2\u6237\u7aef\u5728<code>Protocol::HandshakeResponse</code>\u4e2d\u53ea\u58f0\u660e\u4e0e\u670d\u52a1\u5668\u76f8\u540c\u7684\u529f\u80fd\u3002</p> <p>\u7136\u540e\u4f7f\u7528\u5982\u4e0b\u53c2\u6570\u8fbe\u6210\u4e00\u81f4\uff1a</p> <ul> <li>\u72b6\u6001\u6807\u8bc6\uff08status flags\uff09</li> <li>SQL\u72b6\u6001\u9519\u8bef\u7801\uff08SQL states for error codes\uff09</li> <li>\u8ba4\u8bc1\u65b9\u6cd5\uff08authentication methods\uff09</li> <li>SSL\uff08SSL Support\uff09</li> <li>\u538b\u7f29\uff08Compression\uff09</li> </ul> <p>MySQL\u901a\u4fe1\u662f\u5426\u5f00\u542fTLS\u52a0\u5bc6\uff0c\u662f\u7531\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u7aef\u5171\u540c\u534f\u5546\u662f\u5426\u5f00\u542f\u7684\uff0c\u5ba2\u6237\u7aef\u4e0e\u670d\u52a1\u7aef\u90fd\u5904\u4e8e\u9ed8\u8ba4\u914d\u7f6e\u4e0b\u7684\u8bdd\uff0c\u6709\u4e9b\u7c7b\u4f3c\u4e8e\u7535\u5b50\u90ae\u4ef6\u901a\u4fe1\u573a\u666f\u4e2dSTARTTLS\u534f\u5546\u3002</p> <p>\u670d\u52a1\u7aef\u5728\u53d1\u9001<code>Protocol::Handshake</code>\u4e2d\u5378\u8f7d<code>Capabilities Flag</code>\u3002\u987e\u540d\u601d\u4e49\uff0c\u8fd9\u5c31\u662f\u7528\u6765\u505a\u517c\u5bb9\u6027\uff0c\u6216\u8005\u8bf4\u7279\u6027\u5f00\u5173\u7684 flag\uff0c\u5927\u5c0f\u4e3a 2 \u4e2a\u5b57\u8282\uff0c\u5176\u4e2d\u7684\u7b2c 12 \u4f4d\uff0c\u4ee3\u8868\u7740 <code>CLIENT_SSL</code>\uff0c\u5982\u679c\u8bbe\u7f6e\u4e3a 1\uff0c\u90a3\u4ee3\u8868\u7740\u5982\u679c\u5ba2\u6237\u7aef\u5177\u5907\u80fd\u529b\uff0c\u670d\u52a1\u7aef\u53ef\u4ee5\u5728\u540e\u9762\u7684\u4f1a\u8bdd\u4e2d\u5207\u6362\u5230 TLS\u3002</p> <p>\u5982\u679c\u6211\u4eec\u5728\u670d\u52a1\u5668\u4e0a</p>"},{"location":"foundmental/1.MySQL%E5%8D%8F%E8%AE%AE%E5%88%86%E6%9E%90%E4%B8%8E%E6%8A%93%E5%8C%85%E6%A6%82%E8%BF%B0/#_7","title":"\u786e\u8ba4\u8eab\u4efd\u9a8c\u8bc1\u65b9\u6cd5","text":"<p>\u7528\u6237\u8eab\u4efd\u9a8c\u8bc1\u65b9\u6cd5\uff08\u5176\u5b9e\u5c31\u662f\u52a0\u5bc6\u65b9\u6cd5\uff09\u5c06\u4e0e\u7528\u6237\u5e10\u6237\u5173\u8054\uff0c\u5e76\u5b58\u50a8\u5728<code>mysql.user</code>\u8868\u7684<code>plugin</code>\u5217\u4e2d\u3002</p> <p>\u5ba2\u6237\u7aef\u5728<code>Protocol::HandshakeResponse</code>\u6570\u636e\u5305\u4e2d\u53d1\u9001\u5c06\u8981\u767b\u5f55\u7684\u7528\u6237\u5e10\u6237\u3002\u670d\u52a1\u5668\u67e5\u627e<code>mysql.user</code>\u8868\u5e76\u627e\u5230\u8981\u5f53\u524d\u767b\u5f55\u7528\u6237\u4f7f\u7528\u7684\u8eab\u4efd\u9a8c\u8bc1\u65b9\u6cd5\u3002</p> <p>\u4e3a\u8282\u7701\u901a\u4fe1\u6210\u672c\uff0c\u670d\u52a1\u5668\u548c\u5ba2\u6237\u7aef\u5728\u53d1\u9001\u521d\u59cb<code>Handshake</code>\u6570\u636e\u5305\u65f6\u5c31\u5bf9\u8981\u4f7f\u7528\u7684\u8eab\u4efd\u9a8c\u8bc1\u65b9\u6cd5\u8fdb\u884c\u4e86**\u4e50\u89c2\u63a8\u6d4b**\u3002</p> <p>\u670d\u52a1\u5668\u4f7f\u7528\u5176\u9ed8\u8ba4\u8eab\u4efd\u9a8c\u8bc1\u65b9\u6cd5<code>default_auth_plugin</code>\u751f\u6210\u521d\u59cb\u8eab\u4efd\u9a8c\u8bc1\u6570\u636e\u7684\u6709\u6548\u8d1f\u8f7d\uff0c\u5e76\u5c06\u5176\u4e0e\u65b9\u6cd5\u540d\u653e\u5728<code>Protocol::Handshake</code>\u4e2d\u4e00\u8d77\u53d1\u7ed9\u5ba2\u6237\u7aef\u3002</p> <p>\u5ba2\u6237\u7aef\u5728<code>Protocol::HandshakeResponse</code>\u4e2d\u5305\u542b\u5bf9\u670d\u52a1\u5668\u53d1\u9001\u7684\u8eab\u4efd\u9a8c\u8bc1\u6570\u636e\u7684\u7b54\u590d\u3002\u5728\u8fd9\u4e2a\u7b54\u590d\u8fc7\u7a0b\uff0c\u5ba2\u6237\u7aef**\u6ca1\u6709\u4e49\u52a1\u4e00\u5b9a\u8981**\u4f7f\u7528\u4e0e<code>Protocol::Handshake</code>\u6570\u636e\u5305\u4e2d\u670d\u52a1\u5668\u6240\u4f7f\u7528\u7684\u8eab\u4efd\u9a8c\u8bc1\u65b9\u6cd5\u76f8\u540c\u7684\u8eab\u4efd\u9a8c\u8bc1\u65b9\u6cd5\u3002\u5ba2\u6237\u7aef\u4f7f\u7528\u7684\u8eab\u4efd\u9a8c\u8bc1\u65b9\u6cd5\u7684\u540d\u79f0\u5b58\u50a8\u5728\u54cd\u5e94\u6570\u636e\u5305\u4e2d\u3002\u5982\u679c\u5ba2\u6237\u7aef\u6216\u670d\u52a1\u5668\u5728\u521d\u59cb\u63e1\u624b\u4e2d\u5305\u6362\u7684\u63a8\u6d4b\u8eab\u4efd\u9a8c\u8bc1\u65b9\u6cd5\u4e0d\u5339\u914d\uff0c\u5219\u670d\u52a1\u7aef\u4f1a\u4f7f\u7528<code>Protocol::AuthSwitchRequest</code>\u901a\u77e5\u5ba2\u6237\u7aef\u5e94\u4f7f\u7528\u54ea\u79cd\u8eab\u4efd\u9a8c\u8bc1\u65b9\u6cd5\u3002\u8fd9\u4e2a\u5c31\u662f**\u534f\u5546\u9a8c\u8bc1\u9a8c\u8bc1\u65b9\u6cd5\u7684\u8fc7\u7a0b**</p> <p>\u5728 MySQL 8.0.27 \u4e4b\u524d\uff0ccreate user \u7684\u65f6\u5019\u53ef\u4ee5\u6307\u5b9a\u4e00\u79cd\u8ba4\u8bc1\u63d2\u4ef6\uff08\u5c31\u662f\u52a0\u5bc6\u65b9\u6cd5\uff09\uff0c\u5728\u672a\u660e\u786e\u6307\u5b9a\u7684\u60c5\u51b5\u4e0b\u4f1a\u53d6\u7cfb\u7edf\u53d8\u91cf default_authentication_plugin\u7684\u503c\u3002default_authentication_plugin \u7684\u6709\u6548\u503c\u67093\u4e2a\uff0c\u5206\u522b\u662f mysql_native_password \uff0csha256_password \uff0ccaching_sha2_password \uff0c\u8fd9\u4e2a3\u4e2a\u8ba4\u8bc1\u63d2\u4ef6\u662f\u5185\u7f6e\u7684\u3001\u4e0d\u9700\u8981\u6ce8\u518c\u6b65\u9aa4\u7684\u63d2\u4ef6\u3002default_authentication_plugin \u8fd9\u4e2a\u53c2\u6570\u57288.0.27\u4e2d\u88abdeprecated \uff0c\u5728\u672a\u6765\u7684\u7248\u672c\u4e2d\u53ef\u80fd\u4f1a\u88ab\u5f03\u7528\u3002</p> <p>\u5728 MySQL 8.0.27 \u4e2d\uff0c\u5f15\u5165 <code>authentication_policy</code> \u914d\u7f6e\u6765\u7ba1\u7406\u7528\u6237\u7684\u8eab\u4efd\u8ba4\u8bc1\uff08\u53ef\u4ee5\u5b9e\u73b0\u591a\u56e0\u7d20\u8eab\u4efd\u8ba4\u8bc1\uff09\u3002</p> <p>\u5728MySQL 4.0\u4e4b\u524d\uff0cMySQL\u534f\u8bae\u4ec5\u652f\u6301<code>Old Password Authentication</code>\u3002\u5728MySQL 4.1\u4e2d\uff0c\u6dfb\u52a0\u4e86<code>Native Authentication</code>\u65b9\u6cd5\uff0c\u800c\u5728MySQL 5.5\u4e2d\uff0c\u53ef\u4ee5\u901a\u8fc7**\u8eab\u4efd\u9a8c\u8bc1\u63d2\u4ef6**\u5b9e\u73b0\u4efb\u610f\u8eab\u4efd\u9a8c\u8bc1\u65b9\u6cd5\u3002</p> <p>\u5982\u679c\u5ba2\u6237\u7aef\u6216\u670d\u52a1\u5668\u4e0d\u652f\u6301\u63d2\u4ef6\u5f0f\u8eab\u4efd\u9a8c\u8bc1\uff08\u5373\u672a\u8bbe\u7f6e<code>CLIENT_PLUGIN_AUTH</code>\u529f\u80fd\u6807\u5fd7\uff09\uff0c\u5219\u4ece\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u5668\u529f\u80fd\u7ee7\u627f\u4f7f\u7528\u7684\u8eab\u4efd\u9a8c\u8bc1\u65b9\u6cd5\uff0c\u5982\u4e0b\u6240\u793a\uff1a</p> <ul> <li>\u5982\u679c\u672a\u8bbe\u7f6e<code>CLIENT_PROTOCOL_41</code>\u6216<code>CLIENT_SECURE_CONNECTION</code>\uff0c\u5219\u4f7f\u7528\u7684\u65b9\u6cd5\u662f<code>Old Password Authentication</code>\u3002</li> <li>\u5982\u679c\u540c\u65f6\u8bbe\u7f6e\u4e86<code>CLIENT_PROTOCOL_41</code>\u548c<code>CLIENT_SECURE_CONNECTION</code>\uff0c\u4f46\u672a\u8bbe\u7f6e<code>CLIENT_PLUGIN_AUTH</code>\uff0c\u5219\u4f7f\u7528\u7684\u65b9\u6cd5\u662f<code>Native Authentication</code>\u3002</li> </ul> <p>\u8fd9\u4e2a\u57fa\u672c\u4e0a\u662f\u4e0a\u53e4\u65f6\u4ee3\u7684MySQL\u548c\u5ba2\u6237\u7aef\uff0c\u53ef\u4ee5\u4e0d\u7528\u7ba1\u3002</p>"},{"location":"foundmental/1.MySQL%E5%8D%8F%E8%AE%AE%E5%88%86%E6%9E%90%E4%B8%8E%E6%8A%93%E5%8C%85%E6%A6%82%E8%BF%B0/#_8","title":"\u5feb\u901f\u8eab\u4efd\u9a8c\u8bc1","text":"<p>\u5047\u8bbe\u5ba2\u6237\u7aef\u8981\u901a\u8fc7\u7528\u6237\u5e10\u6237<code>U</code>\u767b\u5f55\uff0c\u5e76\u4e14\u8be5\u7528\u6237\u5e10\u6237\u5df2\u5b9a\u4e49\u4e3a\u4f7f\u7528\u8eab\u4efd\u9a8c\u8bc1\u65b9\u6cd5<code>server_method</code>\u3002\u5728\u4ee5\u4e0b\u60c5\u51b5\u4e0b\u4f7f\u7528\u5feb\u901f\u8eab\u4efd\u9a8c\u8bc1\u8def\u5f84\uff1a</p> <ul> <li>\u670d\u52a1\u5668\u4f7f\u7528<code>server_method</code>\u751f\u6210\u8eab\u4efd\u9a8c\u8bc1\u6570\u636e\u540e\u653e\u5165<code>Protocol::Handshake</code>\u6570\u636e\u5305\u4e2d\u3002</li> <li>\u5ba2\u6237\u7aef\u5728<code>Protocol::HandshakeResponse</code>\u4e2d\u58f0\u660e\u4f7f\u7528<code>client_authentication_method</code>\uff0c\u8be5\u65b9\u6cd5\u4e0e\u670d\u52a1\u5668\u4f7f\u7528\u7684<code>server_method</code>\u517c\u5bb9\u3002</li> </ul> <p>\u8fd9\u6837\u5728\u63e1\u624b\u671f\u95f4\u5c31\u5df2\u7ecf\u5f00\u59cb\u4e86\u7b2c\u4e00\u8f6e\u8eab\u4efd\u9a8c\u8bc1\u3002\u7136\u540e\uff0c\u6839\u636e\u8eab\u4efd\u9a8c\u8bc1\u65b9\u6cd5<code>server_method</code>\uff0c\u8fdb\u4e00\u6b65\u4ea4\u6362\u8eab\u4efd\u9a8c\u8bc1\uff0c\u76f4\u5230\u670d\u52a1\u5668\u63a5\u53d7\u6216\u62d2\u7edd\u8eab\u4efd\u9a8c\u8bc1\u4e3a\u6b62\u3002</p>"},{"location":"foundmental/1.MySQL%E5%8D%8F%E8%AE%AE%E5%88%86%E6%9E%90%E4%B8%8E%E6%8A%93%E5%8C%85%E6%A6%82%E8%BF%B0/#_9","title":"\u9a8c\u8bc1\u65b9\u6cd5\u4e0d\u5339\u914d","text":"<p>\u5047\u8bbe\u5ba2\u6237\u7aef\u8981\u4ee5\u7528\u6237<code>U</code>\u8eab\u4efd\u767b\u5f55\uff0c\u5e76\u4e14\u8be5\u7528\u6237\u5e10\u6237\u4f7f\u7528\u8eab\u4efd\u9a8c\u8bc1\u65b9\u6cd5<code>M</code>\u3002\u5982\u679c\uff1a</p> <ol> <li>\u670d\u52a1\u5668\u7528\u4e8e\u751f\u6210\u653e\u5728<code>Protocol::Handshake</code>\u6570\u636e\u5305\u4e2d\u7684\u8eab\u4efd\u9a8c\u8bc1\u6709\u6548\u8d1f\u8f7d\u7684\u9ed8\u8ba4\u65b9\u6cd5\u4e0e<code>M</code>\u4e0d\u540c</li> <li>\u5ba2\u6237\u7aef\u7528\u4e8e\u751f\u6210\u653e\u5728<code>Protocol::HandshakeResponse</code>\u6570\u636e\u5305\u4e2d\u7684\u65b9\u6cd5\u4e0e<code>M</code>\u4e0d\u517c\u5bb9</li> </ol> <p>\u5219\u8bf4\u660e\u8eab\u4efd\u9a8c\u8bc1\u65b9\u6cd5\u4e0d\u5339\u914d\uff0c\u5fc5\u987b\u4f7f\u7528\u6b63\u786e\u7684\u8eab\u4efd\u9a8c\u8bc1\u65b9\u6cd5\u91cd\u65b0\u542f\u52a8\u8eab\u4efd\u9a8c\u8bc1\u4ea4\u6362\u8fc7\u7a0b\u3002</p> <p>\u6ce8\u610f\uff1a</p> <ol> <li>\u5373\u4f7f\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u5668\u5728\u521d\u59cb\u63e1\u624b\u4e2d\u4f7f\u7528\u4e86\u517c\u5bb9\u7684\u8eab\u4efd\u9a8c\u8bc1\u65b9\u6cd5\uff0c\u4e5f\u53ef\u80fd\u53d1\u751f\u4e0d\u5339\u914d\uff0c\u56e0\u4e3a\u670d\u52a1\u5668\u4f7f\u7528\u7684\u65b9\u6cd5\u4e0e\u7528\u6237\u5e10\u6237\u5b9e\u9645\u7528\u7684\u65b9\u6cd5\u4e0d\u540c\u3002</li> <li>\u57284.1-5.7\u7248\u672c\u7684\u670d\u52a1\u5668\u548c\u5ba2\u6237\u7aef\u4e2d\uff0c\u9ed8\u8ba4\u8eab\u4efd\u9a8c\u8bc1\u65b9\u6cd5\u662f<code>Native Authentication</code>\u3002</li> <li>\u57288.0\u7248\u672c\u7684\u670d\u52a1\u5668\u548c\u5ba2\u6237\u7aef\u4e2d\uff0c\u9ed8\u8ba4\u7684\u8eab\u4efd\u9a8c\u8bc1\u65b9\u6cd5\u662f<code>Caching_sha2_password information</code>\u3002</li> <li>\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u5668\u53ef\u4ee5\u901a\u8fc7<code>--default-auth</code>\u9009\u9879\u66f4\u6539\u5176\u9ed8\u8ba4\u8eab\u4efd\u9a8c\u8bc1\u65b9\u6cd5\u3002</li> <li>\u5bf9\u5ba2\u6237\u7aef\u6765\u8bf4\uff0c\u67e5\u770b\u5728<code>Protocol::Handshake</code>\u6570\u636e\u5305\u4e2d\u58f0\u660e\u7684\u670d\u52a1\u5668\u7684\u9ed8\u8ba4\u8eab\u4efd\u9a8c\u8bc1\u65b9\u6cd5\uff0c\u5e76\u4ece\u4e2d\u63a8\u65ad\u51fa\u8eab\u4efd\u9a8c\u8bc1\u65b9\u6cd5\uff0c\u6bd4\u5728\u751f\u6210<code>Protocol::HandshakeResponse</code>\u6570\u636e\u5305\u65f6\u76f4\u63a5\u4f7f\u7528\u5ba2\u6237\u7aef\u9ed8\u8ba4\u8eab\u4efd\u9a8c\u8bc1\u65b9\u6cd5\u66f4\u597d\u3002\u4f46\u662f\uff0c\u7531\u4e8e\u670d\u52a1\u5668\u548c\u5ba2\u6237\u7aef\u4e4b\u95f4\u5b58\u5728\u4e00\u5bf9\u591a\u7684\u8eab\u4efd\u9a8c\u8bc1\u65b9\u6cd5\u63d2\u4ef6\uff0c\u800c\u4e14\uff0c\u5ba2\u6237\u7aef\u901a\u5e38\u90fd\u4e0d\u77e5\u9053\u8fd9\u79cd\u6620\u5c04\u5173\u7cfb\uff0c\u56e0\u6b64\u8fd9\u5728<code>mysql</code>\u5ba2\u6237\u7aef\u5e93\u4e2d\u672a\u5b9e\u73b0\u3002</li> </ol> <p>\u5982\u679c\u53d1\u751f\u8eab\u4efd\u9a8c\u8bc1\u65b9\u6cd5\u4e0d\u5339\u914d\uff0c\u670d\u52a1\u5668\u5c06\u5411\u5ba2\u6237\u7aef\u53d1\u9001<code>Protocol::AuthSwitchRequest</code>\u6570\u636e\u5305\uff0c\u5176\u4e2d\u5305\u542b\u670d\u52a1\u5668\u8981\u4f7f\u7528\u7684\u8eab\u4efd\u9a8c\u8bc1\u65b9\u6cd5\u7684\u540d\u79f0\u4ee5\u53ca\u4f7f\u7528\u65b0\u65b9\u6cd5\u91cd\u65b0\u751f\u6210\u7684\u7b2c\u4e00\u4e2a\u8eab\u4efd\u9a8c\u8bc1\u6709\u6548\u8d1f\u8f7d\u3002\u5ba2\u6237\u7aef\u5e94\u5207\u6362\u5230\u670d\u52a1\u5668\u8bf7\u6c42\u7684\u8eab\u4efd\u9a8c\u8bc1\u65b9\u6cd5\uff0c\u5e76\u6309\u7167\u8be5\u65b9\u6cd5\u7684\u6307\u793a\u7ee7\u7eed\u8fdb\u884c\u4ea4\u6362\u3002</p> <p>\u5982\u679c\u5ba2\u6237\u7aef\u4e0d\u77e5\u9053\u6240\u8bf7\u6c42\u7684\u65b9\u6cd5\uff0c\u5219\u5e94\u65ad\u5f00\u8fde\u63a5\u3002</p>"},{"location":"foundmental/1.MySQL%E5%8D%8F%E8%AE%AE%E5%88%86%E6%9E%90%E4%B8%8E%E6%8A%93%E5%8C%85%E6%A6%82%E8%BF%B0/#_10","title":"\u547d\u4ee4\u6267\u884c\u9636\u6bb5","text":"<p>\u547d\u4ee4\u6267\u884c\u9636\u6bb5\u5728\u5b98\u7f51\u6587\u6863\u4e2d\uff0c\u53eb <code>Command Phase</code>\u3002\u5728\u8fd9\u4e2a\u9636\u6bb5\uff0c\u5c31\u6709\u70b9\u50cf HTTP \u7684\u8bf7\u6c42\u54cd\u5e94\u8fd9\u79cd\u4e00\u95ee\u4e00\u7b54\u7684\u901a\u4fe1\u6a21\u578b\u3002</p> <p>\u9996\u5148\uff0c\u5ba2\u6237\u7aef\u53d1\u9001\u4e00\u4e2a\u5e8f\u53f7(sequence-id)\u4e3a0\u7684\u9996\u5305\u3002</p>"},{"location":"foundmental/1.MySQL%E5%8D%8F%E8%AE%AE%E5%88%86%E6%9E%90%E4%B8%8E%E6%8A%93%E5%8C%85%E6%A6%82%E8%BF%B0/#_11","title":"\u5ba2\u6237\u7aef\u547d\u4ee4\u8bf7\u6c42\u62a5\u6587","text":"<p>\u5ba2\u6237\u7aef\u53ef\u4ee5\u53d1\u9001\u5404\u79cd\u4e0d\u540c\u7c7b\u578b\u7684\u547d\u4ee4\u5305\uff0c<code>payload</code>\u4e2d\u7684\u7b2c\u4e00\u4e2abyte\u63cf\u8ff0<code>command-type</code>\u3002\u8fd9\u4e2atype\u5728 <code>include/my_command.h</code>\u4e2d\u4ee5<code>enum_server_command</code>\u679a\u4e3e\u65b9\u5f0f\u5b9a\u4e49.</p> <p>\u547d\u4ee4\u7528\u4e8e\u6807\u8bc6\u5f53\u524d\u8bf7\u6c42\u6d88\u606f\u7684\u7c7b\u578b\uff0c\u4f8b\u5982\u5207\u6362\u6570\u636e\u5e93\uff080x02\uff09\u3001\u67e5\u8be2\u547d\u4ee4\uff080x03\uff09\u7b49\u3002\u547d\u4ee4\u503c\u7684\u53d6\u503c\u8303\u56f4\u53ca\u8bf4\u660e\u5982\u4e0b\u8868\uff08\u53c2\u8003MySQL\u6e90\u4ee3\u7801/include/mysql_com.h\u5934\u6587\u4ef6\u4e2d\u7684\u5b9a\u4e49\u3002</p> <p>\u5728\u5b98\u7f51\u4e2d\uff0c\u628a\u8fd9\u4e9b\u7c7b\u578b\u5206\u4e3a<code>Text Protocol</code>,<code>Utility Commands</code>,<code>Prepared Statements</code>,<code>Stored Programs</code></p> <p>\u5176\u4e2d\uff0c\u6700\u4e3b\u8981\u7684\u547d\u4ee4\u5305\u662f <code>COM_QUERY</code> \u6d88\u606f\u62a5\u6587\uff0c\u8fd9\u4e2a\u662f\u6700\u5e38\u89c1\u7684\u8bf7\u6c42\u6d88\u606f\u7c7b\u578b\uff0c\u5f53\u5ba2\u6237\u7aef\u63d0\u4ea4SQL\u8bed\u53e5\u65f6\u5c31\u662f\u8fd9\u4e2a\u7c7b\u578b\u3002</p> <p>\u8fd9\u4e2a\u5305\u4e2d\u7684\u7b2c\u4e00\u4e2a\u5b57\u8282\uff1a\u7528\u4e8e\u6807\u8bc6\u5f53\u524d\u8bf7\u6c42\u6d88\u606f\u7684\u7c7b\u578b\uff0c\u4f8b\u5982\u5207\u6362\u6570\u636e\u5e93\uff080x02\uff09\u3001\u67e5\u8be2\u547d\u4ee4\uff080x03\uff09\u7b49\u3002\u547d\u4ee4\u503c\u7684\u53d6\u503c\u8303\u56f4\u53ca\u8bf4\u660e\u5982\u4e0b\u8868\uff08\u53c2\u8003 MySQL \u6e90\u4ee3\u7801 /include/mysql_com.h \u5934\u6587\u4ef6\u4e2d\u7684\u5b9a\u4e49\uff09</p> \u7c7b\u578b\u503c \u547d\u4ee4 \u529f\u80fd \u5173\u8054\u51fd\u6570 0x00 COM_SLEEP \uff08\u5185\u90e8\u7ebf\u7a0b\u72b6\u6001\uff09 \uff08\u65e0\uff09 0x01 COM_QUIT \u5173\u95ed\u8fde\u63a5 mysql_close 0x02 COM_INIT_DB \u5207\u6362\u6570\u636e\u5e93 mysql_select_db 0x03 COM_QUERY SQL\u67e5\u8be2\u8bf7\u6c42 mysql_real_query 0x04 COM_FIELD_LIST \u83b7\u53d6\u6570\u636e\u8868\u5b57\u6bb5\u4fe1\u606f mysql_list_fields 0x05 COM_CREATE_DB \u521b\u5efa\u6570\u636e\u5e93 mysql_create_db 0x06 COM_DROP_DB \u5220\u9664\u6570\u636e\u5e93 mysql_drop_db 0x07 COM_REFRESH \u6e05\u9664\u7f13\u5b58 mysql_refresh 0x08 COM_SHUTDOWN \u505c\u6b62\u670d\u52a1\u5668 mysql_shutdown 0x09 COM_STATISTICS \u83b7\u53d6\u670d\u52a1\u5668\u7edf\u8ba1\u4fe1\u606f mysql_stat 0x0A COM_PROCESS_INFO \u83b7\u53d6\u5f53\u524d\u8fde\u63a5\u7684\u5217\u8868 mysql_list_processes 0x0B COM_CONNECT \uff08\u5185\u90e8\u7ebf\u7a0b\u72b6\u6001\uff09 \uff08\u65e0\uff09 0x0C COM_PROCESS_KILL \u4e2d\u65ad\u67d0\u4e2a\u8fde\u63a5 mysql_kill 0x0D COM_DEBUG \u4fdd\u5b58\u670d\u52a1\u5668\u8c03\u8bd5\u4fe1\u606f mysql_dump_debug_info 0x0E COM_PING \u6d4b\u8bd5\u8fde\u901a\u6027 mysql_ping 0x0F COM_TIME \uff08\u5185\u90e8\u7ebf\u7a0b\u72b6\u6001\uff09 \uff08\u65e0\uff09 0x10 COM_DELAYED_INSERT \uff08\u5185\u90e8\u7ebf\u7a0b\u72b6\u6001\uff09 \uff08\u65e0\uff09 0x11 COM_CHANGE_USER \u91cd\u65b0\u767b\u9646\uff08\u4e0d\u65ad\u8fde\u63a5\uff09 mysql_change_user 0x12 COM_BINLOG_DUMP \u83b7\u53d6\u4e8c\u8fdb\u5236\u65e5\u5fd7\u4fe1\u606f \uff08\u65e0\uff09 0x13 COM_TABLE_DUMP \u83b7\u53d6\u6570\u636e\u8868\u7ed3\u6784\u4fe1\u606f \uff08\u65e0\uff09 0x14 COM_CONNECT_OUT \uff08\u5185\u90e8\u7ebf\u7a0b\u72b6\u6001\uff09 \uff08\u65e0\uff09 0x15 COM_REGISTER_SLAVE \u4ece\u670d\u52a1\u5668\u5411\u4e3b\u670d\u52a1\u5668\u8fdb\u884c\u6ce8\u518c \uff08\u65e0\uff09 0x16 COM_STMT_PREPARE \u9884\u5904\u7406SQL\u8bed\u53e5 mysql_stmt_prepare 0x17 COM_STMT_EXECUTE \u6267\u884c\u9884\u5904\u7406\u8bed\u53e5 mysql_stmt_execute 0x18 COM_STMT_SEND_LONG_DATA \u53d1\u9001BLOB\u7c7b\u578b\u7684\u6570\u636e mysql_stmt_send_long_data 0x19 COM_STMT_CLOSE \u9500\u6bc1\u9884\u5904\u7406\u8bed\u53e5 mysql_stmt_close 0x1A COM_STMT_RESET \u6e05\u9664\u9884\u5904\u7406\u8bed\u53e5\u53c2\u6570\u7f13\u5b58 mysql_stmt_reset 0x1B COM_SET_OPTION \u8bbe\u7f6e\u8bed\u53e5\u9009\u9879 mysql_set_server_option 0x1C COM_STMT_FETCH \u83b7\u53d6\u9884\u5904\u7406\u8bed\u53e5\u7684\u6267\u884c\u7ed3\u679c mysql_stmt_fetch"},{"location":"foundmental/1.MySQL%E5%8D%8F%E8%AE%AE%E5%88%86%E6%9E%90%E4%B8%8E%E6%8A%93%E5%8C%85%E6%A6%82%E8%BF%B0/#_12","title":"\u56de\u5305\u62a5\u6587","text":"<p>\u5e38\u89c1MySQL\u8fd4\u56de\u7684\u62a5\u6587\u6709<code>Data Packet</code>, <code>OK Packet</code>, <code>EOF Packe</code>t<code>, \u548c</code>ERROR Packet`\u3002\u56de\u5305\u683c\u5f0f\u4e3b\u8981\u53d6\u51b3\u4e8e\u67e5\u8be2\u662f\u5426\u9700\u8981\u8fd4\u56de\u7ed3\u679c\u96c6\u3002</p> <p>\u5bf9\u4e8e\u8bf8\u5982 <code>COM_PING</code>, <code>IUD Query</code> \u7b49\u4e0d\u9700\u8981\u8fd4\u56de\u7ed3\u679c\u96c6\u7684\u547d\u4ee4, \u4ee5\u53ca\u8fde\u63a5\u9636\u6bb5\u7684\u767b\u5f55\u6210\u529f\u3002<code>MySQL server</code>\u5982\u679c\u6b63\u786e\u6267\u884c\u8fd9\u4e2a\u67e5\u8be2, \u4f1a\u8fd4\u56de OK \u62a5\u6587\u7ed9 client\u3002</p> <p>OK Packet</p> <p>\u5bf9\u4e8eOK\u5305\uff0c\u5728  <code>sql/protocol_classic.cc -&gt; net_send_ok()</code> \u51fd\u6570\u4e2d\u5b9a\u4e49\u7684\u6570\u636e\u5305\u7ed3\u6784\u3002The Payload of an OK Packet</p> <p>\u57285.7.5\u7248\u672c\u4e4b\u540e\uff0cOK Packet\u4e5f\u53ef\u4ee5\u7528\u4e8e\u8868\u793aEOF\u4fe1\u606f\uff0c\u539f\u5148\u7684 EOF_Packet\u88ab\u5e9f\u5f03\u4e86\u3002</p> <ul> <li>\u5982\u679c header = 0x00 \u5e76\u4e14packer \u957f\u5ea6\u5927\u4e8e7\uff0c\u8bf4\u660e\u8fd9\u4e2a\u5305\u662f OK \u6570\u636e\u5305</li> <li>\u5982\u679c header = 0xFE \u5e76\u4e14 packer \u957f\u5ea6\u5c0f\u4e8e9\uff0c\u8bf4\u660e\u8fd9\u4e2a\u5305\u662f EOF \u5305</li> </ul> <p>\u5982\u679c\u8bbe\u7f6e\u4e86<code>CLIENT_PROTOCOL_41</code>\u6807\u8bb0\u4f4d\uff0c\u5373MySQL \u7248\u672c\u5927\u4e8e4.1\u3002 \u8be5\u6570\u636e\u5305\u5305\u542b\u4e00\u4e2a\u8b66\u544a\u8ba1\u6570\u3002</p>"},{"location":"foundmental/1.MySQL%E5%8D%8F%E8%AE%AE%E5%88%86%E6%9E%90%E4%B8%8E%E6%8A%93%E5%8C%85%E6%A6%82%E8%BF%B0/#_13","title":"\u534f\u8bae\u6570\u636e\u7c7b\u578b","text":"<p>\u534f\u8bae\u6570\u636e\u7c7b\u578b\u662f\u4e0e\u8bed\u8a00\u65e0\u5173\u7684\u6570\u636e\u7c7b\u578b, \u53ef\u4ee5\u7406\u89e3\u4e3a <code>wire type</code>, \u5b83\u4eec\u662f\u7f51\u7edc\u5b57\u8282\u6d41\u4e2d\u7684\u6570\u636e\u7c7b\u578b\u3002</p> <p>\u5728 MySQL \u534f\u8bae\u4e2d\u6570\u636e\u7c7b\u578b\u53ea\u6709\u4e24\u5927\u7c7b, \u5206\u522b\u662f\u6574\u6570(Integers) \u548c\u5b57\u7b26\u4e32(Strings), \u8fd9\u4e24\u79cd\u6570\u636e\u7c7b\u578b\u53c8\u4f1a\u5206\u4e3a\u591a\u4e2a\u66f4\u5c0f\u7684\u6570\u636e\u7c7b\u578b, \u5bf9\u4e8e\u6574\u6570\u7c7b\u578b, \u53ef\u4ee5\u8fdb\u4e00\u6b65\u5206\u4e3a\u5b9a\u957f\u6574\u6570(Fixed-Length Integer Types) \u548c\u957f\u5ea6\u7f16\u7801\u578b\u6574\u6570(Length-Encoded Integer Type)\u3002</p> <p>\u5bf9\u4e8e\u5b9a\u957f\u6574\u6570, \u987e\u540d\u601d\u4e49\u5176\u957f\u5ea6\u662f\u56fa\u5b9a\u7684, \u5b9a\u957f\u6574\u6570\u6709 int&lt;1&gt;\u3001int&lt;2&gt;\u3001int&lt;3&gt;\u3001int&lt;4&gt;\u3001int&lt;6&gt;\u3001int&lt;8&gt; \u5171 6 \u79cd, \u5b9a\u957f\u6574\u6570\u90fd\u662f\u4ee5\u5c0f\u7aef\u5b57\u8282\u5e8f\u5b58\u653e\u7684, \u5373\u6700\u4f4e\u6709\u6548\u4f4d\u5728\u524d\u3002\u4e3e\u4f8b\u6765\u8bf4, \u5bf9\u4e8e int&lt;4&gt; \u7c7b\u578b\u7684\u6570\u5b57 2, \u5176\u5b57\u8282\u6982\u51b5\u4e3a 10 00 00 00;</p> <p>\u800c\u957f\u5ea6\u7f16\u7801\u578b\u6574\u6570, \u5b83\u6240\u5360\u7528\u7684\u5b57\u8282\u6570\u4e0d\u662f\u56fa\u5b9a\u7684, \u53d6\u51b3\u4e8e\u503c\u7684\u5927\u5c0f, \u8bb0\u4e3a int, \u8fd9\u662f\u4e00\u79cd\u53d8\u957f\u7f16\u7801\u65b9\u5f0f, \u957f\u5ea6\u7f16\u7801\u578b\u6574\u6570\u5360\u7528\u7684\u5b57\u8282\u6570\u6709 1\u30013\u30014\u30019 \u5b57\u8282\u5171 4 \u79cd\u60c5\u51b5, \u6570\u5b57\u8d8a\u5c0f, \u5360\u7528\u7684\u5b57\u8282\u6570\u8d8a\u5c11, \u5f53\u6570\u5b57\u5c0f\u4e8e 0xfb \u65f6, \u7f16\u7801\u540e\u5176\u5360\u7528\u4e00\u4e2a\u5b57\u8282, \u5f53\u6570\u5b57\u5927\u4e8e\u7b49\u4e8e 0xfb \u5e76\u4e14\u5c0f\u4e8e\u7b49\u4e8e 0x7ffff \u65f6, \u5176\u7f16\u7801\u540e\u5c06\u5360\u7528 3 \u4e2a\u5b57\u8282(\u56fa\u5b9a\u7684 0xfc + 2 \u4e2a\u5b57\u8282\u6570\u503c\u4f4d), \u5f53\u6570\u5b57\u5927\u4e8e\u7b49\u4e8e 0x10000 \u4e14\u5c0f\u4e8e\u7b49\u4e8e 0x7fffff \u65f6, \u5176\u7f16\u7801\u540e\u5c06\u5360\u7528 4 \u4e2a\u5b57\u8282(\u56fa\u5b9a\u7684 0xfd + 3 \u5b57\u8282\u7684\u6570\u503c\u4f4d), \u5f53\u6570\u5b57\u5927\u4e8e\u7b49\u4e8e 0x1000000 \u4e14\u5c0f\u4e8e\u7b49\u4e8e 0x7ffffffff \u65f6, \u5176\u7f16\u7801\u540e\u5c06\u5360\u7528 9 \u4e2a\u5b57\u8282(\u56fa\u5b9a\u7684 0xfe + 8 \u5b57\u8282\u7684\u6570\u503c\u4f4d), \u6839\u636e\u8fd9\u6837\u7684\u7f16\u7801\u89c4\u5219, \u53cd\u8fc7\u6765\u6211\u4eec\u4e5f\u80fd\u5f97\u5230\u957f\u5ea6\u7f16\u7801\u578b\u6574\u6570\u7684\u89e3\u7801\u89c4\u5219, \u8bc6\u522b\u6570\u636e\u7684\u7b2c\u4e00\u4e2a\u5b57\u8282\u4fbf\u53ef\u4ee5\u77e5\u9053\u5176\u540e\u6240\u8ddf\u968f\u7684\u6570\u503c\u4f4d\u7684\u5b57\u8282\u6570, \u8fdb\u800c\u53ef\u4ee5\u83b7\u5f97\u6570\u503c\u672c\u8eab, \u4e5f\u5c31\u662f\u8bf4\u957f\u5ea6\u7f16\u7801\u578b\u6574\u6570\u5b9e\u9645\u4e0a\u662f\u7528\u5f00\u5934\u7684\u4e00\u5b57\u8282\u6765\u6307\u793a\u5176\u540e\u6240\u8ddf\u7684\u6570\u636e\u7684\u5b57\u8282\u957f\u5ea6, \u800c\u5176\u540e\u7684\u6570\u503c\u5b57\u8282\u4ecd\u7136\u662f\u4ee5\u5c0f\u7aef\u5b57\u8282\u5e8f\u5b58\u50a8, \u8fd9\u91cc\u5b9e\u9645\u4e0a\u6709\u70b9\u7c7b\u4f3c\u4e8e Redis \u7684 ziplist \u7ed3\u6784\u4e2d\u7684\u7ed3\u70b9, \u5728 Redis ziplist \u7ed3\u6784\u4e2d, \u5176\u7ed3\u70b9\u7684\u7b2c\u4e00\u4e2a\u5143\u7d20 previous_entry_length \u4e5f\u662f\u91c7\u7528\u7c7b\u4f3c\u7684\u7ed3\u6784\u6765\u8868\u793a\u524d\u4e00\u4e2a\u7ed3\u70b9\u7684\u957f\u5ea6, \u82e5\u524d\u4e00\u7ed3\u70b9\u7684\u957f\u5ea6\u5c0f\u4e8e 254 \u4e2a\u5b57\u8282, \u5219 previous_entry_length \u7684\u672c\u8eab\u5c31\u662f\u524d\u4e00\u7ed3\u70b9\u7684\u957f\u5ea6, \u82e5\u524d\u4e00\u7ed3\u70b9\u7684\u957f\u5ea6\u5927\u4e8e\u7b49\u4e8e 254 \u4e2a\u5b57\u8282, \u5219 previous_entry_length \u672c\u8eab\u5360\u7528 5 \u4e2a\u5b57\u8282\u7684\u957f\u5ea6, \u5176\u7b2c\u4e00\u5b57\u8282\u7684\u503c\u56fa\u5b9a\u4e3a 0xfe, \u800c\u540e\u6240\u8ddf\u7684 4 \u4e2a\u5b57\u8282\u6307\u793a\u4e86\u5176\u524d\u4e00\u4e2a\u7ed3\u70b9\u7684\u957f\u5ea6"},{"location":"foundmental/1.MySQL%E5%8D%8F%E8%AE%AE%E5%88%86%E6%9E%90%E4%B8%8E%E6%8A%93%E5%8C%85%E6%A6%82%E8%BF%B0/#_14","title":"\u6570\u636e\u5305\u683c\u5f0f","text":"\u6570\u636e\u7c7b\u578b \u957f\u5ea6 \u540d\u79f0 \u542b\u4e49 int&lt;3&gt; 3 byte payload_length \u8868\u793a\u5305\u957f\u5ea6 int&lt;1&gt; 1 byte sequence_id string Body \u5305\u4e3b\u4f53\u90e8\u5206\uff0c\u627f\u8f7d\u7740MySQL\u4e1a\u52a1\u6570\u636e <p>\u4e00\u4e2a\u5178\u578b\u7684\u6570\u636e\u5305\u4f8b\u5b50</p> 1 00 00 00 01 length: 1   sequence_id: x00   payload: 0x01"},{"location":"foundmental/1.MySQL%E5%8D%8F%E8%AE%AE%E5%88%86%E6%9E%90%E4%B8%8E%E6%8A%93%E5%8C%85%E6%A6%82%E8%BF%B0/#_15","title":"\u6570\u636e\u62a5\u6587\u9636\u6bb5","text":"<p>MySQL \u662f\u4e00\u4e2a\u6709\u72b6\u6001\u534f\u8bae\uff0c</p> <p>\u8fde\u63a5\u9636\u6bb5\uff1a</p> <ul> <li>\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u7aef\u4ea4\u6362\u80fd\u529b\uff08capabilities \uff09</li> <li>\u5efa\u7acbTLS\u901a\u4fe1\uff08\u5982\u6709\u5fc5\u8981\u7684\u8bdd\uff09</li> <li>\u8eab\u4efd\u8ba4\u8bc1</li> </ul>"},{"location":"foundmental/1.MySQL%E5%8D%8F%E8%AE%AE%E5%88%86%E6%9E%90%E4%B8%8E%E6%8A%93%E5%8C%85%E6%A6%82%E8%BF%B0/#_16","title":"\u6293\u5305\u5b9e\u6218","text":"<p>\u5728 Windows \u5ba2\u6237\u7aef\u6293\u5305\uff0c\u6293\u5305\u56fe\u5982\u4e0b\uff1a</p> <p></p> <p></p>"},{"location":"foundmental/1.MySQL%E5%8D%8F%E8%AE%AE%E5%88%86%E6%9E%90%E4%B8%8E%E6%8A%93%E5%8C%85%E6%A6%82%E8%BF%B0/#-tcp","title":"- TCP \u4e09\u6b21\u63e1\u624b","text":"<ul> <li>Client\u2014\u2014&gt;Server\uff0cLogin Request\uff0cClient \u53d1\u8d77\u7684\u767b\u5f55\u8bf7\u6c42\u62a5\u6587\uff0c</li> </ul>"},{"location":"foundmental/1.MySQL%E5%8D%8F%E8%AE%AE%E5%88%86%E6%9E%90%E4%B8%8E%E6%8A%93%E5%8C%85%E6%A6%82%E8%BF%B0/#tcp","title":"TCP \u4e09\u6b21\u63e1\u624b","text":""},{"location":"foundmental/1.MySQL%E5%8D%8F%E8%AE%AE%E5%88%86%E6%9E%90%E4%B8%8E%E6%8A%93%E5%8C%85%E6%A6%82%E8%BF%B0/#_17","title":"\u6311\u6218\u6570\u636e\u5305","text":"<p>MySQL \u91c7\u7528\u7684\u662f\u6311\u6218-\u54cd\u5e94\u65b9\u5f0f\u6765\u8fdb\u884c\u8eab\u4efd\u8ba4\u8bc1\u3002\u7531\u670d\u52a1\u7aef\u751f\u6210\u52a0\u5bc6\u7528\u7684\u76d0\u7ed9\u5ba2\u6237\u7aef\uff0c\u63d0\u9ad8\u5b89\u5168\u6027\u3002\u5728\u5b98\u7f51\u4e2d\u53eb Protocol::Handshake</p> <p>Sever \u544a\u8bc9\u5ba2\u6237\u7aef\u81ea\u5df1\u7684\u7248\u672c\u3001\u5206\u914d\u7684\u8fde\u63a5 ID\u3001\u670d\u52a1\u5668\u7684\u80fd\u529b\uff08Capabilities\uff09\u3001\u8ba4\u8bc1\u63d2\u4ef6\uff0c\u5b57\u7b26\u96c6\uff0cSalt \u7b49\u4fe1\u606f\u3002</p> <p>MySQL \u91c7\u7528\u7684\u662f\u6311\u6218-\u54cd\u5e94\u65b9\u5f0f\u6765\u8fdb\u884c\u8eab\u4efd\u8ba4\u8bc1\u3002\u7531\u670d\u52a1\u7aef\u751f\u6210\u52a0\u5bc6\u7528\u7684\u76d0\u7ed9\u5ba2\u6237\u7aef\uff0c\u63d0\u9ad8\u5b89\u5168\u6027\u3002</p> \u540d\u79f0 \u7c7b\u578b \u957f\u5ea6 \u542b\u4e49 Protocol int 1 byte MySQL \u5e94\u7528\u534f\u8bae\u7684\u7248\u672c\u53f7\u3002\u8fd9\u4e2a\u7248\u672c\u53f7\u7528\u4e8e\u786e\u4fdd\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u5668\u6bb5\u80fd\u591f\u6b63\u786e\u5730\u89e3\u6790\u548c\u901a\u4fe1\u3002\u53c2\u8003 MySQL \u6e90\u4ee3\u7801/include/mysql_version.h \u5934\u6587\u4ef6\u5b9a\u4e49 Version string \u4e0d\u786e\u5b9a MySQL Server \u7684\u7248\u672c\u53f7\uff0c\u4ee5\u4fbf\u5ba2\u6237\u7aef\u80fd\u591f\u6839\u636e\u670d\u52a1\u5668\u7248\u672c\u7684\u4e0d\u540c\u91c7\u53d6\u4e0d\u540c\u7684\u5904\u7406\u65b9\u5f0f\u6216\u4f7f\u7528\u4e0d\u540c\u7684\u534f\u8bae\u7279\u6027\u3002\u670d\u52a1\u5668\u7248\u672c\u4fe1\u606f\u901a\u5e38\u662f\u4e00\u4e2a\u5b57\u7b26\u4e32\uff0c\u5305\u542b\u4e86 MySQL \u7684\u7248\u672c\u53f7\u3001\u6784\u5efa\u65e5\u671f\u3001\u64cd\u4f5c\u7cfb\u7edf\u7b49\u4fe1\u606f\u3002\u53c2\u8003 <code>MYSQL_SERVER_VERSION</code> \u5b8f\u5b9a\u4e49\u51b3\u5b9a\uff08\u53c2\u8003MySQL\u6e90\u4ee3\u7801/include/mysql_version.h\u5934\u6587\u4ef6\u5b9a\u4e49\uff09 Thread ID int 4 byte \u5efa\u7acb\u8fde\u63a5\u6240\u5206\u914d\u7684\u7ebf\u7a0b id Salt \u6311\u6218\u5b57\u7b26\u4e32\uff08\u968f\u673a\u7684\uff09\uff0c\u76f8\u5f53\u4e8e\u7528\u4e8e\u52a0\u5bc6\u5bc6\u7801\u7684\u76d0\u503c\uff0c\u5206\u4e3a\u4e24\u90e8\u5206\uff0c\u957f\u5ea6\u5206\u522b\u4e3a 8 \u5b57\u8282\u548c 12 \u5b57\u8282 Server Capabilities \u670d\u52a1\u5668\u652f\u6301\u7684\u529f\u80fd\uff0cint \u4e3a 32 \u4f4d\uff0c1 \u652f\u6301\uff0c0 \u4e0d\u652f\u6301\uff0c\u6700\u591a\u652f\u6301 32 \u79cd\u529f\u80fd\u3002\u8fd9\u91cc\u5360 2 \u4e2a\u5b57\u8282\uff0c\u4e3a int \u7684\u524d 16 \u4f4d\uff08\u53c2\u8003MySQL\u6e90\u4ee3\u7801/include/mysql_com.h\u4e2d\u7684\u5b8f\u5b9a\u4e49\uff09 Server Language \u670d\u52a1\u5668\u7f16\u7801\uff0c\u901a\u5e38\u4e3a utf8mb4 Server Status \u670d\u52a1\u5668\u72b6\u6001\uff0c\u901a\u5e38\u4e3a SERVER_STATUS_AUTOCOMMIT\uff0c\u8868\u793a\u81ea\u52a8\u63d0\u4ea4\u4e8b\u52a1 Extended Server Capabilities \u670d\u52a1\u5668\u652f\u6301\u7684\u62d3\u5c55\u529f\u80fd\uff0cint \u4e3a 32 \u4f4d\uff0c1 \u652f\u6301\uff0c0 \u4e0d\u652f\u6301\uff0c\u6700\u591a\u652f\u6301 32 \u79cd\u529f\u80fd\u3002\u8fd9\u91cc\u5360 2 \u4e2a\u5b57\u8282\uff0c\u4e3a int \u7684\u540e 16 \u4f4d Authentication Plugin Length ?\u597d\u50cf\u6307\u7684\u662f\u6311\u6218\u5b57\u7b26\u4e32\u7684\u957f\u5ea6\uff0c\u6ca1\u641e\u61c2\u4e3a\u4ec0\u4e48\u662f 21 \u800c\u4e0d\u662f 20 Unused \u672a\u4f7f\u7528\u7684\u90e8\u5206 Authentication Plugin string \u5bc6\u7801\u91c7\u7528\u7684\u52a0\u5bc6\u65b9\u6cd5\uff0c\u901a\u5e38\u4e3a mysql_native_password <p>Server Capabilities </p> \u6807\u8bb0\u4f4d\u540d\u79f0 \u6807\u5fd7\u4f4d \u8bf4\u660e CLIENT_LONG_PASSWORD CLIENT_FOUND_ROWS CLIENT_LONG_FLAG CLIENT_CONNECT_WITH_DB"},{"location":"foundmental/1.MySQL%E5%8D%8F%E8%AE%AE%E5%88%86%E6%9E%90%E4%B8%8E%E6%8A%93%E5%8C%85%E6%A6%82%E8%BF%B0/#_18","title":"\u8ba4\u8bc1\u6570\u636e\u5305","text":""},{"location":"foundmental/1.MySQL%E5%8D%8F%E8%AE%AE%E5%88%86%E6%9E%90%E4%B8%8E%E6%8A%93%E5%8C%85%E6%A6%82%E8%BF%B0/#_19","title":"\u5207\u6362\u52a0\u5bc6\u7b97\u6cd5","text":"<p>\u5982\u679c\u6311\u6218\u6570\u636e\u5305\u8fd4\u56de\u7684<code>Authentication Plugin</code>\u8ba4\u8bc1\u63d2\u4ef6\u4e0e\u4f60\u7684\u7528\u6237\u5bc6\u7801\u52a0\u5bc6\u65b9\u5f0f\u4e0d\u4e00\u81f4\uff08\u6bd4\u5982\u4f60\u7684\u7528\u6237\u91c7\u7528\u7684\u662f<code>mysql_native_password</code>\u52a0\u5bc6\uff0c\u800c\u670d\u52a1\u5668\u8fd4\u56de\u7684\u662f<code>caching_sha2_password</code>\uff09\uff0c\u90a3\u4e48\u6821\u9a8c\u80af\u5b9a\u5931\u8d25\uff0c\u6240\u4ee5\u9700\u8981\u66f4\u6362\u52a0\u5bc6\u65b9\u5f0f\u3002\u670d\u52a1\u5668\u4f1a\u53d1\u9001\u4e00\u4e2a\u5207\u6362\u8ba4\u8bc1\u63d2\u4ef6\u8bf7\u6c42\u6570\u636e\u5305\u6765\u6307\u793a\u5ba2\u6237\u7aef\u91cd\u65b0\u52a0\u5bc6\u5bc6\u7801\u5e76\u53d1\u9001\u3002</p>"},{"location":"foundmental/1.MySQL%E5%8D%8F%E8%AE%AE%E5%88%86%E6%9E%90%E4%B8%8E%E6%8A%93%E5%8C%85%E6%A6%82%E8%BF%B0/#_20","title":"\u6210\u529f\u54cd\u5e94\u62a5\u6587","text":"<p>Response OK \uff0c\u6210\u529f\u54cd\u5e94\uff0c\u8fd9\u4e2a\u6ca1\u4ec0\u4e48\u597d\u8bf4\u7684\u3002\u8fd4\u56de\u7684\u6838\u5fc3\u5b57\u6bb5\u662f Server Status \u8fd9\u4e9b\u5404\u79cd flag \u6807\u8bb0\u4f4d\u3002</p>"},{"location":"foundmental/1.MySQL%E5%8D%8F%E8%AE%AE%E5%88%86%E6%9E%90%E4%B8%8E%E6%8A%93%E5%8C%85%E6%A6%82%E8%BF%B0/#_21","title":"\u5bc6\u7801\u63d2\u4ef6\u7b97\u6cd5","text":"<p>MySQL 5.6/5.7 \u7684\u9ed8\u8ba4\u5bc6\u7801\u63d2\u4ef6\u4e00\u76f4\u4ee5\u6765\u90fd\u662f <code>mysql_native_password</code>\u3002\u5176\u4f18\u70b9\u662f\u5b83\u652f\u6301 <code>challenge-response</code> \u673a\u5236\uff0c\u8fd9\u662f\u975e\u5e38\u5feb\u7684\u9a8c\u8bc1\u673a\u5236\uff0c\u65e0\u9700\u5728\u7f51\u7edc\u4e2d\u53d1\u9001\u5b9e\u9645\u5bc6\u7801\uff0c\u5e76\u4e14\u4e0d\u9700\u8981\u52a0\u5bc6\u7684\u8fde\u63a5\u3002</p> <p>\u7136\u800c\uff0c<code>mysql_native_password</code> \u4f9d\u8d56\u4e8e SHA1 \u7b97\u6cd5\uff0c\u4f46 NIST\uff08\u7f8e\u56fd\u56fd\u5bb6\u6807\u51c6\u4e0e\u6280\u672f\u7814\u7a76\u9662\uff09\u5df2\u5efa\u8bae\u505c\u6b62\u4f7f\u7528 SHA1 \u7b97\u6cd5\uff0c\u56e0\u4e3a SHA1 \u548c\u5176\u4ed6\u54c8\u5e0c\u7b97\u6cd5\uff08\u4f8b\u5982 MD5\uff09\u5df2\u88ab\u8bc1\u660e\u975e\u5e38\u5bb9\u6613\u7834\u89e3\u3002</p> <p>\u6b64\u5916\uff0c\u7531\u4e8e <code>mysql_native_password</code> \u5728 mysql.user \u8868\u4e2d <code>authentication_string</code> \u5b57\u6bb5\u5b58\u50a8\u7684\u662f\u4e24\u6b21\u54c8\u5e0c SHA1(SHA1(password)) \u8ba1\u7b97\u7684\u503c \uff0c\u4e5f\u5c31\u662f\u8bf4\u5982\u679c\u4e24\u4e2a\u7528\u6237\u5e10\u6237\u4f7f\u7528\u76f8\u540c\u7684\u5bc6\u7801\uff0c\u90a3\u4e48\u7ecf\u8fc7 <code>mysql_native_password</code> \u8f6c\u6362\u540e\u5728 mysql.user \u8868\u5f97\u5230\u7684\u54c8\u5e0c\u503c\u76f8\u540c\u3002</p> <p>\u5c3d\u7ba1\u6709 hash \u503c\u4e5f\u65e0\u6cd5\u5f97\u5230\u5b9e\u9645\u5bc6\u7801\u4fe1\u606f\uff0c\u4f46\u5b83\u4ecd\u7136\u544a\u8bc9\u8fd9\u4e24\u4e2a\u7528\u6237\u4f7f\u7528\u4e86\u76f8\u540c\u7684\u5bc6\u7801\u3002\u4e3a\u4e86\u907f\u514d\u8fd9\u79cd\u60c5\u51b5\uff0c\u5e94\u8be5\u7ed9\u5bc6\u7801\u52a0\u76d0\uff08salt\uff09\uff0csalt \u57fa\u672c\u4e0a\u662f\u88ab\u7528\u4f5c\u8f93\u5165\uff0c\u7528\u4e8e\u8f6c\u6362\u7528\u6237\u5bc6\u7801\u7684\u52a0\u5bc6\u6563\u5217\u51fd\u6570\u3002\u7531\u4e8e salt \u662f\u968f\u673a\u7684\uff0c\u5373\u4f7f\u4e24\u4e2a\u7528\u6237\u4f7f\u7528\u76f8\u540c\u7684\u5bc6\u7801\uff0c\u8f6c\u6362\u540e\u7684\u6700\u7ec8\u7ed3\u679c\u5c06\u53d1\u751f\u8f83\u5927\u7684\u53d8\u5316\u3002</p> <p>\u4ece MySQL 5.6 \u5f00\u59cb\u652f\u6301 <code>sha256_password</code> \u8ba4\u8bc1\u63d2\u4ef6\u3002\u5b83\u4f7f\u7528\u4e00\u4e2a\u52a0\u76d0\u5bc6\u7801\uff08salted password\uff09\u8fdb\u884c\u591a\u8f6e SHA256 \u54c8\u5e0c\uff08\u6570\u5343\u8f6e\u54c8\u5e0c\uff0c\u66b4\u529b\u7834\u89e3\u66f4\u96be\uff09\uff0c\u4ee5\u786e\u4fdd\u54c8\u5e0c\u503c\u8f6c\u6362\u66f4\u5b89\u5168\u3002\u7136\u800c\uff0c\u5b83\u9700\u8981\u8981\u4e48\u5728\u5b89\u5168\u8fde\u63a5\u6216\u5bc6\u7801\u4f7f\u7528 RSA \u79d8\u94a5\u5bf9\u52a0\u5bc6\u3002\u6240\u4ee5\uff0c\u867d\u7136\u5bc6\u7801\u7684\u5b89\u5168\u6027\u66f4\u5f3a\uff0c\u4f46\u5b89\u5168\u8fde\u63a5\u548c\u591a\u8f6e hash \u8f6c\u6362\u9700\u8981\u5728\u8ba4\u8bc1\u8fc7\u7a0b\u4e2d\u7684\u65f6\u95f4\u66f4\u957f\u3002</p>"},{"location":"foundmental/2.MySQL%E7%B4%A2%E5%BC%95/","title":"\u7d22\u5f15\u57fa\u672c\u6982\u5ff5","text":"<p>\u6570\u636e\u5e93\u4e2d\u7684\u7d22\u5f15\uff0c\u5c31\u50cf\u662f\u4e66\u7c4d\u4e2d\u7684\u76ee\u5f55\u4e00\u6837\u3002\u6216\u8005\u662f\u6211\u4eec\u53bb\u56fe\u4e66\u9986\u770b\u4e66\u65f6\uff0c\u901a\u5e38\u5728\u56fe\u4e66\u9986\u7f51\u7edc\u4e0a\u67e5\u627e\u5230\u60f3\u770b\u7684\u4e66\u7684\u7d22\u4e66\u53f7\uff0c\u7136\u540e\u6839\u636e\u56fe\u4e66\u9986\u5206\u7c7b\u7d22\u5f15\u53bb\u67e5\u627e\u5bf9\u5e94\u7684\u4e66\u67b6\u627e\u5230\u4e66\u7c4d\u3002\u7d22\u5f15\u8fd9\u4e2a\u6982\u5ff5\u5728\u6211\u4eec\u65e5\u5e38\u751f\u6d3b\u4e2d\u5f88\u5e38\u89c1\u3002\u6bd4\u5982\u5728\u5f88\u591a\u4e66\u7c4d\u7684\u6700\u540e\uff0c\u90fd\u914d\u6709\u5173\u952e\u5b57\u7d22\u5f15\u3002\u5b83\u80fd\u5e2e\u52a9\u4f60\u5feb\u901f\u5730\u627e\u5230\u67d0\u4e2a\u5173\u952e\u5b57\u6240\u5728\u7684\u4e66\u9875\u3002\u8bd5\u60f3\u4e00\u4e0b\uff0c\u5982\u679c\u6ca1\u6709\u7d22\u5f15\uff0c\u60f3\u8981\u67e5\u8be2\u67d0\u4e2a\u5173\u952e\u5b57\u6240\u5728\u7684\u7ae0\u8282\u548c\u4e66\u9875\uff0c\u53ef\u80fd\u552f\u4e00\u7684\u529e\u6cd5\u5c31\u662f\u4e00\u9875\u4e00\u9875\u7ffb\u4e66\u76f4\u5230\u627e\u5230\u4e3a\u6b62\u3002\u7d22\u5f15\u5927\u5927\u63d0\u9ad8\u4e86\u67e5\u8be2\u7684\u901f\u5ea6\uff01</p> <p>\u5728\u6570\u636e\u5e93\u4e2d\u7684\u7d22\u5f15\uff0c\u4e5f\u662f\u8fd9\u4e2a\u6982\u5ff5\u3002\u6570\u636e\u5e93\u7684\u7d22\u5f15\u4e5f\u6b63\u662f\u4e3a\u4e86\u89e3\u51b3\u8fd9\u7c7b\u95ee\u9898\uff1a\u7d22\u5f15\u901a\u8fc7\u5f15\u5165\u5197\u4f59\u7684\u6570\u636e\u5b58\u50a8(\u7c7b\u6bd4\u4e66\u7c4d\u6700\u540e\u7684\u7d22\u5f15\u7ae0\u8282)\uff0c\u4ee5\u6b64\u6765\u63d0\u9ad8\u67e5\u8be2\u8bed\u53e5\u7684\u901f\u5ea6\u3002</p> <p>\u5728\u5b66\u751f\u8868\u4e2d\uff0c\u4e3a\u4e86\u6839\u636e\u7ed9\u5b9a ID \u68c0\u7d22\u4e00\u6761 student \u8bb0\u5f55\uff0c\u6570\u636e\u5e93\u7cfb\u7edf\u4f1a\u5148\u67e5\u627e\u7d22\u5f15\uff0c\u627e\u5230\u8bb0\u5f55\u6240\u5728\u7684\u78c1\u76d8\u5757\uff0c\u7136\u540e\u8bfb\u53d6\u6240\u9700\u7684 student \u8bb0\u5f55\u3002</p> <p>\u7d22\u5f15\u662f\u4e00\u79cd\u5178\u578b\u7684 \u7a7a\u95f4\u6362\u53d6\u65f6\u95f4 \u7684\u7b97\u6cd5\u601d\u60f3\uff0c\u5728\u78c1\u76d8\u4e2d\u82b1\u8d39\u4e00\u4e9b\u989d\u5916\u7a7a\u95f4\u6765\u5b58\u50a8\u4e00\u4e9b\u989d\u5916\u7684\u7d22\u5f15\u6570\u636e\uff0c\u6765\u63d0\u9ad8\u67e5\u627e\u6548\u7387\u3002</p> <p>\u8fd9\u91cc\u7684\u67e5\u627e\uff0c\u5e76\u4e0d\u662f\u7b80\u5355\u7684\u67e5\u8be2\uff0c\u65e0\u8bba\u662f\u589e\u5220\u6539\u67e5\uff0c\u90fd\u9700\u8981\u67e5\u627e\u76f8\u5e94\u7684\u4f4d\u7f6e\u8fdb\u884c\u63d2\u5165\uff0c\u6216\u8005\u627e\u5230\u76f8\u5e94\u7684\u8bb0\u5f55\u518d\u8fdb\u884c\u5220\u9664\u548c\u4fee\u6539\u3002</p> <p>\u6240\u4ee5\u7d22\u5f15\u63d0\u9ad8\u7684\u5e76\u4e0d\u4ec5\u4ec5\u53ea\u662f\u67e5\u8be2\u6548\u7387\u3002</p> <p>\u6839\u636e\u7d22\u5f15\u7684\u4f5c\u7528\uff1a\u65e0\u8bba\u662f\u589e\u5220\u6539\u67e5\uff0c\u90fd\u662f\u8981\u5148\u67e5\u627e\u5230\u76f8\u5e94\u7684\u8bb0\u5f55\uff0c\u800c\u4e14\u5728\u589e\u5220\u6539\u65f6\u4e5f\u8981\u4fee\u6539\u7d22\u5f15\u6570\u636e\u3002\u7d22\u5f15\u4e5f\u4f1a\u5e26\u6765\u4e00\u4e9b\u989d\u5916\u7684\u7ef4\u62a4\u5f00\u9500\u3002</p> <p>\u8bc4\u4ef7\u7d22\u5f15\u6027\u80fd\u5927\u6982\u6709\u5982\u4e0b\u51e0\u79cd\u56e0\u7d20\uff1a</p> <ul> <li>\u8bbf\u95ee\u7c7b\u578b\uff1a\u7d22\u5f15\u80fd\u591f\u652f\u6301\u7684\u8bbf\u95ee\u7c7b\u578b\uff0c\u4e3b\u8981\u7684\u8bbf\u95ee\u7c7b\u578b\u5305\u62ec\uff1a\u7279\u5b9a\u8bb0\u5f55\u7684\u67e5\u627e\uff08\u7b49\u503c\u67e5\u627e\uff09\uff0c\u8303\u56f4\u67e5\u627e \u3002</li> <li>\u8bbf\u95ee\u65f6\u95f4\uff1a\u5728\u67e5\u8be2\u4e2d\uff0c\u4f7f\u7528\u7d22\u5f15\u6280\u672f\u67e5\u627e\u5230\u8bb0\u5f55\u7684\u65f6\u95f4\u3002</li> <li>\u63d2\u5165\u65f6\u95f4\uff1a\u63d2\u5165\u65b0\u6570\u636e\u9879\u7684\u65f6\u95f4\uff0c\u5305\u62ec\u627e\u5230\u6b63\u786e\u7684\u4f4d\u7f6e\u63d2\u5165\u6570\u636e\u9879\u548c\u66f4\u65b0\u7d22\u5f15\u6240\u9700\u8981\u7684\u65f6\u95f4\u3002</li> <li>\u5220\u9664\u65f6\u95f4\uff1a\u5220\u9664\u6570\u636e\u9879\u7684\u65f6\u95f4\uff0c\u5305\u62ec\u627e\u5230\u8981\u88ab\u5220\u9664\u7684\u9879\u548c\u66f4\u65b0\u7d22\u5f15\u6240\u9700\u8981\u7684\u65f6\u95f4\u3002</li> <li>\u7a7a\u95f4\u5f00\u9500\uff1a\u7d22\u5f15\u7ed3\u6784\u5360\u7528\u7684\u989d\u5916\u7684\u7a7a\u95f4\u5f00\u9500\u3002</li> </ul>"},{"location":"foundmental/2.MySQL%E7%B4%A2%E5%BC%95/#_2","title":"\u7d22\u5f15\u7684\u57fa\u672c\u6570\u636e\u7ed3\u6784","text":"<p>\u6839\u636e\u7d22\u5f15\u7684\u6570\u636e\u7ed3\u6784\u5206\u7c7b\uff0c\u6709\u4e24\u79cd\u57fa\u672c\u7684\u7d22\u5f15\u7c7b\u578b\uff1a</p> <p>\u6563\u5217\u7d22\u5f15\uff08\u54c8\u5e0c\u7d22\u5f15\uff09</p> <ul> <li> <p>\u6563\u5217\u7d22\u5f15\u4e3b\u8981\u7684\u6570\u636e\u7ed3\u6784\u5c31\u662f\u54c8\u5e0c\u8868\u3002\u53ea\u6709\u7cbe\u786e\u5339\u914d\u7d22\u5f15\u8fd9\u79cd\u7b49\u503c\u67e5\u8be2\u624d\u6709\u6548\u3002</p> </li> <li> <p>\u5bf9\u4e8e\u6bcf\u4e00\u884c\u6570\u636e\uff0c\u5b58\u50a8\u5f15\u64ce\u90fd\u4f1a\u5bf9\u7d22\u5f15\u5217\u8ba1\u7b97\u4e00\u4e2a\u54c8\u5e0c\u7801\uff0c\u54c8\u5e0c\u7801\u662f\u4e00\u4e2a\u8f83\u5c0f\u7684\u503c\uff0c\u5e76\u4e14\u4e0d\u540c\u952e\u503c\u7684\u884c\u8ba1\u7b97\u51fa\u6765\u7684\u54c8\u5e0c\u7801\u4e5f\u4e0d\u4e00\u6837\uff08\u5c11\u6570\u60c5\u51b5\u4e5f\u53ef\u80fd\u6709\u54c8\u5e0c\u51b2\u7a81\uff09\u3002</p> </li> <li>\u54c8\u5e0c\u7d22\u5f15\u5c06\u6240\u6709\u7684\u54c8\u5e0c\u7801\u5b58\u50a8\u5728\u7d22\u5f15\u4e2d\uff0c\u540c\u65f6\u5728\u54c8\u5e0c\u8868\u4e2d\u4fdd\u5b58\u6307\u5411\u6bcf\u4e2a\u6570\u636e\u884c\u7684\u6307\u9488\u3002</li> <li> <p>\u4e5f\u5c31\u662f\u8bf4\uff0c\u7531\u4e8e\u54c8\u5e0c\u67e5\u627e\u6bd4\u8d77 B-Tree \u7d22\u5f15\uff0c\u5176\u672c\u8eab\u5bf9\u4e8e\u5355\u884c\u67e5\u8be2\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u66f4\u4f4e\uff0c\u6709\u4e86\u54c8\u5e0c\u7d22\u5f15\u540e\u660e\u663e\u53ef\u52a0\u5feb\u5355\u884c\u67e5\u8be2\u901f\u5ea6\u3002</p> </li> <li> <p>\u54c8\u5e0c\u7d22\u5f15\u4e0d\u662f\u6309\u7167\u7d22\u5f15\u503c\u987a\u5e8f\u5b58\u50a8\u7684\uff0c\u6240\u4ee5\u4e5f\u5c31\u65e0\u6cd5\u7528\u4e8e\u6392\u5e8f\u67e5\u627e\u3002</p> </li> <li>\u6563\u5217\u7d22\u5f15\u4ec5\u652f\u6301 \u4ec5\u80fd\u6ee1\u8db3 \"=\",\"IN\"\u548c\"&lt;=&gt;\"\u67e5\u8be2\uff0c\u4e0d\u80fd\u4f7f\u7528\u8303\u56f4\u67e5\u8be2\uff0c\u4f8b\u5982 \" where price &gt; 100\"\uff08\u6ce8\u610f \"&lt;=&gt;\" \u548c \"&lt;\" ,\"&gt;\" \u662f\u4e0d\u540c\u7684\u8fd0\u7b97\u7b26\u3002\uff09</li> <li>\u5176\u68c0\u7d22\u6548\u7387\u975e\u5e38\u9ad8\uff0c\u7d22\u5f15\u7684\u68c0\u7d22\u53ef\u4ee5\u4e00\u6b21\u5b9a\u4f4d\uff0c\u4e0d\u50cf B-Tree \u7d22\u5f15\u9700\u8981\u4ece\u6839\u8282\u70b9\u5230\u679d\u8282\u70b9\uff0c\u6700\u540e\u624d\u80fd\u8bbf\u95ee\u5230\u9875\u8282\u70b9\u8fd9\u6837\u591a\u6b21\u7684 IO \u8bbf\u95ee\u3002\u6240\u4ee5 Hash \u7d22\u5f15\u7684\u67e5\u8be2\u6548\u7387\u8981\u8fdc\u9ad8\u4e8e B-Tree \u7d22\u5f15\u3002</li> <li>MySQL \u7684 InnoDB \u5b58\u50a8\u5f15\u64ce\u4e2d\u6709\u4e2a\u529f\u80fd\u53eb \u81ea\u9002\u5e94\u54c8\u5e0c\u7d22\u5f15( adaptive hash index)\uff0c\u5f53 InnoDB \u6ce8\u610f\u5230\u67d0\u4e9b\u7d22\u5f15\u503c\u4f7f\u7528\u7684\u975e\u5e38\u9891\u7e41\u65f6\uff0c\u5b83\u4f1a\u5728\u5185\u5b58\u4e2d\u57fa\u4e8e B-Tree \u7d22\u5f15\u4e4b\u4e0a\u518d\u521b\u5efa\u4e00\u4e2a\u54c8\u5e0c\u7d22\u5f15\uff0c\u8fd9\u6837\u5c31\u8ba9 B-Tree \u4e5f\u5177\u6709\u54c8\u5e0c\u7d22\u5f15\u7684\u4e00\u4e9b\u4f18\u70b9\uff0c\u6bd4\u5982\u5feb\u901f\u67e5\u627e\uff0c\u8fd9\u662f\u4e00\u4e2a\u81ea\u52a8\u7684\u3001\u5185\u90e8\u7684\u884c\u4e3a\uff0c\u7528\u6237\u65e0\u6cd5\u63a7\u5236\u6216\u914d\u7f6e\uff0c\u4e0d\u8fc7\u5982\u679c\u6709\u5fc5\u8981\uff0c\u53ef\u4ee5\u81ea\u5df1\u5173\u6389\u3002</li> </ul> <p>\u987a\u5e8f\u7d22\u5f15</p> <p>\u5728\u4f20\u7edf\u6570\u636e\u5e93\u9886\u57df\uff0c\u57fa\u672c\u4e0a\u53ea\u6709 B+\u6811\u4e00\u79cd\uff0cB+\u6811\u53ef\u4ee5\u8bf4\u662f\u9875\u9762\u4e3a\u5355\u4f4d\u7ec4\u7ec7\u6570\u636e\u7684\u6570\u636e\u5e93\u67b6\u6784\u7684\u57fa\u77f3\u3002\u7a76\u5176\u539f\u56e0\uff0c\u4e3b\u8981\u8fd8\u662f\u56e0\u4e3a B+\u6811\u5404\u9879\u64cd\u4f5c\u7684\u5747\u8861\u6027\uff0c\u65e0\u8bba\u662f\u70b9\u67e5\u8be2\uff0c\u8303\u56f4\u67e5\u8be2\uff0c\u8fd8\u662f\u63d2\u5165\uff0c\u5220\u9664\u7b49\uff0cB+\u6811\u5747\u80fd\u5728\u53ef\u63a5\u53d7\u7684 IO \u4ee3\u4ef7\u5185\u5b8c\u6210\u3002</p> <p>\u987a\u5e8f\u7d22\u5f15\u7684\u4e3b\u8981\u6570\u636e\u7ed3\u6784\u662f B+Tree \u3002\u5c06\u7d22\u5f15\u5217\u6309\u7167 B+tree \u8fd9\u79cd\u6570\u636e\u7ed3\u6784\u6765\u5b58\u50a8\uff0c\u672c\u8d28\u4e0a\u5c31\u662f\u4e00\u79cd\u6392\u597d\u5e8f\u7684\u6570\u636e\u7ed3\u6784\u3002\u52a0\u5feb\u6570\u636e\u67e5\u627e\u6548\u7387\u3002</p> <p>\u7d22\u5f15\u9879\u662f\u7531\u7d22\u5f15\u7801\u503c\u548c\u6307\u5411\u5177\u6709\u8be5\u7d22\u5f15\u7801\u7684\u4e00\u6761\u6216\u591a\u6761\u8bb0\u5f55\u7684\u6307\u9488\u7ec4\u6210\u3002</p> <p>\u9762\u8bd5\u9898\u4e8c\uff1a\u4e3a\u4ec0\u4e48\u4e0d\u7528\u7ea2\u9ed1\u6811\uff1f\u800c\u662f B \u6811</p> <ul> <li> <p>\u7ea2\u9ed1\u6811\u4e00\u4e2a\u7d22\u5f15\u8282\u70b9\u7a7a\u95f4\u4e2d\u53ea\u6709\u4e00\u4e2a\u5143\u7d20\uff0c\u5982\u679c\u6d77\u91cf\u6570\u636e\u65f6\uff0c\u5219\u6811\u7684\u9ad8\u5ea6\u4f1a\u975e\u5e38\u9ad8\uff0c\u6548\u7387\u4e00\u6837\u5f88\u4f4e\u3002</p> </li> <li> <p>B-\u6811 \uff0c\u6bcf\u4e2a\u7d22\u5f15\u8282\u70b9\u7684</p> </li> </ul> <p>\u9762\u8bd5\u9898\u4e00\uff1a\u4e3a\u4ec0\u4e48\u662f B+tree \uff0c\u800c\u4e0d\u662f B-tree \uff1f (\u5176\u5b9e\u5c31\u662f\u5728\u95ee\u8fd9\u4e24\u4e2a\u6570\u636e\u7ed3\u6784\u6709\u4ec0\u4e48\u4e0d\u540c\uff1f)</p> <ul> <li> <p>B+tree \u6811\u975e\u53f6\u5b50\u8282\u70b9\u4e2d\u4e0d\u5b58\u50a8\u6570\u636e\u5143\u7d20\uff0c\u53ea\u5b58\u50a8\u5197\u4f59\u7d22\u5f15\uff08\u4e00\u5c42\u53ef\u4ee5\u653e\u66f4\u591a\u7d22\u5f15\uff09\u3002</p> </li> <li> <p>B+Tree \u53f6\u5b50\u8282\u70b9\u662f\u987a\u5e8f\u6392\u5217\u7684\uff0c\u5e76\u4e14\u76f8\u90bb\u7684\u8282\u70b9\u5177\u6709\u987a\u5e8f\u5f15\u7528(\u6709\u6307\u9488)\u7684\u5173\u7cfb\u3002\uff08\u63d0\u9ad8\u533a\u95f4\u67e5\u627e\u8bbf\u95ee\u80fd\u529b\uff09</p> </li> </ul> <p>B+ \u6811\u4e0e B \u6811\u5dee\u5f02\u7684\u70b9\uff0c\u4e3b\u8981\u662f\u4ee5\u4e0b\u8fd9\u51e0\u70b9\uff1a</p> <ul> <li>\u53f6\u5b50\u8282\u70b9\uff08\u6700\u5e95\u90e8\u7684\u8282\u70b9\uff09\u624d\u4f1a\u5b58\u653e\u5b9e\u9645\u6570\u636e\uff08\u7d22\u5f15+\u8bb0\u5f55\uff09\uff0c\u975e\u53f6\u5b50\u8282\u70b9\u53ea\u4f1a\u5b58\u653e\u7d22\u5f15\uff1b</li> <li>\u6240\u6709\u7d22\u5f15\u90fd\u4f1a\u5728\u53f6\u5b50\u8282\u70b9\u51fa\u73b0\uff0c\u53f6\u5b50\u8282\u70b9\u4e4b\u95f4\u6784\u6210\u4e00\u4e2a\u6709\u5e8f\u94fe\u8868\uff1b</li> <li>\u975e\u53f6\u5b50\u8282\u70b9\u7684\u7d22\u5f15\u4e5f\u4f1a\u540c\u65f6\u5b58\u5728\u5728\u5b50\u8282\u70b9\u4e2d\uff0c\u5e76\u4e14\u662f\u5728\u5b50\u8282\u70b9\u4e2d\u6240\u6709\u7d22\u5f15\u7684\u6700\u5927\uff08\u6216\u6700\u5c0f\uff09\u3002</li> <li> <p>\u975e\u53f6\u5b50\u8282\u70b9\u4e2d\u6709\u591a\u5c11\u4e2a\u5b50\u8282\u70b9\uff0c\u5c31\u6709\u591a\u5c11\u4e2a\u7d22\u5f15\uff1b</p> </li> <li> <p>B+Tree \u53f6\u5b50\u8282\u70b9\u5305\u542b\u6240\u6709\u7d22\u5f15\u5b57\u6bb5</p> </li> </ul> <p>InnoDB \u5b58\u50a8\u5f15\u64ce\u6700\u5c0f\u50a8\u5b58\u5355\u5143\u662f\u9875\uff0c\u4e00\u9875\u5927\u5c0f\u5c31\u662f 16k\u3002 B+\u6811\u53f6\u5b50\u5b58\u7684\u662f\u6570\u636e\uff0c\u5185\u90e8\u8282\u70b9\u5b58\u7684\u662f\u952e\u503c+\u6307\u9488\u3002\u7d22\u5f15\u7ec4\u7ec7\u8868\u901a\u8fc7\u975e\u53f6\u5b50\u8282\u70b9\u7684\u4e8c\u5206\u67e5\u627e\u6cd5\u4ee5\u53ca\u6307\u9488\u786e\u5b9a\u6570\u636e\u5728\u54ea\u4e2a\u9875\u4e2d\uff0c\u8fdb\u800c\u518d\u53bb\u6570\u636e\u9875\u4e2d\u627e\u5230\u9700\u8981\u7684\u6570\u636e\uff1b</p> <p>\u4e3a\u4ec0\u4e48\u6ca1\u6709\u4e8c\u53c9\u6811\u4f5c\u4e3a\u5b83\u7684\u7d22\u5f15\u6570\u636e\u7ed3\u6784\u5462\uff1f</p> <p>\u4e8c\u53c9\u6811\u662f\u901a\u8fc7\u4e8c\u5206\u67e5\u627e\u6765\u8fdb\u884c\u5b9a\u4f4d\u6570\u636e\u7684\uff0c\u6240\u4ee5\u6548\u679c\u8fd8\u662f\u4e0d\u9519\u7684\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u662f O(logn)\uff1b</p> <p>\u4f46\u662f\u4e8c\u53c9\u6811\u6709\u4e2a\u95ee\u9898\uff0c\u5c31\u662f\u5728\u7279\u6b8a\u60c5\u51b5\u4e0b\uff0c\u5b83\u4f1a\u9000\u5316\u6210\u4e00\u4e2a\u5355\u5411\u94fe\u8868\u3002\u8fd9\u4e2a\u65f6\u5019\uff0c\u5b83\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u5c31\u4f1a\u9000\u5316\u6210 O(n)\uff1b</p> <p>\u5e73\u8861\u4e8c\u53c9\u6811</p> <p>\u65e2\u7136\u4e8c\u53c9\u6811\u5728\u7279\u6b8a\u60c5\u51b5\u4e0b\u4f1a\u9000\u5316\u6210\u94fe\u8868\uff0c\u90a3\u4e48\u5e73\u8861\u4e8c\u53c9\u6811\u4e3a\u4ec0\u4e48\u4e0d\u53ef\u4ee5\u5462\uff1f</p> <p>\u56e0\u4e3a\u80fd\u4fdd\u6301\u5e73\u8861\uff0c\u6240\u4ee5\u5b83\u7684\u67e5\u8be2\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a O(logN)\uff0c\u81f3\u4e8e\u600e\u4e48\u4fdd\u6301\u5e73\u8861\u7684\uff0c\u4e3b\u8981\u662f\u505a\u4e00\u4e9b\u5de6\u65cb\uff0c\u53f3\u65cb\u7b49\uff0c\u5177\u4f53\u4fdd\u6301\u5e73\u8861\u7684\u7ec6\u8282\u4e0d\u662f\u672c\u6587\u4e3b\u8981\u5185\u5bb9\uff0c\u60f3\u4e86\u89e3\u7684\u53ef\u81ea\u884c\u641c\u7d22\u3002</p> <p>\u7528\u8fd9\u4e2a\u6570\u636e\u7ed3\u6784\u6765\u505a MySQL \u7684\u7d22\u5f15\u4f1a\u6709 \u4ec0\u4e48\u95ee\u9898\u5462\uff1f</p> <ul> <li>\u78c1\u76d8 IO \u8fc7\u591a\uff1a\u5728 MySQL \u5f53\u4e2d\uff0c\u4e00\u6b21 IO \u64cd\u4f5c\u53ea\u8bfb\u53d6\u4e00\u4e2a\u8282\u70b9\uff0c\u90a3\u4e48\u4e00\u4e2a\u8282\u70b9\u82e5\u662f\u6700\u591a\u5c31\u4e24\u4e2a\u5b50\u8282\u70b9\u7684\u8bdd\uff0c\u90a3\u4e48\u5c31\u53ea\u6709\u8fd9\u4e24\u4e2a\u5b50\u8282\u70b9\u7684\u67e5\u8be2\u8303\u56f4\uff0c\u6240\u4ee5\u8981\u7cbe\u786e\u5230\u5177\u4f53\u7684\u6570\u636e\u65f6\uff0c\u5c31\u9700\u8981\u8fdb\u884c\u591a\u6b21\u8bfb\u53d6\uff0c\u5982\u679c\u6811\u975e\u5e38\u6df1\u7684\u8bdd\uff0c\u90a3\u4e48\u5c06\u4f1a\u8fdb\u884c\u5927\u91cf\u7684\u78c1\u76d8 IO\u3002\u6027\u80fd\u81ea\u7136\u4e0b\u964d\u4e86\u3002</li> <li>\u7a7a\u95f4\u5229\u7528\u7387\u4f4e\uff1a\u5bf9\u4e8e\u5e73\u8861\u4e8c\u53c9\u6811\u6765\u8bf4\uff0c\u6bcf\u4e2a\u8282\u70b9\u503c\u4fdd\u5b58\u4e00\u4e2a\u5173\u952e\u5b57\uff0c\u4e00\u4e2a\u6570\u636e\u533a\uff0c\u4e24\u4e2a\u5b50\u8282\u70b9\u7684\u6307\u9488\u3002\u8fd9\u6837\u5bfc\u81f4\u4e86\uff0c\u4e00\u6b21\u8f9b\u8f9b\u82e6\u82e6\u7684 IO \u64cd\u4f5c\u5c31\u53ea\u52a0\u8f7d\u8fd9\u4e48\u70b9\u6570\u636e\uff0c\u5b9e\u5728\u662f\u6709\u70b9\u6740\u9e21\u7528\u725b\u5200\u4e86\u3002</li> <li>\u67e5\u8be2\u6548\u679c\u4e0d\u7a33\u5b9a\uff1a\u5982\u679c\u5728\u4e00\u4e2a\u9ad8\u5ea6\u5f88\u6df1\u7684\u5e73\u8861\u4e8c\u53c9\u6811\u4e2d\uff0c\u82e5\u662f\u67e5\u8be2\u7684\u6570\u636e\u6b63\u597d\u662f\u6839\u8282\u70b9\uff0c\u90a3\u4e48\u5c31\u4f1a\u5f88\u5feb\u7684\u67e5\u5230\uff0c\u82e5\u662f\u67e5\u8be2\u7684\u6570\u636e\u6b63\u597d\u662f\u53f6\u5b50\u8282\u70b9\uff0c\u90a3\u4e48\u4f1a\u8fdb\u884c\u591a\u6b21\u78c1\u76d8 IO \u540e\u624d\u80fd\u8fd4\u56de\uff0c\u54cd\u5e94\u65f6\u95f4\u6709\u53ef\u80fd\u548c\u6839\u8282\u70b9\u7684\u4e0d\u5728\u4e00\u4e2a\u6570\u91cf\u7ea7\u4e0a\u3002</li> </ul> <p>\u867d\u7136\u8bf4\u4e8c\u53c9\u6811\u89e3\u51b3\u7684\u5e73\u8861\u7684\u95ee\u9898\uff0c\u4f46\u662f\u4e5f\u5e26\u6765\u4e86\u65b0\u7684\u95ee\u9898\uff0c\u90a3\u5c31\u662f\u7531\u4e8e\u5b83\u672c\u8eab\u6811\u7684\u6df1\u5ea6\u7684\uff0c\u4f1a\u9020\u6210\u4e00\u7cfb\u5217\u7684\u6548\u7387\u95ee\u9898\u3002</p> <p>\u90a3\u4e48\u4e3a\u4e86\u89e3\u51b3\u5e73\u8861\u4e8c\u53c9\u6811\u7684\u8fd9\u7c7b\u95ee\u9898\uff0c\u5e73\u8861\u591a\u53c9\u6811\uff08Balance Tree\uff09\u5c31\u6210\u4e3a\u4e86\u66f4\u597d\u7684\u9009\u62e9\u3002</p> <p>\u5e73\u8861\u591a\u53c9\u6811\uff08Balance Tree--B-Tree\uff09</p> <p>B-Tree \u7684\u610f\u601d\u662f\u5e73\u8861\u591a\u53c9\u6811\uff0c\u4e00\u822c B-Tree \u4e2d\u7684\u4e00\u4e2a\u8282\u70b9\u6709\u591a\u5c11\u4e2a\u5b50\u8282\u70b9\uff0c\u6211\u4eec\u5c31\u79f0\u4e3a\u591a\u5c11\u9636\u7684 B-Tree\u3002\u901a\u5e38\u7528 m \u8868\u793a\u9636\u6570\uff0c\u5f53 m \u4e3a 2 \u7684\u65f6\u5019\uff0c\u5c31\u662f\u5e73\u8861\u4e8c\u53c9\u6811\u3002</p> <p>\u4e00\u68f5 B-Tree \u7684\u6bcf\u4e2a\u8282\u70b9\u4e0a\u6700\u591a\u80fd\u6709 m-1 \u4e2a\u5173\u952e\u5b57\uff0c\u6700\u5c11\u8981\u5b58\u653e Math.ceil(m/2)-1 \u4e2a\u5173\u952e\u5b57\uff0c\u6240\u6709\u7684\u53f6\u5b50\u8282\u70b9\u90fd\u5728\u540c\u4e00\u5c42\u3002\u5982\u4e0b\u56fe\u5c31\u662f\u4e00\u4e2a 4 \u9636\u7684 B-Tree\u3002</p> <p>https://www.cnblogs.com/jimoer/p/14353022.html</p>"},{"location":"foundmental/2.MySQL%E7%B4%A2%E5%BC%95/#innodb","title":"InnoDB \u5b58\u50a8\u5f15\u64ce","text":""},{"location":"foundmental/2.MySQL%E7%B4%A2%E5%BC%95/#mysql","title":"MySQL \u4e2d\u7684\u54c8\u5e0c\u7d22\u5f15","text":"<p>MySQL \u6700\u5e38\u7528\u5b58\u50a8\u5f15\u64ce InnoDB \u548c MyISAM \u90fd\u4e0d\u652f\u6301 Hash \u7d22\u5f15\uff0c\u5b83\u4eec\u9ed8\u8ba4\u7684\u7d22\u5f15\u90fd\u662f B-Tree\u3002</p> <p>\u4f46\u662f\u5982\u679c\u4f60\u5728\u521b\u5efa\u7d22\u5f15\u7684\u65f6\u5019\u5b9a\u4e49\u5176\u7c7b\u578b\u4e3a Hash\uff0c\u6210\u529f\u5efa\u8868\uff0c\u800c\u4e14\u4f60\u901a\u8fc7 SHOW CREATE TABLE \u548c show index from table \u6765\u770b\uff0c\u5b9e\u9645\u8fd8\u662f B-Tree \u3002</p> <p>\u67e5\u9605\u5b98\u7f51\u6587\u6863\uff0c\u53ef\u4ee5\u53d1\u73b0 InnoDB \u652f\u6301\u7684\u6240\u6709\u7279\u6027\uff0c\u5176\u4e2d\u5bf9 Hash index \u7279\u5f81\u7684\u652f\u6301\u63cf\u8ff0\u662f\uff1a</p> <p>No (InnoDB utilizes hash indexes internally for its Adaptive Hash Index feature.)</p> <p>\u4e0d\u652f\u6301\uff08InnoDB \u5728\u5185\u90e8\u5229\u7528 hash \u7d22\u5f15\u6765\u5b9e\u73b0\u5176\u81ea\u9002\u5e94 hash \u7d22\u5f15\u7279\u6027\uff09</p> <p>\u6839\u636e\u6587\u6863\u53d1\u73b0\uff0c\u81ea\u9002\u5e94\u7d22\u5f15\u662f InnoDB \u5f15\u64ce\u7684\u5185\u5b58\u7ed3\u6784\u4e2d\u7684\u4e00\u79cd\u7279\u6027\u3002\u5bf9\u81ea\u9002\u5e94 hash \u7d22\u5f15\u7684\u63cf\u8ff0:</p> <p>\u81ea\u9002\u5e94 hash \u7d22\u5f15\u7279\u6027\u4f7f InnoDB \u80fd\u591f\u5728\u5177\u6709\u9002\u5f53\u7684\u5de5\u4f5c\u8d1f\u8f7d\u548c\u8db3\u591f\u7684\u7f13\u51b2\u6c60\u5185\u5b58\u7684\u7cfb\u7edf\u4e0a\u6267\u884c\u66f4\u50cf\u5185\u5b58\u4e2d\u7684\u6570\u636e\u5e93\uff0c\u800c\u4e0d\u727a\u7272\u4e8b\u52a1\u7279\u6027\u6216\u53ef\u9760\u6027\u3002</p> <p>\u603b\u7684\u6765\u8bf4\u5c31\u662f\u63d0\u9ad8\u4e86\u67e5\u8be2\u6027\u80fd\u3002\u8fd9\u91cc\u7684\u81ea\u9002\u5e94\u6307\u7684\u662f\u4e0d\u9700\u8981\u4eba\u5de5\u6765\u5236\u5b9a\uff0c\u800c\u662f\u7cfb\u7edf\u6839\u636e\u60c5\u51b5\u6765\u81ea\u52a8\u5b8c\u6210\u7684\u3002</p> <p>\u54c8\u5e0c hash \u67e5\u627e\u975e\u5e38\u5feb\uff0c\u4e00\u822c\u60c5\u51b5\u4e0b\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a O(1)\uff0c\u4e00\u822c\u4ec5\u9700\u8981\u4e00\u6b21\u67e5\u627e\u5c31\u80fd\u5b9a\u4f4d\u3002\u800c B+ \u6811\u7684\u67e5\u627e\u6b21\u6570\uff0c\u53d6\u51b3\u4e8e B+ \u6811\u7684\u9ad8\u5ea6\uff0cB+ \u6811\u7684\u9ad8\u5ea6\u4e00\u822c\u4e3a 34 \u5c42\uff0c\u56e0\u6b64\u4fbf\u9700\u8981\u67e5\u8be2 34 \u6b21\u3002</p> <p><code>InnoDB</code>\u50a8\u5f15\u64ce\u901a\u8fc7\u89c2\u5bdf\u8868\u4e0a\u7d22\u5f15\u9875\u7684\u67e5\u8be2\uff0c\u5982\u679c\u53d1\u73b0\u5efa\u7acb\u54c8\u5e0c\u7d22\u5f15\u53ef\u4ee5\u63d0\u5347\u67e5\u8be2\u6548\u7387\uff0c\u5219\u4f1a\u81ea\u52a8\u5efa\u7acb\u54c8\u5e0c\u7d22\u5f15\uff0c\u79f0\u4e4b\u4e3a\u81ea\u9002\u5e94\u54c8\u5e0c\u7d22\u5f15<code>Adaptive Hash Index</code>\u3002</p> <p><code>AHI</code>\u662f\u57fa\u4e8e\u7f13\u51b2\u6c60\u7684 B+\u6811\u6784\u9020\u7684\u7d22\u5f15\uff0c\u56e0\u6b64\u901f\u5ea6\u975e\u5e38\u5feb\uff0c\u800c\u4e14\u4e0d\u9700\u8981\u5bf9\u6574\u5f20\u8868\u5efa\u7acb\u7d22\u5f15\u3002<code>InnoDB</code>\u5b58\u50a8\u5f15\u64ce\u4f1a\u81ea\u52a8\u6839\u636e\u8bbf\u95ee\u7684\u9891\u7387\u548c\u6a21\u5f0f\u6765\u81ea\u52a8\u4e3a\u67d0\u4e9b\u70ed\u70b9\u9875\u5efa\u7acb\u54c8\u5e0c\u7d22\u5f15\u3002</p> <p>\u8003\u8651\u5230\u4e0d\u540c\u7cfb\u7edf\u7684\u5dee\u5f02\uff0c\u6709\u4e9b\u7cfb\u7edf\u5f00\u542f\u81ea\u9002\u5e94\u54c8\u5e0c\u7d22\u5f15\u53ef\u80fd\u4f1a\u5bfc\u81f4\u6027\u80fd\u63d0\u5347\u4e0d\u660e\u663e\uff0c\u800c\u4e14\u4e3a\u76d1\u63a7\u7d22\u5f15\u9875\u67e5\u8be2\u6b21\u6570\u589e\u52a0\u4e86\u591a\u4f59\u7684\u6027\u80fd\u635f\u8017\uff0c<code>MySQL5.7</code>\u66f4\u6539\u4e86 AHI \u5b9e\u73b0\u673a\u5236\uff0c\u6bcf\u4e2a AHI \u90fd\u5206\u914d\u4e86\u7279\u5b9a\u5206\u533a\uff0c\u6bcf\u4e2a\u7d22\u5f15\u90fd\u7ed1\u5b9a\u5230\u7279\u5b9a\u5206\u533a\uff0c\u5e76\u4e14\u6bcf\u4e2a\u5206\u533a\u5747\u53d7\u5355\u72ec\u7684\u9501\u5b58\u5668\u4fdd\u62a4\u3002\u5206\u533a\u7531 <code>innodb_adaptive_hash_index_parts</code> \u53d8\u91cf\u63a7\u5236\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c<code>innodb_adaptive_hash_index_parts</code> \u53d8\u91cf\u503c\u4e3a 8\uff0c\u6700\u5927\u503c\u4e3a 512\u3002</p> <p>\u90a3\u4ec0\u4e48\u60c5\u51b5\u4e0b\u624d\u4f1a\u4f7f\u7528\u81ea\u9002\u5e94 Hash \u7d22\u5f15\u5462\uff1f\u5982\u679c\u67d0\u4e2a\u6570\u636e\u7ecf\u5e38\u4f1a\u8bbf\u95ee\u5230\uff0c\u5f53\u6ee1\u8db3\u4e00\u5b9a\u6761\u4ef6\u7684\u65f6\u5019\uff0c\u5c31\u4f1a\u5c06\u8fd9\u4e2a\u6570\u636e\u9875\u7684\u5730\u5740\u5b58\u653e\u5230 Hash \u8868\u4e2d\u3002\u8fd9\u6837\u4e0b\u6b21\u67e5\u8be2\u7684\u65f6\u5019\uff0c\u5c31\u53ef\u4ee5\u76f4\u63a5\u627e\u5230\u8fd9\u4e2a\u9875\u9762\u7684\u6240\u5728\u4f4d\u7f6e\u3002\u9700\u8981\u8bf4\u660e\u7684\u662f\uff1a</p> <ul> <li> <p>\u81ea\u9002\u5e94\u54c8\u5e0c\u7d22\u5f15\u53ea\u4fdd\u5b58\u70ed\u6570\u636e\uff08\u7ecf\u5e38\u88ab\u4f7f\u7528\u5230\u7684\u6570\u636e\uff09\uff0c\u5e76\u975e\u5168\u8868\u6570\u636e\u3002\u56e0\u6b64\u6570\u636e\u91cf\u5e76\u4e0d\u4f1a\u5f88\u5927\uff0c\u53ef\u4ee5\u8ba9\u81ea\u9002\u5e94 Hash \u653e\u5230\u7f13\u51b2\u6c60\u4e2d\uff0c\u4e5f\u5c31\u662f InnoDB buffer pool\uff0c\u8fdb\u4e00\u6b65\u63d0\u5347\u67e5\u627e\u6548\u7387\u3002</p> </li> <li> <p>InnoDB \u4e2d\u7684\u81ea\u9002\u5e94 Hash \u76f8\u5f53\u4e8e\u662f\u201c\u7d22\u5f15\u7684\u7d22\u5f15\u201d\uff0c\u91c7\u7528 Hash \u7d22\u5f15\u5b58\u50a8\u7684\u662f B+\u6811\u7d22\u5f15\u4e2d\u7684\u9875\u9762\u7684\u5730\u5740\u3002\u8fd9\u4e5f\u5c31\u662f\u4e3a\u4ec0\u4e48\u53ef\u4ee5\u79f0**\u81ea\u9002\u5e94 Hash \u4e3a\u7d22\u5f15\u7684\u7d22\u5f15**\u3002\u91c7\u7528\u81ea\u9002\u5e94 Hash \u7d22\u5f15\u76ee\u7684\u662f\u53ef\u4ee5\u6839\u636e SQL \u7684\u67e5\u8be2\u6761\u4ef6\u52a0\u901f\u5b9a\u4f4d\u5230\u53f6\u5b50\u8282\u70b9\uff0c\u7279\u522b\u662f\u5f53 B+\u6811\u6bd4\u8f83\u6df1\u7684\u65f6\u5019\uff0c\u901a\u8fc7\u81ea\u9002\u5e94 Hash \u7d22\u5f15\u53ef\u4ee5\u63d0\u9ad8\u6570\u636e\u7684\u68c0\u7d22\u6548\u7387\u3002</p> </li> <li> <p>\u81ea\u9002\u5e94 Hash \u91c7\u7528 Hash \u51fd\u6570\u6620\u5c04\u5230\u4e00\u4e2a\u54c8\u5e0c\u8868\u4e2d\uff0c\u6240\u4ee5\u5bf9\u4e8e\u5b57\u5178\u7c7b\u578b\u7684\u6570\u636e\u67e5\u627e\u975e\u5e38\u65b9\u4fbf \u54c8\u5e0c\u8868\u662f\u6570\u7ec4+\u94fe\u8868\u7684\u5f62\u5f0f\u3002\u901a\u8fc7 Hash \u51fd\u6570\u53ef\u4ee5\u8ba1\u7b97\u7d22\u5f15\u952e\u503c\u6240\u5bf9\u5e94\u7684 bucket\uff08\u6876\uff09\u7684\u4f4d\u7f6e\uff0c\u5982\u679c\u4ea7\u751f Hash \u51b2\u7a81\uff0c\u5982\u679c\u4ea7\u751f\u54c8\u5e0c\u51b2\u7a81\uff0c\u5c31\u9700\u8981\u904d\u5386\u94fe\u8868\u6765\u89e3\u51b3\u3002</p> </li> <li> <p>\u662f\u5426\u5f00\u542f\u4e86\u81ea\u9002\u5e94 Hash\uff0c\u53ef\u4ee5\u901a\u8fc7 innodb_adaptive_hash_index \u53d8\u91cf\u6765\u67e5\u770b\uff0c\u6bd4\u5982\uff1amysql&gt; show variables like '%adaptive_hash_index';</p> </li> </ul> <p>\u6240\u4ee5\uff0c\u603b\u7ed3\u4e0b InnoDB \u672c\u8eab\u4e0d\u652f\u6301 Hash\uff0c\u4f46\u662f\u63d0\u4f9b\u81ea\u9002\u5e94 Hash \u7d22\u5f15\uff0c\u4e0d\u9700\u8981\u7528\u6237\u6765\u64cd\u4f5c\uff0c\u800c\u662f\u5b58\u50a8\u5f15\u64ce\u81ea\u52a8\u5b8c\u6210\u7684\u3002</p> <p>\u81ea\u9002\u5e94 Hash \u4e5f\u662f InnoDB \u4e09\u5927\u5173\u952e\u7279\u6027\u4e4b\u4e00\uff0c\u53e6\u5916\u4e24\u4e2a\u5206\u522b\u662f\u63d2\u5165\u7f13\u51b2\uff08Insert Buffer\uff09\u548c\u4e8c\u6b21\u5199(Double Write)\u3002</p> <p>\u867d\u7136\u5e38\u89c1\u5b58\u50a8\u5f15\u64ce\u5e76\u4e0d\u652f\u6301 Hash \u7d22\u5f15\uff0c\u4f46 InnoDB \u6709\u53e6\u4e00\u79cd\u5b9e\u73b0\u65b9\u6cd5\uff1a\u81ea\u9002\u5e94\u54c8\u5e0c\u7d22\u5f15\u3002</p> <p>InnoDB \u5b58\u50a8\u5f15\u64ce\u4f1a\u76d1\u63a7\u5bf9\u8868\u4e0a\u7d22\u5f15\u7684\u67e5\u627e\uff0c\u5982\u679c\u89c2\u5bdf\u5230\u5efa\u7acb\u54c8\u5e0c\u7d22\u5f15\u53ef\u4ee5\u5e26\u6765\u901f\u5ea6\u7684\u63d0\u5347\uff0c\u5219\u5efa\u7acb\u54c8\u5e0c\u7d22\u5f15\u3002</p>"},{"location":"foundmental/2.MySQL%E7%B4%A2%E5%BC%95/#_3","title":"\u7a20\u5bc6\u7d22\u5f15","text":"<p>\u7d22\u5f15\u662f\u8fde\u7eed\u7684\uff0c\u5373\u5728\u8981\u7d22\u5f15\u5217\u7684\u6bcf\u4e00\u884c\u4e2d\uff0c\u90fd\u6709\u7d22\u5f15\u9879\u3002\u7d22\u5f15\u9879\u5305\u62ec</p> <p>\u7a20\u5bc6\u7d22\u5f15\u7684\u7279\u70b9\u662f\u5360\u7528\u7a7a\u95f4\u5927\uff0c\u641c\u7d22\u6548\u7387\u9ad8\u3002\u7edd\u5927\u591a\u6570\u5173\u7cfb\u578b\u6570\u636e\u5e93\u7684\u7d22\u5f15\u90fd\u662f\u7a20\u5bc6\u7d22\u5f15\u3002</p>"},{"location":"foundmental/2.MySQL%E7%B4%A2%E5%BC%95/#_4","title":"\u7a00\u758f\u7d22\u5f15","text":"<p>\u7d22\u5f15\u662f\u975e\u8fde\u7eed\u7684\u3002</p> <p>\u5728\u7a00\u758f\u7d22\u5f15\u4e2d\uff0c\u53ea\u4e3a\u641c\u7d22\u7801\u7684\u67d0\u4e9b\u503c\u5efa\u7acb\u7d22\u5f15\u9879\u3002\u53ea\u6709\u5f53\u6570\u636e\u662f\u6309\u7167</p> <p>\u8003\u8651\u4e00\u672c\u5b57\u5178\uff0c\u6bcf\u4e00\u9875\u7684\u9875\u7709\u90fd\u987a\u5e8f\u7684\u5217\u51fa\u4e86\u8be5\u9875\u4e2d\u6309\u5b57\u6bcd\u987a\u5e8f\u51fa\u73b0\u7684\u7b2c\u4e00\u4e2a\u5355\u8bcd\uff0c\u8fd9\u4e2a\u5b57\u5178\u6240\u6709\u9875\u7684\u9875\u7709\u6784\u6210\u4e86\u8fd9\u4e2a\u5b57\u5178\u7684\u7a00\u758f\u7d22\u5f15\u3002</p> <p>\u663e\u7136\uff0c\u7a20\u5bc6\u7d22\u5f15\u662f\u53ef\u4ee5\u5feb\u901f\u5b9a\u4f4d\u4e00\u6761\u8bb0\u5f55\u7684\u3002</p> <p>\u4f46\u662f\u7a00\u758f\u7d22\u5f15\u7684\u4f18\u70b9\u5728\u4e8e\uff1a</p> <ul> <li>\u5360\u7528\u66f4\u5c11\u7684\u7a7a\u95f4\u3002</li> <li>\u63d2\u5165\u548c\u5220\u9664\u65f6\u7684\u5f00\u9500\u66f4\u5c0f\u3002</li> </ul> <p>\u7cfb\u7edf\u8bbe\u8ba1\u8005\u5fc5\u987b\u5728\u5b58\u53d6\u65f6\u95f4\u548c\u7a7a\u95f4\u5f00\u9500\u4e4b\u95f4\u6743\u8861\u3002\u5c3d\u7ba1\u6709\u5173\u8fd9\u4e00\u6743\u8861\u7684\u51b3\u5b9a\u4f9d\u8d56\u4e8e\u5177\u4f53\u7684\u5e94\u7528\uff0c\u4f46\u662f\u4e3a\u6bcf\u4e2a\u5757\u5efa\u7acb\u7a00\u758f\u7d22\u5f15\u662f\u6bd4\u8f83\u597d\u7684\u6298\u4e2d\u3002\u8bbe\u8ba1\u7d22\u5f15\u7684\u7c92\u5ea6\u5f88\u91cd\u8981</p> <p>\u5904\u7406\u6570\u636e\u5e93\u67e5\u8be2\u7684\u5f00\u9500\uff0c\u4e3b\u8981\u662f\u628a\u5757\u4ece\u78c1\u76d8\u8bfb\u53d6\u5230\u5185\u5b58\u4e2d\u7684\u65f6\u95f4\u3002\u4e00\u65e6\u5757\u88ab\u8bfb\u5165\u5185\u5b58\uff0c\u626b\u63cf\u6574\u4e2a\u5757\u7684\u65f6\u95f4\u51e0\u4e4e\u662f\u53ef\u4ee5\u5ffd\u7565\u7684\u3002</p> <p>\uff08\u78c1\u76d8\u88ab\u8bfb\u53d6\u5230\u5185\u5b58\u662f\u4ee5\u5757\u4e3a\u5355\u4f4d\uff0c\u4e00\u4e2a\u6570\u636e\u5757\u4e2d\u7684\u53ef\u4ee5\u5b58\u53d6\u591a\u6761\u8bb0\u5f55\uff09</p>"},{"location":"foundmental/2.MySQL%E7%B4%A2%E5%BC%95/#_5","title":"\u591a\u7ea7\u7d22\u5f15","text":"<p>\u5047\u8bbe\u8981\u5728 100 000 000 \u884c\u6570\u636e\u4e0a\u5efa\u7acb\u4e86\u7a20\u5bc6\u7d22\u5f15\uff0c1 \u4e2a 4KB \u7684\u6570\u636e\u5757\u53ef\u4ee5\u5bb9\u7eb3 100 \u6761\u7d22\u5f15\u9879\u3002\u8fd9\u6837\u7d22\u5f15\u6587\u4ef6\u5c31\u9700\u8981\u5360\u7528 1 000 000 \u4e2a\u6570\u636e\u5757\u3002\u5373 4GB\u3002</p> <p>\u8fd9\u4e2a\u7d22\u5f15\u6587\u4ef6\u4ee5\u987a\u5e8f\u7684\u65b9\u5f0f\u5b58\u50a8\u5728\u78c1\u76d8\u4e2d\u3002</p> <p>\u5982\u679c\u7d22\u5f15\u5c0f\u5230\u53ef\u4ee5\u653e\u5230\u5185\u5b58\u4e2d\u3002\u90a3\u4e48\u641c\u7d22\u4e00\u4e2a\u7d22\u5f15\u9879\u7684\u65f6\u95f4\u975e\u5e38\u5c0f\u3002\uff08\u5373\u4f7f\u7d22\u5f15\u6bd4\u5185\u5b58\u5c0f\uff0c\u4e5f\u4e0d\u53ef\u80fd\u5168\u90e8\u8bfb\u5165\u5185\u5b58\uff0c\u5185\u5b58\u8fd8\u9700\u8981\u5904\u7406\u5176\u4ed6\u4efb\u52a1\uff09</p> <p>\u5728\u7d22\u5f15\u6587\u4ef6\u4e2d\uff0c\u7528\u4e8c\u5206\u67e5\u627e\u6cd5\u6765\u8fdb\u884c\u641c\u7d22\u3002</p> <p>\u591a\u7ea7\u7d22\u5f15\u7b80\u5355\u8bf4\uff0c\u5176\u5b9e\u5c31\u662f\u7d22\u5f15\u7684\u7d22\u5f15\u3002 \u518d</p>"},{"location":"foundmental/2.MySQL%E7%B4%A2%E5%BC%95/#_6","title":"\u7d22\u5f15\u7684\u66f4\u65b0","text":"<p>\u65e0\u8bba\u91c7\u7528\u4ec0\u4e48\u5f62\u5f0f\u7684\u7d22\u5f15\uff0c\u6bcf\u5f53\u6709\u8bb0\u5f55\u63d2\u5165\u6216\u8005\u5220\u9664\u65f6\uff0c\u7d22\u5f15\u90fd\u9700\u8981\u66f4\u65b0\u3002</p> <p>\u5982\u679c\u6709\u8bb0\u5f55\u66f4\u65b0\uff0c\u4efb\u4f55\u8be5\u8bb0\u5f55\u4e0a\u7684\u641c\u7d22\u7801\u53d7\u5f71\u54cd\u7684\u7d22\u5f15\u4e5f\u5fc5\u987b\u66f4\u65b0\u3002</p> <p>\u4f8b\u5982\uff0c\u5982\u679c\u4e00\u4e2a\u6559\u5e08\u7684\u7cfb\u53d1\u751f\u4e86\u53d8\u5316\uff0c\u90a3\u4e48 instructor \u4e0a\u7684 dept_name \u5217\u4e0a\u7684\u7d22\u5f15\u4e5f\u5fc5\u987b\u76f8\u5e94\u7684\u66f4\u65b0\u3002</p> <p>\u7d22\u5f15\u7684\u66f4\u65b0\u53ef\u4ee5\u8ba4\u4e3a\u662f\u5220\u9664\u65e7\u7684\u7d22\u5f15\uff0c\u968f\u540e\u63d2\u5165\u5bf9\u5e94\u7684\u65b0\u8bb0\u5f55\u3002\u56e0\u6b64\uff0c\u53ea\u9700\u8981\u8003\u8651\u7d22\u5f15\u7684\u63d2\u5165\u548c\u5220\u9664\u3002</p>"},{"location":"foundmental/2.MySQL%E7%B4%A2%E5%BC%95/#_7","title":"\u7d22\u5f15\u7c7b\u578b","text":"<p>\u6309\u7167\u7d22\u5f15\u7684\u6570\u636e\u7ed3\u6784\uff0cMySQL \u4e2d\u7684 \u7d22\u5f15\u65b9\u6cd5 \u53ef\u4ee5\u5206\u4e3a</p> <ul> <li> <p>\u54c8\u5e0c\u7d22\u5f15\uff08HASH\uff09(\u5176\u5b9e MySQL \u5e76\u4e0d\u652f\u6301\u54c8\u5e0c\u7d22\u5f15)</p> </li> <li> <p>BTREE \u7d22\u5f15\uff08BREE\uff09</p> </li> </ul> <p>\u6309\u7167\u7d22\u5f15\u7c7b\u578b\uff0c\u53ef\u4ee5\u5206\u4e3a\uff1a</p> <ul> <li>\u666e\u901a\u7d22\u5f15\uff08NORMAL\uff09</li> <li>\u552f\u4e00\u7d22\u5f15\uff08UNIQUE\uff09</li> <li>\u5168\u6587\u7d22\u5f15\uff08FULLTEXT\uff09\uff08MySQL8.0\uff09</li> <li>\u5730\u7406\u7d22\u5f15\uff08SPATIAL\uff09</li> </ul> <pre><code>-- \u7d22\u5f15\u8bed\u6cd5\uff1aALTER TABLE table1 ADD (UNIQUE| SPATIAL | FULLTEXT )INDEX idx_name(column(length)) USING  BTREE |HASH ;\n-- \u7d22\u5f15\u8bed\u6cd5\uff1aALTER TABLE table1 ADD INDEX idx_name(column) USING  BTREE |HASH ;\n\n-- \u6dfb\u52a0\u666e\u901a\u7684B-tree\u7d22\u5f15\nALTER TABLE t1   ADD INDEX idx_name(column(10)) USING BTREE;\n-- \u6dfb\u52a0unique\u7684B-tree\u7d22\u5f15\nALTER TABLE t1   ADD INDEX unique idx_name(column(10)) USING BTREE;\n</code></pre>"},{"location":"foundmental/2.MySQL%E7%B4%A2%E5%BC%95/#_8","title":"\u9690\u85cf\u7d22\u5f15","text":"<p>MySQL 8.0.19 \u4e2d\u65b0\u589e\u4e86\u4e09\u79cd\u7d22\u5f15\u65b9\u5f0f\uff1a\u9690\u85cf\u7d22\u5f15\u3001\u964d\u5e8f\u7d22\u5f15\u3001\u51fd\u6570\u7d22\u5f15</p> <p>\u9690\u85cf\u7d22\u5f15\u6982\u8ff0</p> <p>MySQL 8.0.19 \u53ca\u4ee5\u4e0a\u652f\u6301\u9690\u85cf\u7d22\u5f15\uff08invisible index\uff09\uff0c\u4e5f\u79f0\u4e3a\u4e0d\u53ef\u89c1\u7d22\u5f15\u3002\u9690\u85cf\u7d22\u5f15\u4e0d\u4f1a\u9ed8\u8ba4\u88ab\u4f18\u5316\u5668\u4f7f\u7528\u3002\u4e3b\u952e\u4e0d\u80fd\u8bbe\u7f6e\u4e3a\u9690\u85cf\uff08\u5305\u62ec\u663e\u5f0f\u8bbe\u7f6e\u6216\u9690\u5f0f\u8bbe\u7f6e\uff09</p> <p>\u5b9e\u9645\u4e0a\uff0c\u901a\u8fc7\u8fd9\u79cd\u65b9\u5f0f\u521b\u5efa\u7684\u7d22\u5f15\uff0c\u7d22\u5f15\u6587\u4ef6\u8fd8\u662f\u5b58\u5728\u7684\uff0c\u53ea\u662f\u9ed8\u8ba4\u4e0d\u4f1a\u88ab\u4f18\u5316\u5668\u4f7f\u7528\u3002</p> <p>\u8fd9\u4e2a\u529f\u80fd\u5728\u6d4b\u8bd5\u8bc4\u4f30\u7d22\u5f15\u6709\u6548\u6027\u65f6\u975e\u5e38\u6709\u7528\u3002DBA \u5bf9\u5e0c\u671b\u5220\u9664\u7684\u7d22\u5f15\u5f00\u542f\u8be5\u529f\u80fd\uff0c\u7ecf\u8fc7\u5b8c\u6574\u9a8c\u8bc1\uff0c\u786e\u8ba4\u4e4b\u540e\uff0c\u53ef\u4ee5\u653e\u5fc3\u5220\u9664\u7d22\u5f15\u3002</p> <p>\u6240\u6709\u7684\u7d22\u5f15\u9ed8\u8ba4\u662f\u53ef\u89c1\u7684\uff0c\u53ef\u4ee5\u5728 CREATE TABLE, CREATE INDEX, ALTER TABLE \u7684\u65f6\u5019\uff0c\u5bf9\u65b0\u7d22\u5f15\u8bbe\u7f6e\u4e3a\u4e0d\u53ef\u89c1\u3002\u4f7f\u7528\u65b9\u6cd5\u5982\u4e0b\uff1a</p> <pre><code>CREATE TABLE t1 (\n  i INT,\n  j INT,\n  k INT,\n  INDEX i_idx (i) INVISIBLE  -- \u9690\u85cf\u7d22\u5f15\n) ENGINE = InnoDB;\nCREATE INDEX j_idx ON t1 (j) INVISIBLE;  -- \u9690\u85cf\u7d22\u5f15\nALTER TABLE t1 ADD INDEX k_idx (k) INVISIBLE; -- \u9690\u85cf\u7d22\u5f15\n\n-- \u9690\u85cf\u7d22\u5f15\u4e0e\u53ef\u89c1\u7d22\u5f15\u7684\u8f6c\u6362\nALTER TABLE t1 ALTER INDEX i_idx INVISIBLE;\nALTER TABLE t1 ALTER INDEX i_idx VISIBLE;\n\n-- \u67e5\u770b\u8868\u4e2d\u7d22\u5f15\u662f\u5426\u4e3a\u9690\u85cf\u7d22\u5f15 show index from t1;\n\nSELECT INDEX_NAME, IS_VISIBLE FROM INFORMATION_SCHEMA.STATISTICS  WHERE TABLE_SCHEMA = 'db1' AND TABLE_NAME = 't1';\n\n+------------+------------+\n| INDEX_NAME | IS_VISIBLE |\n+------------+------------+\n| i_idx      | YES        |\n| j_idx      | NO         |\n| k_idx      | NO         |\n+------------+------------+\n</code></pre> <p>\u5f53\u5c06\u7d22\u5f15\u8bbe\u7f6e\u4e3a\u4e0d\u53ef\u89c1\u65f6\uff0c\u53ef\u4ee5\u901a\u8fc7\u4e0b\u9762\u51e0\u4e2a\u65b9\u6cd5\u786e\u8ba4\u4f18\u5316\u5668\u662f\u5426\u9700\u8981\u4f7f\u7528\u5230\u8be5\u7d22\u5f15\uff1a</p> <ul> <li> <p>\u4f7f\u7528\u5230\u8be5\u7d22\u5f15\u7684\u7d22\u5f15\u63d0\u793a\u8bed\u53e5\u4f1a\u53d1\u751f\u9519\u8bef\u3002(index hint)</p> </li> <li> <p>\u67e5\u8be2\u7684\u6267\u884c\u8ba1\u5212\u548c\u4e4b\u524d\u7684\u4e0d\u540c</p> </li> <li> <p>\u67e5\u8be2\u51fa\u73b0\u5728\u6162\u65e5\u5fd7\u4e2d</p> </li> <li> <p>Performance Schema \u91cc\u9762\u76f8\u5173\u7684\u67e5\u8be2\u5de5\u4f5c\u91cf\u4f1a\u589e\u52a0</p> </li> </ul> <p>\u9690\u85cf\u7d22\u5f15\u7684\u76f8\u5173\u8bf4\u660e</p> <ul> <li>\u9664\u4e86\u4e3b\u952e\uff0c\u5176\u4ed6\u7d22\u5f15\u90fd\u53ef\u4ee5\u8bbe\u7f6e\u4e3a\u9690\u85cf\u7d22\u5f15\u3002</li> <li> <p>\u5bf9\u4e8e\u552f\u4e00\u952e\uff1a\u4f8b\u5916\u60c5\u51b5: \u6ca1\u6709\u4e3b\u952e\u7684\u60c5\u51b5\u4e0b\uff0c\u7b2c\u4e00\u4e2a\u552f\u4e00\u952e \u4e0d\u53ef\u9690\u85cf\uff0c\u7b2c\u4e8c\u4e2a\u552f\u4e00\u952e\u53ef\u9690\u85cf\u3002</p> </li> <li> <p>MySQL \u5728\u6ca1\u6709\u4e3b\u952e\u7684\u60c5\u51b5\u4e0b \u662f\u628a\u7b2c\u4e00\u4e2a\u552f\u4e00\u5efa\u505a\u4e3a\u4e3b\u952e\u3002</p> </li> <li> <p>\u7cfb\u7edf\u53d8\u91cf optimizer_switch \u7684 use_invisible_indexes \u503c\u63a7\u5236\u4e86\u4f18\u5316\u5668\u6784\u5efa\u6267\u884c\u8ba1\u5212\u65f6\u662f\u5426\u4f7f\u7528\u9690\u85cf\u7d22\u5f15\u3002</p> </li> <li>\u5982\u679c\u8bbe\u7f6e\u4e3a off \uff08\u9ed8\u8ba4\u503c\uff09\uff0c\u4f18\u5316\u5668\u5c06\u4f1a\u5ffd\u7565\u9690\u85cf\u7d22\u5f15\uff08\u4e0e\u5f15\u5165\u8be5\u5c5e\u6027\u4e4b\u524d\u7684\u884c\u4e3a\u76f8\u540c\uff09\u3002</li> <li>\u5982\u679c\u8bbe\u7f6e\u4e3a on\uff0c\u9690\u85cf\u7d22\u5f15\u4ecd\u7136\u4e0d\u53ef\u89c1\uff0c\u4f46\u662f\u4f18\u5316\u5668\u5728\u6784\u5efa\u6267\u884c\u8ba1\u5212\u65f6\u5c06\u4f1a\u8003\u8651\u8fd9\u4e9b\u7d22\u5f15\u3002</li> </ul> <p>\u603b\u7ed3</p> <p>\u4e0d\u53ef\u89c1\u7d22\u5f15\u7279\u6027\u53ef\u4ee5\u7528\u4e8e\u6d4b\u8bd5\u5220\u9664\u67d0\u4e2a\u7d22\u5f15\u5bf9\u4e8e\u67e5\u8be2\u6027\u80fd\u7684\u5f71\u54cd\uff0c\u540c\u65f6\u53c8\u4e0d\u9700\u8981\u771f\u6b63\u5220\u9664\u7d22\u5f15\uff0c\u4e5f\u5c31\u907f\u514d\u4e86\u9519\u8bef\u5220\u9664\u4e4b\u540e\u7684\u7d22\u5f15\u91cd\u5efa\u3002</p> <p>\u5bf9\u4e8e\u4e00\u4e2a\u5927\u8868\u4e0a\u7684\u7d22\u5f15\u8fdb\u884c\u5220\u9664\u91cd\u5efa\u5c06\u4f1a\u975e\u5e38\u8017\u65f6\uff0c\u800c\u5c06\u5176\u8bbe\u7f6e\u4e3a\u4e0d\u53ef\u89c1\u6216\u53ef\u89c1\u5c06\u4f1a\u975e\u5e38\u7b80\u5355\u5feb\u6377\u3002</p>"},{"location":"foundmental/2.MySQL%E7%B4%A2%E5%BC%95/#_9","title":"\u5168\u6587\u7d22\u5f15","text":"<p>\u6211\u4eec\u5728\u7528\u4e00\u4e2a\u4e1c\u897f\u524d\uff0c\u5f97\u77e5\u9053\u4e3a\u4ec0\u4e48\u8981\u7528\u5b83\uff0c\u4f7f\u7528\u5168\u6587\u7d22\u5f15\u65e0\u975e\u6709\u4ee5\u4e0b\u539f\u56e0:</p> <p>1\u3001like \u67e5\u8be2\u592a\u6162\u3001json \u5b57\u6bb5\u67e5\u8be2\u592a\u6162\uff08\u8f66\u592a\u6162\u4e86\uff09</p> <p>2\u3001\u6ca1\u65f6\u95f4\u5f15\u5165 ElasticSearch\u3001Solr \u6216\u8005 Sphinx \u8fd9\u6837\u7684\u8f6f\u4ef6\uff0c\u6216\u8005\u6839\u672c\u5c31\u4e0d\u4f1a\u7528</p> <p>3\u3001\u52a0\u7d22\u5f15\u3001\u8054\u5408\u7d22\u5f15\u5565\u7684\u90fd\u5df2\u7ecf\u6162\u5f97\u4e0d\u884c\u4e86\uff08\u9650\u901f 80\uff0c\u8f66\u9876\u76d6\u90fd\u5378\u4e86\u4e5f\u53ea\u80fd\u5f00\u5230 30\uff09</p> <p>4\u3001\u4e3a\u4e86\u63d0\u5347\u4e00\u4e0b\u81ea\u5df1\u7684\u903c\u683c\uff08\u4eba\u5bb6\u95ee\u4f60\u6709\u6ca1\u6709\u5f00\u8fc7\u6cd5\u62c9\u5229\uff0c\u4f60\u8bf4\u5f00\u8fc7\u80af\u5b9a\u66f4\u6709\u6c14\u8d28\u4e00\u70b9\uff09</p> <p>\u7b80\u5355\u7684\u8bf4\uff0c\u5168\u6587\u7d22\u5f15\u5c31\u76f8\u5f53\u4e8e\u5927\u8bcd\u5178\u4e2d\u7684\u76ee\u5f55\uff0c\u901a\u8fc7\u67e5\u8be2\u76ee\u5f55\u53ef\u4ee5\u5feb\u901f\u5b9a\u4f4d\u5230\u60f3\u770b\u7684\u5185\u5bb9\u3002</p> <p>\u5168\u6587\u7d22\u5f15\u901a\u8fc7\u5efa\u7acb<code>\u5012\u6392\u7d22\u5f15</code>\u6765\u5feb\u901f\u5339\u914d\u6587\u6863\uff08\u4ec5\u5728 mysql5.6 \u7248\u672c\u4ee5\u4e0a\u652f\u6301\uff09\uff0c\u5168\u6587\u7d22\u5f15\u5c06\u8fde\u7eed\u7684<code>\u5b57\u6bcd\u3001\u6570\u5b57\u548c\u4e0b\u5212\u7ebf</code>\u5f53\u505a\u4e00\u4e2a\u5355\u8bcd\uff0c\u5206\u5272\u5355\u8bcd\u4e00\u822c\u7528\u7a7a\u683c/\u9017\u53f7/\u53e5\u53f7\u3002</p> <p>MySQL \u4e2d\u7684 InnoDB \u5b58\u50a8\u5f15\u64ce\u4e2d\u5bf9\u4e8e\u8868\u7d22\u5f15\u7684\u7ba1\u7406\u662f\u91c7\u7528 B+\u6811\u7ed3\u6784\u7684\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u7d22\u5f15\u5b57\u6bb5\u7684\u524d\u7f00\u8fdb\u884c\u67e5\u627e\u3002</p> <pre><code>-- \u4e0b\u8ff0sql\u8bed\u53e5\u53ef\u4ee5\u5728blog\u4e2d\u67e5\u627e\u5185\u5bb9\u4ee5xxx\u5f00\u5934\u7684\u6587\u7ae0\uff0c\u5e76\u4e14\u53ea\u8981content\u6dfb\u52a0\u4e86B+\u6811\u7d22\u5f15\uff0c\u90a3\u4e48\u5c31\u53ef\u4ee5\u5229\u7528\u7d22\u5f15\u5feb\u901f\u7684\u8fdb\u884c\u67e5\u8be2\u3002\nSELECT * FROM blog WHERE content like \"xxx%\";\n</code></pre> <p>\u95ee\u9898\uff1a</p> <p>\u4f46\u662f\u5728\u5b9e\u9645\u7684\u7528\u6237\u67e5\u8be2\u64cd\u4f5c\u4e2d\uff0c\u4e0a\u8ff0\u67e5\u8be2\u5e76\u4e0d\u7b26\u5408\u7528\u6237\u7684\u8981\u6c42\u3002\u56e0\u4e3a\u5728\u5927\u591a\u6570\u7684\u60c5\u51b5\u4e0b\uff0c\u7528\u6237\u9700\u8981\u67e5\u8be2\u7684\u662f\u5305\u542b xxx \u7684\u6587\u7ae0\uff0c\u800c\u4e0d\u662f\u4ee5 xxx \u5f00\u5934\u7684\u6587\u7ae0\u3002</p> <pre><code>-- \u5b9e\u9645\u4e0a\uff0c\u8fd9\u79cd\u67e5\u8be2\u5e76\u4e0d\u662fB+\u6811\u7d22\u5f15\u6240\u80fd\u5f88\u597d\u7684\u5b8c\u6210\u7684\u5de5\u4f5c\u3002\nSELECT * FROM blog WHERE content like \"%xxx%\";\n</code></pre> <p>\u5168\u6587\u68c0\u7d22\u7684\u4e00\u822c\u5b9e\u73b0\u2014\u2014\u2014\u2014\u5012\u6392\u7d22\u5f15</p> <p>\u4ec0\u4e48\u662f\u5168\u6587\u67e5\u8be2\u7684\u201c\u5206\u8bcd\u673a\u5236\u201d\uff1f</p> <p>\u5206\u8bcd\u673a\u5236\uff0c\u4e5f\u5e38\u79f0\u4e3a\u201c\u5206\u8bcd\u201d\u6216\u201c\u8bcd\u6761\u5316\u201d\uff08Tokenization\uff09\uff0c\u662f\u5c06\u4e00\u6bb5\u8fde\u7eed\u7684\u6587\u672c\u5207\u5206\u6210\u82e5\u5e72\u72ec\u7acb\u7684\u8bcd\u6c47\u6216\u8bcd\u6761\u7684\u8fc7\u7a0b\u3002\u5728\u5f88\u591a\u6587\u672c\u5904\u7406\u548c\u4fe1\u606f\u68c0\u7d22\u7684\u4efb\u52a1\u4e2d\uff0c\u5206\u8bcd\u662f\u9996\u8981\u4e14\u5173\u952e\u7684\u6b65\u9aa4\u3002</p> <p>\u5206\u8bcd\u673a\u5236\u7684\u91cd\u8981\u6027\u4e3b\u8981\u4f53\u73b0\u5728\u4ee5\u4e0b\u51e0\u4e2a\u65b9\u9762\uff1a</p> <ul> <li>\u4fe1\u606f\u68c0\u7d22\uff1a\u641c\u7d22\u5f15\u64ce\u5728\u7d22\u5f15\u548c\u67e5\u8be2\u65f6\uff0c\u9700\u8981\u5bf9\u6587\u672c\u5185\u5bb9\u8fdb\u884c\u5206\u8bcd\uff0c\u4ee5\u4fbf\u5feb\u901f\u5b9a\u4f4d\u548c\u68c0\u7d22\u76f8\u5173\u5185\u5bb9\u3002</li> <li>\u6587\u672c\u5206\u6790\uff1a\u5728\u81ea\u7136\u8bed\u8a00\u5904\u7406\u4e2d\uff0c\u5f88\u591a\u4efb\u52a1\uff08\u5982\u8bcd\u6027\u6807\u6ce8\u3001\u547d\u540d\u5b9e\u4f53\u8bc6\u522b\u7b49\uff09\u5728\u8fdb\u884c\u524d\uff0c\u9700\u8981\u5bf9\u6587\u672c\u8fdb\u884c\u5206\u8bcd\u5904\u7406\u3002</li> <li>\u6570\u636e\u538b\u7f29\uff1a\u5728\u67d0\u4e9b\u60c5\u51b5\u4e0b\uff0c\u901a\u8fc7\u5206\u8bcd\u53ef\u4ee5\u66f4\u6709\u6548\u5730\u538b\u7f29\u6587\u672c\u6570\u636e\u3002</li> </ul> <p>\u5206\u8bcd\u7684\u96be\u5ea6\u548c\u5177\u4f53\u65b9\u6cd5\u53d6\u51b3\u4e8e\u6240\u5904\u7406\u7684\u8bed\u8a00\u7279\u6027\uff1a</p> <ul> <li> <p>\u82f1\u6587\u5206\u8bcd\uff1a\u82f1\u6587\u7b49\u4f7f\u7528\u7a7a\u683c\u4f5c\u4e3a\u5355\u8bcd\u5206\u9694\u7b26\u7684\u8bed\u8a00\uff0c\u5206\u8bcd\u76f8\u5bf9\u7b80\u5355\u3002\u901a\u5e38\u53ef\u4ee5\u4f7f\u7528\u7a7a\u683c\u548c\u4e00\u4e9b\u6807\u70b9\u7b26\u53f7\u6765\u5206\u5272\u6587\u672c\u3002</p> </li> <li> <p>\u4e2d\u6587\u5206\u8bcd\uff1a\u4e2d\u6587\u548c\u5176\u4ed6\u4e0d\u4f7f\u7528\u7a7a\u683c\u5206\u9694\u7684\u8bed\u8a00\uff0c\u5206\u8bcd\u5c31\u53d8\u5f97\u6bd4\u8f83\u590d\u6742\u3002\u4e2d\u6587\u5206\u8bcd\u901a\u5e38\u9700\u8981\u501f\u52a9\u7279\u5b9a\u7684\u7b97\u6cd5\u548c\u5927\u91cf\u7684\u8bcd\u5e93\u8d44\u6e90\uff0c\u5982\u57fa\u4e8e\u7edf\u8ba1\u7684\u5206\u8bcd\u65b9\u6cd5\u3001\u57fa\u4e8e\u89c4\u5219\u7684\u5206\u8bcd\u65b9\u6cd5\u7b49\u3002</p> </li> </ul> <p>\u5728 MySQL \u7684 FULLTEXT \u7d22\u5f15\u4e2d\uff0c\u5206\u8bcd\u673a\u5236\u7684\u5de5\u4f5c\u662f\u7531\u7279\u5b9a\u7684\u5206\u8bcd\u7cfb\u7edf\u5b8c\u6210\u7684\u3002\u8fd9\u4e2a\u5206\u8bcd\u7cfb\u7edf\u4f1a\u6839\u636e\u4e0d\u540c\u7684\u8bed\u8a00\u548c\u5b57\u7b26\u96c6\u6765\u5904\u7406\u548c\u7d22\u5f15\u6587\u672c\u3002\u4f8b\u5982\uff0c\u82f1\u6587\u6587\u672c\u901a\u5e38\u4f1a\u6839\u636e\u7a7a\u683c\u3001\u6807\u70b9\u548c\u5176\u4ed6\u7279\u6b8a\u5b57\u7b26\u8fdb\u884c\u5206\u8bcd\uff0c\u800c\u5bf9\u4e8e\u5176\u4ed6\u8bed\u8a00\uff0c\u5982\u4e2d\u6587\u6216\u65e5\u6587\uff0c\u5219\u53ef\u80fd\u9700\u8981\u7279\u5b9a\u7684\u63d2\u4ef6\u6216\u5de5\u5177\u6765\u5b9e\u73b0\u5206\u8bcd\u3002</p> <p>\u5168\u6587\u7d22\u5f15\u7684\u7406\u5ff5\u548c\u666e\u901a B \u6811\u7d22\u5f15\u7684\u7406\u5ff5\u521a\u597d\u76f8\u53cd\uff0cB \u6811\u7d22\u5f15\u7684\u6784\u5efa\u662f\u57fa\u4e8e\u67d0\u4e2a\u5b57\u6bb5\u503c\u7684\u5168\u90e8\u6216\u8005\u4e00\u90e8\u5206\uff1b</p> <p>\u5168\u6587\u7d22\u5f15\u662f\u628a\u67d0\u4e2a\u5b57\u6bb5\u503c\u7684\u5168\u90e8\u6570\u636e\u6309\u7167\u4e00\u5b9a\u7684\u5206\u9694\u7b26\uff08\u505c\u6b62\u8bcd\uff09\u4e0e\u5b57\u7b26\u957f\u5ea6\uff08\u4e5f\u53eb\u5206\u8bcd\u957f\u5ea6\uff09\u4e00\u8d77\u7ec4\u6210\u5404\u79cd\u6392\u5217\uff0c\u8fdb\u800c\u5728\u7d22\u5f15\u4e2d\u8bb0\u5f55\u8fd9\u4e9b\u5b57\u7b26\u51fa\u73b0\u7684\u4f4d\u7f6e\uff0c\u6b21\u6570\u7b49\u9759\u6001\u4fe1\u606f\u3002</p> <p>\u5168\u6587\u7d22\u5f15\uff08\u4e5f\u53eb\u5012\u6392\u7d22\u5f15\uff09\u6709\u70b9\u7c7b\u4f3c\u4e8e HASH \u7d22\u5f15\u7684\u5b58\u50a8\uff0c\u53ea\u4e0d\u8fc7 KEY \u4e3a\u5355\u8bcd\uff0cVALUE \u4e3a\u5173\u952e\u8bcd\u6240\u5c5e\u7684\u6587\u6863 ID \u4e0e\u5bf9\u5e94\u4f4d\u7f6e\u4fe1\u606f\u3002</p> <p>\u6bd4\u5982 \"YTT\" \u4e00\u8bcd\u51fa\u73b0\u5728 4 \u4e2a\u6587\u6863\u91cc\u7684\u67d0\u4e2a\u4f4d\u7f6e\uff0c\u4e5f\u5c31\u662f 4 \u884c\u8bb0\u5f55\u91cc\u67d0\u4e2a\u4f4d\u7f6e\uff0c<code>FTS_DOC_ID</code> \u6307\u7684\u662f\u6587\u6863\u7684 ID\uff0c\u6bcf\u6761\u8bb0\u5f55\u5bf9\u5e94\u4e00\u4e2a ID\uff0c\u7c7b\u4f3c\u4e8e\u8868\u7684\u4e3b\u952e\u3002</p> <pre><code>CREATE SCHEMA test_fulltext;\nCREATE TABLE test_fulltext.opening_lines (\n    id INT UNSIGNED AUTO_INCREMENT NOT NULL PRIMARY KEY,\n    opening_line TEXT(500),\n    author VARCHAR(200),\n    title VARCHAR(200),\n    FULLTEXT idx (opening_line)\n) ENGINE=InnoDB;\n\n-- \u5bf9\u8868\u5efa\u7acb\u5168\u6587\u7d22\u5f15\u540e\uff0cMySQL \u7528\u4e00\u4e9b\u8f85\u52a9\u8868\u6765\u4fdd\u5b58\u5168\u6587\u7d22\u5f15\u5b57\u6bb5\u7684\u76f8\u5173\u6570\u636e\u6307\u5411\u3002\u5982\u679c\u8868 opening_lines \u4e0d\u5c5e\u4e8e\u5171\u4eab\u8868\u7a7a\u95f4\uff0c\u90a3\u5bf9\u5e94\u78c1\u76d8\u76ee\u5f55\u4e0a\u4e5f\u80fd\u770b\u5230\u8fd9\u4e9b\u8868\u3002\nSELECT table_id, name, space FROM INFORMATION_SCHEMA.INNODB_TABLES  WHERE name LIKE 'test_fulltext/%';\n11171   test_fulltext/opening_lines                                 10114\n11172   test_fulltext/fts_0000000000002ba3_being_deleted            10115\n11173   test_fulltext/fts_0000000000002ba3_being_deleted_cache      10116\n11174   test_fulltext/fts_0000000000002ba3_config                   10117\n11175   test_fulltext/fts_0000000000002ba3_deleted                  10118\n11176   test_fulltext/fts_0000000000002ba3_deleted_cache            10119\n11177   test_fulltext/fts_0000000000002ba3_000000000000a964_index_1 10120\n11178   test_fulltext/fts_0000000000002ba3_000000000000a964_index_2 10121\n11179   test_fulltext/fts_0000000000002ba3_000000000000a964_index_3 10122\n11180   test_fulltext/fts_0000000000002ba3_000000000000a964_index_4 10123\n11181   test_fulltext/fts_0000000000002ba3_000000000000a964_index_5 10124\n11182   test_fulltext/fts_0000000000002ba3_000000000000a964_index_6 10125\n</code></pre> <p>\u5176\u4e2d\uff0c\u4ee5 _index_1-6 \u4e3a\u540e\u7f00\u7684\u88ab\u79f0\u4e3a\u8f85\u52a9\u8868<code>Auxiliary Table</code>\uff0c\u4e5f\u4f1a\u88ab\u6301\u4e45\u5316\u9053\u78c1\u76d8\u4e2d\u3002\u91cc\u9762\u987a\u5e8f\u5b58\u653e\u5012\u6392\u7d22\u5f15\u7684\u771f\u5b9e\u6570\u636e\u3002</p> <p>\u81f3\u4e8e\u5206\u4e86\u516d\u5f20\u8868\u7684\u539f\u56e0\uff0c\u53ef\u4ee5\u7406\u89e3\u4e3a\u5bf9\u5b57\u6bb5\u6dfb\u52a0\u5168\u6587\u7d22\u5f15\u5e76\u4e14\u5bf9\u6570\u636e\u5206\u8bcd\u7684\u5e76\u884c\u5316\u3002\u53c2\u8003\u53c2\u6570<code>innodb_ft_sort_pll_degree</code>\uff0c\u53ef\u4ee5\u63a7\u5236\u5e76\u53d1\u6570\u91cf\u3002</p> <p>\u4f8b\u5982\uff0c\u8868\u540d <code>test/fts_0000000000002ba3_000000000000a964_index_1</code> \uff0c\u5176\u4e2d test \u4ee3\u8868\u6570\u636e\u5e93\u540d\uff0cfts_ \u5f00\u5934\u548c _index_n \u7ed3\u5c3e\u8868\u793a\u8f85\u52a9\u8868\u3002</p> <p>0000000000002ba3 \u4ee3\u8868\u5bf9\u5e94\u7684\u8868 ID \u7684\u5341\u516d\u8fdb\u5236\u503c\uff0c000000000000a964 \u4ee3\u8868\u52a0 <code>fulltext\u7d22\u5f15ID</code> \u5bf9\u5e94\u7684\u5341\u516d\u8fdb\u5236\u503c\u3002</p> SQL <pre><code>SELECT\n    b.name as table_name,\n    a.table_id,\n    HEX(a.table_id),\n    a.name as index_name\n    a.index_id,\n    HEX(a.index_id),\nFROM\n    information_schema.innodb_indexes a,\n    information_schema.innodb_tables b\nWHERE\n    a.table_id = b.table_id\n        AND b.name = 'test_fulltext/opening_lines'\n        AND a.name = 'idx';\n\n--Innodb \u5b58\u50a8\u5f15\u64ce\u5141\u8bb8\u7528\u6237\u67e5\u770b\u6307\u5b9a\u5012\u6392\u7d22\u5f15\u7684Auxiliary Table\u4e2d\u5206\u8bcd\u7684\u4fe1\u606f\uff0c\u53ef\u4ee5\u901a\u8fc7\u8bbe\u7f6e\u53c2\u6570 innodb_ft_aux_table \u6765\u89c2\u5bdf\u5012\u6392\u7d22\u5f15\u7684 Auxiliary Table\u3002\n\nSET GLOBAL innodb_ft_aux_table=\"test_fulltext/opening_lines\";\n\n--\u67e5\u770b\u5206\u8bcd\u60c5\u51b5\nSELECT * FROM INFORMATION_SCHEMA.INNODB_FT_INDEX_TABLE ORDER BY doc_id, position;\n</code></pre> <p>\u5269\u4e0b\u7684\u4e0d\u5305\u542b\u5168\u6587\u7d22\u5f15\u5b57\u6bb5 ID \u7684\u8868\u4e3a\u901a\u7528\u8f85\u52a9\u8868\uff0c\u8bb0\u5f55\u7d22\u5f15\u8868\u7684\u914d\u7f6e\u4fe1\u606f\u3001\u4ee5\u53ca\u6709\u5173\u7d22\u5f15\u5220\u9664\u7684\u4fe1\u606f\u3002</p> <p>\u5e26\u6709<code>delete</code>\u7684\u8fd9\u56db\u5f20\u8868\u5b58\u5728\u7684\u610f\u4e49\u5728\u4e8e\u53ef\u4ee5\u907f\u514d\u5728\u5168\u6587\u7d22\u5f15\u5b57\u6bb5\u9891\u7e41\u7684\u5199\u5165\u64cd\u4f5c\u5bfc\u81f4\u5bf9\u5e94\u7684\u516d\u5f20\u78c1\u76d8\u7d22\u5f15\u8868\u6210\u4e3a\u70ed\u70b9\u3002\u7531\u6b64\u5e26\u6765\u7684\u95ee\u9898\u662f\u5220\u9664\u7684\u8bb0\u5f55\u88ab\u4fdd\u5b58\u591a\u4efd\uff0c\u6ca1\u6709\u53ca\u65f6\u7684\u5220\u9664\uff0c\u5360\u7528\u989d\u5916\u7684\u78c1\u76d8\u7a7a\u95f4\u3002\u4e0d\u8fc7\u53ef\u4ee5\u7528 MySQL \u8bed\u53e5 <code>optimize table</code> \u6765\u624b\u52a8\u63d0\u524d\u91ca\u653e\u8fd9\u4e9b\u7a7a\u95f4\uff0c\u8fd9\u4e2a\u8bed\u53e5\u9ed8\u8ba4\u53ea\u5bf9 B+ \u6811\u805a\u7c07\u7d22\u5f15\u8fdb\u884c\u6574\u7406\uff0c\u4e0d\u4f1a\u5bf9\u5168\u6587\u7d22\u5f15\u505a\u6574\u7406\u3002\u8fd9\u91cc MySQL \u63d0\u4f9b\u4e86\u4e00\u4e2a\u53c2\u6570 <code>innodb_optimize_fulltext_only</code>\uff0c\u9ed8\u8ba4\u5173\u95ed\uff0c\u6253\u5f00\u8fd9\u4e2a\u53c2\u6570\u540e\uff0c\u8bed\u53e5 optimize table \u53ea\u4f1a\u5bf9\u5168\u6587\u7d22\u5f15\u6574\u7406\u78c1\u76d8\u7a7a\u95f4\u3002</p> <p>\u5168\u6587\u7d22\u5f15\u6709\u4e00\u4e2a\u7f13\u51b2\u6c60\uff1ainformation_schema.innodb_ft_index_cache\u3002\u7528\u6765\u7f13\u5b58\u5168\u6587\u7d22\u5f15\u5b57\u6bb5\u7684\u5199\u5165\u64cd\u4f5c\uff08insert/update\uff09\uff0c\u6807\u8bb0\u5206\u8bcd\u4ee5\u53ca\u5176\u4ed6\u76f8\u5173\u4fe1\u606f\uff0c\u548c MySQL \u5176\u4ed6\u7684\u7f13\u5b58\u4e00\u6837\uff0c\u76ee\u7684\u662f\u628a\u591a\u6b21\u9891\u7e41\u5237\u76d8\u53d8\u4e3a\u6309\u7167\u5b9a\u4e49\u7684\u7f13\u51b2\u6c60\u5927\u5c0f\u5199\u6ee1\u540e\u5408\u5e76\u4e00\u6b21\u6027\u5237\u76d8\uff08\u5237\u65b0\u5230\u4e4b\u524d\u7684\u516d\u5f20\u8f85\u52a9\u8868\uff09\u3002</p> <p>\u5237\u76d8\u540e\u8868 information_schema.innodb_ft_index_cache \u88ab\u6e05\u7a7a\uff0c\u4e0b\u6b21\u6839\u636e\u5168\u6587\u7d22\u5f15\u5b57\u6bb5\u6765\u8fc7\u6ee4\u65f6\uff0c\u76f4\u63a5\u67e5\u8be2\u5bf9\u5e94\u7684\u78c1\u76d8\u7d22\u5f15\u8868\uff1b\u5982\u679c\u6b64\u65f6\u5bf9\u5168\u6587\u7d22\u5f15\u5b57\u6bb5\u503c\u6709\u66f4\u65b0\u4f46\u662f\u8fd8\u6ca1\u6709\u89e6\u53d1\u5237\u76d8\uff0cMySQL \u4f1a\u628a\u7f13\u51b2\u6c60\u7684\u6570\u636e\u548c\u78c1\u76d8\u7d22\u5f15\u8868\u7684\u6570\u636e\u4e00\u8d77\u8fd4\u56de\u7ed9\u5ba2\u6237\u7aef\u3002</p> <p>\u5176\u4e2d\u63a7\u5236\u5355\u8868\u7f13\u51b2\u6c60\u5927\u5c0f\u7684\u53d8\u91cf\u4e3a\uff1a<code>innodb_ft_cache_size</code>\uff0c\u9ed8\u8ba4 8MB\uff0c\u6700\u5c0f 1.6MB\uff0c\u6700\u5927 80MB\u3002</p> <p>\u63a7\u5236\u6574\u4e2a MySQL \u5b9e\u4f8b\u7f13\u51b2\u6c60\u5927\u5c0f\u7684\u53d8\u91cf\u4e3a\uff1a<code>innodb_ft_total_cache_size</code>\uff0c\u9ed8\u8ba4 640M\uff0c\u6700\u5c0f 32MB\uff0c\u6700\u5927 1.6GB\u3002</p> <p>DOC_ID \u662f\u5173\u952e\u8bcd\u6620\u5c04\u7684\u7d22\u5f15\u8868\u8bb0\u5f55 ID\uff0c\u6bcf\u6761\u8bb0\u5f55\u88ab\u5f53\u4f5c\u4e00\u4e2a\u6587\u6863\uff0c \u6620\u5c04\u4e3a MySQL \u5168\u6587\u7d22\u5f15\u8868\u7684\u4e00\u4e2a\u5b57\u6bb5 <code>FTS_DOC_ID</code>\u3002</p> <p>\u5982\u679c\u5168\u6587\u7d22\u5f15\u8868\u6ca1\u6709\u663e\u5f0f\u6307\u5b9a\u8fd9\u4e2a\u5b57\u6bb5\uff0cMySQL \u9ed8\u8ba4\u5efa\u7acb\u4e00\u4e2a\u9690\u85cf\u5b57\u6bb5\u3002\u4e3a\u4e86\u907f\u514d\u540e\u671f\u52a0\u5217\u7684\u5f00\u9500\uff0c\u8fd9\u4e2a\u5b57\u6bb5\u4e0d\u4f1a\u968f\u7740\u5168\u6587\u7d22\u5f15\u7684\u9500\u6bc1\u800c\u5220\u9664\u3002\u4e5f\u5c31\u662f\u8bf4\u8fd9\u4e2a\u5b57\u6bb5\u4f1a\u4e00\u76f4\u5b58\u5728\uff0c\u9664\u975e\u8fd9\u5f20\u8868\u88ab\u5220\u6389\u3002</p> <pre><code>mysql&gt;\nmysql&gt; SHOW EXTENDED COLUMNS FROM test_fulltext.opening_lines;\n+--------------+--------------+------+-----+---------+----------------+\n| Field        | Type         | Null | Key | Default | Extra          |\n+--------------+--------------+------+-----+---------+----------------+\n| id           | int unsigned | NO   | PRI | NULL    | auto_increment |\n| opening_line | text         | YES  | MUL | NULL    |                |\n| author       | varchar(200) | YES  |     | NULL    |                |\n| title        | varchar(200) | YES  |     | NULL    |                |\n| FTS_DOC_ID   |              | NO   |     | NULL    |                |\n| DB_TRX_ID    |              | NO   |     | NULL    |                |\n| DB_ROLL_PTR  |              | NO   |     | NULL    |                |\n+--------------+--------------+------+-----+---------+----------------+\n7 rows in set (0.00 sec)\n\nmysql&gt;\n\n\n-- \u5982\u679c\u60f3\u663e\u5f0f\u81ea\u5b9a\u4e49\u8fd9\u4e2a\u5b57\u6bb5\uff0c\u5e76\u4e14\u624b\u52a8\u7ef4\u62a4\u503c\u7684\u552f\u4e00\u6027\uff0c\u5728\u5efa\u8868\u7684\u65f6\u5019\uff0c\u6216\u8005\u662f\u5728\u5168\u6587\u7d22\u5f15\u6ca1\u6709\u5efa\u7acb\u4e4b\u524d\uff0c\u53ef\u4ee5\u6307\u5b9a\u4e00\u4e2a\u540d\u5b57\u4e3a FTS_DOC_ID \u5b57\u6bb5\uff0c\u7c7b\u578b\u4e3a\u65e0\u7b26\u53f7 INT64\uff08\u6ce8\u610f\uff0c\u8fd9\u4e2a\u5b57\u6bb5\u5fc5\u987b\u4e3a\u5927\u5199\uff09\n</code></pre> <pre><code>-- ----------------------------\n-- Table structure for t_article\n-- ----------------------------\nCREATE TABLE `t_article`  (\n  `id` int(11) NOT NULL AUTO_INCREMENT,\n  `title` varchar(255) CHARACTER SET utf8 COLLATE utf8_general_ci NULL DEFAULT NULL,\n  `content` text CHARACTER SET utf8 COLLATE utf8_general_ci NULL,\n  PRIMARY KEY (`id`) USING BTREE,\n  FULLTEXT INDEX `fulltext_title_content`(`title`, `content`) WITH PARSER `ngram`\n) ENGINE = InnoDB AUTO_INCREMENT = 15 CHARACTER SET = utf8 COLLATE = utf8_general_ci ROW_FORMAT = Dynamic;\n\n-- ----------------------------\n-- Records of t_article\n-- ----------------------------\nINSERT INTO `t_article` VALUES (1, '\u516b\u8363\u516b\u803b 1', '\u4ee5\u70ed\u7231\u7956\u56fd\u4e3a\u8363\u3001\u4ee5\u5371\u5bb3\u7956\u56fd\u4e3a\u803b');\nINSERT INTO `t_article` VALUES (2, '\u516b\u8363\u516b\u803b 2', '\u4ee5\u670d\u52a1\u4eba\u6c11\u4e3a\u8363\u3001\u4ee5\u80cc\u79bb\u4eba\u6c11\u4e3a\u803b');\nINSERT INTO `t_article` VALUES (3, '\u516b\u8363\u516b\u803b 3', '\u4ee5\u5d07\u5c1a\u79d1\u5b66\u4e3a\u8363\uff0c\u4ee5\u611a\u6627\u65e0\u77e5\u4e3a\u803b');\nINSERT INTO `t_article` VALUES (4, '\u516b\u8363\u516b\u803b 4', '\u4ee5\u8f9b\u52e4\u52b3\u52a8\u4e3a\u8363\uff0c\u4ee5\u597d\u9038\u6076\u52b3\u4e3a\u803b');\nINSERT INTO `t_article` VALUES (5, '\u516b\u8363\u516b\u803b 5', '\u4ee5\u56e2\u7ed3\u4e92\u52a9\u4e3a\u8363\uff0c\u4ee5\u635f\u4eba\u5229\u5df1\u4e3a\u803b');\nINSERT INTO `t_article` VALUES (6, '\u516b\u8363\u516b\u803b 6', '\u4ee5\u8bda\u5b9e\u5b88\u4fe1\u4e3a\u8363\uff0c\u4ee5\u89c1\u5229\u5fd8\u4e49\u4e3a\u803b');\nINSERT INTO `t_article` VALUES (7, '\u516b\u8363\u516b\u803b 7', '\u4ee5\u9075\u7eaa\u5b88\u6cd5\u4e3a\u8363\uff0c\u4ee5\u8fdd\u6cd5\u4e71\u7eaa\u4e3a\u803b');\nINSERT INTO `t_article` VALUES (8, '\u516b\u8363\u516b\u803b 8', '\u4ee5\u8270\u82e6\u594b\u6597\u4e3a\u8363\uff0c\u4ee5\u9a84\u5962\u6deb\u9038\u4e3a\u803b');\nINSERT INTO `t_article` VALUES (9, '\u6ee1\u6c5f\u7ea2', '\u9756\u5eb7\u803b\uff0c\u5c24\u672a\u96ea');\nINSERT INTO `t_article` VALUES (10, '\u7b2c\u4e00\u751f\u4ea7\u529b', '\u79d1\u5b66\u6280\u672f\u662f\u7b2c\u4e00 \u751f\u4ea7\u529b');\nINSERT INTO `t_article` VALUES (11, '\u56e2\u7ed3\u4e92\u52a9', '\u56e2\u7ed3\u5c31\u662f\u529b\u91cf');\nINSERT INTO `t_article` VALUES (12, 'Blue Red', 'Red Black');\nINSERT INTO `t_article` VALUES (13, '\u6211\u662f\u5947\u8ff9 1', '\u4f60\u597d\uff0c\u6211\u662f\u5947\u8ff92');\nINSERT INTO `t_article` VALUES (14, '\u606d\u559c\u53d1\u8d22', '\u4f60\u597d');\n\n-- \u6dfb\u52a0\u5168\u6587\u7d22\u5f15\n\n-- \u53ef\u4ee5\u591a\u5b57\u6bb5\u8054\u5408\u7d22\u5f15\nALTER TABLE `t_article` ADD FULLTEXT INDEX fulltext_title_content(`title`,`content`) WITH PARSER ngram;\n\n-- \u53ef\u4ee5\u5355\u5b57\u6bb5\u7d22\u5f15\nALTER TABLE `t_article` add FULLTEXT INDEX fulltext_content(`content`) WITH PARSER ngram;\n\n\n--------------------------------------------------------------------------------------------------------\n-- \u81ea\u7136\u8bed\u8a00\u68c0\u7d22IN NATURAL LANGUAGE MODE\n-- \u81ea\u7136\u8bed\u8a00\u6a21\u5f0f\u662f MySQL \u9ed8\u8ba4\u7684\u5168\u6587\u68c0\u7d22\u6a21\u5f0f\u3002\u81ea\u7136\u8bed\u8a00\u6a21\u5f0f\u4e0d\u80fd\u4f7f\u7528\u64cd\u4f5c\u7b26\uff0c\u4e0d\u80fd\u6307\u5b9a\u5173\u952e\u8bcd\u5fc5\u987b\u51fa\u73b0\u6216\u8005\u5fc5\u987b\u4e0d\u80fd\u51fa\u73b0\u7b49\u590d\u6742\u67e5\u8be2\u3002\n\n-- \u67e5\u8be2 title \u6216\u8005 content \u4e2d\u5305\u542b\"\u7956\u56fd\"\u7684\u8bb0\u5f55\nSELECT *, MATCH (title, content) AGAINST ('\u7956\u56fd')  AS score\n    FROM t_article WHERE MATCH (title, content) AGAINST ('\u7956\u56fd' IN NATURAL LANGUAGE MODE);\n\n\n-- \u67e5\u8be2 title \u6216\u8005 content \u4e2d\u5305\u542b\"\u56e2\u7ed3\u52b3\u52a8\"\u7684\u8bb0\u5f55\n-- \u67e5\u8be2\u7ed3\u679c\uff0c\u9ed8\u8ba4\u4f1a\u6309\u7167\u5f97\u5206 score \uff0c\u4ece\u9ad8\u5230\u4f4e\u6392\u5e8f\nSELECT *, MATCH (title, content) AGAINST ('\u56e2\u7ed3\u52b3\u52a8') AS score\n    FROM t_article WHERE MATCH (title, content) AGAINST ('\u56e2\u7ed3\u52b3\u52a8' IN NATURAL LANGUAGE MODE);\n\n\n-- \u67e5\u8be2 title \u6216\u8005 content \u4e2d\u5305\u542b\"\u56e2\"\u7684\u8bb0\u5f55\nSELECT *, MATCH (title, content) AGAINST ('\u56e2') AS score\n    FROM t_article WHERE MATCH (title, content) AGAINST ('\u56e2' IN NATURAL LANGUAGE MODE);\n-- \u67e5\u4e0d\u5230\u7ed3\u679c\u3002\u539f\u56e0\u662f\u8bbe\u7f6e\u7684\u5168\u5c40\u53d8\u91cf ngram_token_size \u7684\u503c\u4e3a 2\n--------------------------------------------------------------------------------------------------------\n\n\n\n--------------------------------------------------------------------------------------------------------\n-- \u5e03\u5c14\u68c0\u7d22\uff08IN BOOLEAN MODE\uff09\u5254\u9664\u4e00\u534a\u5339\u914d\u884c\u4ee5\u4e0a\u90fd\u6709\u7684\u8bcd\n\n-- \u6bcf\u884c\u90fd\u6709this\u8fd9\u4e2a\u8bcd\u7684\u8bdd\uff0c\u90a3\u7528this\u53bb\u67e5\u65f6\uff0c\u4f1a\u627e\u4e0d\u5230\u4efb\u4f55\u7ed3\u679c\uff0c\u8fd9\u5728\u8bb0\u5f55\u6761\u6570\u7279\u522b\u591a\u65f6\u5f88\u6709\u7528\uff0c\u539f\u56e0\u662f\u6570\u636e\u5e93\u8ba4\u4e3a\u628a\u6240\u6709\u884c\u90fd\u627e\u51fa\u6765\u662f\u6ca1\u6709\u610f\u4e49\u7684\uff0c\u8fd9\u65f6\uff0cthis\u51e0\u4e4e\u88ab\u5f53\u4f5c\u662fstopword(\u4e2d\u65ad\u8bcd)\uff1b\n\n\n\n\n-- \u67e5\u8be2 content \u4e2d\u5305\u542b\"\u8bda\u5b9e\u5b88\u4fe1\"\u548c\"\u89c1\u5229\u5fd8\u4e49\"\u7684\u8bed\u53e5\nSELECT  * , MATCH (content) AGAINST ('+\u8bda\u5b9e\u5b88\u4fe1 +\u89c1\u5229\u5fd8\u4e49') as score\n    FROM  t_article where MATCH (content) AGAINST ('+\u8bda\u5b9e\u5b88\u4fe1 +\u89c1\u5229\u5fd8\u4e49' IN BOOLEAN MODE);\n</code></pre> <p>\u5e03\u5c14\u68c0\u7d22</p> <p>IN BOOLEAN MODE \u7684\u7279\u8272:</p> <ul> <li>\u4e0d\u5254\u9664 50%\u4ee5\u4e0a\u7b26\u5408\u7684 row\u3002</li> <li>\u4e0d\u81ea\u52a8\u4ee5\u76f8\u5173\u6027\u53cd\u5411\u6392\u5e8f\u3002</li> <li>\u53ef\u4ee5\u5bf9\u6ca1\u6709 FULLTEXT index \u7684\u5b57\u6bb5\u8fdb\u884c\u641c\u5bfb\uff0c\u4f46\u4f1a\u975e\u5e38\u6162\u3002</li> <li>\u9650\u5236\u6700\u957f\u4e0e\u6700\u77ed\u7684\u5b57\u7b26\u4e32\u3002</li> <li>\u5957\u7528 Stopwords\u3002</li> </ul> <p>\u641c\u7d22\u8bed\u6cd5\u89c4\u5219\uff1a</p> <ul> <li> <ul> <li>\u4e00\u5b9a\u8981\u6709(\u4e0d\u542b\u6709\u8be5\u5173\u952e\u8bcd\u7684\u6570\u636e\u6761\u5747\u88ab\u5ffd\u7565)\u3002</li> </ul> </li> <li> <ul> <li>\u4e0d\u53ef\u4ee5\u6709(\u6392\u9664\u6307\u5b9a\u5173\u952e\u8bcd\uff0c\u542b\u6709\u8be5\u5173\u952e\u8bcd\u7684\u5747\u88ab\u5ffd\u7565)\u3002</li> </ul> </li> <li> <p>\u63d0\u9ad8\u8be5\u6761\u5339\u914d\u6570\u636e\u7684\u6743\u91cd\u503c\u3002</p> </li> <li>&lt; \u964d\u4f4e\u8be5\u6761\u5339\u914d\u6570\u636e\u7684\u6743\u91cd\u503c\u3002</li> <li>~ \u5c06\u5176\u76f8\u5173\u6027\u7531\u6b63\u8f6c\u8d1f\uff0c\u8868\u793a\u62e5\u6709\u8be5\u5b57\u4f1a\u964d\u4f4e\u76f8\u5173\u6027(\u4f46\u4e0d\u50cf-\u5c06\u4e4b\u6392\u9664)\uff0c\u53ea\u662f\u6392\u5728\u8f83\u540e\u9762\u6743\u91cd\u503c\u964d\u4f4e\u3002</li> <li> <ul> <li>\u4e07\u7528\u5b57\uff0c\u4e0d\u50cf\u5176\u4ed6\u8bed\u6cd5\u653e\u5728\u524d\u9762\uff0c\u8fd9\u4e2a\u8981\u63a5\u5728\u5b57\u7b26\u4e32\u540e\u9762\u3002</li> </ul> </li> <li>\" \" \u7528\u53cc\u5f15\u53f7\u5c06\u4e00\u6bb5\u53e5\u5b50\u5305\u8d77\u6765\u8868\u793a\u8981\u5b8c\u5168\u76f8\u7b26\uff0c\u4e0d\u53ef\u62c6\u5b57\u3002</li> </ul> <p>\u5728\u5168\u6587\u7d22\u5f15\u5e95\u5c42\u662f\u6709\u4e00\u4e2a\u5207\u8bcd\u7684\u6982\u5ff5\u7684\uff0c\u6bd4\u5982 \"\u795d\u4e2d\u56fd\u8d8a\u6765\u8d8a\u5f3a\u5927\" \u8fd9\u6837\u7684\u8bcd\uff0c\u5168\u6587\u7d22\u5f15\u6309\u7167\u4e00\u4e2a\u89c4\u5219\u5207\u8bcd\uff0c\u6709\u53ef\u80fd\u4f1a\u88ab\u5207\u6210 \u795d \u3001 \u4e2d\u56fd\u3001 \u8d8a\u6765\u8d8a\u5f3a\u5927\u3002</p> <p>\u90a3\u4e48\u5207\u8bcd\u7684\u4f9d\u636e\u662f\u4ec0\u4e48\u5462\uff1f\u5168\u6587\u7d22\u5f15\u53c8\u662f\u600e\u4e48\u5207\u8bcd\u7684\u5462\uff1f\uff1f</p> <p>MySQL \u4e2d\u4f7f\u7528\u5168\u5c40\u53d8\u91cf <code>ngram_token_size</code> \u6765\u914d\u7f6e ngram \u4e2d n \u7684\u5927\u5c0f\uff0c\u5b83\u7684\u53d6\u503c\u8303\u56f4\u662f 1 \u5230 10\uff0c\u9ed8\u8ba4\u503c\u662f 2\u3002</p> <p>\u901a\u5e38<code>ngram_token_size</code>\u8bbe\u7f6e\u4e3a\u8981\u67e5\u8be2\u7684\u5355\u8bcd\u7684\u6700\u5c0f\u5b57\u6570\u3002\u5982\u679c\u9700\u8981\u641c\u7d22\u5355\u5b57\uff0c\u5c31\u8981\u8bbe\u7f6e\u4e3a 1\u3002\u5728\u9ed8\u8ba4\u503c\u662f 2 \u7684\u60c5\u51b5\u4e0b\uff0c\u641c\u7d22\u5355\u5b57\u662f\u5f97\u4e0d\u5230\u4efb\u4f55\u7ed3\u679c\u7684\u3002</p> <p>\u56e0\u4e3a\u4e2d\u6587\u5355\u8bcd\u6700\u5c11\u662f\u4e24\u4e2a\u6c49\u5b57\uff0c\u63a8\u8350\u4f7f\u7528\u9ed8\u8ba4\u503c 2\u3002</p>"},{"location":"foundmental/2.MySQL%E7%B4%A2%E5%BC%95/#_10","title":"\u964d\u5e8f\u7d22\u5f15","text":"<p>MySQL8.0 \u5f00\u59cb\u771f\u6b63\u652f\u6301\u964d\u5e8f\u7d22\u5f15\uff0c\u53ea\u6709<code>InnoDB</code>\u5f15\u64ce\u652f\u6301\u964d\u5e8f\u7d22\u5f15\uff0c\u4e14\u5fc5\u987b\u662f<code>BTREE</code>\u964d\u5e8f\u7d22\u5f15\uff0c<code>MySQL8.0</code>\u4e0d\u518d\u5bf9 group by \u64cd\u4f5c\u8fdb\u884c\u9690\u5f0f\u6392\u5e8f\u3002</p> <p>MySQL \u652f\u6301\u964d\u5e8f\u7d22\u5f15\uff1a\u7d22\u5f15\u5b9a\u4e49\u4e2d\u7684<code>DESC</code>\u4e0d\u518d\u88ab\u5ffd\u7565\uff0c\u800c\u662f\u6309\u964d\u5e8f\u5b58\u50a8\u952e\u503c\u3002\u4ee5\u524d\uff0c\u53ef\u4ee5\u4ee5\u76f8\u53cd\u7684\u987a\u5e8f\u626b\u63cf\u7d22\u5f15\uff0c\u4f46\u662f\u4f1a\u5bfc\u81f4\u6027\u80fd\u635f\u5931\u3002</p> <p>\u5f53\u53ea\u6709\u7d22\u5f15\u53ea\u5305\u542b\u4e00\u4e2a\u5b57\u6bb5\u65f6\uff0c\u65e0\u8bba\u662f\u4f7f\u7528\u964d\u5e8f\u7d22\u5f15\u8fd8\u662f\u5347\u5e8f\u7d22\u5f15\uff0c\u6574\u4e2a\u67e5\u8be2\u8fc7\u7a0b\u7684\u6027\u80fd\u662f\u4e00\u6837\u7684\u3002</p> <pre><code>-- \u540c\u4e00\u4e2a\u5efa\u8868\u8bed\u53e5\ncreate table slowtech.t1(c1 int,c2 int,index idx_c1_c2(c1,c2 desc));\n\n-- MySQL5.7\nmysql&gt; show create table slowtech.t1\\G\n*************************** 1. row ***************************\n      Table: t1\nCreate Table: CREATE TABLE `t1` (\n  `c1` int(11) DEFAULT NULL,\n  `c2` int(11) DEFAULT NULL,\n  KEY `idx_c1_c2` (`c1`,`c2`)  -- \u867d\u7136c2\u5217\u6307\u5b9a\u4e86desc\uff0c\u4f46\u5728\u5b9e\u9645\u7684\u5efa\u8868\u8bed\u53e5\u4e2d\u8fd8\u662f\u5c06\u5176\u5ffd\u7565\u4e86\n) ENGINE=InnoDB DEFAULT CHARSET=latin1\n1 row in set (0.00 sec)\n\n\n-- \u5728t1\u8868\u4e2d\uff0c\u9488\u5bf9b,c,d\u4e09\u4e2a\u5b57\u6bb5\u521b\u5efa\u4e00\u4e2a\u8054\u5408\u7d22\u5f15\u3002\u5176\u5b9e\u7b49\u4ef7\u4e8e\u4e0b\u9762\u7684\u8bed\u53e5\ncreate index idx_t1_bcd on t1(b,c,d);\n\ncreate index idx_t1_bcd on t1(b asc,c asc,d asc);\n\n-- asc\u8868\u793a\u7684\u662f\u5347\u5e8f\uff0c\u4f7f\u7528\u8fd9\u79cd\u8bed\u6cd5\u521b\u5efa\u51fa\u6765\u7684\u7d22\u5f15\u53eb\u505a\u5347\u5e8f\u7d22\u5f15\u3002\u4e5f\u5c31\u662f\u6211\u4eec\u5e73\u65f6\u5728\u521b\u5efa\u7d22\u5f15\u7684\u65f6\u5019\uff0c\u521b\u5efa\u7684\u90fd\u662f\u5347\u5e8f\u7d22\u5f15\u3002\n\n\n-- MySQL8.0\nmysql&gt; show create table slowtech.t1\\G\n*************************** 1. row ***************************\n      Table: t1\nCreate Table: CREATE TABLE `t1` (\n  `c1` int(11) DEFAULT NULL,\n  `c2` int(11) DEFAULT NULL,\n  KEY `idx_c1_c2` (`c1`,`c2` DESC) --\u4fdd\u7559\u4e86desc\u5b50\u53e5\n) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci\n1 row in set (0.00 sec)\n</code></pre>"},{"location":"foundmental/2.MySQL%E7%B4%A2%E5%BC%95/#_11","title":"\u964d\u5e8f\u7d22\u5f15\u7684\u610f\u4e49","text":"<p>\u5f53\u4e00\u4e2a\u67e5\u8be2 SQL\uff0c\u9700\u8981\u6309\u591a\u4e2a\u5b57\u6bb5\uff0c\u4ee5\u4e0d\u540c\u7684\u987a\u5e8f\u8fdb\u884c\u6392\u5e8f\u65f6\uff0c8.0 \u4e4b\u524d\u65e0\u6cd5\u4f7f\u7528\u7d22\u5f15\u5df2\u6392\u5e8f\u7684\u7279\u6027\uff0c\u56e0\u4e3a <code>order by</code> \u7684\u987a\u5e8f\u4e0e\u7d22\u5f15\u7684\u987a\u5e8f\u4e0d\u4e00\u81f4\uff0c\u800c\u4f7f\u7528\u964d\u5e8f\u7d22\u5f15\uff0c\u5c31\u80fd\u591f\u6307\u5b9a\u8054\u5408\u7d22\u5f15\u4e2d\u6bcf\u4e00\u4e2a\u5b57\u6bb5\u7684\u987a\u5e8f\uff0c\u4ee5\u9002\u5e94 <code>SQL</code> \u8bed\u53e5\u4e2d\u7684 <code>order by</code> \u987a\u5e8f\uff0c\u8ba9 <code>SQL</code> \u80fd\u591f\u5145\u5206\u4f7f\u7528\u7d22\u5f15\u5df2\u6392\u5e8f\u7684\u7279\u6027\uff0c\u63d0\u5347 SQL \u6027\u80fd</p> <p>\u5bf9\u4e8e\u666e\u901a\u7684\u5347\u5e8f\u7d22\u5f15\uff0c\u4ece\u6839\u8282\u70b9\u5230\u53f6\u5b50\u8282\u70b9\u662f\u5347\u5e8f\u6392\u5217\u7684\uff0c\u6240\u6709\u7d22\u5f15\u8282\u70b9\u4ece\u5de6\u5230\u53f3\u4e5f\u662f\u5347\u5e8f\u6392\u5217\u7684\uff0c\u4f46\u662f\u5982\u679c\u8981\u5f97\u5230\u5347\u5e8f\u7d22\u5f15\u6392\u5728\u540e\u9762\u7684\u6570\u636e(\u4f8b\u5982\u4e3b\u952e id \u5b57\u6bb5\uff0c\u9ed8\u8ba4\u5347\u5e8f\uff0c<code>select * from test where id &lt; 1000 order by id desc</code>)\uff0c\u5c31\u9700\u8981\u5bf9\u8fd9\u4e2a\u7d22\u5f15\u9006\u5411\u67e5\u627e\uff0c\u5c31\u4f7f\u7528\u4e86<code>backward index scan</code>\uff0c\u8fd9\u5c31\u662f\u57fa\u4e8e\u53cc\u5411\u94fe\u8868\u7684\u673a\u5236\u3002</p> <p>\u5982\u679c\u4e00\u4e2a\u67e5\u8be2\uff0c\u9700\u8981\u5bf9\u591a\u4e2a\u5217\u8fdb\u884c\u6392\u5e8f\uff0c\u4e14\u987a\u5e8f\u8981\u6c42\u4e0d\u4e00\u81f4\u3002\u5728\u8fd9\u79cd\u573a\u666f\u4e0b\uff0c\u8981\u60f3\u907f\u514d\u6570\u636e\u5e93\u989d\u5916\u7684\u6392\u5e8f-\"filesort\"\uff0c\u53ea\u80fd\u4f7f\u7528\u964d\u5e8f\u7d22\u5f15\u3002</p> <p>\u6bd4\u5982\uff0c\u5148\u6309 c1 \u5347\u5e8f\uff0c\u7136\u540e\u6309\u7167 c2 \u964d\u5e8f</p> <p>\u8fd8\u662f\u4e0a\u9762\u8fd9\u5f20\u8868\uff0c\u6765\u770b\u770b\u6709\u964d\u5e8f\u7d22\u5f15\u548c\u6ca1\u964d\u5e8f\u7d22\u5f15\u533a\u522b\u3002</p> <pre><code>-- mysql5.7\nmysql&gt; explain select * from slowtech.t1 order by c1,c2 desc;\n+----+-------------+-------+------------+-------+---------------+-----------+---------+------+------+----------+-----------------------------+\n| id | select_type | table | partitions | type  | possible_keys | key      | key_len | ref  | rows | filtered | Extra                      |\n+----+-------------+-------+------------+-------+---------------+-----------+---------+------+------+----------+-----------------------------+\n|  1 | SIMPLE      | t1    | NULL      | index | NULL          | idx_c1_c2 | 10      | NULL |    1 |  100.00 | Using index; Using filesort |\n+----+-------------+-------+------------+-------+---------------+-----------+---------+------+------+----------+-----------------------------+\n1 row in set, 1 warning (0.00 sec)\n</code></pre>"},{"location":"foundmental/2.MySQL%E7%B4%A2%E5%BC%95/#mysql-group-by","title":"MySQL group by \u9690\u5f0f\u6392\u5e8f","text":"<p>\u5728 MySQL5.7 \u4e2d\uff0c<code>GROUP BY</code> \u5b50\u53e5\u4f1a\u9690\u5f0f\u6392\u5e8f\uff1a</p> <p>\u9ed8\u8ba4\u60c5\u51b5\u4e0b <code>GROUP BY</code> \u4f1a\u9690\u5f0f\u6392\u5e8f\uff08\u5373 <code>GROUP BY id</code> \u540e\u9762\u6ca1\u6709 <code>ASC/DESC</code> \u5173\u952e\u5b57\uff0c\u4f46\u662f\u8fd4\u56de\u7684\u6570\u636e <code>GROUP BY id</code> \u8fd9\u4e2a id \u81ea\u5df1\u4f1a\u6392\u5e8f \uff09\u3002</p> <ul> <li> <p>\u4e0d\u63a8\u8350 <code>GROUP BY</code> \u9690\u5f0f\u6392\u5e8f <code>group by id</code> \u6216 <code>GROUP BY</code> \u663e\u5f0f\u6392\u5e8f <code>group by id desc</code>\uff0c\u540e\u8005\u4e0d\u7b26\u5408<code>SQL</code>\u8bed\u6cd5\u3002</p> </li> <li> <p>\u8981\u751f\u6210\u7ed9\u5b9a\u7684\u6392\u5e8f\uff0c\u8bf7\u63d0\u4f9b\u6807\u51c6 SQL \u4e2d\u7684<code>ORDER BY</code>\u5b50\u53e5\u3002<code>GROUP BY id ORDER BY id</code></p> </li> </ul> <pre><code> CREATE TABLE t (id INTEGER,  cnt INTEGER);\n\nINSERT INTO t VALUES (4,1),(3,2),(1,4),(2,2),(1,1),(1,5),(2,6),(2,1),(1,3),(3,4),(4,5),(3,6);\n\n-- \u5728MySQL5.7\u4e2d\uff0c\u4e0b\u9762\u8fd9\u4e09\u6761SQL\u770b\u8d77\u6765\u6267\u884c\u7684\u6548\u679c\u662f\u4e00\u6837\u7684\n\n-- \u63a8\u8350\uff0c5.7\u548c8.0\u6548\u679c\u4e00\u81f4\nselect id, SUM(cnt) from t group by id order by id;\n-- \u4e0d\u63a8\u8350  --8.0\u4e2d\u4e0d\u4f1a\u6392\u5e8f\uff0c\u7ed3\u679c\u4e0d\u4fdd\u8bc1\u6709\u5e8f\nselect id, SUM(cnt) from t group by id ;\n-- \u4e0d\u63a8\u8350  --8.0\u4e2d\u76f4\u63a5\u62a5\u9519\nselect id, SUM(cnt) from t group by id  asc;\n\n+------+----------+\n| id   | SUM(cnt) |\n+------+----------+\n|    1 |       13 |\n|    2 |        9 |\n|    3 |       12 |\n|    4 |        6 |\n+------+----------+\n4 rows in set (0.00 sec)\n\n-- \u4ece MySQL8.0 \u5f00\u59cb\uff0c\u4e0d\u652f\u6301 GROUP BY\u9690\u5f0f\u6392\u5e8f \u548c GROUP BY\u663e\u5f0f\u6392\u5e8f\nhttps://dev.mysql.com/blog-archive/removal-of-implicit-and-explicit-sorting-for-group-by/\n</code></pre> <p> \u8981\u5bf9\u4e00\u7ec4\u6570\u636e\u8fdb\u884c\u5206\u7ec4\uff0cMySQL \u4f18\u5316\u5668\u4f1a\u9009\u62e9\u4e0d\u540c\u7684\u65b9\u6cd5\u3002\u5176\u4e2d\u4e4b\u4e00\u662f\u5206\u7ec4\u4e4b\u524d\u5bf9\u6570\u636e\u6392\u5e8f\u3002\u8fd9\u4f7f\u5f97\u8fde\u7eed\u5206\u7ec4\u53d8\u5f97\u5f88\u5bb9\u6613\u3002</p> <p>\u5982\u679c\u5df2\u7ecf\u6709\u4e00\u4e2a\u7d22\u5f15\u53ef\u7528\u4e8e\u83b7\u53d6\u6392\u5e8f\u7684\u6570\u636e\uff0c\u90a3\u4e48\u4f7f\u7528\u5b83\u7684\u6210\u672c\u4f1a\u975e\u5e38\u4f4e\u5ec9\u3002\u5982\u679c\u6ca1\u6709\u7d22\u5f15\uff0cMySQL \u4f18\u5316\u5668\u4ecd\u7136\u53ef\u4ee5\u51b3\u5b9a\u5728\u5206\u7ec4\u4e4b\u524d\u8fdb\u884c\u5916\u90e8\uff08filesort\uff09\u6392\u5e8f\u3002</p>"},{"location":"foundmental/2.MySQL%E7%B4%A2%E5%BC%95/#_12","title":"\u8868\u8fbe\u5f0f\u7d22\u5f15\u548c\u51fd\u6570\u7d22\u5f15","text":"<p>\u4e00\u4e2a\u7d22\u5f15\u5217\u5e76\u4e0d\u4e00\u5b9a\u662f\u5e95\u5c42\u8868\u7684\u4e00\u4e2a\u5217\uff0c\u4e5f\u53ef\u4ee5\u662f\u4ece\u8868\u7684\u4e00\u5217\u6216\u591a\u5217\u8ba1\u7b97\u800c\u6765\u7684\u4e00\u4e2a\u51fd\u6570\u6216\u8005\u6807\u91cf\u8868\u8fbe\u5f0f\u3002\u8fd9\u79cd\u7279\u6027\u5bf9\u4e8e\u6839\u636e\u8ba1\u7b97\u7ed3\u679c\u5feb\u901f\u83b7\u53d6\u8868\u4e2d\u5185\u5bb9\u662f\u6709\u7528\u7684\u3002</p> <p>\u7d22\u5f15\u8868\u8fbe\u5f0f\u7684\u7ef4\u62a4\u4ee3\u4ef7\u8f83\u4e3a\u6602\u8d35\uff0c\u56e0\u4e3a\u5728\u6bcf\u4e00\u4e2a\u884c\u88ab\u63d2\u5165\u6216\u66f4\u65b0\u65f6\u90fd\u5f97\u4e3a\u5b83\u91cd\u65b0\u8ba1\u7b97\u76f8\u5e94\u7684\u8868\u8fbe\u5f0f\u3002\u7d22\u5f15\u8868\u8fbe\u5f0f\u5728\u8fdb\u884c\u7d22\u5f15\u641c\u7d22\u65f6\u5374\u4e0d\u9700\u8981\u91cd\u65b0\u8ba1\u7b97\uff0c\u56e0\u4e3a\u5b83\u4eec\u7684\u7ed3\u679c\u5df2\u7ecf\u88ab\u5b58\u50a8\u5728\u7d22\u5f15\u4e2d\u4e86\u3002\u5bf9\u4e8e\u67e5\u8be2\u6761\u4ef6\u662f WHERE indexedcolumn = 'constant' \u67e5\u8be2\u7684\u901f\u5ea6\u5c06\u7b49\u540c\u4e8e\u5176\u4ed6\u7b80\u5355\u7d22\u5f15\u67e5\u8be2\u3002\u56e0\u6b64\uff0c\u8868\u8fbe\u5f0f\u7d22\u5f15\u5bf9\u4e8e\u68c0\u7d22\u901f\u5ea6\u8fdc\u6bd4\u63d2\u5165\u548c\u66f4\u65b0\u901f\u5ea6\u91cd\u8981\u7684\u60c5\u51b5\u975e\u5e38\u6709\u7528\u3002</p> <p>\u4ece MySQL 8.0.13 \u8d77\uff0c\u5f00\u59cb\u652f\u6301\u51fd\u6570\u7d22\u5f15\u529f\u80fd\uff0c\u8be5\u529f\u80fd\u53ef\u4ee5\u5f88\u597d\u7684\u5e2e\u52a9\u5f00\u53d1\u4eba\u5458\u6216\u8005 DBA \u53bb\u4f18\u5148\u751f\u4ea7\u73af\u5883\u7684 SQL \u8bed\u53e5\u3002\u901a\u5e38\uff0c\u6211\u4eec\u662f\u5e76\u5efa\u8bae\u5728 SQL \u8bed\u53e5\u7684\u67e5\u8be2\u6761\u4ef6\u4e2d\u5bf9\u5217\u8fdb\u884c\u4efb\u4f55\u7684\u51fd\u6570\u8ba1\u7b97\u7684\uff0c\u56e0\u4e3a\u8fd9\u79cd\u505a\u5f88\u6709\u53ef\u80fd\u5bfc\u81f4\u539f\u672c\u53ef\u4ee5\u4f7f\u7528\u7d22\u5f15\u7684\u67e5\u8be2\u6761\u4ef6\uff0c\u53d8\u5f97\u65e0\u6cd5\u4f7f\u7528\u7d22\u5f15\u3002</p> <pre><code>-- \u8eab\u4efd\u8bc1\u524d6\u4f4d\u67e5\u8be2\nSELECT * FROM user_info WHERE substr(id_card_no,1,6) = '330106';\n\n-- \u8be5\u8868\u7684id_card_no\u4e0a\u539f\u672c\u662f\u5b58\u5728\u7d22\u5f15\u7684\uff0c\u4f46\u662f\u4e0a\u9762\u7684\u5199\u6cd5\u5219\u4f1a\u5bfc\u81f4SQL\u65e0\u6cd5\u6b63\u5e38\u4f7f\u7528id_card_no\u5217\u4e0a\u7684\u7d22\u5f15\u3002\u4e00\u822c\u6765\u8bf4\uff0c\u6211\u4eec\u4f1a\u5efa\u8bae\u5f00\u53d1\u4eba\u5458\uff0c\u907f\u514d\u8fd9\u79cd\u5199\u6cd5\uff0c\u66f4\u591a\u7684\u662f\u5c06\u8868\u8fbe\u5f0f\u653e\u5230\u53f3\u4fa7\n\nSELECT * FROM user_info WHERE id_card_no like '330106%';\n</code></pre> <p>MySQL \u7684\u51fd\u6570\u7d22\u5f15\u662f 8.0 \u7248\u672c\u5f15\u5165\u7684\u91cd\u8981\u7279\u6027\u4e4b\u4e00\u3002\u5b83\u5141\u8bb8\u5f00\u53d1\u4eba\u5458\u5728\u67e5\u8be2\u4e2d\u4f7f\u7528\u51fd\u6570\uff0c\u5e76\u4e14\u4f9d\u65e7\u53ef\u4ee5\u6709\u6548\u5730\u52a0\u901f\u67e5\u8be2\u6027\u80fd\u3002\u5177\u4f53\u7684\uff0c\u51fd\u6570\u7d22\u5f15\u7684\u4f5c\u7528\u662f\u901a\u8fc7\u5728\u51fd\u6570\u8868\u8fbe\u5f0f\u4e0a\u521b\u5efa\u7d22\u5f15\uff0c\u5728\u5904\u7406\u5b57\u7b26\u4e32\u3001\u65e5\u671f\u3001\u6570\u503c\u7b49\u7c7b\u578b\u7684\u6570\u636e\u65f6\u7279\u522b\u6709\u7528\u3002\u4f8b\u5982\uff0c\u4ee5\u524d\u9762\u7684\u53d6\u8eab\u4efd\u8bc1\u53f7\u7801\u524d\u516d\u4f4d\u4e3a\u4f8b\u5b50\u4ecb\u7ecd\u5982\u4f55\u4f7f\u7528\u51fd\u6570\u7d22\u5f15\u3002</p> <p>\u51fd\u6570\u7d22\u5f15\u4e5f\u6709\u4e00\u4e9b\u9650\u5236\u548c\u6ce8\u610f\u4e8b\u9879\u3002\u9996\u5148\uff0c\u51fd\u6570\u7d22\u5f15\u7684\u521b\u5efa\u5fc5\u987b\u57fa\u4e8e\u5df2\u7ecf\u5b58\u5728\u7684\u51fd\u6570\uff0c\u4e14\u51fd\u6570\u5fc5\u987b\u662f\u786e\u5b9a\u6027\u7684\uff0c\u5373\u5bf9\u4e8e\u76f8\u540c\u7684\u8f93\u5165\u59cb\u7ec8\u8fd4\u56de\u76f8\u540c\u7684\u8f93\u51fa\u3002\u6b64\u5916\uff0c\u51fd\u6570\u7d22\u5f15\u7684\u9009\u62e9\u5e94\u8c28\u614e\uff0c\u56e0\u4e3a\u4e0d\u9002\u5f53\u7684\u51fd\u6570\u9009\u62e9\u53ef\u80fd\u4f1a\u5bfc\u81f4\u7d22\u5f15\u65e0\u6548\uff0c\u6216\u8005\u5728\u67e5\u8be2\u65f6\u4ea7\u751f\u6027\u80fd\u95ee\u9898\u3002</p> <p>\u5728\u5b9e\u9645\u4f7f\u7528\u4e2d\uff0c\u6211\u4eec\u5e94\u8be5\u6839\u636e\u5177\u4f53\u7684\u4e1a\u52a1\u9700\u6c42\u548c\u67e5\u8be2\u6a21\u5f0f\u6765\u51b3\u5b9a\u662f\u5426\u4f7f\u7528\u51fd\u6570\u7d22\u5f15\u3002\u5728\u67d0\u4e9b\u60c5\u51b5\u4e0b\uff0c\u521b\u5efa\u989d\u5916\u7684\u865a\u62df\u5217\u53ef\u80fd\u66f4\u9002\u5408\uff0c\u6216\u8005\u901a\u8fc7\u4f18\u5316\u67e5\u8be2\u8bed\u53e5\u6765\u907f\u514d\u4f7f\u7528\u51fd\u6570\u7d22\u5f15\u3002</p> <p>\u603b\u800c\u8a00\u4e4b\uff0cMySQL \u7684\u51fd\u6570\u7d22\u5f15\u529f\u80fd\u4e3a\u5f00\u53d1\u4eba\u5458\u63d0\u4f9b\u4e86\u66f4\u591a\u7075\u6d3b\u6027\u548c\u6548\u7387\uff0c\u53ef\u4ee5\u52a0\u901f\u590d\u6742\u67e5\u8be2\u548c\u7279\u5b9a\u6570\u636e\u64cd\u4f5c\u3002\u7136\u800c\uff0c\u5728\u4f7f\u7528\u51fd\u6570\u7d22\u5f15\u65f6\u9700\u8981\u6ce8\u610f\u9009\u62e9\u5408\u9002\u7684\u51fd\u6570\u548c\u7d22\u5f15\u7c7b\u578b\uff0c\u5e76\u6839\u636e\u5177\u4f53\u60c5\u51b5\u8fdb\u884c\u6027\u80fd\u6d4b\u8bd5\u548c\u8c03\u4f18\u3002\u638c\u63e1\u51fd\u6570\u7d22\u5f15\u7684\u539f\u7406\u548c\u6700\u4f73\u5b9e\u8df5\uff0c\u5c06\u6709\u52a9\u4e8e\u63d0\u9ad8 MySQL \u6570\u636e\u5e93\u7684\u6027\u80fd\u548c\u54cd\u5e94\u901f\u5ea6\u3002</p>"},{"location":"foundmental/2.MySQL%E7%B4%A2%E5%BC%95/#_13","title":"\u90e8\u5206\u7d22\u5f15","text":"<p>\u5728 PostgreSQL \u6570\u636e\u5e93\u4e2d\uff0c\u90e8\u5206\u7d22\u5f15\uff08partial index\uff09\u662f\u6307\u5bf9\u8868\u4e2d\u6ee1\u8db3\u7279\u5b9a\u6761\u4ef6\u7684\u6570\u636e\u884c\u8fdb\u884c\u7d22\u5f15\u3002\u7531\u4e8e\u5b83\u4e0d\u9700\u8981\u5bf9\u5168\u90e8\u6570\u636e\u8fdb\u884c\u7d22\u5f15\uff0c\u56e0\u6b64\u7d22\u5f15\u4f1a\u66f4\u5c0f\uff0c\u5728\u7279\u5b9a\u573a\u666f\u4e0b\u901a\u8fc7\u90e8\u5206\u7d22\u5f15\u67e5\u627e\u6570\u636e\u65f6\u6027\u80fd\u4f1a\u66f4\u597d\u3002\u4e2d\u6587\u559c\u6b22\u53eb\u6761\u4ef6\u7d22\u5f15\u3002</p> <p>PostgreSQL \u5728\u521b\u5efa\u7d22\u5f15\u65f6\u53ef\u4ee5\u901a\u8fc7\u4e00\u4e2a WHERE \u5b50\u53e5\u6307\u5b9a\u9700\u8981\u7d22\u5f15\u7684\u6570\u636e\u884c\uff0c\u4ece\u800c\u521b\u5efa\u4e00\u4e2a\u90e8\u5206\u7d22\u5f15\u3002</p> <pre><code>CREATE TABLE orders (\n  id INT PRIMARY KEY,\n  customer_id INT,\n  status TEXT\n);\n\nINSERT INTO orders (id, customer_id, status)\nSELECT\n  i,\n  (random()*10000)::INT,\n  CASE (random() * 100)::int\n    WHEN 0 THEN 'pending'\n    WHEN 1 THEN 'shipped'\n    ELSE 'completed'\n  END\n    FROM generate_series(1, 1000000) i;\n\n-- \u8be5\u8868\u4e2d\u603b\u5171\u6709 1000000 \u4e2a\u8ba2\u5355\uff0c\u901a\u5e38\u7edd\u5927\u90e8\u7684\u8ba2\u5355\u90fd\u5904\u4e8e\u5b8c\u6210\u72b6\u6001\u3002\u4e00\u822c\u60c5\u51b5\u4e0b\uff0c\u6211\u4eec\u53ea\u9700\u8981\u9488\u5bf9\u67d0\u4e2a\u7528\u6237\u672a\u5b8c\u6210\u7684\u8ba2\u5355\u8fdb\u884c\u67e5\u8be2\u8ddf\u8e2a\uff0c\u56e0\u6b64\u53ef\u4ee5\u521b\u5efa\u4e00\u4e2a\u57fa\u4e8e\u7528\u6237\u7f16\u53f7\u548c\u72b6\u6001\u7684\u90e8\u5206\u7d22\u5f15\uff1a\n</code></pre>"},{"location":"foundmental/2.MySQL%E7%B4%A2%E5%BC%95/#index-organized-table-iot","title":"\u7d22\u5f15\u7ec4\u7ec7\u8868(index organized table \uff0cIOT)","text":"<p>\u76ee\u524d\u7684\u6d41\u884c\u7684 MySQL \u5b58\u50a8\u5f15\u64ce\u4e2d\uff0cInnoDB \u662f\u6700\u4f18\u5148\u7684\u5f15\u64ce\u9009\u578b\uff0c\u6211\u4eec\u5728\u90e8\u7f72\u548c\u89c4\u5212\u7684\u8fc7\u7a0b\u4e2d\uff0c\u5e94\u8be5\u9996\u9009\u4e3a InnoDB \u4f5c\u4e3a\u5b58\u50a8\u5f15\u64ce\u7684\u9996\u9009\u3002\u5728<code>InnoDB</code>\u5b58\u50a8\u5f15\u64ce\u4e2d\uff0c\u56e0\u4e3a\u8868\u90fd\u662f\u6309\u7167\u4e3b\u952e\u7684\u987a\u5e8f\u8fdb\u884c\u5b58\u653e\u7684\uff0c\u6211\u4eec\u79f0\u4e4b\u4e3a \u7d22\u5f15\u7ec4\u7ec7\u8868(index organized table \uff0cIOT) \u56e0\u4e3a\u5728<code>InnoDB</code>\u4e2d\uff0c\u6570\u636e\u6587\u4ef6\u672c\u8eab\u5c31\u662f\u6839\u636e \u4e3b\u952e\u7d22\u5f15 \u6392\u5e8f\u7684 B+Tree \u7684\u6570\u636e\u7ed3\u6784\u8fdb\u884c\u5b58\u50a8\uff0c\u5176\u4e2d\u53f6\u5b50\u8282\u70b9\u5305\u542b\u4e86\u5b8c\u6574\u7684\u6570\u636e\u8bb0\u5f55\u3002</p> <p></p> <p>\u7d22\u5f15\u7ec4\u7ec7\u8868</p> <p>\u6b63\u6240\u8c13\u7d22\u5f15\u7ec4\u7ec7\u8868\uff0c\u5373\u6570\u636e\u9ed8\u8ba4\u662f\u6309\u7167\u805a\u7c07\u7d22\u5f15\u987a\u5e8f\u6784\u5efa\u4e86\u4e00\u9897 B+TREE \u6811\u3002</p> <p>\u5806\u6587\u4ef6\u662f\u6570\u636e\u5e93\u4e2d\u6700\u7b80\u5355\uff0c\u6700\u57fa\u672c\u7684\u6587\u4ef6\u7ed3\u6784\uff1a\u65b0\u6570\u636e\u63d2\u5165\u4f18\u5148\u4f7f\u7528\u6587\u4ef6\u672b\u5c3e\u7684\u7a7a\u95f2\u9875\u9762\uff0c\u6bcf\u884c\u6570\u636e\u90fd\u4f1a\u88ab\u5206\u914d\u4e00\u4e2a rowid \u4f5c\u4e3a\u884c\u7684\u552f\u4e00\u6807\u8bc6\u3002rowid \u901a\u5e38\u5305\u542b\u5176\u6240\u5728\u7684\u6587\u4ef6 ID\uff0c\u9875\u9762 ID\uff0c\u4ee5\u53ca\u9875\u9762\u5185\u7684\u884c\u5e8f\u53f7 ID\u3002 \u6570\u636e\u7684\u903b\u8f91\u6392\u5e8f\u5b8c\u5168\u4f9d\u8d56\u4e8e\u7d22\u5f15\uff08Oracle\u3001Microsoft SQL Server\u3001PostgreSQL \u65e9\u671f\u9ed8\u8ba4\u652f\u6301\u7684\u6570\u636e\u5b58\u50a8\u90fd\u662f\u5806\u8868\u7ed3\u6784\uff09\u3002\u4ece\u6587\u4ef6\u7cfb\u7edf\u6765\u770b\uff0c\u6bcf\u4e2a\u5806\u8868\u7531\u82e5\u5e72\u6587\u4ef6\u7ec4\u6210(\u8868\u5927\u5c0f\u8d85\u8fc7 RELSEG_SIZE \u4e2a\u5757\u5c31\u4f1a\u88ab\u5207\u5206\u6210\u591a\u4e2a\u6587\u4ef6)\uff0c\u6bcf\u4e2a\u6587\u4ef6\u7531\u82e5\u5e72\u5757(block)\u6784\u6210\uff0c\u6bcf\u4e2a\u5757\u5927\u5c0f\u4e3a BLOCKS\uff0c\u9ed8\u8ba4 8KB\u3002 \u5806\u8868\u7684\u7ec4\u7ec7\u7ed3\u6784\u4e2d\uff0c\u6570\u636e\u548c\u7d22\u5f15\u5206\u5f00\u5b58\u50a8\u3002\u7d22\u5f15\u662f\u6392\u5e8f\u540e\u7684\u6570\u636e\u7ed3\u6784\uff0c\u800c\u5806\u8868\u4e2d\u7684\u6570\u636e\u662f\u65e0\u5e8f\u7684\uff0c\u7d22\u5f15\u7684\u53f6\u5b50\u8282\u70b9\u5b58\u653e\u4e86\u6570\u636e\u5728\u5806\u8868\u4e2d\u7684\u5730\u5740\uff0c\u5f53\u5806\u8868\u7684\u6570\u636e\u53d1\u751f\u6539\u53d8\uff0c\u4e14\u4f4d\u7f6e\u53d1\u751f\u4e86\u53d8\u66f4\uff0c\u6240\u6709\u7d22\u5f15\u4e2d\u7684\u5730\u5740\u90fd\u8981\u66f4\u65b0\uff0c\u8fd9\u975e\u5e38\u5f71\u54cd\u6027\u80fd\uff0c\u7279\u522b\u662f\u5bf9\u4e8e OLTP \u4e1a\u52a1\u3002</p> <p>\u800c\u7d22\u5f15\u7ec4\u7ec7\u8868\uff0c\u6570\u636e\u6839\u636e\u4e3b\u952e\u6392\u5e8f\u5b58\u653e\u5728\u7d22\u5f15\u4e2d\uff0c\u4e3b\u952e\u7d22\u5f15\u4e5f\u53eb\u805a\u96c6\u7d22\u5f15\uff08Clustered Index\uff09\u3002\u5728\u7d22\u5f15\u7ec4\u7ec7\u8868\u4e2d\uff0c\u6570\u636e\u5373\u7d22\u5f15\uff0c\u7d22\u5f15\u5373\u6570\u636e\u3002MySQL InnoDB \u5b58\u50a8\u5f15\u64ce\u5c31\u662f\u8fd9\u6837\u7684\u6570\u636e\u7ec4\u7ec7\u65b9\u5f0f\uff1bOracle\u3001Microsoft SQL Server \u540e\u671f\u4e5f\u63a8\u51fa\u4e86\u652f\u6301\u7d22\u5f15\u7ec4\u7ec7\u8868\u7684\u5b58\u50a8\u65b9\u5f0f\u3002\u4f46\u662f\uff0cPostgreSQL \u6570\u636e\u5e93\u56e0\u4e3a\u53ea\u652f\u6301\u5806\u8868\u5b58\u50a8\uff0c\u4e0d\u9002\u5408 OLTP \u7684\u8bbf\u95ee\u7279\u6027\uff0c\u867d\u7136\u5b83\u540e\u671f\u5bf9\u5806\u8868\u6709\u4e00\u5b9a\u7684\u4f18\u5316\uff0c\u4f46\u672c\u8d28\u662f\u901a\u8fc7\u7a7a\u95f4\u6362\u65f6\u95f4\uff0c\u5bf9\u6d77\u91cf\u5e76\u53d1\u7684 OLTP \u4e1a\u52a1\u652f\u6301\u4f9d\u7136\u5b58\u5728\u5c40\u9650\u6027\u3002</p> <p>clustered index</p> <p>The InnoDB term for a primary key index. InnoDB table storage is organized based on the values of the primary key columns,</p> <p>to speed up queries and sorts involving the primary key columns. For best performance,</p> <p>choose the primary key columns carefully based on the most performance-critical queries. Because modifying</p> <p>the columns of the clustered index is an expensive operation, choose primary columns that are rarely or never updated.</p> <p>In the Oracle Database product, this type of table is known as an index-organized table.</p> <p>See Also index, primary key, secondary index.</p> <p>\u65e2\u7136 MySQL InnoDB \u8868\u9ed8\u8ba4\u662f\u4e3b\u952e\u7d22\u5f15\u7684 B+Tree \u5b58\u653e\u7684\u3002\u90a3\u4e48\u9ed8\u8ba4\u4e0d\u5e26\u4efb\u4f55\u6761\u4ef6\u548c\u6392\u5e8f\u7684\u5168\u8868\u626b\u63cf\u662f\u9ed8\u8ba4\u6309\u7167\u4ec0\u4e48\u987a\u5e8f\u8fd4\u56de\u7ed3\u679c\u5462\uff1f</p> <p>\u7406\u89e3 SQL \u6700\u91cd\u8981\u7684\u4e00\u70b9\u5c31\u662f\u8981\u660e\u767d\u8868\u4e0d\u4fdd\u8bc1\u662f\u6709\u5e8f\u7684\uff0c\u56e0\u4e3a\u8868\u662f\u4e3a\u4e86\u4ee3\u8868\u4e00\u4e2a\u96c6\u5408\uff08\u5982\u679c\u6709\u91cd\u590d\u9879\uff0c\u5219\u662f\u591a\u96c6\uff09\uff0c\u800c\u96c6\u5408\u662f\u65e0\u5e8f\u7684\u3002</p> <p>\u5982\u679c\u5728\u67e5\u8be2\u8868\u65f6\u4e0d\u6307\u5b9a ORDER BY \u5b50\u53e5\uff0c\u90a3\u4e48\u867d\u7136\u67e5\u8be2\u53ef\u4ee5\u8fd4\u56de\u4e00\u4e2a\u7ed3\u679c\u8868\uff0c\u4f46 MySQL Server \u53ef\u4ee5\u81ea\u7531\u5730\u6309\u4efb\u610f\u987a\u5e8f\u5bf9\u7ed3\u679c\u4e2d\u7684\u884c\u8fdb\u884c\u6392\u5e8f\u3002\uff08\u6ce8\u610f\uff0c\u8fd9\u4e2a\u4e0d\u4e00\u5b9a\u53ef\u9760\uff09</p> <p>\u4e3a\u4e86\u786e\u4fdd\u7ed3\u679c\u4e2d\u7684\u884c\u6309\u7167\u4e00\u5b9a\u7684\u987a\u5e8f\u8fdb\u884c\u6392\u5e8f\uff0c\u552f\u4e00\u7684\u65b9\u6cd5\u5c31\u662f\u663e\u793a\u5730\u6307\u5b9a\u4e00\u4e2a ORDER BY \u5b50\u53e5\u3002</p> <p>MySQL \u8bba\u575b</p> <p>B+TREE \u7d22\u5f15\u7684\u4e09\u5927\u6027\u8d28\uff1a\u6709\u5e8f\u6027\uff0c\u975e\u7a7a\u6027\uff0c\u8fde\u7eed\u6027</p> <ul> <li> <p>\u6709\u5e8f\u6027\uff1a\u5728<code>order by</code>,<code>group by</code>\u7684\u65f6\u5019\uff0c\u7531\u4e8e\u7d22\u5f15\u67e5\u627e\u7ed3\u679c\u96c6\u5929\u7136\u6709\u5e8f\uff0c\u5373\u53ef\u4ee5\u51cf\u5c11\u989d\u5916\u6392\u5e8f\uff0c\u4e5f\u5c31\u662f\u8bf4\u7d22\u5f15\u4e0d\u4ec5\u4ec5\u5728\u8868\u8fde\u63a5<code>join</code>\u548c<code>where</code>\u6761\u4ef6\u65f6\u4f7f\u7528\uff0c\u5728<code>order by</code>\u548c<code>group by</code>\u4e2d\u4e5f\u53ef\u4ee5\u7528\u5230\u3002</p> </li> <li> <p>\u8fde\u7eed\u6027\uff1a\u5728\u7d22\u5f15\u8986\u76d6\u4e14\u7d22\u5f15\u5168\u626b\u63cf\u7684\u65f6\u5019\uff0c\u8fde\u7eed\u6027\u4fdd\u8bc1\u7d22\u5f15\u8bfb\u53d6\u6bd4\u8f83\u5feb</p> </li> <li> <p>\u975e\u7a7a\u6027\uff1a\u7531\u4e8e B+TREE \u7d22\u5f15\u6761\u76ee\u4e0d\u4fdd\u5b58 null \u6761\u76ee,\u5982\u679c\u5728\u5efa\u7acb\u51fd\u6570\u7d22\u5f15\u7684\u65f6\u5019\u5229\u7528\u8fd9\u4e2a\u6027\u8d28\u53ef\u4ee5\u5927\u5927\u63d0\u9ad8\u67e5\u8be2\u6548\u7387\uff0c\u4e00\u822c\u5bf9\u4e8e\u8868\u793a\u72b6\u6001\u5b57\u6bb5\u67e5\u8be2\u6709\u5947\u6548\uff0c\u56e0\u4e3a\u5b83\u5728\u7d22\u5f15\u4e2d\u5df2\u7ecf\u6392\u9664\u4e86\u5927\u90e8\u5206\u6570\u636e</p> </li> </ul> <p></p> <p>https://blog.csdn.net/xuejianxinokok/article/details/118354964?spm=1001.2014.3001.5502</p> <p>http://mysql.taobao.org/monthly/2022/04/01/</p>"},{"location":"foundmental/2.MySQL%E7%B4%A2%E5%BC%95/#io","title":"\u7d22\u5f15\u7ec4\u7ec7\u8868\u548c\u5806\u8868\u7684 IO \u8bbf\u95ee","text":"<p>\u5bf9\u4e8e HEAP \u8868\u6765\u8bf4\uff0c\u5168\u8868\u626b\u63cf\u662f\u5728\u7269\u7406\u4e0a\u987a\u5e8f\u626b\u63cf\u6240\u6709\u7684\u6570\u636e\u9875\u9762\uff0c\u6240\u4ee5\u4e5f\u79f0\u4e4b\u4e3a\u987a\u5e8f\u626b\u63cf(sequential scan)\uff0c\u5bf9\u4e8e\u5168\u65b0\u5bfc\u5165\u7684\u6570\u636e\uff0c\u751a\u81f3\u5728\u7269\u7406\u4e0a\u8fd9\u4e9b\u9875\u9762\u90fd\u662f\u8fde\u7eed\u7684\u3002\u7136\u800c\u5982\u679c\u7ecf\u8fc7\u4e0d\u65ad\u7684\u66f4\u65b0\u3001\u5220\u9664\u64cd\u4f5c\uff0c\u5c31\u65e0\u6cd5\u518d\u4fdd\u8bc1\u9875\u9762\u7684\u8fde\u7eed\u6027\u3002</p> <p>\u5bf9\u4e8e\u7d22\u5f15\u7ec4\u7ec7\u8868\uff0c\u53f6\u5b50\u8282\u70b9\u867d\u7136\u662f\u4f9d\u6b21\u626b\u63cf\u6240\u6709\u8282\u70b9\uff0c\u4f46\u662f\u8fd9\u4e9b\u53f6\u5b50\u8282\u70b9\u5e76\u4e0d\u4fdd\u8bc1\u5728\u7269\u7406\u4e0a\u662f\u8fde\u7eed\u7684\uff0c\u4e5f\u4e0d\u4fdd\u8bc1\u662f\u6709\u5e8f\u7684\uff0c\u56e0\u6b64\u5bf9\u5e94\u7684 IO \u662f\u968f\u673a IO\u3002\u5168\u8868\u626b\u63cf\u51fa\u6765\u7684\u6570\u636e\u5bf9\u4e3b\u952e\u5929\u7136\u6709\u5e8f\uff0c\u8fd9\u5bf9\u4f18\u5316\u5668\u6765\u8bf4\u662f\u4e00\u4e2a\u975e\u5e38\u6709\u7528\u7684\u7279\u6027\uff0c\u5982\u679c\u67e5\u8be2\u7684\u7ed3\u679c\u8981\u6c42\u5bf9\u4e3b\u952e\u6709\u5e8f\uff0c\u90a3\u4e48\u8fd9\u6837\u626b\u63cf\u51fa\u6765\u7684\u7ed3\u679c\u5c31\u65e0\u9700\u518d\u505a\u989d\u5916\u7684\u6392\u5e8f\u64cd\u4f5c\uff0c\u8282\u7701\u4e86\u6392\u5e8f\u7684\u5f00\u9500\u3002</p> <p>\u5bf9\u4e8e HEAP \u8868\uff0c\u6570\u636e\u9875\u5728\u7269\u7406\u4e0a\u662f\u90bb\u8fd1\u7684\uff0c\u53ef\u4ee5\u987a\u5e8f\u8bbf\u95ee\u8fd9\u4e9b\u6570\u636e\u9875\uff0c\u5bf9\u5e94\u7684 IO \u662f\u987a\u5e8f IO\u3002\u901a\u5e38\u6765\u8bf4\uff0c\u968f\u673a IO \u7684\u4ee3\u4ef7\u8981\u6bd4\u987a\u5e8f IO \u7684\u4ee3\u4ef7\u8981\u9ad8\u5f88\u591a\u3002</p>"},{"location":"foundmental/2.MySQL%E7%B4%A2%E5%BC%95/#clustered-index","title":"\u805a\u96c6\u7d22\u5f15(clustered index)","text":"<p>innodb \u8868\u4e2d\u7684\u4e3b\u952e\uff0c\u5c31\u662f\u805a\u7c07\u7d22\u5f15\uff08\u6216\u8005\u8bf4\u805a\u96c6\u7d22\u5f15\uff09\u3002</p> <p>\u4e3b\u952e\u7d22\u5f15\u7684\u53f6\u5b50\u8282\u70b9\u5b58\u7684\u662f\u6574\u884c\u6570\u636e\u3002\u7531\u4e8e\u8868\u91cc\u7684\u6570\u636e\u884c\u53ea\u80fd\u6309\u7167\u4e00\u9897 B+\u6811\u6392\u5e8f\uff0c\u56e0\u6b64**\u4e00\u5f20\u8868\u53ea\u80fd\u6709\u4e00\u4e2a\u805a\u7c07\u7d22\u5f15\u3002**</p> <ul> <li> <p>\u5982\u679c\u5728\u5efa\u8868\u65f6\u6ca1\u6709\u4e3b\u952e\uff0cMySQL \u5185\u90e8\u4f1a\u5c1d\u8bd5\u627e\u4e00\u4e2a\u53ef\u4ee5\u505a\u4e3a\u552f\u4e00\u7d22\u5f15\uff08\u552f\u4e00\u4e0d\u91cd\u590d\u4e14\u4e0d\u53ef\u4e3a\u7a7a\u7684\u5217\uff09\u7684\u5217\u505a\u4e3a\u4e3b\u952e\uff0c\u6210\u4e3a\u6b64\u8868\u7684\u805a\u7c07\u7d22\u5f15\u3002\u5f53\u8868\u4e2d\u6709\u591a\u4e2a\u975e\u7a7a\u552f\u4e00\u7d22\u5f15\uff0cInnoDB \u9009\u62e9\u5efa\u8868\u65f6\u5b9a\u4e49\u7684\u7b2c\u4e00\u4e2a\u975e\u7a7a\u552f\u4e00\u7d22\u5f15\u4e3a\u4e3b\u952e\u3002</p> </li> <li> <p>\u5982\u679c\u4e0a\u8ff0\u6761\u4ef6\u4e0d\u6ee1\u8db3\uff0cInnoDB \u5185\u90e8\u4f1a\u9690\u5f0f\u81ea\u52a8\u521b\u5efa\u4e00\u4e2a 6 \u5b57\u8282\u5927\u5c0f\u7684\u6307\u9488</p> </li> </ul> <p>\u4e00\u822c\u5efa\u8bae\u5728\u5efa\u8868\u7684\u65f6\u5019\u663e\u5f0f\u6307\u5b9a\u4e3b\u952e\uff08\u8fd9\u6837 MySQL \u5c31\u81ea\u52a8\u6839\u636e\u8fd9\u4e2a\u4e3b\u952e\u7d22\u5f15\u53bb\u5b58\u50a8\u6570\u636e\uff09\u3002</p> <p>_rowid \u4ecb\u7ecd</p> <p>\u5728 MySQL \u4e2d\u5b58\u5728\u4e00\u4e2a\u9690\u85cf\u5217 _rowid \u6765\u6807\u8bb0\u552f\u4e00\u6807\u8bc6\u3002\u4f46\u662f\u9700\u8981\u6ce8\u610f\u7684\u662f _rowid \u5e76\u4e0d\u662f\u4e00\u4e2a\u771f\u5b9e\u5b58\u5728\u7684\u5217\uff0c\u672c\u8d28\u662f\u4e00\u4e2a\u975e\u7a7a\u552f\u4e00\u5217\u7684\u522b\u540d\u3002\u56e0\u6b64\uff0c\u5728\u67d0\u4e9b\u60c5\u51b5\u4e0b _rowid \u662f\u4e0d\u5b58\u5728\u7684\u3002\u5b83\u53ea\u5b58\u5728\u4e8e\u4ee5\u4e0b\u60c5\u51b5\uff1a</p> <p>1\u3001\u5f53\u8868\u4e2d\u5b58\u5728\u4e00\u4e2a\u6570\u5b57\u7c7b\u578b\u7684\u5355\u5217\u4e3b\u952e\u65f6\uff0c _rowid \u5176\u5b9e\u6307\u7684\u5c31\u662f\u8fd9\u4e2a\u4e3b\u952e\u5217</p> <p>2\u3001\u5f53\u8868\u4e2d\u4e0d\u5b58\u5728\u4e3b\u952e\u4f46\u5b58\u5728\u4e00\u4e2a\u6570\u5b57\u7c7b\u578b\u7684\u975e\u7a7a\u552f\u4e00\u5217\u65f6\uff0c _rowid \u5176\u5b9e\u6307\u7684\u5c31\u662f\u8fd9\u4e2a\u5bf9\u5e94\u7684\u975e\u7a7a\u552f\u4e00\u5217</p> <pre><code># \u8be6\u89c1MySQL\u6587\u6863 https://dev.mysql.com/doc/refman/8.0/en/create-index.html\n\nIf a table has a PRIMARY KEY or UNIQUE NOT NULL index that consists of a single column that has an integer type, you can use _rowid to refer to the indexed column in SELECT statements, as follows:\n\n_rowid refers to the PRIMARY KEY column if there is a PRIMARY KEY consisting of a single integer column. If there is a PRIMARY KEY but it does not consist of a single integer column, _rowid cannot be used.\n\nOtherwise, _rowid refers to the column in the first UNIQUE NOT NULL index if that index consists of a single integer column. If the first UNIQUE NOT NULL index does not consist of a single integer column, _rowid cannot be used.\n</code></pre> <pre><code>mysql&gt; create table test(a int primary key,b varchar(5));\nQuery OK, 0 rows affected (0.03 sec)\n\nmysql&gt; insert into test values(1,'a'),(2,'b'),(3,'c'),(4,'c'),(5,'d');\nQuery OK, 5 rows affected (0.00 sec)\nRecords: 5  Duplicates: 0  Warnings: 0\n\nmysql&gt; select _rowid from test;\n+--------+\n| _rowid |\n+--------+\n|      1 |\n|      2 |\n|      3 |\n|      4 |\n|      5 |\n+--------+\n5 rows in set (0.00 sec)\n</code></pre> <p>\u5728 InnoDB \u4e2d\uff0c\u805a\u7c07\u7d22\u5f15\u9ed8\u8ba4\u5c31\u662f\u4e3b\u952e\u7d22\u5f15\u3002</p> <p>\u5982\u679c\u5728\u5efa\u8868\u540e\uff0c\u5e76\u4e14\u8868\u4e2d\u5df2\u7ecf\u6709\u5927\u91cf\u6570\u636e\u65f6\uff0c\u518d\u4e3a\u8fd9\u4e2a\u8868\u521b\u5efa\u4e3b\u952e\u7d22\u5f15\u6216\u8005\u4fee\u6539\u4e3b\u952e\u7d22\u5f15\u7684\u4ee3\u4ef7\u662f\u5f88\u9ad8\u7684\u3002\u8fd9\u4e2a\u64cd\u4f5c\u5176\u5b9e\u5c31\u662f\u91cd\u5efa\u8868\u3002</p> <pre><code>-- \u91cd\u5efa\u8868\nalter table T engine=InnoDB;\n</code></pre>"},{"location":"foundmental/2.MySQL%E7%B4%A2%E5%BC%95/#_14","title":"\u7d22\u5f15\u6269\u5c55","text":"<p><code>InnoDB</code>\u7684\u4e8c\u7ea7\u7d22\u5f15\uff08Secondary Index\uff09\u4f1a\u81ea\u52a8\u8865\u9f50\u4e3b\u952e\uff0c\u5c06\u4e3b\u952e\u5217\u8ffd\u52a0\u5230\u4e8c\u7ea7\u7d22\u5f15\u5217\u540e\u9762\u3002</p> <p>InnoDB \u7684\u4e8c\u7ea7\u7d22\u5f15\uff08Secondary Index\uff09\u9664\u4e86\u5b58\u50a8\u7d22\u5f15\u5217 key \u503c\uff0c\u8fd8\u5b58\u50a8\u7740\u4e3b\u952e\u7684\u503c(\u800c\u4e0d\u662f\u6307\u5411\u4e3b\u952e\u7684\u6307\u9488)\u3002</p> <pre><code>CREATE TABLE t1 (\n  i1 INT NOT NULL DEFAULT 0,\n  i2 INT NOT NULL DEFAULT 0,\n  d DATE DEFAULT NULL,\n  PRIMARY KEY (i1, i2),\n  INDEX k_d (d)\n) ENGINE = InnoDB;\n-- \u8fd9\u4e2at1\u8868\u5305\u542b\u4e3b\u952e\u548c\u4e8c\u7ea7\u7d22\u5f15k_d\uff0c\u4e8c\u7ea7\u7d22\u5f15k_d\uff08d\uff09\u7684\u5143\u7ec4\u5728InnoDB\u5185\u90e8\u5b9e\u9645\u88ab\u6269\u5c55\u6210\uff08d,i1,i2\uff09\uff0c\u5373\u5305\u542b\u4e3b\u952e\u503c\u3002\n-- \u56e0\u6b64\u5728\u8bbe\u8ba1\u4e3b\u952e\u7684\u65f6\u5019\uff0c\u5e38\u89c1\u7684\u4e00\u6761\u8bbe\u8ba1\u539f\u5219\u662f\u8981\u6c42\u4e3b\u952e\u5b57\u6bb5\u5c3d\u91cf\u7b80\u77ed\uff0c\u4ee5\u907f\u514d\u4e8c\u7ea7\u7d22\u5f15\u8fc7\u5927(\u56e0\u4e3a\u4e8c\u7ea7\u7d22\u5f15\u4f1a\u81ea\u52a8\u8865\u9f50\u4e3b\u952e\u5b57\u6bb5)\u3002\n</code></pre> <p>\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u7d22\u5f15\u6269\u5c55\uff08use_index_extensions\uff09\u9009\u9879\u662f\u5f00\u542f\u7684\u3002\u53ef\u4ee5\u5728\u5f53\u524d\u4f1a\u8bdd\u901a\u8fc7\u4fee\u6539\u4f18\u5316\u5668\u5f00\u5173 optimizer_switch \u5f00\u542f\u3001\u5173\u95ed\u6b64\u9009\u9879\u3002</p> <pre><code>INSERT INTO t1 VALUES\n(1, 1, '1998-01-01'), (1, 2, '1999-01-01'),\n(1, 3, '2000-01-01'), (1, 4, '2001-01-01'),\n(1, 5, '2002-01-01'), (2, 1, '1998-01-01'),\n(2, 2, '1999-01-01'), (2, 3, '2000-01-01'),\n(2, 4, '2001-01-01'), (2, 5, '2002-01-01'),\n(3, 1, '1998-01-01'), (3, 2, '1999-01-01'),\n(3, 3, '2000-01-01'), (3, 4, '2001-01-01'),\n(3, 5, '2002-01-01'), (4, 1, '1998-01-01'),\n(4, 2, '1999-01-01'), (4, 3, '2000-01-01'),\n(4, 4, '2001-01-01'), (4, 5, '2002-01-01'),\n(5, 1, '1998-01-01'), (5, 2, '1999-01-01'),\n(5, 3, '2000-01-01'), (5, 4, '2001-01-01'),\n(5, 5, '2002-01-01');\n\n\nshow variables like '%optimizer_switch%';\n\nSET optimizer_switch = 'use_index_extensions=off';\n\n-- \u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u4f18\u5316\u5668\u4e0d\u4f1a\u4f7f\u7528\u4e3b\u952e\uff0c\u56e0\u4e3a\u4e3b\u952e\u7531\u5b57\u6bb5\uff08i1,i2\uff09\u7ec4\u6210\uff0c\u4f46\u662f\u8be5\u67e5\u8be2\u4e2d\u6ca1\u6709\u5f15\u7528t2\u5b57\u6bb5;\u4f18\u5316\u5668\u4f1a\u9009\u62e9\u4e8c\u7ea7\u7d22\u5f15 k_d(d) \u3002\n\n-- \u8fd9\u4e2a\u67e5\u8be2\uff0c\u5ffd\u7565\u4e86\nEXPLAIN  SELECT COUNT(*) FROM t1 WHERE i1 = 3 AND d = '2000-01-01';\n\n\nSET optimizer_switch = 'use_index_extensions=on';\n</code></pre>"},{"location":"foundmental/2.MySQL%E7%B4%A2%E5%BC%95/#_15","title":"\u5982\u4f55\u6b63\u786e\u9009\u62e9\u4e3b\u952e","text":""},{"location":"foundmental/2.MySQL%E7%B4%A2%E5%BC%95/#_16","title":"\u81ea\u589e\u4e3b\u952e","text":"<p>\u81ea\u589e\u4e3b\u952e\u662f\u6307\u81ea\u589e\u5217\u4e0a\u5b9a\u4e49\u7684\u4e3b\u952e\uff0c\u5728\u5efa\u8868\u8bed\u53e5\u4e2d\u4e00\u822c\u662f\u8fd9\u4e48\u5b9a\u4e49\u7684\uff1a</p> <pre><code>create table t1 (\n    -- \u521b\u5efa\u81ea\u589e\u5217\n    `rid` int(11)  NOT NULL  AUTO_INCREMENT,\n    -- \u4ee5\u81ea\u589e\u5217\u521b\u5efa\u4e3b\u952e\n    PRIMARY KEY (`id`),\n )\n</code></pre> <p>\u63d2\u5165\u65b0\u8bb0\u5f55\u7684\u65f6\u5019\u53ef\u4ee5\u4e0d\u6307\u5b9a ID \u7684\u503c\uff0c\u7cfb\u7edf\u4f1a\u83b7\u53d6\u5f53\u524d ID \u6700\u5927\u503c\u52a0 1 \u4f5c\u4e3a\u4e0b\u4e00\u6761\u8bb0\u5f55\u7684 ID \u503c\u3002</p> <p>\u4e5f\u5c31\u662f\u8bf4\uff0c\u81ea\u589e\u4e3b\u952e\u7684\u63d2\u5165\u6570\u636e\u6a21\u5f0f\uff0c\u6b63\u7b26\u5408\u4e86\u6211\u4eec\u524d\u9762\u63d0\u5230\u7684\u9012\u589e\u63d2\u5165\u7684\u573a\u666f\u3002</p> <p>\u6bcf\u6b21\u63d2\u5165\u4e00\u6761\u65b0\u8bb0\u5f55\uff0c\u90fd\u662f\u8ffd\u52a0\u64cd\u4f5c\uff0c\u90fd\u4e0d\u6d89\u53ca\u5230\u632a\u52a8\u5176\u4ed6\u8bb0\u5f55\uff0c\u4e5f\u4e0d\u4f1a\u89e6\u53d1\u53f6\u5b50\u8282\u70b9\u7684\u5206\u88c2\u3002</p> <p>\u800c\u7528\u4e1a\u52a1\u903b\u8f91\u7684\u5b57\u6bb5\u505a\u4e3b\u952e\uff0c\u5219\u5f80\u5f80\u4e0d\u5bb9\u6613\u4fdd\u8bc1\u6709\u5e8f\u63d2\u5165\uff0c\u8fd9\u6837\u5199\u6570\u636e\u6210\u672c\u76f8\u5bf9\u8f83\u9ad8\u3002\u4e00\u822c\u591a\u6570\u60c5\u51b5\u5efa\u8bae\u4f7f\u7528\u4e1a\u52a1\u65e0\u5173\u7684\u81ea\u589e\u5217\u4f5c\u4e3a\u4e3b\u952e\u3002</p> <p>\u5bf9\u4e8e\u4e1a\u52a1\u4e2d\u9700\u8981\u552f\u4e00\u7684\uff0c\u53ef\u4ee5\u4f7f\u7528\u552f\u4e00\u7ea6\u675f\u3002</p> <p>\u9664\u4e86\u6027\u80fd\u5916\uff0c\u8fd8\u53ef\u4ee5\u4ece\u5b58\u50a8\u7a7a\u95f4\u6765\u770b\uff0c\u5047\u8bbe\u8868\u4e2d\u786e\u5b9e\u6709\u4e00\u4e2a\u552f\u4e00\u5b57\u6bb5\u3002\u6bd4\u5982\u5b57\u7b26\u4e32\u7c7b\u578b\u7684\u8eab\u4efd\u8bc1\u53f7\uff0c\u90a3\u5e94\u8be5\u7528\u8eab\u4efd\u8bc1\u53f7\u505a\u4e3b\u952e\uff0c\u8fd8\u662f\u7528\u81ea\u589e\u5b57\u6bb5\u505a\u4e3b\u952e\u5462\uff1f</p> <p>\u4e3a\u4ec0\u4e48\u4e0d\u5efa\u8bae\u8fc7\u957f\u7684\u5b57\u6bb5\u505a\u4e3b\u952e\uff1f</p> <p>\u7531\u4e8e\u6bcf\u4e2a\u975e\u4e3b\u952e\u7d22\u5f15\u7684\u53f6\u5b50\u8282\u70b9\u4e0a\u90fd\u662f\u4e3b\u952e\u7684\u503c\u3002\u5982\u679c\u7528\u8eab\u4efd\u8bc1\u53f7\u505a\u4e3b\u952e\uff0c</p> <p>\u90a3\u4e48\u6bcf\u4e2a\u4e8c\u7ea7\u7d22\u5f15\u7684\u53f6\u5b50\u8282\u70b9\u5360\u7528\u7ea6 20 \u4e2a\u5b57\u8282\uff0c\u800c\u5982\u679c\u7528\u6574\u578b\u505a\u4e3b\u952e\uff0c\u5219\u53ea\u8981 4 \u4e2a\u5b57\u8282\uff0c\u5982\u679c\u662f\u957f\u6574\u578b\uff08bigint\uff09\u5219\u662f 8 \u4e2a\u5b57\u8282\u3002</p> <p>\u663e\u7136\uff0c\u4e3b\u952e\u957f\u5ea6\u8d8a\u5c0f\uff0c\u666e\u901a\u7d22\u5f15\u7684\u53f6\u5b50\u8282\u70b9\u5c31\u8d8a\u5c0f\uff0c\u666e\u901a\u7d22\u5f15\u5360\u7528\u7684\u7a7a\u95f4\u4e5f\u5c31\u8d8a\u5c0f\u3002</p> <p>\u6240\u4ee5\u4ece\u6027\u80fd\u548c\u5b58\u50a8\u6765\u770b\uff0c\u81ea\u589e\u4e3b\u952e\u5f80\u5f80\u662f\u66f4\u5408\u9002\u7684\u9009\u62e9\u3002</p> <p>\u4e3b\u952e\u6027\u80fd\u95ee\u9898\u4e0d\u662f\u4e00\u4e2a\u5355\u4e00\u7684\u95ee\u9898\uff0c\u9700\u8981 MySQL \u65b9\u5411\u6301\u7eed\u6539\u9020\u7684\uff0c\u5c06\u6280\u672f\u4ef7\u503c\u548c\u4e1a\u52a1\u4ef7\u503c\u7ed3\u5408\u8d77\u6765\u3002\u5f88\u591a\u4e1a\u52a1\u5f88\u591a\u4eba\u90fd\u77e5\u9053\u4e3b\u952e\u6700\u597d\u8bbe\u7f6e\u6210\u81ea\u589e\u5217\uff0c\u4f46\u662f\u5927\u591a\u6570\u60c5\u51b5\u4e0b\uff0c\u8fd9\u79cd\u81ea\u589e\u5217\u5374\u6ca1\u6709\u5b9e\u9645\u7684\u4e1a\u52a1\u542b\u4e49\uff0c\u5c3d\u7ba1\u662f\u4e3b\u952e\u5217\u4fdd\u8bc1\u4e86 ID \u7684\u552f\u4e00\u6027\uff0c\u4f46\u662f\u4e1a\u52a1\u5f00\u53d1\u65e0\u6cd5\u76f4\u63a5\u6839\u636e\u4e3b\u952e\u81ea\u589e\u5217\u6765\u8fdb\u884c\u67e5\u8be2\uff0c\u4e8e\u662f\u4ed6\u4eec\u9700\u8981\u5bfb\u627e\u65b0\u7684\u4e1a\u52a1\u5c5e\u6027\uff0c\u6dfb\u52a0\u4e00\u7cfb\u5217\u7684\u552f\u4e00\u6027\u7d22\u5f15\uff0c\u975e\u552f\u4e00\u6027\u7d22\u5f15\u7b49\u7b49\uff0c\u8fd9\u6837\u4e00\u6765\u6211\u4eec\u575a\u6301\u7684\u89c4\u8303\u548c\u4e1a\u52a1\u4f7f\u7528\u7684\u65b9\u5f0f\u5c31\u5b58\u5728\u4e86\u504f\u5dee\u3002</p> <p>\u4ece\u53e6\u5916\u4e00\u4e2a\u7ef4\u5ea6\u6765\u8bf4\uff0c\u6211\u4eec\u5bf9\u4e8e\u4e3b\u952e\u7684\u7406\u89e3\u662f\u6709\u504f\u5dee\u7684\uff0c\u6211\u4eec\u4e0d\u80fd\u5355\u4e00\u7684\u8ba4\u4e3a\u4e3b\u952e\u5c31\u4e00\u5b9a\u662f\u4ece 1 \u5f00\u59cb\u7684\u6574\u6570\u7c7b\u578b\uff0c\u6211\u4eec\u9700\u8981\u7ed3\u5408\u4e1a\u52a1\u573a\u666f\u6765\u770b\u5f85\uff0c\u6bd4\u5982\u6211\u4eec\u7684\u8eab\u4efd\u8bc1\u5176\u5b9e\u5c31\u662f\u4e00\u4e2a\u4e0d\u9519\u7684\u4f8b\u5b50\uff0c\u628a\u8bc1\u53f7\u5206\u6210\u4e86\u51e0\u4e2a\u533a\u6bb5\uff0c\u504f\u4e8e\u68c0\u7d22\u548c\u7ef4\u62a4\uff1b\u6216\u8005\u662f\u5916\u51fa\u5c31\u9910\u65f6\u5f97\u5230\u7684\u6d41\u6c34\u5355\u53f7\uff0c\u5b83\u90fd\u6709\u4e00\u5b9a\u7684\u4e1a\u52a1\u5c5e\u6027\u5728\u91cc\u9762\uff0c\u5bf9\u4e8e\u6211\u4eec\u53bb\u7406\u89e3\u4e1a\u52a1\u7684\u4f7f\u7528\u662f\u4e00\u79cd\u4e0d\u9519\u7684\u501f\u9274\u3002</p> <p>\u4e3a\u4ec0\u4e48\u662f\u81ea\u589e\u7684\u4e3b\u952e\uff1f</p> <p>\u56e0\u4e3a\u4e3b\u952e\u63d2\u5165\u540e\uff0c\u5728 B+tree \u4e2d\u5176\u5b9e\u5e94\u8be5\u8981\u6709\u6709\u5e8f\u7684\uff0c\u5982\u679c\u662f\u65e0\u5e8f\u7684\uff0c\u4f1a\u5bfc\u81f4\u4e00\u4e9b\u9875\u5206\u88c2\u7684\u60c5\u51b5\u3002</p>"},{"location":"foundmental/2.MySQL%E7%B4%A2%E5%BC%95/#secondary-index","title":"\u975e\u805a\u96c6\u7d22\u5f15(secondary index)","text":"<p>\u975e\u4e3b\u952e\u7d22\u5f15\uff0c\u5176\u5b9e\u662f\u53e6\u5916\u4e00\u9897\u5355\u72ec\u7684 B+Tree\uff0c\u53f6\u5b50\u7ed3\u70b9\u4e2d\u53ea\u5b58\u653e\u4e3b\u952e\u7d22\u5f15\u7684\u503c\u3002</p> <p>\u901a\u8fc7\u975e\u4e3b\u952e\u7d22\u5f15\u67e5\u627e\u6570\u636e\u65f6\uff0c\u5148\u53bb\u67e5\u627e\u7d22\u5f15\u6240\u5728\u7684 B+\u6811\u4e0a\u8fdb\u884c\u67e5\u627e\u3002\u7136\u540e\u518d\u6839\u636e\u7d22\u5f15\u7684\u503c\uff0c\u518d\u56de\u53bb\u4e3b\u952e\u7d22\u5f15\u7684 B+\u6811\u4e0a\u8fdb\u884c\u67e5\u627e\u3002</p> <p>\u7b2c\u4e8c\u4e2a\u8fc7\u7a0b\u88ab\u79f0\u4e3a**\u56de\u8868\u67e5\u8be2\uff0c**\u5373\u8981\u67e5\u8be2\u7684\u5217\u4e0d\u5728\u975e\u4e3b\u952e\u7d22\u5f15\u4e2d\u3002</p> <pre><code>-- \u67e5\u770b\u8868\u4e2d\u7684\u7d22\u5f15\u8be6\u60c5\nSHOW INDEX FROM table_name;\n-- \u521b\u5efa\u552f\u4e00\u7d22\u5f15\nALTER TABLE table_name ADD UNIQUE (column);\n</code></pre>"},{"location":"foundmental/2.MySQL%E7%B4%A2%E5%BC%95/#multi-range-readmrr","title":"Multi-Range Read\uff08MRR\uff09","text":"<p>\u5728 <code>secondary index</code> \u4e0a\u8fdb\u884c\u8303\u56f4\u67e5\u8be2\u6216\u7b49\u503c\u67e5\u8be2\u65f6\uff0c\u8fd4\u56de\u7684\u4e00\u7cfb\u5217\u4e3b\u952e\u7d22\u5f15\u503c\u53ef\u80fd\u662f\u65e0\u5e8f\u7684\uff0c\u540e\u7eed\u7684\u56de\u8868\u67e5\u8be2\u5c31\u53d8\u6210\u4e86\u968f\u673a\u8bfb\u3002\u5982\u679c\u56de\u8868\u524d\u628a\u4e3b\u952e\u503c\u5728\u5185\u5b58\u4e2d\u7ed9\u5b83\u6392\u4e00\u4e0b\u5e8f\uff0c\u90a3\u4e48\u5728\u56de\u8868\u7684\u65f6\u5019\u5c31\u53ef\u4ee5\u7528\u987a\u5e8f IO \u53d6\u4ee3\u539f\u672c\u7684\u968f\u673a IO\u3002</p> <p>MRR \u8981\u628a\u4e3b\u952e\u6392\u5e8f\uff0c\u8fd9\u6837\u4e4b\u540e\u5bf9\u78c1\u76d8\u7684\u64cd\u4f5c\u5c31\u662f\u7531\u987a\u5e8f\u8bfb\u4ee3\u66ff\u4e4b\u524d\u7684\u968f\u673a\u8bfb\u3002</p> <p>\u4ece\u8d44\u6e90\u7684\u4f7f\u7528\u60c5\u51b5\u4e0a\u6765\u770b\u5c31\u662f\u8ba9 CPU \u548c\u5185\u5b58\u591a\u505a\u70b9\u4e8b\uff0c\u6765\u6362\u78c1\u76d8\u7684\u987a\u5e8f\u8bfb\u3002\u7136\u800c\u6392\u5e8f\u662f\u9700\u8981\u5185\u5b58\u7684\uff0c\u8fd9\u5757\u5185\u5b58\u7684\u5927\u5c0f\u5c31\u7531\u53c2\u6570<code>read_rnd_buffer_size</code>\u6765\u63a7\u5236\u3002</p> <p>MRR \u5728\u901a\u8fc7\u4e8c\u7ea7\u7d22\u5f15\u83b7\u53d6\u5230\u4e3b\u952e ID \u540e\uff0c\u5c06 ID \u503c\u653e\u5165<code>read_rnd_buffer</code>\u4e2d\uff0c\u7136\u540e\u5bf9\u5176\u8fdb\u884c\u6392\u5e8f\uff0c\u5229\u7528\u6392\u5e8f\u540e\u7684 ID \u6570\u7ec4\u904d\u5386\u4e3b\u952e\u7d22\u5f15\u67e5\u627e\u8bb0\u5f55\u5e76\u8fd4\u56de\u7ed3\u679c\u96c6\uff0c\u4f18\u5316\u4e86\u56de\u8868\u6027\u80fd\u3002</p> <p><code>read_rnd_buffer_size</code>\u8fd9\u662f\u4e00\u4e2a\u5185\u5b58\u4e2d\u7684 buffer \u7528\u4e8e\u5206\u914d\u7ed9\u6bcf\u4e2a\u5ba2\u6237\u7aef\u7528\u7684\u3002\u9ed8\u8ba4\u503c\u662f 0.25MB\uff0c\u6700\u5927\u503c\u4e3a 2GB</p> <p>\u6240\u4ee5\u4e0d\u80fd\u8bbe\u7f6e global \u5168\u5c40\u53d8\u91cf\u592a\u5927\uff0c\u6240\u4ee5\u53ea\u80fd\u5ba2\u6237\u7aef\u81ea\u5df1\u8fd0\u884c\u5927\u67e5\u8be2\u65f6\u8fdb\u884c\u8bbe\u7f6e\u3002</p> <p>MRR \u80fd\u591f\u63d0\u5347\u6027\u80fd\u7684\u6838\u5fc3\u5728\u4e8e\uff0c\u8fd9\u6761\u67e5\u8be2\u8bed\u53e5\u5728\u7d22\u5f15 a \u4e0a\u505a\u7684\u662f\u4e00\u4e2a\u8303\u56f4\u67e5\u8be2\uff08\u4e5f\u5c31\u662f\u8bf4\uff0c\u8fd9\u662f\u4e00\u4e2a\u591a\u503c\u67e5\u8be2\uff09\uff0c\u53ef\u4ee5\u5f97\u5230\u8db3\u591f\u591a\u7684\u4e3b\u952e id\u3002\u8fd9\u6837\u901a\u8fc7\u6392\u5e8f\u4ee5\u540e\uff0c\u518d\u53bb\u4e3b\u952e\u7d22\u5f15\u67e5\u6570\u636e\uff0c\u624d\u80fd\u4f53\u73b0\u51fa\"\u987a\u5e8f\u6027\"\u7684\u4f18\u52bf\u3002</p> <p>MRR \u7684\u6838\u5fc3\u601d\u60f3\u5c31\u662f\u901a\u8fc7\u628a\u300c\u968f\u673a\u78c1\u76d8\u8bfb\u300d\uff0c\u8f6c\u5316\u4e3a\u300c\u987a\u5e8f\u78c1\u76d8\u8bfb\u300d\uff0c\u4ece\u800c\u63d0\u9ad8\u4e86\u7d22\u5f15\u67e5\u8be2\u7684\u6027\u80fd\u3002\u672c\u8d28\u4e0a\u662f\u4e00\u79cd\u7528\u300c\u7a7a\u95f4\u6362\u65f6\u95f4\u300d\u7684\u505a\u6cd5\u3002</p> <p>https://opensource.actionsky.com/20200616-mysql/</p> <p>\u5f15\u7533\u51fa\u6765\u7684\u4e00\u4e2a\u7ecf\u5178\u95ee\u9898\u3002MySQL \u4e2d\u7684 Innodb \u603b\u662f\u805a\u96c6\u7d22\u5f15\u8868\uff0c\u6216\u8005 SqlServer \u4e2d\u7684\u805a\u96c6\u8868\u3002\u975e\u805a\u96c6\u7d22\u5f15\u4e3a\u4ec0\u4e48\u8981\u62ff\u805a\u96c6\u7d22\u5f15\u952e\uff08\u800c\u975e\u7269\u7406\u5730\u5740\uff09\u4f5c\u4e3a\u5176\u884c\u6307\u9488\uff1f</p> <p>\u5bf9\u4e8e\u805a\u96c6\u8868\uff0c\u8868\u4e2d\u6570\u636e\u7684\u7269\u7406\u4f4d\u7f6e\u56e0\u4e3a\u9700\u8981\u4fdd\u8bc1\u6309\u805a\u96c6\u7d22\u5f15\u5efa\u6709\u5e8f\uff0c\u540c\u65f6\u610f\u5473\u7740\u5176\u771f\u6b63\u7684\u7269\u7406\u7684<code>rowid</code>\u53ef\u80fd\u4f1a\u53d1\u751f\u53d8\u5316\uff08\u6bd4\u5982\u805a\u96c6\u7d22\u5f15\u975e\u7ebf\u6027\u5199\u5165\u7684\u65f6\u5019\uff0c\u4f1a\u5bfc\u81f4\u53f6\u5206\u88c2\uff0c\u9875\u5206\u88c2\u4f1a\u5bfc\u81f4\u539f\u59cb\u8bb0\u5f55\u7684\u7269\u7406\u4f4d\u7f6e\u53d8\u5316\uff09\uff0c\u6b64\u65f6\u975e\u805a\u96c6\u7d22\u5f15\u7684\u884c\u6307\u9488<code>rowid</code>\u4e5f\u8981\u505a\u4fee\u6539\uff0c\u8fd9\u6837\u4f1a\u5bfc\u81f4\u805a\u96c6\u8868\u4e2d\u7684\u6570\u636e\u53d1\u751f\u7269\u7406\u4f4d\u7f6e\u53d8\u5316\u7684\u65f6\u5019\uff0c\u975e\u805a\u96c6\u7d22\u5f15\u4e5f\u8981\u505a\u76f8\u5e94\u7684\u53d8\u5316\uff0c\u5982\u679c\u975e\u805a\u96c6\u7d22\u5f15\u7528\u5bf9\u5e94\u7684\u805a\u96c6\u7d22\u5f15\u952e\u505a\u6307\u9488\u7684\u8bdd\uff0c\u5c31\u4e0d\u4f1a\u53d1\u751f\u8be5\u95ee\u9898\u3002</p> <p>postgresql \u8868\u7684\u6570\u636e\u90fd\u662f\u4ee5\u5806\u8868<code>heap</code>\u7684\u5f62\u5f0f\u5b58\u50a8\u7684\uff0c\u56e0\u6b64<code>Postgresql</code>\u4e2d\u4e0d\u5b58\u5728\u6240\u8c13\u7684\u805a\u96c6\u7d22\u5f15\uff0c\u540c\u65f6\u610f\u5473\u7740\u5176\u8bb0\u5f55\u5728\u7269\u7406\u7ed3\u6784\u4e0a\u53ef\u4ee5\u662f\u65e0\u5e8f\u5b58\u50a8\uff0c\u4e0d\u4f1a\u4ea7\u751f\u6240\u8c13\u7684\u9875\u5206\u88c2<code>page split</code>\u3002 \u90a3\u4e48<code>Postgresql</code>\u4e2d\u7684\u884c\u6307\u9488\uff0c\u8fd9\u91cc\u79f0\u4f5c<code>rowid</code>\uff0c\u6b63\u5e38\u60c5\u51b5\u662f\u4e0d\u4f1a\u56e0\u4e3a\u65b0\u6570\u636e\u7684\u5199\u5165\u5bfc\u81f4\u7c7b\u4f3c\u4e8e MySQL \u6216\u8005 sqlserver \u4e2d\u7684\u9875\u62c6\u5206\uff08page split\uff09\u3002</p> <p>\u7136\u540e\u518d\u8bf4<code>Postgresql</code>\u7684<code>bitmap scan</code>\uff0c<code>bitmap scan</code>\u7684\u4f5c\u7528\u5c31\u662f\u901a\u8fc7\u5efa\u7acb\u4f4d\u56fe\u7684\u65b9\u5f0f\uff0c\u5c06\u56de\u8868\u8fc7\u7a0b\u4e2d\u5bf9\u6807\u8bbf\u95ee\u968f\u673a\u6027 IO \u7684\u8f6c\u6362\u4e3a\u987a\u884c\u6027\u884c\u4e3a\uff0c\u4ece\u800c\u51cf\u5c11\u67e5\u8be2\u8fc7\u7a0b\u4e2d IO \u7684\u6d88\u8017\u3002</p>"},{"location":"foundmental/2.MySQL%E7%B4%A2%E5%BC%95/#_17","title":"\u7d22\u5f15\u8986\u76d6","text":"<p>\u7d22\u5f15\u8986\u76d6\uff08index covering\uff09\uff0c\u6545\u540d\u601d\u4e49\uff0c\u8981\u67e5\u8be2\u7684\u6570\u636e\u5217\u90fd\u5728\u7d22\u5f15\u6811\u4e0a\u67e5\u8be2\u5b8c\u6210\u4e86\uff0c\u4e0d\u9700\u8981\u518d\u56de\u4e3b\u952e\u7684\u8fd9\u9897\u4e8c\u53c9\u6811\u4e0a\u8fdb\u884c**\u56de\u8868\u67e5\u8be2**\u3002</p> <p>An index that provides all the necessary results for a query is called a covering index.</p> <p>\u7531\u4e8e\u8986\u76d6\u7d22\u5f15\u53ef\u4ee5\u51cf\u5c11\u6811\u7684\u641c\u7d22\u6b21\u6570\uff0c\u663e\u8457\u63d0\u5347\u67e5\u8be2\u6027\u80fd\uff0c\u6240\u4ee5\u4f7f\u7528\u8986\u76d6\u7d22\u5f15\u662f\u4e00\u4e2a\u5e38\u7528\u7684\u6027\u80fd\u4f18\u5316\u624b\u6bb5\u3002</p> <p>**\u901a\u5e38\u4f7f\u7528\u8054\u5408\u7d22\u5f15\u6765\u63d0\u5347\u67e5\u8be2\u6027\u80fd\u3002**\u6bd4\u5982\u6709\u4e00\u4e2a\u5e02\u6c11\u4fe1\u606f\u8868\uff0c\u8eab\u4efd\u8bc1\u53f7\u662f\u5e02\u6c11\u7684\u552f\u4e00\u6807\u8bc6\uff1a</p> <pre><code>CREATE TABLE `tuser` (\n  `id` int(11) NOT NULL,\n  `id_card` varchar(32) DEFAULT NULL,\n  `name` varchar(32) DEFAULT NULL,\n  `age` int(11) DEFAULT NULL,\n  `ismale` tinyint(1) DEFAULT NULL,\n  PRIMARY KEY (`id`),\n  KEY `id_card` (`id_card`),\n  KEY `name_age` (`name`,`age`)\n) ENGINE=In\n</code></pre> <p>\u5982\u679c\u8981\u6839\u636e\u5e02\u6c11\u8eab\u4efd\u8bc1\u53f7\u67e5\u8be2\u5e02\u6c11\u4fe1\u606f\u7684\u9700\u6c42\uff0c\u5728\u8eab\u4efd\u8bc1\u53f7\u5b57\u6bb5\u4e0a\u5efa\u7acb\u7d22\u5f15\u5c31\u591f\u4e86\u3002</p> <p>\u73b0\u5728\u5982\u679c\u6709\u4e00\u4e2a\u9ad8\u9891\u8bf7\u6c42\uff0c\u8981\u6839\u636e\u5e02\u6c11\u7684\u8eab\u4efd\u8bc1\u53f7\u67e5\u8be2\u4ed6\u7684\u59d3\u540d\uff0c\u5c31\u53ef\u4ee5\u5efa\u7acb</p>"},{"location":"foundmental/2.MySQL%E7%B4%A2%E5%BC%95/#_18","title":"\u8054\u5408\u7d22\u5f15","text":"<p>https://www.cnblogs.com/xuwc/p/14007766.html</p> <p>MySQL \u53ef\u4ee5\u521b\u5efa\u8054\u5408\u7d22\u5f15\uff08\u5373\u5728\u591a\u5217\u4e0a\u521b\u5efa\u4e00\u4e2a\u7d22\u5f15\uff0c\u4e00\u4e2a\u7d22\u5f15\u53ef\u4ee5\u5305\u542b\u6700\u591a 16 \u5217\u3002\uff09\uff0c\u82f1\u6587\u53eb Multiple-Column Indexes</p> <p>\u5982\u679c\u5206\u522b\u4e3a\u6bcf\u4e2a\u5217\u521b\u5efa\u7d22\u5f15\uff0c\u5219\u5373\u4f7f\u4e00\u4e2a\u6761\u4ef6\u67e5\u627e\u4e2d\u5229\u7528\u4e86\u591a\u4e2a\u7d22\u5f15\u5217\u5b57\u6bb5\u53bb\u5339\u914d\uff0c\u90a3\u4e48 SQL \u5f15\u64ce\u67e5\u627e\u4e5f\u53ea\u4f1a\u9009\u62e9\u7528\u4e00\u4e2a\u5408\u9002\u7684\u7d22\u5f15\u6761\u4ef6\u53bb\u67e5\u627e\uff0c\u7136\u540e\u901a\u8fc7\u7d22\u5f15\u5408\u5e76\u7684\u65b9\u5f0f\u67e5\u627e\u3002\u6216\u8005\u53ea\u4f1a\u9009\u62e9\u7528\u4e00\u4e2a\u7d22\u5f15\u5217\u53bb\u5339\u914d\u67e5\u627e(\u7b56\u7565\u662f\u5224\u65ad\u54ea\u4e2a\u5217\u8fc7\u6ee4\u6392\u9664\u7684\u6570\u636e\u66f4\u591a)</p> <p>\u8054\u5408\u7d22\u5f15\u7684\u597d\u5904\uff1a</p> <ul> <li> <p>\u5efa\u4e00\u4e2a\u8054\u5408\u7d22\u5f15 <code>(col1,col2,col3)</code>\uff0c\u5b9e\u9645\u76f8\u5f53\u4e8e\u5efa\u4e86 <code>(col1)</code>\uff0c<code>(col1,col2)</code>\uff0c<code>(col1,col2,col3)</code> \u4e09\u4e2a\u7d22\u5f15\u3002\u6bcf\u591a\u4e00\u4e2a\u7d22\u5f15\uff0c\u90fd\u4f1a\u589e\u52a0\u5199\u64cd\u4f5c\u7684\u5f00\u9500\u548c\u78c1\u76d8\u7a7a\u95f4\u7684\u5f00\u9500\u3002\u5bf9\u4e8e\u5927\u91cf\u6570\u636e\u7684\u8868\uff0c\u4f7f\u7528\u8054\u5408\u7d22\u5f15\u4f1a\u5927\u5927\u7684\u51cf\u5c11\u5f00\u9500\uff01</p> </li> <li> <p>\u4e00\u822c DBA \u90fd\u4f1a\u5efa\u8bae\u5c3d\u91cf\u591a\u4f7f\u7528\u8054\u5408\u7d22\u5f15\u3002</p> </li> </ul> <p>\u5bf9\u4e8e\u8054\u5408\u4e3b\u952e\u548c\u7d22\u5f15\u7ec4\u7ec7\u8868\u7684\u7406\u89e3</p> <pre><code>CREATE TABLE `geek` (\n  `a` int(11) NOT NULL,\n  `b` int(11) NOT NULL,\n  `c` int(11) NOT NULL,\n  `d` int(11) NOT NULL,\n  PRIMARY KEY (`a`,`b`),\n  KEY `c` (`c`),\n  KEY `ca` (`c`,`a`),\n  KEY `cb` (`c`,`b`)\n) ENGINE=InnoDB;\n\n\n-- \u4e3b\u952e(a\uff0cb)\u7684\u805a\u7c07\u7d22\u5f15\u7ec4\u7ec7\u987a\u5e8f\u76f8\u5f53\u4e8eorder by a,b \uff0c\u4e5f\u5c31\u662f\u5148\u6309a\u6392\u5e8f\uff0c\u518d\u6309b\u6392\u5e8f\uff0cc\u65e0\u5e8f\u3002\n\n-- \u5728(a,b)\u4e3b\u952e\u7d22\u5f15\u6392\u597d\u5e8f\u4e4b\u540e\uff0c\u518d\u6309\u7167\u7d22\u5f15c\u6765\u7ec4\u7ec7\u6570\u636e\n\n\u2013a--|\u2013b--|\u2013c--|\u2013d--\n1 2 3 d\n1 3 2 d\n1 4 3 d\n2 1 3 d\n2 2 2 d\n2 3 4 d\n</code></pre>"},{"location":"foundmental/2.MySQL%E7%B4%A2%E5%BC%95/#_19","title":"\u6700\u5de6\u524d\u7f00\u5339\u914d\u539f\u5219","text":"<p>\u6240\u8c13\u7684\u7d22\u5f15\u6709\u6548\uff0c\u662f\u6307**\u4f7f\u7528\u4e86\u7d22\u5f15\u7684\u5feb\u901f\u641c\u7d22\u529f\u80fd\uff0c\u5e76\u4e14\u6709\u6548\u7684\u51cf\u5c11\u4e86\u626b\u63cf\u884c**\uff0c\u6240\u4ee5**\u5168\u7d22\u5f15\u626b\u63cf**\uff08\u8f85\u52a9\u7d22\u5f15\u6811\uff09\u548c**\u5168\u8868\u626b\u63cf**\uff08\u4e3b\u952e\u7d22\u5f15\u6811\uff09\u90fd\u4e0d\u80fd\u79f0\u4e3a\u771f\u6b63\u7684**\u7d22\u5f15\u6709\u6548**</p> <p>\u5bf9\u4e8e\u590d\u5408\u7d22\u5f15 Index\uff08A,B\uff09\uff0cB \u6811\u7684\u6392\u5e8f\u662f\u6309 A \u5217\u7684\u6570\u503c\u4e3a\u7b2c\u4e00\u8981\u7d20\uff0cB \u5217\u7684\u6570\u503c\u4e3a\u7b2c\u4e8c\u8981\u7d20\u8fdb\u884c\u6392\u5e8f\uff0c\u8fd9\u4e5f\u5c31\u662f\u4e3a\u4ec0\u4e48\u6211\u4eec\u67e5\u8be2\u8bed\u53e5\u65f6\uff0c\u6761\u4ef6\u8bed\u53e5\u5fc5\u987b\u4fdd\u8bc1\u6700\u5de6\u539f\u5219\u624d\u53ef\u4ee5\u5229\u7528\u5230\u7d22\u5f15</p> <p>\u8c08\u5230\u8054\u5408\u7d22\u5f15\uff0c\u4e00\u5b9a\u8981\u8bb2**\u6700\u5de6\u524d\u7f00\u5339\u914d**\uff0c\u6709\u5982\u4e0b\u539f\u5219\uff1a</p> <ul> <li> <p>\u5982\u679c\u67e5\u8be2\u7684\u65f6\u5019\u67e5\u8be2\u6761\u4ef6\u53ef\u4ee5\u901a\u8fc7\u7d22\u5f15\u7cbe\u786e\u5339\u914d\u5de6\u8fb9\u8fde\u7eed\u4e00\u5217\u6216\u51e0\u5217\uff0c\u5219\u6b64\u5217\u5c31\u53ef\u4ee5\u88ab\u7528\u5230\u3002</p> </li> <li> <p>\u6ce8\u610f\uff0c\u4e00\u5b9a\u8981\u662f\u6307\u7cbe\u51c6\u5339\u914d\u3002</p> </li> </ul> <pre><code>CREATE TABLE test (\n    id INT NOT NULL,\n    last_name CHAR(30) NOT NULL,\n    first_name CHAR(30) NOT NULL,\n    age INT NULL ,\n    PRIMARY KEY (id),\n    INDEX name (last_name,first_name,age)\n);\n\n-- name \u662f\u4e00\u4e2a\u5305\u542b\u4e86 last_name,first_name,age \u4e09\u5217\u7684\u8054\u5408\u7d22\u5f15\u3002\n\n\n-- \u5bf9\u4e8e\u8fd9\u4e2a\u8868\uff0c\u4f7f\u7528 (last_name) \u548c (last_name,first_name) (last_name,first_name,age) \u8fd9\u6837\u7684\u6761\u4ef6\u8fc7\u6ee4\u624d\u53ef\u4ee5\u8d70\u7d22\u5f15\n-- \u8fd9\u91cc\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u67e5\u8be2\u7684\u65f6\u5019\u5982\u679c\u4e24\u4e2a\u6761\u4ef6\u90fd\u7528\u4e0a\u4e86\u4f46\u662f\u987a\u5e8f\u4e0d\u540c\u3002\n-- \u5982 first_name= xx and last_name \uff1dxx\uff0c\u90a3\u4e48\u73b0\u5728\u7684\u67e5\u8be2\u5f15\u64ce\u4f1a\u81ea\u52a8\u4f18\u5316\u4e3a\u5339\u914d\u8054\u5408\u7d22\u5f15\u7684\u987a\u5e8f\uff0c\u8fd9\u6837\u662f\u80fd\u591f\u547d\u4e2d\u7d22\u5f15\u7684\u3002\n-- \u7531\u4e8e\u6700\u5de6\u524d\u7f00\u539f\u5219\uff0c\u5728\u521b\u5efa\u8054\u5408\u7d22\u5f15\u65f6\uff0c\u7d22\u5f15\u5b57\u6bb5\u7684\u987a\u5e8f\u9700\u8981\u8003\u8651\u5b57\u6bb5\u503c\u53bb\u91cd\u4e4b\u540e\u7684\u4e2a\u6570\uff0c\u8f83\u591a\u7684\u653e\u524d\u9762\u3002ORDER BY\u5b50\u53e5\u4e5f\u9075\u5faa\u6b64\u89c4\u5219\u3002\n\n\nSELECT * FROM test WHERE last_name='Jones';\nSELECT * FROM test WHERE last_name='Jones' AND first_name='John';\nSELECT * FROM test WHERE last_name='Jones' AND (first_name='John' OR first_name='Jon');\nSELECT * FROM test WHERE last_name='Jones' AND first_name &gt;='M' AND first_name &lt; 'N';\nselect * FROM test where last_name like '\u5f20%' and age=10 ;\n\n-- \u4e0b\u9762\u7684\u67e5\u8be2\u65e0\u6cd5\u7528\u5230\u8fd9\u4e2a\u7d22\u5f15\nSELECT * FROM test WHERE first_name='John';\nSELECT * FROM test WHERE last_name='Jones' OR first_name='John';\n</code></pre>"},{"location":"foundmental/2.MySQL%E7%B4%A2%E5%BC%95/#_20","title":"\u524d\u7f00\u7d22\u5f15","text":"<p>\u6211\u4eec\u5728\u7ed9\u4e00\u4e2a\u5b57\u6bb5\u52a0\u7d22\u5f15\u7684\u65f6\u5019\uff0c\u5b9e\u9645\u4e0a\u4ec5\u53ef\u4ee5\u9488\u5bf9\u5b57\u6bb5\u7684\u524d n \u4f4d\u52a0\u7d22\u5f15\u3002\u4f7f\u7528 <code>col_name(N)</code> \u8fd9\u6837\u7684\u683c\u5f0f\u3002</p> <p>\u6709\u70b9\u7c7b\u4f3c\u4e8e Oracle \u4e2d\u5bf9\u5b57\u6bb5\u4f7f\u7528 Left \u51fd\u6570\u6765\u5efa\u7acb\u51fd\u6570\u7d22\u5f15\uff0c\u53ea\u4e0d\u8fc7 MySQL \u7684\u8fd9\u4e2a\u524d\u7f00\u7d22\u5f15\u5728\u67e5\u8be2\u65f6\u662f\u5185\u90e8\u81ea\u52a8\u5b8c\u6210\u5339\u914d\u7684\uff0c\u5e76\u4e0d\u9700\u8981\u4f7f\u7528 Left \u51fd\u6570\u3002</p> <p>\u4e00\u822c\u6765\u8bf4\uff0c\u5f53\u67d0\u4e2a\u5b57\u6bb5\u7684\u6570\u636e\u91cf\u592a\u5927\uff0c\u800c\u4e14\u67e5\u8be2\u53c8\u975e\u5e38\u7684\u9891\u7e41\u65f6\uff0c\u4f7f\u7528\u524d\u7f00\u7d22\u5f15\u80fd\u6709\u6548\u7684\u51cf\u5c0f\u7d22\u5f15\u6587\u4ef6\u7684\u5927\u5c0f\uff0c\u8ba9\u6bcf\u4e2a\u7d22\u5f15\u9875\u53ef\u4ee5\u4fdd\u5b58\u66f4\u591a\u7684\u7d22\u5f15\u503c\uff0c\u4ece\u800c\u63d0\u9ad8\u4e86\u7d22\u5f15\u67e5\u8be2\u7684\u901f\u5ea6\u3002</p> <p>\u6bd4\u5982\uff0c\u5ba2\u6237\u5e97\u94fa\u540d\u79f0\uff0c\u6709\u7684\u540d\u79f0\u5f88\u957f\uff0c\u6709\u7684\u5f88\u77ed\uff0c\u5982\u679c\u5b8c\u5168\u6309\u7167\u5168\u8986\u76d6\u6765\u5efa\u7d22\u5f15\uff0c\u7d22\u5f15\u7684\u5b58\u50a8\u7a7a\u95f4\u53ef\u80fd\u4f1a\u975e\u5e38\u7684\u5927\uff0c\u6709\u7684\u8868\u5982\u679c\u7d22\u5f15\u521b\u5efa\u7684\u5f88\u591a\uff0c\u751a\u81f3\u4f1a\u51fa\u73b0\u7d22\u5f15\u5b58\u50a8\u7684\u7a7a\u95f4\u90fd\u6bd4\u6570\u636e\u8868\u7684\u5b58\u50a8\u7a7a\u95f4\u5927\u5f88\u591a\uff0c\u56e0\u6b64\u5bf9\u4e8e\u8fd9\u79cd\u6587\u672c\u5f88\u957f\u7684\u5b57\u6bb5\uff0c\u6211\u4eec\u53ef\u4ee5\u622a\u53d6\u524d\u51e0\u4e2a\u5b57\u7b26\u6765\u5efa\u7d22\u5f15\uff0c\u5728\u4e00\u5b9a\u7a0b\u5ea6\u4e0a\uff0c\u65e2\u80fd\u6ee1\u8db3\u6570\u636e\u7684\u67e5\u8be2\u6548\u7387\u8981\u6c42\uff0c\u53c8\u80fd\u8282\u7701\u7d22\u5f15\u5b58\u50a8\u7a7a\u95f4\u3002</p> <p>\u5728 varchar , blob , text \u7b49\u7c7b\u578b\u7684\u5b57\u6bb5\u4e0a\u5efa\u7acb\u7d22\u5f15\u65f6\uff0c\u5fc5\u987b\u6307\u5b9a\u7d22\u5f15\u957f\u5ea6\uff0c\u6ca1\u5fc5\u8981\u5bf9\u5168\u5b57\u6bb5\u5efa\u7acb\u7d22\u5f15\uff0c\u6839\u636e\u5b9e\u9645\u6587\u672c\u533a\u5206\u5ea6\u51b3\u5b9a\u7d22\u5f15\u957f\u5ea6\u5373\u53ef\u3002</p> <p>\u7d22\u5f15\u957f\u5ea6\u548c\u533a\u5206\u5ea6\u5176\u5b9e\u662f\u76f8\u4e92\u77db\u76fe\u7684\u3002</p> <p>\u7d22\u5f15\u957f\u5ea6\u8fc7\u77ed\uff0c\u90a3\u4e48\u533a\u5206\u5ea6\u5c31\u5f88\u4f4e\uff0c\u67e5\u627e\u65f6\u626b\u63cf\u7684\u884c\u8d8a\u591a\uff0c\u628a\u7d22\u5f15\u957f\u5ea6\u52a0\u957f\uff0c\u533a\u5206\u5ea6\u5c31\u9ad8\uff0c\u4f46\u662f\u7d22\u5f15\u5360\u7528\u7a7a\u95f4\u5927\uff0c\u56e0\u6b64\u8981\u638c\u63e1\u4e00\u4e2a\u5e73\u8861\u70b9\u3002</p> <p>\u5f53\u67d0\u4e2a\u5b57\u6bb5\u5185\u5bb9\u7684\u524d\u51e0\u4f4d\u533a\u5206\u5ea6\u5f88\u9ad8\u7684\u65f6\u5019\uff0c\u8fd9\u4e2a\u65f6\u5019\u91c7\u7528\u524d\u7f00\u7d22\u5f15\uff0c\u53ef\u4ee5\u5728\u67e5\u8be2\u6027\u80fd\u548c\u7a7a\u95f4\u5b58\u50a8\u65b9\u9762\u8fbe\u5230\u4e00\u4e2a\u5f88\u9ad8\u7684\u6027\u4ef7\u6bd4\u3002</p> <p>\u7d22\u5f15\u5176\u5b9e\u90fd\u662f\u6392\u597d\u5e8f\u7684\u6570\u636e\u7ed3\u6784\uff0c\u82e5\u662f\u533a\u5206\u5ea6\u9ad8\u6392\u5e8f\u8d8a\u5feb\uff0c\u533a\u5206\u5ea6\u8d8a\u4f4e\uff0c\u6392\u5e8f\u6162\uff1b</p> <p>\u4e3e\u4e2a\u4f8b\u5b50\uff1a \uff08\u5f20\uff0c\u5f20\u4e09\uff0c\u5f20\u4e09\u54e5\uff09\uff0c\u5982\u679c\u7d22\u5f15\u957f\u5ea6\u53d6 1 \u7684\u8bdd\uff0c\u90a3\u4e48\u6bcf\u4e00\u884c\u7684\u7d22\u5f15\u90fd\u662f <code>\u5f20</code> \u8fd9\u4e2a\u5b57\uff0c\u5b8c\u5168\u6ca1\u6709\u533a\u5206\u5ea6\uff0c\u4f60\u8ba9\u5b83\u600e\u4e48\u6392\u5e8f\uff1f</p> <p>\u7ed3\u679c\u8fd9\u6837\u4e09\u884c\u5b8c\u5168\u662f\u968f\u673a\u6392\u7684\uff0c\u56e0\u4e3a\u7d22\u5f15\u90fd\u4e00\u6837\uff1b</p> <p>\u5982\u679c\u957f\u5ea6\u53d6 2\uff0c\u90a3\u4e48\u6392\u5e8f\u7684\u65f6\u5019\u81f3\u5c11\u524d\u4e24\u4e2a\u662f\u6392\u5bf9\u4e86\u7684\uff0c\u5982\u679c\u53d6 3\uff0c\u533a\u5206\u5ea6\u8fbe\u5230 100%\uff0c\u6392\u5e8f\u5b8c\u5168\u6b63\u786e\uff1b</p> <p>\u7b49\u7b49\uff0c\u90a3\u4f60\u8bf4\u662f\u4e0d\u662f\u7d22\u5f15\u8d8a\u957f\u8d8a\u597d\uff1f \u7b54\u6848\u80af\u5b9a\u662f\u9519\u7684\u3002</p> <p>\u6bd4\u5982 (\u5f20,\u674e,\u738b) \u548c \uff08\u5f20\u4e09\u5566\u5566\u5566\uff0c\u5f20\u4e09\u5475\u5475\u5475\uff0c\u5f20\u4e09\u547c\u547c\u547c\uff09\uff1b</p> <p>\u524d\u8005\u5728\u5185\u5b58\u4e2d\u6392\u5e8f\u5360\u5f97\u7a7a\u95f4\u5c11\uff0c\u6392\u5e8f\u4e5f\u5feb\uff0c\u540e\u8005\u660e\u663e\u66f4\u6162\u66f4\u5360\u5185\u5b58\uff0c\u5728\u5927\u6570\u636e\u5e94\u7528\u4e2d\u8fd9\u4e00\u70b9\u70b9\u90fd\u662f\u5f88\u6050\u6016\u7684\uff1b</p>"},{"location":"foundmental/2.MySQL%E7%B4%A2%E5%BC%95/#_21","title":"\u524d\u7f00\u7d22\u5f15\u4f18\u5316\u539f\u5219","text":"<p>\u7d22\u5f15\u957f\u5ea6\u7684\u5224\u65ad\u516c\u5f0f\uff1a</p> <p>test \u662f\u8981\u52a0\u7d22\u5f15\u7684\u5b57\u6bb5\uff0c5 \u662f\u7d22\u5f15\u957f\u5ea6\uff0c</p> <pre><code>-- \u67e5\u8be2\u8868\u4e2d\u67d0\u4e2a\u5b57\u6bb5\u6700\u957f\u7684\u8bb0\u5f55\nselect  `\u5b57\u6bb5`, length(`\u5b57\u6bb5`)  from \u8868\u540d  where  length(`\u5b57\u6bb5`) = ( select max(length(`\u5b57\u6bb5`)) from \u8868\u540d  )\n-- \u67e5\u8be2\u8868\u4e2d\u67d0\u4e2a\u5b57\u6bb5\u6700\u77ed\u7684\u8bb0\u5f55\nselect  `\u5b57\u6bb5`, length(`\u5b57\u6bb5`)  from \u8868\u540d  where  length(`\u5b57\u6bb5`) = ( select min(length(`\u5b57\u6bb5`)) from \u8868\u540d  )\n\n-- left\u51fd\u6570\u53d6test\u5b57\u6bb5\u7684\u524d5\u4f4d\uff0c\u5bf9\u524d5\u4f4d\u53bb\u91cd\uff0c\u8fd9\u4e2a\nselect count(distinct left(test,5))/count(*) from table;\n\n-- \u968f\u7740\u7d22\u5f15\u5b57\u6bb5\u957f\u5ea6\u7684\u6269\u5927\uff0c\u8fd9\u4e2a\u533a\u5206\u5ea6\u7684\u503c\u662f\u8d8a\u6765\u8d8a\u8d8b\u8fd1\u4e8e1\uff0c\u7b49\u4e8e1\u5373\u8868\u793a\n\n\n-- \u7ed9\u5b57\u6bb5\u6307\u5b9a\u524d10\u4f4d\u52a0\u7d22\u5f15\nCREATE TABLE test (blob_col BLOB, INDEX(blob_col(10)));\n</code></pre>"},{"location":"foundmental/2.MySQL%E7%B4%A2%E5%BC%95/#_22","title":"\u7d22\u5f15\u57fa\u6570","text":"<p>\u4e86\u89e3\u524d\u7f00\u7d22\u5f15\u4e4b\u540e\uff0c\u4e86\u89e3\u4e00\u4e0b\u7d22\u5f15\u57fa\u6570</p> <p>\u7d22\u5f15\u57fa\u6570\uff08cardinality\uff09\uff1a\u7d22\u5f15\u4e2d\u4e0d\u91cd\u590d\u7684\u7d22\u5f15\u503c\u7684\u6570\u91cf\uff1b</p> <p>\u4f8b\u5982\uff0c\u4f8b\u5982\uff0c\u67d0\u4e2a\u6570\u636e\u5217\u5305\u542b\u503c 1\u30013\u30017\u30014\u30017\u30013\uff0c \u90a3\u4e48\u5b83\u7684**\u7d22\u5f15\u57fa\u6570**\u5c31\u662f 4\u3002</p> <p>\u7d22\u5f15\u57fa\u6570\u76f8\u5bf9\u4e8e\u6570\u636e\u8868\u884c\u6570\u8f83\u9ad8\uff08\u4e5f\u5c31\u662f\u8bf4\uff0c\u5217\u4e2d\u5305\u542b\u5f88\u591a\u4e0d\u540c\u7684\u503c\uff0c\u91cd\u590d\u7684\u503c\u5f88\u5c11\uff0c\u503c\u5f88\u5206\u6563\uff09\u7684\u65f6\u5019\uff0c\u5b83\u7684\u5de5\u4f5c\u6548\u679c\u6700\u597d\u3002</p> <ul> <li> <p>\u5982\u679c\u67d0\u6570\u636e\u5217\u542b\u6709\u5f88\u591a\u4e0d\u540c\u7684\u5e74\u9f84\uff0c\u7d22\u5f15\u4f1a\u5f88\u5feb\u5730\u5206\u8fa8\u6570\u636e\u884c\u3002</p> </li> <li> <p>\u5982\u679c\u67d0\u4e2a\u6570\u636e\u5217\u7528\u4e8e\u8bb0\u5f55\u6027\u522b\uff08\u53ea\u6709\u201dM\u201d\u548c\u201dF\u201d\u4e24\u79cd\u503c\uff09\uff0c\u90a3\u4e48 B+TREE \u7d22\u5f15\u7684\u7528\u5904\u5c31\u4e0d\u5927\u3002</p> </li> <li> <p>\u5982\u679c\u503c\u51fa\u73b0\u7684\u51e0\u7387\u51e0\u4e4e\u76f8\u7b49\uff0c\u90a3\u4e48\u65e0\u8bba\u641c\u7d22\u54ea\u4e2a\u503c\u90fd\u53ef\u80fd\u5f97\u5230\u4e00\u534a\u7684\u6570\u636e\u884c\u3002</p> </li> </ul> <p>\u5728\u8fd9\u4e9b\u60c5\u51b5\u4e0b\uff0c\u6700\u597d\u6839\u672c\u4e0d\u8981\u4f7f\u7528 B+TREE \u7d22\u5f15\uff0c\u56e0\u4e3a\u67e5\u8be2\u4f18\u5316\u5668\u53d1\u73b0\u67d0\u4e2a\u503c\u51fa\u73b0\u5728\u8868\u7684\u6570\u636e\u884c\u4e2d\u7684\u767e\u5206\u6bd4\u5f88\u9ad8\u7684\u65f6\u5019\u3002\u5b83\u4e00\u822c\u4f1a\u5ffd\u7565\u7d22\u5f15\uff0c\u8fdb\u884c\u5168\u8868\u626b\u63cf\u3002\u60ef\u7528\u7684\u767e\u5206\u6bd4\u754c\u7ebf\u662f\u201d30%\u201d\u3002</p>"},{"location":"foundmental/2.MySQL%E7%B4%A2%E5%BC%95/#_23","title":"\u4f4d\u56fe\u7d22\u5f15","text":"<p>\u5b83\u5c06\u6bcf\u4e2a\u72ec\u7279\u7684\u503c\u6620\u5c04\u5230\u4e00\u4e2a\u4f4d\u56fe\u4e0a\uff0c\u5176\u4e2d\u6bcf\u4e00\u4f4d\u4ee3\u8868\u4e00\u884c\u6570\u636e\u662f\u5426\u5305\u542b\u8be5\u503c\u3002\u5f53\u591a\u4e2a\u4f4d\u56fe\u9700\u8981\u8fdb\u884c\u4ea4\u96c6\u3001\u5e76\u96c6\u7b49\u64cd\u4f5c\u65f6\uff0c\u53ea\u9700\u5bf9\u4f4d\u56fe\u8fdb\u884c\u903b\u8f91\u8fd0\u7b97\uff0c\u4ece\u800c\u5b9e\u73b0\u9ad8\u6548\u7684\u96c6\u5408\u8fd0\u7b97\u67e5\u8be2\u3002</p> <p><code>BitMap</code> \u7684\u57fa\u672c\u539f\u7406\u5c31\u662f\u7528\u4e00\u4e2a bit \u4f4d\u6765\u5b58\u653e\u67d0\u79cd\u72b6\u6001\uff0c\u9002\u7528\u4e8e\u5927\u89c4\u6a21\u6570\u636e\uff0c\u4f46\u6570\u636e\u72b6\u6001\u53c8\u4e0d\u662f\u5f88\u591a\u7684\u60c5\u51b5\u3002\u901a\u5e38\u662f\u7528\u6765\u5224\u65ad\u67d0\u4e2a\u6570\u636e\u5b58\u4e0d\u5b58\u5728\u7684\u3002</p>"},{"location":"foundmental/2.MySQL%E7%B4%A2%E5%BC%95/#_24","title":"\u7d22\u5f15\u7ef4\u62a4\u7684\u4ee3\u4ef7","text":"<p>\u7d22\u5f15\u7ef4\u62a4\uff0cB+\u6811\u4e3a\u4e86\u7ef4\u62a4\u7d22\u5f15\u6709\u5e8f\u6027\uff0c\u5728\u63d2\u5165\u65b0\u503c\u7684\u65f6\u5019\u9700\u8981\u505a\u5fc5\u8981\u7684\u7ef4\u62a4\u3002</p> <p>\u5982\u679c\u4f60\u7684\u4e3b\u952e\u7684\u503c\u662f\u4e0d\u8fde\u7eed\u7684\uff0c\u90a3\u4e48\u5728\u63d2\u5165\u7d22\u5f15\u7684\u65f6\u5019\uff0c\u5c31\u8981\u6709\u79fb\u52a8 B+\u6811\u4e0a\u8282\u70b9\u7684\u64cd\u4f5c\u3002</p> <p>\u5982\u679c\u63d2\u5165\u503c\u65f6\u7236\u8282\u70b9\u6240\u5728\u7684\u6570\u636e\u9875\u5df2\u7ecf\u6ee1\u4e86\uff0c\u6839\u636e B+\u6811\u7684\u7b97\u6cd5\uff0c\u8fd9\u65f6\u5019\u9700\u8981\u7533\u8bf7\u4e00\u4e2a\u65b0\u7684\u6570\u636e\u9875\uff0c\u7136\u540e\u632a\u52a8\u90e8\u5206\u6570\u636e\u8fc7\u53bb\u3002</p> <p>\u8fd9\u4e2a\u8fc7\u7a0b\u79f0\u4e3a\u9875\u5206\u88c2\u3002\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u6027\u80fd\u81ea\u7136\u4f1a\u53d7\u5f71\u54cd\u3002</p> <p>\u9664\u4e86\u6027\u80fd\u5916\uff0c\u9875\u5206\u88c2\u64cd\u4f5c\u8fd8\u5f71\u54cd\u6570\u636e\u9875\u7684\u5229\u7528\u7387\u3002\u539f\u672c\u653e\u5728\u4e00\u4e2a\u9875\u7684\u6570\u636e\uff0c\u73b0\u5728\u5206\u5230\u4e24\u4e2a\u9875\u4e2d\uff0c\u6574\u4f53\u7a7a\u95f4\u5229\u7528\u7387\u964d\u4f4e\u5927\u7ea6 50%\u3002</p> <p>\u5f53\u7136\u6709\u5206\u88c2\u5c31\u6709\u5408\u5e76\u3002\u5f53\u76f8\u90bb\u4e24\u4e2a\u9875\u7531\u4e8e\u5220\u9664\u4e86\u6570\u636e\uff0c\u5229\u7528\u7387\u5f88\u4f4e\u4e4b\u540e\uff0c\u4f1a\u5c06\u6570\u636e\u9875\u505a\u5408\u5e76\u3002\u5408\u5e76\u7684\u8fc7\u7a0b\uff0c\u53ef\u4ee5\u8ba4\u4e3a\u662f\u5206\u88c2\u8fc7\u7a0b\u7684\u9006\u8fc7\u7a0b\u3002</p>"},{"location":"foundmental/2.MySQL%E7%B4%A2%E5%BC%95/#icp","title":"\u7d22\u5f15\u4e0b\u63a8\uff08ICP\uff09","text":"<p>\u5728\u8054\u5408\u7d22\u5f15\u7684\u6700\u5de6\u524d\u7f00\u5339\u914d\u65f6\uff0c\u4ee5 INDEX name (last_name,first_name,age) \u8fd9\u4e2a\u7d22\u5f15\u4e3a\u4f8b\u3002\u6709\u5982\u4e0b\u67e5\u8be2</p> <pre><code>select * FROM test where last_name like '\u5f20%' and age=10 ;\n</code></pre> <p>\u5728 5.6 \u4e4b\u524d\uff0c\u8fd9\u4e2a\u8bed\u53e5\u5728\u641c\u7d22\u7d22\u5f15\u6811\u7684\u65f6\u5019\uff0c\u4f7f\u7528\u7b2c\u4e00\u4e2a\u5b57\u6bb5\u7684\u6761\u4ef6\u53bb\u5339\u914d\u3002\u627e\u5230\u6240\u6709\u5339\u914d\u7684\u884c\uff0c\u9010\u884c\u53bb\u4e3b\u952e\u7d22\u5f15\u4e0a\u627e\u5230\u6570\u636e\u884c\uff0c\u5bf9\u6bd4\u540e\u9762\u7684\u6761\u4ef6\u3002</p> <p>\u5728 5.6 \u4e4b\u540e\uff0cMySQL \u5f15\u5165\u4e86 \u7d22\u5f15\u4e0b\u63a8 \u4f18\u5316\uff0c\u53ef\u4ee5\u5728\u7d22\u5f15\u904d\u5386\u7684\u8fc7\u7a0b\u4e2d\uff0c\u5bf9\u7d22\u5f15\u5305\u542b\u7684\u5b57\u6bb5\u5148\u505a\u5224\u65ad\uff0c\u8fc7\u6ee4\u6389\u4e0d\u6ee1\u8db3\u8981\u6c42\u7684\u884c\uff0c\u51cf\u5c11\u56de\u8868\u6b21\u6570\u3002</p> <p>\u7d22\u5f15\u4e0b\u63a8 \u5176\u5b9e\u5c31\u662f\u6307\u5c06\u90e8\u5206\u4e0a\u5c42\uff08\u670d\u52a1\u5c42\uff09\u8d1f\u8d23\u7684\u4e8b\u60c5\uff0c\u4ea4\u7ed9\u4e86\u4e0b\u5c42\uff08\u5f15\u64ce\u5c42\uff09\u53bb\u5904\u7406\u3002</p> <p>\u7d22\u5f15\u4e0b\u63a8\u7684\u76ee\u7684\u662f\u4e3a\u4e86\u51cf\u5c11\u56de\u8868\u6b21\u6570\uff0c\u4e5f\u5c31\u662f\u8981\u51cf\u5c11 IO \u64cd\u4f5c\u3002\u5bf9\u4e8e InnoDB \u7684\u805a\u7c07\u7d22\u5f15\u6765\u8bf4\uff0c\u6570\u636e\u548c\u7d22\u5f15\u662f\u5728\u4e00\u8d77\u7684\uff0c\u4e0d\u5b58\u5728\u56de\u8868\u8fd9\u4e00\u8bf4\u3002</p> <p>\u5728\u6ca1\u6709\u4f7f\u7528 ICP \u7684\u60c5\u51b5\u4e0b\uff0cMySQL \u7684\u67e5\u8be2\uff1a</p> <ul> <li>\u5b58\u50a8\u5f15\u64ce\u8bfb\u53d6\u7d22\u5f15\u8bb0\u5f55\uff1b</li> <li>\u6839\u636e\u7d22\u5f15\u4e2d\u7684\u4e3b\u952e\u503c\uff0c\u5b9a\u4f4d\u5e76\u8bfb\u53d6\u5b8c\u6574\u7684\u884c\u8bb0\u5f55\uff1b</li> <li>\u5b58\u50a8\u5f15\u64ce\u628a\u8bb0\u5f55\u4ea4\u7ed9 Server \u5c42\u53bb\u68c0\u6d4b\u8be5\u8bb0\u5f55\u662f\u5426\u6ee1\u8db3 WHERE \u6761\u4ef6\u3002</li> </ul> <p>\u4f7f\u7528 ICP \u7684\u60c5\u51b5\u4e0b\uff0c\u67e5\u8be2\u8fc7\u7a0b\uff1a</p> <ul> <li>\u5b58\u50a8\u5f15\u64ce\u8bfb\u53d6\u7d22\u5f15\u8bb0\u5f55\uff08\u4e0d\u662f\u5b8c\u6574\u7684\u884c\u8bb0\u5f55\uff09\uff1b</li> <li>\u5224\u65ad WHERE \u6761\u4ef6\u90e8\u5206\u80fd\u5426\u7528\u7d22\u5f15\u4e2d\u7684\u5217\u6765\u505a\u68c0\u67e5\uff0c\u6761\u4ef6\u4e0d\u6ee1\u8db3\uff0c\u5219\u5904\u7406\u4e0b\u4e00\u884c\u7d22\u5f15\u8bb0\u5f55\uff1b</li> <li>\u6761\u4ef6\u6ee1\u8db3\uff0c\u4f7f\u7528\u7d22\u5f15\u4e2d\u7684\u4e3b\u952e\u53bb\u5b9a\u4f4d\u5e76\u8bfb\u53d6\u5b8c\u6574\u7684\u884c\u8bb0\u5f55\uff08\u5c31\u662f\u6240\u8c13\u7684\u56de\u8868\uff09\uff1b</li> <li>\u5b58\u50a8\u5f15\u64ce\u628a\u8bb0\u5f55\u4ea4\u7ed9 Server \u5c42\uff0cServer \u5c42\u68c0\u6d4b\u8be5\u8bb0\u5f55\u662f\u5426\u6ee1\u8db3 WHERE \u6761\u4ef6\u7684\u5176\u4f59\u90e8\u5206\u3002</li> </ul> <p>\u5728\u4e8c\u7ea7\u7d22\u5f15\u662f\u590d\u5408\u7d22\u5f15\u4e14\u524d\u9762\u7684\u6761\u4ef6\u8fc7\u6ee4\u6027\u8f83\u4f4e\u7684\u60c5\u51b5\u4e0b\uff0c\u6253\u5f00 ICP \u53ef\u4ee5\u6709\u6548\u7684\u964d\u4f4e server \u5c42\u548c engine \u5c42\u4e4b\u95f4\u4ea4\u4e92\u7684\u6b21\u6570\uff0c\u4ece\u800c\u6709\u6548\u7684\u964d\u4f4e\u8fd0\u884c\u65f6\u95f4\u3002</p> <p>\u4f46\u662f\uff0c\u5bf9\u4e8e\u591a\u4e2a\u666e\u901a\u5355\u5217\u7d22\u5f15\u6784\u6210\u7684 where \u8fc7\u6ee4\u6761\u4ef6\uff0c\u65e0\u8bba\u662f\u5426\u542f\u7528 ICP\uff0c\u4f18\u5316\u5668\u90fd\u4f1a\u5c06\u8fc7\u6ee4\u6027\u9ad8\u7684\u7d22\u5f15\u6761\u4ef6\u4e0b\u63a8\u5230 engine \u5c42\u6267\u884c index range scan\uff0c\u56e0\u6b64\uff0c\u6536\u76ca\u4e0d\u5927\u3002</p> <p>\u4f7f\u7528\u9650\u5236 &amp; \u9002\u7528\u6761\u4ef6</p> <ul> <li>\u5f53\u9700\u8981\u8bbf\u95ee\u5168\u8868\u8bb0\u5f55\u65f6\uff0cICP \u53ef\u7528\u4e8e range\uff08\u8303\u56f4\u626b\u63cf\uff09\u3001ref\uff08\u975e\u552f\u4e00\u7d22\u5f15\u7684\u201d=\u201d\u64cd\u4f5c\uff09\u3001eq_ref\uff08\u552f\u4e00\u7d22\u5f15\u7684\u201d=\u201d\u64cd\u4f5c\uff09 \u548c ref_or_null\uff08ref + \u652f\u6301\u7a7a\u503c\uff0c\u6bd4\u5982\uff1aWHERE col = \u2026 OR col IS NULL\uff09 \u8bbf\u95ee\u65b9\u6cd5\u3002</li> <li>ICP \u53ef\u4ee5\u7528\u4e8e InnoDB \u548c MyISAM \u5f15\u64ce\u8868\uff08\u5305\u62ec\u5206\u533a\u8868\uff09\u3002</li> <li>\u5bf9\u4e8e InnoDB \u8868\uff0cICP \u4ec5\u652f\u6301\u4e8c\u7ea7\u7d22\u5f15\u3002\u800c\u5bf9\u4e8e InnoDB \u805a\u7c07\u7d22\u5f15\uff0c\u7531\u4e8e\u5b8c\u6574\u7684\u8bb0\u5f55\u4f1a\u88ab\u8bfb\u5230 InnoDB \u7f13\u51b2\u533a\uff0c\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u4f7f\u7528 ICP \u4e0d\u4f1a\u51cf\u5c11 I/O \u64cd\u4f5c\u3002</li> <li>\u865a\u62df\u5217\u4e0a\u521b\u5efa\u7684\u4e8c\u7ea7\u7d22\u5f15\u4e0d\u652f\u6301 ICP\u3002</li> <li>\u4f7f\u7528\u5b50\u67e5\u8be2\u7684 where \u6761\u4ef6\u4e0d\u652f\u6301 ICP\u3002</li> <li>\u7531\u4e8e\u5f15\u64ce\u5c42\u65e0\u6cd5\u8c03\u7528\u4f4d\u4e8e server \u5c42\u7684\u5b58\u50a8\u8fc7\u7a0b\uff0c\u56e0\u6b64\uff0c\u8c03\u7528\u5b58\u50a8\u8fc7\u7a0b\u7684 SQL \u4e0d\u652f\u6301 ICP\u3002</li> <li>\u89e6\u53d1\u5668\u4e0d\u652f\u6301 ICP\u3002</li> </ul> <p>\u5373\u4f7f\u67e5\u8be2\u6ee1\u8db3\u4e0a\u8ff0\u6761\u4ef6\uff0cMySQL \u7684\u4f18\u5316\u5668\u4e5f\u4e0d\u4e00\u5b9a\u4f1a\u9009\u62e9\u4f7f\u7528 ICP\u3002\u4f18\u5316\u5668\u4f1a\u6839\u636e\u67e5\u8be2\u6210\u672c\u4f30\u7b97\u6765\u51b3\u5b9a\u662f\u5426\u4f7f\u7528 ICP\u3002\u5982\u679c\u4f18\u5316\u5668\u8ba4\u4e3a\u5168\u8868\u626b\u63cf\u6216\u8005\u5176\u4ed6\u8bbf\u95ee\u65b9\u6cd5\u66f4\u5feb\uff0c\u5b83\u53ef\u80fd\u4e0d\u4f1a\u9009\u62e9 ICP\u3002</p> <p>\u8981\u5145\u5206\u5229\u7528 ICP \u4f18\u5316\uff0c\u9664\u4e86\u6ee1\u8db3\u4e0a\u8ff0\u6761\u4ef6\u5916\uff0c\u8fd8\u9700\u8981\u5408\u7406\u5730\u8bbe\u8ba1\u6570\u636e\u5e93\u6a21\u5f0f\u548c\u7d22\u5f15\uff0c\u4ee5\u53ca\u7f16\u5199\u9ad8\u6548\u7684 SQL \u67e5\u8be2\u3002\u540c\u65f6\uff0c\u5b9a\u671f\u5206\u6790\u67e5\u8be2\u6027\u80fd\u548c\u6267\u884c\u8ba1\u5212\uff0c\u6839\u636e\u5b9e\u9645\u7684\u6570\u636e\u5206\u5e03\u548c\u67e5\u8be2\u8d1f\u8f7d\u6765\u8c03\u6574\u548c\u4f18\u5316\u6570\u636e\u5e93\u8bbe\u8ba1\u4e5f\u662f\u975e\u5e38\u91cd\u8981\u7684\u3002</p> <p>\u53c2\u8003</p>"},{"location":"foundmental/2.MySQL%E7%B4%A2%E5%BC%95/#_25","title":"\u7d22\u5f15\u5408\u5e76","text":"<p>\u5728\u67d0\u4e9b\u60c5\u51b5\u4e0b\uff0c\u5355\u72ec\u4f7f\u7528\u4efb\u4f55\u4e00\u4e2a\u7d22\u5f15\u90fd\u65e0\u6cd5\u9ad8\u6548\u5730\u83b7\u53d6\u5230\u5b8c\u6574\u7684\u7ed3\u679c\u96c6\u3002\u800c\u901a\u8fc7\u5408\u5e76\u591a\u4e2a\u7d22\u5f15\u7684\u626b\u63cf\u7ed3\u679c\uff0c\u6211\u4eec\u53ef\u4ee5\u66f4\u7cbe\u786e\u5730\u5b9a\u4f4d\u5230\u6ee1\u8db3\u6240\u6709\u6761\u4ef6\u7684\u8bb0\u5f55\uff0c\u4ece\u800c\u63d0\u9ad8\u67e5\u8be2\u6548\u7387\u3002</p> <p>\u8003\u8651\u4e00\u4e2a\u573a\u666f\uff0c\u4f60\u6709\u4e00\u4e2a\u5927\u578b\u7684\u7535\u5b50\u5546\u52a1\u6570\u636e\u5e93\uff0c\u5176\u4e2d\u5305\u542b\u5546\u54c1\u4fe1\u606f\u3002\u4f60\u53ef\u80fd\u9700\u8981\u6839\u636e\u5546\u54c1\u7684\u540d\u79f0\u3001\u4ef7\u683c\u3001\u5206\u7c7b\u7b49\u591a\u4e2a\u6761\u4ef6\u6765\u68c0\u7d22\u5546\u54c1\u3002\u5982\u679c\u53ea\u4f9d\u8d56\u5355\u4e2a\u5b57\u6bb5\u7684\u7d22\u5f15\u3002\u90a3\u4e48\u67e5\u8be2\u6548\u7387\u53ef\u80fd\u4f1a\u5f88\u4f4e\uff0c\u56e0\u4e3a\u4f60\u9700\u8981\u626b\u63cf\u5927\u91cf\u7684\u4e0d\u76f8\u5173\u8bb0\u5f55\u3002</p> <p>\u901a\u8fc7\u7d22\u5f15\u5408\u5e76\uff0cMySQL \u53ef\u4ee5\u5229\u7528\u591a\u4e2a\u5b57\u6bb5\u4e0a\u7684\u7d22\u5f15\u6765\u52a0\u901f\u67e5\u8be2\u3002\u5b83\u9996\u5148\u5206\u522b\u626b\u63cf\u6bcf\u4e2a\u7d22\u5f15\uff0c\u83b7\u53d6\u6ee1\u8db3\u76f8\u5e94\u6761\u4ef6\u7684\u8bb0\u5f55\u96c6\uff0c\u7136\u540e\u518d\u5c06\u8fd9\u4e9b\u8bb0\u5f55\u96c6\u5408\u5e76\uff0c\u5f97\u5230\u6700\u7ec8\u7684\u7ed3\u679c\u3002 \u7d22\u5f15\u5408\u5e76\u7684\u6838\u5fc3\u539f\u7406\u5c31\u662f\u5728\u591a\u4e2a\u7d22\u5f15\u6811\u4e0a\u540c\u65f6\u8fdb\u884c\u626b\u63cf\uff0c\u5e76\u53d6\u8fd9\u4e9b\u626b\u63cf\u7ed3\u679c\u8fdb\u884c\u96c6\u5408\u8fd0\u7b97\u4f5c\u4e3a\u6700\u7ec8\u7ed3\u679c\u96c6\u3002</p> <p>\u5b98\u7f51</p> <p>MySQL5.0 \u4e4b\u524d\uff0c\u4e00\u4e2a\u8868\u4e00\u6b21\u53ea\u80fd\u4f7f\u7528\u4e00\u4e2a\u7d22\u5f15\uff0c\u65e0\u6cd5\u540c\u65f6\u4f7f\u7528\u591a\u4e2a\u7d22\u5f15\u5206\u522b\u8fdb\u884c\u6761\u4ef6\u626b\u63cf\u3002</p> <p>\u4f46\u662f\u4ece 5.1 \u5f00\u59cb\uff0c\u5f15\u5165\u4e86 <code>index merge</code> \u4f18\u5316\u6280\u672f\uff0c\u5bf9\u540c\u4e00\u4e2a\u8868\u53ef\u4ee5\u4f7f\u7528\u591a\u4e2a\u7d22\u5f15\u5206\u522b\u8fdb\u884c\u6761\u4ef6\u626b\u63cf\u3002</p> <p>\u5f53\u4e00\u4e2a\u67e5\u8be2\u4e2d\u5305\u542b\u591a\u4e2a\u6761\u4ef6\uff0c\u5e76\u4e14\u8fd9\u4e9b\u6761\u4ef6\u5206\u522b\u9002\u7528\u4e8e\u4e0d\u540c\u7684\u7d22\u5f15\u65f6\uff0c<code>MySQL</code>\u53ef\u4ee5\u5c06\u8fd9\u4e9b\u7d22\u5f15\u5408\u5e76\u8d77\u6765\u4f7f\u7528\uff0c\u51cf\u5c11\u4e86\u56de\u8868\u7684\u6b21\u6570\uff0c\u4ee5\u52a0\u901f\u67e5\u8be2\u7684\u6267\u884c\u3002</p> <p>\u5f53\u5355\u8868\u4f7f\u7528\u4e86\u591a\u4e2a\u7d22\u5f15\uff0c\u6bcf\u4e2a\u7d22\u5f15\u67e5\u627e\u90fd\u53ef\u80fd\u8fd4\u56de\u4e00\u4e2a\u7ed3\u679c\u96c6\uff0cMySQL \u4f1a\u5c06\u5176\u6c42\u4ea4\u96c6\u6216\u8005\u5e76\u96c6\uff0c\u6216\u8005\u662f\u4ea4\u96c6\u548c\u5e76\u96c6\u7684\u7ec4\u5408\u3002\u4e5f\u5c31\u662f\u8bf4\u4e00\u6b21\u67e5\u8be2\u4e2d\u53ef\u4ee5\u540c\u65f6\u4f7f\u7528\u591a\u4e2a\u7d22\u5f15</p> <p>\u5de5\u4f5c\u539f\u7406\u6d41\u7a0b\u4e3b\u8981\u5982\u4e0b\uff1a</p> <ul> <li>\u6761\u4ef6\u5206\u6790\uff1aMySQL \u4f18\u5316\u5668\u9996\u5148\u5206\u6790\u67e5\u8be2\u7684 WHERE \u5b50\u53e5\uff0c\u786e\u5b9a\u5176\u4e2d\u6709\u591a\u5c11\u4e2a\u72ec\u7acb\u7684\u6761\u4ef6\u3002</li> <li>\u7d22\u5f15\u9009\u62e9\uff1a\u5bf9\u4e8e WHERE \u5b50\u53e5\u4e2d\u7684\u6bcf\u4e2a\u72ec\u7acb\u6761\u4ef6\uff0c\u4f18\u5316\u5668\u68c0\u67e5\u662f\u5426\u5b58\u5728\u53ef\u7528\u7684\u7d22\u5f15\u3002\u5982\u679c\u5b58\u5728\uff0c\u5b83\u4f1a\u8bc4\u4f30\u4f7f\u7528\u8fd9\u4e9b\u7d22\u5f15\u7684\u6210\u672c\u3002</li> <li>\u7d22\u5f15\u626b\u63cf\uff1a\u4f18\u5316\u5668\u51b3\u5b9a\u4f7f\u7528\u54ea\u4e9b\u7d22\u5f15\u540e\uff0c\u5b83\u4f1a\u5206\u522b\u5bf9\u8fd9\u4e9b\u7d22\u5f15\u8fdb\u884c\u626b\u63cf\uff0c\u83b7\u53d6\u6ee1\u8db3\u6bcf\u4e2a\u6761\u4ef6\u7684\u8bb0\u5f55\u96c6\u3002</li> <li>\u7ed3\u679c\u5408\u5e76\uff1a\u626b\u63cf\u5b8c\u6240\u6709\u9009\u5b9a\u7684\u7d22\u5f15\u540e\uff0cMySQL \u5c06\u8fd9\u4e9b\u8bb0\u5f55\u96c6\u5408\u5e76\uff0c\u4ee5\u4ea7\u751f\u6700\u7ec8\u7684\u7ed3\u679c\u96c6\u3002\u5408\u5e76\u7684\u65b9\u5f0f\u53ef\u4ee5\u662f\u4ea4\u96c6\uff08Intersection\uff09\u3001\u5e76\u96c6\uff08Union\uff09\u6216\u6392\u5e8f\u5e76\u96c6\uff08Sort-Union\uff09\uff0c\u5177\u4f53\u53d6\u51b3\u4e8e\u67e5\u8be2\u7684\u6761\u4ef6\u548c\u6240\u9700\u7684\u7ed3\u679c\u3002</li> <li>\u8fd4\u56de\u7ed3\u679c\uff1a\u6700\u7ec8\uff0c\u4f18\u5316\u5668\u5c06\u5408\u5e76\u540e\u7684\u7ed3\u679c\u96c6\u8fd4\u56de\u7ed9\u5ba2\u6237\u7aef\u3002</li> </ul> <p>\u7d22\u5f15\u5408\u5e76\u901a\u5e38\u5e94\u7528\u4e8e\u4ee5\u4e0b\u573a\u666f\uff1a</p> <ul> <li> <p>\u591a\u6761\u4ef6\u67e5\u8be2: \u5f53\u67e5\u8be2\u7684 WHERE \u5b50\u53e5\u4e2d\u5305\u542b\u591a\u4e2a\u72ec\u7acb\u7684\u6761\u4ef6\u65f6\uff0c\u6bcf\u4e2a\u6761\u4ef6\u90fd\u53ef\u4ee5\u5229\u7528\u4e0d\u540c\u7684\u7d22\u5f15\u3002</p> </li> <li> <p>\u590d\u5408\u7d22\u5f15\u4e0d\u5b8c\u5168\u5339\u914d:\u5373\u4f7f\u4f60\u6709\u4e00\u4e2a\u590d\u5408\u7d22\u5f15\uff08\u4f8b\u5982\uff0cINDEX(col1, col2)\uff09\uff0c\u4f46\u67e5\u8be2\u6761\u4ef6\u53ea\u6d89\u53ca col1 \u6216 col2 \u65f6\uff0cMySQL \u53ef\u80fd\u4f1a\u9009\u62e9\u4f7f\u7528\u5355\u5217\u7d22\u5f15\uff0c\u5e76\u901a\u8fc7\u7d22\u5f15\u5408\u5e76\u6765\u4f18\u5316\u67e5\u8be2\u3002</p> </li> <li> <p>\u6392\u5e8f\u548c\u9650\u5236:\u5f53\u67e5\u8be2\u9700\u8981\u6392\u5e8f\u6216\u9650\u5236\u7ed3\u679c\u96c6\u5927\u5c0f\u65f6\uff0c\u7d22\u5f15\u5408\u5e76\u53ef\u4ee5\u5e2e\u52a9\u5feb\u901f\u5b9a\u4f4d\u5230\u6ee1\u8db3\u6761\u4ef6\u7684\u8bb0\u5f55\u3002</p> </li> </ul> <pre><code>-- \u53ef\u4ee5\u4f7f\u7528\u7d22\u5f15\u5408\u5e76\u7684\u8bed\u53e5\u793a\u4f8b\n\nSELECT * FROM tbl_name WHERE key1 = 10 OR key2 = 20;\n-- \u5bf9\u4e8e\u7b2c\u4e00\u6761\u8bed\u53e5\uff1a\u4f7f\u7528\u7d22\u5f15\u5e76\u96c6\u8bbf\u95ee\u7b97\u6cd5\uff0c\u5f97\u5230key1=10\u7684\u4e3b\u952e\u6709\u5e8f\u96c6\u5408\uff0c\u5f97\u5230key2=20\u7684\u4e3b\u952e\u6709\u5e8f\u96c6\u5408\u3002\u518d\u5bf9\u8fd9\u4e24\u4e2a\u96c6\u5408\u6c42\u5e76\u96c6\uff1b\u6700\u540e\u56de\u8868\u67e5\u627e\u3002\n\nSELECT * FROM tbl_name\n  WHERE (key1 = 10 OR key2 = 20) AND non_key = 30;\n-- \u5bf9\u4e8e\u7b2c\u4e8c\u6761\u8bed\u53e5\uff1a\u5148\u4e22\u5f03non_key=30,\u56e0\u4e3a\u5b83\u4f7f\u7528\u4e0d\u5230\u7d22\u5f15\uff0cwhere\u5b50\u53e5\u5c31\u53d8\u6210\u4e86where key10 or key2=20\uff0c\u4f7f\u7528\u7d22\u5f15\u5148\u6839\u636e\u7d22\u5f15\u5408\u5e76\u5e76\u96c6\u8bbf\u95ee\u7b97\u6cd5\u3002\n\nSELECT * FROM t1, t2\n  WHERE (t1.key1 IN (1,2) OR t1.key2 LIKE 'value%')\n  AND t2.key1 = t1.some_col;\n\n\nSELECT * FROM t1, t2\n  WHERE t1.key1 = 1\n  AND (t2.key1 = t1.some_col OR t2.key2 = t1.some_col2);\n\n-- \u5148\u901a\u8fc7\u7d22\u5f15\u67e5\u627e\u7b97\u6cd5\u67e5\u627e\u540e\u7f29\u5c0f\u7ed3\u679c\u96c6\uff0c\u5728\u5c0f\u8868\u4e2d\u518d\u8fdb\u884c\u5168\u8868\u5339\u914d\u67e5\u8be2\u3002\n--\n</code></pre> <p>\u6ce8\u610f\uff1a</p> <p>\u7d22\u5f15\u5408\u5e76\u4f18\u5316\u7b97\u6cd5\u5177\u6709\u4ee5\u4e0b\u5df2\u77e5\u9650\u5236\uff1a</p> <ul> <li>\u5982\u679c\u60a8\u7684\u67e5\u8be2\u5177\u6709\u6df1\u5ea6 AND/OR \u5d4c\u5957\u7684\u590d\u6742 WHERE \u5b50\u53e5\uff0c\u5e76\u4e14 MySQL \u6ca1\u6709\u9009\u62e9\u6700\u4f73\u8ba1\u5212\uff0c\u8bf7\u5c1d\u8bd5\u4f7f\u7528\u4ee5\u4e0b\u8f6c\u6362\u540e\u8868\u8fbe\u65b9\u5f0f\u6765\u6ee1\u8db3\u6761\u4ef6\uff1a</li> </ul> <pre><code>(x AND y) OR z =&gt; (x OR z) AND (y OR z)\n(x OR y) AND z =&gt; (x AND z) OR (y AND z)\n</code></pre> <ul> <li>\u7d22\u5f15\u5408\u5e76\u4e0d\u9002\u7528\u4e8e\u5168\u6587\u7d22\u5f15\u3002</li> </ul> <p>\u7d22\u5f15\u5408\u5e76\u8bbf\u95ee\u65b9\u6cd5\u6709\u51e0\u4e2a\u7b97\u6cd5\uff0c\u8fd9\u4e9b\u7b97\u6cd5\u663e\u793a\u5728 EXPLAIN \u8f93\u51fa\u7684 <code>Extra</code> \u5b57\u6bb5\u4e2d\uff1a</p> <ul> <li><code>Using intersect(...)</code></li> <li><code>Using union(...)</code></li> <li><code>Using sort_union(...)</code></li> </ul>"},{"location":"foundmental/2.MySQL%E7%B4%A2%E5%BC%95/#index-merge-intersection-access-algorithm-","title":"index merge intersection access algorithm\uff08\u7d22\u5f15\u5408\u5e76-\u4ea4\u96c6\u8bbf\u95ee\u7b97\u6cd5\uff09","text":"<p>\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u4f7f\u7528\u5230\u7684\u7d22\u5f15\u8fdb\u884c\u67e5\u8be2\uff0c\u67e5\u8be2\u4e3b\u952e\u503c\u96c6\u5408\uff0c\u7136\u540e\u8fdb\u884c\u5408\u5e76\uff0c\u6c42\u4ea4\u96c6\uff0c\u4e5f\u5c31\u662f AND \u8fd0\u7b97\u3002\u4e0b\u9762\u662f\u4f7f\u7528\u5230\u8be5\u7b97\u6cd5\u7684\u4e24\u79cd\u5fc5\u8981\u6761\u4ef6\uff1a</p> <ul> <li>\u5728\u4e8c\u7ea7\u7d22\u5f15\u5217\u4e0a\u8fdb\u884c\u7b49\u503c\u67e5\u8be2\uff1b\u5982\u679c\u662f\u7ec4\u5408\u7d22\u5f15\uff0c\u7ec4\u5408\u7d22\u5f15\u7684\u6bcf\u4e00\u4f4d\u90fd\u5fc5\u987b\u8986\u76d6\u5230\uff0c\u4e0d\u80fd\u53ea\u662f\u90e8\u5206</li> </ul> <pre><code>-- \u4e8c\u7ea7\u7d22\u5f15\u662f\u7b49\u503c\u67e5\u8be2\uff1b\u5982\u679c\u662f\u8054\u5408\u7d22\u5f15\uff0c\u8054\u5408\u7d22\u5f15\u7684\u6bcf\u4e00\u4f4d\u90fd\u5fc5\u987b\u8986\u76d6\u5230\uff0c\u4e0d\u80fd\u53ea\u662f\u90e8\u5206\nkey_part1 = const1 AND key_part2 = const2 ... AND key_partN = constN\n</code></pre> <ul> <li>InnoDB \u8868\u4e0a\u7684\u4e3b\u952e\u8303\u56f4\u67e5\u8be2\u6761\u4ef6</li> </ul> <pre><code>-- \u4f8b\u5b50\n\n-- \u4e3b\u952e\u53ef\u4ee5\u662f\u8303\u56f4\u67e5\u8be2\uff0c\u4e8c\u7ea7\u7d22\u5f15\u53ea\u80fd\u662f\u7b49\u503c\u67e5\u8be2\nSELECT * FROM innodb_table  WHERE primary_key &lt; 10 AND key_col1 = 20;\n\n-- \u6ca1\u6709\u4e3b\u952e\u7684\u60c5\u51b5\nSELECT * FROM tbl_name  WHERE key1_part1 = 1 AND key1_part2 = 2 AND key2 = 2;\n</code></pre>"},{"location":"foundmental/2.MySQL%E7%B4%A2%E5%BC%95/#index-merge-union-access-algorithm","title":"index merge union access algorithm\uff08\u7d22\u5f15\u5408\u5e76\u5e76\u96c6\u8bbf\u95ee\u7b97\u6cd5\uff09","text":"<p>\u5728\u67d0\u4e9b\u60c5\u51b5\u4e0b\uff0c\u67e5\u8be2\u53ef\u80fd\u53ea\u9700\u8981\u6ee1\u8db3\u591a\u4e2a\u6761\u4ef6\u4e2d\u7684\u4efb\u610f\u4e00\u4e2a\uff08\u4f7f\u7528 OR \u8fde\u63a5\uff09\u3002MySQL \u4f1a\u5206\u522b\u626b\u63cf\u8fd9\u4e9b\u7d22\u5f15\uff0c\u7136\u540e\u53d6\u7ed3\u679c\u7684\u5e76\u96c6\u3002</p> <p>\u6848\u4f8b\uff1a\u4f7f\u7528\u4e0a\u9762\u7684 users \u8868\uff0c\u67e5\u8be2\u8bed\u53e5\u5982\u4e0b\uff1a</p> <pre><code>SELECT * FROM users WHERE age = 30 OR city = 'Los Angeles';\n</code></pre> <p>\u5728\u8fd9\u4e2a\u67e5\u8be2\u4e2d\uff0c\u53ea\u8981\u6ee1\u8db3<code>age = 30</code>\u6216<code>city = 'Los Angeles'</code>\u4e2d\u7684\u4efb\u610f\u4e00\u4e2a\u6761\u4ef6\uff0c\u8bb0\u5f55\u5c31\u4f1a\u88ab\u9009\u4e2d\u3002MySQL \u53ef\u80fd\u4f1a\u4f7f\u7528\u5e76\u96c6\u5408\u5e76\u7b56\u7565\uff0c\u5206\u522b\u626b\u63cf age \u7d22\u5f15\u548c city \u7d22\u5f15\uff0c\u7136\u540e\u5408\u5e76\u7ed3\u679c\u96c6\uff0c\u8fd4\u56de\u6ee1\u8db3\u4efb\u4e00\u6761\u4ef6\u7684\u7528\u6237\u8bb0\u5f55\u3002</p>"},{"location":"foundmental/2.MySQL%E7%B4%A2%E5%BC%95/#_26","title":"\u7d22\u5f15\u8df3\u8dc3\u626b\u63cf","text":"<p>\u56de\u987e\u4e00\u4e0b \u8054\u5408\u7d22\u5f15\u6700\u5de6\u524d\u7f00 \uff1a\u5047\u8bbe\u6709\u4e00\u4e2a\u7d22\u5f15 idx_abc(a,b,c)\uff0c\u80fd\u7528\u5230\u7d22\u5f15\u7684\u60c5\u51b5\u53ea\u6709\u67e5\u8be2\u6761\u4ef6\u4e3a a\u3001ab\u3001abc\u3001ac \u8fd9\u56db\u79cd\uff0c\u5bf9\u4e8e\u53ea\u6709\u5b57\u6bb5 b \u7684 where \u6761\u4ef6\u662f\u65e0\u6cd5\u7528\u5230\u8fd9\u4e2a<code>idx_abcf</code>\u7d22\u5f15\u7684\u3002\u8fd9\u91cc\u518d\u5f3a\u8c03\u4e00\u4e0b\uff0c\u8fd9\u91cc\u7684\u987a\u5e8f\u5e76\u4e0d\u662f\u5728 where \u4e2d\u5b57\u6bb5\u51fa\u73b0\u7684\u987a\u5e8f\u3002</p> <p>MySQL \u4ece 8.0.13 \u7248\u672c\u5f00\u59cb\u652f\u6301\u4e00\u79cd\u65b0\u7684 <code>range scan</code> \u65b9\u5f0f\uff0c\u79f0\u4e3a<code>range-access-skip-scan</code>\u3002\u8be5\u7279\u6027\u7531 Facebook \u8d21\u732e\u3002\u7d22\u5f15\u8df3\u8dc3\u626b\u63cf\uff08Index Skip Scan\uff09</p> <p>\u5728\u67d0\u4e9b\u7d22\u5f15\u67e5\u8be2\u573a\u666f\u4e0b\u80fd\u591f\u663e\u8457\u63d0\u9ad8\u67e5\u8be2\u6548\u7387\u3002</p> <p>\u7d22\u5f15\u8df3\u8dc3\u626b\u63cf\u6280\u672f\u662f\u5728\u4f7f\u7528\u591a\u5217\u7d22\u5f15\u67e5\u8be2\u65f6\uff0c\u901a\u8fc7\u8df3\u8fc7\u4e00\u90e8\u5206\u7d22\u5f15\u5217\u800c\u76f4\u63a5\u8fdb\u5165\u4e0a\u4e0b\u6587\u626b\u63cf\u9636\u6bb5\uff0c\u4ee5\u51cf\u5c11\u626b\u63cf\u7684\u6570\u636e\u884c\u6570\uff0c\u4ece\u800c\u63d0\u9ad8\u67e5\u8be2\u6548\u7387\u7684\u4e00\u79cd\u4f18\u5316\u624b\u6bb5\u3002</p> <p>\u5177\u4f53\u6765\u8bf4\uff0c\u5c31\u662f\u901a\u8fc7\u6784\u5efa\u4e00\u4e2a\u8986\u76d6\u67d0\u4e9b\u7d22\u5f15\u5217\u7684\u8054\u5408\u7d22\u5f15\uff0c\u7136\u540e\u5c06\u67e5\u8be2\u6761\u4ef6\u5206\u4e3a\u4e24\u4e2a\u90e8\u5206\uff1a\u4e00\u90e8\u5206\u5339\u914d\u8054\u5408\u7d22\u5f15\u7684\u524d\u7f00\u5217\uff0c\u4e00\u90e8\u5206\u5339\u914d\u8054\u5408\u7d22\u5f15\u7684\u540e\u7f00\u5217\u3002\u8fd9\u6837\u5c31\u53ef\u4ee5\u8df3\u8fc7\u7d22\u5f15\u524d\u7f00\u5217\u626b\u63cf\uff0c\u76f4\u63a5\u8fdb\u5165\u540e\u7f00\u5217\u626b\u63cf\uff0c\u79f0\u4e4b\u4e3a\u7d22\u5f15\u8df3\u8dc3\u626b\u63cf\u3002</p> <pre><code>-- \u521b\u5efa\u4e86\u4e00\u4e2at1\u8868\uff0c\u5176\u4e2d\u4e3b\u952e\u4e3a(f1,f2)\uff0c\u8fd9\u91cc\u662f\u4e24\u4e2a\u5b57\u6bb5\u3002\u6267\u884c\u5b8c\u8fd9\u4e2asql\u8bed\u53e5\u540e\u8868\u91cc\u6709160\u6761\u8bb0\u5f55\nCREATE TABLE t1 (f1 INT NOT NULL, f2 INT NOT NULL, PRIMARY KEY(f1, f2));\nINSERT INTO t1 VALUES\n  (1,1), (1,2), (1,3), (1,4), (1,5),\n  (2,1), (2,2), (2,3), (2,4), (2,5);\nINSERT INTO t1 SELECT f1, f2 + 5 FROM t1;\nINSERT INTO t1 SELECT f1, f2 + 10 FROM t1;\nINSERT INTO t1 SELECT f1, f2 + 20 FROM t1;\nINSERT INTO t1 SELECT f1, f2 + 40 FROM t1;\nANALYZE TABLE t1;\n\nEXPLAIN SELECT f1, f2 FROM t1 WHERE f2 &gt; 40;\n\n\nmysql&gt; EXPLAIN SELECT f1, f2 FROM t1 WHERE f2 &gt; 40;\n+----+-------------+-------+------------+-------+---------------+---------+---------+------+------+----------+----------------------------------------+\n| id | select_type | table | partitions | type  | possible_keys | key     | key_len | ref  | rows | filtered | Extra                                  |\n+----+-------------+-------+------------+-------+---------------+---------+---------+------+------+----------+----------------------------------------+\n|  1 | SIMPLE      | t1    | NULL       | range | PRIMARY       | PRIMARY | 8       | NULL |   53 |   100.00 | Using where; Using index for skip scan |\n+----+-------------+-------+------------+-------+---------------+---------+---------+------+------+----------+----------------------------------------+\n1 row in set, 1 warning (0.00 sec)\n</code></pre> <p>A range scan is more efficient than a full index scan, but cannot be used in this case because there is no condition on f1, the first index column. However, as of MySQL 8.0.13, the optimizer can perform multiple range scans, one for each value of f1, using a method called Skip Scan that is similar to Loose Index Scan\u3002</p> <p>https://dev.mysql.com/doc/refman/8.0/en/range-optimization.html#range-access-skip-scan</p> <p>\u5728 MySQL \u5185\u90e8\u8fd9\u4e2a <code>skip scan</code> \u5b83\u53c8\u662f\u5982\u4f55\u6267\u884c\u7684\u5462\uff0c\u6211\u4eec\u53ef\u4ee5\u7406\u89e3\u4ee5\u4e0b\u51e0\u6b65</p> <ul> <li>\u5148\u7edf\u8ba1\u4e00\u4e0b\u7d22\u5f15\u524d\u7f00\u5b57\u6bb5 f1 \u5b57\u6bb5\u503c\u6709\u51e0\u4e2a\u552f\u4e00\u503c\uff0c\u8fd9\u91cc\u4e00\u5171\u6709 1 \u548c 2</li> <li>\u5bf9\u5176\u4f59\u7d22\u5f15\u90e8\u5206\u4e0a\u7684 f2&gt; 40 \u6761\u4ef6\u7684\u6bcf\u4e2a\u4e0d\u540c\u7684\u524d\u7f00\u503c\u6267\u884c\u5b50\u8303\u56f4\u626b\u63cf</li> </ul> <p>\u5bf9\u4e8e\u8be6\u7ec6\u7684\u6267\u884c\u6d41\u7a0b\u5982\u4e0b\uff1a</p> <ul> <li>\u83b7\u53d6 f1 \u7684\u7b2c\u4e00\u4e2a\u552f\u4e00\u503c\uff08f1=1)</li> <li>\u7ec4\u5408\u80fd\u7528\u5230\u7d22\u5f15\u7684 sql \u8bed\u53e5(f1=1 AND f2&gt;40)</li> <li>\u6267\u884c\u7ec4\u5408\u540e\u7684 sql \u8bed\u53e5\uff0c\u8fdb\u884c\u8303\u56f4\u626b\u63cf\uff0c\u5e76\u5c06\u7ed3\u679c\u653e\u5165\u8bb0\u5f55\u96c6</li> <li>\u91cd\u590d\u4e0a\u9762\u7684\u6b65\u9aa4\uff0c\u83b7\u53d6 f1 \u7684\u7b2c\u4e8c\u4e2a\u552f\u4e00\u503c(f1=2)</li> <li>\u7ec4\u5408\u80fd\u7528\u5230\u7d22\u5f15\u7684 sql \u8bed\u53e5(f1=2 AND f2&gt;40)</li> <li>\u6267\u884c\u7ec4\u5408\u540e\u7684 sql \u8bed\u53e5\uff0c\u8fdb\u884c\u8303\u56f4\u626b\u63cf\uff0c\u5e76\u5c06\u7ed3\u679c\u653e\u5165\u8bb0\u5f55\u96c6</li> <li>\u5168\u90e8\u6267\u884c\u5b8c\u6bd5\uff0c\u8fd4\u56de\u8bb0\u5f55\u96c6\u7ed9\u5ba2\u6237\u7aef</li> </ul> <p>\u4e0d\u9519\uff0c\u539f\u7406\u5f88\u7b80\u5355\uff0c\u5c31\u662f\u5c06 f1 \u5b57\u6bb5\u62c6\u5206\u6210\u4e0d\u540c\u7684\u503c\uff0c\u5c06\u6bcf\u4e2a\u503c\u5e26\u5165\u5230\u9002\u5408\u5de6\u524d\u7f00\u7d22\u5f15\u7684<code>SQL</code>\u8bed\u53e5\u4e2d\uff0c\u6700\u540e\u518d\u5408\u5e76\u8bb0\u5f55\u96c6\u5e76\u8fd4\u56de\u5373\u53ef\uff0c\u7c7b\u4f3c<code>UNION</code>\u64cd\u4f5c\u3002</p> <p>\u4e3b\u8981\u8fd8\u8981\u770b\u5de6\u524d\u7f00\u6709\u5b57\u6bb5\u503c\u7684\u5206\u6563\u60c5\u51b5\uff0c\u5982\u679c\u503c\u8fc7\u591a\u7684\u8bdd\uff0c\u6027\u80fd\u8fd8\u662f\u6bd4\u8f83\u5dee\u7684\u3002\u7cfb\u7edf\u4f1a\u8fdb\u884c\u5168\u8868\u626b\u63cf\uff0c\u8fd9\u91cc\u5c31\u9700\u8981\u5355\u72ec\u4e3a\u8fd9\u4e2a\u5b57\u6bb5\u521b\u5efa\u4e00\u4e2a\u5355\u72ec\u7684\u7d22\u5f15\u3002</p>"},{"location":"foundmental/2.MySQL%E7%B4%A2%E5%BC%95/#index-hint","title":"\u7d22\u5f15\u63d0\u793a(index hint)","text":"<p>MySQL \u53ef\u4ee5\u4f7f\u7528\u7d22\u5f15\u63d0\u793a\uff08Index Hints\uff09\uff0c \u7528\u4e8e\u544a\u8bc9**\u4f18\u5316\u5668**\u5728\u67e5\u8be2\u4e2d\u5982\u4f55\u9009\u62e9\u7d22\u5f15\u3002</p> <p>\u7d22\u5f15\u63d0\u793a\u53ea\u80fd\u7528\u4e8e <code>SELECT</code> \u548c <code>UPDATE</code> \u8bed\u53e5\u4e2d\u3002<code>MySQL</code> \u5171\u6709\u4e09\u79cd\u7d22\u5f15\u63d0\u793a\uff0c\u5206\u522b\u662f\uff1a<code>USE INDEX</code>\u3001<code>IGNORE INDEX</code>\u548c<code>FORCE INDEX</code>\u3002</p> <ul> <li><code>use index(index_list)</code> \u544a\u8bc9 MySQL \u7528\u7d22\u5f15\u5217\u8868\u4e2d\u7684\u7d22\u5f15\u53bb\u505a\u672c\u6b21\u67e5\u8be2</li> </ul> <pre><code>-- \u5f3a\u5236\u4f7f\u7528\u8fd9\u4e24\u4e2a\u7d22\u5f15\u53bb\u8fdb\u884c\u67e5\u627e\nSELECT * FROM table1 USE INDEX (col1_index,col2_index)\n  WHERE col1=1 AND col2=2 AND col3=3;\n</code></pre> <ul> <li><code>ignore index(index_list)</code> \u544a\u8bc9 MySQL \u4e0d\u8981\u4f7f\u7528\u67d0\u4e9b\u7d22\u5f15\u53bb\u505a\u672c\u6b21\u67e5\u8be2</li> </ul> <pre><code>SELECT * FROM table1 IGNORE INDEX (col3_index)\nWHERE col1=1 AND col2=2 AND col3=3;\n</code></pre> <ul> <li><code>force index</code> <code>force index</code>\u548c<code>use index</code>\u529f\u80fd\u7c7b\u4f3c\uff0c\u90fd\u662f\u544a\u8bc9 MySQL \u53bb\u4f7f\u7528\u67d0\u4e9b\u7d22\u5f15\u3002\u533a\u522b\u5728\u4e8e\uff0c\u5982\u679c\u4f7f\u7528<code>force index</code>\uff0c\u90a3\u4e48\u5168\u8868\u626b\u63cf\u5c31\u4f1a\u88ab\u5047\u5b9a\u4e3a\u9700\u8981\u5f88\u9ad8\u4ee3\u4ef7\uff0c\u9664\u975e\u4e0d\u80fd\u4f7f\u7528\u7d22\u5f15\uff0c\u5426\u5219\u4e0d\u4f1a\u8003\u8651\u5168\u8868\u626b\u63cf\uff1b\u800c\u4f7f\u7528 <code>use index</code> \u7684\u8bdd\uff0c\u5982\u679c MySQL \u89c9\u5f97\u5168\u8868\u626b\u63cf\u4ee3\u4ef7\u66f4\u4f4e\u7684\u8bdd\uff0c\u4ecd\u7136\u4f1a\u4f7f\u7528\u5168\u8868\u626b\u63cf\u3002</li> </ul> <pre><code>   SELECT * FROM table1 FORCE INDEX (col3_index) WHERE col1=1 AND col2=2 AND col3=3;\n</code></pre>"},{"location":"foundmental/2.MySQL%E7%B4%A2%E5%BC%95/#_27","title":"\u7d22\u5f15\u63d0\u793a\u7684\u7528\u9014","text":"<p>\u53ef\u4ee5\u5728\u7d22\u5f15\u63d0\u793a\u7684\u540e\u8fb9\u4f7f\u7528<code>FOR</code>\u8bed\u53e5\u6307\u5b9a<code>INDEX HINT</code>\u7684\u8303\u56f4\uff0c\u7d22\u5f15\u63d0\u793a\u5171\u6709\u4e09\u79cd\u9002\u7528\u8303\u56f4\uff0c\u5206\u522b\u662f<code>FOR JOIN</code>\u3001<code>FOR ORDER BY</code>\u3001<code>FOR GROUP BY</code></p> <p>\u6ce8\u610f\uff0c\u5982\u679c\u5728<code>MySQL5.0</code>\u7248\u672c\u53ca\u4ee5\u4e0b\uff0c\u5982\u679c\u4e0d\u6307\u5b9a<code>FOR</code>\u8bed\u53e5\uff0c\u90a3\u4e48<code>MySQL</code>\u53ea\u4f1a\u7528\u5b83\u6765\u67e5\u627e\u884c\u3002\u800c\u5728\u65b0\u7248\u672c\u7684<code>MySQL</code>\uff0c\u5982\u679c\u4e0d\u6307\u5b9a<code>FOR</code>\u8bed\u53e5\uff0c\u90a3\u4e48<code>MySQL</code>\u4f1a\u628a\u7d22\u5f15\u7528\u4e8e\u6240\u6709\u7528\u9014\u3002</p> <pre><code>SELECT * FROM t1 USE INDEX (i1)  IGNORE INDEX FOR ORDER BY (i2)  ORDER BY a;\n\nSELECT * FROM t1 USE INDEX FOR JOIN (i1) FORCE INDEX FOR JOIN (i2);\n</code></pre>"},{"location":"foundmental/2.MySQL%E7%B4%A2%E5%BC%95/#mysql_1","title":"MySQL \u4f18\u5316\u5668\u5f00\u5173","text":"<p><code>optimizer_switch</code>\u7cfb\u7edf\u53d8\u91cf\u53ef\u4ee5\u63a7\u5236\u4f18\u5316\u5668\u884c\u4e3a\u3002\u5b83\u7684\u503c\u662f\u4e00\u7ec4\u6807\u5fd7\uff0c\u6bcf\u4e2a\u6807\u5fd7\u90fd\u6709\u4e00\u4e2a on \u6216 off \u503c\uff0c\u7528\u4e8e\u6307\u793a\u76f8\u5e94\u7684\u4f18\u5316\u5668\u884c\u4e3a\u662f\u542f\u7528\u8fd8\u662f\u7981\u7528\u3002</p> <p>\u6b64\u53d8\u91cf\u5177\u6709\u5168\u5c40\u503c\u548c\u4f1a\u8bdd\u503c\uff0c\u53ef\u4ee5\u5728\u8fd0\u884c\u65f6\u66f4\u6539\u3002\u5168\u5c40\u9ed8\u8ba4\u503c\u53ef\u4ee5\u5728\u670d\u52a1\u5668\u542f\u52a8\u65f6\u8bbe\u7f6e\u3002</p> <pre><code>SELECT @@optimizer_switch;\n\nindex_merge=on,\nindex_merge_union=on,\nindex_merge_sort_union=on,\nindex_merge_intersection=on,\nengine_condition_pushdown=on\nindex_condition_pushdown=on,\nmrr=on,\nmrr_cost_based=on,\nblock_nested_loop=on,\nbatched_key_access=off,\nmaterialization=on,\nsemijoin=on,\nloosescan=on,\nfirstmatch=on,\nduplicateweedout=on,\nsubquery_materialization_cost_based=on,\nuse_index_extensions=on,\ncondition_fanout_filter=on,\nderived_merge=on,\nuse_invisible_indexes=off,\nskip_scan=on,\nhash_join=on\n\n\n-- \u8981\u4fee\u6539optimizer_switch\u7684\u503c\uff0c\u6307\u5b9a\u4e00\u4e2a\u7531\u4e00\u4e2a\u6216\u591a\u4e2a\u547d\u4ee4\u7ec4\u6210\u7684\u9017\u53f7\u5206\u9694\u7684\u503c\n-- \u4fee\u6539\u4f18\u5316\u5668\nSET [GLOBAL|SESSION] optimizer_switch='command[,command]...';\n\n-- command\u8bed\u6cd5\u5982\u4e0b\uff1a\n-- default          --\u91cd\u7f6e\u4e3a\u9ed8\u8ba4\n-- opt_name=default --\u9009\u9879\u9ed8\u8ba4\n-- opt_name=off     --\u5173\u6389\u67d0\u9879\u4f18\u5316\n-- opt_name=on      --\u5f00\u542f\u67d0\u9879\u4f18\u5316\n</code></pre> <p>\u8be5\u503c\u4e2d\u547d\u4ee4\u7684\u987a\u5e8f\u5e76\u4e0d\u91cd\u8981\uff0c\u4f46\u5982\u679c\u5b58\u5728\uff0c\u9ed8\u8ba4\u547d\u4ee4\u5c06\u9996\u5148\u6267\u884c\u3002\u5c06 opt_name \u6807\u5fd7\u8bbe\u7f6e\u4e3a default \u5c06\u5176\u8bbe\u7f6e\u4e3a on \u6216 off \u4e2d\u7684\u4efb\u610f\u4e00\u4e2a\u4e3a\u5176\u9ed8\u8ba4\u503c\u3002</p> <p>\u4e0d\u5141\u8bb8\u5728\u503c\u4e2d\u591a\u6b21\u6307\u5b9a\u4efb\u4f55\u7ed9\u5b9a\u7684 opt_name\uff0c\u8fd9\u4f1a\u5bfc\u81f4\u9519\u8bef\u3002\u8be5\u503c\u4e2d\u7684\u4efb\u4f55\u9519\u8bef\u90fd\u4f1a\u5bfc\u81f4\u8d4b\u503c\u5931\u8d25\uff0c\u5e76\u5bfc\u81f4 optimizer_switch \u7684\u503c\u4fdd\u6301\u4e0d\u53d8\u3002</p> <p>\u63a7\u5236\u4f18\u5316\u5668\u7b56\u7565\u7684\u4e00\u79cd\u65b9\u6cd5\u662f\u8bbe\u7f6e optimizer_switch \u7cfb\u7edf\u53d8\u91cf\u3002\u5bf9\u8be5\u53d8\u91cf\u7684\u66f4\u6539\u5c06\u5f71\u54cd\u6240\u6709\u540e\u7eed\u67e5\u8be2\u7684\u6267\u884c;\u4e3a\u4e86\u5bf9\u4e0d\u540c\u7684\u67e5\u8be2\u4ea7\u751f\u4e0d\u540c\u7684\u5f71\u54cd\uff0c\u5fc5\u987b\u5728\u6bcf\u4e2a\u67e5\u8be2\u4e4b\u524d\u66f4\u6539 optimizer_switch\u3002</p> <p>\u63a7\u5236\u4f18\u5316\u5668\u7684\u53e6\u4e00\u79cd\u65b9\u6cd5\u662f\u4f7f\u7528\u4f18\u5316\u5668\u63d0\u793a\uff0c\u8fd9\u4e9b\u63d0\u793a\u53ef\u4ee5\u5728\u5355\u72ec\u7684\u8bed\u53e5\u4e2d\u6307\u5b9a\u3002\u56e0\u4e3a\u4f18\u5316\u5668\u63d0\u793a\u662f\u9488\u5bf9\u6bcf\u6761\u8bed\u53e5\u5e94\u7528\u7684\uff0c\u6240\u4ee5\u5b83\u4eec\u5bf9\u8bed\u53e5\u6267\u884c\u8ba1\u5212\u63d0\u4f9b\u4e86\u6bd4\u4f7f\u7528 optimizer_switch \u66f4\u7cbe\u7ec6\u7684\u63a7\u5236\u3002\u4f8b\u5982\uff0c\u53ef\u4ee5\u5bf9\u8bed\u53e5\u4e2d\u7684\u4e00\u4e2a\u8868\u542f\u7528\u4f18\u5316\uff0c\u800c\u5bf9\u53e6\u4e00\u4e2a\u8868\u7981\u7528\u4f18\u5316\u3002\u8bed\u53e5\u4e2d\u7684\u63d0\u793a\u4f18\u5148\u4e8e optimizer_switch \u6807\u5fd7\u3002</p>"},{"location":"foundmental/2.MySQL%E7%B4%A2%E5%BC%95/#optimizer-hints","title":"\u4f18\u5316\u5668\u63d0\u793a\uff08Optimizer Hints\uff09","text":"<p>Optimizer Hints (\u4e0b\u6587\u7b80\u79f0 Hints ) \u662f\u4e00\u5957\u5e72\u9884\u4f18\u5316\u5668\u7684\u5b9e\u7528\u673a\u5236\uff0c\u4e0d\u540c\u6570\u636e\u5e93\u5382\u5546\u90fd\u6709\u5404\u81ea\u7684\u5b9e\u73b0\u65b9\u5f0f\u3002</p> <p>Oracle \u53ef\u80fd\u662f\u5c06 Hints \u673a\u5236\u53d1\u6325\u5230\u6781\u81f4\u7684\u6570\u636e\u5e93\u5927\u5382\u3002\u800c\u5373\u4f7f\u50cf PostgreSQL \u8fd9\u6837\u62d2\u7edd hints \u7684\u5b66\u9662\u6d3e\u6570\u636e\u5e93\uff0c\u793e\u533a\u4e5f\u81ea\u53d1\u641e\u4e86\u4e2a pg_hint_plan \u63d2\u4ef6 \uff0c\u8ba9\u5927\u5bb6\u80fd\u591f\u5c3d\u5feb\u5730\u89e3\u51b3\u6267\u884c\u8ba1\u5212\u8d70\u9519\u7684\u95ee\u9898\u3002</p> <p>Hints \u7684\u5e72\u9884\u65b9\u5f0f\u662f\u5411\u4f18\u5316\u5668\u63d0\u4f9b\u73b0\u6210\u7684\u4f18\u5316\u51b3\u7b56\uff0c\u4ece\u800c\u7f29\u5c0f\u6267\u884c\u8ba1\u5212\u7684\u9009\u62e9\u8303\u56f4\u3002\u901a\u5e38\u5728\u4eba\u4e3a\u5e72\u9884\u4f18\u5316\u5668\u65f6\uff0c\u53ea\u9700\u8981\u5728\u5173\u952e\u51b3\u7b56\u70b9\u63d0\u4f9b\u5177\u4f53\u51b3\u7b56\uff0c\u5c31\u53ef\u4ee5\u89c4\u907f\u9519\u8bef\u7684\u6267\u884c\u8ba1\u5212\uff1b\u5f53\u7136\u4e5f\u53ef\u4ee5\u63d0\u4f9b\u6240\u6709\u51b3\u7b56\uff0c\u8fd9\u6837\u53ef\u4ee5\u4ea7\u751f\u786e\u5b9a\u7684\u6267\u884c\u8ba1\u5212\u3002</p> <p>\u63a7\u5236\u4f18\u5316\u5668\u7b56\u7565\u7684\u4e00\u79cd\u65b9\u6cd5\u662f\u8bbe\u7f6e<code>optimizer_switch</code>\u7cfb\u7edf\u53d8\u91cf\u3002\u5bf9\u8be5\u53d8\u91cf\u7684\u66f4\u6539\u5c06\u5f71\u54cd\u6240\u6709\u540e\u7eed\u67e5\u8be2\u7684\u6267\u884c;\u4e3a\u4e86\u5bf9\u4e0d\u540c\u7684\u67e5\u8be2\u4ea7\u751f\u4e0d\u540c\u7684\u5f71\u54cd\uff0c\u5fc5\u987b\u5728\u6bcf\u4e2a\u67e5\u8be2\u4e4b\u524d\u66f4\u6539<code>optimizer_switch</code>\u3002</p> <p>\u63a7\u5236\u4f18\u5316\u5668\u7684\u53e6\u4e00\u79cd\u65b9\u6cd5\u662f\u4f7f\u7528\u4f18\u5316\u5668\u63d0\u793a\uff0c\u8fd9\u4e9b\u63d0\u793a\u53ef\u4ee5\u5728\u5355\u72ec\u7684\u8bed\u53e5\u4e2d\u6307\u5b9a\u3002\u56e0\u4e3a\u4f18\u5316\u5668\u63d0\u793a\u662f\u9488\u5bf9\u6bcf\u6761\u8bed\u53e5\u5e94\u7528\u7684\uff0c\u6240\u4ee5\u5b83\u4eec\u5bf9\u8bed\u53e5\u6267\u884c\u8ba1\u5212\u63d0\u4f9b\u4e86\u6bd4\u4f7f\u7528<code>optimizer_switch</code>\u66f4\u7cbe\u7ec6\u7684\u63a7\u5236\u3002\u4f8b\u5982\uff0c\u53ef\u4ee5\u5bf9\u8bed\u53e5\u4e2d\u7684\u4e00\u4e2a\u8868\u542f\u7528\u4f18\u5316\uff0c\u800c\u5bf9\u53e6\u4e00\u4e2a\u8868\u7981\u7528\u4f18\u5316\u3002\u8bed\u53e5\u4e2d\u7684\u63d0\u793a\u4f18\u5148\u4e8e<code>optimizer_switch</code>\u6807\u5fd7\u3002</p> <p>\u4f18\u5316\u5668\u63d0\u793a\u5fc5\u987b\u5728<code>/+\u2026 /</code>\u6ce8\u91ca\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c\u4f18\u5316\u5668\u63d0\u793a\u4f7f\u7528<code>/\u2026/</code> c \u98ce\u683c\u7684\u6ce8\u91ca\u8bed\u6cd5\uff0c\u5728<code>/*</code>\u6ce8\u91ca\u5f00\u59cb\u5e8f\u5217\u540e\u9762\u6709\u4e00\u4e2a<code>+</code>\u5b57\u7b26\u3002</p>"},{"location":"foundmental/2.MySQL%E7%B4%A2%E5%BC%95/#_28","title":"\u5c3d\u91cf\u907f\u514d\u5168\u8868\u626b\u63cf","text":"<p>https://cloud.tencent.com/developer/article/1404687</p> <p>http://zhongmingmao.me/2019/03/08/mysql-full-table-scan/</p> <p>\u5728 expain \u67e5\u770b\u4e00\u4e2a SQL \u7684\u6267\u884c\u8ba1\u5212\u65f6\uff0c\u5982\u679c type \u5b57\u6bb5\u662f ALL \uff0c\u5219\u4f1a\u8fdb\u884c\u5168\u8868\u626b\u63cf\u3002</p> <p>SQL \u4f18\u5316\u7684\u4e00\u6761\u6700\u57fa\u672c\u7684\u539f\u5219\u5c31\u662f\uff0c\u5f53\u771f\u6b63\u51fa\u73b0\u6027\u80fd\u95ee\u9898\u65f6\u6216\u8005\u5f71\u54cd\u5230\u4e1a\u52a1\u65f6\uff0c\u624d\u8003\u8651\u4f18\u5316\u3002</p> <p>\u5168\u8868\u626b\u63cf\u7684\u60c5\u51b5\uff1a</p> <ul> <li>\u8868\u8db3\u591f\u5c0f\uff0c\u6570\u636e\u91cf\u8db3\u591f\u5c11\uff0c\u5168\u8868\u626b\u63cf\u7684\u901f\u5ea6\u751a\u81f3\u6bd4\u7d22\u5f15\u67e5\u627e\u8fd8\u8981\u5feb\u3002\u901a\u5e38\u662f 10 \u884c\u4e4b\u5185\u7684\u8868\u3002</li> <li>on \u8fde\u63a5\u7684\u5b57\u6bb5\uff0c\u6216\u8005 where \u6761\u4ef6\u7684\u5b57\u6bb5\u6ca1\u6709\u7d22\u5f15\u5217\uff0c\u6216\u8005\u6839\u672c\u4e0d\u5e26 where \u6761\u4ef6\u3002</li> </ul>"},{"location":"foundmental/2.MySQL%E7%B4%A2%E5%BC%95/#mysql_2","title":"MySQL \u4f18\u5316\u51c6\u5219","text":"<p>https://github.com/kekobin/blog/issues/87</p> <p>https://github.com/Snailclimb/JavaGuide/blob/main/docs/database/mysql/mysql-high-performance-optimization-specification-recommendations.md</p>"},{"location":"foundmental/2.MySQL%E7%B4%A2%E5%BC%95/#_29","title":"\u6027\u80fd\u4f18\u5316\u6982\u8ff0","text":"<p>\u6570\u636e\u5e93\u6027\u80fd\u4f18\u5316\u5728\u6570\u636e\u5e93\u5c42\u9762\u6709\u5f88\u591a\u56e0\u7d20\uff0c\u4f8b\u5982\uff0c\u8868\uff0c\u67e5\u8be2\u8bed\u53e5\uff0c\u6570\u636e\u5e93\u914d\u7f6e\u7b49\u3002</p> <p>\u6570\u636e\u5e93\u64cd\u4f5c\u6700\u7ec8\u662f\u4f5c\u7528\u5728\u786c\u4ef6\u5c42\u9762\u7684 CPU \u8ba1\u7b97\u548c\u78c1\u76d8\u7684 IO \u64cd\u4f5c\u4e0a\u3002\u6240\u4ee5\u8981\u5c3d\u53ef\u80fd\u8ba9\u5f00\u9500\u8db3\u591f\u5c0f\u3002</p> <p>\u6570\u636e\u5e93\u5c42\u9762\u7684\u4f18\u5316</p> <ul> <li> <p>\u8868\u7ed3\u6784\u8bbe\u8ba1\u662f\u5426\u5408\u7406\uff1f\u662f\u5426\u6ee1\u8db3\u4e09\u8303\u5f0f\uff1f\u8303\u5f0f\u548c\u53cd\u8303\u5f0f\u7684\u8bbe\u8ba1\uff1fhttps://www.zhihu.com/question/19900437</p> </li> <li> <p>oltp: \u4e8b\u52a1\u578b\uff0c\u8bfb\u591a\u5199\u5c11\uff0c\u5173\u8054\u67e5\u8be2\u6bd4\u8f83\u5c11\u7684\uff0c\u5c3d\u91cf\u9075\u5b88\u4e09\u8303\u5f0f\uff0c\u51cf\u5c11\u6570\u636e\u5197\u4f59\u3002</p> </li> <li> <p>olap\uff1a\u5206\u6790\u578b\uff0c\u5efa\u5bbd\u8868\uff0c\u589e\u5927\u5197\u4f59\uff0c\u51cf\u5c11\u5173\u8054\u67e5\u8be2\u3002</p> </li> <li> <p>\u5b57\u6bb5\u7684\u6570\u636e\u7c7b\u578b\u662f\u5426\u5408\u9002\uff1f</p> </li> <li> <p>\u7d22\u5f15\u8bbe\u8ba1\u662f\u5426\u5408\u7406\uff1f</p> </li> <li> <p>\u662f\u5426\u9009\u7528\u5408\u9002\u7684\u5b58\u50a8\u5f15\u64ce\uff1f</p> </li> <li> <p>\u8868\u662f\u5426\u6709\u6b63\u786e\u7684 row \u683c\u5f0f\uff1f</p> </li> </ul> <p>\u4f18\u5316\u7684\u51e0\u4e2a\u7b80\u5355\u539f\u5219\uff1a</p> <ol> <li>\u51cf\u5c11\u6570\u636e\u8bbf\u95ee\uff1a \u8bbe\u7f6e\u5408\u7406\u7684\u5b57\u6bb5\u7c7b\u578b\uff0c\u542f\u7528\u538b\u7f29\uff0c\u901a\u8fc7\u7d22\u5f15\u8bbf\u95ee\u7b49\u51cf\u5c11\u78c1\u76d8 IO</li> <li>\u8fd4\u56de\u66f4\u5c11\u7684\u6570\u636e\uff1a \u53ea\u8fd4\u56de\u9700\u8981\u7684\u5b57\u6bb5\u548c\u6570\u636e\u5206\u9875\u5904\u7406 \u51cf\u5c11\u78c1\u76d8 IO \u53ca\u7f51\u7edc IO</li> <li>\u51cf\u5c11\u4ea4\u4e92\u6b21\u6570\uff1a \u6279\u91cf DML \u64cd\u4f5c\uff0c\u51fd\u6570\u5b58\u50a8\u7b49\u51cf\u5c11\u6570\u636e\u8fde\u63a5\u6b21\u6570</li> <li>\u51cf\u5c11\u670d\u52a1\u5668 CPU \u5f00\u9500\uff1a \u5c3d\u91cf\u51cf\u5c11\u6570\u636e\u5e93\u6392\u5e8f\u64cd\u4f5c\u4ee5\u53ca\u5168\u8868\u67e5\u8be2\uff0c\u51cf\u5c11 cpu \u5185\u5b58\u5360\u7528</li> <li>\u5229\u7528\u66f4\u591a\u8d44\u6e90\uff1a \u4f7f\u7528\u8868\u5206\u533a\uff0c\u53ef\u4ee5\u589e\u52a0\u5e76\u884c\u64cd\u4f5c\uff0c\u66f4\u5927\u9650\u5ea6\u5229\u7528 cpu \u8d44\u6e90</li> </ol>"},{"location":"foundmental/2.MySQL%E7%B4%A2%E5%BC%95/#_30","title":"\u4f18\u5316\u5668\u548c\u67e5\u8be2\u6210\u672c","text":"<p>\u4e00\u822c\u6765\u8bf4\u4e00\u4e2a sql \u67e5\u8be2\u53ef\u4ee5\u6709\u4e0d\u540c\u7684\u6267\u884c\u65b9\u6848\uff0c\u53ef\u4ee5\u9009\u62e9\u8d70\u67d0\u4e2a\u7d22\u5f15\u8fdb\u884c\u67e5\u8be2\uff0c\u4e5f\u53ef\u4ee5\u9009\u62e9\u5168\u8868\u626b\u63cf\u3002</p> <p>**\u67e5\u8be2\u4f18\u5316\u5668**\u5219\u4f1a\u6bd4\u8f83\u5e76\u9009\u62e9\u5176\u4e2d\u6210\u672c\u6700\u4f4e\u7684\u65b9\u6848\u53bb\u6267\u884c\u67e5\u8be2\u3002</p> <p>\u67e5\u8be2\u6210\u672c\u5206\u5927\u4f53\u4e3a\u4e24\u79cd\uff1a</p> <ul> <li> <p>I/O \u6210\u672c\uff1a\u78c1\u76d8\u8bfb\u5199\u7684\u5f00\u9500\u3002\u4e00\u4e2a\u67e5\u8be2\u6216\u4e00\u4e2a\u5199\u5165\uff0c\u90fd\u8981\u4ece\u78c1\u76d8\u4e2d\u8bfb\u5199\u6570\u636e\uff0c\u8981\u4e00\u5b9a\u7684 IO \u5f00\u9500\u3002</p> </li> <li> <p>CPU \u6210\u672c\uff1a\u5173\u8054\u67e5\u8be2\uff0c\u6761\u4ef6\u67e5\u627e\uff0c\u90fd\u8981 CPU \u6765\u8fdb\u884c\u8ba1\u7b97\u5224\u65ad\uff0c\u4e00\u5b9a\u7684\u8ba1\u7b97\u5f00\u9500\u3002</p> </li> </ul> <p>MySQL \u4f7f\u7528\u7684 InnoDB \u5f15\u64ce\u4f1a\u628a\u6570\u636e\u548c\u7d22\u5f15\u90fd\u5b58\u50a8\u5230\u78c1\u76d8\u4e0a\uff0c\u5f53\u67e5\u8be2\u7684\u65f6\u5019\u9700\u8981\u5148\u628a\u6570\u636e\u5148\u52a0\u8f7d\u5230\u5185\u5b58\u4e2d\u5728\u8fdb\u884c\u4e0b\u4e00\u6b65\u64cd\u4f5c\uff0c\u8fd9\u4e2a\u52a0\u8f7d\u7684\u65f6\u95f4\u5c31\u662f I/O \u6210\u672c\u3002</p> <p>\u5f53\u6570\u636e\u88ab\u52a0\u8f7d\u5230\u5185\u5b58\u4e2d\u540e\uff0cCPU \u4f1a\u8ba1\u7b97\u67e5\u8be2\u6761\u4ef6\u5339\u914d\uff0c\u5bf9\u6570\u636e\u6392\u5e8f\u7b49\u7b49\u64cd\u4f5c\uff0c\u8fd9\u4e00\u6b65\u6240\u6d88\u8017\u7684\u65f6\u95f4\u5c31\u662f CPU \u6210\u672c\u3002</p> <p>\u4f46\u662f\u67e5\u8be2\u4f18\u5316\u5668\u5e76\u4e0d\u4f1a\u771f\u6b63\u7684\u53bb\u6267\u884c sql\uff0c\u53ea\u4f1a\u53bb\u6839\u636e\u4f18\u5316\u7684\u7ed3\u679c\u53bb\u9884\u4f30\u4e00\u4e2a\u6210\u672c\u3002</p> <p>InnoDB \u5f15\u64ce\u89c4\u5b9a\u8bfb\u53d6\u4e00\u4e2a\u9875\u9762\u82b1\u8d39\u7684\u6210\u672c\u9ed8\u8ba4\u7ea6\u662f 0.25\uff0c\u8bfb\u53d6\u4ee5\u53ca\u68c0\u6d4b\u4e00\u6761\u8bb0\u5f55\u662f\u5426\u7b26\u5408\u641c\u7d22\u6761\u4ef6\u7684\u6210\u672c\u9ed8\u8ba4\u7ea6\u662f 0.1\u3002</p> <p>\u4e3a\u4ec0\u4e48\u90fd\u662f\u7ea6\u5462\uff0c\u56e0\u4e3a MySQL \u5185\u90e8\u7684\u8ba1\u7b97\u6210\u672c\u6bd4\u8f83\u590d\u6742\u8fd9\u91cc\u63d0\u53d6\u4e86\u4e24\u4e2a\u4e3b\u8981\u7684\u8ba1\u7b97\u53c2\u6570\u3002</p> <pre><code>## MySQL server \u5c42\u9762\u7684\u5404\u79cd\u5f00\u9500\nmysql&gt; select * from mysql.server_cost;\n+------------------------------+------------+---------------------+---------+---------------+\n| cost_name                    | cost_value | last_update         | comment | default_value |\n+------------------------------+------------+---------------------+---------+---------------+\n| disk_temptable_create_cost   |       NULL | 2021-09-24 14:47:20 | NULL    |            20 |\n| disk_temptable_row_cost      |       NULL | 2021-09-24 14:47:20 | NULL    |           0.5 |\n| key_compare_cost             |       NULL | 2021-09-24 14:47:20 | NULL    |          0.05 |\n| memory_temptable_create_cost |       NULL | 2021-09-24 14:47:20 | NULL    |             1 |\n| memory_temptable_row_cost    |       NULL | 2021-09-24 14:47:20 | NULL    |           0.1 |\n| row_evaluate_cost            |       NULL | 2021-09-24 14:47:20 | NULL    |           0.1 |\n+------------------------------+------------+---------------------+---------+---------------+\n6 rows in set (0.00 sec)\n\nmysql&gt;\n\n## MySQL \u5b58\u50a8\u5f15\u64ce\u5c42\u9762\u7684\u5404\u79cd\u5f00\u9500\nmysql&gt; select * from mysql.engine_cost;\n+-------------+-------------+------------------------+------------+---------------------+---------+---------------+\n| engine_name | device_type | cost_name              | cost_value | last_update         | comment | default_value |\n+-------------+-------------+------------------------+------------+---------------------+---------+---------------+\n| default     |           0 | io_block_read_cost     |       NULL | 2021-09-24 14:47:20 | NULL    |             1 |\n| default     |           0 | memory_block_read_cost |       NULL | 2021-09-24 14:47:20 | NULL    |          0.25 |\n+-------------+-------------+------------------------+------------+---------------------+---------+---------------+\n2 rows in set (0.00 sec)\n\nmysql&gt;\n</code></pre>"},{"location":"foundmental/2.MySQL%E7%B4%A2%E5%BC%95/#_31","title":"\u57fa\u4e8e\u6210\u672c\u7684\u4f18\u5316","text":"<p>\u5728\u4e00\u6761\u5355\u8868\u67e5\u8be2\u8bed\u53e5\u771f\u6b63\u6267\u884c\u4e4b\u524d\uff0cMysql \u7684\u67e5\u8be2\u4f18\u5316\u5668\u4f1a\u627e\u51fa\u6267\u884c\u8be5\u8bed\u53e5\u6240\u6709\u53ef\u80fd\u4f7f\u7528\u7684\u65b9\u6848\uff0c\u5bf9\u6bd4\u4e4b\u540e\u627e\u51fa\u6210\u672c\u6700\u4f4e\u7684\u65b9\u6848\u3002</p> <p>\u8fd9\u4e2a\u6210\u672c\u6700\u4f4e\u7684\u65b9\u6848\u5c31\u662f\u6240\u8c13\u7684**\u6267\u884c\u8ba1\u5212**\uff0c\u4e4b\u540e\u624d\u4f1a\u8c03\u7528\u5b58\u50a8\u5f15\u64ce\u63d0\u4f9b\u7684\u63a5\u53e3\u771f\u6b63\u7684\u6267\u884c\u67e5\u8be2\u3002</p> <p>\u591a\u6570\u60c5\u51b5\u4e0b\uff0c\u4e00\u6761\u67e5\u8be2\u53ef\u4ee5\u6709\u5f88\u591a\u79cd\u6267\u884c\u65b9\u5f0f\uff0c\u6700\u540e\u90fd\u8fd4\u56de\u76f8\u5e94\u7684\u7ed3\u679c\u3002\u4f18\u5316\u5668\u7684\u4f5c\u7528\u5c31\u662f\u627e\u5230\u8fd9\u5176\u4e2d\u6700\u597d\u7684\u6267\u884c\u8ba1\u5212\u3002</p> <p>MySQL \u91c7\u7528\u4e86\u57fa\u4e8e\u5f00\u9500\u7684\u4f18\u5316\u5668\uff0c\u4ee5\u786e\u5b9a\u5904\u7406\u67e5\u8be2\u7684\u6700\u89e3\u65b9\u5f0f\uff0c\u4e5f\u5c31\u662f\u8bf4\u6267\u884c\u67e5\u8be2\u4e4b\u524d\uff0c\u90fd\u4f1a\u5148\u9009\u62e9\u4e00\u6761\u81ea\u8ba4\u4e3a\u6700\u4f18\u7684\u65b9\u6848\uff0c\u7136\u540e\u6267\u884c\u8fd9\u4e2a\u65b9\u6848\u6765\u83b7\u53d6\u7ed3\u679c\u3002</p> <p>\u5728\u5f88\u591a\u60c5\u51b5\u4e0b\uff0cMySQL \u80fd\u591f\u8ba1\u7b97\u6700\u4f73\u7684\u53ef\u80fd\u67e5\u8be2\u8ba1\u5212\uff0c\u4f46\u5728\u67d0\u4e9b\u60c5\u51b5\u4e0b\uff0cMySQL \u6ca1\u6709\u5173\u4e8e\u6570\u636e\u7684\u8db3\u591f\u4fe1\u606f\uff0c\u6216\u8005\u662f\u63d0\u4f9b\u592a\u591a\u7684\u76f8\u5173\u6570\u636e\u4fe1\u606f\uff0c\u4f30\u6d4b\u5c31\u4e0d\u90a3\u4e48\u53cb\u597d\u4e86\u3002</p> <p>\u5bf9\u4e8e\u4e00\u4e9b\u6267\u884c\u8d77\u6765\u5341\u5206\u8017\u8d39\u6027\u80fd\u7684\u8bed\u53e5\uff0cMySQL \u8fd8\u662f\u4f9d\u636e\u4e00\u4e9b\u89c4\u5219\uff0c\u7aed\u5c3d\u5168\u529b\u7684\u628a\u8fd9\u4e2a\u5f88\u7cdf\u7cd5\u7684\u8bed\u53e5\u8f6c\u6362\u6210\u67d0\u79cd\u53ef\u4ee5\u6bd4\u8f83\u9ad8\u6548\u6267\u884c\u7684\u5f62\u5f0f\uff0c\u8fd9\u4e2a\u8fc7\u7a0b\u4e5f\u53ef\u4ee5\u88ab\u79f0\u4f5c\u67e5\u8be2\u91cd\u5199\u3002</p> <p>MySQL \u4f7f\u7528\u57fa\u4e8e\u6210\u672c\u7684\u4f18\u5316\u5668\uff0c\u5b83\u5c1d\u8bd5\u9884\u6d4b\u4e00\u4e2a\u67e5\u8be2\u4f7f\u7528\u67d0\u79cd\u6267\u884c\u8ba1\u5212\u65f6\u7684\u6210\u672c\uff0c\u5e76\u9009\u62e9\u5176\u4e2d\u6210\u672c\u6700\u5c0f\u7684\u4e00\u4e2a\u3002</p> <p>\u5728 MySQL \u53ef\u4ee5\u901a\u8fc7\u67e5\u8be2\u5f53\u524d\u4f1a\u8bdd\u7684 last_query_cost \u7684\u503c\u6765\u5f97\u5230\u5176\u8ba1\u7b97\u5f53\u524d\u67e5\u8be2\u7684\u6210\u672c\u3002</p>"},{"location":"foundmental/2.MySQL%E7%B4%A2%E5%BC%95/#_32","title":"\u6570\u636e\u5e93\u5c42\u9762\u7684\u4f18\u5316","text":"<ul> <li>\u8868\u7ed3\u6784\u8bbe\u8ba1\u662f\u5426\u5408\u7406\uff1f\u662f\u5426\u6ee1\u8db3\u4e09\u8303\u5f0f\uff1f\u8303\u5f0f\u548c\u53cd\u8303\u5f0f\u7684\u8bbe\u8ba1\uff1fhttps://www.zhihu.com/question/19900437</li> <li>\u5b57\u6bb5\u7684\u6570\u636e\u7c7b\u578b\u662f\u5426\u5408\u9002\uff1f</li> <li>\u7ecf\u5e38\u66f4\u65b0\u7684\u5e94\u7528\u5e94\u8be5\u8bbe\u8ba1\u4e3a\u591a\u4e2a\u8868\uff0c\u5f88\u5c11\u5217\u3002\u6570\u636e\u5206\u6790\u7684\u5e94\u8be5\u8bbe\u8ba1\u4e3a\u5927\u5bbd\u8868\u3002</li> <li> <p>\u7d22\u5f15\u8bbe\u8ba1\u662f\u5426\u5408\u7406\uff1f</p> </li> <li> <p>\u662f\u5426\u9009\u7528\u5408\u9002\u7684\u5b58\u50a8\u5f15\u64ce\uff1f</p> </li> <li> <p>\u8868\u662f\u5426\u6709\u6b63\u786e\u7684 row \u683c\u5f0f\uff1f</p> </li> </ul>"},{"location":"foundmental/2.MySQL%E7%B4%A2%E5%BC%95/#_33","title":"\u987a\u5e8f\u7d22\u5f15","text":"<p>\u4e3a\u4e86\u5feb\u901f\u968f\u673a\u8bbf\u95ee\u6587\u4ef6\u4e2d\u7684\u8bb0\u5f55\uff0c\u53ef\u4ee5\u4f7f\u7528\u7d22\u5f15\u7ed3\u6784\uff0c\u6bcf\u4e2a\u7d22\u5f15\u7ed3\u6784\u4e0e\u4e00\u4e2a\u7279\u5b9a\u7684\u641c\u7d22\u7801\u5173\u8054\u3002</p> <p>\u88ab\u7d22\u5f15\u7684\u6587\u4ef6</p>"},{"location":"foundmental/2.MySQL%E7%B4%A2%E5%BC%95/#_34","title":"\u7d22\u5f15\u5931\u6548\u6216\u4e0d\u8d70\u7d22\u5f15\u7684\u539f\u56e0","text":"<p>\u65e0\u8bba\u662f\u9762\u8bd5\u6216\u662f\u65e5\u5e38\uff0cMySQL \u7d22\u5f15\u5931\u6548\u7684\u901a\u5e38\u60c5\u51b5\u90fd\u5e94\u8be5\u4e86\u89e3\u548c\u5b66\u4e60\u3002</p> <ul> <li>\u5bf9\u7d22\u5f15\u5217\u8fdb\u884c\u4e86\u8fd0\u7b97\u6216\u4f7f\u7528\u51fd\u6570\u8ba1\u7b97</li> </ul> <pre><code>-- \u7d22\u5f15\u5931\u6548\u539f\u56e0\uff1a\u7d22\u5f15\u662f\u9488\u5bf9\u539f\u503c\u5efa\u7684\u4e8c\u53c9\u6811\u7684\u6570\u636e\u7ed3\u6784\uff0c\u5c06\u5217\u503c\u8fdb\u884c\u4e86\u5404\u79cd\u8ba1\u7b97\u540e\uff0c\u53ef\u80fd\u4f1a\u7834\u574f\u7d22\u5f15\u503c\u7684\u6709\u5e8f\u6027\uff0c\u539f\u6765\u7684\u4e8c\u53c9\u6811\u5c31\u7528\u4e0d\u4e0a\u4e86\u3002\nSELECT * FROM t WHERE id*3 = 3000 ;\n\n-- \u81ea MySQL 8.0 \u5f00\u59cb\uff0c\u7d22\u5f15\u7279\u6027\u589e\u52a0\u4e86\u51fd\u6570\u7d22\u5f15\uff0c\u5373\u53ef\u4ee5\u9488\u5bf9\u51fd\u6570\u8ba1\u7b97\u540e\u7684\u503c\u5efa\u7acb\u4e00\u4e2a\u7d22\u5f15\uff0c\u4e5f\u5c31\u662f\u8bf4\u8be5\u7d22\u5f15\u7684\u503c\u662f\u51fd\u6570\u8ba1\u7b97\u540e\u7684\u503c\uff0c\u6240\u4ee5\u5c31\u53ef\u4ee5\u901a\u8fc7\u626b\u63cf\u7d22\u5f15\u6765\u67e5\u8be2\u6570\u636e\u3002\n-- \u901a\u8fc7\u4e0b\u9762\u8fd9\u6761\u8bed\u53e5\uff0c\u5bf9 length(name) \u7684\u8ba1\u7b97\u7ed3\u679c\u5efa\u7acb\u4e00\u4e2a\u540d\u4e3a idx_name_length \u7684\u7d22\u5f15\nALTER TABLE t_user ADD KEY idx_name_length ((LENGTH(name)));\n</code></pre> <ul> <li>\u53d1\u751f\u9690\u5f0f\u6570\u636e\u7c7b\u578b\u8f6c\u6362\uff08\u5f53\u64cd\u4f5c\u7b26\u5de6\u53f3\u4e24\u8fb9\u7684\u6570\u636e\u7c7b\u578b\u4e0d\u4e00\u81f4\u65f6\uff0c\u4f1a\u53d1\u751f\u9690\u5f0f\u8f6c\u6362\uff09</li> </ul> <pre><code>-- \u987e\u540d\u601d\u4e49\uff0c\u5f53\u4e24\u4e2a\u7c7b\u578b\u4e0d\u540c\u7684\u503c\u8fdb\u884c\u6bd4\u8f83\u65f6\uff0c\u9700\u8981\u8f6c\u6362\u6210\u76f8\u540c\u7c7b\u578b\u3002\u800c\u8fd9\u4e00\u64cd\u4f5c\u662fMySQL\u4f18\u5316\u5668\u6765\u505a\u7684\uff0c\u6240\u4ee5\u88ab\u79f0\u4e4b\u4e3a\u9690\u5f0f\u7c7b\u578b\u8f6c\u6362\u3002\n\n\n-- 1\u3001\u53d1\u751f\u7c7b\u578b\u8f6c\u6362\u65f6\uff0c\u7edd\u5927\u591a\u6570\u60c5\u51b5\u662f\u4ece\u5b57\u7b26\u4e32\u8f6c\u6362\u4e3a\u6570\u503c\uff0c\u800c\u4e0d\u662f\u4ece\u6570\u503c\u8f6c\u6362\u4e3a\u5b57\u7b26\u4e32\uff0c\uff08\u53ea\u6709\u6781\u5c11\u6570\u60c5\u51b5\u662f\u4ece\u6570\u503c\u8f6c\u6362\u4e3a\u5b57\u7b26\u4e32\uff0c\u4f8b\u5982\u4f7f\u7528 concat \u51fd\u6570\u5c06\u6570\u503c\u548c\u5b57\u7b26\u4e32\u62fc\u63a5\u6210\u4e00\u4e2a\u65b0\u7684\u5b57\u7b26\u4e32\u65f6\uff09\n\n-- 2\u3001\u5b57\u7b26\u4e32\u548c\u6570\u5b57\u6bd4\u8f83\uff0c\u5230\u5e95\u662f\u90fd\u8f6c\u6210\u5b57\u7b26\u4e32\u6bd4\u8f83\u8fd8\u662f\u8f6c\u6210\u6570\u5b57\u6bd4\u8f83\u5462\uff1f\u7b54\u6848\u662f\u5c06\u5b57\u7b26\u4e32\u8f6c\u6362\u6210\u6570\u5b57\u3002\n        -- \u5f53\u5b57\u7b26\u4e32\u8f6c\u6362\u4e3a\u6570\u503c\u65f6\uff0c\u5982\u679c\u5b57\u7b26\u4e32\u662f\u5408\u6cd5\u6570\u5b57\u5f00\u5934\u7684\uff0c\u4f1a\u5c1d\u8bd5\u5c06\u5b57\u7b26\u4e32\u8f6c\u6362\u4e3a\u6570\u503c\u7c7b\u578b\uff0c\u5982\u679c\u5b57\u7b26\u4e32\u662f\u5408\u6cd5\u6570\u5b57\u5f00\u5934\uff0c\u4f46\u6574\u4e2a\u5b57\u7b26\u4e32\u53c8\u4e0d\u662f\u5b8c\u5168\u5408\u6cd5\u7684\u6570\u5b57\uff0c\u5219\u53ea\u4f1a\u8f6c\u6362\u5b57\u7b26\u4e32\u5f00\u5934\u7684\u5408\u6cd5\u6570\u5b57\u90e8\u5206\u3002\n        -- \u5982\u679c\u5b57\u7b26\u4e32\u4e0d\u662f\u4ee5\u5408\u6cd5\u6570\u5b57\u5f00\u5934\uff0c\u90a3\u4e48\u8f6c\u6362\u7ed3\u679c\u4e3a 0\n\n-- \u7d22\u5f15\u4e8c\u53c9\u6811\uff0c\u901a\u5e38\u5b58\u50a8\u7684\u662f\u5217\u7684\u503c\uff0c\u8fd9\u4e9b\u503c\u662f\u6309\u7167\u7279\u5b9a\u7684\u6570\u636e\u7c7b\u578b\u5b58\u50a8\u7684\u3002\u4f8b\u5982\uff0c\u5982\u679c\u4e00\u4e2a\u5b57\u6bb5\u662fVARCHAR\u7c7b\u578b\uff0c\u7d22\u5f15\u4e2d\u5b58\u50a8\u7684\u5c31\u662f\u5b57\u7b26\u4e32\u3002\n-- \u7d22\u5f15\u4e8c\u53c9\u6811\u7684\u6709\u5e8f\u6027\uff08\u662f\u57fa\u4e8e\u5217\u7684\u539f\u503c\u6765\u6392\u5e8f\u7684\uff09\uff0c1\u548c'1'\u672c\u8d28\u4e0a\u4e0d\u662f\u4e00\u4e2a\u4e1c\u897f\u3002\u4f60\u7528\u6570\u5b571\u600e\u4e48\u53ef\u80fd\u641c\u7d22\u5230\u5bf9\u5e94\u7684'1'\n\n-- \u53d1\u751f\u6570\u636e\u7c7b\u578b\u8f6c\u6362\n--\n</code></pre> <p>\u5728 MySQL \u4e2d\uff0c\u5b57\u7b26\u4e32\u548c\u6570\u5b57\u505a\u6bd4\u8f83\u7684\u8bdd\uff0c</p> <ul> <li> <p>\u4e24\u4e2a\u8868\u7684\u7d22\u5f15\u5217\u7684\u5b57\u6bb5\u6570\u636e\u7c7b\u578b\u4e0d\u4e00\u81f4</p> </li> <li> <p>\u7d22\u5f15\u5217\u5b57\u6bb5\u548c\u5e38\u91cf\u6bd4\u8f83\u65f6\uff0c\u6570\u636e\u7c7b\u578b\u4e0d\u4e00\u81f4\u3002</p> </li> <li> <p>\u5b57\u7b26\u96c6\u4e0d\u4e00\u81f4</p> </li> </ul> <p>\u8981\u6bd4\u8f83\u7684\u5b57\u6bb5\u5b57\u7b26\u96c6\u4e0d\u4e00\u81f4</p> <p>-</p>"},{"location":"foundmental/2.MySQL%E7%B4%A2%E5%BC%95/#_35","title":"\u70b9\u67e5\u4f18\u5316","text":"<p>\u70b9\u67e5\u662f\u5e94\u7528\u8bbf\u95ee OLTP \u6570\u636e\u5e93\u7684\u4e00\u79cd\u5e38\u89c1\u65b9\u5f0f\uff0c\u7279\u70b9\u662f\u8fd4\u56de\u7ed3\u679c\u524d\u53ea\u626b\u63cf\u8868\u4e2d\u7684\u5c11\u91cf\u6570\u636e\uff0c\u5728\u6dd8\u5b9d\u4e0a\u67e5\u770b\u8ba2\u5355\u6216\u8005\u5546\u54c1\u4fe1\u606f\u5bf9\u5e94\u5230\u6570\u636e\u5e93\u4e0a\u7684\u64cd\u4f5c\u5c31\u662f\u70b9\u67e5\u3002</p> <p>\u987e\u540d\u601d\u4e49\uff0c\u70b9\u67e5\u662f\u53ea\u626b\u63cf\u5c11\u91cf\u6570\u636e\u7684\u67e5\u8be2\u3002\u6ce8\u610f\u8fd9\u91cc\u8bf4\u7684\u662f**\u626b\u63cf\u5c11\u91cf\u6570\u636e**\u800c\u4e0d\u662f**\u8fd4\u56de\u5c11\u91cf\u6570\u636e**\uff0c\u6bd4\u5982<code>SELECT * FROM t1 ORDER BY c1 LIMIT 1</code>\u867d\u7136\u53ea\u8fd4\u56de\u4e86\u4e00\u6761\u6570\u636e\uff0c\u4f46\u5982\u679c c1 \u4e0a\u6ca1\u6709\u7d22\u5f15\uff0c\u9700\u8981\u5148\u626b\u63cf t1 \u4e0a\u6240\u6709\u6570\u636e\u6392\u5e8f\u540e\u624d\u80fd\u8fd4\u56de\u7ed3\u679c\uff0c\u4e0d\u7b26\u5408\u70b9\u67e5\u7684\u5b9a\u4e49\u3002</p> <p>\u5355\u673a\u6570\u636e\u5e93\u4e2d\uff0c\u6700\u5e38\u89c1\u7684\u70b9\u67e5\u662f\u6309\u7167\u4e3b\u952e\uff08Primary Key\uff0cPK\uff09\u67e5\u8be2\u6570\u636e\uff0c\u901a\u8fc7\u626b\u63cf\u4e3b\u952e\u7d22\u5f15\u5feb\u901f\u5f97\u5230\u7ed3\u679c\uff0c\u5e73\u5747\u53ea\u9700\u8981\u626b\u63cf log(n)\uff08n \u4e3a\u6574\u5f20\u8868\u7684\u884c\u6570\uff09\u6761\u8bb0\u5f55\u3002\u5982\u679c\u901a\u8fc7\u5176\u4ed6\u6761\u4ef6\u67e5\u8be2\uff0c\u53ef\u4ee5\u589e\u52a0\u5c40\u90e8\u4e8c\u7ea7\u7d22\u5f15\uff08Local Secondary Index\uff0cLSI\uff09\uff0c\u9996\u5148\u626b\u63cf\u5c40\u90e8\u4e8c\u7ea7\u7d22\u5f15\u5f97\u5230\u4e3b\u952e\uff0c\u7136\u540e\u56de\u8868\u67e5\u51fa\u5b8c\u6574\u8bb0\u5f55\u3002\u7279\u6b8a\u573a\u666f\u4e0b\uff0c\u5982\u679c\u5c40\u90e8\u4e8c\u7ea7\u7d22\u5f15\u4e2d\u5305\u542b\u4e86\u67e5\u8be2\u6d89\u53ca\u7684\u6240\u6709\u5217\uff0c\u5219\u56de\u8868\u7684\u6b65\u9aa4\u4e5f\u53ef\u4ee5\u7701\u7565\u3002</p>"},{"location":"foundmental/2.MySQL%E7%B4%A2%E5%BC%95/#mysql_3","title":"MySQL \u591a\u8868\u8fde\u63a5","text":"<p>\u9a71\u52a8\u8868\u7684\u6982\u5ff5\u662f\u6307\u591a\u8868\u5173\u8054\u67e5\u8be2\u65f6\uff0c\u7b2c\u4e00\u4e2a\u88ab\u5904\u7406\u7684\u8868\uff0c\u4f7f\u7528\u6b64\u8868\u7684\u8bb0\u5f55\u53bb\u5173\u8054\u5176\u4ed6\u8868\u3002</p> <p>\u9a71\u52a8\u8868\u7684\u786e\u5b9a\u5f88\u5173\u952e\uff0c\u4f1a\u76f4\u63a5\u5f71\u54cd\u591a\u8868\u8fde\u63a5\u7684\u5173\u8054\u987a\u5e8f\uff0c\u4e5f\u51b3\u5b9a\u4e86\u540e\u7eed\u5173\u8054\u65f6\u7684\u67e5\u8be2\u6027\u80fd\u3002</p> <ul> <li>\u9a71\u52a8\u8868/\u4e3b\u8868/\u524d\u8868</li> <li>\u88ab\u9a71\u52a8\u8868/\u526f\u8868/\u540e\u8868</li> </ul> <p>\u9a71\u52a8\u8868\u7684\u9009\u62e9\u9075\u5faa\u4e00\u4e2a\u539f\u5219\uff1a<code>\u5728\u5bf9\u6700\u7ec8\u7ed3\u679c\u96c6\u6ca1\u5f71\u54cd\u7684\u524d\u63d0\u4e0b\uff0c\u4f18\u5148\u9009\u62e9\u7ed3\u679c\u96c6\u6700\u5c0f\u7684\u90a3\u5f20\u8868\u4f5c\u4e3a\u9a71\u52a8\u8868</code>\u3002</p> <p>\u6539\u53d8\u9a71\u52a8\u8868\u5c31\u610f\u5473\u7740\u6539\u53d8\u8fde\u63a5\u987a\u5e8f\uff0c\u53ea\u6709\u5728\u4e0d\u4f1a\u6539\u53d8\u6700\u7ec8\u8f93\u51fa\u7ed3\u679c\u7684\u524d\u63d0\u4e0b\u624d\u53ef\u4ee5\u5bf9\u9a71\u52a8\u8868\u505a\u4f18\u5316\u9009\u62e9\u3002</p> <p>https://blog.csdn.net/lkforce/article/details/102940091</p>"},{"location":"foundmental/2.MySQL%E7%B4%A2%E5%BC%95/#_36","title":"\u8fde\u63a5\u67e5\u8be2","text":"<p>\u5199\u8fc7\u6216\u8005\u5b66\u8fc7 SQL \u7684\u4eba\u5e94\u8be5\u90fd\u77e5\u9053 left join\uff0c\u77e5\u9053 left join \u7684\u5b9e\u73b0\u7684\u6548\u679c\uff0c\u5c31\u662f\u4fdd\u7559\u5de6\u8868\u7684\u5168\u90e8\u4fe1\u606f\uff0c\u7136\u540e\u628a\u53f3\u8868\u5f80\u5de6\u8868\u4e0a\u62fc\u63a5\uff0c\u5982\u679c\u62fc\u4e0d\u4e0a\u5c31\u662f null\u3002</p> <p>\u9664\u4e86 left join \u4ee5\u5916\uff0c\u8fd8\u6709 inner join\u3001outer join\u3001right join\uff0c\u8fd9\u4e9b\u4e0d\u540c\u7684 join \u80fd\u8fbe\u5230\u7684\u4ec0\u4e48\u6837\u7684\u6548\u679c\uff0c\u5927\u5bb6\u5e94\u8be5\u90fd\u4e86\u89e3\u4e86\u3002</p> <p>\u9a71\u52a8\u8868\u7684\u9009\u62e9\u539f\u5219</p> <p>MySQL \u4f1a\u5982\u4f55\u9009\u62e9\u9a71\u52a8\u8868\uff0c\u6309\u4ece\u5de6\u81f3\u53f3\u7684\u987a\u5e8f\u9009\u62e9\u7b2c\u4e00\u4e2a\uff1f</p> <p>\u591a\u8868\u8fde\u63a5\u7684\u987a\u5e8f\uff1f</p> <p>\u5047\u8bbe\u6211\u4eec\u6709 3 \u5f20\u8868\uff1aA\u3001B\u3001C\uff0c\u548c\u5982\u4e0b SQL</p> <pre><code>-- \u4f2a SQL\uff0c\u4e0d\u80fd\u76f4\u63a5\u6267\u884c\nA LEFT JOIN B ON B.aId = A.id  LEFT JOIN C ON C.aId = A.id\nWHERE A.name = '666' AND B.state = 1 AND C.create_time &gt; '2019-11-22 12:12:30'\n</code></pre> <p>\u662f A \u548c B \u8054\u8868\u5904\u7406\u5b8c\u4e4b\u540e\u7684\u7ed3\u679c\u518d\u548c C \u8fdb\u884c\u8054\u8868\u5904\u7406\uff0c\u8fd8\u662f A\u3001B\u3001C \u4e00\u8d77\u8054\u8868\u4e4b\u540e\u518d\u8fdb\u884c\u8fc7\u6ee4\u5904\u7406 \uff0c\u8fd8\u662f\u8bf4\u8fd9\u4e24\u79cd\u90fd\u4e0d\u5bf9\uff0c\u6709\u5176\u4ed6\u7684\u5904\u7406\u65b9\u5f0f \uff1f</p> <p>join \u4e3b\u8981\u6709 Nested Loop\u3001Hash Join\u3001Merge Join \u8fd9\u4e09\u79cd\u7b97\u6cd5\u65b9\u5f0f\uff0c\u6700\u666e\u904d\u6700\u597d\u7684\u7406\u89e3\u7684 Nested Loop join \u3002</p> <p>\u987e\u540d\u601d\u4e49\u5c31\u662f\u5d4c\u5957\u5faa\u73af\u8fde\u63a5\u3002</p> <p>\u4f46\u662f\u6839\u636e\u573a\u666f\u4e0d\u540c\u53ef\u80fd\u6709\u4e0d\u540c\u7684\u53d8\u79cd\uff1a</p> <ul> <li>Simple Nested-Loop join</li> <li>Index Nested-Loop join</li> <li>Block Nested-Loop join</li> <li>Betched Key Access join</li> </ul> <p>Nested Loop join \u7ffb\u8bd1\u8fc7\u6765\u5c31\u662f**\u5d4c\u5957\u5faa\u73af\u8fde\u63a5**\u7684\u610f\u601d\uff0c\u90a3\u4ec0\u4e48\u53c8\u662f\u5d4c\u5957\u5faa\u73af\u5462\uff1f</p> <p>\u5d4c\u5957\u5927\u5bb6\u5e94\u8be5\u90fd\u80fd\u7406\u89e3\uff0c\u5c31\u662f\u4e00\u5c42\u5957\u4e00\u5c42\uff1b\u90a3\u5faa\u73af\u5462\uff0c\u4f60\u53ef\u4ee5\u7406\u89e3\u6210\u662f for \u5faa\u73af\u3002</p> <p>\u5728\u6b63\u5f0f\u5f00\u59cb\u4e4b\u524d\uff0c\u5148\u4ecb\u7ecd\u4e24\u4e2a\u6982\u5ff5\uff1a</p> <ul> <li>\u9a71\u52a8\u8868\uff08\u4e5f\u53eb\u4e3b\u8868\uff09\uff1a</li> </ul> <p>\u5c0f\u8868\u9a71\u52a8\u5927\u8868\u3002</p> <p>\u6211\u4eec\u5e38\u8bf4\uff0c\u5c0f\u8868\u9a71\u52a8\u5927\u8868\uff0c\u9a71\u52a8\u8868\u4e00\u5b9a\u662f\u5c0f\u8868\u5417\uff1f\u5176\u5b9e\u66f4\u7cbe\u51c6\u4e00\u70b9\u662f\u6307\u7684\u662f\u6839\u636e\u6761\u4ef6\u83b7\u5f97\u7684\u5b50\u96c6\u5408\u4e00\u5b9a\u8981\u5c0f\uff0c\u800c\u4e0d\u662f\u8bf4\u5b9e\u4f53\u8868\u672c\u8eab\u4e00\u5b9a\u8981\u5c0f\uff0c\u5927\u8868\u5982\u679c\u83b7\u5f97\u7684\u5b50\u96c6\u5408\u5c0f\uff0c\u4e00\u6837\u53ef\u4ee5\u7b80\u79f0\u8fd9\u4e2a\u5927\u8868\u4e3a\u9a71\u52a8\u8868\u3002 \uff0c\u6700\u597d\u9009\u62e9\u4e0e\u5176\u4ed6\u8868\u7684\u4e3b\u952e\u5b57\u6bb5\u8fdb\u884c\u6bd4\u8f83\uff0c\u6216\u8005\u4e0e\u5df2\u7ecf\u7d22\u5f15\u7684\u5b57\u6bb5\u8fdb\u884c\u6bd4\u8f83\uff0c\u8fd9\u6837\u4e00\u6765\uff0c\u5c31\u6709\u610f\u8bc6\u5730\u5c06\u4e1a\u52a1\u9700\u6c42\u7684\u4e3b\u8868</p> <p>\u548c\u88ab\u9a71\u52a8\u8868\uff08\u4e5f\u53eb\u975e\u9a71\u52a8\u8868\uff0c\u8fd8\u53ef\u4ee5\u53eb\u5339\u914d\u8868\uff0c\u4ea6\u53ef\u53eb\u5185\u8868\uff09\uff0c\u7b80\u5355\u6765\u8bf4\uff0c\u9a71\u52a8\u8868\u5c31\u662f\u4e3b\u8868\uff0cleft join \u4e2d\u7684\u5de6\u8868\u5c31\u662f\u9a71\u52a8\u8868\uff0cright join \u4e2d\u7684\u53f3\u8868\u662f\u9a71\u52a8\u8868\u3002</p> <p>\u4e00\u4e2a\u662f\u9a71\u52a8\u8868\uff0c\u90a3\u53e6\u4e00\u4e2a\u5c31\u53ea\u80fd\u662f\u975e\u9a71\u52a8\u8868\u4e86\uff0c\u5728 join \u7684\u8fc7\u7a0b\u4e2d\uff0c\u5176\u5b9e\u5c31\u662f\u4ece\u9a71\u52a8\u8868\u91cc\u9762\u4f9d\u6b21\uff08\u6ce8\u610f\u7406\u89e3\u8fd9\u91cc\u9762\u7684\u4f9d\u6b21\uff09\u53d6\u51fa\u6bcf\u4e00\u4e2a\u503c\uff0c\u7136\u540e\u53bb\u975e\u9a71\u52a8\u8868\u91cc\u9762\u8fdb\u884c\u5339\u914d\uff0c\u90a3\u5177\u4f53\u662f\u600e\u4e48\u5339\u914d\u7684\u5462\uff1f\u8fd9\u5c31\u662f\u6211\u4eec\u63a5\u4e0b\u6765\u8bb2\u7684\u8fd9\u4e09\u79cd\u8fde\u63a5\u65b9\u5f0f\u3002</p>"},{"location":"foundmental/2.MySQL%E7%B4%A2%E5%BC%95/#simple-nested-loop-join","title":"Simple Nested-Loop Join","text":"<p>Simple Nested-Loop Join \u662f\u8fd9\u4e09\u79cd\u65b9\u6cd5\u91cc\u9762\u6700\u7b80\u5355\uff0c\u6700\u597d\u7406\u89e3\uff0c\u4e5f\u662f\u6700\u7b26\u5408\u5927\u5bb6\u8ba4\u77e5\u7684\u4e00\u79cd\u8fde\u63a5\u65b9\u5f0f\u3002</p> <p>\u73b0\u5728\u6709\u4e24\u5f20\u8868 table A \u548c table B\uff0c\u6211\u4eec\u8ba9 table A left join table B\uff0c\u5982\u679c\u662f\u7528\u7b2c\u4e00\u79cd\u8fde\u63a5\u65b9\u5f0f\u53bb\u5b9e\u73b0\u7684\u8bdd\uff0c\u4f1a\u662f\u600e\u4e48\u53bb\u5339\u914d\u7684\u5462\uff1f\u76f4\u63a5\u4e0a\u56fe\uff1a</p> <p></p> <ul> <li>\u4e0a\u9762\u7684 left join \u4f1a\u4ece**\u9a71\u52a8\u8868 table A** \u4e2d**\u9010\u884c\u53d6\u51fa\u6bcf\u4e00\u4e2a\u503c**\u3002\uff08\u5728\u5916\u5c42\u5faa\u73af\u4e2d\uff09</li> <li> <p>\u7136\u540e\u53bb**\u975e\u9a71\u52a8\u8868 table B** \u4e2d\u4ece**\u4e0a\u5f80\u4e0b\u4f9d\u6b21\u5339\u914d**\u3002\uff08\u5728\u5185\u5b58\u5faa\u73af\u4e2d\uff09</p> </li> <li> <p>\u7136\u540e\u628a\u5339\u914d\u5230\u7684\u503c\u8fdb\u884c\u8fd4\u56de\uff0c\u6700\u540e\u628a\u6240\u6709\u8fd4\u56de\u503c\u8fdb\u884c\u5408\u5e76\uff0c\u8fd9\u6837\u6211\u4eec\u5c31\u67e5\u627e\u5230\u4e86 table A left join table B \u7684\u7ed3\u679c\u3002</p> </li> </ul> <p>\u5229\u7528\u8fd9\u79cd\u65b9\u6cd5\uff0c\u5982\u679c table A \u6709 100 \u884c\uff0ctable B \u6709 100 \u884c\uff0c\u603b\u5171\u9700\u8981\u6267\u884c 10 x 10 = 100 \u6b21\u5faa\u73af\u3002</p> <p>\u5d4c\u5957\u5faa\u73af\u8fde\u63a5 join\uff08Nested-Loop Join Algorithms\uff09\uff1a\u662f\u6bcf\u6b21\u5339\u914d 1 \u884c\uff0c\u5339\u914d\u901f\u5ea6\u8f83\u6162\uff0c\u9700\u8981\u7684\u5185\u5b58\u8f83\u5c11\u3002</p> <pre><code>//\u4f2a\u4ee3\u7801\u8868\u793a\nList&lt;Row&gt; result = new ArrayList&lt;&gt;();\nfor(Row r1 in List&lt;Row&gt; t1){\n    for(Row r2 in List&lt;Row&gt; t2){\n        if(r1.id = r2.tid){\n            result.add(r1.join(r2));\n        }\n    }\n}\n\n// \u5f88\u591a\u4eba\u8bf4\n</code></pre> <pre><code>-- \u5728\u5b9e\u9645 inner join \u4e2d\uff0c\u6570\u636e\u5e93\u5f15\u64ce\u4f1a\u81ea\u52a8\u9009\u53d6\u6570\u91cf\u5c0f\u7684\u8868\u505a\u4e3a\u9a71\u52a8\u8868\n-- \u9a71\u52a8\u8868\u662f t2\uff0c\u88ab\u9a71\u52a8\u8868\u662f t1\u3002\u5148\u6267\u884c\u67e5\u627e\u7684\u5c31\u662f\u9a71\u52a8\u8868(\u6267\u884c\u8ba1\u5212\u7ed3\u679c\u7684id\u5982\u679c\u4e00\u6837\u5219\u6309\u4ece\u4e0a\u5230\u4e0b\u987a\u5e8f\u6267\u884csql);\u4f18\u5316\u5668\u4e00\u822c\u4f1a\u4f18\u5148\u9009\u62e9\u5c0f\u8868\u505a\u9a71\u52a8\u8868\u3002\n-- \u6240\u4ee5\u4f7f\u7528 inner join \u65f6\uff0c\u6392\u5728\u524d\u9762\u7684\u8868\u5e76\u4e0d\u4e00\u5b9a\u5c31\u662f\u9a71\u52a8\u8868\u3002\n-- \u5f53\u4f7f\u7528join\u65f6\uff0cmysql\u4f1a\u9009\u62e9\u6570\u636e\u91cf\u6bd4\u8f83\u5c0f\u7684\u8868\u4f5c\u4e3a\u9a71\u52a8\u8868\uff0c\u5927\u8868\u4f5c\u4e3a\u88ab\u9a71\u52a8\u8868\u3002\n\n-- \u5f53\u4f7f\u7528left join\u65f6\uff0c\u5de6\u8868\u662f\u9a71\u52a8\u8868\uff0c\u53f3\u8868\u662f\u88ab\u9a71\u52a8\u8868\uff0c\u5f53\u4f7f\u7528right join\u65f6\uff0c\u53f3\u8868\u65f6\u9a71\u52a8\u8868\uff0c\u5de6\u8868\u662f\u88ab\u9a71\u52a8\u8868\u3002\n\n-- \u4f7f\u7528\u4e86 NLJ\u7b97\u6cd5\u3002\u4e00\u822c join \u8bed\u53e5\u4e2d\uff0c\u5982\u679c\u6267\u884c\u8ba1\u5212 Extra \u4e2d\u672a\u51fa\u73b0 Using join buffer \u5219\u8868\u793a\u4f7f\u7528\u7684 join \u7b97 \u6cd5\u662fNLJ\nselect * from t1 inner join t2 on t1.id=t2.tid\n\n-- \u4ece\u8868 t2 \u4e2d\u8bfb\u53d6\u4e00\u884c\u6570\u636e(\u5982\u679ct2\u8868\u6709\u67e5\u8be2\u8fc7\u6ee4\u6761\u4ef6\u7684\uff0c\u4f1a\u4ece\u8fc7\u6ee4\u7ed3\u679c\u91cc\u53d6\u51fa\u4e00\u884c\u6570\u636e);\n</code></pre> <p>\u8fd9\u79cd\u66b4\u529b\u5339\u914d\u7684\u65b9\u5f0f\u5728\u6570\u636e\u5e93\u4e2d\u4e00\u822c\u4e0d\u4f7f\u7528\u3002</p> <p>\u4e3e\u4e2a\u4f8b\u5b50\uff1a</p> <p>select * from t1 inner join t2 on t1.id=t2.tid</p> <p>\uff081\uff09t1 \u79f0\u4e3a\u5916\u5c42\u8868\uff0c\u4e5f\u53ef\u79f0\u4e3a\u9a71\u52a8\u8868\u3002 \uff082\uff09t2 \u79f0\u4e3a\u5185\u5c42\u8868\uff0c\u4e5f\u53ef\u79f0\u4e3a\u88ab\u9a71\u52a8\u8868\u3002</p> <pre><code>//\u4f2a\u4ee3\u7801\u8868\u793a\uff1a\nList&lt;Row&gt; result = new ArrayList&lt;&gt;();\nfor(Row r1 in List&lt;Row&gt; t1){\n    for(Row r2 in List&lt;Row&gt; t2){\n        if(r1.id = r2.tid){\n            result.add(r1.join(r2));\n        }\n    }\n}\n</code></pre> <pre><code># \u5bf9\u4e8et1,t2,t3\u8fd9\u6837\u4e09\u4e2a\u8868\uff0ct1\u8303\u56f4\u67e5\u627e\uff0ct2\u7d22\u5f15\u67e5\u627e\uff0ct3\u5168\u626b\u63cf\n\n\nTable   Join Type\nt1      range\nt2      ref\nt3      ALL\n\n\nfor each row in t1 matching range {\n  for each row in t2 matching reference key {\n    for each row in t3 {\n      if row satisfies join conditions, send to client\n    }\n  }\n}\n\n\n# \u56e0\u4e3aNLJ\u7b97\u6cd5\u662f\u901a\u8fc7\u5916\u5faa\u73af\u7684\u884c\u53bb\u5339\u914d\u5185\u5faa\u73af\u7684\u884c\uff0c\u6240\u4ee5\u5185\u5faa\u73af\u7684\u8868\u4f1a\u88ab\u626b\u63cf\u591a\u6b21\u3002\n</code></pre> <p>https://blog.csdn.net/weixin_44663675/article/details/112190762</p>"},{"location":"foundmental/2.MySQL%E7%B4%A2%E5%BC%95/#block-nested-loop-join-algorithm","title":"Block Nested-Loop Join Algorithm","text":"<p>https://dev.mysql.com/doc/refman/8.0/en/nested-loop-joins.html</p> <p>https://dev.mysql.com/doc/refman/8.0/en/server-system-variables.html#sysvar_join_buffer_size</p> <p>\u524d\u9762\u7684\u7b97\u6cd5\uff0c \u9010\u884c\u67e5\u627e\uff0c\u6bcf\u6b21\u78c1\u76d8 IO \u90fd\u8bfb\u5f88\u5c11\u6570\u636e\uff0c\u81ea\u7136\u6548\u7387\u5f88\u4f4e\u3002</p> <p>\u5757\u5d4c\u5957\u5faa\u73af\u8054\u63a5\uff08BNL\uff09\u7b97\u6cd5\uff0c\u5c06\u5916\u5faa\u73af\u7684\u884c\u7f13\u5b58\u8d77\u6765\uff0c\u8bfb\u53d6\u7f13\u5b58\u4e2d\u7684\u884c\uff0c\u51cf\u5c11\u5185\u5faa\u73af\u7684\u8868\u88ab\u626b\u63cf\u7684\u6b21\u6570\u3002</p> <p>\u4f8b\u5982\uff0c\u5982\u679c 10 \u884c\u8bfb\u5165\u7f13\u51b2\u533a\u5e76\u4e14\u7f13\u51b2\u533a\u4f20\u9012\u7ed9\u4e0b\u4e00\u4e2a\u5185\u5faa\u73af\uff0c\u5728\u5185\u5faa\u73af\u8bfb\u5230\u7684\u6bcf\u884c\u53ef\u4ee5\u548c\u7f13\u51b2\u533a\u7684 10 \u884c\u505a\u6bd4\u8f83\u3002</p> <p>\u8fd9\u6837\u4f7f\u5185\u5faa\u73af\u8868\u88ab\u626b\u63cf\u7684\u6b21\u6570\u51cf\u5c11\u4e86\u4e00\u4e2a\u6570\u91cf\u7ea7\u3002</p> <p>\u5728 MySQL 8.0.18 \u4e4b\u524d\uff0c\u5982\u679c\u8fde\u63a5\u5b57\u6bb5\u6ca1\u6709\u7d22\u5f15\uff0cMySQL \u9ed8\u8ba4\u4f1a\u4f7f\u7528\u8fd9\u4e2a\u7b97\u6cd5\u3002</p> <p>\u5728 MySQL 8.0.18 \u4e4b\u540e\u3002</p> <p>MySQL \u4f7f\u7528\u8054\u63a5\u7f13\u51b2\u533a\u65f6\uff0c\u4f1a\u9075\u5faa\u4e0b\u9762\u8fd9\u4e9b\u539f\u5219\uff1a</p> <ul> <li>join_buffer_size \u7cfb\u7edf\u53d8\u91cf\u7684\u503c\u51b3\u5b9a\u4e86\u6bcf\u4e2a join_buffer \u7684\u5927\u5c0f\u3002</li> <li>\u8054\u63a5\u7c7b\u578b\u4e3a ALL\u3001index\u3001range \u65f6\uff08\u6362\u53e5\u8bdd\u8bf4\uff0c\u8054\u63a5\u7684\u8fc7\u7a0b\u4f1a\u626b\u63cf\u7d22\u5f15\u6216\u5168\u8868\u626b\u63cf\u65f6\uff09\uff0cMySQL \u4f1a\u4f7f\u7528 join_buffer \u3002</li> <li>join_buffer \u662f\u5206\u914d\u7ed9\u6bcf\u4e00\u4e2a\u80fd\u88ab\u7f13\u51b2\u7684 join\uff0c\u6240\u4ee5\u4e00\u4e2a\u67e5\u8be2\u53ef\u80fd\u4f1a\u4f7f\u7528\u591a\u4e2a join_buffer \u3002</li> <li>\u4f7f\u7528\u5230\u7684\u5217\u624d\u4f1a\u653e\u5230 join_buffer \u4e2d\uff0c\u5e76\u4e0d\u662f\u6bcf\u4e00\u4e2a\u6574\u884c\u6570\u636e\u3002</li> <li>\u7f13\u51b2\u533a\u662f\u5206\u914d\u7ed9\u6bcf\u4e00\u4e2a\u80fd\u88ab\u7f13\u51b2\u7684\u8054\u63a5\uff0c\u6240\u4ee5\u4e00\u4e2a\u67e5\u8be2\u53ef\u80fd\u4f1a\u4f7f\u7528\u591a\u4e2a\u8054\u63a5\u7f13\u51b2\u533a\u3002</li> </ul> <p>\u6ce8\u610f</p> <pre><code>-- \u6ce8\u610f \u5728 MySQL \u4e2d\uff0c CROSS JOIN  \u7b49\u4ef7\u4e8e  INNER JOIN \uff0c \u8fd9\u4e24\u4e2a\u53ef\u4ee5\u4e92\u6362\u4f7f\u7528\u3002\n-- \u4f46\u662f\u5728\u6807\u51c6SQL\u4e2d\uff0c\u8fd9\u4e24\u4e2a\u5e76\u4e0d\u4e00\u6837\u3002\n\nSELECT * FROM t1 LEFT JOIN (t2, t3, t4)  ON (t2.a=t1.a AND t3.b=t1.b AND t4.c=t1.c)\n\nSELECT * FROM t1 LEFT JOIN (t2 CROSS JOIN t3 CROSS JOIN t4)  ON (t2.a=t1.a AND t3.b=t1.b AND t4.c=t1.c)\n</code></pre>"},{"location":"foundmental/2.MySQL%E7%B4%A2%E5%BC%95/#index-nested-loop-join","title":"Index Nested-Loop Join","text":"<p>Index Nested-Loop Join \u7ffb\u8bd1\u6210\u4e2d\u6587\u53eb \u7d22\u5f15\u5d4c\u5957\u5faa\u73af\u8fde\u63a5\u67e5\u8be2</p> <p>Index Nested-Loop Join \u8fd9\u79cd\u65b9\u6cd5\u4e2d\uff0c\u6211\u4eec\u770b\u5230\u4e86 Index\uff0c\u5927\u5bb6\u5e94\u8be5\u90fd\u77e5\u9053\u8fd9\u4e2a\u5c31\u662f\u7d22\u5f15\u7684\u610f\u601d\u3002</p> <p>\u8fd9\u4e2a Index \u662f\u8981\u6c42\u975e\u9a71\u52a8\u8868\u4e0a\u8981\u6709\u7d22\u5f15\uff0c\u6709\u4e86\u7d22\u5f15\u4ee5\u540e\u53ef\u4ee5\u51cf\u5c11\u5339\u914d\u6b21\u6570\uff0c\u5339\u914d\u6b21\u6570\u51cf\u5c11\u4e86\u5c31\u53ef\u4ee5\u63d0\u9ad8\u67e5\u8be2\u7684\u6548\u7387\u4e86\u3002</p> <p>\u4e3a\u4ec0\u4e48\u4f1a\u6709\u4e86\u7d22\u5f15\u4ee5\u540e\u53ef\u4ee5\u51cf\u5c11\u67e5\u8be2\u7684\u6b21\u6570\u5462\uff1f\u8fd9\u4e2a\u5176\u5b9e\u5c31\u6d89\u53ca\u5230\u6570\u636e\u7ed3\u6784\u91cc\u9762\u7684\u4e00\u4e9b\u77e5\u8bc6\u4e86\uff0c\u7ed9\u5927\u5bb6\u4e3e\u4e2a\u4f8b\u5b50\u5c31\u6e05\u695a\u4e86</p> <ol> <li>\u7d22\u5f15\u5d4c\u5957\u5faa\u73af\u8fde\u63a5\u662f\u57fa\u4e8e\u7d22\u5f15\u8fdb\u884c\u8fde\u63a5\u7684\u7b97\u6cd5\uff0c\u7d22\u5f15\u662f\u57fa\u4e8e\u5185\u5c42\u8868\u7684\uff0c\u901a\u8fc7**\u5916\u5c42\u8868\u5339\u914d\u6761\u4ef6**\u76f4\u63a5\u4e0e**\u5185\u5c42\u8868\u7d22\u5f15**\u8fdb\u884c\u5339\u914d\uff0c\u907f\u514d\u548c\u5185\u5c42\u8868\u7684\u6bcf\u6761\u8bb0\u5f55\u8fdb\u884c\u6bd4\u8f83\uff0c \u4ece\u800c\u5229\u7528\u7d22\u5f15\u7684\u67e5\u8be2\u51cf\u5c11\u4e86\u5bf9\u5185\u5c42\u8868\u7684\u5339\u914d\u6b21\u6570\uff0c\u4f18\u52bf\u6781\u5927\u7684\u63d0\u5347\u4e86 join \u7684\u6027\u80fd\uff1a</li> </ol> <p>\u539f\u6765\u7684\u5339\u914d\u6b21\u6570 = \u5916\u5c42\u8868\u884c\u6570 _ \u5185\u5c42\u8868\u884c\u6570 \u4f18\u5316\u540e\u7684\u5339\u914d\u6b21\u6570= \u5916\u5c42\u8868\u7684\u884c\u6570 _ \u5185\u5c42\u8868\u7d22\u5f15\u7684\u9ad8\u5ea6</p> <ol> <li>\u4f7f\u7528\u573a\u666f\uff1a\u53ea\u6709\u5185\u5c42\u8868 join \u7684\u5217\u6709\u7d22\u5f15\u65f6\uff0c\u624d\u80fd\u7528\u5230 Index Nested-LoopJoin \u8fdb\u884c\u8fde\u63a5\u3002</li> <li>\u7531\u4e8e\u7528\u5230\u7d22\u5f15\uff0c\u5982\u679c\u7d22\u5f15\u662f\u8f85\u52a9\u7d22\u5f15\u800c\u4e14\u8fd4\u56de\u7684\u6570\u636e\u8fd8\u5305\u62ec\u5185\u5c42\u8868\u7684\u5176\u4ed6\u6570\u636e\uff0c\u5219\u4f1a\u56de\u5185\u5c42\u8868\u67e5\u8be2\u6570\u636e\uff0c\u591a\u4e86\u4e00\u4e9b IO \u64cd\u4f5c\u3002 3.</li> </ol> <p>MySQL8.0 \u6b63\u5f0f\u5f15\u5165\u4e86 Hash Join \u7684\u8fde\u63a5\u65b9\u5f0f\u3002</p>"},{"location":"foundmental/2.MySQL%E7%B4%A2%E5%BC%95/#_37","title":"\u5b9e\u4f8b","text":"<pre><code>-- \u5efa\u8868t2\nCREATE TABLE `t2` (\n  `id` int(11) NOT NULL,\n  `a` int(11) DEFAULT NULL,\n  `b` int(11) DEFAULT NULL,\n  `c` int(11) DEFAULT NULL,\n  `d` int(11) DEFAULT NULL,\n  PRIMARY KEY (`id`),\n  KEY `a` (`a`),\n  KEY `b` (`b`),\n  KEY `c` (`c`),\n  KEY `d` (`d`)\n) ENGINE=InnoDB;\n\n-- t2\u6d4b\u8bd5\u6570\u636e\ndelimiter ;;\ncreate procedure idata2()\nbegin\n  declare i int;\n  set i=1;\n  while(i&lt;=1000)do\n    insert into t2 values(i, i+1, i+2, i+2, i+4);\n    set i=i+1;\n  end while;\nend;;\n\ndelimiter ;\n\n-- \u8c03\u7528\u5b58\u50a8\u8fc7\u7a0b\ncall idata2();\n\n\n-- \u5efa\u8868t1\ncreate table t1 like t2;\ninsert into t1 (select * from t2 where id&lt;=100);\n\n\n-- t1\u6d4b\u8bd5\u6570\u636e\ndelimiter ;;\ncreate procedure idata1()\nbegin\n  declare i int;\n  set i=2000;\n  while(i&lt;=3000)do\n    insert into t1 values(i, i, i, i, i);\n    set i=i+1;\n  end while;\nend;;\n\ndelimiter ;\n\n-- \u8c03\u7528\u5b58\u50a8\u8fc7\u7a0b\ncall idata1();\n\n\n\n\n-- t1 \u7684\u6570\u636e  1-100  2000-3000  \u4e00\u5171\u662f1101\u6761\u6570\u636e\n-- t2 \u7684\u6570\u636e  1-1000  \u4e00\u5171\u662f1000\u6761\u6570\u636e\n\n-- \u76f4\u63a5\u591a\u8868\u67e5\u8be2\uff0c\u7b1b\u5361\u5c14\u79ef\uff1a1101*1000 \u6761\u6570\u636e\uff0c\u4e00\u822c\u5f88\u5c11\u6709\u8fd9\u6837\u7684\u67e5\u8be2\nselect *  from t1 , t2\n\n\n\n-- \u5185\u8fde\u63a5\u67e5\u8be2\uff0c\u5339\u914d\u5230\u4e861-100\u8fd9100\u884c\u6570\u636e\nselect count(*)  from t1  join t2 on  t1.id=t2.id\n\n-- \u67e5\u770b\u6267\u884c\u8ba1\u5212\n\n\nexplain select count(*)  from t1  join t2 on  t1.id=t2.id\n-- \u6b64\u65f6\u9a71\u52a8\u8868\u662ft2\n\n\nexplain select t1.* from t1  join t2 on  t1.id=t2.id\n\nexplain select t2.* from t1  join t2 on  t1.id=t2.id\n\n-- \u4e0d\u7b49\u503c\u8fde\u63a5\u67e5\u8be2\nexplain select count(*) from t1  join t2 on  t1.id != t2.id\n\n\n\n\n-- t1 \u7684\u6570\u636e  1-100  2000-3000  \u4e00\u5171\u662f1101\u6761\u6570\u636e\n-- t2 \u7684\u6570\u636e  1-1000  \u4e00\u5171\u662f1000\u6761\u6570\u636e\n</code></pre>"},{"location":"foundmental/2.MySQL%E7%B4%A2%E5%BC%95/#mysql_4","title":"MySQL \u6267\u884c\u8ba1\u5212","text":"<p>\u5728 MySQL \u4e2d\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7 EXPLAIN \u547d\u4ee4\u83b7\u53d6<code>MySQL</code>\u5982\u4f55\u6267\u884c<code>SELECT</code>\u8bed\u53e5\u7684\u4fe1\u606f\uff0c\u5305\u62ec\u5728<code>SELECT</code>\u8bed\u53e5\u6267\u884c\u8fc7\u7a0b\u4e2d\u8868\u5982\u4f55\u8fde\u63a5\u548c\u8fde\u63a5\u7684\u987a\u5e8f\u3002</p> <p>EXPLAIN \u53ef\u4ee5\u4f7f\u7528\u5728<code>SELECT, DELETE, INSERT, REPLACE, and UPDATE</code> \u8bed\u53e5\u4e2d\uff0c\u6267\u884c\u7684\u7ed3\u679c\u4f1a\u5728\u6bcf\u4e00\u884c\u663e\u793a\u7528\u5230\u7684\u6bcf\u4e00\u4e2a\u8868\u7684\u8be6\u7ec6\u4fe1\u606f\u3002</p> <p>\u7b80\u5355\u8bed\u53e5\u53ef\u80fd\u7ed3\u679c\u5c31\u53ea\u6709\u4e00\u884c\uff0c\u4f46\u662f\u590d\u6742\u7684\u67e5\u8be2\u8bed\u53e5\u4f1a\u6709\u5f88\u591a\u884c\u6570\u636e\u3002</p> <p><code>MySQL 8.0.16</code>\u5f15\u5165\u4e00\u4e2a\u5b9e\u9a8c\u7279\u6027\uff1a<code>explain format=tree</code> \uff0c\u6811\u72b6\u7684\u8f93\u51fa\u6267\u884c\u8fc7\u7a0b\uff0c\u4ee5\u53ca\u9884\u4f30\u6210\u672c\u548c\u9884\u4f30\u8fd4\u56de\u884c\u6570\u3002\u5728 <code>MySQL 8.0.18</code> \u53c8\u5f15\u5165\u4e86 <code>EXPLAIN ANALYZE</code>\uff0c\u5728 <code>format=tree</code> \u57fa\u7840\u4e0a\uff0c\u4f7f\u7528\u65f6\uff0c\u4f1a\u6267\u884c SQL \uff0c\u5e76\u8f93\u51fa\u8fed\u4ee3\u5668\uff08\u611f\u89c9\u8fd9\u91cc\u7528\u7b97\u5b50\u66f4\u5bb9\u6613\u7406\u89e3\uff09\u76f8\u5173\u7684\u5b9e\u9645\u4fe1\u606f\uff0c\u6bd4\u5982\u6267\u884c\u6210\u672c\u3001\u8fd4\u56de\u884c\u6570\u3001\u6267\u884c\u65f6\u95f4\uff0c\u5faa\u73af\u6b21\u6570\u3002</p> <ul> <li>\u9884\u8ba1\u6267\u884c\u65f6\u95f4</li> <li>\u9884\u8ba1\u8fd4\u56de\u7684\u884c\u6570</li> <li>\u8fd4\u56de\u7b2c\u4e00\u884c\u7684\u65f6\u95f4</li> <li>\u8fed\u4ee3\u5668\u7684\u6267\u884c\u65f6\u95f4\uff0c\u5355\u4f4d\u6beb\u79d2</li> <li>\u8fed\u4ee3\u5668\u8fd4\u56de\u7684\u884c\u6570</li> <li>\u6267\u884c\u5faa\u73af\u7684\u6b21\u6570</li> </ul> <p>\u67e5\u8be2\u4fe1\u606f\u4ee5 TREE \u7684\u5f62\u5f0f\u8f93\u51fa\uff0c\u6bcf\u4e2a\u8282\u70b9\u4ee3\u8868\u4e00\u4e2a\u8fed\u4ee3\u5668\u3002<code>EXPLAIN ANALYZE</code> \u53ef\u4ee5\u7528\u4e8e SELECT \u8bed\u53e5\uff0c\u4ee5\u53ca\u591a\u8868\u7684 <code>UPDATE</code> \u548c <code>DELETE</code> \u8bed\u53e5\uff0c<code>MySQL 8.0.19</code> \u4ee5\u540e\u4e5f\u53ef\u4ee5\u7528\u4e8e <code>TABLE</code> \u8bed\u53e5\u3002<code>EXPLAIN ANALYZE</code> \u4e0d\u80fd\u4f7f\u7528 <code>FOR CONNECTION</code> \u3002<code>MySQL 8.0.20</code> \u4ee5\u540e\u53ef\u4ee5\u901a\u8fc7 <code>KILL QUERY</code> \u6216 <code>CTRL-C</code> \u7ec8\u6b62\u8be5\u8bed\u53e5\u7684\u6267\u884c\u3002</p> <p>\u4e0e\u4f20\u7edf\u7684\u6267\u884c\u8ba1\u5212\u76f8\u6bd4\uff0c\u5c55\u793a\u4e86\u6bd4\u8f83\u6e05\u6670\u7684\u6267\u884c\u8fc7\u7a0b\u3002\u800c <code>explain analyze</code> \u5219\u4f1a\u5728\u6b64\u57fa\u7840\u4e0a\u591a\u8f93\u51fa\u5b9e\u9645\u7684\u6267\u884c\u65f6\u95f4\u3001\u8fd4\u56de\u884c\u6570\u548c\u5faa\u73af\u6b21\u6570\u3002</p>"},{"location":"foundmental/2.MySQL%E7%B4%A2%E5%BC%95/#explain","title":"<code>EXPLAIN</code> \u7684\u4f7f\u7528","text":"<p>\u5728 SQL \u8bed\u53e5\u524d\u9762\u52a0\u4e0a <code>EXPLAIN</code>\uff0c\u5982\uff1a<code>EXPLAIN SELECT * FROM a;</code></p> <pre><code>EXPLAIN [explain_type] {explainable_stmt }\nexplain_type:\n{ EXTENDED | PARTITIONS | FORMAT = format_name}\n\nformat_name:\n{ TRADITIONAL | JSON}\nexplainable_stmt:\n{ SELECT statement | DELETE statement | INSERT statement | REPLACE statement | UPDATE statement }\n\n-- \u4ee5JSON\u683c\u5f0f\u663e\u793aexplain\u8f93\u51fa\nEXPLAIN  format=\"JSON\"  SELECT * FROM a\n</code></pre>"},{"location":"foundmental/2.MySQL%E7%B4%A2%E5%BC%95/#explain_1","title":"<code>Explain</code> \u8f93\u51fa\u7684\u5b57\u6bb5\u5185\u5bb9","text":"<pre><code>id, select_type, table, partitions, type, possible_keys, key, key_len, ref, rows,filtered,extra\n</code></pre> \u5217\u540d \u542b\u4e49 id \u67e5\u8be2\u8bed\u53e5\u7684\u6807\u8bc6 select_type \u67e5\u8be2\u7684\u7c7b\u578b table \u5f53\u524d\u884c\u6240\u67e5\u7684\u8868 partitions \u5339\u914d\u7684\u5206\u533a type \u8bbf\u95ee\u7c7b\u578b possible_keys \u67e5\u8be2\u53ef\u80fd\u7528\u5230\u7684\u7d22\u5f15 key mysql \u51b3\u5b9a\u91c7\u7528\u7684\u7d22\u5f15\u6765\u4f18\u5316\u67e5\u8be2 key_len \u7d22\u5f15 key \u7684\u957f\u5ea6 ref \u663e\u793a\u4e86\u4e4b\u524d\u7684\u8868\u5728 key \u5217\u8bb0\u5f55\u7684\u7d22\u5f15\u4e2d\u67e5\u627e\u503c\u6240\u7528\u7684\u5217\u6216\u5e38\u91cf rows \u67e5\u8be2\u626b\u63cf\u7684\u884c\u6570\uff0c\u9884\u4f30\u503c\uff0c\u4e0d\u4e00\u5b9a\u51c6\u786e filtered \u67e5\u8be2\u7684\u8868\u884c\u5360\u8868\u7684\u767e\u5206\u6bd4 extra \u989d\u5916\u7684\u67e5\u8be2\u8f85\u52a9\u4fe1\u606f"},{"location":"foundmental/2.MySQL%E7%B4%A2%E5%BC%95/#select_type","title":"select_type \u7c7b\u578b","text":"<p>select_type:\u8868\u793a\u67e5\u8be2\u7c7b\u578b\uff0c\u5e38\u89c1\u7684\u53d6\u503c\u6709\uff1a</p> \u7c7b\u578b \u8bf4\u660e SIMPLE \u7b80\u5355\u8868\uff0c\u4e0d\u4f7f\u7528\u8868\u8fde\u63a5\u6216\u5b50\u67e5\u8be2 PRIMARY \u4e3b\u67e5\u8be2\uff0c\u5373\u6700\u5916\u5c42\u7684\u67e5\u8be2 UNION UNION \u4e2d\u7684\u7b2c\u4e8c\u4e2a\u6216\u8005\u66f4\u65b0\u540e\u9762\u7684\u67e5\u8be2\u8bed\u53e5 SUBQUERY \u5b50\u67e5\u8be2\u4e2d\u7684\u7b2c\u4e00\u4e2a DERIVED \u6d3e\u751f\u8868 <p>table:\u8f93\u51fa\u7ed3\u679c\u96c6\u7684\u8868\uff08\u8868\u522b\u540d\uff09</p>"},{"location":"foundmental/2.MySQL%E7%B4%A2%E5%BC%95/#type","title":"type \u7c7b\u578b","text":"<p>\u8868\u793a MySQL \u5728\u8868\u4e2d\u627e\u5230\u6240\u9700\u884c\u7684\u65b9\u5f0f\uff0c\u6216\u8005\u53eb\u8bbf\u95ee\u7c7b\u578b\u3002\u5e38\u89c1\u8bbf\u95ee\u7c7b\u578b\u5982\u4e0b\uff0c\u4ece\u4e0a\u5230\u4e0b\uff0c\u6027\u80fd\u7531\u5dee\u5230\u6700\u597d\uff1a</p> TYPE \u8bbf\u95ee\u7c7b\u578b \u4e00\u822c\u662f\u6ca1\u6709 where \u6761\u4ef6\u6216\u8005 where \u6761\u4ef6\u6ca1\u6709\u4f7f\u7528\u7d22\u5f15\u7684\u67e5\u8be2\u8bed\u53e5 ALL \u5168\u8868\u626b\u63cf \u4e00\u822c\u662f\u6ca1\u6709 where \u6761\u4ef6\u6216\u8005 where \u6761\u4ef6\u6ca1\u6709\u4f7f\u7528\u7d22\u5f15\u7684\u67e5\u8be2\u8bed\u53e5 index \u7d22\u5f15\u5168\u626b\u63cf MySQL \u904d\u5386\u6574\u4e2a\u7d22\u5f15\u6765\u67e5\u8be2\u5339\u914d\u884c\uff0c\u5e76\u4e0d\u4f1a\u626b\u63cf\u8868\uff0c\u4e00\u822c\u662f\u67e5\u8be2\u7684\u5b57\u6bb5\u6709\u7d22\u5f15\u7684\u8bed\u53e5 range \u7d22\u5f15\u8303\u56f4\u626b\u63cf \u7d22\u5f15\u8303\u56f4\u626b\u63cf\uff0c\u5e38\u7528\u4e8e\u5bf9\u7d22\u5f15\u5b57\u6bb5\u8fdb\u884c &lt;\u3001&lt;=\u3001&gt;\u3001&gt;=\u3001between \u7b49\u67e5\u8be2\u64cd\u4f5c index_subquery \u7d22\u5f15\u5b50\u67e5\u8be2 unique_subquery \u552f\u4e00\u7d22\u5f15\u5b50\u67e5\u8be2 value IN (SELECT primary_key FROM single_table WHERE some_expr) index_merge \u7d22\u5f15\u5408\u5e76 ref_or_null fulltext \u5168\u6587\u7d22\u5f15\u626b\u63cf ref \u975e\u552f\u4e00\u7d22\u5f15\u626b\u63cf \u4f7f\u7528\u975e\u552f\u4e00\u7d22\u5f15\u6216\u552f\u4e00\u7d22\u5f15\u7684\u524d\u7f00\u626b\u63cf\uff0c\u8fd4\u56de\u5339\u914d\u67d0\u4e2a\u5355\u72ec\u503c\u7684\u8bb0\u5f55\u884c eq_ref \u552f\u4e00\u7d22\u5f15\u626b\u63cf \u7c7b\u4f3c ref\uff0c\u533a\u522b\u5728\u4e8e\u4f7f\u7528\u7684\u7d22\u5f15\u662f\u552f\u4e00\u7d22\u5f15\uff0c\u5bf9\u4e8e\u6bcf\u4e2a\u7d22\u5f15\u952e\u503c\uff0c\u8868\u4e2d\u53ea\u6709\u4e00\u6761\u8bb0\u5f55\u5339\u914d const,system \u5355\u8868\u6700\u591a\u6709\u4e00\u4e2a\u5339\u914d\u884c \u5355\u8868\u4e2d\u6700\u591a\u6709\u4e00\u6761\u5339\u914d\u884c\uff0c\u67e5\u8be2\u8d77\u6765\u975e\u5e38\u8fc5\u901f\uff0c\u6240\u4ee5\u8fd9\u4e2a\u5339\u914d\u884c\u7684\u5176\u4ed6\u5217\u7684\u503c\u53ef\u4ee5\u88ab\u4f18\u5316\u5668\u5728\u5f53\u524d\u67e5\u8be2\u4e2d\u5f53\u4f5c\u5e38\u91cf\u6765\u5904\u7406 NULL \u4e0d\u7528\u626b\u63cf\u8868\u6216\u7d22\u5f15"},{"location":"foundmental/2.MySQL%E7%B4%A2%E5%BC%95/#all","title":"ALL \u573a\u666f","text":"<p>\u5168\u8868\u626b\u63cf\uff0c\u4e00\u822c\u662f\u6ca1\u6709 where \u6761\u4ef6\u6216\u8005 where \u6761\u4ef6\u6ca1\u6709\u4f7f\u7528\u7d22\u5f15\u7684\u67e5\u8be2\u8bed\u53e5</p> <p>\u5168\u8868\u626b\u63cf\uff1aMySQL \u8981\u4ece\u78c1\u76d8\u8bfb\u53d6\u6574\u4e2a\u8868\uff0c\u9010\u884c\u904d\u5386\u5e76\u8fdb\u884c\u8ba1\u7b97\u5339\u914d\u6bd4\u5bf9\u7684\u8fc7\u7a0b\u3002</p> <pre><code>-- customer\u8868\u4e2d\u7684active\u5b57\u6bb5\u6ca1\u6709\u7d22\u5f15\uff1a\u9010\u884c\u8bfb\u53d6\u5e76\u8ddf\u67e5\u8be2\u6761\u4ef6\u6bd4\u5bf9\nEXPLAIN SELECT * FROM customer WHERE active=0;\n</code></pre>"},{"location":"foundmental/2.MySQL%E7%B4%A2%E5%BC%95/#index","title":"index \u573a\u666f","text":"<p>\u7d22\u5f15\u5168\u626b\u63cf\uff0cMySQL \u904d\u5386\u6574\u4e2a\u7d22\u5f15\u6765\u67e5\u8be2\u5339\u914d\u884c\uff0c\u5e76\u4e0d\u4f1a\u626b\u63cf\u8868</p> <pre><code>-- \u4e00\u822c\u662f\u67e5\u8be2\u7684\u5b57\u6bb5\u90fd\u6709\u7d22\u5f15\u7684\u67e5\u8be2\u8bed\u53e5\nEXPLAIN SELECT store_id FROM customer;\n</code></pre>"},{"location":"foundmental/2.MySQL%E7%B4%A2%E5%BC%95/#range","title":"range \u573a\u666f","text":"<p>\u7d22\u5f15\u8303\u56f4\u626b\u63cf\uff0c\u5e38\u7528\u4e8e &lt;\u3001&lt;=\u3001&gt;\u3001&gt;=\u3001between \u7b49\u64cd\u4f5c\uff0c\u4ec5\u626b\u63cf\u90e8\u5206\u7d22\u5f15\u884c\u7684\u6570\u636e</p> <pre><code>-- \u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u6ce8\u610f\u6bd4\u8f83\u7684\u5b57\u6bb5\u8981\u52a0\u4e0a\u7d22\u5f15\u3002\u5426\u5219\u5c31\u662f\u5168\u8868\u626b\u63cf\n-- \u8fd9\u79cd\u4e5f\u4e0d\u662f\u7edd\u5bf9\u7684\uff0c\u4e5f\u6709\u53ef\u80fd\u8d70\u5168\u8868\u626b\u63cf\uff0c\u65e0\u8bba\u4ec0\u4e48\u60c5\u51b5\u4e0b\uff0c\u53ea\u67e5\u8be2\u9700\u8981\u7684\u5217\nEXPLAIN SELECT * FROM customer WHERE customer_id&gt;=10 AND customer_id&lt;=20;\nEXPLAIN select  apprdate from temp_policy_org_base where apprdate &gt; '8' and apprdate &lt; '10' ;\n</code></pre>"},{"location":"foundmental/2.MySQL%E7%B4%A2%E5%BC%95/#index_subquery","title":"<code>index_subquery</code>","text":""},{"location":"foundmental/2.MySQL%E7%B4%A2%E5%BC%95/#unique_subquery","title":"<code>unique_subquery</code>","text":""},{"location":"foundmental/2.MySQL%E7%B4%A2%E5%BC%95/#index_merge","title":"<code>index_merge</code>","text":""},{"location":"foundmental/2.MySQL%E7%B4%A2%E5%BC%95/#ref_or_null","title":"<code>ref_or_null</code>","text":""},{"location":"foundmental/2.MySQL%E7%B4%A2%E5%BC%95/#fulltext","title":"fulltext \u573a\u666f","text":""},{"location":"foundmental/2.MySQL%E7%B4%A2%E5%BC%95/#ref","title":"ref \u573a\u666f","text":"<ul> <li>\u6839\u636e\u7d22\u5f15\u5b57\u6bb5\u8fdb\u884c\u7b49\u503c\u67e5\u8be2\uff0c\u8fd4\u56de\u5339\u914d\u67d0\u4e2a\u5355\u72ec\u503c\u7684\u8bb0\u5f55\u884c \uff08\u975e\u552f\u4e00\u7d22\u5f15\uff0c\u6216\u8005\u552f\u4e00\u7d22\u5f15\u7684\u524d\u7f00\u626b\u63cf\u3002\uff09</li> </ul> <pre><code>SELECT * FROM ref_table WHERE key_column=expr;\n</code></pre> <ul> <li>join \u8054\u8868\u67e5\u8be2</li> </ul> <p>ref_table\u3001other_table \u8868\u5173\u8054\u67e5\u8be2\uff0c\u5173\u8054\u5b57\u6bb5<code>customer.customer_id</code>\uff08\u4e3b\u952e\uff09\uff0c<code>payment.customer_id</code>\uff08\u975e\u552f\u4e00\u7d22\u5f15\uff09</p> <pre><code>    SELECT * FROM ref_table,other_table  WHERE ref_table.key_column=other_table.column;\n</code></pre> <p>\u5173\u8054\u67e5\u8be2\u65f6\u5fc5\u5b9a\u4f1a\u6709\u4e00\u5f20\u8868\u8fdb\u884c\u5168\u8868\u626b\u63cf\uff0c\u6b64\u8868\u4e00\u5b9a\u662f\u51e0\u5f20\u8868\u4e2d\u8bb0\u5f55\u884c\u6570\u6700\u5c11\u7684\u8868\uff0c\u7136\u540e\u518d\u901a\u8fc7\u975e\u552f\u4e00\u7d22\u5f15\u5bfb\u627e\u5176\u4ed6\u5173\u8054\u8868\u4e2d\u7684\u5339\u914d\u884c\uff0c\u4ee5\u6b64\u8fbe\u5230\u8868\u5173\u8054\u65f6\u626b\u63cf\u884c\u6570\u6700\u5c11\u3002</p> <p>\u56e0\u4e3a**customer**\u3001**payment**\u4e24\u8868\u4e2d**customer**\u8868\u7684\u8bb0\u5f55\u884c\u6570\u6700\u5c11\uff0c\u6240\u4ee5**customer**\u8868\u8fdb\u884c\u5168\u8868\u626b\u63cf\uff0c**payment**\u8868\u901a\u8fc7\u975e\u552f\u4e00\u7d22\u5f15\u5bfb\u627e\u5339\u914d\u884c\u3002</p>"},{"location":"foundmental/2.MySQL%E7%B4%A2%E5%BC%95/#eq_ref","title":"eq_ref \u573a\u666f","text":"<p>\u8868\u793a\u5bf9\u4e8e\u524d\u8868\u7684\u6bcf\u4e00\u4e2a\u7ed3\u679c\uff0c\u90fd\u53ea\u80fd\u5339\u914d\u5230\u540e\u8868\u7684\u4e00\u884c\u7ed3\u679c\u3002\u5e76\u4e14\u67e5\u8be2\u7684\u6bd4\u8f83\u64cd\u4f5c\u901a\u5e38\u662f <code>=</code>\uff0c\u67e5\u8be2\u6548\u7387\u8f83\u9ad8\u3002</p> <pre><code>SELECT * FROM ref_table,other_table  WHERE ref_table.key_column=other_table.column;\nSELECT * FROM ref_table,other_table  WHERE ref_table.key_column_part1=other_table.column AND ref_table.key_column_part2=1;\n</code></pre>"},{"location":"foundmental/2.MySQL%E7%B4%A2%E5%BC%95/#systemconst","title":"system/const \u573a\u666f","text":"<p>\u5355\u8868\u4e2d\u6700\u591a\u6709\u4e00\u6761\u5339\u914d\u884c\uff0c\u67e5\u8be2\u8d77\u6765\u975e\u5e38\u8fc5\u901f\uff0c\u6240\u4ee5\u8fd9\u4e2a\u5339\u914d\u884c\u7684\u5176\u4ed6\u5217\u7684\u503c\u53ef\u4ee5\u88ab\u4f18\u5316\u5668\u5728\u5f53\u524d\u67e5\u8be2\u4e2d\u5f53\u4f5c\u5e38\u91cf\u6765\u5904\u7406\u3002</p> <p>\u573a\u666f\uff1a\u5c06\u552f\u4e00\u7d22\u5f15\u6216\u4e3b\u952e\uff0c\u8ddf\u5e38\u91cf\u8fdb\u884c\u7b49\u503c\u5339\u914d\u67e5\u627e\u3002</p> <pre><code>SELECT * FROM tbl_name WHERE primary_key=1;\nSELECT * FROM tbl_name  WHERE primary_key_part1=1 AND primary_key_part2=2;\n</code></pre> <p>system \u67e5\u627e\uff0c\u8868\u4e2d\u53ea\u6709\u4e00\u884c\u3002system \u662f\u7279\u6b8a\u7684 const \u67e5\u627e\u60c5\u51b5\u3002</p>"},{"location":"foundmental/2.MySQL%E7%B4%A2%E5%BC%95/#extra","title":"Extra \u7c7b\u578b","text":"<p>Extra \u63cf\u8ff0\u4e86 MySQL \u5185\u90e8\u5982\u4f55\u8fdb\u884c\u989d\u5916\u7684\u5904\u7406\u3002</p> <p>\u5173\u4e8e\u5982\u4f55\u7406\u89e3 MySQL \u6267\u884c\u8ba1\u5212\u4e2d Extra \u5217\u7684 Using where\u3001Using Index\u3001Using index condition\uff0cUsing index,Using where \u8fd9\u56db\u8005\u7684\u533a\u522b\u3002</p> <p>\u9996\u5148\uff0c\u6211\u4eec\u6765\u770b\u770b\u5b98\u65b9\u6587\u6863\u5173\u4e8e\u4e09\u8005\u7684\u7b80\u5355\u4ecb\u7ecd\uff08\u5b98\u65b9\u6587\u6863\u5e76\u6ca1\u6709\u4ecb\u7ecd Using index,Using where \u8fd9\u79cd\u60c5\u51b5\uff09</p>"},{"location":"foundmental/2.MySQL%E7%B4%A2%E5%BC%95/#using-index","title":"Using Index","text":"<p>\u8986\u76d6\u7d22\u5f15\uff1a\u8868\u793a\u76f4\u63a5\u8bbf\u95ee\u7d22\u5f15\u5c31\u80fd\u591f\u83b7\u53d6\u5230\u6240\u9700\u8981\u7684\u6570\u636e\uff08\uff09\uff0c\u4e0d\u9700\u8981\u901a\u8fc7\u56de\u8868\u67e5\u8be2\u3002</p> <p>\u6ce8\u610f\uff1a\u6267\u884c\u8ba1\u5212\u4e2d\u7684<code>Extra</code>\u5217\u7684<code>Using index</code>\u8ddf type \u5217\u7684<code>index</code>\u4e0d\u8981\u6df7\u6dc6\u3002Extra \u5217\u7684<code>Using index</code>\u8868\u793a\u7d22\u5f15\u8986\u76d6\u3002\u800c type \u5217\u7684\u201cindex\u201d\u8868\u793a Full Index Scan\u3002</p> <p>\u4ec5\u4f7f\u7528\u7d22\u5f15\u6811\u4e2d\u7684\u4fe1\u606f\u5c31\u80fd\u83b7\u53d6\u67e5\u8be2\u8bed\u53e5\u7684\u5217\u7684\u4fe1\u606f, \u800c\u4e0d\u5fc5\u8fdb\u884c\u5176\u4ed6\u989d\u5916\u67e5\u627e\uff08seek\uff09\u53bb\u8bfb\u53d6\u5b9e\u9645\u7684\u884c\u8bb0\u5f55\u3002\u5f53\u67e5\u8be2\u7684\u5217\u662f\u5355\u4e2a\u7d22\u5f15\u7684\u90e8\u5206\u7684\u5217\u65f6, \u53ef\u4ee5\u4f7f\u7528\u6b64\u7b56\u7565\u3002\uff08\u7b80\u5355\u7684\u7ffb\u8bd1\u5c31\u662f\uff1a\u4f7f\u7528\u7d22\u5f15\u6765\u76f4\u63a5\u83b7\u53d6\u5217\u7684\u6570\u636e\uff0c\u800c\u4e0d\u9700\u56de\u8868\uff09\u3002\u5bf9\u4e8e\u5177\u6709\u7528\u6237\u5b9a\u4e49\u7684\u805a\u96c6\u7d22\u5f15\u7684 InnoDB \u8868, \u5373\u4f7f\u4ece Extra \u5217\u4e2d\u6ca1\u6709\u4f7f\u7528\u7d22\u5f15, \u4e5f\u53ef\u4ee5\u4f7f\u7528\u8be5\u7d22\u5f15\u3002\u5982\u679c type \u662f index \u5e76\u4e14 Key \u662f\u4e3b\u952e, \u5219\u4f1a\u51fa\u73b0\u8fd9\u79cd\u60c5\u51b5\u3002</p>"},{"location":"foundmental/2.MySQL%E7%B4%A2%E5%BC%95/#using-index-condition","title":"Using Index Condition","text":"<p>\u7d22\u5f15\u4e0b\u63a8\uff1a\u4f1a\u5148\u6761\u4ef6\u8fc7\u6ee4\u7d22\u5f15\uff0c\u8fc7\u6ee4\u5b8c\u7d22\u5f15\u540e\u627e\u5230\u6240\u6709\u7b26\u5408\u7d22\u5f15\u6761\u4ef6\u7684\u6570\u636e\u884c\uff0c\u968f\u540e\u7528<code>WHERE</code>\u5b50\u53e5\u4e2d\u7684\u5176\u4ed6\u6761\u4ef6\u53bb\u8fc7\u6ee4\u8fd9\u4e9b\u6570\u636e\u884c\uff1b</p> <p><code>Index Condition Pushdown</code>\u662f\u4e00\u79cd\u5728\u5b58\u50a8\u5f15\u64ce\u5c42\u4f7f\u7528\u7d22\u5f15\u8fc7\u6ee4\u6570\u636e\u7684\u4e00\u79cd\u4f18\u5316\u65b9\u5f0f\u3002ICP \u5f00\u542f\u65f6\u7684\u6267\u884c\u8ba1\u5212\u542b\u6709<code>Using index condition</code>\u6807\u793a \uff0c\u8868\u793a\u4f18\u5316\u5668\u4f7f\u7528\u4e86 ICP \u5bf9\u6570\u636e\u8bbf\u95ee\u8fdb\u884c\u4f18\u5316\u3002</p> <p>\u5f53\u5173\u95ed<code>ICP</code>\u65f6\uff0c<code>Index</code>\u4ec5\u4ec5\u662f<code>data access</code>\u7684\u4e00\u79cd\u8bbf\u95ee\u65b9\u5f0f\uff0c\u5b58\u50a8\u5f15\u64ce\u901a\u8fc7\u7d22\u5f15\u56de\u8868\u83b7\u53d6\u7684\u6570\u636e\u4f1a\u4f20\u9012\u5230<code>MySQL Server</code>\u5c42\u8fdb\u884c<code>WHERE</code>\u6761\u4ef6\u8fc7\u6ee4</p> <p>\u5f53\u6253\u5f00<code>ICP</code>\u65f6\uff0c\u5982\u679c\u90e8\u5206<code>WHERE</code>\u6761\u4ef6\u80fd\u4f7f\u7528\u7d22\u5f15\u4e2d\u7684\u5b57\u6bb5\uff0c<code>MySQL Server</code>\u4f1a\u628a\u8fd9\u90e8\u5206\u4e0b\u63a8\u5230\u5f15\u64ce\u5c42\uff0c\u53ef\u4ee5\u5229\u7528<code>Index</code>\u8fc7\u6ee4\u7684<code>WHERE</code>\u6761\u4ef6\u5728\u5b58\u50a8\u5f15\u64ce\u5c42\u8fdb\u884c\u6570\u636e\u8fc7\u6ee4,\u800c\u975e\u5c06\u6240\u6709\u901a\u8fc7<code>Index Access</code>\u7684\u7ed3\u679c\u4f20\u9012\u5230<code>MySQL Server</code>\u5c42\u8fdb\u884c<code>WHERE</code>\u8fc7\u6ee4\u3002</p>"},{"location":"foundmental/2.MySQL%E7%B4%A2%E5%BC%95/#using-where","title":"Using where","text":"<p>\u8868\u793a<code>MySQL Server</code>\u5728\u5b58\u50a8\u5f15\u64ce\u6536\u5230\u8bb0\u5f55\u540e\u8fdb\u884c\"\u540e\u8fc7\u6ee4\"\uff08Post-filter\uff09\u3002</p> <p>\u5982\u679c\u67e5\u8be2\u672a\u80fd\u4f7f\u7528\u7d22\u5f15\uff0c<code>Using where</code>\u7684\u4f5c\u7528\u53ea\u662f\u63d0\u9192\u6211\u4eec<code>MySQL</code>\u5c06\u7528<code>where</code>\u5b50\u53e5\u6765\u8fc7\u6ee4\u7ed3\u679c\u96c6\u3002\u8fd9\u4e2a\u4e00\u822c\u53d1\u751f\u5728<code>MySQL</code>\u670d\u52a1\u5668\uff0c\u800c\u4e0d\u662f\u5b58\u50a8\u5f15\u64ce\u5c42\u3002</p> <p>\u4e00\u822c\u53d1\u751f\u5728\u4e0d\u80fd\u8d70\u7d22\u5f15\u626b\u63cf\u7684\u60c5\u51b5\u4e0b\u6216\u8005\u8d70\u7d22\u5f15\u626b\u63cf\uff0c\u4f46\u662f\u6709\u4e9b\u67e5\u8be2\u6761\u4ef6\u4e0d\u5728\u7d22\u5f15\u5f53\u4e2d\u7684\u60c5\u51b5\u4e0b\u3002</p> <p>\u6ce8\u610f: <code>Using where</code>\u8fc7\u6ee4\u5143\u7ec4\u548c\u6267\u884c\u8ba1\u5212\u662f\u5426\u8d70\u5168\u8868\u626b\u63cf\u6216\u8d70\u7d22\u5f15\u67e5\u627e\u6ca1\u6709\u5173\u7cfb\u3002</p> <p>\u4e0d\u7ba1 SQL \u8bed\u53e5\u7684\u6267\u884c\u8ba1\u5212\u662f\u5168\u8868\u626b\u63cf<code>type=ALL</code>\u6216\u975e\u552f\u4e00\u6027\u7d22\u5f15\u626b\u63cf<code>type=ref</code>\u3002</p> <p>\u7f51\u4e0a\u6709\u79cd\u8bf4\u6cd5\"Using where\uff1a\u8868\u793a\u4f18\u5316\u5668\u9700\u8981\u901a\u8fc7\u7d22\u5f15\u56de\u8868\u67e5\u8be2\u6570\u636e\" \uff0c\u4e0a\u9762\u5b9e\u9a8c\u53ef\u4ee5\u8bc1\u5b9e\u8fd9\u79cd\u8bf4\u6cd5\u5b8c\u5168\u4e0d\u6b63\u786e\u3002</p> <p>\u6240\u6709<code>SQL</code>\u8bed\u53e5\u7686\u51c6\u7684<code>WHERE</code>\u67e5\u8be2\u6761\u4ef6\u7684\u63d0\u53d6\u89c4\u5219\uff1aIndex Key (First Key &amp; Last Key)\uff0cIndex Filter\uff0cTable Filter</p> <p>\u6240\u6709<code>SQL</code>\u8bed\u53e5\u4e2d\u7684<code>WHERE</code>\u67e5\u8be2\u6761\u4ef6\uff0c\u6700\u7ec8\u90fd\u4f1a\u88ab\u63d0\u53d6\u5230 <code>Index Key (First Key &amp; Last Key)</code>\uff0c<code>Index Filter</code> \u4e0e <code>Table Filter</code> \u4e4b\u4e2d\uff0c\u90a3\u4e48 <code>where</code> \u6761\u4ef6\u7684\u5e94\u7528\uff0c\u5176\u5b9e\u5c31\u662f <code>Index Key (First Key &amp; Last Key)</code>\uff0c<code>Index Filter</code> \u4e0e <code>Table Filter</code> \u7684\u5e94\u7528</p> <p><code>Index First Key</code>\uff0c\u53ea\u662f\u7528\u6765\u5b9a\u4f4d\u7d22\u5f15\u7684\u8d77\u59cb\u70b9\uff0c\u56e0\u6b64\u53ea\u5728\u7d22\u5f15\u7b2c\u4e00\u6b21<code>Search Path</code>(\u6cbf\u7740\u7d22\u5f15 B+\u6811\u7684\u6839\u8282\u70b9\u4e00\u76f4\u904d\u5386\uff0c\u5230\u7d22\u5f15\u6b63\u786e\u7684\u53f6\u8282\u70b9\u4f4d\u7f6e)\u65f6\u4f7f\u7528\uff0c\u53ea\u4f1a\u5224\u65ad\u4e00\u6b21</p> <p><code>Index Last Key</code>\uff0c\u7528\u6765\u5b9a\u4f4d\u7d22\u5f15\u7684\u7ec8\u6b62\u70b9\uff0c\u56e0\u6b64\u5bf9\u4e8e\u8d77\u59cb\u70b9\u4e4b\u540e\u8bfb\u5230\u7684\u6bcf\u4e00\u6761\u7d22\u5f15\u8bb0\u5f55\uff0c\u5747\u9700\u8981\u5224\u65ad\u662f\u5426\u6ee1\u8db3<code>Index Last Key</code>\uff0c\u82e5\u4e0d\u6ee1\u8db3\uff0c\u5219\u5f53\u524d\u67e5\u8be2\u7ed3\u675f</p> <p><code>Index Filter</code>\uff0c\u7528\u4e8e\u8fc7\u6ee4\u7d22\u5f15\u8303\u56f4\u4e2d\u4e0d\u6ee1\u8db3\u6761\u4ef6\u7684\u7d22\u5f15\u9879\uff0c\u56e0\u6b64\u5bf9\u4e8e\u7d22\u5f15\u8303\u56f4\u4e2d\u7684\u6bcf\u4e00\u6761\u7d22\u5f15\u9879\uff0c\u5747\u9700\u8981\u4e0e <code>Index Filter</code> \u8fdb\u884c\u5339\u5bf9\uff0c\u82e5\u4e0d\u6ee1\u8db3 Index Filter \u5219\u76f4\u63a5\u4e22\u5f03\uff0c\u7ee7\u7eed\u8bfb\u53d6\u7d22\u5f15\u4e0b\u4e00\u6761\u8bb0\u5f55</p> <p><code>Table Filter</code>\uff0c\u7528\u4e8e\u8fc7\u6ee4\u4e0d\u80fd\u88ab\u7d22\u5f15\u8fc7\u6ee4\u7684\u6761\u4ef6\uff0c\u6b64\u65f6\u7684\u7d22\u5f15\u9879\u5df2\u7ecf\u6ee1\u8db3\u4e86 <code>Index First Key</code> \u4e0e <code>Index Last Key</code> \u6784\u6210\u7684\u8303\u56f4\uff0c\u5e76\u4e14\u6ee1\u8db3 <code>Index Filter</code> \u7684\u6761\u4ef6\uff0c\u4f46\u662f\u7d22\u5f15\u9879\u65e0\u6cd5\u8fc7\u6ee4 <code>Table Filter</code> \u4e2d\u7684\u6761\u4ef6\uff0c\u6240\u4ee5\u56de\u8868\u8bfb\u53d6\u5b8c\u6574\u7684\u6570\u636e\u8bb0\u5f55\u3002\u5224\u65ad\u5b8c\u6574\u8bb0\u5f55\u662f\u5426\u6ee1\u8db3<code>Table Filter</code>\u4e2d\u7684\u67e5\u8be2\u6761\u4ef6\uff0c\u82e5\u4e0d\u6ee1\u8db3\uff0c\u8df3\u8fc7\u5f53\u524d\u8bb0\u5f55\uff0c\u7ee7\u7eed\u8bfb\u53d6\u7d22\u5f15\u9879\u7684\u4e0b\u4e00\u6761\u7d22\u5f15\u9879\uff0c\u82e5\u6ee1\u8db3\uff0c\u5219\u8fd4\u56de\u8bb0\u5f55\uff0c\u6b64\u8bb0\u5f55\u6ee1\u8db3\u4e86 where \u7684\u6240\u6709\u6761\u4ef6\uff0c\u53ef\u4ee5\u8fd4\u56de\u7ed9\u5ba2\u6237\u7aef</p>"},{"location":"foundmental/2.MySQL%E7%B4%A2%E5%BC%95/#backward-index-scan","title":"Backward index scan","text":"<p>\u5728 MySQL \u4e2d\u6211\u4eec\u521b\u5efa\u7684\u7d22\u5f15\uff0c\u9ed8\u8ba4\u7d22\u5f15\u7684\u53f6\u5b50\u8282\u70b9\u662f\u4ece\u5c0f\u5230\u5927\u6392\u5e8f\u7684\uff0c\u800c\u6b64\u65f6\u6211\u4eec\u964d\u5e8f\u67e5\u8be2\u6392\u5e8f\u65f6\uff0c\u662f\u4ece\u5927\u5230\u5c0f\u3002\u6240\u4ee5\u5728\u626b\u63cf\u65f6\uff0c\u5c31\u662f\u53cd\u5411\u626b\u63cf\uff0c\u5c31\u4f1a\u51fa\u73b0 <code>Backward index scan</code>\u3002 \u5728<code>MySQL8.0</code>\u7248\u672c\u4e2d\uff0c\u652f\u6301\u964d\u5e8f\u7d22\u5f15\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u521b\u5efa\u964d\u5e8f\u7d22\u5f15\u3002</p>"},{"location":"foundmental/2.MySQL%E7%B4%A2%E5%BC%95/#mysql_5","title":"MySQL \u6392\u5e8f\u4f18\u5316","text":"<p><code>order by</code>\u6392\u5e8f\u662f\u4e00\u4e2a\u5e38\u89c1\u7684\u4e1a\u52a1\u529f\u80fd\uff0c\u5c06\u7ed3\u679c\u6839\u636e\u6307\u5b9a\u7684\u5b57\u6bb5\u6392\u5e8f\uff0c\u6ee1\u8db3\u524d\u7aef\u5c55\u793a\u7684\u9700\u6c42\u3002</p> <ul> <li>\u901a\u8fc7\u6709\u5e8f\u7d22\u5f15\u987a\u5e8f\u626b\u63cf\u76f4\u63a5\u8fd4\u56de\u6709\u5e8f\u6570\u636e</li> </ul> <p>\u56e0\u4e3a\u7d22\u5f15\u7684\u6570\u636e\u7ed3\u6784\u662f B+\u6811\uff0c\u7d22\u5f15\u4e2d\u7684\u6570\u636e\u662f\u5929\u7136\u6709\u5e8f\u7684\uff0c\u6240\u4ee5\u901a\u8fc7 where \u8fc7\u6ee4\u540e\u7684\u7ed3\u679c\u96c6\u5982\u679c\u5df2\u7ecf\u6709\u5e8f\uff0c\u5c31\u80fd\u907f\u514d\u989d\u5916\u7684\u6392\u5e8f\u5f00\u9500\u64cd\u4f5c\u3002</p> <p>\u4f7f\u7528<code>EXPLAIN</code>\u5206\u6790\u67e5\u8be2\u65f6\uff0cExtra \u663e\u793a\u4e3a<code>Using index</code>\u8868\u793a\u7528\u5230\u4e86\u7d22\u5f15\u7684\u6392\u5e8f</p> <p>\u6bd4\u5982\u8fd9\u6837\u7684\u4f8b\u5b50\uff1a</p> <pre><code>-- \u626b\u63cf\u6574\u4e2a\u7d22\u5f15\u56de\u8868\u6765\u67e5\u627e\u7d22\u5f15\u4e2d\u6ca1\u6709\u7684\u5217\uff0c\u53ef\u80fd\u6bd4\u626b\u63cf\u8868\u5e76\u5bf9\u7ed3\u679c\u8fdb\u884c\u6392\u5e8f\u5f00\u9500\u66f4\u9ad8\uff0c\u53ef\u80fd\u4e0d\u4f1a\u7528\u7d22\u5f15\u3002\nSELECT * FROM t1\n  ORDER BY key_part1, key_part2;\n\n\n-- \u7d22\u5f15\u5217(key_part1 , key_part2)\n\n--\u5982\u679c\u662fInnoDB\u8868\uff0c\u90a3\u4e48\u4e3b\u952e\u503c\u4e5f\u9690\u542b\u5728\u662f\u7d22\u5f15\u4e2d\uff0c\u65e0\u9700\u56de\u8868\uff0c\u8fd9\u79cd\u67e5\u8be2\u4e00\u822c\u90fd\u53ef\u4ee5\u4f7f\u7528\u7d22\u5f15\u76f4\u63a5\u6392\u5e8f\nSELECT pk, key_part1, key_part2 FROM t1\n  ORDER BY key_part1, key_part2;\n\n-- key_part1\u662f\u5e38\u91cf\u67e5\u627e\uff0c\u6240\u6709\u901a\u8fc7\u7d22\u5f15\u8bbf\u95ee\u5230\u7684\u8bb0\u5f55\u90fd\u4f1a\u6309\u7167key_part2\u6765\u6392\u5e8f\u3002\n-- \u5e76\u4e14\u5982\u679cwhere\u5b50\u53e5\u6709\u8db3\u591f\u7684\u9009\u62e9\u6027\u4f7f\u5f97\u7d22\u5f15\u8303\u56f4\u626b\u63cf\u6bd4\u5168\u8868\u626b\u63cf\u5f00\u9500\u66f4\u5c0f\u7684\u8bdd\uff0c\u90a3\u4e48\u8986\u76d6\u4e86(key_part1, key_part2)\u7684\u590d\u5408\u7d22\u5f15\u5c31\u53ef\u4ee5\u907f\u514d\u6392\u5e8f\u64cd\u4f5c\u3002\nSELECT * FROM t1\n  WHERE key_part1 = constant\n  ORDER BY key_part2;\n\n\n  SELECT * FROM t1\n  WHERE key_part1 &gt; constant\n  ORDER BY key_part1 ASC;\n</code></pre> <ul> <li>Filesort \u6392\u5e8f\uff0c\u5bf9\u8fd4\u56de\u7684\u6570\u636e\u8fdb\u884c\u6392\u5e8f</li> </ul> <p>\u4e0d\u662f\u901a\u8fc7\u7d22\u5f15\u76f4\u63a5\u8fd4\u56de\u7684\u5df2\u6392\u597d\u5e8f\u7ed3\u679c\u7684\u64cd\u4f5c\u90fd\u662f<code>Filesort</code>\u6392\u5e8f\uff0c\u4e5f\u5c31\u662f\u8bf4\u8fdb\u884c\u4e86\u989d\u5916\u7684\u6392\u5e8f\u64cd\u4f5c\u3002</p> <p>\u4e3a\u4e86\u83b7\u53d6\u7528\u4e8e <code>filesort</code> \u64cd\u4f5c\u7684\u5185\u5b58\uff0c\u4f18\u5316\u5668\u4f1a\u9884\u5148\u5206\u914d\u4e00\u4e2a\u56fa\u5b9a\u5927\u5c0f\u4e3a<code>sort_buffer_size</code>\u4e2a\u5b57\u8282\u3002\u6bcf\u4e2a <code>session</code> \u4f1a\u8bdd\u53ef\u4ee5\u901a\u8fc7\u6539\u53d8\u8fd9\u4e2a\u503c\u6765\u907f\u514d\u8fc7\u5ea6\u7684\u5185\u5b58\u6d88\u8017\uff0c\u6216\u8005\u5728\u5fc5\u8981\u65f6\u5206\u914d\u66f4\u591a\u5185\u5b58\u3002</p> <p>\u4f7f\u7528<code>EXPLAIN</code>\u5206\u6790\u67e5\u8be2\u65f6\uff0cExtra \u663e\u793a\u4e3a<code>Using filesort</code>\u8868\u793a\u6ca1\u6709\u7528\u5230\u7d22\u5f15\uff0c\u7528\u5230\u4e86\u989d\u5916\u7684\u6392\u5e8f</p> <p>\u5176\u5b9e MySQL \u4f1a\u7ed9\u6bcf\u4e2a\u7ebf\u7a0b\u5206\u914d\u4e00\u5757\u5185\u5b58\u7528\u4e8e\u6392\u5e8f\uff0c\u79f0\u4e3a sort_buffer\uff0c\u7531<code>sort_buffer_size</code>\u8fd9\u4e2a\u53c2\u6570\u63a7\u5236\uff0c\u9ed8\u8ba4\u662f 256KB\u3002</p>"},{"location":"foundmental/2.MySQL%E7%B4%A2%E5%BC%95/#order-by","title":"ORDER BY \u4f18\u5316\u7684\u6838\u5fc3\u539f\u5219","text":""},{"location":"foundmental/2.MySQL%E7%B4%A2%E5%BC%95/#_38","title":"\u5168\u5b57\u6bb5\u6392\u5e8f/\u5355\u8def\u6392\u5e8f","text":"<p>\u300c\u5168\u5b57\u6bb5\u6392\u5e8f\u662f\u6307\uff0c\u53ea\u8981\u4e0e\u6700\u7ec8\u7ed3\u679c\u96c6\u6709\u5173\u7684\u5b57\u6bb5\u90fd\u4f1a\u88ab\u653e\u8fdb<code>sort_buffer</code>\uff0c\u800c\u4e0d\u7ba1\u8be5\u5b57\u6bb5\u672c\u8eab\u662f\u5426\u53c2\u4e0e\u6392\u5e8f\u3002\u300d</p> <pre><code>CREATE TABLE 't' (\n    'id' INT(11) NOT NULL ,\n    'city' VARCHAR(16) NOT NULL,\n    'name' VARCHAR(16) NOT NULL,\n    'age' VARCHAR(16) NOT NULL,\n    'addr' VARCHAR(128) DEFAULT NOT NULL ,\n    PRIMARY KEY('id'),\n    KEY 'city'('city')\n)ENGINE = InnoDB;\n\n-- \u67e5\u8be2city\u662f\"\u676d\u5dde\"\u7684\u6240\u6709\u4eba\u540d\u5b57\uff0c\u5e76\u4e14\u6309\u7167name\u6392\u5e8f\u8fd4\u56de\u524d 1000 \u4e2a\u4eba\u7684name\u3001age\nSELECT city,name,age FROM t WHERE city = '\u676d\u5dde' ORDER BY  name LIMIT 1000;\n</code></pre> <p>\u4e3a\u4e86\u907f\u514d\u5168\u8868\u626b\u63cf\uff0c\u9700\u8981\u5728<code>city</code>\u5b57\u6bb5\u4e0a\u52a0\u4e0a\u7d22\u5f15</p> <p>\u5047\u8bbe\u6ee1\u8db3<code>city = '\u676d\u5dde'</code>\u6761\u4ef6\u7684\u884c\u662f\u4ece<code>ID_X</code>\u5230<code>ID_(X+N)</code>\u7684\u8fd9\u4e9b\u8bb0\u5f55\u3002</p> <p>\u6267\u884c\u6d41\u7a0b\uff1a</p> <ol> <li>\u521d\u59cb\u5316 sort_buffer\uff0c\u786e\u5b9a\u653e\u5165<code>name</code>\u3001<code>city</code>\u3001<code>age</code>\u4e09\u4e2a\u5b57\u6bb5;</li> <li>\u4ece\u7d22\u5f15 city \u627e\u5230\u7b2c\u4e00\u4e2a\u6ee1\u8db3 <code>city = '\u676d\u5dde'</code> \u6761\u4ef6\u7684\u4e3b\u952e<code>id</code>\uff0c\u5176\u503c\u4e5f\u5c31\u662f<code>ID_X</code>;</li> <li>\u5230\u4e3b\u952e id \u7d22\u5f15\u53d6\u51fa\u6574\u884c\uff0c\u53d6 name\u3001city\u3001age \u4e09\u4e2a\u5b57\u6bb5\u503c\uff0c\u5b58\u5165 sort_buffer;</li> <li>\u4ece\u7d22\u5f15 city \u53d6\u4e0b\u4e00\u4e2a\u8bb0\u5f55\u7684\u4e3b\u952e id;</li> <li>\u91cd\u590d step3\u30014 \u76f4\u5230 city \u7684\u503c\u4e0d\u6ee1\u8db3\u67e5\u8be2\u6761\u4ef6\u4e3a\u6b62\uff0c\u5bf9\u5e94\u7684 ID(X+N);</li> <li>\u5bf9<code>sort_buffer</code>\u4e2d\u7684\u6570\u636e\u6309\u7167\u5b57\u6bb5<code>name</code>\u505a\u5feb\u901f\u6392\u5e8f\uff08MySQL \u5185\u90e8\u4f7f\u7528\u662f\u7684**\u5feb\u6392\u7b97\u6cd5**\uff09</li> <li>\u6309\u7167\u6392\u5e8f\u7ed3\u679c\u53d6\u524d 1000 \u884c\u8fd4\u56de\u7ed9\u5ba2\u6237\u7aef</li> </ol> <p>tips\uff0csort_buffer \u662f MySQL \u5206\u914d\u7ed9\u6bcf\u4e2a\u7ebf\u7a0b\u7528\u4e8e\u6392\u5e8f\u7684\u5185\u5b58\u3002 <code>sort_buffer</code>\u662f MySQL \u5206\u914d\u7ed9\u6bcf\u4e2a\u7ebf\u7a0b\u7528\u4e8e\u6392\u5e8f\u7684\u5185\u5b58\u3002\u7531\u53c2\u6570<code>sort_buffer_size</code>\u63a7\u5236\u5176\u5927\u5c0f\uff0c\u5982\u679c\u8981\u6392\u5e8f\u7684\u6570\u636e\u91cf\u5c0f\u4e8e<code>sort_buffer_size\uff0c</code>\u6392\u5e8f\u5c31\u5728\u5185\u5b58\u4e2d\u5b8c\u6210\uff0c\u5982\u679c\u6392\u5e8f\u6570\u636e\u91cf\u8fc7\u5927\uff0c\u5c31\u5f97\u4f7f\u7528\u5916\u90e8\u6587\u4ef6\uff08\u4e00\u822c\u78c1\u76d8\u4e34\u65f6\u6587\u4ef6\uff09\u8f85\u52a9\u6392\u5e8f\u3002\u5916\u90e8\u6392\u5e8f\u4e00\u822c\u4f7f\u7528**\u5f52\u5e76\u6392\u5e8f\u7b97\u6cd5**\u3002</p> <p>\u5148\u5047\u8bbe\u6570\u636e\u90fd\u662f\u4ee5\u9875(page)\u7684\u5f62\u5f0f\u5b58\u653e\u5728\u6587\u4ef6\u7cfb\u7edf\u4e2d\uff0c\u5e76\u4e14\u4ee5\u9875\u7684\u5f62\u5f0f\u8bfb\u53d6\u5230\u5185\u5b58\u4e2d(\u5373\uff0c\u6bcf\u6b21\u8bfb\u53d6\u7684\u6700\u5c0f\u5355\u4f4d\u4e3a 1 \u9875)\u3002</p> <p>\u5916\u90e8\u5f52\u5e76\u6392\u5e8f\u7684\u601d\u8def\u548c\u5f52\u5e76\u6392\u5e8f(merge sort)\u4e00\u6837\uff0c\u90fd\u662f\u5229\u7528\u4e86\u5206\u6cbb\u7b97\u6cd5\u3002\u6574\u4e2a\u7b97\u6cd5\u5206\u6210\u4e24\u4e2a\u9636\u6bb5\uff1a</p> <ul> <li> <p>\u9636\u6bb5\u4e00\uff1a\u628a\u6240\u6709\u6570\u636e\u5206\u6210\u5c0f\u6bb5\uff0c\u5e76\u5bf9\u6bcf\u4e00\u6bb5\u8fdb\u884c\u6392\u5e8f(\u8fd9\u91cc\u5047\u8bbe\u6bcf\u4e00\u5c0f\u6bb5\u90fd\u80fd\u591f\u5b58\u653e\u5728\u5185\u5b58\u4e2d\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u7528\u5404\u79cd\u6392\u5e8f\u7b97\u6cd5\u5b9e\u73b0);</p> </li> <li> <p>\u9636\u6bb5\u4e8c\uff1a\u628a\u6bcf\u4e00\u5c0f\u6bb5\u9010\u6e10\u5408\u5e76\uff0c\u6700\u7ec8\u5b8c\u6210\u5168\u90e8\u6392\u5e8f\u3002</p> </li> </ul> <p>\u7b80\u5355\u8bf4\uff0c\u5c31\u662f\u901a\u8fc7\u7d22\u5f15\u5b57\u6bb5\u67e5\u627e\u7b26\u5408\u6761\u4ef6\u7684\u8bb0\u5f55\u4e4b\u540e\uff0c\u7136\u540e\u628a\u7ed3\u679c\u96c6\u9700\u8981\u7684\u5168\u90e8\u5b57\u6bb5\u90fd\u52a0\u8f7d\u5230\u5185\u5b58\u3002\u6700\u540e\u518d\u6392\u5e8f\u3002</p> <p>\u663e\u800c\u6613\u89c1\uff0c\u5168\u5b57\u6bb5\u6392\u5e8f\u65b9\u6cd5\u7f3a\u70b9\uff1a\u5355\u884c\u5927\u7684\u8bdd\u5360\u7528\u5185\u5b58\u7a7a\u95f4\u3002</p> <p>\u53ef\u4ee5\u770b\u5230\u5f53\u67e5\u8be2\u6761\u4ef6\u672c\u8eab\u6709\u7d22\u5f15\u53ef\u7528\u7684\u8bdd\uff0c\u5168\u5b57\u6bb5\u6392\u5e8f\u7684\u6392\u5e8f\u8fc7\u7a0b\u90fd\u5728 sort buffer\uff08\u5185\u5b58\uff09\u8fdb\u884c\uff0c\u56de\u8868\u6b21\u6570\u4e3a\u7b26\u5408\u6761\u4ef6\u7684\u6570\u636e\u4e2a\u6570\u3002</p> <p>\u5f53\u7136\uff0c\u5982\u679c\u6211\u4eec\u5efa\u7acb\u7684\u662f<code>(city\u3001name\u3001age)</code>\u7684\u8054\u5408\u7d22\u5f15\uff0c\u8fd8\u53ef\u4ee5\u5b9e\u73b0\"\u7d22\u5f15\u8986\u76d6\"\uff0c\u5373\u5728\u4e00\u68f5\u7d22\u5f15\u6811\u4e0a\u53d6\u5f97\u5168\u90e8\u6240\u9700\u6570\u636e\uff0c\u51cf\u5c11\u56de\u8868\uff08\u968f\u673a\u8bfb\uff09\u6b21\u6570\u3002</p> <p>\u4e0d\u8fc7\u9488\u5bf9\u6bcf\u4e2a\u67e5\u8be2\u6216\u6392\u5e8f\u8bed\u53e5\u5efa\u7acb\u8054\u5408\u7d22\u5f15\uff0c\u4f1a\u5bfc\u81f4\u7d22\u5f15\u8fc7\u591a\uff0c\u5927\u5927\u964d\u4f4e\u5199\u5165\u66f4\u65b0\u6570\u636e\u7684\u901f\u5ea6\uff0c\u4ee5\u53ca\u5927\u5927\u63d0\u5347\u6570\u636e\u6240\u9700\u8981\u7684\u5b58\u50a8\u7a7a\u95f4\u3002</p> <p>\u751f\u4ea7\u4e0a\u5bf9\u7d22\u5f15\u7684\u5efa\u7acb\u4fee\u6539\u9700\u8981\u683c\u5916\u8c28\u614e\u3002</p>"},{"location":"foundmental/2.MySQL%E7%B4%A2%E5%BC%95/#rowid","title":"rowid \u6392\u5e8f/\u53cc\u8def\u6392\u5e8f","text":"<p>rowId \u5c31\u662f MySQL \u5bf9\u6bcf\u884c\u6570\u636e\u7684\u552f\u4e00\u6807\u8bc6\u7b26\u3002</p> <p>\u5f53\u6570\u636e\u8868\u6709\u4e3b\u952e\u65f6\uff0crowId \u5c31\u662f\u8868\u4e3b\u952e\uff1b\u5f53\u6570\u636e\u8868\u6ca1\u6709\u4e3b\u952e\u6216\u8005\u4e3b\u952e\u88ab\u5220\u9664\u65f6\uff0cMySQL \u4f1a\u81ea\u52a8\u751f\u6210\u4e00\u4e2a\u957f\u5ea6\u4e3a 6 \u5b57\u8282\u7684 rowId \u4e3a\u4f5c\u4e3a rowId\u3002</p> <p>\u300crowId \u6392\u5e8f\u662f\u6307\u53ea\u5c06\u4e0e\u6392\u5e8f\u76f8\u5173\u7684\u5b57\u6bb5\u548c rowId \u653e\u5165 sort buffer\uff0c\u5176\u4f59\u7ed3\u679c\u96c6\u9700\u8981\u7528\u5230\u7684\u6570\u636e\u5728\u6392\u5e8f\u5b8c\u6210\u540e\uff0c\u901a\u8fc7 rowId \u56de\u8868\u53d6\u5f97\u3002\u300d</p> <p>\u5168\u5b57\u6bb5\u6392\u5e8f\u7684\u6d41\u7a0b\u770b\u7740\u5df2\u7ecf\u5341\u5206\u5408\u7406\uff0c\u4e3a\u4ec0\u4e48\u8fd8\u9700\u8981\u6709\u4e2a rowId \u6392\u5e8f\uff1f</p> <p>\u8fd9\u662f\u6211\u4eec\u53ea\u9700\u8981\u8f93\u51fa\u4e09\u4e2a\u5b57\u6bb5\u7684\u60c5\u51b5\uff0c\u5047\u5982\u6211\u4eec\u6709\u4e0a\u767e\u4e2a\u5b57\u6bb5\u9700\u8981\u8fd4\u56de\u5462\uff1fsort buffer \u9ed8\u8ba4\u53ea\u6709 256 KB\u3002\u80fd\u591f\u88c5\u4e0b\u591a\u5c11\u884c\u7684\u539f\u59cb\u6570\u636e\u884c\uff1f</p> <p>\u6240\u4ee5\u5f53\u5f85\u6392\u5e8f\u7684\u6570\u636e\u884c\u5f88\u5927\u7684\u65f6\u5019\uff0c\u4f7f\u7528\u5168\u5b57\u6bb5\u6392\u5e8f\u5fc5\u7136\u4f1a\u5bfc\u81f4\"\u5916\u90e8\u6392\u5e8f\"\u3002\u800c\u4e14\u662f\u4f7f\u7528\u5f88\u591a\u4e34\u65f6\u6587\u4ef6\u7684\"\u5916\u90e8\u6392\u5e8f\"\uff0c\u6548\u7387\u5f88\u4f4e\u4e0b\u3002</p> <p>\u76f8\u6bd4\u5168\u5b57\u6bb5\u6392\u5e8f\uff0crowId \u6392\u5e8f\u7684\u597d\u5904\u662f\u5728<code>sort buffer</code>\u5927\u5c0f\u56fa\u5b9a\u7684\u60c5\u51b5\u4e0b\uff0c<code>sort buffer</code>\u80fd\u591f\u5bb9\u7eb3\u66f4\u591a\u7684\u6570\u636e\u884c\uff0c\u80fd\u591f\u907f\u514d\u4f7f\u7528\u6216\u8005\u5c11\u4f7f\u7528\"\u5916\u90e8\u6392\u5e8f\u6587\u4ef6\"\u3002</p> <p>\u7f3a\u70b9\u662f\u6700\u7ec8\u8fd4\u56de\u7ed3\u679c\u96c6\u7684\u65f6\u5019\uff0c\u9700\u8981\u518d\u6b21\u8fdb\u884c**\u56de\u8868**\u3002</p> <pre><code>SELECT nick_name, age, phone\nFROM t_user\nWHERE city = \"\u6df1\u5733\"\nORDER BY nick_name;\n</code></pre> <p>rowId \u6392\u5e8f\u5168\u8fc7\u7a0b\uff1a</p> <ol> <li>\u4ece city \u7d22\u5f15\u6811\u4e0a\u627e\u5230\u7b2c\u4e00\u6761\u503c\u4e3a\u6df1\u5733\u7684\u6570\u636e\uff0c\u53d6\u5f97 id \u4e4b\u540e\u56de\u8868\uff08\u56de\u5230\u4e3b\u952e\u7d22\u5f15\uff09\u53d6\u5f97 nick_name \u8fd9\u4e2a\u4e0e\u6392\u5e8f\u76f8\u5173\u7684\u5b57\u6bb5\u548c\u4e3b\u952e id \u4e00\u8d77\u653e\u5165 sort buffer</li> <li>\u4ece city \u7d22\u5f15\u6811\u53d6\u4e0b\u4e00\u6761\u503c\u4e3a\u6df1\u5733\u7684\u6570\u636e\uff0c\u91cd\u590d 1 \u8fc7\u7a0b\uff0c\u76f4\u5230\u4e0b\u4e00\u6761\u6570\u636e\u4e0d\u6ee1\u8db3\u503c\u4e3a\u6df1\u5733\u6761\u4ef6</li> <li>\u8fd9\u65f6\u5019\uff0c\u6240\u6709 city = \u6df1\u5733 \u7684\u6570\u636e\u90fd\u5728 sort buffer \u4e86\uff08sort buffer \u91cc\u9762\u7684\u6570\u636e\u5305\u542b\u4e24\u4e2a\u5b57\u6bb5\uff1aid \u548c nick_name\uff09\u3002\u5bf9 nick_name \u6267\u884c\u5feb\u901f\u6392\u5e8f</li> <li>\u5229\u7528\u6392\u5e8f\u597d\u7684\u6570\u636e\uff0c\u4f7f\u7528\u4e3b\u952e id \u518d\u6b21\u56de\u8868\u53d6\u5176\u4ed6\u5b57\u6bb5\uff0c\u5c06\u7ed3\u679c\u8fd4\u56de</li> </ol> <p>\u6ce8\u610f\uff1a\u5728\u6b65\u9aa4 4 \u4e2d\u4e0d\u4f1a\u7b49\u6240\u6709\u6392\u5e8f\u597d\u7684 id \u56de\u8868\u5b8c\u518d\u8fd4\u56de\uff0c\u800c\u662f\u6bcf\u4e2a id \u56de\u8868\u4e00\u6b21\uff0c\u53d6\u5f97\u8be5\u884c\u6570\u636e\u4e4b\u540e\u7acb\u5373\u8fd4\u56de\uff0c\u6240\u4ee5\u4e0d\u4f1a\u6d88\u8017\u989d\u5916\u7684\u5185\u5b58\u3002</p> <p>\u53c2\u8003 1</p> <p>\u53c2\u8003 2</p>"},{"location":"foundmental/2.MySQL%E7%B4%A2%E5%BC%95/#_39","title":"\u4f18\u5148\u961f\u5217\u6392\u5e8f","text":"<p>\u65e0\u8bba\u662f\u4f7f\u7528\u5168\u5b57\u6bb5\u6392\u5e8f\u8fd8\u662f <code>rowId</code> \u6392\u5e8f\uff0c\u90fd\u4e0d\u53ef\u907f\u514d\u4e86\u5bf9\u6240\u6709\u7b26\u5408 <code>WHRER</code> \u6761\u4ef6\u7684\u6570\u636e\u8fdb\u884c\u4e86\u6392\u5e8f\u3002\u5982\u679c\u6211\u4eec\u8fd8\u642d\u914d\u7740 LIMIT \u4f7f\u7528\u5462\uff1f</p> <p>\u4f8b\u5982\u6211\u4eec\u5728\u6392\u5e8f\u8bed\u53e5\u540e\u6dfb\u52a0 LIMIT 3 \uff0c\u54ea\u6015\u67e5\u51fa\u6765\u7684\u6570\u636e\u6709 10W \u884c\uff0c\u6211\u4eec\u4e5f\u53ea\u9700\u8981\u524d 3 \u884c\u6709\u5e8f\u3002</p> <p>\u4e3a\u4e86\u5f97\u5230\u524d 3 \u884c\u6570\u636e\uff0c\u800c\u4e0d\u5f97\u4e0d\u5c06 10W \u884c\u6570\u636e\u8f7d\u5165\u5185\u5b58\uff0c\u5927\u5927\u964d\u4f4e\u4e86 sort buffer \u7684\u5229\u7528\u7387\u3002</p> <p>\u8fd9\u65f6\u5019\u4f60\u53ef\u80fd\u60f3\u5230\u5229\u7528\"\u6700\u5c0f\u5806\"\u3001\"\u6700\u5927\u5806\"\u6765\u8fdb\u884c\u6392\u5e8f\u3002</p> <p>\u6ca1\u9519\uff0c\u8fd9\u6b63\u662f MySQL \u9488\u5bf9\u5e26\u6709 LIMIT \u7684 ORDER BY \u8bed\u53e5\u7684\u4f18\u5316\uff1a\u4f7f\u7528\u4f18\u5148\u961f\u5217\u8fdb\u884c\u6392\u5e8f</p> <p>\u53c2\u8003 3</p>"},{"location":"foundmental/2.MySQL%E7%B4%A2%E5%BC%95/#_40","title":"\u5982\u4f55\u9009\u62e9?","text":"<p>\u73b0\u5728\u6211\u4eec\u77e5\u9053\u6709\u5168\u5b57\u6bb5\u6392\u5e8f\u548c <code>rowId</code> \u6392\u5e8f\uff0c\u90a3\u4e48 <code>MySQL</code> \u662f\u5982\u4f55\u5728\u8fd9\u4e24\u79cd\u6392\u5e8f\u65b9\u6848\u4e2d\u505a\u9009\u62e9\u5462\uff1f</p> <p>\u7531\u4e8e <code>rowId</code> \u6392\u5e8f\u76f8\u5bf9\u4e8e\u5168\u5b57\u6bb5\u6392\u5e8f\uff0c\u4e0d\u53ef\u907f\u514d\u7684\u591a\u4e86\u4e00\u6b21\u56de\u8868\u64cd\u4f5c\uff0c\u56de\u8868\u64cd\u4f5c\u610f\u5473\u7740\u968f\u673a\u8bfb\uff0c\u800c\u968f\u673a IO \u662f\u6570\u636e\u5e93\u4e2d\u6700\u6602\u8d35\u7684\u64cd\u4f5c\u3002</p> <p>\u6240\u4ee5 <code>MySQL</code> \u4f1a\u5728\u5c3d\u53ef\u80fd\u7684\u60c5\u51b5\u4e0b\u9009\u62e9\u5168\u5b57\u6bb5\u6392\u5e8f\u3002</p> <p>\u90a3\u4e48\u4ec0\u4e48\u60c5\u51b5\u4e0b <code>MySQL</code> \u4f1a\u9009\u62e9 <code>rowId</code> \u6392\u5e8f\u5462\uff0c\u662f\u5426\u6709\u5177\u4f53\u7684\u503c\u53ef\u4ee5\u91cf\u5ea6\uff1f</p> <p>\u7b54\u6848\u662f\u6709\u7684\uff0c\u901a\u8fc7\u53c2\u6570<code>max_length_for_sort_data</code>\u53ef\u4ee5\u63a7\u5236\u7528\u4e8e\u6392\u5e8f\u7684\u884c\u6570\u636e\u6700\u5927\u957f\u5ea6\uff0c\u9ed8\u8ba4\u503c\u4e3a 1024 \u5b57\u8282\u3002</p> <p>\u5f53\u5355\u884c\u6570\u636e\u957f\u5ea6\u8d85\u8fc7\u8be5\u503c\uff0cMySQL \u5c31\u4f1a\u89c9\u5f97\u5982\u679c\u8fd8\u7528\u5168\u5b57\u6bb5\u6392\u5e8f\uff0c\u4f1a\u5bfc\u81f4 sort buffer \u5bb9\u7eb3\u4e0b\u7684\u884c\u6570\u592a\u5c11\uff0c\u4ece\u800c\u8f6c\u4e3a\u4f7f\u7528 rowId \u6392\u5e8f\u3002</p> <p><code>max_length_for_sort_data</code>\u662f\u4e3a\u4e86\u8ba9 MySQL \u9009\u62e9<code>&lt; sort_key, rowid &gt;</code>\u8fd8\u662f<code>&lt; sort_key, additional_fields &gt;</code>\u7684\u6a21\u5f0f\u3002</p> <p>\u7531\u4e8e\u4f18\u5316\u5668\u7684\u4fee\u6539\uff0c\u5bfc\u81f4\u8be5\u53c2\u6570\u4e0d\u518d\u8d77\u4f5c\u7528\uff0c\u5728 8.0.20 \u7248\u672c\u88ab\u5e9f\u5f03\u3002max_length_for_sort_data \u53ea\u5bf9 8.0.20 \u4e4b\u524d\u7684\u6709\u6548</p> <p>\u90a3\u5982\u679c\u9700\u8981\u6392\u5e8f\u7684\u5b57\u6bb5\u957f\u5ea6\u5f88\u5927\u6216\u8005\u5f53\u4e0d\u5f97\u4e0d\u5bf9 text\u3001blob \u5217\u8fdb\u884c\u6392\u5e8f\u65f6\uff0c\u4f1a\u600e\u4e48\u6837\u5462\uff1f</p> <p>\u901a\u8fc7<code>max_sort_length</code>\u53c2\u6570\u7528\u4e8e\u8bbe\u7f6e\u6392\u5e8f\u65f6\u5b57\u7b26\u4e32\u7684\u6700\u5927\u957f\u5ea6\u3002\u5982\u679c\u6392\u5e8f\u7684\u5b57\u7b26\u4e32\u957f\u5ea6\u8d85\u8fc7\u4e86\u8be5\u53c2\u6570\u8bbe\u7f6e\u7684\u957f\u5ea6\uff0c\u5219\u4f1a\u88ab\u622a\u65ad\u3002\u8be5\u53c2\u6570\u9ed8\u8ba4\u503c\u4e3a 1024\u3002</p> <p>\u5927\u90e8\u5206\u6b63\u5e38\u60c5\u51b5\u4e0b MySQL \u5c31\u4e24\u79cd\u6392\u5e8f\u65b9\u5f0f\u3002\u5982\u679c sort_buffer_size \u591f\u7528\uff0c\u90a3\u4e48\u5c31\u5728\u5185\u5b58\u4e2d\u4f7f\u7528\u5feb\u901f\u6392\u5e8f\u5b8c\u6210\u6392\u5e8f\u3002</p>"},{"location":"foundmental/2.MySQL%E7%B4%A2%E5%BC%95/#_41","title":"\u4e34\u65f6\u8868\u6392\u5e8f","text":"<p>\u901a\u5e38\u5bf9\u4e8e\u4e00\u4e2a\u6267\u884c\u8f83\u6162\u7684\u6392\u5e8f\u8bed\u53e5\uff0c\u5728\u4f7f\u7528 EXPLAIN \u8fdb\u884c\u6267\u884c\u8fc7\u7a0b\u5206\u6790\u7684\u65f6\u5019\u9664\u4e86\u80fd\u770b\u5230<code>Using filesort</code>\u4ee5\u5916\uff0c\u8fd8\u80fd\u770b\u5230<code>Using temporary</code>\uff0c\u4ee3\u8868\u5728\u6392\u5e8f\u8fc7\u7a0b\u4e2d\u4f7f\u7528\u5230\u4e86\u4e34\u65f6\u8868\u3002</p> <p>\u5185\u5b58\u4e34\u65f6\u8868\u6392\u5e8f</p> <p>MySQL \u4f18\u5148\u4f7f\u7528\u5185\u5b58\u4e34\u65f6\u8868\u3002\u5f53 MySQL \u4f7f\u7528\u5185\u5b58\u4e34\u65f6\u8868\u65f6\uff0c\u4e34\u65f6\u8868\u5b58\u50a8\u5f15\u64ce\u4e3a<code>memory</code></p> <p>\u5982\u679c\u5f53\u524d MySQL \u4f7f\u7528\u7684\u662f\u5185\u5b58\u4e34\u65f6\u8868\u7684\u8bdd\uff0c\u5c06\u4f1a\u76f4\u63a5\u4f7f\u7528 rowId \u6392\u5e8f\uff0c\u56e0\u4e3a\u8fd9\u65f6\u5019\u6240\u8c13\u7684\"\u56de\u8868\"\u53ea\u662f\u5728\u5185\u5b58\u8868\u4e2d\u8bfb\u6570\u636e\uff0c\u64cd\u4f5c\u4e0d\u6d89\u53ca\u786c\u76d8\u7684\u968f\u673a IO \u8bfb\u3002</p> <p>\u4f7f\u7528 rowId \u53ef\u4ee5\u5728 sort buffer \u5bb9\u7eb3\u7ed9\u591a\u7684\u884c\uff0c\u907f\u514d\u6216\u51cf\u5c11\u5916\u90e8\u6392\u5e8f\u6587\u4ef6\u7684\u4f7f\u7528\u3002</p> <p>\u78c1\u76d8\u4e34\u65f6\u8868\u6392\u5e8f</p> <p>\u5982\u679c\u7cfb\u7edf\u4e2d\u5f88\u591a\u9700\u8981\u4f7f\u7528\u4e34\u65f6\u8868\u7684\u6392\u5e8f\u8bed\u53e5\u6267\u884c\uff0c\u800c\u53c8\u4e0d\u52a0\u4ee5\u9650\u5236\uff0c\u5168\u90fd\u4f7f\u7528\u4e34\u65f6\u8868\u7684\u8bdd\uff0c\u5185\u5b58\u5f88\u5feb\u5c31\u4f1a\u88ab\u6253\u6ee1\u3002</p> <p>\u6240\u4ee5 MySQL \u63d0\u4f9b\u4e86<code>tmp_table_size</code>\u53c2\u6570\u9650\u5236\u4e86\u5185\u5b58\u4e34\u65f6\u8868\u7684\u5927\u5c0f\uff0c\u9ed8\u8ba4\u503c\u662f 16M\u3002\u5982\u679c\u4e34\u65f6\u8868\u5927\u5c0f\u8d85\u8fc7\u4e86 tmp_table_size\uff0c\u90a3\u4e48\u5185\u5b58\u4e34\u65f6\u8868\u5c31\u4f1a\u8f6c\u6210\u78c1\u76d8\u4e34\u65f6\u8868\u3002</p> <p>\u5f53\u4f7f\u7528\u78c1\u76d8\u4e34\u65f6\u8868\u7684\u65f6\u5019\uff0c\u8868\u50a8\u5b58\u5f15\u64ce\u5c06\u4e0d\u518d\u662f memory\uff0c\u800c\u662f\u7531<code>internal_tmp_disk_storage_engine</code>\u53c2\u6570\u63a7\u5236\uff0c\u9ed8\u8ba4\u4e3a InnoDB \u3002</p> <p>\u8fd9\u65f6\u5019 MySQL \u4f1a\u6839\u636e\u5355\u884c\u5927\u5c0f\u662f\u5426\u8d85\u8fc7 max_length_for_sort_data \u51b3\u5b9a\u91c7\u7528\u5168\u5b57\u6bb5\u6392\u5e8f\u8fd8\u662f rowId \u6392\u5e8f\u3002</p>"},{"location":"foundmental/2.MySQL%E7%B4%A2%E5%BC%95/#orderby","title":"orderby \u4e2d\u7684\u4e00\u4e9b\u5c0f\u5751","text":"<p>MySQL \u4e2d\uff0corder by \u548c limit \u4f7f\u7528\u65f6\u6709\u4e00\u4e9b\u5c0f\u5751\uff0c\u4e00\u5b9a\u8981\u6ce8\u610f\u3002</p> <p>\u95ee\u9898\uff1aORDER BY \u6392\u5e8f\u540e\uff0c\u7528 LIMIT \u53d6\u524d\u51e0\u6761\uff0c\u53d1\u73b0\u8fd4\u56de\u7684\u7ed3\u679c\u96c6\u7684\u987a\u5e8f\u4e0e\u9884\u671f\u7684\u4e0d\u4e00\u6837\u3002</p> <pre><code>--\u5148\u8bf4\u73b0\u8c61\uff1a\u5f53order by\u6392\u5e8f\u5b57\u6bb5\u5b58\u5728\u91cd\u590d\u65f6\uff0c\u4e0d\u5e26limit\u53ef\u4ee5\u6b63\u5e38\u6392\u5e8f\u3002\u5e26\u4e86limit\u53d1\u73b0\u4e71\u5e8f\u4e86\u3002\n\nselect * from ratings order by category;\nselect * from ratings order by category limit 5\n</code></pre> <p>\u5173\u4e8e\u8fd9\u4e2a\u73b0\u8c61\uff0c\u5b98\u7f51\u4e2d\u6709\u4e00\u6bb5\u63cf\u8ff0\u3002</p> <p>\u5728\u4f7f\u7528 ORDER BY \u5bf9\u5217\u8fdb\u884c\u6392\u5e8f\u65f6\uff0c\u5982\u679c\u5bf9\u5e94\uff08ORDER BY \u7684\u5217\uff09\u5217\u5b58\u5728\u591a\u884c\u76f8\u540c\u6570\u636e\uff0cMySQL Server \u4f1a\u6309\u7167\u4efb\u610f\u987a\u5e8f\u8fd4\u56de\u8fd9\u4e9b\u884c\uff0c\u5e76\u4e14\u53ef\u80fd\u4f1a\u6839\u636e\u6574\u4f53\u6267\u884c\u8ba1\u5212\u4ee5\u4e0d\u540c\u7684\u65b9\u5f0f\u8fd4\u56de\u3002</p> <p>\u5bf9\u4e8e\u8fd9\u79cd\u60c5\u51b5\uff0c\u4e3a\u4e86\u4fdd\u8bc1\u6bcf\u6b21\u90fd\u8fd4\u56de\u7684\u987a\u5e8f\u4e00\u81f4\u53ef\u4ee5\u989d\u5916\u589e\u52a0\u4e00\u4e2a\u6392\u5e8f\u5b57\u6bb5\uff08\u6bd4\u5982\uff1aid\uff09\uff0c\u7528\u4e24\u4e2a\u5b57\u6bb5\u6765\u5c3d\u53ef\u80fd\u51cf\u5c11\u91cd\u590d\u7684\u6982\u7387\u3002\u4e8e\u662f\uff0c\u6539\u6210 order by status, id;</p>"},{"location":"foundmental/2.MySQL%E7%B4%A2%E5%BC%95/#mysql_6","title":"MySQL \u805a\u5408\u4f18\u5316","text":"<p>\u805a\u5408\u7b97\u5b50\u3002\u805a\u5408\u7b97\u5b50\u548c\u805a\u5408\u8bed\u53e5\u7c7b\u578b\u4e00\u4e00\u5bf9\u5e94\uff0c\u90a3\u5e38\u89c1\u7684\u805a\u5408\u8bed\u53e5\u53c8\u6709\u54ea\u4e9b\u5462\uff1f</p> <p>\u9996\u5148\u662f\u5355\u9879\u805a\u5408(scalar aggregation), \u6307\u805a\u5408\u540e\u7684\u7ed3\u679c\u96c6\u662f\u4e00\u4e2a\u5355\u4e00\u503c(\u7ebf\u6027\u4ee3\u6570\u91cc\u79f0\u6807\u91cf)\u3002</p> <p>\u5176\u6b21\u5c31\u662f\u7ec4\u961f\u805a\u5408(group aggregation)\uff0c\u5176\u7ed3\u679c\u662f\u5148\u5bf9\u6240\u6709\u6570\u636e\u6839\u636e group by \u952e\u5206\u7ec4\uff0c\u7136\u540e\u5bf9\u6bcf\u4e2a\u7ec4\u5206\u522b\u8ba1\u7b97\u805a\u5408\u503c\u3002</p> <p>\u5728\u65e5\u5e38\u67e5\u8be2\u4e2d\uff0c\u5305\u542b <code>GROUP BY</code> \u5b50\u53e5\u7684\u67e5\u8be2\u6548\u7387\u5f80\u5f80\u8f83\u4f4e\uff0c\u4e3b\u8981\u539f\u56e0\u662f <code>GROUP BY</code> \u64cd\u4f5c\u6d89\u53ca\u4e34\u65f6\u8868\u7684\u6784\u5efa\uff0c\u8fd9\u4f1a\u5f15\u53d1\u9891\u7e41\u7684\u78c1\u76d8 I/O \u64cd\u4f5c\uff0c\u6216\u662f\u5728\u8ba1\u7b97\u805a\u5408\u51fd\u6570\u65f6\u589e\u52a0\u4e86\u989d\u5916\u7684\u8ba1\u7b97\u5f00\u9500\u3002</p> <p>\u4e4d\u770b\u4e4b\u4e0b\uff0c\u4f3c\u4e4e\u662f\u5355\u9879\u805a\u5408\u56e0\u4e3a\u7ed3\u679c\u96c6\u662f\u4e00\u4e2a\u6807\u91cf\uff0c\u6c42\u603b\u5171\u6709\u591a\u5c11\u4e2a\u4e0d\u540c\u7684\u73ed\u7ea7\u3002\u4f46\u5176\u5b9e\uff0c\u8fd9\u4e2a\u8bed\u53e5\u53ef\u4ee5\u770b\u6210\u662f\u4e00\u4e2a\u5355\u9879\u805a\u5408\u548c\u7ec4\u961f\u805a\u5408\u7684\u53e0\u52a0</p>"},{"location":"foundmental/2.MySQL%E7%B4%A2%E5%BC%95/#mysql-count","title":"MySQL count \u4f18\u5316","text":"<pre><code>select count(*) from api_runtime_log;\n</code></pre> <p>\u5728 InnoDB \u5b58\u50a8\u5f15\u64ce**\u4e2d\uff0c**count(*) \u51fd\u6570\u662f\u5148\u4ece\u5185\u5b58\u4e2d\u8bfb\u53d6\u6570\u636e\u5230**\u5185\u5b58\u7f13\u51b2\u533a**\uff0c\u7136\u540e\u8fdb\u884c\u626b\u63cf\u83b7\u5f97\u884c\u8bb0\u5f55\u6570\u3002</p> <ul> <li>\u8fd9\u91cc InnoDB \u4f1a**\u4f18\u5148\u8d70\u4e8c\u7ea7\u7d22\u5f15**\uff1b</li> <li>\u5982\u679c\u540c\u65f6\u5b58\u5728\u591a\u4e2a\u4e8c\u7ea7\u7d22\u5f15\uff0c\u4f1a\u9009\u62e9**key_len \u6700\u5c0f**\u7684\u4e8c\u7ea7\u7d22\u5f15\uff1b</li> <li>\u5982\u679c\u4e0d\u5b58\u5728\u4e8c\u7ea7\u7d22\u5f15\uff0c\u90a3\u4e48\u4f1a\u8d70**\u4e3b\u952e\u7d22\u5f15**\uff1b</li> <li>\u5982\u679c\u8fde\u4e3b\u952e\u90fd\u4e0d\u5b58\u5728\uff0c\u90a3\u4e48\u5c31\u8d70**\u5168\u8868\u626b\u63cf**\uff01</li> </ul>"},{"location":"foundmental/2.MySQL%E7%B4%A2%E5%BC%95/#mysql_7","title":"MySQL \u6570\u636e\u8f6c\u578b","text":"<p>\u5b98\u7f51\u624b\u518c</p> <p>MySQL \u4e2d\u6709\u5404\u79cd\u6570\u636e\u7c7b\u578b\uff0c\u5305\u62ec\uff1a\u6570\u5b57\uff0c\u5b57\u7b26\u3001\u5b57\u7b26\u4e32\u3001\u65f6\u95f4 \u7b49\u51e0\u79cd\u5927\u7c7b\u578b\u3002</p> <p>\u5f53\u4e0d\u540c\u7c7b\u578b\u7684\u6570\u636e\u8fdb\u884c\u8ba1\u7b97\u65f6\uff0c\u53ef\u80fd\u4f1a\u53d1\u751f\u9690\u5f0f\u6216\u663e\u5f0f\u8f6c\u6362\u3002\u663e\u5f0f\u8f6c\u6362\u4e00\u822c\u662f\u5404\u79cd\u51fd\u6570\uff1aCONVERT() CAST() \u7b49\u7b49\u3002</p> <p>\u5f53\u64cd\u4f5c\u7b26\u4e0e\u4e0d\u540c\u7c7b\u578b\u7684\u64cd\u4f5c\u6570\u4e00\u8d77\u4f7f\u7528\u65f6\uff0c\u4f1a\u53d1\u751f\u7c7b\u578b\u8f6c\u6362\u4ee5\u4f7f\u64cd\u4f5c\u6570\u517c\u5bb9\u3002</p> <p>\u4e3e\u4e2a\u4f8b\u5b50\uff0c\u5f53\u64cd\u4f5c\u6570\u662f\u5b57\u7b26\u8ddf\u6570\u5b57\u65f6\uff0c MySQL \u4f1a\u6839\u636e\u4f7f\u7528\u7684\u64cd\u4f5c\u7b26\uff0c\u8f6c\u6362\u5b57\u7b26\u5230\u6570\u5b57\u6216\u8f6c\u6362\u6570\u5b57\u6210\u5b57\u7b26\u3002</p> <pre><code>mysql&gt; SELECT 1+'1';\n     -&gt; 2\nmysql&gt; SELECT CONCAT(2,' test');\n     -&gt; '2 test'\n</code></pre>"},{"location":"foundmental/2.MySQL%E7%B4%A2%E5%BC%95/#_42","title":"\u6bd4\u8f83\u64cd\u4f5c\u7684\u9690\u5f0f\u8f6c\u6362","text":"<ul> <li>\u4e24\u4e2a\u53c2\u6570\u81f3\u5c11\u6709\u4e00\u4e2a\u662f NULL \u65f6\uff0c\u6bd4\u8f83\u7684\u7ed3\u679c\u4e5f\u662f NULL\uff0c\u4f8b\u5916\u662f\u4f7f\u7528 &lt;=&gt; \u5bf9\u4e24\u4e2a NULL \u505a\u6bd4\u8f83\u65f6\u4f1a\u8fd4\u56de 1\uff0c\u8fd9\u4e24\u79cd\u60c5\u51b5\u90fd\u4e0d\u9700\u8981\u505a\u7c7b\u578b\u8f6c\u6362\u3002</li> </ul> <pre><code>select 1=NULL   -- \u7ed3\u679c\u4e5f\u662fnull\n</code></pre> <ul> <li> <p>\u4e24\u4e2a\u53c2\u6570\u90fd\u662f\u5b57\u7b26\u4e32\uff0c\u4f1a\u6309\u7167\u5b57\u7b26\u4e32\u6765\u6bd4\u8f83\uff0c\u4e0d\u505a\u7c7b\u578b\u8f6c\u6362</p> </li> <li> <p>\u4e24\u4e2a\u53c2\u6570\u90fd\u662f\u6574\u6570\uff0c\u6309\u7167\u6574\u6570\u6765\u6bd4\u8f83\uff0c\u4e0d\u505a\u7c7b\u578b\u8f6c\u6362</p> </li> <li> <p>\u5b57\u7b26\u4e32\u548c\u6570\u5b57\u6bd4\u8f83\u65f6\uff0c\u4f1a\u5c1d\u8bd5\u5c06\u5b57\u7b26\u4e32\u8f6c\u6362\u4e3a\u6570\u5b57\u3002</p> </li> </ul>"},{"location":"foundmental/2.MySQL%E7%B4%A2%E5%BC%95/#mysql_8","title":"MySQL \u6392\u5e8f\u548c\u6bd4\u8f83\u89c4\u5219","text":""},{"location":"foundmental/2.MySQL%E7%B4%A2%E5%BC%95/#_43","title":"\u5b57\u7b26\u96c6\u548c\u6821\u9a8c\u89c4\u5219","text":""},{"location":"foundmental/2.MySQL%E7%B4%A2%E5%BC%95/#11","title":"1.1\u3001\u4e8c\u8fdb\u5236","text":"<p>binary \u3002\u8ba1\u7b97\u673a\u5e95\u5c42\u5b58\u50a8\u6570\u636e\u53ea\u662f\u4e00\u5927\u5806\u4e8c\u8fdb\u5236\u7684 0 \u548c 1\u3002</p>"},{"location":"foundmental/2.MySQL%E7%B4%A2%E5%BC%95/#12","title":"1.2\u3001\u5b57\u7b26","text":"<p>character \u3002\u73b0\u5728\u6709\u5404\u79cd\u5404\u6837\u7684\u5b57\u7b26\uff0c\u5305\u62ec\u82f1\u6587\u5b57\u6bcd\uff0c\u963f\u62c9\u4f2f\u6570\u5b57\uff0c\u4e2d\u6587\uff0cemoji \u7b49\u7b49\u5404\u79cd\u7279\u6b8a\u5b57\u7b26\u3002</p>"},{"location":"foundmental/2.MySQL%E7%B4%A2%E5%BC%95/#13","title":"1.3 \u5b57\u7b26\u7f16\u7801","text":""},{"location":"foundmental/2.MySQL%E7%B4%A2%E5%BC%95/#14","title":"1.4\u3001\u5b57\u7b26\u96c6","text":"<p>character set \u3002\u60f3\u8981\u628a\u5404\u79cd\u4eba\u7c7b\u53ef\u4ee5\u7406\u89e3\u7684\u5b57\u7b26\u5b58\u50a8\u5230\u8ba1\u7b97\u673a\u4e2d\uff0c\u5c31\u9700\u8981\u5efa\u7acb\u5b57\u7b26\u4e0e\u4e8c\u8fdb\u5236\u6570\u5b57\u7684\u6620\u5c04\u5173\u7cfb\u3002</p> <p>\u5b57\u7b26\u96c6\u5c31\u662f\u8fd9\u6837\u7684\u4e00\u79cd\u6620\u5c04\u5173\u7cfb\uff0c\u4e0d\u540c\u7684\u5b57\u7b26\u96c6\u8868\u793a\u7684\u5b57\u7b26\u6570\u91cf\u4e0d\u540c\uff0c\u5b57\u7b26\u96c6\u8d8a\u5927\uff0c\u6240\u80fd\u8868\u793a\u7684\u5b57\u7b26\u8d8a\u591a\uff0c\u9700\u8981\u5360\u7528\u7684\u4e8c\u8fdb\u5236\u4f4d\u66f4\u591a\uff0c\u9700\u8981\u7684\u78c1\u76d8\u7a7a\u95f4\u5c31\u8d8a\u5927\u3002</p> <p>MySQL \u4e2d\u6240\u652f\u6301\u7684\u5b57\u7b26\u96c6\u5b58\u5728 <code>information_schema.CHARACTER_SETS</code> \u8868\u4e2d\u3002</p> <p>utf8 \u662f MySQL \u4e2d\u7684\u4e00\u79cd\u5b57\u7b26\u96c6\uff0c\u53ea\u652f\u6301\u6700\u957f\u4e09\u4e2a\u5b57\u8282\u7684 UTF-8 \u5b57\u7b26\uff0c\u4e5f\u5c31\u662f Unicode \u4e2d\u7684\u57fa\u672c\u591a\u6587\u672c\u5e73\u9762\u3002</p> <p>\u5176\u4e2d utf8mb4 \u5b57\u7b26\u96c6\u517c\u5bb9\u6027\u6700\u597d\uff0c\u5b83\u53ef\u4ee5\u5b58\u5404\u79cd\u8bed\u8a00\u7684\u5b57\u7b26\uff0c\u5305\u62ec emoji \u8868\u60c5\u7b49\u3002\u4e00\u822c\u90fd\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528 utf8mb4 \u5b57\u7b26\u96c6\u3002</p> <p>\u5b57\u7b26\u96c6\u7684\u4f5c\u7528\u8303\u56f4\uff1a</p> <ul> <li>schema</li> <li>table</li> <li>column</li> </ul>"},{"location":"foundmental/2.MySQL%E7%B4%A2%E5%BC%95/#15","title":"1.5\u3001\u6821\u9a8c\u89c4\u5219(\u6392\u5e8f\u89c4\u5219)","text":"<p>collation \u3002\u68c0\u9a8c\u89c4\u5219\uff0c\u53c8\u79f0\u6392\u5e8f\u89c4\u5219\uff0c\u662f\u7528\u4e8e\u6bd4\u8f83\u5b57\u7b26\u548c\u6392\u5e8f\u7684\u4e00\u5957\u89c4\u5219\uff0c\u5373\u5b57\u7b26\u7684\u6392\u5e8f\u89c4\u5219\u3002\u6bd4\u5982\u6709\u7684\u89c4\u5219\u533a\u5206\u5927\u5c0f\u5199\uff0c\u6709\u7684\u5219\u65e0\u89c6\u3002</p> <p>\u6bd4\u5982\u6211\u4eec\u5728\u6bd4\u8f83</p> <p>\u5982\u679c\u6307\u5b9a\u6821\u9a8c\u89c4\u5219\u4e3a\"\u4e0d\u533a\u5206\u5927\u5c0f\u5199\"\uff0c\u90a3\u4e48 a \u548c A\uff0ce \u548c E \u5c31\u662f\u7b49\u4ef7\u7684\u3002</p> <p>\u4e16\u754c\u4e0a\u7684\u6587\u5b57\u5f88\u591a\uff0c\u6240\u4ee5\u624d\u4f1a\u6709\u201c\u4e0d\u533a\u5206\u97f3\u8c03\u201d\u7684\u8981\u6c42\uff0c\u8fd9\u65f6\u5019 e\u3001\u0113\u3001\u00e9\u3001\u011b\u3001\u00e8 \u5c31\u662f\u7b49\u4ef7\u7684\u3002</p> <p>\u90a3\u4e48\u5047\u8bbe\u6211\u4eec\u8981\u8fdb\u884c\u62fc\u97f3\u67e5\u627e\uff0c\u53ea\u8981\u6309 e \u53bb\u627e\u5c31\u53ef\u4ee5\u5168\u90e8\u5217\u51fa\u6765\uff0c\u5f88\u65b9\u4fbf\u3002\u751a\u81f3\uff0c\u5b83\u4eec\u4e5f\u548c \u00ea\u3001\u00eb \u4e5f\u662f\u7b49\u4ef7\u7684\uff0c\u8fd9\u6837\u5c31\u66f4\u65b9\u4fbf\u4e86\u3002</p> <p>\u6bcf\u79cd\u5b57\u7b26\u96c6\u90fd\u53ef\u80fd\u6709\u591a\u79cd\u68c0\u9a8c\u89c4\u5219\uff0c\u5e76\u4e14\u90fd\u6709\u4e00\u4e2a\u9ed8\u8ba4\u7684\u68c0\u9a8c\u89c4\u5219(information_schema. CHARACTER_SETS.DEFAULT_COLLATE_NAME)</p> <p>\u6bcf\u4e2a\u6821\u9a8c\u89c4\u5219\u53ea\u80fd\u7528\u4e8e\u4e00\u4e2a\u5b57\u7b26\u96c6\uff0c\u56e0\u6b64\u5b57\u7b26\u96c6\u4e0e\u6821\u9a8c\u89c4\u5219\u662f\u4e00\u5bf9\u591a\u7684\u5173\u7cfb\u3002</p> <p>\u6821\u9a8c\u89c4\u5219\u5b58\u50a8\u5728 information_schema. COLLATIONS \u8868\u4e2d\u3002\u4e00\u822c\u4f7f\u7528 utf8mb4_general_ci \u6392\u5e8f\u89c4\u5219\u3002</p> <p>\u6392\u5e8f\u89c4\u5219\u547d\u540d\u60ef\u4f8b\uff1a\u5b57\u7b26\u96c6\u540d_\u5bf9\u5e94\u7684\u8bed\u8a00\u6392\u5e8f\u89c4\u5219_ai/as/ci/cs/ks/bin</p> <ul> <li>ai \u53e3\u97f3\u4e0d\u654f\u611f\uff08accent-sensitive \uff09</li> <li>\u53e3\u97f3\u4e0d\u654f\u611f</li> <li>\u5927\u5199\u654f\u611f</li> <li> </li> </ul> <p>\u8bed\u8a00\u540d\u4e00\u822c\u90fd\u662f\u7528 general</p> <p>\u5176\u4e2d ci \u8868\u793a\u5927\u5c0f\u5199\u4e0d\u654f\u611f\u6027\uff0ccs \u8868\u793a\u5927\u5c0f\u5199\u654f\u611f\u6027\uff0cbin \u8868\u793a\u4e8c\u8fdb\u5236\u3002</p> <p>\u6309\u5b57\u6bcd\u6392\u5e8f\uff0c\u6216\u8005\u6309\u7167\u4e8c\u8fdb\u5236\u6392\u5e8f</p> <p>utf8mb4_tr_0900_ai_ci</p> <p>utf8mb4_hu_0900_ai_ci</p> <p>utf8mb4_turkish_ci</p> <p>utf8mb4_hungarian_ci</p>"},{"location":"foundmental/2.MySQL%E7%B4%A2%E5%BC%95/#_44","title":"\u5c0f\u5199\u654f\u611f","text":""},{"location":"foundmental/2.MySQL%E7%B4%A2%E5%BC%95/#_45","title":"\u82f1\u6587\u6392\u5e8f\u89c4\u5219","text":""},{"location":"foundmental/2.MySQL%E7%B4%A2%E5%BC%95/#_46","title":"\u4e2d\u6587\u5b57\u6bb5\u6392\u5e8f\u548c\u6bd4\u8f83","text":"<p>\u8981\u8fdb\u884c\u4e2d\u6587\u6392\u5e8f\uff0c\u6bd4\u5982\u901a\u8baf\u5f55\u91cc\u9762\u7684\u6392\u5e8f\u5217\u8868\u3002\u554a XX \u6392\u5230 \u66fe XX \u7b49\u7b49\u3002</p> <p>\u5982\u679c\u5b58\u50a8\u6c49\u5b57\u7684\u5b57\u6bb5\u7f16\u7801\u4f7f\u7528\u7684\u662f GBK \u5b57\u7b26\u96c6\uff0c\u56e0\u4e3a GBK \u5185\u7801\u7f16\u7801\u65f6\u672c\u8eab\u5c31\u91c7\u7528\u4e86\u62fc\u97f3\u6392\u5e8f\u7684\u65b9\u6cd5</p> <p>\uff08\u5e38\u7528\u4e00\u7ea7\u6c49\u5b57 3755 \u4e2a\u91c7\u7528\u62fc\u97f3\u6392\u5e8f\uff0c\u4e8c\u7ea7\u6c49\u5b57\u5c31\u4e0d\u662f\u4e86\uff0c\u4f46\u8003\u8651\u5230\u4eba\u540d\u7b49\u90fd\u662f\u5e38\u7528\u6c49\u5b57\uff0c\u56e0\u6b64\u53ea\u662f\u9488\u5bf9\u4e00\u7ea7\u6c49\u5b57\u80fd\u6b63\u786e\u6392\u5e8f\u4e5f\u591f\u7528\u4e86\uff09.</p> <p>\u76f4\u63a5\u5728\u67e5\u8be2\u8bed\u53e5\u540e\u9762\u6dfb\u52a0 <code>ORDER BY name ASC</code>\uff0c\u67e5\u8be2\u7ed3\u679c\u5c06\u6309\u7167\u59d3\u6c0f\u7684\u5347\u5e8f\u6392\u5e8f\uff1b</p> <p>\u5982\u679c\u5b58\u50a8\u5b57\u6bb5\u7684\u4e0d\u662f\u91c7\u7528 GBK \u7f16\u7801 \u3002\u9700\u8981\u5728\u6392\u5e8f\u7684\u65f6\u5019\u5bf9\u5b57\u6bb5\u8fdb\u884c\u8f6c\u7801\uff0c\u5bf9\u5e94\u7684 SQL \u662f <code>ORDER BY convert(name using gbk) ASC</code></p>"},{"location":"foundmental/2.MySQL%E7%B4%A2%E5%BC%95/#_47","title":"\u8868\u8bbf\u95ee\u65b9\u5f0f","text":""},{"location":"foundmental/2.MySQL%E7%B4%A2%E5%BC%95/#_48","title":"\u5168\u8868\u626b\u63cf","text":"<p>\u4e3a\u5b9e\u73b0\u5168\u8868\u626b\u63cf\uff0cOracle \u8bfb\u53d6\u8868\u4e2d\u6240\u6709\u7684\u884c\uff0c\u5e76\u68c0\u67e5\u6bcf\u4e00\u884c\u662f\u5426\u6ee1\u8db3\u8bed\u53e5\u7684 WHERE \u9650\u5236\u6761\u4ef6\u3002Oracle \u987a\u5e8f\u5730\u8bfb\u53d6\u5206\u914d\u7ed9\u8868\u7684\u6bcf\u4e2a\u6570\u636e\u5757\uff0c\u76f4\u5230\u8bfb\u5230\u8868\u7684\u6700\u9ad8\u6c34\u7ebf\u5904\u3002\u4e00\u4e2a\u591a\u5757\u8bfb\u64cd\u4f5c\u53ef\u4ee5\u4f7f\u4e00\u6b21 I/O \u80fd\u8bfb\u53d6\u591a\u5757\u6570\u636e\u5757\uff0c\u800c\u4e0d\u662f\u53ea\u8bfb\u53d6\u4e00\u4e2a\u6570\u636e\u5757\uff0c\u8fd9\u6781\u5927\u7684\u51cf\u5c11\u4e86 I/O \u603b\u6b21\u6570\uff0c\u63d0\u9ad8\u4e86\u7cfb\u7edf\u7684\u541e\u5410\u91cf\uff0c\u6240\u4ee5\u5229\u7528\u591a\u5757\u8bfb\u7684\u65b9\u6cd5\u53ef\u4ee5\u5341\u5206\u9ad8\u6548\u5730\u5b9e\u73b0\u5168\u8868\u626b\u63cf\uff0c\u800c\u4e14\u53ea\u6709\u5728\u5168\u8868\u626b\u63cf\u7684\u60c5\u51b5\u4e0b\u624d\u80fd\u4f7f\u7528\u591a\u5757\u8bfb\u64cd\u4f5c\u3002\u5728\u8fd9\u79cd\u8bbf\u95ee\u6a21\u5f0f\u4e0b\uff0c\u6bcf\u4e2a\u6570\u636e\u5757\u53ea\u88ab\u8bfb\u4e00\u6b21\u3002\u8fd9\u4e5f\u662f\u6700\u4e3a\u5e38\u89c4\u7684\u8bbf\u95ee\u8def\u5f84\u3002</p>"},{"location":"foundmental/2.MySQL%E7%B4%A2%E5%BC%95/#rowid_1","title":"rowid \u626b\u63cf","text":"<p>\u884c\u7684 ROWID \u6307\u51fa\u4e86\u8be5\u884c\u6240\u5728\u7684\u6570\u636e\u6587\u4ef6\u3001\u6570\u636e\u5757\u4ee5\u53ca\u884c\u5728\u8be5\u5757\u4e2d\u7684\u4f4d\u7f6e\uff0c\u6240\u4ee5\u901a\u8fc7 ROWID \u6765\u5b58\u53d6\u6570\u636e\u53ef\u4ee5\u5feb\u901f\u5b9a\u4f4d\u5230\u76ee\u6807\u6570\u636e\u4e0a\uff0c\u662f Oracle \u5b58\u53d6\u5355\u884c\u6570\u636e\u7684\u6700\u5feb\u65b9\u6cd5\u3002\u4e3a\u4e86\u901a\u8fc7 ROWID \u5b58\u53d6\u8868\uff0cOracle \u9996\u5148\u8981\u83b7\u53d6\u88ab\u9009\u62e9\u884c\u7684 ROWID\uff0c\u6216\u8005\u4ece\u8bed\u53e5\u7684 WHERE \u5b50\u53e5\u4e2d\u5f97\u5230\uff0c\u6216\u8005\u901a\u8fc7\u8868\u7684\u4e00\u4e2a\u6216\u591a\u4e2a\u7d22\u5f15\u7684\u7d22\u5f15\u626b\u63cf\u5f97\u5230\u3002Oracle \u7136\u540e\u4ee5\u5f97\u5230\u7684 ROWID \u4e3a\u4f9d\u636e\u5b9a\u4f4d\u6bcf\u4e2a\u88ab\u9009\u62e9\u7684\u884c\u3002\u8fd9\u79cd\u5b58\u53d6\u65b9\u6cd5\u4e0d\u4f1a\u7528\u5230\u591a\u5757\u8bfb\u64cd\u4f5c\uff0c\u4e00\u6b21 I/O \u53ea\u80fd\u8bfb\u53d6\u4e00\u4e2a\u6570\u636e\u5757\u3002\u6211\u4eec\u4f1a\u7ecf\u5e38\u5728\u6267\u884c\u8ba1\u5212\u4e2d\u770b\u5230\u8be5\u5b58\u53d6\u65b9\u6cd5\uff0c\u5982\u901a\u8fc7\u7d22\u5f15\u67e5\u8be2\u6570\u636e\u3002</p>"},{"location":"foundmental/2.MySQL%E7%B4%A2%E5%BC%95/#_49","title":"\u91c7\u6837\u626b\u63cf","text":"<p>\u5c06\u4ece\u5168\u90e8\u6570\u636e\u5757\u4e2d\u8bfb\u53d6\u6307\u5b9a\u6bd4\u4f8b\u7684\u6570\u636e\u4e4b\u540e\uff0c\u7136\u540e\u518d\u901a\u8fc7\u8fc7\u6ee4\u8fd4\u56de\u6ee1\u8db3\u6761\u4ef6\u7684\u884c\u3002\u5728\u6bcf\u6b21\u6267\u884c\u65f6\uff0c\u90fd\u4f1a\u4ece\u5168\u90e8\u7684\u6570\u636e\u5757\u4e2d\u8bfb\u53d6\u6307\u5b9a\u6bd4\u4f8b\u7684\u6570\u636e\u5757\u3002\u6240\u4ee5\u6bcf\u6b21\u8bfb\u53d6\u7684\u6570\u636e\u5757\u90fd\u662f\u4e0d\u540c\u7684\uff0c\u5f53\u67d0\u4e2a\u6570\u636e\u5757\u88ab\u9009\u5b9a\u4e3a\u8bfb\u53d6\u5bf9\u8c61\u65f6\uff0c\u5757\u4e2d\u6240\u6709\u884c\u5c06\u88ab\u5168\u90e8\u8bfb\u53d6\u3002\u6b64\u79cd\u8bbf\u95ee\u8def\u5f84\u5e38\u89c1\u4e8e\u7edf\u8ba1\u4fe1\u606f\u6536\u96c6\u7b49\u573a\u666f\u4e4b\u4e2d\u3002</p>"},{"location":"foundmental/2.MySQL%E7%B4%A2%E5%BC%95/#_50","title":"\u7d22\u5f15\u8bbf\u95ee\u8def\u5f84","text":"<p>\u7d22\u5f15\u552f\u4e00\u626b\u63cf</p> <p>\u901a\u8fc7\u552f\u4e00\u7d22\u5f15\u67e5\u627e\u4e00\u4e2a\u6570\u503c\u7ecf\u5e38\u8fd4\u56de\u5355\u4e2a ROWID\u3002\u5982\u679c\u5b58\u5728 UNIQUE \u6216 PRIMARY KEY \u7ea6\u675f(\u5b83\u4fdd\u8bc1\u4e86\u8bed\u53e5\u53ea\u5b58\u53d6\u5355\u884c)\u7684\u8bdd\uff0cOracle \u7ecf\u5e38\u5b9e\u73b0\u552f\u4e00\u6027\u626b\u63cf\u3002\u5728\u5927\u90e8\u5206\u60c5\u51b5\u4e0b\u8be5\u626b\u63cf\u65b9\u5f0f\u4e3b\u8981\u88ab\u4f7f\u7528\u5728\u68c0\u7d22\u552f\u4e00 ROWID \u7684\u67e5\u8be2\u4e2d\uff0c\u4e3a\u4e86\u8fdb\u884c\u7d22\u5f15\u552f\u4e00\u626b\u63cf\u800c\u5fc5\u987b\u57fa\u4e8e\u4e3b\u952e\u6765\u521b\u5efa\u7d22\u5f15\u6216\u8005\u521b\u5efa\u552f\u4e00\u7d22\u5f15\uff0c\u4e14\u5728 SQL \u8bed\u53e5\u4e2d\u5fc5\u987b\u4e3a\u7d22\u5f15\u5217\u4f7f\u7528\"=\"\u6bd4\u8f83\u8fd0\u7b97\u7b26\u3002\u5426\u5219\u5373\u4f7f\u57fa\u4e8e\u5177\u6709\u552f\u4e00\u503c\u7684\u5217\u521b\u5efa\u4e86\u7d22\u5f15\uff0c\u5728\u6267\u884c\u65f6\u4f18\u5316\u5668\u4e5f\u4e0d\u80fd\u53ef\u80fd\u9009\u62e9\u7d22\u5f15\u552f\u4e00\u626b\u63cf\uff0c\u800c\u4f1a\u9009\u62e9\u8303\u56f4\u626b\u63cf\u3002</p> <p>\u7d22\u5f15\u8303\u56f4\u626b\u63cf</p> <p>\u7d22\u5f15\u6700\u666e\u904d\u7684\u6570\u636e\u8bfb\u53d6\u65b9\u5f0f\uff0c\u4f18\u5316\u5668\u9009\u62e9\u8be5\u626b\u63cf\u65b9\u5f0f\u7684\u60c5\u51b5\u6709\u4e24\u79cd\uff0c\u5373\u7531\u5f00\u59cb\u503c\u4e0e\u7ed3\u675f\u503c\u7684\u60c5\u51b5\u548c\u6709\u4e00\u4e2a\u4ee5\u4e0a\u7684\u884c\u4f46\u6ca1\u6709\u7ed3\u675f\u7684\u60c5\u51b5\u3002\u7d22\u5f15\u8303\u56f4\u626b\u63cf\u5728\u5bfb\u627e\u5f00\u59cb\u4f4d\u7f6e\u7684\u65f6\u5019\u4f7f\u7528\u968f\u673a\u8bfb\u53d6\uff0c\u4f46\u4e4b\u540e\u6240\u6267\u884c\u7684\u5168\u90e8\u90fd\u662f\u8fde\u7eed\u626b\u63cf\u3002\u5982\u679c\u518d\u7cbe\u786e\u63cf\u8ff0\uff0c\u5373\u5728\u67e5\u627e\u5206\u652f\u5757\u65f6\u4f7f\u7528\u7684\u662f\u968f\u673a\u8bfb\u53d6\uff0c\u5728\u7ecf\u8fc7\u5206\u652f\u5757\u67e5\u627e\u5230\u5f00\u59cb\u7684\u53f6\u5757\u4e4b\u540e\u6240\u6267\u884c\u7684\u5c31\u662f\u8fde\u7eed\u626b\u63cf\u3002\u5728\u626b\u63cf\u65b9\u5411\u4e0a\uff0c\u53c8\u53ef\u5206\u4e3a\u5347\u5e8f\u626b\u63cf\u548c\u964d\u5e8f\u626b\u63cf\u3002</p> <p>\u7d22\u5f15\u5168\u626b\u63cf</p> <p>\u7d22\u5f15\u5168\u626b\u63cf\u4e0d\u8bfb\u53d6\u7d22\u5f15\u7ed3\u6784\u4e2d\u7684\u6bcf\u4e2a\u5757\uff0c\u8fd9\u4e0e\u5176\u540d\u79f0\u8868\u9762\u4e0a\u76f8\u6096\u3002\u7d22\u5f15\u5168\u626b\u63cf\u5904\u7406\u7d22\u5f15\u7684\u6240\u6709\u53f6\u5757\uff0c\u4f46\u4e3a\u4e86\u67e5\u627e\u5230\u7b2c\u4e00\u4e2a\u53f6\u5757\u9700\u8981\u5904\u7406\u8db3\u591f\u591a\u7684\u5206\u652f\u5757\u3002\u4e00\u65e6\u5728\u7d22\u5f15\u4e2d\u83b7\u5f97\u4e00\u4e2a\u53f6\u5757\uff0c\u5219\u5176\u524d\u548c\u540e\u7684\u53f6\u5757\u5c06\u6309\u987a\u5e8f\u88ab\u94fe\u63a5\u8d77\u6765\u3002\u5373\uff0c\u53f6\u5757\u4e0d\u4ec5\u53ef\u4ee5\u901a\u8fc7\u5206\u652f\u5757\u5bfc\u822a\uff1b\u800c\u4e14\uff0c\u4e00\u65e6\u83b7\u5f97\u4e00\u4e2a\u53f6\u5757\uff0c\u4e5f\u53ef\u4ee5\u968f\u6307\u9488\u83b7\u5f97\u4e0b\u4e00\u4e2a\u53f6\u5757\u3002\u4e8b\u5b9e\u4e0a\uff0c\u4f7f\u7528\u8fd9\u79cd\u53cc\u5411\u94fe\u8868\u53ef\u4ee5\u5728\u7d22\u5f15\u7ed3\u6784\u4e2d\u524d\u8fdb\u6216\u540e\u9000\u3002\u7d22\u5f15\u5168\u626b\u63cf\u4f7f\u7528\u5355\u5757 IO \u6309\u987a\u5e8f\u8bfb\u53d6\u7d22\u5f15\uff0c\u5b83\u4ece\u6839\u5f00\u59cb\uff0c\u901a\u8fc7\u5206\u652f\u5757\u5230\u8fbe\u7b2c\u4e00\u4e2a\u53f6\u5757\u3002\u8fd9\u4e9b\u5757\u90fd\u662f\u6bcf\u6b21\u8bfb\u53d6\u4e00\u5757\u3002\u5f53\u83b7\u53d6\u7b2c\u4e00\u4e2a\u53f6\u5757\u65f6\uff0c\u53ef\u6309\u987a\u5e8f\u8bfb\u53d6\u6bcf\u4e2a\u53f6\u5757\uff0c\u540c\u6837\u662f\u4e00\u6b21\u4e00\u5757\u3002\u7d22\u5f15\u5168\u626b\u63cf\u4ece\u7d22\u5f15\u4e2d\u6309\u987a\u5e8f\u8bfb\u53d6\u6570\u636e\u3002\u56e0\u6b64\uff0c\u7d22\u5f15\u5168\u626b\u63cf\u53ef\u4ee5\u907f\u514d\u6392\u5e8f\u3002</p>"},{"location":"foundmental/3.MySQL%E7%9B%B4%E6%96%B9%E5%9B%BE/","title":"\u76f4\u65b9\u56fe\u6982\u8ff0","text":"<p><code>MySQL8.0</code>\u5f00\u59cb\u652f\u6301\u7d22\u5f15\u4e4b\u5916\u7684\u6570\u636e\u5206\u5e03\u7edf\u8ba1\u4fe1\u606f\u53ef\u9009\u9879\u3002\u5b83\u5c31\u662f\u76f4\u65b9\u56fe\uff08Histogram\uff09\u3002\u76f4\u65b9\u56fe(histogram)\uff0c\u76f4\u8bd1\u5c31\u662f\u67f1\u72b6\u56fe\uff0c\u56fd\u5185\u591a\u7ffb\u8bd1\u4e3a\u76f4\u65b9\u56fe\u3002</p> <p>\u76f4\u65b9\u56fe\u4e0d\u662f\u56fe\uff0c\u662f\u5bf9\u8868\u7684\u67d0\u4e2a\u5b57\u6bb5\u6570\u636e\u5206\u5e03\u7684\u7edf\u8ba1\uff0c\u8fd9\u79cd\u6570\u636e\u7edf\u8ba1\u662f\u57fa\u4e8e\u67d0\u5b57\u6bb5\u7684\u5b9e\u9645\u5b58\u50a8\u6570\u636e\u5206\u5e03\u5f97\u51fa\u7684\u3002</p> <p>\u8fd9\u79cd\u5206\u5e03\u7edf\u8ba1\u53ef\u4ee5\u5e2e\u52a9\u67e5\u8be2\u4f18\u5316\u5668\u638c\u63e1\u5b57\u6bb5\u771f\u5b9e\u7684\u60c5\u51b5\uff0c\u4ece\u800c\u5f97\u51fa\u66f4\u9ad8\u6548\u800c\u5207\u5408\u5b9e\u9645\u7684\u6267\u884c\u8ba1\u5212\u3002</p> <p>\u5728\u6709\u76f4\u65b9\u56fe\u4e4b\u524d\uff0c\u4f18\u5316\u5668\u5bf9\u67d0\u5b57\u6bb5\u7684\u6570\u636e\u5206\u5e03\u9884\u4f30\u6709\u53ef\u80fd\u662f\u4e0d\u51c6\u786e\u7684\uff0c\u751a\u81f3\u53ef\u80fd\u548c\u5b9e\u9645\u60c5\u51b5\u5dee\u8ddd\u6bd4\u8f83\u5927\uff0c\u9519\u8bef\u7684\u9884\u4f30\u4f1a\u5bfc\u81f4\u4e0d\u9ad8\u6548\u7684\u6267\u884c\u8ba1\u5212\u3002</p> <p>\u76f4\u65b9\u56fe\u901a\u8fc7\u4f30\u7b97\u67e5\u8be2\u8c13\u8bcd\u7684\u9009\u62e9\u7387\uff0c\u4ee5\u4fbf\u9009\u62e9\u5408\u9002\u7684\u6267\u884c\u8ba1\u5212\uff0c\u4e5f\u8ba9SQL\u4f18\u5316\u6709\u4e86\u66f4\u591a\u624b\u6bb5\u3002\u5728DB\u4e2d\uff0c\u4f18\u5316\u5668\u8d1f\u8d23\u5c06SQL\u8f6c\u6362\u4e3a\u5f88\u591a\u4e2a\u4e0d\u540c\u7684\u6267\u884c\u8ba1\u5212\uff0c\u7136\u540e\u4ece\u4e2d\u9009\u62e9\u4e00\u4e2a\u6700\u4f18\u7684\u6765\u5b9e\u9645\u6267\u884c\u3002\u4f46\u662f\u6709\u65f6\u5019\u4f18\u5316\u5668\u9009\u62e9\u7684\u6700\u7ec8\u8ba1\u5212\u6709\u53ef\u80fd\u968f\u7740DB\u73af\u5883\u7684\u53d8\u5316\u4e0d\u662f\u6700\u4f18\u7684\uff0c\u8fd9\u5c31\u5bfc\u81f4\u4e86\u67e5\u8be2\u6027\u80fd\u4e0d\u662f\u5f88\u597d\u3002</p> <p>\u6bd4\u5982\uff0c\u4f18\u5316\u5668\u65e0\u6cd5\u51c6\u786e\u7684\u77e5\u9053\u6bcf\u5f20\u8868\u7684\u5b9e\u9645\u884c\u6570\u4ee5\u53ca\u53c2\u4e0e\u8fc7\u6ee4\u6761\u4ef6\u7684\u5217\u6709\u591a\u5c11\u4e2a\u4e0d\u540c\u7684\u503c\u3002\u5f53\u7136\u4e0d\u540c\u7c7b\u578b\u7684\u7d22\u5f15\u4e5f\u53ef\u4ee5\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\uff0c\u4f46\u662f\u4f60\u4e0d\u80fd\u6bcf\u4e2a\u5217\u90fd\u5efa\u7d22\u5f15\u5427\uff1f</p> <p>\u5982\u679c\u4e00\u5f20\u8868\u6709100\u4e2a\u5b57\u6bb5\uff0c\u90a3\u5168\u5b57\u6bb5\u7d22\u5f15\u5c06\u4f1a\u62d6\u6b7b\u5bf9\u8fd9\u5f20\u8868\u7684\u5199\u5165\u3002\u800c\u4e14\u4f46\u7d22\u5f15\u7ef4\u62a4\u7684\u4ee3\u4ef7\u66f4\u9ad8\uff0c\u7d22\u5f15\u7edf\u8ba1\u4fe1\u606f\u4e5f\u6709\u4e0d\u53ef\u9760\u7684\u65f6\u5019\uff0c\u4f8b\u5982\u5b58\u5728\u6570\u636e\u503e\u659c\uff0c\u6216\u8005\u7edf\u8ba1\u5ef6\u8fdf\u7b49\u95ee\u9898\uff0c\u7d22\u5f15\u8981\u4fdd\u6301\u66f4\u65b0\uff0c\u800c\u76f4\u65b9\u56fe\u53ef\u4ee5\u6309\u9700\u624b\u52a8\u66f4\u65b0\u3002\u6b64\u65f6\uff0c\u76f4\u65b9\u56fe\u5c31\u662f\u76f8\u5bf9\u6765\u8bf4\uff0c\u5f00\u9500\u8f83\u5c0f\u7684\u65b9\u6cd5\u3002\u5f53\u7136\uff0c\u76f4\u65b9\u56fe\u8fd8\u662f\u65e0\u6cd5\u4ee3\u66ff\u7d22\u5f15\uff0c\u53ea\u5728\u4e00\u4e9b\u7279\u5b9a\u7684\u573a\u666f\u91cc\u6bd4\u8f83\u6709\u7528</p> <p>\u76f4\u65b9\u56fe\u5c31\u662f\u5728 MySQL \u4e2d\u4e3a\u67d0\u5f20\u8868\u7684\u67d0\u4e9b\u5b57\u6bb5\u63d0\u4f9b\u4e86\u4e00\u79cd\u6570\u503c\u5206\u5e03\u7684\u7edf\u8ba1\u4fe1\u606f\u3002\u6bd4\u5982\u5b57\u6bb5NULL\u7684\u4e2a\u6570\uff0c\u6bcf\u4e2a\u4e0d\u540c\u503c\u51fa\u73b0\u7684\u767e\u5206\u6bd4\uff0c\u6700\u5927\u503c\uff0c\u6700\u5c0f\u503c\u7b49\u7b49\u3002</p> <p>\u5982\u679c\u6211\u4eec\u7528\u8fc7\u4e86<code>MySQL</code>\u7684\u5206\u6790\u578b\u5f15\u64ce<code>brighthouse</code>\uff0c\u90a3\u5bf9\u8fd9\u4e2a\u6982\u5ff5\u592a\u719f\u6089\u4e86\u3002</p> <pre><code>SELECT *\nFROM \n    customer JOIN orders ON customer.cust_id = orders.customer_id\n WHERE\n    customer.balance &lt; 1000 AND\n  orders.total &gt; 10000\n</code></pre> <p>\u5728\u4f18\u5316\u8fc7\u7a0b\u4e2d\uff0c\u4e3a\u4e86\u51b3\u5b9a <code>customer</code> \u4e0e <code>orders</code> \u4e24\u8868\u7684 <code>join order</code>\uff0c\u6211\u4eec\u9700\u8981\u54ea\u4e2a\u8868\u7ecf\u8fc7 where \u6761\u4ef6\uff08customers.balance &lt; 1000 \u548c orders.total &gt; 10000\uff09\u7b5b\u9009\u540e\u80fd\u751f\u6210\u66f4\u5c11\u7684\u884c\u6570\u3002\u8fd9\u65f6\uff0c\u4f18\u5316\u5668\u4e0d\u5149\u9700\u8981\u77e5\u9053\u4e24\u8868\u7684\u603b\u884c\u6570\uff0c\u4e5f\u9700\u8981\u77e5\u9053\u6bcf\u4e2a\u8868\u4e2d\u7b26\u5408\u6761\u4ef6\u7684\u884c\u6570\uff0c\u5373**\u67e5\u8be2\u8c13\u8bcd\u7684\u9009\u53d6\u7387**\u3002</p> <p>\u5728\u76f8\u5e94\u5217\u65e2\u6ca1\u6709\u76f4\u65b9\u56fe\u4e5f\u6ca1\u6709\u7d22\u5f15\u7684\u60c5\u51b5\u4e0b\uff0cMySQL \u5bf9\u9009\u62e9\u7387\u7684\u4f30\u7b97\u4e3a<code>max((1/max_distinct_values),max_distinct_values)</code>\uff0c\u5176\u4e2d<code>max_distinct_values</code>\u7684\u503c\u4e3a 0.1\uff08where \u6761\u4ef6\u4e3a = \u65f6\uff09\u6216 0.333\uff08where \u6761\u4ef6\u4e3a &lt; \u6216 &gt; \u65f6\uff09\u3002\u8fd9\u79cd\u4f30\u7b97\u65b9\u5f0f\u5341\u5206\u7c97\u7cd9\u5730\u5ffd\u7565\u4e86\u5217\u4e2d\u6570\u636e\u7684\u5206\u5e03\u3002\u200b</p>"},{"location":"mongodb/01.%E7%AE%80%E4%BB%8B/","title":"\u7b80\u4ecb","text":"<p>MongoDB\u662f\u57fa\u4e8e\u5206\u5e03\u5f0f\u6587\u4ef6\u5b58\u50a8\u7684\u5f00\u6e90\u6570\u636e\u5e93\uff0c\u5b83\u5177\u6709\u9ad8\u6027\u80fd/\u53ef\u6269\u5c55/\u6613\u90e8\u7f72/\u6613\u4f7f\u7528/\u5b58\u50a8\u6570\u636e\u975e\u5e38\u65b9\u4fbf\u7b49\u7279\u70b9\u3002\u5b83\u5728DB-Engine\u957f\u671f\u6392\u540d\u524d\u4e94\uff0c\u4e5f\u662f\u6700\u53d7\u6b22\u8fce\u7684NoSQL\u6570\u636e\u5e93\u4e4b\u4e00\u3002</p> <p>MongoDB\u662f\u4e13\u4e3a\u53ef\u6269\u5c55\u6027\uff0c\u9ad8\u6027\u80fd\u548c\u9ad8\u53ef\u7528\u6027\u800c\u8bbe\u8ba1\u7684\u6570\u636e\u5e93\u3002\u5b83\u53ef\u4ee5\u4ece\u5355\u670d\u52a1\u5668\u90e8\u7f72\u6269\u5c55\u5230\u5927\u578b\u3001\u590d\u6742\u7684\u591a\u6570\u636e\u4e2d\u5fc3\u67b6\u6784\u3002\u5229\u7528\u5185\u5b58\u8ba1\u7b97\u7684\u4f18\u52bf\uff0cMongoDB\u80fd\u591f\u63d0\u4f9b\u9ad8\u6027\u80fd\u7684\u6570\u636e\u8bfb\u5199\u64cd\u4f5c\u3002 </p> <p>MongoDB\u7684\u672c\u5730\u590d\u5236\u548c\u81ea\u52a8\u6545\u969c\u8f6c\u79fb\u529f\u80fd\u4f7f\u60a8\u7684\u5e94\u7528\u7a0b\u5e8f\u5177\u6709\u4f01\u4e1a\u7ea7\u7684\u53ef\u9760\u6027\u548c\u64cd\u4f5c\u7075\u6d3b\u6027\u3002</p> <p>MongoDB Inc. \u516c\u53f8\u4e8e2007\u5e74\u5728\u7ebd\u7ea6\u6210\u7acb\uff0c\u4ea7\u54c1\u4e8e2008\u5e74\u5f00\u6e90\u3002MongoDB\u4e8e 2017\u5e7410\u6708\u5728\u7eb3\u65af\u8fbe\u514b\u4e0a\u5e02\uff0c\u662f26\u5e74\u6765\u7b2c\u4e00\u5bb6\u4e0a\u5e02\u7684\u6570\u636e\u5e93\u516c\u53f8\uff0c\u76ee\u524d\u5b83\u7684\u5e02\u503c\u4ece\u521a\u4e0a\u5e02\u65f6\u5019\u768412\u4ebf\u7f8e\u5143\u6da8\u5230\u4e86248\u4ebf\u7f8e\u5143\uff0c\u5e76\u4e14\u5728\u5168\u7403\u4e00\u767e\u591a\u4e2a\u56fd\u5bb6/\u5730\u533a\u62e5\u6709\u7ea625000\u4e2a\u5ba2\u6237\u3002</p> <p>MongoDB\u63d0\u4f9b\u6570\u636e\u5e93\u7684\u793e\u533a\u7248\u548c\u4f01\u4e1a\u7248\uff1a</p> <ul> <li> <p>MongoDB\u793e\u533a\u7248\u662fMongoDB\u7684\u5f00\u6e90\u548c\u514d\u8d39\u7248\u672c\u3002</p> </li> <li> <p>MongoDB\u4f01\u4e1a\u7248\u4f5c\u4e3aMongoDB\u9ad8\u7ea7\u4f01\u4e1a\u7248\u8ba2\u9605\u7684\u4e00\u90e8\u5206\u63d0\u4f9b\uff0c\u5e76\u5305\u62ec\u5bf9MongoDB\u90e8\u7f72\u7684\u5168\u9762\u652f\u6301\u3002MongoDB\u4f01\u4e1a\u7248\u8fd8\u6dfb\u52a0\u4e86\u4ee5\u4f01\u4e1a\u4e3a\u4e2d\u5fc3\u7684\u529f\u80fd\uff0c\u4f8b\u5982LDAP\u548cKerberos\u652f\u6301\uff0c\u78c1\u76d8\u4e0a\u7684\u52a0\u5bc6\u4ee5\u53ca\u5ba1\u8ba1\u3002</p> </li> </ul> <p>MongoDB\u8fd8\u63d0\u4f9b Atlas\uff08\u4e91\u4e2d\u6258\u7ba1\u7684MongoDB\u4f01\u4e1a\u7248\u670d\u52a1\u9009\u9879\uff09\uff0c\u65e0\u9700\u5b89\u88c5\u5f00\u9500\uff0c\u5e76\u63d0\u4f9b\u514d\u8d39\u7684\u5165\u95e8\u5957\u9910\u3002</p>"},{"location":"mongodb/01.%E7%AE%80%E4%BB%8B/#mongo","title":"mongo\u57fa\u672c\u6982\u5ff5","text":"<p>MongoDB \u4e0d\u662f\u5173\u7cfb\u6570\u636e\u5e93\uff0c\u800c\u662f\u9762\u5411\u6587\u6863\uff08document-oriented\uff09\u7684\u6570\u636e\u5e93\u3002</p> <p>\u9762\u5411\u6587\u6863\u7684\u6570\u636e\u5e93\u4f7f\u7528\u66f4\u7075\u6d3b\u7684<code>\u6587\u6863</code>\u6a21\u578b\u53d6\u4ee3\u4e86<code>\u884c</code>\u7684\u6982\u5ff5\u3002\u901a\u8fc7\u5d4c\u5165\u6587\u6863\u548c\u6570\u7ec4\uff0c\u9762\u5411\u6587\u6863\u7684\u65b9\u5f0f\u53ef\u4ee5\u4ec5\u7528\u4e00\u6761\u8bb0\u5f55\u6765\u8868\u793a\u590d\u6742\u7684\u5c42\u6b21\u5173\u7cfb\u3002</p> <p>MongoDB \u4e2d\u4e5f\u6ca1\u6709\u9884\u5b9a\u4e49\u6a21\u5f0f\uff08predefined schema\uff09\uff1a\u6587\u6863\u952e\u503c\u7684\u7c7b\u578b\u548c\u5927\u5c0f\u4e0d\u662f\u56fa\u5b9a\u7684\u3002\u7531\u4e8e\u6ca1\u6709\u56fa\u5b9a\u7684\u6a21\u5f0f\uff0c\u56e0\u6b64\u6309\u9700\u6dfb\u52a0\u6216\u5220\u9664\u5b57\u6bb5\u53d8\u5f97\u66f4\u5bb9\u6613\u3002</p>"},{"location":"mongodb/01.%E7%AE%80%E4%BB%8B/#_2","title":"\u6587\u6863","text":"<p>\u6587\u6863\u662fMongoDB\u7684\u6838\u5fc3\u6982\u5ff5\u3002\u6587\u6863\u5c31\u662f\u952e\u503c\u5bf9\u7684\u6709\u5e8f\u96c6\u5408\u3002\u6bcf\u79cd\u7f16\u7a0b\u8bed\u8a00\u8868\u793a\u6587\u6863\u7684\u65b9\u6cd5\u4e0d\u592a\u4e00\u6837\uff0c\u4f46\u5927\u591a\u6570\u90fd\u6709\u7c7b\u4f3c\u7684\u6570\u636e\u7ed3\u6784\u3002\u6bd4\u5982\u6620\u5c04\uff0c\u54c8\u5e0c\uff0c\u5b57\u5178\u7b49\u3002</p> <pre><code>// \u5728 JavaScript \u91cc\uff0c\u6587\u6863\u88ab\u8868\u793a\u4e3a\u5bf9\u8c61\uff1a\n{\n    \"greeting\" : \"Hello, World!\" , \n    \"foo\": 3\n}\n</code></pre> <p>\u6587\u6863\u7684\u952e\u662f\u5b57\u7b26\u4e32\u3002\u5b83\u5177\u6709\u5982\u4e0b\u7ea6\u675f\u548c\u9650\u5236\uff1a</p> <ul> <li>\u9664\u4e86\u5c11\u6570\u4f8b\u5916\u60c5\u51b5\uff0c\u952e\u53ef\u4ee5\u4f7f\u7528\u4efb\u610f UTF-8 \u5b57\u7b26\uff08 . \u548c $ \u6709\u7279\u6b8a\u542b\u4e49\uff09\u3002\u952e\u533a\u5206\u5927\u5c0f\u5199\u3002</li> <li>\u6587\u6863\u4e0d\u80fd\u6709\u91cd\u590d\u7684\u952e\u3002</li> <li>\u6587\u6863\u4e2d\u7684\u952e\u503c\u5bf9\u662f\u6709\u5e8f\u7684\u3002</li> </ul>"},{"location":"mongodb/01.%E7%AE%80%E4%BB%8B/#_3","title":"\u96c6\u5408","text":"<p>\u96c6\u5408\u5c31\u662f\u4e00\u7ec4\u6587\u6863\u3002\u5982\u679c\u5c06MongoDB\u4e2d\u7684\u4e00\u4e2a\u6587\u6863\u6bd4\u4f5c\u5173\u7cfb\u6570\u636e\u5e93\u4e2d\u7684\u4e00\u884c\uff0c\u90a3\u4e48\u96c6\u5408\u5c31\u76f8\u5f53\u4e8e\u4e00\u5f20\u8868\u3002</p> <p>\u52a8\u6001\u6a21\u5f0f</p> <p>\u96c6\u5408\u662f\u52a8\u6001\u6a21\u5f0f\u7684\u3002\u8fd9\u610f\u5473\u7740\u4e00\u4e2a\u96c6\u5408\u91cc\u9762\u7684\u6587\u6863\u53ef\u4ee5\u662f\u5404\u5f0f\u5404\u6837\u7684\u3002\u96c6\u5408\u53ef\u4ee5\u653e\u7f6e\u4efb\u610f\u6587\u6863\u3002</p> <p>\u4e3a\u4ec0\u4e48\u9700\u8981\u5c06\u4e0d\u540c\u7684\u6587\u6863\u653e\u5230\u4e0d\u540c\u7684\u96c6\u5408\u4e2d\uff1f</p> <p>\u547d\u540d \u96c6\u5408\u4f7f\u7528\u540d\u79f0\u8fdb\u884c\u6807\u8bc6\u3002\u96c6\u5408\u540d\u79f0\u53ef\u4ee5\u662f\u6ee1\u8db3\u4e0b\u5217\u6761\u4ef6\u7684\u4efb\u610fUTF-8\u5b57\u7b26\u3002 \u96c6\u5408\u540d\u4e0d\u80fd\u662f\u7a7a\u5b57\u7b26\u4e32\u3002 \u96c6\u5408\u540d\u4e0d\u80fd\u5305\u542b\u7a7a\u5b57\u7b26</p> <p>\u5b50\u96c6\u5408 \u7ec4\u7ec7\u96c6\u5408\u7684\u4e00\u79cd\u60ef\u4f8b\u662f\u4f7f\u7528 . \u5206\u5272\u4e0d\u540c\u547d\u540d\u7a7a\u95f4\u7684\u5b50\u96c6\u5408\u3002\u4f8b\u5982\uff0c\u4e00\u4e2a\u5177\u6709\u535a\u5ba2\u529f\u80fd\u7684\u5e94\u7528\u53ef\u80fd\u5305\u542b\u4e24\u4e2a\u96c6\u5408\u3002\u5206\u522b\u662f blog.posts \u548c blog.authors \u3002\u8fd9\u662f\u4e3a\u4e86\u4f7f\u7ec4\u7ec7\u7ed3\u6784\u66f4\u6e05\u6670\uff0c\u8fd9\u91cc\u7684 blog \u96c6\u5408\u751a\u81f3\u53ef\u4ee5\u4e0d\u9700\u8981\u5b58\u5728\u3002</p> <p>\u5728 MongoDB \u4e2d\uff0c\u4f7f\u7528\u5b50\u96c6\u5408\u6765\u7ec4\u7ec7\u6570\u636e\u975e\u5e38\u9ad8\u6548\u3002\u503c\u5f97\u63a8\u8350\u3002</p> <p>\u6570\u636e\u5e93 \u5728 MongoDB \u4e2d\uff0c\u591a\u4e2a\u6587\u6863\u7ec4\u6210\u96c6\u5408\uff0c\u591a\u4e2a\u96c6\u5408\u53ef\u4ee5\u7ec4\u6210\u6570\u636e\u5e93\u3002\u4e00\u4e2a MongoDB \u5b9e\u4f8b\u53ef\u4ee5\u627f\u8f7d\u591a\u4e2a\u6570\u636e\u5e93\u3002\u6bcf\u4e2a\u6570\u636e\u5e93\u67090\u4e2a\u6216\u591a\u4e2a\u96c6\u5408\u3002 \u6bcf\u4e2a\u6570\u636e\u5e93\u6709\u72ec\u7acb\u7684\u6743\u9650\uff0c \u6570\u636e\u5e93\u901a\u8fc7\u540d\u79f0\u6765\u6807\u8bc6\u3002\u8fd9\u70b9\u4e0e\u96c6\u5408\u7c7b\u4f3c\u3002\u6570\u636e\u5e93\u547d\u540d\u8981\u6c42\u5982\u4e0b\uff1a \u4e0d\u80fd\u662f\u7a7a\u5b57\u7b26\u4e32\u3002 \u57fa\u672c\u4e0a\u53ea\u80fd\u7528 ASCII \u4e2d\u7684\u5b57\u6bcd\u548c\u6570\u5b57\u3002 \u6570\u636e\u5e93\u540d\u533a\u5206\u5927\u5c0f\u5199\u3002\u7b80\u5355\u8d77\u89c1\uff0c\u6570\u636e\u5e93\u540d\u5e94\u5168\u90e8\u4e3a\u5c0f\u5199\u3002 \u6570\u636e\u5e93\u540d\u6700\u591a\u4e3a64\u5b57\u8282\u3002</p> <p>\u6570\u636e\u5e93\u6700\u7ec8\u4f1a\u53d8\u6210\u6587\u4ef6\u7cfb\u7edf\u4e2d\u7684\u6587\u4ef6\u3002\u6570\u636e\u5e93\u540d\u5c31\u662f\u76f8\u5e94\u6587\u4ef6\u540d\u3002\u53e6\u5916\uff0c\u6709\u4e00\u4e9b\u6570\u636e\u5e93\u540d\u662f\u4fdd\u7559\u7684\u3002\u53ef\u4ee5\u76f4\u63a5\u8bbf\u95ee\u8fd9\u4e9b\u6709\u7279\u6b8a\u8bed\u4e49\u7684\u6570\u636e\u5e93\uff1a</p> <p>admin  \u4ece\u8eab\u4efd\u9a8c\u8bc1\u89d2\u5ea6\u8bb2\uff0c\u8fd9\u662f \u201droot\u201c \u6570\u636e\u5e93\u3002\u5982\u679c\u5c06\u4e00\u4e2a\u7528\u6237\u6dfb\u52a0\u5230admin\u6570\u636e\u5e93\u4e2d\uff0c\u8fd9\u4e2a\u7528\u6237\u81ea\u52a8\u83b7\u5f97\u6240\u6709\u6570\u636e\u5e93\u7684\u6743\u9650\u3002 local config \u628a\u6570\u636e\u5e93\u540d\u79f0\u6dfb\u52a0\u5230\u96c6\u5408\u540d\u524d\uff0c\u5f97\u5230\u96c6\u5408\u7684\u5b8c\u5168\u9650\u5b9a\u540d\u3002\u5373\u201d\u547d\u540d\u7a7a\u95f4\u201c \uff0c \u4f8b\u5982\u8981\u4f7f\u7528 cms \u6570\u636e\u5e93\u4e2d\u7684 blog.posts \u96c6\u5408\u3002\u8fd9\u4e2a\u96c6\u5408\u7684\u547d\u540d\u7a7a\u95f4\u5c31\u662f cms.blog.posts  \u547d\u540d\u7a7a\u95f4\u957f\u5ea6\u4e0d\u5f97\u8d85\u8fc7121\u5b57\u8282\uff0c\u4e14\u5728\u5b9e\u9645\u5e94\u7528\u4e2d\u5e94\u5c0f\u4e8e100\u5b57\u8282\u3002</p>"},{"location":"mysql-kernel/01.MySQL%E6%BA%90%E7%A0%81-%E8%AF%AD%E6%B3%95%E6%A0%91%E7%BB%93%E6%9E%84/","title":"\u8bcd\u6cd5\u5206\u6790\u6982\u8ff0","text":"<p>\u8bcd\u6cd5\u5206\u6790\uff08lexical analysis\uff09\u662f\u8ba1\u7b97\u673a\u79d1\u5b66\u4e2d\u5c06\u5b57\u7b26\u5e8f\u5217\u8f6c\u6362\u4e3a\u5355\u8bcd\uff08Token\uff09\u5e8f\u5217\u7684\u8fc7\u7a0b\u3002\u8fdb\u884c\u8bcd\u6cd5\u5206\u6790\u7684\u7a0b\u5e8f\u6216\u8005\u51fd\u6570\u53eb\u4f5c\u8bcd\u6cd5\u5206\u6790\u5668\uff08Lexical analyzer\uff0c\u7b80\u79f0Lexer\uff09\uff0c\u4e5f\u53eb\u626b\u63cf\u5668\uff08Scanner\uff09\u3002</p> <p>\u8bcd\u6cd5\u5206\u6790\u5668\u4e00\u822c\u4ee5\u51fd\u6570\u7684\u5f62\u5f0f\u5b58\u5728\uff0c\u4f9b\u8bed\u6cd5\u5206\u6790\u5668\u8c03\u7528\u3002\u8bcd\u6cd5\u5206\u6790\u9636\u6bb5\u662f\u7f16\u8bd1\u8fc7\u7a0b\u7684\u7b2c\u4e00\u4e2a\u9636\u6bb5\uff0c\u662f\u7f16\u8bd1\u7684\u57fa\u7840\u3002\u8fd9\u4e2a\u9636\u6bb5\u7684\u4efb\u52a1\u662f\u4ece\u5de6\u5230\u53f3\u4e00\u4e2a\u5b57\u7b26\u4e00\u4e2a\u5b57\u7b26\u5730\u8bfb\u5165\u6e90\u7a0b\u5e8f\uff0c\u5373\u5bf9\u6784\u6210\u6e90\u7a0b\u5e8f\u7684\u5b57\u7b26\u6d41\u8fdb\u884c\u626b\u63cf\u7136\u540e\u6839\u636e\u6784\u8bcd\u89c4\u5219\u8bc6\u522b\u5355\u8bcd(\u4e5f\u79f0\u5355\u8bcd\u7b26\u53f7\u6216\u7b26\u53f7)\u3002</p> <p>\u8bcd\u6cd5\u5206\u6790\u7a0b\u5e8f\u5b9e\u73b0\u8fd9\u4e2a\u4efb\u52a1\u3002\u8bcd\u6cd5\u5206\u6790\u7a0b\u5e8f\u53ef\u4ee5\u4f7f\u7528Lex\u7b49\u5de5\u5177\u81ea\u52a8\u751f\u6210,lex\u53ef\u4ee5\u53c2\u8003Lex\u4e0eYACC\u8be6\u89e3\u3002</p> <p>\u8bcd\u6cd5\u5206\u6790\u662f\u7f16\u8bd1\u7a0b\u5e8f\u7684\u7b2c\u4e00\u4e2a\u9636\u6bb5\u4e14\u662f\u5fc5\u8981\u9636\u6bb5\uff1b\u8bcd\u6cd5\u5206\u6790\u7684\u6838\u5fc3\u4efb\u52a1\u662f\u626b\u63cf\u3001\u8bc6\u522b\u5355\u8bcd\u4e14\u5bf9\u8bc6\u522b\u51fa\u7684\u5355\u8bcd\u7ed9\u51fa\u5b9a\u6027\u3001\u5b9a\u957f\u7684\u5904\u7406\uff1b</p> <p>\u8bcd\u6cd5\u5206\u6790 &amp; \u8bed\u6cd5\u5206\u6790 \u9636\u6bb5\u7684\u5165\u53e3\u662f**\u8bed\u6cd5\u5206\u6790\u5668**\uff0c\u8bed\u6cd5\u5206\u6790\u5668\u8c03\u7528\u8bcd\u6cd5\u5206\u6790\u5668\u8bfb\u53d6\u4e00\u4e2a token \u8fdb\u884c\u5206\u6790\uff0c\u5206\u6790\u5b8c\u540e\u518d\u8bfb\u53d6\u4e00\u4e2a token\uff0c\u76f4\u5230\u5206\u6790\u5b8c\u6240\u6709\u7684 token\uff0c\u7ed3\u675f\u6574\u4e2a\u8fc7\u7a0b\u3002\u6240\u4ee5\uff0c\u8bcd\u6cd5\u5206\u6790 &amp; \u8bed\u6cd5\u5206\u6790\u9636\u6bb5\u5b9e\u9645\u4e0a\u662f\u7531\u8bed\u6cd5\u5206\u6790\u5668\u9a71\u52a8\u7684\u3002</p> <p>**\u8bcd\u6cd5\u5206\u6790**\u548c**\u8bed\u6cd5\u89e3\u6790**\u6709\u4e24\u4e2a\u8f83\u6210\u719f\u7684\u5f00\u6e90\u5de5\u5177<code>Flex</code>\u548c<code>Bison</code>\u5206\u522b\u7528\u6765\u89e3\u51b3\u8fd9\u4e24\u4e2a\u95ee\u9898\u3002</p> <p>MySQL\u51fa\u4e8e\u4e8e\u6027\u80fd\u548c\u7075\u6d3b\u8003\u8651\uff0c\u9009\u62e9\u4e86\u81ea\u5df1\u5b8c\u6210\u8bcd\u6cd5\u89e3\u6790\u90e8\u5206\uff0c\u8bed\u6cd5\u89c4\u5219\u90e8\u5206\u4f7f\u7528Bison\u3002\u8bcd\u6cd5\u89e3\u6790\u548cBison\u6c9f\u901a\u7684\u6838\u5fc3\u51fd\u6570\u662f\u7531\u8bcd\u6cd5\u89e3\u6790\u5668\u63d0\u4f9b\u7684\u51fd\u6570\u63a5\u53e3yylex()\uff0c\u5728Bison\u4e2d\uff0c\u5fc5\u8981\u7684\u65f6\u5019\u8c03\u7528yylex()\u83b7\u5f97\u8bcd\u6cd5\u89e3\u6790\u7684\u6570\u636e\uff0c\u5b8c\u6210\u81ea\u5df1\u7684\u8bed\u6cd5\u89e3\u6790\u3002Bison\u7684\u5165\u53e3\u65f6yyparse()\uff0c\u5728MySQL\u4e2d\u662f\uff0cMYSQLParse\u3002 </p> <p>\u5728 <code>MySQL</code> \u6570\u636e\u5e93\u4e2d\uff0c\u5ba2\u6237\u7aef\u5411\u670d\u52a1\u5668\u53d1\u9001\u8fc7\u6765SQL\u8bed\u53e5\u540e\uff0c\u670d\u52a1\u5668\u9996\u5148\u8981\u8fdb\u884c**\u8bcd\u6cd5\u5206\u6790**\uff0c\u800c\u540e\u8fdb\u884c**\u8bed\u6cd5\u5206\u6790**\uff0c\u8bed\u4e49\u5206\u6790\uff0c\u6784\u9020\u6267\u884c\u6811\uff0c\u751f\u6210\u6267\u884c\u8ba1\u5212\u3002**\u8bcd\u6cd5\u5206\u6790**\u662f\u7b2c\u4e00\u9636\u6bb5\uff0c\u7136\u800cMySQL\u5e76\u6ca1\u6709\u4f7f\u7528lex\u6765\u5b9e\u73b0\u8bcd\u6cd5\u5206\u6790\uff0c\u4f46\u662f\u8bed\u6cd5\u5206\u6790\u5374\u7528\u4e86yacc\uff0c\u800cyacc\u9700\u8981\u8bcd\u6cd5\u5206\u6790\u51fd\u6570yylex\uff0c\u6545\u5728sql_yacc.cc\u6587\u4ef6\u6700\u524d\u9762\u6211\u4eec\u53ef\u4ee5\u770b\u5230\u5982\u4e0b\u7684\u5b8f\u5b9a\u4e49:</p> <p>MySQL\u7684\u8bcd\u6cd5\u5206\u6790\u5668\u4e5f\u662f\u624b\u5199\u7684\uff0c\u8fd9\u7ed9\u7b97\u6cd5\u63d0\u4f9b\u4e86\u4e00\u5b9a\u7684\u7075\u6d3b\u6027\u3002\u6bd4\u5982\uff0cSQL\u8bed\u53e5\u4e2d\uff0cToken\u7684\u89e3\u6790\u662f\u8ddf\u5f53\u524d\u4f7f\u7528\u7684\u5b57\u7b26\u96c6\u6709\u5173\u7684\u3002\u4f7f\u7528\u4e0d\u540c\u7684\u5b57\u7b26\u96c6\uff0c\u8bcd\u6cd5\u5206\u6790\u5668\u6240\u5360\u7528\u7684\u5b57\u8282\u6570\u662f\u4e0d\u4e00\u6837\u7684\uff0c\u5224\u65ad\u5408\u6cd5\u5b57\u7b26\u7684\u4f9d\u636e\u4e5f\u662f\u4e0d\u540c\u7684\u3002\u800c\u5b57\u7b26\u96c6\u4fe1\u606f\uff0c\u53d6\u51b3\u4e8e\u5f53\u524d\u7684\u7cfb\u7edf\u7684\u914d\u7f6e\u3002\u8bcd\u6cd5\u5206\u6790\u5668\u53ef\u4ee5\u6839\u636e\u8fd9\u4e9b\u914d\u7f6e\u4fe1\u606f\uff0c\u6b63\u786e\u5730\u89e3\u6790\u6807\u8bc6\u7b26\u548c\u5b57\u7b26\u4e32\u3002</p> <p>\u5047\u8bbe\u6211\u4eec\u6709\u4e00\u4e2a\u540d\u4e3a\"employees\"\u7684\u8868\uff0c\u5b83\u5305\u542b\u4e86\u5458\u5de5\u7684\u4fe1\u606f\uff0c\u5176\u4e2d\u5305\u542b\u5217\uff1a<code>employee_id</code>\u3001<code>first_name</code>\u3001<code>last_name</code>\u3001<code>department</code>\u3001<code>salary</code></p> <p>\u5982\u679c\u8bed\u53e5\u4e3a\uff1a</p> <pre><code>SELECT first_name, last_name, salary\nFROM employees\nWHERE department = 'IT';\n</code></pre> <p>\u8bcd\u6cd5\u5206\u6790</p> <p>\u8bcd\u6cd5\u5206\u6790\u7684\u4efb\u52a1\u4e86\uff1a\u8f93\u5165\u7684\u662f\u5b57\u7b26\u4e32\uff0c\u8f93\u51fa\u7684\u662fToken\u4e32\u3002</p> <p>\u5728\u8bcd\u6cd5\u5206\u6790\u9636\u6bb5\uff0cMySQL\u4f1a\u5c06\u8f93\u5165\u7684SQL\u8bed\u53e5\u62c6\u5206\u6210\u4e0d\u540c\u7684\u8bcd\u5143(Token)\u3002\u5bf9\u4e8e\u8fd9\u4e2aSELECT\u8bed\u53e5\uff0c\u8bcd\u6cd5\u5206\u6790\u5668\u4f1a\u4ea7\u751f\u4ee5\u4e0b\u8bcd\u5143\uff1a</p> <pre><code>SELECT, first_name, comma, last_name, comma, salary, FROM, employees, WHERE, department, equal, 'IT', semicolon\n</code></pre> <p>\u5728\u5206\u6790\u8fc7\u7a0b\u4e2d\uff0c\u8bcd\u6cd5\u5206\u6790\u5668\u4f7f\u7528\u6709\u9650\u72b6\u6001\u673a\uff08finite state machine\uff09\u6765\u786e\u5b9a\u6bcf\u4e2a\u8bcd\u5143\u7684\u7c7b\u578b\u3002</p> <p>\u6709\u9650\u72b6\u6001\u673a\u662f\u4e00\u79cd\u62bd\u8c61\u8ba1\u7b97\u673a\uff0c\u5b83\u5728\u4e0d\u540c\u7684\u72b6\u6001\u4e4b\u95f4\u8f6c\u6362\uff0c\u6839\u636e\u8f93\u5165\u7684\u5b57\u7b26\u6765\u51b3\u5b9a\u72b6\u6001\u8f6c\u6362\u89c4\u5219\u3002\u4e3b\u8981\u7684\u8bcd\u6cd5\u5206\u6790\u6b65\u9aa4\u5982\u4e0b\uff1a</p> <ul> <li>\u8df3\u8fc7\u7a7a\u767d\u5b57\u7b26\uff1a\u8bcd\u6cd5\u5206\u6790\u5668\u4f1a\u8df3\u8fc7\u7a7a\u683c\u3001\u5236\u8868\u7b26\u3001\u6362\u884c\u7b26\u7b49\u4e0d\u5fc5\u8981\u7684\u7a7a\u767d\u5b57\u7b26\u3002</li> <li>\u8bc6\u522b\u5173\u952e\u5b57\u548c\u6807\u8bc6\u7b26\uff1a\u8bcd\u6cd5\u5206\u6790\u5668\u5c06\u8bc6\u522b\u51faSELECT\u3001FROM\u3001WHERE\u7b49\u5173\u952e\u5b57\uff0c\u5e76\u5c06\u5b83\u4eec\u4f5c\u4e3a\u76f8\u5e94\u7684\u8bcd\u5143\u7c7b\u578b\u3002</li> <li>\u8bc6\u522b\u8fd0\u7b97\u7b26\u548c\u6807\u70b9\u7b26\u53f7\uff1a\u8bcd\u6cd5\u5206\u6790\u5668\u5c06\u8bc6\u522b\u51fa\u9017\u53f7\uff08comma\uff09\u3001\u7b49\u53f7\uff08equal\uff09\u3001\u5206\u53f7\uff08semicolon\uff09\u7b49\u8fd0\u7b97\u7b26\u548c\u6807\u70b9\u7b26\u53f7\uff0c\u5e76\u5c06\u5b83\u4eec\u4f5c\u4e3a\u76f8\u5e94\u7684\u8bcd\u5143\u7c7b\u578b\u3002</li> <li>\u8bc6\u522b\u5e38\u91cf\uff1a\u8bcd\u6cd5\u5206\u6790\u5668\u5c06\u8bc6\u522b\u51fa'IT'\u4f5c\u4e3a\u4e00\u4e2a\u5b57\u7b26\u4e32\u5e38\u91cf\uff0c\u5e76\u5c06\u5176\u4f5c\u4e3a\u76f8\u5e94\u7684\u8bcd\u5143\u7c7b\u578b\u3002</li> <li>\u8bc6\u522b\u6570\u5b57\uff1a\u5982\u679cSQL\u8bed\u53e5\u4e2d\u6709\u6570\u5b57\uff0c\u8bcd\u6cd5\u5206\u6790\u5668\u4e5f\u4f1a\u5c06\u5176\u8bc6\u522b\u4e3a\u4e00\u4e2a\u6570\u5b57\u5e38\u91cf\u3002</li> </ul> <p>MySQL \u4f7f\u7528 Bison \u8bed\u6cd5\u89e3\u6790\u5668\u5b9e\u73b0 SQL \u8bed\u53e5\u7684\u89e3\u6790\u529f\u80fd\u3002Bison \u89e3\u6790\u5668\u7684\u6838\u5fc3\u903b\u8f91\u5982\u4e0b\uff1a</p> <ul> <li>Bison \u8bed\u6cd5\u6587\u4ef6</li> <li>yylex() \u51fd\u6570\uff1a\u7528\u4e8e\u5b9e\u73b0\u8bcd\u6cd5\u89e3\u6790\u5668\u7684\u529f\u80fd\uff0c\u5c06\u8f93\u5165\u6d41\u8bc6\u522b\u4e3a Token \u5e76\u5c06\u5b83\u4eec\u8fd4\u56de\u7ed9\u89e3\u6790\u5668</li> <li>yyparse() \u51fd\u6570\uff1a\u8bed\u6cd5\u89e3\u6790\u5668\u7684\u5165\u53e3\u51fd\u6570\uff0c\u8be5\u51fd\u6570\u7531 Bison \u89e3\u6790\u5668\u751f\u6210\uff0c\u7528\u4e8e\u8fd0\u884c\u6267\u884c\u89e3\u6790\u8fc7\u7a0b</li> </ul> <p>bison\u7684\u89c4\u5219\u6587\u4ef6\u662f<code>sql/sql_yacc.yy</code>\uff0c\u7ecf\u8fc7\u7f16\u8bd1\u540e\u4f1a\u751f\u6210<code>sql/sql_yacc.cc</code>\u6587\u4ef6\u3002</p> <p>\u5728 MySQL \u4e2d\uff0c<code>sql/sql_yacc.yy</code> \u6587\u4ef6\u662f\u4f7f\u7528<code>Bison</code>\u5de5\u5177\u751f\u6210\u8bed\u6cd5\u5206\u6790\u5668\u7684\u8f93\u5165\u6587\u4ef6\u3002\u5b83\u63cf\u8ff0\u4e86<code>MySQL</code>\u8bed\u53e5\u7684\u8bed\u6cd5\u89c4\u5219\uff0c\u4f7f\u7528\u4e00\u79cd\u7c7b\u4f3c\u4e8e BNF\uff08Backus-Naur Form\uff09\u7684\u8bed\u6cd5\u6765\u5b9a\u4e49\u3002Bison \u4f1a\u6839\u636e\u8fd9\u4e2a\u6587\u4ef6\u751f\u6210 C++ \u4ee3\u7801\uff0c\u8fd9\u4e9b\u4ee3\u7801\u5b9e\u73b0\u4e86<code>MySQL</code>\u7684\u8bed\u6cd5\u5206\u6790\u5668\u3002</p> <p>sql_yacc.yy \u7684\u4f5c\u7528   - \u5b9a\u4e49 SQL \u8bed\u6cd5\uff1a \u901a\u8fc7\u4e00\u7cfb\u5217\u89c4\u5219\uff0c\u660e\u786e\u5b9a\u4e49\u4e86<code>SQL</code>\u8bed\u53e5\u7684\u7ec4\u6210\u90e8\u5206\u3001\u7ed3\u6784\u548c\u5b83\u4eec\u4e4b\u95f4\u7684\u5173\u7cfb\u3002   - \u751f\u6210\u8bed\u6cd5\u5206\u6790\u5668\uff1a Bison \u5de5\u5177\u4f1a\u6839\u636e<code>sql_yacc.yy</code>\u6587\u4ef6\u4e2d\u7684\u89c4\u5219\u751f\u6210 C++ \u4ee3\u7801\uff0c\u8fd9\u4e9b\u4ee3\u7801\u7ec4\u6210\u4e86MySQL\u7684\u8bed\u6cd5\u5206\u6790\u5668\u3002   - \u6307\u5bfc\u8bed\u6cd5\u5206\u6790\uff1a \u751f\u6210\u7684\u8bed\u6cd5\u5206\u6790\u5668\u4f1a\u6839\u636e<code>sql_yacc.yy</code>\u4e2d\u5b9a\u4e49\u7684\u89c4\u5219\uff0c\u5bf9\u8f93\u5165\u7684 SQL \u8bed\u53e5\u8fdb\u884c\u8bed\u6cd5\u5206\u6790\uff0c\u68c0\u67e5\u5176\u662f\u5426\u7b26\u5408 SQL \u8bed\u6cd5\u89c4\u8303\u3002</p> <p>\u8bcd\u6cd5\u5206\u6790\u4e2d\u7684\u5404\u79cdToken\uff0c\u90fd\u662f\u5728<code>sql/lex_token.h</code>\u4e2d\u5b9a\u4e49\u7684\uff0c\u8fd9\u4e2a\u662f\u6587\u4ef6\u662f\u901a\u8fc7This file is generated, do not edit.  See file sql/gen_lex_token</p> <pre><code>sql/lex.h                    // symbol\nsql/gen_lex_token.{h,cc}     // token\nsql/sql_lex_hints.{h,cc}     // hint lexer\nsql/sql_hints.yy             // hint parser\nsql/parse_tree_hints.{h,cc}  // PT_hint_list, PT_hint, PT_{qb,table,key}_level_hint, PT_hint_sys_var, ...\nsql/sql_lex.cc               // consume_optimizer_hints()\n</code></pre> <p>Tokens printed in sql/lex_token.h do come from several sources:   - tokens from sql_yacc.yy   - tokens from sql_hints.yy   - fake tokens for digests.</p> <p>All the token values are mapped in the same space, indexed by the token value directly.</p> <p>To account for enhancements and new tokens,  gap are created, so that adding a token from one source does not change values of tokens from other sources.</p> <p>This is done to ensure stability in digest computed values.</p> <p>As of now (8.0.0), the mapping looks like this:   - PART 1: [0 .. 255] tokens of single-character lexemes   - PART 2: [256 .. ...] tokens &lt; YYUNDEF from sql_yacc.yy   - PART 3: [... .. 999] reserved for sql_yacc.yy new tokens &lt; YYUNDEF   - PART 4: [1000 .. ...] tokens from sql_hints.yy   - PART 5: [... .. 1099] reserved for sql_hints.yy new tokens   - PART 6: [1100 .. ...] digest special fake tokens   - PART 7: [... .. 1149] reserved for new digest special fake tokens   - PART 8: [1150 .. ...] tokens &gt; YYUNDEF from sql_yacc.yy</p> <p><code>sql/sql_yacc.cc</code>\u6587\u4ef6\u662f MySQL \u8bed\u6cd5\u5206\u6790\u5668\u7684\u4e00\u4e2a\u6838\u5fc3\u7ec4\u6210\u90e8\u5206\uff0c\u5b83\u662f\u901a\u8fc7 Bison \u5de5\u5177\u6839\u636e <code>sql/sql_yacc.yy</code> \u6587\u4ef6\u751f\u6210\u7684\u3002</p> <p>\u751f\u6210\u8fc7\u7a0b\u6982\u8ff0 - \u7f16\u5199 sql_yacc.yy \u6587\u4ef6\uff1a \u8fd9\u4e2a\u6587\u4ef6\u4f7f\u7528 Bison \u8bed\u6cd5\u63cf\u8ff0 MySQL SQL \u8bed\u53e5\u7684\u8bed\u6cd5\u89c4\u5219\u3002 - \u8fd0\u884c Bison\uff1a\u5c06 sql_yacc.yy \u6587\u4ef6\u4f5c\u4e3a\u8f93\u5165\uff0c\u4f7f\u7528 Bison \u5de5\u5177\u8fdb\u884c\u7f16\u8bd1\u3002Bison \u4f1a\u6839\u636e\u5b9a\u4e49\u7684\u8bed\u6cd5\u89c4\u5219\u751f\u6210 C++ \u4ee3\u7801\uff0c\u8fd9\u4e9b\u4ee3\u7801\u5b9e\u73b0\u4e86\u8bed\u6cd5\u5206\u6790\u5668\u7684\u6838\u5fc3\u903b\u8f91\u3002 - \u751f\u6210 sql_yacc.cc \u6587\u4ef6\uff1a Bison \u7684\u8f93\u51fa\u7ed3\u679c\u4e4b\u4e00\u5c31\u662f sql_yacc.cc \u6587\u4ef6\u3002\u8fd9\u4e2a\u6587\u4ef6\u5305\u542b\u4e86\u8bed\u6cd5\u5206\u6790\u5668\u6240\u9700\u8981\u7684\u51fd\u6570\u548c\u6570\u636e\u7ed3\u6784\u3002</p> <p>\u5728 MySQL \u7684\u6e90\u7801\u4e2d\uff0cBison \u7684\u8bed\u6cd5\u6587\u4ef6\u4e3a<code>sql/sql_yacc.yy</code>\uff0c\u5176\u4e2d\u4e3b\u8981\u5305\u542b\u5982\u4e0b\u4e09\u90e8\u5206\uff1a   - Bison \u58f0\u660e   - \u7ec8\u7ed3\u7b26\u3001\u8bed\u4e49\u7ec4\u7684\u8fd4\u56de\u503c\u7c7b\u578b   - \u8bed\u4e49\u7ec4\u7684\u5907\u9009\u89c4\u5219\u53ca\u884c\u4e3a</p> <pre><code>// \u5728\u8bed\u6cd5\u5206\u6790\u5668\uff08\u5982 Bison\uff09\u4e2d\u5b9a\u4e49\u4e86\u4e00\u4e2a\u540d\u4e3a ABORT_SYM \u7684 token\uff0c\u5176\u6570\u503c\u4e3a 258\u3002\n\n\n/*      Tokens from MySQL 5.7, keep in alphabetical order                 */\n%token  ABORT_SYM 258                     /* INTERNAL (used in lex) */\n%token  ACCESSIBLE_SYM 259\n%token&lt;lexer.keyword&gt; ACCOUNT_SYM 260\n%token&lt;lexer.keyword&gt; ACTION 261                /* SQL-2003-N */\n%token  ADD 262                           /* SQL-2003-R */\n%token&lt;lexer.keyword&gt; ADDDATE_SYM 263           /* MYSQL-FUNC */\n%token&lt;lexer.keyword&gt; AFTER_SYM 264             /* SQL-2003-N */\n\n/*   many token and so on */\n\n%token&lt;lexer.keyword&gt; YEAR_SYM 905              /* SQL-2003-R */\n%token  ZEROFILL_SYM 906                  /* MYSQL */\n\n\n\n/*  Tokens from MySQL 8.0*/\n%token  JSON_UNQUOTED_SEPARATOR_SYM 907                 /* MYSQL */\n/*   many token and so on                                   */\n%token&lt;lexer.keyword&gt; RETURNING_SYM 999                 /* SQL-2016-N */\n...\n</code></pre> <p>sql/sql_yacc.yy\uff1bsql/sql_lex.cc\uff1bsql/parser_yystype.h</p> <p>MySQL\u8bcd\u6cd5\u89e3\u6790\u7684\u5165\u53e3\u51fd\u6570\u662f<code>sql/sql_lex.cc</code>\u4e2d\u5b9a\u4e49\u7684 <code>my_sql_parser_lex()</code> \u51fd\u6570\u3002</p> <p>\u56e0\u4e3a\u5728 Bison \u8bed\u6cd5\u6587\u4ef6<code>sql/sql_yacc.yy</code>\u4e2d\u5b9a\u4e49\u4e86 <code>%define api.prefix {my_sql_parser_}</code>\uff0c\u6240\u4ee5 MySQL \u7684 <code>yylex()</code> \u51fd\u6570\u5373 <code>my_sql_parser_lex()</code> \u51fd\u6570\u3002</p> <pre><code>/**\n  yylex() function implementation for the main parser\n\n  @param [out] yacc_yylval   semantic value of the token being parsed (yylval)\n  @param [out] yylloc        \"location\" of the token being parsed (yylloc)\n  @param thd                 THD\n\n  @return                    token number\n\n  @note\n  my_sql_parser_lex remember the following states from the\n  following my_sql_parser_lex():\n\n  - MY_LEX_END          Found end of query\n*/\n\n\nint my_sql_parser_lex(MY_SQL_PARSER_STYPE *yacc_yylval, POS *yylloc, THD *thd) {}\n</code></pre> <p><code>MYSQLlex</code>\u51fd\u6570\u662f MySQL \u8bcd\u6cd5\u5206\u6790\u5668\u7684\u6838\u5fc3\uff0c\u8d1f\u8d23\u5c06 SQL \u5b57\u7b26\u4e32\u5206\u5272\u6210 Token\u3002 <code>my_sql_parser_lex</code>\u51fd\u6570\u662f\u5bf9 MYSQLlex \u51fd\u6570\u7684\u5c01\u88c5\uff0c\u63d0\u4f9b\u4e86\u4e00\u4e2a\u66f4\u9ad8\u5c42\u6b21\u7684\u63a5\u53e3\uff0c\u65b9\u4fbf\u5176\u4ed6\u6a21\u5757\u8c03\u7528\u8bcd\u6cd5\u5206\u6790\u529f\u80fd\u3002</p>"},{"location":"mysql-kernel/01.MySQL%E6%BA%90%E7%A0%81-%E8%AF%AD%E6%B3%95%E6%A0%91%E7%BB%93%E6%9E%84/#_2","title":"\u6e90\u4ee3\u7801\u5206\u6790","text":""},{"location":"mysql-kernel/01.MySQL%E6%BA%90%E7%A0%81-%E8%AF%AD%E6%B3%95%E6%A0%91%E7%BB%93%E6%9E%84/#_3","title":"\u8bcd\u6cd5\u5206\u6790 &amp; \u8bed\u6cd5\u5206\u6790","text":""},{"location":"mysql-kernel/01.MySQL%E6%BA%90%E7%A0%81-%E8%AF%AD%E6%B3%95%E6%A0%91%E7%BB%93%E6%9E%84/#_4","title":"\u521d\u59cb\u5316\u5b57\u6bb5","text":"<p>select\u5b50\u53e5\u4e2d\uff0c\u5b57\u6bb5\u53ef\u80fd\u6709 2 \u79cd\u7c7b\u578b\uff0c\u4e00\u79cd\u662f\u661f\u53f7\uff08*\uff09\uff0c\u4e00\u79cd\u662f\u666e\u901a\u5b57\u6bb5\uff0c\u661f\u53f7\u4f1a\u7528 <code>Item_asterisk</code> \u7c7b\u5b9e\u4f8b\u5316\uff0c\u800c <code>Item_asterisk</code> \u7c7b\u662f Item_field \u7c7b\u7684\u5b50\u7c7b\u3002\u666e\u901a\u5b57\u6bb5\u5c31\u76f4\u63a5\u7528 <code>Item_field</code> \u7c7b\u5b9e\u4f8b\u5316\u3002</p> <p>\u8bcd\u6cd5\u5206\u6790 &amp; \u8bed\u6cd5\u5206\u6790\u9636\u6bb5\uff0c\u5404\u5b57\u6bb5\u53ea\u662f\u5b8c\u6210\u4e86 <code>Item_field</code> \u7c7b\u7684\u5b9e\u4f8b\u5316\uff0c\u4f46\u662f\u8fd8\u6ca1\u6709\u5bf9\u5e94\u5230\u8868\u4e2d\u771f\u5b9e\u7684\u5b57\u6bb5\u3002\u6b64\u65f6\uff0c<code>Item_field</code> \u7c7b\u5b9e\u4f8b\u5c31\u50cf\u521a\u521a\u6210\u5f62\u7684\u5c0f\u874c\u86aa\uff0c\u8fd8\u6ca1\u6709\u627e\u5230\u5988\u5988\u3002\u5b83\u7684\u5988\u5988\u662f Field \u7c7b\uff08\u6216\u5b50\u7c7b\uff09\u7684\u5b9e\u4f8b\u3002</p> <p>\u8981\u7b49\u5230\u67e5\u8be2\u51c6\u5907\u9636\u6bb5\uff0c<code>Item_field</code> \u7c7b\u5b9e\u4f8b\u624d\u4f1a\u53bb\u627e\u5988\u5988\uff0c\u627e\u5230\u5988\u5988\u4e4b\u540e\uff0c<code>Item_field</code> \u7c7b\u5b9e\u4f8b\u4e2d\u7684 <code>field</code> \u5c5e\u6027\u4f1a\u6307\u5411\u627e\u5230\u7684 Field \u7c7b\uff08\u6216\u5b50\u7c7b\uff09\u5b9e\u4f8b\uff0c\u4ece\u6b64\u4ee5\u540e\uff0c\u5c0f\u874c\u86aa\u548c\u5988\u5988\u5c31\u8fc7\u4e0a\u4e86\u5e78\u798f\u5feb\u4e50\u7684\u751f\u6d3b\u3002</p>"},{"location":"mysql-kernel/01.MySQL%E6%BA%90%E7%A0%81-%E8%AF%AD%E6%B3%95%E6%A0%91%E7%BB%93%E6%9E%84/#_5","title":"\u521d\u59cb\u5316\u8868","text":"<p>\u5bf9\u4e8e<code>FROM</code>\u5b50\u53e5\u4e2d\u7684\u6bcf\u4e2a\u8868\uff0c\u90fd\u4f1a\u521b\u5efa\u4e00\u4e2a <code>TABLE_LIST</code> \u7c7b\u7684\u5b9e\u4f8b\uff0c<code>TABLE_LIST</code> \u7c7b\u5b9e\u4f8b\u4e2d\u53ea\u4fdd\u5b58\u4e86\u6570\u636e\u5e93\u540d\u3001\u8868\u540d\u3001\u8868\u522b\u540d\u3001\u7d22\u5f15\u63d0\u793a\u8fd9\u51e0\u4e2a\u6211\u4eec\u4f7f\u7528\u8fc7\u7a0b\u4e2d\u6709\u611f\u77e5\u7684\u5c5e\u6027\uff0c<code>TABLE_LIST</code> \u7c7b\u5b9e\u4f8b\u4e2d\u6709\u4e2a\u5f88\u91cd\u8981\u7684\u5c5e\u6027 <code>table</code>\uff0c\u5b83\u7684\u7c7b\u578b\u662f <code>TABLE</code>\uff0c\u8fd9\u4e2a\u7c7b\u7684\u5b9e\u4f8b\u624d\u662f\u771f\u6b63\u4fdd\u5b58\u7740\u8868\u4e2d\u6240\u6709\u4fe1\u606f\u7684\u5730\u65b9\u3002</p> <p>\u7b49\u5230\u67e5\u8be2\u51c6\u5907\u9636\u6bb5\uff0c\u624d\u4f1a\u627e\u5230 <code>TABLE_LIST</code> \u7c7b\u5b9e\u4f8b\u5bf9\u5e94\u7684 <code>TABLE</code> \u7c7b\u5b9e\u4f8b\u3002</p> <p>\u8fd9\u91cc\u8981\u7279\u522b\u8bf4\u660e\u7684\u4e00\u70b9\u662f\u6570\u636e\u5e93\u540d\uff0c\u6211\u4eec\u4e00\u822c\u5728\u5199SQL\u65f6\uff0cFROM \u5b50\u53e5\u4e2d\u7684\u8868\u540d\u524d\u9762\u662f\u4e0d\u4f1a\u5e26\u4e0a\u6570\u636e\u5e93\u540d\u7684\uff0c\u5c31\u50cf\u672c\u6587\u793a\u4f8b SQL \u4e2d\u7684\u4e00\u6837\u3002\u5728**\u8bcd\u6cd5\u5206\u6790 &amp; \u8bed\u53e5\u5206\u6790**\u9636\u6bb5\uff0c\u521d\u59cb\u5316\u8868\u7684\u65f6\u5019\uff0c\u5982\u679c\u8868\u540d\u524d\u9762\u6ca1\u6709\u5e26\u4e0a\u6570\u636e\u5e93\u540d\uff0c\u5c31\u4f1a\u628a\u5f53\u524d\u8fde\u63a5\u4e2d\u4fdd\u5b58\u7684\u6570\u636e\u5e93\u540d\u8bfb\u53d6\u51fa\u6765\uff0c\u4fdd\u5b58\u5230<code>TABLE_LIST</code>\u7c7b\u5b9e\u4f8b\u7684\u5c5e\u6027\u4e2d\uff0c\u5982\u679cFROM\u5b50\u53e5\u4e2d\u8868\u540d\u524d\u9762\u5e26\u4e86\u6570\u636e\u5e93\u540d\uff0c\u5219\u628a\u81ea\u5e26\u7684\u6570\u636e\u5e93\u540d\u4fdd\u5b58\u5230**TABLE_LIST**\u7c7b\u5b9e\u4f8b\u7684\u5c5e\u6027\u4e2d\u3002</p>"},{"location":"mysql-kernel/01.MySQL%E6%BA%90%E7%A0%81-%E8%AF%AD%E6%B3%95%E6%A0%91%E7%BB%93%E6%9E%84/#where","title":"\u521d\u59cb\u5316WHERE\u6761\u4ef6","text":"<p>\u521d\u59cb\u5316 where \u6761\u4ef6\u8981\u6bd4\u521d\u59cb\u5316\u5b57\u6bb5\u590d\u6742\u5f97\u591a\uff0c</p>"},{"location":"mysql-kernel/01.MySQL%E6%BA%90%E7%A0%81-%E8%AF%AD%E6%B3%95%E6%A0%91%E7%BB%93%E6%9E%84/#_6","title":"\u67e5\u8be2\u51c6\u5907\u9636\u6bb5","text":"<p>\u5728\u67e5\u8be2\u51c6\u5907\u9636\u6bb5\u4f1a\u5e72\u54ea\u4e9b\u4e8b\u60c5\uff1f\u5206 3 \u4e2a\u90e8\u5206\uff1a</p> <ul> <li>\u6253\u5f00\u8868</li> <li>select * \u66ff\u6362\u4e3a\u8868\u5b57\u6bb5</li> <li>\u586b\u5145 where \u6761\u4ef6</li> </ul>"},{"location":"mysql-kernel/01.MySQL%E6%BA%90%E7%A0%81-%E8%AF%AD%E6%B3%95%E6%A0%91%E7%BB%93%E6%9E%84/#_7","title":"\u6253\u5f00\u8868","text":"<p>\u4ece\u5b58\u50a8\u5f15\u64ce\u8bfb\u53d6\u6570\u636e\u4e4b\u524d\uff0cMySQL \u9700\u8981\u628a SQL \u4e2d\u6d89\u53ca\u7684\u6240\u6709\u8868\u7684\u4fe1\u606f\u8bfb\u53d6\u51fa\u6765\u3002</p> <p>\u4e8c\u7ea7\u7f13\u5b58</p>"},{"location":"mysql-kernel/01.MySQL%E6%BA%90%E7%A0%81-%E8%AF%AD%E6%B3%95%E6%A0%91%E7%BB%93%E6%9E%84/#_8","title":"\u5b57\u6bb5\u66ff\u6362","text":"<p>\u5728\u5199 select \u8bed\u53e5\u7684\u8fc7\u7a0b\u4e2d\uff0c\u7ecf\u5e38\u4f1a\u7528\u5230\u661f\u53f7\uff08*\uff09\uff0c\u8868\u793a\u67e5\u8be2\u8868\u4e2d\u6240\u6709\u5b57\u6bb5\uff0c\u4f46\u662f\u8868\u4e2d\u5e76\u6ca1\u6709\u4e00\u4e2a\u661f\u53f7\u5b57\u6bb5\u7528\u6765\u8868\u793a\u6240\u6709\u5b57\u6bb5\uff0c\u6240\u4ee5\u5728\u67e5\u8be2\u51c6\u5907\u9636\u6bb5\uff0c\u4f1a\u628a\u661f\u53f7\u66ff\u6362\u4e3a\u8868\u4e2d\u7684\u6240\u6709\u5b57\u6bb5\u3002</p> <p>\u8fd9\u4e2a\u66ff\u6362\u8fc7\u7a0b\u4e00\u822c\u5c31\u662f\u76f4\u63a5\u904d\u5386\u8868\u4e2d\u7684\u6240\u6709\u5b57\u6bb5\uff0c\u4e3a\u6bcf\u4e2a\u5b57\u6bb5\u521b\u5efa\u4e00\u4e2a Item_field \u7c7b\u5b9e\u4f8b\uff0c\u5e76\u4e14\u7531\u4e8e\u662f\u76f4\u63a5\u904d\u5386\u8868\u4e2d\u7684 Field \u5b50\u7c7b\u5b9e\u4f8b\u5217\u8868\uff0c\u5728\u521b\u5efa Item_field \u7c7b\u5b9e\u4f8b\u7684\u65f6\u5019\u5c31\u5173\u8054\u4e0a\u4e86 Field \u5b50\u7c7b\u5b9e\u4f8b\u3002</p> <p>\u904d\u5386\u5b8c\u8868\u4e2d\u6240\u6709\u5b57\u6bb5\u4e4b\u540e\uff0c\u5f62\u6210\u4e00\u4e2a Item_field \u5217\u8868\uff0c\u66ff\u6362\u6389\u661f\u53f7\uff08*\uff09\u5bf9\u5e94\u7684 Item_field \u5217\u8868\u5c31\u884c\u4e86\uff0c\u81f3\u6b64\uff0c\u5c31\u5b8c\u6210\u4e86 select \u8bed\u53e5\u4e2d\u661f\u53f7\u66ff\u6362\u4e3a\u8868\u5b57\u6bb5\u7684\u8fc7\u7a0b\u4e86\u3002</p>"},{"location":"mysql-kernel/01.MySQL%E6%BA%90%E7%A0%81-%E8%AF%AD%E6%B3%95%E6%A0%91%E7%BB%93%E6%9E%84/#_9","title":"\u586b\u5145\u6761\u4ef6","text":"<p>MySQL \u4ece InnoDB \u8bfb\u53d6\u6570\u636e\u4e4b\u524d\uff0c\u8bcd\u6cd5\u5206\u6790\u3001\u8bed\u6cd5\u5206\u6790\u3001\u67e5\u8be2\u51c6\u5907\u3001\u67e5\u8be2\u4f18\u5316\u8fd9\u4e9b\u9636\u6bb5\u90fd\u662f server \u5c42\u7684\u8303\u56f4\uff0c\u5728 server \u5c42\u4e2d\u9700\u8981\u4f7f\u7528\u7d22\u5f15\u4fe1\u606f\u65f6\uff0c\u4f7f\u7528\u7684\u90fd\u662f MySQL \u7684\u7d22\u5f15\u4fe1\u606f\u3002</p>"},{"location":"olap/01.OLAP%E6%A6%82%E8%BF%B0/","title":"\u6954\u5b50","text":"<p>OLAP \u540d\u4e3a\u8054\u673a\u5206\u6790\u5904\u7406\uff0c\u53c8\u53ef\u4ee5\u79f0\u4e4b\u4e3a\u591a\u7ef4\u5206\u6790\u5904\u7406\uff0c\u662f\u7531\u5173\u7cfb\u578b\u6570\u636e\u4e4b\u7236\u4e8e 1993 \u5e74\u63d0\u51fa\u7684\u6982\u5ff5\u3002\u987e\u540d\u601d\u4e49\uff0c\u5b83\u6307\u7684\u662f\u901a\u8fc7\u591a\u79cd\u4e0d\u540c\u7684\u7ef4\u5ea6\u5ba1\u89c6\u6570\u636e\uff0c\u8fdb\u884c\u6df1\u5c42\u6b21\u5206\u6790\u3002</p> <p>\u7ef4\u5ea6\u53ef\u4ee5\u770b\u6210\u662f\u89c2\u5bdf\u6570\u636e\u7684\u4e00\u79cd\u89c6\u89d2\uff0c\u4f8b\u5982\u4eba\u7c7b\u80fd\u770b\u5230\u7684\u4e16\u754c\u662f\u4e09\u7ef4\u7684\uff0c\u5b83\u5305\u542b\u957f\u3001\u5bbd\u3001\u9ad8\u4e09\u4e2a\u7ef4\u5ea6\u3002\u76f4\u63a5\u4e00\u70b9\u7406\u89e3\uff0c\u7ef4\u5ea6\u5c31\u597d\u6bd4\u662f\u4e00\u5f20\u6570\u636e\u8868\u7684\u5b57\u6bb5\uff0c\u800c\u591a\u7ef4\u5206\u6790\u5219\u662f\u57fa\u4e8e\u8fd9\u4e9b\u5b57\u6bb5\u8fdb\u884c\u805a\u5408\u67e5\u8be2\u3002</p> <p>\u6570\u636e\u4ed3\u5e93\u7684\u6570\u636e\u6a21\u578b\u901a\u5e38\u662f\u5173\u7cfb\u578b\u7684\uff0c\u56e0\u4e3a SQL \u901a\u5e38\u5f88\u9002\u5408\u5206\u6790\u67e5\u8be2\u3002\u6709\u8bb8\u591a\u56fe\u5f62\u6570\u636e\u5206\u6790\u5de5\u5177\u53ef\u4ee5\u751f\u6210 SQL \u67e5\u8be2\uff0c\u53ef\u89c6\u5316\u7ed3\u679c\uff0c\u5e76\u5141\u8bb8\u5206\u6790\u4eba\u5458\u63a2\u7d22\u6570\u636e\uff08\u901a\u8fc7\u4e0b\u94bb\u3001\u5207\u7247\u548c\u5207\u5757\u7b49\u64cd\u4f5c\uff09\u3002</p> <p>\u8868\u9762\u4e0a\uff0c\u4e00\u4e2a\u6570\u636e\u4ed3\u5e93\u548c\u4e00\u4e2a\u5173\u7cfb\u578b OLTP \u6570\u636e\u5e93\u770b\u8d77\u6765\u5f88\u76f8\u4f3c\uff0c\u56e0\u4e3a\u5b83\u4eec\u90fd\u6709\u4e00\u4e2a SQL \u67e5\u8be2\u63a5\u53e3\u3002\u7136\u800c\uff0c\u7cfb\u7edf\u7684\u5185\u90e8\u770b\u8d77\u6765\u53ef\u80fd\u5b8c\u5168\u4e0d\u540c\uff0c\u56e0\u4e3a\u5b83\u4eec\u9488\u5bf9\u975e\u5e38\u4e0d\u540c\u7684\u67e5\u8be2\u6a21\u5f0f\u8fdb\u884c\u4e86\u4f18\u5316\u3002\u73b0\u5728\u8bb8\u591a\u6570\u636e\u5e93\u4f9b\u5e94\u5546\u90fd\u53ea\u662f\u91cd\u70b9\u652f\u6301\u4e8b\u52a1\u5904\u7406\u8d1f\u8f7d\u548c\u5206\u6790\u5de5\u4f5c\u8d1f\u8f7d\u8fd9\u4e24\u8005\u4e2d\u7684\u4e00\u4e2a\uff0c\u800c\u4e0d\u662f\u90fd\u652f\u6301\u3002</p> <p>\u6570\u636e\u4ed3\u5e93\u672c\u8d28\u662f\u4ece\u6570\u636e\u5e93\u884d\u751f\u51fa\u6765\u7684\uff0c\u6240\u4ee5\u6570\u636e\u4ed3\u5e93\u7684\u5efa\u6a21\u4e5f\u662f\u4e0d\u65ad\u884d\u751f\u53d1\u5c55\u7684\u3002</p> <p>\u4ece\u6700\u65e9\u7684\u501f\u9274\u6570\u636e\u5e93\u7684\u8303\u5f0f\u5efa\u6a21\uff0c\u5230\u9010\u6e10\u63d0\u51fa\u7ef4\u5ea6\u5efa\u6a21\uff0cData Vault \u6a21\u578b\uff0cAnchor \u6a21\u578b\u7b49\u7b49\uff0c\u8d8a\u5f80\u540e\u5efa\u6a21\u7684\u8981\u6c42\u8d8a\u9ad8\uff0c\u8d8a\u9700\u6ee1\u8db3 3NF\uff0c4NF \u7b49\u3002</p> <p>\u4f46\u662f\u5bf9\u4e8e\u6570\u636e\u4ed3\u5e93\u6765\u8bf4\uff0c\u76ee\u524d\u4e3b\u6d41\u8fd8\u662f\u7ef4\u5ea6\u5efa\u6a21\uff0c\u4f1a\u5939\u6742\u7740\u8303\u5f0f\u5efa\u6a21\u3002</p>"},{"location":"olap/01.OLAP%E6%A6%82%E8%BF%B0/#_2","title":"\u6570\u636e\u5e93\u4e1a\u52a1\u7c7b\u578b","text":""},{"location":"olap/01.OLAP%E6%A6%82%E8%BF%B0/#oltp","title":"OLTP","text":"<p>OLTP \u6216\u8054\u673a\u4e8b\u52a1\u5904\u7406\u662f\u4e00\u79cd\u6570\u636e\u5904\u7406\u7c7b\u578b\uff0c\u5305\u62ec\u6267\u884c\u591a\u4e2a\u5e76\u53d1\u7684\u4e8b\u52a1\uff0c\u4f8b\u5982\u7f51\u4e0a\u94f6\u884c\u3001\u8d2d\u7269\u3001\u8ba2\u5355\u8f93\u5165\u6216\u53d1\u9001\u6587\u672c\u6d88\u606f\u3002\u8fd9\u4e9b\u4e8b\u52a1\u4f20\u7edf\u4e0a\u88ab\u79f0\u4e3a\u7ecf\u6d4e\u6216\u8d22\u52a1\u4e8b\u52a1\uff0c\u4f1a\u88ab\u8bb0\u5f55\u5e76\u52a0\u4ee5\u4fdd\u62a4\uff0c\u5e2e\u52a9\u4f01\u4e1a\u968f\u65f6\u8bbf\u95ee\u8fd9\u4e9b\u4fe1\u606f\uff0c\u4ee5\u7528\u4e8e\u4f1a\u8ba1\u6216\u62a5\u544a\u76ee\u7684\u3002</p> <p>\u4f20\u7edf\u5173\u7cfb\u6570\u636e\u5e93\uff1a\u4f20\u7edf\u7684\u5173\u7cfb\u578b\u6570\u636e\u5e93\u7684\u4e3b\u8981\u5e94\u7528\u662f\u57fa\u672c\u7684\u3001\u65e5\u5e38\u7684\u4e8b\u52a1\u5904\u7406\uff08OLTP\uff09\uff0c\u4f8b\u5982\u7535\u5546\u7b49\u3002</p> <p>OLTP \u7cfb\u7edf\u901a\u5e38\u9762\u5411\u6700\u7ec8\u6d77\u91cf\u7528\u6237\uff0c\u8fd9\u610f\u5473\u7740\u7cfb\u7edf\u53ef\u80fd\u4f1a\u6536\u5230\u6d77\u91cf\u8bf7\u6c42\u3002\u4e3a\u4e86\u5904\u7406\u8d1f\u8f7d\uff0c\u5e94\u7528\u7a0b\u5e8f\u5728\u6bcf\u4e2a\u67e5\u8be2\u4e2d\u901a\u5e38\u53ea\u8bbf\u95ee\u5c11\u91cf\u7684\u8bb0\u5f55\u3002</p> <p>\u5e94\u7528\u7a0b\u5e8f\u4f7f\u7528\u67d0\u79cd\u952e\u6765\u8bf7\u6c42\u8bb0\u5f55\uff0c\u5b58\u50a8\u5f15\u64ce\u4f7f\u7528\u7d22\u5f15\u6765\u67e5\u627e\u6240\u8bf7\u6c42\u7684\u952e\u7684\u6570\u636e\u3002\u786c\u76d8\u67e5\u627e\u65f6\u95f4\u5f80\u5f80\u662f\u8fd9\u91cc\u7684\u74f6\u9888\u3002</p> <p>\u6570\u636e\u5e93(Database)\u7684\u4e1a\u52a1\u7279\u70b9\u662f\uff1a</p> <ul> <li>\u76f8\u5bf9\u590d\u6742\u7684\u8868\u683c\u7ed3\u6784\uff0c\u5b58\u50a8\u7ed3\u6784\u76f8\u5bf9\u7d27\u81f4\uff0c\u5c11\u5197\u4f59\u6570\u636e\u3002</li> <li>\u8bfb\u548c\u5199\u90fd\u6709\u4f18\u5316\u3002</li> <li>\u76f8\u5bf9\u7b80\u5355\u7684 read/write query\uff0c\u5355\u6b21\u4f5c\u7528\u4e8e\u76f8\u5bf9\u7684\u5c11\u91cf\u6570\u636e\u3002</li> </ul> <p>https://www.cnblogs.com/liujiaqi1101/p/17590632.html</p>"},{"location":"olap/01.OLAP%E6%A6%82%E8%BF%B0/#olap","title":"OLAP","text":"<p>OLAP\uff0c\u82f1\u6587\u5168\u79f0\u4e3a On-Line Analysis Processing\uff0c\u4e2d\u6587\u540d\u79f0\u4e3a\u8054\u673a\u5206\u6790\u5904\u7406\uff0c\u4e5f\u79f0\u4e3a\u5728\u7ebf\u5206\u6790\u5904\u7406\u3002</p> <p>\u6570\u636e\u4ed3\u5e93\uff1a\u6570\u636e\u4ed3\u5e93\u7cfb\u7edf\u7684\u4e3b\u8981\u5e94\u7528\u4e3b\u8981\u662f OLAP\uff08On-Line Analytical Processing\uff09\uff0c\u652f\u6301\u590d\u6742\u7684\u5206\u6790\u64cd\u4f5c\uff0c\u4fa7\u91cd\u51b3\u7b56\u652f\u6301\uff0c\u5e76\u4e14\u63d0\u4f9b\u76f4\u89c2\u6613\u61c2\u7684\u67e5\u8be2\u7ed3\u679c\u3002</p> <ul> <li>\u76f8\u5bf9\u7b80\u5355\u7684(Denormalized)\u8868\u683c\u7ed3\u6784\uff0c\u5b58\u50a8\u7ed3\u6784\u76f8\u5bf9\u677e\u6563\uff0c\u591a\u5197\u4f59\u6570\u636e\u3002</li> <li>\u4e00\u822c\u53ea\u662f\u8bfb\u4f18\u5316\u3002</li> <li>\u76f8\u5bf9\u590d\u6742\u7684 read query\uff0c\u5355\u6b21\u4f5c\u7528\u4e8e\u76f8\u5bf9\u5927\u91cf\u7684\u6570\u636e\uff08\u5386\u53f2\u6570\u636e\uff09\u3002</li> </ul> <p>\u6570\u636e\u4ed3\u5e93\u548c\u7c7b\u4f3c\u7684\u5206\u6790\u51b3\u7b56\u7cfb\u7edf\u4f1a\u5c11\u89c1\u4e00\u4e9b\uff0c\u56e0\u4e3a\u5b83\u4eec\u4e3b\u8981\u7531\u4f01\u4e1a\u6570\u636e\u5206\u6790\u4eba\u5458\u5bf9\u6570\u636e\u5206\u6790\u6210\u7ed3\u679c\uff0c\u4f9b\u4f01\u4e1a\u51b3\u7b56\u8005\u4f7f\u7528\uff0c\u800c\u4e0d\u662f\u6700\u7ec8\u7528\u6237\u3002</p> <p>\u5b83\u4eec\u7684\u5e76\u53d1\u91cf\u8981\u6bd4 OLTP \u7cfb\u7edf\u5c11\u5f97\u591a\uff0c\u4f46\u901a\u5e38\u6bcf\u4e2a\u67e5\u8be2\u5f00\u9500\u9ad8\u6602\uff0c\u9700\u8981\u5728\u77ed\u65f6\u95f4\u5185\u626b\u63cf\u6570\u767e\u4e07\u6761\u8bb0\u5f55\u3002\u786c\u76d8\u5e26\u5bbd\uff08\u800c\u4e0d\u662f\u67e5\u627e\u65f6\u95f4\uff09\u5f80\u5f80\u662f\u74f6\u9888\uff0c\u5217\u5f0f\u5b58\u50a8\u662f\u9488\u5bf9\u8fd9\u79cd\u5de5\u4f5c\u8d1f\u8f7d\u7684\u65e5\u76ca\u6d41\u884c\u7684\u89e3\u51b3\u65b9\u6848\u3002</p> \u6bd4\u8f83\u9879 \u64cd\u4f5c\u578b\uff08OLTP\uff09 \u5206\u6790\u6027\uff08OLAP\uff09 \u5173\u6ce8 \u7ec6\u8282 \u7efc\u5408\u6216\u63d0\u70bc \u6a21\u578b \u5b9e\u4f53 \u2013 \u5173\u7cfb\uff08E-R\uff09 \u661f\u578b\u6216\u96ea\u82b1 \u64cd\u4f5c \u53ef\u66f4\u65b0 \u53ea\u8bfb\uff0c\u53ea\u8ffd\u52a0 \u64cd\u4f5c\u7c92\u5ea6 \u64cd\u4f5c\u4e00\u4e2a\u5355\u5143 \u64cd\u4f5c\u4e00\u4e2a\u96c6\u5408 \u573a\u666f \u9762\u5411\u4e8b\u52a1 \u9762\u5411\u5206\u6790 \u6570\u636e\u91cf \u5c0f \u5927 \u9700\u6c42 \u65e5\u5e38\u64cd\u4f5c \u51b3\u7b56\u9700\u6c42 \u4e1a\u52a1\u65b9\u5411 \u5ba2\u6237\u4fe1\u606f\u3001\u8ba2\u5355\u7b49\u67e5\u8be2 \u5ba2\u6237\u767b\u5f55\u95f4\u9694\u65f6\u95f4\uff0c\u5e02\u573a\u7ec6\u5206\u7b49"},{"location":"olap/01.OLAP%E6%A6%82%E8%BF%B0/#_3","title":"\u6570\u4ed3","text":"<p>\u53c2\u8003</p> <p>\u6570\u636e\u4ed3\u5e93\uff0c\u82f1\u6587\u540d\u79f0\u4e3a<code>Data Warehouse</code>\uff0c\u53ef\u7b80\u5199\u4e3a DW \u6216 DWH\u3002\u6570\u636e\u4ed3\u5e93\uff0c\u662f\u4e3a\u4f01\u4e1a\u6240\u6709\u7ea7\u522b\u7684\u51b3\u7b56\u5236\u5b9a\u8fc7\u7a0b\uff0c\u63d0\u4f9b\u6240\u6709\u7c7b\u578b\u6570\u636e\u652f\u6301\u7684\u6218\u7565\u96c6\u5408\u3002</p> <p>\u5b83\u51fa\u4e8e**\u5206\u6790\u6027\u62a5\u544a**\u548c**\u51b3\u7b56\u652f\u6301\u76ee\u7684**\u800c\u521b\u5efa\u3002\u4e3a\u9700\u8981\u4e1a\u52a1\u667a\u80fd\u7684\u4f01\u4e1a\uff0c\u63d0\u4f9b\u6307\u5bfc\u4e1a\u52a1\u6d41\u7a0b\u6539\u8fdb\u3001\u76d1\u89c6\u65f6\u95f4\u3001\u6210\u672c\u3001\u8d28\u91cf\u4ee5\u53ca\u63a7\u5236\u3002</p> <p>\u6570\u636e\u4ed3\u5e93\u4e4b\u7236\u6bd4\u5c14\u6069\u95e8\u5bf9\u6570\u4ed3\u7684\u5b9a\u4e49\u5982\u4e0b:</p> <p>\u6570\u636e\u4ed3\u5e93\uff08data warehouse\uff09\u662f\u4e00\u4e2a\u9762\u5411\u4e3b\u9898\u7684\uff08subject oriented\uff09\u3001\u96c6\u6210\u7684\uff08integrate\uff09\u3001\u76f8\u5bf9\u7a33\u5b9a\u7684\uff08non-volatile\uff09\u3001\u53cd\u6620\u5386\u53f2\u53d8\u5316\uff08time variant\uff09\u7684\u6570\u636e\u96c6\u5408\uff0c\u7528\u4e8e\u652f\u6301\u7ba1\u7406\u51b3\u7b56\u3002</p> <p>\u5bf9\u4e8e\u6570\u636e\u4ed3\u5e93\u7684\u6982\u5ff5\u6211\u4eec\u53ef\u4ee5\u4ece\u4e24\u4e2a\u5c42\u6b21\u4e88\u4ee5\u7406\u89e3\uff1a</p> <ul> <li>\u9996\u5148\uff0c\u6570\u636e\u4ed3\u5e93\u7528\u4e8e**\u652f\u6301\u51b3\u7b56**\uff0c\u9762\u5411\u5206\u6790\u578b\u6570\u636e\u5904\u7406\uff0c\u5b83\u4e0d\u540c\u4e8e\u4f01\u4e1a\u73b0\u6709\u7684\u64cd\u4f5c\u578b\u6570\u636e\u5e93\uff1b</li> <li>\u5176\u6b21\uff0c\u6570\u636e\u4ed3\u5e93\u662f\u5bf9\u591a\u4e2a\u5f02\u6784\u7684\u6570\u636e\u6e90\u6709\u6548\u96c6\u6210\uff0c\u96c6\u6210\u540e\u6309\u7167\u4e3b\u9898\u8fdb\u884c\u4e86\u91cd\u7ec4\uff0c\u5e76\u5305\u542b\u5386\u53f2\u6570\u636e\uff0c\u800c\u4e14\u5b58\u653e\u5728\u6570\u636e\u4ed3\u5e93\u4e2d\u7684\u6570\u636e\u4e00\u822c\u4e0d\u518d\u4fee\u6539\u3002</li> </ul> <p>\u6570\u636e\u4ed3\u5e93\u7684\u7279\u70b9</p> <p>\u6839\u636e\u6570\u636e\u4ed3\u5e93\u6982\u5ff5\u7684\u542b\u4e49\uff0c\u6570\u636e\u4ed3\u5e93\u62e5\u6709\u4ee5\u4e0b\u56db\u4e2a\u7279\u70b9\uff1a</p> <p>1\u3001\u9762\u5411\u4e3b\u9898 \u64cd\u4f5c\u578b\u6570\u636e\u5e93\u7684\u6570\u636e\u7ec4\u7ec7**\u9762\u5411\u5e94\u7528**\u4e8b\u52a1\u5904\u7406\u4efb\u52a1\uff0c\u5404\u4e2a\u4e1a\u52a1\u7cfb\u7edf\u4e4b\u95f4\u5404\u81ea\u5206\u79bb\uff0c\u800c\u6570\u636e\u4ed3\u5e93\u4e2d\u7684\u6570\u636e\u662f\u6309\u7167\u4e00\u5b9a\u7684\u4e3b\u9898\u57df\u8fdb\u884c\u7ec4\u7ec7\u3002 \u4e3b\u9898\u662f\u4e00\u4e2a\u62bd\u8c61\u7684\u6982\u5ff5\uff0c\u662f\u8f83\u9ad8\u5c42\u6b21\u4e0a\u4f01\u4e1a\u4fe1\u606f\u7cfb\u7edf\u4e2d\u7684\u6570\u636e\u7efc\u5408\u3001\u5f52\u7c7b\u5e76\u8fdb\u884c\u5206\u6790\u5229\u7528\u7684\u62bd\u8c61\u3002\u662f\u6307\u7528\u6237\u4f7f\u7528\u6570\u636e\u4ed3\u5e93\u8fdb\u884c\u51b3\u7b56\u65f6\u6240\u5173\u5fc3\u7684\u91cd\u70b9\u65b9\u9762\uff0c\u4e00\u4e2a\u4e3b\u9898\u901a\u5e38\u4e0e\u591a\u4e2a\u64cd\u4f5c\u578b\u4e1a\u52a1\u4fe1\u606f\u7cfb\u7edf\u76f8\u5173\u3002\u5728\u903b\u8f91\u610f\u4e49\u4e0a\uff0c\u5b83\u662f\u5bf9\u5e94\u4f01\u4e1a\u4e2d\u67d0\u4e00\u5b8f\u89c2\u5206\u6790\u9886\u57df\u6240\u6d89\u53ca\u7684\u5206\u6790\u5bf9\u8c61\u3002</p> <p>2\u3001\u96c6\u6210\u7684 \u9762\u5411\u4e8b\u52a1\u5904\u7406\u7684\u64cd\u4f5c\u578b\u6570\u636e\u5e93\u901a\u5e38\u4e0e\u67d0\u4e9b\u7279\u5b9a\u7684\u5e94\u7528\u76f8\u5173\uff0c\u6570\u636e\u5e93\u4e4b\u95f4\u76f8\u4e92\u72ec\u7acb\uff0c\u5e76\u4e14\u5f80\u5f80\u662f\u5f02\u6784\u7684\u3002 \u800c\u6570\u636e\u4ed3\u5e93\u4e2d\u7684\u6570\u636e\u662f\u5728\u5bf9\u539f\u6709\u5206\u6563\u7684\u6570\u636e\u5e93\u6570\u636e\u62bd\u53d6\u3001\u6e05\u7406\u7684\u57fa\u7840\u4e0a\u7ecf\u8fc7\u7cfb\u7edf\u52a0\u5de5\u3001\u6c47\u603b\u548c\u6574\u7406\u5f97\u5230\u7684\uff0c\u5fc5\u987b\u6d88\u9664\u6e90\u6570\u636e\u4e2d\u7684\u4e0d\u4e00\u81f4\u6027\uff0c\u4ee5\u4fdd\u8bc1\u6570\u636e\u4ed3\u5e93\u5185\u7684\u4fe1\u606f\u662f\u5173\u4e8e\u6574\u4e2a\u4f01\u4e1a\u7684\u4e00\u81f4\u7684\u5168\u5c40\u4fe1\u606f\u3002</p> <p>\u901a\u8fc7\u5bf9\u5206\u6563\u3001\u72ec\u7acb\u3001\u5f02\u6784\u7684\u6570\u636e\u5e93\u6570\u636e\u8fdb\u884c\u62bd\u53d6\u3001\u6e05\u7406\u3001\u8f6c\u6362\u548c\u6c47\u603b\u4fbf\u5f97\u5230\u4e86\u6570\u636e\u4ed3\u5e93\u7684\u6570\u636e\uff0c\u8fd9\u6837\u4fdd\u8bc1\u4e86\u6570\u636e\u4ed3\u5e93\u5185\u7684\u6570\u636e\u5173\u4e8e\u6574\u4e2a\u4f01\u4e1a\u7684\u4e00\u81f4\u6027\u3002</p> <p>\u6570\u636e\u4ed3\u5e93\u4e2d\u7684\u7efc\u5408\u6570\u636e\u4e0d\u80fd\u4ece\u539f\u6709\u7684\u6570\u636e\u5e93\u7cfb\u7edf\u76f4\u63a5\u5f97\u5230\u3002\u56e0\u6b64\u5728\u6570\u636e\u8fdb\u5165\u6570\u636e\u4ed3\u5e93\u4e4b\u524d\uff0c\u5fc5\u7136\u8981\u7ecf\u8fc7\u7edf\u4e00\u4e0e\u7efc\u5408\uff0c\u8fd9\u4e00\u6b65\u662f\u6570\u636e\u4ed3\u5e93\u5efa\u8bbe\u4e2d\u6700\u5173\u952e\u3001\u6700\u590d\u6742\u7684\u4e00\u6b65\uff0c\u6240\u8981\u5b8c\u6210\u7684\u5de5\u4f5c\u6709\uff1a</p> <ul> <li>\u8981\u7edf\u4e00\u6e90\u6570\u636e\u4e2d\u6240\u6709\u77db\u76fe\u4e4b\u5904\uff0c\u5982\u5b57\u6bb5\u7684\u540c\u540d\u5f02\u4e49\u3001\u5f02\u540d\u540c\u4e49\u3001\u5355\u4f4d\u4e0d\u7edf\u4e00\u3001\u5b57\u957f\u4e0d\u4e00\u81f4\uff0c\u7b49\u7b49\u3002</li> <li>\u8fdb\u884c\u6570\u636e\u7efc\u5408\u548c\u8ba1\u7b97\u3002\u6570\u636e\u4ed3\u5e93\u4e2d\u7684\u6570\u636e\u7efc\u5408\u5de5\u4f5c\u53ef\u4ee5\u5728\u4ece\u539f\u6709\u6570\u636e\u5e93\u62bd\u53d6\u6570\u636e\u65f6\u751f\u6210\uff0c\u4f46\u8bb8\u591a\u662f\u5728\u6570\u636e\u4ed3\u5e93\u5185\u90e8\u751f\u6210\u7684\uff0c\u5373\u8fdb\u5165\u6570\u636e\u4ed3\u5e93\u4ee5\u540e\u8fdb\u884c\u7efc\u5408\u751f\u6210\u7684\u3002</li> </ul> <p>3\u3001\u76f8\u5bf9\u7a33\u5b9a\u7684 \u64cd\u4f5c\u578b\u6570\u636e\u5e93\u4e2d\u7684\u6570\u636e\u901a\u5e38\u5b9e\u65f6\u66f4\u65b0\uff0c\u6570\u636e\u6839\u636e\u9700\u8981\u53ca\u65f6\u53d1\u751f\u53d8\u5316\u3002 \u6570\u636e\u4ed3\u5e93\u7684\u6570\u636e\u4e3b\u8981\u4f9b\u4f01\u4e1a\u51b3\u7b56\u5206\u6790\u4e4b\u7528\uff0c\u6240\u6d89\u53ca\u7684\u6570\u636e\u64cd\u4f5c\u4e3b\u8981\u662f\u6570\u636e\u67e5\u8be2\uff0c\u4e00\u65e6\u67d0\u4e2a\u6570\u636e\u8fdb\u5165\u6570\u636e\u4ed3\u5e93\u4ee5\u540e\uff0c\u4e00\u822c\u60c5\u51b5\u4e0b\u5c06\u88ab\u957f\u671f\u4fdd\u7559\u3002 \u4e5f\u5c31\u662f\u6570\u636e\u4ed3\u5e93\u4e2d\u4e00\u822c\u6709\u5927\u91cf\u7684\u67e5\u8be2\u64cd\u4f5c\uff0c\u4f46\u4fee\u6539\u548c\u5220\u9664\u64cd\u4f5c\u5f88\u5c11\uff0c\u901a\u5e38\u53ea\u9700\u8981\u5b9a\u671f\u7684\u52a0\u8f7d\u3001\u5237\u65b0\u3002</p> <p>4\u3001\u53cd\u6620\u5386\u53f2\u53d8\u5316 \u64cd\u4f5c\u578b\u6570\u636e\u5e93\u4e3b\u8981\u5173\u5fc3\u5f53\u524d\u67d0\u4e00\u4e2a\u65f6\u95f4\u6bb5\u5185\u7684\u6570\u636e\uff0c\u800c\u6570\u636e\u4ed3\u5e93\u4e2d\u7684\u6570\u636e\u901a\u5e38\u5305\u542b\u5386\u53f2\u4fe1\u606f\uff0c\u7cfb\u7edf\u8bb0\u5f55\u4e86\u4f01\u4e1a\u4ece\u8fc7\u53bb\u67d0\u4e00\u65f6\u70b9(\u5982\u5f00\u59cb\u5e94\u7528\u6570\u636e\u4ed3\u5e93\u7684\u65f6\u70b9)\u5230\u76ee\u524d\u7684\u5404\u4e2a\u9636\u6bb5\u7684\u4fe1\u606f\u3002 \u901a\u8fc7\u8fd9\u4e9b\u4fe1\u606f\uff0c\u53ef\u4ee5\u5bf9\u4f01\u4e1a\u7684\u53d1\u5c55\u5386\u7a0b\u548c\u672a\u6765\u8d8b\u52bf\u505a\u51fa\u5b9a\u91cf\u5206\u6790\u548c\u9884\u6d4b\u3002</p> <p>\u4f01\u4e1a\u6570\u636e\u4ed3\u5e93\u7684\u5efa\u8bbe\uff0c\u662f\u4ee5\u73b0\u6709\u4f01\u4e1a\u4e1a\u52a1\u7cfb\u7edf\u548c\u5927\u91cf\u4e1a\u52a1\u6570\u636e\u7684\u79ef\u7d2f\u4e3a\u57fa\u7840\u3002</p> <p>\u6570\u636e\u4ed3\u5e93\u4e0d\u662f\u9759\u6001\u7684\u6982\u5ff5\uff0c\u53ea\u6709\u628a\u4fe1\u606f\u53ca\u65f6\u4ea4\u7ed9\u9700\u8981\u8fd9\u4e9b\u4fe1\u606f\u7684\u4f7f\u7528\u8005\uff0c\u4f9b\u4ed6\u4eec\u505a\u51fa\u6539\u5584\u5176\u4e1a\u52a1\u7ecf\u8425\u7684\u51b3\u7b56\uff0c\u4fe1\u606f\u624d\u80fd\u53d1\u6325\u4f5c\u7528\uff0c\u4fe1\u606f\u624d\u6709\u610f\u4e49\u3002\u800c\u628a\u4fe1\u606f\u52a0\u4ee5\u6574\u7406\u5f52\u7eb3\u548c\u91cd\u7ec4\uff0c\u5e76\u53ca\u65f6\u63d0\u4f9b\u7ed9\u76f8\u5e94\u7684\u7ba1\u7406\u51b3\u7b56\u4eba\u5458\uff0c\u662f\u6570\u636e\u4ed3\u5e93\u7684\u6839\u672c\u4efb\u52a1\u3002</p> <p>\u56e0\u6b64\uff0c\u4ece\u4ea7\u4e1a\u754c\u7684\u89d2\u5ea6\u770b\uff0c\u6570\u636e\u4ed3\u5e93\u5efa\u8bbe\u662f\u4e00\u4e2a\u5de5\u7a0b\uff0c\u662f\u4e00\u4e2a\u8fc7\u7a0b\u3002\u6570\u636e\u5e93\u662f\u4f9d\u7167\u67d0\u79cd\u6570\u636e\u6a21\u578b\u7ec4\u7ec7\u8d77\u6765\u5e76\u5b58\u653e\u4e8c\u7ea7\u5b58\u50a8\u5668\u4e2d\u7684\u6570\u636e\u96c6\u5408\u3002</p> <p>\u8fd9\u79cd\u6570\u636e\u96c6\u5408\u5177\u6709\u5982\u4e0b\u7279\u70b9\uff1a\u5c3d\u53ef\u80fd\u4e0d\u91cd\u590d\uff0c\u4ee5\u6700\u4f18\u65b9\u5f0f\u4e3a\u67d0\u4e2a\u7279\u5b9a\u7ec4\u7ec7\u7684\u591a\u79cd\u5e94\u7528\u670d\u52a1\uff0c\u5176\u6570\u636e\u7ed3\u6784\u72ec\u7acb\u4e8e\u4f7f\u7528\u5b83\u7684\u5e94\u7528\u7a0b\u5e8f\uff0c\u5bf9\u6570\u636e\u7684\u589e\u3001\u5220\u3001\u6539\u548c\u68c0\u7d22\u7531\u7edf\u4e00\u8f6f\u4ef6\u8fdb\u884c\u7ba1\u7406\u548c\u63a7\u5236\u3002</p> <p>\u4ece\u53d1\u5c55\u7684\u5386\u53f2\u770b\uff0c\u6570\u636e\u5e93\u662f\u6570\u636e\u7ba1\u7406\u7684\u9ad8\u7ea7\u9636\u6bb5\uff0c\u5b83\u662f\u7531\u6587\u4ef6\u7ba1\u7406\u7cfb\u7edf\u53d1\u5c55\u8d77\u6765\u7684\u3002</p> <p>\u6570\u636e\u5e93 Database (Oracle\uff0cMySQL\uff0cPostgreSQL)\u4e3b\u8981\u7528\u4e8e\u4e8b\u52a1\u5904\u7406\uff0c\u6570\u636e\u4ed3\u5e93 Datawarehouse (Amazon Redshift\uff0cHive)\u4e3b\u8981\u7528\u4e8e\u6570\u636e\u5206\u6790\u3002</p> <p>\u57fa\u672c\u6bcf\u5bb6\u7535\u5546\u516c\u53f8\u90fd\u4f1a\u7ecf\u5386\uff0c\u4ece\u53ea\u9700\u8981\u4e1a\u52a1\u6570\u636e\u5e93\u5230\u8981\u6570\u636e\u4ed3\u5e93\u7684\u9636\u6bb5\u3002</p> <p>\u7b2c\u4e00\u9636\u6bb5\uff0c\u7535\u5546\u65e9\u671f\u542f\u52a8\u975e\u5e38\u5bb9\u6613\uff0c\u5165\u884c\u95e8\u69db\u4f4e\u3002\u627e\u4e2a\u5916\u5305\u56e2\u961f\uff0c\u505a\u4e86\u4e00\u4e2a\u53ef\u4ee5\u4e0b\u5355\u7684\u7f51\u9875\u524d\u7aef + \u51e0\u53f0\u670d\u52a1\u5668 + \u4e00\u4e2a MySQL\uff0c\u5c31\u80fd\u5f00\u95e8\u8fce\u5ba2\u4e86\u3002\u8fd9\u597d\u6bd4\u624b\u5de5\u4f5c\u574a\u65f6\u671f\u3002</p> <p>\u7b2c\u4e8c\u9636\u6bb5\uff0c\u6d41\u91cf\u6765\u4e86\uff0c\u5ba2\u6237\u548c\u8ba2\u5355\u90fd\u591a\u8d77\u6765\u4e86\uff0c\u666e\u901a\u67e5\u8be2\u5df2\u7ecf\u6709\u538b\u529b\u4e86\uff0c\u8fd9\u4e2a\u65f6\u5019\u5c31\u9700\u8981\u5347\u7ea7\u67b6\u6784\u53d8\u6210\u591a\u53f0\u670d\u52a1\u5668\u548c\u591a\u4e2a\u4e1a\u52a1\u6570\u636e\u5e93\uff08\u91cf\u5927+\u5206\u5e93\u5206\u8868\uff09\u3002 \u8fd9\u4e2a\u9636\u6bb5\u7684\u4e1a\u52a1\u6570\u5b57\u548c\u6307\u6807\u8fd8\u53ef\u4ee5\u52c9\u5f3a\u4ece\u4e1a\u52a1\u6570\u636e\u5e93\u91cc\u67e5\u8be2\u3002\u521d\u6b65\u8fdb\u5165\u5de5\u4e1a\u5316\u3002</p> <p>\u7b2c\u4e09\u4e2a\u9636\u6bb5\uff0c\u4e00\u822c\u9700\u8981 3-5 \u5e74\u5de6\u53f3\u7684\u65f6\u95f4\uff0c\u968f\u7740\u4e1a\u52a1\u6307\u6570\u7ea7\u7684\u589e\u957f\uff0c\u6570\u636e\u91cf\u7684\u4f1a\u9661\u589e\uff0c\u516c\u53f8\u89d2\u8272\u4e5f\u5f00\u59cb\u591a\u4e86\u8d77\u6765\uff0c\u5f00\u59cb\u6709\u4e86 CEO\u3001CMO\u3001CIO\u3002\u5927\u5bb6\u9700\u8981\u9762\u4e34\u7684\u95ee\u9898\u8d8a\u6765\u8d8a\u590d\u6742\uff0c\u8d8a\u6765\u8d8a\u6df1\u5165\u3002\u9ad8\u7ba1\u4eec\u5173\u5fc3\u7684\u95ee\u9898\uff0c\u4ece\u6700\u521d\u975e\u5e38\u7c97\u653e\u7684\uff1a\"\u6628\u5929\u7684\u6536\u5165\u662f\u591a\u5c11\"\u3001\"\u4e0a\u4e2a\u6708\u7684 PV\u3001UV \u662f\u591a\u5c11\"\u3002 \u9010\u6e10\u6f14\u5316\u5230\u975e\u5e38\u7cbe\u7ec6\u5316\u548c\u5177\u4f53\u7684\u7528\u6237\u7684\u96c6\u7fa4\u5206\u6790\uff0c\u7279\u5b9a\u7528\u6237\u5728\u67d0\u79cd\u4f7f\u7528\u573a\u666f\u4e2d\u3002 \u4f8b\u5982\"20~30 \u5c81\u5973\u6027\u7528\u6237\u5728\u8fc7\u53bb\u4e94\u5e74\u7684\u7b2c\u4e00\u5b63\u5ea6\u5316\u5986\u54c1\u7c7b\u5546\u54c1\u7684\u8d2d\u4e70\u884c\u4e3a\u4e0e\u516c\u53f8\u8fdb\u884c\u7684\u4fc3\u9500\u6d3b\u52a8\u65b9\u6848\u4e4b\u95f4\u7684\u5173\u7cfb\"\u3002</p> <p>\u8fd9\u7c7b\u975e\u5e38\u5177\u4f53\uff0c\u4e14\u80fd\u591f\u5bf9\u516c\u53f8\u51b3\u7b56\u8d77\u5230\u5173\u952e\u6027\u4f5c\u7528\u7684\u95ee\u9898\uff0c\u57fa\u672c\u5f88\u96be\u4ece\u4e1a\u52a1\u6570\u636e\u5e93\u4ece\u8c03\u53d6\u51fa\u6765\u3002\u539f\u56e0\u5728\u4e8e\uff1a</p> <ul> <li>\u4e1a\u52a1\u6570\u636e\u5e93\u4e2d\u7684\u6570\u636e\u7ed3\u6784\u662f\u4e3a\u4e86\u5b8c\u6210\u4ea4\u6613\u800c\u8bbe\u8ba1\u7684\uff0c\u4e0d\u662f\u4e3a\u4e86\u800c\u67e5\u8be2\u548c\u5206\u6790\u7684\u4fbf\u5229\u8bbe\u8ba1\u7684\u3002</li> <li>\u4e1a\u52a1\u6570\u636e\u5e93\u5927\u591a\u662f\u8bfb\u5199\u4f18\u5316\u7684\uff0c\u5373\u53c8\u8981\u8bfb\uff08\u67e5\u770b\u5546\u54c1\u4fe1\u606f\uff09\uff0c\u4e5f\u8981\u5199\uff08\u4ea7\u751f\u8ba2\u5355\uff0c\u5b8c\u6210\u652f\u4ed8\uff09\u3002\u56e0\u6b64\u5bf9\u4e8e\u5927\u91cf\u6570\u636e\u7684\u8bfb\uff08\u67e5\u8be2\u6307\u6807\uff0c\u4e00\u822c\u662f\u590d\u6742\u7684\u53ea\u8bfb\u7c7b\u578b\u67e5\u8be2\uff09\u662f\u652f\u6301\u4e0d\u8db3\u7684\u3002</li> </ul> <p>\u800c\u600e\u4e48\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\uff0c\u6b64\u65f6\u6211\u4eec\u5c31\u9700\u8981\u5efa\u7acb\u4e00\u4e2a\u6570\u636e\u4ed3\u5e93\u4e86\uff0c\u516c\u53f8\u4e5f\u7b97\u5f00\u59cb\u8fdb\u5165\u4fe1\u606f\u5316\u9636\u6bb5\u4e86\u3002\u6570\u636e\u4ed3\u5e93\u7684\u4f5c\u7528\u5728\u4e8e\uff1a</p> <ul> <li>\u6570\u636e\u7ed3\u6784\u4e3a\u4e86\u5206\u6790\u548c\u67e5\u8be2\u7684\u4fbf\u5229\uff1b</li> <li>\u53ea\u8bfb\u4f18\u5316\u7684\u6570\u636e\u5e93\uff0c\u5373\u4e0d\u9700\u8981\u5b83\u5199\u5165\u901f\u5ea6\u591a\u4e48\u5feb\uff0c\u53ea\u8981\u505a\u5927\u91cf\u6570\u636e\u7684\u590d\u6742\u67e5\u8be2\u7684\u901f\u5ea6\u8db3\u591f\u5feb\u5c31\u884c\u4e86\u3002</li> </ul> <p>\u90a3\u4e48\u5728\u8fd9\u91cc\u524d\u4e00\u79cd\u4e1a\u52a1\u6570\u636e\u5e93\uff08\u8bfb\u5199\u90fd\u4f18\u5316\uff09\u7684\u662f\u4e1a\u52a1\u6027\u6570\u636e\u5e93\uff0c\u540e\u4e00\u79cd\u662f\u5206\u6790\u6027\u6570\u636e\u5e93\uff0c\u5373\u6570\u636e\u4ed3\u5e93\u3002</p> <ul> <li>\u6570\u636e\u5e93\u6bd4\u8f83\u6d41\u884c\u7684\u6280\u672f\u6808\u6709\uff1aMySQL\uff0cOracle\uff0c SQLServer \u7b49</li> <li>\u6570\u636e\u4ed3\u5e93\u6bd4\u8f83\u6d41\u884c\u7684\u6280\u672f\u6808\u6709\uff1aAWS Redshift\uff0cGreenplum\uff0cHive \u7b49</li> </ul> <p>\u8fd9\u6837\u628a\u6570\u636e\u4ece\u4e1a\u52a1\u6027\u7684\u6570\u636e\u5e93\u4e2d\u63d0\u53d6\u3001\u52a0\u5de5\u3001\u5bfc\u5165\u5206\u6790\u6027\u7684\u6570\u636e\u5e93\u5c31\u662f\u4f20\u7edf\u7684 ETL \u5de5\u4f5c\u3002</p> <p>\u62bd\u53d6-\u8f6c\u6362-\u52a0\u8f7d\uff08Extract-Transform-Load\uff09\u7cfb\u7edf\u662f\u6570\u636e\u4ed3\u5e93\u7684\u57fa\u7840\u3002</p> <p>\u4e00\u4e2a\u8bbe\u8ba1\u826f\u597d\u7684 ETL \u7cfb\u7edf\u4ece\u6e90\u7cfb\u7edf\u62bd\u53d6\u6570\u636e\uff0c\u6267\u884c\u6570\u636e\u8d28\u91cf\u548c\u4e00\u81f4\u6027\u6807\u51c6\uff0c\u7136\u540e\u89c4\u683c\u5316\u6570\u636e\uff0c\u4ece\u800c\u4f7f\u5206\u6563\u7684\u6e90\u6570\u636e\u53ef\u4ee5\u96c6\u4e2d\u5728\u4e00\u8d77\u4f7f\u7528\uff0c\u6700\u7ec8\u518d\u4ee5\u53ef\u4ee5\u5c55\u73b0\u7684\u683c\u5f0f\u63d0\u4ea4\u6570\u636e\uff0c\u4ee5\u4fbf\u5e94\u7528\u5f00\u53d1\u8005\u53ef\u4ee5\u521b\u5efa\u5e94\u7528\u7cfb\u7edf\uff0c\u4e5f\u4f7f\u6700\u7ec8\u7528\u6237\u53ef\u4ee5\u5236\u5b9a\u51b3\u7b56\u3002</p>"},{"location":"olap/01.OLAP%E6%A6%82%E8%BF%B0/#_4","title":"\u6570\u636e\u4ed3\u5e93\u53d1\u5c55\u5386\u7a0b","text":"<p>\u6570\u636e\u4ed3\u5e93\u7684\u53d1\u5c55\u5927\u81f4\u7ecf\u5386\u4e86\u8fd9\u6837\u7684\u4e09\u4e2a\u8fc7\u7a0b\uff1a</p> <ol> <li> <p>\u7b80\u5355\u62a5\u8868\u9636\u6bb5\uff1a\u8fd9\u4e2a\u9636\u6bb5\uff0c\u7cfb\u7edf\u7684\u4e3b\u8981\u76ee\u6807\u662f\u89e3\u51b3\u4e00\u4e9b\u65e5\u5e38\u7684\u5de5\u4f5c\u4e2d\u4e1a\u52a1\u4eba\u5458\u9700\u8981\u7684\u62a5\u8868\uff0c\u4ee5\u53ca\u751f\u6210\u4e00\u4e9b\u7b80\u5355\u7684\u80fd\u591f\u5e2e\u52a9\u9886\u5bfc\u8fdb\u884c\u51b3\u7b56\u6240\u9700\u8981\u7684\u6c47\u603b\u6570\u636e\u3002\u8fd9\u4e2a\u9636\u6bb5\u7684\u5927\u90e8\u5206\u8868\u73b0\u5f62\u5f0f\u4e3a\u6570\u636e\u5e93\u548c\u524d\u7aef\u62a5\u8868\u5de5\u5177\u3002</p> </li> <li> <p>\u6570\u636e\u96c6\u5e02\u9636\u6bb5\uff1a\u8fd9\u4e2a\u9636\u6bb5\uff0c\u4e3b\u8981\u662f\u6839\u636e\u67d0\u4e2a\u4e1a\u52a1\u90e8\u95e8\u7684\u9700\u8981\uff0c\u8fdb\u884c\u4e00\u5b9a\u7684\u6570\u636e\u7684\u91c7\u96c6\uff0c\u6574\u7406\uff0c\u6309\u7167\u4e1a\u52a1\u4eba\u5458\u7684\u9700\u8981\uff0c\u8fdb\u884c\u591a\u7ef4\u62a5\u8868\u7684\u5c55\u73b0\uff0c\u80fd\u591f\u63d0\u4f9b\u5bf9\u7279\u5b9a\u4e1a\u52a1\u6307\u5bfc\u7684\u6570\u636e\uff0c\u5e76\u4e14\u80fd\u591f\u63d0\u4f9b\u7279\u5b9a\u7684\u9886\u5bfc\u51b3\u7b56\u6570\u636e\u3002</p> </li> <li> <p>\u6570\u636e\u4ed3\u5e93\u9636\u6bb5\uff1a\u8fd9\u4e2a\u9636\u6bb5\uff0c\u4e3b\u8981\u662f\u6309\u7167\u4e00\u5b9a\u7684\u6570\u636e\u6a21\u578b\uff0c\u5bf9\u6574\u4e2a\u4f01\u4e1a\u7684\u6570\u636e\u8fdb\u884c\u91c7\u96c6\uff0c\u6574\u7406\uff0c\u5e76\u4e14\u80fd\u591f\u6309\u7167\u5404\u4e2a\u4e1a\u52a1\u90e8\u95e8\u7684\u9700\u8981\uff0c\u63d0\u4f9b\u8de8\u90e8\u95e8\u7684\uff0c\u5b8c\u5168\u4e00\u81f4\u7684\u4e1a\u52a1\u62a5\u8868\u6570\u636e\uff0c\u80fd\u591f\u901a\u8fc7\u6570\u636e\u4ed3\u5e93\u751f\u6210\u5bf9\u5bf9\u4e1a\u52a1\u5177\u6709\u6307\u5bfc\u6027\u7684\u6570\u636e\uff0c\u540c\u65f6\uff0c\u4e3a\u9886\u5bfc\u51b3\u7b56\u63d0\u4f9b\u5168\u9762\u7684\u6570\u636e\u652f\u6301\u3002</p> </li> </ol> <p>\u901a\u8fc7\u6570\u636e\u4ed3\u5e93\u5efa\u8bbe\u7684\u53d1\u5c55\u9636\u6bb5\uff0c\u6211\u4eec\u80fd\u591f\u770b\u51fa\uff0c\u6570\u636e\u4ed3\u5e93\u7684\u5efa\u8bbe\u548c\u6570\u636e\u96c6\u5e02\u7684\u5efa\u8bbe\u7684\u91cd\u8981\u533a\u522b\u5c31\u5728\u4e8e\u6570\u636e\u6a21\u578b\u7684\u652f\u6301\u3002</p> <p>\u56e0\u6b64\uff0c\u6570\u636e\u6a21\u578b\u7684\u5efa\u8bbe\uff0c\u5bf9\u4e8e\u6211\u4eec\u6570\u636e\u4ed3\u5e93\u7684\u5efa\u8bbe\uff0c\u6709\u7740\u51b3\u5b9a\u6027\u7684\u610f\u4e49\u3002</p>"},{"location":"olap/01.OLAP%E6%A6%82%E8%BF%B0/#_5","title":"\u591a\u7ef4\u5206\u6790","text":"<p>OLAP \u540d\u4e3a\u8054\u673a\u5206\u6790\u5904\u7406\uff0c\u53c8\u53ef\u4ee5\u79f0\u4e4b\u4e3a \u591a\u7ef4\u5206\u6790 \u5904\u7406\uff0c\u662f\u7531\u5173\u7cfb\u578b\u6570\u636e\u4e4b\u7236\u4e8e 1993 \u5e74\u63d0\u51fa\u7684\u6982\u5ff5\u3002\u987e\u540d\u601d\u4e49\uff0c\u5b83\u6307\u7684\u662f\u901a\u8fc7\u591a\u79cd\u4e0d\u540c\u7684\u7ef4\u5ea6\u5ba1\u89c6\u6570\u636e\uff0c\u8fdb\u884c\u6df1\u5c42\u6b21\u5206\u6790\u3002</p>"},{"location":"olap/01.OLAP%E6%A6%82%E8%BF%B0/#_6","title":"\u7ef4\u5ea6\u548c\u6307\u6807","text":"<p>\u4ee5\u5f80\u6211\u4eec\u662f\u4ece\u7528\u6237\u6d41\u7a0b\u3001\u7ec4\u7ec7\u5c42\u7ea7\u7b49\u89c6\u89d2\u7406\u89e3\u6211\u4eec\u7684\u4e1a\u52a1\uff0c\u4f46\u662f\u4e0d\u59a8\u4ece\u6570\u636e\u903b\u8f91\u89c6\u89d2\u8bd5\u8bd5\uff1a</p> <p>\u6570\u636e\u662f\u5728\u54ea\u4e2a\u4e3b\u4f53\u4e0a\uff0c\u5728\u4ec0\u4e48\u573a\u666f\u4e0b\uff0c\u4ee5\u4ec0\u4e48\u6837\u7684\u65b9\u5f0f\u88ab\u751f\u4ea7\u548c\u8bb0\u5f55\u7684\uff1f\u6570\u636e\u662f\u600e\u4e48\u88ab\u52a0\u5de5\u548c\u5448\u73b0\u7684\uff1f\u4e3a\u4ec0\u4e48\u9700\u8981\u8fd9\u4e48\u5448\u73b0\uff1f\u8fd9\u4e2a\u6307\u6807\u5982\u679c\u8dcc\u4e86\uff0c\u5bf9\u4e1a\u52a1\u6709\u6307\u5411\u610f\u4e49\u5417\uff1f</p> <p>\u5f53\u4f60\u95ee\u8fd9\u4e9b\u95ee\u9898\u7684\u65f6\u5019\uff0c\u4f60\u4f1a\u53d1\u73b0\u4f60\u4e0d\u4ec5\u8981\u77e5\u9053\u4ea7\u54c1\u7684\u8bbe\u8ba1\u903b\u8f91\u3001\u5404\u4e2a\u6a21\u5757\u7684\u529f\u80fd\u70b9\uff0c\u8fd8\u8981\u77e5\u9053\u5b83\u4eec\u7684\u8026\u5408\u548c\u7ec4\u7ec7\u65b9\u5f0f\u3002\u8fd9\u4e9b\u90fd\u4f1a\u9a71\u52a8\u4f60\u53bb\u95ee\u540c\u4e8b\u3001\u67e5 wiki\u3001\u81ea\u5df1\u4e0a\u624b\u4f53\u9a8c\u3002\u76f8\u4fe1\u6211\uff0c\u8fd9\u6837\u5168\u5957\u6d41\u7a0b\u8d70\u4e0b\u6765\uff0c\u4f60\u5bf9\u4e1a\u52a1\u548c\u4ea7\u54c1\u4e00\u5b9a\u4f1a\u6709\u66f4\u6df1\u5165\u7684\u7406\u89e3\u3002</p> <p>\u7ef4\u5ea6\u4e00\u822c\u6307\u4e8b\u7269\u73b0\u8c61\u7684\u67d0\u79cd\u7279\u5f81\u3002\u4ece\u67d0\u79cd\u89d2\u5ea6\u51fa\u53d1\u7684\u5ea6\u91cf\u7edf\u8ba1\uff0c\u89d2\u5ea6\u5373\u4e3a\u7ef4\u5ea6\u3002\u53ef\u4ee5\u770b\u6210\u662f\u89c2\u5bdf\u6570\u636e\u7684\u4e00\u79cd\u89c6\u89d2\uff0c\u4f8b\u5982\u4eba\u7c7b\u80fd\u770b\u5230\u7684\u4e16\u754c\u662f\u4e09\u7ef4\u7684\uff0c\u5b83\u5305\u542b\u957f\u3001\u5bbd\u3001\u9ad8\u4e09\u4e2a\u7ef4\u5ea6\u3002\u76f4\u63a5\u4e00\u70b9\u7406\u89e3\uff0c\u7ef4\u5ea6\u5c31\u597d\u6bd4\u662f\u4e00\u5f20\u6570\u636e\u8868\u7684\u5b57\u6bb5\uff0c\u800c\u591a\u7ef4\u5206\u6790\u5219\u662f\u57fa\u4e8e\u8fd9\u4e9b\u5b57\u6bb5\u8fdb\u884c\u805a\u5408\u67e5\u8be2\u3002\u201c\u7ef4\u5ea6\u201d\u662f\u6307\u6570\u636e\u7684\u5c5e\u6027\u3002\u4ee5 Google Analytics \u4e3e\u4f8b\u6765\u8bf4\uff0c\u201c\u57ce\u5e02\u201d\u7ef4\u5ea6\u8868\u793a\u7684\u662f\u7528\u6237\u53d1\u8d77 WEB \u8bbf\u95ee\u4f1a\u8bdd\u7684\u57ce\u5e02\uff0c\u4f8b\u5982\u201c\u5df4\u9ece\u201d\u6216\u201c\u7ebd\u7ea6\u201d\u3002\u201c\u7f51\u9875\u201d\u7ef4\u5ea6\u8868\u793a\u7684\u662f\u7528\u6237\u6d4f\u89c8\u8fc7\u7684\u7f51\u9875\u7684\u7f51\u5740\u3002</p> <p>\u6307\u6807\u4e00\u822c\u6307\u53ef\u4ee5\u91cf\u5316\u7684\u6570\u636e(\u91cf\u5316\u8861\u91cf\u6807\u51c6\uff09\u662f\u8fdb\u884c\u7edf\u8ba1\u540e\u7684\u7ed3\u679c\u3002\u201c\u6307\u6807\u201d\u662f\u6307\u91cf\u5316\u8861\u91cf\u6807\u51c6\u3002\u201c\u4f1a\u8bdd\u6570\u201d\u6307\u6807\u662f\u6307\u603b\u4f1a\u8bdd\u6b21\u6570\u3002\u201c\u6bcf\u6b21\u4f1a\u8bdd\u6d4f\u89c8\u9875\u6570\u201d\u6307\u6807\u662f\u6307\u6bcf\u6b21\u4f1a\u8bdd\u7684\u5e73\u5747\u7f51\u9875\u6d4f\u89c8\u91cf\u3002</p> <p>\u4f8b\u5982\uff0c\u4e0b\u8868\u663e\u793a\u7684\u662f\u4e00\u4e2a\u7ef4\u5ea6\uff08\u201c\u57ce\u5e02\u201d\uff09\u548c\u4e24\u4e2a\u6307\u6807\uff08\u201c\u4f1a\u8bdd\u6570\u201d\u548c\u201c\u6bcf\u6b21\u4f1a\u8bdd\u6d4f\u89c8\u9875\u6570\u201d\uff09\u3002</p> \u7ef4\u5ea6 \u6307\u6807 \u6307\u6807 \u57ce\u5e02 \u4f1a\u8bdd\u6570 \u6bcf\u6b21\u4f1a\u8bdd\u6d4f\u89c8\u9875\u6570 \u65e7\u91d1\u5c71 5,000 3.74 \u67cf\u6797 4,000 4.55 <p>\u6307\u6807\u7528\u4e8e\u8861\u91cf\u4e8b\u7269\u53d1\u5c55\u7a0b\u5ea6\uff0c\u7ef4\u5ea6\u7528\u4e8e\u5bf9\u6307\u6807\u591a\u65b9\u9762\u7684\u8fdb\u884c\u5bf9\u6bd4\uff0c\u627e\u8d8b\u52bf\u7b49\u7b49\u3002</p> <p>\u7ef4\u5ea6\u7684\u56db\u4e2a\u4f5c\u7528\uff1a</p> <ul> <li>\u7b5b\u9009\uff1a\u6211\u4eec\u4e00\u822c\u901a\u8fc7\u7ef4\u5ea6\u6765\u7b5b\u9009\u6240\u89c2\u5bdf\u7684\u6570\u636e\u8303\u56f4\u3002</li> </ul> <p>\u5982\u679c\u662f\u5b9a\u6027\u7684\u5206\u7c7b\u7ef4\u5ea6\uff0c\u90a3\u4e48\u901a\u8fc7\u679a\u4e3e\u53ef\u4ee5\u7b5b\u9009\uff0c\u5178\u578b\u7684\u5b9a\u6027\u7ef4\u5ea6\u5982\u5e74\u4efd(\u65f6\u95f4\u7ef4\u5ea6)\u3001\u7701\u4efd(\u7a7a\u95f4\u7ef4\u5ea6)\u7b49\uff1b\u5982\u679c\u662f\u5b9a\u91cf\u7684\u7ef4\u5ea6\uff0c\u90a3\u4e48\u53ef\u4ee5\u50cf\u6307\u6807\u4e00\u6837\uff0c\u6309\u7167\u6570\u503c\u5927\u5c0f\u53d6\u4e00\u4e2a\u8303\u56f4\u5373\u53ef\uff0c\u5982\u8eab\u9ad8\u3002</p> <ul> <li>\u805a\u5408\uff1a\u901a\u4fd7\u5730\u6765\u8bf4\uff0c\u5373\u6211\u4eec\u5e0c\u671b\u5728\u591a\u5927\u7c92\u5ea6\u4e0a\u5206\u6790\u6570\u636e\u3002</li> </ul> <p>\u6bd4\u5982\u4f60\u8981\u7edf\u8ba1\u5e7f\u544a\u6d88\u8017\uff0c\u90a3\u4e48\u662f\u5728\u521b\u610f\u7c92\u5ea6\u4e0a\u770b\uff0c\u8fd8\u662f\u5c06\u521b\u610f\u7c92\u5ea6\u6d88\u8017\u6570\u636e\u52a0\u603b\uff0c\u5e76\u4e0a\u5377\u5230\u8ba1\u5212\u7c92\u5ea6\u5206\u6790\u6d88\u8017\u5462\uff1f\u5982\u679c\u4f60\u4e4b\u524d\u5199\u8fc7 SQL\uff0c\u90a3\u4e48\u80af\u5b9a\u77e5\u9053\u5728\u5bf9\u6307\u6807\u8fdb\u884c sum\uff08\u6c42\u548c\uff09\u3001avg\uff08\u6c42\u5e73\u5747\uff09\u4e4b\u540e\uff0c\u8981\u5728\u811a\u672c\u6700\u540e\u52a0\u5165<code>GROUP BY XX</code>\uff0c\u4e5f\u5c31\u662f\u4f60\u5e0c\u671b\u805a\u5408\u5230\u7684\u7ef4\u5ea6\u3002\u4f46\u662f\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u4f60\u5728\u8fdb\u884c\u805a\u5408\u7684\u65f6\u5019\uff0c\u4e00\u5b9a\u8981\u786e\u8ba4\u8ba1\u7b97\u7684\u6307\u6807\uff0c\u662f\u53ef\u4ee5\u5728\u8be5\u7ef4\u5ea6\u4e0a\u53ef\u5206\u548c\u53ef\u8ba1\u7b97\u7684\uff0c\u5426\u5219\u4f60\u7b97\u51fa\u6765\u7684\u6570\u636e\u80af\u5b9a\u662f\u9519\u8bef\u7684\uff0c\u8fd9\u4e2a\u4f1a\u5728\u540e\u9762\u4f1a\u8be6\u8ff0\u3002</p> <ul> <li>\u5bf9\u6bd4\uff1a\u6570\u636e\u53ea\u6709\u5728\u5bf9\u6bd4\u7684\u65f6\u5019\u624d\u6709\u610f\u4e49</li> </ul> <p>\u6211\u4eec\u53d1\u73b0\u6570\u636e\u4e0a\u6da8\u3001\u4e0b\u8dcc\u3001\u6ce2\u52a8\uff0c\u662f\u56e0\u4e3a\u6211\u4eec\u77e5\u9053\u6b63\u5e38\u7684\u6570\u636e\u5e94\u8be5\u662f\u591a\u5c11\uff0c\u8d85\u8fc7\u8fd9\u4e2a\u8303\u56f4\u7684\u6570\u636e\u90fd\u662f\u5f02\u5e38\u7684\uff0c\u624d\u4f1a\u9700\u8981\u8fdb\u4e00\u6b65\u6bd4\u8f83\u548c\u5206\u6790\u3002\u6211\u4eec\u5728\u5bf9\u6bd4\u6570\u636e\u7684\u65f6\u5019\uff0c\u901a\u5e38\u4f1a\u9009\u62e9\u67d0\u4e00\u4e2a\u7ef4\u5ea6\uff0c\u7136\u540e\u5728\u8be5\u7ef4\u5ea6\u4e0b\u8fdb\u884c\u5bf9\u6bd4\u3002\u4e0d\u5728\u540c\u4e00\u4e2a\u7ef4\u5ea6\u4e0a\uff0c\u5bf9\u6bd4 2 \u4e2a\u540c\u6837\u6307\u6807\uff0c\u5728\u4e1a\u52a1\u4e2d\u6ca1\u6709\u4efb\u4f55\u610f\u4e49\u3002</p> <p>\u5047\u8bbe\u6211\u4eec\u8981\u5bf9\u6bd4\u6bcf\u4e00\u4e2a\u673a\u578b\u7684\u7559\u5b58\uff0c\u5fc5\u987b\u662f\u5728\u540c\u4e00\u4e2a\u7ef4\u5ea6\uff08\u673a\u578b\uff09\u7684\u4e0b\u94bb\u548c\u6bd4\u8f83\uff0c\u8fd9\u901a\u5e38\u79f0\u4e3a\u6a2a\u5411\u5bf9\u6bd4\u3002</p> <p>\u53e6\u4e00\u79cd\u5bf9\u6bd4\uff0c\u5219\u662f\u4ee5\u65f6\u95f4\u4e3a\u7ef4\u5ea6\u7684\u7eb5\u5411\u5bf9\u6bd4\u3002\u6211\u4eec\u770b DAU\u3001\u7559\u5b58\u8fd9\u4e9b\u6307\u6807\uff0c\u7a76\u7adf\u662f\u6da8\u4e86\u8fd8\u662f\u8dcc\u4e86\uff0c\u901a\u5e38\u90fd\u662f\u89c2\u5bdf\u4e00\u6bb5\u65f6\u95f4\u7684\u6307\u6807\u53d8\u5316\uff1b\u73af\u6bd4\u3001\u540c\u6bd4\u8fd9\u4e9b\uff0c\u5219\u662f\u57fa\u4e8e\u4e0d\u540c\u65f6\u95f4\u7a97\u53e3\u7ef4\u5ea6\uff0c\u5bf9\u6307\u6807\u7684\u4e8c\u6b21\u52a0\u5de5\u548c\u8ba1\u7b97\u3002</p> <p>\u5bf9\u4e8e\u7ef4\u5ea6\u548c\u6307\u6807\u7684\u7406\u89e3\uff0c\u4e00\u5b9a\u8981\u5728\u5177\u4f53\u4e1a\u52a1\u573a\u666f\u4e0b\u6df1\u5165\u5206\u6790\u3002\u5e76\u4e0d\u662f\u67d0\u4e9b\u5b57\u6bb5\u4e00\u5b9a\u662f\u7ef4\u5ea6\uff0c\u67d0\u4e9b\u5b57\u6bb5\u4e00\u5b9a\u662f\u6307\u6807\uff1b\u7ef4\u5ea6\u548c\u6307\u6807\u7684\u754c\u5b9a\uff0c\u4e00\u5b9a\u8981\u6839\u636e\u5177\u4f53\u4e1a\u52a1\u573a\u666f\uff0c\u4ee5\u53ca\u5728\u8be5\u4e1a\u52a1\u573a\u666f\u4e0b\u7684\u6570\u636e\u751f\u4ea7\u903b\u8f91\u3002</p> <p>\u591a\u7ef4\u5206\u6790\u662f\u6570\u636e\u4ed3\u5e93\u7cfb\u7edf\u4e0b\u6e38\u5e38\u89c1\u7684\u57fa\u7840\u5e94\u7528\uff0c\u5e95\u5c42\u6570\u636e\u662f\u5305\u542b\u591a\u79cd\u7c92\u5ea6\u6c47\u603b\u7ed3\u679c\u7684 Cube\uff0c\u7528\u4e8e\u63d0\u4f9b\u4e0a\u5377\uff0c\u4e0b\u94bb\u7b49\u64cd\u4f5c\u7684\u6570\u636e\u652f\u6301\u3002</p> <ul> <li>\u591a\u7ef4\u6570\u636e\u6a21\u578b\uff1a\u4e3a\u4e86\u6ee1\u8db3\u7528\u6237\u4ece\u591a\u89d2\u5ea6\u591a\u5c42\u6b21\u8fdb\u884c\u6570\u636e\u67e5\u8be2\u548c\u5206\u6790\u7684\u9700\u8981\u800c\u5efa\u7acb\u8d77\u6765\u7684\u57fa\u4e8e\u4e8b\u5b9e\u548c\u7ef4\u7684\u6570\u636e\u5e93\u6a21\u578b\uff0c\u5176\u57fa\u672c\u7684\u5e94\u7528\u662f\u4e3a\u4e86\u5b9e\u73b0 OLAP\uff08Online Analytical Processing\uff09</li> <li>\u7acb\u65b9\u4f53\uff1a\u5b83\u662f\u7531\u7ef4\u5ea6\u6784\u5efa\u51fa\u6765\u7684\u591a\u7ef4\u7a7a\u95f4\uff0c\u5305\u542b\u4e86\u6240\u8981\u5206\u6790\u7684\u57fa\u7840\u6570\u636e\uff0c\u6240\u6709\u7684\u805a\u5408\u6570\u636e\u64cd\u4f5c\u90fd\u5728\u5b83\u4e0a\u9762\u8fdb\u884c\u3002</li> <li>\u7ef4\u5ea6\uff08Dimensions\uff09\uff1a\u89c2\u5bdf\u6570\u636e\u7684\u4e00\u79cd\u89d2\u5ea6\uff0c\u6bd4\u5982\u5728\u4e0a\u56fe\u4e2d address\u3001item\u3001time \u90fd\u53ef\u4ee5\u88ab\u770b\u4f5c\u4e00\u4e2a\u7ef4\u5ea6\uff0c\u76f4\u89c2\u4e0a\u6765\u770b\u7ef4\u5ea6\u662f\u4e00\u4e2a\u7acb\u65b9\u4f53\u7684\u8f74\uff0c\u6bd4\u5982\u4e09\u4e2a\u7ef4\u5ea6\u53ef\u4ee5\u6784\u6210\u4e00\u4e2a\u7acb\u65b9\u4f53\u7684\u7a7a\u95f4</li> <li>\u7ef4\u5ea6\u6210\u5458\uff1a\u6784\u6210\u7ef4\u5ea6\u7684\u57fa\u672c\u5355\u4f4d\uff0c\u6bd4\u5982\u5bf9\u4e8e time \u7ef4\uff0c\u5305\u542b Q1\u3001Q2\u3001Q3\u3001Q4 \u56db\u4e2a\u7ef4\u5ea6\u6210\u5458\u3002</li> <li>\u5c42\u6b21\uff1a\u7ef4\u5ea6\u7684\u5c42\u6b21\u7ed3\u6784\uff0c\u5b83\u5b58\u5728\u4e24\u79cd\uff1a\u81ea\u7136\u5c42\u6b21\u548c\u7528\u6237\u81ea\u5b9a\u4e49\u5c42\u6b21\u3002\u6bd4\u5982\u5bf9\u4e8e\u65f6\u95f4\u7ef4\uff0c\u53ef\u4ee5\u5206\u4e3a\u5e74\u3001\u6708\u3001\u65e5\u4e09\u4e2a\u5c42\u6b21\uff0c\u4e5f\u53ef\u4ee5\u5206\u4e3a\u5e74\u3001\u5b63\u5ea6\u3001\u6708\u4e09\u4e2a\u5c42\u6b21\u3002\u4e00\u4e2a\u7ef4\u53ef\u4ee5\u6709\u591a\u4e2a\u5c42\u6b21\uff0c\u5b83\u662f\u5355\u4f4d\u6570\u636e\u805a\u96c6\u7684\u4e00\u79cd\u8def\u5f84</li> <li>\u7ea7\u522b\uff1a\u7ea7\u522b\u7ec4\u6210\u5c42\u6b21\uff0c\u6bd4\u5982\u5e74\u3001\u6708\u3001\u65e5\u5206\u522b\u662f\u65f6\u95f4\u7ef4\u7684\u4e09\u4e2a\u7ea7\u522b</li> <li>\u5ea6\u91cf\uff1a\u4e00\u4e2a\u6570\u503c\u51fd\u6570\uff0c\u53ef\u4ee5\u5bf9\u6570\u636e\u7acb\u65b9\u4f53\u7a7a\u95f4\u4e2d\u7684\u6bcf\u4e2a\u70b9\u6c42\u503c\uff1b\u5ea6\u91cf\u503c\u81ea\u7136\u5c31\u662f\u5ea6\u91cf\u7684\u7ed3\u679c</li> <li>\u4e8b\u5b9e\u8868\uff1a\u5b58\u653e\u5ea6\u91cf\u503c\u5f97\u8868\uff0c\u540c\u65f6\u5b58\u653e\u4e86\u7ef4\u8868\u5f97\u5916\u952e\uff0c\u6240\u6709\u5206\u6790\u6240\u7528\u5f97\u6570\u636e\u6700\u7ec8\u90fd\u6765\u81ea\u4e8b\u5b9e\u8868</li> <li>\u7ef4\u8868\uff1a\u5bf9\u4e8e\u7ef4\u5ea6\u7684\u63cf\u8ff0\uff0c\u6bcf\u4e2a\u7ef4\u5ea6\u5bf9\u5e94\u4e00\u4e2a\u6216\u591a\u4e2a\u7ef4\u8868\uff0c\u4e00\u4e2a\u7ef4\u5ea6\u5bf9\u5e94\u4e00\u4e2a\u8868\u7684\u662f\u661f\u578b\u6a21\u5f0f\uff0c\u5bf9\u5e94\u591a\u4e2a\u8868\u7684\u662f\u96ea\u82b1\u6a21\u5f0f</li> </ul>"},{"location":"olap/01.OLAP%E6%A6%82%E8%BF%B0/#_7","title":"\u6570\u636e\u7acb\u65b9\u4f53","text":"<p>\u6570\u636e\u7acb\u65b9\u4f53\uff08Data Cube\uff09\u662f\u6570\u636e\u4ed3\u5e93\u6280\u672f\u4e2d\u7684\u4e00\u4e2a\u6838\u5fc3\u6982\u5ff5\uff0c\u901a\u5e38\u7528\u4e8e\u591a\u7ef4\u6570\u636e\u7684\u5206\u6790\u548c\u67e5\u8be2\u3002\u6570\u636e\u7acb\u65b9\u4f53\u901a\u5e38\u5efa\u7acb\u5728\u6570\u636e\u4ed3\u5e93\u4e4b\u4e0a\uff0c\u901a\u8fc7 ETL\uff08\u62bd\u53d6\u3001\u8f6c\u6362\u3001\u52a0\u8f7d\uff09\u8fc7\u7a0b\u4ece\u591a\u4e2a\u6570\u636e\u6e90\u63d0\u53d6\u6570\u636e\u3002\u5b83\u901a\u8fc7\u5728\u591a\u4e2a\u7ef4\u5ea6\u4e0a\u7ec4\u7ec7\u6570\u636e\uff0c\u4f7f\u5f97\u7528\u6237\u80fd\u591f\u7075\u6d3b\u5730\u4ece\u4e0d\u540c\u7684\u89d2\u5ea6\u8fdb\u884c\u6570\u636e\u5206\u6790\u548c\u6316\u6398\u3002\u9700\u8981\u6ce8\u610f\u7684\u662f\u6570\u636e\u7acb\u65b9\u4f53\u53ea\u662f\u591a\u7ef4\u6a21\u578b\u7684\u4e00\u4e2a\u5f62\u8c61\u7684\u8bf4\u6cd5\u3002\u7acb\u65b9\u4f53\u5176\u672c\u8eab\u53ea\u6709\u4e09\u7ef4\uff0c\u4f46\u591a\u7ef4\u6a21\u578b\u4e0d\u4ec5\u9650\u4e8e\u4e09\u7ef4\u6a21\u578b\uff0c\u53ef\u4ee5\u7ec4\u5408\u66f4\u591a\u7684\u7ef4\u5ea6\uff0c\u4f46\u4e00\u65b9\u9762\u662f\u51fa\u4e8e\u66f4\u65b9\u4fbf\u5730\u89e3\u91ca\u548c\u63cf\u8ff0\uff0c\u540c\u65f6\u4e5f\u662f\u7ed9\u601d\u7ef4\u6210\u50cf\u548c\u60f3\u8c61\u7684\u7a7a\u95f4\uff1b\u53e6\u4e00\u65b9\u9762\u662f\u4e3a\u4e86\u4e0e\u4f20\u7edf\u5173\u7cfb\u578b\u6570\u636e\u5e93\u7684\u4e8c\u7ef4\u8868\u533a\u522b\u5f00\u6765\uff0c\u4e8e\u662f\u5c31\u6709\u4e86\u6570\u636e\u7acb\u65b9\u4f53\u7684\u53eb\u6cd5\u3002</p> <p>\u6570\u636e\u4ed3\u5e93\u7684\u6570\u636e\u6a21\u578b\u901a\u5e38\u662f\u5173\u7cfb\u578b\u7684\uff0c\u56e0\u4e3a<code>SQL</code>\u901a\u5e38\u5f88\u9002\u5408\u5206\u6790\u67e5\u8be2\u3002\u6709\u8bb8\u591a\u56fe\u5f62\u6570\u636e\u5206\u6790\u5de5\u5177\u53ef\u4ee5\u751f\u6210<code>SQL</code>\u67e5\u8be2\uff0c\u53ef\u89c6\u5316\u7ed3\u679c\uff0c\u5e76\u5141\u8bb8\u5206\u6790\u4eba\u5458\u63a2\u7d22\u6570\u636e\uff08\u901a\u8fc7\u4e0b\u94bb\u3001\u5207\u7247\u548c\u5207\u5757\u7b49\u64cd\u4f5c\uff09\u3002\u5728\u6570\u636e\u5206\u6790\u65f6\uff0c\u6709\u4e00\u4e2a\u6982\u5ff5\u53eb \u94bb\u53d6 \uff0c\u5206\u4e3a \u4e0a\u94bb \u548c \u4e0b\u94bb \uff0c\u5176\u5b9e\u5c31\u662f\u9010\u5c42\u805a\u5408\u3002</p> <p>\u5b9e\u9645\u4e0a\uff0c\u6709\u4e9b\u7ef4\u5ea6\uff08\u5b57\u6bb5\uff09\u672c\u8eab\u8fd8\u5177\u5907\u5c42\u6b21\u6027\u3002\u5982<code>\u65f6\u95f4\u7ef4</code>\u53ef\u7531<code>\u5e74\u3001\u5b63\u3001\u6708\u3001\u65e5</code>\u6784\u6210\uff0c<code>\u5730\u533a</code>\u4e5f\u53ef\u4ee5\u7531<code>\u56fd\u5bb6\u3001\u7701\u4efd\u3001\u5e02\u3001\u533a\u53bf</code>\u6784\u6210\u7b49\u3002</p> <p>\u7ef4\u5ea6\u6709\u4e86\u5c42\u4ee5\u540e\uff0c\u5c31\u53ef\u4ee5\u65b9\u4fbf\u4ece\u540c\u4e00\u7ef4\u5ea6\u7684\u4e0d\u540c\u7c92\u5ea6\uff08\u5c42\u6b21\uff09\u6765\u5206\u6790\u6570\u636e\u4e86\u3002\u6bd4\u5982\u9488\u5bf9\u8fd9\u5f20\u5546\u54c1\u9500\u552e\u660e\u7ec6\u8868</p> \u7701 \u5e02 \u5546\u54c1 \u65f6\u95f4 \u4ef7\u683c \u6e56\u5317 \u6b66\u6c49 \u8db3\u7403 \u6e56\u5317 \u6b66\u6c49 \u7bee\u7403 \u6e56\u5317 \u5b9c\u660c \u7bee\u7403 \u5e7f\u4e1c \u5e7f\u5dde \u4e52\u4e53\u7403 \u5e7f\u4e1c \u73e0\u6d77 \u7fbd\u6bdb\u7403 \u5e7f\u4e1c \u73e0\u6d77 \u7fbd\u6bdb\u7403 \u5e7f\u4e1c \u73e0\u6d77 \u8db3\u7403 \u5e7f\u4e1c \u5e7f\u5dde \u8db3\u7403 <ul> <li> <p>\u4e0b\u94bb\uff08drill down\uff09\uff1a\u4e0b\u94bb\u53ef\u4ee5\u7406\u89e3\u6210\u589e\u52a0\u7ef4\u7684\u5c42\u6b21\uff0c\u4ece\u800c\u53ef\u4ee5\u7531\u7c97\u7c92\u5ea6\u5230\u7ec6\u7c92\u5ea6\u6765\u89c2\u5bdf\u6570\u636e\uff0c\u6bd4\u5982\u5bf9\u4ea7\u54c1\u9500\u552e\u60c5\u51b5\u5206\u6790\u65f6\uff0c\u53ef\u4ee5\u6cbf\u7740\u65f6\u95f4\u7ef4\u4ece\u5e74\u5230\u6708\u5230\u65e5\u66f4\u7ec6\u7c92\u5ea6\u7684\u89c2\u5bdf\u6570\u636e\u3002</p> </li> <li> <p>\u5728\u8fd9\u4e2a\u4f8b\u5b50\uff0c\u6309\u7167\u5730\u533a\u4e0b\u94bb\u67e5\u8be2(\u7701\u2014\u2014&gt;\u5e02)\uff1a\u5176\u5b9e\u5c31\u662f\u6309\u7167\u5e02\u5206\u7ec4\u805a\u5408\u67e5\u8be2\uff0c\u67e5\u8be2\u6bcf\u4e2a\u5e02\u7684\u603b\u9500\u552e\u4ef7\u683c\u3002</p> </li> <li> <p>\u4e0a\u94bb(drill up)\uff1a\u53ef\u4ee5\u7406\u89e3\u6210\u4f4e\u5c42\u6b21\u5411\u9ad8\u5c42\u6b21\u6c47\u805a\u3002\u5220\u6389\u7ef4\u7684\u67d0\u4e9b\u5c42\uff0c\u7531\u7ec6\u7c92\u5ea6\u5230\u7c97\u7c92\u5ea6\u89c2\u5bdf\u6570\u636e\u7684\u64cd\u4f5c\u6216\u6cbf\u7740\u7ef4\u7684\u5c42\u6b21\u5411\u4e0a\u805a\u5408\u6c47\u603b\u6570\u636e\u3002</p> </li> <li> <p>\u5728\u8fd9\u4e2a\u4f8b\u5b50\uff0c\u6309\u7167\u5730\u533a\u4e0b\u94bb\u67e5\u8be2\uff08\u5e02\u2014\u2014&gt;\u7701\uff09\uff1a\u5176\u5b9e\u5c31\u662f\u6309\u7167\u7701\u5206\u7ec4\u805a\u5408\u67e5\u8be2\uff0c\u67e5\u8be2\u6bcf\u4e2a\u7701\u7684\u603b\u9500\u552e\u4ef7\u683c\u3002</p> </li> <li> <p>\u5207\u7247(slice)\uff1a\u89c2\u5bdf\u7acb\u65b9\u4f53\u7684\u4e00\u5c42\uff0c\u5c06\u4e00\u4e2a\u6216\u591a\u4e2a\u6e29\u5ea6\u8bbe\u4e3a\u5355\u4e2a\u56fa\u5b9a\u7684\u503c\uff0c\u7136\u540e\u89c2\u5bdf\u5269\u4f59\u7684\u7ef4\u5ea6\uff0c\u4f8b\u5982\u5c06\u5546\u54c1\u7ef4\u5ea6\u56fa\u5b9a\u4e3a \"\u8db3\u7403\"\u3002</p> </li> <li> <p>\u67e5\u770b\u6570\u636e\u7684\u65f6\u5019\uff0c\u901a\u5e38\u662f\u4e0d\u4f1a\u6240\u6709\u7ef4\u5ea6\u90fd\u7528\u5230\u7684\u3002\u8b6c\u5982\uff0c\u65f6\u95f4\u3001\u5730\u533a\u3001\u5546\u54c1\u3001\u9500\u552e\u90e8\u95e8\uff0c\u8fd9\u51e0\u4e2a\u7ef4\u5ea6\uff0c\u6211\u4eec\u505a\u62a5\u8868\u5206\u6790\u65f6\uff0c\u53ef\u80fd\u53ea\u9009\u4e86\u65f6\u95f4\u3001\u5730\u533a\uff0c\u90a3\u6b64\u65f6\uff0c\u5546\u54c1\u548c\u90e8\u95e8\u7ef4\u5ea6\u4f1a\u81ea\u52a8\u4e3a\u9ed8\u8ba4\u6210\u5458\uff08\u901a\u5e38\u4e3a ALL\uff0c\u6216\u4f60\u81ea\u8bbe\u7684 DEFAULT\uff09\uff0c\u5982\u679c\u6211\u4eec\u9009\u53d6\u90e8\u95e8\u7ef4\u5ea6\u8fd9\u4e2a\u6811\u679d\u4e0a\u7684\u67d0\u4e00\u4e2a\u8282\u70b9\uff0c\u5373\u7ef4\u5ea6\u6210\u5458\uff0c\u5982\u9500\u552e\u4e00\u90e8\uff0c\u5546\u54c1\u9009\u4e00\u54c1\u7c7b\uff0c\u5982\u98df\u54c1\uff0c\u5c31\u770b\u9500\u552e\u4e00\u90e8\u7684\u98df\u54c1\u7c7b\u7684\u5404\u65f6\u95f4\u3001\u5730\u533a\u6570\u636e\u4e86\uff0c\u53ea\u6709 2 \u4e2a\u7ef4\u5ea6\u4e86\uff0c\u53ef\u4ee5\u60f3\u8c61\u4e3a\u4e00\u4e2a\u5e73\u9762\u4e86\uff0c\u8fd9\u5c31\u662f\u5207\u7247\u3002</p> </li> <li> <p>\u5207\u5757\uff1a\u548c\u5207\u7247\u7c7b\u4f3c\uff0c\u53ea\u662f\u5c06\u5355\u4e2a\u56fa\u5b9a\u503c\u53d8\u6210\u591a\u4e2a\u56fa\u5b9a\u503c\u3002\u4f8b\u5982\u5c06\u5546\u54c1\u7ef4\u5ea6\u56fa\u5b9a\u4e3a\"\u8db3\u7403\"\u3001\"\u7bee\u7403\" \u548c \"\u4e52\u4e53\u7403\"\u3002</p> </li> <li> <p>\u65cb\u8f6c\uff1a\u65cb\u8f6c\u7acb\u65b9\u4f53\u7684\u4e00\u9762\uff0c\u5982\u679c\u8981\u5c06\u6570\u636e\u6620\u5c04\u5230\u4e00\u5f20\u4e8c\u7ef4\u8868\uff0c\u90a3\u4e48\u5c31\u8981\u8fdb\u884c\u65cb\u8f6c\uff0c\u7b49\u540c\u4e8e\u884c\u5217\u8f6c\u6362\u3002</p> </li> </ul> <p>\u56e0\u4e3a\u4e0a\u4e0b\u5c42\u7684\u5173\u7cfb\uff0c\u6211\u4eec\u5728\u6570\u636e\u805a\u5408\u65f6\u5c31\u4f1a\u6d89\u53ca\u5230\u4e0d\u540c\u5c42\u6b21\u7684\u805a\u5408\uff0c\u6bd4\u5982 <code>group by a</code> ; <code>group by a,b</code> ; <code>group by a,b,c</code>\uff0c\u800c<code>group by</code>\u7684\u6bcf\u6b21\u6267\u884c\u90fd\u53ea\u80fd\u57fa\u4e8e\u67d0\u4e00\u4e2a\u5c42\u7ea7\u7684\u805a\u5408\u3002</p> <p>\u56e0\u6b64\uff0c\u6709\u6ca1\u6709\u53ef\u80fd\u4e00\u4e2a<code>group by</code> \u5c31\u628a\u6240\u6709\u53ef\u80fd\u7684\u7ec4\u5408\u90fd\u6267\u884c\u51fa\u6765\u5462\uff1f\u663e\u7136<code>hive</code>\u786e\u5b9e\u63d0\u4f9b\u4e86\u8fd9\u6837\u7684\u529f\u80fd\uff0c\u90a3\u5c31\u662f<code>cube</code>\uff0c\u6240\u8c13\u7684\u6570\u636e\u7acb\u65b9\u4f53\u4e86\u3002</p> <p>\u4ece\u5b8f\u89c2\u4e0a\u770b\uff0c\u6570\u636e\u672c\u8eab\u5c31\u662f\u591a\u7ef4\u7acb\u4f53\u7684\uff0c\u5f53\u6211\u4eec\u57fa\u4e8e\u67d0\u4e2a\u6216\u8005\u67d0\u51e0\u4e2a\u7ef4\u5ea6\u805a\u5408\u65f6\uff0c\u5c31\u76f8\u5f53\u4e8e\u4ece\u67d0\u4e2a\u65b9\u5411\u62bd\u53d6\u4e00\u4e2a\u70b9\u6216\u8005\u4e00\u4e2a\u9762\u8fdb\u884c\u89c2\u5bdf\u3002</p>"},{"location":"olap/01.OLAP%E6%A6%82%E8%BF%B0/#_8","title":"\u589e\u5f3a\u805a\u5408","text":"<p>\u589e\u5f3a\u805a\u5408\u548c\u591a\u7ef4\u5206\u6790\u51fd\u6570\u662f\u6570\u636e\u4ed3\u5e93\u548c\u5927\u6570\u636e\u5206\u6790\u4e2d\u7684\u91cd\u8981\u6280\u672f\u624b\u6bb5\uff0c\u7528\u4e8e\u9ad8\u6548\u5904\u7406\u590d\u6742\u7684\u6570\u636e\u67e5\u8be2\u9700\u6c42\u3002\u8fd9\u4e9b\u6280\u672f\u901a\u5e38\u4e0e OLAP\uff08\u5728\u7ebf\u5206\u6790\u5904\u7406\uff09\u7cfb\u7edf\u7ed3\u5408\u4f7f\u7528\uff0c\u652f\u6301\u7528\u6237\u5feb\u901f\u5bf9\u5927\u89c4\u6a21\u6570\u636e\u8fdb\u884c\u5206\u7ec4\u3001\u6c47\u603b\u3001\u5207\u7247\u3001\u5207\u5757\u7b49\u64cd\u4f5c\u3002</p> <p>\u589e\u5f3a\u805a\u5408\u662f\u6307\u5728\u4f20\u7edf\u7684 SQL \u805a\u5408\uff08\u5982 SUM\u3001COUNT\u3001AVG \u7b49\uff09\u57fa\u7840\u4e0a\uff0c\u901a\u8fc7\u5f15\u5165\u66f4\u590d\u6742\u7684\u903b\u8f91\u6216\u51fd\u6570\u6765\u6ee1\u8db3\u7279\u5b9a\u7684\u4e1a\u52a1\u9700\u6c42\u3002</p> <p>\u5728 SQL \u4e2d\u4f7f\u7528\u5206\u7ec4\u805a\u5408\u67e5\u8be2\u65f6\uff0c\u4f7f\u7528 <code>grouping sets</code>\u3001<code>rollup</code>\u3001<code>cube</code> \u8bed\u53e5\u8fdb\u884c\u64cd\u4f5c\uff0c\u5728\u5e38\u89c1\u7684\u6570\u636e\u5f15\u64ce\u4e2d\u90fd\u652f\u6301\u8fd9\u79cd\u8bed\u6cd5\uff0c\u6bd4\u5982 hive\u3001spark\u3001presto\u3001ck\u3001flinkSQL</p> <p>\u4f7f\u7528\u589e\u5f3a\u805a\u5408\u4e0d\u4ec5\u53ef\u4ee5\u7b80\u5316 SQL \u4ee3\u7801\uff0c\u800c\u4e14\u8fd8\u80fd\u5bf9 SQL \u8bed\u53e5\u7684\u6027\u80fd\u6709\u6240\u63d0\u5347</p> <p>CUBE \u662f\u4e00\u79cd\u6269\u5c55\u7684\u5206\u7ec4\u64cd\u4f5c\u7b26\uff0c\u7528\u4e8e\u751f\u6210\u6240\u6709\u53ef\u80fd\u7684\u5206\u7ec4\u7ec4\u5408\u3002\u5b83\u4f1a\u57fa\u4e8e\u6307\u5b9a\u7684\u5206\u7ec4\u5217\u751f\u6210\u4e00\u4e2a\u5b8c\u6574\u7684\u591a\u7ef4\u6570\u636e\u96c6\uff08Cube\uff09\uff0c\u5305\u62ec\u6240\u6709\u7ef4\u5ea6\u7684\u4ea4\u53c9\u7ec4\u5408\u3002</p> <p><code>PostgreSQL</code>\u9664\u4e86\u652f\u6301\u57fa\u672c\u7684<code>GROUP BY</code>\u5206\u7ec4\u64cd\u4f5c\u4e4b\u5916\uff0c\u8fd8\u652f\u6301 3 \u79cd\u9ad8\u7ea7\u7684\u5206\u7ec4\u9009\u9879\uff1a<code>GROUPING SETS</code>\u3001<code>ROLLUP</code>\u4ee5\u53ca<code>CUBE</code></p> <pre><code>-- \u5728\u4e00\u4e2a GROUP BY \u5b50\u53e5\u4e2d\u4e00\u6b21\u5b9e\u73b0\u591a\u4e2a\u96c6\u5408\u7684\u5206\u7ec4\u3002\u5176\u7ed3\u679c\u7b49\u4ef7\u4e8e\u5c06\u591a\u4e2a\u76f8\u5e94 GROUP BY \u5b50\u53e5\u8fdb\u884c UNION ALL \u64cd\u4f5c\u3002\nSELECT k1, k2, SUM( k3 ) FROM t GROUP BY GROUPING SETS ( (k1, k2), (k1), (k2), ( ) );\n\nSELECT k1, k2, SUM( k3 ) FROM t GROUP BY k1, k2\nUNION ALL\nSELECT k1, null, SUM( k3 ) FROM t GROUP BY k1\nUNION ALL\nSELECT null, k2, SUM( k3 ) FROM t GROUP BY k2\nUNION ALL\nSELECT null, null, SUM( k3 ) FROM t\n\n\n-- \u5047\u8bbe\u6709\u4e00\u4e2a\u9500\u552e\u6570\u636e\u8868 sales\uff0c\u5305\u542b\u4ee5\u4e0b\u5b57\u6bb5\uff1a\n\n--  region\uff08\u5730\u533a\uff09\n--  product_category\uff08\u4ea7\u54c1\u7c7b\u522b\uff09\n-- sales_amount\uff08\u9500\u552e\u989d\uff09\n\n-- \u67e5\u8be2\uff1a\u6309\u5730\u533a\u548c\u4ea7\u54c1\u7c7b\u522b\u751f\u6210\u6240\u6709\u53ef\u80fd\u7684\u6c47\u603b\n\nSELECT\n    region,\n    product_category,\n    SUM(sales_amount) AS total_sales\nFROM sales\nGROUP BY CUBE(region, product_category);\n\n-- \u5728\u8fd9\u4e2a\u4f8b\u5b50\u4e2d\uff0cCUBE \u751f\u6210\u4e86\u6240\u6709\u53ef\u80fd\u7684\u5206\u7ec4\u7ec4\u5408\uff0c\u5305\u62ec\u5355\u72ec\u7684\u5730\u533a\u3001\u5355\u72ec\u7684\u4ea7\u54c1\u7c7b\u522b\u3001\u5730\u533a\u548c\u7c7b\u522b\u7684\u4ea4\u53c9\u7ec4\u5408\uff0c\u4ee5\u53ca\u603b\u8ba1\u3002\n\n-- ROLLUP \u662f\u5bf9 GROUPING SETS \u7684\u6269\u5c55\u3002\n\nSELECT a, b,c, SUM( d ) FROM tab1 GROUP BY ROLLUP(a,b,c)\n\nGROUPING SETS (\n(a,b,c),\n( a, b ),\n( a),\n( )\n)\n</code></pre>"},{"location":"olap/01.OLAP%E6%A6%82%E8%BF%B0/#_9","title":"\u4e16\u754c\u94f6\u884c\u6570\u636e\u516c\u5f00","text":"<p>\u4e16\u754c\u94f6\u884c\u516c\u5f00\u6570\u636e\uff08World Bank Open Data\uff09\u6536\u5f55\u4e86\u4e16\u754c\u94f6\u884c\u6570\u636e\u5e93\u7684\u4e03\u5343\u591a\u4e2a\u6307\u6807\uff0c\u7528\u6237\u53ef\u4ee5\u6309\u56fd\u5bb6\u3001\u6307\u6807\u3001\u4e13\u9898\u548c\u6570\u636e\u76ee\u5f55\u8fdb\u884c\u6570\u636e\u6d4f\u89c8\uff0c\u5176\u4e2d\u6570\u767e\u4e2a\u6570\u636e\u53ef\u4e0a\u6eaf 50 \u5e74\u3002</p> <p>\u8be5\u6570\u636e\u5e93\u53ef\u4ee5\u6309\u4ee5\u4e0b\u65b9\u5f0f\u6d4f\u89c8\u6570\u636e\uff1a</p> <ul> <li> <p>\u6309\u56fd\u5bb6\u6d4f\u89c8\u6570\u636e\uff1a\u6570\u636e\u5305\u62ec\u4eba\u53e3\u6570\u91cf\u5728 3 \u4e07\u4eba\u4ee5\u4e0a\u7684\u7ecf\u6d4e\u4f53\u4ee5\u53ca\u66f4\u5c0f\u7684\u7ecf\u6d4e\u4f53\uff08\u5747\u4e3a\u4e16\u754c\u94f6\u884c\u7684\u6210\u5458\u4f53\uff09\u3002\u4ece\u56fd\u5bb6\u5217\u8868\u4e2d\u9009\u62e9\u4e00\u4e2a\u56fd\u5bb6\uff0c\u6d4f\u89c8\u8be5\u56fd\u7684\u57fa\u672c\u4fe1\u606f\u3001\u6240\u5c5e\u5730\u533a\u3001\u6240\u5c5e\u6536\u5165\u7ec4\u522b\u3001\u56fd\u6c11\u751f\u4ea7\u603b\u503c\u548c\u4eba\u53e3\u6570\u91cf\u7b49\u6570\u636e\u3002</p> </li> <li> <p>\u6309\u4e13\u9898\u6d4f\u89c8\u6570\u636e\uff1a\u5217\u51fa\u4e00\u7cfb\u5217\u7ecf\u6d4e\u53d1\u5c55\u4e13\u9898\u3002\u9009\u62e9\u5176\u4e2d\u4e00\u4e2a\u4e13\u9898\uff0c\u6d4f\u89c8\u8be5\u4e13\u9898\u7684\u7b80\u8981\u4ecb\u7ecd\u3001\u4e0e\u4e4b\u76f8\u5173\u7684\u6307\u6807\u3001\u5730\u533a\u603b\u91cf\u548c\u4e3b\u8981\u6570\u636e\u7684\u89c6\u56fe\u3002</p> </li> <li> <p>\u6309\u6307\u6807\u6d4f\u89c8\u6570\u636e\uff1a\u4ece\u6240\u5217\u76ee\u5f55\u4e2d\u9009\u62e9\u4e00\u9879\u6307\u6807\uff0c\u6d4f\u89c8\u8be5\u6307\u6807\u7684\u8be6\u7ec6\u8bf4\u660e\u548c 200 \u591a\u4e2a\u56fd\u5bb6\u7684\u6307\u6807\u6570\u636e\u3002\u53ef\u4ee5\u5728\u8868\u683c\u6216\u5730\u56fe\u4e2d\u6d4f\u89c8\u6570\u636e\u6216\u4ee5\u591a\u79cd\u683c\u5f0f\u4e0b\u8f7d\uff0c\u8fd8\u53ef\u4ee5\u501f\u52a9\u641c\u7d22\u529f\u80fd\u83b7\u5f97\u6570\u636e\u3002</p> </li> <li> <p>\u6309\u6570\u636e\u76ee\u5f55\u6d4f\u89c8\u6570\u636e\uff1a\u6570\u636e\u76ee\u5f55\u6309\u7167\u4e13\u4e1a\u6570\u636e\u3001\u5730\u533a\u548c\u5168\u7403\u4e13\u9898\u7b49\u8fdb\u884c\u5206\u7c7b\u3002\u6bcf\u4e2a\u6761\u76ee\u5305\u62ec\u6570\u636e\u63cf\u8ff0\u3001\u8986\u76d6\u8303\u56f4\u3001\u66f4\u65b0\u5468\u671f\u3001\u6765\u6e90\u548c\u6570\u636e\u6ce8\u91ca\u3002</p> </li> </ul>"},{"location":"olap/01.OLAP%E6%A6%82%E8%BF%B0/#_10","title":"\u7ecf\u6d4e\u6570\u636e","text":"<p>The World Development Indicators (WDI) is the primary World Bank collection of development indicators, compiled from officially-recognized international sources. It presents the most current and accurate global development data available, and includes national, regional and global estimates.</p> <p>The World Development Indicators (WDI)\u6570\u636e\u5e93\u662f\u4e16\u754c\u94f6\u884c\uff08World Bank\uff09\u53d1\u5e03\u7684\u4e00\u5957\u5168\u7403\u6027\u5f00\u653e\u6570\u636e\u96c6\uff0c\u5b83\u5305\u542b\u4e86\u5404\u79cd\u56fd\u5bb6\u548c\u5730\u533a\u7684\u7ecf\u6d4e\u3001\u793e\u4f1a\u3001\u73af\u5883\u7b49\u65b9\u9762\u7684\u6570\u636e\u6307\u6807\u3002\u56fd\u5185\u5916\u4f17\u591a\u79d1\u7814\u4eba\u5458\u5229\u7528 WDI \u6570\u636e\u5e93\u6765\u8fdb\u884c\u8de8\u9886\u57df\u7684\u7814\u7a76\u548c\u5206\u6790\uff0c\u4e3a\u56fd\u5bb6\u7684\u53d1\u5c55\u3001\u653f\u7b56\u5236\u5b9a\u4ee5\u53ca\u53ef\u6301\u7eed\u53d1\u5c55\u505a\u51fa\u8d21\u732e\u3002\u4eca\u5929\u4e3a\u5927\u5bb6\u6574\u7406\u51fa WDI \u6570\u636e\u5e93\u8d85\u957f\u65f6\u95f4\u6bb5\u6570\u636e\uff0c\u4f9b\u8bfb\u8005\u8fdb\u884c\u79d1\u7814\u4f7f\u7528\u3002</p> <p>WDI \u6570\u636e\u5e93\u5305\u542b\u591a\u9886\u57df\u6307\u6807\uff0c\u5e7f\u6cdb\u8fd0\u7528\u4e8e\u5404\u4e2a\u79d1\u7814\u9886\u57df\u3002\u5df2\u6709\u7814\u7a76\u91c7\u53d6 WDI \u6570\u636e\u5e93\u8fdb\u884c\u7814\u7a76\u8868\u660e\uff0c\u6536\u5165\u5206\u914d\u7684\u5e93\u5179\u6d85\u8328\u5012 U \u66f2\u7ebf\u63ed\u793a\u4e86\u4eba\u7c7b\u793e\u4f1a\u73b0\u4ee3\u5316\u8fdb\u7a0b\u4e2d\u6536\u5165\u5206\u914d\u6f14\u53d8\u7684\u4e00\u822c\u8d8b\u52bf\uff0c\u53ea\u8981\u5728\u73b0\u4ee3\u5316\u8fdb\u7a0b\u4e2d\u7ee7\u7eed\u52a0\u5feb\u7ed3\u6784\u8f6c\u53d8\u548c\u5236\u5ea6\u5b8c\u5584\uff0c\u6536\u5165\u5dee\u8ddd\u6709\u671b\u9010\u6e10\u7f29\u5c0f\uff08\u90b5\u7ea2\u4f1f \u7b49\uff0c2016\uff09\u3002\u4e2d\u56fd\u957f\u671f\u7ecf\u6d4e\u589e\u957f\u7684\u5747\u8861\u7b49\u5f0f,\u53d1\u73b0\u7ecf\u6d4e\u6539\u9769\u548c\u4eba\u529b\u8d44\u672c\u5747\u5bf9\u4e2d\u56fd\u7ecf\u6d4e\u7684\u957f\u671f\u589e\u957f\u8d77\u7740\u663e\u8457\u7684\u79ef\u6781\u4f5c\u7528,\u800c\u4e14\u7279\u522b\u5730,\u7ecf\u6d4e\u6539\u9769\u7684\u4f5c\u7528\u66f4\u4e3a\u663e\u8457\u548c\u5f3a\u52b2\uff08\u7530\u8273\u5e73\uff0c2014\uff09\u3002\u7a0e\u5236\u7ed3\u6784\u4e0e\u6536\u5165\u4e0d\u5e73\u7b49\u663e\u8457\u76f8\u5173,\u5728\u63a7\u5236\u4e86\u5176\u4ed6\u56e0\u7d20\u4e4b\u540e\uff0c\u6d41\u8f6c\u7a0e\u5360\u8d22\u653f\u6536\u5165\u7684\u6bd4\u91cd\u8d8a\u9ad8,\u8be5\u56fd\u7684\u6536\u5165\u8d8a\u4e0d\u5e73\u7b49\uff0c\u5e76\u5c31\u6211\u56fd\u7a0e\u5236\u6539\u9769\u63d0\u51fa\u4e86\u76f8\u5173\u653f\u7b56\u5efa\u8bae\uff08\u5218\u534e \u7b49\uff0c2012\uff09\u3002\u74e6\u683c\u7eb3\u6cd5\u5219\u6210\u7acb\u7684\u4e3b\u8981\u539f\u56e0\u662f\u793e\u4f1a\u4fdd\u62a4\u652f\u51fa\u4e0e\u7ecf\u6d4e\u53d1\u5c55\u4e4b\u95f4\u7684\u6b63\u5411\u5173\u7cfb\uff08\u621a\u660c\u539a \u7b49\uff0c2020\uff09\u3002\u76f8\u5173\u6210\u679c\u53d1\u8868\u5728\u300a\u4e2d\u56fd\u5de5\u4e1a\u7ecf\u6d4e\u300b\u3001\u300a\u5b8f\u89c2\u7ecf\u6d4e\u7814\u7a76\u300b\u3001\u300a\u4e2d\u56fd\u8f6f\u79d1\u5b66\u300b\u3001\u300a\u7ecf\u6d4e\u7406\u8bba\u4e0e\u7ecf\u6d4e\u7ba1\u7406\u300b\u7b49\u9876\u520a\u4e0a\u3002</p> <p>\u9274\u4e8e\u6b64\uff0c\u4e3a\u5927\u5bb6\u6574\u7406\u53d1\u5e03\u4e86 1960-2022 \u5e74 WDI \u6570\u636e\u5e93\uff0c\u5185\u542b\u7ecf\u6d4e\u3001\u793e\u4f1a\u3001\u73af\u5883\u7b49\u6570\u636e\u6307\u6807\uff0c\u4f9b\u5927\u5bb6\u4f7f\u7528\u3002</p> <p>\u672c\u6587\u6570\u636e\u6765\u6e90\u4e3a\u4e16\u754c\u94f6\u884c\u516c\u5f00\u6570\u636e\u4e2d\u7684 GDP\uff08\u73b0\u4ef7\u7f8e\u5143\uff09\u548c\u4eba\u53e3\u603b\u6570\u3002\u4e3a\u4e86\u65b9\u4fbf\u4f7f\u7528\uff0c\u6211\u4eec\u5c06\u6570\u636e\u8f6c\u6362\u6210\u4e86 SQL \u811a\u672c\uff0c\u6458\u53d6\u4e86\u5168\u7403 217 \u4e2a\u56fd\u5bb6\u548c\u5730\u533a 2010-2018 \u5e74\u7684 GDP \u6570\u636e\uff08\u6309\u7167\u73b0\u4ef7\u7f8e\u5143\u8fdb\u884c\u6362\u7b97\uff09\u4ee5\u53ca\u76f8\u5e94\u7684\u4eba\u53e3\u6570\u636e\u3002</p> <pre><code>\"SL.UEM.TOTL\",          # \u5931\u4e1a\u4eba\u6570 Number of people unemployed\n\"SL.UEM.TOTL.ZS\",       # \u5931\u4e1a\u7387 Unemployed (%) (modeled ILO estimate)\n\"SL.UEM.TOTL.NE.ZS\",    # \u5931\u4e1a\u7387 Unemployed (%) national estimate\n\n\"NY.GDP.PCAP.KD.ZG\",    # \u4eba\u5747 GDP \u589e\u901f\n\"NY.GDP.MKTP.CD\",       # GDP\u603b\u91cf, GDP\uff08\u73b0\u4ef7\u7f8e\u5143\uff09\n\"NY.GDP.MKTP.KD.ZG\",    # GDP \u589e\u901f\n\n\"FP.CPI.TOTL\",          # \u6d88\u8d39\u4ef7\u683c\u6307\u6570\uff08\u4ee5 2010 \u5e74\u4e3a\u5bf9\u6bd4\u57fa\u6570 100\uff09\n\"FP.CPI.TOTL.ZG\",       # \u901a\u8d27\u81a8\u80c0\u7387\n\"SI.POV.GINI\",          # Gini \u6307\u6570\n\n\"SP.DYN.LE00.IN\",       # \u9884\u671f\u5bff\u547d\n\"NY.GDP.PCAP.CD\",       # \u4eba\u5747 GDP\n\"SP.POP.TOTL\"           # \u4eba\u53e3\u603b\u6570\n</code></pre> <p>gdpdata.sql</p> <pre><code>su - postgres\ncd /data/postgres/14.4/bin/\npsql  -h localhost -p 54321 -U postgres -w password -d postgres\n\n# \u5bfc\u5165\u6570\u636e\n\\i /data/PGAdvanceSQL/src/main/source/gdpdata.sql\n\n\npostgres=# \\dt\n            List of relations\n Schema |          Name          | Type  |  Owner\n--------+------------------------+-------+----------\n public | country_gdp_year       | table | postgres\n public | country_gdp_year_final | table | postgres\n public | metadata_country       | table | postgres\n\n# \u4f5c\u8005\u7684\u4e00\u4e9b\u539f\u59cb\u6570\u636e\u4e2d\uff0c\u6709\u4e9bGDP\u4e3a0\u53ef\u80fd\u4e0d\u51c6\u3002\u6ce8\u610f\u7504\u522b\n\n# country_gdp_year(\u56fd\u5bb6\u540d\u79f0\uff0c\u56fd\u5bb6\u4ee3\u7801\uff0c\u6307\u6807\u540d\u79f0\uff0c\u6307\u6807\u4ee3\u7801\uff0c\u5e74\u4efd\uff0cGPD\u6570\u503c)\npostgres=# select * from country_gdp_year limit 3;\n country_name | country_code | indicator_name  | indicator_code | year | gdp\n--------------+--------------+-----------------+----------------+------+-----\n \u963f\u9c81\u5df4       | ABW          | GDP\uff08\u73b0\u4ef7\u7f8e\u5143\uff09 | NY.GDP.MKTP.CD | 1960 |   0\n \u963f\u9c81\u5df4       | ABW          | GDP\uff08\u73b0\u4ef7\u7f8e\u5143\uff09 | NY.GDP.MKTP.CD | 1961 |   0\n \u963f\u9c81\u5df4       | ABW          | GDP\uff08\u73b0\u4ef7\u7f8e\u5143\uff09 | NY.GDP.MKTP.CD | 1962 |   0\npostgres=#\n\n# country_gdp_year_final(\u56fd\u5bb6\u4ee3\u7801\uff0c\u56fd\u5bb6\u540d\u79f0\uff0c\u6536\u5165\u5206\u7c7b\uff0c\u6240\u5c5e\u5730\u533a\uff0c\u5e74\u4efd\uff0cGDP\u503c)\npostgres=# select * from country_gdp_year_final limit 3;\n country_code | country_name | income_group |   region   | year |       gdp\n--------------+--------------+--------------+------------+------+------------------\n AFG          | \u963f\u5bcc\u6c57       | Low income   | South Asia | 2018 |                0\n AFG          | \u963f\u5bcc\u6c57       | Low income   | South Asia | 2017 | 19543976895.4248\n AFG          | \u963f\u5bcc\u6c57       | Low income   | South Asia | 2016 | 19046357714.4928\n\n# metadata_country(\u56fd\u5bb6\u4ee3\u7801\uff0c\u5730\u533a\uff0c\u6536\u5165\u5206\u7c7b)\npostgres=# select * from metadata_country  limit 3;\n country_code |        region         |    income_group\n--------------+-----------------------+---------------------\n AFG          | South Asia            | Low income\n AGO          | Sub-Saharan Africa    | Lower middle income\n ALB          | Europe &amp; Central Asia | Upper middle income\n(3 rows)\n\npostgres=#\n</code></pre> <pre><code>-- \u4e16\u754c\u5404\u4e2a\u5927\u6d32(\u533a\u57df)2017\u5e74\u7684GDP\u5e73\u5747\u503c\uff1a\u5bf9\u4e8e2017\u5e74\u7684GPD\uff0c\u6309\u6d32\u5206\u7ec4\uff0c\u6c42\u5404\u6d32\u5e73\u5747\u503c\n-- 2017\u5e74\u4e16\u754cGDP\u5747\u503c\u6700\u9ad8\u5730\u533a\u662f\uff1a\u5317\u7f8e\u6d32\uff0cGDP\u6700\u4f4e\u5730\u533a\u662f\uff1a\u6492\u54c8\u62c9\u4ee5\u5357\u975e\u6d32\nSELECT\n    region,\n    round(AVG(gdp),0)\nFROM\n    country_gdp_year_final\nWHERE\n    YEAR = '2017'\nGROUP BY\n    region\nORDER BY\n    2 DESC;\n\n-- \u5982\u679c\u6211\u4eec\u60f3\u8981\u4e0a\u9762\u7684\u62a5\u8868\u5e26\u6709\u5168\u4e16\u754c\u5404\u56fdGDP\u5e73\u5747\u503c\uff0c\u4e0b\u9762\u8fd9\u79cdSQL\u5176\u5b9e\u5d4c\u5957\u4e86\u8fd9\u4e48\u591a\u5c42\uff0c\u5f88\u957f\u5e76\u4e14\u53ef\u8bfb\u6027\u5f88\u5dee\n(SELECT region, round(AVG(gdp),0) FROM country_gdp_year_final WHERE  YEAR = '2017' GROUP BY  region ORDER BY 2 DESC)\n\nUNION ALL\n\nSELECT NULL AS\n    region,\n    sumCount\nFROM ( SELECT round(SUM(gdp)/COUNT(1),0) AS sumCount FROM country_gdp_year_final WHERE YEAR = '2017') p;\n\n\n-- \u8fd9\u79cdSQL\u5176\u5b9e\u5d4c\u5957\u4e86\u8fd9\u4e48\u591a\u5c42\uff0c\u5f88\u957f\u5e76\u4e14\u53ef\u8bfb\u6027\u5f88\u5dee\uff0c\u5176\u5b9ePG\u91cc\u9762\u81ea\u5e26\u8fd9\u79cd\u5206\u7ec4\u5e76\u4e14\u5e26\u6709\u5206\u7ec4\u5e73\u5747\u503c\u7684SQL\nSELECT\n    region,\n    round( AVG ( gdp ), 0 ) AS sumCount\nFROM\n    country_gdp_year_final\nWHERE\n    YEAR = '2017'\nGROUP BY\n    ROLLUP ( region )\nORDER BY\n    2 DESC;\n\n-- group by rollup(column) \u9664\u4e86\u8ba1\u7b97column\u5b57\u6bb5\u5206\u7ec4\u4e0b\u7684\u805a\u5408\u7ed3\u679c\u4ee5\u5916\uff0c\u8fd8\u4f1a\u8ba1\u7b97\u6574\u4f53\u7684\u805a\u5408\u7ed3\u679c\u3002\u672c\u4f8b\u5c31\u662f\u8ba1\u7b97\u4e16\u754c2017\u5e74GDP\u6240\u6709\u56fd\u5e73\u5747\u503c(\u8fd9\u4e9b\u56fd\u5bb6\u6709\u7740\u4e00\u4e2a\u5171\u540c\u7684region\u53eb\u505a\uff1a\u4e16\u754c)\uff0c\u65e0\u9700\u8fd0\u884c\u4fe9\u4e2a\u67e5\u8be2\n\n-- GROUP BY \u5b50\u53e5\u52a0\u4e0a ROLLUP \u9009\u9879\u65f6\uff0c\u9996\u5148\u6309\u7167\u5206\u7ec4\u5b57\u6bb5\u8fdb\u884c\u5206\u7ec4\u6c47\u603b\u3002\u7136\u540e\u4ece\u53f3\u81f3\u5de6\u4f9d\u6b21\u53bb\u6389\u4e00\u4e2a\u5206\u7ec4\u5b57\u6bb5\u518d\u8fdb\u884c\u5206\u7ec4\u6c47\u603b\uff0c\u88ab\u53bb\u6389\u7684\u5b57\u6bb5\u663e\u793a\u4e3a\u7a7a\uff1b\n-- \u6700\u540e\uff0c\u5c06\u6240\u6709\u7684\u6570\u636e\u8fdb\u884c\u4e00\u6b21\u6c47\u603b\uff0c\u6240\u6709\u7684\u5206\u7ec4\u5b57\u6bb5\u90fd\u663e\u793a\u4e3a\u7a7a\u3002\n\n\n-- rollup\u4e5f\u53ef\u4ee5\u901a\u8fc7\u4e0d\u6b62\u4e00\u5217\u7684\u65b9\u5f0f\u6765\u4f7f\u7528\uff0c\u6bd4\u5982\u8ba1\u7b97\u4e2d\u65e5\u5fb7\u6cd5\u7f8e\u516d\u56fd\u76841960-2018\u5e74\u5e74\u5747GDP\n</code></pre>"},{"location":"olap/01.OLAP%E6%A6%82%E8%BF%B0/#_11","title":"\u6570\u4ed3\u5efa\u6a21","text":"<p>\u73b0\u5728\u8bb8\u591a\u6570\u636e\u5e93\u4f9b\u5e94\u5546\u90fd\u53ea\u662f\u91cd\u70b9\u652f\u6301\u4e8b\u52a1\u5904\u7406\u8d1f\u8f7d\u548c\u5206\u6790\u5de5\u4f5c\u8d1f\u8f7d\u8fd9\u4e24\u8005\u4e2d\u7684\u4e00\u4e2a\uff0c\u800c\u4e0d\u662f\u90fd\u652f\u6301\u3002\u6570\u636e\u4ed3\u5e93\u672c\u8d28\u662f\u4ece\u6570\u636e\u5e93\u884d\u751f\u51fa\u6765\u7684\uff0c\u6240\u4ee5\u6570\u636e\u4ed3\u5e93\u7684\u5efa\u6a21\u4e5f\u662f\u4e0d\u65ad\u884d\u751f\u53d1\u5c55\u7684\u3002</p> <p>\u4ece\u6700\u65e9\u7684\u501f\u9274\u6570\u636e\u5e93\u7684\u8303\u5f0f\u5efa\u6a21\uff0c\u5230\u9010\u6e10\u63d0\u51fa\u7ef4\u5ea6\u5efa\u6a21\uff0cData Vault \u6a21\u578b\uff0cAnchor \u6a21\u578b\u7b49\u7b49\uff0c\u8d8a\u5f80\u540e\u5efa\u6a21\u7684\u8981\u6c42\u8d8a\u9ad8\u3002</p> <p>\u4f46\u662f\u5bf9\u4e8e\u6570\u636e\u4ed3\u5e93\u6765\u8bf4\uff0c\u76ee\u524d\u4e3b\u6d41\u8fd8\u662f\u7ef4\u5ea6\u5efa\u6a21\uff0c\u4f1a\u5939\u6742\u7740\u8303\u5f0f\u5efa\u6a21\u3002</p> <p>\u6570\u636e\u5efa\u6a21</p> <p>\u6570\u636e\u6a21\u578b</p> <p>\u8fdb\u884c\u5168\u9762\u7684\u4e1a\u52a1\u68b3\u7406\u65f6\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u4e1a\u52a1\u6a21\u578b\uff0c\u5168\u9762\u4e86\u89e3\u4e1a\u52a1\u7ed3\u6784\u53ca\u8fd0\u884c\u60c5\u51b5\uff0c\u6309\u7167\u4e1a\u52a1\u7279\u5b9a\u7684\u89c4\u5f8b\u5206\u95e8\u522b\u7c7b\u548c\u7a0b\u5e8f\u5316\uff0c\u6539\u8fdb\u4e1a\u52a1\u7684\u6d41\u7a0b\u3002</p> <p>\u901a\u8fc7\u6a21\u578b\u7684\u5efa\u8bbe\uff0c\u6211\u4eec\u53ef\u4ee5\u5f88\u6e05\u6670\u7684\u770b\u5230\u6570\u636e\u4e4b\u95f4\u5185\u5728\u7684\u5173\u8054\u5173\u7cfb\uff0c\u4ece\u800c\u5efa\u7acb\u8d77\u5168\u65b9\u4f4d\u7684\u6570\u636e\u89c6\u89d2\uff0c\u5e76\u6d88\u706d\u4fe1\u606f\u5b64\u5c9b\u548c\u6570\u636e\u5dee\u5f02\u5316\u7684\u95ee\u9898\uff0c\u8fdb\u800c\u4fdd\u8bc1\u6570\u636e\u7684\u4e00\u81f4\u6027\u3002</p> <p>\u6a21\u578b\u53ef\u4ee5\u5f88\u597d\u7684\u5e2e\u52a9\u6211\u4eec\u5206\u79bb\u51fa\u5e95\u5c42\u6280\u672f\u7684\u5b9e\u73b0\u548c\u4e0a\u5c42\u4e1a\u52a1\u7684\u5c55\u73b0\uff0c\u5f53\u4e0a\u5c42\u4e1a\u52a1\u53d1\u751f\u53d8\u5316\u65f6\uff0c\u901a\u8fc7\u6570\u636e\u6a21\u578b\uff0c\u5e95\u5c42\u7684\u6280\u672f\u5b9e\u73b0\u53ef\u4ee5\u9002\u5e94\u7684\u4e86**\u4e1a\u52a1\u7684\u53d8\u52a8**\uff0c\u8fdb\u800c\u89e3\u51b3\u6570\u636e\u5e93\u7684\u7075\u6d3b\u6027\u3002</p> <p>\u5728\u6a21\u578b\u4e2d\u53ef\u4ee5\u5f88\u597d\u7684\u770b\u51fa\u5f00\u53d1\u4eba\u5458\u548c\u4e1a\u52a1\u4eba\u5458\u4e4b\u95f4\u7684**\u7cfb\u7edf\u5efa\u8bbe\u8303\u56f4**\u7684\u754c\u5b9a\uff0c\u53ca\u672a\u6765\u7684\u89c4\u5212\u3002</p> <p>\u6570\u636e\u5efa\u6a21\u8fc7\u7a0b</p> <ul> <li> <p>\u4e1a\u52a1\u6a21\u578b\uff1a\u4e1a\u52a1\u5206\u89e3\u548c\u7a0b\u5e8f\u5316\uff0c\u786e\u5b9a\u597d\u4e1a\u52a1\u7684\u8fb9\u754c\u53ca\u4e1a\u52a1\u6d41\u7a0b\uff0c\u5982\u8ba2\u5355\u3001\u652f\u4ed8\u90fd\u662f\u4e00\u4e2a\u5355\u72ec\u7684\u4e1a\u52a1\u6a21\u5757</p> </li> <li> <p>\u9886\u57df\u6a21\u578b\uff1a\u4e1a\u52a1\u6982\u5ff5\u7684\u62bd\u8c61\u3001\u5206\u7ec4\uff0c\u6574\u7406\u5206\u7ec4\u4e4b\u95f4\u7684\u5173\u8054\uff0c\u6bd4\u5982\u7528\u6237\u8d2d\u7269\u7684\u4e1a\u52a1\uff0c\u62bd\u6210\u4e00\u4e2a\u66f4\u5927\u7684\u6a21\u578b\uff0c\u8fd9\u4e2a\u6a21\u578b\u4e00\u822c\u76f8\u5bf9\u4e8e\u884c\u4e1a\u3002</p> </li> <li> <p>\u8f91\u5efa\u6a21\uff1a\u9886\u57df\u6a21\u578b\u4e2d\u7684\u4e1a\u52a1\u6982\u5ff5\u5b9e\u4f53\u5316\uff0c\u5e76\u8003\u8651\u5b9e\u4f53\u7684\u5177\u4f53\u5c5e\u6027\u53ca\u5b9e\u4f53\u4e0e\u5b9e\u4f53\u4e4b\u95f4\u7684\u5173\u7cfb\uff0c\u6bd4\u5982\u8ba2\u5355\uff08\u8ba2\u5355\u53f7\u3001\u4ed8\u6b3e\u4eba\u2026\uff09\u548c\u652f\u4ed8\uff08\u91d1\u989d\u3001\u652f\u4ed8\u65f6\u95f4\u2026\uff09\u7684\u5173\u7cfb\u3002</p> </li> <li> <p>\u7269\u7406\u6a21\u578b\uff1a\u89e3\u51b3\u5b9e\u9645\u5e94\u7528\u7684\u843d\u5730\u5f00\u53d1\u3001\u4e0a\u7ebf\u7b49\u95ee\u9898\uff0c\u53ca\u6027\u80fd\u7b49\u4e00\u4e9b\u5177\u4f53\u7684\u6280\u672f\u95ee\u9898\u3002</p> </li> </ul> <p>\u5728\u6570\u636e\u4ed3\u5e93\u9886\u57df\uff0c\u6709\u4e24\u4f4d\u5927\u5e08\uff0c\u4e00\u4f4d\u662f\u201c\u6570\u636e\u4ed3\u5e93\u201d\u4e4b\u7236 Bill Inmon\uff0c\u4e00\u4f4d\u662f\u6570\u636e\u4ed3\u5e93\u6743\u5a01\u4e13\u5bb6 Ralph Kimball\uff0c\u4e24\u4f4d\u5927\u5e08\u6bcf\u4eba\u90fd\u6709\u4e00\u672c\u7ecf\u5178\u8457\u4f5c\u3002</p> <p>Inmon \u5927\u5e08\u8457\u4f5c\u300a\u6570\u636e\u4ed3\u5e93\u300b\u53ca Kimball \u5927\u5e08\u7684\u300a\u6570\u4ed3\u5de5\u5177\u7bb1\u300b\uff0c\u4e24\u672c\u4e66\u4e5f\u4ee3\u8868\u4e86\u4e24\u79cd\u4e0d\u540c\u7684\u6570\u4ed3\u5efa\u8bbe\u6a21\u5f0f\uff0c\u8fd9\u4e24\u79cd\u67b6\u6784\u6a21\u5f0f\u652f\u6491\u4e86\u6570\u636e\u4ed3\u5e93\u4ee5\u53ca\u5546\u4e1a\u667a\u80fd\u8fd1\u4e8c\u5341\u5e74\u7684\u53d1\u5c55\u3002</p> <p>\u903b\u8f91\u5efa\u6a21</p>"},{"location":"olap/01.OLAP%E6%A6%82%E8%BF%B0/#_12","title":"\u8303\u5f0f\u5efa\u6a21","text":"<p>\u8303\u5f0f\u5efa\u6a21\u662f\u6570\u4ed3\u4e4b\u7236 Inmon \u6240\u5021\u5bfc\u7684\uff0c\"\u6570\u636e\u4ed3\u5e93\"\u8fd9\u4e2a\u8bcd\u5c31\u662f\u8fd9\u4f4d\u5927\u5e08\u6240\u5b9a\u4e49\u7684\uff0c\u4e3b\u8981\u89e3\u51b3\u5173\u7cfb\u578b\u6570\u636e\u5e93\u7684\u6570\u636e\u5b58\u50a8\uff0c\u5229\u7528\u7684\u4e00\u79cd\u6280\u672f\u5c42\u9762\u4e0a\u7684\u65b9\u6cd5\u3002\u76ee\u524d\uff0c\u6211\u4eec\u5728\u5173\u7cfb\u578b\u6570\u636e\u5e93\u4e2d\u7684\u5efa\u6a21\u65b9\u6cd5\uff0c\u5927\u90e8\u5206\u91c7\u7528\u7684\u662f\u4e09\u8303\u5f0f\u5efa\u6a21\u6cd5\u3002</p> <p>\u8fd9\u79cd\u5efa\u6a21\u65b9\u5f0f\u5728\u8303\u5f0f\u7406\u8bba\u4e0a\u7b26\u5408 3NF\uff0c\u8fd9\u91cc\u7684 3NF \u4e0e OLTP \u4e2d\u7684 3NF \u8fd8\u662f\u6709\u70b9\u533a\u522b\u7684\uff1a</p> <p>\u5173\u7cfb\u6570\u636e\u5e93\u4e2d\u7684<code>3NF</code>\u662f\u9488\u5bf9\u5177\u4f53\u7684\u4e1a\u52a1\u6d41\u7a0b\u7684\u5b9e\u4f53\u5bf9\u8c61\u5173\u7cfb\u62bd\u8c61\uff0c\u800c\u6570\u636e\u4ed3\u5e93\u7684<code>3NF</code>\u662f\u7ad9\u5728\u4f01\u4e1a\u89d2\u5ea6\u9762\u5411\u4e3b\u9898\u7684\u62bd\u8c61\u3002</p> <p>\u6839\u636e Inmon \u7684\u89c2\u70b9\uff0c\u6570\u636e\u4ed3\u5e93\u6a21\u578b\u7684\u5efa\u8bbe\u65b9\u6cd5\u548c\u4e1a\u52a1\u7cfb\u7edf\u7684\u4f01\u4e1a\u6570\u636e\u6a21\u578b\u7c7b\u4f3c\u3002</p> <p>\u5728\u4e1a\u52a1\u7cfb\u7edf\u4e2d\uff0c\u4f01\u4e1a\u6570\u636e\u6a21\u578b\u51b3\u5b9a\u4e86\u6570\u636e\u7684\u6765\u6e90\uff0c\u800c\u4f01\u4e1a\u6570\u636e\u6a21\u578b\u4e5f\u5206\u4e3a\u4e24\u4e2a\u5c42\u6b21\uff0c\u5373\u4e3b\u9898\u57df\u6a21\u578b\u548c\u903b\u8f91\u6a21\u578b\u3002</p> <p>\u540c\u6837\uff0c\u4e3b\u9898\u57df\u6a21\u578b\u53ef\u4ee5\u770b\u6210\u662f\u4e1a\u52a1\u6a21\u578b\u7684\u6982\u5ff5\u6a21\u578b\uff0c\u800c\u903b\u8f91\u6a21\u578b\u5219\u662f\u57df\u6a21\u578b\u5728\u5173\u7cfb\u578b\u6570\u636e\u5e93\u4e0a\u7684\u5b9e\u4f8b\u5316\u3002</p> <p>Inmon \u6a21\u578b\u4ece\u6d41\u7a0b\u4e0a\u770b\u662f\u81ea\u4e0a\u800c\u4e0b\u7684\uff0c\u81ea\u4e0a\u800c\u4e0b\u6307\u7684\u662f\u6570\u636e\u7684\u6d41\u5411\uff0c\u201c\u4e0a\u201d\u5373\u6570\u636e\u7684\u4e0a\u6e38\uff0c\u201c\u4e0b\u201d\u5373\u6570\u636e\u7684\u4e0b\u6e38\uff0c\u5373\u4ece\u5206\u6563\u5f02\u6784\u7684\u6570\u636e\u6e90 -&gt; \u6570\u636e\u4ed3\u5e93 -&gt; \u6570\u636e\u96c6\u5e02\u3002</p> <p>\u4ee5\u6570\u636e\u6e90\u5934\u4e3a\u5bfc\u5411\uff0c\u7136\u540e\u4e00\u6b65\u6b65\u63a2\u7d22\u83b7\u53d6\u5c3d\u91cf\u7b26\u5408\u9884\u671f\u7684\u6570\u636e\uff0c\u56e0\u4e3a\u6570\u636e\u6e90\u5f80\u5f80\u662f\u5f02\u6784\u7684\uff0c\u6240\u4ee5\u4f1a\u66f4\u52a0\u5f3a\u8c03\u6570\u636e\u7684\u6e05\u6d17\u5de5\u4f5c\uff0c\u5c06\u6570\u636e\u62bd\u53d6\u4e3a\u5b9e\u4f53-\u5173\u7cfb\u6a21\u578b\uff0c\u5e76\u4e0d\u5f3a\u8c03\u4e8b\u5b9e\u8868\u548c\u7ef4\u5ea6\u8868\u7684\u6982\u5ff5\u3002</p>"},{"location":"olap/01.OLAP%E6%A6%82%E8%BF%B0/#_13","title":"\u7ef4\u5ea6\u5efa\u6a21","text":"<p>Kimball \u6a21\u578b\u4ece\u6d41\u7a0b\u4e0a\u770b\u662f\u81ea\u4e0b\u800c\u4e0a\u7684\uff0c\u5373\u4ece\u6570\u636e\u96c6\u5e02-&gt; \u6570\u636e\u4ed3\u5e93 -&gt; \u5206\u6563\u5f02\u6784\u7684\u6570\u636e\u6e90\u3002Kimball \u662f\u4ee5\u6700\u7ec8\u4efb\u52a1\u4e3a\u5bfc\u5411\uff0c\u5c06\u6570\u636e\u6309\u7167\u76ee\u6807\u62c6\u5206\u51fa\u4e0d\u540c\u7684\u8868\u9700\u6c42\uff0c\u6570\u636e\u4f1a\u62bd\u53d6\u4e3a\u4e8b\u5b9e-\u7ef4\u5ea6\u6a21\u578b\u3002</p> <p>\u6570\u636e\u6e90\u7ecf ETL \u8f6c\u5316\u4e3a\u4e8b\u5b9e\u8868\u548c\u7ef4\u5ea6\u8868\u5bfc\u5165\u6570\u636e\u96c6\u5e02\uff0c\u4ee5\u661f\u578b\u6a21\u578b\u6216\u96ea\u82b1\u6a21\u578b\u7b49\u65b9\u5f0f\u6784\u5efa\u7ef4\u5ea6\u6570\u636e\u4ed3\u5e93\uff0c\u67b6\u6784\u4f53\u7cfb\u4e2d\uff0c\u6570\u636e\u96c6\u5e02\u4e0e\u6570\u636e\u4ed3\u5e93\u662f\u7d27\u5bc6\u7ed3\u5408\u7684\uff0c\u6570\u636e\u96c6\u5e02\u662f\u6570\u636e\u4ed3\u5e93\u4e2d\u4e00\u4e2a\u903b\u8f91\u4e0a\u7684\u4e3b\u9898\u57df\u3002</p> <p>\u7ef4\u5ea6\u5efa\u6a21\u662f\u4e13\u95e8\u5e94\u7528\u4e8e\u5206\u6790\u578b\u6570\u636e\u5e93\u3001\u6570\u636e\u4ed3\u5e93\u3001\u6570\u636e\u96c6\u5e02\u5efa\u6a21\u7684\u65b9\u6cd5\u3002\u6570\u636e\u96c6\u5e02\u53ef\u4ee5\u7406\u89e3\u4e3a\u662f\u4e00\u79cd\"\u5c0f\u578b\u6570\u636e\u4ed3\u5e93\"\u3002</p>"},{"location":"olap/01.OLAP%E6%A6%82%E8%BF%B0/#_14","title":"\u661f\u578b\u6a21\u578b","text":"<p>\u6839\u636e\u5e94\u7528\u7a0b\u5e8f\u7684\u9700\u8981\uff0c\u5728\u4e8b\u52a1\u5904\u7406\u9886\u57df\u4e2d\u4f7f\u7528\u4e86\u5927\u91cf\u4e0d\u540c\u7684\u6570\u636e\u6a21\u578b\u3002\u53e6\u4e00\u65b9\u9762\uff0c\u5728\u5206\u6790\u578b\u4e1a\u52a1\u4e2d\uff0c\u6570\u636e\u6a21\u578b\u7684\u591a\u6837\u6027\u5219\u5c11\u5f97\u591a\u3002\u8bb8\u591a\u6570\u636e\u4ed3\u5e93\u90fd\u4ee5\u76f8\u5f53\u516c\u5f0f\u5316\u7684\u65b9\u5f0f\u4f7f\u7528\uff0c\u88ab\u79f0\u4e3a\u661f\u578b\u6a21\u5f0f \u201c\u661f\u578b\u6a21\u5f0f\u201d \u8fd9\u4e2a\u540d\u5b57\u6765\u6e90\u4e8e\u8fd9\u6837\u4e00\u4e2a\u4e8b\u5b9e\uff0c\u5373\u5f53\u6211\u4eec\u5bf9\u8868\u4e4b\u95f4\u7684\u5173\u7cfb\u8fdb\u884c\u53ef\u89c6\u5316\u65f6\uff0c\u4e8b\u5b9e\u8868\u5728\u4e2d\u95f4\uff0c\u88ab\u7ef4\u5ea6\u8868\u5305\u56f4\uff1b\u4e0e\u8fd9\u4e9b\u8868\u7684\u8fde\u63a5\u5c31\u50cf\u661f\u661f\u7684\u5149\u8292\u3002</p>"},{"location":"olap/01.OLAP%E6%A6%82%E8%BF%B0/#_15","title":"\u96ea\u82b1\u6a21\u578b","text":"<p>\u8fd9\u4e2a\u6a21\u677f\u7684\u53d8\u4f53\u88ab\u79f0\u4e3a\u96ea\u82b1\u6a21\u5f0f\uff0c\u5176\u4e2d\u7ef4\u5ea6\u88ab\u8fdb\u4e00\u6b65\u5206\u89e3\u4e3a\u5b50\u7ef4\u5ea6\u3002\u4f8b\u5982\uff0c\u54c1\u724c\u548c\u4ea7\u54c1\u7c7b\u522b\u53ef\u80fd\u6709\u5355\u72ec\u7684\u8868\u683c\uff0c\u5e76\u4e14 dim_product \u8868\u683c\u4e2d\u7684\u6bcf\u4e00\u884c\u90fd\u53ef\u4ee5\u5c06\u54c1\u724c\u548c\u7c7b\u522b\u4f5c\u4e3a\u5916\u952e\u5f15\u7528\uff0c\u800c\u4e0d\u662f\u5c06\u5b83\u4eec\u4f5c\u4e3a\u5b57\u7b26\u4e32\u5b58\u50a8\u5728 dim_product \u8868\u683c\u4e2d\u3002\u96ea\u82b1\u6a21\u5f0f\u6bd4\u661f\u5f62\u6a21\u5f0f\u66f4\u89c4\u8303\u5316\uff0c\u4f46\u662f\u661f\u5f62\u6a21\u5f0f\u901a\u5e38\u662f\u9996\u9009\uff0c\u56e0\u4e3a\u5206\u6790\u5e08\u4f7f\u7528\u5b83\u66f4\u7b80\u5355\u3002</p> <p>\u5728\u5178\u578b\u7684\u6570\u636e\u4ed3\u5e93\u4e2d\uff0c\u8868\u683c\u901a\u5e38\u975e\u5e38\u5bbd\uff1a\u4e8b\u5b9e\u8868\u901a\u5e38\u6709 100 \u5217\u4ee5\u4e0a\uff0c\u6709\u65f6\u751a\u81f3\u6709\u6570\u767e\u5217\u3002\u7ef4\u5ea6\u8868\u4e5f\u53ef\u4ee5\u662f\u975e\u5e38\u5bbd\u7684\uff0c\u56e0\u4e3a\u5b83\u4eec\u5305\u62ec\u4e86\u6240\u6709\u53ef\u80fd\u4e0e\u5206\u6790\u76f8\u5173\u7684\u5143\u6570\u636e \u2014\u2014 \u4f8b\u5982\uff0cdim_store \u8868\u53ef\u4ee5\u5305\u62ec\u5728\u6bcf\u4e2a\u5546\u5e97\u63d0\u4f9b\u54ea\u4e9b\u670d\u52a1\u7684\u7ec6\u8282\uff0c\u5b83\u662f\u5426\u5177\u6709\u5e97\u5185\u9762\u5305\u623f\uff0c\u5e97\u9762\u9762\u79ef\uff0c\u5546\u5e97\u7b2c\u4e00\u6b21\u5f00\u5f20\u7684\u65e5\u671f\uff0c\u6700\u8fd1\u4e00\u6b21\u6539\u9020\u7684\u65f6\u95f4\uff0c\u79bb\u6700\u8fd1\u7684\u9ad8\u901f\u516c\u8def\u7684\u8ddd\u79bb\u7b49\u7b49\u3002</p> <p>\u7ef4\u5ea6\u548c\u6307\u6807\uff08\u5ea6\u91cf\uff09</p> <p>\u7ef4\u5ea6\u548c\u6307\u6807\u662f\u6570\u636e\u5206\u6790\u9886\u57df\u5e38\u7528\u7684\u6982\u5ff5\uff0c\u4ea6\u662f\u5728\u8bbe\u8ba1\u6570\u636e\u4ed3\u5e93\u8fc7\u7a0b\u4e2d\u9700\u8981\u8003\u8651\u7684\u3002 \u7ef4\u5ea6\u5c31\u662f\u6570\u636e\u7684\u89c2\u5bdf\u89d2\u5ea6\uff0c\u5373\u4ece\u54ea\u4e2a\u89d2\u5ea6\u53bb\u5206\u6790\u95ee\u9898\uff0c\u770b\u5f85\u95ee\u9898\u3002</p> <p>\u6307\u6807\uff0c\u5373\u5ea6\u91cf\uff0c\u5c31\u662f\u4ece\u7ef4\u5ea6\u7684\u57fa\u7840\u4e0a\u53bb\u8861\u7b97\u8fd9\u4e2a\u7ed3\u679c\u7684\u503c\u3002</p> <p>\u7ef4\u5ea6\u4e00\u822c\u662f\u4e00\u4e2a\u79bb\u6563\u7684\u503c\uff0c\u6bd4\u5982\u65f6\u95f4\u7ef4\u5ea6\u4e0a\u6bcf\u4e00\u4e2a\u72ec\u7acb\u7684\u65e5\u671f\u6216\u5730\u57df\uff0c\u56e0\u6b64\u7edf\u8ba1\u65f6\uff0c\u53ef\u4ee5\u628a\u7ef4\u5ea6\u76f8\u540c\u8bb0\u5f55\u7684\u805a\u5408\u5728\u4e00\u8d77\uff0c\u5e94\u7528\u805a\u5408\u51fd\u6570\u505a\u7d2f\u52a0\u3001\u5747\u503c\u3001\u6700\u5927\u503c\u3001\u6700\u5c0f\u503c\u7b49\u805a\u5408\u8ba1\u7b97\u3002</p> <p>\u6307\u6807\u5c31\u662f\u88ab\u805a\u5408\u7684\u901a\u8ba1\u7b97\uff0c\u5373\u805a\u5408\u8fd0\u7b97\u7684\u7ed3\u679c\uff0c\u4e00\u822c\u662f\u4e00\u4e2a\u8fde\u7eed\u7684\u503c\u3002 \u6bd4\u5982\u6211\u4eec\u53ef\u4ee5\u4ece\u94f6\u884c\u7684\u5b58\u6b3e\u989d\u548c\u4f01\u4e1a\u7684\u8d37\u6b3e\u989d\u4e4b\u95f4\u7684\u8ba1\u7b97\uff0c\u63a8\u7b97\u51fa\u76ee\u524d\u7684\u5e02\u573a\u72b6\u51b5\u662f\u5982\u4f55\uff0c\u5982\u679c\u4f01\u4e1a\u7684\u8d37\u6b3e\u989d\u9ad8\uff0c\u94f6\u884c\u7684\u5b58\u6b3e\u989d\u4e5f\u9ad8\uff0c\u8bf4\u660e\u4eba\u4eec\u4e0d\u613f\u610f\u6d88\u8d39\u4e86\uff0c\u90fd\u628a\u94b1\u5b58\u8d77\u6765\uff0c\u4f01\u4e1a\u4ea7\u54c1\u5356\u4e0d\u51fa\u53bb\uff0c\u8981\u53d1\u5de5\u8d44\uff0c\u90a3\u4e48\u81ea\u7136\u8981\u8d37\u6b3e\u4e86\uff0c\u8fd9\u53ea\u662f\u4e00\u4e2a\u4f8b\u5b50\uff0c\u5177\u4f53\u8fd8\u9700\u8981\u7ed3\u5408\u5f88\u591a\u6570\u636e\u505a\u5206\u6790\u3002</p> <p>\u4e8b\u5b9e\u8868\u548c\u7ef4\u5ea6\u8868</p> <p>\u4e8b\u5b9e\u8868\u548c\u7ef4\u5ea6\u8868\u662f\u5728\u8bbe\u8ba1\u6570\u636e\u4ed3\u5e93\u8fc7\u7a0b\u4e2d\u9700\u8981\u8003\u8651\u7684\u3002</p> <p>\u4e8b\u5b9e\u8868\u662f\u6307\u5b58\u50a8\u6709\u4e8b\u5b9e\u8bb0\u5f55\u7684\u8868\uff0c\u5982\u7cfb\u7edf\u7684\u65e5\u5fd7\u3001\u9500\u552e\u8bb0\u5f55\u3001\u7528\u6237\u8bbf\u95ee\u65e5\u5fd7\u7b49\u4fe1\u606f\uff0c\u4e8b\u5b9e\u8868\u7684\u8bb0\u5f55\u662f\u52a8\u6001\u7684\u589e\u957f\u7684\uff0c\u6240\u4ee5\u4f53\u79ef\u662f\u5927\u4e8e\u7ef4\u5ea6\u8868\u3002 \u7528\u6237\u8bbf\u95ee\u65e5\u5fd7\uff08\u4e8b\u5b9e\u8868\uff09:\uff08\u7528\u6237\u540d \u3001URL \u3001 \u65f6 \u95f4 \u2026 \uff09</p> <p>\u7ef4\u5ea6\u8868\u4e5f\u79f0\u4e3a\u67e5\u627e\u8868\uff0c\u662f\u4e0e\u4e8b\u5b9e\u8868\u76f8\u5bf9\u5e94\u7684\u8868\uff0c\u8fd9\u4e2a\u8868\u4fdd\u5b58\u4e86\u7ef4\u5ea6\u7684\u5c5e\u6027\u503c\uff0c\u53ef\u4ee5\u8ddf\u4e8b\u5b9e\u8868\u505a\u5173\u8054\uff0c\u76f8\u5f53\u4e8e\u662f\u5c06\u4e8b\u5b9e\u8868\u4e2d\u7ecf\u5e38\u91cd\u590d\u7684\u6570\u636e\u62bd\u53d6\u3001\u89c4\u8303\u51fa\u6765\u7528\u4e00\u5f20\u8868\u7ba1\u7406\uff0c\u5e38\u89c1\u7684\u6709\u65e5\u671f\uff08\u65e5\u3001\u5468\u3001\u6708\u3001\u5b63\u5ea6\u7b49\u5c5e\u6027\uff09\u3001\u5730\u533a\u8868\u7b49\uff0c\u6240\u4ee5\u7ef4\u5ea6\u8868\u7684\u53d8\u5316\u901a\u5e38\u4e0d\u4f1a\u592a\u5927\u3002</p> <p>\u7ef4\u5ea6\u8868\u7684\u5b58\u5728\u7f29\u5c0f\u4e86\u4e8b\u5b9e\u8868\u7684\u5927\u5c0f\uff0c\u4fbf\u4e8e\u7ef4\u5ea6\u7684\u7ba1\u7406\u548c CURD \u7ef4\u5ea6\u7684\u5c5e\u6027\uff0c\u4e0d\u5fc5\u5bf9\u4e8b\u5b9e\u8868\u7684\u5927\u91cf\u8bb0\u5f55\u8fdb\u884c\u6539\u52a8\uff0c\u5e76\u4e14\u53ef\u4ee5\u7ed9\u591a\u4e2a\u4e8b\u5b9e\u8868\u91cd\u7528\u3002</p> <p>\u7701\u4efd\u8868\uff08\u7ef4\u5ea6\u8868\uff09\uff1a \uff08\u5317\u4eac\u5e02 \u3001 \u5e7f\u4e1c\u7701 \u3001 \u4e0a\u6d77\u5e02 \u2026\uff09</p> <p>\u7ef4\u5ea6\u5217\uff1a\u7528\u6237\u4fe1\u606f</p> <p>\u6307\u6807\u5217\uff1a\u7528\u6237\u884c\u4e3a</p>"},{"location":"olap/01.OLAP%E6%A6%82%E8%BF%B0/#_16","title":"\u6570\u4ed3\u5efa\u6a21","text":""},{"location":"olap/01.OLAP%E6%A6%82%E8%BF%B0/#_17","title":"\u6570\u4ed3\u5206\u5c42","text":"<p>\u6570\u4ed3\u5728\u5efa\u8bbe\u8fc7\u7a0b\u4e2d\uff0c\u5bf9\u6570\u636e\u7684\u7ec4\u7ec7\u7ba1\u7406\u4e0a\uff0c\u4e0d\u4ec5\u8981\u6839\u636e\u4e1a\u52a1\u8fdb\u884c\u7eb5\u5411\u7684\u4e3b\u9898\u57df\u5212\u5206\uff0c\u8fd8\u9700\u8981\u6a2a\u5411\u7684\u6570\u4ed3\u5206\u5c42\u89c4\u8303\u3002</p> <p>\u4e3a\u4e86\u89e3\u51b3\u6211\u4eec\u53ef\u80fd\u9762\u4e34\u7684\u95ee\u9898\uff0c\u6211\u4eec\u9700\u8981\u4e00\u5957\u6709\u6548\u7684\u6570\u636e\u7ec4\u7ec7\u3001\u7ba1\u7406\u548c\u5904\u7406\u65b9\u6cd5\uff0c\u4f7f\u6211\u4eec\u7684\u6570\u636e\u7cfb\u7edf\u66f4\u52a0\u6709\u5e8f\uff0c\u8fd9\u5c31\u662f\u6570\u636e\u5206\u5c42\u3002\u6570\u636e\u5206\u5c42\u7684\u597d\u5904\uff1a</p> <ul> <li>\u6e05\u6670\u7684\u6570\u636e\u7ed3\u6784\uff1a\u6bcf\u4e2a\u6570\u636e\u5c42\u90fd\u6709\u81ea\u5df1\u7684\u89d2\u8272\u548c\u8d23\u4efb\uff0c\u66f4\u6613\u4e8e\u4f7f\u7528\u3001\u7ef4\u62a4\u548c\u7406\u89e3</li> <li>\u590d\u6742\u95ee\u9898\u7b80\u5316\uff1a\u5c06\u590d\u6742\u4efb\u52a1\u5206\u89e3\u4e3a\u591a\u4e2a\u6b65\u9aa4\uff0c\u6bcf\u4e00\u5c42\u53ea\u89e3\u51b3\u7279\u5b9a\u95ee\u9898</li> <li>\u7edf\u4e00\u7684\u6570\u636e\u53e3\u5f84\uff1a\u901a\u8fc7\u6570\u636e\u5206\u5c42\u63d0\u4f9b\u7edf\u4e00\u7684\u6570\u636e\u51fa\u53e3\u548c\u7edf\u4e00\u7684\u8f93\u51fa\u53e3\u5f84</li> <li>\u51cf\u5c11\u91cd\u590d\uff1a\u6b63\u5f0f\u5316\u6570\u636e\u5206\u5c42\u5e76\u5f00\u53d1\u901a\u7528\u7684\u4e2d\u95f4\u5c42\u53ef\u4ee5\u5927\u5927\u51cf\u5c11\u91cd\u590d</li> </ul> <p>\u6570\u4ed3\u7684\u5efa\u8bbe\u5e76\u4e0d\u662f\u6570\u636e\u5b58\u50a8\u7684\u6700\u7ec8\u76ee\u7684\u5730\uff0c\u800c\u662f\u4e3a\u6570\u636e\u6700\u7ec8\u7684\u76ee\u7684\u5730\u505a\u597d\u51c6\u5907: \u6e05\u6d17\u3001\u8f6c\u4e49\u3001\u5206\u7c7b\u3001\u91cd\u7ec4\u3001\u5408\u5e76\u3001\u62c6\u5206\u3001\u7edf\u8ba1\u7b49\u7b49\u3002\u901a\u8fc7\u5bf9\u6570\u636e\u4ed3\u5e93\u4e2d\u6570\u636e\u7684\u5206\u6790\uff0c\u53ef\u4ee5\u5e2e\u52a9\u4f01\u4e1a\uff0c\u6539\u8fdb\u4e1a\u52a1\u6d41\u7a0b\u3001\u63a7\u5236\u3001\u6210\u672c\u3001\u63d0\u9ad8\u4ea7\u54c1\u8d28\u91cf\u7b49\u3002\u4e3b</p> <p>\u8981\u5728\u4ee5\u4e0b\u573a\u666f\u4e2d\uff1a</p> <ul> <li> <p>\u7406\u6e05\u6570\u636e\u8d44\u4ea7\u63d0\u9ad8\u6392\u67e5\u548c\u5f00\u53d1\u8fd0\u7ef4\u6548\u7387</p> </li> <li> <p>\u63d0\u9ad8\u6570\u636e\u8d28\u91cf</p> </li> <li> <p>\u6570\u636e\u89e3\u8026</p> </li> <li> <p>\u89e3\u51b3\u9891\u7e41\u7684\u4e34\u65f6\u6027\u9700\u6c42(\u6bd4\u5982\u76d1\u7ba1\u62a5\u9001)</p> </li> </ul> <p>\u4e0d\u540c\u7684\u4f01\u4e1a\u4e0d\u540c\u7684\u4e1a\u52a1\u7c7b\u578b\u670d\u52a1\u4e0d\u540c\u7684\u7528\u6237\uff0c\u6ca1\u6709\u5b9a\u8bba\u8bf4\u5206 3\u30014 \u5c42\u8fd8\u662f 5 \u5c42\uff0c\u53ea\u6709\u6700\u5408\u9002\u7684\u5206\u5c42\u3002</p> <p>\u6bcf\u4e2a\u4f01\u4e1a\u6839\u636e\u81ea\u5df1\u7684\u4e1a\u52a1\u9700\u6c42\u53ef\u4ee5\u5206\u6210\u4e0d\u540c\u7684\u5c42\u6b21\uff0c\u4f46\u662f\u6700\u57fa\u7840\u7684\u5206\u5c42\u601d\u60f3\uff0c\u7406\u8bba\u4e0a\u6570\u636e\u5206\u4e3a\u4e09\u4e2a\u5c42\uff1a\u8d34\u6e90\u5c42\uff08ODS)\u3001\u6570\u636e\u4ed3\u5e93\u5c42\uff08DW\uff09\u3001\u6570\u636e\u670d\u52a1\u5c42(APP/DWA)\u3002\u57fa\u4e8e\u8fd9\u4e2a\u57fa\u7840\u5206\u5c42\u4e4b\u4e0a\u6ee1\u8db3\u4e0d\u540c\u7684\u4e1a\u52a1\u9700\u6c42\u3002</p> <ul> <li> <p>\u6570\u636e\u5f15\u5165\u5c42: \u6570\u636e\u4ed3\u5e93\u6e90\u5934\u7cfb\u7edf\u7684\u6570\u636e\u8868\u901a\u5e38\u4f1a\u539f\u5c01\u4e0d\u52a8\u7684\u5b58\u50a8\u4e00\u4efd\uff0c\u8fd9\u79f0\u4e3a ODS \u5c42\uff0c\u662f\u540e\u7eed\u6570\u636e\u4ed3\u5e93\u52a0\u5de5\u6570\u636e\u7684\u6765\u6e90\u3002</p> </li> <li> <p>\u660e\u7ec6\u6570\u636e\u5c42: \u662f\u4e1a\u52a1\u5c42\u4e0e\u6570\u636e\u4ed3\u5e93\u7684\u9694\u79bb\u5c42\u3002\u4e3b\u8981\u5bf9 ODS \u6570\u636e\u5c42\u505a\u4e00\u4e9b\u6570\u636e\u6e05\u6d17(\u53bb\u9664\u7a7a\u503c\u3001\u810f\u6570\u636e\u3001\u8d85\u8fc7\u6781\u9650\u8303)\u548c\u89c4\u8303\u5316\u7684\u64cd\u4f5c\u3002</p> </li> <li> <p>\u6570\u636e\u57fa\u7840\u5c42\uff1a\u5bf9 ODS \u5c42\u7684\u6570\u636e\u8fdb\u884c\u6df1\u5ea6\u6e05\u6d17\u3001\u6807\u51c6\u5316\u548c\u6574\u5408\u3002\u5b58\u50a8\u7684\u662f\u5ba2\u89c2\u6570\u636e\uff0c\u4e00\u822c\u7528\u4f5c\u4e2d\u95f4\u5c42\uff0c\u53ef\u4ee5\u8ba4\u4e3a\u662f\u5927\u91cf\u6307\u6807\u7684\u6570\u636e\u5c42\u3002\u8fd9\u4e00\u5c42\u7684\u6570\u636e\u901a\u5e38\u662f\u6309\u4e3b\u9898\u57df\u5212\u5206\u7684\uff0c\u5e76\u4e14\u5df2\u7ecf\u5177\u5907\u4e00\u5b9a\u7684\u4e1a\u52a1\u542b\u4e49\u3002</p> </li> <li> <p>\u6c47\u603b\u6570\u636e\u5c42 DWS\uff08Data Warehouse Summary\uff09: \u57fa\u4e8e DWB \u4e0a\u7684\u57fa\u7840\u6570\u636e\uff0c\u4e3b\u8981\u662f\u5bf9\u7528\u6237\u884c\u4e3a\u8fdb\u884c\u8f7b\u5ea6\u805a\u5408\uff0c\u6574\u5408\u6c47\u603b\u6210\u5206\u6790\u67d0\u4e00\u4e2a\u4e3b\u9898\u57df\u7684\u670d\u52a1\u6570\u636e\u5c42\uff0c\u4e00\u822c\u662f\u5bbd\u8868\u3002\u7528\u4e8e\u63d0\u4f9b\u540e\u7eed\u7684\u4e1a\u52a1\u67e5\u8be2\uff0cOLAP \u5206\u6790\uff0c\u6570\u636e\u5206\u53d1\u7b49\u3002</p> </li> <li> <p>\u5e94\u7528\u6570\u636e\u5c42 ADS\uff08Application Data Service\uff09: \u5b58\u653e\u6570\u636e\u4ea7\u54c1\u4e2a\u6027\u5316\u7684\u7edf\u8ba1\u6307\u6807\u6570\u636e\u3002\u63d0\u4f9b\u6570\u636e\u4ea7\u54c1\u548c\u6570\u636e\u5206\u6790\u4f7f\u7528\u7684\u6570\u636e\uff0c\u6211\u4eec\u901a\u8fc7\u8bf4\u7684\u62a5\u8868\u6570\u636e\uff0c\u6216\u8005\u8bf4\u90a3\u79cd\u5927\u5bbd\u8868\uff0c\u4e00\u822c\u5c31\u653e\u5728\u8fd9\u91cc\u3002</p> </li> <li> <p>\u516c\u5171\u7ef4\u5ea6\u5c42 DIM\uff08Dimension\uff09: \u57fa\u4e8e\u7ef4\u5ea6\u5efa\u6a21\u7406\u5ff5\u601d\u60f3\uff0c\u5efa\u7acb\u6574\u4e2a\u4f01\u4e1a\u7684\u4e00\u81f4\u6027\u7ef4\u5ea6\u3002\u964d\u4f4e\u6570\u636e\u8ba1\u7b97\u53e3\u5f84\u548c\u7b97\u6cd5\u4e0d\u7edf\u4e00\u98ce\u9669\u3002\u516c\u5171\u7ef4\u5ea6\u5c42\u7684\u8868\u901a\u5e38\u4e5f\u88ab\u79f0\u4e3a\u903b\u8f91\u7ef4\u5ea6\u8868\uff0c\u7ef4\u5ea6\u548c\u7ef4\u5ea6\u903b\u8f91\u8868\u901a\u5e38\u4e00\u4e00\u5bf9\u5e94\u3002</p> </li> </ul> \u6570\u4ed3\u5206\u5c42 \u6570\u4ed3\u5206\u5c42 \u4e1a\u52a1\u542b\u4e49 \u6570\u636e\u5f15\u5165\u5c42 ODS\uff08Operational Data Store\uff09 \u6570\u636e\u4ed3\u5e93\u6e90\u5934\u7cfb\u7edf\u7684\u6570\u636e\u8868\uff0c\u539f\u59cb\u5c42 \u660e\u7ec6\u6570\u636e\u5c42 DWD\uff08Data Warehouse Detail\uff09 \u6570\u636e\u57fa\u7840\u5c42 DWB (Data Warehouse Base) \u6c47\u603b\u6570\u636e\u5c42 DWS\uff08Data Warehouse Summary\uff09 \u5e94\u7528\u6570\u636e\u5c42 ADS\uff08Application Data Service\uff09 \u516c\u5171\u7ef4\u5ea6\u5c42 DIM\uff08Dimension\uff09 <p>https://help.aliyun.com/zh/dataworks/user-guide/data-warehouse-planning</p> <p>https://help.aliyun.com/zh/maxcompute/getting-started/divide-a-data-warehouse-into-layers</p>"},{"location":"olap/01.OLAP%E6%A6%82%E8%BF%B0/#_18","title":"\u5373\u5e2d\u67e5\u8be2","text":"<p>\u5373\u5e2d\u67e5\u8be2AD-HOC \uff1a\u4ee5\u5355\u72ec\u7684SQL\u8bed\u53e5\u7684\u5f62\u5f0f\u6267\u884c\u7684\u67e5\u8be2\u5c31\u662f\u5373\u5e2d\u67e5\u8be2\uff0c\u6bd4\u5982\u8bf4\uff1aHUE\u91cc\u9762\u8f93\u5165SQL\u8bed\u53e5\u5e76\u83b7\u5f97\u7ed3\u679c\u6216\u8005\u4f7f\u7528dbeaver\u8fde\u63a5hiveserver2\u81ea\u5df1\u952e\u5165\u7684SQL\u4ee3\u7801\u5e76\u83b7\u53d6\u7ed3\u679c\uff0c\u8fd9\u6837\u7684\u64cd\u4f5c\u5c31\u662f\u5373\u5e2d\u67e5\u8be2\u3002</p> <p>\u5373\u5e2d\u67e5\u8be2\uff0c\u53c8\u79f0\u4e3a\u968f\u673a\u67e5\u8be2\uff0c\u662f\u4e00\u79cd\u5728\u6570\u636e\u5e93\u6216\u6570\u636e\u4ed3\u5e93\u4e2d\u5feb\u901f\u6784\u5efa\u548c\u6267\u884c\u4e34\u65f6\u67e5\u8be2\u7684\u65b9\u6cd5\u3002</p> <p>\u5b83\u5141\u8bb8\u7528\u6237\u6839\u636e\u81ea\u5df1\u7684\u9700\u6c42\uff0c\u968f\u65f6\u521b\u5efa\u548c\u8fd0\u884c\u67e5\u8be2\uff0c\u65e0\u9700\u9884\u5148\u5b9a\u4e49\u67e5\u8be2\u8bed\u53e5\u6216\u7f16\u5199\u590d\u6742\u7684\u811a\u672c\u3002\u5373\u5e2d\u67e5\u8be2\u901a\u5e38\u7528\u4e8e\u63a2\u7d22\u6027\u6570\u636e\u5206\u6790\uff0c\u5e2e\u52a9\u7528\u6237\u5feb\u901f\u4e86\u89e3\u6570\u636e\u7684\u7279\u5f81\u548c\u89c4\u5f8b\u3002</p> <ul> <li>\u7075\u6d3b\u6027\uff1a\u7528\u6237\u53ef\u4ee5\u6839\u636e\u81ea\u5df1\u7684\u9700\u6c42\u968f\u65f6\u6784\u5efa\u548c\u6267\u884c\u67e5\u8be2\uff0c\u65e0\u9700\u9884\u5148\u5b9a\u4e49\u67e5\u8be2\u8bed\u53e5\u3002</li> <li>\u5b9e\u65f6\u6027\uff1a\u5373\u5e2d\u67e5\u8be2\u53ef\u4ee5\u5b9e\u65f6\u5730\u83b7\u53d6\u6570\u636e\uff0c\u5e2e\u52a9\u7528\u6237\u53ca\u65f6\u4e86\u89e3\u6570\u636e\u7684\u6700\u65b0\u72b6\u6001\u3002</li> <li>\u4ea4\u4e92\u6027\uff1a\u7528\u6237\u53ef\u4ee5\u901a\u8fc7\u4ea4\u4e92\u5f0f\u754c\u9762\u4e0e\u67e5\u8be2\u7ed3\u679c\u8fdb\u884c\u4ea4\u4e92\uff0c\u8fdb\u4e00\u6b65\u6316\u6398\u6570\u636e\u4e2d\u7684\u4fe1\u606f\u3002 </li> </ul> <p>\u6211\u4eec\u53ef\u4ee5\u628aOLAP\u5206\u4e3a\u4e24\u5927\u7c7b\uff0c\u5373\u5e2d\u67e5\u8be2\u5c31\u662f\u5176\u4e2d\u7684\u4e00\u7c7b\uff0c\u53e6\u5916\u4e00\u7c7b\u53ef\u4ee5\u88ab\u79f0\u4f5c\u56fa\u5316\u67e5\u8be2\u3002\u5b83\u4eec\u4e4b\u95f4\u7684\u5dee\u522b\u5728\u4e8e\uff0c\u56fa\u5316\u67e5\u8be2\u5728\u7cfb\u7edf\u8bbe\u8ba1\u548c\u5b9e\u65bd\u65f6\u662f\u5df2\u77e5\u7684\u6211\u4eec\u53ef\u4ee5\u5728\u7cfb\u7edf\u4e2d\u901a\u8fc7\u5206\u533a\u3001\u9884\u8ba1\u7b97\u7b49\u6280\u672f\u6765\u4f18\u5316\u8fd9\u4e9b\u67e5\u8be2\u4f7f\u8fd9\u4e9b\u67e5\u8be2\u7684\u6548\u7387\u5f88\u9ad8\uff0c\u800c\u5373\u5e2d\u67e5\u8be2\u662f\u7528\u6237\u5728\u4f7f\u7528\u65f6\u4e34\u65f6\u751f\u4ea7\u7684\uff0c\u67e5\u8be2\u7684\u5185\u5bb9\u65e0\u6cd5\u63d0\u524d\u8fd0\u7b97\u548c\u9884\u6d4b\u3002</p> <p>\u5bf9\u4e8e\u6570\u4ed3\u6765\u8bf4\uff0c\u5373\u5e2d\u67e5\u8be2\u7684\u54cd\u5e94\u7a0b\u5ea6\u4e5f\u5c31\u6210\u4e3a\u4e86\u8bc4\u4f30\u6570\u636e\u4ed3\u5e93\u7684\u4e00\u4e2a\u91cd\u8981\u6307\u6807\u3002\u5bf9\u4e8e\u5373\u5e2d\u67e5\u8be2\u7684\u652f\u6301\u7a0b\u5ea6\u4e0d\u4ec5\u4ec5\u662f\u5bf9\u6570\u636e\u4ed3\u5e93\u8bbe\u8ba1\u7684\u8981\u6c42\uff0c\u4e5f\u662f\u5bf9\u4e8e\u6574\u4e2a\u6570\u636e\u5e73\u53f0\u67b6\u6784\u7684\u8981\u6c42\u3002\u5728\u6574\u4e2a\u7cfb\u7edf\u4e2d\u5373\u5e2d\u67e5\u8be2\u4f7f\u7528\u7684\u8d8a\u591a\uff0c\u5bf9\u7cfb\u7edf\u7684\u8981\u6c42\u5c31\u8d8a\u9ad8\uff0c\u5bf9\u6570\u4ed3\u4e2d\u6570\u636e\u6a21\u578b\u7684\u5bf9\u79f0\u6027\u7684\u8981\u6c42\u4e5f\u8d8a\u9ad8\u3002\uff08\u8fd9\u91cc\u6240\u8bf4\u7684\u5bf9\u79f0\u6027\u6307\u7684\u662f\uff1a\u6570\u636e\u6a21\u578b\u5bf9\u6240\u6709\u7684\u67e5\u8be2\u90fd\u662f\u76f8\u540c\u7684\uff0c\u8fd9\u4e5f\u662f\u7ef4\u5ea6\u5efa\u6a21\u7684\u4e00\u4e2a\u4f18\u70b9\uff09</p> <p>\u80fd\u591f\u5feb\u901f\u7684\u6267\u884c\u81ea\u5b9a\u4e49SQL\u5bf9\u5373\u5e2d\u67e5\u8be2\u6765\u8bf4\u662f\u6700\u57fa\u672c\u7684\u8981\u6c42\uff0c\u4e00\u822c\u60c5\u51b5\u4e0b\u5373\u5e2d\u67e5\u8be2\u57fa\u672c\u4e0a\u90fd\u662f\u4ece\u5168\u91cf\u7684\u8be6\u7ec6\u6570\u636e\u4e2d\u8fdb\u884c\u8fc7\u6ee4\u7b5b\u9009\uff0c\u5e76\u4e14\u9700\u8981\u5728\u77ed\u65f6\u95f4\u5185\u7ed9\u51fa\u67e5\u8be2\u7684\u7ed3\u679c\uff0c\u8fd9\u5c31\u5bf9\u54cd\u5e94\u901f\u5ea6\u6709\u4e86\u4e25\u683c\u7684\u8981\u6c42\uff0c\u4ece\u67e5\u8be2\u8f93\u5165\u5230\u7528\u6237\u5f97\u5230\u7ed3\u679c\u5fc5\u987b\u662f\u79d2\u7ea7\u7684\u76f8\u5e94\u3002\u5bf9\u4e8eHive\u8fd9\u6837\u7684\u79bb\u7ebf\u6570\u4ed3\u80af\u5b9a\u662f\u6ee1\u8db3\u4e0d\u4e86\u8fd9\u6837\u7684\u9700\u6c42\uff0c\u6240\u4ee5\u5c31\u4ea7\u751f\u5404\u79cd\u67b6\u6784\u7684\u67e5\u8be2\u5f15\u64ce/\u7cfb\u7edf\u3002</p>"},{"location":"olap/01.OLAP%E6%A6%82%E8%BF%B0/#_19","title":"\u9884\u805a\u5408\u6570\u636e\u6a21\u578b","text":"<p>Mesa \u9879\u76ee\u662f <code>Google</code> \u5927\u6982\u5728 2014 \u5e74\u53d1\u8868\u7684\u8bba\u6587\uff0c\u5b9e\u73b0\u5168\u7403\u590d\u5236\u4ee5\u53ca\u9ad8\u5ea6\u53ef\u6269\u5c55\u7684\u5206\u6790\u578b\u6570\u636e\u4ed3\u5e93\u7cfb\u7edf\u3002</p> <p>\u4e1a\u52a1\u80cc\u666f</p> <p>\u5728 <code>Google</code> \u5185\u90e8\uff0c<code>Mesa</code> \u4e3b\u8981\u89e3\u51b3 <code>Google</code> \u5728\u7ebf\u5e7f\u544a\u62a5\u8868\u548c\u5206\u6790\u4e1a\u52a1\uff0c\u62e5\u6709\u51c6\u5b9e\u65f6\u7684\u6570\u636e\u66f4\u65b0\u80fd\u529b\u548c\u4f4e\u5ef6\u8fdf\u7684\u6570\u636e\u67e5\u8be2\u6027\u80fd\u3002</p> <p>\u5e7f\u544a\u4e1a\u52a1\u7684\u7279\u70b9\u662f\u5176\u6570\u636e\u91cf\u7279\u522b\u5927\uff0c\u6bcf\u6b21\u5e7f\u544a\u7684\u5c55\u793a\u3001\u70b9\u51fb\u90fd\u4f1a\u4ea7\u751f\u4e00\u6761\u6570\u636e\uff0c\u5b58\u50a8\u8fd9\u4e9b\u539f\u59cb\u6570\u636e\u4e0d\u4f46\u4f1a\u6d88\u8017\u5927\u91cf\u7684\u5b58\u50a8\u8d44\u6e90\uff0c\u4e5f\u4f1a\u7ed9\u5b9e\u65f6\u8ba1\u7b97\u805a\u5408\u7ed3\u679c\uff08\u6bd4\u5982 \"\u67d0\u4e2a\u5e7f\u544a\u4e3b\u622a\u6b62\u76ee\u524d\u5df2\u7ecf\u6d88\u8d39\u4e86\u591a\u5c11\u9884\u7b97\"\uff09\u5e26\u6765\u5f88\u5927\u56f0\u96be\u3002</p> <p>\u5728\u5927\u6570\u636e\u5206\u6790\u573a\u666f\u4e2d\uff0c\u6838\u5fc3\u4e1a\u52a1\u662f \u7ecf\u5e38\u9700\u8981\u5bf9\u6d77\u91cf\u6570\u636e\u8fdb\u884c\u590d\u6742\u7684\u805a\u5408\u64cd\u4f5c\uff08\u5982\u6c42\u548c\u3001\u8ba1\u6570\u3001\u5e73\u5747\u503c\u7b49\uff09\uff0c\u8fd9\u4e9b\u64cd\u4f5c\u53ef\u80fd\u6d89\u53ca\u591a\u7ef4\u8fc7\u6ee4\u3001\u5206\u7ec4\u548c\u6392\u5e8f\u3002</p> <p>\u5982\u679c\u6bcf\u6b21\u67e5\u8be2\u90fd\u9700\u8981\u5bf9\u539f\u59cb\u6570\u636e\u6765\u91cd\u65b0 \u5b9e\u65f6\u8ba1\u7b97\uff0c\u53ef\u80fd\u4f1a\u5bfc\u81f4\u67e5\u8be2\u5ef6\u8fdf\u8fc7\u9ad8\u3002\u5c24\u5176\u662f\u5f53\u6570\u636e\u89c4\u6a21\u8fbe\u5230 PB \u7ea7\u65f6\u3002</p> <p>Mesa \u4e3a\u4e86\u89e3\u51b3\u4e0a\u9762\u63d0\u5230\u7684\u4e24\u4e2a\u95ee\u9898\uff0c\u63d0\u51fa\u4e86\u4e00\u4e2a\u9884\u805a\u5408\u7684\u5b58\u50a8\u6a21\u578b\u3002Mesa \u4e2d\u7684\u6240\u6709\u8868\u90fd\u662f\u9884\u805a\u5408\u8868\uff0c\u4ee5\u4e0b\u56fe\u4e2d\u7684 Table A \u4e3a\u4f8b\uff1a</p> <p></p> <p>\u5176\u4e2d\u7ad6\u7ebf\u4e4b\u524d\u7684 Date\u3001PublisherId\u3001Country \u4e09\u5217\u662f Key \u5217\uff0c\u8868\u793a\u805a\u5408\u7684\u7ef4\u5ea6\uff0c\u8bed\u4e49\u7b49\u540c\u4e8e Group-By\uff1b\u7ad6\u7ebf\u4e4b\u540e\u7684 Clicks \u548c Cost \u5217\u662f Value \u5217\uff0c\u8868\u793a\u88ab\u805a\u5408\u7684\u7ed3\u679c\u3002\u4f8b\u5982\u7b2c\u4e00\u884c\u8868\u793a <code>2013-12-31 \u8fd9\u4e00\u5929\uff0cID \u4e3a 100 \u7684 Publisher \u5728 US \u4e00\u5171\u53d1\u751f\u4e86 10 \u6b21\u70b9\u51fb\u3001\u4ef7\u503c 32 \u5757\u94b1</code></p> <p>\u4e0a\u9762\u7684 Table A \uff5e D \u5176\u5b9e\u8868\u793a\u7684\u662f\u540c\u4e00\u6279\u539f\u59cb\u6570\u636e\u7684\u5728\u56db\u4e2a\u4e0d\u540c\u7ef4\u5ea6\u7684\u805a\u5408\u7ed3\u679c\uff0c\u4f9b\u4e0d\u540c\u7684\u4e1a\u52a1\u67e5\u8be2\u4f7f\u7528\u3002\u662f\u4e0d\u662f\u6709\u70b9\u50cf MOLAP \u6216\u8005\u8bf4 Data Cube \u7684\u6982\u5ff5\uff1f</p> <p>\u672c\u8d28\u4e0a\u662f\u4e00\u6837\u7684\uff0c\u90fd\u662f\u7528\u9884\u5148\u5b9a\u4e49\u548c\u8ba1\u7b97\u805a\u5408\uff08\u7b80\u79f0 \u201c\u9884\u805a\u5408\u201d\uff09\u6765\u52a0\u901f\u7279\u5b9a\u6a21\u5f0f\u7684\u67e5\u8be2\u3002</p> <p>\u53c2\u8003</p> <p>\u53c2\u8003</p>"},{"location":"olap/01.OLAP%E6%A6%82%E8%BF%B0/#_20","title":"\u7269\u5316\u89c6\u56fe","text":"<p>\u7269\u5316\u89c6\u56fe\u662f\u4e00\u79cd\u9884\u5148\u8ba1\u7b97\u5e76\u5b58\u50a8\u7684\u6570\u636e\u5e93\u5bf9\u8c61\uff0c\u5b83\u57fa\u4e8e\u57fa\u7840\u8868\u7684\u6570\u636e\u751f\u6210\u3002\u5b83\u7c7b\u4f3c\u4e8e\u666e\u901a\u89c6\u56fe\uff0c\u4f46\u666e\u901a\u89c6\u56fe\u53ea\u662f\u903b\u8f91\u5b9a\u4e49\uff08\u4e0d\u5b58\u50a8\u6570\u636e\uff09\uff0c\u800c \u7269\u5316\u89c6\u56fe\u4f1a\u5c06\u67e5\u8be2\u7ed3\u679c\u5b9e\u9645\u5b58\u50a8\u5728\u78c1\u76d8\u4e0a\uff0c\u5bf9\u4e8e\u5ba2\u6237\u7aef(client)\u6765\u8bf4\uff0c\u7269\u5316\u89c6\u56fe\u5c31\u50cf\u662f\u4e00\u4e2a\u53ea\u8bfb\u7684\u8868\u3002\u8fd9\u4e2a\u8868\u7684\u6570\u66f4\u65b0\u662f\u6839\u636e\u57fa\u8868\u7684\u66f4\u65b0\u6765\u7ef4\u62a4\u7684</p> \u7279\u6027 \u666e\u901a\u89c6\u56fe\uff08View\uff09 \u7269\u5316\u89c6\u56fe\uff08Materialized View\uff09 \u6570\u636e\u5b58\u50a8 \u4e0d\u5b58\u50a8\u6570\u636e\uff0c\u4ec5\u4fdd\u5b58\u67e5\u8be2\u5b9a\u4e49 \u5b58\u50a8\u67e5\u8be2\u7ed3\u679c\u7684\u5b9e\u9645\u6570\u636e \u67e5\u8be2\u6027\u80fd \u6bcf\u6b21\u67e5\u8be2\u90fd\u9700\u8981\u91cd\u65b0\u8ba1\u7b97 \u76f4\u63a5\u4ece\u5b58\u50a8\u7684\u6570\u636e\u4e2d\u8bfb\u53d6\uff0c\u6027\u80fd\u66f4\u9ad8 \u5237\u65b0\u673a\u5236 \u52a8\u6001\u8ba1\u7b97\uff0c\u65e0\u9700\u5237\u65b0 \u9700\u8981\u5b9a\u671f\u6216\u6309\u9700\u5237\u65b0\u4ee5\u4fdd\u6301\u6570\u636e\u4e00\u81f4\u6027 \u9002\u7528\u573a\u666f \u52a8\u6001\u67e5\u8be2\uff0c\u7075\u6d3b\u8c03\u6574 \u9884\u8ba1\u7b97\u7ed3\u679c\uff0c\u52a0\u901f\u590d\u6742\u67e5\u8be2 \u5b58\u50a8\u5f00\u9500 \u65e0\u989d\u5916\u5b58\u50a8\u5f00\u9500 \u9700\u8981\u989d\u5916\u5b58\u50a8\u7a7a\u95f4\u6765\u4fdd\u5b58\u67e5\u8be2\u7ed3\u679c \u5b9e\u65f6\u6027 \u5b9e\u65f6\u53cd\u6620\u57fa\u7840\u8868\u7684\u53d8\u5316 \u53ef\u80fd\u5b58\u5728\u5ef6\u8fdf\uff0c\u53d6\u51b3\u4e8e\u5237\u65b0\u9891\u7387 \u652f\u6301\u7684\u529f\u80fd \u4e0d\u652f\u6301\u589e\u91cf\u5237\u65b0\u3001\u67e5\u8be2\u6539\u5199\u7b49 \u652f\u6301\u589e\u91cf\u5237\u65b0\u3001\u67e5\u8be2\u6539\u5199\u7b49\u529f\u80fd <p>\u7269\u5316\u89c6\u56fe\u7ef4\u62a4(materialized view maintenance)</p> <p>\u7531\u4e8e\u89c6\u56fe\u4e2d\u7684\u6570\u636e\u662f\u4ece\u57fa\u8868\u4e2d\u67e5\u8be2\u51fa\u6765\u7684\uff0c\u6240\u4ee5\u4e00\u65e6\u57fa\u8868\u4e2d\u7684\u6570\u636e\u53d1\u751f\u6539\u53d8\uff0c\u89c6\u56fe\u5c31\u4f1a\u8fc7\u671f\uff0c\u6240\u4ee5\u89c6\u56fe\u4e2d\u7684\u6570\u636e\u4e5f\u8981\u53d1\u751f\u6539\u53d8\u3002\u4fdd\u6301\u89c6\u56fe\u7269\u5316\u4e00\u76f4\u5728\u6700\u65b0\u72b6\u6001\u7684\u8fc7\u7a0b\u79f0\u4e3a**\u7269\u5316\u89c6\u56fe\u7ef4\u62a4\uff08\u6216\u8005\u53eb\u6570\u636e\u5237\u65b0\uff09**\uff0c\u7269\u5316\u89c6\u56fe\u7ef4\u62a4\u7684\u7b56\u7565\u5927\u6982\u6709\u51e0\u79cd\uff1a</p> <ul> <li>\u6bcf\u5f53\u6570\u636e\u53d8\u66f4\u65f6\u5c31\u8fdb\u884c\u89c6\u56fe\u7269\u5316\uff08\u5b9e\u65f6\u5237\u65b0\uff09</li> <li>\u5468\u671f\u6027\u7684\u8fdb\u884c\u89c6\u56fe\u7269\u5316\uff08\u5b9a\u671f\u5237\u65b0\uff09</li> <li>\u5f53\u9700\u8981\u8bbf\u95ee\u89c6\u56fe\u65f6\u624d\u8fdb\u884c\u89c6\u56fe\u7269\u5316\uff08\u5ef6\u8fdf\u5230\u9700\u8981\u67e5\u8be2\u65f6\u624d\u6765\u8ba1\u7b97\uff09</li> </ul> <p>\u7269\u5316\u89c6\u56fe\uff0c\u8ddf\u9884\u805a\u5408\u6570\u636e\u6a21\u578b\u5176\u5b9e\u5f88\u7c7b\u4f3c\uff0c\u5176\u672c\u8d28\u90fd\u662f**\u5c06\u7528\u6237\u5b9a\u4e49\u7684\u67e5\u8be2\u63d0\u524d\u8ba1\u7b97\u597d\uff0c\u6309\u7528\u6237\u8981\u6c42\u81ea\u52a8\u5237\u65b0\u89c6\u56fe\u4e2d\u7684\u6570\u636e**\uff0c\u5176\u89c6\u56fe\u6570\u636e\u5237\u65b0\u7684\u65b9\u5f0f\u4e00\u822c\u5206\u4e3a\u4e24\u79cd\uff1a\u5168\u91cf\u5237\u65b0**\u548c**\u589e\u91cf\u5237\u65b0\u3002</p> <ul> <li> <p>**\u5168\u91cf\u5237\u65b0**\u6bcf\u6b21\u91cd\u65b0\u8fd0\u884c SQL\uff0c\u5c06\u7b97\u597d\u7684\u65b0\u6570\u636e\u5168\u91cf\u8986\u76d6\u65e7\u6570\u636e\u3002</p> </li> <li> <p>**\u589e\u91cf\u5237\u65b0**\u901a\u8fc7\u7279\u5b9a\u7b97\u6cd5\uff0c\u6bcf\u6b21\u53ea\u8ba1\u7b97\u81ea\u4e0a\u6b21\u5237\u65b0\u4ee5\u6765\u53d1\u751f\u53d8\u5316\u7684\u6570\u636e\u90e8\u5206\uff0c\u7136\u540e\u5b9a\u5411\u66f4\u65b0\u7269\u5316\u89c6\u56fe\u4e2d\u7684\u90e8\u5206\u6570\u636e\u3002</p> </li> </ul> <p>\u663e\u7136\uff0c\u589e\u91cf\u5237\u65b0\u8fd9\u79cd\u65b9\u6cd5\u663e\u8457\u51cf\u5c11\u4e86\u5237\u65b0\u5f00\u9500\uff0c\u53ef\u4ee5\u66f4\u9ad8\u9891\u5730\u66f4\u65b0\u3002\u7279\u522b\u9002\u7528\u4e8e\u5927\u89c4\u6a21\u6570\u636e\u96c6\u6216\u9891\u7e41\u66f4\u65b0\u7684\u573a\u666f\u3002</p> <p>\u5168\u91cf\u5237\u65b0\u9002\u7528\u4e8e T+1 \u7c7b\u7684\u79bb\u7ebf\u573a\u666f\u3002\u5e38\u89c1\u7684\u9002\u7528\u573a\u666f\u5982\u4e0b\uff1a</p> <ul> <li> <p>\u6570\u636e\u6bcf\u5929\u6279\u91cf\u66f4\u65b0\u4e00\u6b21\uff0c\u6216\u8005\u5c0f\u65f6\u7ea7\u522b\u66f4\u65b0\u4e00\u6b21\uff0c\u66f4\u9002\u5408\u5168\u91cf\u5237\u65b0\u3002\u8fd9\u7c7b SQL \u901a\u5e38\u6bd4\u8f83\u590d\u6742\uff0c\u5168\u91cf\u5237\u65b0\u5bf9 SQL \u8bed\u6cd5\u6ca1\u6709\u4efb\u4f55\u7ea6\u675f\u3002</p> </li> <li> <p>\u5728\u67d0\u4e9b\u5206\u949f\u7ea7\u522b\u5ef6\u8fdf\u7684\u573a\u666f\u4e2d\u4e5f\u53ef\u4ee5\u4f7f\u7528\u5168\u91cf\u5237\u65b0\uff0c\u5f80\u5f80\u8fd9\u7c7b SQL \u5373\u4f7f\u5168\u91cf\u8ba1\u7b97\u6210\u672c\u4e5f\u4e0d\u5927\uff0c\u901a\u5e38\u5341\u51e0\u79d2\u80fd\u5b8c\u6210\uff0c\u8fd8\u53ef\u4ee5\u8fbe\u5230\u4e00\u5b9a\u7684\u5b9e\u65f6\u6548\u679c\u3002</p> </li> </ul> <p>\u589e\u91cf\u5237\u65b0\u9002\u7528\u4e8e**\u5b9e\u65f6\u573a\u666f**\u3002\u5e38\u89c1\u7684\u9002\u7528\u573a\u666f\u5982\u4e0b\uff1a</p> <ul> <li> <p>\u6570\u636e\u5b9e\u65f6\u6d41\u5165\u3002</p> </li> <li> <p>\u9700\u8981\u5b9e\u65f6\u66f4\u65b0\u7684\u62a5\u8868\u6216 ETL\u3002</p> </li> <li> <p>\u5bf9\u6570\u636e\u5ef6\u8fdf\u8981\u6c42\u9ad8\u7684\u79d2\u7ea7\u5ef6\u8fdf\u9700\u6c42\u3002</p> </li> </ul> <p>\u6839\u636e\u7269\u5316\u89c6\u56fe\u7684\u66f4\u65b0\u5468\u671f\uff0cStarRocks \u652f\u6301\u4e24\u79cd\u7c7b\u578b\u7684\u7269\u5316\u89c6\u56fe\uff1a\u540c\u6b65\u7269\u5316\u89c6\u56fe \u548c \u5f02\u6b65\u7269\u5316\u89c6\u56fe</p> <p>\u589e\u91cf\u66f4\u65b0\u7684\u539f\u7406\uff1a\u7269\u5316\u89c6\u56fe\u589e\u91cf\u66f4\u65b0\uff08IVM\uff09\u7684\u6838\u5fc3\u5728\u4e8e\"\u589e\u91cf\"\uff0c\u4ec5\u5904\u7406\u81ea\u4e0a\u6b21\u66f4\u65b0\u4ee5\u6765\u7684\u6570\u636e\u53d8\u52a8\uff0c\u907f\u514d\u91cd\u65b0\u8ba1\u7b97\u6574\u4e2a\u89c6\u56fe\uff0c\u663e\u8457\u964d\u4f4e\u8ba1\u7b97\u548c\u65f6\u95f4\u5f00\u9500\u3002\u901a\u8fc7\u6355\u83b7\u5e76\u8ba1\u7b97\u589e\u91cf\u6570\u636e\uff0c\u5b83\u80fd\u9ad8\u6548\u7ef4\u62a4\u6700\u65b0\u6570\u636e\u7ed3\u679c\uff0c\u5728\u5b9e\u65f6\u6570\u636e\u5206\u6790\u3001\u62a5\u8868\u751f\u6210\u548c\u6570\u636e\u540c\u6b65\u7b49\u573a\u666f\u4e2d\uff0c\u6210\u4e3a\u63d0\u5347\u67e5\u8be2\u6027\u80fd\u3001\u51cf\u5c11\u5b58\u50a8\u5f00\u9500\u7684\u4e0d\u53ef\u6216\u7f3a\u5de5\u5177\u3002</p> <p>(1) \u53d8\u66f4\u6355\u83b7 \u589e\u91cf\u66f4\u65b0\u7684\u6838\u5fc3\u5728\u4e8e\u6355\u83b7\u57fa\u7840\u8868\u4e2d\u7684\u53d8\u66f4\u6570\u636e\u3002\u5e38\u89c1\u7684\u65b9\u6cd5\u5305\u62ec\uff1a</p> <ul> <li>\u4e8b\u52a1\u65e5\u5fd7\u89e3\u6790 \uff1a\u89e3\u6790\u6570\u636e\u5e93\u7684\u4e8b\u52a1\u65e5\u5fd7\uff08\u5982 Redo Log \u6216 Write-Ahead Log\uff09\uff0c\u63d0\u53d6\u65b0\u589e\u3001\u4fee\u6539\u6216\u5220\u9664\u7684\u8bb0\u5f55\u3002</li> <li>\u89e6\u53d1\u5668 \uff1a\u5728\u57fa\u7840\u8868\u4e0a\u5b9a\u4e49\u89e6\u53d1\u5668\uff0c\u5c06\u53d8\u66f4\u8bb0\u5f55\u5199\u5165\u4e00\u4e2a\u8f85\u52a9\u8868\uff08Change Log Table\uff09\u3002</li> <li>\u65f6\u95f4\u6233\u6216\u7248\u672c\u53f7 \uff1a\u901a\u8fc7\u65f6\u95f4\u6233\u6216\u7248\u672c\u53f7\u6807\u8bb0\u8bb0\u5f55\u7684\u66f4\u65b0\u72b6\u6001\u3002</li> </ul> <p>(2) \u5dee\u5f02\u8ba1\u7b97 \u6839\u636e\u6355\u83b7\u7684\u53d8\u66f4\u6570\u636e\uff0c\u8ba1\u7b97\u5bf9\u7269\u5316\u89c6\u56fe\u7684\u5f71\u54cd\uff1a</p> <ul> <li>\u5982\u679c\u67d0\u6761\u8bb0\u5f55\u88ab\u63d2\u5165\u5230\u57fa\u7840\u8868\u4e2d\uff0c\u5219\u5c06\u5176\u52a0\u5165\u7269\u5316\u89c6\u56fe\u3002</li> <li>\u5982\u679c\u67d0\u6761\u8bb0\u5f55\u88ab\u4fee\u6539\uff0c\u5219\u66f4\u65b0\u7269\u5316\u89c6\u56fe\u4e2d\u5bf9\u5e94\u7684\u805a\u5408\u503c\u3002</li> <li>\u5982\u679c\u67d0\u6761\u8bb0\u5f55\u88ab\u5220\u9664\uff0c\u5219\u4ece\u7269\u5316\u89c6\u56fe\u4e2d\u79fb\u9664\u76f8\u5e94\u7684\u7ed3\u679c\u3002</li> </ul> <p>(3) \u66f4\u65b0\u7269\u5316\u89c6\u56fe \u5c06\u8ba1\u7b97\u51fa\u7684\u5dee\u5f02\u5e94\u7528\u5230\u7269\u5316\u89c6\u56fe\u4e2d\uff0c\u5b8c\u6210\u589e\u91cf\u66f4\u65b0\u3002</p> <p>\u7269\u5316\u89c6\u56fe\u67e5\u8be2\u6539\u5199\u548c\u900f\u660e\u52a0\u901f</p> <p>\u7269\u5316\u89c6\u56fe\uff08Materialized View\uff09\u7684**\u67e5\u8be2\u6539\u5199**\u529f\u80fd\uff08Query Rewrite\uff09</p> <p>\u8fd9\u662f Oracle \u6570\u636e\u5e93\u7684\u4e00\u9879\u6838\u5fc3\u4f18\u5316\u6280\u672f\uff0c\u5141\u8bb8\u6570\u636e\u5e93\u4f18\u5316\u5668\u5728\u6267\u884c\u7528\u6237\u67e5\u8be2\u65f6\uff0c\u81ea\u52a8\u5c06\u67e5\u8be2\u91cd\u5199\u4e3a\u5bf9\u7269\u5316\u89c6\u56fe\u7684\u8bbf\u95ee\uff0c\u4ece\u800c\u907f\u514d\u5bf9\u57fa\u7840\u8868\u8fdb\u884c\u5b9e\u65f6\u8ba1\u7b97\u3002</p> <p>\u4f18\u5316\u5668\u80fd\u591f\u81ea\u52a8\u68c0\u6d4b\u7528\u6237\u7684\u67e5\u8be2\uff0c\u5e76\u5c1d\u8bd5\u5c06\u5176\u91cd\u5199\u4e3a\u5bf9\u7269\u5316\u89c6\u56fe\u7684\u8bbf\u95ee\u3002\u57fa\u672c\u5de5\u4f5c\u539f\u7406\uff1a\u7528\u6237\u53ea\u9700\u63d0\u4ea4\u6807\u51c6 SQL \u67e5\u8be2\uff0c\u7cfb\u7edf\u4f1a\u81ea\u52a8\u9009\u62e9\u6700\u4f18\u7684\u6267\u884c\u8ba1\u5212(\u4f18\u5316\u5668\u4f1a\u5206\u6790\u7528\u6237\u7684\u67e5\u8be2\uff0c\u5e76\u5c06\u5176\u4e0e\u73b0\u6709\u7684\u7269\u5316\u89c6\u56fe\u8fdb\u884c\u5339\u914d\u3002\u5982\u679c\u5339\u914d\u6210\u529f\uff0c\u4f18\u5316\u5668\u4f1a\u751f\u6210\u4e00\u4e2a\u65b0\u7684\u67e5\u8be2\u8ba1\u5212\uff0c\u5c06\u7528\u6237\u5bf9\u539f\u59cb\u57fa\u8868\u7684\u67e5\u8be2\u91cd\u5199\u4e3a\u5bf9\u7269\u5316\u89c6\u56fe\u7684\u8bbf\u95ee)\u3002\u8fd9\u4e00\u8fc7\u7a0b\u5bf9\u7528\u6237\u5b8c\u5168\u900f\u660e\uff0c\u4ee5\u8fbe\u5230\u900f\u660e\u52a0\u901f\u7684\u6548\u679c</p> <pre><code>-- \u539f\u59cb\u8868\nCREATE TABLE sales (\n    id INT,\n    region VARCHAR(50),\n    amount DECIMAL(10, 2)\n);\n\n-- \u7269\u5316\u89c6\u56fe\nCREATE MATERIALIZED VIEW mv_sales_summary\n    BUILD IMMEDIATE\n    REFRESH FAST ON COMMIT\nE\n\nNABLE QUERY REWRITE\nAS\nSELECT region, SUM(amount) AS total_sales\nFROM sales\nGROUP BY region;\n\n\n-- \u539f\u59cb\u67e5\u8be2\nSELECT region, SUM(amount) FROM sales GROUP BY region;\n\n-- \u4f18\u5316\u5668\u6539\u5199\nSELECT region, total_sales FROM mv_sales_summary;\n</code></pre>"},{"location":"olap/01.OLAP%E6%A6%82%E8%BF%B0/#_21","title":"\u8fbe\u68a6\u7269\u5316\u89c6\u56fe","text":"<p>\u7269\u5316\u89c6\u56fe (MATERIALIZED VIEW) \u662f\u76ee\u6807\u8868\u5728\u7279\u5b9a\u65f6\u95f4\u70b9\u4e0a\u7684\u4e00\u4e2a\u526f\u672c\uff0c**\u8981\u5360\u7528\u989d\u5916\u7684\u5b58\u50a8\u7a7a\u95f4\uff0c\u5373\u5c06\u67e5\u8be2\u51fa\u6765\u7684\u6570\u636e\u5b58\u50a8\u5728\u6570\u636e\u5e93**\u4e2d\u3002\u5f53\u6240\u4f9d\u8d56\u7684\u4e00\u4e2a\u6216\u591a\u4e2a\u57fa\u8868\u7684\u6570\u636e\u53d1\u751f\u66f4\u65b0\uff0c\u5fc5\u987b\u542f\u7528\u5237\u65b0\u673a\u5236\u624d\u80fd\u4fdd\u8bc1\u6570\u636e\u662f\u6700\u65b0\u7684\u3002</p> <p>\u7269\u5316\u89c6\u56fe\u53ef\u4ee5\u7528\u4e8e\u6570\u636e\u590d\u5236\uff08Data Replication\uff09\uff0c\u4e5f\u53ef\u7528\u4e8e\u6570\u636e\u4ed3\u5e93\u7f13\u5b58\u7ed3\u679c\u96c6\u4ee5\u6b64\u6765\u63d0\u5347\u590d\u6742\u67e5\u8be2\u7684\u6027\u80fd\u3002</p> <pre><code>SET SCHEMA DB_QHDATA_MACRO;\n\nCREATE TABLE \"DB_QHDATA_MACRO\".\"macro_index_data\"\n(\n    \"rid\" INT IDENTITY(42481576, 1) NOT NULL,\n    \"index_code\" VARCHAR(50) NOT NULL,\n    \"occur_period\" INT,\n    \"occur_period_t\" VARCHAR(20),\n    \"occur_period_year\" INT,\n    \"occur_period_month\" INT,\n    \"area_code\" VARCHAR(32) NOT NULL,\n    \"dim_cal\" VARCHAR(32),\n    \"dim_dur\" VARCHAR(32),\n    \"dim_extra\" VARCHAR(32),\n    \"index_value\" DECIMAL(38,8),\n    \"unit_use\" VARCHAR(50),\n    \"label\" INT NOT NULL,\n    \"source_code\" VARCHAR(100),\n    \"update_time\" TIMESTAMP(0) DEFAULT CURRENT_TIMESTAMP(),\n    \"area_code_type\" INT,\n  NOT CLUSTER PRIMARY KEY(\"rid\", \"label\")\n) STORAGE(USING LONG ROW, ON \"MAIN\", CLUSTERBTR) ;\n\nCOMMENT ON COLUMN DB_QHDATA_MACRO.macro_index_data.index_code IS '\u6307\u6807\u540d\u79f0';\nCOMMENT ON COLUMN DB_QHDATA_MACRO.macro_index_data.occur_period IS '\u6570\u636e\u671f';\nCOMMENT ON COLUMN DB_QHDATA_MACRO.macro_index_data.occur_period_t IS 'tableau\u4e13\u7528\u6570\u636e\u671f';\nCOMMENT ON COLUMN DB_QHDATA_MACRO.macro_index_data.occur_period_year IS '\u5e74';\nCOMMENT ON COLUMN DB_QHDATA_MACRO.macro_index_data.occur_period_month IS '\u6708';\nCOMMENT ON COLUMN DB_QHDATA_MACRO.macro_index_data.area_code IS '\u533a\u5212\u4ee3\u7801';\nCOMMENT ON COLUMN DB_QHDATA_MACRO.macro_index_data.dim_cal IS '\u8ba1\u7b97\u7c7b\u578b';\nCOMMENT ON COLUMN DB_QHDATA_MACRO.macro_index_data.dim_dur IS '\u65f6\u95f4\u7279\u5f81';\nCOMMENT ON COLUMN DB_QHDATA_MACRO.macro_index_data.dim_extra IS '\u5176\u4ed6\u7ef4\u5ea6';\nCOMMENT ON COLUMN DB_QHDATA_MACRO.macro_index_data.index_value IS '\u7edd\u5bf9\u503c';\nCOMMENT ON COLUMN DB_QHDATA_MACRO.macro_index_data.unit_use IS '\u5e93\u4e2d\u4f7f\u7528\u5355\u4f4d';\nCOMMENT ON COLUMN DB_QHDATA_MACRO.macro_index_data.label IS '\u6570\u636e\u5c5e\u6027\uff081\u4ee3\u8868\u5b98\u65b9\u516c\u5e03\u5b8f\u89c2\u6570\u636e\uff0c2\u4ee3\u8868\u4e2d\u89c2\u6570\u636e\uff09';\nCOMMENT ON COLUMN DB_QHDATA_MACRO.macro_index_data.source_code IS '\u6570\u636e\u6765\u6e90';\nCOMMENT ON COLUMN DB_QHDATA_MACRO.macro_index_data.update_time IS '\u66f4\u65b0\u65f6\u95f4';\nCOMMENT ON COLUMN DB_QHDATA_MACRO.macro_index_data.area_code_type IS '\u533a\u5212\u4ee3\u7801\u7c7b\u578b\uff081-\u884c\u653f\u533a 2-\u5173\u533a 3-\u7247\u533a 4-\u56ed\u533a\uff09';\n\nCOMMENT ON TABLE DB_QHDATA_MACRO.macro_index_data IS '\u5b8f\u89c2\u6307\u6807\u6570\u636e\u8868';\n\n\n\n\n-- \u5982\u679c\u5bf9\u8fd9\u4e2a\u8868\u7ecf\u5e38\u8fdb\u884c\u8fd9\u7c7b\u67e5\u8be2\nSELECT\n    OCCUR_PERIOD,SUM(index_value)\nFROM DB_QHDATA_MACRO.macro_index_data\nWHERE  index_code=? AND dim_extra=?\nGROUP BY OCCUR_PERIOD ORDER BY occur_period DESC\n\n\n-- \u521b\u5efa\u7269\u5316\u89c6\u56fe mv_macro_index_data_summary\nCREATE MATERIALIZED VIEW mv_macro_index_data_summary\nENABLE QUERY REWRITE    -- \u542f\u7528\u67e5\u8be2\u6539\u5199\nREFRESH FAST ON COMMIT  -- \u589e\u91cf\u5237\u65b0\nAS\nSELECT\n    index_code,\n    dim_extra,\n    OCCUR_PERIOD,\n    SUM(index_value) AS total_index_value\nFROM DB_QHDATA_MACRO.macro_index_data\nGROUP BY index_code, dim_extra, OCCUR_PERIOD\nORDER BY index_code, dim_extra, OCCUR_PERIOD DESC;\n\n-- \u5728\u539f\u59cb\u67e5\u8be2\u4e2d\uff0cindex_code \u548c dim_extra \u662f\u52a8\u6001\u53c2\u6570\uff08\u7528 ? \u8868\u793a\uff09\u3002\u4e3a\u4e86\u652f\u6301\u4efb\u610f\u7ec4\u5408\u7684\u67e5\u8be2\uff0c\u7269\u5316\u89c6\u56fe\u9700\u8981\u5305\u542b\u6240\u6709\u53ef\u80fd\u7684(index_code,dim_extra,OCCUR_PERIOD) \u7ec4\u5408\u3002\u5728\u7269\u5316\u89c6\u56fe mv_macro_index_data_summary\uff0c\u80fd\u591f\u663e\u8457\u63d0\u5347\u6d89\u53ca index_code \u548c dim_extra \u8fc7\u6ee4\u6761\u4ef6\u7684\u67e5\u8be2\u6027\u80fd\u3002\u9884\u8ba1\u7b97\u6309\u7167\u4e09\u4e2a\u5b57\u6bb5\u5206\u7ec4\u540e\u7684\u805a\u5408\u6570\u636e\n\n\n\nSELECT\n    OCCUR_PERIOD,SUM(index_value)\nFROM DB_QHDATA_MACRO.macro_index_data\nWHERE    index_code='gmjj_gnmy_01' AND dim_extra='CITY_TARGET'\nGROUP BY OCCUR_PERIOD ORDER BY occur_period DESC;\n\n\n\n-- \u901a\u5e38\uff0c\u5355\u8868\u67e5\u8be2\u57fa\u672c\u7528\u4e0d\u4e0a\u8fd9\u79cd MV\uff0c\u8fd8\u4e0d\u5982\u76f4\u63a5\u9488\u5bf9\u4e00\u4e9b\u5173\u952e\u5b57\u6bb5\u6dfb\u52a0\u7d22\u5f15\u6765\u7684\u9ad8\u6548\uff0c\u8fd9\u4e2a\u4f8b\u5b50\u53ea\u662f\u4e3a\u4e86\u6f14\u793a\u8fd9\u79cd\u9884\u8ba1\u7b97\u7684\u6548\u679c\u3002\n</code></pre>"},{"location":"olap/01.OLAP%E6%A6%82%E8%BF%B0/#_22","title":"\u8868\u51fd\u6570","text":"<p>\u8868\u51fd\u6570\uff0c\u987e\u540d\u601d\u4e49\uff0c\u4ee5\u8868\uff08tabled-value\uff0c\u591a\u884c\u6570\u636e\u96c6\uff09\u4e3a\u8fd4\u56de\u503c\u7684\u51fd\u6570\u3002\u4e0e\u5355\u884c\u51fd\u6570\u3001\u805a\u5408\u51fd\u6570\u76f8\u6bd4\uff0c\u5b83\u6bd4\u8f83\u5c0f\u4f17\uff0c\u4ee5\u81f3\u4e8e\u6709\u5f88\u591a\u591a\u5e74\u4ece\u4e8b\u6570\u636e\u5f00\u53d1\u7684\u4eba\u5458\u90fd\u95fb\u6240\u672a\u95fb\u3002</p>"},{"location":"olap/02.Hbase/","title":"02.Hbase","text":"<p>HBase\u662f\u4e00\u79cd\u5206\u5e03\u5f0f\u3001\u53ef\u6269\u5c55\u3001\u652f\u6301\u6d77\u91cf\u6570\u636e\u5b58\u50a8\u7684NoSQL\u6570\u636e\u5e93\u3002</p> <p>\u903b\u8f91\u4e0a\uff0cHBase\u7684\u6570\u636e\u6a21\u578b\u540c\u5173\u7cfb\u578b\u6570\u636e\u5e93\u5f88\u7c7b\u4f3c\uff0c\u6570\u636e\u5b58\u50a8\u5728\u4e00\u5f20\u8868\u4e2d\uff0c\u6709\u884c\u6709\u5217\u3002\u4f46\u4eceHBase\u7684\u5e95\u5c42\u7269\u7406\u5b58\u50a8\u7ed3\u6784\uff08K-V\uff09\u6765\u770b\uff0cHBase\u66f4\u50cf\u662f\u4e00\u4e2a\u591a\u7ef4\u5ea6\u7684map</p> <p>\u5b83\u4e3b\u8981\u9002\u7528\u4e8e\u6d77\u91cf\u660e\u7ec6\u6570\u636e\uff08\u5341\u4ebf\u3001\u767e\u4ebf\uff09\u7684\u968f\u673a\u5b9e\u65f6\u67e5\u8be2\uff0c\u5982\u65e5\u5fd7\u660e\u7ec6\u3001\u4ea4\u6613\u6e05\u5355\u3001\u8f68\u8ff9\u884c\u4e3a\u7b49\u3002</p> <p>\u5b83\u4f7f\u7528\u7684\u6587\u4ef6\u7cfb\u7edf\u662f\u53ef\u63d2\u62d4\u7684\uff0c\u4e5f\u5c31\u662f\u8bf4\u5b83\u65e2\u53ef\u4ee5\u4f7f\u7528\u672c\u5730\u7684\u6587\u4ef6\u7cfb\u7edf\uff0c\u53c8\u53ef\u4ee5\u4f7f\u7528\u66f4\u9ad8\u4e00\u5c42\u62bd\u8c61\u7684\u7cfb\u7edf\u5982HDFS\u4f5c\u4e3a\u6587\u4ef6\u7cfb\u7edf\uff0c\u5b9e\u9645\u4e0aHDFS\u662fHBase\u6700\u5e38\u7528\u7684\u6587\u4ef6\u7cfb\u7edf\u3002</p>"},{"location":"olap/02.Hbase/#_1","title":"\u672f\u8bed","text":"<p>Namespace</p> <p>\u547d\u540d\u7a7a\u95f4\uff0c\u7c7b\u4f3c\u4e8e\u5173\u7cfb\u578b\u6570\u636e\u5e93\u7684DataBase\u6982\u5ff5\uff0c\u6bcf\u4e2a\u547d\u540d\u7a7a\u95f4\u4e0b\u6709\u591a\u4e2a\u8868\u3002HBase\u6709\u4e24\u4e2a\u81ea\u5e26\u7684\u547d\u540d\u7a7a\u95f4\u5206\u522b\u662fhbase\u548cdefault\u3002hbase\u4e2d\u5b58\u653e\u7684\u662fHBase\u5185\u7f6e\u7684\u8868\uff0c default\u8868\u662f\u7528\u6237\u9ed8\u8ba4\u4f7f\u7528\u7684\u547d\u540d\u7a7a\u95f4\u3002</p> <p>2\uff09Region</p> <p>\u6309\u7167\u6570\u636e\u91cf\u5207\u5206\u7684\u884c\u7ec4\u6210\u7684\u5207\u7247\u79f0\u4e3aRegion\u3002</p> <p>3\uff09Row</p> <p>HBase\u8868\u4e2d\u7684\u6bcf\u884c\u6570\u636e\u90fd\u7531\u4e00\u4e2aRowKey\u548c\u591a\u4e2aColumn\uff08\u5217\uff09\u7ec4\u6210\uff0c\u6570\u636e\u662f\u6309\u7167RowKey\u7684\u5b57\u5178\u987a\u5e8f\u5b58\u50a8\u7684\uff0c\u5e76\u4e14\u67e5\u8be2\u6570\u636e\u65f6\u53ea\u80fd\u6839\u636e RowKey \u8fdb\u884c\u68c0\u7d22\uff0c\u6240\u4ee5RowKey\u7684\u8bbe\u8ba1\u5341\u5206\u91cd\u8981\u3002</p> <p>4\uff09Column</p> <p>HBase\u4e2d\u7684\u6bcf\u4e2a\u5217\u90fd\u7531Column Family\uff08\u5217\u65cf\uff09\u548cColumn Qualifier\uff08\u5217\u9650\u5b9a\u7b26\uff09\u8fdb\u884c\u9650\u5b9a\u3002\u5efa\u8868\u65f6\u53ea\u9700\u6307\u660e\u5217\u65cf\uff0c\u800c\u5217\u9650\u5b9a\u7b26\u65e0\u9700\u9884\u5148\u5b9a\u4e49\u3002</p> <p>5\uff09Timestamp</p> <p>\u7528\u4e8e\u6807\u8bc6\u6570\u636e\u7684\u4e0d\u540c\u7248\u672c\uff08version\uff09\uff0c\u6bcf\u6761\u6570\u636e\u5199\u5165\u65f6\uff0c\u5982\u679c\u4e0d\u6307\u5b9a\u65f6\u95f4\u6233\uff0c\u7cfb\u7edf\u4f1a\u81ea\u52a8\u4e3a\u5176\u52a0\u4e0a\u8be5\u5b57\u6bb5\uff0c\u5176\u503c\u4e3a\u5199\u5165HBase\u7684\u65f6\u95f4\u3002</p> <p>6\uff09Cell</p> <p>\u7531{rowkey, column Family:column Qualifier, timestamp}\u552f\u4e00\u786e\u5b9a\u7684\u5355\u5143\u3002cell\u4e2d\u7684\u6570\u636e\u662f\u6ca1\u6709\u7c7b\u578b\u7684\uff0c\u5168\u90e8\u662f\u5b57\u8282\u7801\u5f62\u5f0f\u5b58\u50a8\u3002</p> <pre><code>&lt;!-- \u6bcf\u4e2aregionServer\u7684\u5171\u4eab\u76ee\u5f55,\u7528\u6765\u6301\u4e45\u5316Hbase,\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u5728/tmp/hbase\u4e0b\u9762 --&gt;  \n&lt;property&gt; \n  &lt;name&gt;hbase.rootdir&lt;/name&gt;  \n  &lt;value&gt;/hbase&lt;/value&gt;  \n&lt;/property&gt;  \n\n&lt;!-- hbase\u96c6\u7fa4\u6a21\u5f0f,false\u8868\u793ahbase\u7684\u5355\u673a\uff0ctrue\u8868\u793a\u662f\u5206\u5e03\u5f0f\u6a21\u5f0f --&gt;  \n&lt;property&gt;  \n  &lt;name&gt;hbase.cluster.distributed&lt;/name&gt;  \n  &lt;value&gt;true&lt;/value&gt;  \n&lt;/property&gt;  \n\n&lt;!-- hbase master\u8282\u70b9\u7684\u7aef\u53e3 --&gt;  \n&lt;property&gt;  \n  &lt;name&gt;hbase.master.port&lt;/name&gt;  \n  &lt;value&gt;16000&lt;/value&gt;\n&lt;/property&gt; \n\n&lt;!-- hbase master\u7684web ui\u9875\u9762\u7684\u7aef\u53e3 --&gt;  \n&lt;property&gt;  \n  &lt;name&gt;hbase.master.info.port&lt;/name&gt;  \n  &lt;value&gt;16010&lt;/value&gt;  \n&lt;/property&gt;  \n\n&lt;!-- hbase master\u7684web ui\u9875\u9762\u7ed1\u5b9a\u7684\u5730\u5740 --&gt;  \n&lt;property&gt; \n  &lt;name&gt;hbase.master.info.bindAddress&lt;/name&gt;  \n  &lt;value&gt;0.0.0.0&lt;/value&gt;\n&lt;/property&gt;\n\n&lt;!-- hbase\u4f9d\u8d56\u7684zk\u5730\u5740 --&gt;  \n&lt;property&gt;  \n  &lt;name&gt;hbase.zookeeper.quorum&lt;/name&gt;  \n  &lt;value&gt;centos161,centos162,centos163&lt;/value&gt;  \n&lt;/property&gt;\n\n&lt;!-- zookeeper\u7684\u5de5\u4f5c\u76ee\u5f55 --&gt;\n&lt;property&gt;  \n  &lt;name&gt;hbase.zookeeper.property.dataDir&lt;/name&gt;  \n  &lt;value&gt;/opt/module/zookeeper/data&lt;/value&gt;  \n&lt;/property&gt;  \n\n&lt;!-- \u4e00\u4e2aregion\u8fdb\u884cmajor compaction\u5408\u5e76\u7684\u5468\u671f\uff0c\u5728\u8fd9\u4e2a\u70b9\u7684\u65f6\u5019\uff0c\u8fd9\u4e2aregion\u4e0b\u7684\u6240\u6709hfile\u4f1a\u8fdb\u884c\u5408\u5e76\uff0c\u9ed8\u8ba4\u662f7\u5929\u3002major   \n        compaction\u975e\u5e38\u8017\u8d44\u6e90,\u5efa\u8bae\u751f\u4ea7\u5173\u95ed(\u8bbe\u7f6e\u4e3a0)\uff0c\u5728\u5e94\u7528\u7a7a\u95f2\u65f6\u95f4\u624b\u52a8\u89e6\u53d1\u3010compact \u8868\u540d\u3011 --&gt;  \n&lt;property&gt;  \n  &lt;name&gt;hbase.hregion.majorcompaction&lt;/name&gt;  \n  &lt;value&gt;604800000&lt;/value&gt;  \n&lt;/property&gt;  \n\n&lt;!-- \u4e00\u4e2a\u6296\u52a8\u6bd4\u4f8b\uff0c\u610f\u601d\u662f\u8bf4\u4e0a\u4e00\u4e2a\u53c2\u6570\u8bbe\u7f6e\u662f7\u5929\u8fdb\u884c\u4e00\u6b21\u5408\u5e76\uff0c\u4e5f\u53ef\u4ee5\u670950%\u7684\u6296\u52a8\u6bd4\u4f8b\uff0c\u751f\u4ea7\u73af\u5883majorcompaction\u5e94\u8be5\u88ab\u5173\u95ed\uff0c\u6b64\u53c2\u6570\u5c31\u4e0d\u91cd\u8981\u4e86 --&gt;  \n&lt;property&gt;  \n  &lt;name&gt;hbase.hregion.majorcompaction.jitter&lt;/name&gt;  \n  &lt;value&gt;0.50&lt;/value&gt;  \n&lt;/property&gt;  \n\n&lt;!-- \u4e00\u4e2astore\u91cc\u9762\u5141\u8bb8\u5b58\u7684hfile\u7684\u4e2a\u6570\uff0c\u8d85\u8fc7\u8fd9\u4e2a\u4e2a\u6570\u4f1a\u88ab\u5199\u5230\u65b0\u7684\u4e00\u4e2ahfile\u91cc\u9762 \u4e5f\u5373\u662f\u6bcf\u4e2aregion\u7684\u6bcf\u4e2a\u5217\u65cf\u5bf9\u5e94\u7684memstore\u5728fulsh\u4e3ahfile\u7684\u65f6\u5019\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u5f53\u8fbe\u52303\u4e2ahfile\u7684\u65f6\u5019\u5c31\u4f1a\u5bf9\u8fd9\u4e9b\u6587\u4ef6\u8fdb\u884c\u5408\u5e76\u91cd\u5199\u4e3a\u4e00\u4e2a\u65b0\u6587\u4ef6\uff0c\u8bbe\u7f6e\u4e2a\u6570\u8d8a\u5927\u53ef\u4ee5\u51cf\u5c11\u89e6\u53d1\u5408\u5e76\u7684\u65f6\u95f4\uff0c\u4f46\u662f\u6bcf\u6b21\u5408\u5e76\u7684\u65f6\u95f4\u5c31\u4f1a\u8d8a\u957f --&gt;  \n&lt;property&gt;  \n  &lt;name&gt;hbase.hstore.compactionThreshold&lt;/name&gt;  \n  &lt;value&gt;3&lt;/value&gt;  \n&lt;/property&gt;\n\n&lt;!-- #######################################\u4ee5\u4e0b\u662f\u975e\u5fc5\u987b\u914d\u7f6e\u53c2\u6570####################################### --&gt;\n&lt;!-- regionServer\u7684\u5168\u5c40memstore\u7684\u5927\u5c0f\uff0c\u8d85\u8fc7\u8be5\u5927\u5c0f\u4f1a\u89e6\u53d1flush\u5230\u78c1\u76d8\u7684\u64cd\u4f5c\uff0c\u9ed8\u8ba4\u662f\u5806\u5927\u5c0f\u768440%\uff0c\u800c\u4e14regionserver\u7ea7\u522b\u7684flush\u4f1a\u963b\u585e\u5ba2\u6237\u7aef\u8bfb\u5199 --&gt;  \n&lt;property&gt;  \n  &lt;name&gt;hbase.regionserver.global.memstore.size&lt;/name&gt;  \n  &lt;value&gt;&lt;/value&gt;  \n&lt;/property&gt; \n\n&lt;!-- \u53ef\u4ee5\u7406\u89e3\u4e3a\u4e00\u4e2a\u5b89\u5168\u7684\u8bbe\u7f6e\uff0c\u6709\u65f6\u5019\u96c6\u7fa4\u7684\u201c\u5199\u8d1f\u8f7d\u201d\u975e\u5e38\u9ad8\uff0c\u5199\u5165\u91cf\u4e00\u76f4\u8d85\u8fc7flush\u7684\u91cf\uff0c\u8fd9\u65f6\u6211\u4eec\u5c31\u5e0c\u671bmemstore\u4e0d\u8981\u8d85\u8fc7\u4e00\u5b9a\u7684\u5b89\u5168\u8bbe\u7f6e\u3002\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u5199\u64cd\u4f5c\u5c31\u8981\u88ab\u963b\u585e\u4e00\u76f4\u5230memstore\u6062\u590d\u5230\u4e00\u4e2a\u201c\u53ef\u7ba1\u7406\u201d\u7684\u5927\u5c0f\uff0c\u8fd9\u4e2a\u5927\u5c0f\u5c31\u662f\u9ed8\u8ba4\u503c\u662f\u5806\u5927\u5c0f*0.4*0.95\uff0c\u4e5f\u5c31\u662f\u5f53regionserver\u7ea7\u522b\u7684flush\u64cd\u4f5c\u53d1\u9001\u540e\uff0c\u4f1a\u963b\u585e\u5ba2\u6237\u7aef\u5199\uff0c\u4e00\u76f4\u963b\u585e\u5230\u6574\u4e2aregionserver\u7ea7\u522b\u7684memstore\u7684\u5927\u5c0f\u4e3a\u5806\u5927\u5c0f*0.4*0.95\u4e3a\u6b62 --&gt;  \n&lt;property&gt;  \n  &lt;name&gt;hbase.regionserver.global.memstore.size.lower.limit&lt;/name&gt;  \n  &lt;value&gt;&lt;/value&gt;  \n&lt;/property&gt;  \n\n&lt;!-- \u5185\u5b58\u4e2d\u7684\u6587\u4ef6\u5728\u81ea\u52a8\u5237\u65b0\u4e4b\u524d\u80fd\u591f\u5b58\u6d3b\u7684\u6700\u957f\u65f6\u95f4\uff0c\u9ed8\u8ba4\u662f1h --&gt;  \n&lt;property&gt;  \n  &lt;name&gt;hbase.regionserver.optionalcacheflushinterval&lt;/name&gt;  \n  &lt;value&gt;3600000&lt;/value&gt;  \n&lt;/property&gt;\n\n\n&lt;!-- \u5355\u4e2aregion\u91ccmemstore\u7684\u7f13\u5b58\u5927\u5c0f\uff0c\u8d85\u8fc7\u90a3\u4e48\u6574\u4e2aHRegion\u5c31\u4f1aflush,\u9ed8\u8ba4128M --&gt;  \n&lt;property&gt;  \n  &lt;name&gt;hbase.hregion.memstore.flush.size&lt;/name&gt;  \n  &lt;value&gt;134217728&lt;/value&gt;  \n&lt;/property&gt;  \n</code></pre>"},{"location":"optimize/1.overview/","title":"\u6570\u636e\u5e93\u8c03\u4f18\u6982\u8ff0","text":""},{"location":"optimize/1.overview/#_2","title":"\u4e00\u3001\u5f15\u8a00","text":"<p>\u5728\u7f51\u4e0a\u6709\u5f88\u591a\u6587\u7ae0\u4ecb\u7ecd\u6570\u636e\u5e93\u4f18\u5316\u77e5\u8bc6\uff0c\u4f46\u662f\u5927\u90e8\u4efd\u6587\u7ae0\u53ea\u662f\u5bf9\u67d0\u4e2a\u4e00\u4e2a\u65b9\u9762\u8fdb\u884c\u8bf4\u660e\uff0c\u800c\u5bf9\u4e8e\u6211\u4eec\u6765\u8bf4\u8fd9\u79cd\u4ecb\u7ecd\u5e76\u4e0d\u80fd\u5f88\u597d\u7684\u638c\u63e1\u4f18\u5316\u77e5\u8bc6\uff0c\u56e0\u4e3a\u5f88\u591a\u4ecb\u7ecd\u53ea\u662f\u5bf9\u4e00\u4e9b\u7279\u5b9a\u7684\u573a\u666f\u4f18\u5316\u7684\uff0c\u6240\u4ee5\u53cd\u800c\u6709\u65f6\u4f1a\u4ea7\u751f\u8bef\u5bfc\u6216\u8ba9\u4eba\u611f\u89c9\u4e0d\u660e\u767d\u5176\u4e2d\u7684\u5965\u5999\u800c\u5bf9\u6570\u636e\u5e93\u4f18\u5316\u611f\u89c9\u5f88\u795e\u79d8\u3002</p> <p>\u5f88\u591a\u4eba\u603b\u662f\u95ee\u5982\u4f55\u5b66\u4e60\u6570\u636e\u5e93\u4f18\u5316\uff0c\u6709\u6ca1\u6709\u597d\u7684\u6559\u6750\u4e4b\u7c7b\u7684\u95ee\u9898\u3002\u5728\u4e66\u5e97\u4e5f\u770b\u5230\u4e86\u8bb8\u591a\u6570\u636e\u5e93\u4f18\u5316\u7684\u4e13\u4e1a\u4e66\u7c4d\uff0c\u4f46\u662f\u611f\u89c9\u66f4\u591a\u662f\u9762\u5411DBA\u6216\u8005\u662fPL/SQL\u5f00\u53d1\u65b9\u9762\u7684\u77e5\u8bc6\uff0c\u4e2a\u4eba\u611f\u89c9\u4e0d\u592a\u9002\u5408\u666e\u901a\u7a0b\u5e8f\u5458\u3002\u800c\u8981\u60f3\u505a\u5230\u6570\u636e\u5e93\u4f18\u5316\u7684\u9ad8\u624b\uff0c\u4e0d\u662f\u82b1\u51e0\u5468\uff0c\u51e0\u4e2a\u6708\u5c31\u80fd\u8fbe\u5230\u7684\uff0c\u8fd9\u5e76\u4e0d\u662f\u56e0\u4e3a\u6570\u636e\u5e93\u4f18\u5316\u6709\u591a\u9ad8\u6df1\uff0c\u800c\u662f\u56e0\u4e3a\u8981\u505a\u597d\u4f18\u5316\u4e00\u65b9\u9762\u9700\u8981\u6709\u975e\u5e38\u597d\u7684\u6280\u672f\u529f\u5e95\uff0c\u5bf9\u64cd\u4f5c\u7cfb\u7edf\u3001\u5b58\u50a8\u786c\u4ef6\u7f51\u7edc\u3001\u6570\u636e\u5e93\u539f\u7406\u7b49\u65b9\u9762\u6709\u6bd4\u8f83\u624e\u5b9e\u7684\u57fa\u7840\u77e5\u8bc6\uff0c\u53e6\u4e00\u65b9\u9762\u662f\u9700\u8981\u82b1\u5927\u91cf\u65f6\u95f4\u5bf9\u7279\u5b9a\u7684\u6570\u636e\u5e93\u8fdb\u884c\u5b9e\u8df5\u6d4b\u8bd5\u4e0e\u603b\u7ed3\u3002</p> <p>\u4f5c\u4e3a\u4e00\u4e2a\u7a0b\u5e8f\u5458\uff0c\u6211\u4eec\u4e5f\u8bb8\u4e0d\u6e05\u695a\u7ebf\u4e0a\u6b63\u5f0f\u7684\u670d\u52a1\u5668\u786c\u4ef6\u914d\u7f6e\uff0c\u6211\u4eec\u4e0d\u53ef\u80fd\u50cfDBA\u90a3\u6837\u4e13\u4e1a\u7684\u5bf9\u6570\u636e\u5e93\u8fdb\u884c\u5404\u79cd\u5b9e\u8df5\u6d4b\u8bd5\u4e0e\u603b\u7ed3\uff0c\u4f46\u6211\u4eec\u90fd\u5e94\u8be5\u975e\u5e38\u4e86\u89e3\u6211\u4eecSQL\u7684\u4e1a\u52a1\u903b\u8f91\uff0c\u6211\u4eec\u6e05\u695aSQL\u4e2d\u8bbf\u95ee\u8868\u53ca\u5b57\u6bb5\u7684\u6570\u636e\u60c5\u51b5\uff0c\u6211\u4eec\u5176\u5b9e\u53ea\u5173\u5fc3\u6211\u4eec\u7684SQL\u662f\u5426\u80fd\u5c3d\u5feb\u8fd4\u56de\u7ed3\u679c\u3002\u90a3\u7a0b\u5e8f\u5458\u5982\u4f55\u5229\u7528\u5df2\u77e5\u7684\u77e5\u8bc6\u8fdb\u884c\u6570\u636e\u5e93\u4f18\u5316\uff1f\u5982\u4f55\u80fd\u5feb\u901f\u5b9a\u4f4dSQL\u6027\u80fd\u95ee\u9898\u5e76\u627e\u5230\u6b63\u786e\u7684\u4f18\u5316\u65b9\u5411\uff1f</p> <p>\u672c\u6587\u8bfb\u8005\u5bf9\u50cf\uff1a</p> <ul> <li> <p>\u5f00\u53d1\u4eba\u5458\uff1a\u5982\u679c\u4f60\u662f\u505a\u6570\u636e\u5e93\u5f00\u53d1\uff0c\u90a3\u672c\u6587\u7684\u5185\u5bb9\u975e\u5e38\u9002\u5408\uff0c\u56e0\u4e3a\u672c\u6587\u662f\u4ece\u7a0b\u5e8f\u5458\u7684\u89d2\u5ea6\u6765\u8c08\u6570\u636e\u5e93\u6027\u80fd\u4f18\u5316\u3002</p> </li> <li> <p>\u67b6\u6784\u5e08\uff1a\u5982\u679c\u4f60\u5df2\u7ecf\u662f\u6570\u636e\u5e93\u5e94\u7528\u7684\u67b6\u6784\u5e08\uff0c\u90a3\u672c\u6587\u7684\u77e5\u8bc6\u4f60\u5e94\u8be5\u6e05\u695a90%\uff0c\u5426\u5219\u4f60\u53ef\u80fd\u662f\u4e00\u4e2a\u559c\u6b22\u6298\u817e\u7684\u67b6\u6784\u5e08\u3002</p> </li> <li> <p>DBA\uff08\u6570\u636e\u5e93\u7ba1\u7406\u5458\uff09\uff1a\u5927\u578b\u6570\u636e\u5e93\u4f18\u5316\u7684\u77e5\u8bc6\u975e\u5e38\u590d\u6742\uff0c\u672c\u6587\u53ea\u662f\u4ece\u7a0b\u5e8f\u5458\u7684\u89d2\u5ea6\u6765\u8c08\u6027\u80fd\u4f18\u5316\uff0cDBA\u9664\u4e86\u9700\u8981\u4e86\u89e3\u8fd9\u4e9b\u77e5\u8bc6\u5916\uff0c\u8fd8\u9700\u8981\u6df1\u5165\u6570\u636e\u5e93\u7684\u5185\u90e8\u4f53\u7cfb\u67b6\u6784\u6765\u89e3\u51b3\u95ee\u9898\u3002</p> </li> </ul> <p>\u4e00\u4e2a\u6570\u636e\u5e93\u7cfb\u7edf\uff0c\u5176\u786c\u4ef6\u8d44\u6e90(CPU\u3001Disk\u3001SSD...)\u5229\u7528\u7387\u662f\u4e0d\u662f\u8d8a\u9ad8\uff0c\u8bf4\u660e\u7cfb\u7edf\u8c03\u4f18\u7684\u8d8a\u597d\uff1f</p> <ul> <li> <p>\u7528\u6237\u5173\u6ce8\uff1a\u54cd\u5e94\u65f6\u95f4(Latency) Query response time </p> </li> <li> <p>\u8001\u677f\u5173\u6ce8\uff1a\u8d44\u6e90\u6709\u6ca1\u6709\u6d6a\u8d39\uff1f</p> </li> <li> <p>\u8c03\u4f18\u5173\u6ce8\uff1a\u4fdd\u8bc1\u7528\u6237\u54cd\u5e94\u65f6\u95f4\u7684\u57fa\u7840\u4e0a\uff0c\u6700\u5927\u9650\u5ea6\u63d0\u9ad8\u8d44\u6e90\u5229\u7528\u7387\u3002</p> </li> </ul>"},{"location":"optimize/1.overview/#_3","title":"\u4e8c\u3001\u5982\u4f55\u8bc4\u7ea7\u6570\u636e\u5e93\u8d1f\u8f7d\u60c5\u51b5\uff1f","text":"<p>\u57fa\u51c6\u6d4b\u8bd5</p> <p>\u57fa\u51c6\u6d4b\u8bd5-benchmarking \u662f\u4e00\u79cd\u6d4b\u91cf\u548c\u8bc4\u4f30\u8f6f\u4ef6\u6027\u80fd\u6307\u6807\u7684\u6d3b\u52a8\u3002 \u4f60\u53ef\u4ee5\u5728\u67d0\u4e2a\u65f6\u5019\u901a\u8fc7\u57fa\u51c6\u6d4b\u8bd5\u5efa\u7acb\u4e00\u4e2a\u5df2\u77e5\u7684\u6027\u80fd\u6c34\u5e73\uff08\u79f0\u4e3a\u57fa\u51c6\u7ebf\uff09\uff0c\u5f53\u7cfb\u7edf\u7684\u8f6f\u786c\u4ef6\u73af\u5883\u53d1\u751f\u53d8\u5316\u4e4b\u540e\u518d\u8fdb\u884c\u4e00\u6b21\u57fa\u51c6\u6d4b\u8bd5\u4ee5\u786e\u5b9a\u90a3\u4e9b\u53d8\u5316\u5bf9\u6027\u80fd\u7684\u5f71\u54cd\u3002 \u8fd9\u662f\u57fa\u51c6\u6d4b\u8bd5\u6700\u5e38\u89c1\u7684\u7528\u9014\u3002\u5176\u4ed6\u7528\u9014\u5305\u62ec\u6d4b\u5b9a\u67d0\u79cd\u8d1f\u8f7d\u6c34\u5e73\u4e0b\u7684\u6027\u80fd\u6781\u9650\u3001\u7ba1\u7406\u7cfb\u7edf\u6216\u73af\u5883\u7684\u53d8\u5316\u3001\u53d1\u73b0\u53ef\u80fd\u5bfc\u81f4\u6027\u80fd\u95ee\u9898\u7684\u6761\u4ef6\uff0c\u7b49\u7b49\u3002</p> <p><code>\u57fa\u51c6\u6d4b\u8bd5</code>\u7684\u5177\u4f53\u505a\u6cd5\u662f\uff1a\u5728\u7cfb\u7edf\u4e0a\u8fd0\u884c\u4e00\u7cfb\u5217\u6d4b\u8bd5\u7a0b\u5e8f\u5e76\u628a\u6027\u80fd\u8ba1\u6570\u5668\u7684\u7ed3\u679c\u4fdd\u5b58\u8d77\u6765\u3002\u8fd9\u4e9b\u7ed3\u6784\u79f0\u4e3a\"\u6027\u80fd\u6307\u6807\"\u3002 \u6027\u80fd\u6307\u6807\u901a\u5e38\u90fd\u4fdd\u5b58\u6216\u5f52\u6863\uff0c\u5e76\u5728\u7cfb\u7edf\u73af\u5883\u7684\u63cf\u8ff0\u4e2d\u8fdb\u884c\u6ce8\u89e3\u3002\u6bd4\u5982\u8bf4\uff0c\u6709\u7ecf\u9a8c\u7684\u6570\u636e\u5e93\u4e13\u4e1a\u4eba\u5458\u4f1a\u628a\u57fa\u51c6\u6d4b\u8bd5\u7684\u7ed3\u679c\u4ee5\u53ca\u5f53\u65f6\u7684\u7cfb\u7edf\u914d\u7f6e\u548c\u73af\u5883\u4e00\u8d77\u5b58\u5165\u4ed6\u4eec\u7684\u6863\u6848\u3002\u8fd9\u53ef\u4ee5\u8ba9\u4ed6\u4eec\u5bf9\u7cfb\u7edf\u8fc7\u53bb\u548c\u73b0\u5728\u7684\u6027\u80fd\u8868\u73b0\u8fdb\u884c\u5bf9\u7167\u6bd4\u8f83\uff0c\u786e\u8ba4\u7cfb\u7edf\u6216\u73af\u5883\u7684\u6240\u6709\u53d8\u5316\u3002</p> <p>\u57fa\u51c6\u6d4b\u8bd5\u5de5\u5177\u548c\u6807\u51c6</p>"},{"location":"optimize/1.overview/#tpc","title":"TPC","text":"<p>TPC\u7b80\u4ecb</p> <p>\u4e8b\u52a1\u5904\u7406\u6027\u80fd\u59d4\u5458\u4f1a\uff08 Transaction ProcessingPerformance Council \uff09\uff0c\u662f\u7531\u657010\u5bb6\u4f1a\u5458\u516c\u53f8\u521b\u5efa\u7684\u975e\u76c8\u5229\u7ec4\u7ec7\uff0c\u603b\u90e8\u8bbe\u5728\u7f8e\u56fd\u3002\u8be5\u7ec4\u7ec7\u5bf9\u5168\u4e16\u754c\u5f00\u653e\uff0c\u4f46\u8fc4\u4eca\u4e3a\u6b62\uff0c\u7edd\u5927\u591a\u6570\u4f1a\u5458\u90fd\u662f\u7f8e\u3001\u65e5\u3001\u897f\u6b27\u7684\u5927\u516c\u53f8\u3002</p> <p>TPC\u7684\u6210\u5458\u4e3b\u8981\u662f\u8ba1\u7b97\u673a\u8f6f\u786c\u4ef6\u5382\u5bb6\uff0c\u800c\u975e\u8ba1\u7b97\u673a\u7528\u6237\uff0c\u5b83\u7684\u529f\u80fd\u662f\u5236\u5b9a\u5546\u52a1\u5e94\u7528\u57fa\u51c6\u7a0b\u5e8f\uff08Benchmark\uff09\u7684\u6807\u51c6\u89c4\u8303\u3001\u6027\u80fd\u548c\u4ef7\u683c\u5ea6\u91cf\uff0c\u5e76\u7ba1\u7406\u6d4b\u8bd5\u7ed3\u679c\u7684\u53d1\u5e03\u3002</p> <p>TPC-C\u7528\u4e8e\u6d4b\u8bd5\u6570\u636e\u5e93\u7cfb\u7edf\u7684\u4e8b\u52a1\u5904\u7406\u80fd\u529b\uff0cTPC-App\u7528\u4e8e\u6d4b\u8bd57\u00d724 \u73af\u5883\u4e0bB2B\u7684\u5e94\u7528\u670d\u52a1\u548cWeb\u670d\u52a1\u7684\u80fd\u529b\u3002</p> <p>TPC \u7ec4\u7ec7\u8fd8\u53d1\u5e03\u8fc7TPC-S\uff08Server \u4e13\u95e8\u6d4b\u8bd5\u57fa\u51c6\u7a0b\u5e8f\uff09\u3001TPC-E\uff08\u5927\u578b\u4f01\u4e1a\u4fe1\u606f\u670d\u52a1\u6d4b\u8bd5\u57fa\u51c6\u7a0b\u5e8f\uff09\u548cTPC-Client/Server\u7b49\u6d4b\u8bd5\u6807\u51c6\uff0c\u4f46\u8fd93\u4e2a\u6807\u51c6\u4e0d\u88ab\u4e1a\u754c\u63a5\u53d7\u800c\u88ab\u653e\u5f03\u3002</p> <p>TPC\u4e0d\u7ed9\u51fa\u57fa\u51c6\u7a0b\u5e8f\u7684\u4ee3\u7801\uff0c\u800c\u53ea\u7ed9\u51fa\u57fa\u51c6\u7a0b\u5e8f\u7684\u6807\u51c6\u89c4\u8303\uff08Standard Specification\uff09\u3002\u4efb\u4f55\u5382\u5bb6\u6216\u5176\u5b83\u6d4b\u8bd5\u8005\u90fd\u53ef\u4ee5\u6839\u636e\u89c4\u8303\uff0c\u6700\u4f18\u5730\u6784\u9020\u51fa\u81ea\u5df1\u7684\u7cfb\u7edf\uff08\u6d4b\u8bd5\u5e73\u53f0\u548c\u6d4b\u8bd5\u7a0b\u5e8f\uff09\u3002\uff08\u9700\u8981\u81ea\u5df1\u5199\u6d4b\u8bd5\u5de5\u5177\uff0c\u6d4b\u8bd5\u5b8c\u4e4b\u540e\u63d0\u4ea4\u7ed9TPC\u534f\u4f1a\uff09\u4e3a\u4fdd\u8bc1\u6d4b\u8bd5\u7ed3\u679c\u7684\u5ba2\u89c2\u6027\uff0c\u88ab\u6d4b\u8bd5\u8005\uff08\u901a\u5e38\u662f\u5382\u5bb6\uff09\u5fc5\u987b\u63d0\u4ea4\u7ed9TPC\u4e00\u5957\u5b8c\u6574\u7684\u62a5\u544a\uff08FullDisclosure Report\uff09\uff0c\u5305\u62ec\u88ab\u6d4b\u7cfb\u7edf\u7684\u8be6\u7ec6\u914d\u7f6e\u3001\u5206\u7c7b\u4ef7\u683c\u548c\u5305\u542b\u4e94\u5e74\u7ef4\u62a4\u8d39\u7528\u5728\u5185\u7684\u603b\u4ef7\u683c\u3002\u8be5\u62a5\u544a\u5fc5\u987b\u7531TPC\u6388\u6743\u7684\u5ba1\u6838\u5458\u6838\u5b9e\uff08TPC\u672c\u8eab\u5e76\u4e0d\u505a\u5ba1\u8ba1\uff09\uff0c\u73b0\u5728\u5168\u7403\u53ea\u6709\u4e0d\u5230\u5341\u4e2a\u5ba1\u6838\u5458\uff0c\u5168\u90e8\u5728\u7f8e\u56fd\u3002\uff08\u6d4b\u8bd5\u4ef7\u683c\u6602\u8d35\u7684\u539f\u56e0\uff09</p> <p>TPC\u76ee\u524d\u63a8\u51fa\u7684\u57fa\u51c6\u7a0b\u5e8f</p> <p>TPC\u63a8\u51fa\u8fc711\u5957\u57fa\u51c6\u7a0b\u5e8f\uff0c\u5206\u522b\u662f\u6b63\u5728\u4f7f\u7528\u7684TPC-App\u3001TPC-H\u3001TPC-C\u3001TPC-W\uff0c\u8fc7\u65f6\u7684TPC-A\u3001TPC-B\u3001TPC-D\u548cTPC-R\uff0c\u4ee5\u53ca\u56e0\u4e3a\u4e0d\u88ab\u4e1a\u754c\u63a5\u53d7\u800c\u653e\u5f03\u7684TPC-S\uff08Server\u4e13\u95e8\u6d4b\u8bd5\u57fa\u51c6\u7a0b\u5e8f\uff09\u3001TPC-E\uff08\u5927\u578b\u4f01\u4e1a\u4fe1\u606f\u670d\u52a1\u6d4b\u8bd5\u57fa\u51c6\u7a0b\u5e8f\uff09\u548cTPC-Client/Server\u3002\u8fd9\u91cc\u91cd\u70b9\u4ecb\u7ecdTPC-H\u3002</p>"},{"location":"optimize/1.overview/#tpc-h","title":"TPC-H","text":"<p>TPC-H\u7684\u76ee\u7684</p> <p>TPC-H\u662f\u4e00\u4e2a\u51b3\u7b56\u652f\u6301\u57fa\u51c6\uff08Decision Support Benchmark\uff09\uff0c\u7531\u4e00\u5957\u9762\u5411\u4e1a\u52a1\u7684\u4e34\u65f6\u67e5\u8be2\uff08ad-hoc queries\uff09\u548c\u5e76\u53d1\u6570\u636e\u4fee\u6539\uff08concurrent data modifications\uff09\u7ec4\u6210\u3002\u9009\u62e9\u7684\u67e5\u8be2\u548c\u586b\u5145\u6570\u636e\u5e93\u7684\u6570\u636e\u5177\u6709\u5e7f\u6cdb\u7684\u884c\u4e1a\u76f8\u5173\u6027\u3002\u8be5\u57fa\u51c6\u6d4b\u8bd5\u8bf4\u660e\u4e86\u51b3\u7b56\u652f\u6301\u7cfb\u7edf\u53ef\u4ee5\u68c0\u67e5\u5927\u91cf\u6570\u636e\uff0c\u6267\u884c\u9ad8\u5ea6\u590d\u6742\u7684\u67e5\u8be2\uff0c\u5e76\u89e3\u7b54\u5173\u952e\u7684\u4e1a\u52a1\u95ee\u9898\u3002</p> <p>TPC-H\u8981\u76ee\u7684\u662f\u8bc4\u4ef7\u7279\u5b9a\u67e5\u8be2\u7684\u51b3\u7b56\u652f\u6301\u80fd\u529b\uff0c\u5f3a\u8c03\u670d\u52a1\u5668\u5728\u6570\u636e\u6316\u6398\u3001\u5206\u6790\u5904\u7406\u65b9\u9762\u7684\u80fd\u529b\u3002\u67e5\u8be2\u662f\u51b3\u7b56\u652f\u6301\u5e94\u7528\u7684\u6700\u4e3b\u8981\u5e94\u7528\u4e4b\u4e00\uff0c\u6570\u636e\u4ed3\u5e93\u4e2d\u7684\u590d\u6742\u67e5\u8be2\u53ef\u4ee5\u5206\u6210\u4e24\u79cd\u7c7b\u578b\uff1a\u4e00\u79cd\u662f\u9884\u5148\u77e5\u9053\u7684\u67e5\u8be2\uff0c\u5982\u5b9a\u671f\u7684\u4e1a\u52a1\u62a5\u8868\uff1b\u53e6\u4e00\u79cd\u5219\u662f\u4e8b\u5148\u672a\u77e5\u7684\u67e5\u8be2\uff0c\u79f0\u4e3a\u52a8\u6001\u67e5\u8be2\uff08Ad- Hoc Query\uff09\u3002</p> <p>\u901a\u4fd7\u7684\u8bb2\uff0cTPC-H\u5c31\u662f\u5f53\u4e00\u5bb6\u6570\u636e\u5e93\u5f00\u53d1\u5546\u5f00\u53d1\u4e86\u4e00\u4e2a\u65b0\u7684\u6570\u636e\u5e93\u64cd\u4f5c\u7cfb\u7edf\uff0c\u91c7\u7528TPC-H\u4f5c\u4e3a\u6d4b\u8bd5\u57fa\u51c6\uff0c\u6765\u6d4b\u8bd5\u8861\u91cf\u6570\u636e\u5e93\u64cd\u4f5c\u7cfb\u7edf\u67e5\u8be2\u51b3\u7b56\u652f\u6301\u65b9\u9762\u7684\u80fd\u529b\u3002</p> <p>TPC-H\u7684\u8861\u91cf\u6307\u6807</p> <p>\u5b83\u6a21\u62df\u51b3\u7b56\u652f\u6301\u7cfb\u7edf\u4e2d\u7684\u6570\u636e\u5e93\u64cd\u4f5c\uff0c\u6d4b\u8bd5\u6570\u636e\u5e93\u7cfb\u7edf\u590d\u6742\u67e5\u8be2\u7684\u54cd\u5e94\u65f6\u95f4\uff0c\u4ee5\u6bcf\u5c0f\u65f6\u6267\u884c\u7684\u67e5\u8be2\u6570(TPC-H QphH@Siz)\u4f5c\u4e3a\u5ea6\u91cf\u6307\u6807\u3002</p> <p>TPC-H\u6807\u51c6\u89c4\u8303</p> <p>TPC-H\u6807\u51c6\u89c4\u8303\u753110\u7ae0\u6b63\u6587\u548c5\u4e2a\u9644\u5f55\u7ec4\u6210\u3002\u8be6\u7ec6\u5185\u5bb9\u89c1 https://www.tpc.org/TPC_Documents_Current_Versions/pdf/TPC-H_v3.0.1.pdf</p> <p>\u6570\u636e\u5e93\u8fd0\u884c\u7684\u73af\u5883\u6761\u4ef6</p> <p>TPC-H\u6d4b\u8bd5\u6a21\u578b\u4e3a\u6570\u636e\u5e93\u670d\u52a1\u5668<code>\u8fde\u7eed7\u00d724</code>\u5c0f\u65f6\u5de5\u4f5c\uff0c\u53ef\u80fd\u53ea\u6709<code>1\u6b21/\u6708</code>\u7684\u7ef4\u62a4\uff1b\u591a\u7528\u6237\u5e76\u53d1\u6267\u884c\u590d\u6742\u7684\u52a8\u6001\u67e5\u8be2\uff0c\u540c\u65f6\u6709\u5e76\u53d1\u6267\u884c\u8868\u4fee\u6539\u64cd\u4f5c\u3002</p> <p>\u6570\u636e\u5e93\u6a21\u578b\u5171\u67098\u5f20\u8868\uff0c\u9664Nation\u548cRegion\u8868\u5916\uff0c\u5176\u5b83\u8868\u4e0e\u6d4b\u8bd5\u7684\u6570\u636e\u91cf\u6709\u5173\uff0c\u5373\u6bd4\u4f8b\u56e0SF\uff08Scale Factor\uff09</p> <p>TPC-H\u662f\u4e1a\u754c\u5e38\u7528\u7684\u4e00\u5957Benchmark\uff0c\u7531TPC\u59d4\u5458\u4f1a\u5236\u5b9a\u53d1\u5e03\uff0c\u7528\u4e8e\u8bc4\u6d4b\u6570\u636e\u5e93\u7684\u5206\u6790\u578b\u67e5\u8be2\u80fd\u529b\u3002</p> <p>\u6570\u636e\u6a21\u578b</p> <p>TPC-H\u67e5\u8be2\u5305\u542b8\u5f20\u6570\u636e\u8868\u300122\u6761\u590d\u6742\u7684SQL\u67e5\u8be2\uff0c\u5927\u591a\u6570\u67e5\u8be2\u5305\u542b\u82e5\u5e72\u8868Join\u3001\u5b50\u67e5\u8be2\u548cGroup-by\u805a\u5408\u7b49\u3002</p> <p>\u4eceMySQL\u5b98\u7f51\u641e\u4e86\u4e00\u4efdddl.sql</p> <p></p> <p>\u6570\u636e\u89c4\u6a21</p> <p>\u7531\u4e8e\u6570\u636e\u91cf\u7684\u5927\u5c0f\u5bf9\u67e5\u8be2\u901f\u5ea6\u6709\u76f4\u63a5\u7684\u5f71\u54cd\uff0c<code>TPC-H</code>\u6807\u51c6\u5bf9\u6570\u636e\u5e93\u7cfb\u7edf\u4e2d\u7684\u6570\u636e\u91cf\u6709\u4e25\u683c\u3001\u660e\u786e\u7684\u89c4\u5b9a\u3002</p> <p>\u7528<code>SF</code>\u63cf\u8ff0\u6570\u636e\u91cf\uff0c1SF\u5bf9\u5e941GB\u5355\u4f4d\uff0cSF\u7531\u4f4e\u5230\u9ad8\u4f9d\u6b21\u662f1\u300110\u300130\u3001100\u3001300\u30011000\u30013000\u300110000\u3002\u9700\u8981\u5f3a\u8c03\uff0cSF\u89c4\u5b9a\u7684\u6570\u636e\u91cf\u53ea\u662f8\u4e2a\u57fa\u672c\u8868\u7684\u6570\u636e\u91cf\uff0c\u4e0d\u5305\u62ec\u7d22\u5f15\u548c\u4e34\u65f6\u8868\u3002</p> <p>\u4ece<code>TPC-H</code>\u6d4b\u8bd5\u5168\u7a0b\u6765\u770b\uff0c\u9700\u8981\u7684\u6570\u636e\u5b58\u50a8\u7a7a\u8f83\u5927\uff0c\u4e00\u822c\u5305\u62ec\u6709\u57fa\u672c\u8868\u3001\u7d22\u5f15\u3001\u4e34\u65f6\u8868\u3001\u6570\u636e\u6587\u4ef6\u548c\u5907\u4efd\u6587\u4ef6\uff0c\u57fa\u672c\u8868\u7684\u5927\u5c0f\u4e3ax\uff1b\u7d22\u5f15\u548c\u4e34\u65f6\u7a7a\u95f4\u7684\u7ecf\u9a8c\u503c\u4e3a3-5\u4f4d\uff0c\u53d6\u4e0a\u96505x\uff1bDBGEN\u4ea7\u751f\u7684\u6570\u636e\u6587\u4ef6\u7684\u5927\u5c0f\u4e3ax\uff1b\u5907\u4efd\u6587\u4ef6\u5927\u5c0f\u4e3ax\uff1b\u603b\u8ba1\u9700\u8981\u7684\u5b58\u50a8\u7a7a\u95f4\u4e3a8x\u3002\u5c31\u662f\u8bf4SF=1\uff0c\u9700\u8981\u51c6\u59078\u500d\uff0c\u53738GB\u5b58\u50a8\u7a7a\u95f4\uff0c\u624d\u80fd\u987a\u5229\u5730\u8fdb\u884c\u6d4b\u8bd5.</p> <p>\u67e5\u8be2\u8bed\u53e5</p> <p>TPC-H\u6d4b\u8bd5\u56f4\u7ed522\u4e2aSELECT\u8bed\u53e5\u5c55\u5f00\uff0c\u6bcf\u4e2a<code>SELECT</code>\u4e25\u683c\u5b9a\u4e49\uff0c\u9075\u5b88SQL-92\u8bed\u6cd5\uff0c\u5e76\u4e14\u4e0d\u5141\u8bb8\u7528\u6237\u4fee\u6539\u3002\u6807\u51c6\u4e2d\u4ece4\u4e2a\u65b9\u9762\u5b9a\u4e49\u6bcf\u4e2a<code>SELECT</code>\u8bed\u53e5\uff0c\u5373\u5546\u4e1a\u95ee\u9898\u3001<code>SELECT</code>\u7684\u8bed\u6cd5\u3001\u53c2\u6570\u548c\u67e5\u8be2\u786e\u8ba4\u3002\u8fd9\u4e9b<code>SELECT</code>\u8bed\u53e5\u7684\u590d\u6742\u7a0b\u5ea6\u8d85\u8fc7\u5927\u591a\u6570\u5b9e\u9645\u7684<code>OLTP</code>\u5e94\u7528\uff0c\u4e00\u4e2a<code>SELECT</code>\u6267\u884c\u65f6\u95f4\u5c11\u5219\u51e0\u5341\u79d2\uff0c\u591a\u5219\u8fbe15\u5c0f\u65f6\u4ee5\u4e0a\uff0c22\u4e2a\u67e5\u8be2\u8bed\u53e5\u6267\u884c\u4e00\u904d\u9700\u6570\u4e2a\u5c0f\u65f6\u3002</p> <p>Q1\u8bed\u53e5\u662f\u67e5\u8be2lineItems\u7684\u4e00\u4e2a\u5b9a\u4ef7\u603b\u7ed3\u62a5\u544a\u3002\u5728\u5355\u4e2a\u8868lineitem\u4e0a\u67e5\u8be2\u67d0\u4e2a\u65f6\u95f4\u6bb5\u5185\uff0c\u5bf9\u5df2\u7ecf\u4ed8\u6b3e\u7684\u3001\u5df2\u7ecf\u8fd0\u9001\u7684\u7b49\u5404\u7c7b\u5546\u54c1\u8fdb\u884c\u7edf\u8ba1\uff0c\u5305\u62ec\u4e1a\u52a1\u91cf\u7684\u8ba1\u8d39\u3001\u53d1\u8d27\u3001\u6298\u6263\u3001\u7a0e\u3001\u5e73\u5747\u4ef7\u683c\u7b49\u4fe1\u606f\u3002</p> <p>Q1\u8bed\u53e5\u7684\u7279\u70b9\u662f\uff1a\u5e26\u6709\u5206\u7ec4\u3001\u6392\u5e8f\u3001\u805a\u96c6\u64cd\u4f5c\u5e76\u5b58\u7684\u5355\u8868\u67e5\u8be2\u64cd\u4f5c\u3002\u8fd9\u4e2a\u67e5\u8be2\u4f1a\u5bfc\u81f4\u8868\u4e0a\u7684\u6570\u636e\u670995%\u523097%\u884c\u88ab\u8bfb\u53d6\u5230\u3002</p> <p>Q1\u7684\u67e5\u8be2\u8bed\u53e5\u5982\u4e0b\uff1a</p> <pre><code>SELECT \n    l_returnflag, -- \u8fd4\u56de\u6807\u5fd7\n    l_linestatus, \n    SUM(l_quantity) AS sum_qty, -- \u603b\u7684\u6570\u91cf\n    SUM(l_extendedprice) AS sum_base_price, -- \u805a\u96c6\u51fd\u6570\u64cd\u4f5c\n    SUM(l_extendedprice * (1 - l_discount)) AS sum_disc_price, \n    SUM(l_extendedprice * (1 - l_discount) * (1 + l_tax)) AS sum_charge, \n    AVG(l_quantity) AS avg_qty, \n    AVG(l_extendedprice) AS avg_price, \n    AVG(l_discount) AS avg_disc, \n    COUNT(*) AS count_order -- \u6bcf\u4e2a\u5206\u7ec4\u6240\u5305\u542b\u7684\u884c\u6570\nFROM \n    lineitem\nWHERE \n    l_shipdate &lt;= date'1998-12-01' - interval '90' day -- \u65f6\u95f4\u6bb5\u662f\u968f\u673a\u751f\u6210\u7684\nGROUP BY -- \u5206\u7ec4\u64cd\u4f5c\n    l_returnflag, \n    l_linestatus\nORDER BY -- \u6392\u5e8f\u64cd\u4f5c\n    l_returnflag, \n    l_linestatus;\n</code></pre>"},{"location":"optimize/1.overview/#tpc-c","title":"TPC-C","text":"<p>TPC-C\u662f\u4e1a\u754c\u5e38\u7528\u7684\u4e00\u5957Benchmark\uff0c\u7531TPC\u59d4\u5458\u4f1a\u5236\u5b9a\u53d1\u5e03\uff0c\u7528\u4e8e\u8bc4\u6d4b\u6570\u636e\u5e93\u7684\u8054\u673a\u4ea4\u6613\u5904\u7406\uff08\u504f\u5411OLTP\u80fd\u529b\uff09\u3002</p> <p>TPC-C\u662fTPC\uff08\u4e8b\u52a1\u5904\u7406\u6027\u80fd\u59d4\u5458\u4f1a\uff09\u63a8\u51fa\u7684\u4e00\u7cfb\u5217\u6027\u80fd\u6d4b\u8bd5\u6807\u51c6\u4e2d\u7684\u4e00\u6b3e\uff0c\u81ea1992\u5e74\u63a8\u51fa\uff0c\u4fbf\u6210\u4e3a\u4e86\u6570\u636e\u5e93\u6027\u80fd\u6d4b\u8bd5\u7684\u6807\u6746\uff0c\u5404\u4e2a\u6570\u636e\u5e93\u5927\u5382\u90fd\u5411TPC\u59d4\u5458\u4f1a\u63d0\u4ea4\u4e86\u6d4b\u8bd5\u7ed3\u679c\uff0c\u4ee5\u671f\u5728TPC-C\u6d4b\u8bd5\u7684\u6392\u884c\u699c\u4e0a\u62e5\u6709\u4e00\u5e2d\u4e4b\u5730\u3002\u5c31\u50cf\u51b3\u6218\u7d2b\u7981\u4e4b\u5dc5\uff0c\u8bba\u5251\u534e\u5c71\u4e4b\u5dc5\uff0c\u62e5\u6709\u4e00\u5e2d\u4e4b\u5730\u7684\u90fd\u662f\u6210\u540d\u7684\u5927\u4f6c\u4eec\u3002</p> <p>\u4e3b\u8981\u6d89\u53ca10\u5f20\u8868\uff0c\u5305\u542b\u4e86NewOrder\uff08\u65b0\u8ba2\u5355\u7684\u751f\u6210\uff09\u3001Payment\uff08\u8ba2\u5355\u4ed8\u6b3e\uff09\u3001OrderStatus\uff08\u6700\u8fd1\u8ba2\u5355\u67e5\u8be2\uff09\u3001Delivery\uff08\u914d\u9001\uff09\u548cStockLevel\uff08\u5e93\u5b58\u7f3a\u8d27\u72b6\u6001\u5206\u6790\uff09\u7b49\u4e94\u7c7b\u4e1a\u52a1\u4e8b\u52a1\u6a21\u578b\u3002</p> <p>\u6982\u62ec\u6765\u8bb2\uff0cTPC-C\u662f\u7528\u6765\u8861\u91cf\u5728\u7ebf\u4e8b\u52a1\u5904\u7406\u7684\u57fa\u51c6\uff0cTPC-C\u63d0\u4f9b\u4e86\u4e00\u4e2a\u8bf4\u660e\u4e66\uff0c\u7528\u6765\u63cf\u8ff0\u8fd9\u4e2a\u57fa\u51c6\uff0c\u5728\u5199\u8fd9\u7bc7\u6587\u7ae0\u7684\u65f6\u5019\uff0c\u8be5\u8bf4\u660e\u4e66\u7684\u7248\u672c\u662f\u4e8e2010\u5e74\u53d1\u5e03\u76845.11.0\uff0c\u53ef\u4ee5\u901a\u8fc7\u8bbf\u95eeTPC\u7684\u7f51\u7ad9\u6765\u83b7\u53d6\u6700\u65b0\u7684\u8bf4\u660e\u4e66\u3002</p> <p>TPC-C\u6a21\u578b\u662f\u6a21\u62df\u4e00\u4e2a\u5546\u54c1\u6279\u53d1\u516c\u53f8\u7684\u9500\u552e\u6a21\u578b\uff0c\u8fd9\u4e2a\u6a21\u578b\u6db5\u76d6\u4e86\u4e00\u4e2a\u6279\u53d1\u516c\u53f8\u9762\u5411\u5ba2\u6237\u5bf9\u4e00\u7cfb\u5217\u5546\u54c1\u8fdb\u884c\u9500\u552e\u7684\u8fc7\u7a0b\uff0c\u8fd9\u5305\u62ec\u7ba1\u7406\u8ba2\u5355\uff0c\u7ba1\u7406\u5e93\u5b58\uff0c\u7ba1\u7406\u8d26\u53f7\u6536\u652f\u7b49\u64cd\u4f5c\u3002\u8fd9\u4e9b\u64cd\u4f5c\u6d89\u53ca\u5230\u4ed3\u5e93\u3001\u5546\u54c1\u3001\u5ba2\u6237\u3001\u8ba2\u5355\u7b49\u6982\u5ff5\uff0c\u56f4\u7ed5\u8fd9\u4e9b\u6982\u5ff5\uff0c\u6784\u9020\u4e86\u6570\u636e\u8868\u683c\uff0c\u4ee5\u53ca\u76f8\u5e94\u7684\u6570\u636e\u5e93\u64cd\u4f5c\u3002</p> <p>TPC-C\u6d4b\u8bd5\u89c4\u8303\u4e2d\u6a21\u62df\u4e86\u4e00\u4e2a\u6bd4\u8f83\u590d\u6742\u5e76\u5177\u6709\u4ee3\u8868\u610f\u4e49\u7684OLTP\u5e94\u7528\u73af\u5883\uff1a\u5047\u8bbe\u6709\u4e00\u4e2a\u5927\u578b\u5546\u54c1\u6279\u53d1\u5546\uff0c\u5b83\u62e5\u6709\u82e5\u5e72\u4e2a\u5206\u5e03\u5728\u4e0d\u540c\u533a\u57df\u7684\u5546\u54c1\u5e93\uff1b\u6bcf\u4e2a\u4ed3\u5e93\u8d1f\u8d23\u4e3a10\u4e2a\u9500\u552e\u70b9\u4f9b\u8d27\uff1b\u6bcf\u4e2a\u9500\u552e\u70b9\u4e3a3000\u4e2a\u5ba2\u6237\u63d0\u4f9b\u670d\u52a1\uff1b\u6bcf\u4e2a\u5ba2\u6237\u5e73\u5747\u4e00\u4e2a\u8ba2\u5355\u670910\u9879\u4ea7\u54c1\uff1b\u6240\u6709\u8ba2\u5355\u4e2d\u7ea61%\u7684\u4ea7\u54c1\u5728\u5176\u76f4\u63a5\u6240\u5c5e\u7684\u4ed3\u5e93\u4e2d\u6ca1\u6709\u5b58\u8d27\uff0c\u9700\u8981\u7531\u5176\u4ed6\u533a\u57df\u7684\u4ed3\u5e93\u6765\u4f9b\u8d27\u3002</p> <p>TPC-C\u7684\u6279\u53d1\u64cd\u4f5c\u5728\u6982\u5ff5\u4e0a\u5305\u62ec5\u4e2a\u64cd\u4f5c\uff0c\u65b0\u8ba2\u5355\u64cd\u4f5c\u3001\u4ed8\u6b3e\u64cd\u4f5c\u3001\u8ba2\u5355\u72b6\u6001\u64cd\u4f5c\u3001\u53d1\u8d27\u64cd\u4f5c\uff0c\u5e93\u5b58\u64cd\u4f5c\uff0c\u8fd9\u4e9b\u64cd\u4f5c\u4e00\u8d77\u6784\u6210\u4e86\u5b8c\u6574\u7684\u6279\u53d1\u6d41\u7a0b\uff0c\u5176\u4e2d\u65b0\u8ba2\u5355\u64cd\u4f5c\u662f\u7528\u6765\u8861\u91cftpmC\u7684\u6838\u5fc3\uff0c\u4e5f\u5c31\u662f\u6570\u636e\u5e93\u7cfb\u7edf\u6bcf\u5206\u949f\u6240\u80fd\u5904\u7406\u7684\u4ea4\u6613\u6570\u91cf\u3002\u4e0b\u9762\uff0c\u6211\u4eec\u5c06\u8be6\u7ec6\u8bb2\u8ff0TPCC\u7684\u6570\u636e\u5e93\u8bbe\u8ba1\u4e0e\u7279\u70b9\uff0c\u4ee5\u53ca\u5404\u4e2a\u64cd\u4f5c\u7684\u7ec4\u6210\u3002</p> <ul> <li> <p>New-Order\uff1a\u5ba2\u6237\u8f93\u5165\u4e00\u7b14\u65b0\u7684\u8ba2\u8d27\u4ea4\u6613\uff1b</p> </li> <li> <p>Payment\uff1a\u66f4\u65b0\u5ba2\u6237\u8d26\u6237\u4f59\u989d\u4ee5\u53cd\u6620\u5176\u652f\u4ed8\u72b6\u51b5\uff1b</p> </li> <li> <p>Delivery\uff1a\u53d1\u8d27(\u6a21\u62df\u6279\u5904\u7406\u4ea4\u6613)\uff1b</p> </li> <li> <p>Order-Status:\u67e5\u8be2\u5ba2\u6237\u6700\u8fd1\u4ea4\u6613\u7684\u72b6\u6001\uff1b</p> </li> <li> <p>Stock-Level:\u67e5\u8be2\u4ed3\u5e93\u5e93\u5b58\u72b6\u51b5\uff0c\u4ee5\u4fbf\u80fd\u591f\u53ca\u65f6\u8865\u8d27\u3002</p> </li> </ul> <p>TPC-C\u4f7f\u7528tpmC\u503c\uff08Transactions per Minute\uff09\u6765\u8861\u91cf\u7cfb\u7edf\u6700\u5927\u6709\u6548\u541e\u5410\u91cf\uff08MQTh\uff0cMax Qualified Throughput\uff09\uff0c\u5176\u4e2dTransactions\u4ee5NewOrder Transaction\u4e3a\u51c6\uff0c\u5373\u6700\u7ec8\u8861\u91cf\u5355\u4f4d\u4e3a\u6bcf\u5206\u949f\u5904\u7406\u7684\u65b0\u8ba2\u5355\u6570\u3002</p> <p>TPC-C\u662f\u4e00\u79cd\u65e8\u5728\u8861\u91cf\u8054\u673a\u4e8b\u52a1\u5904\u7406\uff08OLTP\uff09\u7cfb\u7edf\u6027\u80fd\u4e0e\u53ef\u4f38\u7f29\u6027\u7684\u884c\u4e1a\u6807\u51c6\u57fa\u51c6\u6d4b\u8bd5\u9879\u76ee\u3002\u8fd9\u79cd\u57fa\u51c6\u6d4b\u8bd5\u9879\u76ee\u5c06\u5bf9\u5305\u62ec\u67e5\u8be2\u3001\u66f4\u65b0\u53ca\u961f\u5217\u5f0f\u5c0f\u6279\u91cf\u4e8b\u52a1\u5728\u5185\u7684\u5e7f\u6cdb\u6570\u636e\u5e93\u529f\u80fd\u8fdb\u884c\u6d4b\u8bd5\u3002\u8bb8\u591aIT\u4e13\u4e1a\u4eba\u5458\u5c06TPC-C\u89c6\u4e3a\u8861\u91cf\u201c\u771f\u5b9e\u201dOLTP\u7cfb\u7edf\u6027\u80fd\u7684\u6709\u6548\u6307\u793a\u5668\u3002</p> <p>\u8be5\u7cfb\u7edf\u9700\u8981\u5904\u7406\u7684\u4ea4\u6613\u4e3a\u4ee5\u4e0b\u51e0\u79cd\uff1a</p> <p>New-Order\uff1a\u5ba2\u6237\u8f93\u5165\u4e00\u7b14\u65b0\u7684\u8ba2\u8d27\u4ea4\u6613\uff1b</p> <p>Payment:\u66f4\u65b0\u5ba2\u6237\u8d26\u6237\u4f59\u989d\u4ee5\u53cd\u6620\u5176\u652f\u4ed8\u72b6\u51b5;</p> <p>Delivery:\u53d1\u8d27(\u6a21\u62df\u6279\u5904\u7406\u4ea4\u6613);</p> <p>Order-Status:\u67e5\u8be2\u5ba2\u6237\u6700\u8fd1\u4ea4\u6613\u7684\u72b6\u6001\uff1b</p> <p>Stock-Level:\u67e5\u8be2\u4ed3\u5e93\u5e93\u5b58\u72b6\u51b5\uff0c\u4ee5\u4fbf\u80fd\u591f\u53ca\u65f6\u8865\u8d27\u3002</p> <p>\u5bf9\u4e8e\u524d\u56db\u79cd\u7c7b\u578b\u7684\u4ea4\u6613\uff0c\u8981\u6c42\u54cd\u5e94\u65f6\u95f4\u57285\u79d2\u4ee5\u5185\uff1b\u5bf9\u4e8e\u5e93\u5b58\u72b6\u51b5\u67e5\u8be2\u4ea4\u6613\uff0c\u8981\u6c42\u54cd\u5e94\u65f6\u95f4\u572820\u79d2\u4ee5\u5185\u3002</p> <p>\uff082\uff09\u8bc4\u6d4b\u6307\u6807</p> <p>TPC-C\u7684\u6d4b\u8bd5\u7ed3\u679c\u4e3b\u8981\u6709\u4e24\u4e2a\u6307\u6807\uff1a</p> <p>tpmC\u6d41\u91cf\u6307\u6807(Transactions per minute C)\uff0c\u8d8a\u5927\u8d8a\u597d          \u6309\u7167TPC\u7684\u5b9a\u4e49\uff0c\u6d41\u91cf\u6307\u6807\u63cf\u8ff0\u4e86\u7cfb\u7edf\u5728\u6267\u884cPayment\u3001Order-status\u3001Delivery\u3001Stock-Level\u8fd9\u56db\u79cd\u4ea4\u6613\u7684\u540c\u65f6\uff0c\u6bcf\u5206\u949f\u53ef\u4ee5\u5904\u7406\u591a\u5c11\u4e2aNew-Order\u4ea4\u6613\u3002\u6240\u6709\u4ea4\u6613\u7684\u54cd\u5e94\u65f6\u95f4\u5fc5\u987b\u6ee1\u8db3TPC-C\u6d4b\u8bd5\u89c4\u8303\u7684\u8981\u6c42\u3002</p> <p>Price/tpmC\u6027\u4ef7\u6bd4(Price/Performance)\uff0c\u8d8a\u5c0f\u8d8a\u597d           \u5373\u6d4b\u8bd5\u7cfb\u7edf\u4ef7\u683c\uff08\u6307\u5728\u7f8e\u56fd\u7684\u62a5\u4ef7\uff09\u4e0e\u6d41\u91cf\u6307\u6807\u7684\u6bd4\u503c\u3002</p> <p>\uff083\uff09\u53d1\u5e03\u7ed3\u679c</p> <p>\u5404\u5382\u5546\u7684TPC-C\u6d4b\u8bd5\u7ed3\u679c\u90fd\u6309TPC\u7ec4\u7ec7\u89c4\u5b9a\u7684\u4e24\u79cd\u5f62\u5f0f\u53d1\u5e03\uff1a\u6d4b\u8bd5\u7ed3\u679c\u6982\u8981(Executive Summary)\u548c\u8be6\u7ec6\u6d4b\u8bd5\u62a5\u544a(Full Disclosure Report)\u3002\u6d4b\u8bd5\u7ed3\u679c\u6982\u8981\u4e2d\u63cf\u8ff0\u4e86\u4e3b\u8981\u7684\u6d4b\u8bd5\u6307\u6807\u3001\u6d4b\u8bd5\u73af\u5883\u793a\u610f\u56fe\u4ee5\u53ca\u5b8c\u6574\u7684\u7cfb\u7edf\u914d\u7f6e\u4e0e\u62a5\u4ef7\uff0c\u800c\u8be6\u7ec6\u6d4b\u8bd5\u62a5\u544a\u4e2d\u9664\u4e86\u5305\u542b\u4e0a\u8ff0\u5185\u5bb9\u5916\uff0c\u8fd8\u8be6\u7ec6\u8bf4\u660e\u4e86\u6574\u4e2a\u6d4b\u8bd5\u73af\u5883\u7684\u8bbe\u7f6e\u4e0e\u6d4b\u8bd5\u8fc7\u7a0b\u3002</p>"},{"location":"optimize/1.overview/#_4","title":"\u57fa\u51c6\u6d4b\u8bd5\u7684\u6027\u80fd\u6307\u6807","text":"<p>\u5728\u8861\u91cf\u4e00\u4e2a\u7cfb\u7edf\u6027\u80fd\u65f6\uff0c\u4e00\u5b9a\u8981\u6709\u53ef\u91cf\u5316\u7684\u6307\u6807\uff0c\u65e0\u6cd5\u91cf\u5316\u5c31\u65e0\u6cd5\u6709\u6548\u7684\u4f18\u5316\u7cfb\u7edf\u6027\u80fd\u3002\u7cfb\u7edf\u6bcf\u79d2\u53ef\u4ee5\u627f\u8f7d\u591a\u5927\u8bf7\u6c42\u91cf\uff0c\u6bcf\u4e2a\u8bf7\u6c42\u7684\u54cd\u5e94\u65f6\u95f4\uff0c\u5e76\u53d1\u6570\u7b49\u90fd\u662f\u8861\u91cf\u4e00\u4e2a\u7cfb\u7edf\u7684\u5173\u952e\u6027\u80fd\u6307\u6807\u3002</p> <p>\u541e\u5410\u91cf-Throughput</p> <p>\u541e\u5410\u91cf\u6307\u7684\u662f\u5355\u4f4d\u65f6\u95f4\u5185\u7684\u4e8b\u52a1\u5904\u7406\u6570\u3002\u8fd9\u4e00\u76f4\u662f\u7ecf\u5178\u7684\u6570\u636e\u5e93\u5e94\u7528\u6d4b\u8bd5\u6307\u6807\u3002\uff08\u9ad8\u5e76\u53d1\u7cfb\u7edf\u5fc5\u5907\uff09 \u5728\u8861\u91cf\u7cfb\u7edf\u6027\u80fd\u4e00\u76f4\u4f5c\u4e3a\u4e00\u4e2a\u7ecf\u5178\u548c\u91cd\u8981\u7684\u6307\u6807\uff0c\u9002\u7528\u4e8e\u591a\u7528\u6237\u7684\u4ea4\u4e92\u5f0f\u5e94\u7528\uff0c\u6bd4\u5982Web\u670d\u52a1\u5668\u7684\u591a\u7528\u6237\u8bbf\u95ee\u548c\u6570\u636e\u5e93\u7684\u591a\u8bf7\u6c42\u64cd\u4f5c\u3002</p> <p>\u541e\u5410\u91cf\u5e38\u7528\u7684\u8ba1\u91cf\u5355\u4f4d\uff1a</p> <ul> <li> <p>\u6bcf\u79d2\u4e8b\u52a1\u6570\uff08TPS Transactions Per Second\uff09</p> </li> <li> <p>\u6bcf\u79d2\u67e5\u8be2\u6570\uff08QPS Query Per Second\uff09 \uff0c\u6bcf\u79d2\u80fd\u591f\u54cd\u5e94\u7684\u67e5\u8be2\u6b21\u6570\u3002</p> </li> </ul> <p>\u6bd4\u5982\uff0c\u5bf9\u4e8eWeb\u670d\u52a1\u5668\uff0c\u7528\u6237\u5bf9\u67d0\u4e00\u4e2a\u9875\u9762\u7684\u4e00\u6b21\u8bf7\u6c42\uff0c\u7528\u6237\u5bf9\u67d0\u7cfb\u7edf\u7684\u4e00\u6b21\u767b\u5f55\uff0c\u7528\u6237\u5bf9\u5546\u54c1\u7684\u4e00\u6b21\u786e\u8ba4\u652f\u4ed8\u8fc7\u7a0b\uff1b \u5bf9\u4e8e\u6570\u636e\u5e93\uff0c\u4e00\u6b21\u67e5\u8be2\u3001\u4fee\u6539\u3001\u65b0\u589e\u3001\u5220\u9664\u3002\u8fd9\u4e9b\u6211\u4eec\u90fd\u53ef\u4ee5\u770b\u4f5c\u4e00\u4e2a\u4e8b\u52a1\u6216\u8005\u8bf7\u6c42\u3002</p>"},{"location":"optimize/1.overview/#qps","title":"QPS","text":"<p>QPS\u00a0<code>Queries Per Second</code>\u00a0\u662f\u6bcf\u79d2\u67e5\u8be2\u7387\uff0c\u662f\u4e00\u53f0\u670d\u52a1\u5668\u6bcf\u79d2\u80fd\u591f\u76f8\u5e94\u7684\u67e5\u8be2\u6b21\u6570\uff0c\u662f\u5bf9\u4e00\u4e2a\u7279\u5b9a\u7684\u67e5\u8be2\u670d\u52a1\u5668\u5728\u89c4\u5b9a\u65f6\u95f4\u5185\u6240\u5904\u7406\u6d41\u91cf\u591a\u5c11\u7684\u8861\u91cf\u6807\u51c6, \u5373\u6bcf\u79d2\u7684\u54cd\u5e94\u8bf7\u6c42\u6570\uff0c\u4e5f\u5373\u662f\u6700\u5927\u541e\u5410\u80fd\u529b\u3002QPS \u4e2d\u7684 Q \u5e94\u8be5\u548c SQL \u4e2d\u7684 Q \u4e00\u6837\uff0c\u90fd\u662f\u5e7f\u4e49\u4e0a\u7684 Query\uff0c\u4e5f\u5c31\u662f\u6240\u6709\u7684 <code>SQL</code> \u8bed\u53e5\u3002</p> <p>\u5173\u4e8e\u8fd9\u4e2aQ\uff0c\u5176\u5b9e\u5728MySQL\u4e0a\u4e5f\u6709\u4e24\u4e2a\u53d8\u91cf\u3002</p> <pre><code>show global status like 'Que%'\n+---------------+------------+\n| Variable_name | Value      |\n+---------------+------------+\n| Queries       | 6173236173 |\n| Questions     | 5451023114 |\n+---------------+------------+\n2 rows in set (0.48 sec)\n</code></pre> <pre><code>Queries\n\nThe number of statements executed by the server. This variable includes statements executed within stored programs, unlike the Questions variable. It does not count COM_PING or COM_STATISTICS commands.\n\nThe discussion at the beginning of this section indicates how to relate this statement-counting status variable to other such variables.\n\n\u670d\u52a1\u5668\u6267\u884c\u7684\u8bed\u53e5\u6570\u3002\u6b64\u53d8\u91cf\u5305\u62ec\u5728\u5b58\u50a8\u8fc7\u7a0b\u548c\u51fd\u6570\u4e2d\u6267\u884c\u7684\u8bed\u53e5\uff0c\u4e0eQuestions\u53d8\u91cf\u4e0d\u540c\u3002 \u5b83\u4e0d\u8ba1\u7b97COM_PING\u6216COM_STATISTICS\u547d\u4ee4\n\n\nQuestions\n\nThe number of statements executed by the server. This includes only statements sent to the server by clients and not statements executed within stored programs, unlike the Queries variable. This variable does not count COM_PING, COM_STATISTICS, COM_STMT_PREPARE, COM_STMT_CLOSE, or COM_STMT_RESET commands.\n\nThe discussion at the beginning of this section indicates how to relate this statement-counting status variable to other such variables.\n\n\u670d\u52a1\u5668\u6267\u884c\u7684\u8bed\u53e5\u6570\u3002\u4ec5\u5305\u62ec\u7531\u5ba2\u6237\u7aef\u53d1\u9001\u5230\u670d\u52a1\u5668\u7684\u8bed\u53e5\uff0c\u800c\u4e0d\u5305\u62ec\u5728\u5b58\u50a8\u8fc7\u7a0b\u548c\u5b58\u50a8\u51fd\u6570\u4e2d\u6267\u884c\u7684\u8bed\u53e5\uff0c\u8fd9\u4e0eQueries\u53d8\u91cf\u4e0d\u540c\u3002 \n\n\u6b64\u53d8\u91cf\u4e0d\u8ba1\u7b97COM_PING\uff0cCOM_STATISTICS\uff0cCOM_STMT_PREPARE\uff0cCOM_STMT_CLOSE\u6216COM_STMT_RESET\u547d\u4ee4\n</code></pre> <p>\u4ece\u5b9a\u4e49\u4e0a\u770b\u7740Queries\u662f\u5305\u542b\u5b58\u50a8\u8fc7\u7a0b\uff0c\u5e76\u4e14\u4e0d\u5305\u542b <code>com_ping</code> \u548c <code>com_statistics</code> \uff0c\u800cQuestions \u5219\u662f\u5305\u542b\u5927\u91cfCom \u64cd\u4f5c\u7684\u3002\u90a3\u5230\u5e95\u4f7f\u7528\u90a3\u4e2a\u4f5c\u4e3a\u5c55\u793a\u7684\u53c2\u6570\uff1f   \u4e00\u822c\u4f1a\u4f7f\u7528 quersions \u7684\u503c\u4f5c\u4e3a\u4e00\u4e2a\u76d1\u63a7\u503c\uff0c\u4f8b\u5982pmm \u4e2d\u5e76\u6ca1\u6709 queries \u800c\u9009\u62e9\u663e\u793a\u7684\u662f questions \u4f5c\u4e3a\u4e00\u4e2a\u6570\u636e\u5e93\u6267\u884c\u8bed\u53e5\u7684\u76d1\u63a7\u503c\u3002</p>"},{"location":"optimize/1.overview/#tps","title":"TPS","text":"<p>TPS\u00a0<code>Transactions Per Second</code>\u00a0\u4e5f\u5c31\u662f\u4e8b\u52a1\u6570/\u79d2</p> <p>\u4eceweb\u5e94\u7528\u7684\u89d2\u5ea6\u6765\u8bf4\uff0c\u5305\u62ec\u4e86</p> <p>1\uff09\u7528\u6237\u901a\u8fc7client\u5de5\u5177\uff0c\u5f00\u59cb\u53d1\u8d77\u8bf7\u6c42 2\uff09client\u5de5\u5177\u6267\u884cN\u4e2a\u670d\u52a1\u7aef\u7684API\u8c03\u7528 3\uff09client\u8fdb\u884cAPI\u7ed3\u679c\u7684\u805a\u5408\u518d\u6e32\u67d3\uff0c\u6700\u540e\u5448\u73b0\u7ed9\u7528\u6237\u3002</p> <p>\u8fd9\u4e09\u4e2a\u8fc7\u7a0b\u7ec4\u6210\u4e00\u4e2a\u4e8b\u52a1\uff0c\u6bcf\u79d2\u80fd\u591f\u5b8c\u6210N\u4e8b\u52a1\uff0cTps\u4e5f\u5c31\u662fN\u3002</p> <p>\u54cd\u5e94\u65f6\u95f4\u6216\u5ef6\u8fdf</p> <p>\u8fd9\u4e2a\u6307\u6807\u7528\u4e8e\u6d4b\u8bd5\u4efb\u52a1\u6240\u9700\u7684\u6574\u4f53\u65f6\u95f4\u3002\u6839\u636e\u5177\u4f53\u7684\u5e94\u7528\uff0c\u6d4b\u8bd5\u7684\u65f6\u95f4\u5355\u4f4d\u53ef\u80fd\u662f\u5fae\u79d2\uff0c\u6beb\u79d2\uff0c\u79d2\uff0c\u5206\u949f\u3002 \u6839\u636e\u4e0d\u540c\u7684\u65f6\u95f4\u5355\u4f4d\u53ef\u4ee5\u8ba1\u7b97\u51fa\u5e73\u5747\u54cd\u5e94\u65f6\u95f4\uff0c\u6700\u5c0f\u54cd\u5e94\u65f6\u95f4\uff0c\u6700\u5927\u54cd\u5e94\u65f6\u95f4\u548c\u6240\u5360\u7684\u767e\u5206\u6bd4\u3002 \u901a\u5e38\u6bd4\u8f83\u591a\u4f7f\u7528\u7684\u767e\u5206\u6bd4\u54cd\u5e94\u65f6\u95f4\uff0c\u4f8b\u5982\uff1a95%\u7684\u54cd\u5e94\u65f6\u95f4\u90fd\u662f5\u6beb\u79d2\uff0c\u5219\u8868\u793a\u4efb\u52a1\u572895%\u7684\u65f6\u95f4\u6bb5\u5185\u90fd\u53ef\u4ee5\u57285\u6beb\u79d2\u4e4b\u5185\u5b8c\u6210\u3002 \u5c06\u54cd\u5e94\u65f6\u95f4\u7ed8\u5236\u6210\u6298\u7ebf\u56fe\u6216\u6563\u70b9\u56fe\u6216\u76f4\u65b9\u56fe \uff0c\u53ef\u4ee5\u76f4\u89c2\u5730\u8868\u73b0\u51fa\u6570\u636e\u7ed3\u679c\u96c6\u7684\u5206\u5e03\u60c5\u51b5\u3002</p> <p>\u67e5\u8be2\u54cd\u5e94\u65f6\u95f4(Query response time )\u662f\u6307MySQL\u6267\u884c\u67e5\u8be2\u6240\u9700\u7684\u65f6\u95f4\u3002\u540c\u4e49\u8bcd\u5305\u62ec\u54cd\u5e94\u65f6\u95f4(response time)\u3001\u67e5\u8be2\u65f6\u95f4(query time)\u3001\u6267\u884c\u65f6\u95f4(execution time)\uff0c\u4ee5\u53ca\uff08\u4e0d\u51c6\u786e\u5730\u8bf4\uff09\u67e5\u8be2\u5ef6\u8fdf(query latency)\u3002</p> <p>\u8ba1\u65f6\u5f00\u59cb\u4e8eMySQL\u63a5\u6536\u67e5\u8be2\uff0c\u7ed3\u675f\u4e8e\u5b83\u5c06\u7ed3\u679c\u96c6\u53d1\u9001\u7ed9\u5ba2\u6237\u7aef\u3002</p>"},{"location":"optimize/1.overview/#_5","title":"\u67e5\u8be2\u62a5\u544a","text":"<p>\u67e5\u8be2\uff0c\u5305\u62ec\u8bb8\u591a\u9636\u6bb5\uff08\u67e5\u8be2\u6267\u884c\u4e2d\u7684\u6b65\u9aa4\uff09\u548c\u7b49\u5f85\uff08\u9501\u7b49\u5f85\u3001I/O\u7b49\u5f85\u7b49\uff09\uff0c\u4f46\u662f\u5b8c\u6574\u800c\u8be6\u7ec6\u7684\u5206\u89e3\u65e2\u4e0d\u53ef\u80fd\u4e5f\u4e0d\u5fc5\u8981\u3002</p> <p>\u4e0e\u8bb8\u591a\u7cfb\u7edf\u4e00\u6837\uff0c\u57fa\u672c\u7684\u6545\u969c\u6392\u9664\u548c\u5206\u6790\u53ef\u4ee5\u63ed\u793a\u5927\u90e8\u5206\u95ee\u9898\u3002</p> <p>\u67e5\u8be2\u6307\u6807\u63d0\u4f9b\u4e86\u6709\u5173\u67e5\u8be2\u6267\u884c\u7684\u5b9d\u8d35\u6d1e\u89c1\uff0c\u5305\u62ec\u54cd\u5e94\u65f6\u95f4\u3001\u9501\u5b9a\u65f6\u95f4\u3001\u68c0\u67e5\u7684\u884c\u6570\u7b49\u7b49\u3002</p> <p>\u4f46\u662f\u4e0e\u6240\u6709\u6307\u6807\u4e00\u6837\uff0c\u67e5\u8be2\u6307\u6807\u662f\u539f\u59cb\u503c\uff0c\u9700\u8981\u88ab\u6536\u96c6\u3001\u6c47\u603b\uff0c\u5e76\u4ee5\u5bf9\u5de5\u7a0b\u5e08\u6709\u610f\u4e49\uff08\u4e14\u6613\u8bfb\uff09\u7684\u65b9\u5f0f\u5448\u73b0\u3002</p> <p>\u8fd9\u6b63\u662f\u672c\u8282\u7684\u5185\u5bb9\uff1a\u67e5\u8be2\u6307\u6807\u5de5\u5177\u5982\u4f55\u5c06\u67e5\u8be2\u6307\u6807\u8f6c\u5316\u4e3a\u67e5\u8be2\u62a5\u544a\u3002\u4f46\u662f\u67e5\u8be2\u62a5\u544a\u53ea\u662f\u8fbe\u5230\u76ee\u7684\u7684\u624b\u6bb5\u4e4b\u4e00\u3002</p>"},{"location":"optimize/1.overview/#_6","title":"\u6e90","text":"<p>\u67e5\u8be2\u6307\u6807\u6765\u81ea <code>\u6162\u67e5\u8be2\u65e5\u5fd7</code> \u548c <code>performance_schema</code> , \u540e\u8005\u53ef\u80fd\u662f\u6700\u597d\u7684\u67e5\u8be2\u6307\u6807\u6570\u636e\u6765\u6e90\u3002</p> <p>MySQL\u6162\u67e5\u8be2\u65e5\u5fd7\u662fMySQL\u63d0\u4f9b\u7684\u4e00\u79cd\u65e5\u5fd7\u8bb0\u5f55\uff0c\u7528\u6765\u8bb0\u5f55\u6267\u884c\u65f6\u957f\u8d85\u8fc7\u6307\u5b9a\u65f6\u957f\u7684\u67e5\u8be2\u8bed\u53e5\uff0c\u5177\u4f53\u6307\u8fd0\u884c\u65f6\u95f4\u8d85\u8fc7 long_query_time \u503c\u7684 SQL \u8bed\u53e5\uff0c\u5219\u4f1a\u88ab\u8bb0\u5f55\u5230\u6162\u67e5\u8be2\u65e5\u5fd7\u4e2d\u3002</p> <pre><code>mysql&gt; \nmysql&gt;  SHOW VARIABLES LIKE '%query%';\n+------------------------------+-------------------------------------+\n| Variable_name                | Value                               |\n+------------------------------+-------------------------------------+\n| binlog_rows_query_log_events | OFF                                 |\n| ft_query_expansion_limit     | 20                                  |\n| have_query_cache             | NO                                  |\n| long_query_time              | 10.000000                           |\n| query_alloc_block_size       | 8192                                |\n| query_prealloc_size          | 8192                                |\n| slow_query_log               | OFF                                 |\n| slow_query_log_file          | /data/mysql/data/localhost-slow.log |\n+------------------------------+-------------------------------------+\n8 rows in set (0.00 sec)\n\nmysql&gt; \n</code></pre> <pre><code># slow logging\nslow_query_log=1    ## \u662f\u5426\u542f\u7528\u6162\u67e5\u8be2\u65e5\u5fd7\uff0c[1 | 0] \u6216\u8005 [ON | OFF]\uff0c MySQL 5.6\u4ee5\u524d\u6b64\u53c2\u6570\u5e94\u8be5\u4e3alog_slow_queries\nlog-output=FILE     ## \u6307\u5b9a\u7528\u6587\u4ef6\u5b58\u50a8\u6216\u8005\u7528\u6570\u636e\u8868\u5b58\u50a8\uff0c\u4e0e\u901a\u7528\u67e5\u8be2\u65e5\u5fd7\u5171\u7528\u8fd9\u4e2a\u53c2\u6570\uff0c\u65e5\u5fd7\u8bb0\u5f55\u5230\u7cfb\u7edf\u7684\u4e13\u7528\u65e5\u5fd7\u8868\u4e2d\uff0c\u8981\u6bd4\u8bb0\u5f55\u5230\u6587\u4ef6\u8017\u8d39\u66f4\u591a\u7684\u7cfb\u7edf\u8d44\u6e90\uff0c\u56e0\u6b64\u5bf9\u4e8e\u9700\u8981\u542f\u7528\u6162\u67e5\u8be2\u65e5\u5fd7\uff0c\u53c8\u9700\u8981\u80fd\u591f\u83b7\u5f97\u66f4\u9ad8\u7684\u7cfb\u7edf\u6027\u80fd\uff0c\u90a3\u4e48\u5efa\u8bae\u4f18\u5148\u8bb0\u5f55\u5230\u6587\u4ef6\u3002\n\n\nslow_query_log_file  ## \u6307\u5b9a\u6587\u4ef6\u5b58\u50a8\u8def\u5f84\u548c\u6587\u4ef6\u540d\uff0c\u4e00\u822c\u5728\u6570\u636e\u76ee\u5f55\u4e0b\uff0c\u9ed8\u8ba4\u662f/var/lib/mysql/hostname-slow.log\u3002\n\nlong_query_time=10    ## \u6162\u67e5\u7684\u65f6\u957f\u5355\u4f4d\u4e3a\u79d2\uff0c\u9ed8\u8ba4\u662f10\u79d2\u3002\u53ef\u4ee5\u7cbe\u786e\u5230\u5c0f\u6570\u70b9\u540e6\u4f4d(\u5fae\u79d2)\u3002\nlog_queries_not_using_indexes  ## \u6ca1\u6709\u4f7f\u7528\u5230\u7d22\u5f15\u7684\u8bed\u53e5\uff0c\u662f\u5426\u88ab\u8bb0\u5f55\u5230\u6162\u67e5\u8be2\u65e5\u5fd7\u4e2d\u3002\nlog_timestamps      ## \u4e3b\u8981\u662f\u63a7\u5236 error log\u3001genera log\uff0c\u7b49\u7b49\u8bb0\u5f55\u65e5\u5fd7\u7684\u663e\u793a\u65f6\u95f4\u53c2\u6570\u3002\u9ed8\u8ba4\u65f6\u95f4\u6233\u662futc\u65f6\u95f4\u3002\u4e0e\u5317\u4eac\u65f6\u95f4\u76f8\u5dee8h\uff0c\u4e00\u822c\u6211\u4eec\u4f1a\u8bbe\u7f6e\u6210SYSTEMd\u4e3a\u64cd\u4f5c\u7cfb\u7edf\u65f6\u95f4\u3002\n</code></pre> <p>\u6162\u67e5\u8be2\u65e5\u5fd7\u5f00\u9500\u6bd4\u8f83\u5c0f\uff0c\u901a\u8fc7\u5bf9\u6162\u67e5\u8be2\u7684\u5206\u6790\u53ef\u4ee5\u5230\u7cfb\u7edf\u7684\u6027\u80fd\u95ee\u9898\uff0c\u627e\u5230\u76f8\u5173\u7684sql\u8bed\u53e5\u5e76\u8fdb\u4e00\u6b65\u4f18\u5316\uff0c\u56e0\u4e3a\u6216\u591a\u6216\u5c11\u90fd\u6709\u4e00\u4e9b\u6027\u80fd\u5f00\u9500\uff0c\u6240\u4ee5\u5982\u679c\u4e0d\u662f\u4e3a\u4e86\u8c03\u4f18\uff0c\u4e00\u822c\u5efa\u8bae\u4e0d\u7528\u5f00\u542f\u3002</p> <p>\u5bf9\u4e8e 8.0.14 \u4e4b\u524d\uff0c\u6162\u67e5\u8be2\u65e5\u5fd7\u4ec5\u63d0\u4f9b\u4e86 Query_time , Lock_time , Rows_sent , Rows_examined \u8fd9\u56db\u4e2a\u6307\u6807\u3002</p>"},{"location":"optimize/1.overview/#_7","title":"\u805a\u5408","text":"<p>\u67e5\u8be2\u6307\u6807\u53ef\u4ee5\u5206\u7ec4\u548c\u805a\u5408\u3002\u4f46\u662f\u6709\u4e9b\u67e5\u8be2\u6307\u6807\u5de5\u5177\u53ef\u4ee5\u6309\u7528\u6237\u540d\u3001\u4e3b\u673a\u540d\u3001\u6570\u636e\u5e93\u7b49\u8fdb\u884c\u5206\u7ec4\u3002\u8fd9\u4e9b\u5907\u9009\u5206\u7ec4\u975e\u5e38\u7f55\u89c1\uff0c\u5e76\u4e14\u4ea7\u751f\u4e86\u4e00\u79cd\u4e0d\u540c\u7c7b\u578b\u7684\u67e5\u8be2\u5206\u6790\u3002</p> <p>\u7531\u4e8e\u67e5\u8be2\u54cd\u5e94\u65f6\u95f4\u662fMySQL\u6027\u80fd\u7684\"\u5317\u6781\u661f\"\uff0c\u5c06\u67e5\u8be2\u6307\u6807\u6309\u67e5\u8be2\u8fdb\u884c\u5206\u7ec4\u662f\u67e5\u770b\u54ea\u4e9b\u67e5\u8be2\u5177\u6709\u6700\u6162\u54cd\u5e94\u65f6\u95f4\u7684\u6700\u4f73\u65b9\u5f0f\uff0c\u8fd9\u6784\u6210\u4e86\u67e5\u8be2\u62a5\u544a\u548c\u5206\u6790\u7684\u57fa\u7840\u3002</p> <p>\u5982\u4f55\u552f\u4e00\u6807\u8bc6\u67e5\u8be2\uff0c\u4ee5\u786e\u5b9a\u5b83\u4eec\u5c5e\u4e8e\u54ea\u4e9b\u5206\u7ec4\u5462\uff1f\u4f8b\u5982\uff0c\u7cfb\u7edf\u6307\u6807\uff08CPU\u3001\u5185\u5b58\u3001\u5b58\u50a8\u7b49\uff09\u6309\u4e3b\u673a\u540d\u8fdb\u884c\u5206\u7ec4\uff0c\u56e0\u4e3a\u4e3b\u673a\u540d\u662f\u552f\u4e00\u4e14\u6709\u610f\u4e49\u7684\u3002</p> <p>\u4f46\u662f\uff0c\u67e5\u8be2\u6ca1\u6709\u50cf\u4e3b\u673a\u540d\u90a3\u6837\u552f\u4e00\u6807\u8bc6\u7684\u5c5e\u6027\u3002\u89e3\u51b3\u529e\u6cd5\u662f\u4f7f\u7528SQL\u8bed\u53e5\u7684\u6807\u51c6\u5316\u5f62\u5f0f\u7684\u6458\u8981\u3002\u5e76\u5bf9\u6458\u8981\u6587\u672c\u8ba1\u7b97\u5176SHA-256\u54c8\u5e0c\u503c\u3002</p> <p><code>DIGEST TEXT</code> \u672c\u8d28\u662f\u4e00\u79cdSQL\u8bed\u53e5\u89c4\u8303\u5316\u540e\u5c06\u5e38\u91cf\u66ff\u6362\u6210'?'\u7684\u8fd0\u7b97\u7ed3\u679c\uff0c<code>STATEMENT_DIGEST_TEXT</code>\u51fd\u6570\u7528\u4e8e\u8ba1\u7b97\u8bed\u53e5\u7684 <code>DIGEST TEXT</code>(\u6458\u8981\u6587\u672c)\uff0c\u901a\u5e38\u6211\u4eec\u4e5f\u53ef\u4ee5\u79f0\u547c\u5176\u4e3a\uff0cSQL\u6307\u7eb9\uff1aSQL \u6307\u7eb9\u6307\u5c06\u4e00\u6761 SQL \u4e2d\u7684\u5b57\u9762\u503c\u66ff\u6362\u6210\u5176\u4ed6\u56fa\u5b9a\u7b26\u53f7\u3002\u53ef\u4ee5\u7528\u6765\u505a SQL \u8131\u654f\u6216\u8005 SQL \u5f52\u7c7b\u3002</p> <p>\u6458\u8981\u6587\u672c\u548c\u6458\u8981\u54c8\u5e0c\u90fd\u662f\u72ec\u4e00\u65e0\u4e8c\u7684\u3002\u6458\u8981\u6587\u672c\u4ee5\u53ca\u6458\u8981\u54c8\u5e0c\u503c\u7684\u4e00\u81f4\u6027\u6765\u81ea\u4e8e\u8868\u6216\u8005\u8fc7\u6ee4\u5b57\u6bb5\u7684\u4e0d\u53d8\u6027\uff0c\u5982\u679c\u8868\u540d\u6216\u8005\u8fc7\u6ee4\u5b57\u6bb5\u6709\u53d8\u5316\uff0cMySQL \u5c06\u4f1a\u5f52\u7c7b\u8fd9\u4e9b\u67e5\u8be2\u8bed\u53e5\u4e3a\u4e0d\u540c\u7684\u6458\u8981\u3002</p> <p>SQL\u8bed\u53e5\u88ab\u79f0\u4e3a\u67e5\u8be2\u6837\u672c</p> <pre><code>SELECT * FROM orders WHERE customer_id=10 AND quantity&gt;20\nSELECT * FROM orders WHERE customer_id = 20 AND quantity &gt; 100\n\nSELECT * FROM orders WHERE customer_id = ? AND quantity &gt; ?\n\n-- statement_digest()\uff1a\u8ba1\u7b97 SQL \u8bed\u53e5\u7684\u6458\u8981\u54c8\u5e0c\u503c\n\n-- statement_digest_text()\uff1a\u8fd4\u56de SQL \u8bed\u53e5\u5bf9\u5e94\u7684\u6458\u8981\u6587\u672c\n\nf49d50dfab1c364e622d1e1ff54bb12df436be5d44c464a4e25a1ebb80fc2f13\n</code></pre> <p>MySQL\u7684 <code>PERFORMANCE_SCHEMA</code> \u7528\u4e8e\u5728\u4e00\u4e2a\u8f83\u4f4e\u7ea7\u522b\u7684\u8fd0\u884c\u8fc7\u7a0b\u4e2d\u76d1\u63a7MySQL server\u7684\u8d44\u6e90\u6d88\u8017\u3001\u8d44\u6e90\u7b49\u5f85\u7b49\u60c5\u51b5\u3002</p> <p>\u200b\u7279\u70b9\u5982\u4e0b\uff1a</p> <ul> <li>\u63d0\u4f9b\u4e86\u4e00\u79cd\u5728\u6570\u636e\u5e93\u8fd0\u884c\u65f6\u5b9e\u65f6\u68c0\u67e5server\u7684\u5185\u90e8\u6267\u884c\u60c5\u51b5\u7684\u65b9\u6cd5\u3002PERFORMANCE_SCHEMA \u6570\u636e\u5e93\u4e2d\u7684\u8868\u4f7f\u7528PERFORMANCE_SCHEMA\u5b58\u50a8\u5f15\u64ce\u3002</li> </ul> <p>\u8be5\u6570\u636e\u5e93\u4e3b\u8981\u5173\u6ce8\u6570\u636e\u5e93\u8fd0\u884c\u8fc7\u7a0b\u4e2d\u7684\u6027\u80fd\u76f8\u5173\u7684\u6570\u636e\uff0c\u4e0einformation_schema\u4e0d\u540c\uff0cinformation_schema\u4e3b\u8981\u5173\u6ce8server\u8fd0\u884c\u8fc7\u7a0b\u4e2d\u7684\u5143\u6570\u636e\u4fe1\u606f</p> <ul> <li>PERFORMANCE_SCHEMA\u901a\u8fc7\u76d1\u89c6server\u7684\u4e8b\u4ef6\u6765\u5b9e\u73b0\u76d1\u89c6server\u5185\u90e8\u8fd0\u884c\u60c5\u51b5\uff0c \u201c\u4e8b\u4ef6\u201d\u5c31\u662fserver\u5185\u90e8\u6d3b\u52a8\u4e2d\u6240\u505a\u7684\u4efb\u4f55\u4e8b\u60c5\u4ee5\u53ca\u5bf9\u5e94\u7684\u65f6\u95f4\u6d88\u8017\uff0c\u5229\u7528\u8fd9\u4e9b\u4fe1\u606f\u6765\u5224\u65adserver\u4e2d\u7684\u76f8\u5173\u8d44\u6e90\u6d88\u8017\u5728\u4e86\u54ea\u91cc\uff1f</li> </ul> <p>\u4e00\u822c\u6765\u8bf4\uff0c\u4e8b\u4ef6\u53ef\u4ee5\u662f\u51fd\u6570\u8c03\u7528\u3001\u64cd\u4f5c\u7cfb\u7edf\u7684\u7b49\u5f85\u3001SQL\u8bed\u53e5\u6267\u884c\u7684\u9636\u6bb5\uff08\u5982sql\u8bed\u53e5\u6267\u884c\u8fc7\u7a0b\u4e2d\u7684parsing \u6216 sorting\u9636\u6bb5\uff09\u6216\u8005\u6574\u4e2aSQL\u8bed\u53e5\u4e0eSQL\u8bed\u53e5\u96c6\u5408\u3002\u4e8b\u4ef6\u7684\u91c7\u96c6\u53ef\u4ee5\u65b9\u4fbf\u7684\u63d0\u4f9bserver\u4e2d\u7684\u76f8\u5173\u5b58\u50a8\u5f15\u64ce\u5bf9\u78c1\u76d8\u6587\u4ef6\u3001\u8868I/O\u3001\u8868\u9501\u7b49\u8d44\u6e90\u7684\u540c\u6b65\u8c03\u7528\u4fe1\u606f\u3002</p> <ul> <li> <p>PERFORMANCE_SCHEMA\u4e2d\u7684\u4e8b\u4ef6\u4e0e\u5199\u5165\u4e8c\u8fdb\u5236\u65e5\u5fd7\u4e2d\u7684\u4e8b\u4ef6\uff08\u63cf\u8ff0\u6570\u636e\u4fee\u6539\u7684events\uff09\u3001\u4e8b\u4ef6\u8ba1\u5212\u8c03\u5ea6\u7a0b\u5e8f\uff08\u8fd9\u662f\u4e00\u79cd\u5b58\u50a8\u7a0b\u5e8f\uff09\u7684\u4e8b\u4ef6\u4e0d\u540c\u3002PERFORMANCE_SCHEMA\u4e2d\u7684\u4e8b\u4ef6\u8bb0\u5f55\u7684\u662fserver\u6267\u884c\u67d0\u4e9b\u6d3b\u52a8\u5bf9\u67d0\u4e9b\u8d44\u6e90\u7684\u6d88\u8017\u3001\u8017\u65f6\u3001\u8fd9\u4e9b\u6d3b\u52a8\u6267\u884c\u7684\u6b21\u6570\u7b49\u60c5\u51b5\u3002</p> </li> <li> <p>PERFORMANCE_SCHEMA\u4e2d\u7684\u4e8b\u4ef6\u53ea\u8bb0\u5f55\u5728\u672c\u5730server\u7684PERFORMANCE_SCHEMA\u4e2d\uff0c\u5176\u4e0b\u7684\u8fd9\u4e9b\u8868\u4e2d\u6570\u636e\u53d1\u751f\u53d8\u5316\u65f6\u4e0d\u4f1a\u88ab\u5199\u5165binlog\u4e2d\uff0c\u4e5f\u4e0d\u4f1a\u901a\u8fc7\u590d\u5236\u673a\u5236\u88ab\u590d\u5236\u5230\u5176\u4ed6server\u4e2d\u3002</p> </li> <li> <p>\u5f53\u524d\u6d3b\u8dc3\u4e8b\u4ef6\u3001\u5386\u53f2\u4e8b\u4ef6\u548c\u4e8b\u4ef6\u6458\u8981\u76f8\u5173\u7684\u8868\u4e2d\u8bb0\u5f55\u7684\u4fe1\u606f\u3002\u80fd\u63d0\u4f9b\u67d0\u4e2a\u4e8b\u4ef6\u7684\u6267\u884c\u6b21\u6570\u3001\u4f7f\u7528\u65f6\u957f\u3002\u8fdb\u800c\u53ef\u7528\u4e8e\u5206\u6790\u67d0\u4e2a\u7279\u5b9a\u7ebf\u7a0b\u3001\u7279\u5b9a\u5bf9\u8c61\uff08\u5982mutex\u6216file\uff09\u76f8\u5173\u8054\u7684\u6d3b\u52a8\u3002</p> </li> <li> <p>PERFORMANCE_SCHEMA\u5b58\u50a8\u5f15\u64ce\u4f7f\u7528server\u6e90\u4ee3\u7801\u4e2d\u7684\u201c\u68c0\u6d4b\u70b9\u201d\u6765\u5b9e\u73b0\u4e8b\u4ef6\u6570\u636e\u7684\u6536\u96c6\u3002\u5bf9\u4e8ePERFORMANCE_SCHEMA\u5b9e\u73b0\u673a\u5236\u672c\u8eab\u7684\u4ee3\u7801\u6ca1\u6709\u76f8\u5173\u7684\u5355\u72ec\u7ebf\u7a0b\u6765\u68c0\u6d4b\uff0c\u8fd9\u4e0e\u5176\u4ed6\u529f\u80fd\uff08\u5982\u590d\u5236\u6216\u4e8b\u4ef6\u8ba1\u5212\u7a0b\u5e8f\uff09\u4e0d\u540c\u3002</p> </li> <li> <p>\u6536\u96c6\u7684\u4e8b\u4ef6\u6570\u636e\u5b58\u50a8\u5728PERFORMANCE_SCHEMA\u6570\u636e\u5e93\u7684\u8868\u4e2d\u3002\u8fd9\u4e9b\u8868\u53ef\u4ee5\u4f7f\u7528SELECT\u8bed\u53e5\u67e5\u8be2\uff0c\u4e5f\u53ef\u4ee5\u4f7f\u7528SQL\u8bed\u53e5\u66f4\u65b0PERFORMANCE_SCHEMA\u6570\u636e\u5e93\u4e2d\u7684\u8868\u8bb0\u5f55\uff08\u5982\u52a8\u6001\u4fee\u6539PERFORMANCE_SCHEMA\u7684setup_*\u5f00\u5934\u7684\u51e0\u4e2a\u914d\u7f6e\u8868\uff0c\u4f46\u8981\u6ce8\u610f\uff1a\u914d\u7f6e\u8868\u7684\u66f4\u6539\u4f1a\u7acb\u5373\u751f\u6548\uff0c\u8fd9\u4f1a\u5f71\u54cd\u6570\u636e\u6536\u96c6\uff09</p> </li> <li> <p>PERFORMANCE_SCHEMA\u7684\u8868\u4e2d\u7684\u6570\u636e\u4e0d\u4f1a\u6301\u4e45\u5316\u5b58\u50a8\u5728\u78c1\u76d8\u4e2d\uff0c\u800c\u662f\u4fdd\u5b58\u5728\u5185\u5b58\u4e2d\uff0c\u4e00\u65e6\u670d\u52a1\u5668\u91cd\u542f\uff0c\u8fd9\u4e9b\u6570\u636e\u4f1a\u4e22\u5931\uff08\u5305\u62ec\u914d\u7f6e\u8868\u5728\u5185\u7684\u6574\u4e2aPERFORMANCE_SCHEMA\u4e0b\u7684\u6240\u6709\u6570\u636e\uff09</p> </li> <li> <p>MySQL\u652f\u6301\u7684\u6240\u6709\u5e73\u53f0\u4e2d\u4e8b\u4ef6\u76d1\u63a7\u529f\u80fd\u90fd\u53ef\u7528\uff0c\u4f46\u4e0d\u540c\u5e73\u53f0\u4e2d\u7528\u4e8e\u7edf\u8ba1\u4e8b\u4ef6\u65f6\u95f4\u5f00\u9500\u7684\u8ba1\u65f6\u5668\u7c7b\u578b\u53ef\u80fd\u4f1a\u6709\u6240\u5dee\u5f02\u3002</p> </li> </ul> <p>\u5e76\u53d1\u6027</p> <p>\u5e76\u53d1\u6027\u662f\u4e00\u4e2a\u975e\u91cd\u8981</p>"},{"location":"optimize/1.overview/#_8","title":"\u5e38\u7528\u57fa\u51c6\u6d4b\u8bd5\u5b9e\u9645\u5de5\u5177","text":"<p>SysBench\u662f Peter Zaitsev \u57282004\u5e74\u6700\u5f00\u59cb\u53d1\u660e\u7684\uff0c\u5f88\u5feb\uff0cAlexey Kopytov \u63a5\u7ba1\u4e86\u5b83\u7684\u5f00\u53d1\u5de5\u4f5c\u3002\u5230<code>0.4.12</code>\u7248\u672c\u4faf\u5c31\u6682\u505c\u4e86\u3002</p> <p>Sysbench\u662f\u4e00\u6b3e\u57fa\u51c6\u6d4b\u8bd5\u5de5\u5177\uff0c\u6700\u5f00\u59cb\u88ab\u8bbe\u8ba1\u4e3a\u7528\u6765\u5bf9\u57fa\u4e8e\u786c\u4ef6\u670d\u52a1\u5668\u4e0a\u7684MySQ\u7684\u57fa\u51c6\u6027\u80fd\u6d4b\u8bd5\u5de5\u5177\u3002\u5305\u62ecCPU\uff0c\u5185\u5b58\uff0c\u78c1\u76d8IO\u7b49\u7b49\u3002 \u5b83\u4e5f\u652f\u6301\u5728<code>MySQL</code>\u4e0a\u7684<code>OLTP</code>\u5de5\u4f5c\u8d1f\u8f7d\u7684\u6d4b\u8bd5\uff0cOLTP\u5c31\u662f\u5728\u7ebf\u4e8b\u52a1\u5904\u7406\uff0c\u5178\u578b\u7684\u6570\u636e\u5e93\u5e94\u7528\u573a\u666f\u3002</p> <p>IO\u6d4b\u8bd5\u5bf9\u5e94InnoDB\u7684IO\u6027\u80fd\uff0c\u6ce8\u91cd\u6d4b\u8bd5IO\u5bc6\u96c6\u578b CPU\u6d4b\u8bd5\u5bf9\u5e94\u9ad8\u5e76\u53d1\uff0c\u591a\u7ebf\u7a0b\u7684\u573a\u666f\uff0c\u6ce8\u91cd\u6d4b\u8bd5CPU\u5bc6\u96c6\u578b</p> <p>\u5b83\u53ef\u4ee5\u8986\u76d6\u5230\u591a\u79cd\u573a\u666f\uff1aOLTP workloads\uff0cread-only or read-write, primary key lookups and primary key updates.</p> <p>BenchmarkSQL\u6d4b\u8bd5PostgreSQL</p>"},{"location":"optimize/1.overview/#_9","title":"\u4e09\u3001\u6570\u636e\u5e93\u8bbf\u95ee\u4f18\u5316\u6cd5\u5219\u7b80\u4ecb","text":"<p>\u8981\u6b63\u786e\u7684\u4f18\u5316SQL\uff0c\u6211\u4eec\u9700\u8981\u5feb\u901f\u5b9a\u4f4d\u80fd\u6027\u7684\u74f6\u9888\u70b9\uff0c\u4e5f\u5c31\u662f\u8bf4\u5feb\u901f\u627e\u5230\u6211\u4eecSQL\u4e3b\u8981\u7684\u5f00\u9500\u5728\u54ea\u91cc\uff1f\u800c\u5927\u591a\u6570\u60c5\u51b5\u6027\u80fd\u6700\u6162\u7684\u8bbe\u5907\u4f1a\u662f\u74f6\u9888\u70b9\uff0c\u5982\u4e0b\u8f7d\u65f6\u7f51\u7edc\u901f\u5ea6\u53ef\u80fd\u4f1a\u662f\u74f6\u9888\u70b9\uff0c\u672c\u5730\u590d\u5236\u6587\u4ef6\u65f6\u786c\u76d8\u53ef\u80fd\u4f1a\u662f\u74f6\u9888\u70b9\uff0c\u4e3a\u4ec0\u4e48\u8fd9\u4e9b\u4e00\u822c\u7684\u5de5\u4f5c\u6211\u4eec\u80fd\u5feb\u901f\u786e\u8ba4\u74f6\u9888\u70b9\u5462\uff0c\u56e0\u4e3a\u6211\u4eec\u5bf9\u8fd9\u4e9b\u6162\u901f\u8bbe\u5907\u7684\u6027\u80fd\u6570\u636e\u6709\u4e00\u4e9b\u57fa\u672c\u7684\u8ba4\u8bc6\uff0c\u5982\u7f51\u7edc\u5e26\u5bbd\u662f2Mbps\uff0c\u786c\u76d8\u662f\u6bcf\u5206\u949f7200\u8f6c\u7b49\u7b49\u3002\u56e0\u6b64\uff0c\u4e3a\u4e86\u5feb\u901f\u627e\u5230SQL\u7684\u6027\u80fd\u74f6\u9888\u70b9\uff0c\u6211\u4eec\u4e5f\u9700\u8981\u4e86\u89e3\u6211\u4eec\u8ba1\u7b97\u673a\u7cfb\u7edf\u7684\u786c\u4ef6\u57fa\u672c\u6027\u80fd\u6307\u6807\u3002</p> <p></p> <p>\u5f53\u4eca\u7684\u8ba1\u7b97\u673a\u7cfb\u7edf\u5f53\u4e2d\uff0c\u57fa\u672c\u4e0a\u5168\u90e8\u90fd\u7f6e\u5165\u4e86\u5404\u79cd\u5404\u6837\u7684\u5b58\u50a8\u8bbe\u5907\uff0c\u8fd9\u4e9b\u5b58\u50a8\u8bbe\u5907\u5448\u660e\u663e\u7684\u5c42\u6b21\u7ed3\u6784\uff0c\u5b83\u4eec\u7684\u7279\u70b9\u662f\u5bb9\u91cf\u8d8a\u5927\uff0c\u901f\u5ea6\u8d8a\u6162\u3002</p> <p>\u56e0\u6b64\u5982\u679c\u6309\u7167\u5bb9\u91cf\u548c\u901f\u5ea6\u5c06\u5b83\u4eec\u4ee5\u56fe\u793a\u7684\u65b9\u5f0f\u5448\u73b0\u7684\u8bdd\uff0c\u5219\u770b\u8d77\u6765\u5c31\u50cf\u662f\u4e00\u4e2a\u91d1\u5b57\u5854\uff0c\u4e0a\u56fe\u5c31\u662fcsapp\u4e2d\u7684\u8457\u540d\u7684 \u8ba1\u7b97\u673a\u5b58\u50a8\u7ed3\u6784\u5c42\u6b21\u91d1\u5b57\u5854 \u56fe\u3002</p> <p>\u4ece\u4e0a\u56fe\u53ef\u4ee5\u770b\u51fa\uff0c\u8ba1\u7b97\u673a\u7cfb\u7edf\u786c\u4ef6\u6027\u80fd\u4ece\u9ad8\u5230\u4ee3\u4f9d\u6b21\u4e3a\uff1a</p> <pre><code>CPU\u2014\u2014Cache(L1-L2-L3)\u2014\u2014\u5185\u5b58\u2014\u2014SSD\u786c\u76d8\u2014\u2014\u7f51\u7edc\u2014\u2014\u673a\u68b0\u786c\u76d8\n</code></pre> <p>\u6839\u636e\u6570\u636e\u5e93\u77e5\u8bc6\uff0c\u6211\u4eec\u53ef\u4ee5\u5217\u51fa\u6bcf\u79cd\u786c\u4ef6\u4e3b\u8981\u7684\u5de5\u4f5c\u5185\u5bb9\uff1a</p> <ul> <li> <p>CPU\u53ca\u5185\u5b58\uff1a\u7f13\u5b58\u6570\u636e\u8bbf\u95ee\u3001\u6bd4\u8f83\u3001\u6392\u5e8f\u3001\u4e8b\u52a1\u68c0\u6d4b\u3001SQL\u89e3\u6790\u3001\u51fd\u6570\u6216\u903b\u8f91\u8fd0\u7b97;</p> </li> <li> <p>\u7f51\u7edc\uff1a\u7ed3\u679c\u6570\u636e\u4f20\u8f93\u3001SQL\u8bf7\u6c42\u3001\u6570\u636e\u540c\u6b65\u3001\u65e5\u5fd7\u540c\u6b65\u7b49;</p> </li> <li> <p>\u786c\u76d8\uff1a\u6570\u636e\u8bbf\u95ee\u3001\u6570\u636e\u5199\u5165\u3001\u65e5\u5fd7\u8bb0\u5f55\u3001\u5927\u6570\u636e\u91cf\u6392\u5e8f\u3001\u5927\u8868\u8fde\u63a5\u3002</p> </li> </ul> <p>\u8fd9\u4e2a\u4f18\u5316\u6cd5\u5219\u5f52\u7eb3\u4e3a5\u4e2a\u5c42\u6b21\uff1a</p> <ul> <li> <p>\u51cf\u5c11\u6570\u636e\u8bbf\u95ee\uff08\u51cf\u5c11\u78c1\u76d8\u8bbf\u95ee\uff09</p> </li> <li> <p>\u8fd4\u56de\u66f4\u5c11\u6570\u636e\uff08\u51cf\u5c11\u7f51\u7edc\u4f20\u8f93\u6216\u78c1\u76d8\u8bbf\u95ee\uff09</p> </li> <li> <p>\u51cf\u5c11\u4ea4\u4e92\u6b21\u6570\uff08\u51cf\u5c11\u7f51\u7edc\u4f20\u8f93\uff09</p> </li> <li> <p>\u51cf\u5c11\u670d\u52a1\u5668CPU\u5f00\u9500\uff08\u51cf\u5c11CPU\u53ca\u5185\u5b58\u5f00\u9500\uff09</p> </li> <li> <p>\u5229\u7528\u66f4\u591a\u8d44\u6e90\uff08\u589e\u52a0\u8d44\u6e90\uff09</p> </li> </ul>"},{"location":"optimize/2.MySQL%E6%80%A7%E8%83%BD%E5%88%86%E6%9E%90%E5%B7%A5%E5%85%B7PFS/","title":"\u521d\u76f8\u8bc6\uff5cperformance_schema\u5168\u65b9\u4f4d\u4ecb\u7ecd\uff08PFS\uff09","text":"<p>MySQL\u7684performance schema \u7528\u4e8e\u76d1\u63a7MySQL server\u5728\u4e00\u4e2a\u8f83\u4f4e\u7ea7\u522b\u7684\u8fd0\u884c\u8fc7\u7a0b\u4e2d\u7684\u8d44\u6e90\u6d88\u8017\u3001\u8d44\u6e90\u7b49\u5f85\u7b49\u60c5\u51b5\uff0c\u5b83\u5177\u6709\u4ee5\u4e0b\u7279\u70b9\uff1a </p> <ol> <li> <p>\u63d0\u4f9b\u4e86\u4e00\u79cd\u5728\u6570\u636e\u5e93\u8fd0\u884c\u65f6\u5b9e\u65f6\u68c0\u67e5server\u7684\u5185\u90e8\u6267\u884c\u60c5\u51b5\u7684\u65b9\u6cd5\u3002performance_schema \u6570\u636e\u5e93\u4e2d\u7684\u8868\u4f7f\u7528performance_schema\u5b58\u50a8\u5f15\u64ce\u3002\u8be5\u6570\u636e\u5e93\u4e3b\u8981\u5173\u6ce8\u6570\u636e\u5e93\u8fd0\u884c\u8fc7\u7a0b\u4e2d\u7684\u6027\u80fd\u76f8\u5173\u7684\u6570\u636e\uff0c\u4e0einformation_schema\u4e0d\u540c\uff0cinformation_schema\u4e3b\u8981\u5173\u6ce8server\u8fd0\u884c\u8fc7\u7a0b\u4e2d\u7684\u5143\u6570\u636e\u4fe1\u606f\u3002</p> </li> <li> <p>performance_schema\u901a\u8fc7\u76d1\u89c6server\u7684\u4e8b\u4ef6\u6765\u5b9e\u73b0\u76d1\u89c6server\u5185\u90e8\u8fd0\u884c\u60c5\u51b5\uff0c \u201c\u4e8b\u4ef6\u201d\u5c31\u662fserver\u5185\u90e8\u6d3b\u52a8\u4e2d\u6240\u505a\u7684\u4efb\u4f55\u4e8b\u60c5\u4ee5\u53ca\u5bf9\u5e94\u7684\u65f6\u95f4\u6d88\u8017\uff0c\u5229\u7528\u8fd9\u4e9b\u4fe1\u606f\u6765\u5224\u65adserver\u4e2d\u7684\u76f8\u5173\u8d44\u6e90\u6d88\u8017\u5728\u4e86\u54ea\u91cc\uff1f\u4e00\u822c\u6765\u8bf4\uff0c\u4e8b\u4ef6\u53ef\u4ee5\u662f\u51fd\u6570\u8c03\u7528\u3001\u64cd\u4f5c\u7cfb\u7edf\u7684\u7b49\u5f85\u3001SQL\u8bed\u53e5\u6267\u884c\u7684\u9636\u6bb5\uff08\u5982sql\u8bed\u53e5\u6267\u884c\u8fc7\u7a0b\u4e2d\u7684parsing \u6216 sorting\u9636\u6bb5\uff09\u6216\u8005\u6574\u4e2aSQL\u8bed\u53e5\u4e0eSQL\u8bed\u53e5\u96c6\u5408\u3002\u4e8b\u4ef6\u7684\u91c7\u96c6\u53ef\u4ee5\u65b9\u4fbf\u7684\u63d0\u4f9bserver\u4e2d\u7684\u76f8\u5173\u5b58\u50a8\u5f15\u64ce\u5bf9\u78c1\u76d8\u6587\u4ef6\u3001\u8868I/O\u3001\u8868\u9501\u7b49\u8d44\u6e90\u7684\u540c\u6b65\u8c03\u7528\u4fe1\u606f\u3002 </p> </li> <li> <p>performance_schema\u4e2d\u7684\u4e8b\u4ef6\u4e0e\u5199\u5165\u4e8c\u8fdb\u5236\u65e5\u5fd7\u4e2d\u7684\u4e8b\u4ef6\uff08\u63cf\u8ff0\u6570\u636e\u4fee\u6539\u7684events\uff09\u3001\u4e8b\u4ef6\u8ba1\u5212\u8c03\u5ea6\u7a0b\u5e8f\uff08\u8fd9\u662f\u4e00\u79cd\u5b58\u50a8\u7a0b\u5e8f\uff09\u7684\u4e8b\u4ef6\u4e0d\u540c\u3002performance_schema\u4e2d\u7684\u4e8b\u4ef6\u8bb0\u5f55\u7684\u662fserver\u6267\u884c\u67d0\u4e9b\u6d3b\u52a8\u5bf9\u67d0\u4e9b\u8d44\u6e90\u7684\u6d88\u8017\u3001\u8017\u65f6\u3001\u8fd9\u4e9b\u6d3b\u52a8\u6267\u884c\u7684\u6b21\u6570\u7b49\u60c5\u51b5\u3002  </p> </li> <li> <p>performance_schema\u4e2d\u7684\u4e8b\u4ef6\u53ea\u8bb0\u5f55\u5728\u672c\u5730server\u7684performance_schema\u4e2d\uff0c\u5176\u4e0b\u7684\u8fd9\u4e9b\u8868\u4e2d\u6570\u636e\u53d1\u751f\u53d8\u5316\u65f6\u4e0d\u4f1a\u88ab\u5199\u5165binlog\u4e2d\uff0c\u4e5f\u4e0d\u4f1a\u901a\u8fc7\u590d\u5236\u673a\u5236\u88ab\u590d\u5236\u5230\u5176\u4ed6server\u4e2d\u3002 </p> </li> <li> <p>\u5f53\u524d\u6d3b\u8dc3\u4e8b\u4ef6\u3001\u5386\u53f2\u4e8b\u4ef6\u548c\u4e8b\u4ef6\u6458\u8981\u76f8\u5173\u7684\u8868\u4e2d\u8bb0\u5f55\u7684\u4fe1\u606f\u3002\u80fd\u63d0\u4f9b\u67d0\u4e2a\u4e8b\u4ef6\u7684\u6267\u884c\u6b21\u6570\u3001\u4f7f\u7528\u65f6\u957f\u3002\u8fdb\u800c\u53ef\u7528\u4e8e\u5206\u6790\u67d0\u4e2a\u7279\u5b9a\u7ebf\u7a0b\u3001\u7279\u5b9a\u5bf9\u8c61\uff08\u5982mutex\u6216file\uff09\u76f8\u5173\u8054\u7684\u6d3b\u52a8\u3002 </p> </li> <li> <p>PERFORMANCE_SCHEMA\u5b58\u50a8\u5f15\u64ce\u4f7f\u7528server\u6e90\u4ee3\u7801\u4e2d\u7684\u201c\u68c0\u6d4b\u70b9\u201d\u6765\u5b9e\u73b0\u4e8b\u4ef6\u6570\u636e\u7684\u6536\u96c6\u3002\u5bf9\u4e8eperformance_schema\u5b9e\u73b0\u673a\u5236\u672c\u8eab\u7684\u4ee3\u7801\u6ca1\u6709\u76f8\u5173\u7684\u5355\u72ec\u7ebf\u7a0b\u6765\u68c0\u6d4b\uff0c\u8fd9\u4e0e\u5176\u4ed6\u529f\u80fd\uff08\u5982\u590d\u5236\u6216\u4e8b\u4ef6\u8ba1\u5212\u7a0b\u5e8f\uff09\u4e0d\u540c </p> </li> <li> <p>\u6536\u96c6\u7684\u4e8b\u4ef6\u6570\u636e\u5b58\u50a8\u5728performance_schema\u6570\u636e\u5e93\u7684\u8868\u4e2d\u3002\u8fd9\u4e9b\u8868\u53ef\u4ee5\u4f7f\u7528SELECT\u8bed\u53e5\u67e5\u8be2\uff0c\u4e5f\u53ef\u4ee5\u4f7f\u7528SQL\u8bed\u53e5\u66f4\u65b0performance_schema\u6570\u636e\u5e93\u4e2d\u7684\u8868\u8bb0\u5f55\uff08\u5982\u52a8\u6001\u4fee\u6539performance_schema\u7684setup_*\u5f00\u5934\u7684\u51e0\u4e2a\u914d\u7f6e\u8868\uff0c\u4f46\u8981\u6ce8\u610f\uff1a\u914d\u7f6e\u8868\u7684\u66f4\u6539\u4f1a\u7acb\u5373\u751f\u6548\uff0c\u8fd9\u4f1a\u5f71\u54cd\u6570\u636e\u6536\u96c6\uff09  </p> </li> <li> <p>performance_schema\u7684\u8868\u4e2d\u7684\u6570\u636e\u4e0d\u4f1a\u6301\u4e45\u5316\u5b58\u50a8\u5728\u78c1\u76d8\u4e2d\uff0c\u800c\u662f\u4fdd\u5b58\u5728\u5185\u5b58\u4e2d\uff0c\u4e00\u65e6\u670d\u52a1\u5668\u91cd\u542f\uff0c\u8fd9\u4e9b\u6570\u636e\u4f1a\u4e22\u5931\uff08\u5305\u62ec\u914d\u7f6e\u8868\u5728\u5185\u7684\u6574\u4e2aperformance_schema\u4e0b\u7684\u6240\u6709\u6570\u636e\uff09 </p> </li> <li> <p>MySQL\u652f\u6301\u7684\u6240\u6709\u5e73\u53f0\u4e2d\u4e8b\u4ef6\u76d1\u63a7\u529f\u80fd\u90fd\u53ef\u7528\uff0c\u4f46\u4e0d\u540c\u5e73\u53f0\u4e2d\u7528\u4e8e\u7edf\u8ba1\u4e8b\u4ef6\u65f6\u95f4\u5f00\u9500\u7684\u8ba1\u65f6\u5668\u7c7b\u578b\u53ef\u80fd\u4f1a\u6709\u6240\u5dee\u5f02\u3002 </p> </li> </ol> <p>performance_schema\u5b9e\u73b0\u673a\u5236\u9075\u5faa\u4ee5\u4e0b\u8bbe\u8ba1\u76ee\u6807\uff1a </p> <ol> <li> <p>\u542f\u7528performance_schema\u4e0d\u4f1a\u5bfc\u81f4server\u7684\u884c\u4e3a\u53d1\u751f\u53d8\u5316\u3002\u4f8b\u5982\uff0c\u5b83\u4e0d\u4f1a\u6539\u53d8\u7ebf\u7a0b\u8c03\u5ea6\u673a\u5236\uff0c\u4e0d\u4f1a\u5bfc\u81f4\u67e5\u8be2\u6267\u884c\u8ba1\u5212\uff08\u5982EXPLAIN\uff09\u53d1\u751f\u53d8\u5316 </p> </li> <li> <p>\u542f\u7528performance_schema\u4e4b\u540e\uff0cserver\u4f1a\u6301\u7eed\u4e0d\u95f4\u65ad\u5730\u76d1\u6d4b\uff0c\u5f00\u9500\u5f88\u5c0f\u3002\u4e0d\u4f1a\u5bfc\u81f4server\u4e0d\u53ef\u7528 </p> </li> <li> <p>\u5728\u8be5\u5b9e\u73b0\u673a\u5236\u4e2d\u6ca1\u6709\u589e\u52a0\u65b0\u7684\u5173\u952e\u5b57\u6216\u8bed\u53e5\uff0c\u89e3\u6790\u5668\u4e0d\u4f1a\u53d8\u5316  </p> </li> <li> <p>\u5373\u4f7fperformance_schema\u7684\u76d1\u6d4b\u673a\u5236\u5728\u5185\u90e8\u5bf9\u67d0\u4e8b\u4ef6\u6267\u884c\u76d1\u6d4b\u5931\u8d25\uff0c\u4e5f\u4e0d\u4f1a\u5f71\u54cdserver\u6b63\u5e38\u8fd0\u884c </p> </li> <li> <p>\u5982\u679c\u5728\u5f00\u59cb\u6536\u96c6\u4e8b\u4ef6\u6570\u636e\u65f6\u78b0\u5230\u6709\u5176\u4ed6\u7ebf\u7a0b\u6b63\u5728\u9488\u5bf9\u8fd9\u4e9b\u4e8b\u4ef6\u4fe1\u606f\u8fdb\u884c\u67e5\u8be2\uff0c\u90a3\u4e48\u67e5\u8be2\u4f1a\u4f18\u5148\u6267\u884c\u4e8b\u4ef6\u6570\u636e\u7684\u6536\u96c6\uff0c\u56e0\u4e3a\u4e8b\u4ef6\u6570\u636e\u7684\u6536\u96c6\u662f\u4e00\u4e2a\u6301\u7eed\u4e0d\u65ad\u7684\u8fc7\u7a0b\uff0c\u800c\u68c0\u7d22(\u67e5\u8be2)\u8fd9\u4e9b\u4e8b\u4ef6\u6570\u636e\u4ec5\u4ec5\u53ea\u662f\u5728\u9700\u8981\u67e5\u770b\u7684\u65f6\u5019\u624d\u8fdb\u884c\u68c0\u7d22\u3002\u4e5f\u53ef\u80fd\u67d0\u4e9b\u4e8b\u4ef6\u6570\u636e\u6c38\u8fdc\u90fd\u4e0d\u4f1a\u53bb\u68c0\u7d22 </p> </li> <li> <p>\u9700\u8981\u5f88\u5bb9\u6613\u5730\u6dfb\u52a0\u65b0\u7684instruments\u76d1\u6d4b\u70b9  instruments(\u4e8b\u4ef6\u91c7\u96c6\u9879)\u4ee3\u7801\u7248\u672c\u5316\uff1a\u5982\u679cinstruments\u7684\u4ee3\u7801\u53d1\u751f\u4e86\u53d8\u66f4\uff0c\u65e7\u7684instruments\u4ee3\u7801\u8fd8\u53ef\u4ee5\u7ee7\u7eed\u5de5\u4f5c\u3002  \u6ce8\u610f\uff1aMySQL sys schema\u662f\u4e00\u7ec4\u5bf9\u8c61\uff08\u5305\u62ec\u76f8\u5173\u7684\u89c6\u56fe\u3001\u5b58\u50a8\u8fc7\u7a0b\u548c\u51fd\u6570\uff09\uff0c\u53ef\u4ee5\u65b9\u4fbf\u5730\u8bbf\u95eeperformance_schema\u6536\u96c6\u7684\u6570\u636e\u3002\u540c\u65f6\u68c0\u7d22\u7684\u6570\u636e\u53ef\u8bfb\u6027\u4e5f\u66f4\u9ad8(\u4f8b\u5982\uff1aperformance_schema\u4e2d\u7684\u65f6\u95f4\u5355\u4f4d\u662f\u76ae\u79d2\uff0c\u7ecf\u8fc7sys schema\u67e5\u8be2\u65f6\u4f1a\u8f6c\u6362\u4e3a\u53ef\u8bfb\u7684us,ms,s,min,hour,day\u7b49\u5355\u4f4d)\uff0csys schem\u57285.7.x\u7248\u672c\u9ed8\u8ba4\u5b89\u88c5</p> </li> </ol>"},{"location":"optimize/many_tables/","title":"MySQL\u662f\u5982\u4f55\u6253\u5f00\u8868\uff1f","text":""},{"location":"optimize/many_tables/#_1","title":"\u80cc\u666f","text":"<p>MySQL\u662f\u591a\u7ebf\u7a0b\u7684\uff0c\u53ef\u80fd\u5728\u540c\u4e00\u65f6\u523b\u6709\u5f88\u591a\u7684\u5ba2\u6237\u7aef\u8bbf\u95ee\u67d0\u5f20\u7279\u5b9a\u7684\u8868\u3002\u4e3a\u4e86\u80fd\u6700\u5c0f\u5316\u591a\u4e2a\u5ba2\u6237\u7aef\u5728\u76f8\u540c\u8868\u4e0a\u7684\u4e0d\u540c\u72b6\u6001\u95ee\u9898\uff0c\u5e76\u53d1\u4f1a\u8bdd\u4e2d\u8bbf\u95ee\u7684\u6bcf\u5f20\u8868\u90fd\u4f1a\u5355\u72ec\u6253\u5f00\u3002\u867d\u7136\u8fd9\u53ef\u80fd\u6d88\u8017\u8fc7\u591a\u7684\u5185\u5b58\uff0c\u4f46\u662f\u901a\u5e38\u4f1a\u63d0\u9ad8\u7cfb\u7edf\u7684\u6027\u80fd\u3002</p> <p>\u6211\u4eec\u77e5\u9053MySQL\u662f\u4e00\u4e2a\u652f\u6301\u591a\u7ebf\u7a0b\u7684\u6570\u636e\u5e93\uff0c\u5c24\u5176\u5728innodb\u5b58\u50a8\u5f15\u64ce\u51fa\u73b0\u540e\uff0c\u5bf9MySQL\u7684\u4e8b\u52a1\uff0c\u5e76\u53d1\uff0c\u9501\u652f\u6301\u5f97\u5230\u4e86\u6781\u5927\u63d0\u9ad8\u3002</p> <p>\u5728\u9ad8\u5e76\u53d1\u7684\u8bbf\u95ee\u7684\u5e94\u7528\u573a\u666f\u4e2d\uff0c\u5e94\u7528\u7aef\u5927\u91cf\u5e76\u53d1\u7684\u8fdb\u7a0b\u53d1\u95ee\u6570\u636e\u5e93\uff0c\u800c\u6570\u636e\u5e93\u4e2d\u7684\u6570\u636e\u8868\u5728\u78c1\u76d8\u4e0a\u4ee5\u6570\u636e\u6587\u4ef6\u5b58\u653e\uff0c\u5728Unix/Linux\u7684\u7cfb\u7edf\u8c03\u7528\u4e2d\uff0c\u662f\u4f9d\u8d56\u4e8e\u6587\u4ef6\u63cf\u8ff0\u7b26\u7684\u3002</p> <p>\u4e0d\u540c\u7684OS\u5bf9\u6587\u4ef6\u63cf\u8ff0\u7b26\u7684\u9650\u5236\u4e0d\u540c\uff08\u975eUnix/Linux\u64cd\u4f5c\u7cfb\u7edf\u65e0\u6587\u4ef6\u63cf\u8ff0\u7b26\u6982\u5ff5\uff0c\u5728Windows\u4e2d\u79f0\u4f5c\u6587\u4ef6\u53e5\u67c4\uff09\uff0c\u5982\u5728Linux\u4e2d<code>/etc/security/limits.conf</code>\u914d\u7f6e\u6587\u4ef6\u4e2d\u8bbe\u7f6e\u4ed6\u4eec\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26\u6781\u9650\u3002</p>"},{"location":"optimize/many_tables/#_2","title":"\u6570\u636e\u5b57\u5178","text":"<p>\u6570\u636e\u5b57\u5178\u662f\u6570\u636e\u5e93\u91cd\u8981\u7684\u7ec4\u6210\u90e8\u5206\u4e4b\u4e00\uff0c\u90a3\u4e48\u4ec0\u4e48\u662f\u6570\u636e\u5b57\u5178\uff1f\u6570\u636e\u5b57\u5178\u5305\u542b\u54ea\u4e9b\u5185\u5bb9\u5462\uff1f\u6570\u636e\u5b57\u5178\u662f\u5bf9\u6570\u636e\u5e93\u4e2d\u7684\u6570\u636e\u3001\u5e93\u5bf9\u8c61\u3001\u8868\u5bf9\u8c61\u7b49\u7684\u5143\u4fe1\u606f\u7684\u96c6\u5408\u3002</p> <p>\u5728MySQL\u4e2d\uff0c\u6570\u636e\u5b57\u5178\u4fe1\u606f\u5185\u5bb9\u5c31\u5305\u62ec\u8868\u7ed3\u6784\u3001\u6570\u636e\u5e93\u540d\u6216\u8868\u540d\u3001\u5b57\u6bb5\u7684\u6570\u636e\u7c7b\u578b\u3001\u89c6\u56fe\u3001\u7d22\u5f15\u3001\u8868\u5b57\u6bb5\u4fe1\u606f\u3001\u5b58\u50a8\u8fc7\u7a0b\u3001\u89e6\u53d1\u5668\u7b49\u5185\u5bb9\u3002</p> <p><code>MySQL.INFORMATION_SCHEMA</code>\u5e93\u63d0\u4f9b\u4e86\u5bf9\u6570\u636e\u5c40\u5143\u6570\u636e\u3001\u7edf\u8ba1\u4fe1\u606f\u3001\u4ee5\u53ca\u6709\u5173<code>MySQL server</code>\u7684\u8bbf\u95ee\u4fe1\u606f\uff08\u4f8b\u5982\uff1a\u6570\u636e\u5e93\u540d\u6216\u8868\u540d\uff0c\u5b57\u6bb5\u7684\u6570\u636e\u7c7b\u578b\u548c\u8bbf\u95ee\u6743\u9650\u7b49\uff09\u3002</p> <p>\u8be5\u5e93\u4e2d\u4fdd\u5b58\u7684\u4fe1\u606f\u4e5f\u53ef\u4ee5\u79f0\u4e3aMySQL\u7684\u6570\u636e\u5b57\u5178\u3002</p> <p>\u5728MySQL8.0\u4e4b\u524d\uff0cMySQL\u7684\u6570\u636e\u5b57\u5178\u4fe1\u606f\u5e76\u6ca1\u6709\u5168\u90e8\u5b58\u653e\u5728\u7cfb\u7edf\u6570\u636e\u5e93\u8868\u4e2d\uff0c\u90e8\u5206\u5b57\u5178\u4fe1\u606f\u5b58\u653e\u4e8e\u6587\u4ef6\u4e2d\uff0c\u5176\u4f59\u7684\u6570\u636e\u5b57\u5178\u4fe1\u606f\u5b58\u653e\u4e8e\u6570\u636e\u5b57\u5178<code>INFORMATION_SCHEMA</code>,<code>MySQL</code>,<code>SYS</code></p> <p>\u5728MySQL8.0\u4e4b\u524d\uff0c\u5982\u679c\u6211\u4eec\u4f7f\u7528\u4e86\u9ed8\u8ba4\u7684\u5b58\u50a8\u5f15\u64ceinnodb\u521b\u5efa\u4e00\u5f20\u8868\uff0c\u90a3\u4e48\u5728\u6587\u4ef6\u5939\u4e0b\u9762\u5c31\u4f1a\u51fa\u73b0\u8868\u540d.frm\u548c\u8868\u540d.ibd\u4e24\u4e2a\u6587\u4ef6\uff0c\u5982\u679c\u6211\u4eec\u4f7f\u7528\u7684\u662fMyisam\u5b58\u50a8\u5f15\u64ce\uff0c\u90a3\u4e48\u5c31\u4f1a\u51fa\u73b0\u4e09\u4e2a\u6587\u4ef6\u3002\u5176\u4e2dibd\u6587\u4ef6\u662finnodb\u7684\u8868\u6570\u636e\u6587\u4ef6\uff0c\u800cfrm\u6587\u4ef6\u662finnodb\u7684\u8868\u7ed3\u6784\u6587\u4ef6\uff0cmysiam\u5b58\u50a8\u5f15\u64ce\u7684\u8868\u4e2d\uff0cfrm\u662f\u8868\u7ed3\u6784\uff0cMYI\u6587\u4ef6\u662f\u7d22\u5f15\u6587\u4ef6\uff0c\u800cMYD\u6587\u4ef6\u662f\u6570\u636e\u6587\u4ef6\uff0c\u4ece\u8fd9\u91cc\u4e5f\u53ef\u4ee5\u770b\u51fa\uff0cinnodb\u5b58\u50a8\u5f15\u64ce\u7684\u7d22\u5f15\u548c\u6570\u636e\u662f\u5728\u4e00\u8d77\u7684\uff0c\u800cMyisam\u5b58\u50a8\u5f15\u64ce\u7d22\u5f15\u548c\u6570\u636e\u662f\u5206\u5f00\u7684\u3002 \u6ce8\u610f\uff1a\u8fd9\u4e2afrm\u6587\u4ef6\u548cibd\u6587\u4ef6\u4e0d\u662f\u6587\u672c\u6587\u4ef6\uff0c\u90fd\u662f\u4e0d\u80fd\u76f4\u63a5\u7528\u7f16\u8f91\u5668\u6253\u5f00\u7684\u3002 \u5728\u65e9\u671f5.6\u7248\u672c\u4e4b\u524d\uff0cMyISAM\u662fMySQL\u7684\u9ed8\u8ba4\u5b58\u50a8\u5f15\u64ce\uff0c\u800c\u4f5c\u4e3aMyISAM\u5b58\u50a8\u5f15\u64ce\uff0c\u5b83\u662f\u6ca1\u6709\u6570\u636e\u5b57\u5178\u7684\u3002\u53ea\u6709\u8868\u7ed3\u6784\u4fe1\u606f\u8bb0\u5f55\u5728.frm\u6587\u4ef6\u4e2d\u3002MySQL5.6\u7248\u672c\u4e4b\u540e\uff0c\u5c06InnoDB\u5b58\u50a8\u5f15\u64ce\u4f5c\u4e3a\u9ed8\u8ba4\u7684\u5b58\u50a8\u5f15\u64ce\u3002\u5728InnoDB\u5b58\u50a8\u5f15\u64ce\u4e2d\uff0c\u6dfb\u52a0\u4e86\u4e00\u4e9b\u6570\u636e\u5b57\u5178\u6587\u4ef6\u7528\u4e8e\u5b58\u653e\u6570\u636e\u5b57\u5178\u5143\u4fe1\u606f\uff0c\u4f8b\u5982\uff1a.opt\u6587\u4ef6\uff0c\u8bb0\u5f55\u4e86\u6bcf\u4e2a\u5e93\u7684\u4e00\u4e9b\u57fa\u672c\u4fe1\u606f\uff0c\u5305\u62ec\u5e93\u7684\u5b57\u7b26\u96c6\u7b49\u4fe1\u606f\uff0c.TRN\uff0c.TRG\u6587\u4ef6\u7528\u4e8e\u5b58\u653e\u89e6\u53d1\u5668\u7684\u4fe1\u606f\u5185\u5bb9\u3002</p> <p>\u6700\u65b0\u7684MySQL 8.0 \u53d1\u5e03\u4e4b\u540e\uff0c\u5bf9\u6570\u636e\u5e93\u6570\u636e\u5b57\u5178\u65b9\u9762\u505a\u4e86\u8f83\u5927\u7684\u6539\u8fdb\u3002</p> <ul> <li> <p>\u9996\u5148\u662f\uff0c\u5c06\u6240\u6709\u539f\u5148\u5b58\u653e\u4e8e\u6570\u636e\u5b57\u5178\u6587\u4ef6\u4e2d\u7684\u4fe1\u606f\uff0c\u5168\u90e8\u5b58\u653e\u5230\u6570\u636e\u5e93\u7cfb\u7edf\u8868\u4e2d\uff0c\u5373\u5c06\u4e4b\u524d\u7248\u672c\u7684.frm,.opt,.par,.TRN,.TRG,.isl\u6587\u4ef6\u90fd\u79fb\u9664\u4e86\uff0c\u4e0d\u518d\u901a\u8fc7\u6587\u4ef6\u7684\u65b9\u5f0f\u5b58\u50a8\u6570\u636e\u5b57\u5178\u4fe1\u606f\u3002</p> </li> <li> <p>\u5176\u6b21\u662f\u5bf9<code>INFORMATION_SCHEMA</code>,<code>MySQL</code>,<code>SYS</code>\u7cfb\u7edf\u5e93\u4e2d\u7684\u5b58\u50a8\u5f15\u64ce\u505a\u4e86\u6539\u8fdb\uff0c\u539f\u5148\u4f7f\u7528<code>MyISAM</code>\u5b58\u50a8\u5f15\u64ce\u7684\u6570\u636e\u5b57\u5178\u8868\u90fd\u6539\u4e3a\u4f7f\u7528<code>InnoDB</code>\u5b58\u50a8\u5f15\u64ce\u5b58\u653e\u3002\u4ece\u4e0d\u652f\u6301\u4e8b\u52a1\u7684<code>MyISAM</code>\u5b58\u50a8\u5f15\u64ce\u8f6c\u53d8\u5230\u652f\u6301\u4e8b\u52a1\u7684<code>InnoDB</code>\u5b58\u50a8\u5f15\u64ce\uff0c\u4e3a\u539f\u5b50DDL\u7684\u5b9e\u73b0\uff0c\u63d0\u4f9b\u4e86\u53ef\u80fd\u6027\u3002</p> </li> </ul> <p>https://opensource.actionsky.com/20200709-mysql/</p>"},{"location":"optimize/many_tables/#_3","title":"\u6587\u4ef6\u63cf\u8ff0\u7b26","text":"<p>\u56de\u5230\u4e3b\u9898\uff0cMySQL\u662f\u5982\u4f55\u6253\u5f00\u4e00\u4e2a\u8868\u7684\uff0cInnoDB\u5f15\u64ce\u7684\u8868\u90fd\u662f\u4ee5\u6587\u4ef6\u7684\u5f62\u5f0f\u5b58\u5728\u78c1\u76d8\u4e2d\uff0cMySQL Server\u8981\u64cd\u4f5c\u4e00\u4e2a\u8868\uff08\u589e\u5220\u6539\u67e5\u7b49\uff09\uff0c\u90fd\u8981\u5229\u7528\u64cd\u4f5c\u7cfb\u7edf\u63d0\u4f9b\u7684\u6587\u4ef6IO\u63a5\u53e3\uff0c\u6765\u64cd\u4f5c\u6587\u4ef6\u3002</p> <p>\u5728 <code>Linux</code> \u4e2d\uff0c\u6587\u4ef6IO\u662f\u901a\u8fc7\u6587\u4ef6\u63cf\u8ff0\u7b26\u6765\u8bbf\u95ee\u7684\u3002\u5982\u679c\u9891\u7e41\u7684\u6587\u4ef6IO\uff0c\u7533\u8bf7\u548c\u5173\u95ed\u6587\u4ef6\u63cf\u8ff0\u7b26\uff0c\u4e5f\u662f\u6709\u4e00\u5b9a\u5f00\u9500\u7684\u3002</p> <p>table cache\u7684\u4e3b\u8981\u4f5c\u7528\u5c31\u662f\u7f13\u5b58\u6587\u4ef6\u63cf\u8ff0\u7b26\uff0c\u5f53\u6709\u65b0\u7684\u8bf7\u6c42\u65f6\u4e0d\u9700\u8981\u91cd\u65b0\u6253\u5f00\uff0c\u4f7f\u7528\u7ed3\u675f\u65f6\u4e5f\u4e0d\u7528\u7acb\u5373\u5173\u95ed\u3002</p> <p>MySQL\u662f\u4e00\u4e2a\u591a\u7ebf\u7a0b\u670d\u52a1\uff0c\u6240\u4ee5\u53ef\u80fd\u5b58\u5728\u591a\u4e2a\u7ebf\u7a0b\u540c\u65f6\u8bbf\u95ee\u4e00\u5f20\u8868\u7684\u60c5\u51b5\u3002\u4e3a\u4e86\u51cf\u5c11\u591a\u4e2a\u5e76\u53d1\u4f1a\u8bdd\u5bf9\u540c\u65f6\u4e00\u4e2a\u8868\u6709\u4e0d\u540c\u72b6\u6001\u7684\u95ee\u9898\uff0c\u8868\u88ab\u6bcf\u4e2a\u5e76\u53d1\u4f1a\u8bdd\u5355\u72ec\u6253\u5f00\u3002\u6bcf\u4e2a\u4f1a\u8bdd\u64cd\u4f5c\u4e00\u4e2a</p> <p>\u5f53\u6211\u4eec\u7684\u6570\u636e\u5e93\u4e2d\u4e0a\u5343\u6570\u91cf\u7684\u8868\u7684\u65f6\u5019\uff0c\u67e5\u8be2\u4e2d\u6709\u6d89\u53ca\u590d\u6742\u7684\u591a\u8868\u8fde\u63a5\uff0c\u5e76\u4e14\u540c\u65f6\u6709\u591a\u4e2a<code>connection</code>\u9ad8\u5e76\u53d1\u8fde\u5230<code>MySQL</code>\u4e2d\u6267\u884c\u8fd9\u4e9bquery\uff0c\u90a3\u4e48\u5c31\u53ef\u80fd\u5f88\u5feb\u7528\u5b8c\u6587\u4ef6\u63cf\u8ff0\u7b26cache<code>table_open_cache</code>\uff0c<code>MySQL</code>\u4f7f\u7528<code>LRU</code>\u7b97\u6cd5\uff0c\u628a\u6700\u8fd1\u6700\u5c11\u4f7f\u7528\u7684\u63cf\u8ff0\u7b26\u5173\u95ed\u6389\uff0c\u7528\u4e8e\u5b58\u653e\u65b0\u7684\u63cf\u8ff0\u7b26\u3002</p> <p>\u4f46\u662f\u5728\u67e5\u627e\u8981\u5173\u95ed\u7684\u63cf\u8ff0\u7b26\u4e2d\uff0c\u67e5\u627e\u65f6\u95f4\u4f1a\u968f\u7740cache\u4e2d\u7684\u7f13\u5b58\u6570\u91cf\u589e\u52a0\u800c\u589e\u52a0\uff08O(n),n\u4e3acache\u7684items\u6570\u91cf\uff09\uff0c\u6587\u4ef6\u6253\u5f00\u7684\u65f6\u95f4\u7b49\u4e8e\u6587\u4ef6\u5173\u95ed\u7684\u65f6\u95f4\uff0c\u4ece\u800c\u5bfc\u81f4\u4e86\u6027\u80fd\u4e0a\u7684\u4e0b\u964d\u3002</p> <ul> <li> <p>\u53c2\u6570<code>table_open_cache</code>\u5b9a\u4e49\u4e86MySQL\u7f13\u5b58\u4e2d\u53ef\u4ee5\u5b58\u653e\u7684\u8868\u63cf\u8ff0\u7b26\u7684\u6700\u5927\u6570\u91cf\u3002\u9ed8\u8ba4\u503c\u662f4000</p> </li> <li> <p>\u53c2\u6570<code>table_open_cache_instances</code>\u5b58\u50a8\u4e86\u8868\u7f13\u5b58\u5b9e\u4f8b\u7684\u6570\u91cf\u3002\u9ed8\u8ba4\u503c\u662f16\u3002\u5b83\u5c06table_open_cache\u5206\u6210\u591a\u4e2a\u5b9e\u4f8b\uff0c\u4ece\u800c\u51cf\u5c11\u4f1a\u8bdd\u4e4b\u95f4\u7684\u7ade\u4e89\u3002 </p> </li> </ul> <p>MySQL\u4f1a\u521b\u5efa16\u4e2a\u72ec\u7acb\u7684\u5185\u5b58<code>buffer instance</code>\uff0c\u5176\u4e2d\u6bcf\u4e2a<code>instance</code>\u53ef\u4ee5\u5b58\u653e4000/16=250\u4e2a\u8868\u63cf\u8ff0\u7b26\u3002\u8fd9\u4e9b\u8868\u7f13\u5b58<code>instance</code>\u53ef\u4ee5\u88ab\u5e76\u53d1\u8bbf\u95ee\uff0c\u8fd9\u6837<code>DML</code>\u5728\u4f7f\u7528\u8868\u63cf\u8ff0\u7b26\u7684\u65f6\u5019\u4e0d\u4f1a\u4e92\u76f8\u963b\u585e\u3002</p> <p>\u7f13\u5b58\u8bbf\u95ee\u5728\u5b9e\u4f8b\u4e4b\u95f4\u88ab\u5206\u5272\u5f00\u6765\uff0c\u5f53\u6709\u8bb8\u591a\u4f1a\u8bdd\u8bbf\u95ee\u8868\u65f6\uff0c\u4f7f\u7528\u7f13\u5b58\u7684\u64cd\u4f5c\u53ef\u4ee5\u83b7\u5f97\u66f4\u9ad8\u7684\u6027\u80fd\u3002(DDL \u8bed\u53e5\u4ecd\u7136\u9700\u8981\u5bf9\u6574\u4e2a\u7f13\u5b58\u52a0\u9501\uff0c\u4f46\u8fd9\u79cd\u8bed\u53e5\u6bd4 DML \u8bed\u53e5\u8981\u5c11\u5f97\u591a\uff09\u3002</p> <p>\u5bf9\u4e8e\u7ecf\u5e38\u4f7f\u7528 16 \u4e2a\u6216\u66f4\u591a\u5185\u6838\u7684\u7cfb\u7edf\uff0c\u5efa\u8bae\u4f7f\u7528 8 \u6216 16 \u7684\u503c\u3002</p> <p>\u4f46\u662f\u5982\u679c\u8868\u4e2d\u6709\u8bb8\u591a\u5927\u578b\u89e6\u53d1\u5668\uff0c\u5bfc\u81f4\u5185\u5b58\u8d1f\u8377\u8fc7\u9ad8\uff0c\u90a3\u4e48 <code>table_open_cache_instances</code> \u7684\u9ed8\u8ba4\u8bbe\u7f6e\u53ef\u80fd\u4f1a\u5bfc\u81f4\u5185\u5b58\u4f7f\u7528\u8fc7\u591a\u3002</p> <p>\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u5c06 <code>table_open_cache_instances</code> \u8bbe\u7f6e\u4e3a 1 \u53ef\u80fd\u4f1a\u5bf9\u9650\u5236\u5185\u5b58\u4f7f\u7528\u6709\u6240\u5e2e\u52a9\u3002\u53c2\u8003</p> <pre><code>--\u5173\u95ed\u6240\u6709\u6253\u5f00\u7684\u8868\nFLUSH TABLES;\n\n\n--\u5173\u95ed\u6240\u6709\u6253\u5f00\u7684\u8868\uff0c\u5e76\u4f7f\u7528\u5168\u5c40\u8bfb\u9501\u9501\u5b9a\u6240\u6709\u6570\u636e\u5e93\u7684\u6240\u6709\u8868\u3002\n--\u6267\u884c\u540e\uff0c\u6574\u4e2a\u5b9e\u4f8b\u5168\u5c40\u53ea\u8bfb\u3002\u5168\u5c40\u8bfb\u9501(lock_global_read_lock) \u4f1a\u5bfc\u81f4\u6240\u6709\u7684\u66f4\u65b0\u64cd\u4f5c\u88ab\u5835\u585e\nFLUSH TABLES WITH READ LOCK;\n\n\n--\u5173\u95ed\u591a\u4e2a\u6253\u5f00\u7684\u8868\nFLUSH TABLES tbl_name [, tbl_name] ...\n</code></pre>"},{"location":"oracle/01.Oracle%E6%A6%82%E8%BF%B0/","title":"\u6954\u5b50","text":"<p>Oracle \u6570\u636e\u5e93(Oracle database,\u7b80\u79f0 Oracle) \u53c8\u540dOracle RDBMS\u662f\u7532\u9aa8\u6587\u516c\u53f8\u7684\u4e00\u6b3e\u5173\u7cfb\u6570\u636e\u7ba1\u7406\u7cfb\u7edf\uff0c\u4e5f\u662f\u4e16\u754c\u4e0a\u4f7f\u7528\u6700\u5e7f\u6cdb\u7684\u5173\u7cfb\u6570\u636e\u5e93\u7ba1\u7406\u7cfb\u7edf\uff0c\u5360\u636e\u7740\u5168\u7403\u6570\u636e\u5e93\u4efd\u989d\u768448%\u5de6\u53f3\uff0c\u5728\u4e2d\u56fd\u4f7f\u7528\u66f4\u662f\u5360\u636e\u523057%\u7684\u4efd\u989d\uff0c\u5168\u7403\u4e94\u767e\u5f3a\u4f01\u4e1a\u4e2d90%\u90fd\u5728\u4f7f\u7528Oracle\uff0c\u4e2d\u56fd\u524d100\u5927\u4f01\u4e1a\u4e5f\u6709\u8fd199\u4e2a\u90fd\u5728\u4f7f\u7528Oracle\u3002</p> <p>Oracle \u6570\u636e\u5e93\u4ea7\u54c1\u4e3a\u5ba2\u6237\u63d0\u4f9b\u6210\u672c\u4f18\u5316\u7684\u9ad8\u6027\u80fd\u7248 Oracle \u6570\u636e\u5e93\u3001\u5168\u7403\u9886\u5148\u7684\u878d\u5408\u591a\u6a21\u578b\u6570\u636e\u5e93\u7ba1\u7406\u7cfb\u7edf\u4ee5\u53ca In-memory\u3001NoSQL \u548c MySQL \u6570\u636e\u5e93\u3002\u5ba2\u6237\u53ef\u4ee5\u5728\u672c\u5730\u90e8\u7f72\u73af\u5883\u4e2d\u901a\u8fc7 Oracle \u516c\u6709\u4e91\u672c\u5730\u5316\u89e3\u51b3\u65b9\u6848\u4f7f\u7528 Oracle \u81ea\u6cbb\u6570\u636e\u5e93\uff0c\u4e5f\u53ef\u4ee5\u5728 Oracle \u4e91\u57fa\u7840\u8bbe\u65bd\u4e2d\u4f7f\u7528 Oracle \u81ea\u6cbb\u6570\u636e\u5e93\uff0c\u4ece\u800c\u7b80\u5316\u5173\u7cfb\u6570\u636e\u5e93\u73af\u5883\u5e76\u51cf\u5c11\u7ba1\u7406\u5de5\u4f5c\u91cf\u3002</p> <p>Oracle \u6570\u636e\u5e93\u5b83\u662f\u5728\u5173\u7cfb\u578b\u6570\u636e\u5e93\u9886\u57df\u4e2d\u4e00\u76f4\u5904\u4e8e\u9886\u5148\u5730\u4f4d\u7684\u4ea7\u54c1\uff0c\u5b83\u53ef\u5728\u672c\u5730\u73af\u5883\u548c\u4e91\u7aef\u63d0\u4f9b\u5e02\u573a\u9886\u5148\u7684\u6027\u80fd\u3001\u53ef\u6269\u5c55\u6027\u3001\u53ef\u9760\u6027\u548c\u5b89\u5168\u6027,\u53ef\u4ee5\u8bf4Oracle\u6570\u636e\u5e93\u7cfb\u7edf\u662f\u76ee\u524d\u4e16\u754c\u4e0a\u6d41\u884c\u7684\u5173\u7cfb\u6570\u636e\u5e93\u7ba1\u7406\u7cfb\u7edf\u3002</p> <p>Oracle \u6570\u636e\u5e93\u7cfb\u7edf\u53ef\u79fb\u690d\u6027\u597d\u3001\u4f7f\u7528\u65b9\u4fbf\u3001\u529f\u80fd\u5f3a,\u9002\u7528\u4e8e\u5404\u7c7b\u5927\u3001\u4e2d\u3001\u5c0f\u3001\u5fae\u673a\u73af\u5883 ,\u5b83\u662f\u4e00\u79cd\u9ad8\u6548\u7387\u3001\u53ef\u9760\u6027\u597d\u7684\u9002\u5e94\u9ad8\u541e\u5410\u91cf\u7684\u6570\u636e\u5e93\u89e3\u51b3\u65b9\u6848\u3002</p> <p>Tips \uff1a\u5f53\u524d\u6700\u65b0\u7248\u672c\u4e3a Oracle Database 23ai, \u4e0d\u8fc7\u4f5c\u8005\u5efa\u8bae\u5728\u751f\u4ea7\u73af\u5883\u4e2d\u4f7f\u7528 Oracle Database 19c \u7248\u62e5\u6709\u8d85\u9ad8\u6c34\u5e73\u7684\u7248\u672c\u7a33\u5b9a\u6027\u4ee5\u53ca\u8d85\u957f\u7684\u652f\u6301\u548c\u9519\u8bef\u4fee\u590d\u652f\u6301\u5468\u671f\uff0c\u53ef\u4e3a\u60a8\u7684\u5e94\u7528\u63d0\u4f9b\u4e00\u4e2a\u8d85\u7ea7\u7a33\u5b9a\u7684\u5e73\u53f0\uff0c\u5982\u679c\u662f\u5b66\u4e60\u7684\u5316\u5efa\u8bae\u4f7f\u7528 Oracle Database 11g \u6216\u8005 Oracle Database 12c\u3002</p> <p>Tips : Oracle \u6570\u636e\u5e93\u6280\u672f\u5b98\u7f51\u7ad9\u70b9 (https://www.oracle.com/cn/database/technologies/)</p> <p>Oracle \u6570\u636e\u5e93\u5c31\u662f\u4e00\u4e2a RDBMS\uff0cOracle \u5b9e\u73b0\u9762\u5411\u5bf9\u8c61\u7279\u6027\uff08\u5982\u7528\u6237\u5b9a\u4e49\u7c7b\u578b\u3001\u7ee7\u627f\u548c\u591a\u6001\u6027\uff09\u7684 RDBMS \u79f0\u4e3a \u5bf9\u8c61\u5173\u7cfb\u6570\u636e\u5e93\u7ba1\u7406\u7cfb\u7edf \uff08ORDBMS\uff09, Oracle \u6570\u636e\u5e93\u5df2\u5c06\u5173\u7cfb\u6a21\u578b\u6269\u5c55\u4e3a\u5bf9\u8c61\u5173\u7cfb\u6a21\u578b\uff0c\u4ece\u800c\u53ef\u4ee5\u5728\u5173\u7cfb\u6570\u636e\u5e93\u4e2d\u5b58\u50a8\u590d\u6742\u7684\u4e1a\u52a1\u6a21\u578b\u3002</p> <p>Oracle \u6570\u636e\u5e93\u591a\u64cd\u4f5c\u5e73\u53f0\u652f\u6301:\u7532\u9aa8\u6587\u516c\u53f8\u7684Oracle10g/11g/12c/18c/19c/21c/23ai\u652f\u6301\u5e38\u89c1\u7684\u64cd\u4f5c\u7cfb\u7edf\u4f8b\u5982:</p> <ul> <li>Microsoft Windows x86,x86-64</li> <li>Linux x86,x86-64</li> <li>Apple Mac OS X Server</li> <li>Sun Salaris SPARC x86,x86-64</li> </ul> <p>Oracle \u5ba3\u5e03Oracle Database 19c Enterprise Edition\uff08Oracle Database\u76ee\u524d\u7684\u957f\u671f\u652f\u6301\u7248\u672c\uff09\uff0c\u73b0\u5df2\u901a\u8fc7\u8ba4\u8bc1\uff0c\u53ef\u4ee5\u5728\u70ed\u95e8 Arm \u67b6\u6784\u4e0a\u90e8\u7f72\uff0c\u5e76\u652f\u6301\u4e91\u7aef\u548c\u672c\u5730\u73af\u5883\u3002</p> <p>Oracle \u6570\u636e\u5e93\u7279\u6027:</p> <ul> <li>\u9ad8\u53ef\u7528\u6027 : \u4e30\u5bcc\u7684\u5185\u7f6e\u529f\u80fd\u548c\u9009\u4ef6\uff0c\u5305\u62ec Oracle Active Data Guard \u548c Oracle Real Application Clusters\uff0c\u53ef\u652f\u6301\u9ad8\u6548\u6269\u5c55\u548c\u6574\u5408\u5ba2\u6237\u6570\u636e\u5e93, \u6765\u4fdd\u62a4\u91cd\u8981\u5ba2\u6237\u6570\u636e\u5e93\uff0c\u5927\u5e45\u63d0\u9ad8\u6570\u636e\u53ef\u7528\u6027\u3002</li> <li>\u6570\u636e\u5e93\u5b89\u5168\u6027 : \u501f\u52a9\u52a0\u5bc6\u3001\u6570\u636e\u5c4f\u853d\u3001\u7279\u6743\u7528\u6237\u8bbf\u95ee\u63a7\u5236\u3001\u6d3b\u52a8\u76d1\u89c6\u548c\u5ba1\u8ba1\u529f\u80fd; \u964d\u4f4e\u6570\u636e\u6cc4\u9732\u98ce\u9669\uff0c\u5e76\u8ba9\u5ba2\u6237\u80fd\u591f\u66f4\u52a0\u8f7b\u677e\u5730\u6ee1\u8db3\u5408\u89c4\u6027\u8981\u6c42\u3002</li> <li>\u6570\u636e\u5e93\u53ef\u7ba1\u7406\u6027 : \u901a\u8fc7\u5355\u4e00\u7ba1\u7406\u4eea\u8868\u76d8\u548c\u4e00\u81f4\u7684\u7ba1\u7406\u6d41\u7a0b\u63d0\u9ad8\u4f01\u4e1a\u7ea7\u6570\u636e\u5e93\u7684\u6027\u80fd\u548c\u53ef\u7528\u6027\uff0c\u51cf\u5c11 DBA \u7684\u5de5\u4f5c\u91cf\u3002</li> <li>\u6027\u80fd\u4e0e\u53ef\u4f38\u7f29\u6027 : \u901a\u8fc7\u4e00\u7cfb\u5217\u5f3a\u5927\u529f\u80fd\u4f18\u5316\u5ef6\u8fdf\uff0c\u63d0\u9ad8\u541e\u5410\u91cf\uff0c\u6ee1\u8db3\u5b9e\u65f6\u73af\u5883\u548c\u6570\u636e\u4e2d\u5fc3\u73af\u5883\u4e0b\u4e25\u683c\u7684\u6027\u80fd\u8981\u6c42\u3002</li> </ul> <p>Oracle \u6570\u636e\u5e93\u670d\u52a1\u5e94\u7528\u65b9\u6848:</p> <ul> <li>\u5206\u6790\u548c\u6570\u636e\u4ed3\u5e93 : \u501f\u52a9 Oracle Database In-Memory \u548c Oracle Multitenant \u7b49\u9ad8\u7ea7\u6570\u636e\u4ed3\u5e93\u548c\u5206\u6790\u6280\u672f\uff0c\u5206\u6790\u56e2\u961f\u53ef\u5728\u66f4\u77ed\u7684\u65f6\u95f4\u5185\u5bf9\u53ef\u6269\u5c55\u6570\u636e\u4ed3\u5e93\u8fdb\u884c\u66f4\u6df1\u5165\u7684\u5206\u6790\u3002</li> <li>\u673a\u5668\u5b66\u4e60 : Oracle \u6570\u636e\u5e93\u53ef\u8fd0\u884c\u5f3a\u5927\u7684\u7b97\u6cd5\u6765\u52a0\u901f\u673a\u5668\u5b66\u4e60 (ML)\uff0c\u8ba9\u5ba2\u6237\u65e0\u9700\u79fb\u52a8\u6216\u91cd\u65b0\u683c\u5f0f\u5316\u6570\u636e\u5373\u53ef\u6784\u5efa\u548c\u8fd0\u884c ML \u6a21\u578b\u3002\u6570\u636e\u79d1\u5b66\u5bb6\u5229\u7528 Python\u3001R\u3001SQL \u548c\u5176\u4ed6\u5de5\u5177\u5c06 ML \u529f\u80fd\u96c6\u6210\u5230\u6570\u636e\u5e93\u5e94\u7528\u4e2d\uff0c\u5e76\u5728\u6613\u4e8e\u4f7f\u7528\u7684\u4eea\u8868\u76d8\u4e2d\u5448\u73b0\u5206\u6790\u7ed3\u679c\u3002</li> <li>\u5168\u9762\u3001\u53ef\u6269\u5c55\u7684\u5f00\u53d1\u5e73\u53f0 : \u5f00\u53d1\u4eba\u5458\u53ef\u4ee5\u4f7f\u7528 SQL\u3001JSON\u3001XML \u548c\u4e00\u7cfb\u5217\u8fc7\u7a0b\u8bed\u8a00\u6765\u5feb\u901f\u521b\u5efa\u53ef\u6269\u5c55\u7684\u9ad8\u6027\u80fd\u5e94\u7528\u3002Oracle Database 19c \u63d0\u4f9b\u4e86\u4e00\u7cfb\u5217\u5185\u7f6e\u5f00\u53d1\u5de5\u5177\uff0c\u4f8b\u5982 APEX \u548c \u878d\u5408\u6570\u636e\u5e93 \u529f\u80fd\u3002</li> <li>\u654f\u6377\u3001\u7075\u6d3b\u3001\u5b89\u5168\u7684\u6570\u636e\u5e93\u7ba1\u7406 : Oracle \u4e91\u57fa\u7840\u8bbe\u65bd\u63d0\u4f9b\u4e00\u7cfb\u5217\u4f18\u5316\u7684\u6570\u636e\u5e93\u529f\u80fd\uff0c\u53ef\u5e2e\u52a9\u5ba2\u6237\u5bc6\u5207\u534f\u540c\u8d44\u6e90\u4e0e\u5176\u7279\u5b9a\u9700\u6c42\uff0c\u4ece\u800c\u5b9e\u73b0\u7ecf\u6d4e\u3001\u9ad8\u6548\u7684\u8fd0\u8425\u3002\u8bb8\u591a\u516c\u53f8\u7ed3\u5408\u5168\u6258\u7ba1\u5f0f\u81ea\u6cbb\u6570\u636e\u5e93\u7684\u5f3a\u5927\u529f\u80fd\u3001Exadata \u4e91\u670d\u52a1\u7684\u8d85\u5f3a\u6027\u80fd\u548c\u63a7\u5236\u4ee5\u53ca Oracle \u6570\u636e\u5e93\u3001MySQL \u6570\u636e\u5e93\u548c NoSQL \u6570\u636e\u5e93\u4e91\u670d\u52a1\u7684\u8d85\u4f4e\u6210\u672c\u6765\u63a8\u8fdb\u6570\u5b57\u8f6c\u578b\u3002</li> </ul>"},{"location":"oracle/03.oracle%E4%BD%93%E7%B3%BB%E6%9E%B6%E6%9E%84/","title":"03.oracle\u4f53\u7cfb\u67b6\u6784","text":""},{"location":"oracle/03.oracle%E4%BD%93%E7%B3%BB%E6%9E%B6%E6%9E%84/#oracle","title":"Oracle\u4f53\u7cfb\u67b6\u6784\u6982\u8ff0","text":"<p>Oracle\u4f53\u7cfb\u7ed3\u6784\u4e3b\u8981\u7528\u6765\u5206\u6790\u6570\u636e\u5e93\u7684\u7ec4\u6210\u3001\u5de5\u4f5c\u8fc7\u7a0b\u4e0e\u539f\u7406\uff0c\u4ee5\u53ca\u6570\u636e\u5728\u6570\u636e\u5e93\u4e2d\u7684\u7ec4\u7ec7\u4e0e\u7ba1\u7406\u673a\u5236\u3002oracle\u6570\u636e\u5e93\u662f\u4e00\u4e2a\u903b\u8f91\u6982\u5ff5\uff0c\u800c\u4e0d\u662f\u7269\u7406\u6982\u5ff5\u4e0a\u5b89\u88c5\u4e86oracle\u6570\u636e\u5e93\u7ba1\u7406\u7cfb\u7edf\u7684\u670d\u52a1\u5668\u3002</p> <p>\u5728Oracle\u6570\u636e\u5e93\u7ba1\u7406\u7cfb\u7edf\u4e2d\u67093\u4e2a\u91cd\u8981\u7684\u6982\u5ff5\u9700\u8981\u7406\u89e3\uff0c\u5b9e\u4f8b\uff08instance\uff09\u3001\u6570\u636e\u5e93\uff08database\uff09\u548c\u6570\u636e\u5e93\u670d\u52a1\u5668\uff08database server\uff09</p> <ul> <li>\u5b9e\u4f8b\uff1a\u5b9e\u4f8b\u662f Oracle \u6570\u636e\u5e93\u5728\u5185\u5b58\u4e2d\u7684\u8fd0\u884c\u73af\u5883\uff0c\u5305\u62ec\u4e00\u7ec4\u64cd\u4f5c\u7cfb\u7edf\u8fdb\u7a0b\u548c\u5185\u5b58\u7ed3\u6784\u3002\u5b9e\u4f8b\u8d1f\u8d23\u5904\u7406\u5bf9\u6570\u636e\u5e93\u7684\u6240\u6709\u64cd\u4f5c\uff0c\u5982\u8bfb\u53d6\u3001\u5199\u5165\u548c\u7ba1\u7406\u6570\u636e\u5e93\u6587\u4ef6\u3002\u6bcf\u4e2a\u5b9e\u4f8b\u5728\u542f\u52a8\u65f6\u4f1a\u88ab\u5206\u914d\u5185\u5b58\u548c\u542f\u52a8\u540e\u53f0\u8fdb\u7a0b\uff0c\u5e76\u4e0e\u6570\u636e\u5e93\uff08\u5b58\u50a8\u5728\u78c1\u76d8\u4e0a\u7684\u6570\u636e\u6587\u4ef6\uff09\u4ea4\u4e92\u3002<ul> <li>SGA\uff08System Global Area\uff09\uff1a\u5171\u4eab\u5185\u5b58\u533a\u57df\uff0c\u7528\u4e8e\u5b58\u50a8\u6570\u636e\u5e93\u7684\u5171\u4eab\u6570\u636e\u7ed3\u6784\uff0c\u5982\u7f13\u51b2\u533a\u7f13\u5b58\u3001\u5171\u4eab SQL \u533a\u3001\u65e5\u5fd7\u7f13\u51b2\u533a\u7b49\u3002SGA \u5728\u5b9e\u4f8b\u542f\u52a8\u65f6\u5206\u914d\u3002</li> <li>PGA\uff08Program Global Area\uff09\uff1a\u6bcf\u4e2a\u7528\u6237\u8fdb\u7a0b\u7684\u4e13\u7528\u5185\u5b58\u533a\u57df\uff0c\u5b58\u50a8\u7528\u6237\u4f1a\u8bdd\u7684\u7279\u5b9a\u6570\u636e\uff0c\u5982\u6e38\u6807\u4fe1\u606f\u548c SQL \u6267\u884c\u72b6\u6001\u3002</li> <li>\u540e\u53f0\u8fdb\u7a0b\uff1a\u5b9e\u4f8b\u5728\u8fd0\u884c\u65f6\u542f\u52a8\u7684\u4e00\u7ec4\u64cd\u4f5c\u7cfb\u7edf\u8fdb\u7a0b\uff0c\u5305\u62ec DBWn\uff08\u6570\u636e\u5e93\u5199\u5165\u5668\uff09\u3001LGWR\uff08\u65e5\u5fd7\u5199\u5165\u5668\uff09\u3001CKPT\uff08\u68c0\u67e5\u70b9\u8fdb\u7a0b\uff09\u3001SMON\uff08\u7cfb\u7edf\u76d1\u63a7\u8fdb\u7a0b\uff09\u3001PMON\uff08\u8fdb\u7a0b\u76d1\u63a7\u8fdb\u7a0b\uff09\u7b49\u3002\u8fd9\u4e9b\u8fdb\u7a0b\u534f\u540c\u5de5\u4f5c\uff0c\u7ba1\u7406\u6570\u636e\u5e93\u7684\u8f93\u5165/\u8f93\u51fa\u3001\u4e8b\u52a1\u5904\u7406\u3001\u6062\u590d\u548c\u6e05\u7406\u5de5\u4f5c\u3002</li> </ul> </li> </ul> <p>\u591a\u5b9e\u4f8b\u67b6\u6784\uff1a\u5728 Oracle \u7684 RAC\uff08Real Application Clusters\uff09\u73af\u5883\u4e2d\uff0c\u591a\u4e2a\u5b9e\u4f8b\u53ef\u4ee5\u540c\u65f6\u8bbf\u95ee\u4e00\u4e2a\u6570\u636e\u5e93\uff0c\u8fd9\u4e9b\u5b9e\u4f8b\u5171\u4eab\u6570\u636e\u5e93\u7684\u5b58\u50a8\uff0c\u4f46\u5404\u81ea\u62e5\u6709\u72ec\u7acb\u7684\u5185\u5b58\u548c\u8fdb\u7a0b\u3002</p> <ul> <li> <p>\u6570\u636e\u5e93\uff1a\u7531\u57fa\u4e8e\u78c1\u76d8\u7684\u6570\u636e\u6587\u4ef6\u3001\u63a7\u5236\u6587\u4ef6\u3001\u65e5\u5fd7\u6587\u4ef6\u3001\u53c2\u6570\u6587\u4ef6\u548c\u5f52\u6863\u65e5\u5fd7\u6587\u4ef6\u7b49\u7ec4\u6210\u7684\u7269\u7406\u6587\u4ef6\u96c6\u5408\uff1b</p> <ul> <li> <p>\u6570\u636e\u6587\u4ef6\uff08Data Files\uff09: \u5b58\u50a8\u5b9e\u9645\u7684\u7528\u6237\u6570\u636e\uff0c\u5982\u8868\u3001\u7d22\u5f15\u7b49\u4e1a\u52a1\u6570\u636e\u7684\u78c1\u76d8\u6587\u4ef6\u3002\u8fd9\u4e9b\u6587\u4ef6\u662f\u6570\u636e\u5e93\u7684\u6838\u5fc3\u7ec4\u6210\u90e8\u5206\u3002</p> </li> <li> <p>\u63a7\u5236\u6587\u4ef6\uff08Control Files\uff09\uff1a\u5305\u542b\u6570\u636e\u5e93\u7684\u5143\u6570\u636e\uff0c\u5982\u6570\u636e\u5e93\u540d\u3001\u6570\u636e\u6587\u4ef6\u548c\u65e5\u5fd7\u6587\u4ef6\u7684\u4f4d\u7f6e\u3001\u6570\u636e\u5e93\u7684\u7ed3\u6784\u548c\u72b6\u6001\u7b49\u3002\u63a7\u5236\u6587\u4ef6\u5bf9\u6570\u636e\u5e93\u7684\u6b63\u5e38\u8fd0\u884c\u81f3\u5173\u91cd\u8981\u3002</p> </li> <li> <p>\u91cd\u505a\u65e5\u5fd7\u6587\u4ef6\uff08Redo Log Files\uff09\uff1a\u8bb0\u5f55\u6570\u636e\u5e93\u7684\u6240\u6709\u4fee\u6539\u64cd\u4f5c\uff0c\u7528\u4e8e\u6062\u590d\u6570\u636e\u5e93\u5230\u4e00\u81f4\u72b6\u6001\u3002\u91cd\u505a\u65e5\u5fd7\u6587\u4ef6\u662f\u6570\u636e\u5e93\u6062\u590d\u673a\u5236\u7684\u91cd\u8981\u7ec4\u6210\u90e8\u5206\u3002</p> </li> <li> <p>\u53c2\u6570\u6587\u4ef6\uff08Parameter File\uff09\uff1a\u5b9a\u4e49\u5b9e\u4f8b\u542f\u52a8\u65f6\u4f7f\u7528\u7684\u914d\u7f6e\u53c2\u6570\uff0c\u5982 SGA \u5927\u5c0f\u3001\u540e\u53f0\u8fdb\u7a0b\u914d\u7f6e\u7b49\u3002</p> </li> <li> <p>\u5f52\u6863\u65e5\u5fd7\u6587\u4ef6\uff08Archived Log Files\uff09\uff1a\u5b58\u50a8\u91cd\u505a\u65e5\u5fd7\u7684\u5f52\u6863\u526f\u672c\uff0c\u7528\u4e8e\u6062\u590d\u5386\u53f2\u6570\u636e\u3002</p> </li> </ul> </li> </ul> <p>\u6570\u636e\u5e93\u670d\u52a1\u5668\uff1a\u7ba1\u7406\u6570\u636e\u5e93\u7684\u5404\u79cd\u8f6f\u4ef6\u5de5\u5177\u548c\u5b9e\u4f8b\u53ca\u6570\u636e\u5e93\u7684\u4e09\u4e2a\u90e8\u5206\u3002</p> <p>\u4ece\u5b9e\u4f8b\u4e0e\u6570\u636e\u5e93\u4e4b\u95f4\u7684\u8fa9\u8bc1\u5173\u7cfb\u6765\u8bb2\uff0c\u5b9e\u4f8b\u7528\u4e8e\u7ba1\u7406\u548c\u63a7\u5236\u6570\u636e\u5e93\uff1b\u800c\u6570\u636e\u5e93\u4e3a\u5b9e\u4f8b\u63d0\u4f9b\u6570\u636e\u3002 \u4e00\u4e2a\u5b9e\u4f8b\u5728\u5176\u751f\u5b58\u671f\u5185\u53ea\u80fd\u88c5\u8f7d\u548c\u6253\u5f00\u4e00\u4e2a\u6570\u636e\u5e93\uff08\u5728Oracle 12c \u591a\u79df\u6237\u4e4b\u524d\uff09\u3002\u591a\u4e2a\u5b9e\u4f8b\uff08\u4e00\u822c\u8fd9\u4e9b\u5b9e\u4f8b\u662f\u8fd0\u884c\u5728\u4e0d\u540c\u4e3b\u673a\u4e0a\u7684\uff09\u53ef\u4ee5\u540c\u65f6\u8bbf\u95ee\u4e00\u4e2a\u6570\u636e\u5e93\uff08\u5728 RAC \u73af\u5883\u4e2d\uff09\u3002</p> <p>RAC\u67b6\u6784 Oracle Real Application Clusters \u662f Oracle \u6570\u636e\u5e93\u4f01\u4e1a\u7248\u7684\u4e00\u4e2a\u9009\u4ef6\uff0c\u5728 Oracle 9i \u4e2d\u9996\u6b21\u5f15\u5165\u3002\u76ee\u524d\uff0c\u5b83\u5df2\u53d1\u5c55\u6210\u4e3a\u4e00\u9879\u6210\u719f\u7684\u6280\u672f\uff0c\u5176\u7528\u6237\u8fc7\u5343\uff0c\u904d\u53ca\u5404\u4e2a\u884c\u4e1a\uff0c\u6d89\u53ca\u5404\u7c7b\u5e94\u7528\u7a0b\u5e8f\u3002 Oracle RAC \u80fd\u591f\u6269\u5c55\u5e94\u7528\u7a0b\u5e8f\uff0c\u63d0\u4f9b\u7684\u6027\u80fd\u53ef\u4ee5\u8d85\u8d8a\u5355\u53f0\u670d\u52a1\u5668\u3002 Oracle Real Application Clusters \u662f Oracle \u6700\u9ad8\u53ef\u7528\u6027\u67b6\u6784 (MAA) \u7684\u5173\u952e\u7ec4\u4ef6\u4e4b\u4e00\uff0c\u8be5\u67b6\u6784\u662f\u5e94\u7528\u7a0b\u5e8f\u6700\u9ad8\u53ef\u7528\u6027\u67b6\u6784\u7684\u53d1\u5c55\u65b9\u5411\u3002Oracle RAC \u63d0\u4f9b\u4e86\u5728\u4efb\u4f55\u6570\u636e\u5e93\u5e94\u7528\u7a0b\u5e8f\u73af\u5883\u4e2d\u79fb\u9664\u5355\u70b9\u6545\u969c\u670d\u52a1\u5668\u7684\u80fd\u529b\u3002</p> <p>\u5728 Oracle Real Application Clusters \u4e2d\uff0c\u5c06 Oracle \u5b9e\u4f8b\uff08\u8fd0\u884c\u5728\u670d\u52a1\u5668\u4e0a\u7684\u8fdb\u7a0b\u548c\u5185\u5b58\u7ed3\u6784\uff0c\u7528\u4e8e\u652f\u6301\u6570\u636e\u8bbf\u95ee\uff09\u4e0e Oracle \u6570\u636e\u5e93\uff08\u9a7b\u7559\u5728\u5b58\u50a8\u5668\u4e0a\u7684\u5b9e\u9645\u7528\u4e8e\u4fdd\u5b58\u6570\u636e\u7684\u7269\u7406\u7ed3\u6784\uff0c\u901a\u5e38\u79f0\u4e3a\u6570\u636e\u6587\u4ef6\uff09\u8fdb\u884c\u4e86\u5206\u79bb\u3002 \u96c6\u7fa4\u6570\u636e\u5e93\u662f\u4e00\u4e2a\u53ef\u7531\u591a\u4e2a\u5b9e\u4f8b\u8bbf\u95ee\u7684\u6570\u636e\u5e93\u3002\u5404\u5b9e\u4f8b\u5728\u670d\u52a1\u5668\u6c60\u4e2d\u4e0d\u540c\u7684\u670d\u52a1\u5668\u4e0a\u8fd0\u884c\u3002\u5f53\u9700\u8981\u66f4\u591a\u7684\u8d44\u6e90\u65f6\uff0c\u53ef\u4ee5\u5728\u4e0d\u505c\u673a\u7684\u60c5\u51b5\u4e0b\u8f7b\u677e\u5730\u5411\u670d\u52a1\u5668\u6c60\u4e2d\u6dfb\u52a0\u670d\u52a1\u5668\u548c\u5b9e\u4f8b\u3002 \u5728\u542f\u52a8\u65b0\u5b9e\u4f8b\u540e\uff0c\u4f7f\u7528\u670d\u52a1\u7684\u5e94\u7528\u7a0b\u5e8f\u53ef\u7acb\u5373\u5229\u7528\u8be5\u5b9e\u4f8b\uff0c\u65e0\u9700\u5bf9\u5e94\u7528\u7a0b\u5e8f\u6216\u5e94\u7528\u7a0b\u5e8f\u670d\u52a1\u5668\u8fdb\u884c\u4efb\u4f55\u66f4\u6539\u3002</p> <p>\u53ef\u4ee5\u770b\u51fa\uff0cOracle RAC\u662f\u5178\u578b\u7684share disk\u67b6\u6784\uff0c\u5404\u4e2a\u5904\u7406\u5355\u5143\u4f7f\u7528\u81ea\u5df1\u7684\u79c1\u6709 CPU\u548cMemory\uff0c\u5171\u4eab\u78c1\u76d8\u7cfb\u7edf\u3002\u53ef\u901a\u8fc7\u589e\u52a0\u8282\u70b9\u6765\u63d0\u9ad8\u5e76\u884c\u5904\u7406\u7684\u80fd\u529b\uff0c\u6269\u5c55\u80fd\u529b\u8f83\u597d\u3002 \u5176\u7c7b\u4f3c\u4e8eSMP\uff08\u5bf9\u79f0\u591a\u5904\u7406\uff09\u6a21\u5f0f\uff0c\u4f46\u662f\u5f53\u5b58\u50a8\u5668\u63a5\u53e3\u8fbe\u5230\u9971\u548c\u7684\u65f6\u5019\uff0c\u589e\u52a0\u8282\u70b9\u5e76\u4e0d\u80fd\u83b7\u5f97\u66f4\u9ad8\u7684\u6027\u80fd \u3002</p> <p>\u5b9e\u4f8b\u542f\u52a8\uff1a \u5728 Oracle \u6570\u636e\u5e93\u4e2d\uff0c\u542f\u52a8\u5b9e\u4f8b\u662f\u4e00\u4e2a\u5173\u952e\u64cd\u4f5c\uff0c\u6d89\u53ca\u521d\u59cb\u5316\u6570\u636e\u5e93\u5b9e\u4f8b\u7684\u5185\u5b58\u7ed3\u6784\u3001\u542f\u52a8\u540e\u53f0\u8fdb\u7a0b\u4ee5\u53ca\u6253\u5f00\u6570\u636e\u5e93\uff0c\u4f7f\u5176\u80fd\u591f\u5904\u7406\u7528\u6237\u8bf7\u6c42\u3002 \u542f\u52a8\uff08STARTUP NOMOUNT\uff09\uff1a\u8be5\u9636\u6bb5\u5b9e\u4f8b\u542f\u52a8\uff0c\u521d\u59cb\u5316\u5185\u5b58\u7ed3\u6784\uff08SGA\uff09\u5e76\u542f\u52a8\u540e\u53f0\u8fdb\u7a0b\uff0c\u4f46\u4e0d\u52a0\u8f7d\u6570\u636e\u5e93\u3002\u6b64\u9636\u6bb5\u53ef\u4ee5\u7528\u4e8e\u521b\u5efa\u6570\u636e\u5e93\u6216\u91cd\u5efa\u63a7\u5236\u6587\u4ef6\u3002 \u52a0\u8f7d\u6570\u636e\u5e93\uff08STARTUP MOUNT\uff09\uff1a\u5728\u8fd9\u4e2a\u9636\u6bb5\uff0c\u5b9e\u4f8b\u52a0\u8f7d\u63a7\u5236\u6587\u4ef6\uff0c\u4f46\u6570\u636e\u5e93\u4ecd\u672a\u6253\u5f00\u3002\u8fd9\u65f6\u53ef\u4ee5\u6267\u884c\u6570\u636e\u5e93\u6062\u590d\u64cd\u4f5c\uff0c\u5982\u4ecb\u8d28\u6062\u590d\u3002 \u6253\u5f00\u6570\u636e\u5e93\uff08STARTUP OPEN\uff09\uff1a\u6570\u636e\u5e93\u6587\u4ef6\u88ab\u6253\u5f00\uff0c\u7528\u6237\u53ef\u4ee5\u8bbf\u95ee\u6570\u636e\u5e93\u3002\u8fd9\u662f\u6570\u636e\u5e93\u6b63\u5e38\u8fd0\u884c\u7684\u72b6\u6001\uff0c\u5141\u8bb8\u6267\u884c\u5404\u79cd\u64cd\u4f5c\uff0c\u5982\u67e5\u8be2\u3001\u63d2\u5165\u3001\u66f4\u65b0\u7b49\u3002</p> <p>\u6570\u636e\u5e93\u7684\u4e3b\u8981\u529f\u80fd\u5c31\u662f\u5b58\u50a8\u6570\u636e\uff0c\u6570\u636e\u5e93\u5b58\u50a8\u6570\u636e\u7684\u65b9\u5f0f\u901a\u5e38\u79f0\u4e3a\u5b58\u50a8\u7ed3\u6784\uff0cOracle \u6570\u636e\u5e93\u7684\u5b58\u50a8\u7ed3\u6784\u5206\u4e3a\u903b\u8f91\u5b58\u50a8\u7ed3\u6784\u548c\u7269\u7406\u5b58\u50a8\u7ed3\u6784\u3002 \u903b\u8f91\u5b58\u50a8\u7ed3\u6784\u7528\u4e8e\u63cf\u8ff0 Oracle \u5185\u90e8\u7ec4\u7ec7\u548c\u7ba1\u7406\u6570\u636e\u7684\u65b9\u5f0f\uff0c\u800c\u7269\u7406\u5b58\u50a8\u7ed3\u6784\u7528\u4e8e\u5c55\u793a Oracle \u5728\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u7684\u7269\u7406\u6587\u4ef6\u7ec4\u6210\u60c5\u51b5\u3002        \u542f\u52a8 Oracle \u6570\u636e\u5e93\u670d\u52a1\u5668\u5b9e\u9645\u4e0a\u662f\u5728\u670d\u52a1\u5668\u7684\u5185\u5b58\u4e2d\u521b\u5efa\u4e00\u4e2a Oracle \u5b9e\u4f8b\uff0c \u7136\u540e\u7528\u8fd9\u4e2a\u5b9e\u4f8b\u6765\u8bbf\u95ee\u548c\u63a7\u5236\u78c1\u76d8\u4e2d\u7684\u6570\u636e\u6587\u4ef6\u3002 \u5f53\u7528\u6237\u8fde\u63a5\u5230\u6570\u636e\u5e93\u65f6\uff0c\u5b9e\u9645\u4e0a\u8fde\u63a5\u7684\u662f\u6570\u636e\u5e93\u7684\u5b9e\u4f8b\uff0c\u7136\u540e\u7531\u5b9e\u4f8b\u8d1f\u8d23\u4e0e\u6570\u636e\u5e93\u8fdb\u884c\u901a\u4fe1\uff0c\u6700\u540e\u5c06\u5904\u7406\u7ed3\u679c\u8fd4\u56de\u7ed9\u7528\u6237\u3002</p>"},{"location":"oracle/03.oracle%E4%BD%93%E7%B3%BB%E6%9E%B6%E6%9E%84/#oracle_1","title":"Oracle\u903b\u8f91\u5b58\u50a8\u7ed3\u6784","text":"<p>ORACLE\u5728\u903b\u8f91\u5b58\u50a8\u4e0a\u52064\u4e2a\u7c92\u5ea6 \uff0c\u7531\u5927\u5230\u5c0f\u4e3a: \u8868\u7a7a\u95f4\uff0c\u6bb5\uff0c\u533a\uff0c\u5757\u3002</p>"},{"location":"oracle/03.oracle%E4%BD%93%E7%B3%BB%E6%9E%B6%E6%9E%84/#block","title":"\u5757Block","text":"<p>\u5757\u662f\u7c92\u5ea6\u6700\u5c0f\u7684\u5b58\u50a8\u5355\u4f4d\uff0c\u73b0\u5728\u6807\u51c6\u7684\u5757\u5927\u5c0f\u662f8K\u3002ORACLE\u6bcf\u4e00\u6b21I/O\u64cd\u4f5c\u4e5f\u662f\u6309\u5757\u6765\u64cd\u4f5c\u7684\uff0c\u4e5f\u5c31\u662f\u8bf4\u5f53ORACLE\u4ece\u6570\u636e\u6587\u4ef6\u8bfb\u6570\u636e\u65f6\uff0c\u662f\u8bfb\u53d6\u591a\u5c11\u4e2a\u5757\uff0c\u800c\u4e0d\u662f\u591a\u5c11\u884c\u3002  \u6bcf\u4e00\u4e2aBlock\u91cc\u53ef\u4ee5\u5305\u542b\u591a\u4e2arow\u3002\u6570\u636e\u5757\u7684\u5927\u5c0f\u662f\u901a\u8fc7KB\u5b57\u8282\u4e2a\u6570\u6765\u6307\u5b9a\u7684\uff0c\u9ed8\u8ba4\u4e3a8KB\u3002 \u5757\u7684\u5927\u5c0f\u5728\u6570\u636e\u5e93\u521b\u5efa\u65f6\u5c31\u5df2\u7ecf\u56fa\u5b9a\u4e0b\u6765\uff0c\u6570\u636e\u5e93\u4e2d\u6bcf\u4e2a\u5757\u7684\u5927\u5c0f\u90fd\u662f\u76f8\u540c\u7684\uff0c\u800c\u4e14\u6240\u6709\u7684\u5757\u90fd\u6709\u76f8\u540c\u7684\u683c\u5f0f\uff0c\u7531\u201c\u5757\u5934\uff0b\u8868\u76ee\u5f55\uff0b\u884c\u76ee\u5f55\uff0b\u7a7a\u95f2\u7a7a\u95f4\uff0b\u6570\u636e\u7a7a\u95f4\u201d\u7ec4\u6210\u3002 \u5757\u5934\u5305\u542b\u7740\u5757\u7c7b\u578b\uff08\u6bd4\u5982\u662f\u8868\u5757\u3001\u8fd8\u662f\u7d22\u5f15\u5757\uff09\u7684\u4fe1\u606f\u3001\u78c1\u76d8\u4e0a\u5757\u7684\u4f4d\u7f6e\u7b49\u4fe1\u606f\u3002</p>"},{"location":"oracle/03.oracle%E4%BD%93%E7%B3%BB%E6%9E%B6%E6%9E%84/#extent","title":"\u533aExtent","text":"<p>\u533a\u7531\u4e00\u7cfb\u5217\u76f8\u90bb\u7684\u5757\u800c\u7ec4\u6210,\u8fd9\u4e5f\u662fORACLE\u7a7a\u95f4\u5206\u914d\u7684\u57fa\u672c\u5355\u4f4d\u3002\u533aextent\u662f\u6bd4\u6570\u636e\u5757\u5927\u4e00\u7ea7\u7684\u5b58\u50a8\u7ed3\u6784\uff0c\u8868\u793a\u7684\u662f\u4e00\u8fde\u4e32\u8fde\u7eed\u7684\u6570\u636e\u5757\u96c6\u5408\u3002\u533a\u7684\u5927\u5c0f\u4ece\u4e00\u4e2a\u5757\u52302GB\u4e0d\u7b49</p> <p>\u5728\u8fdb\u884c\u5b58\u50a8\u6570\u636e\u4fe1\u606f\u7684\u65f6\u5019\uff0cOracle\u5c06\u5206\u914d\u6570\u636e\u5757\u8fdb\u884c\u5b58\u50a8\uff0c\u4f46\u662f\u4e0d\u80fd\u4fdd\u8bc1\u6240\u6709\u5206\u914d\u7684\u6570\u636e\u5757\u90fd\u662f\u8fde\u7eed\u7684\u7ed3\u6784\u3002\u6240\u4ee5\uff0c\u51fa\u73b0\u5206\u533aextent\u7684\u6982\u5ff5\uff0c\u8868\u793a\u4e00\u7cfb\u5217\u8fde\u7eed\u7684\u6570\u636e\u5757\u96c6\u5408\u3002</p> <p>\u4e3e\u4e2a\u4f8b\u5b50\u6765\u8bf4\uff0c\u5f53\u6211\u4eec\u521b\u5efa\u4e00\u4e2a\u8868\u65f6\uff0c\u9996\u5148ORACLE\u4f1a\u5206\u914d\u4e00\u533a\u7684\u7a7a\u95f4\u7ed9\u8fd9\u4e2a\u8868\uff0c\u968f\u7740\u6570\u636e\u4e0d\u65ad\u5730\u589e\u957f\uff0c\u539f\u6765\u7684\u8fd9\u4e2a\u533a\u5bb9\u4e0d\u4e0b\u63d2\u5165\u7684\u6570\u636e\u65f6\uff0cORACLE\u662f\u4ee5\u533a\u4e3a\u5355\u4f4d\u8fdb\u884c\u6269\u5c55\u7684\uff0c\u4e5f\u5c31\u662f\u8bf4\u518d\u5206\u914d\u591a\u5c11\u4e2a\u533a\u7ed9\u8fd9\u4e2a\u8868\uff0c\u800c\u4e0d\u662f\u591a\u5c11\u4e2a\u5757\u3002 \u89c6\u56fedba_extents\uff08\u6216\u8005all_extents\u3001user_extents\uff09\u662f\u6211\u4eec\u7814\u7a76\u5206\u533a\u7ed3\u6784\u548c\u5b58\u50a8\u6784\u6210\u7684\u91cd\u8981\u624b\u6bb5\u3002</p>"},{"location":"oracle/03.oracle%E4%BD%93%E7%B3%BB%E6%9E%B6%E6%9E%84/#segment","title":"\u6bb5Segment","text":"<p>\u6bb5\u662foracle\u6570\u636e\u5e93\u4e2d\u7684\u5206\u914d\u5355\u4f4d\uff0c\u5bf9\u8c61\u5982\u8868\u3001\u7d22\u5f15\u7b49\u90fd\u662f\u4ee5\u6bb5\u4e3a\u5355\u4f4d\u8fdb\u884c\u5206\u914d\u3002\u5f53\u521b\u5efa\u4e00\u4e2a\u8868\u65f6\u5c06\u521b\u5efa\u4e00\u4e2a\u8868\u6bb5\uff0c\u521b\u5efa\u4e00\u4e2a\u7d22\u5f15\u65f6\u5c31\u521b\u5efa\u4e00\u4e2a\u7d22\u5f15\u6bb5\u3002\u6bcf\u4e00\u4e2a\u6d88\u8017\u5b58\u50a8\u7a7a\u95f4\u7684\u5bf9\u8c61\u6700\u7ec8\u88ab\u5b58\u50a8\u5230\u4e00\u4e2a\u5355\u4e00\u7684\u6bb5\u4e2d\u3002 \u6709\u56de\u6eda\u6bb5\u3001\u4e34\u65f6\u6bb5\u3001\u805a\u7c07\u6bb5\u3001\u7d22\u5f15\u6bb5\u7b49\u3002\u6bb5(SEGMENT)\u5b58\u5728\u4e8e\u8868\u7a7a\u95f4\u4e2d\uff0c\u662f\u5305\u542b\u4e8e\u8868\u7a7a\u95f4\u4e2d\u7684\u4e00\u79cd\u6307\u5b9a\u7c7b\u578b\u7684\u903b\u8f91\u5b58\u50a8\u7ed3\u6784\uff0c\u6bb5\u7531\u4e00\u7ec4\u533a\u7ec4\u6210\u3002 \u6309\u7167\u6bb5\u4e2d\u6240\u5b58\u50a8\u6570\u636e\u7684\u7279\u6027\u4ee5\u53ca\u4e3a\u4f18\u5316\u7cfb\u7edf\u6027\u80fd\u7684\u9700\u8981\uff0c\u5c06\u6bb5\u5206\u62104\u7c7b\uff0c\u5373\u6570\u636e\u6bb5\u3001\u7d22\u5f15\u6bb5\u3001\u56de\u9000\u6bb5\u3001\u4e34\u65f6\u6bb5\u3002 \u4f8b\u5982\uff0c\u5bf9\u4e8e\u6bcf\u4e2a\u8868\uff0cOracle\u90fd\u5206\u914d\u4e00\u4e2a\u6216\u591a\u4e2a\u533a\u4ee5\u6784\u6210\u8be5\u8868\u7684\u6570\u636e\u6bb5\uff1b\u800c\u5bf9\u4e8e\u6bcf\u4e2a\u7d22\u5f15\uff0cOracle\u5219\u5206\u914d\u4e00\u4e2a\u6216\u591a\u4e2a\u533a\u4ee5\u6784\u6210\u7d22\u5f15\u6bb5\u3002</p> <p>\u6bb5\u662f\u7c07\u7684\u4e0a\u7ea7\u903b\u8f91\u5206\u533a\u5355\u5143\uff0c\u5b83\u7531\u4e00\u7ec4\u7c07\u7ec4\u6210\u3002\u5728\u540c\u4e00\u4e2a\u8868\u7a7a\u95f4\u4e2d\uff0c\u6bb5\u53ef\u4ee5\u5305\u542b\u6765\u81ea\u4e0d\u540c\u6587\u4ef6\u7684\u7c07\uff0c\u5373\u4e00\u4e2a\u6bb5\u53ef\u4ee5\u8de8\u8d8a\u4e0d\u540c\u7684\u6587\u4ef6\u3002\u800c\u4e00\u4e2a\u7c07\u4ee5\u53ca\u8be5\u7c07\u6240\u5305\u542b\u7684\u6570\u636e\u9875\u5219\u53ea\u80fd\u6765\u81ea\u4e00\u4e2a\u6587\u4ef6\uff0c\u662f\u8fde\u7eed\u768416\u6216\u800532\u4e2a\u6570\u636e\u9875\u3002 \u7531\u4e8e\u7c07\u7684\u6570\u91cf\u662f\u6309\u9700\u5206\u914d\u7684\uff0c\u6570\u636e\u6bb5\u4e2d\u7684\u4e0d\u540c\u7c07\u5728\u78c1\u76d8\u4e0a\u4e0d\u4e00\u5b9a\u8fde\u7eed\u3002\u6bb5\u53ef\u4ee5\u6709\u6570\u636e\u6bb5\u3001\u4e34\u65f6\u6bb5\u548c\u56de\u6eda\u6bb5\uff0c\u800c\u6700\u5e38\u7528\u7684\u6bb5\u5c31\u662f\u6570\u636e\u6bb5\u3002</p>"},{"location":"oracle/03.oracle%E4%BD%93%E7%B3%BB%E6%9E%B6%E6%9E%84/#tablespace","title":"\u8868\u7a7a\u95f4TableSpace","text":"<p>\u8868\u7a7a\u95f4\u662f\u4e00\u4e2a\u903b\u8f91\u5bb9\u5668\uff0c\u5b83\u548c\u6570\u636e\u6587\u4ef6\uff08\u7269\u7406\u78c1\u76d8\u4e0a\u7684\u6570\u636e\u6587\u4ef6\uff09\u5173\u8054\u8d77\u6765\uff0c\u4e00\u4e2a\u8868\u7a7a\u95f4\u7531\u4e00\u4e2a\u6216\u591a\u4e2a\u6570\u636e\u6587\u4ef6\u7ec4\u6210\u3002\u4e00\u4e2a\u8868\u7a7a\u95f4\u53ef\u4ee5\u6709\u591a\u4e2a\u6bb5\uff0c\u4e00\u4e2a\u6bb5\u53ea\u80fd\u5c5e\u4e8e\u4e00\u4e2a\u8868\u7a7a\u95f4\u3002</p> <pre><code>SELECT * FROM DBA_TABLESPACES                 -- \u8bb0\u5f55\u5404\u4e2a\u8868\u7a7a\u95f4\u7684\u8be6\u7ec6\u4fe1\u606f\nSELECT * FROM DBA_TABLESPACE_USAGE_METRICS    -- \u8bb0\u5f55\u5404\u4e2a\u8868\u7a7a\u95f4\u7684\u4f7f\u7528\u72b6\u51b5\nSELECT * FROM DBA_DATA_FILES -- \u8bb0\u5f55\u5404\u4e2a\u6570\u636e\u6587\u4ef6\u7684\u8be6\u7ec6\u4fe1\u606f\nSELECT * FROM DBA_SEGMENTS -- \u8bb0\u5f55\u5404\u4e2a\u6bb5\u7684\u8be6\u7ec6\u4fe1\u606f\uff0c\u4e0e DBA_TABLES,DBA_INDEXES,DBA_LOBS,DBA_PART_TABLES,DBA_PART_INDEXES,DBA_PART_LOBS,DBA_OBJECTS \u642d\u914d\u4f7f\u7528\nSELECT * FROM DBA_LOBS --BLOB \u5b57\u6bb5\u6240\u5bf9\u5e94\u7684\u5b57\u6bb5\u540d\u79f0\nSELECT * FROM DBA_INDEXES -- \u5206\u533a\u7d22\u5f15\u9700\u8981\u901a\u8fc7 DBA_INDEXS \u6765\u627e\u5230\u5bf9\u5e94\u7684\u8868\u540d\nSELECT * FROM DBA_EXTENTS -- \u8bb0\u5f55\u5404\u4e2a\u533a\u95f4\u5bf9\u8c61\u7684\u8be6\u7ec6\u4fe1\u606f\n\n\nQuestion:\u00a0 What is the difference between dba_segments and dba_tables ?\nAnswer:\u00a0 The dba_tables view describes a \"logical\" structure while dba_segments describes the \"physical\" data segment, like a data file.\nAlso, columns like \"blocks\" are different between dba_tables and dba_segments.\u00a0 \nIn dba_tables, the \"blocks\" are calculated when you run dbms_stats, while in dba_segments, \"blocks\" is the actual number of blocks used by the object on disk.\n</code></pre> <p>Oracle\u9ad8\u6c34\u4f4d\u95ee\u9898</p> <p>\u9996\u5148\u65b0\u5efa\u4e00\u5f20\u7a7a\u8868\uff0c\u5927\u5c0f\u5360\u75285K\uff0c\u7136\u540e\u63d2\u51651000\u4e07\u6761\u6570\u636e\uff0c\u76f4\u5230\u8868\u5927\u5c0f\u53d8\u4e3a50G\uff0c\u6b64\u65f6\u4f7f\u7528DELETE\u5220\u9664\u6240\u6709\u7684\u6570\u636e\u5e76\u4e14\u63d0\u4ea4\uff0c\u8fd9\u4e2a\u65f6\u5019\u67e5\u8be2\u8868\u7684\u5927\u5c0f\u7684\u65f6\u5019\u4f9d\u7136\u662f50G\uff0c\u8fd9\u5c31\u662f\u56e0\u4e3a\u8868\u7684\u9ad8\u6c34\u4f4d\u6ca1\u6709\u91ca\u653e\u7684\u7f18\u6545\u3002 \u800c\u5728\u8fd9\u65f6\u5982\u679c\u4f7f\u7528\u201cSELECT * FROM TABLE_NAME;\u201d\u8bed\u53e5\u6765\u67e5\u8be2\u6570\u636e\u7684\u8bdd\uff0c\u90a3\u4e48\u67e5\u8be2\u8fc7\u7a0b\u4f9d\u7136\u4f1a\u5f88\u6162\uff0c\u56e0\u4e3aOracle\u8981\u6267\u884c\u5168\u8868\u626b\u63cf\uff0c\u9ad8\u6c34\u4f4d\u4e0b\u6240\u6709\u7684\u5757\u90fd\u5f97\u53bb\u626b\u63cf\uff0c\u76f4\u523050G\u7684\u6240\u6709\u5757\u5168\u90e8\u626b\u63cf\u5b8c\u6bd5\u3002 \u5176\u5b9e\u8fd9\u4e2a\u95ee\u9898\u5c31\u662f\u7531\u4e8e\u9ad8\u6c34\u4f4d\u7684\u7f18\u6545\u3002\u5728Oracle\u4e2d\u6267\u884cdelete\u5220\u9664\u64cd\u4f5c\u4e0d\u4f1a\u964d\u4f4e\u9ad8\u6c34\u4f4d\u3002\u800c\u6267\u884ctruncate\u64cd\u4f5c\u53ef\u4ee5\u964d\u4f4e\u9ad8\u6c34\u4f4d\uff0c\u901a\u5e38\u80fd\u628a\u9ad8\u6c34\u4f4d\u964d\u52300\u3002 \u6240\u4ee5\u4e3a\u4e86\u964d\u4f4e\u9ad8\u6c34\u4f4d\uff0c\u80fd\u5c3d\u91cf\u4f7f\u7528truncate\u7684\u5c31\u4e0d\u4f7f\u7528delete\u64cd\u4f5c\u3002</p> <p>\u7b80\u5355\u7684\u8bf4\u5c31\u50cf\u6c34\u5e93\u91cc\u7684\u5386\u53f2\u6700\u9ad8\u6c34\u4f4d\u3002 \u5c31\u5982\u521a\u6316\u7684\u6c34\u5e93\u4e00\u6837\u91cc\u9762\u6ca1\u6709\u4e00\u6ef4\u6c34\uff0c\u90a3\u4e48\u5b83\u7684\u6700\u9ad8\u6c34\u4f4d\u4e3a0\u3002\u540c\u7406\u5728\u521a\u5efa\u7684\u65b0\u8868\u4e2d\u7531\u4e8e\u6ca1\u6709\u4e00\u6761\u6570\u636e\uff0c\u6240\u4ee5\u7684\u9ad8\u6c34\u4f4d\u662f0\uff0c\u968f\u7740\u4e0d\u65ad\u7684\u5f80\u91cc\u9762\u6dfb\u52a0\u6570\u636e\uff0c\u8fdb\u884c\u589e\u5220\u64cd\u4f5c\uff0c\u90a3\u4e48\u5b83\u7684\u9ad8\u6c34\u4f4d\u5c31\u4f1a\u4e0a\u6da8\u3002  \u5f53\u7136\u4e5f\u4e0d\u662f\u8bf4\u4f60\u628a\u8868\u7684\u6570\u636e\u5220\u6389\u4e00\u534a\uff0c\u5b83\u7684\u9ad8\u6c34\u4f4d\u5c31\u4f1a\u4e0b\u964d\uff0c\u56e0\u4e3a\u9ad8\u6c34\u4f4d\u4ee3\u8868\u5386\u53f2\u6700\u9ad8\u6c34\u4f4d\u3002\u00a0 \u5728Oracle\u4e2d\u6267\u884cdelete\u5220\u9664\u64cd\u4f5c\u4e0d\u4f1a\u964d\u4f4e\u9ad8\u6c34\u4f4d\u3002\u6267\u884ctruncate\u64cd\u4f5c\u53ef\u4ee5\u964d\u4f4e\u9ad8\u6c34\u4f4d\uff0c\u901a\u5e38\u80fd\u628a\u9ad8\u6c34\u4f4d\u964d\u52300\u3002 \u6240\u4ee5\u4e3a\u4e86\u964d\u4f4e\u9ad8\u6c34\u4f4d\uff0c\u80fd\u5c3d\u91cf\u4f7f\u7528truncate\u7684\u5c31\u4e0d\u4f7f\u7528delete\u64cd\u4f5c\u3002</p> <p>\u9ad8\u6c34\u4f4d\u7ebf\u5f71\u54cd\u6700\u663e\u8457\u7684\u5c31\u662f\u5168\u8868\u626b\u63cf\u7684\u6548\u7387\uff0c\u56e0\u4e3a\u5f53\u8fdb\u884c\u5168\u8868\u626b\u63cf\u65f6\uff0c\u4f1a\u626b\u63cf\u9ad8\u6c34\u4f4d\u7ebf\u4ee5\u4e0b\u7684\u6240\u6709\u6570\u636e\u5757\uff0c\u7528\u4e0a\u8ff0\u7684\u4f8b\u5b50\u8bf4\uff0c\u5982\u679c1220\u4e07\u6570\u636e\uff0c\u5220\u9664\u4e861200\u4e07\uff0c\u53ea\u5269\u4e0b20\u4e07\uff0c\u5f53\u8fdb\u884c\u5168\u8868\u626b\u63cf\u7684\u65f6\u5019\uff0c\u4e0d\u4f1a\u53ea\u626b\u63cf\u8fd920\u4e07\u6570\u636e\u7684\u6570\u636e\u5757\uff0c\u4ed6\u8fd8\u4f1a\u626b\u63cf1220\u4e07\u6570\u636e\u7684\u6570\u636e\u5757\u3002</p> <p>Oracle\u6570\u636e\u5e93\u903b\u8f91\u4e0a\u7531\u4e00\u4e2a\u6216\u591a\u4e2a\u8868\u7a7a\u95f4\u7ec4\u6210\uff0c\u6bcf\u4e2a\u8868\u7a7a\u95f4\u5728\u7269\u7406\u4e0a\u7531\u4e00\u4e2a\u6216\u591a\u4e2a\u6570\u636e\u6587\u4ef6\u7ec4\u6210\uff0c\u800c\u6bcf\u4e2a\u6570\u636e\u6587\u4ef6\u662f\u6709\u6570\u636e\u5757\u6784\u6210\u7684\u3002 \u6240\u4ee5\uff0c\u903b\u8f91\u4e0a\u6570\u636e\u5b58\u653e\u5728\u8868\u7a7a\u95f4\u4e2d\uff0c\u800c\u7269\u7406\u4e0a\u5b58\u50a8\u5728\u8868\u7a7a\u95f4\u6240\u5bf9\u5e94\u7684\u6570\u636e\u6587\u4ef6\u4e2d\u3002 oarcle\u6570\u636e\u5e93\u771f\u6b63\u5b58\u653e\u6570\u636e\u7684\u662f\u6570\u636e\u6587\u4ef6\uff08data\u00a0files\uff09\uff0cOarcle\u8868\u7a7a\u95f4\uff08tablespaces\uff09\u5b9e\u9645\u4e0a\u662f\u4e00\u4e2a\u903b\u8f91\u7684\u6982\u5ff5\uff0c\u4ed6\u5728\u7269\u7406\u4e0a\u662f\u5e76\u4e0d\u5b58\u5728\u7684\uff0c\u90a3\u4e48\u628a\u4e00\u7ec4data\u00a0files\u00a0\u637b\u5728\u4e00\u8d77\u5c31\u6210\u4e3a\u4e00\u4e2a\u8868\u7a7a\u95f4\u3002</p> <p>\u8868\u7a7a\u95f4\uff1a\u6700\u9ad8\u7ea7\u7684\u903b\u8f91\u5b58\u50a8\u7ed3\u6784\uff0c\u6570\u636e\u5e93\u662f\u7531\u591a\u4e2a\u8868\u7a7a\u95f4\u7ec4\u6210\u7684\u3002\u5728\u521b\u5efa\u6570\u636e\u5e93\u65f6\u4f1a\u81ea\u52a8\u521b\u5efa\u4e00\u4e9b\u9ed8\u8ba4\u7684\u8868\u7a7a\u95f4\uff0c\u4f8b\u5982 SYSTEM\u8868\u7a7a\u95f4\uff0cSYSAUX\u8868\u7a7a\u95f4\u7b49\u3002 \u901a\u8fc7\u4f7f\u7528\u8868\u7a7a\u95f4\uff0cOracle\u5c06\u6240\u6709\u76f8\u5173\u7684\u903b\u8f91\u7ed3\u6784\u548c\u5bf9\u8c61\u7ec4\u5408\u5728\u4e00\u8d77\u3002\u6211\u4eec\u53ef\u4ee5\u5728\u8868\u7a7a\u95f4\u7ea7\u522b\u6307\u5b9a\u5b58\u50a8\u53c2\u6570\uff0c\u4e5f\u53ef\u4ee5\u5728\u77ed\u7ea7\u522b\u6307\u5b9a\u3002</p> <p>\u4e0b\u9762\u6211\u4eec\u5217\u51fa\u5e38\u89c1\u7684\u8868\u7a7a\u95f4\uff0c\u548c\u4ed6\u4eec\u6240\u5b58\u50a8\u7684\u4fe1\u606f\uff1a \u6570\u636e\u8868\u7a7a\u95f4\uff1a\u7528\u4e8e\u5b58\u50a8\u7528\u6237\u6570\u636e\u7684\u666e\u901a\u8868\u7a7a\u95f4\u3002 \u7cfb\u7edf\u8868\u7a7a\u95f4\uff1a\u9ed8\u8ba4\u7684\u8868\u7a7a\u95f4\uff0c\u7528\u4e8e\u4fdd\u5b58\u6570\u636e\u5b57\u5178\uff08\u4e00\u7ec4\u4fdd\u5b58\u6570\u636e\u5e93\u81ea\u8eab\u4fe1\u606f\u7684\u5185\u90e8\u7cfb\u7edf\u8868\u548c\u89c6\u56fe\uff0c\u53ca\u7528\u4e8eOracle\u5185\u90e8\u4f7f\u7528\u7684\u5176\u4ed6\u4e00\u4e9b\u5bf9\u8c61\uff09\uff0c\u4fdd\u5b58\u6240\u6709\u7684PL/SQL\u7a0b\u5e8f\u7684\u6e90\u4ee3\u7801\u548c\u89e3\u6790\u4ee3\u7801\uff0c\u5305\u62ec\u5b58\u50a8\u8fc7\u7a0b\u548c\u51fd\u6570\u3001\u5305\u3001\u6570\u636e\u5e93\u89e6\u53d1\u5668\u7b49\uff0c\u4fdd\u5b58\u6570\u636e\u5e93\u5bf9\u8c61\uff08\u8868\u3001\u89c6\u56fe\u3001\u5e8f\u5217\uff09\u7684\u5b9a\u4e49\u3002\u7cfb\u7edf\u8868\u7a7a\u95f4\uff0c\u7528\u4e8e\u5b58\u653e Oracle \u7cfb\u7edf\u5185\u90e8\u8868\u548c\u6570\u636e\u5b57\u5178\u7684\u6570\u636e\uff0c\u5982\u8868\u540d\u3001\u5217\u540d\u3001\u7528\u6237\u540d\u7b49\u3002 Oracle \u672c\u8eab\u4e0d\u8d5e\u6210\u5c06\u7528\u6237\u521b\u5efa\u7684\u8868\u3001\u7d22\u5f15\u7b49\u5b58\u653e\u5728\u7cfb\u7edf\u8868\u7a7a\u95f4\u4e2d\u3002\u8868\u7a7a\u95f4\u4e2d\u7684\u6570\u636e\u6587\u4ef6\u4e2a\u6570\u4e0d\u662f\u56fa\u5b9a\u4e0d\u53d8\u7684\uff0c\u53ef\u4ee5\u6839\u636e\u9700\u8981\u5411\u8868\u7a7a\u95f4\u4e2d\u8ffd\u52a0\u65b0\u7684\u6570\u636e\u6587\u4ef6\u3002 \u56de\u6eda\u8868\u7a7a\u95f4\uff1a\u7528\u4e8e\u5b58\u653e\u56de\u6eda\u6bb5,\u6bcf\u4e2a\u5b9e\u4f8b\u6700\u591a\u53ea\u80fd\u4f7f\u7528\u4e00\u4e2a\u64a4\u9500\u8868\u7a7a\u95f4 \u4e34\u65f6\u8868\u7a7a\u95f4\uff1a\u5b58\u50a8SQL\u6267\u884c\u8fc7\u7a0b\u4e2d\u4ea7\u751f\u7684\u4e34\u65f6\u6570\u636e</p> <p>\u6211\u4eec\u77e5\u9053oarcle\u6570\u636e\u5e93\u771f\u6b63\u5b58\u653e\u6570\u636e\u7684\u662f\u6570\u636e\u6587\u4ef6\uff08data\u00a0files\uff09\u3002 Oarcle\u8868\u7a7a\u95f4\uff08tablespaces\uff09\u5b9e\u9645\u4e0a\u662f\u4e00\u4e2a\u903b\u8f91\u7684\u6982\u5ff5\uff0c\u4ed6\u5728\u7269\u7406\u4e0a\u662f\u5e76\u4e0d\u5b58\u5728\u7684\uff0c\u90a3\u4e48\u628a\u4e00\u7ec4data\u00a0files\u00a0\u637b\u5728\u4e00\u8d77\u5c31\u6210\u4e3a\u4e00\u4e2a\u8868\u7a7a\u95f4\u3002</p> <p>\u8868\u7a7a\u95f4\u5c5e\u6027\uff1a \u4e00\u4e2a\u6570\u636e\u5e93\u53ef\u4ee5\u5305\u542b\u591a\u4e2a\u8868\u7a7a\u95f4\uff0c\u4e00\u4e2a\u8868\u7a7a\u95f4\u53ea\u80fd\u5c5e\u4e8e\u4e00\u4e2a\u6570\u636e\u5e93 \u4e00\u4e2a\u8868\u7a7a\u95f4\u5305\u542b\u591a\u4e2a\u6570\u636e\u6587\u4ef6\uff0c\u4e00\u4e2a\u6570\u636e\u6587\u4ef6\u53ea\u80fd\u5c5e\u4e8e\u4e00\u4e2a\u8868\u7a7a\u95f4 \u8868\u7a7a\u95f4\u53ef\u4ee5\u5212\u5206\u6210\u66f4\u7ec6\u7684\u903b\u8f91\u5b58\u50a8\u5355\u5143\u3002</p> <p>oralce\u6570\u636e\u5e93\u7684\u5b58\u50a8\u7ed3\u6784\uff1a</p> <p>\u4ece\u903b\u8f91\u7684\u89d2\u5ea6\u6765\u770b\uff0c\u4e00\u4e2a\u6570\u636e\u5e93\uff08database\uff09\u4e0b\u9762\u53ef\u4ee5\u5206\u591a\u4e2a\u8868\u7a7a\u95f4\uff08tablespace\uff09\uff1b\u4e00\u4e2a\u8868\u7a7a\u95f4\u4e0b\u9762\u53c8\u53ef\u4ee5\u5206\u591a\u4e2a\u6bb5\uff08segment\uff09\uff1b\u4e00\u4e2a\u6570\u636e\u8868\u8981\u5360\u4e00\u4e2a\u6bb5\uff08segment\uff09\uff0c\u4e00\u4e2a\u7d22\u5f15\u4e5f\u8981\u5360\u4e00\u4e2a\u6bb5\uff08segment\u00a0\uff09\u3002\u00a0\u4e00\u4e2a\u6bb5\uff08segment\uff09\u7531\u591a\u4e2a\u00a0\u533a\u95f4\uff08extent\uff09\u7ec4\u6210\uff0c\u90a3\u4e48\u4e00\u4e2a\u533a\u95f4\u53c8\u7531\u4e00\u7ec4\u8fde\u7eed\u7684\u6570\u636e\u5757\uff08data\u00a0block\uff09\u7ec4\u6210\u3002\u8fd9\u8fde\u7eed\u7684\u6570\u636e\u5757\u662f\u5728\u903b\u8f91\u4e0a\u662f\u8fde\u7eed\u7684\uff0c\u6709\u53ef\u80fd\u5728\u7269\u7406\u78c1\u76d8\u4e0a\u662f\u5206\u6563\u3002 \u3000\u3000\u90a3\u4e48\u4ece\u7269\u7406\u7684\u89d2\u5ea6\u4e0a\u770b\uff0c\u4e00\u4e2a\u8868\u7a7a\u95f4\u7531\u591a\u4e2a\u6570\u636e\u6587\u4ef6\u7ec4\u6210\uff0c\u6570\u636e\u6587\u4ef6\u662f\u5b9e\u5b9e\u5728\u5728\u5b58\u5728\u7684\u78c1\u76d8\u4e0a\u7684\u6587\u4ef6\u3002\u8fd9\u4e9b\u6587\u4ef6\u662f\u7531oracle\u6570\u636e\u5e93\u64cd\u4f5c\u7cfb\u7edf\u7684block\u7ec4\u6210\u7684\u3002</p> <p>https://www.cnblogs.com/hmwh/p/14453984.html</p>"},{"location":"oracle/06.%E8%BE%BE%E6%A2%A6%E4%BC%98%E5%8C%96/","title":"\u8fbe\u68a6\u53c2\u6570\u914d\u7f6e","text":"<p>dm.ini\u662f\u8fbe\u68a6\u6700\u57fa\u672c\u7684\u914d\u7f6e\u6587\u4ef6\uff0c\u6bcf\u521b\u5efa\u4e00\u4e2a\u6570\u636e\u5e93\uff0c\u90fd\u4f1a\u751f\u6210\u4e00\u4e2adm.ini\u914d\u7f6e\u6587\u4ef6\u3002dm.ini \u662f DM \u6570\u636e\u5e93\u542f\u52a8\u6240\u5fc5\u987b\u7684\u914d\u7f6e\u6587\u4ef6\uff0c\u7528\u4e8e\u8bbe\u7f6e DM \u6570\u636e\u5e93\u670d\u52a1\u5668\u7684\u5404\u79cd\u529f\u80fd\u548c\u6027\u80fd\u9009\u9879\u3002 \u4e3b\u8981\u7684\u914d\u7f6e\u6a21\u5757\u5305\u62ec\uff1a\u63a7\u5236\u6587\u4ef6\u76f8\u5173\u3001\u6570\u636e\u5e93\u76f8\u5173\u3001\u5185\u5b58\u76f8\u5173\u3001\u7ebf\u7a0b\u76f8\u5173\u7b49\u3002</p> <p>dmarch.ini\u53casqllog.ini\u914d\u7f6e\u6587\u4ef6\u5206\u522b\u4f9d\u8d56\u4e8edm.ini\u4e2d\u7684ARCH_INI\u53caSVR_LOG\uff0c\u9ed8\u8ba4\u5747\u4e0d\u5f00\u542f\uff08\u9ed8\u8ba4\u4e3a0\uff0c\u5f00\u542f\u4e3a1\uff09\u3002\u53ef\u4f7f\u7528\u81ea\u52a8\u5316\u811a\u672c\u6839\u636e\u73b0\u573a\u73af\u5883\u8fdb\u884c\u81ea\u52a8\u4f18\u5316\u3002</p> <p>\u5176\u4e2d\u53c2\u6570\u5206\u624b\u52a8\u3001\u9759\u6001\u3001\u52a8\u6001\u4e09\u7c7b\u3002\u624b\u52a8\u53c2\u6570\u65e0\u6cd5\u52a8\u6001\u4fee\u6539\uff0c\u53ea\u80fd\u4fee\u6539\u914d\u7f6e\u6587\u4ef6\u91cd\u542f\u6570\u636e\u5e93\u751f\u6548\u3002\u9759\u6001\u53c2\u6570\u53ef\u4ee5\u52a8\u6001\u4fee\u6539\uff0c\u4f46\u65e0\u6cd5\u751f\u6548\uff0c\u4ea6\u9700\u91cd\u542f\u751f\u6548\u3002</p> <p>\u52a8\u6001\u53c2\u6570\u53ef\u4ee5\u52a8\u6001\u4fee\u6539\uff0c\u4fee\u6539\u540e\u7acb\u5373\u751f\u6548\uff0c\u6839\u636e\u751f\u6548\u8303\u56f4\u53c8\u5206\u4e3a\u4f1a\u8bdd\u7ea7\u4e0e\u7cfb\u7edf\u7ea7\u3002\u4f1a\u8bdd\u7ea7\u4fee\u6539\u540e\u4f1a\u5f71\u54cd\u5f53\u524d\u4f1a\u8bdd\u53ca\u540e\u7eed\u521b\u5efa\u7684\u4f1a\u8bdd\u3002\u7cfb\u7edf\u7ea7\u4fee\u6539\u540e\u4f1a\u5f71\u54cd\u6240\u6709\u4f1a\u8bdd\u3002</p> <p>\u8fbe\u68a6\u6570\u636e\u5e93\u7684\u53c2\u6570\u6587\u4ef6\uff08\u914d\u7f6e\u6587\u4ef6\uff09\u662f\u4e00\u4e2a\u6587\u672c\u6587\u4ef6\uff0c\u4fdd\u5b58\u5728\u6570\u636e\u6587\u4ef6\u6240\u5728\u76ee\u5f55\u3002 <pre><code>-- \u5728\u6570\u636e\u5e93\u5185\u90e8\u53ef\u4ee5\u4f7f\u7528SQL\u67e5\u770b\u52a8\u6001\u89c6\u56fev$dm_ini\u6765\u67e5\u8be2\u53c2\u6570\u914d\u7f6e\u60c5\u51b5\n-- \u8b6c\u5982\uff1a\u67e5\u770bcompatible_mode\u53c2\u6570\u3002\u5728DM\u4e2d\uff0c\u8fd9\u4e2a\u53c2\u6570\u63a7\u5236\u7740DM\u5bf9\u5176\u4ed6\u5173\u7cfb\u578b\u6570\u636e\u5e93\uff08Oracle\uff0cMySQL\uff09\u7b49\u7684\u517c\u5bb9\u6027\nSELECT PARA_NAME, PARA_VALUE, PARA_TYPE FROM v$dm_ini WHERE para_name LIKE 'COMPA%';\n\n\n-- DM\u6570\u636e\u5e93\u7684INI\u53c2\u6570\uff0c\u90fd\u53ef\u4ee5\u901a\u8fc7\u5982\u4e0b\u65b9\u5f0f\u67e5\u770b\uff0c\u5728DM\u8fbe\u68a6\u6570\u636e\u5e93\u4e2d\uff0c\u67093\u4e2a\u7cfb\u7edf\u51fd\u6570\u53ef\u4ee5\u67e5\u770b\u53c2\u6570\u914d\u7f6e\u60c5\u51b5\u3002\n-- \u5206\u522b\u662fSF_GET_PARA_VALUE\u3001SF_GET_PARA_DOUBLE_VALUE\u548cSF_GET_PARA_STRING_VALUE\u4e09\u4e2a\u51fd\u6570\uff0c\u5206\u522b\u5bf9\u5e94\u53c2\u6570\u503c\u4e3a\u6570\u503c\u7c7b\u578b\u3001\u6d6e\u70b9\u7c7b\u578b\u3001\u5b57\u7b26\u4e32\u7c7b\u578b\u7684\u53c2\u6570\u65f6\u4f7f\u7528\u3002\n\n\nSF_GET_PARA_VALUE(scope int, paraname varchar(256))\nSF_GET_PARA_DOUBLE_VALUE(scope int, paraname varchar(8187))\nSF_GET_PARA_STRING_VALUE(scope int, paraname varchar(8187))\n-- \u5176\u4e2d\uff0cSCOPE\u53c2\u6570\u4e3a1\u8868\u793a\u83b7\u53d6INI\u6587\u4ef6\u4e2d\u914d\u7f6e\u53c2\u6570\u7684\u503c\uff0c\u4e3a2\u8868\u793a\u83b7\u53d6\u5185\u5b58\u4e2d\u914d\u7f6e\u53c2\u6570\u7684\u503c\u3002\n\n-- \u793a\u4f8b\uff1a\u67e5\u770b\u6570\u636e\u5e93\u5b9e\u4f8b\u6700\u5927\u8fde\u63a5\u6570\uff0c\u5728\u6587\u4ef6\u548c\u5185\u5b58\u4e2d\u7684\u914d\u7f6e\u3002\u8fbe\u68a6\u6570\u636e\u5e93\u5b89\u88c5\u9ed8\u8ba4\u8fde\u63a5\u6570\u4e3a100\uff0c\u5b9e\u9645\u9879\u76ee\u4e2d\u53ef\u80fd\u4e0d\u591f\u7528\uff0c\u5982\u4e0b\u662f\u4fee\u6539\u6700\u5927\u8fde\u63a5\u6570\u7684\u65b9\u6cd5\n\nSELECT  SF_GET_PARA_VALUE(2,'MAX_SESSIONS'); -- \u5148\u67e5\u4e00\u4e0b\u5f53\u524d\u6700\u5927\u8fde\u63a5\u6570\uff0c\u770b\u770b\u7ed3\u679c\u662f\u4e0d\u662f\u9ed8\u8ba4\u7684100\n\n\n-- DM\u7684INI\u53c2\u6570\u90fd\u53ef\u4ee5\u901a\u8fc7\u8c03\u7528\u7cfb\u7edf\u8fc7\u7a0bSP_SET_PARA_VALUE/SP_SET_PARA_DOUBLE_VALUE/SP_SET_PARA_STRING_VALUE\u7684\u65b9\u6cd5\u6765\u8fdb\u884c\u4fee\u6539\u6216\u8bbe\u7f6e\u3002\n-- SP_SET_PARA_VALUE\u7684\u4f5c\u7528\u5c31\u662f\u8bbe\u7f6e dm.ini \u6587\u4ef6\u4e2d\u975e\u6d6e\u70b9\u548c\u5b57\u7b26\u4e32\u7c7b\u578b\u7684\u53c2\u6570\u503c\n\n-- \u7b2c\u4e00\u4e2a\u53c2\u6570\uff1ascope\uff1a\u53d6\u503c\u4e3a 1\u30012 \u30021 \u8868\u793a dm.ini \u6587\u4ef6\u548c\u5185\u5b58\u53c2\u6570\u90fd\u4fee\u6539\uff0c\u4e0d\u9700\u8981\u91cd\u542f\u670d\u52a1\u5668\uff1b2 \u8868\u793a\u53ea\u4fee\u6539 dm.ini \u6587\u4ef6\uff0c\u670d\u52a1\u5668\u91cd\u542f\u540e\u751f\u6548\u3002\n-- \u7b2c\u4e8c\u4e2a\u53c2\u6570\uff1a\u5177\u4f53\u8981\u8bbe\u7f6e\u7684dm.ini\u4e2d\u7684\u53c2\u6570\u540d\n-- \u7b2c\u4e09\u4e2a\u53c2\u6570\uff1a\u53c2\u6570\u503c\n\n\n-- \u4e3e\u4f8b\u8bf4\u660e\uff1a\u5c06 dm.ini \u6587\u4ef6\u4e2d HFS_CACHE_SIZE \u53c2\u6570\u503c\u8bbe\u7f6e\u4e3a 320\nSP_SET_PARA_VALUE (1,'HFS_CACHE_SIZE',320);\n</code></pre></p>"},{"location":"oracle/06.%E8%BE%BE%E6%A2%A6%E4%BC%98%E5%8C%96/#_2","title":"\u8fbe\u68a6\u6570\u636e\u8868\u7684\u6570\u636e\u7ed3\u6784","text":"<p>\u8fbe\u68a6\u6570\u636e\u5e93\u5bf9\u4e8e\u884c\u5b58\u6570\u636e\u8868\u652f\u6301 \u7d22\u5f15\u7ec4\u7ec7\u8868 \u548c \u5806\u8868 \u4e24\u79cd\u5f62\u5f0f\uff0c\u4e24\u8005\u7684\u90fd\u6709rowid\u5217\u3002\u9ed8\u8ba4\u5efa\u8868\u662f\u7d22\u5f15\u7ec4\u7ec7\u8868\u3002</p> <p>\u7528\u4e8e\u5728\u6267\u884c\u5176\u4ed6\u7d22\u5f15\u65f6\u5feb\u901f\u5b9a\u4f4d\u6570\u636e(\u4e00\u822c\u4e1a\u52a1\u67e5\u8be2\u4e0d\u4f1a\u4ee5rowid\u5217\u4e3a\u67e5\u8be2\u6761\u4ef6)\uff0c\u4e24\u79cd\u8868\u7684\u533a\u522b\u5728\u4e8e\uff1a</p> <ul> <li>\u8868\u91c7\u7528\u7684\u5b58\u50a8\u65b9\u5f0f\u79f0\u4e3a\u7d22\u5f15\u7ec4\u7ec7\u8868\uff08index organizedtable\uff09\uff0c\u4e5f\u5373 \u8868\u90fd\u662f\u6839\u636e\u4e3b\u952e\u7684\u987a\u5e8f\u6765\u8fdb\u884c\u7ec4\u7ec7\u5b58\u653e\u7684\u3002</li> </ul> <p>\u7d22\u5f15\u7ec4\u7ec7\u8868\uff1a\u5728\u8fbe\u68a6\u6570\u636e\u5e93\u4e2d\u7684\u9ed8\u8ba4\u7684\u8868\u7ec4\u7ec7\u7c7b\u578b\uff0c\u9ed8\u8ba4\u4ee5 B+BTREE \u7684\u6570\u636e\u7ed3\u6784\u6765\u5b58\u653e\u6570\u636e\uff0cROWID\u5217\u662f\u903b\u8f91\u503c \uff0c\u4ece1\u5f00\u59cb\u4e00\u76f4\u589e\u957f\uff0c\u5728\u6570\u636e\u7684\u63d2\u5165\u65f6\u9ed8\u8ba4\u4f1a\u63d2\u5165ROWID\u5217\u503c\uff0c\u6240\u4ee5\u63d2\u5165\u901f\u5ea6\u4f1a\u53d7\u6b64\u5217\u5f71\u54cd\u800c\u53d8\u6162\uff0c\u540c\u65f6\u4e5f\u4f1a\u5360\u7528\u66f4\u591a\u7684\u5b58\u50a8\u7a7a\u95f4\u3002ROWID\u5176\u5b9e\u5c31\u662f\u9690\u5f0f\u81ea\u589e\u5217</p> <p>\u5f53DDL\u8bed\u53e5\u672a\u663e\u5f0f\u521b\u5efa\u805a\u96c6\u7d22\u5f15\uff0c\u5219\u9ed8\u8ba4\u7684\u4f1a\u521b\u5efa\u4e00\u4e2a\u805a\u96c6\u7d22\u5f15\uff08\u8fd9\u4e2a\u7d22\u5f15\u7531\u8fbe\u68a6\u6570\u636e\u5e93\u81ea\u52a8\u7ef4\u62a4\uff09\uff0c\u5176\u7d22\u5f15\u952e\u662fROWID\uff0c\u5373\u8bb0\u5f55\u9ed8\u8ba4\u4ee5 ROWID\u5728\u9875\u9762\u4e2d\u6392\u5e8f\u3002ROWID \u662f\u8fbe\u68a6\u4e3a B \u6811\u4e3a\u8bb0\u5f55\u751f\u6210\u7684\u903b\u8f91\u9012\u589e\u5e8f\u53f7\uff0c\u8868\u4e0a\u4e0d\u540c\u8bb0\u5f55\u7684 ROWID \u662f\u4e0d\u4e00\u6837\u7684\uff0c\u5e76\u4e14\u6700\u65b0\u63d2\u5165\u7684\u8bb0\u5f55 ROWID \u6700\u5927\u3002</p> <p>\u5f88\u591a\u60c5\u51b5\u4e0b\uff0c\u4ee5 ROWID \u5efa\u7684\u9ed8\u8ba4\u805a\u96c6\u7d22\u5f15\u5e76\u4e0d\u80fd\u63d0\u9ad8\u67e5\u8be2\u901f\u5ea6\uff0c\u56e0\u4e3a\u5b9e\u9645\u60c5\u51b5\u4e0b\u5f88\u5c11\u4eba\u6839\u636e ROWID\u6765\u67e5\u627e\u6570\u636e\u3002</p> <p>\u56e0\u6b64\uff0cDM \u63d0\u4f9b\u4e09\u79cd\u65b9\u5f0f\u4f9b\u7528\u6237\u6307\u5b9a\u805a\u96c6\u7d22\u5f15\u952e\uff1a</p> <ol> <li>CLUSTER PRIMARY KEY\uff1a\u6307\u5b9a\u5217\u4e3a\u805a\u96c6\u7d22\u5f15\u952e\uff0c\u5e76\u540c\u65f6\u6307\u5b9a\u4e3a\u4e3b\u952e\uff0c\u79f0\u4e3a\u805a\u7c07\u4e3b\u952e\uff1b</li> <li>CLUSTER KEY\uff1a\u6307\u5b9a\u5217\u4e3a\u805a\u96c6\u7d22\u5f15\u952e\uff0c\u4f46\u662f\u662f\u975e\u552f\u4e00\u7684\uff1b</li> <li>CLUSTER UNIQUE KEY\uff1a\u6307\u5b9a\u5217\u4e3a\u805a\u96c6\u7d22\u5f15\u952e\uff0c\u5e76\u4e14\u662f\u552f\u4e00\u7684\u3002</li> </ol>"},{"location":"oracle/06.%E8%BE%BE%E6%A2%A6%E4%BC%98%E5%8C%96/#_3","title":"\u805a\u96c6\u7d22\u5f15\u548c\u975e\u805a\u96c6\u7d22\u5f15","text":"<ul> <li> <p>\u4e3b\u952e\uff1a\u4e3b\u952e\u662f\u4e00\u79cd\u57fa\u4e8e\u5173\u7cfb\u6a21\u578b\u6765\u5b9a\u4e49\u7684\u903b\u8f91\u7ea6\u675f\u3002\u5373\u6574\u4e2aSQL\u8868\u4e2d\uff0c\u4e0d\u80fd\u5b58\u5728\u91cd\u590d\u7684\u4e3b\u952e\u5217\uff08\u4e00\u5217\u6216\u591a\u5217\uff09\uff0c\u4e3b\u952e\u7684\u4f5c\u7528\u66f4\u4fa7\u91cd\u4e8e\u4e0d\u91cd\u590d\u3002</p> </li> <li> <p>\u5728\u8fbe\u68a6\u6570\u636e\u5e93\u4e2d\uff0c\u4e3b\u952e\u7ea6\u675f\u662f\u901a\u8fc7\u521b\u5efa**\u552f\u4e00\u7d22\u5f15**\u6765\u5b9e\u73b0\u7684\u3002</p> <pre><code>-- \u901a\u8fc7 CLUSTER \u6216 NOT CLUSTER \u5173\u952e\u5b57\u6765\u6307\u660e\u521b\u5efa\u7d22\u5f15\u7684\u7c7b\u578b\u3002\n    -- CLUSTER       \u6307\u660e\u8be5\u4e3b\u952e\u662f\u521b\u5efa\u5728\u805a\u96c6\u7d22\u5f15\u4e0a\u7684\n    -- NOT CLUSTER   \u6307\u660e\u8be5\u4e3b\u952e\u662f\u521b\u5efa\u5728\u975e\u805a\u96c6\u7d22\u5f15\u4e0a\u7684\n</code></pre> </li> <li> <p>\u7d22\u5f15\uff1a\u7d22\u5f15\u662f\u4e00\u79cd\u6570\u636e\u7ed3\u6784\u3002\u6bd4\u5982\u4ee5\u67d0\u5217\u4e3a\u805a\u96c6\u7d22\u5f15\uff08\u5373\u4ee5\u67d0\u5217\u4e3a\u7d22\u5f15\u8282\u70b9\u6784\u6210\u7684 B+BTREE \u6570\u636e\u7ed3\u6784\uff09\uff0c\u7d22\u5f15\u7684\u4f5c\u7528\u66f4\u4fa7\u91cd\u4e8e\u6570\u636e\u6392\u5e8f\u3002</p> </li> </ul> <p>\u4ece\u7269\u7406\u5b58\u50a8\u89d2\u5ea6\u8fdb\u884c\u5206\u7c7b\uff0c\u53ef\u5206\u4e3a\u805a\u96c6\u7d22\u5f15\u548c\u975e\u805a\u96c6\u7d22\u5f15\u3002</p> <ul> <li> <p>\u805a\u96c6\u7d22\u5f15\uff1a\u6574\u4e2a\u7d22\u5f15\u7ec4\u7ec7\u8868\u7684 B+BTREE \u6570\u636e\u7ed3\u6784\uff0c\u90fd\u6309\u7167\u7d22\u5f15\u952e\u6765\u6784\u5efa\u7684\u3002\u5b83\u5b9a\u4e49\u4e86\u6570\u636e\u7684\u7269\u7406\u5b58\u50a8\u987a\u5e8f\u3002\u6574\u4e2a\u8868\u7684\u7269\u7406\u5b58\u50a8\u662f\u6309\u7167\u805a\u96c6\u7d22\u5f15\u952e\u6784\u9020\u4e00\u68f5 B+ \u6811\uff0c\u8868\u6570\u636e\u5b58\u50a8\u5728 B+ \u6811\u53f6\u5b50\u8282\u70b9\u4e0a\uff0c\u901a\u8fc7\u5b9a\u4f4d\u7d22\u5f15\u53ef\u76f4\u63a5\u5728 B+ \u6811\u4e2d\u627e\u5230\u6570\u636e\u3002\u6bcf\u5f20\u8868\u6709\u4e14\u53ea\u6709\u4e00\u4e2a\u805a\u96c6\u7d22\u5f15\u3002</p> </li> <li> <p>\u975e\u805a\u96c6\u7d22\u5f15\uff1a**\u5c06\u4e8c\u7ea7\u7d22\u5f15\u5217\u548c\u805a\u96c6\u7d22\u5f15\u5217\u5171\u540c\u5b58\u50a8\u5728 B+ \u6811\u53f6\u5b50\u8282\u70b9\u4e0a\u3002\u5982\u679c\u67e5\u627e\u975e\u805a\u96c6\u7d22\u5f15\u952e\u503c\u6216\u805a\u96c6\u7d22\u5f15\u952e\u503c\u53ef\u76f4\u63a5\u5728 B+ \u6811\u4e2d\u627e\u5230\uff1b\u5982\u679c\u67e5\u627e\u7d22\u5f15\u952e\u503c\u4ee5\u5916\u7684\u6570\u636e\uff0c\u5219\u9700\u8981\u56de\u5230\u4e00\u7ea7\u7d22\u5f15\u4e2d\u8fdb\u884c\u67e5\u627e\u3002**\u6bcf\u5f20\u8868\u53ef\u4ee5\u6709\u591a\u4e2a\u975e\u805a\u96c6\u7d22\u5f15\u3002</p> </li> </ul> <p>\u5728\u5173\u7cfb\u6570\u636e\u5e93\u4e2d\uff0c\u7d22\u5f15\u548c\u4e3b\u952e\u662f\u4e24\u4e2a\u6982\u5ff5\u3002\u53ea\u662fMySQL\u4e2d\u4e00\u822c\u628a\u805a\u96c6\u7d22\u5f15\u548c\u4e3b\u952e\u505a\u4e3a\u540c\u4e49\u8bcd\u4e86\uff0cMySQL\u9ed8\u8ba4\u4f1a\u4ee5\u4e3b\u952e\u521b\u5efa\u4e00\u9897\u805a\u96c6\u7d22\u5f15\u6811\u6765\u5b58\u50a8\u6570\u636e\u3002</p> <p>\u6ce8\u610f\uff1a\u5728\u8fbe\u68a6\u4e2d\uff0c\u805a\u96c6\u7d22\u5f15\u548c\u4e3b\u952e\u662f\u4e24\u4e2a\u6982\u5ff5\uff0c\u7528\u4e8e\u4e0d\u540c\u7684\u76ee\u7684\u3002</p> <ul> <li>\u4e3b\u952e\u7684\u4f5c\u7528\u66f4\u4fa7\u91cd\u4e8e\u6570\u636e\u4e0d\u91cd\u590d\u3002\u5b83\u662f\u4f20\u7edf\u5173\u7cfb\u578b\u6570\u636e\u5e93\u4e0a\u8bbe\u8ba1\u7684\u903b\u8f91\u4e1a\u52a1\u9700\u6c42\uff08\u552f\u4e00\uff09</li> <li>\u7d22\u5f15\u7684\u4f5c\u7528\u66f4\u4fa7\u91cd\u4e8e\u6570\u636e\u6392\u5e8f\u3002\u5b83\u662f\u5b9a\u4e49\u6570\u636e\u7269\u7406\u4e0a\u7684\u6570\u636e\u7ed3\u6784\u3002</li> </ul> <pre><code>-- \uff08\u7d22\u5f15\u7ec4\u7ec7\u8868\uff09\u6bcf\u4e2a\u8868\u53ea\u6709\u4e00\u4e2a\u805a\u96c6\u7d22\u5f15\uff1a\u4e8c\u53c9\u6811\u7ed3\u6784\u53ea\u80fd\u6309\u7167\u4e00\u4e2a\u7d22\u5f15\u952e\u6765\u6392\u5e8f\n\n------------------------------------------------------------------------------------------------------------------------\n-- DDL \uff08\u5982\u679c\u4ec5\u521b\u5efa\u4e1a\u52a1\u5b57\u6bb5\uff0c\u8fbe\u68a6\u5185\u90e8\u4f1a\u81ea\u52a8\u751f\u6210ROWID\u6765\u505a\u4e3a\u9690\u5f0f\u4e3b\u952e\uff09\nCREATE TABLE users(\n    id BIGINT,\n    C1 INT,\n    C2 int,\n    C3 VARCHAR(20),\n    C4 VARCHAR(20)\n);\n\n-- \u67e5\u8be2\u6b64\u8868\u4e0a\u7684\u7d22\u5f15\uff1a\u53ef\u4ee5\u770b\u5230\u8fbe\u68a6\u9ed8\u8ba4\u4f1a\u521b\u5efa\u4e00\u4e2a\u968f\u673a\u540d\u79f0\u7684\u805a\u96c6\u7d22\u5f15\u3002\u7d22\u5f15\u7c7b\u578b\u662fCLUSTER\nSELECT * FROM DBA_INDEXES idx \n    WHERE  idx.owner='QHDATA_TEST' AND  idx.table_name='users';\n\n-- \u7528\u6237\u624b\u52a8\u5728\u8be5\u8868\u6dfb\u52a0\u805a\u96c6\u7d22\u5f15\uff08\u4ee5id\u4e3a\u7d22\u5f15\u952e\uff09\u540e\uff0c\u8be5\u9ed8\u8ba4\u805a\u96c6\u7d22\u5f15\u5219\u4f1a\u81ea\u52a8\u5220\u9664\u3002\u8fd9\u4e2a\u7528\u6237\u521b\u5efa\u805a\u96c6\u7d22\u5f15\u662f\u53ef\u4ee5\u5220\u9664\u7684\uff0c\u5982\u679c\u5220\u9664\u540e\u539f\u5148\u7684\u805a\u96c6\u7d22\u5f15\u4f1a\u81ea\u52a8\u6062\u590d\u3002\nCREATE CLUSTER INDEX idx_users_id  on QHDATA_TEST.\"users\"(id);\n\n-- \u5982\u679c\u76f4\u63a5\u5728\u8be5\u8868\u4e0a\u57fa\u4e8e\u5176\u4ed6\u8868\u521b\u5efa\u805a\u96c6\u7d22\u5f15\uff0c\u5219\u76f4\u63a5\u8986\u76d6\u524d\u9762\u7684\u3002\nCREATE CLUSTER INDEX idx_users_index  on QHDATA_TEST.\"users\"(id);\n\n-- \u67e5\u8be2\u6b64\u7d22\u5f15\u7684DDL\u8bed\u53e5\nSELECT dbms_metadata.get_ddl(OBJECT_TYPE =&gt; 'INDEX',NAME=&gt;upper('idx_users_id'),SCHNAME =&gt; 'QHDATA_TEST');\n\n-- \u7d22\u5f15DDL\u8bed\u53e5\nCREATE OR REPLACE CLUSTER  INDEX \"QHDATA_TEST\".\"idx_users_id\" ON \"QHDATA_TEST\".\"users\"(\"id\" ASC) STORAGE(ON \"MAIN\", CLUSTERBTR) ;\n------------------------------------------------------------------------------------------------------------------------\n\n\n------------------------------------------------------------------------------------------------------------------------\n-- \u521b\u5efa\u57fa\u4e8e\u4e3b\u952e\u7684\u805a\u96c6\u7d22\u5f15\uff1aPRIMARY KEY\u4e3b\u952e\u5b9a\u4e49\u7684\u4f5c\u7528\u662f\u8868\u793a\u6570\u636e\u552f\u4e00\uff0cCLUSTER\u8868\u793a\u57fa\u4e8e\u8fd9\u4e2a\u4e3b\u952e\u5217\u7684\u805a\u96c6\u7d22\u5f15\nCREATE  TABLE  STUDENT1( \n    STUNO     INT           CLUSTER PRIMARY KEY, \n    STUNAME   VARCHAR(15)   NOT NULL, \n    TEANO     INT, \n    CLASSID   INT\n);\n\n-- \u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u8fbe\u68a6\u7684dm.ini\u4e2dPK_WITH_CLUSTER\u53c2\u6570\u4e3a1\uff0c\u5373\u5efa\u8868\u65f6\u6307\u5b9a\u7684\u4e3b\u952e\u4f1a\u81ea\u52a8\u8f6c\u5316\u4e3a\u805a\u96c6\u4e3b\u952e\n-- \u4e3b\u952e\u8bed\u53e5\u4e2d\u4e0d\u5e26CLUSTER\u5173\u952e\u5b57\uff0c\u8fd9\u4e0e\u4e0a\u9762\u662f\u540c\u4e49\u7684\u3002  \nCREATE  TABLE  STUDENT2( \n    STUNO     INT           PRIMARY KEY, \n    STUNAME   VARCHAR(15)   NOT NULL, \n    TEANO     INT, \n    CLASSID   INT\n);\n\n\n-- \u67e5\u770b\u8fd9\u4e2a\u7d22\u5f15\uff08\u57fa\u4e8e\u4e3b\u952e\u5217\u7684\u7d22\u5f15\u7ec4\u7ec7\u8868B+TREE\u6570\u636e\u7ed3\u6784\uff09\nSELECT * from DBA_INDEXES idx WHERE  idx.owner='QHDATA_TEST' AND  idx.table_name='STUDENT2';\n\n-- \u67e5\u770b\u7d22\u5f15\u5b9a\u4e49\uff08NAME\u57fa\u4e8e\u4e0a\u9762\u67e5\u8be2\u5f97\u6765\uff09\nSELECT dbms_metadata.get_ddl(OBJECT_TYPE =&gt; 'INDEX',NAME=&gt;upper('INDEX33625894'),SCHNAME =&gt; 'QHDATA_TEST');\n\n-- \u7d22\u5f15\u5b9a\u4e49\u8bed\u53e5\uff1a CLUSTER UNIQUE  INDEX \uff0c \u552f\u4e00\u7684\u805a\u96c6\u7d22\u5f15\nCREATE OR REPLACE CLUSTER UNIQUE  INDEX \"QHDATA_TEST\".\"INDEX33625893\" ON \"QHDATA_TEST\".\"STUDENT1\"(\"STUNO\" ASC) STORAGE(ON \"MAIN\", CLUSTERBTR) ;\n\nCREATE OR REPLACE CLUSTER UNIQUE  INDEX \"SYSDBA\".\"INDEX33625920\" ON \"SYSDBA\".\"STUDENT1\"(\"STUNO\" ASC) STORAGE(ON \"MAIN\", CLUSTERBTR) ;\nCREATE OR REPLACE CLUSTER UNIQUE  INDEX \"SYSDBA\".\"INDEX33625921\" ON \"SYSDBA\".\"STUDENT2\"(\"STUNO\" ASC) STORAGE(ON \"MAIN\", CLUSTERBTR) ;\n------------------------------------------------------------------------------------------------------------------------\n\n\n-- CLUSTER PRIMARY KEY          \u4e3b\u952e\u7ea6\u675f\uff0c\u6307\u660e\u6307\u5b9a\u5217\u4f5c\u4e3a\u57fa\u8868\u7684\u805a\u96c6\u7d22\u5f15\uff08\u4e5f \u53eb\u805a\u7c07\u7d22\u5f15\uff09\u548c\u4e3b\u5173\u952e\u5b57\uff1b\n-- PRIMARY KEY                  \u4e3b\u952e\u7ea6\u675f\uff0c\u6307\u660e\u6307\u5b9a\u5217\u4f5c\u4e3a\u57fa\u8868\u7684\u4e3b\u5173\u952e\u5b57\uff08\u5f53PK_WITH_CLUSTER \u4e3a0\u65f6\uff0c\u5373\u5efa\u8868\u65f6\u6307\u5b9a\u7684\u4e3b\u952e\u4e0d\u4f1a\u81ea\u52a8\u8f6c\u5316\u4e3a\u805a\u96c6\u4e3b\u952e\uff1b\u82e5\u4e3a 1\uff0c\u5219\u4e3b\u952e\u81ea\u52a8\u53d8\u4e3a\u805a\u96c6\u4e3b\u952e\u3002\uff09\uff1b\n-- \u8fd9\u4e24\u4e2a\u7b49\u4ef7\uff0c\u90fd\u662f CLUSTER UNIQUE  INDEX\n\n-- CLUSTER KEY                  \u6307\u5b9a\u5217\u4e3a\u805a\u96c6\u7d22\u5f15\u952e\uff0c\u4f46\u662f\u8fd9\u4e2a\u5217\u662f\u975e\u552f\u4e00\u7684\u5b57\u6bb5\uff1b\nCREATE OR REPLACE CLUSTER  INDEX \"SYSDBA\".\"INDEX33625905\" ON \"QHDATA_TEST\".\"STUDENT4\"(\"id\" ASC) STORAGE(ON \"MAIN\", CLUSTERBTR) ;\n\n-- NOT CLUSTER PRIMARY KEY      \u4e3b\u952e\u7ea6\u675f\uff0c\u6307\u660e\u6307\u5b9a\u5217\u4f5c\u4e3a\u57fa\u8868\u7684\u975e\u805a\u96c6\u7d22\u5f15\u4e3b\u5173\u952e\u5b57\u3002\u8fd9\u4e2a\u4f1a\u521b\u5efa\u4e24\u4e2a\u7d22\u5f15\uff1a\n-- \u57fa\u4e8e\u8fd9\u4e2a\u5217\u7684\u552f\u4e00\u7d22\u5f15 \u548c  \u57fa\u4e8eROWID\u7684\u805a\u96c6\u7d22\u5f15\nCREATE OR REPLACE UNIQUE  INDEX \"SYSDBA\".\"INDEX33625915\" ON \"SYSDBA\".\"STUDENT5\"(\"id\" ASC) STORAGE(ON \"MAIN\", CLUSTERBTR) ;\nCREATE OR REPLACE CLUSTER INDEX \"SYSDBA\".\"INDEX33625914\" ON \"SYSDBA\".\"STUDENT5\"( STORAGE(ON \"MAIN\", CLUSTERBTR) ;\n\n-- CLUSTER UNIQUE KEY       \u6307\u5b9a\u5217\u4e3a\u805a\u96c6\u7d22\u5f15\u952e\uff0c\u5e76\u4e14\u662f\u552f\u4e00\u7684\uff1b\n</code></pre>"},{"location":"oracle/06.%E8%BE%BE%E6%A2%A6%E4%BC%98%E5%8C%96/#_4","title":"\u8fbe\u68a6\u6267\u884c\u8ba1\u5212","text":"<p>SQL \u7684\u6838\u5fc3\u662f\u4e00\u79cd\u63cf\u8ff0\u6027\u8bed\u8a00\uff0c\u4f7f\u7528\u8005\u53ea\u9700\u5b9a\u4e49\u6240\u9700\u7684\u6570\u636e\u53ca\u6570\u636e\u7684\u83b7\u53d6\u65b9\u5f0f\u7531\u4f18\u5316\u5668\u6765\u51b3\u5b9a\u3002</p> <p>\u53ef\u4ee5\u8bf4\uff0c\u6267\u884c\u5f15\u64ce\u76f8\u5f53\u4e8e\u6c7d\u8f66\u7684\u53d1\u52a8\u673a\uff0c\u800c\u67e5\u8be2\u4f18\u5316\u5668\u5219\u662f\u65b9\u5411\u76d8\u3002\u82e5\u6ca1\u6709\u5408\u9002\u7684\u4f18\u5316\u5668\u6307\u5f15\uff0c\u518d\u5f3a\u5927\u7684\u5f15\u64ce\u4e5f\u53ef\u80fd\u5bfc\u81f4\u6211\u4eec\u5728\u9ad8\u901f\u884c\u9a76\u4e2d\u649e\u4e0a\u5185\u5b58\u6ea2\u51fa\u7684\u969c\u788d</p> <p>\u56e0\u6b64\uff0c\u4f18\u5316\u5668\u662f SQL \u4e2d\u6781\u4e3a\u5173\u952e\u7684\u7ec4\u4ef6\u3002</p> <p>\u6570\u636e\u5e93\u7ba1\u7406\u7cfb\u7edf\u7684\u4f18\u5316\u5668\u662f\u51b3\u5b9a SQL \u6267\u884c\u6027\u80fd\u7684\u5173\u952e\u3002DM \u91c7\u7528\u57fa\u4e8e\u4ee3\u4ef7\u7684\u4f18\u5316\u5668\uff0c\u670d\u52a1\u5668\u63a5\u6536\u5230 SQL \u8bed\u53e5\u540e\uff0c\u7ecf\u8fc7\u8bed\u6cd5\u5206\u6790\u548c\u8bed\u4e49\u5206\u6790\uff0c\u4e4b\u540e\u8fdb\u884c\u5404\u79cd\u5173\u7cfb\u4ee3\u6570\u8f6c\u6362\uff0c\u5f62\u6210\u4e00 \u7cfb\u5217\u5907\u9009\u7684\u903b\u8f91\u6267\u884c\u8ba1\u5212\u3002DM \u4f18\u5316\u5668\u901a\u8fc7\u5bf9\u8fd9\u4e9b\u5907\u9009\u903b\u8f91\u8ba1\u5212\u8fdb\u884c\u4ee3\u4ef7\u4f30\u7b97\u548c\u4f18\u5316\uff0c\u6700\u7ec8 \u751f\u6210\u4e00\u4e2a\u6700\u4f18\u7684\u7269\u7406\u6267\u884c\u8ba1\u5212\uff0c\u4ea4\u7531\u6267\u884c\u5668\u6267\u884c\u3002</p> <p>\u4f18\u5316\u5668\u5de5\u4f5c\u6d41\u7a0b\u524d\u9762\u8bf4\u7684\u201c\u751f\u6210\u4e00\u4e2a\u6700\u4f18\u7684\u7269\u7406\u6267\u884c\u8ba1\u5212\u201d\u53ea\u662f\u4e00\u4e2a\u76f8\u5bf9\u7684\u6982\u5ff5\uff0c\u8ba1\u7b97\u51fa\u4e00\u4e2a\u4e0e\u5b9e\u9645\u6267 \u884c\u76f8\u63a5\u8fd1\u7684\u4ee3\u4ef7\u503c\u662f\u4e00\u4ef6\u56f0\u96be\u7684\u4e8b\u3002\u5f71\u54cd\u5b9e\u9645\u6267\u884c\u4ee3\u4ef7\u7684\u56e0\u7d20\u975e\u5e38\u591a\uff0c\u4f18\u5316\u5668\u4e0d\u53ef\u80fd\u4e5f\u6ca1\u6709 \u5fc5\u8981\u975e\u5e38\u5168\u9762\u5730\u8003\u8651\u6bcf\u4e00\u4e2a\u7ec6\u8282\uff0c\u5982\u7cfb\u7edf\u5c01\u9501\uff0c\u5e76\u53d1\u7b49\u56e0\u7d20\u3002DM \u4f18\u5316\u5668\u4e3b\u8981\u5173\u6ce8\u7684\u662f\u6267\u884c \u67e5\u8be2\u6240\u6d89\u53ca\u7684\u8868\u7684\u8bb0\u5f55\u884c\u6570\uff0c\u6570\u636e\u9875\u7684\u6570\u91cf\uff0c\u53ef\u5229\u7528\u7684\u7d22\u5f15\u548c\u7edf\u8ba1\u4fe1\u606f\uff0c\u4ee5\u53ca\u5185\u5b58\uff0cIO \u548c CPU \u7684\u8ba1\u7b97\u91cf\u7b49\u3002</p> <p>\u6267\u884c\u8ba1\u5212\u5206\u4e3a**\u9884\u4f30\u6267\u884c\u8ba1\u5212**\u548c**\u5b9e\u9645\u6267\u884c\u8ba1\u5212**\u3002</p> <p>\u5982\u4f55\u67e5\u770b\u6267\u884c\u8ba1\u5212\uff1f</p> <p>\u5f00\u53d1\u4eba\u5458\u53ea\u5173\u5fc3 SQL \u8bed\u53e5\u80fd\u5426\u8fd4\u56de T1 \u4e0e T2 \u8868\u7684\u5173\u8054\u67e5\u8be2\u7ed3\u679c\uff0c\u4e0d\u9700\u8981\u6307\u5b9a\u8be5 SQL \u5982\u4f55\u6267\u884c\uff0c\u4e5f\u5c31\u662f\u8bf4\u4e0d\u5173\u5fc3\u8be5 SQL \u662f\u5148\u8bbf\u95ee T1 \u8868\u8fd8\u662f\u5148\u8bbf\u95ee T2 \u8868\u3002</p> <p>\u5bf9\u4e8e SQL \u6765\u8bf4\uff0c\u4e24\u79cd\u8bbf\u95ee\u65b9\u5f0f\u5c31\u662f\u4e24\u4e2a\u6267\u884c\u8ba1\u5212\uff0c\u67e5\u8be2\u4f18\u5316\u5668 (CBO) \u5c06\u6839\u636e\u4ee3\u4ef7\u4e5f\u5c31\u662f\u5f00\u9500\u6765\u9009\u62e9\u6700\u4f18\u7684\u6267\u884c\u8ba1\u5212\u3002</p> <p>\u9884\u4f30\u6267\u884c\u8ba1\u5212</p> <ul> <li> <p>\u8fbe\u68a6\u5ba2\u6237\u7aef\u76f4\u63a5\u70b9\u51fb\u83dc\u5355\u680f\u6309\u94ae\u6216\u6309F9\u751f\u6210</p> </li> <li> <p>\u5728 SQL \u8bed\u53e5\u524d\u9762\u52a0\u4e0a EXPLAIN </p> </li> </ul> \u52a8\u4f5c \u4f7f\u7528\u805a\u7c07\u7d22\u5f15 \u4f7f\u7528\u975e\u805a\u7c07\u7d22\u5f15 \u5217\u7ecf\u5e38\u88ab\u5206\u7ec4\u6392\u5e8f \u5e94 \u5e94 \u8fd4\u56de\u67d0\u8303\u56f4\u5185\u7684\u6570\u636e \u5e94 \u4e0d\u5e94 \u4e00\u4e2a\u6216\u6781\u5c11\u4e0d\u540c\u503c \u4e0d\u5e94 \u4e0d\u5e94 \u5c0f\u6570\u76ee\u7684\u4e0d\u540c\u503c \u5e94 \u4e0d\u5e94 \u5927\u6570\u76ee\u7684\u4e0d\u540c\u503c \u4e0d\u5e94 \u5e94 \u9891\u7e41\u66f4\u65b0\u7684\u5217 \u4e0d\u5e94 \u5e94 \u5916\u952e\u5217 \u5e94 \u5e94 \u4e3b\u952e\u5217 \u5e94 \u5e94 \u9891\u7e41\u4fee\u6539\u7d22\u5f15\u5217 \u4e0d\u5e94 \u5e94 <p>\u6267\u884c\u8ba1\u5212\u64cd\u4f5c\u7b26\uff0c\u53ef\u4ee5\u53c2\u8003\u8fbe\u68a6\u5b98\u65b9\u64cd\u4f5c\u624b\u518c</p> <p>\u64cd\u4f5c\u7b26\uff1a</p> <ul> <li>NSET2 \u7ed3\u679c\u6536\u96c6 \u6267\u884c\u8ba1\u5212\u6700\u9876\u5c42\u64cd\u4f5c\u7b26</li> <li>PRJT2 \u6295\u5f71</li> <li>SLCT2 \u9009\u62e9 \u8868\u793a\u8fc7\u6ee4</li> <li>FAGR2 \u5feb\u901f\u805a\u96c6 select count(*) from \u8868; \u4f1a\u81ea\u52a8\u8d70\u8fd9\u4e2a\u6267\u884c\u8ba1\u5212</li> <li>CSCN2 \u5168\u8868\u626b\u63cf cluster index scan \u7684\u7f29\u5199\uff0c\u8fbe\u68a6\u9ed8\u8ba4\u521b\u5efa\u7684\u8868\u662f\u7d22\u5f15\u7ec4\u7ec7\u8868</li> <li>AAGR2 \u805a\u96c6 \u7528\u4e8e\u65e0group by\u7684count,sum,max,min,avg\u8fd0\u7b97</li> <li>HAGR2 \u5206\u7ec4\u805a\u96c6 \u7528\u4e8e\u5168\u8868\u626b\u63cfGROUP BY\u805a\u96c6</li> <li>BLKUP2 \u56de\u8868</li> <li>SSEK2 \u4e8c\u7ea7\u7d22\u5f15\u626b\u63cf</li> <li>SSCN \u7d22\u5f15\u5168\u626b\u63cf\u4e0d\u56de\u8868</li> <li> <p>CSEK2 \u805a\u96c6\u7d22\u5f15\u626b\u63cf\u4e0d\u56de\u8868</p> </li> <li> <p>NSET\uff1a\u7ed3\u679c\u96c6\u6536\u96c6\uff1aNSET \u662f\u7528\u4e8e\u7ed3\u679c\u96c6\u6536\u96c6\u7684\u64cd\u4f5c\u7b26\uff0c\u4e00\u822c\u662f\u67e5\u8be2\u8ba1\u5212\u7684\u9876\u5c42\u8282\u70b9\uff0c\u4f18\u5316\u5de5\u4f5c\u4e2d\u65e0\u9700\u5bf9\u8be5\u64cd\u4f5c\u7b26\u8fc7\u591a\u5173\u6ce8\uff0c\u4e00\u822c\u6ca1\u6709\u4f18\u5316\u7a7a\u95f4\u3002</p> </li> <li>PRJT\uff1a\u6295\u5f71\uff1a</li> <li> <p>SLCT\uff1a\u9009\u62e9\uff1a</p> </li> <li> <p>\u8868\u67e5\u627e\u64cd\u4f5c\u7b26</p> </li> <li>SSEK2\uff1a \u662f\u4e8c\u7ea7\u7d22\u5f15\u626b\u63cf\u5373\u5148\u626b\u63cf\u7d22\u5f15\uff0c\u518d\u901a\u8fc7\u4e3b\u952e\u3001\u805a\u96c6\u7d22\u5f15\u3001rowid \u7b49\u4fe1\u606f\u53bb\u626b\u63cf\u8868\u3002</li> <li>BLKUP \uff1a\u56de\u8868\uff1a\u6839\u636e\u4e8c\u7ea7\u7d22\u5f15\u7684ROWID \u56de\u539f\u8868\u4e2d\u53d6\u51fa\u5168\u90e8\u6570\u636e(b + a)</li> <li>CSEK2\uff1a \u662f\u805a\u96c6\u7d22\u5f15\u626b\u63cf\u3002\u53ea\u9700\u8981\u626b\u63cf\u7d22\u5f15\uff0c\u4e0d\u9700\u8981\u626b\u63cf\u8868\uff0c\u5373\u65e0\u9700 BLKUP \u64cd\u4f5c\uff0c\u5982\u679c BLKUP \u5f00\u9500\u8f83\u5927\u65f6\uff0c\u53ef\u8003\u8651\u521b\u5efa\u805a\u96c6\u7d22\u5f15\u3002<ul> <li>CLUSTER_INDEX_SEEK \uff1a\u805a\u96c6\u7d22\u5f15\u67e5\u627e\uff1a\u6bd4\u5982  <code>select cluster_column from table where cluster_column = '123'</code></li> </ul> </li> <li> <p>CLUSTER SCAN :    \u805a\u96c6\u7d22\u5f15\u5168\u626b\u63cf\uff1a\u6bd4\u5982\u76f4\u63a5\u67e5\u5168\u90e8\u7684\u805a\u96c6\u7d22\u5f15\u5217 <code>select cluster_column from table</code></p> </li> <li> <p>**SSCN\uff1a**\u662fSecond Index scan\uff0c\u5373\u4e8c\u7ea7\u7d22\u5f15\u5168\u626b\u63cf\uff0c\u4e0d\u9700\u8981\u626b\u63cf\u8868\u3002\u6bd4\u5982 <code>second index scan</code></p> </li> <li> <p>**CSCN: **CSCN2\u662fCLUSTER INDEX SCAN\u7684\u7f29\u5199\u5373\u901a\u8fc7\u805a\u96c6\u7d22\u5f15\u626b\u63cf\u5168\u8868\uff0c\u5168\u8868\u626b\u63cf\u662f\u6700\u7b80\u5355\u7684\u67e5\u8be2\uff0c\u5982\u679c\u6ca1\u6709\u9009\u62e9\u8c13\u8bcd\uff0c\u6216\u8005\u6ca1\u6709\u7d22\u5f15\u53ef\u4ee5\u5229\u7528\uff0c\u5219\u7cfb\u7edf\u4e00\u822c\u53ea\u80fd\u505a\u5168\u8868\u626b\u63cf\u3002</p> </li> </ul> <pre><code>CREATE TABLE \"qhdata_warehouse\".\"dw_addr_admin_area_code\"  (\n    \"rid\" INT NOT NULL,\n    \"update_time\" TIMESTAMP(0) DEFAULT CURRENT_TIMESTAMP() NOT NULL,\n    \"start_time\" DATE,\n    \"end_time\" DATE,\n    \"version_num\" INT NOT NULL,\n    \"lng_lat_GCJ02\" VARCHAR(100),\n    \"lng_lat_GCJ02_md5\" VARCHAR(64) NOT NULL,\n    \"UA0003\" VARCHAR(100),\n    \"UA0004\" VARCHAR(100),\n    \"UA0005\" VARCHAR(100),\n    \"UA0006\" VARCHAR(100),\n    \"UA0007\" VARCHAR(100),\n    \"UA0008\" VARCHAR(100),\n    \"code_version\" VARCHAR(100),\n    \"addr_code\" VARCHAR(600),\n    \"check_md5\" VARCHAR(64),\n    \"deal_ind\" INT,\n    UNIQUE(\"lng_lat_GCJ02_md5\")\n) STORAGE(ON \"MAIN\", CLUSTERBTR);\n\n-- \u805a\u96c6\u7d22\u5f15\nCREATE OR REPLACE CLUSTER  INDEX \"qhdata_warehouse\".\"INDEX_RID_111\" ON \"qhdata_warehouse\".\"dw_addr_admin_area_code\"(\"rid\" ASC) STORAGE(ON \"MAIN\", CLUSTERBTR);\n\n-- \u552f\u4e00\u7d22\u5f15\nCREATE OR REPLACE UNIQUE  INDEX \"qhdata_warehouse\".\"INDEX177922827890000\" ON \"qhdata_warehouse\".\"dw_addr_admin_area_code\"(\"rid\" ASC) STORAGE(ON \"MAIN\", CLUSTERBTR);\n\n\n-- \u57fa\u4e8eUA0008\u7684\u7d22\u5f15\nCREATE OR REPLACE  INDEX \"qhdata_warehouse\".\"INDEX177921343911900\" ON \"qhdata_warehouse\".\"dw_addr_admin_area_code\"(\"UA0008\" ASC) STORAGE(ON \"MAIN\", CLUSTERBTR);\n\n-- \u57fa\u4e8eUA0005\u7684\u7d22\u5f15\nCREATE OR REPLACE  INDEX \"qhdata_warehouse\".\"INDEX177921813174100\" ON \"qhdata_warehouse\".\"dw_addr_admin_area_code\"(\"UA0005\" ASC) STORAGE(ON \"MAIN\", CLUSTERBTR);\n\n-- \u8054\u5408\u7d22\u5f15\nCREATE OR REPLACE  INDEX \"qhdata_warehouse\".\"mutli_index\" ON \"qhdata_warehouse\".\"dw_addr_admin_area_code\"(\"UA0008\" ASC,\"UA0005\" ASC) STORAGE(ON \"MAIN\", CLUSTERBTR);\n\n\n-- \u4e3b\u8981\u901a\u8fc7explain\u548cexplain for\u6765\u67e5\u770bSQL\u8bed\u53e5\u7684\u6267\u884c\u8ba1\u5212\nexplain  select * from qhdata_warehouse.dw_addr_admin_area_code where UA0005 = '440300000000' and  UA0008 = '440311006001';\nexplain for select * from qhdata_warehouse.dw_addr_admin_area_code where UA0005 = '440300000000' and  UA0008 = '440311006001';\n</code></pre> <p>\u6267\u884c\u8ba1\u5212\u7684\u6bcf\u884c\u5373\u4e3a\u4e00\u4e2a\u8ba1\u5212\u8282\u70b9\uff0c\u4e3b\u8981\u5305\u542b\u4e09\u90e8\u5206\u4fe1\u606f:</p> <ol> <li>\u7f29\u8fdb\u8d8a\u6df1\u7684\u8d8a\u5148\u6267\u884c\uff1b</li> <li>\u540c\u6837\u7f29\u8fdb\u7684\u4e0a\u9762\u7684\u5148\u6267\u884c\uff0c\u4e0b\u9762\u7684\u540e\u6267\u884c\uff1b</li> <li>\u4e0a\u4e0b\u7684\u4f18\u5148\u7ea7\u9ad8\u4e8e\u5185\u5916\uff1b</li> </ol> <p></p> <p>**\u8bf4\u660e\uff1a**\u8d8a\u7f29\u8fdb\u8d8a\u5148\u6267\u884c\uff0c\u5373\u6700\u7ec8\u7f29\u8fdb\u5206\u53c9\u4e863\uff0c4\uff0c\u540c\u6837\u7684\u7f29\u8fdb\uff0c\u4ece\u4e0a\u7531\u4e0b\u4f18\u5148\u7ea7\u66f4\u9ad8\uff0c\u6240\u4ee5\u8fd9\u91cc\u76843\u5148\u6267\u884c\uff0c3\u4e0b\u9762\u53c8\u6709\u8d8a\u6df1\u7684\u8d8a\u5148\u6267\u6267\u884c\uff0c\u53c8\u67091\uff0c2 \uff0c\u6240\u4ee5\u6574\u4e2a\u6392\u5e8f\u6267\u884c\u987a\u5e8f\u5c31\u51fa\u6765\u4e86\uff0c\u5f00\u59cb\u770b\u4e0d\u4e60\u60ef\uff0c\u5927\u5bb6\u591a\u770b\u51e0\u6b21\u5c31\u4e60\u60ef\u4e86\u3002</p> <ul> <li>\u7b2c\u4e00\u90e8\u5206 NEST2\u3001PRJT2\u3001CSCN2 \u4e3a\u64cd\u4f5c\u7b26\u53ca\u6570\u636e\u5e93\u5177\u4f53\u6267\u884c\u4e86\u4ec0\u4e48\u64cd\u4f5c\u3002\u5177\u4f53\u8be6\u89c1\u64cd\u4f5c\u7b26</li> <li>\u7b2c\u4e8c\u90e8\u5206\u7684\u4e09\u5143\u7ec4\u4e3a\u8be5\u8ba1\u5212\u8282\u70b9\u7684\u6267\u884c\u4ee3\u4ef7\uff0c\u5177\u4f53\u542b\u4e49\u4e3a[\u4ee3\u4ef7\uff0c\u8bb0\u5f55\u884c\u6570\uff0c\u5b57\u8282\u6570]\u3002</li> <li>\u7b2c\u4e09\u90e8\u5206\u4e3a\u64cd\u4f5c\u7b26\u7684\u8865\u5145\u4fe1\u606f\u3002</li> </ul> <p></p> <ul> <li> <p>SEEK2\uff1a\u8868\u793a\u8fd9\u4e2a\u7b49\u503c\u67e5\u627e\u4f7f\u7528\u4e86**\u4e8c\u7ea7\u7d22\u5f15\u8fdb\u884c\u8303\u56f4\u67e5\u627e**\uff0c\u67e5\u627e\u8303\u56f4\u662f <code>[('440311006001','440300000000'),('440311006001','440300000000')]</code></p> </li> <li> <p>BLKUP2\uff1a\u8868\u793a\u56de\u8868\uff0c\u6839\u636e\u4e8c\u7ea7\u7d22\u5f15\u5b9a\u4f4d rowid\uff0c\u518d\u6839\u636e\u8868\u7684\u4e3b\u952e\u3001\u805a\u96c6\u7d22\u5f15\u3001rowid \u7b49\u4fe1\u606f\u83b7\u53d6\u6570\u636e\u884c\u4e2d\u5176\u5b83\u5217\u3002</p> </li> <li>PRJT2\uff1a\u8868\u793a\u6295\u5f71\uff0c\u5c06\u67e5\u8be2\u8bed\u53e5\u4e2d\u7684\u661f\u53f7\u62d3\u5c55\u4e3a\u6240\u6709\u5217\u540d\u3002</li> <li>NSET\uff1a\u7528\u4e8e\u7ed3\u679c\u96c6\u6536\u96c6\u7684\u64cd\u4f5c\u7b26\uff0c\u4e00\u822c\u662f\u67e5\u8be2\u8ba1\u5212\u7684\u9876\u5c42\u8282\u70b9\uff0c\u4f18\u5316\u5de5\u4f5c\u4e2d\u65e0\u9700\u5bf9\u8be5\u64cd\u4f5c\u7b26\u8fc7\u591a\u5173\u6ce8\uff0c\u4e00\u822c\u6ca1\u6709\u4f18\u5316\u7a7a\u95f4\u3002</li> </ul> <p>\u6267\u884c\u8ba1\u5212\u89c6\u56fe</p> <p>\u8fbe\u68a6\u6570\u636e\u5e93\u7684 <code>v$SQL_PLAN</code>\u89c6\u56fe\u4e3b\u8981\u7528\u4e8e\u663e\u793a\u7f13\u5b58\u4e2d\u7684SQL\u6267\u884c\u8ba1\u5212\u4fe1\u606f\uff0c\u5728 dm.ini \u53c2\u6570 USE_PLN_POOL !=0 \u65f6\u624d\u7edf\u8ba1\u3002</p> <p>\u901a\u8fc7\u67e5\u8be2\u8fd9\u4e2a\u89c6\u56fe\uff0c\u7528\u6237\u53ef\u4ee5\u83b7\u53d6\u5230\u7f13\u5b58\u4e2d\u7684SQL\u8bed\u53e5\u7684\u6267\u884c\u8ba1\u5212\uff0c\u8fd9\u5bf9\u4e8e\u76d1\u63a7\u548c\u5206\u6790\u6570\u636e\u5e93\u4e2d\u7684SQL\u6267\u884c\u60c5\u51b5\u975e\u5e38\u6709\u7528\u3002\u4f8b\u5982\uff0cDBA\u53ef\u4ee5\u901a\u8fc7\u8fd9\u4e2a\u89c6\u56fe\u6765\u68c0\u67e5\u54ea\u4e9bSQL\u8bed\u53e5\u7684\u6267\u884c\u8ba1\u5212\u88ab\u9891\u7e41\u4f7f\u7528\uff0c\u4ece\u800c\u8fdb\u884c\u6027\u80fd\u4f18\u5316\u6216\u6545\u969c\u6392\u67e5\u3002</p> <p>\u6b64\u5916\uff0c\u8be5\u89c6\u56fe\u8fd8\u53ef\u4ee5\u4e0e<code>DBMS_XPLAN\u5305</code>\u7ed3\u5408\u4f7f\u7528\uff0c\u4ee5\u591a\u79cd\u9884\u5b9a\u4e49\u683c\u5f0f\u663e\u793a<code>EXPLAIN PLAN</code>\u547d\u4ee4\u7684\u8f93\u51fa\uff0c\u8fdb\u4e00\u6b65\u5e2e\u52a9\u7528\u6237\u7406\u89e3\u548c\u4f18\u5316SQL\u6267\u884c\u8ba1\u5212\u3002</p> <pre><code>SELECT NUM_ROWS,LAST_ANALYZED,TEMPORARY  FROM USER_TABLES WHERE TABLE_NAME='TEST_TAB1';\n</code></pre>"},{"location":"oracle/06.%E8%BE%BE%E6%A2%A6%E4%BC%98%E5%8C%96/#_5","title":"\u7edf\u8ba1\u4fe1\u606f\u6536\u96c6","text":"<p>\u5f53\u6211\u4eec\u53d1\u73b0\u4e00\u4e9b\u4e1a\u52a1\u8868\u7684\u76f8\u5173\u8bed\u53e5\u5b58\u5728\u56e0\u4e3a\u6570\u636e\u7684\u53d8\u5316\u800c\u5bfc\u81f4\u8bed\u53e5\u6267\u884c\u6548\u7387\u5dee\u5f02\u53d8\u5927\u65f6\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u8bbe\u5b9a\u5b9a\u65f6\u4f5c\u4e1a\u5bf9\u8868\u8fdb\u884c\u7edf\u8ba1\u4fe1\u606f\u7684\u6536\u96c6\u3002</p> <p>\u8fbe\u68a6\u6570\u636e\u5e93\u662f\u57fa\u4e8e\u4ee3\u4ef7\u7684\u4f18\u5316\u5668\uff0c\u8fbe\u68a6\u6570\u636e\u5e93\u7edf\u8ba1\u4fe1\u606f\u4e0d\u51c6\uff0c\u4f1a\u5f71\u54cd\u5230\u6267\u884c\u8ba1\u5212\u7684\u4f30\u7b97\uff0c\u5bfc\u81f4SQL\u89e3\u6790\u5230\u9519\u8bef\u7684\u6267\u884c\u8ba1\u5212\uff0c\u5982\u4f55\u5224\u65ad\u7edf\u8ba1\u4fe1\u606f\u6709\u6ca1\u6709\u6536\u96c6\u5462\uff1f</p> <p>\u4e3a\u4ec0\u4e48\u8981\u52a8\u6001\u66f4\u65b0\u7edf\u8ba1\u4fe1\u606f\u5462\uff0c\u6570\u636e\u5e93\u7ecf\u5e38\u4f1a\u5728\u8ba1\u5212\u7f13\u5b58\u4e2d\u751f\u6210\u4e86\u975e\u6700\u4f18\u7684\u8ba1\u5212\uff0c\u8fbe\u68a6\u6570\u636e\u5e93\u7684\u4f18\u5316\u5668\u662f\u57fa\u4e8e\u4ee3\u4ef7\u7684\u4f18\u5316\u5668\uff0c\u7cbe\u786e\u7684\u7edf\u8ba1\u4fe1\u606f\u6709\u52a9\u4e8eCBO\u751f\u6210\u66f4\u4f18\u7684\u8ba1\u5212\uff0c\u4f46\u662f\u7edf\u8ba1\u4fe1\u606f\u5e76\u4e0d\u4f1a\u5b9e\u65f6\u66f4\u65b0\u3002\u6240\u4ee5\uff0c\u7edf\u8ba1\u4fe1\u606f\u7684\u4e0d\u51c6\u786e\uff0c\u5c31\u5bfc\u81f4CBO\u751f\u6210\u4e86\u975e\u6700\u4f18\u7684\u8ba1\u5212\u3002</p> <p>\u6211\u4eec\u770b\u5982\u4e0bSQL\uff0c\u4e3b\u8981\u770b<code>NUM_ROWS</code>\u5b57\u6bb5\uff0c\u5982\u679c\u6ca1\u6709\u6536\u96c6\u901a\u5e38\u662f\u7a7a\u3002\u7b2c\u4e8c\u4e2a<code>LAST_ANALYZED</code>\u4ee3\u8868\u6536\u96c6\u7684\u65f6\u95f4\uff0c\u5982\u679c\u6ca1\u6709\u6536\u96c6\u8fd9\u4e2a\u5b57\u6bb5\u4e5f\u662f\u7a7a\uff0c\u7b2c\u4e09\u4e2a<code>TEMPORARY</code>\u5b57\u6bb5\u9644\u5e26\u8bf4\u660e\uff0cN\u8868\u793a\u4e0d\u662f\u4e34\u65f6\u8868\uff0cY\u8868\u793a\u662f\u4e34\u65f6\u8868\uff0c\u901a\u5e38\u5982\u679cTEMPORARY=Y \u662f\u4e0d\u7528\u6536\u96c6\u7684\u3002</p> <pre><code>SELECT ONWER, TABLE_NAME , NUM_ROWS,LAST_ANALYZED,TEMPORARY  FROM ALL_TABLES WHERE TABLE_NAME='bak_20240904180937_ud_cwx';\n\nSELECT ONWER, TABLE_NAME , NUM_ROWS,LAST_ANALYZED,TEMPORARY  FROM USER_TABLES WHERE TABLE_NAME='bak_20240904180937_ud_cwx';\n</code></pre> <p>\u5f53\u4e00\u4e2a\u8868\u7f3a\u5931\u4e86\u7edf\u8ba1\u4fe1\u606f\u6211\u901a\u5e38\u7528\u5982\u4e0b\u8bed\u53e5\u4fee\u590d\uff1a</p> <pre><code>-- 1\u3001\u6536\u96c6\u6570\u636e\u5e93\u7684\u7edf\u8ba1\u4fe1\u606f\uff0c\u5bf9\u5e93\u4e0a\u6240\u6709\u6a21\u5f0f\u4e0b\u7684\u6240\u6709\u7528\u6237\u8868\u4ee5\u53ca\u8868\u4e0a\u7684\u6240\u6709\u7d22\u5f15\u751f\u6210\u7edf\u8ba1\u4fe1\u606f\nCALL SP_DB_STAT_INIT ();\n\n-- 2\u3001\u6e05\u7a7a\u5e93\u7684\u7edf\u8ba1\u4fe1\u606f\nCALL SP_DB_STAT_DEINIT ();\n\n-- 3\u3001\u5bf9\u67d0\u5f20\u8868\u6216\u67d0\u4e2a\u7d22\u5f15\u751f\u6210\u7edf\u8ba1\u4fe1\u606f CALL SP_TAB_STAT_INIT ('\u6a21\u5f0f\u540d', '\u8868\u540d\u6216\u7d22\u5f15\u540d');\n\u5bf9\u8868 SYSOBECTS \u751f\u6210\u7edf\u8ba1\u4fe1\u606f CALL SP_TAB_STAT_INIT ('SYS', 'SYSOBJECTS');\n\n-- 4\u3001\u6e05\u7a7a\u67d0\u5f20\u8868\u7684\u7edf\u8ba1\u4fe1\u606f CALL SP_TAB_STAT_DEINIT ('\u6a21\u5f0f\u540d', '\u8868\u540d');\n\u6e05\u7a7a\u8868 SYSOBECTS \u7684\u7edf\u8ba1\u4fe1\u606f CALL SP_TAB_STAT_DEINIT ('SYS', 'SYSOBJECTS');\n\n-- 5\u3001\u5bf9\u67d0\u4e2a\u8868\u4e0a\u6240\u6709\u7684\u5217\u751f\u6210\u7edf\u8ba1\u4fe1\u606f CALL SP_TAB_COL_STAT_INIT ('\u6a21\u5f0f\u540d', '\u8868\u540d');\n\u5bf9'SYSOBJECTS'\u8868\u4e0a\u6240\u6709\u7684\u5217\u751f\u6210\u7edf\u8ba1\u4fe1\u606f CALL SP_TAB_COL_STAT_INIT ('SYS', 'SYSOBJECTS');\n\n-- 6\u3001\u6e05\u7a7a\u67d0\u4e2a\u8868\u4e0a\u6240\u6709\u7684\u5217\u7684\u7edf\u8ba1\u4fe1\u606f CALL SP_TAB_COL_STAT_DEINIT ('\u6a21\u5f0f\u540d', '\u8868\u540d');\n\u6e05\u7a7a'SYSOBJECTS'\u8868\u4e0a\u6240\u6709\u7684\u5217\u7edf\u8ba1\u4fe1\u606f CALL SP_TAB_COL_STAT_DEINIT ('SYS', 'SYSOBJECTS');\n\n-- 7\u3001\u5bf9\u6307\u5b9a\u7684\u5217\u751f\u6210\u7edf\u8ba1\u4fe1\u606f\uff0c\u4e0d\u652f\u6301\u5927\u5b57\u6bb5\u5217\u548c\u865a\u62df\u5217 \nCALL SP_COL_STAT_INIT ('\u6a21\u5f0f\u540d', '\u8868\u540d', '\u5217\u540d');\n    --\u5bf9\u8868 SYSOBJECTS \u7684 ID \u5217\u751f\u6210\u7edf\u8ba1\u4fe1\u606f \nCALL SP_COL_STAT_INIT ('SYS', 'SYSOBJECTS', 'ID');\n\n-- 8\u3001\u6e05\u7a7a\u6307\u5b9a\u5217\u7684\u7edf\u8ba1\u4fe1\u606f \nCALL SP_COL_STAT_DEINIT ('\u6a21\u5f0f\u540d', '\u8868\u540d', '\u5217\u540d');\n-- \u6e05\u7a7a\u8868 SYSOBJECTS \u7684 ID \u5217\u7edf\u8ba1\u4fe1\u606f \nCALL SP_COL_STAT_INIT ('SYS', 'SYSOBJECTS', 'ID');\n\n-- 9\u3001\u5bf9\u8868\u4e0a\u6240\u6709\u7684\u7d22\u5f15\u751f\u6210\u7edf\u8ba1\u4fe1\u606f CALL SP_TAB_INDEX_STAT_INIT ('\u6a21\u5f0f\u540d', '\u8868\u540d');\n\u5bf9 SYSOBJECTS \u8868\u4e0a\u6240\u6709\u7684\u7d22\u5f15\u751f\u6210\u7edf\u8ba1\u4fe1\u606f CALL SP_TAB_INDEX_STAT_INIT ('SYS', 'SYSOBJECTS');\n\n-- 10\u3001\u5bf9\u6307\u5b9a\u7684\u7d22\u5f15\u751f\u6210\u7edf\u8ba1\u4fe1\u606f CALL SP_INDEX_STAT_INIT ('\u6a21\u5f0f\u540d', '\u7d22\u5f15\u540d'); \n-- \u5bf9\u6307\u5b9a\u7684\u7d22\u5f15 IND \u751f\u6210\u7edf\u8ba1\u4fe1\u606f CALL SP_INDEX_STAT_INIT ('SYSDBA', 'IND');\n\n-- 11\u3001\u6e05\u7a7a\u6307\u5b9a\u7684\u7d22\u5f15\u7684\u7edf\u8ba1\u4fe1\u606f CALL SP_INDEX_STAT_DEINIT ('\u6a21\u5f0f\u540d', '\u7d22\u5f15\u540d');\n-- \u6e05\u7a7a\u6307\u5b9a\u7684\u7d22\u5f15 IND \u7684\u7edf\u8ba1\u4fe1\u606f CALL SP_INDEX_STAT_DEINIT ('SYSDBA', 'IND');\n\n-- 12\u3001\u5bf9\u67d0\u4e2a SQL \u67e5\u8be2\u8bed\u53e5\u4e2d\u6d89\u53ca\u7684\u6240\u6709\u8868\u548c\u8fc7\u6ee4\u6761\u4ef6\u4e2d\u7684\u5217(\u4e0d\u5305\u62ec\u5927\u5b57\u6bb5\u3001ROWID)\u751f\u6210\u7edf\u8ba1\u4fe1\u606f\u3002\u53ef\u80fd\u8fd4\u56de\u7684\u9519\u8bef\u63d0\u793a\uff1a\n-- 1\uff09 \u8bed\u6cd5\u5206\u6790\u51fa\u9519\uff0csql \u8bed\u53e5\u8bed\u6cd5\u9519\u8bef 2\uff09 \u5bf9\u8c61\u4e0d\u652f\u6301\u7edf\u8ba1\u4fe1\u606f\uff0c\u7edf\u8ba1\u7684\u8868\u6216\u8005\u5217\u4e0d\u5b58\u5728\uff0c\u6216\u8005\u4e0d\u5141\u8bb8\u88ab\u7edf\u8ba1 CALL SP_SQL_STAT_INIT ('SQL');\n-- \u5bf9'SELECT * FROM SYSOBJECTS'\u8bed\u53e5\u6d89\u53ca\u7684\u6240\u6709\u8868\u751f\u6210\u7edf\u8ba1\u4fe1\u606f \nCALL SP_SQL_STAT_INIT ('SELECT * FROM SYSOBJECTS');\n\n-- 13\u3001\u5bf9\u6307\u5b9a\u7684\u5217\u751f\u6210\u7edf\u8ba1\u4fe1\u606f\uff0c\u4e0d\u652f\u6301\u5927\u5b57\u6bb5\u5217\u548c\u865a\u62df\u5217 \nCALL SP_COL_STAT_INIT('\u6a21\u5f0f\u540d','\u8868\u540d','\u5217\u540d')\n-- \u5bf9\u8868 SYSOBJECTS \u7684 ID \u5217\u751f\u6210\u7edf\u8ba1\u4fe1\u606f \nCALL SP_COL_STAT_INIT ('SYS', 'SYSOBJECTS', 'ID');\n\n-- 14\u3001\u6e05\u7a7a\u6307\u5b9a\u7684\u5217\u7684\u7edf\u8ba1\u4fe1\u606f \nCALL SP_COL_STAT_DEINIT('\u6a21\u5f0f\u540d','\u8868\u540d','\u5217\u540d')\n-- \u6e05\u7a7a\u8868 SYSOBJECTS \u7684 ID \u5217\u7edf\u8ba1\u4fe1\u606f \nCALL SP_COL_STAT_DEINIT ('SYS', 'SYSOBJECTS', 'ID');\n\n-- 15\u3001\u5bf9\u67d0\u4e2a\u8868\u4e0a\u6240\u6709\u7684\u5217\uff0c\u6309\u7167\u6307\u5b9a\u7684\u91c7\u6837\u7387\u751f\u6210\u7edf\u8ba1\u4fe1\u606f \nCALL SP_STAT_ON_TABLE_COLS('\u6a21\u5f0f\u540d','\u8868\u540d','\u91c7\u6837\u7387')\n-- \u5bf9'SYSOBJECTS'\u8868\u4e0a\u6240\u6709\u7684\u5217\u751f\u6210\u7edf\u8ba1\u4fe1\u606f\uff0c\u91c7\u6837\u7387 90 \nCALL SP_STAT_ON_TABLE_COLS('SYS','SYSOBJECTS',90);\n\n-- 16\u3001\u5220\u9664\u4e00\u4e2a\u8868\u7684\u591a\u7ef4\u7edf\u8ba1\u4fe1\u606f \nCALL SP_TAB_MSTAT_DEINIT('\u6a21\u5f0f\u540d','\u8868\u540d')\n</code></pre>"},{"location":"oracle/06.%E8%BE%BE%E6%A2%A6%E4%BC%98%E5%8C%96/#_6","title":"\u4f18\u5316\u6982\u8ff0","text":""},{"location":"oracle/06.%E8%BE%BE%E6%A2%A6%E4%BC%98%E5%8C%96/#_7","title":"\u53c2\u6570\u914d\u7f6e","text":""},{"location":"oracle/06.%E8%BE%BE%E6%A2%A6%E4%BC%98%E5%8C%96/#sql","title":"SQL\u5c42\u9762","text":"<p>\u6570\u636e\u5e93\u7684\u6027\u80fd\u95ee\u9898\u6700\u7ec8\u90fd\u8981\u6d89\u53ca\u5230SQL\u4f18\u5316\uff0c\u5904\u7406\u6d41\u7a0b\u57fa\u672c\u6b65\u9aa4\uff1a\u751f\u6210\u65e5\u5fd7\u2014\u2014&gt;\u65e5\u5fd7\u5165\u5e93\u2014\u2014&gt;\u5206\u6790SQL\u2014\u2014&gt;\u4f18\u5316\u65b9\u6848\u3002\u5bf9\u4e8eSQL\u6211\u4eec\u4e00\u822c\u4f18\u5316\u7684\u539f\u5219\u7b26\u5408\uff1a</p> <ul> <li>\u6700\u4f18\u5148\u5904\u7406\uff1a\u6570\u91cf\u5f88\u5c11(5%)\uff0c\u4f46\u662f\u6267\u884c\u9891\u7387\u975e\u5e38\u9ad8\uff0c\u751a\u81f3\u8fbe\u5230\u6bcf\u79d2\u4e0a\u767e\u6b21\uff0c\u53ea\u8981\u4e00\u6162\uff0c\u7cfb\u7edf\u5f88\u53ef\u80fd\u762b\u75ea\u3002\uff08\u5e76\u53d1\u975e\u5e38\u9ad8\uff09</li> <li>\u6b21\u4f18\u5148\u5904\u7406\uff1a\u5360\u5927\u591a\u6570(80%)\uff0c\u5982\u679c\u6709\u6162\u7684\uff0c\u5bf9\u7cfb\u7edf\u6574\u4f53\u7a33\u5b9a\u6027\u5f71\u54cd\u4e0d\u5927\uff0c\u4f46\u662f\u4f1a\u9020\u6210\u5c40\u90e8\u7684\u67d0\u4e9b\u64cd\u4f5c\u6162\uff08\u5e76\u53d1\u4e00\u822c\uff09</li> <li>\u6700\u540e\u5904\u7406\uff1a\u6570\u91cf\u5c11(15%)\uff0c\u5f80\u5f80\u662f\u5f88\u590d\u6742\u7684\u67e5\u8be2\uff0c\u53ef\u80fd\u4e00\u5929\u5c31\u6267\u884c\u51e0\u6b21\uff0c\u5bf9\u7cfb\u7edf\u6574\u4f53\u5f71\u54cd\u4e0d\u5927\uff0c\u4f46\u662f\u4f18\u5316\u96be\u5ea6\u5f88\u5927\u3002\uff08\u5e76\u53d1\u5f88\u5c11\u7279\u522b\u6162\uff09</li> </ul>"},{"location":"oracle/06.%E8%BE%BE%E6%A2%A6%E4%BC%98%E5%8C%96/#sql_1","title":"\u6162SQL\u5b9a\u4f4d","text":"<p>\u8ddf\u8e2a\u65e5\u5fd7\u6587\u4ef6\u662f\u4e00\u4e2a\u7eaf\u6587\u672c\u6587\u4ef6\uff0c\u4ee5 dmsql_\u5b9e\u4f8b\u540d_\u65e5\u671f_\u65f6\u95f4\u547d\u540d\uff0c \u9ed8\u8ba4\u751f\u6210\u5728 DM \u5b89\u88c5\u76ee\u5f55\u7684 log \u5b50\u76ee\u5f55\u4e0b\u3002</p> <p>\u8ddf\u8e2a\u65e5\u5fd7\u5185\u5bb9\u5305\u542b\u7cfb\u7edf\u5404\u4f1a\u8bdd\u6267\u884c\u7684 SQL \u8bed\u53e5\u3001\u53c2\u6570\u4fe1\u606f\u3001\u9519\u8bef\u4fe1\u606f\u3001\u6267\u884c\u65f6\u95f4\u7b49\u3002\u8ddf\u8e2a\u65e5\u5fd7\u4e3b\u8981\u7528\u4e8e\u5206\u6790\u9519\u8bef\u548c\u5206\u6790\u6027\u80fd\u95ee\u9898\uff0c\u57fa\u4e8e\u8ddf\u8e2a\u65e5\u5fd7\u53ef\u4ee5\u5bf9\u7cfb\u7edf\u8fd0\u884c\u72b6\u6001\u8fdb\u884c\u5206\u6790\u3002</p> <p>\u6839\u636e\u8ddf\u8e2a\u65e5\u5fd7\u67e5\u627e\u6162 SQL</p> <p>\u5f53 INI \u53c2\u6570 <code>ENABLE_MONITOR=1</code>\u3001<code>MONITOR_TIME=1</code> \u6253\u5f00\u65f6\uff0c\u663e\u793a\u7cfb\u7edf\u6700\u8fd1 1000 \u6761\u6267\u884c\u65f6\u95f4\u8d85\u8fc7\u9884\u5b9a\u503c\u7684 SQL \u8bed\u53e5\u3002</p> <p>\u9ed8\u8ba4\u9884\u5b9a\u503c\u4e3a 1000 \u6beb\u79d2\u3002\u9884\u5b9a\u503c\u53ef\u901a\u8fc7 <code>LONG_EXEC_SQLS_CNT</code>  \u6765\u4fee\u6539\u3002</p> <p>\u53ef\u901a\u8fc7 SP_SET_LONG_TIME \u7cfb\u7edf\u51fd\u6570\u4fee\u6539\uff0c\u901a\u8fc7 SF_GET_LONG_TIME \u7cfb\u7edf\u51fd\u6570\u67e5\u770b\u5f53\u524d\u503c\u3002</p> <pre><code>-- \u4e24\u4e2a\u53c2\u6570\u5747\u4e3a\u52a8\u6001\u53c2\u6570\uff0c\u53ef\u76f4\u63a5\u8c03\u7528\u7cfb\u7edf\u51fd\u6570\u8fdb\u884c\u4fee\u6539\n\nSP_SET_PARA_VALUE(1,'ENABLE_MONITOR',1);\nSP_SET_PARA_VALUE(1,'MONITOR_TIME',1);\nSP_SET_PARA_VALUE(1,'MONITOR_SQL_EXEC',1);\n\n-- LONG_EXEC_SQLS_CNT \n\n\n -- v$SYSTEM_LONG_EXEC_SQLS     \u663e\u793a\u670d\u52a1\u5668\u542f\u52a8\u4ee5\u6765\u6267\u884c\u65f6\u95f4\u6700\u957f\u7684 20 \u6761 SQL \u8bed\u53e5\n -- v$LONG_EXEC_SQLS            \u663e\u793a\u6700\u8fd1 1000 \u6761\u6267\u884c\u65f6\u95f4\u8f83\u957f\u7684 SQL \u8bed\u53e5\n -- v$SQL_HISTORY               \u663e\u793a\u6267\u884c sql \u7684\u5386\u53f2\u8bb0\u5f55\u4fe1\u606f\uff1b\u53ef\u4ee5\u65b9\u4fbf\u7528\u6237\u7ecf\u5e38\u4f7f\u7528\u7684\u8bb0\u5f55\u8fdb\u884c\u4fdd\u5b58\u3002    \n</code></pre>"},{"location":"oracle/06.%E8%BE%BE%E6%A2%A6%E4%BC%98%E5%8C%96/#et","title":"ET\u67e5\u8be2","text":"<p>ET \u662f\u8fbe\u68a6\u6570\u636e\u5e93\u5185\u7f6e\u7684SQL\u6027\u80fd\u4f18\u5316\u5206\u6790\u5de5\u5177\uff0c\u5b83\u53ef\u4ee5\u7edf\u8ba1\u6307\u5b9a\u4f1a\u8bddID\u6267\u884c\u7684SQL\u7684\u6240\u6709\u64cd\u4f5c\u7b26\u7684\u6267\u884c\u65f6\u95f4\u3002</p> <p>\u5bf9\u4e8e\u5206\u6790\u4f18\u5316SQL\u63d0\u4f9b\u6bd4\u8f83\u76f4\u89c2\u7684\u6570\u636e\u4f9d\u636e\uff0c\u5bf9\u4e8e\u8fbe\u68a6\u6570\u636e\u5e93SQL\u4f18\u5316\uff0cET\u7684\u4f7f\u7528\u662f\u5fc5\u987b\u8981\u638c\u63e1\u7684\u6280\u80fd\u4e4b\u4e00\u3002</p> <p>\u8fbe\u68a6\u6570\u636e\u5e93ET\u529f\u80fd\u9ed8\u8ba4\u662f\u5173\u95ed\uff0c\u9700\u8981\u8bbe\u7f6eini\u53c2\u6570\uff0c<code>enable_monitor=1</code>\u3001<code>monitor_time=1</code>\u548c<code>monitor_sql_exec=1</code></p> <pre><code>-- \u67e5\u770bET\u76f8\u5173\u53c2\u6570\u53ca\u5176\u503c\nselect para_name,para_value,para_type from v$dm_ini where para_name in ('ENABLE_MONITOR','MONITOR_TIME','MONITOR_SQL_EXEC')\n\n-- \u914d\u7f6e\u76f8\u5173\u53c2\u6570\u5f00\u542fET\u529f\u80fd\nSP_SET_PARA_VALUE(1,'ENABLE_MONITOR',1);    -- \u5f00\u542f\u76d1\u89c6\nSP_SET_PARA_VALUE(1,'MONITOR_SQL_EXEC',1);  -- \u76d1\u89c6SQL\u6267\u884c\nSP_SET_PARA_VALUE(1,'MONITOR_TIME',1);      -- \u76d1\u89c6\u65f6\u95f4\n\n--\u4f7f\u7528ET\u5206\u6790sql\u6267\u884c\u6548\u7387,\u8bed\u53e5\u7684\u6267\u884c\u53f7\u4e3a3105\uff0c\u53ef\u4ee5\u901a\u8fc7ET(3105)\u7684\u65b9\u5f0f\u8c03\u7528ET\nSELECT D.* FROM DMTEST.EMPLOYEES E, DMTEST.DEPT_EMP D WHERE D.EMP_NO = E.EMP_NO LIMIT 10;\nET(3105);\n</code></pre> <p>https://www.modb.pro/db/583100</p>"},{"location":"oracle/06.%E8%BE%BE%E6%A2%A6%E4%BC%98%E5%8C%96/#sql_2","title":"\u542f\u7528SQL\u65e5\u5fd7\u6765\u8f85\u52a9\u5206\u6790\u6027\u80fd\u95ee\u9898","text":"<p>\u5728\u8fbe\u68a6\u6570\u636e\u5e93\u4e2d\uff0cDBA\u53ef\u4ee5\u901a\u8fc7\u67e5\u770b\u7cfb\u7edfSQL\u65e5\u5fd7\u6765\u8f85\u52a9\u5206\u6790SQL\u6027\u80fd\u95ee\u9898\u3002</p> <p>\u5c06DM\u6570\u636e\u5e93\u914d\u7f6e\u6587\u4ef6\u4e2d\u7684\u53c2\u6570SVR_LOG\u8bbe\u7f6e\u4e3a\u6253\u5f00\uff0c\u7cfb\u7edf\u4f1a\u5728\u5b89\u88c5\u7684log\u76ee\u5f55\u4e0b\u751f\u6210\u540d\u4e3a dmsql_\u5b9e\u4f8b\u540d_\u65e5\u671f_\u65f6\u95f4.log \u7684SQL\u65e5\u5fd7\u6587\u4ef6\u3002</p> <p>\u5728\u8be5\u6587\u4ef6\u4e2d\u8bb0\u5f55\u4e86\u542f\u7528SVR_LOG\u4e4b\u540e\u6570\u636e\u5e93\u63a5\u6536\u5230\u7684\u6240\u6709SQL\u8bed\u53e5\u7b49\u4fe1\u606f\uff0cDBA\u53ef\u4ee5\u901a\u8fc7\u5206\u6790\u8be5\u6587\u4ef6\u6765\u5e2e\u52a9\u89e3\u51b3\u95ee\u9898\u3002</p> <pre><code># \u5f00\u542fSQL\u65e5\u5fd7\nSP_SET_PARA_VALUE(1, 'SVR_LOG', 1);\n</code></pre> <p>\u91cd\u70b9\u5173\u6ce8\u4fe1\u606f\uff1a\u8bb0\u5f55\u6267\u884c\u65f6\u95f4\u8d85\u8fc7200ms\u7684\u8bed\u53e5\uff1b\u751f\u4ea7\u73af\u5883\u5fc5\u987b\u8bbe\u7f6e\u4e3a\u5f02\u6b65\u65e5\u5fd7\uff1b\u8bbe\u7f6eSQL\u8fc7\u6ee4\u89c4\u5219\uff0c\u53ea\u8bb0\u5f55\u5fc5\u8981\u7684SQL\u7b49\u3002</p>"},{"location":"oracle/06.%E8%BE%BE%E6%A2%A6%E4%BC%98%E5%8C%96/#_8","title":"\u8fbe\u68a6\u5185\u5b58\u6982\u8ff0","text":"<p>\u8fbe\u68a6\u7684\u5185\u5b58\u7ed3\u6784\u4e3b\u8981\u5305\u62ec**\u5185\u5b58\u6c60**\u3001\u7f13\u51b2\u533a\u3001\u6392\u5e8f\u533a\u3001\u54c8\u5e0c\u533a\u3002 \u6839\u636e\u7cfb\u7edf\u4e2d\u5b50\u6a21\u5757\u7684\u4e0d\u540c\u529f\u80fd\uff0c\u5bf9\u5185\u5b58\u8fdb\u884c\u4e86\u4e0a\u8ff0\u5212\u5206\uff0c\u5e76\u91c7\u7528\u4e86\u4e0d\u540c\u7684\u7ba1\u7406\u6a21\u5f0f\u3002</p> <p>\u8fd9\u4e9b\u53c2\u6570\u7684\u9ed8\u8ba4\u503c\u90fd\u5f88\u5c0f\u3002 \u751f\u4ea7\u73af\u5883\u9700\u8981\u6839\u636e\u670d\u52a1\u5668\u7684\u914d\u7f6e\u8fdb\u884c\u76f8\u5e94\u7684\u4fee\u6539\u3002</p> <p>\u8fbe\u68a6\u6570\u636e\u5e93\u670d\u52a1\u542f\u52a8\u65f6\uff0c\u4f1a\u5411\u64cd\u4f5c\u7cfb\u7edf\u7533\u8bf7 6 \u5757\u72ec\u7acb\u7684\u5185\u5b58\uff08\u6570\u636e\u7f13\u51b2\u533a\uff0c\u5b57\u5178\u7f13\u51b2\u533a\uff0c\u65e5\u5fd7\u7f13\u51b2\u533a\uff0c\u5171\u4eab\u5185\u5b58\u6c60\uff0c\u5907\u7528\u5185\u5b58\u6c60\uff0csql \u7f13\u51b2\u533a\uff09\u5e38\u9a7b\u3002</p> <p>\u5982\u679c\u6709\u4f1a\u8bdd\u8fde\u63a5\uff0c\u5219\u4f1a\u53bb\u5efa\u7acb\u76f8\u5173\u7684\u5185\u5b58\u6c60\uff08\u4f1a\u8bdd\u5185\u5b58\u6c60\uff0c\u6392\u5e8f\u5185\u5b58\u6c60\uff0c\u865a\u62df\u673a\u5185\u5b58\u6c60\u7b49\uff09\u4f1a\u8bdd\u7ed3\u675f\u540e\uff0c\u76f8\u5173\u5185\u5b58\u6c60\u56de\u6536\u3002</p> <p>\u524d\u8005\u79f0\u4e4b\u4e3a\u5171\u4eab\u5185\u5b58\u6c60\uff08\u610f\u4e3a\u5168\u5c40\uff0c\u6574\u4e2a\u5b9e\u4f8b\u5171\u4eab\uff09\uff0c\u540e\u8005\u79f0\u4e4b\u4e3a\u8fd0\u884c\u65f6\u5185\u5b58\uff08\u610f\u4e3a\u6bcf\u4e2a\u8fde\u63a5\u72ec\u4eab\uff09\u3002</p>"},{"location":"oracle/06.%E8%BE%BE%E6%A2%A6%E4%BC%98%E5%8C%96/#_9","title":"\u5171\u4eab\u5185\u5b58\u6c60","text":"<p>\u8fbe\u68a6\u5728\u5b9e\u4f8b\u8fd0\u884c\u671f\u95f4\uff0c\u9700\u8981\u7ecf\u5e38\u7533\u8bf7\u6216\u91ca\u653e\u5c0f\u7247\u5185\u5b58\uff0c\u800c\u5411\u64cd\u4f5c\u7cfb\u7edf\u7533\u8bf7\u6216\u91ca\u653e\u5185\u5b58\u65f6\u9700\u8981\u8fdb\u884c\u7cfb\u7edf\u8c03\u7528\uff0c\u6b64\u65f6\u53ef\u80fd\u4f1a\u5f15\u8d77\u7ebf\u7a0b\u5207\u6362\uff0c\u964d\u4f4e\u7cfb\u7edf\u8fd0\u884c\u6548\u7387\u3002</p> <p>\u5b9e\u4f8b\u542f\u52a8\u65f6\u4f1a\u4ece\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u7533\u8bf7\u4e00\u5927\u7247\u5185\u5b58\uff0c\u5373\u5171\u4eab\u5185\u5b58\u6c60\u3002\u5f53\u5b9e\u4f8b\u5728\u8fd0\u884c\u4e2d\u9700\u8981\u5185\u5b58\u65f6\uff0c\u53ef\u4ee5\u5728\u5171\u4eab\u5185\u5b58\u6c60\u5185\u7533\u8bf7\u6216\u8005\u91ca\u653e\u5185\u5b58\u3002</p>"},{"location":"oracle/06.%E8%BE%BE%E6%A2%A6%E4%BC%98%E5%8C%96/#_10","title":"\u6570\u636e\u7f13\u51b2\u533a","text":"<p>\u6570\u636e\u7f13\u51b2\u533a\u4fdd\u5b58\u7684\u662f\u6570\u636e\u9875\uff0c\u5305\u62ec\u7528\u6237\u66f4\u6539\u7684\u6570\u636e\u9875\u548c\u67e5\u8be2\u65f6\u4ece\u78c1\u76d8\u8bfb\u53d6\u7684\u6570\u636e\u9875\u3002\u8fd9\u662fDM Server\u81f3\u5173\u91cd\u8981\u7684\u5185\u5b58\u533a\u57df\u4e4b\u4e00\u3002</p> <p>\u8be5\u533a\u57df\u5927\u5c0f\u5bf9\u5b9e\u4f8b\u6027\u80fd\u7684\u5f71\u54cd\u8f83\u5927\uff0c\u8bbe\u5b9a\u8fc7\u5c0f\u4f1a\u5bfc\u81f4\u7f13\u51b2\u9875\u547d\u4e2d\u7387\u4f4e\uff0c\u78c1\u76d8I/O\u9891\u7e41\uff1b\u8bbe\u5b9a\u8fc7\u5927\u4f1a\u5bfc\u81f4\u8d44\u6e90\u7684\u6d6a\u8d39\uff0c\u5bfc\u81f4\u64cd\u4f5c\u7cfb\u7edf\u5185\u5b58\u672c\u8eab\u4e0d\u591f\u7528\u3002</p> <p>\u5b9e\u4f8b\u5728\u542f\u52a8\u65f6\uff0c\u6839\u636e\u914d\u7f6e\u6587\u4ef6\u4e2d\u53c2\u6570\u6307\u5b9a\u7684\u6570\u636e\u7f13\u51b2\u533a\u5927\u5c0f\uff0c\u5411\u64cd\u4f5c\u7cfb\u7edf\u7533\u8bf7\u4e00\u7247\u8fde\u7eed\u7684\u5185\u5b58\uff0c\u5e76\u5c06\u5176\u6309\u6570\u636e\u9875\u5927\u5c0f\u8fdb\u884c\u683c\u5f0f\u5316\uff0c\u6700\u540e\u7f6e\u5165\u81ea\u7531\u94fe\u4e2d\u3002</p> <p>\u6570\u636e\u7f13\u51b2\u533a\u5b58\u5728\u4e09\u6761\u94fe\u6765\u7ba1\u7406\u88ab\u7f13\u51b2\u7684\u6570\u636e\u9875\uff1a</p> <p>\uff081\uff09\u81ea\u7531\u94fe\uff0c\u7528\u4e8e\u5b58\u653e\u76ee\u524d\u5c1a\u672a\u4f7f\u7528\u7684\u5185\u5b58\u6570\u636e\u9875\u3002</p> <p>\uff082\uff09LRU\u94fe\uff0c\u7528\u6237\u5b58\u653e\u5df2\u88ab\u4f7f\u7528\u7684\u5185\u5b58\u6570\u636e\u9875\uff08\u5305\u62ec\u672a\u4fee\u6539\u548c\u5df2\u4fee\u6539\u7684\u5185\u5b58\u6570\u636e\u9875\uff09</p> <p>\uff083\uff09\u810f\u94fe\uff0c\u7528\u4e8e\u5b58\u653e\u5df2\u88ab\u4fee\u6539\u8fc7\u7684\u5185\u5b58\u6570\u636e\u9875\u3002</p> <p><code>DM</code> \u7684<code>buffer</code>\u533a\u76f8\u5f53\u4e8e<code>Oracle</code>\u7684<code>buffer cache</code>\uff0c\u6570\u636e\u5e93\u7f13\u51b2\u533a\u662f<code>DMDB</code>\u7528\u4e8e\u7f13\u5b58\u6570\u636e\u5757\u7684\u5185\u5b58\u533a\u57df\u3002</p> <p>\u5f53\u6570\u636e\u4ece\u78c1\u76d8\u8bfb\u53d6\u5230\u5185\u5b58\u65f6\uff0c\u5b83\u4eec\u901a\u5e38\u4f1a\u88ab\u5b58\u50a8\u5728 \u6570\u636e\u5e93\u7f13\u51b2\u533a \u4e2d\uff0c\u4ee5\u63d0\u9ad8\u6570\u636e\u8bbf\u95ee\u7684\u6027\u80fd\u3002\u7f13\u51b2\u533a\u7684\u5927\u5c0f\u53ef\u4ee5\u901a\u8fc7\u914d\u7f6e\u53c2\u6570\u8fdb\u884c\u8c03\u6574\u3002</p> <pre><code>-- \u67e5\u8be2buffer\u76f8\u5173\u89c6\u56fe\nSELECT distinct name,count(*) FROM v$bufferpool GROUP BY name ORDER BY 2 DESC;\n\n-- \u67e5\u8be2BUFFER\u76f8\u5173\u53c2\u6570\nSELECT * FROM V$DM_INI WHERE PARA_NAME LIKE '%BUFFER%';\n\n-- \u67e5\u8be2BUFFER\u76f8\u5173\nSELECT name ,type,value,sys_value,file_value,description FROM v$parameter WHERE upper(name) LIKE upper('%BUFFER%');\n</code></pre> <p>\u8fbe\u68a6\u6570\u636e\u5e93\u4e2d\u63d0\u4f9b\u4e86\u52a8\u6001\u6027\u80fd\u89c6\u56fe <code>v$BUFFERPOOL</code> \u6765\u76d1\u63a7\u6570\u636e\u7f13\u51b2\u533a\u7684\u4f7f\u7528\u60c5\u51b5\u3002\u8be5\u89c6\u56fe\u7ed3\u6784\u5982\u4e0b\uff1a</p> \u5217 \u6570\u636e\u7c7b\u578b \u8bf4\u660e ID \u7f13\u51b2\u533aID NAME \u7f13\u51b2\u533a\u540d\u79f0 NORMAL/KEEP/RECYCLE/FAST PAGE_SIZE \u57fa\u7f13\u51b2\u533a\u9875\u5927\u5c0f\uff0c\u4e0d\u5305\u62ec\u6269\u5c55\u6c60\u9875 N_PAGES \u9875\u6570 N_FIXED \u6570\u636e\u9875\u88ab\u5f15\u7528\u7684\u6b21\u6570 FREE \u7a7a\u95f2\u9875\u6570\u76ee <p>\u540c\u6837<code>buffer</code>\u53c8\u5206\u4e3a\u51e0\u4e2a\u5b50\u6c60\uff0c\u5982 <code>normal</code>,  <code>keep</code>, <code>recycle</code>, <code>fast</code>, <code>roll</code>\u7528\u4e8e\u6570\u636e\u5185\u5b58\u4e2d\u5468\u671f\u7ba1\u7406\u3002</p> <p>\u5728DM\u6570\u636e\u5e93\u4e2d\uff0cbuffer \u7f13\u51b2\u5206\u4e3a4\u79cd\uff0c\u5206\u522b\u4e3a\uff1a</p> <ul> <li>normal\u7f13\u51b2\u533a\uff0c\u5bf9\u5e94\u7684<code>ini</code>\u53c2\u6570\uff1a\u5728\u4e00\u822c\u7684\u7cfb\u7edf\u4e2d\uff0c\u6211\u4eec\u91cd\u70b9\u9700\u8981\u4fee\u6539\u7684\u662f2\u4e2a buffer \u53c2\u6570\uff0c \u8be5\u53c2\u6570\u5bf9\u6027\u80fd\u5f71\u54cd\u8f83\u5927\uff1a</li> </ul> <p><code>BUFFER</code>\uff1a\u7cfb\u7edf\u7f13\u51b2\u533a\u5927\u5c0f\uff0c\u4ee5 M \u4e3a\u5355\u4f4d\uff0c\u9ed8\u8ba4\u503c\u662f1000\u3002\u63a8\u8350\u503c\uff1a\u7cfb\u7edf\u7f13\u51b2\u533a\u5927\u5c0f\u4e3a\u53ef\u7528\u7269\u7406\u5185\u5b58\u7684 60%\uff5e80%\u3002\u6709\u6548\u503c\u8303\u56f4\uff088~1048576\uff09 <code>BUFFER_POOLS</code> \uff1a <code>BUFFER</code> \u7cfb\u7edf\u5206\u533a\u6570\uff0c\u6bcf\u4e2a <code>BUFFER</code> \u5206\u533a\u7684\u5927\u5c0f\u4e3a <code>BUFFER/BUFFER_POOLS</code>\u3002\u9ed8\u8ba4\u503c\u662f19\uff0c\u5728\u5185\u5b58\u4e0d\u5927\u7684\u60c5\u51b5\u4e0b\uff0c\u5efa\u8bae\u8c03\u5c0f\u8be5\u503c\u3002</p> <ul> <li>keep\u7f13\u51b2\u533a\uff0c\u5e38\u9a7b\u7684\u6570\u636e\u90fd\u653e\u5728keep\u6570\u636e\u9875\u4e2d\uff0c\u5bf9\u5e94\u7684ini\u53c2\u6570\u5c31\u662fKEEP</li> </ul> <p>KEEP\u7684\u7279\u6027\u662f\u5bf9\u7f13\u51b2\u533a\u4e2d\u7684\u6570\u636e\u9875\u5f88\u5c11\u6216\u51e0\u4e4e\u4e0d\u600e\u4e48\u6dd8\u6c70\u51fa\u53bb\uff0c\u4e3b\u8981\u9488\u5bf9\u7528\u6237\u7684\u5e94\u7528\u662f\u5426\u9700\u8981\u7ecf\u5e38\u5904\u5728\u5185\u5b58\u5f53\u4e2d\u3002</p> <p>\u5982\u679c\u662f\u8fd9\u79cd\u60c5\u51b5\uff0c\u53ef\u4ee5\u6307\u5b9a\u7f13\u51b2\u533a\u4e3aKEEP\u3002\u7528\u6237\u53ef\u4ee5\u5728\u521b\u5efa\u8868\u7a7a\u95f4\u6216\u4fee\u6539\u8868\u7a7a\u95f4\u65f6\uff0c\u6307\u5b9a\u8868\u7a7a\u95f4\u5c5e\u4e8eNORMAL\u6216KEEP\u7f13\u51b2\u533a\u3002</p> <p><code>KEEP</code>: <code>KEEP</code>\u7f13\u51b2\u533a\u5927\u5c0f\uff0c\u4ee5 M \u4e3a\u5355\u4f4d\u3002\u9ed8\u8ba48M\uff0c\u6709\u6548\u503c\u8303\u56f4\uff088~1048576\uff09</p> <ul> <li>recycle\u7f13\u51b2\u533a\uff0c\u9ad8\u5e76\u53d1\u7cfb\u7edf\u3001\u4f7f\u7528with as\u8bed\u53e5\u8f83\u591a\uff0c\u4e34\u65f6\u6570\u636e\u8f83\u591a\u9700\u8981\u5c06\u8fd9\u4e2arecycle\u6570\u636e\u9875\u6240\u5360\u7528\u7684\u5185\u5b58\u503c\u8c03\u5927\uff0c\u5bf9\u5e94\u7684ini\u53c2\u6570\u662frecycle\u3002</li> </ul> <p>RECYCLE\u7f13\u51b2\u533a\u4f9b\u4e34\u65f6\u8868\u7a7a\u95f4\u4f7f\u7528\uff0c\u8bb0\u4f4f\u6240\u6709\u7684\u9875\u5927\u5c0f\u5728\u521d\u59cb\u5316\u5b9e\u4f8b\u65f6\u5df2\u7ecf\u8bbe\u5b9a\u597d\u4e86\uff0c\u73b0\u5728\u4f7f\u7528ini\u53c2\u6570\u4fee\u6539\u7684\u662f\u7f13\u51b2\u533a\u5185\u5b58\u5927\u5c0f\u3002</p> <ul> <li>fast\u7f13\u51b2\u533a\uff0cfast\u5305\u542b\u6570\u636e\u9875\u548c\u56de\u6eda\u9875\uff0c\u5e38\u9a7b\u7f13\u51b2\u533a\uff0c\u8fd9\u4e24\u8005\u90fd\u662f\u7531\u7cfb\u7edf\u81ea\u52a8\u7ba1\u7406\uff0c\u65e0\u9700\u5e72\u6d89\u5bf9\u5e94\u7684ini\u53c2\u6570\u662ffast_pool_pages\u548cfast_roll_pages\uff0c\u4ee3\u8868fast\u7f13\u51b2\u533a\u7684\u5927\u5c0f\u4e3a\u591a\u5c11\u6570\u636e\u9875\u3002</li> </ul> <p>\u4ece\u53c2\u6570\u6765\u770b\uff0cDM\u4e5f\u6709\u7c7b\u4f3cOracle\u7684\u5185\u5b58\u81ea\u52a8\u7ba1\u7406\u673a\u5236\uff0c\u5982memory_target.</p> <p>\u53c2\u6570\u5c5e\u6027\u5206\u4e3a\u4e09\u79cd:\u9759\u6001\u3001\u52a8\u6001\u548c\u624b\u52a8\u3002</p> <ul> <li> <p>\u9759\u6001\uff0c\u53ef\u4ee5\u88ab\u52a8\u6001\u4fee\u6539\uff0c\u4fee\u6539\u540e\u91cd\u542f\u670d\u52a1\u5668\u624d \u80fd\u751f\u6548\u3002</p> </li> <li> <p>\u52a8\u6001\uff0c\u53ef\u4ee5\u88ab\u52a8\u6001\u4fee\u6539\uff0c\u4fee\u6539\u540e\u5373\u65f6\u751f\u6548\u3002\u52a8\u6001\u53c2\u6570\u53c8\u5206\u4e3a**\u4f1a\u8bdd\u7ea7**\u548c**\u7cfb\u7edf\u7ea7**\u4e24\u79cd\u3002</p> </li> </ul> <p>\u4f1a\u8bdd\u7ea7\u53c2\u6570\u88ab\u4fee\u6539\u540e\uff0c\u65b0\u53c2\u6570\u503c\u53ea\u4f1a\u5f71\u54cd\u65b0\u521b\u5efa\u7684\u4f1a\u8bdd\uff0c\u4e4b\u524d\u521b\u5efa\u7684\u4f1a\u8bdd\u4e0d\u53d7\u5f71\u54cd;\u7cfb\u7edf\u7ea7\u53c2\u6570 \u7684\u4fee\u6539\u5219\u4f1a\u5f71\u54cd\u6240\u6709\u7684\u4f1a\u8bdd\u3002</p> <ul> <li>\u624b\u52a8\uff0c\u4e0d\u80fd\u88ab\u52a8\u6001\u4fee\u6539\uff0c\u5fc5\u987b\u624b\u52a8\u4fee\u6539 dm.ini \u53c2\u6570\u6587\u4ef6\uff0c\u7136\u540e\u91cd\u542f\u624d\u80fd\u751f\u6548\u3002</li> </ul>"},{"location":"oracle/06.%E8%BE%BE%E6%A2%A6%E4%BC%98%E5%8C%96/#_11","title":"\u65e5\u5fd7\u7f13\u51b2\u533a","text":"<p>\u65e5\u5fd7\u7f13\u51b2\u533a\u662f\u7528\u4e8e\u5b58\u653e\u91cd\u505a\u65e5\u5fd7\u7684\u5185\u5b58\u7f13\u51b2\u533a\u3002\u4e3a\u4e86\u907f\u514d\u7531\u4e8e\u76f4\u63a5\u7684\u78c1\u76d8 IO \u800c\u4f7f\u7cfb\u7edf\u6027\u80fd\u53d7\u5230\u5f71\u54cd\uff0c\u7cfb\u7edf\u5728\u8fd0\u884c\u8fc7\u7a0b\u4e2d\u4ea7\u751f\u7684\u65e5\u5fd7\u5e76\u4e0d\u4f1a\u7acb\u5373\u88ab\u5199\u5165\u78c1\u76d8\uff0c\u800c\u662f\u548c\u6570\u636e\u9875\u4e00\u6837\uff0c\u5148\u5c06\u5176\u653e\u7f6e\u5230\u65e5\u5fd7\u7f13\u51b2\u533a\u4e2d\u3002\u90a3\u4e48\u4e3a\u4f55\u4e0d\u5728\u6570\u636e\u7f13\u51b2\u533a\u4e2d\u7f13\u5b58\u91cd\u505a\u65e5\u5fd7\u800c\u8981\u5355\u72ec\u8bbe\u7acb\u65e5\u5fd7\u7f13\u51b2\u533a\u5462\uff1f\u4e3b\u8981\u662f\u57fa\u4e8e\u4ee5\u4e0b\u539f\u56e0\uff1a</p> <ol> <li>\u91cd\u505a\u65e5\u5fd7\u7684\u683c\u5f0f\u540c\u6570\u636e\u9875\u5b8c\u5168\u4e0d\u4e00\u6837\uff0c\u65e0\u6cd5\u8fdb\u884c\u7edf\u4e00\u7ba1\u7406\uff1b</li> <li>\u91cd\u505a\u65e5\u5fd7\u5177\u5907\u8fde\u7eed\u5199\u7684\u7279\u70b9\uff1b</li> <li>\u5728\u903b\u8f91\u4e0a\uff0c\u5199\u91cd\u505a\u65e5\u5fd7\u6bd4\u6570\u636e\u9875 IO \u4f18\u5148\u7ea7\u66f4\u9ad8\u3002</li> </ol> <p>DM Server \u63d0\u4f9b\u4e86\u53c2\u6570 <code>RLOG_BUF_SIZE</code> \u5bf9\u65e5\u5fd7\u7f13\u51b2\u533a\u5927\u5c0f\u8fdb\u884c\u63a7\u5236\uff0c\u65e5\u5fd7\u7f13\u51b2\u533a\u6240\u5360\u7528\u7684\u5185\u5b58\u662f\u4ece\u5171\u4eab\u5185\u5b58\u6c60\u4e2d\u7533\u8bf7\u7684\uff0c\u5355\u4f4d\u4e3a\u9875\u6570\u91cf\u3002</p>"},{"location":"oracle/06.%E8%BE%BE%E6%A2%A6%E4%BC%98%E5%8C%96/#sql_3","title":"SQL\u7f13\u51b2\u533a","text":"<p><code>sql buffer</code>\u533a\u76f8\u5f53\u4e8e<code>oracle</code>\u7684<code>shared pool</code>\u4e2d\u7684\u4e00\u90e8\u5206\u6216\u662f<code>library cache</code>\u4e2d\u7684<code>shared sql area</code>\u3002</p> <p>\u7528\u4e8e\u8bb0\u5f55<code>sql text</code>, <code>sql execution plan</code> ,<code>plsql obj</code>\u3002</p> <p>\u5171\u4eab\u6c60\u7684\u76ee\u7684\u662f\u51cf\u5c11\u91cd\u590dSQL\u8bed\u53e5\u7684\u89e3\u6790\u548c\u4f18\u5316\u6210\u672c\uff0c\u63d0\u9ad8\u6570\u636e\u5e93\u7684\u6027\u80fd\u3002\u8fd8\u6709\u5305\u542b\u7c7b\u4f3coracle \u7684result cache</p> <pre><code>select name ,type,value,sys_value,file_value,description from v$parameter where upper(name) like upper('%BUFFER%');\n</code></pre> <p>CACHE_POOL_SIZE\u9ed8\u8ba4\u503c20M</p> <p>\u4e00\u822c\u5728\u5185\u5b58\u5c0f\u4e8e16G\u7684\u60c5\u51b5\u4e0b\uff0c\u5efa\u8bae\u8bbe\u7f6e\u4e3a200M\uff0c\u5185\u5b58\u5927\u4e8e16G\uff0c\u5c0f\u4e8e64G\uff0c\u5efa\u8bae\u8bbe\u7f6e\u4e3a1024M\uff0c\u5f53\u5185\u5b58\u5927\u4e8e64G\u65f6\uff0c\u5efa\u8bae\u8bbe\u7f6e\u4e3a2048M\u3002</p>"},{"location":"oracle/06.%E8%BE%BE%E6%A2%A6%E4%BC%98%E5%8C%96/#_12","title":"\u8fd0\u884c\u65f6\u5185\u5b58\u6c60","text":"<p>\u9664\u4e86\u5171\u4eab\u5185\u5b58\u6c60\uff0c\u5b9e\u4f8b\u7684\u4e00\u4e9b\u529f\u80fd\u6a21\u5757\u5728\u8fd0\u884c\u65f6\u8fd8\u4f1a\u4f7f\u7528\u81ea\u5df1\u7684\u8fd0\u884c\u65f6\u5185\u5b58\u6c60\u3002</p> <p>\u8fd9\u4e9b\u8fd0\u884c\u65f6\u5185\u5b58\u6c60\u4ece\u64cd\u4f5c\u7cfb\u7edf\u7533\u8bf7\u4e00\u7247\u5185\u5b58\u4f5c\u4e3a\u672c\u529f\u80fd\u6a21\u5757\u7684\u5185\u5b58\u6c60\u6765\u4f7f\u7528\uff0c\u5982\u4f1a\u8bdd\u5185\u5b58\u6c60\u3001\u865a\u62df\u673a\u5185\u5b58\u6c60\u7b49\u3002</p> \u5171\u4eab\u5185\u5b58\u6c60 DM Server \u5728\u542f\u52a8\u65f6\u4ece\u64cd\u4f5c\u7cfb\u7edf\u7533\u8bf7\u7684\u4e00\u5927\u7247\u5185\u5b58 \u8fd0\u884c\u65f6\u5185\u5b58\u6c60 \u6570\u636e\u7f13\u51b2\u533a"},{"location":"oracle/06.%E8%BE%BE%E6%A2%A6%E4%BC%98%E5%8C%96/#_13","title":"\u4f1a\u8bdd\u5185\u5b58\u6c60","text":"<p>\u5728DM\u5e93\u4e2d\u6bcf\u4e2a\u6d3b\u52a8\u4f1a\u8bdd\u6709\u81ea\u5df1\u7684\u8fd0\u884c\u65f6\u5185\u5b58\u6c60<code>vm_pool</code>\u548c\u4f1a\u8bdd\u5185\u5b58 <code>sess_pool</code>\uff0c\u5f53 <code>VM_POOL</code> \u548c<code>SESS_POOL</code> \u5927\u5c0f\u4e0d\u8db3\u65f6\uff0c\u4f1a\u5411\u4e3b\u5185\u5b58\u6c60MEM_POOL\u7533\u8bf7\u5185\u5b58\uff0c\u5230\u79c1\u6709\u6c60\u4e0a\u7684 <code>VM_POOL</code> \u548c <code>SESS_POOL</code> \u8fdb\u884c\u6269\u5c55\u3002</p> <p>\u6bcf\u4e2a\u8fde\u63a5\u4f1a\u5206\u914d\u4e00\u4e2asession\u533a\uff0c\u5e94\u7528\u662f\u7528\u4e8e\u5b58\u50a8\u4f1a\u8bdd\u7ea7\u522b\u7684\u6570\u636e\u548c\u53d8\u91cf\uff0c\u5728SQL\u8fd0\u884c\u671f\u95f4\u4f1a\u5206\u914d\u8be5\u5185\u5b58\u533a1\u4e2a\u6216\u591a\u4e2a<code>vm pool</code></p> <pre><code>select name ,type,value,sys_value,file_value,description from v$parameter where upper(name) like upper('%session%');\n\n\nselect name ,type,value,sys_value,file_value,description from v$parameter where upper(name) like upper('%vm%');\n\n--MAX_SESSIONS:\u7f3a\u7701\u503c10000\uff0c\u9759\u6001\u5c5e\u6027\uff0c\u7cfb\u7edf\u8fd0\u884c\u540c\u65f6\u8fde\u63a5\u7684\u6700\u5927\u6570\uff0c\u53d6\u503c\u8303\u56f41-15000\u3002\u5728\u5b89\u5168\u7248\u73af\u5883\u4e0b\uff0c\u8be5\u53c2\u6570\u53d7LICENSE\u7684\u9650\u5236\uff0c\u53d6\u4e8c\u8005\u4e2d\u8f83\u5c0f\u8005\u3002\u5f53\u4f1a\u8bdd\u6570\u8fbe\u5230 MAX_SESSIONS \u503c\u540e\uff0c\u4e3a\u4e86\u4fdd\u8bc1\u7ba1\u7406\u5458\u53ef\u7ee7\u7eed\u7ba1\u7406\u6570\u636e\u5e93\uff0c\u5141\u8bb8 SYSDBA \u989d\u5916\u5f00\u542f 10 \u4e2a\u4f1a\u8bdd\u8fde\u63a5\u3002\n\n--LISTEN_IP\uff1a\u624b\u52a8\u5c5e\u6027\uff0c\u4e0e PORT_NUM \u914d\u5408\u4f7f\u7528\uff0c\u76d1\u542c IP \u5730\u5740\u3002\u82e5\u6307\u5b9a\uff0c\u5219\u8fde\u63a5\u65f6\u5fc5\u987b\u6307\u5b9a\u4e0e\u8be5\u503c\u4e00\u6837\u7684 IP\uff0c\u5426\u5219\u521b\u5efa\u8fde\u63a5\u5931\u8d25\u3002\n\n--MAX_SESSION_STATEMENT\uff1a\u7f3a\u7701\u503c10000\uff0c\u52a8\u6001\u7cfb\u7edf\u7ea7\u5c5e\u6027\uff0c\u5355\u4e2a\u4f1a\u8bdd\u4e0a\u5141\u8bb8\u540c\u65f6\u6253\u5f00\u7684\u8bed\u53e5\u53e5\u67c4\u6700\u5927\u6570\uff0c\u53d6\u503c\u8303\u56f4 64~20480\uff09\u3002\n\n--MAX_SESSION_MEMORY\uff1a\u7f3a\u7701\u503c0\uff0c\u52a8\u6001\u7cfb\u7edf\u7ea7\u5c5e\u6027\uff0c\u5355\u4e2a\u4f1a\u8bdd\u7684\u8fd0\u884c\u5185\u5b58\u4e0a\u9650\uff0c\u5355\u4f4d MB\uff0c\u53d6\u503c\u8303\u56f4 0~262144\uff0c0 \u8868\u793a\u4e0d\u9650\u5236\u3002\n</code></pre>"},{"location":"oracle/06.%E8%BE%BE%E6%A2%A6%E4%BC%98%E5%8C%96/#_14","title":"\u7efc\u5408\u5185\u5b58\u67e5\u8be2","text":"<pre><code>SELECT name,TOTAL_SIZE,TARGET_SIZE,IS_OVERFLOW,FILE_NAME FROM v$mem_pool;\nSELECT name,VALUE,DESCRIPTION FROM v$parameter WHERE name='MEMORY_POOL';\nSELECT PARA_NAME,PARA_VALUE,DESCRIPTION ,PARA_TYPE FROM v$dm_ini WHERE PARA_NAME like '%MEMORY_%';\n\n-- \u5185\u5b58\u603b\u91cf\u67e5\u8be2\uff1a\u8fbe\u68a6\u6570\u636e\u5e93\u4f7f\u7528\u7684\u5185\u5b58\u5927\u81f4\u7b49\u4e8e BUFFER + MPOOL\uff0c\u5bf9\u5e94\u7684 SQL \u8bed\u53e5\u4e3a\nselect\n(select sum(n_pages * page_size)/1024/1024 from v$bufferpool)||'MB' as BUFFER_SIZE, ( select sum(total_size)/1024/1024 from v$mem_pool)||'MB' as mem_pool, (select sum(n_pages * page_size)/1024/1024 from v$bufferpool)+(select sum(total_size)/1024/1024 from\nv$mem_pool)||'MB' as TOTAL_SIZE\nFrom dual;\n\n\nselect name, --\u5185\u5b58\u6c60\u540d\u79f0\nis_shared, --\u662f\u5426\u662f\u5171\u4eab\u7684\nis_overflow, --\u662f\u5426\u7528\u5230\u4e86\u5907\u4efd\u6c60\norg_size/1024.0/1024.0, --\u5185\u5b58\u6c60\u521d\u59cb\u5927\u5c0f\nTOTAL_size/1024.0/1024.0, --\u5185\u5b58\u6c60\u603b\u5927\u5c0f(\u5305\u62ec\u6269\u5c55\u7684)\nRESERVED_SIZE/1024.0/1024.0, --\u5f53\u524d\u5df2\u5206\u914d\u5927\u5c0f(\u5305\u62ec\u6269\u5c55\u7684)\nDATA_SIZE/1024.0/1024.0, --\u5b9e\u9645\u6709\u6548\u5b57\u8282\nEXTEND_SIZE, --\u6bcf\u6b21\u6269\u5c55\u591a\u5c11\nTARGET_SIZE, --\u76ee\u6807\u5927\u5c0f\nN_EXTEND_NORMAL , --TARGET \u8303\u56f4\u5185\u7d2f\u8ba1\u6269\u5c55\u6b21\u6570\nN_EXTEND_EXCLUSIVE --\u8d85\u8fc7 TARGET \u7d2f\u8ba1\u6269\u5c55\u6b21\u6570\nfrom v$mem_pool order by TOTAL_size desc;\n\n\n\u6ce8\u610f\uff1a\n1\u3001N_EXTEND_EXCLUSIVE \u5982\u679c\u957f\u671f\u5927\u4e8e 0\uff0c\u8bf4\u660e\u957f\u671f\u4ece\u6c60\u5916\u6269\u5c55\uff0c\u53ef\u80fd\u5b58\u5728\u5185\u5b58\u6cc4\u9732\u3002\u9700\u8981\u91cd\u70b9\u5173\u6ce8\u3002\n2\u3001\u7528\u5230\u5907\u4efd\u6c60\u7684\u8bdd,\u9700\u8981\u4fdd\u6301\u9ad8\u5ea6\u5173\u6ce8\uff0c\u6b64\u65f6\u7cfb\u7edf\u975e\u5e38\u5371\u9669\u3002\n3\u3001\u5185\u5b58\u6c60\u521b\u5efa\u7684\u7ebf\u7a0b\u53f7 creator \u53ef\u4ee5\u4e0e session \u7684 thrd_id \u5173\u8054\uff0c\u67e5\u770b\u5bf9\u5e94\u7684\u67d0\u4e2a\u4f1a\u8bdd\u7684\u5185\u5b58\u4f7f\u7528\u60c5\u51b5\u3002\n4\u3001\u5982\u679c RESERVED_SIZE \u6bd4 org_size \u5c0f\uff0c\u8bf4\u660e\u5185\u5b58\u6c60\u975e\u5e38\u7a7a\u95f2\uff0c\u9700\u8981\u628a\u5bf9\u4e8e\u7684\u521d\u59cb\u5185\u5b58\u653e\u5c0f\uff0c\u5426\u5219\u6d6a\u8d39\u3002\n5\u3001\u5982\u679c TOTAL_size \u6bd4 TARGET_SIZE \u5927\uff0c\u8bf4\u660e\u5185\u5b58\u6c60\u4e0d\u591f\uff0c\u7ecf\u5e38\u5411\u6c60\u5916\u7533\u8bf7\uff0c\u9700\u8981\u628a\u5bf9\u4e8e\u7684\u53c2\u6570\u8c03\u5927\u3002\u5c3d\u91cf\u4fdd\u6301\u6bcf\u4e2a\u6c60\u81ea\u6301\u3002\n\n\n2.2 \u5982\u4f55\u5224\u65ad BUFFER \u7a7a\u95f2\u8fd8\u662f\u7d27\u5f20\nselect name, --\u7f13\u51b2\u533a\u540d\u79f0\nn_pages, --\u9875\u6570\nfree, --\u7a7a\u95f2\u9875\u6570\u76ee\nN_DISCARD64 --\u6dd8\u6c70\u7684\u9875\u6570\nfrom v$bufferpool\n\u6ce8\u610f\u91cd\u70b9\uff1a\n1\u3001\u5982\u679c free \u5f88\u591a\u8bf4\u660e\u8be5\u7f13\u51b2\u533a\u5f88\u7a7a\u95f2\uff0c\u53ef\u4ee5\u9002\u5f53\u7684\u8c03\u6574\u964d\u4f4e buffer \u7f13\u51b2\u533a\u53c2\u6570\u503c\u3002\n2\u3001\u5982\u679c free \u9879\u4e3a 0\uff0c\u6216\u8005 N_DISCARD64 \u975e\u96f6\uff0c\u8868\u793a\u8be5\u7f13\u51b2\u533a\u7ecf\u5e38\u6dd8\u6c70\u3002\u8fd9\u79cd\u60c5\u51b5\uff0c\u5c31\u8bf4\u660e\u5bf9\u5e94\u7684\u7f13\u51b2\u533a\n\u53c2\u6570\u592a\u5c0f\uff0c\u5bfc\u81f4\u9891\u7e41\u6dd8\u6c70\uff0c\u9700\u8981\u8c03\u6574\u5bf9\u5e94\u7684\u7f13\u51b2\u533a\u7684\u53c2\u6570\u3002\n</code></pre> <pre><code>SELECT para_name,para_value,MAX_VALUE,DEFAULT_VALUE,DESCRIPTION,PARA_TYPE \n    FROM v$dm_ini \nWHERE para_name LIKE '%MEMORY%';\n\n\n\n\nselect a.mem_all mem_size, b.mem_all buffer_size,a.MEM_ALL+b.MEM_ALL MEM_M,a.MEM_USED+b.MEM_USED USED_M\nfrom\n(select sum(TOTAL_SIZE)/1024/1024 MEM_ALL,\nsum(RESERVED_SIZE)/1024/1024 MEM_USED \nfrom v$mem_pool)a,\n(select sum(PAGE_SIZE*N_PAGES)/1024/1024 MEM_ALL,\nsum(PAGE_SIZE*(N_PAGES-FREE))/1024/1024 MEM_USED \nfrom v$bufferpool) b\n\n\nSELECT name, is_shared,CHK_LEAK,IS_OVERFLOW,sum(ORG_SIZE) t_ORG_SIZE,sum(TOTAL_SIZE) t_TOTAL_SIZE,sum(TARGET_SIZE)          t_TARGET_SIZE,count(*) cnt  FROM V$MEM_POOl\nGROUP BY name, is_shared,CHK_LEAK,IS_OVERFLOW  order by 6 desc;\n</code></pre>"},{"location":"oracle/06.%E8%BE%BE%E6%A2%A6%E4%BC%98%E5%8C%96/#_15","title":"\u8fbe\u68a6\u5185\u5b58\u5229\u7528\u8fc7\u9ad8\u5206\u6790","text":"<p>\u5f53\u5185\u5b58\u7387\u4f7f\u7528\u8f83\u9ad8\u65f6</p> <ol> <li>\u67e5\u770bdmserver\u8fdb\u7a0b\u5360\u7528\u5185\u5b58 ps</li> <li>\u67e5\u770b\u7ebf\u7a0b\u5185\u5b58 top -H -p</li> <li>\u7edf\u8ba1buffer pool\u548cmem_pool\u5185\u5b58\u533a\u4f7f\u7528</li> <li>\u67e5\u627e\u4f7f\u7528\u5927\u5185\u5b58\u8fdb\u7a0b</li> <li>\u8f93\u51faproc meminfo\u4fe1\u606f</li> <li>pmap\u67e5\u770b\u8fdb\u7a0b\u5185\u5b58</li> </ol> <p>https://www.anbob.com/archives/7427.html</p>"},{"location":"oracle/06.%E8%BE%BE%E6%A2%A6%E4%BC%98%E5%8C%96/#_16","title":"\u6570\u636e\u5e93\u5185\u5b58\u76f8\u5173\u53c2\u6570","text":"\u53c2\u6570\u540d \u7f3a\u7701\u503c \u5c5e\u6027 \u8bf4\u660e MAX_OS_MEMORY 100 \u9759\u6001 DM\u670d\u52a1\u5668\u80fd\u4f7f\u7528\u7684\u6700\u5927\u5185\u5b58\u5360\u64cd\u4f5c\u7cfb\u7edf\u7269\u7406\u5185\u5b58\u4e0e\u865a\u62df\u5185\u5b58\u603b\u548c\u7684\u767e\u5206\u6bd4\uff0c\u6709\u6548\u503c\u8303\u56f4\uff0840~100\uff09\u3002\u5f53\u53d6\u503c100\u65f6\uff0c\u670d\u52a1\u5668\u4e0d\u8fdb\u884c\u5185\u5b58\u7684\u68c0\u67e5 \u6ce8\uff1a\u5bf9\u4e8e32\u4f4d\u7248\u672c\u7684DM\u670d\u52a1\u5668\uff0c\u865a\u62df\u5185\u5b58\u6700\u5927\u4e3a2G MEMORY_POOL 200 \u9759\u6001 \u5171\u4eab\u5185\u5b58\u6c60\u5927\u5c0f\uff0c\u4ee5M\u4e3a\u5355\u4f4d\u3002\u5171\u4eab\u5185\u5b58\u6c60\u662f\u7531DM\u7ba1\u7406\u7684\u5185\u5b58\u3002\u6709\u6548\u503c\u8303\u56f4\uff1a32\u4f4d\u5e73\u53f0\u4e3a\uff08642000\uff09\uff0c64\u4f4d\u5e73\u53f0\u4e3a\uff086467108864\uff09 MEMORY_N_POOLS 1 \u9759\u6001 \u5171\u4eab\u5185\u5b58\u6c60\u4e2a\u6570\uff0c\u6709\u6548\u503c\u8303\u56f4\uff080~2048\uff09\uff0c0\u4e0e1\u7b49\u4ef7\uff0c\u5373\u5171\u4eab\u6c60\u4e0d\u5206\u7247\u3002\u5206\u7247\u65f6\uff0c\u6bcf\u6c60\u7684\u521d\u59cb\u5bb9\u91cf\u4e3aMEMORY_POOL / MEMORY_N_POOLS, \u4f46\u53d7\u6700\u5c0f\u521d\u59cb\u5bb9\u91cf\u4e3a30M\u9650\u5236\uff0c\u56e0\u6b64\u5b9e\u9645\u5206\u7247\u6570\u53ef\u80fd\u4f1a\u5c0f\u4e8eMEMORY_N_POOLS\uff0c\u6bcf\u4e2a\u6c60\u7684TARGET\u4e5f\u6309\u6b64\u65b9\u5f0f\u7531MEMORY_TARGET\u5bfc\u51fa MEMORY_TARGET 0 \u52a8\u6001\uff0c\u7cfb\u7edf\u7ea7 \u5171\u4eab\u5185\u5b58\u6c60\u5728\u6269\u5145\u5230\u6b64\u5927\u5c0f\u4ee5\u4e0a\u540e\uff0c\u7a7a\u95f2\u65f6\u6536\u7f29\u56de\u6b64\u6307\u5b9a\u5927\u5c0f\uff0c\u4ee5M\u4e3a\u5355\u4f4d\uff0c\u6709\u6548\u503c\u8303\u56f4\uff1a32\u4f4d\u5e73\u53f0\u4e3a\uff0802000\uff09\uff0c64\u4f4d\u5e73\u53f0\u4e3a\uff08067108864\uff09\uff0c0\u8868\u793a\u4e0d\u9650\u5236 MEMORY_EXTENT_SIZE 1 \u9759\u6001 \u5171\u4eab\u5185\u5b58\u6c60\u6bcf\u6b21\u6269\u5145\u7684\u5927\u5c0f\uff0c\u4ee5M\u4e3a\u5355\u4f4d\uff0c\u6709\u6548\u503c\u8303\u56f4\uff081~10240\uff09 MEMORY_LEAK_CHECK 0 \u52a8\u6001\uff0c\u7cfb\u7edf\u7ea7 \u662f\u5426\u5f00\u542f\u5185\u5b58\u6cc4\u6f0f\u68c0\u6d4b\u30020\uff1a\u5426\uff1b1\uff1a\u662f\uff0c\u6b64\u65f6\u7cfb\u7edf\u5bf9\u6bcf\u4e00\u6b21\u5185\u5b58\u5206\u914d\u90fd\u767b\u8bb0\u5230\u52a8\u6001\u89c6\u56feV$MEM_REGINFO\u4e2d\uff0c \u5e76\u5728\u91ca\u653e\u65f6\u89e3\u9664\u767b\u8bb0 MEMORY_MAGIC_CHECK 2 \u9759\u6001 \u662f\u5426\u5f00\u542f\u5bf9\u6240\u6709\u5185\u5b58\u6c60\u7684\u6821\u9a8c\u30020\uff1a\u4e0d\u5f00\u542f\uff1b1\uff1a\u5f00\u542f\u6821\u9a8c\uff0c\u6821\u9a8c\u7801\u57fa\u4e8e\u5206\u914d\u51fa\u7684\u5757\u5730\u5740\u8ba1\u7b97\uff0c\u5728\u88ab\u5206\u914d\u7a7a\u95f4\u7684\u5934\u90e8\u548c\u5c3e\u90e8\u5199\u5165\u6821\u9a8c\u7801\uff1b2\uff1a\u589e\u5f3a\u6821\u9a8c\uff0c\u57281\u7684\u57fa\u7840\u4e0a\uff0c\u5982\u679c\u662f\u5185\u5b58\u6c60\u5206\u914d\u7684\uff0c\u5219\u5bf9\u5c3e\u90e8\u672a\u4f7f\u7528\u7a7a\u95f4\u4e5f\u8ba1\u7b97\u6821\u9a8c\u7801\uff0c\u5199\u5165\u672a\u4f7f\u7528\u7a7a\u95f4\u7684\u5934\u90e8 HUGEPAGE_THRESHOLD 32 \u52a8\u6001\uff0c\u7cfb\u7edf\u7ea7 \u5982\u679c\u4eceOS\u7533\u8bf7\u5185\u5b58\u7684\u5c3a\u5bf8\u5927\u4e8e\u7b49\u4e8e HUGEPAGE_THRESHOLD * 2M\uff0c \u5219\u5c1d\u8bd5\u5148\u7533\u8bf7\u5de8\u9875\u5185\u5b58\uff0c\u82e5\u5931\u8d25\u518d\u7533\u8bf7\u5e38\u89c4\u5185\u5b58\uff1b 0\u8868\u793a\u4e0d\u5c1d\u8bd5\u4f7f\u7528\u5de8\u9875\u5185\u5b58\u3002\u6709\u6548\u503c\u8303\u56f4\uff080~1024\uff09\u3002\u6ce8\uff1a\u672c\u53c2\u6570\u4ec5\u5bf9LINUX\u64cd\u4f5c\u7cfb\u7edf\u6709\u6548\uff0c\u4f7f\u7528\u5de8\u9875\u5185\u5b58\u9700\u8981\u5bf9OS\u8fdb\u884c\u76f8\u5173\u914d\u7f6e MEMORY_BAK_POOL 4 \u9759\u6001 \u7cfb\u7edf\u5907\u4efd\u5185\u5b58\u6c60\u5927\u5c0f\uff0c\u4ee5M\u4e3a\u5355\u4f4d\u3002\u7cfb\u7edf\u5907\u4efd\u5185\u5b58\u6c60\u662f\u7531DM\u7ba1\u7406\u7684\u5185\u5b58\u3002\u6709\u6548\u503c\u8303\u56f4\uff082~10000\uff09 HUGE_MEMORY_PERCENTAGE 50 \u9759\u6001 \u6307\u793aHUGE_BUFFER\u4e2d\u53ef\u4ee5\u501f\u7528\u4f5c\u5e38\u89c4\u5185\u5b58\u5206\u914d\u7684\u7a7a\u95f4\u767e\u5206\u6bd4\uff0c\u6709\u6548\u503c\u4e3a0~100\u3002 HUGE_BUFFER 80 \u9759\u6001 HUGE\u8868\u4f7f\u7528\u7684\u7f13\u51b2\u533a\u5927\u5c0f\uff0c\u4ee5M\u4e3a\u5355\u4f4d\u3002\u6709\u6548\u503c\u8303\u56f4\uff0880~1048576\uff09 HUGE_BUFFER_POOLS 4 \u9759\u6001 HUGE BUFFER\u7cfb\u7edf\u5206\u533a\u6570\uff0c\u6bcf\u4e2aHUGE BUFFER\u5206\u533a\u7684\u5927\u5c0f\u4e3aHUGE_BUFFER/HUGE_BUFFER_POOLS\u3002\u6709\u6548\u503c\u8303\u56f4\uff081~512\uff09 BUFFER 100 \u9759\u6001 \u7cfb\u7edf\u7f13\u51b2\u533a\u5927\u5c0f\uff0c\u4ee5M\u4e3a\u5355\u4f4d\u3002\u63a8\u8350\u503c\uff1a\u7cfb\u7edf\u7f13\u51b2\u533a\u5927\u5c0f\u4e3a\u53ef\u7528\u7269\u7406\u5185\u5b58\u768460%\uff5e80%\u3002\u6709\u6548\u503c\u8303\u56f4\uff088~1048576\uff09 BUFFER_POOLS 19 \u9759\u6001 BUFFER\u7cfb\u7edf\u5206\u533a\u6570\uff0c\u6bcf\u4e2aBUFFER\u5206\u533a\u7684\u5927\u5c0f\u4e3aBUFFER/BUFFER_POOLS\u3002\u6709\u6548\u503c\u8303\u56f4\uff081~512\uff09 FAST_POOL_PAGES 3000 \u9759\u6001 \u5feb\u901f\u7f13\u51b2\u533a\u9875\u6570\u3002\u6709\u6548\u503c\u8303\u56f4\uff080~99999999\uff09\u3002 FAST_POOL_PAGES\u7684\u503c\u6700\u591a\u4e0d\u80fd\u8d85\u8fc7BUFFER\u603b\u9875\u6570\u7684\u4e00\u534a\uff0c\u5982\u679c\u8d85\u8fc7\uff0c\u7cfb\u7edf\u4f1a\u81ea\u52a8\u8c03\u6574\u4e3aBUFFER\u603b\u9875\u6570\u7684\u4e00\u534a FAST_ROLL_PAGES 1000 \u9759\u6001 BUFFER\u4e2dFAST POOL\u56de\u6eda\u9875\u6570\u91cf\u3002\u6709\u6548\u503c\u8303\u56f4(0<sub>9999999)\uff0c\u6700\u591a\u4e0d\u8d85\u8fc7FAST_POOL_PAGES\u768475%\uff0c\u5982\u679c\u8d85\u8fc7\uff0c\u7cfb\u7edf\u4f1a\u81ea\u52a8\u8c03\u6574\u3002\u586b\u5145\u89c4\u5219\uff1a\u5c06\u56de\u6eda\u8868\u7a7a\u95f40\u53f7\u6587\u4ef6\u76840</sub>FAST_ROLL_PAGE-1\u53f7\u9875\u586b\u5165FAST POOL\u4e2d KEEP 8 \u9759\u6001 KEEP\u7f13\u51b2\u533a\u5927\u5c0f\uff0c\u4ee5M\u4e3a\u5355\u4f4d\u3002\u6709\u6548\u503c\u8303\u56f4\uff088~1048576\uff09 RECYCLE 64 \u9759\u6001 RECYCLE\u7f13\u51b2\u533a\u5927\u5c0f\uff0c\u4ee5M\u4e3a\u5355\u4f4d\u3002\u6709\u6548\u503c\u8303\u56f4\uff088~1048576\uff09 RECYCLE_POOLS 19 \u9759\u6001 RECYCLE\u7f13\u51b2\u533a\u5206\u533a\u6570\uff0c\u6bcf\u4e2aRECYCLE\u5206\u533a\u7684\u5927\u5c0f\u4e3aRECYCLE/RECYCLE_POOLS\u3002\u6709\u6548\u503c\u8303\u56f4\uff081~512\uff09 MULTI_PAGE_GET_NUM 1 \u52a8\u6001\uff0c\u7cfb\u7edf\u7ea7 \u7f13\u51b2\u533a\u6700\u591a\u4e00\u6b21\u8bfb\u53d6\u7684\u9875\u9762\u6570\u3002\u6709\u6548\u503c\u8303\u56f4\uff081~64\uff09 \u6ce8\uff1a\u5f53\u6570\u636e\u5e93\u52a0\u5bc6\u65f6\u4e0d\u652f\u6301\u591a\u9875\u8bfb\u53d6\uff0c\u6b64\u65f6DM.INI\u4e2d\u6b64\u53c2\u6570\u503c\u65e0\u6548 PRELOAD_SCAN_NUM 0 \u52a8\u6001\uff0c\u7cfb\u7edf\u7ea7 \u6570\u636e\u9875\u9996\u6b21\u9884\u52a0\u8f7d\u65f6\u8fde\u7eed\u626b\u63cf\u7684\u9875\u6570\uff0c\u6709\u6548\u503c\u8303\u56f4\uff080~64\uff09\u3002\u53d6\u503c\u4e3a0\u65f6\u5173\u95ed\u6570\u636e\u9875\u9884\u52a0\u8f7d\u529f\u80fd \u6ce8\uff1aPRELOAD_SCAN_NUM\u5b9e\u9645\u6709\u6548\u8303\u56f4\u4e3a\uff080 ~ EXTENT_SIZE \u2013 2\uff09,\u5f53\u5927\u4e8eEXTENT - 2\u65f6\u5c06\u4f1a\u95f4\u63a5\u5931\u6548\u9884\u52a0\u8f7d PRELOAD_EXTENT_NUM 0 \u52a8\u6001\uff0c\u7cfb\u7edf\u7ea7 \u6570\u636e\u9875\u9996\u6b21\u9884\u52a0\u8f7d\u7684\u7c07\u6570\u91cf\uff0c\u6709\u6548\u503c\u8303\u56f4\uff080~64\uff09\u3002\u53d6\u503c\u4e3a0\u65f6\u5173\u95ed\u6570\u636e\u9875\u9884\u52a0\u8f7d\u529f\u80fd SORT_FLAG 0 \u52a8\u6001\uff0c\u4f1a\u8bdd\u7ea7 \u6392\u5e8f\u673a\u5236\uff0c0\uff1a\u539f\u6392\u5e8f\u673a\u5236\uff1b1\uff1a\u65b0\u6392\u5e8f\u673a\u5236 SORT_BUF_SIZE 2 \u52a8\u6001\uff0c\u4f1a\u8bdd\u7ea7 \u539f\u6392\u5e8f\u673a\u5236\u4e0b\uff0c\u6392\u5e8f\u7f13\u5b58\u533a\u6700\u5927\u503c\uff0c\u4ee5M\u4e3a\u5355\u4f4d\u3002\u6709\u6548\u503c\u8303\u56f4\uff081~2048\uff09 SORT_BUF_GLOBAL_SIZE 1000 \u52a8\u6001\uff0c\u7cfb\u7edf\u7ea7 \u65b0\u6392\u5e8f\u673a\u5236\u4e0b\uff0c\u6392\u5e8f\u5168\u5c40\u5185\u5b58\u4f7f\u7528\u4e0a\u9650\uff0c\u4ee5M\u4e3a\u5355\u4f4d\u3002\u6709\u6548\u503c\u8303\u56f4\uff0810~4294967294\uff09 SORT_BLK_SIZE 1 \u52a8\u6001\uff0c\u4f1a\u8bdd\u7ea7 \u65b0\u6392\u5e8f\u673a\u5236\u4e0b\uff0c\u6bcf\u4e2a\u6392\u5e8f\u5206\u7247\u7a7a\u95f4\u7684\u5927\u5c0f\uff0c\u4ee5M\u4e3a\u5355\u4f4d\uff0c\u5fc5\u987b\u5c0f\u4e8eSORT_BUF_GLOBAL_SIZE\u3002\u6709\u6548\u503c\u8303\u56f4\uff081~50\uff09 HAGR_HASH_SIZE 100000 \u52a8\u6001\uff0c\u4f1a\u8bdd\u7ea7 HAGR\u64cd\u4f5c\u65f6\uff0c\u5efa\u7acbHASH\u8868\u7684\u6876\u4e2a\u6570\u3002\u6709\u6548\u503c\u8303\u56f4\uff0810000~100000000\uff09 MAL_LEAK_CHECK 0 \u52a8\u6001\uff0c\u7cfb\u7edf\u7ea7 \u662f\u5426\u6253\u5f00MAL\u5185\u5b58\u6cc4\u9732\u68c0\u67e5\u30020\uff1a\u5173\u95ed\uff1b1\uff1a\u6253\u5f00 MAL_LEAK_CHECK\u4e3a1\u65f6\uff0c\u53ef\u67e5\u8be2V$MAL_USING_LETTERS\u68c0\u67e5MAL\u5185\u5b58\u6cc4\u9732\u3002 HJ_BUF_GLOBAL_SIZE 500 \u52a8\u6001\uff0c\u7cfb\u7edf\u7ea7 HASH \u8fde\u63a5\u64cd\u4f5c\u7b26\u7684\u6570\u636e\u603b\u7f13\u5b58\u5927\u5c0f\uff08&gt;= HJ_BUF_SIZE\uff09\uff0c\u7cfb\u7edf\u7ea7\u53c2\u6570\uff0c\u4ee5M\u4e3a\u5355\u4f4d\u3002\u6709\u6548\u503c\u8303\u56f4(10~500000) HJ_BUF_SIZE 50 \u52a8\u6001\uff0c\u4f1a\u8bdd\u7ea7 \u5355\u4e2aHASH\u8fde\u63a5\u64cd\u4f5c\u7b26\u7684\u6570\u636e\u603b\u7f13\u5b58\u5927\u5c0f\uff0c\u4ee5M\u4e3a\u5355\u4f4d\uff0c\u5fc5\u987b\u5c0f\u4e8eHJ_BUF_GLOBAL_SIZE\u3002\u6709\u6548\u503c\u8303\u56f4\uff082~100000\uff09 HJ_BLK_SIZE 1 \u52a8\u6001\uff0c\u4f1a\u8bdd\u7ea7 HASH\u8fde\u63a5\u64cd\u4f5c\u7b26\u6bcf\u6b21\u5206\u914d\u7f13\u5b58\uff08BLK\uff09\u5927\u5c0f\uff0c\u4ee5M\u4e3a\u5355\u4f4d\uff0c\u5fc5\u987b\u5c0f\u4e8eHJ_BUF_SIZE\u3002\u6709\u6548\u503c\u8303\u56f4\uff081~50\uff09 HAGR_BUF_GLOBAL_SIZE 500 \u52a8\u6001\uff0c\u7cfb\u7edf\u7ea7 HAGR\u3001DIST\u3001\u96c6\u5408\u64cd\u4f5c\u3001SPL2\u3001NTTS2\u4ee5\u53caHTAB\u64cd\u4f5c\u7b26\u7684\u6570\u636e\u603b\u7f13\u5b58\u5927\u5c0f\uff08&gt;= HAGR_BUF_SIZE\uff09\uff0c\u7cfb\u7edf\u7ea7\u53c2\u6570\uff0c\u4ee5M\u4e3a\u5355\u4f4d\u3002\u6709\u6548\u503c\u8303\u56f4(10~1000000) HAGR_BUF_SIZE 50 \u52a8\u6001\uff0c\u4f1a\u8bdd\u7ea7 \u5355\u4e2aHAGR\u3001DIST\u3001\u96c6\u5408\u64cd\u4f5c\u3001SPL2\u3001NTTS2\u4ee5\u53caHTAB\u64cd\u4f5c\u7b26\u7684\u6570\u636e\u603b\u7f13\u5b58\u5927\u5c0f\uff0c\u4ee5M\u4e3a\u5355\u4f4d\u3002\u6709\u6548\u503c\u8303\u56f4\uff082~500000\uff09\u3002 \u5982\u679cHAGR_BUF_SIZE\u8bbe\u7f6e\u7684\u503c\u6ee1\u8db3\u8303\u56f4\u4e14\u5927\u4e8eHAGR_BUF_GLOBAL_SIZE\uff0c\u90a3\u4e48\u4f1a\u5728HAGR_BUF_GLOBAL_SIZE/2\u548c500000\u4e24\u4e2a\u503c\u4e2d\uff0c\u9009\u51fa\u8f83\u5c0f\u7684\u90a3\u4e2a\uff0c\u4f5c\u4e3a\u65b0\u7684HAGR_BUF_SIZE\u503c\u3002 HAGR_BLK_SIZE 1 \u52a8\u6001\uff0c\u4f1a\u8bdd\u7ea7 HAGR\u3001DIST\u3001\u96c6\u5408\u64cd\u4f5c\u3001SPL2\u3001NTTS2\u4ee5\u53caHTAB\u64cd\u4f5c\u7b26\u6bcf\u6b21\u5206\u914d\u7f13\u5b58\uff08BLK\uff09\u5927\u5c0f\uff0c\u4ee5M\u4e3a\u5355\u4f4d\uff0c\u5fc5\u987b\u5c0f\u4e8eHAGR_BUF_SIZE\u3002\u6709\u6548\u503c\u8303\u56f4\uff081~50\uff09 MTAB_MEM_SIZE 8 \u9759\u6001 MTAB\u7f13\u5b58BDTA\u5360\u7528\u5185\u5b58\u7a7a\u95f4\u7684\u5927\u5c0f\uff0c\u4ee5KB\u4e3a\u5355\u4f4d\uff0c\u6709\u6548\u503c\u8303\u56f4\uff081~1048576\uff09 FTAB_MEM_SIZE 0 \u9759\u6001 FTAB\u7f13\u5b58BDTA\u5360\u7528\u5185\u5b58\u7a7a\u95f4\u7684\u5927\u5c0f\uff0c\u4ee5KB\u4e3a\u5355\u4f4d\u3002\u53d6\u503c\u8303\u56f4\u4e3a(0~64 * 1024)\u30020\u8868\u793a\u4f7f\u7528MTAB\uff0c\u5927\u4e8e0\u65f6\u624d\u4f7f\u7528FTAB\u3002\u5f53\u53d6\u503c\u5c0f\u4e8e32\u65f6\uff0cFTAB_MEM_SIZE\u5747\u4f7f\u752832 MMT_SIZE 0 \u52a8\u6001\uff0c\u4f1a\u8bdd\u7ea7 \u662f\u5426\u4f7f\u7528MMT\u30020\uff1a\u4e0d\u542f\u7528\uff1b\u5176\u4ed6\u6709\u6548\u503c\uff1a\u542f\u7528\uff0c\u5e76\u786e\u5b9a\u5355\u4e2a\u6620\u5c04\u6587\u4ef6\u5927\u5c0f\uff0c\u5fc5\u987b\u5c0f\u4e8eMMT_GLOBAL_SIZE\u3002\u6709\u6548\u503c\u8303\u56f4\uff080~64\uff09\uff0c\u5355\u4f4dMB MMT_GLOBAL_SIZE 4000 \u52a8\u6001\uff0c\u7cfb\u7edf\u7ea7 \u7cfb\u7edf\u603b\u5171\u4f7f\u7528MMT\u7684\u6587\u4ef6\u603b\u5927\u5c0f\uff0c\u5355\u4f4dMB\uff0c\u6709\u6548\u503c\u8303\u56f4\uff0810~1000000\uff09\uff0c\u4ec5\u5728MMT_SIZE\u5927\u4e8e0\u65f6\u6709\u6548 MMT_FLAG 1 \u52a8\u6001\uff0c\u4f1a\u8bdd\u7ea7 MMT\u5b58\u50a8\u6570\u636e\u65b9\u5f0f\u30021\uff1a\u6309\u9875\u5b58\u50a8\uff1b2\uff1aBDTA\u5b58\u50a8\u3002\u4ec5\u5728MMT_SIZE\u5927\u4e8e0\u65f6\u6709\u6548 DICT_BUF_SIZE 5 \u9759\u6001 \u5b57\u5178\u7f13\u51b2\u533a\u5927\u5c0f\uff0c\u4ee5M\u4e3a\u5355\u4f4d\uff0c\u6709\u6548\u503c\u8303\u56f4\uff081~2048\uff09\u3002\u5355\u4f4d\uff1aMB HFS_CACHE_SIZE 160 \u52a8\u6001\uff0c\u7cfb\u7edf\u7ea7 HUGE\u8868 I/U/D \u65f6HDTA_BUFFER\u7f13\u5b58\u6c60\u5927\u5c0f\uff0c\u5355\u4f4d\u4e3aMB\u3002\u6709\u6548\u503c\u8303\u56f4\uff08160~ 2000\uff09 VM_STACK_SIZE 256 \u9759\u6001 \u7cfb\u7edf\u6267\u884c\u65f6\u865a\u62df\u673a\u5806\u6808\u5927\u5c0f\uff0c\u5355\u4f4d\u4e3aK\uff0c\u5806\u6808\u7684\u7a7a\u95f4\u662f\u4ece\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u7533\u8bf7\u7684\uff0c\u6709\u6548\u503c\u8303\u56f4\uff0864~256*1024\uff09 VM_POOL_SIZE 64 \u9759\u6001 \u7cfb\u7edf\u6267\u884c\u65f6\u865a\u62df\u673a\u5185\u5b58\u6c60\u5927\u5c0f\uff0c\u5728\u6267\u884c\u8fc7\u7a0b\u4e2d\u7528\u5230\u7684\u5185\u5b58\u5927\u90e8\u5206\u662f\u4ece\u8fd9\u91cc\u7533\u8bf7\u7684\uff0c\u5b83\u7684\u7a7a\u95f4\u662f\u4ece\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u76f4\u63a5\u7533\u8bf7\u7684\uff0c\u6709\u6548\u503c\u8303\u56f4\uff0832~1024*1024\uff09 VM_POOL_TARGET 32768 \u9759\u6001 \u865a\u62df\u673a\u5185\u5b58\u6c60\u80fd\u6269\u5145\u5230\u7684\u6700\u5927\u5927\u5c0f\uff0c\u4ee5KB\u4e3a\u5355\u4f4d\uff0c\u6709\u6548\u503c\u8303\u56f4\uff080~10*1024*1024\uff09\uff0c0\u8868\u793a\u4e0d\u9650\u5236 SESS_POOL_SIZE 64 \u52a8\u6001\uff0c\u7cfb\u7edf\u7ea7 \u4f1a\u8bdd\u7f13\u51b2\u533a\u5927\u5c0f\uff0c\u4ee5KB\u4e3a\u5355\u4f4d\uff0c\u6709\u6548\u503c\u8303\u56f4\uff0816~1024*1024\uff09\u3002\u82e5\u6240\u7533\u8bf7\u7684\u5185\u5b58\u8d85\u8fc7\u5b9e\u9645\u80fd\u7533\u8bf7\u7684\u5927\u5c0f\uff0c\u5219\u7cfb\u7edf\u5c06\u630916KB\u5927\u5c0f\u91cd\u65b0\u7533\u8bf7 SESS_POOL_TARGET 32768 \u52a8\u6001\uff0c\u7cfb\u7edf\u7ea7 \u4f1a\u8bdd\u7f13\u51b2\u533a\u80fd\u6269\u5145\u5230\u7684\u6700\u5927\u5927\u5c0f\uff0c\u4ee5KB\u4e3a\u5355\u4f4d\uff0c\u6709\u6548\u503c\u8303\u56f4\uff080~10*1024*1024\uff09\uff0c0\u8868\u793a\u4e0d\u9650\u5236 RT_HEAP_TARGET 8192 \u52a8\u6001\uff0c\u7cfb\u7edf\u7ea7 \u4f1a\u8bdd\u4e0a\u7528\u4e8e\u52a8\u6001\u5bf9\u8c61\u5b58\u50a8\u7684RT_HEAP\u6700\u5927\u53ef\u6269\u5c55\u5230\u7684\u5927\u5c0f\uff0c\u4ee5K\u4e3a\u5355\u4f4d\uff0c\u6709\u6548\u503c\u8303\u56f4\uff088192~10*1024*1024\uff09 VM_MEM_HEAP 0 \u52a8\u6001\uff0c\u7cfb\u7edf\u7ea7 VM\u662f\u5426\u4f7f\u7528HEAP\u5206\u914d\u5185\u5b58\u30020\uff1aMEMORY POOL\u6a21\u5f0f\uff1b1\uff1aHEAP\u6a21\u5f0f\uff1b2\uff1aMEMORY POOL\u548cHEAP\u6df7\u5408\u6a21\u5f0f RFIL_RECV_BUF_SIZE 16 \u9759\u6001 \u63a7\u5236\u670d\u52a1\u5668\u542f\u52a8\u65f6\uff0c\u8fdb\u884cREDO\u64cd\u4f5c\u8fc7\u7a0b\u4e2d\uff0cREDO\u65e5\u5fd7\u6587\u4ef6\u6062\u590d\u65f6BUFFER\u7684\u5927\u5c0f\uff0c\u4ee5MB\u4e3a\u5355\u4f4d\uff0c\u6709\u6548\u503c\u8303\u56f4\uff0816~4000\uff09 COLDATA_POOL_SIZE 0 \u52a8\u6001\uff0c\u7cfb\u7edf\u7ea7 COLDATA\u6c60\u7684\u5927\u5c0f\uff0c\u4ee5M\u4e3a\u5355\u4f4d HAGR_DISTINCT_HASH_TABLE_SIZE 10000 \u52a8\u6001\uff0c\u4f1a\u8bdd\u7ea7 \u5206\u7ec4DISTINCT\u64cd\u4f5c\u4e2dHASH\u8868\u7684\u5927\u5c0f\uff08\u6876\u6570\uff09\u3002\u53d6\u503c\u8303\u56f4\u4e3a(10000~100000000) CNNTB_HASH_TABLE_SIZE 100 \u52a8\u6001\uff0c\u4f1a\u8bdd\u7ea7 \u6307\u5b9aCNNTB\u64cd\u4f5c\u7b26\u4e2d\u521b\u5efaHASH\u8868\u7684\u5927\u5c0f\u3002\u6709\u6548\u503c\u8303\u56f4\uff08100~100000000\uff09 GLOBAL_RTREE_BUF_SIZE 100 \u52a8\u6001\uff0c\u4f1a\u8bdd\u7ea7 R\u6811\u5168\u5c40\u7f13\u51b2\u533a\u5927\u5c0f\uff0c\u4ee5MB\u4e3a\u5355\u4f4d SINGLE_RTREE_BUF_SIZE 10 \u52a8\u6001\uff0c\u4f1a\u8bdd\u7ea7 \u5355\u4e2aR\u6811\u7684\u7f13\u51b2\u533a\u5927\u5c0f\uff0c\u4ee5MB\u4e3a\u5355\u4f4d\uff0c\u5fc5\u987b\u5c0f\u4e8eGLOBAL_RTREE_BUF_SIZE SORT_OPT_SIZE 1 \u9759\u6001 \u6574\u578b/\u6d6e\u70b9\u578b\u6570\u636e\u6392\u5e8f\u4f18\u5316\u8f85\u52a9\u7a7a\u95f4\u5927\u5c0f\uff0c\u5bf9\u5e94\u5f85\u6392\u5e8f\u6570\u7ec4\u7684\u6700\u5927\u6700\u5c0f\u5dee\u503c\uff0c\u5355\u4f4dM\uff0c\u6709\u6548\u503c\u8303\u56f4\uff080~1024\uff09\u3002\u53d6\u503c1M\u65f6\u5bf9\u5e94\u5f85\u6392\u5e8f\u6570\u7ec4\u7684\u6700\u5927\u6700\u5c0f\u5dee\u503c\u4e3a262144\uff0c\u8d85\u8fc7\u5219\u4e0d\u80fd\u4f7f\u7528\u4f18\u5316\u3002 TSORT_OPT 1 \u52a8\u6001\uff0c\u7cfb\u7edf\u7ea7 \u6392\u5e8f\u4f18\u5316\u9009\u9879\u30020\uff1a\u6392\u5e8f\u64cd\u4f5c\u4e00\u5f8b\u4f7f\u7528\u4f30\u7b97\u7684\u884c\u6570\u5206\u914d\u5185\u5b58\uff08\u81f3\u5c112M\uff09\uff1b1\uff1a\u6253\u5f00\u4f18\u5316\uff0c\u6392\u5e8f\u64cd\u4f5c\u7ed3\u679c\u884c\u6570\u8f83\u5c11\u65f6\uff0c\u4f7f\u7528\u5b9e\u9645\u7684\u8bb0\u5f55\u884c\u6570\u5206\u914d\u5185\u5b58"},{"location":"postgresql/01.postgresql%E7%AE%80%E4%BB%8B/","title":"\u7b80\u4ecb","text":""},{"location":"postgresql/01.postgresql%E7%AE%80%E4%BB%8B/#_2","title":"\u80cc\u666f\u548c\u5386\u53f2","text":"<p>PostgreSQL \u662f\u4e00\u6b3e\u9ad8\u7ea7\u7684\u4f01\u4e1a\u7ea7\u5f00\u6e90\u5173\u7cfb\u6570\u636e\u5e93\uff0c\u652f\u6301 SQL\uff08\u5173\u7cfb\u578b\uff09\u548c JSON\uff08\u975e\u5173\u7cfb\u578b\uff09\u67e5\u8be2\u3002</p> <p>\u5b83\u662f\u4e00\u4e2a\u9ad8\u5ea6\u7a33\u5b9a\u7684\u6570\u636e\u5e93\u7ba1\u7406\u7cfb\u7edf\uff0c\u4f9d\u6258 20 \u591a\u5e74\u7684\u793e\u533a\u53d1\u5c55\uff0c\u9020\u5c31\u4e86\u5176\u9ad8\u6c34\u5e73\u7684\u6545\u969c\u6062\u590d\u80fd\u529b\u3001\u5b8c\u6574\u6027\u548c\u6b63\u786e\u6027\u3002</p> <p>PostgreSQL \u53ef\u7528\u4f5c\u5f88\u591a Web\u3001\u79fb\u52a8\u3001\u5730\u7406\u7a7a\u95f4\u548c\u5206\u6790\u5e94\u7528\u7a0b\u5e8f\u7684\u4e3b\u8981\u6570\u636e\u5b58\u50a8\u6216\u6570\u636e\u4ed3\u5e93\u3002\u76ee\u524d\u5e7f\u4e3a\u4f7f\u7528\u7684\u7248\u672c\u4e3a PostgreSQL 12\uff0c\u6700\u65b0\u7684\u7684\u7248\u672c\u5df2\u7ecf\u53d1\u5230PostgreSQL 16\u3002</p> <p>PostgreSQL \u5c1d\u8bd5\u9075\u5b88 SQL \u6807\u51c6\uff0c\u8fd9\u79cd\u4e00\u81f4\u6027\u4e0d\u4f1a\u4e0e\u4f20\u7edf\u529f\u80fd\u76f8\u77db\u76fe\uff0c\u4e5f\u4e0d\u4f1a\u5bfc\u81f4\u7cdf\u7cd5\u7684\u67b6\u6784\u51b3\u7b56\u3002\u652f\u6301 SQL \u6807\u51c6\u6240\u9700\u7684\u8bb8\u591a\u529f\u80fd\uff0c\u5c3d\u7ba1\u6709\u65f6\u8bed\u6cd5\u6216\u529f\u80fd\u7565\u6709\u4e0d\u540c\u3002\u968f\u7740\u65f6\u95f4\u7684\u63a8\u79fb\uff0c\u9884\u8ba1\u5c06\u8fdb\u4e00\u6b65\u5b9e\u73b0\u4e00\u81f4\u6027\u3002\u622a\u81f3 2023 \u5e74 9 \u6708\u53d1\u5e03\u7684\u7b2c 16 \u7248\uff0cPostgreSQL \u81f3\u5c11\u7b26\u5408 <code>SQL:2023 Core</code> \u4e00\u81f4\u6027\u7684 179 \u9879\u5f3a\u5236\u529f\u80fd\u4e2d\u7684 170 \u9879\u3002\u622a\u81f3\u64b0\u5199\u672c\u6587\u65f6\uff0c\u8fd8\u6ca1\u6709\u5173\u7cfb\u6570\u636e\u5e93\u5b8c\u5168\u7b26\u5408\u8be5\u6807\u51c6\u3002</p> <p>PostgreSQL\uff08\u7b80\u79f0 PG\uff09\u662f\u4e16\u754c\u9886\u5148\u7684\u5f00\u6e90\u6570\u636e\u5e93\uff0c\u8d77\u6e90\u4e8e20 \u4e16\u7eaa70 \u5e74\u4ee3\u7f8e\u56fd\u52a0\u5dde\u4f2f\u514b\u5229\u5927\u5b66\uff0c\u521b\u59cb\u4eba\u662f\u8363\u83b7\u56fe\u7075\u5956\u7684 Michael Stonebraker\u3002</p> <p>\u5b83\u7684\u6e90\u4ee3\u7801\u57fa\u4e8e PostgreSQL \u8bb8\u53ef\u534f\u8bae \u53d1\u884c\uff0c\u8fd9\u662f\u4e00\u4e2a\u7c7b\u4f3c\u4e8e BSD \u6216\u8005 MIT \u7684\u81ea\u7531\u5f00\u653e\u6e90\u7801\u8bb8\u53ef\u534f\u8bae\u3002\u7528\u6237\u53ef\u4ee5\u57fa\u4e8e\u4efb\u4f55\u76ee\u7684\u4f7f\u7528\u3001\u4fee\u6539\u548c\u53d1\u5e03 PostgreSQL\uff0c\u751a\u81f3\u76f4\u63a5\u5305\u88c5\u4e00\u4e0b\u62ff\u51fa\u53bb\u5356\u94b1\u90fd\u6ca1\u95ee\u9898\uff0c\u552f\u4e00\u7684\u8981\u6c42\u5c31\u662f\u4fdd\u7559\u5b83\u7684\u7248\u6743\u58f0\u660e\u3002\u8fd9\u4e00\u70b9\u76f8\u5bf9\u4e8e MySQL \u793e\u533a\u7248\u7684 GPL \u534f\u8bae\u53cb\u597d\u8bb8\u591a\u3002</p> <p>PG \u662f\u5f3a\u5927\u7684\u4f01\u4e1a\u7ea7\u6570\u636e\u5e93\uff0c\u7279\u522b\u9002\u5408\u5728\u5927\u578b\u4f01\u4e1a\u6570\u636e\u7ba1\u7406\u4e2d\u8fd0\u7528\u3002\u4f5c\u4e3a\u4e00\u79cd\u4f01\u4e1a\u7ea7\u6570\u636e\u5e93\uff0cPG \u5177\u6709\u7684\u5404\u79cd\u9ad8\u7ea7\u529f\u80fd\uff0c\u50cf\u591a\u7248\u672c\u5e76\u53d1\u63a7\u5236(MVCC)\u3001\u6309\u65f6\u95f4\u70b9\u6062\u590d(PITR)\u3001\u8868\u7a7a\u95f4\u3001\u5f02\u6b65\u590d\u5236\u3001\u5d4c\u5957\u4e8b\u52a1\u3001\u5728\u7ebf\u70ed\u5907\u3001\u590d\u6742\u67e5\u8be2\u7684\u89c4\u5212\u548c\u4f18\u5316\u4ee5\u53ca\u4e3a\u5bb9\u9519\u800c\u8fdb\u884c\u7684\u9884\u5199\u65e5\u5fd7\u7b49\u3002PG\u652f\u6301\u56fd\u9645\u5b57\u7b26\u96c6\u3001\u591a\u5b57\u8282\u7f16\u7801\u5e76\u652f\u6301\u4f7f\u7528\u5f53\u5730\u8bed\u8a00\u8fdb\u884c\u6392\u5e8f\u3001\u5927\u5c0f\u5199\u5904\u7406\u548c\u683c\u5f0f\u5316\u7b49\u64cd\u4f5c\u3002\u540c\u65f6PG\u4e5f\u5728\u6240\u80fd\u7ba1\u7406\u7684\u5927\u6570\u636e\u91cf\u548c\u6240\u5141\u8bb8\u7684\u5927\u7528\u6237\u91cf\u5e76\u53d1\u8bbf\u95ee\u65f6\u95f4\u5177\u6709\u5b8c\u5168\u7684\u9ad8\u4f38\u7f29\u6027\u3002</p> <p>\u76ee\u524d\u5305\u62ec\u4e9a\u9a6c\u900a\uff0c\u534e\u4e3a\uff0c\u963f\u91cc\u7b49\u4e16\u754c\u4e94\u767e\u5f3a\u7ea7\u522b\u7684\u5927\u578b\u4f01\u4e1a\u5728\u4f7f\u7528PG\u6280\u672f\uff1b\u5e94\u7528\u6db5\u76d6\u91d1\u878d\uff0c\u80fd\u6e90\uff0c\u96f6\u552e\uff0cIT\uff0c\u4e92\u8054\u7f51\u7b49\u5404\u4e2a\u884c\u4e1a\u3002PG \u662f\u5927\u578b\u4f01\u4e1a\u548c\u4e92\u8054\u7f51\u53bb Oracle \u7684\u4f18\u9009\u65b9\u6848\uff0c\u80fd\u591f\u5e2e\u52a9\u4f01\u4e1a\u6709\u6548\u7ba1\u7406\u6570\u636e\u548c\u964d\u4f4e\u6210\u672c\uff1b\u4e5f\u662f\u5927\u6570\u636e\u3001\u4e91\u8ba1\u7b97\u9886\u57df\u67b6\u6784\u4e2d\u5173\u7cfb\u6570\u636e\u5e93\u5b58\u50a8\u7ba1\u7406\u7684\u6700\u4f73\u9009\u62e9\u3002\u540c\u65f6\uff0c\u5728\u56fd\u5185\u4e5f\u6709\u5305\u62ec\u963f\u91cc\u3001\u817e\u8baf\u3001\u534e\u4e3a\uff0c\u701a\u9ad8\u5728\u5185\u7684\u8bb8\u591a\u4f01\u4e1a\u57fa\u4e8e PG \u7814\u53d1\u4e91\u4ea7\u54c1\u53ca\u81ea\u4e3b\u53ef\u63a7\u6570\u636e\u5e93\u4ea7\u54c1\u3002</p> <p>\u5de5\u4fe1\u90e8\u4e2d\u56fd\u5f00\u6e90\u8f6f\u4ef6\u8054\u76df PostgreSQL \u5206\u4f1a\uff08\u7b80\u79f0\u4e2d\u56fdPG \u5206\u4f1a\uff09\u662f\u5de5\u4fe1\u90e8\u4e0b\u5c5e\uff0c\u56fd\u5185\u552f\u4e00\u5b98\u65b9\u8ba4\u53ef\u7684 PG \u884c\u4e1a\u534f\u4f1a\u7ec4\u7ec7\uff0c\u627f\u62c5\u5728\u56fd\u5185\u53d1\u5c55\u548c\u63a8\u5e7fPG \u6280\u672f\u7684\u804c\u80fd\u3002 \u57fa\u4e8ePostgresql\u5728\u4e2d\u56fd\u53d1\u5c55\u7684\u826f\u597d\u6001\u52bf\uff0c\u7531\u4e2d\u56fdPG\u5206\u4f1a\u8054\u5408\u6743\u5a01\u8ba4\u8bc1\u673a\u6784\u3001\u77e5\u540d\u57f9\u8bad\u673a\u6784\u5171\u540c\u6253\u9020\u4e2d\u56fd PostgreSQL \u57f9\u8bad\u8ba4\u8bc1\u4f53\u7cfb\uff08\u7b80\u79f0\u201c\u4e2d\u56fdPG \u57f9\u8bad\u8ba4\u8bc1\u201d\uff09\u3002</p> <p>\u4e2d\u56fd PG \u57f9\u8bad\u8ba4\u8bc1\u4f53\u7cfb\u65e8\u5728\u4e3a PG \u751f\u6001\u4f01\u4e1a\u53d1\u5c55\u63d0\u4f9bPG \u4e13\u4e1a\u6280\u672f\u4eba\u624d\u3002\u4e3a\u6709\u5fd7\u4e8e\u4ece\u4e8b PG \u76f8\u5173\u5de5\u4f5c\u7684\u4eba\u5458\uff0c\u63d0\u4f9b\u9ad8\u6548\u7684\u57f9\u8bad\u6307\u5bfc\u3001\u6743\u5a01\u7684\u7b49\u7ea7\u8ba4\u8bc1\uff1b</p> <p>\u4e2d\u56fd PG \u57f9\u8bad\u8ba4\u8bc1\u662f\u76ee\u524d\u56fd\u5185\u552f\u4e00\u7684 PG \u6280\u672f\u7b49\u7ea7\u8ba4\u8bc1\uff0c\u586b\u8865\u4e86\u56fd\u5185 PG \u6280\u672f\u9886\u57df\u76f8\u5173\u7a7a\u767d\uff0c\u8fd9\u5bf9 PG \u57f9\u8bad\u4e43\u81f3 PG \u6280\u672f\u7684\u53d1\u5c55\u63a8\u5e7f\u90fd\u4f1a\u8d77\u5230\u5de8\u5927\u7684\u652f\u6301\u548c\u63a8\u52a8\u4f5c\u7528\u3002</p>"},{"location":"postgresql/01.postgresql%E7%AE%80%E4%BB%8B/#_3","title":"\u5f00\u6e90\u534f\u8bae","text":"<p>PostgreSQL: The world\u2019s most advanced open source database</p> <p>MySQL\uff1aWorld\u2019s Most Popular Open Source Database</p> <p>PostgreSQL\u5f00\u6e90\u534f\u8bae\uff1aPostgreSQL\u57fa\u4e8e\u81ea\u7531\u7684BSD/MIT\u8bb8\u53ef\uff0c\u4efb\u4f55\u7ec4\u7ec7\u90fd\u53ef\u4ee5\u4f7f\u7528\u3001\u590d\u5236\u3001\u4fee\u6539\u548c\u91cd\u65b0\u5206\u53d1\u4ee3\u7801\uff0c\u53ea\u9700\u8981\u63d0\u4f9b\u4e00\u4e2a\u7248\u6743\u58f0\u660e\u5373\u53ef\u3002</p> <p>PG\u7684\u5f00\u6e90\u534f\u8bae\u7279\u522b\u7075\u6d3b\uff0c\u4efb\u4f55\u516c\u53f8\u7684\u548c\u4e2a\u4eba\u90fd\u53ef\u4ee5\u628aPG\u4f5c\u4e3a\u4e00\u4e2a\u4ea7\u54c1\u9500\u552e\uff0c\u800c\u4e0d\u9700\u8981\u50cfMySQL\u90a3\u6837\u5fc5\u987b\u4fee\u6539\u5927\u90e8\u5206\u4ee3\u7801\u624d\u53ef\u4ee5\u4f5c\u4e3a\u516c\u53f8\u7684\u4ea7\u54c1\u3002</p> <p>PostgreSQL\u8bb8\u53ef\u662f\u4e00\u79cd\u81ea\u7531\u7684\u5f00\u6e90\u8bb8\u53ef\uff0c\u4e0eBSD\u6216MIT\u8bb8\u53ef\u8bc1\u7c7b\u4f3c\u30021994\u5e74\u4e4b\u524d\u7684\u90e8\u5206\u7248\u6743\u5c5e\u4e8e\u52a0\u5229\u798f\u5c3c\u4e9a\u8463\u4e8b\u4f1a\uff1b1996\u5e74-2020\u5e74\uff0c\u90e8\u5206\u7248\u6743\u5c5e\u4e8ePostgreSQL\u5168\u7403\u5f00\u53d1\u5c0f\u7ec4\uff1b\u5168\u7403\u5f00\u53d1\u5c0f\u7ec4\u4e3b\u8981\u6210\u5458\u5206\u6563\u5728\u4e16\u754c\u5404\u5730\uff0c\u5176\u80cc\u540e\u4e0d\u53d7\u4efb\u4f55\u516c\u53f8\u5b9e\u4f53\u63a7\u5236\uff0c\u8fd9\u4f7f\u5176\u6210\u4e3a\u4e00\u4e2a\u771f\u6b63\u7684\u5f00\u653e\u9879\u76ee\u3002</p> <p>PG\u4e8b\u5b9e\u4e0a\u4e0d\u88ab\u4efb\u4f55\u4e00\u5bb6\u516c\u53f8\u6240\u638c\u63a7\uff0c\u5b83\u80cc\u540e\u7684\u63a7\u5236\u673a\u6784\u2014\u2014PostgreSQL\u5168\u7403\u5f00\u53d1\u5c0f\u7ec4\uff0c\u662f\u4e00\u4e2a\u677e\u6563\u7684\u7ec4\u7ec7\u3002\u5176\u6838\u5fc3\u6210\u5458\u6765\u81ea\u5168\u7403\u5404\u5730\u7684\u4e0d\u540c\u516c\u53f8\uff0c\u5982\u679c\u4f60\u611f\u5174\u8da3\uff0c\u53ef\u4ee5\u5728PG\u5b98\u7f51\u67e5\u8be2\u5230\u8fd9\u4e2a\u7ec4\u7ec7\u7684\u6210\u5458\u5217\u8868\u3002\u53ef\u4ee5\u8fd9\u4e48\u8bf4\uff0c\u6ca1\u6709\u4efb\u4f55\u4e00\u4e2a\u516c\u53f8\u4eab\u6709\u5bf9PG\u7684\u7edd\u5bf9\u63a7\u5236\u6743\uff0cPG\u6c38\u8fdc\u662f\u5c5e\u4e8e\u793e\u533a\u7684\u3002</p> <p>BSD\u5f00\u6e90\u534f\u8bae\u662f\u4e00\u4e2a\u7ed9\u4e8e\u4f7f\u7528\u8005\u5f88\u5927\u81ea\u7531\u7684\u534f\u8bae\u3002\u53ef\u4ee5\u81ea\u7531\u7684\u4f7f\u7528\uff0c\u4fee\u6539\u6e90\u4ee3\u7801\uff0c\u4e5f\u53ef\u4ee5\u5c06\u4fee\u6539\u540e\u7684\u4ee3\u7801\u4f5c\u4e3a\u5f00\u6e90\u6216\u8005\u4e13\u6709\u8f6f\u4ef6\u518d\u53d1\u5e03\uff0c\u88ab\u8a89\u4e3a\u5f00\u6e90\u8bb8\u53ef\u7684\u201c\u6d3b\u96f7\u950b\u201d\u3002</p> <p>BSD \u4ee3\u7801\u9f13\u52b1\u4ee3\u7801\u5171\u4eab\uff0c\u4f46\u9700\u8981\u5c0a\u91cd\u4ee3\u7801\u4f5c\u8005\u7684\u8457\u4f5c\u6743\u3002BSD\u7531\u4e8e\u5141\u8bb8\u4f7f\u7528\u8005\u4fee\u6539\u548c\u91cd\u65b0\u53d1\u5e03\u4ee3\u7801\uff0c\u4e5f\u5141\u8bb8\u4f7f\u7528\u6216\u5728BSD\u4ee3\u7801\u4e0a\u5f00\u53d1\u5546\u4e1a\u8f6f\u4ef6\u53d1\u5e03\u548c\u9500\u552e\uff0c\u56e0\u6b64\u662f\u5bf9\u5546\u4e1a\u96c6\u6210\u5f88\u53cb\u597d\u7684\u534f\u8bae\u3002\u800c\u5f88\u591a\u7684\u516c\u53f8\u4f01\u4e1a\u5728\u9009\u7528\u5f00\u6e90\u4ea7\u54c1\u7684\u65f6\u5019\u90fd\u9996\u9009BSD\u534f\u8bae\uff0c\u56e0\u4e3a\u53ef\u4ee5\u5b8c\u5168\u63a7\u5236\u8fd9\u4e9b\u7b2c\u4e09\u65b9\u7684\u4ee3\u7801\uff0c\u5728\u5fc5\u8981\u7684\u65f6\u5019\u53ef\u4ee5\u4fee\u6539\u6216\u8005\u4e8c\u6b21\u5f00\u53d1\u3002</p> <p>PostgreSQL\u8bb8\u53ef\u63cf\u8ff0\uff1ahttps://www.postgresql.org/about/licence/</p> <p>MySQL\u5f00\u6e90\u534f\u8bae\uff1a\u6838\u5fc3\u4ee3\u7801\u57fa\u4e8eGPL\u6216Commercial License\u3002</p> <p>MySQL\u7684\u5f00\u6e90\u534f\u8bae\u662f\u57fa\u4e8eGPL\u534f\u8bae\uff0c\u4efb\u4f55\u516c\u53f8\u90fd\u53ef\u4ee5\u514d\u8d39\u4f7f\u7528\uff0c\u4e0d\u5141\u8bb8\u4fee\u6539\u540e\u548c\u884d\u751f\u7684\u4ee3\u7801\u505a\u4e3a\u95ed\u6e90\u7684\u5546\u4e1a\u8f6f\u4ef6\u53d1\u5e03\u548c\u9500\u552e\uff0cMySQL\u7684\u7248\u6743\u5728\u7532\u9aa8\u6587\u624b\u4e2d\uff0c\u7532\u9aa8\u6587\u53ef\u4ee5\u63a8\u4e86\u5176\u5546\u4e1a\u95ed\u6e90\u7248\u672c\u3002</p> <p>GPL(General Public license)\u662f\u516c\u5171\u8bb8\u53ef\uff0c\u9075\u5faa\u4e86GPL\u7684\u8f6f\u4ef6\u662f\u516c\u5171\u7684\u3002\u5982\u679c\u67d0\u8f6f\u4ef6\u4f7f\u7528\u4e86GPL\u8f6f\u4ef6\uff0c\u90a3\u4e48\u8be5\u8f6f\u4ef6\u4e5f\u9700\u8981\u5f00\u6e90\uff0c\u5982\u679c\u4e0d\u5f00\u6e90\uff0c\u5c31\u4e0d\u80fd\u4f7f\u7528GPL\u8f6f\u4ef6\uff0c\u8fd9\u548c\u662f\u5426\u628a\u8be5\u8f6f\u4ef6\u5546\u7528\u4e0e\u5426\u662f\u6ca1\u5173\u7cfb\u7684\u3002</p> <p>\u5982\u679c\u65e0\u6cd5\u6ee1\u8db3GPL\uff0c\u5c31\u9700\u8981\u83b7\u5f97\u5546\u4e1a\u8bb8\u53ef\uff0c\u901a\u8fc7\u4e0eOracle\u516c\u53f8\u8054\u7cfb\uff0c\u5236\u5b9a\u89e3\u51b3\u65b9\u6848\uff0c\u53d7Oracle\u516c\u53f8\u7ea6\u675f\u3002</p> <p>\u5177\u4f53\u7ea6\u675f\uff1a</p> <ol> <li>\u4e0d\u5141\u8bb8\u5bf9\u5728MySQL\u4e0a\u4f5c\u51fa\u7684\u4fee\u6539\u7533\u8bf7\u4e13\u5229\uff1b</li> <li>MySQL\u4e0a\u7684\u4fee\u6539\u9700\u8981\u516c\u5f00\uff0c\u4e14\u6240\u6709\u6743\u5f52Oracle\u6240\u6709\uff1b</li> <li>\u51fa\u4e8e\u7eaf\u5b66\u672f\u76ee\u7684\u3001\u7ec3\u4e60\u76ee\u7684\u6e90\u7801\u4fee\u6539\u4e5f\u662f\u7b26\u5408GPL\u7684\uff1b</li> <li>Oracle\u7684MySQL\u4f01\u4e1a\u7248\u6216\u9ad8\u7ea7\u529f\u80fd\u4f1a\u6d89\u53ca\u8d39\u7528\uff0c\u5e76\u4e14Oracle\u516c\u53f8\u4e0d\u5141\u8bb8\u5176\u5b83\u57fa\u4e8eMySQL\u7684\u95ed\u6e90\u4ea7\u54c1\u3002</li> </ol> <p>\u5176\u5b83\u57fa\u4e8eMySQL\u7684\u6570\u636e\u5e93\u4e5f\u9075\u5faa\u5e76\u5fc5\u987b\u9075\u5faaGPL\u8bb8\u53ef\u6216GPL\u7684\u4fee\u8ba2\u7248GPL V2\uff0c\u8b6c\u5982Mariadb\u3002GPL \u8bb8\u53ef\u903b\u8f91\u4e0a\u4e0e\u5546\u4e1a\u8bb8\u53ef\u5b58\u5728\u51b2\u7a81\uff0c\u53ef\u4ee5\u7406\u89e3\u4e3a\uff1a\u5546\u4e1a\u8bb8\u53ef\u662f\u63a7\u5236MySQL\u7684\u516c\u53f8\u7559\u7ed9\u81ea\u5df1\u7684\u7279\u6743\u3002</p> <p>\u7531\u4e8eGPL\u4e25\u683c\u8981\u6c42\u4f7f\u7528\u4e86GPL\u7c7b\u5e93\u7684\u8f6f\u4ef6\u4ea7\u54c1\u5fc5\u987b\u4f7f\u7528GPL\u534f\u8bae\uff0c\u5bf9\u4e8e\u4f7f\u7528GPL\u534f\u8bae\u7684\u5f00\u6e90\u4ee3\u7801\uff0c\u5546\u4e1a\u8f6f\u4ef6\u6216\u8005\u5bf9\u4ee3\u7801\u6709\u4fdd\u5bc6\u8981\u6c42\u7684\u5c31\u4e0d\u9002\u5408\u96c6\u6210/\u91c7\u7528\u4f5c\u4e3a\u7c7b\u5e93\u548c\u4e8c\u6b21\u5f00\u53d1\u7684\u57fa\u7840\u3002\u4eceGPL \u5230GPL V2 V3\uff0c\u53e6\u5916\u8fd8\u6709LGPL\uff0c\u8fd9\u4e2a\u534f\u8bae\u4e00\u76f4\u6709\u5728\u6f14\u53d8\u4e2d\uff0c\u5185\u5bb9\u8868\u8ff0\u6bd4\u8f83\u590d\u6742\uff0c\u8fd9\u4f1a\u5f71\u54cd\u5f00\u6e90\u7cbe\u795e\u7684\u53d1\u5c55\u4e0e\u4f20\u627f\u5e76\u4e14\u5bb9\u6613\u4ea7\u751f\u5206\u6b67\u3002</p>"},{"location":"postgresql/01.postgresql%E7%AE%80%E4%BB%8B/#_4","title":"\u4e8b\u52a1\u652f\u6301","text":"<p>PostgreSQL\u652f\u6301\u4e8b\u52a1\u7684\u5f3a\u4e00\u81f4\u6027\uff0c\u4e8b\u52a1\u4fdd\u8bc1\u6027\u597d\uff0c\u5b8c\u5168\u652f\u6301ACID\u7279\u6027\u3002 MySQL\u53ea\u6709innodb\u5f15\u64ce\u652f\u6301\u4e8b\u52a1\uff0c\u4e8b\u52a1\u4e00\u81f4\u6027\u4fdd\u8bc1\u4e0a\u53ef\u6839\u636e\u5b9e\u9645\u9700\u6c42\u8c03\u6574\uff0c\u4e3a\u4e86\u6700\u5927\u9650\u5ea6\u7684\u4fdd\u62a4\u6570\u636e\uff0cMySQL\u53ef\u914d\u7f6e\u53cc\u4e00\u6a21\u5f0f\uff0c\u5bf9ACID\u7684\u652f\u6301\u4e0a\u6bd4PG\u7a0d\u5f31\u5f31\u3002 MySQL\u7684\"\u53cc1\u9a8c\u8bc1\"\u6307\u7684\u662finnodb_flush_log_at_trx_commit\u548csync_binlog\u4e24\u4e2a\u53c2\u6570\u8bbe\u7f6e\uff0c\u8fd9\u4e24\u4e2a\u662f\u662f\u63a7\u5236MySQL \u78c1\u76d8\u5199\u5165\u7b56\u7565\u4ee5\u53ca\u6570\u636e\u5b89\u5168\u6027\u7684\u5173\u952e\u53c2\u6570\u3002</p>"},{"location":"postgresql/01.postgresql%E7%AE%80%E4%BB%8B/#sql","title":"\u5bf9SQL\u6807\u51c6\u7684\u652f\u6301","text":"<p>PostgreSQL\u51e0\u4e4e\u652f\u6301\u6240\u6709\u7684SQL\u6807\u51c6\uff0c\u652f\u6301\u7c7b\u578b\u76f8\u5f53\u4e30\u5bcc\u3002 MySQL\u53ea\u652f\u6301\u90e8\u5206SQL\u6807\u51c6\uff0c\u76f8\u6bd4\u4e8ePG\u652f\u6301\u7c7b\u578b\u7a0d\u5f31\u3002</p>"},{"location":"postgresql/01.postgresql%E7%AE%80%E4%BB%8B/#_5","title":"\u5e76\u53d1\u63a7\u5236","text":"<p>PostgreSQL\u901a\u8fc7\u5176MVCC\u5b9e\u73b0\u6709\u6548\u5730\u89e3\u51b3\u4e86\u5e76\u53d1\u95ee\u9898\uff0c\u4ece\u800c\u5b9e\u73b0\u4e86\u975e\u5e38\u9ad8\u7684\u5e76\u53d1\u6027\u3002PG\u65b0\u8001\u6570\u636e\u4e00\u8d77\u5b58\u653e\u7684\u57fa\u4e8eXID\u7684MVCC\u673a\u5236,\u65b0\u8001\u6570\u636e\u4e00\u8d77\u5b58\u653e\uff0c\u9700\u8981\u5b9a\u65f6\u89e6\u53d1VACUUM\uff0c\u4f1a\u5e26\u6765\u591a\u4f59\u7684IO\u548c\u6570\u636e\u5e93\u5bf9\u8c61\u52a0\u9501\u5f00\u9500\uff0c\u5f15\u8d77\u6570\u636e\u5e93\u6574\u4f53\u7684\u5e76\u53d1\u80fd\u529b\u4e0b\u964d\u3002\u800c\u4e14VACUUM\u6e05\u7406\u4e0d\u53ca\u65f6\uff0c\u8fd8\u53ef\u80fd\u4f1a\u5f15\u53d1\u6570\u636e\u81a8\u80c0\u3002\u5f53\u7136PostgreSQL\u8fd8\u6709\u4e00\u70b9\u5f71\u54cd\u6bd4\u8f83\uff0c\u4e3a\u4e86\u4fdd\u8bc1\u4e8b\u52a1\u7684\u5f3a\u4e00\u81f4\u6027\uff0c\u672a\u51b3\u4e8b\u52a1\u4f1a\u5f71\u54cd\u6240\u6709\u8868VACUUM\u6e05\u7406\uff0c\u5bfc\u81f4\u8868\u81a8\u80c0\u3002</p> <p>MySQL\u4ec5\u5728InnoDB\u4e2d\u652f\u6301MVCC\uff0cinnodb\u7684\u57fa\u4e8e\u56de\u6eda\u6bb5\u5b9e\u73b0\u7684MVCC\u673a\u5236\uff0c\u4f46\u662fMySQL\u7684\u95f4\u9699\u9501\u5f71\u54cd\u8f83\u5927\uff0c\u9501\u5b9a\u6570\u636e\u8f83\u591a\u3002</p>"},{"location":"postgresql/01.postgresql%E7%AE%80%E4%BB%8B/#acid","title":"\u5bf9ACID\u7684\u652f\u6301","text":"<p>PostgreSQL\u652f\u6301\u4e8b\u52a1\u7684\u5f3a\u4e00\u81f4\u6027\uff0c\u4e8b\u52a1\u4fdd\u8bc1\u6027\u597d\uff0c\u5b8c\u5168\u652f\u6301ACID\u7279\u6027\u3002</p> <p>MySQL\u53ea\u6709innodb\u5f15\u64ce\u652f\u6301\u4e8b\u52a1\uff0c\u4e8b\u52a1\u4e00\u81f4\u6027\u4fdd\u8bc1\u4e0a\u53ef\u6839\u636e\u5b9e\u9645\u9700\u6c42\u8c03\u6574\uff0c\u4e3a\u4e86\u6700\u5927\u9650\u5ea6\u7684\u4fdd\u62a4\u6570\u636e\uff0cMySQL\u53ef\u914d\u7f6e\u53cc\u4e00\u6a21\u5f0f\uff0c\u5bf9ACID\u7684\u652f\u6301\u4e0a\u6bd4PG\u7a0d\u5f31\u5f31\u3002</p>"},{"location":"postgresql/01.postgresql%E7%AE%80%E4%BB%8B/#_6","title":"\u6027\u80fd","text":"<p>PostgreSQL</p> <p>1\uff09PostgreSQL\u5e7f\u6cdb\u7528\u4e8e\u8bfb\u5199\u901f\u5ea6\u9ad8\u548c\u6570\u636e\u4e00\u81f4\u6027\u9ad8\u7684\u5927\u578b\u7cfb\u7edf\u3002\u6b64\u5916\uff0c\u5b83\u8fd8\u652f\u6301\u5404\u79cd\u6027\u80fd\u4f18\u5316\uff0c\u5f53\u7136\u8fd9\u4e9b\u4f18\u5316\u4ec5\u5728\u5546\u4e1a\u89e3\u51b3\u65b9\u6848\u4e2d\u53ef\u7528\uff0c\u4f8b\u5982\u5730\u7406\u7a7a\u95f4\u6570\u636e\u652f\u6301\uff0c\u6ca1\u6709\u8bfb\u9501\u5b9a\u7684\u5e76\u53d1\u6027\u7b49\u7b49\u3002</p> <p>2\uff09PostgreSQL\u6027\u80fd\u6700\u9002\u7528\u4e8e\u9700\u8981\u6267\u884c\u590d\u6742\u67e5\u8be2\u7684\u7cfb\u7edf\u3002</p> <p>3\uff09PostgreSQL\u5728OLTP/OLAP\u7cfb\u7edf\u4e2d\u8868\u73b0\u826f\u597d\uff0c\u8bfb\u5199\u901f\u5ea6\u4ee5\u53ca\u5927\u6570\u636e\u5206\u6790\u65b9\u9762\u8868\u73b0\u826f\u597d\uff0c\u57fa\u4e8ePG\u7684GP\u6570\u636e\u5e93\uff0c\u5728\u6570\u636e\u4ed3\u5e93\u9886\u57df\u8868\u73b0\u826f\u597d\u3002</p> <p>4\uff09PostgreSQL\u4e5f\u9002\u7528\u4e8e\u5546\u4e1a\u667a\u80fd\u5e94\u7528\u7a0b\u5e8f\uff0c\u4f46\u66f4\u9002\u5408\u9700\u8981\u5feb\u901f\u8bfb/\u5199\u901f\u5ea6\u7684\u6570\u636e\u4ed3\u5e93\u548c\u6570\u636e\u5206\u6790\u5e94\u7528\u7a0b\u5e8f\u3002</p> <p>MySQL</p> <p>1\uff09MySQL\u662f\u5e7f\u6cdb\u9009\u62e9\u7684\u57fa\u4e8eWeb\u7684\u9879\u76ee\uff0c\u9700\u8981\u6570\u636e\u5e93\u53ea\u662f\u4e3a\u4e86\u7b80\u5355\u7684\u6570\u636e\u4e8b\u52a1\u3002\u4f46\u662f\u5f53\u9047\u5230\u91cd\u8d1f\u8f7d\u6216\u5c1d\u8bd5\u5b8c\u6210\u590d\u6742\u67e5\u8be2\u65f6\uff0cMySQL\u901a\u5e38\u4f1a\u8868\u73b0\u4e0d\u4f73\u3002</p> <p>2\uff09MySQL\u7684\u8bfb\u53d6\u901f\u5ea6\uff0c\u5728OLTP\u7cfb\u7edf\u4e2d\u8868\u73b0\u826f\u597d\u3002</p> <p>3\uff09MySQL + InnoDB\u4e3aOLTP\u573a\u666f\u63d0\u4f9b\u4e86\u975e\u5e38\u597d\u7684\u8bfb/\u5199\u901f\u5ea6\u3002\u603b\u4f53\u800c\u8a00\uff0cMySQL\u5728\u9ad8\u5e76\u53d1\u573a\u666f\u4e0b\u8868\u73b0\u826f\u597d\u3002</p> <p>4\uff09MySQL\u662f\u53ef\u9760\u7684\uff0c\u5e76\u4e14\u4e0e\u5546\u4e1a\u667a\u80fd\u5e94\u7528\u7a0b\u5e8f\u914d\u5408\u826f\u597d\uff0c\u56e0\u4e3a\u5546\u4e1a\u667a\u80fd\u5e94\u7528\u7a0b\u5e8f\u901a\u5e38\u8bfb\u53d6\u5f88\u591a\u3002</p>"},{"location":"postgresql/01.postgresql%E7%AE%80%E4%BB%8B/#_7","title":"\u5b98\u65b9\u6587\u6863","text":"<p>\u5b98\u65b9\u6587\u6863pdf\u4e0b\u8f7d</p> <p>\u5b98\u65b9\u6587\u6863\u5728\u7ebfHTML\u9605\u8bfb</p>"},{"location":"postgresql/01.postgresql%E7%AE%80%E4%BB%8B/#postgresql","title":"postgresql\u57fa\u672c\u6982\u5ff5","text":"<p>cluster</p> <p>A database cluster is a collection of databases that is managed by a single instance of a running database server</p> <p>\u521d\u59cb\u5316\u540e\uff0c\u4e00\u4e2acluster\u4e2d\u9ed8\u8ba4\u5c31\u4f1a\u5305\u542b</p> <p>\u4ece\u6587\u4ef6\u7cfb\u7edf\u89d2\u5ea6\uff0c\u4e00\u4e2adatabase cluster\u5c31\u662f\u6240\u6709\u6570\u636e\u7684\u4e00\u4e2a\u5b58\u653e\u76ee\u5f55\uff0c\u4e5f\u53eb<code>data directory</code>\u6216<code>data area</code>\uff0c\u5b83\u901a\u5e38\u9700\u8981\u4f60\u6307\u5b9a\u76ee\u5f55\uff0c\u5373\u4f7f\u5f88\u5e38\u89c1\u662f\u8def\u5f84\u662f<code>/usr/local/pgsql/data</code>\u6216<code>/var/lib/pgsql/data</code>\u3002</p> <p>database</p> <p>\u5728<code>PostgreSQL</code>\u4e2d\uff0c<code>database</code>\u7684\u521b\u5efa\u662f\u901a\u8fc7\u514b\u9686<code>database template</code>\u6765\u5b9e\u73b0\u7684\uff0c\u8fd9\u4e0e<code>SQL SERVER</code>\u662f\u540c\u6837\u7684\u673a\u5236\u3002</p> <p><code>PostgreSQL</code>\u5b89\u88c5\u540e\u4f1a\u9ed8\u8ba4\u9644\u5e26\u4e09\u4e2a\u5e93\uff0c\u5206\u522b\u662fpostgres\u3001template0\u3001template1\u3002</p> <p>\u5982\u679c<code>CREATE DATABASE dbname</code>\u5e76\u6ca1\u6709\u6307\u660e<code>database template</code>\uff0c\u6240\u4ee5\u7cfb\u7edf\u5c06\u9ed8\u8ba4\u514b\u9686template1\u6570\u636e\u5e93\uff0c\u5f97\u5230\u65b0\u7684\u6570\u636e\u5e93dbname\u3002</p> <p>By default, the new database will be created by cloning the standard system database template1</p> <p>\u8fd9\u79cd\u7279\u6027\uff0c\u53ef\u4ee5\u8ba9\u7528\u6237\u5f88\u597d\u7684\u5236\u5b9a\u6570\u636e\u5e93\u6a21\u677f\u3002<code>template0</code>\u548c<code>template1</code>\u5728\u521d\u59cb\u72b6\u6001\u662f\u76f8\u540c\u7684\u3002\u4e00\u822c\u53ef\u4ee5\u5728<code>template1</code>\u4e2d\u81ea\u5b9a\u4e49\u6a21\u677f\uff0c<code>template0</code>\u505a\u4e3a\u5e72\u51c0\u5d2d\u65b0\u7684\u5e93\u3002</p> <p>\u5728\u6570\u636e\u5e93\u521b\u5efa\u7684\u540c\u65f6\uff0c\u5c31\u5df2\u7ecf\u9ed8\u8ba4\u4e3a\u6570\u636e\u5e93\u521b\u5efa\u4e86\u4e00\u4e2a\u6a21\u5f0f--public\uff0c\u8fd9\u4e5f\u662f\u8be5\u6570\u636e\u5e93\u7684\u9ed8\u8ba4\u6a21\u5f0f\u3002\u6240\u6709\u4e3a\u6b64\u6570\u636e\u5e93\u521b\u5efa\u7684\u5bf9\u8c61(\u8868\u3001\u51fd\u6570\u3001\u8bd5\u56fe\u3001\u7d22\u5f15\u3001\u5e8f\u5217\u7b49)\u90fd\u662f\u521b\u5efa\u5728\u8fd9\u4e2a\u6a21\u5f0f\u4e2d\u7684\u3002</p> <pre><code>CREATE DATABASE name\n    [ WITH ] [ OWNER [=] user_name ]\n           [ TEMPLATE [=] template ]\n           [ ENCODING [=] encoding ]\n           [ STRATEGY [=] strategy ] ]\n           [ LOCALE [=] locale ]\n           [ LC_COLLATE [=] lc_collate ]\n           [ LC_CTYPE [=] lc_ctype ]\n           [ ICU_LOCALE [=] icu_locale ]\n           [ LOCALE_PROVIDER [=] locale_provider ]\n           [ COLLATION_VERSION = collation_version ]\n           [ TABLESPACE [=] tablespace_name ]\n           [ ALLOW_CONNECTIONS [=] allowconn ]\n           [ CONNECTION LIMIT [=] connlimit ]\n           [ IS_TEMPLATE [=] istemplate ]\n           [ OID [=] oid ]\n</code></pre> <p>schema</p> <p>\u5728<code>PostgreSQL</code>\u4e2d\uff0c\u6a21\u5f0f\u662f\u6570\u636e\u5e93\u5b9e\u4f8b\u7684\u903b\u8f91\u5206\u5272\u3002</p> <p>\u6570\u636e\u5e93(database)\u662f\u88ab\u6a21\u5f0f(schema)\u6765\u5207\u5206\u7684\uff0c\u4e00\u4e2a\u6570\u636e\u5e93(database)\u81f3\u5c11\u6709\u4e00\u4e2a\u6a21\u5f0f(schema)\uff0c\u6240\u6709\u6570\u636e\u5e93\u5bf9\u8c61(object)\u662f\u88ab\u521b\u5efa\u5728\u6a21\u5f0f\u4e2d\u7684\u3002</p> <p>\u7528\u6237\u767b\u5f55\u5230\u7cfb\u7edf\uff0c\u8fde\u63a5\u5230\u4e00\u4e2a\u6570\u636e\u5e93\u540e\uff0c\u662f\u901a\u8fc7\u8be5\u6570\u636e\u5e93\u7684search_path\u6765\u5bfb\u627eschema\u7684\u641c\u7d22\u987a\u5e8f\uff1a</p> <pre><code># search_path\u7c7b\u4f3c\u4e8elinux\u4e2d\u7684path\u73af\u5883\u53d8\u91cf\u3002\u9ed8\u8ba4\u503c\u662f `\"$user\",public`\u3002\n# \u610f\u601d\u5c31\u662f\u5f53\u4ee5\u67d0\u4e2a\u7528\u6237\u767b\u5f55\u5230\u6570\u636e\u5e93\u7684\u65f6\u5019\uff0c\u9ed8\u8ba4\u5c31\u662f\u5148\u67e5\u627e\u548c\u767b\u5f55\u7528\u6237\u540c\u540d\u7684schema\uff0c\u518d\u67e5\u627epublic\u3002\n\npostgres=#\npostgres=# SHOW search_path;\n   search_path\n-----------------\n \"$user\", public\n(1 row)\n\npostgres=#\npostgres=#\n</code></pre>"},{"location":"postgresql/02.postgresql%E5%AE%89%E8%A3%85/","title":"\u5b89\u88c5postgresql","text":""},{"location":"postgresql/02.postgresql%E5%AE%89%E8%A3%85/#_1","title":"\u4e8c\u8fdb\u5236\u5b89\u88c5","text":"<pre><code># ubuntu/debian package install \n\nsudo apt update\nsudo apt -y upgrade\nsudo apt -y install vim bash-completion wget\n\n# \u6dfb\u52a0PostgreSQL\u7684APT\u6e90\nsudo sh -c 'echo \"deb http://apt.postgresql.org/pub/repos/apt $(lsb_release -cs)-pgdg main\" &gt; /etc/apt/sources.list.d/pgdg.list'\n# \u6dfb\u52a0\u516c\u94a5\u7b7e\u540d\nwget --quiet -O - https://www.postgresql.org/media/keys/ACCC4CF8.asc | sudo apt-key add -\n# \u66f4\u65b0\u5305\u5217\u8868\nsudo apt update\n\n# Install the latest version of PostgreSQL.\n# If you want a specific version, use 'postgresql-12' or similar instead of 'postgresql':\nsudo apt install postgresql-13 postgresql-client-13\n\nsystemctl status postgresql.service \n\nVer  Cluster    Port   Status   Owner      Data directory                    Log file\n13    main      5432   down     postgres   /var/lib/postgresql/13/main       /var/log/postgresql/postgresql-13-main.log\n\npg_ctlcluster 13 main start\n</code></pre>"},{"location":"postgresql/02.postgresql%E5%AE%89%E8%A3%85/#_2","title":"\u7f16\u8bd1\u5b89\u88c5","text":"<p>\u7f16\u8bd1\u5b89\u88c5\uff0c\u9700\u8981\u7684\u76f8\u5173\u4f9d\u8d56\uff1a</p> <ul> <li>GNU make version 3.80 or newer; </li> <li>ISO/ANSI C compiler (at least C99-compliant). Recent versions of GCC are recom-mended</li> <li>The GNU Readline library is used by default</li> </ul> <pre><code># https://wiki.postgresql.org/wiki/Compile_and_Install_from_source_code\napt-get install build-essential  zlib1g-dev   libxml2-dev libxslt-dev libssl-dev  xsltproc ccache  bison flex libxml2-utils libreadline-dev  libsystemd-dev libacl1  libacl1-dev libicu-dev pkg-config\n\n# git clone\u6e90\u4ee3\u7801\ngit clone https://git.postgresql.org/git/postgresql.git \n\n\n# \u5b98\u7f51\u4e0b\u8f7d\u4e8c\u8fdb\u5236\uff0c\u4e00\u822c\u4e0b\u6bd4\u8f83\u65b0\u7684\u7248\u672c\nwget https://ftp.postgresql.org/pub/source/v13.2/postgresql-13.2.tar.gz -P /usr/local/src/\nwget https://mirrors.tuna.tsinghua.edu.cn/postgresql/source/v14.4/postgresql-14.4.tar.gz -P /usr/local/src/\nwget https://mirrors.ustc.edu.cn/postgresql/source/v14.4/postgresql-14.4.tar.gz -P /usr/local/src/\ncd /usr/local/src/  &amp;&amp; tar -zxvf postgresql-14.4.tar.gz\n\n\n# \u521b\u5efa\u7528\u4e8e\u8fd0\u884cpostgre\u7684\u64cd\u4f5c\u7cfb\u7edf\u8d26\u53f7\uff0c\u5e76\u8bbe\u7f6e\u5f3a\u5bc6\u7801\ngroupadd postgres &amp;&amp;  useradd -g postgres postgres\necho \"postgres@123\" | passwd --stdin postgres\n\n# \u521b\u5efa\u5b89\u88c5\u76ee\u5f55\nmkdir -p /data/postgres/data\nchown -R postgres:postgres /data/postgres/\n\n\ncd /usr/local/src/postgresql-14.4\n# \u5982\u679c\u4e0d\u81ea\u5b9a\u4e49\u76ee\u5f55\uff0c\u540e\u9762\u7684\u5b89\u88c5\u9ed8\u8ba4\u4f1a\u5b89\u5230/usr/local/pgsql/bin\u4e2d\n./configure --prefix=/data/postgres/14.4/  --with-systemd\nmake world\nmake install\n\n\nsu - postgres\n\n# \u521d\u59cb\u5316\uff0c\u521d\u59cb\u5316\u5fc5\u987b\u8981\u5207\u5230postgres\u7528\u6237\uff0c\u4e0d\u80fd\u7528root\u7528\u6237\u6267\u884c\u521d\u59cb\u5316\u547d\u4ee4\n# \u5728\u521d\u59cb\u5316\u6570\u636e\u5e93\u7cfb\u7edf\u65f6\u6709\u4e00\u4e2a\u9884\u5b9a\u4e49\u7684\u8d85\u7ea7\u7528\u6237\uff0c\u8fd9\u4e2a\u7528\u6237\u7684\u540d\u79f0\u4e0e\u521d\u59cb\u5316\u8be5\u6570\u636e\u5e93\u7684\u64cd\u4f5c\u7cfb\u7edf\u7528\u6237\u540d\u76f8\u540c\u3002\n\n\n# \u53c2\u6570\n/data/postgres/14.4/bin/initdb -D /data/postgres/14.4/data\n\n\n\n# \u542f\u52a8\n# bin\u76ee\u5f55\u4e2d\u7684postgres\u5c31\u662fpostgre server\u8fdb\u7a0b\u7684\u4e8c\u8fdb\u5236\u53ef\u6267\u884c\u6587\u4ef6\n\n# \u76f4\u63a5\u524d\u53f0\u542f\u52a8\uff0c-D\u6307\u5b9a\u6570\u636e\u76ee\u5f55\uff0c\u5982\u679c\u6ca1\u6709-D\uff0c\u5219\u7528PGDATA\u73af\u5883\u53d8\u91cf\u3002\npostgres -D /usr/local/pgsql/data\n\n# pg_ctl\u662f\u4e00\u4e2a\u5305\u88c5\u547d\u4ee4\uff0c\u53ef\u4ee5\u76f4\u63a5\u540e\u53f0\u542f\u52a8postgre\u8fdb\u7a0b\n/usr/local/pgsql/bin/pg_ctl start -l logfile -D /usr/local/pgsql/data\n\n# \u767b\u5f55\n./psql  -h localhost -p 54321 -U postgres -w password -d postgres\n\n# \u4fee\u6539\u5bc6\u7801\nALTER USER postgres WITH PASSWORD 'postgres@123';\n\n\n\n# \u6ce8\u518c\u6210\u7cfb\u7edf\u670d\u52a1\uff0c/etc/systemd/system/postgresql.service\n[Unit]\nDescription=PostgreSQL database server\nDocumentation=man:postgres(1)\n[Service]\nType=notify\nUser=postgres\nExecStart=/usr/local/pgsql/bin/postgres -D /usr/local/pgsql/data\nExecReload=/bin/kill -HUP $MAINPID\nKillMode=mixed\nKillSignal=SIGINT\nTimeoutSec=infinity\n[Install]\nWantedBy=multi-user.target\n</code></pre>"},{"location":"postgresql/02.postgresql%E5%AE%89%E8%A3%85/#_3","title":"\u914d\u7f6e","text":"<p><code>PostgreSQL</code>\u914d\u7f6e\uff0c\u4e3b\u8981\u5206\u4e3a\u4e09\u7c7b\u914d\u7f6e\u6587\u4ef6\uff0c</p>"},{"location":"postgresql/02.postgresql%E5%AE%89%E8%A3%85/#_4","title":"\u4e3b\u914d\u7f6e\u6587\u4ef6","text":"<p>\u5bf9\u4e8ePostgreSQL 9.4\u6216\u4e4b\u540e\u7684\u7248\u672c\uff0c\u5f53\u4f7f\u7528initdb\u7a0b\u5e8f\u547d\u4ee4\u521d\u59cb\u5316\u6570\u636e\u5e93\u96c6\u7c07\u4e4b\u540e\uff0c\u4f1a\u5728PG_DATA\u76ee\u5f55\u4e0b\u540c\u65f6\u5b58\u5728\u4e24\u4e2a\u4e0ePostgreSQL\u670d\u52a1\u76f8\u5173\u7684\u914d\u7f6e\u6587\u4ef6\u3002</p> <p>\u5b83\u4eec\u5206\u522b\u662fpostgresql.auto.conf\u548cpostgresql.conf\u3002\u5bf9\u4e8epostgresql.conf\u6587\u4ef6\uff0c\u6211\u4eec\u6bd4\u8f83\u719f\u6089\uff0c\u8be5\u6587\u4ef6\u4e2d\u5b58\u50a8\u7740\u4e0ePostgreSQL\u670d\u52a1\u76f8\u5173\u7684\u6240\u6709\u9ed8\u8ba4\u53c2\u6570\u3002</p> <p>\u5728PostgreSQL 9.4\u7248\u672c\u4e4b\u524d\uff0c\u5982\u679c\u9700\u8981\u5bf9PostgreSQL\u670d\u52a1\u7684\u67d0\u4e9b\u529f\u80fd\u8fdb\u884c\u4f18\u5316\u3001\u6216\u662f\u8c03\u6574\u9ed8\u8ba4\u914d\u7f6e\u53c2\u6570\uff0c\u5219\u4fee\u6539postgresql.conf\u914d\u7f6e\u6587\u4ef6\uff0c\u7136\u540e\u91cd\u542fPostgreSQL\uff08\u5bf9\u4e8e\u5927\u591a\u6570\u914d\u7f6e\u53c2\u6570\u7684\u4fee\u6539\uff0c\u5747\u9700\u8981\u91cd\u542f\u4ee5\u751f\u6548\uff09\u670d\u52a1\u3002</p> <p>\u53c2\u6570\u52a8\u6001\u4fee\u6539</p> <p>\u4f46\u662f\u4ecePostgreSQL 9.4\u7248\u672c\u5f00\u59cb\uff0c\u65b0\u5f15\u5165\u4e86postgresql.auto.conf\u914d\u7f6e\u6587\u4ef6\uff0c\u5b83\u4f5c\u4e3apostgresql.conf\u6587\u4ef6\u7684\u8865\u5145\uff0c\u5728\u53c2\u6570\u914d\u7f6e\u683c\u5f0f\u4e0a\uff0c\u5b83\u548cpostgresql.conf\u4fdd\u6301\u4e00\u81f4\u3002</p> <pre><code>configuration_parameter = value \u6216 configuration_parameter = 'value'\n</code></pre> <p>postgresql.conf\u6587\u4ef6\u521b\u5efa\u6210\u529f\u4e4b\u540e\uff0c\u91cc\u9762\u6709PostgreSQL\u4f9d\u8d56\u7684\u9ed8\u8ba4\u914d\u7f6e\u6587\u4ef6\u53c2\u6570\uff0c\u6bd4\u5982\"\u6700\u5927\u8fde\u63a5\u6570\u3001\u5171\u4eab\u7f13\u51b2\u533a\u3001\u65f6\u533a\"\u7b49\u7b49</p> <p>\u5bf9\u4e8epostgresql.auto.conf\u914d\u7f6e\u6587\u4ef6\uff0c\u4e00\u5f00\u59cb\u9664\u4e86\u4e24\u884c\u6587\u672c\u6ce8\u91ca\u8bf4\u660e\u4e4b\u5916\uff0c\u6ca1\u6709\u5176\u4ed6\u7684\u914d\u7f6e\u53c2\u6570\u3002\u6b63\u5982postgresql.auto.conf\u914d\u7f6e\u6587\u4ef6\u4e2d\u521d\u59cb\u5316\u65f6\u7684\u6587\u672c\u5b57\u7b26\u4e32\u63d0\u793a\u4e00\u6837\uff1a</p> <p>\u4e0d\u8981\u624b\u52a8\u4fee\u6539\u6b64\u6587\u4ef6, \u56e0\u4e3a\u5b83\u4f1a\u88abALTER SYSTEM\u547d\u4ee4\u7ed9\u8986\u76d6\u3002</p> <p>\u8be5\u6587\u4ef6\u4e3b\u8981\u7528\u4e8e\u5b58\u50a8\u6709<code>ALTER SYSTEM</code>\u547d\u4ee4\u8bbe\u7f6e\u7684\u53c2\u6570\u503c\u3002\u6240\u4ee5\u5b83\u4e0d\u9700\u8981\u50cfpostgresql.conf\u6587\u4ef6\u4e00\u6837\uff0c\u6bcf\u5f53\u8c03\u6574\u914d\u7f6e\u53c2\u6570\u65f6\uff0c\u90fd\u624b\u52a8\u53bb\u6253\u5f00\u4fee\u6539\u3001\u4fdd\u5b58\u3002</p> <p><code>ALTER SYSTEM</code>\u8bed\u53e5\u662fPostgreSQL\u6570\u636e\u5e93\u7684\u4e00\u4e2a\u6269\u5c55\uff0c\u5b83\u7528\u4e8e\u5728PostgreSQL\u6570\u636e\u5e93\u96c6\u7fa4\u4e2d\u4fee\u6539\u670d\u52a1\u5668\u7684\u914d\u7f6e\u53c2\u6570\u3002\u7136\u540e\u4fee\u6539\u540e\u7684\u53c2\u6570\u5c06\u4fdd\u5b58\u5728postgresql.auto.conf\u914d\u7f6e\u6587\u4ef6\u4e2d\u3002</p> <p>\u5f53\u4f7f\u7528<code>ALTER SYSTEM</code>\u8bed\u53e5\u4fee\u6539\u4e86\u67d0\u914d\u7f6e\u53c2\u6570\u4e4b\u540e\uff0c\u8be5\u6587\u4ef6\u4e2d\u5b58\u5728\u7684\u8fd9\u4e2a\u53c2\u6570\u5c06\u8986\u76d6\u89e3\u6790\u8be5\u6587\u4ef6\u4e4b\u524d\u5b58\u5728\u7684\u53c2\u6570\u503c\u3002\u901a\u4fd7\u70b9\u8bf4\uff0c\u5c31\u662f\u8be5\u6587\u4ef6\u4e2d\u7684\u8fd9\u4e2a\u53c2\u6570\u5c06\u8986\u76d6\u6389postgresql.conf\u6587\u4ef6\u4e2d\u7684\u8be5\u53c2\u6570\uff08\u4f46\u662fpostgresql.conf\u6587\u4ef6\u4e2d\u8fd9\u4e2a\u53c2\u6570\u503c\u4e0d\u4f1a\u88ab\u4fee\u6539\uff0c\u53ea\u662f\u5bf9\u4e8ePostgreSQL\u670d\u52a1\uff0cpostgresql.auto.conf\u6587\u4ef6\u4e2d\u7684\u8be5\u53c2\u6570\u5177\u6709\u66f4\u9ad8\u7684\u4f18\u5148\u7ea7\uff09\u3002</p>"},{"location":"postgresql/02.postgresql%E5%AE%89%E8%A3%85/#_5","title":"\u5ba2\u6237\u7aef\u8ba4\u8bc1\u914d\u7f6e\u6587\u4ef6","text":"<p>\u5ba2\u6237\u7aef\u8ba4\u8bc1\u662f\u7531\u4e00\u4e2a\u914d\u7f6e\u6587\u4ef6\uff08\u901a\u5e38\u540d\u4e3a<code>pg_hba.conf</code>\u5e76\u88ab\u5b58\u653e\u5728\u6570\u636e\u5e93\u96c6\u7c07\u76ee\u5f55\u4e2d\uff09\u63a7\u5236\uff08HBA\u8868\u793a\u57fa\u4e8e\u4e3b\u673a\u7684\u8ba4\u8bc1\uff0chost-based authentication\uff09\u3002</p> <p>\u5728initdb\u521d\u59cb\u5316\u6570\u636e\u76ee\u5f55\u65f6\uff0c\u5b83\u4f1a\u5b89\u88c5\u4e00\u4e2a\u9ed8\u8ba4\u7684<code>pg_hba.conf</code>\u6587\u4ef6\u3002\u4e0d\u8fc7\u6211\u4eec\u4e5f\u53ef\u4ee5\u628a\u8ba4\u8bc1\u914d\u7f6e\u6587\u4ef6\u653e\u5728\u5176\u5b83\u5730\u65b9\u3002</p> <p>pg_hba.conf\u7684\u8def\u5f84\u7531<code>postgresql.conf</code>\u4e2d\u7684<code>hba_file = 'ConfigDir/pg_hba.conf'</code>\u6765\u63a7\u5236\u3002</p> <p>pg_hba.conf\u6587\u4ef6\u7684\u5e38\u7528\u683c\u5f0f\u662f\u4e00\u7ec4\u8bb0\u5f55\uff0c\u6bcf\u884c\u4e00\u6761\u3002\u7a7a\u767d\u884c\u5c06\u88ab\u5ffd\u7565\uff0c\u8bb0\u5f55\u4e0d\u80fd\u8de8\u884c\u3002\u6ce8\u91ca\u884c\u4ee5#\u53f7\u5f00\u5934\u3002</p> <p>\u4e00\u6761\u8bb0\u5f55\u7531\u82e5\u5e72\u7528\u7a7a\u683c \u548c/\u6216\u5236\u8868\u7b26\u5206\u9694\u7684\u57df\u7ec4\u6210\u3002\u5982\u679c\u57df\u503c\u7528\u53cc\u5f15\u53f7\u5305\u56f4\uff0c\u90a3\u4e48\u5b83\u53ef\u4ee5\u5305\u542b\u7a7a\u767d\u3002 \u5728\u6570\u636e\u5e93\u3001\u7528\u6237\u6216\u5730\u5740\u57df\u4e2d \u5f15\u7528\u4e00\u4e2a\u5173\u952e\u5b57\uff08\u4f8b\u5982\uff0call\u6216replication\uff09\u5c06\u4f7f\u8be5\u8bcd\u5931\u53bb\u5176\u7279\u6b8a \u542b\u4e49\uff0c\u5e76\u4e14\u53ea\u662f\u5339\u914d\u4e00\u4e2a\u6709\u8be5\u540d\u5b57\u7684\u6570\u636e\u5e93\u3001\u7528\u6237\u6216\u4e3b\u673a\u3002</p> <p>\u6bcf\u6761\u8bb0\u5f55\u6307\u5b9a\u4e00\u79cd\u8fde\u63a5\u7c7b\u578b\u3001\u4e00\u4e2a\u5ba2\u6237\u7aef IP \u5730\u5740\u8303\u56f4\uff08\u5982\u679c\u548c\u8fde\u63a5\u7c7b\u578b\u76f8\u5173\uff09\u3001\u4e00\u4e2a\u6570\u636e\u5e93\u540d\u3001\u4e00\u4e2a\u7528\u6237\u540d\u4ee5\u53ca\u5bf9\u5339\u914d\u8fd9\u4e9b\u53c2\u6570\u7684\u8fde\u63a5\u4f7f\u7528\u7684\u8ba4\u8bc1\u65b9\u6cd5\u3002</p> <p>\u7b2c\u4e00\u6761\u5339\u914d\u8fde\u63a5\u7c7b\u578b\u3001\u5ba2\u6237\u7aef\u5730\u5740\u3001\u8fde\u63a5\u8bf7\u6c42\u7684\u6570\u636e\u5e93\u548c\u7528\u6237\u540d\u7684\u8bb0\u5f55\u5c06\u88ab\u7528\u4e8e\u6267\u884c\u8ba4\u8bc1\u3002</p> <p>\u8fd9\u4e2a\u8fc7\u7a0b\u6ca1\u6709\"\u843d\u7a7a\"\u6216\u8005\"\u540e\u5907\"\u7684\u8bf4\u6cd5\uff1a\u5982\u679c\u9009\u62e9\u4e86\u4e00\u6761\u8bb0\u5f55\u800c\u4e14\u8ba4\u8bc1\u5931\u8d25\uff0c\u90a3\u4e48\u5c06\u4e0d\u518d\u8003\u8651\u540e\u9762\u7684\u8bb0\u5f55\u3002\u5982\u679c\u6ca1\u6709\u5339\u914d\u7684\u8bb0\u5f55\uff0c\u90a3\u4e48\u8bbf\u95ee\u5c06\u88ab\u62d2\u7edd\u3002</p> <pre><code># pg_hba.conf\u6587\u4ef6\u7684\u5e38\u7528\u683c\u5f0f\u662f\u4e00\u7ec4\u8bb0\u5f55\uff0c\u6bcf\u884c\u4e00\u6761\u3002\u7a7a\u767d\u884c\u5c06\u88ab\u5ffd\u7565\uff0c\u00a0#\u6ce8\u91ca\u5b57\u7b26\u540e\u9762\u7684\u4efb\u4f55\u6587\u672c\u4e5f\u88ab\u5ffd\u7565\u3002\u8bb0\u5f55\u4e0d\u80fd\u8de8\u884c\u3002\n# \u4e00\u6761\u8bb0\u5f55\u7531\u82e5\u5e72\u7528\u7a7a\u683c \u548c/\u6216\u5236\u8868\u7b26\u5206\u9694\u7684\u57df\u7ec4\u6210\u3002\u5982\u679c\u57df\u503c\u7528\u53cc\u5f15\u53f7\u5305\u56f4\uff0c\u90a3\u4e48\u5b83\u53ef\u4ee5\u5305\u542b\u7a7a\u767d\u3002\n# \u5728\u6570\u636e\u5e93\u3001\u7528\u6237\u6216\u5730\u5740\u57df\u4e2d \u5f15\u7528\u4e00\u4e2a\u5173\u952e\u5b57\uff08\u4f8b\u5982\uff0call\u6216replication\uff09\u5c06\u4f7f\u8be5\u8bcd\u5931\u53bb\u5176\u7279\u6b8a \u542b\u4e49\uff0c\u5e76\u4e14\u53ea\u662f\u5339\u914d\u4e00\u4e2a\u6709\u8be5\u540d\u5b57\u7684\u6570\u636e\u5e93\u3001\u7528\u6237\u6216\u4e3b\u673a\u3002\n# \u6bcf\u6761\u8bb0\u5f55\u6307\u5b9a\u4e00\u79cd\u8fde\u63a5\u7c7b\u578b\u3001\u4e00\u4e2a\u5ba2\u6237\u7aef IP \u5730\u5740\u8303\u56f4\uff08\u5982\u679c\u548c\u8fde\u63a5\u7c7b\u578b\u76f8\u5173\uff09\u3001\u4e00\u4e2a\u6570\u636e\u5e93\u540d\u3001\u4e00\u4e2a\u7528\u6237\u540d\u4ee5\u53ca\u5bf9\u5339\u914d\u8fd9\u4e9b\u53c2\u6570\u7684\u8fde\u63a5\u4f7f\u7528\u7684\u8ba4\u8bc1\u65b9\u6cd5\u3002\n# \u7b2c\u4e00\u6761\u5339\u914d\u8fde\u63a5\u7c7b\u578b\u3001\u5ba2\u6237\u7aef\u5730\u5740\u3001\u8fde\u63a5\u8bf7\u6c42\u7684\u6570\u636e\u5e93\u548c\u7528\u6237\u540d\u7684\u8bb0\u5f55\u5c06\u88ab\u7528\u4e8e\u6267\u884c\u8ba4\u8bc1\u3002\n\n# PostgreSQL\u81ea\u4e0a\u800c\u4e0b\u9010\u884c\u68c0\u67e5\u89c4\u5219\uff0c\u4e00\u65e6\u5339\u914d\u5230\u4e00\u6761\u89c4\u5219\uff0c\u5c31\u505c\u6b62\u68c0\u67e5\u3002\u5982\u679c\u524d\u9762\u7684\u89c4\u5219\u8fc7\u4e8e\u5bbd\u677e\uff0c\u540e\u9762\u7684\u89c4\u5219\u53ef\u80fd\u6c38\u8fdc\u4e0d\u4f1a\u88ab\u5339\u914d\u3002\u6709\u70b9\u50cf\u9632\u706b\u5899\u7684\u6982\u5ff5\u3002\n# \u5c06\u9650\u5236\u6027\u66f4\u5f3a\u7684\u89c4\u5219\u653e\u5728\u524d\u9762\uff0c\u5c06\u5f00\u653e\u6027\u89c4\u5219\u653e\u5728\u540e\u9762\u3002\u4f8b\u5982\uff0c\u5148\u9650\u5236\u7279\u5b9aIP\u5730\u5740\u7684\u8bbf\u95ee\uff0c\u518d\u5141\u8bb8\u672c\u5730\u8fde\u63a5\u3002\n# \u8fd9\u4e2a\u8fc7\u7a0b\u6ca1\u6709\u201c\u843d\u7a7a\u201d\u6216\u8005\u201c\u540e\u5907\u201d\u7684\u8bf4\u6cd5\uff1a\u5982\u679c\u9009\u62e9\u4e86\u4e00\u6761\u8bb0\u5f55\u800c\u4e14\u8ba4\u8bc1\u5931\u8d25\uff0c\u90a3\u4e48\u5c06\u4e0d\u518d\u8003\u8651\u540e\u9762\u7684\u8bb0\u5f55\u3002\u5982\u679c\u6ca1\u6709\u5339\u914d\u7684\u8bb0\u5f55\uff0c\u90a3\u4e48\u8bbf\u95ee\u5c06\u88ab\u62d2\u7edd\u3002\n\n# TYPE     DATABASE USER   ADDRESS                METHOD\n\nlocal      database  user                       auth-method     [auth-options]\nhost       database  user  address              auth-method     [auth-options]\nhostssl    database  user  address              auth-method     [auth-options]\nhostnossl  database  user  address              auth-method     [auth-options]\nhost       database  user  IP-address  IP-mask  auth-method     [auth-options]\nhostssl    database  user  IP-address  IP-mask  auth-method     [auth-options]\nhostnossl  database  user  IP-address  IP-mask  auth-method     [auth-options]\n\n# \"local\" is for Unix domain socket connections only\nlocal       all              all                     trust\n\n# IPv4 local connections:\nhost    all             all             127.0.0.1/32            trust\n# IPv6 local connections:\nhost    all             all             ::1/128                 trust\n\n\n\n\n# \u7b2c\u4e00\u4e2a\u5b57\u6bb5\u7684\u53d6\u503c\u5982\u4e0b\uff1a\n# local     \u672c\u5730\u8fde\u63a5\uff0c\u8fd9\u6761\u8bb0\u5f55\u5339\u914d\u4f01\u56fe\u4f7f\u7528 Unix \u57df\u5957\u63a5\u5b57\u7684\u8fde\u63a5\u3002\u5982\u679c\u6ca1\u6709\u8fd9\u79cd\u7c7b\u578b\u7684\u8bb0\u5f55\uff0c\u5c31\u4e0d\u5141\u8bb8 Unix \u57df\u5957\u63a5\u5b57\u8fde\u63a5\u3002\n# host      \u8fd9\u6761\u8bb0\u5f55\u5339\u914d\u4f01\u56fe\u4f7f\u7528 TCP/IP \u5efa\u7acb\u7684\u8fde\u63a5\u3002host\u8bb0\u5f55\u5339\u914dSSL\u548c\u975eSSL\u7684\u8fde\u63a5\u5c1d\u8bd5\u3002\n# hostssl   \u8fd9\u6761\u8bb0\u5f55\u5339\u914d\u4f01\u56fe\u4f7f\u7528 TCP/IP \u5efa\u7acb\u7684\u8fde\u63a5\uff0c\u4f46\u5fc5\u987b\u662f\u4f7f\u7528SSL\u52a0\u5bc6\u7684\u8fde\u63a5\u3002\u8981\u4f7f\u7528\u8fd9\u4e2a\u9009\u9879\uff0c\u7f16\u8bd1\u670d\u52a1\u5668\u7684\u65f6\u5019\u5fc5\u987b\u6253\u5f00SSL\u652f\u6301\u3002\n# \nhost all all 0.0.0.0/0        md5 # \u5141\u8bb8\u6240\u6709\u673a\u5668\u767b\u5f55\uff0c\u4f7f\u7528md5\u5bc6\u7801\u3002\n\n# \u7b2c\u4e8c\u4e2a\u5b57\u6bb5\u53d6\u503c\uff1a\n# database \u58f0\u660e\u8bb0\u5f55\u6240\u5339\u914d\u7684\u6570\u636e\u5e93\u540d\u79f0\u3002\u503c\u00a0all\u8868\u660e\u8be5\u8bb0\u5f55\u5339\u914d\u6240\u6709\u6570\u636e\u5e93\uff0c\u53ef\u4ee5\u901a\u8fc7\u7528\u9017\u53f7\u5206\u9694\u7684\u65b9\u6cd5\u58f0\u660e\u591a\u4e2a\u6570\u636e\u5e93\uff0c\u4e5f\u53ef\u4ee5\u901a\u8fc7\u524d\u7f00@\u6765\u58f0\u660e\u4e00\u4e2a\u5305\u542b\u6570\u636e\u5e93\u540d\u7684\u6587\u4ef6\u3002\n\n# \u7b2c\u4e09\u4e2a\u5b57\u6bb5\u53d6\u503c\uff1a\n# user \u4e3a\u8fd9\u6761\u8bb0\u5f55\u58f0\u660e\u6240\u5339\u914d\u7684\u6570\u636e\u5e93\u7528\u6237\u3002\u503call\u8868\u660e\u5b83\u5339\u914d\u4e8e\u6240\u6709\u7528\u6237\u3002\u5426\u5219\uff0c \u5b83\u5c31\u662f\u7279\u5b9a\u6570\u636e\u5e93\u7528\u6237\u7684\u540d\u5b57\u6216\u8005\u662f\u4e00\u4e2a\u524d\u7f00+\u7684\u7ec4\u540d\u79f0\u3002\n</code></pre>"},{"location":"postgresql/02.postgresql%E5%AE%89%E8%A3%85/#_6","title":"\u547d\u4ee4\u884c\u4ea4\u4e92","text":"<p>\u5728UNIX\u5e73\u53f0\u4e2d\u5b89\u88c5PostgreSQL\u4e4b\u540e\uff0cPostgreSQL\u4f1a\u5728UNIX\u7cfb\u7edf\u4e2d\u521b\u5efa\u4e00\u4e2a\u540d\u4e3a\"postgres\"\u7684\u7cfb\u7edf\u7528\u6237\u3002PostgreSQL\u7684\u9ed8\u8ba4\u7528\u6237\u540d\u548c\u6570\u636e\u5e93\u4e5f\u662f\"postgres\"\u3002</p> <p>\u5982\u679c\u662f\u5305\u7ba1\u7406\u5668\u5b89\u88c5\uff0c\u4e00\u822c\u4f1a\u81ea\u52a8\u521b\u5efa\u8fd9\u4e2a\u7528\u6237\uff0c\u5982\u679c\u662f\u6e90\u4ee3\u7801\u7f16\u8bd1\u5b89\u88c5\uff0c\u4e00\u822c\u4e5f\u5efa\u8bae\u521b\u5efa\u4e00\u4e2a\u8fd9\u6837\u7684\u7528\u6237\u3002</p> <p>Linux\u670d\u52a1\u5668\u4e2d\u7684postgresql\u8fdb\u7a0b\u901a\u5e38\u662f\u7531\u64cd\u4f5c\u7cfb\u7edf\u7684postgres\u7528\u6237\u6765\u542f\u52a8\u7684\u3002</p> <p>\u5982\u679c\u4f60\u8fde\u63a5\u5230\u4e00\u4e2a\u6570\u636e\u5e93\u65f6\uff0c\u4f60\u53ef\u4ee5\u9009\u62e9\u4ee5\u4f55\u79cdPostgreSQL\u7528\u6237\u540d\u8fdb\u884c\u8fde\u63a5\uff0c\u5982\u679c\u4f60\u4e0d\u9009\u62e9\uff0c\u90a3\u4e48\u9ed8\u8ba4\u5c31\u662f\u4f60\u7684\u5f53\u524d\u64cd\u4f5c\u7cfb\u7edf\u8d26\u53f7\u3002 \u5982\u679c\u8fd9\u6837\uff0c\u90a3\u4e48\u603b\u6709\u4e00\u4e2a\u4e0e\u64cd\u4f5c\u7cfb\u7edf\u7528\u6237\u540c\u540d\u7684PostgreSQL\u7528\u6237\u8d26\u53f7\u7528\u4e8e\u542f\u52a8\u670d\u52a1\u5668\uff0c \u5e76\u4e14\u901a\u5e38\u8fd9\u4e2a\u7528\u6237\u90fd\u6709\u521b\u5efa\u6570\u636e\u5e93\u7684\u6743\u9650\u3002 \u5982\u679c\u4f60\u4e0d\u60f3\u4ee5\u8be5\u7528\u6237\u8eab\u4efd\u767b\u5f55\uff0c \u90a3\u4e48\u4f60\u4e5f\u53ef\u4ee5\u5728\u4efb\u4f55\u5730\u65b9\u58f0\u660e\u4e00\u4e2a-U\u9009\u9879\u4ee5\u9009\u62e9\u4e00\u4e2a\u7528\u4e8e\u8fde\u63a5\u7684PostgreSQL\u7528\u6237\u540d\u3002</p> <p>\u89d2\u8272\u5c31\u76f8\u5f53\u4e8e\u5c97\u4f4d\uff1a\u89d2\u8272\u53ef\u4ee5\u662f\u7ecf\u7406\uff0c\u52a9\u7406\u3002</p> <p>\u7528\u6237\u5c31\u662f\u5177\u4f53\u7684\u4eba\uff1a\u6bd4\u5982\u9648XX\u7ecf\u7406\uff0c\u6731XX\u52a9\u7406\uff0c\u738bXX\u52a9\u7406\u3002</p> <p>\u5728PostgreSQL \u91cc\u6ca1\u6709\u533a\u5206\u7528\u6237\u548c\u89d2\u8272\u7684\u6982\u5ff5\uff0c\"CREATE USER\" \u4e3a \"CREATE ROLE\" \u7684\u522b\u540d \u8fd9\u4e24\u4e2a\u547d\u4ee4\u51e0\u4e4e\u662f\u5b8c\u5168\u76f8\u540c\u7684\uff0c\u552f\u4e00\u7684\u533a\u522b\u662f\"CREATE USER\" \u547d\u4ee4\u521b\u5efa\u7684\u7528\u6237\u9ed8\u8ba4\u5e26\u6709LOGIN\u5c5e\u6027\uff0c\u800c\"CREATE ROLE\" \u547d\u4ee4\u521b\u5efa\u7684\u7528\u6237\u9ed8\u8ba4\u4e0d\u5e26LOGIN\u5c5e\u6027 (CREATE USER is equivalent to CREATE ROLE except that CREATE USER assumes LOGIN by default, while CREATE ROLE does not)</p> <p>PostgreSQL\u5b89\u88c5\u540e\u9ed8\u8ba4\u7528\u6237\u540d\u548c\u6570\u636e\u5e93\u4e5f\u662f\"postgres\"\uff0c\u9ed8\u8ba4\u6ca1\u6709\u5bc6\u7801\u3002\u5728\u5b89\u88c5PostgreSQL\u4e4b\u540e\u53ef\u4ee5\u4ee5\u9ed8\u8ba4\u7528\u6237\u767b\u5f55\uff0c\u4e5f\u53ef\u4ee5\u521b\u5efa\u65b0\u5f53\u7528\u6237\u540d\u3002</p> <p>\u5b89\u88c5\u6210\u529f\u540e\uff0cPostgreSQL \u4f1a\u81ea\u52a8\u521b\u5efa\u4e00\u4e2a\u9ed8\u8ba4\u7528\u6237\uff08\u8fd9\u4e2a\u5c5e\u4e8e\u6700\u9ad8\u6743\u9650\u7684 superuser\uff09\uff0c\u540d\u79f0\u4e3a postgres\uff0c\u5bc6\u7801\u4e3a\u7a7a\u3002</p> <p>\u4f46\u662f\u4e0d\u652f\u6301\u8fdc\u7a0b\u767b\u5f55\uff08\u62a5\u9519\uff1apsql: fe_sendauth: no password supplied\uff09\uff0c\u5fc5\u987b\u8bbe\u7f6e\u5bc6\u7801\u540e\u624d\u884c\uff08\u666e\u901a\u7528\u6237\u4e5f\u9002\u7528\u8fd9\u4e2a\u89c4\u5219\uff09\u3002</p> <pre><code># \u5207\u6362\u5230Linux\u64cd\u4f5c\u7cfb\u7edf\u4e0a\u7684postgre\u7528\u6237\nsu postgres \n\n# \u767b\u9646: \u4e3b\u673a\uff0c\u7aef\u53e3\uff0c\u7528\u6237\u540d\uff0c\u5bc6\u7801\uff0c\u4f7f\u7528\u7684\u6570\u636e\u5e93\npsql  -h localhost -p 54321 -U postgres -w password -d postgres\n#\npassword postgres    \n</code></pre> <pre><code>-- \u521b\u5efa\u666e\u901a\u7528\u6237\nCREATE ROLE david   WITH PASSWORD '123456';\u3000   -- \u9ed8\u8ba4\u4e0d\u5e26LOGIN\u5c5e\u6027\nCREATE USER fengzhao WITH PASSWORD '123456';\u3000\u3000-- \u9ed8\u8ba4\u5177\u6709LOGIN\u5c5e\u6027\n\n-- \u5728PostgreSQL \u91cc\u6ca1\u6709\u533a\u5206\u7528\u6237\u548c\u89d2\u8272\u7684\u6982\u5ff5\uff0c\"CREATE USER\" \u4e3a \"CREATE ROLE\" \u7684\u522b\u540d\n-- \u8fd9\u4e24\u4e2a\u547d\u4ee4\u51e0\u4e4e\u662f\u5b8c\u5168\u76f8\u540c\u7684\uff0c\u552f\u4e00\u7684\u533a\u522b\u662f\"CREATE USER\"\u547d\u4ee4\u521b\u5efa\u7684\u7528\u6237\u9ed8\u8ba4\u5e26\u6709LOGIN\u5c5e\u6027\uff0c\u800c\"CREATE ROLE\"\u547d\u4ee4\u521b\u5efa\u7684\u7528\u6237\u9ed8\u8ba4\u4e0d\u5e26LOGIN\u5c5e\u6027\n-- (CREATE USER is equivalent to CREATE ROLE except that CREATE USER assumes LOGIN by default, while CREATE ROLE does not)\n\n-- \u7528\u6237sandy\u53ef\u4ee5\u767b\u5f55\uff0c\u89d2\u8272david\u4e0d\u53ef\u4ee5\u767b\u5f55\u3002\n-- \u89d2\u8272\u5c31\u76f8\u5f53\u4e8e\u5c97\u4f4d\uff1a\u89d2\u8272\u53ef\u4ee5\u662f\u7ecf\u7406\uff0c\u52a9\u7406\u3002\n-- \u7528\u6237\u5c31\u662f\u5177\u4f53\u7684\u4eba\uff1a\u6bd4\u5982\u9648XX\u7ecf\u7406\uff0c\u6731XX\u52a9\u7406\uff0c\u738bXX\u52a9\u7406\u3002\n\n-- PostgreSQL\u5b89\u88c5\u540e\u9ed8\u8ba4\u7528\u6237\u540d\u548c\u6570\u636e\u5e93\u4e5f\u662f\"postgres\"\uff0c\u9ed8\u8ba4\u6ca1\u6709\u5bc6\u7801\u3002\u5728\u5b89\u88c5PostgreSQL\u4e4b\u540e\u53ef\u4ee5\u4ee5\u9ed8\u8ba4\u7528\u6237\u767b\u5f55\uff0c\u4e5f\u53ef\u4ee5\u521b\u5efa\u65b0\u5f53\u7528\u6237\u540d\u3002\n-- \u5f3a\u70c8\u5efa\u8bae\u5b89\u88c5\u540e\u7b2c\u4e00\u4ef6\u4e8b\u5c31\u662f\u7ed9\u9ed8\u8ba4\u7684postgres\u7528\u6237\u521b\u5efa\u4e00\u4e2a\n\n-- \u5b98\u65b9\u5efa\u8bae\u662f\u8fd9\u6837\u7684\uff1a\n\n-- \u5728\u7ba1\u7406\u5458\u521b\u5efa\u4e00\u4e2a\u5177\u4f53\u6570\u636e\u5e93\u540e\uff0c\u5e94\u8be5\u4e3a\u6240\u6709\u53ef\u4ee5\u8fde\u63a5\u5230\u8be5\u6570\u636e\u5e93\u7684\u7528\u6237\u5206\u522b\u521b\u5efa\u4e00\u4e2a\u4e0e\u7528\u6237\u540d\u76f8\u540c\u7684\u6a21\u5f0f\uff0c\u7136\u540e\uff0c\u5c06search_path\u8bbe\u7f6e\u4e3a\"$user\"(\u5373\u7f3a\u7701\u6a21\u5f0f\u4e3a\u4e0e\u7528\u6237\u540d\u76f8\u540c\u7684\u6a21\u5f0f)\u3002\n-- \u8fd9\u6837\u4efb\u4f55\u5f53\u67d0\u4e2a\u7528\u6237\u8fde\u63a5\u4e0a\u6765\u540e\uff0c\u4f1a\u9ed8\u8ba4\u5c06\u67e5\u627e\u6216\u8005\u5b9a\u4e49\u7684\u5bf9\u8c61\u90fd\u5b9a\u4f4d\u5230\u4e0e\u4e4b\u540c\u540d\u7684\u6a21\u5f0f\u4e2d\u3002\u8fd9\u662f\u4e00\u4e2a\u597d\u7684\u8bbe\u8ba1\u67b6\u6784\u3002\n\n-- \u4e0d\u5efa\u8bae\u4e1a\u52a1\u9879\u76ee\u7684\u8868\u5b58\u653e\u5728public\u4e0b\uff1a\n--  1\u3001\u662f\u6570\u636e\u5b89\u5168\uff1b\n--  2\u3001\u8868\u5b58\u653e\u6df7\u4e71\uff1b\u4e0d\u5229\u4e8e\u540e\u671f\u7ef4\u62a4\u7b49\u7b49\u3002\n\n\nSELECT rolname from pg_roles ;\nSELECT usename from pg_user;  -- \u89d2\u8272david\u521b\u5efa\u65f6\u6ca1\u6709\u5206\u914dlogin\u6743\u9650\uff0c\u6240\u4ee5\u6ca1\u6709\u521b\u5efa\u7528\u6237\n\n\n\ncreate database dbtest;\n\nschema_element\nCREATE SCHEMA schema_name [AUTHORIZATION username]   [schema_element [ ... ]]\n-- schema_name\uff0c\u521b\u5efa\u65b9\u6848\u7684\u540d\u79f0\uff0c\u5982\u679c\u7701\u7565\uff0c\u5219\u5f53\u524d\u7528\u6237\u540d\u88ab\u7528\u4f5c\u65b9\u6848\u540d\u3002\u8be5\u540d\u5b57\u4e0d\u80fd\u4ee5 pg_ \u5f00\u5934\uff0c\u56e0\u4e3a\u8fd9\u4e9b\u540d\u5b57\u662f\u4e3a\u7cfb\u7edf\u76ee\u5f55\u65b9\u6848\u4fdd\u5b58\u7684\u3002\n-- rolename\uff0c\u62e5\u6709\u8be5\u65b9\u6848\u7684\u89d2\u8272\u7684\u540d\u79f0\u3002\u5982\u679c\u7701\u7565\uff0c\u9ed8\u8ba4\u4e3a\u6267\u884c\u8be5\u547d\u4ee4\u7684\u89d2\u8272\u3002\u53ea\u6709\u8d85\u7ea7\u7528\u6237\u53ef\u4ee5\u521b\u5efa\u5c5e\u4e8e\u5176\u4ed6\u89d2\u8272\u7684\u65b9\u6848\uff0c\u9664\u4e86\u4ed6\u4eec\u81ea\u5df1\u3002\n-- schema_element \uff0c\u5b9a\u4e49\u5728\u65b9\u6848\u4e2d\u521b\u5efa\u5bf9\u8c61\u7684 SQL \u8bed\u53e5\u3002\u6bd4\u5982 CREATE TABLE\u3001CREATE VIEW\u3001CREATE INDEX \u7b49\u8bed\u53e5\n</code></pre> <p>PostgreSQL \u63d0\u4f9b\u4e86\u5f3a\u5927\u7684\u547d\u4ee4\u884c\u4ea4\u4e92\u529f\u80fd\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528  + \u5173\u952e\u8bcd\u6765\u8fdb\u884c\u64cd\u4f5c\u3002\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u67e5\u9605\u6587\u6863\u6216 \\? \u4e0e help \u547d\u4ee4\u6765\u67e5\u770b\u547d\u4ee4\u8be6\u60c5\u4e0e\u5e2e\u52a9\u4fe1\u606f\u3002\u5176\u4ed6\u5e38\u7528\u547d\u4ee4\u5982\u4e0b\uff1a</p> <pre><code># \u67e5\u770b\u5e2e\u52a9\nhelp\n\n# \u67e5\u770b psql \u547d\u4ee4\u8be6\u60c5\n\\?\n\n# \u67e5\u770b\u6570\u636e\u5e93\uff08\u5168\u90e8\uff09\n\\l\n\n# \u67e5\u770b\u6570\u636e\u5e93\uff08\u6307\u5b9a\uff09\n\\l &lt;database-name&gt;\n\n# \u8fde\u63a5\u6570\u636e\u5e93\n\\c &lt;database-name&gt;\n\n# \u67e5\u770b\u65b9\u6cd5\n\\df\n\n# \u67e5\u770b\u8868\uff08\u5168\u90e8\uff09\n\\d\n\n# \u67e5\u770b\u8868\uff08\u53ea\u770b\u8868\uff09\n\\dt\n\n# \u67e5\u770b\u8868\uff08\u6307\u5b9a\uff09\n\\d &lt;table-name&gt;\n\n# \u6267\u884c sql \u547d\u4ee4\n\\i &lt;filepath&gt;/&lt;filename&gt;\n\n# \u6253\u5f00\u62d3\u5c55\u89c6\u56fe\n\\x\n\n# \u5bfc\u51fa\u81f3 CSV\n\\copy (SELECT * FROM person LEFT JOIN car ON person.car_id = car.id) TO 'path/to/output.csv' DELIMITER ',' CSV HEADER;\n\n# \u9000\u51fa\n\\q\n</code></pre>"},{"location":"postgresql/02.postgresql%E5%AE%89%E8%A3%85/#_7","title":"\u89d2\u8272\u7ba1\u7406","text":"<p>PostgreSQL \u7684\u6743\u9650\u7ba1\u7406\u6a21\u578b\uff0c\u662f\u4e00\u79cd\u5178\u578b\u7684 RBAC\uff08\u57fa\u4e8e\u89d2\u8272\u7684\u6743\u9650\u63a7\u5236\uff09\u7684\u5b9e\u73b0\u3002\u5176\u5c06\u7528\u6237\u3001\u89d2\u8272\u3001\u6743\u9650\u901a\u8fc7\u6b64\u6a21\u578b\u7ba1\u7406\u8d77\u6765\u3002</p> <p>\u524d\u9762\u8bb2\u5230\u8fc7\uff0cPostgreSQL \u4e2d\u7684\"\u7528\u6237\"\u6982\u5ff5\u548c\"\u89d2\u8272\"\u6982\u5ff5\u5b9e\u9645\u662f\u7b49\u540c\u7684\uff0c\u552f\u4e00\u7684\u533a\u522b\u5728\u4e8e\"\u7528\u6237\"\u62e5\u6709 login \u6743\u9650\uff0c\u800c\"\u89d2\u8272\"\u62e5\u6709 nologin \u6743\u9650\u3002</p> <p>PostgreSQL \u7684\u6743\u9650\u53ef\u4ee5\u5206\u4e3a\u4e24\u7c7b\uff0c\"\u7cfb\u7edf\u6743\u9650\"\u548c\"\u6570\u636e\u5e93\u5bf9\u8c61\u6743\u9650\"\u3002PostgreSQL \u901a\u8fc7\u89d2\u8272\u6765\u8fdb\u884c\u6743\u9650\u7ba1\u7406\uff0c\u89d2\u8272\u53ef\u4ee5\u62e5\u6709\u7cfb\u7edf\u6743\u9650\u548c\u6570\u636e\u5e93\u5bf9\u8c61\u6743\u9650\u3002\u5e76\u4e14\u4e5f\u53ef\u4ee5\u4f5c\u4e3a\u4e00\u7ec4\u6743\u9650\u96c6\u5408\uff0c\u6388\u4e88\u7ed9\u5176\u4ed6\u7684\u89d2\u8272\u6216\u8005\u7528\u6237\u3002</p> <p>\u53ef\u4ee5\u901a\u8fc7\u6388\u4e88\u89d2\u8272/\u7528\u6237\u76f8\u5e94\u7684\u7cfb\u7edf\u6743\u9650\u548c\u5bf9\u8c61\u6743\u9650\u6765\u5bf9\u6570\u636e\u5e93\u8fdb\u884c\u7ba1\u7406\u3002</p> <p>\u89d2\u8272\u53ef\u4ee5\u62e5\u6709\u5c5e\u6027\uff0c\u5c5e\u6027\u786e\u5b9a\u4e86\u89d2\u8272\u62e5\u6709\u7684\u7279\u6743\uff0c\u5e76\u4e14\u5728\u767b\u5f55\u65f6\u4e0e\u5ba2\u6237\u7aef\u8ba4\u8bc1\u7cfb\u7edf\u8fdb\u884c\u4ea4\u4e92\u3002\u5e38\u89c1\u7684\u89d2\u8272\u5c5e\u6027\u5305\u62ec\uff1a</p> <ul> <li> <p>\u767b\u5f55\u7279\u6743\uff0c\u53ea\u6709\u5177\u6709 LOGIN \u5c5e\u6027\u7684\u89d2\u8272\u624d\u80fd\u8fde\u63a5\u6570\u636e\u5e93\u3002\u5177\u6709 LOGIN \u89d2\u8272\u7684\u7528\u6237\u53ef\u4ee5\u88ab\u770b\u4f5c\u4e00\u4e2a\"\u6570\u636e\u5e93\u7528\u6237\"\u3002     <pre><code>CREATE ROLE name LOGIN;\nCREATE USER name;\n</code></pre></p> </li> <li> <p>\u8d85\u7ea7\u7528\u6237\uff0c\u6570\u636e\u7684\u8d85\u7ea7\u7528\u6237\u53ef\u4ee5\u907f\u5f00\u6240\u6709\u7684\u6743\u9650\u68c0\u67e5\uff0c\u53ea\u9a8c\u8bc1\u767b\u5f55\u6743\u9650\u3002\u56e0\u6b64\uff0c\u8fd9\u662f\u4e00\u4e2a\u5f88\u5371\u9669\u7684\u7279\u6743\uff0c\u4f7f\u7528\u65f6\u9700\u8981\u7279\u522b\u5c0f\u5fc3\uff1b\u6700\u597d\u5728\u65e5\u5e38\u7684\u64cd\u4f5c\u4e2d\u907f\u514d\u4f7f\u7528\u8d85\u7ea7\u7528\u6237\u3002     <pre><code>CREATE ROLE name SUPERUSER;\n</code></pre></p> </li> <li> <p>\u521b\u5efa\u6570\u636e\u5e93\uff0c\u53ea\u6709\u660e\u786e\u6388\u6743\u7684\u89d2\u8272\u624d\u80fd\u591f\u521b\u5efa\u6570\u636e\u5e93\uff08\u8d85\u7ea7\u7528\u6237\u9664\u5916\uff0c\u56e0\u4e3a\u4ed6\u4eec\u53ef\u4ee5\u907f\u5f00\u6743\u9650\u68c0\u67e5\uff09\u3002     <pre><code>CREATE ROLE name CREATEDB;\n</code></pre></p> </li> <li> <p>\u521b\u5efa\u89d2\u8272\uff0c\u53ea\u6709\u660e\u786e\u6388\u6743\u7684\u89d2\u8272\u624d\u80fd\u591f\u521b\u5efa\u5176\u4ed6\u89d2\u8272\uff08\u8d85\u7ea7\u7528\u6237\u9664\u5916\uff0c\u56e0\u4e3a\u4ed6\u4eec\u53ef\u4ee5\u907f\u5f00\u6743\u9650\u68c0\u67e5\uff09\u3002     <pre><code>CREATE ROLE name CREATEROLE;\n</code></pre></p> </li> </ul> <pre><code>CREATE ROLE  david \n    SUPERUSER|NOSUPERUSER       /*\u662f\u5426\u8d85\u7ea7\u7528\u6237\uff0c\u9ed8\u8ba4\u5426*/     \n    CREATEDB|NOCREATEDB         /*\u662f\u5426\u80fd\u5efaDB\uff0c\u9ed8\u8ba4\u5426*/     \n    CREATEROLE|NOCREATEROLE     /*\u662f\u5426\u80fd\u5efaROLE\uff0c\u9ed8\u8ba4\u5426*/     \n    INHERIT|INHERIT             /*\u7ee7\u627f*/\n    LOGIN|NOLOGIN               /*\u662f\u5426\u80fd\u767b\u5f55\uff0c\u9ed8\u8ba4\u5426*/    /*\u80fd\u767b\u9646\u7684role\u7b49\u4ef7\u4e8euser*/\n    REPLICATION|NOREPLICATION   \nENCRYPTED PASSWORD 'david@123';\n\n\n\nCREATE ROLE david;\u3000\u3000/**\u9ed8\u8ba4\u4e0d\u5e26LOGIN\u5c5e\u6027**/\nCREATE USER sandy;\u3000\u3000/**\u9ed8\u8ba4\u5177\u6709LOGIN\u5c5e\u6027**/\n-- \u7528\u6237sandy\u53ef\u4ee5\u767b\u5f55\uff0c\u89d2\u8272david\u4e0d\u53ef\u4ee5\u767b\u5f55\u3002\n\nSELECT rolname from pg_roles ;\nSELECT usename from pg_user;  --\u89d2\u8272david\u521b\u5efa\u65f6\u6ca1\u6709\u5206\u914dlogin\u6743\u9650\uff0c\u6240\u4ee5\u6ca1\u6709\u521b\u5efa\u7528\u6237\n</code></pre>"},{"location":"postgresql/02.postgresql%E5%AE%89%E8%A3%85/#_8","title":"\u5bf9\u8c61\u6388\u6743","text":"<pre><code>-- \u5176\u4e2d\uff0cprivilege_list \u6743\u9650\u5217\u8868\u53ef\u4ee5\u662f SELECT\u3001INSERT\u3001UPDATE\u3001DELETE\u3001TRUNCATE\u7b49\uff0cALL\u8868\u793a\u8868\u4e0a\u7684\u6240\u6709\u6743\u9650\u3002\nGRANT privilege_list | ALL  ON [ TABLE ] table_name   TO role_name;\n\n-- ALL TABLES IN SCHEMA \u8868\u793a\u67d0\u4e2a\u6a21\u5f0f\u4e2d\u7684\u6240\u6709\u8868\uff0c\u53ef\u4ee5\u65b9\u4fbf\u6279\u91cf\u6388\u6743\u64cd\u4f5c\u3002\nGRANT privilege_list | ALL  ON ALL TABLES IN SCHEMA schema_name   TO role_name;\n</code></pre>"},{"location":"postgresql/02.postgresql%E5%AE%89%E8%A3%85/#_9","title":"\u89d2\u8272\u6210\u5458","text":"<p>\u5728\u73b0\u5b9e\u7684\u73af\u5883\u4e2d\uff0c\u7ba1\u7406\u5458\u901a\u5e38\u9700\u8981\u7ba1\u7406\u5927\u91cf\u7684\u7528\u6237\u548c\u5bf9\u8c61\u6743\u9650\u3002\u4e3a\u4e86\u4fbf\u4e8e\u6743\u9650\u7ba1\u7406\uff0c\u51cf\u5c11\u590d\u6742\u5ea6\uff0c\u53ef\u4ee5\u5c06\u7528\u6237\u8fdb\u884c\u5206\u7ec4\uff0c\u7136\u540e\u4ee5\u7ec4\u4e3a\u5355\u4f4d\u8fdb\u884c\u6743\u9650\u7684\u6388\u4e88\u548c\u64a4\u9500\u64cd\u4f5c\u3002</p> <p>\u4e3a\u6b64\uff0cPostgreSQL \u5f15\u5165\u4e86\u7ec4\uff08group\uff09\u89d2\u8272\u7684\u6982\u5ff5\u3002\u5177\u4f53\u6765\u8bf4\uff0c\u5c31\u662f\u521b\u5efa\u4e00\u4e2a\u4ee3\u8868\u7ec4\u7684\u89d2\u8272\uff0c\u7136\u540e\u5c06\u8be5\u7ec4\u7684\u6210\u5458\u8d44\u683c\u6388\u4e88\u5176\u4ed6\u7528\u6237\uff0c\u8ba9\u5176\u6210\u4e3a\u8be5\u7ec4\u7684\u6210\u5458\u3002</p> <pre><code>-- \u521b\u5efa\u4e00\u4e2a\u7ec4\u89d2\u8272\uff0c\u6309\u7167\u4e60\u60ef\uff0c\u7ec4\u89d2\u8272\u901a\u5e38\u4e0d\u5177\u6709 LOGIN \u7279\u6743\uff0c\u4e5f\u5c31\u662f\u4e0d\u80fd\u4f5c\u4e3a\u4e00\u4e2a\u7528\u6237\u767b\u5f55\u3002\nCREATE ROLE group_name;\n\n\n-- \u4f7f\u7528\u4e0e\u5bf9\u8c61\u6388\u6743\u64cd\u4f5c\u76f8\u540c\u7684 GRANT \u548c REVOKE \u8bed\u53e5\u4e3a\u7ec4\u6dfb\u52a0\u548c\u5220\u9664\u6210\u5458\n</code></pre> <pre><code>#/bin/bash\n\nOPT_BASE=/opt\nPGVERSION=15.0\nSOURCE_BINARY_FILE=https://mirrors.tuna.tsinghua.edu.cn/postgresql/source/v${PGVERSION}/postgresql-${PGVERSION}.tar.gz \nPGBASE=$OPT_BASE/local/pgsql\nPGHOME=$OPT_BASE/local/pgsql/$PGVERSION\nPGDATA=$OPT_BASE/var/pgsql/$PGVERSION\n\n### \u68c0\u67e5\u662f\u5426 root \u7528\u6237\n[ $(id -u) != \"0\" ] &amp;&amp; { echo \"${CFAILURE}Error: You must be root to run this script${CEND}\"; exit 1; }\n\n### \u68c0\u67e5\u662f\u5426\u5b58\u5728\u67d0\u4e2a\u6587\u4ef6\uff0c\u662f\u5426\u5b58\u5728\u53ef\u6267\u884c\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\nif  [ ! -e '/usr/bin/wget' ]; then\n    echo \"Error: wget command not found. You must be install wget command at first.\"\n    exit 1\nfi\n\nif [ -d $PGHOME ]; then\n  rm -rf $PGHOME\nelif [ ! -d $PGBASE ]; then\n  mkdir -p $PGBASE\nfi\n\nif [ ! -d $PGDATA ]; then\n  mkdir -p $PGDATA\nfi\n\necho \"DownLoading PostgreSQL\"\nwget -P ${OPT_BASE}  ${SOURCE_BINARY_FILE}\nmd5_sum=$(curl -s https://ftp.postgresql.org/pub/source/v${PGVERSION}/postgresql-${PGVERSION}.tar.gz.md5)\n\n\necho \"Install PostgreSQL\"\ncd /opt/\ntar zxf $PG_SOFT_TAR -C $PGBASE\nmv $PGBASE/pgsql $PGHOME\ncp pg-pwfile $PGHOME\n\necho \"Init PostgreSQL\"\npushd $PGHOME\n./bin/initdb --pgdata=\"$PGDATA\" --auth=ident --auth-host=md5 --encoding=UTF-8 --locale=zh_CN.UTF-8 --username=postgres --pwfile=pg-pwfile\nrm -f pg-pwfile\npopd\n\ncp pg_hba.conf $PGDATA\ncp postgresql.conf $PGDATA\nchmod 600 $PGDATA/*.conf\n\necho \"Start PostgreSQL\"\n$PGHOME/bin/pg_ctl -D $PGDATA -l logfile start\nsleep 5\n#cp .pgpass ~/\n$PGHOME/bin/psql -h localhost -U postgres -d postgres -f pg_init.sql\n</code></pre>"},{"location":"postgresql/03.%E4%BD%93%E7%B3%BB%E6%9E%B6%E6%9E%84/","title":"postgresql \u4f53\u7cfb\u67b6\u6784","text":""},{"location":"postgresql/03.%E4%BD%93%E7%B3%BB%E6%9E%B6%E6%9E%84/#_1","title":"\u7b80\u4ecb","text":"<p>PostgreSQL \u6570\u636e\u5e93\u662f\u7531\u4e00\u7cfb\u5217\u4f4d\u4e8e\u6587\u4ef6\u7cfb\u7edf\u4e0a\u7684\u7269\u7406\u6587\u4ef6\u7ec4\u6210\uff0c\u5728\u6570\u636e\u5e93\u8fd0\u884c\u8fc7\u7a0b\u4e2d\uff0c\u901a\u8fc7\u6574\u5957\u9ad8\u6548\u4e25\u8c28\u7684\u903b\u8f91\u7ba1\u7406\u8fd9\u4e9b\u7269\u7406\u6587\u4ef6\u3002</p> <p>\u901a\u5e38\u5c06\u8fd9\u4e9b\u7269\u7406\u6587\u4ef6\u79f0\u4e3a\u6570\u636e\u5e93\uff0c\u5c06\u8fd9\u4e9b\u7269\u7406\u6587\u4ef6\u3001\u7ba1\u7406\u8fd9\u4e9b\u7269\u7406\u6587\u4ef6\u7684\u8fdb\u7a0b\u3001\u8fdb\u7a0b\u7ba1\u7406\u7684\u5185\u5b58\u79f0\u4e3a\u8fd9\u4e2a\u6570\u636e\u5e93\u7684\u5b9e\u4f8b\u3002</p> <p>\u5728 PostgreSQL \u7684\u5185\u90e8\u529f\u80fd\u5b9e\u73b0\u4e0a\uff0c\u53ef\u4ee5\u5206\u4e3a\u7cfb\u7edf\u63a7\u5236\u5668\u3001\u67e5\u8be2\u5206\u6790\u5668\u3001\u4e8b\u52a1\u7cfb\u7edf\u3001\u6062\u590d\u7cfb\u7edf\u3001\u6587\u4ef6\u7cfb\u7edf\u8fd9\u51e0\u90e8\u5206\u3002</p> <p>\u5176\u4e2d\u7cfb\u7edf\u63a7\u5236\u5668\u8d1f\u8d23\u63a5\u6536\u5916\u90e8\u8fde\u63a5\u8bf7\u6c42\uff0c\u67e5\u8be2\u5206\u6790\u5668\u5bf9\u8fde\u63a5\u8bf7\u6c42\u67e5\u8be2\u8fdb\u884c\u5206\u6790\u5e76\u751f\u6210\u4f18\u5316\u540e\u7684\u67e5\u8be2\u89e3\u6790\u6811\uff0c\u4ece\u6587\u4ef6\u7cfb\u7edf\u83b7\u53d6\u7ed3\u679c\u96c6\u6216\u901a\u8fc7\u4e8b\u52a1\u7cfb\u7edf\u5bf9\u6570\u636e\u505a\u5904\u7406\uff0c\u5e76\u7531\u6587\u4ef6\u7cfb\u7edf\u6301\u4e45\u5316\u6570\u636e\u3002</p> <p>The Internals of PostgreSQL</p>"},{"location":"postgresql/03.%E4%BD%93%E7%B3%BB%E6%9E%B6%E6%9E%84/#_2","title":"\u903b\u8f91\u7ed3\u6784","text":"<p>PostgreSQL is a program that belongs to the class of database management systems. When this program is running, we call it a PostgreSQL server, or instance.</p> <p>Data managed by PostgreSQL is stored in databases. Asingle PostgreSQL instance can serve several databases at a time; together they are called a database cluster.</p> <p>To be able to use the cluster,you must first initialize 2 (create) it. The directory that contains all the files related to the cluster is usually called PGDATA, after the name of the environment variable pointing to this directory.</p> <p>\u6570\u636e\u5e93\u96c6\u7c07\uff08database cluster\uff09 \u662f\u4e00\u7ec4\u6570\u636e\u5e93\uff08database\uff09 \u7684\u96c6\u5408\uff0c\u7531\u4e00\u4e2a PostgreSQL \u670d\u52a1\u5668\u7ba1\u7406\u3002</p> <p>\u7b2c\u4e00\u6b21\u542c\u5230\u8fd9\u4e2a\u5b9a\u4e49\u4e5f\u8bb8\u4f1a\u4ee4\u4eba\u7591\u60d1\uff0cPostgreSQL \u4e2d\u7684\u672f\u8bed\u201c\u6570\u636e\u5e93\u96c6\u7c07\u201d\uff0c\u5e76\u975e\u610f\u5473\u7740\u201c\u4e00\u7ec4\u6570\u636e\u5e93\u670d\u52a1\u5668\u201d\u3002 \u4e00\u4e2a PostgreSQL \u670d\u52a1\u5668\u53ea\u4f1a\u5728\u5355\u673a\u4e0a\u8fd0\u884c\u5e76\u7ba1\u7406\u5355\u4e2a\u6570\u636e\u5e93\u96c6\u7c07\u3002</p> <ul> <li> <p>\u7b2c\u4e00\u5c42\u662f\u5b9e\u4f8b(Instance)\uff1bPostgreSQL is a program that belongs to the class of database management systems. When this program is running, we call it a PostgreSQL server, or instance</p> </li> <li> <p>\u7b2c\u4e8c\u5c42\u662f\u6570\u636e\u5e93(Database)\uff1b\u4e00\u4e2a\u5b9e\u4f8b\u4e0b\u53ef\u4ee5\u6709\u591a\u4e2a\u6570\u636e\u5e93\u3002\u6bcf\u4e2a\u6570\u636e\u5e93\u4e4b\u95f4\u662f\u5b8c\u5168\u72ec\u7acb\u7684\u3002\u5b83\u4eec\u7ec4\u5728\u4e00\u8d77\u5c31\u53eb <code>a database cluster</code></p> </li> <li> <p>\u7b2c\u4e09\u5c42\u662f\u6a21\u5f0f\uff08Schema\uff09\uff1b\u6bcf\u4e2a\u6570\u636e\u5e93\u4e0b\u9762\u53ef\u4ee5\u6709\u591a\u4e2a Schema\uff1b\u5176\u4e2d\"public\"\u662f\u6570\u636e\u5e93\u521b\u5efa\u65f6\u4ea7\u751f\u7684\u3002</p> </li> </ul> <p>\u6bcf\u4e2a Schema \u4e0b\u9762\u53ef\u4ee5\u521b\u5efa\u8868\uff0c\u89c6\u56fe\uff0c\u7d22\u5f15\uff0c\u51fd\u6570\uff0c\u5e8f\u5217\uff0c\u7269\u5316\u89c6\u56fe\uff0c\u5916\u90e8\u8868\u7b49\u7b49\u3002</p> <p>\u7531\u4e8e\u5728 PostgreSQL \u6bcf\u4e2a\u6570\u636e\u5e93\u662f\u5b8c\u5168\u72ec\u7acb\u7684\uff0c\u8fd9\u53ef\u4ee5\u89e3\u91ca\u53e6\u5916\u4e00\u4e2a\u95ee\u9898\uff08\u4e3a\u4ec0\u4e48\u8bbf\u95ee\u540c\u4e00\u4e2a\u5b9e\u4f8b\u4e0b\u5176\u4ed6\u6570\u636e\u5e93\u4e3a\u4ec0\u4e48\u8981\u501f\u7528 dblink \u6216\u8005 fdw \u63a5\u53e3\uff1f\uff09\u3002</p> <p>\u8fd9\u65f6\u53ef\u80fd\u4f1a\u6709\u5b66 MySQL \u540c\u5b66\u4f1a\u95ee\u5230\uff1b\uff08\u4e3a\u4ec0\u4e48\u5728 MySQL \u4e2d\u53ef\u4ee5\u8bbf\u95ee\u540c\u5b9e\u4f8b\u4e0b\u5176\u4ed6\u6570\u636e\u5e93\uff1f\uff09\u3002</p> <p>\u5176\u5b9e MySQL \u8ddf PostgreSQL \u903b\u8f91\u7ed3\u6784\u4e0d\u4e00\u6837\uff1b\u5176\u4e2d MySQL \u5b9e\u4f8b\u4e2d\u7684\u6570\u636e\u5e93\u76f8\u5f53\u4e8e PostgreSQL \u4e0a\u56fe\u7684\u7b2c\u4e09\u5c42\u7684 Schema\u3002</p> <p>\u5728 postgresql \u4e2d\uff0c\u6a21\u5f0f\u662f\u6570\u636e\u5e93\u5b9e\u4f8b\u7684\u903b\u8f91\u5206\u5272\u3002 database &gt; schema &gt; table</p> <p>\u6570\u636e\u5e93(database)\u662f\u88ab\u6a21\u5f0f(schema)\u6765\u5207\u5206\u7684\uff0c\u4e00\u4e2a\u6570\u636e\u5e93(database)\u81f3\u5c11\u6709\u4e00\u4e2a\u6a21\u5f0f(schema)\uff0c\u6240\u6709\u6570\u636e\u5e93\u5185\u90e8\u7684\u5bf9\u8c61(object)\u662f\u88ab\u521b\u5efa\u5728\u6a21\u5f0f\u4e2d\u7684\u3002</p> <p>\u7528\u6237\u767b\u5f55\u5230\u7cfb\u7edf\uff0c\u8fde\u63a5\u5230\u4e00\u4e2a\u6570\u636e\u5e93\u540e\uff0c\u662f\u901a\u8fc7\u8be5\u6570\u636e\u5e93\u7684<code>search_path</code>\u6765\u5bfb\u627e<code>schema</code>\u7684\u641c\u7d22\u987a\u5e8f:</p> <p><code>search_path</code>\u7c7b\u4f3c\u4e8e Linux \u4e2d\u7684 PATH \u73af\u5883\u53d8\u91cf\u3002\u5176\u9ed8\u8ba4\u503c\u662f<code>$user,public</code>\uff0c\u610f\u601d\u5c31\u662f\u5f53\u4ee5\u67d0\u4e2a\u7528\u6237\u767b\u5f55\u5230\u6570\u636e\u5e93\u7684\u65f6\u5019\uff0c\u9ed8\u8ba4\u5c31\u662f\u5148\u67e5\u627e\u548c\u767b\u5f55\u7528\u6237\u540c\u540d\u7684 schema\uff0c\u518d\u67e5\u627e public</p> <p>\u66f4\u51c6\u786e\u7684\u8bf4\uff0c<code>search_path</code>\u662f\u7528\u6237\u67e5\u627e schema \u7684\u4f18\u5148\u7ea7\u3002\u5f53\u7528\u6237\u8bbf\u95ee\u8868\u65f6\u4e0d\u5e26 schema.table \u8fd9\u79cd\u5b8c\u5168\u9650\u5b9a\u540d\uff0c\u5219\u9ed8\u8ba4\u6309\u7167 schema \u4f18\u5148\u7ea7\u53bb\u627e\u3002</p> <p>\u5728\u5173\u7cfb\u578b\u6570\u636e\u5e93\u7406\u8bba\u4e2d\uff0c\u6570\u636e\u5e93\u5bf9\u8c61\u662f\u7528\u4e8e\u5b58\u50a8\u6216\u5f15\u7528\u6570\u636e\u7684\u6570\u636e\u7ed3\u6784\u3002\u8868\u662f\u4e00\u4e2a\u5178\u578b\u7684\u4f8b\u5b50\uff0c\u8fd8\u6709\u66f4\u591a\u79cd\u5bf9\u8c61\uff0c\u4f8b\u5982\u7d22\u5f15\uff0c\u5e8f\u5217\uff0c\u89c6\u56fe\uff0c\u51fd\u6570\u7b49\u3002</p> <p>\u5728 PostgreSQL \u4e2d\u6570\u636e\u5e93\u672c\u8eab\u4e5f\u662f\u6570\u636e\u5e93\u5bf9\u8c61\uff0c\u5e76\u5728\u903b\u8f91\u4e0a\u5f7c\u6b64\u5206\u79bb\u3002\u6240\u6709\u5176\u4ed6\u7684\u6570\u636e\u5e93\u5bf9\u8c61\uff08\u4f8b\u5982\u8868\uff0c\u7d22\u5f15\u7b49\uff09\u5f52\u5c5e\u4e8e\u5404\u81ea\u76f8\u5e94\u7684\u6570\u636e\u5e93\u3002</p> <p></p> <p>\u5728<code>PostgreSQL</code>\u5185\u90e8\uff0c\u6240\u6709\u7684\u6570\u636e\u5e93\u5bf9\u8c61\u90fd\u901a\u8fc7\u76f8\u5e94\u7684 \u5bf9\u8c61\u6807\u8bc6\u7b26\uff08Object Identifiers, OID\uff09 \u8fdb\u884c\u7ba1\u7406\uff0c\u8fd9\u4e9b\u6807\u8bc6\u7b26\u662f\u65e0\u7b26\u53f7\u7684 4 \u5b57\u8282\u6574\u578b\u3002</p> <p>\u6570\u636e\u5e93\u5bf9\u8c61\u4e0e\u76f8\u5e94 OID \u4e4b\u95f4\u7684\u5173\u7cfb\u5b58\u50a8\u5728\u76f8\u5e94\u7684 \u7cfb\u7edf\u76ee\u5f55\uff08System Catalogs\uff09 \u4e2d\uff0c\u4f9d\u5177\u4f53\u7684\u5bf9\u8c61\u7c7b\u578b\u800c\u5f02\u3002\u4f8b\u5982\u6570\u636e\u5e93\u548c\u5806\u8868\u5bf9\u8c61\u7684 OID \u5206\u522b\u5b58\u50a8\u5728 pg_database \u548c pg_class \u4e2d</p> <p>pg_database\u3001pg_class \u662f\u5b58\u653e\u5728\u4e00\u4e2a\u540d\u4e3a pg_catalog \u7684 Schema \u4e0b\u3002\u5176\u4e2d pg_catalog \u662f\u7cfb\u7edf\u7ea7\u7684 schema\uff0c\u7528\u4e8e\u5b58\u50a8\u7cfb\u7edf\u51fd\u6570\u548c\u7cfb\u7edf\u5143\u6570\u636e\u3002</p> <p>pg \u5b89\u88c5\u540e\u4f1a\u9ed8\u8ba4\u9644\u5e26\u4e09\u4e2a database\uff0c\u5206\u522b\u662f postgres\u3001template0\u3001template1</p> <p>\u5728 PostgreSQL \u4e2d\uff0c\u6570\u636e\u5e93\u7684\u521b\u5efa\u662f\u901a\u8fc7\u514b\u9686\u6570\u636e\u5e93\u6a21\u677f\u6765\u5b9e\u73b0\u7684\uff0c\u8fd9\u4e0e<code>SQL SERVER</code>\u662f\u540c\u6837\u7684\u673a\u5236\u3002\u5982\u679c<code>CREATE DATABASE dbname</code>\u8bed\u53e5\u6ca1\u6709\u6307\u660e\u6570\u636e\u5e93\u6a21\u677f\uff0c\u6240\u4ee5\u7cfb\u7edf\u5c06\u9ed8\u8ba4\u514b\u9686 template1 \u6570\u636e\u5e93\uff0c\u5f97\u5230\u65b0\u7684\u6570\u636e\u5e93 dbname\u3002</p> <p>By default, the new database will be created by cloning the standard system database template1</p> <p>\u5982\u679c\u5728 <code>template1</code> \u4e2d\u6dfb\u52a0\u6570\u636e\u5e93\u5bf9\u8c61\uff0c\u8fd9\u4e9b\u5bf9\u8c61\u5c06\u88ab\u590d\u5236\u5230\u968f\u540e\u521b\u5efa\u7684\u7528\u6237\u6570\u636e\u5e93\u4e2d\u3002\u8fd9\u79cd\u65b9\u5f0f\u5141\u8bb8\u5bf9\u6570\u636e\u5e93\u4e2d\u7684\u6807\u51c6\u5bf9\u8c61\u96c6\u8fdb\u884c\u7ad9\u70b9\u672c\u5730\u4fee\u6539\u3002\u4f8b\u5982\uff0c\u5982\u679c\u60a8\u5728 <code>template1</code> \u4e2d\u5b89\u88c5\u4e86\u7a0b\u5e8f\u8bed\u8a00 <code>PL/Perl</code>\uff0c\u90a3\u4e48\u5728\u521b\u5efa\u7528\u6237\u6570\u636e\u5e93\u65f6\uff0c\u65e0\u9700\u91c7\u53d6\u4efb\u4f55\u989d\u5916\u64cd\u4f5c\uff0c\u5b83\u5c31\u4f1a\u81ea\u52a8\u51fa\u73b0\u5728\u7528\u6237\u6570\u636e\u5e93\u4e2d\u3002</p> <p>\u7b2c\u4e8c\u4e2a\u6807\u51c6\u7cfb\u7edf\u6570\u636e\u5e93\u540d\u4e3a <code>template0</code> \u3002\u8be5\u6570\u636e\u5e93\u5305\u542b\u7684\u6570\u636e\u4e0e <code>template1</code> \u7684\u521d\u59cb\u5185\u5bb9\u76f8\u540c\uff0c\u5373\u4ec5\u5305\u542b <code>PostgreSQL</code> \u7248\u672c\u9884\u5b9a\u4e49\u7684\u6807\u51c6\u5bf9\u8c61\u3002\u5728\u6570\u636e\u5e93\u96c6\u7fa4\u521d\u59cb\u5316\u540e\uff0c\u4e0d\u5e94\u66f4\u6539 <code>template0</code> \u3002\u4efb\u4f55\u65f6\u5019\u90fd\u4e0d\u8981\u5bf9 template0 \u6a21\u677f\u6570\u636e\u5e93\u8fdb\u884c\u4efb\u4f55\u4fee\u6539\uff0c\u56e0\u4e3a\u8fd9\u662f\u539f\u59cb\u7684\u5e72\u51c0\u6a21\u677f\u3002\u5982\u679c\u5176\u5b83\u6a21\u677f\u6570\u636e\u5e93\u88ab\u641e\u574f\u4e86\uff0c\u57fa\u4e8e\u8fd9\u4e2a\u6570\u636e\u5e93\u505a\u4e00\u4e2a\u526f\u672c\u5c31\u53ef\u4ee5\u4e86\u3002</p> <p>\u5982\u679c\u5e0c\u671b\u5b9a\u5236\u81ea\u5df1\u7684 \u7528\u6237\u6a21\u677f\u6570\u636e\u5e93 \uff0c\u90a3\u4e48\u8bf7\u57fa\u4e8e<code>template1</code>\u8fdb\u884c\u4fee\u6539\uff0c\u6216\u8005\u81ea\u5df1\u53e6\u5916\u521b\u5efa\u4e00\u4e2a\u6a21\u677f\u6570\u636e\u5e93\u518d\u4fee\u6539\u3002\u5bf9\u57fa\u4e8e<code>template1</code>\u6216\u4f60\u81ea\u5efa\u7684\u6a21\u677f\u6570\u636e\u5e93\u521b\u5efa\u7684\u6570\u636e\u5e93\u6765\u8bf4\uff0c\u4f60\u4e0d\u80fd\u4fee\u6539\u5176\u5b57\u7b26\u96c6\u7f16\u7801\u548c\u6392\u5e8f\u89c4\u5219\u3002<code>template0</code>\u53ef\u4ee5\u3002</p> <p>\u901a\u8fc7<code>CREATE DATABASE</code>\u8bed\u53e5\u590d\u5236 <code>template0</code> \u800c\u4e0d\u662f <code>template1</code> \uff0c\u53ef\u4ee5\u521b\u5efa\u4e00\u4e2a \"\u539f\u59cb \"\u7528\u6237\u6570\u636e\u5e93\uff08\u5176\u4e2d\u4e0d\u5b58\u5728\u7528\u6237\u5b9a\u4e49\u7684\u5bf9\u8c61\uff0c\u7cfb\u7edf\u5bf9\u8c61\u4e5f\u672a\u88ab\u66f4\u6539\uff09\uff0c\u8be5\u6570\u636e\u5e93\u4e0d\u5305\u542b <code>template1</code> \u4e2d\u7684\u7ad9\u70b9\u672c\u5730\u6dfb\u52a0\u5185\u5bb9\u3002\u8fd9\u5728\u6062\u590d <code>pg_dump</code> \u8f6c\u50a8\u65f6\u7279\u522b\u65b9\u4fbf\uff1a\u5e94\u5728\u539f\u59cb\u6570\u636e\u5e93\u4e2d\u6062\u590d\u8f6c\u50a8\u811a\u672c\uff0c\u4ee5\u786e\u4fdd\u91cd\u65b0\u521b\u5efa\u8f6c\u50a8\u6570\u636e\u5e93\u7684\u6b63\u786e\u5185\u5bb9\uff0c\u800c\u4e0d\u4f1a\u4e0e\u540e\u6765\u53ef\u80fd\u6dfb\u52a0\u5230 <code>template1</code> \u4e2d\u7684\u5bf9\u8c61\u53d1\u751f\u51b2\u7a81\u3002</p> <p>\u590d\u5236 <code>template0</code> \u800c\u4e0d\u662f <code>template1</code> \u7684\u53e6\u4e00\u4e2a\u5e38\u89c1\u539f\u56e0\u662f\uff0c\u5728\u590d\u5236 <code>template0</code> \u65f6\u53ef\u4ee5\u6307\u5b9a\u65b0\u7684\u7f16\u7801\u548c\u672c\u5730\u8bbe\u7f6e\uff0c\u800c\u590d\u5236 <code>template1</code> \u65f6\u5fc5\u987b\u4f7f\u7528\u4e0e\u5176\u76f8\u540c\u7684\u8bbe\u7f6e\u3002\u8fd9\u662f\u56e0\u4e3a <code>template1</code> \u53ef\u80fd\u5305\u542b\u7279\u5b9a\u4e8e\u7f16\u7801\u6216\u7279\u5b9a\u4e8e\u672c\u5730\u8bed\u8a00\u7684\u6570\u636e\uff0c\u800c\u5df2\u77e5 <code>template0</code> \u4e0d\u5305\u542b\u8fd9\u4e9b\u6570\u636e\u3002</p> <p><code>template0</code>\u662f\u4e0d\u5141\u8bb8\u8fde\u63a5\u7684\u3002\u5982\u679c\u4f60\u60f3\u5207\u6362\u5230<code>template0</code>\u4f1a\u62a5\u9519\u3002\u56e0\u4e3a\u4e0d\u80fd\u8fde\u63a5\uff0c\u6240\u4ee5\u4e5f\u5c31\u4e0d\u53ef\u4ee5\u5bf9\u5b83\u8fdb\u884c\u4fee\u6539\u3002\u6240\u4ee5\u8fd9\u6837\u5c31\u6709\u4e2a\u597d\u5904\uff0c\u8fd9\u4e2a\u6a21\u677f\u662f\u6700\u539f\u59cb\u6700\u5e72\u51c0\u7684\u6a21\u677f\uff0c\u5982\u679c<code>template1</code>\u88ab\u7834\u574f\u4e86\uff0c \u90a3\u4e48\u57fa\u4e8e<code>template0</code>\u518d\u505a\u4e00\u4e2a\u526f\u672c\u5373\u53ef \u3002\u5173\u4e8e\u8fd9\u4e00\u70b9\uff0c\u53ef\u4ee5\u5728<code>pg_database</code>\u7684<code>datallowconn</code>\u5b57\u6bb5\u4e2d\u770b\u51fa\u6765\uff0c\u6211\u4eec\u53d1\u73b0<code>template0</code>\u7684<code>datallowconn</code>\u4e3a false\uff0c\u8868\u793a\u4e0d\u5141\u8bb8\u8fde\u63a5\u3002</p> <ul> <li> <p>template1 \u53ef\u4ee5\u8fde\u63a5\u5e76\u521b\u5efa\u5bf9\u8c61\uff0ctemplate0 \u4e0d\u53ef\u4ee5\u8fde\u63a5\u3002\u6b63\u56e0\u4e3a template1 \u53ef\u4ee5\u521b\u5efa\u5bf9\u50cf\uff0c\u76f8\u6bd4 template0 \uff0c\u88ab\u79f0\u4e3a\u975e\u5e72\u51c0\u6570\u636e\u5e93\uff0c\u800c template0 \u88ab\u79f0\u4e3a\u5e72\u51c0\u7684\u6570\u636e\u5e93\u3002</p> </li> <li> <p>template0 \u548c template1 \u90fd\u4e0d\u53ef\u5220\u9664</p> </li> </ul> <p><code>CREATE DATABASE</code> \u4e0d\u4f1a\u590d\u5236\u9644\u52a0\u5230\u6e90\u6570\u636e\u5e93\u7684\u6570\u636e\u5e93\u7ea7 GRANT \u6743\u9650\u3002\u65b0\u6570\u636e\u5e93\u5177\u6709\u9ed8\u8ba4\u7684\u6570\u636e\u5e93\u7ea7\u6743\u9650\u3002</p> <p>\u5728\u6570\u636e\u5e93\u521b\u5efa\u7684\u540c\u65f6\uff0c\u5c31\u5df2\u7ecf\u9ed8\u8ba4\u4e3a\u6570\u636e\u5e93\u521b\u5efa\u4e86\u4e00\u4e2a\u6a21\u5f0f--public\uff0c\u8fd9\u4e5f\u662f\u8be5\u6570\u636e\u5e93\u7684\u9ed8\u8ba4\u6a21\u5f0f\u3002</p> <p>\u6240\u6709\u4e3a\u6b64\u6570\u636e\u5e93\u521b\u5efa\u7684\u5bf9\u8c61(\u8868\u3001\u51fd\u6570\u3001\u8bd5\u56fe\u3001\u7d22\u5f15\u3001\u5e8f\u5217\u7b49)\u90fd\u662f\u521b\u5efa\u5728\u8fd9\u4e2a\u6a21\u5f0f\u4e2d\u7684\u3002</p> <pre><code>-- PostgreSQL \u6570\u636e\u5e93\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u662f\u4e0d\u652f\u6301\u8de8\u6570\u636e\u5e93\u8bbf\u95ee\u7684\u3002\u5982\u679c\u6211\u4eec\u60f3\u8981\u6267\u884c\u8de8\u6570\u636e\u5e93\u7684\u67e5\u8be2\uff0c\u6211\u4eec\u9700\u8981\u501f\u52a9 dblink \u6765\u5b9e\u73b0\uff0cdblink \u662f PostgreSQL \u7684\u4e00\u4e2a\u6a21\u5757\uff0c\u652f\u6301\u4ece\u6570\u636e\u5e93\u4f1a\u8bdd\u4e2d\u8fde\u63a5\u5230\u5176\u4ed6\u6570\u636e\u5e93\u3002\n\nSELECT *  FROM pg_database;\n</code></pre>"},{"location":"postgresql/03.%E4%BD%93%E7%B3%BB%E6%9E%B6%E6%9E%84/#_3","title":"\u7cfb\u7edf\u8868\u4f53\u7cfb","text":"<p>\u5728\u5173\u7cfb\u6570\u636e\u5e93\u4e2d\uff0c\u4e3a\u4e86\u6570\u636e\u5e93\u7cfb\u7edf\u7684\u63a7\u5236\uff0c\u5fc5\u987b\u63d0\u4f9b\u6570\u636e\u5b57\u5178\u7684\u529f\u80fd\u3002\u6570\u636e\u5b57\u5178\u4e0d\u4ec5\u5b58\u50a8\u5404\u79cd\u5bf9\u8c61\u7684\u63cf\u8ff0\uff0c\u800c\u4e14\u5b58\u50a8\u8fd9\u4e9b\u6570\u636e\u5bf9\u8c61\u7684\u7ec6\u8282\u4fe1\u606f\u3002</p> <p>\u5176\u4e2d\u7cfb\u7edf\u8868\u662f Postgresql \u6570\u636e\u5e93\u5b58\u653e\u7ed3\u6784\u5143\u6570\u636e\u7684\u5730\u65b9\uff0c\u8868\u73b0\u4e3a\u5b58\u653e\u6709\u7cfb\u7edf\u4fe1\u606f\u7684\u666e\u901a\u8868\u548c\u89c6\u56fe\u3002\u7cfb\u7edf\u8868\u53c8\u53eb<code>database catalog</code>\u3002\u6570\u636e\u5e93\u5b9e\u4f8b\u7684\u6570\u636e\u5e93\u76ee\u5f55\u7531\u5143\u6570\u636e\u7ec4\u6210\uff0c\u5176\u4e2d\u5b58\u50a8\u4e86\u6570\u636e\u5e93\u5bf9\u8c61\u7684\u5b9a\u4e49\u3002</p> <p>\u5728 postgresql \u6bcf\u4e00\u4e2a\u6570\u636e\u5e93\u4e2d\u90fd\u6709\u5355\u72ec\u7684\u4e00\u5957\u7cfb\u7edf\u8868\uff0c\u8fd9\u4e9b\u8868\u5927\u591a\u662f\u5728\u6570\u636e\u5e93\u521b\u5efa\u65f6\u4ece template \u6570\u636e\u5e93\u62f7\u8d1d\u8fc7\u6765\u7684\uff0c\u63cf\u8ff0\u8be5\u6570\u636e\u5e93\u7684\u5c5e\u6027\u3002</p> <p>\u5982\u679c\u60f3\u770b\u6e90\u7801\u7684\u8bdd\uff0c\u53ef\u4ee5\u770b\u770b src/include/catalog \u76ee\u5f55\u4e0b\u7684\"pg_xxx.h\"\u6587\u4ef6\uff0c\u8fd9\u4e9b\u6587\u4ef6\u76f8\u5e94\u5730\u5b9a\u4e49\u4e86\"pg_xxx\"\u7cfb\u7edf\u8868\u7684\u6570\u636e\u7ed3\u6784\u3002\u53e6\u5916\uff0cindexing.h \u6587\u4ef6\u5b9a\u4e49\u4e86\u6240\u6709\u7684\u7cfb\u7edf\u8868\u7d22\u5f15\uff0ctoasting.h \u5b9a\u4e49\u4e86\u6240\u6709\u7cfb\u7edf\u8868\u7684 TOAST \u8868\u3002</p> <p>\u7cfb\u7edf\u8868\u5206\u4e24\u7c7b\uff1a</p> <ul> <li>\u4e00\u7c7b\u662f\u6bcf\u4e2a\u6570\u636e\u5e93\u5185\u72ec\u6709\u7684\u7cfb\u7edf\u8868</li> <li>\u4e00\u7c7b\u662f\u6240\u6709\u6570\u636e\u5e93\u5171\u4eab\u7684\u7cfb\u7edf\u8868\u3002</li> </ul> <p>\u4e3a\u4ec0\u4e48\u6709\u5171\u4eab\u8868\u7684\uff1f\u4f8b\u5982 <code>pg_database</code> \u8bb0\u5f55 cluster \u6240\u6709\u6570\u636e\u5e93\u7684\u4fe1\u606f\uff0c\u4e0d\u9700\u8981\u6bcf\u4e2a\u6570\u636e\u5e93\u5355\u72ec\u5b58\u50a8\u4e00\u4efd\u3002\u5171\u4eab\u7cfb\u7edf\u8868\u5b58\u50a8\u5728$PGDATA/global/\u76ee\u5f55\u4e0b\u3002</p> <p>SQL \u6807\u51c6\u6307\u5b9a\u4e86\u8bbf\u95ee\u76ee\u5f55\u7684\u7edf\u4e00\u65b9\u6cd5\uff0c\u79f0\u4e3a INFORMATION_SCHEMA\u3002INFORMATION_SCHEMA \u662f\u4e00\u79cd\u7279\u6b8a\u7684\u6570\u636e\u5e93\uff0c\u5b83\u5728 SQL \u6807\u51c6\u4e2d\u5b9a\u4e49\u5e76\u5b58\u5728\u4e8e\u8bb8\u591a\u7c7b\u578b\u7684\u6570\u636e\u5e93\u4e2d\uff0c\u7528\u4e8e\u5b58\u50a8\u6570\u636e\u5e93\u7684\u5143\u6570\u636e\uff0c\u5305\u62ec\u6570\u636e\u5e93\u3001\u8868\u3001\u5217\u3001\u7ea6\u675f\u3001\u6743\u9650\u7b49\u7684\u4fe1\u606f\u3002</p> <p>\u5728\u5173\u7cfb\u6570\u636e\u5e93\u4e2d\uff0c\u4fe1\u606f\u6a21\u5f0f(information_schema)\u662f\u4e00\u7ec4 ANSI \u6807\u51c6\u7684\u53ea\u8bfb\u89c6\u56fe\uff0c\u63d0\u4f9b\u6709\u5173\u6570\u636e\u5e93\u4e2d\u6240\u6709\u8868\u3001\u89c6\u56fe\u3001\u5217\u548c\u8fc7\u7a0b\u7684\u4fe1\u606f\u3002\u5b83\u53ef\u4ee5\u4f5c\u4e3a\u67d0\u4e9b\u6570\u636e\u5e93\uff0c\u901a\u8fc7\u975e\u6807\u51c6\u547d\u4ee4\u63d0\u4f9b\u4fe1\u606f\u7684\u6765\u6e90\uff1a</p> <p>\u4f8b\u5982<code>MySQL</code>\u7684<code>SHOW</code>\u547d\u4ee4\uff1b<code>Oracle</code>\u7684<code>SQLPlus</code>\u7684<code>DESCRIBE</code>\u547d\u4ee4\uff1b<code>PostgreSQL</code>\u7684\u9ed8\u8ba4\u547d\u4ee4\u884c\u7a0b\u5e8f\u3002</p> <p>\u5177\u6709 <code>INFORMATION_SCHEMA</code> \u7684\u6570\u636e\u5e93\u7cfb\u7edf\u5305\u62ec\u4f46\u4e0d\u9650\u4e8e\u4ee5\u4e0b\uff1a</p> <ul> <li> <p>MySQL\uff1a<code>MySQL</code>\u7684 <code>INFORMATION_SCHEMA</code> \u5305\u542b\u591a\u4e2a\u53ea\u8bfb\u89c6\u56fe\uff0c\u7528\u4e8e\u83b7\u53d6\u5173\u4e8e\u6570\u636e\u5e93\u5bf9\u8c61\u548c\u670d\u52a1\u5668\u5b9e\u4f8b\u7684\u5143\u6570\u636e\u3002\u8fd9\u4e9b\u89c6\u56fe\u5305\u62ec <code>TABLES</code>\u3001<code>COLUMNS</code>\u3001<code>STATISTICS</code>\u3001<code>SCHEMATA</code>\u3001<code>USER_PRIVILEGES</code> \u7b49\u3002</p> </li> <li> <p>PostgreSQL\uff1a<code>PostgreSQL</code>\u7684 <code>INFORMATION_SCHEMA</code> \u63d0\u4f9b\u4e0e <code>MySQL</code> \u7c7b\u4f3c\u7684\u529f\u80fd\uff0c\u4f46\u5177\u4f53\u7684\u89c6\u56fe\u53ef\u80fd\u4f1a\u6709\u6240\u4e0d\u540c\u3002</p> </li> <li> <p>SQL Server\uff1a<code>SQL Server</code> \u7684 <code>INFORMATION_SCHEMA</code> \u89c6\u56fe\u5305\u542b\u6709\u5173\u6570\u636e\u5e93\u5143\u6570\u636e\u7684\u4fe1\u606f\uff0c\u5982 <code>TABLES</code>\u3001<code>COLUMNS</code>\u3001<code>ROUTINES</code>\u3001<code>VIEWS</code>\u3001<code>TABLE_CONSTRAINTS</code> \u7b49\u3002</p> </li> <li> <p>MariaDB\uff1aMariaDB \u7684 <code>INFORMATION_SCHEMA</code> \u4e0e MySQL \u7684\u975e\u5e38\u76f8\u4f3c\uff0c\u63d0\u4f9b\u5927\u91cf\u7684\u89c6\u56fe\u7528\u4e8e\u67e5\u8be2\u6570\u636e\u5e93\u5143\u6570\u636e\u3002</p> </li> <li> <p>Oracle\uff1a\u5728 <code>Oracle</code> \u4e2d\uff0c\u7c7b\u4f3c\u4e8e <code>INFORMATION_SCHEMA</code> \u7684\u5143\u6570\u636e\u4fe1\u606f\u5b58\u50a8\u5728\u4e00\u7cfb\u5217\u540d\u4e3a <code>ALL_</code>, <code>USER_</code> \u548c <code>DBA_</code> \u7684\u89c6\u56fe\u4e2d\u3002</p> </li> </ul> <p>\u7cfb\u7edf\u8868\u662f\u6574\u4e2a <code>PostgreSQL</code> \u6570\u636e\u5e93\u5b58\u50a8\u4f53\u7cfb\u4e2d\u6700\u91cd\u8981\u7684\u4e00\u90e8\u5206\u6570\u636e\uff0c\u5b83\u4eec\u7528\u6765\u7ec4\u7ec7\u7ba1\u7406 <code>PostgreSQL</code> \u7684\u6570\u636e\u7a7a\u95f4\uff0c\u5c06\u7528\u6237\u81ea\u5df1\u5b9a\u4e49\u7684\u6570\u636e\u96c6\u5408\u66f4\u597d\u5f97\u4ee5\u4e00\u4e2a\u6216\u8005\u591a\u4e2a\u8868\u7ec4\u7ec7\u8d77\u6765\u3002\u5b83\u4eec\u672c\u8d28\u4e5f\u662f\u4e00\u4e2a\u4e2a\u8868\u5bf9\u8c61\uff0c\u76f8\u6bd4\u4e8e\u666e\u901a\u8868\u662f\u5b58\u50a8\u7684\u5143\u6570\u636e\u3002\u8fd9\u91cc\u7684\u5143\u6570\u636e\u53ef\u4ee5\u7406\u89e3\u4e3a\u63cf\u8ff0\u6570\u636e\u7684\u6570\u636e\u3002</p> <p>\u6bd4\u5982\uff0c\u7528\u6237\u521b\u5efa\u7684\u8868\u6709 (c1 int, c2 text)\u4e24\u79cd\u5b57\u6bb5\u7c7b\u578b\uff0c\u8fd9\u4e9b int, text \u5b57\u6bb5\u6570\u636e\u7c7b\u578b\u4f1a\u88ab\u5355\u72ec\u5b58\u653e\u5728 <code>pg_type</code> \u7684\u7cfb\u7edf\u8868\u4e2d\uff0c\u540c\u65f6 c1, c2 \u5217\u540d\u5b57\u5219\u4f1a\u88ab\u5b58\u653e\u5728 <code>pg_attribute</code> \u7684\u7cfb\u7edf\u8868\u4e2d\uff0c\u5e76\u548c <code>pg_type</code> \u5f62\u6210\u5173\u8054\u3002\u8fd9\u4e9b <code>pg_type</code>, <code>pg_attribute</code> \u7c7b\u578b\u7684\u8868\u53ef\u4ee5\u5efa\u7acb\u5bf9\u7528\u6237\u8868\u7684\u5173\u7cfb\u63cf\u8ff0\uff0c\u6240\u4ee5\u5b83\u4eec\u53ef\u4ee5\u88ab\u79f0\u4e3a\u5143\u6570\u636e\u3002</p> <p><code>pg_database</code>\u548c<code>pg_class</code>\u5b58\u653e\u5728\u4e00\u4e2a\u540d\u4e3a<code>pg_catalog</code>\u7684<code>schema</code>\u4e0b\u3002\u5176\u4e2d<code>pg_catalog</code>\u662f**\u7cfb\u7edf\u7ea7**\u7684<code>schema</code>\uff0c\u7528\u4e8e\u5b58\u50a8\u7cfb\u7edf\u51fd\u6570\u548c\u7cfb\u7edf\u5143\u6570\u636e\u3002</p>"},{"location":"postgresql/03.%E4%BD%93%E7%B3%BB%E6%9E%B6%E6%9E%84/#schema","title":"schema","text":"<p>Schemas are namespaces that store all objects of a database</p> <p>\u9884\u5b9a\u4e49\u7684 Schema</p> <ul> <li> <p>public</p> </li> <li> <p>pg_catalog</p> </li> <li> <p>information_schema provides an alternative view for the system catalog as defined by the SQL standard.</p> </li> <li> <p>pg_toast</p> </li> <li> <p>pg_temp</p> </li> </ul>"},{"location":"postgresql/03.%E4%BD%93%E7%B3%BB%E6%9E%B6%E6%9E%84/#_4","title":"\u8868\u7a7a\u95f4","text":"<p>\u672c\u8d28\u4e0a\uff0cPostgreSQL \u4e2d\u7684\u8868\u7a7a\u95f4\u662f\u4e00\u4e2a\u5305\u542b\u6570\u636e\u6587\u4ef6\u7684\u76ee\u5f55\u3002\u8fd9\u4e9b\u6570\u636e\u6587\u4ef6\u662f\u8868\u3001\u5e8f\u5217\u3001\u7d22\u5f15\u548c\u7269\u5316\u89c6\u56fe\u7b49\u5bf9\u8c61\u80cc\u540e\u7684\u5b58\u50a8\u7a7a\u95f4\u3002\u5728 PostgreSQL \u4e2d\uff0c\u6bcf\u4e2a\u8fd9\u6837\u7684\u5bf9\u8c61\u90fd\u6709\u81ea\u5df1\u7684\u6570\u636e\u6587\u4ef6\u3002\u5982\u679c\u5bf9\u8c61\u5f88\u5927\uff0c\u5b83\u5c06\u6709\u51e0\u4e2a\u88ab\u79f0\u4e3a segments \u7684\u6587\u4ef6\uff0c\u5927\u5c0f\u9650\u5236\u4e3a 1GB\u3002</p> <p>PostgreSQL \u4f7f\u7528\u64cd\u4f5c\u7cfb\u7edf\u81ea\u5e26\u7684\u6587\u4ef6\u7cfb\u7edf\u8fdb\u884c\u5b58\u50a8\u3002\u8fd9\u4e0e<code>Oracle</code>\u4e0d\u540c\uff0c\u540e\u8005\u5b9e\u9645\u4e0a\u5b9e\u73b0\u4e86\u81ea\u5df1\u7684\"\u6587\u4ef6\u7cfb\u7edf\"\u3002</p> <ul> <li> <p>\u5728 PostgreSQL \u4e2d\uff0c\u4e00\u4e2a\u8868\u7a7a\u95f4\u53ef\u4f9b\u591a\u4e2a\u6570\u636e\u5e93\u4f7f\u7528\uff1b\u800c\u4e00\u4e2a\u6570\u636e\u5e93\u53ef\u4ee5\u4f7f\u7528\u591a\u4e2a\u8868\u7a7a\u95f4\uff0c\u5c5e\"\u591a\u5bf9\u591a\"\u7684\u5173\u7cfb\u3002</p> </li> <li> <p>\u5728 Oracle \u4e2d\uff0c\u4e00\u4e2a\u8868\u7a7a\u95f4\u53ea\u53ef\u4f9b\u4e00\u4e2a\u6570\u636e\u5e93\u4f7f\u7528\uff1b\u800c\u4e00\u4e2a\u6570\u636e\u5e93\u53ef\u4ee5\u62e5\u6709\u591a\u4e2a\u8868\u7a7a\u95f4\uff0c\u5c5e\"\u4e00\u5bf9\u591a\"\u7684\u5173\u7cfb\u3002</p> </li> </ul> <p>PostgreSQL \u5728\u5b89\u88c5\u5b8c\u6210\u540e\u3002\u521d\u59cb\u5316\u65f6\u9700\u8981\u6307\u5b9a\u4e00\u4e2a\u6570\u636e\u76ee\u5f55\uff08$PGDATA\uff09\uff0c\u8be5\u76ee\u5f55\u4e0b\u4f1a\u5305\u542b PostgreSQL \u8981\u542f\u52a8\u65f6\u7684\u6240\u6709\u4e1c\u897f\uff08\u914d\u7f6e\u6587\u4ef6\u3001\u6570\u636e\u6587\u4ef6\u548c\u6d88\u606f\u961f\u5217\u7b49\uff09\u3002</p> <p>PostgreSQL \u542f\u52a8\u540e\uff0c\u6240\u6709\u6570\u636e\u5e93\u5bf9\u8c61\u7684\u6570\u636e\u6587\u4ef6\u90fd\u662f\u5728\u8be5\u6587\u4ef6\u5939\u4e0b\u5b58\u50a8\u7684\u3002\u7b80\u77ed\u4e00\u70b9\u8bf4\uff0c\u8868\u7a7a\u95f4\u5373\u662f\u544a\u8bc9 PostgreSQL \u670d\u52a1\u5668\u6570\u636e\u5e93\u5bf9\u8c61\u7269\u7406\u6587\u4ef6\u5b58\u50a8\u4f4d\u7f6e\u7684\u4e00\u79cd\u65b9\u5f0f\u3002\u5728 psql \u4e2d\u4f7f\u7528\\db+\u547d\u4ee4\u5373\u53ef\u5217\u51fa\u8868\u7a7a\u95f4\u7684\u8be6\u60c5\uff1a</p> <p>\u8fd9\u4e24\u4e2a\u8868\u7a7a\u95f4\uff08pg_default \u4e0e pg_global\uff09\u662f\u5728<code>PostgreSQL</code>\u521d\u59cb\u5316\u540e\u81ea\u52a8\u521b\u5efa\u7684\u3002</p> <ul> <li> <p>pg_default \u662f template0 \u4e0e template1 \u6570\u636e\u5e93\u7684\u9ed8\u8ba4\u8868\u7a7a\u95f4\uff08\u56e0\u6b64\uff0c\u4e5f\u5c06\u662f\u5176\u5b83\u6570\u636e\u5e93\u7684\u9ed8\u8ba4\u8868\u7a7a\u95f4\uff09\uff0c\u8def\u5f84\u662f ${GDATA}/base   pg_default\u662f\u7528\u6765\u5b58\u50a8\u7cfb\u7edf\u76ee\u5f55\u5bf9\u8c61\u3001\u7528\u6237\u8868\u3001\u7528\u6237\u8868index\u3001\u548c\u4e34\u65f6\u8868\u3001\u4e34\u65f6\u8868index\u3001\u5185\u90e8\u4e34\u65f6\u8868\u7684\u9ed8\u8ba4\u7a7a\u95f4\u3002\u5bf9\u5e94\u5b58\u50a8\u76ee\u5f55<code>${PADATA}/base/</code></p> </li> <li> <p>pg_global \u662f\u5171\u4eab\u7cfb\u7edf\u76ee\u5f55\u8868\uff08pg_database\u3001pg_authid\u3001pg_tablespace\u3001pg_shdepend \u7b49\uff09\u53ca\u5176\u7d22\u5f15\u7684\u8868\u7a7a\u95f4\u3002\u8def\u5f84\u662f <code>${PGDATA}/global</code></p> </li> </ul> <p>\u81ea\u5b9a\u4e49\u8868\u7a7a\u95f4\uff0c\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u8868\u7a7a\u95f4\uff0c\u9700\u8981\u63d0\u524d\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u7a7a\u6587\u4ef6\u5939\uff08\u6ce8\u610f\u4e0d\u8981\u5728 <code>PostgreSQL</code>\u6570\u636e\u6587\u4ef6\u5939<code>$PGDATA</code>\u4e0b\u521b\u5efa\uff09\uff0c\u4e14\u8be5\u6587\u4ef6\u5939\u7684<code>owner</code>\u987b\u662f<code>postgres</code>\u7cfb\u7edf\u7528\u6237\u3002</p> <pre><code>$ mkdir -p /data/postgres/testspace\n$ chown -R postgres:postgres /data/postgres/testspace\n</code></pre> <pre><code>-- \u521b\u5efa\u8868\u7a7a\u95f4\u3002\u8d85\u7ea7\u7528\u6237\uff08superuser\uff09\u53ef\u4f7f\u7528CREATE TABLESPACE\u547d\u4ee4\u6765\u521b\u5efa\u4e00\u4e2a\u8868\u7a7a\u95f4\u3002\nCREATE TABLESPACE myspace LOCATION '/data/postgres/testspace';\n\n-- \u5f53\u521b\u5efa\u4e00\u4e2a\u65b0\u8868\u7a7a\u95f4\uff0c$PGDATA/pg_tblspc\u76ee\u5f55\u4e0b\uff0c\u81ea\u52a8\u751f\u6210\u4e00\u4e2a\u8868\u7a7a\u95f4\u5bf9\u5e94\u7684oid\u540d\u79f0\u7684\u8f6f\u94fe\u63a5\u6587\u4ef6\uff0c\u5b9e\u9645\u6307\u5411\u8868\u7a7a\u95f4\u8bbe\u5b9a\u7684\u8def\u5f84\u3002\n-- oid\u540d\u79f0\u8f6f\u94fe\u63a5\u7684\u8868\u7a7a\u95f4\u5b9e\u9645\u76ee\u5f55\u4e0b\u9762\u4f1a\u518d\u751f\u6210\u4e00\u4e2a\u5b50\u76ee\u5f55\uff0c\u8fd9\u4e2a\u5b50\u76ee\u5f55\u547d\u540d\u89c4\u5219\u662fPG_Major version_Catalog version number(\u6bd4\u5982PG_10_201707211\uff0c\u53ef\u4ee5\u901a\u8fc7pg_controldata\u547d\u4ee4\u770b\u5230Catalog version number)\u7684\u683c\u5f0f\n\n-- \u67e5\u627e\u6240\u6709\u8868\u7a7a\u95f4\nSELECT * FROM pg_catalog.pg_tablespace;\nSELECT * FROM pg_tablespace;\n\n oid  |  spcname   | spcowner | spcacl | spcoptions\n------+------------+----------+--------+------------\n 1663 | pg_default |       10 |        |\n 1664 | pg_global  |       10 |        |\n\n\n\n\n/*\u67e5\u770b\u4e00\u5171\u6709\u591a\u5c11\u4e2adatabase? \u9ed8\u8ba4\u4e00\u5f00\u59cb\u5c31\u6709\u4e09\u4e2adatabase:template0,template1,postgres */\n/* \u7531\u4e8e OID \u662f\u7cfb\u7edf\u8868\u7684\u9690\u85cf\u5217\uff0c\u56e0\u6b64\u67e5\u770b\u7cfb\u7edf\u8868\u4e2d\u6570\u636e\u5e93\u5bf9\u8c61\u7684OID\u65f6\uff0c\u5fc5\u987b\u5728SELECT\u8bed\u53e5\u4e2d\u663e\u5f0f\u6307\u5b9a\u3002*/\nSELECT *, oid FROM pg_catalog.pg_database;\n\n/*\n\u67e5\u770b\u5f53\u524d\u8fde\u63a5\u7684\u6570\u636e\u5e93\u5185\uff0c\u6709\u591a\u5c11\u6a21\u5f0f\uff0c\u6bcf\u4e2a\u6a21\u5f0f\u5185\u6709\u591a\u5c11\u4e2a\u8868?\n\u6bcf\u4e2adatabase\u521b\u5efa\u597d\u540e\uff0c\u9ed8\u8ba4\u5176\u4e2d\u90fd\u4f1a\u5305\u542b3\u4e2aSchema\n\u4e00\u4e2a\u540d\u4e3apg_catalog\uff0c\u7528\u4e8e\u5b58\u50a8Postgresql\u7cfb\u7edf\u81ea\u5e26\u7684\u51fd\u6570,\u8868,\u7cfb\u7edf\u89c6\u56fe,\u6570\u636e\u7c7b\u578b\u8f6c\u6362\u5668\u4ee5\u53ca\u6570\u636e\u7c7b\u578b\u5b9a\u4e49\u7b49\u5143\u6570\u636e\n\u4e00\u4e2a\u540d\u4e3ainformation_schema\uff0c\u7528\u4e8e\u5b58\u50a8\u6240\u9700\u6c42\u63d0\u4f9b\u7684\u5143\u6570\u636e\u67e5\u8be2\u89c6\u56fe\uff0c\u76ee\u7684\u662f\u4e3a\u4e86\u7b26\u5408ANSI SQL\u89c4\u8303\uff0c\u53ef\u5355\u72ec\u5220\u9664\n\u4e00\u4e2a\u540d\u4e3apublic\uff0c\u7528\u4e8e\u5b58\u50a8\u7528\u6237\u521b\u5efa\u7684\u6570\u636e\u8868\u3002\u4e0d\u5efa\u8bae\u9879\u76ee\u7684\u8868\u5b58\u653e\u5728public\u4e0b\uff0c1\u3001\u662f\u6570\u636e\u5b89\u5168\uff1b2\u3001\u8868\u5b58\u653e\u6df7\u4e71\uff1b\u4e0d\u5229\u4e8e\u540e\u671f\u7ef4\u62a4\u7b49\u7b49\n*/\nselect table_schema, count(*) from information_schema.tables  group by table_schema;\n\n-- \u67e5\u770b\u5404\u79cdclass\u548ctype\nselect * from pg_class order by oid ;\n\n-- PostgreSQL\u7684\u6240\u6709\u6570\u636e\u7c7b\u578b\u90fd\u5b58\u50a8\u5728\u7cfb\u7edf\u8868pg_type\u4e2d\nselect * from pg_type ;\n\n\n-- \u6bcf\u4e00\u5f20\u8868\u7684\u6570\u636e\uff08\u5927\u90e8\u5206\uff09\u53c8\u662f\u653e\u5728 $PGDATA/base/{dboid}/{relfilenode} \u8fd9\u4e2a\u6587\u4ef6\u91cc\u9762\uff0crelfilenode\u4e00\u822c\u60c5\u51b5\u4e0b\u548c\u548ctboid\u4e00\u81f4\uff0c\u4f46\u6709\u4e9b\u60c5\u51b5\u4e0b\u4e5f\u4f1a\u53d8\u5316\uff0c\u5982TRUNCATE\u3001REINDEX\u3001CLUSTER\u4ee5\u53ca\u67d0\u4e9b\u5f62\u5f0f\u7684ALTER TABLE\u3002\n\n-- \u67e5\u627e\u8868\u540d\u7684oid, \u8868\u7269\u7406\u6587\u4ef6\u662f${PGDATA}/base/{dboid}/{relfilenode}\nselect oid,relfilenode from pg_class where relname = '\u8868\u540d';\n-- \u8868\u7269\u7406\u6587\u4ef6\u662f base/16396/16399\nselect pg_relation_filepath('dim_admin_area');\n\n\n\n-- \u5f53\u67e5\u770b ${PGDATA}/base/{dboid} \u76ee\u5f55\u65f6\uff0c\u4f1a\u53d1\u73b0 relfilenode \u7684\u6587\u4ef6\uff0c\u9664\u6b64\u4e4b\u5916\u8fd8\u4f1a\u53d1\u73b0\u6709\u4e9b\u6587\u4ef6\u547d\u540d\u4e3a relfilenode_fsm\u3001relfilenode_vm\u3001relfilenode_init\uff0c \u5173\u4e8e 16399 \u901a\u5e38\u4f1a\u6709\u4e09\u79cd\u6587\u4ef6\uff1a16399\u300116399_fsm\u300116399_vm\uff0c\u5206\u522b\u662f\u8be5\u6570\u636e\u5e93\u5bf9\u5e94\u8868\u7684\u6570\u636e\u6216\u7d22\u5f15\u6587\u4ef6\u3001\u5176\u5bf9\u5e94\u7684\u7a7a\u95f2\u7a7a\u95f4\u6620\u5c04\u6587\u4ef6\u3001\u5176\u5bf9\u5e94\u7684\u53ef\u89c1\u6027\u6620\u5c04\u6587\u4ef6\u3002\n\n-- \u5982\u679c\u6570\u636e\u6587\u4ef6\u8fc7\u5927\uff0c\u90a3\u4e48\u4f1a\u600e\u4e48\u547d\u540d\u5462\uff1f\n-- \u5728\u8868\u6216\u8005\u7d22\u5f15\u8d85\u8fc71GB\u4e4b\u540e\uff0c\u5b83\u5c31\u88ab\u5212\u5206\u62101GB\u5927\u5c0f\u7684\u6bb5\u3002 \u7b2c\u4e00\u4e2a\u6bb5\u7684\u6587\u4ef6\u540d\u548c\u6587\u4ef6\u8282\u70b9\u76f8\u540c\uff0c\u968f\u540e\u7684\u6bb5\u88ab\u547d\u540d\u4e3a filenode.1\u3001filenode.2\u7b49\u7b49\u3002\u8fd9\u6837\u7684\u5b89\u6392\u907f\u514d\u4e86\u5728\u67d0\u4e9b\u6709\u6587\u4ef6\u5927\u5c0f\u9650\u5236\u7684\u5e73\u53f0\u4e0a\u7684\u95ee\u9898\u3002\n</code></pre> <p>\u4ec0\u4e48\u65f6\u5019\u521b\u5efa\u8868\u7a7a\u95f4\uff1f</p> <p>\u5728\u7edd\u5927\u591a\u6570\u60c5\u51b5\u4e0b\uff0c\u4e0d\u5e94\u8be5\u5728 PostgreSQL \u4e2d\u521b\u5efa\u989d\u5916\u7684\u8868\u7a7a\u95f4\u3002\u7279\u522b\u662f\uff0c\u5728\u4e0e\u6570\u636e\u76ee\u5f55\u76f8\u540c\u7684\u6587\u4ef6\u7cfb\u7edf\u4e0a\u521b\u5efa\u4e00\u4e2a\u8868\u7a7a\u95f4\uff0c\u6216\u8005\u5728\u4e0e\u53e6\u4e00\u4e2a\u8868\u7a7a\u95f4\u76f8\u540c\u7684\u6587\u4ef6\u7cfb\u7edf\u4e0a\u521b\u5efa\u4e00\u4e2a\u8868\u7a7a\u95f4\uff0c\u90fd\u6ca1\u6709\u610f\u4e49\u3002</p> <p>\u90a3\u4e48\uff0c\u8868\u7a7a\u95f4\u6709\u54ea\u4e9b\u4f18\u70b9\u53ef\u4ee5\u8bc1\u660e\u7ba1\u7406\u7684\u590d\u6742\u6027\u662f\u5408\u7406\u7684\u5462?</p> <ul> <li> <p>\u5982\u679c\u60a8\u7684\u6570\u636e\u5206\u5e03\u5728\u4e0d\u540c\u8bbe\u5907\u4e0a\u7684\u51e0\u4e2a\u6587\u4ef6\u7cfb\u7edf\u4e0a\uff0c\u90a3\u4e48\u60a8\u53ef\u4ee5\u5206\u914d I/O \u8d1f\u8f7d\u3002\u7136\u800c\uff0c\u8fd9\u4e5f\u53ef\u4ee5\u901a\u8fc7\u5728\u8f83\u4f4e\u7684\u7ea7\u522b\u4e0a\u8fdb\u884c\u5265\u79bb\u6765\u5b8c\u6210\u3002</p> </li> <li> <p>\u5982\u679c\u78c1\u76d8\u4e0a\u7684\u7a7a\u95f4\u7528\u5b8c\uff0c\u8868\u7a7a\u95f4\u5c06\u4e3a\u60a8\u63d0\u4f9b\u6dfb\u52a0\u66f4\u591a\u5b58\u50a8\u7a7a\u95f4\u7684\u9009\u9879\u3002\u7136\u800c\uff0c\u73b0\u5728\u901a\u5e38\u53ef\u4ee5\u4f7f\u7528\u67d0\u79cd\u7c7b\u578b\u7684\u5377\u7ba1\u7406\u5668\u5728\u64cd\u4f5c\u7cfb\u7edf\u7ea7\u4e0a\u5b8c\u6210\u6b64\u5de5\u4f5c\u3002</p> </li> <li> <p>\u5982\u679c\u8981\u5bf9\u6570\u636e\u5e93\u6216\u8868\u8bbe\u7f6e\u5927\u5c0f\u9650\u5236\uff0c\u53ef\u4ee5\u5c06\u5176\u653e\u5728\u6587\u4ef6\u7cfb\u7edf\u7684\u8868\u7a7a\u95f4\u4e2d\u3002</p> </li> <li> <p>\u5982\u679c\u60a8\u540c\u65f6\u62e5\u6709\u5feb\u901f\u3001\u6602\u8d35\u548c\u7f13\u6162\u3001\u5ec9\u4ef7\u7684\u5b58\u50a8\u7a7a\u95f4\uff0c\u90a3\u4e48\u60a8\u53ef\u4ee5\u5c06\u9700\u8981\u826f\u597d\u6027\u80fd\u7684\u5bf9\u8c61\u653e\u5728\u5feb\u901f\u5b58\u50a8\u7a7a\u95f4\u4e0a\u7684\u5355\u72ec\u8868\u7a7a\u95f4\u4e2d\u3002\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u60a8\u5e94\u8be5\u8c03\u6574\u8868\u7a7a\u95f4\u4e0a\u7684 seq_page_cost\u3001random_page_cost \u548c effecve_io_concurrency \u9009\u9879\uff0c\u4ee5\u4fbf\u5c06\u6027\u80fd\u7279\u5f81\u544a\u8bc9\u4f18\u5316\u5668\u3002</p> </li> </ul> <p>\u5982\u679c\u5e0c\u671b\u5728\u9ed8\u8ba4\u8868\u7a7a\u95f4\u4e4b\u5916\u7684\u5176\u4ed6\u5730\u65b9\u521b\u5efa\u4e34\u65f6\u6587\u4ef6(\u7528\u4e8e\u4e34\u65f6\u8868\u548c\u7528\u4e8e\u67e5\u8be2\u5904\u7406)\uff0c\u53ef\u4ee5\u5c06 temp_tablespaces \u53c2\u6570\u8bbe\u7f6e\u4e3a\u4e0d\u540c\u7684\u8868\u7a7a\u95f4\u3002</p> <p>\u5982\u679c\u60a8\u8fd0\u884c\u5728\u865a\u62df\u5316\u73af\u5883\u4e2d\uff0c\u4f7f\u7528\u865a\u62df\u5316\u5b58\u50a8\uff0c\u90a3\u4e48\u9664\u4e86\u7b2c\u4e09\u70b9\u4e4b\u5916\uff0c\u5176\u4ed6\u7684\u70b9\u90fd\u662f\u6ca1\u6709\u610f\u4e49\u7684\u3002\u7531\u4e8e\u73b0\u5728\u51e0\u4e4e\u6240\u6709\u4eba\u90fd\u5728\u4f7f\u7528\u865a\u62df\u5316\uff0c\u8868\u7a7a\u95f4\u6b63\u5728\u6210\u4e3a PostgreSQL \u8d8a\u6765\u8d8a\u4e0d\u91cd\u8981\u7684\u7279\u6027\u3002</p> <p>\u6d88\u9664\u4e00\u4e2a\u65e7\u7684\u7684\u9519\u8bef\u7684\u89c2\u70b9</p> <p>\u5728\u6570\u636e\u5e93\u7ba1\u7406\u5458\u4e2d\u6d41\u4f20\u7740\u4e00\u4e2a\u6839\u6df1\u8482\u56fa\u7684\u795e\u8bdd\uff0c\u5373\u4e3a\u4e86\u83b7\u5f97\u826f\u597d\u7684\u6027\u80fd\uff0c\u60a8\u5e94\u8be5\u5c06\u8868\u548c\u7d22\u5f15\u653e\u5728\u4e0d\u540c\u7684\u78c1\u76d8\u4e0a\u3002</p> <p>\u60a8\u5c06\u542c\u5230\u4eba\u4eec\u8be6\u7ec6\u9610\u8ff0\u4e3a\u4ec0\u4e48\u7d22\u5f15\u626b\u63cf\u671f\u95f4\u8bbf\u95ee\u6a21\u5f0f\u7684\u7279\u5b9a\u76f8\u4e92\u4f5c\u7528\u4f1a\u4f7f\u5176\u5728\u65cb\u8f6c\u78c1\u76d8\u4e0a\u6709\u6548\u3002\u4f46\u662f\u65cb\u8f6c\u78c1\u76d8\u6b63\u5728\u505c\u6b62\u5de5\u4f5c\uff0c\u901a\u5e38\u53ea\u4f1a\u4f7f\u7528\u591a\u4e2a\u5e76\u53d1 SQL \u8bed\u53e5\u6765\u4f7f\u5b58\u50a8\u7cfb\u7edf\u9971\u548c\uff0c\u4f46\u65e0\u8bba\u5982\u4f55\uff0c\u6240\u6709\u6b64\u7c7b\u8bbf\u95ee\u6a21\u5f0f\u90fd\u4f1a\u4e2d\u65ad\u3002</p> <p>\u8fd9\u79cd\u8bef\u89e3\u80cc\u540e\u7684\u4e8b\u5b9e\u662f\uff0c\u5c06 I/O \u8d1f\u8f7d\u5206\u6563\u5230\u591a\u4e2a\u8bbe\u5907\u4e0a\u80af\u5b9a\u662f\u6709\u76ca\u7684\u3002\u5982\u679c\u5728\u64cd\u4f5c\u7cfb\u7edf\u7ea7\u522b\u4f7f\u7528\u6761\u5e26\u5316\uff0c\u4e0e\u5c0f\u5fc3\u653e\u7f6e\u8868\u548c\u7d22\u5f15\u76f8\u6bd4\uff0c\u5c06\u83b7\u5f97\u66f4\u597d\u7684\u5206\u5e03\u3002</p> <p>\u8bd1\u81ea https://www.cybertec-postgresql.com/en/when-to-use-tablespaces-in-postgresql/</p>"},{"location":"postgresql/03.%E4%BD%93%E7%B3%BB%E6%9E%B6%E6%9E%84/#_5","title":"\u7269\u7406\u7ed3\u6784","text":"<p>\u6570\u636e\u5e93\u96c6\u7c07\u5728\u672c\u8d28\u4e0a\u5c31\u662f\u4e00\u4e2a\u6587\u4ef6\u76ee\u5f55\uff0c\u540d\u66f0\u57fa\u7840\u76ee\u5f55\uff08base directory\uff09 \uff0c\u5305\u542b\u7740\u4e00\u7cfb\u5217\u5b50\u76ee\u5f55\u4e0e\u6587\u4ef6\u3002</p> <p>\u6267\u884c initdb \u547d\u4ee4\u4f1a\u5728\u6307\u5b9a\u76ee\u5f55\u4e0b\u521b\u5efa\u57fa\u7840\u76ee\u5f55\u4ece\u800c\u521d\u59cb\u5316\u4e00\u4e2a\u65b0\u7684\u6570\u636e\u5e93\u96c6\u7c07\u3002\u901a\u5e38\u4f1a\u5c06\u57fa\u7840\u76ee\u5f55\u7684\u8def\u5f84\u914d\u7f6e\u5230\u73af\u5883\u53d8\u91cf PGDATA \u4e2d\uff0c\u4f46\u8fd9\u5e76\u4e0d\u662f\u5fc5\u987b\u7684\u3002</p> <p>\u4e0b\u56fe\u5c55\u793a\u4e86\u4e00\u4e2a PostgreSQL \u6570\u636e\u5e93\u96c6\u7c07\u7684\u4f8b\u5b50\u3002</p> <p>base \u5b50\u76ee\u5f55\u4e2d\u7684\u6bcf\u4e00\u4e2a\u5b50\u76ee\u5f55\u90fd\u5bf9\u5e94\u4e00\u4e2a\u6570\u636e\u5e93\uff0c\u6570\u636e\u5e93\u4e2d\u6bcf\u4e2a\u8868\u548c\u7d22\u5f15\u90fd\u4f1a\u5728\u76f8\u5e94\u5b50\u76ee\u5f55\u4e0b\u5b58\u50a8\u4e3a\uff08\u81f3\u5c11\uff09\u4e00\u4e2a\u6587\u4ef6\uff1b\u8fd8\u6709\u51e0\u4e2a\u5305\u542b\u7279\u5b9a\u6570\u636e\u7684\u5b50\u76ee\u5f55\uff0c\u4ee5\u53ca\u914d\u7f6e\u6587\u4ef6\u3002 \u867d\u7136 PostgreSQL \u652f\u6301\u8868\u7a7a\u95f4\uff08Tablespace\uff09 \uff0c\u4f46\u8be5\u672f\u8bed\u7684\u542b\u4e49\u4e0e\u5176\u4ed6 RDBMS \u4e0d\u540c\u3002 PostgreSQL \u4e2d\u7684\u8868\u7a7a\u95f4\u5bf9\u5e94\u4e00\u4e2a\u5305\u542b\u57fa\u7840\u76ee\u5f55\u4e4b\u5916\u6570\u636e\u7684\u76ee\u5f55\u3002</p> <p></p> \u5b50\u76ee\u5f55 \u63cf\u8ff0 PG_VERSION \u7248\u672c\u53f7\u7684\u6587\u672c\u6587\u4ef6 <code>base</code> \u6bcf\u4e2a\u6570\u636e\u5e93\u5bf9\u5e94\u7684\u5b50\u76ee\u5f55\u5b58\u50a8\u4e8e\u6b64 <code>current_logfiles</code> \u7531\u65e5\u5fd7\u91c7\u96c6\u5668\u5199\u5165\u7684\u65e5\u5fd7\u6587\u4ef6 <code>global</code> \u6570\u636e\u5e93\u96c6\u7c07\u8303\u7574\u7684\u8868\uff08\u4f8b\u5982<code>pg_database</code>\uff09\uff0c\u4ee5\u53ca<code>pg_control</code>\u6587\u4ef6\u3002 <code>pg_commit_ts</code> \u4e8b\u52a1\u63d0\u4ea4\u7684\u65f6\u95f4\u6233\u6570\u636e\uff089.5 \u53ca\u66f4\u65b0\u7248\u672c\uff09\u3002 <code>pg_dynshmem</code> \u52a8\u6001\u5171\u4eab\u5185\u5b58\u5b50\u7cfb\u7edf\u4e2d\u4f7f\u7528\u7684\u6587\u4ef6\uff089.4 \u6216\u66f4\u65b0\u7248\u672c\uff09\u3002 <code>pg_logical</code> \u903b\u8f91\u89e3\u7801\u7684\u72b6\u6001\u6570\u636e\uff089.4 \u6216\u66f4\u65b0\u7248\u672c\uff09\u3002 <code>pg_multixact</code> \u591a\u4e8b\u52a1\u72b6\u6001\u6570\u636e <code>pg_notify</code> <code>LISTEN</code>/<code>NOTIFY</code>\u72b6\u6001\u6570\u636e <code>pg_repslot</code> \u590d\u5236\u69fd\u6570\u636e\uff089.4 \u6216\u66f4\u65b0\u7248\u672c\uff09\u3002 <code>pg_serial</code> \u5df2\u63d0\u4ea4\u7684\u53ef\u4e32\u884c\u5316\u4e8b\u52a1\u76f8\u5173\u4fe1\u606f\uff089.1 \u6216\u66f4\u65b0\u7248\u672c\uff09 <code>pg_snapshots</code> \u5bfc\u51fa\u5feb\u7167\uff089.2 \u6216\u66f4\u65b0\u7248\u672c\uff09\u3002 PostgreSQL \u51fd\u6570<code>pg_export_snapshot</code>\u5728\u6b64\u5b50\u76ee\u5f55\u4e2d\u521b\u5efa\u5feb\u7167\u4fe1\u606f\u6587\u4ef6\u3002 <code>pg_stat</code> \u7edf\u8ba1\u5b50\u7cfb\u7edf\u7684\u6c38\u4e45\u6587\u4ef6 <code>pg_stat_tmp</code> \u7edf\u8ba1\u5b50\u7cfb\u7edf\u7684\u4e34\u65f6\u6587\u4ef6 <code>pg_subtrans</code> \u5b50\u4e8b\u52a1\u72b6\u6001\u6570\u636e <code>pg_tblspc</code> \u6307\u5411\u8868\u7a7a\u95f4\u7684\u7b26\u53f7\u94fe\u63a5 <code>pg_twophase</code> \u4e24\u9636\u6bb5\u4e8b\u52a1\uff08prepared transactions\uff09\u7684\u72b6\u6001\u6587\u4ef6 <code>pg_wal</code> WAL\uff08 Write Ahead Logging\uff09\u6bb5\u6587\u4ef6\uff0810 \u6216\u66f4\u65b0\u7248\u672c\uff09\uff0c\u4ece<code>pg_xlog</code>\u91cd\u547d\u540d\u800c\u6765\u3002 <code>pg_xact</code> \u4e8b\u52a1\u63d0\u4ea4\u72b6\u6001\u6570\u636e\uff0c\uff0810 \u6216\u66f4\u65b0\u7248\u672c\uff09\uff0c\u4ece<code>pg_clog</code>\u91cd\u547d\u540d\u800c\u6765\u3002CLOG \u5c06\u5728 5.4 \u63d0\u4ea4\u65e5\u5fd7\uff08clog\uff09 \u4e2d\u63cf\u8ff0\u3002 <code>pg_xlog</code> WAL\uff08Write Ahead Logging\uff09 \u6bb5\u6587\u4ef6\uff089.6 \u53ca\u66f4\u8001\u7248\u672c\uff09\uff0c\u5b83\u5728\u7248\u672c 10 \u4e2d\u88ab\u91cd\u547d\u540d\u4e3a<code>pg_wal</code>\u3002 <p>\u65b0\u5efa\u4e00\u4e2a\u6570\u636e\u5e93\u4f1a\u5728\u8868\u7a7a\u95f4\u5bf9\u5e94\u7684\u76ee\u5f55\u4e0b\u521b\u5efa\u4e00\u4e2a oid\uff08\u6570\u636e\u5e93 oid\uff09\u7684\u76ee\u5f55:\u7528\u4e8e\u5b58\u653e\u8fd9\u4e2a\u6570\u636e\u5e93\u5bf9\u5e94\u7684\u6570\u636e\u6587\u4ef6\u3002</p> <p>\u6570\u636e\u5e93\u5b50\u76ee\u5f55\u4e0b\u662f\u4ee5\u5bf9\u8c61 OID \u547d\u540d\u7684\u6587\u4ef6</p> <p>\u4f8b\u5982\u5f53\u6570\u636e\u5e93<code>sampledb</code>\u7684 OID \u4e3a 16384 \u65f6\uff0c\u5b83\u5bf9\u5e94\u7684\u5b50\u76ee\u5f55\u540d\u79f0\u5373\u4e3a 16384\u3002</p> <pre><code>postgres=# SELECT oid,datname,datdba,encoding   FROM pg_database;\n oid |  datname  | datdba | encoding\n-----+-----------+--------+----------\n   5 | postgres  |     10 |        6\n   1 | template1 |     10 |        6\n   4 | template0 |     10 |        6\n(3 rows)\n</code></pre> <p>\u5728 pg \u4e2d\uff0coid \u7528\u6765\u5728\u6574\u4e2a\u6570\u636e\u96c6\u7c07\u4e2d\u552f\u4e00\u6807\u8bc6\u4e00\u4e2a\u6570\u636e\u5e93\u5bf9\u8c61\uff0c\u5bf9\u8c61\u53ef\u4ee5\u662f\u6570\u636e\u5e93\u3001\u6a21\u5f0f\u3001\u8868\u3001\u7d22\u5f15\u3001\u89c6\u56fe\u3001\u5143\u7956\u7b49\u7b49\u3002oid \u7528 4 \u4e2a\u5b57\u8282\u7684\u65e0\u7b26\u53f7\u6574\u6570\u8868\u793a\u3002</p> <p>OID \u5728<code>PostgreSQL</code>\u4e2d\u88ab\u7528\u6765\u63cf\u8ff0\u4e00\u4e2a\u4e2a\u6570\u636e\u8868\u7684\u903b\u8f91\u5bf9\u8c61\uff0c\u6bd4\u5982 Relation, type, attr, namespace \u7b49\u7b49\uff0c\u6bcf\u521b\u5efa\u4e00\u4e2a\u5bf9\u8c61\u90fd\u4f1a\u4e3a\u5176\u5206\u914d\u4e00\u4e2a\u5c5e\u4e8e\u81ea\u5df1\u7684\u6807\u8bc6(Oid)\u3002</p> <p>\u5982\u679c\u5bf9 PostgreSQL \u6709\u4e00\u5b9a\u4e86\u89e3\uff0c\u5e94\u8be5\u77e5\u9053 PostgreSQL \u6700\u521d\u7684\u8bbe\u8ba1\u7406\u5ff5\u5c31\u662f\"\u5bf9\u8c61\u5173\u7cfb\u6570\u636e\u5e93\"\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c\u7cfb\u7edf\u8868\u4e2d\u50a8\u5b58\u7684\u90a3\u4e9b\u5143\u6570\u636e\uff0c\u6bd4\u5982\u8868\uff0c\u89c6\u56fe\uff0c\u7c7b\u578b\uff0c\u64cd\u4f5c\u7b26\uff0c\u51fd\u6570\uff0c\u7d22\u5f15\uff0cFDW\uff0c\u751a\u81f3\u5b58\u50a8\u8fc7\u7a0b\u8bed\u8a00\u7b49\u7b49\u8fd9\u4e9b\u7edf\u7edf\u90fd\u662f\u5bf9\u8c61\u3002\u5177\u4f53\u8868\u73b0\u5c31\u5728\u4e8e\u8fd9\u4e9b\u4e1c\u897f\u90fd\u53ef\u4ee5\u6269\u5c55\uff0c\u53ef\u4ee5\u5b9a\u5236\u3002\u4e0d\u4ec5\u5982\u6b64\uff0cPostgreSQL \u8fd8\u652f\u6301\u51fd\u6570\u91cd\u8f7d\uff0c\u8868\u7ee7\u627f\u7b49\u8fd9\u4e9b\u5f88 OOP \u7684\u7279\u6027\u3002</p> <p>\u5229\u7528 PostgreSQL \u7684\u8fd9\u4e9b\u7279\u6027\uff0c\u7528\u6237\u53ef\u4ee5\u6839\u636e\u4e1a\u52a1\u573a\u666f\u4ece\u5e94\u7528\u5c42\u5230\u6570\u636e\u5e93\u5c42\u505a\u4e00\u4f53\u5316\u7684\u4f18\u5316\u8bbe\u8ba1\uff0c\u83b7\u5f97\u6781\u81f4\u7684\u6027\u80fd\u4e0e\u7528\u6237\u4f53\u9a8c\u3002\u4e00\u4e9b\u7528\u60ef\u4e86 MySQL \u7684\u4e92\u8054\u7f51\u67b6\u6784\u5e08\u63a8\u5d07\"\u628a\u6570\u636e\u5e93\u5f53\u5b58\u50a8\"\uff0c\u8fd9\u4e00\u8bbe\u8ba1\u51c6\u5219\u7528\u5728 MySQL \u4e0a\u4e5f\u8bb8\u5408\u9002\uff0c\u4f46\u5982\u679c\u786c\u8981\u5957\u5728 PostgreSQL \u4e0a\uff0c\u5c31\u6709\u70b9\u66b4\u6b84\u5929\u7269\u4e86\uff01</p> <p>PG \u4e5f\u4f1a\u901a\u8fc7 OID \u6765\u5728\u4e0d\u540c\u7684\u6570\u636e\u8868\u4e4b\u95f4\u5efa\u7acb\u5173\u8054\uff0c\u4e5f\u5c31\u662f\u8bf4\u6709\u4e00\u4e9b\u5bf9\u8c61\u662f\u5168\u5c40\u552f\u4e00\u7684(pg_class \u8868\u7684 oid)\u3002</p> <p>\u4f46\u662f\u56e0\u4e3a OID \u662f <code>unsigned int</code> \u7c7b\u578b\uff0c\u6240\u4ee5\u5f53\u5bf9\u8c61\u7684\u6570\u91cf\u8d85\u8fc7 42 \u4ebf\u4e4b\u540e\u53ef\u80fd\u4f1a\u6709\u56de\u5377\uff0c\u6240\u4ee5 PG \u5bf9 OID \u7684\u5212\u5206\u6709\u4e00\u4e9b\u81ea\u5df1\u7684\u5b9a\u4e49\uff0c\u6bd4\u5982\u9884\u7559<code>16383</code>\u4e2a<code>OID</code>\u4f5c\u4e3a\u5168\u5c40\u552f\u4e00\u7684\u5bf9\u8c61\u6807\u8bc6\uff0c\u5176\u4ed6\u7684\u90fd\u662f\u7ed9\u7528\u6237\u8868\u4f7f\u7528\uff0c\u5141\u8bb8\u53d1\u751f\u56de\u5377\u3002</p> <p>\u6709\u4e00\u4e2a\u7cfb\u7edf\u8868\u53eb\u505a\uff1apg_class\uff0c\u8fd9\u4e2a\u8868\u91cc\u8bb0\u5f55\u4e86\u6570\u636e\u8868\u3001\u7d22\u5f15(\u4ecd\u7136\u9700\u8981\u53c2\u9605 pg_index)\u3001\u5e8f\u5217\u3001\u89c6\u56fe\u3001\u590d\u5408\u7c7b\u578b\u548c\u4e00\u4e9b\u7279\u6b8a\u5173\u7cfb\u7c7b\u578b\u7684\u5143\u6570\u636e\u3002</p> <p><code>pg_class</code>\u7cfb\u7edf\u8868\u7528\u6765\u7ba1\u7406\u4e00\u4e2a\u8868\u7684\u5bf9\u8c61\u5c5e\u6027\uff0c\u5c31\u662f\u5b58\u50a8\u5728\u5f53\u524d\u6570\u636e\u5e93\u7684\u6240\u6709\u8868\u5728\u6b64\u65f6\u7684\u56fa\u6709\u5c5e\u6027\u4fe1\u606f\u90fd\u4f1a\u88ab\u7edf\u4e00\u653e\u5728<code>pg_class</code>\u7cfb\u7edf\u8868\u4e2d\u3002</p> <p>\u6ce8\u610f\uff1a\u4e0d\u662f\u6240\u6709\u5b57\u6bb5\u5bf9\u6240\u6709\u5bf9\u8c61\u7c7b\u578b\u90fd\u6709\u610f\u4e49\u3002</p> \u540d\u5b57 \u7c7b\u578b \u5f15\u7528 \u63cf\u8ff0 oid oid \u6570\u636e\u5e93\u5bf9\u8c61\u7684\u552f\u4e00\u6807\u8bc6\u7b26 relname name \u6570\u636e\u5e93\u5bf9\u8c61\u7684\u540d\u5b57 relnamespace oid pg_namespace.oid \u5305\u542b\u8fd9\u4e2a\u5bf9\u8c61\u7684\u540d\u5b57\u7a7a\u95f4(\u6a21\u5f0f)\u7684 OID\u3002 reltype oid pg_type.oid \u5bf9\u5e94\u8fd9\u4e2a\u8868\u7684\u884c\u7c7b\u578b\u7684\u6570\u636e\u7c7b\u578b OID\u3002 relowner oid pg_authid.oid \u5bf9\u8c61\u7684\u6240\u6709\u8005 OID\u3002 <code>relam</code> oid pg_am.oid \u5bf9\u4e8e\u7d22\u5f15\u5bf9\u8c61\uff0c\u8868\u793a\u8be5\u7d22\u5f15\u7684\u7c7b\u578b(B-tree\uff0chash)\uff0cOID\u3002 <code>relfilenode</code> oid \u5bf9\u8c61\u5b58\u50a8\u5728\u78c1\u76d8\u4e0a\u7684\u6587\u4ef6\u540d\uff0c\u5982\u679c\u6ca1\u6709\u5219\u4e3a 0\uff0cOID\u3002 reltablespace oid pg_tablespace.oid \u5bf9\u8c61\u6240\u5728\u7684\u8868\u7a7a\u95f4\u3002\u5982\u679c\u4e3a\u96f6\uff0c\u5219\u8868\u793a\u4f7f\u7528\u8be5\u6570\u636e\u5e93\u7684\u7f3a\u7701\u8868\u7a7a\u95f4\u3002(\u5982\u679c\u5bf9\u8c61\u5728\u78c1\u76d8\u4e0a\u6ca1\u6709\u6587\u4ef6\uff0c\u8fd9\u4e2a\u5b57\u6bb5\u5c31\u6ca1\u6709\u4ec0\u4e48\u610f\u4e49) relpages int4 \u8be5\u6570\u636e\u8868\u6216\u7d22\u5f15\u6240\u5360\u7528\u7684\u78c1\u76d8\u9875\u9762\u6570\u91cf\uff0c\u67e5\u8be2\u89c4\u5212\u5668\u4f1a\u501f\u52a9\u8be5\u503c\u9009\u62e9\u6700\u4f18\u8def\u5f84\u3002 reltuples float4 \u8868\u4e2d\u884c\u7684\u6570\u91cf\uff0c\u8be5\u503c\u53ea\u662f\u88ab\u89c4\u5212\u5668\u4f7f\u7528\u7684\u4e00\u4e2a\u4f30\u8ba1\u503c\u3002 reltoastrelid oid pg_class.oid \u4e0e\u6b64\u8868\u5173\u8054\u7684 TOAST \u8868\u7684 OID\uff0c\u5982\u679c\u6ca1\u6709\u4e3a 0\u3002TOAST \u8868\u5728\u4e00\u4e2a\u4ece\u5c5e\u8868\u91cc\"\u79bb\u7ebf\"\u5b58\u50a8\u5927\u5b57\u6bb5\u3002 reltoastidxid oid pg_class.oid \u5982\u679c\u662f TOAST \u8868\uff0c\u8be5\u5b57\u6bb5\u4e3a\u5b83\u7d22\u5f15\u7684 OID\uff0c\u5982\u679c\u4e0d\u662f TOAST \u8868\u5219\u4e3a 0\u3002 relhasindex bool \u5982\u679c\u8fd9\u662f\u4e00\u4e2a\u6570\u636e\u8868\u800c\u4e14\u81f3\u5c11\u6709(\u6216\u8005\u6700\u8fd1\u6709\u8fc7)\u4e00\u4e2a\u7d22\u5f15\uff0c\u5219\u4e3a\u771f\u3002\u5b83\u662f\u7531 CREATE INDEX \u8bbe\u7f6e\u7684\uff0c\u4f46 DROP INDEX \u4e0d\u4f1a\u7acb\u5373\u5c06\u5b83\u6e05\u9664\u3002\u5982\u679c VACUUM \u53d1\u73b0\u4e00\u4e2a\u8868\u6ca1\u6709\u7d22\u5f15\uff0c\u90a3\u4e48\u5b83\u6e05\u7406 relhasindex\u3002 relisshared bool \u5982\u679c\u8be5\u8868\u5728\u6574\u4e2a\u96c6\u7fa4\u4e2d\u7531\u6240\u6709\u6570\u636e\u5e93\u5171\u4eab\uff0c\u5219\u4e3a\u771f\u3002 relkind char r = \u666e\u901a\u8868\uff0ci = \u7d22\u5f15\uff0cS = \u5e8f\u5217\uff0cv = \u89c6\u56fe\uff0c c = \u590d\u5408\u7c7b\u578b\uff0cs = \u7279\u6b8a\uff0ct = TOAST \u8868 relnatts int2 \u6570\u636e\u8868\u4e2d\u7528\u6237\u5b57\u6bb5\u7684\u6570\u91cf(\u9664\u4e86\u7cfb\u7edf\u5b57\u6bb5\u4ee5\u5916\uff0c\u5982 oid)\u3002\u5728 pg_attribute \u91cc\u80af\u5b9a\u6709\u76f8\u540c\u6570\u76ee\u7684\u6570\u636e\u884c\u3002\u89c1 pg_attribute.attnum. relchecks int2 \u8868\u4e2d\u68c0\u67e5\u7ea6\u675f\u7684\u6570\u91cf\uff0c\u53c2\u9605 pg_constraint \u8868\u3002 reltriggers int2 \u8868\u4e2d\u89e6\u53d1\u5668\u7684\u6570\u91cf\uff1b\u53c2\u9605 pg_trigger \u8868\u3002 <code>relhasoids</code> bool \u5982\u679c\u6211\u4eec\u4e3a\u5bf9\u8c61\u4e2d\u7684\u6bcf\u884c\u90fd\u751f\u6210\u4e00\u4e2a OID\uff0c\u5219\u4e3a\u771f\u3002 relhaspkey bool \u5982\u679c\u8be5\u8868\u5b58\u5728\u4e3b\u952e\uff0c\u5219\u4e3a\u771f\u3002 relhasrules bool \u5982\u8868\u6709\u89c4\u5219\u5c31\u4e3a\u771f\uff1b\u53c2\u9605<code>pg_rewrite</code>\u8868\u3002 relhassubclass <code>bool</code> \u5982\u679c\u8be5\u8868\u6709\u5b50\u8868\uff0c\u5219\u4e3a\u771f\u3002 relacl aclitem[] \u8bbf\u95ee\u6743\u9650\u3002 <p>\u4f5c\u4e3a OOP \u7684\u4f53\u73b0\u4e4b\u4e00\uff0cPostgreSQL \u4e2d\u6bcf\u4e2a\u8868\u90fd\u662f\u4e00\u4e2a\u65b0\u7684\u6570\u636e\u7c7b\u578b\uff0c\u5373\u6709\u4e00\u4e2a\u76f8\u5e94\u7684\u6570\u636e\u7c7b\u578b\u5bf9\u8c61\u3002</p> <pre><code>-- \u8fd9\u4e2aoid\u662f\u9690\u85cf\u5b57\u6bb5\uff0c\u56e0\u6b64\u5fc5\u987b\u5728select\u5217\u8868\u91cc\u660e\u786e\u6307\u5b9aoid\u5217\u540d\uff0c\u5149\u4f7f\u7528select *\u662f\u4e0d\u8f93\u51faoid\u7684\u3002\nSELECT oid, relname FROM pg_class WHERE relname = '\u8868\u540d';\n\nSELECT oid, relname FROM pg_class WHERE relname = 'pg_class';\n oid  | relname\n------+----------\n 1259 | pg_class\n(1 row)\n\npostgres=#\n\n-- \u8fd9\u6761\u8bed\u53e5\u662f\u67e5\u8be2\u6570\u636e\u5e93\u6570\u636e\u5e93\u4e2d\u7684\u6240\u6709\u8868\n--regclass\u662f\u4e00\u4e2a\u7279\u6b8a\u7684\u6570\u636e\u7c7b\u578b\u3002\u5b83\u5b9e\u9645\u662foid(Object identifiers)\u7684\u522b\u540d\u3002\nSELECT oid :: regclass AS table_name, relname FROM pg_class WHERE relkind = 'r';\n\n\n-- \u5bf9\u4e8epg\u4e2d\u7684\u5bf9\u8c61\u6765\u8bf4\uff0coid\u4e0e\u8868\u540d\u5b58\u5728\u5bf9\u8c61\u5173\u7cfb\uff0c\u8fd9\u4e2a\u5173\u7cfb\u6211\u4eec\u53ef\u4ee5\u4ecepg_class\u4e2d\u5f97\u5230\u3002\n\n\n/*\u67e5\u770b\u4e00\u5171\u6709\u591a\u5c11\u4e2adatabase\uff1a\u9ed8\u8ba4\u4e00\u5f00\u59cb\u5c31\u6709\u4e09\u4e2adatabase:template0,template1,postgres */\nSELECT * FROM pg_catalog.pg_database;\n\n/*\n\u67e5\u770b\u5f53\u524d\u8fde\u63a5\u7684\u6570\u636e\u5e93\u5185\uff0c\u6709\u591a\u5c11\u6a21\u5f0f\uff0c\u6bcf\u4e2a\u6a21\u5f0f\u5185\u6709\u591a\u5c11\u4e2a\u8868\n\u6bcf\u4e2adatabase\u521b\u5efa\u597d\u540e\uff0c\u9ed8\u8ba4\u5176\u4e2d\u90fd\u4f1a\u5305\u542b3\u4e2aSchema\n\u4e00\u4e2a\u540d\u4e3apg_catalog\uff0c\u7528\u4e8e\u5b58\u50a8Postgresql\u7cfb\u7edf\u81ea\u5e26\u7684\u51fd\u6570,\u8868,\u7cfb\u7edf\u89c6\u56fe,\u6570\u636e\u7c7b\u578b\u8f6c\u6362\u5668\u4ee5\u53ca\u6570\u636e\u7c7b\u578b\u5b9a\u4e49\u7b49\u5143\u6570\u636e\n\u4e00\u4e2a\u540d\u4e3ainformation_schema\uff0c\u7528\u4e8e\u5b58\u50a8\u6240\u9700\u6c42\u63d0\u4f9b\u7684\u5143\u6570\u636e\u67e5\u8be2\u89c6\u56fe\uff0c\u76ee\u7684\u662f\u4e3a\u4e86\u7b26\u5408ANSI SQL\u89c4\u8303\uff0c\u53ef\u5355\u72ec\u5220\u9664\n\u4e00\u4e2a\u540d\u4e3apublic\uff0c\u7528\u4e8e\u5b58\u50a8\u7528\u6237\u521b\u5efa\u7684\u6570\u636e\u8868\u3002\u4e0d\u5efa\u8bae\u9879\u76ee\u7684\u8868\u5b58\u653e\u5728public\u4e0b\uff0c1\u3001\u662f\u6570\u636e\u5b89\u5168\uff1b2\u3001\u8868\u5b58\u653e\u6df7\u4e71\uff1b\u4e0d\u5229\u4e8e\u540e\u671f\u7ef4\u62a4\u7b49\u7b49\n*/\nSELECT table_schema, count(*) FROM information_schema.tables  GROUP BY table_schema;\n\n-- \u67e5\u770b\u5404\u79cd\u7c7b\uff1a\nSELECT * FROM pg_class ORDER BY oid ;\nSELECT pg_relation_filepath('dim_admin_area');\n\n\n-- pg_relation_filepath \u662f PostgreSQL \u4e2d\u4e00\u4e2a\u975e\u5e38\u6709\u7528\u7684\u7cfb\u7edf\u51fd\u6570\uff0c\u5b83\u53ef\u4ee5\u8fd4\u56de\u6307\u5b9a\u5173\u7cfb\uff08\u8868\u3001\u7d22\u5f15\u3001\u5e8f\u5217\u7b49\uff09\u7684\u7269\u7406\u6587\u4ef6\u8def\u5f84\u3002\u7b80\u5355\u6765\u8bf4\uff0c\u5c31\u662f\u544a\u8bc9\u4f60\u8fd9\u4e2a\u5173\u7cfb\u7684\u6570\u636e\u5b58\u50a8\u5728\u78c1\u76d8\u4e0a\u7684\u5177\u4f53\u4f4d\u7f6e\u3002oid\u4e3a\u8981\u67e5\u8be2\u7684\u5173\u7cfb\u7684 OID\uff08\u5bf9\u8c61\u6807\u8bc6\u7b26\uff09\u3002\u4f60\u53ef\u4ee5\u901a\u8fc7 SELECT oid FROM pg_class WHERE relname = '\u4f60\u7684\u8868\u540d'; \u6765\u83b7\u53d6\u8868\u7684 OID\u3002\npg_relation_filepath(oid)\n\n\n-- `PostgreSQL\u6587\u4ef6\u6bb5`\u662f\u6307\u6570\u636e\u5e93\u8868\u5728\u78c1\u76d8\u4e0a\u7684\u7269\u7406\u5b58\u50a8\u5355\u5143\u3002\u5f53\u4e00\u4e2a\u8868\u7684\u6570\u636e\u91cf\u8d85\u8fc7\u4e00\u5b9a\u9608\u503c\uff08\u9ed8\u8ba4 1GiB\uff09\u65f6\uff0cPostgreSQL \u4f1a\u5c06\u8be5\u8868\u7684\u6570\u636e\u5206\u5272\u6210\u591a\u4e2a\u5927\u5c0f\u76f8\u7b49\u7684\u6587\u4ef6\uff0c\u8fd9\u4e9b\u6587\u4ef6\u5c31\u662f\u6587\u4ef6\u6bb5\u3002\u6587\u4ef6\u6bb5\u7684\u540d\u79f0\u901a\u5e38\u662f\u8868 OID\uff08\u5bf9\u8c61\u6807\u8bc6\u7b26\uff09\u52a0\u4e0a\u4e00\u4e2a\u6570\u5b57\u540e\u7f00\uff0c\u4f8b\u5982 12345.1\u300112345.2\uff0c\u5176\u4e2d 12345 \u662f\u8868\u7684 OID\uff0c\u540e\u7f00\u8868\u793a\u6587\u4ef6\u6bb5\u7684\u5e8f\u53f7\u3002\n\n-- \u5728 PostgreSQL \u4e2d\uff0csegment_size \u548c blocks \u8fd9\u4e24\u4e2a\u53c2\u6570\u5171\u540c\u51b3\u5b9a\u4e86\u4e00\u4e2a\u8868\u7684\u6570\u636e\u6587\u4ef6\uff08\u5373\u6587\u4ef6\u6bb5\uff09\u7684\u6700\u5927\u5c3a\u5bf8\u3002\n\n-- \u5757\uff1a\u5757\u662fPostgreSQL\u4e2d\u5b58\u50a8\u6570\u636e\u7684\u6700\u5c0f\u5355\u4f4d\uff0c\u4e00\u4e2a block \u7c7b\u4f3c\u4e8e\u78c1\u76d8\u4e0a\u7684\u4e00\u4e2a\u7269\u7406\u9875\u3002\u5b83\u7684\u5927\u5c0f\u53ef\u4ee5\u901a\u8fc7block_size\u53c2\u6570\u6765\u8bbe\u7f6e\uff0c\u9ed8\u8ba4\u662f 8KB \u3002\u7b80\u800c\u8a00\u4e4b\uff0c\u5757\u5c31\u662f\u6570\u636e\u9875\u7684\u6982\u5ff5\u3002\u6bcf\u4e2ablock\u4e2d\u5b58\u50a8\u7740\u8868\u7684\u4e00\u884c\u6216\u591a\u884c\u6570\u636e\u3002PostgreSQL\u901a\u8fc7\u5bf9block\u7684\u7ba1\u7406\u6765\u5206\u914d\u548c\u56de\u6536\u5b58\u50a8\u7a7a\u95f4\u3002\u7d22\u5f15\u4e5f\u662f\u5b58\u50a8\u5728block\u4e2d\u7684\u3002\n\n-- \u6bb5\uff1aPostgreSQL\u6587\u4ef6\u6bb5\u662f\u6307\u6570\u636e\u5e93\u8868\u5728\u78c1\u76d8\u4e0a\u7684\u7269\u7406\u5b58\u50a8\u5355\u5143\uff08\u4e00\u4e2a\u6bb5\u5c31\u5bf9\u5e94\u7740Linux\u6587\u4ef6\u7cfb\u7edf\u4e2d\u7684\u4e00\u4e2a\u6587\u4ef6\uff09\u3002\u5f53\u4e00\u4e2a\u8868\u7684\u6570\u636e\u91cf\u8d85\u8fc7\u4e00\u5b9a\u9608\u503c\uff08\u9ed8\u8ba4 1GB\uff09\u65f6\uff0cPostgreSQL \u4f1a\u5c06\u8be5\u8868\u7684\u6570\u636e\u5206\u5272\u6210\u591a\u4e2a\u5927\u5c0f\u76f8\u7b49\u7684\u6587\u4ef6\uff0c\u8fd9\u4e9b\u6587\u4ef6\u5c31\u662f\u6587\u4ef6\u6bb5\u3002\u6587\u4ef6\u6bb5\u7684\u540d\u79f0\u901a\u5e38\u662f\u8868 OID\uff08\u5bf9\u8c61\u6807\u8bc6\u7b26\uff09\u52a0\u4e0a\u4e00\u4e2a\u6570\u5b57\u540e\u7f00\uff0c\u4f8b\u5982 12345.1\u300112345.2\uff0c\u5176\u4e2d 12345 \u662f\u8868\u7684 OID\uff0c\u540e\u7f00\u8868\u793a\u6587\u4ef6\u6bb5\u7684\u5e8f\u53f7\u3002\u6bb5\u53ef\u4ee5\u5c06\u6570\u636e\u5206\u6210\u591a\u4e2asegment\u53ef\u4ee5\u51cf\u5c11\u5355\u4e2a\u6587\u4ef6I/O\u64cd\u4f5c\uff0c\u63d0\u9ad8\u67e5\u8be2\u6027\u80fd\u3002segment_size \u53c2\u6570\u51b3\u5b9a\u4e86\u4e00\u4e2asegment\u7684\u5927\u5c0f\u3002segment_size\u53c2\u6570\u7684\u542b\u4e49\u662f\u8868\u793a\u5757\u6570\u91cf\uff0c\u9ed8\u8ba4\u662f131072\n\n\n-- \u7ed3\u5408\u8d77\u6765\uff0c\u4e00\u4e2a\u6bb5\u662f131072\u4e2a\u5757\uff0c\u4e00\u5757\u662f8KiB\uff0c\u6240\u4ee5\u4e00\u4e2a\u6bb5\u662f131072*8KiB = 1GiB\n\n\n-- PostgreSQL\u7684\u6240\u6709\u6570\u636e\u7c7b\u578b\u90fd\u5b58\u50a8\u5728\u7cfb\u7edf\u8868pg_type\u4e2d:\nSELECT * FROM pg_catalog.pg_type;\nSELECT typnamespace, count(*) FROM pg_catalog.pg_type GROUP BY typnamespace ;\n\n-- \u5728 PostgreSQL \u4e2d\uff0cpg_namespace \u662f\u4e00\u4e2a\u7cfb\u7edf\u8868\uff0c\u7528\u4e8e\u5b58\u50a8\u6240\u6709\u547d\u540d\u7a7a\u95f4\uff08schema\uff09\u7684\u76f8\u5173\u4fe1\u606f\u3002\u547d\u540d\u7a7a\u95f4\u5728 PostgreSQL \u4e2d\u7528\u4e8e\u7ec4\u7ec7\u6570\u636e\u5e93\u5bf9\u8c61\uff0c\u5982\u8868\u3001\u89c6\u56fe\u3001\u51fd\u6570\u7b49\uff0c\u4ee5\u907f\u514d\u540d\u79f0\u51b2\u7a81\u3002\n-- oid\uff1a\u5bf9\u8c61\u6807\u8bc6\u7b26\uff0c\u8fd9\u662f pg_namespace \u8868\u4e2d\u6bcf\u884c\u7684\u552f\u4e00\u6807\u8bc6\u7b26\u3002\n-- nspname\uff1a\u547d\u540d\u7a7a\u95f4\u7684\u540d\u79f0\u3002\n-- nspowner\uff1a\u62e5\u6709\u8be5\u547d\u540d\u7a7a\u95f4\u7684\u89d2\u8272\uff08\u7528\u6237\uff09\u7684 OID\u3002\n-- nspacl\uff1a\u547d\u540d\u7a7a\u95f4\u7684\u8bbf\u95ee\u63a7\u5236\u5217\u8868\uff08ACL\uff0cAccess Control List\uff09\uff0c\u7528\u4e8e\u5b9a\u4e49\u54ea\u4e9b\u7528\u6237\u6216\u7ec4\u5177\u6709\u54ea\u4e9b\u6743\u9650\u3002\nSELECT * FROM pg_catalog.pg_namespace ;\n</code></pre> <pre><code>-- \u521b\u5efa\u81ea\u5b9a\u4e49\u6570\u636e\u7c7b\u578b\nCREATE TYPE map AS (string VARCHAR, int_1 INT);\n\n-- \u5efa\u8868\nCREATE TYPE map_test (id INT, VALUE map);\n</code></pre> <p>\u53ef\u4ee5\u770b\u5230\u521b\u5efa\u7684\u8868\u5728 <code>pg_class</code> \u4e2d\u5b58\u50a8\u7684\u5c5e\u6027\u4fe1\u606f\u6709\u4e24\u4e2a\uff0c\u4e00\u4e2a\u662f\u7c7b\u578b<code>map</code>\u7684\u5c5e\u6027\u4fe1\u606f\uff0c \u4e00\u4e2a\u662f\u8868<code>map_test</code>\u7684\u5c5e\u6027\u4fe1\u606f\u3002</p> <pre><code>-- \u590d\u5408\u7c7b\u578b map \u7684\u5c5e\u6027\u4fe1\u606f\nSELECT oid,relname,relnamespace,reltype,relam,relfilenode,relpersistence,relkind,relnatts FROM pg_class WHERE relname='map';\n  oid  | relname | relnamespace | reltype | relam | relfilenode | relpersistence | relkind | relnatts\n-------+---------+--------------+---------+-------+-------------+----------------+---------+----------\n 16388 | map     |         2200 |   16390 |     0 |           0 | p              | c       |        2\n(1 row)\n\n--  \u8868map_test\u7684\u5c5e\u6027\u4fe1\u606f\nSELECT oid,relname,relnamespace,reltype,relam,relfilenode,relpersistence,relkind,relnatts FROM pg_class WHERE relname='map_test';\n  oid  | relname  | relnamespace | reltype | relam | relfilenode | relpersistence | relkind | relnatts\n-------+----------+--------------+---------+-------+-------------+----------------+---------+----------\n 16391 | map_test |         2200 |   16393 |     2 |       16391 | p              | r       |        2\n(1 row)\n</code></pre> <p>pg_attribute</p> <p>src/include/catalog/pg_attribute.h</p> <p>\u8be5\u7cfb\u7edf\u8868\u5b58\u50a8\u6240\u6709\u8868(\u5305\u62ec\u7cfb\u7edf\u8868\uff0c\u5982 pg_class)\u7684\u5b57\u6bb5\u4fe1\u606f\u3002\u6570\u636e\u5e93\u4e2d\u7684\u6bcf\u4e2a\u8868\u7684\u6bcf\u4e2a\u5b57\u6bb5\u5728 pg_attribute \u8868\u4e2d\u90fd\u6709\u4e00\u884c\u8bb0\u5f55(\u5b57\u6bb5\u540d\uff0c\u6570\u636e\u7c7b\u578b\uff0c\u9ed8\u8ba4\u503c\uff0c\u975e NULL \u7ea6\u675f)\u7b49\u7b49\u3002</p> <p>pg_type</p> <p>\u8be5\u7cfb\u7edf\u8868\u7528\u4e8e\u8bb0\u5f55\u7ba1\u7406\u6240\u6709\u7684\u7c7b\u578b\u5b9a\u4e49\uff0c\u6bd4\u5982\u4e0a\u9762\u7684 <code>create table map_test (id int, value map);</code> \u5efa\u8868\u8fc7\u7a0b\u4e2d\u7528\u5230\u7684\u7c7b\u578b <code>int</code> \u4ee5\u53ca \u590d\u5408\u7c7b\u578b <code>map</code> \u90fd\u4f1a\u88ab\u5b58\u50a8\u5230 <code>pg_type</code> \u4e2d\uff0c\u800c\u5217\u540d\u5b57 <code>id</code> \u4ee5\u53ca <code>value</code> \u5219\u4f1a\u88ab\u5b58\u50a8\u5230\u7684 <code>pg_attribute</code> \u7cfb\u7edf\u8868\u4e2d\u3002</p> <p>pg_class</p> <p>PG \u901a\u8fc7 <code>pg_class</code> \u7684\u5bf9\u8c61\u5c5e\u6027\u63cf\u8ff0\u7684\u7cfb\u7edf\u8868\uff0c\u540c <code>pg_type</code> \u548c <code>pg_attribute</code> \u4e24\u79cd\u5bf9\u5217\u5c5e\u6027\u63cf\u8ff0\u7684\u7cfb\u7edf\u8868\uff0c\u5171\u540c\u6784\u9020\u4e00\u4e2a\u57fa\u672c\u8868\u7684\u5217\u4fe1\u606f\u3002</p> <p>\u6bcf\u4e2a\u8868\u548c\u7d22\u5f15\u90fd\u5b58\u50a8\u5728\u72ec\u7acb\u7684\u6587\u4ef6\u91cc\u3002\u5bf9\u4e8e\u666e\u901a\u5173\u7cfb\uff0c\u8fd9\u4e9b\u6587\u4ef6\u4ee5\u8868\u6216\u7d22\u5f15\u7684*filenode*\u53f7\u547d\u540d\uff0c\u5b83\u53ef\u4ee5\u5728<code>pg_class</code>.<code>relfilenode</code>\u4e2d\u627e\u5230</p> <p>\u6bcf\u4e2a\u5c0f\u4e8e 1GB \u7684\u8868\u6216\u7d22\u5f15\u90fd\u5728\u76f8\u5e94\u7684\u6570\u636e\u5e93\u76ee\u5f55\u4e2d\u5b58\u50a8\u4e3a\u5355\u4e2a\u6587\u4ef6\u3002</p> <p>\u5728\u8868\u6216\u8005\u7d22\u5f15\u8d85\u8fc7 1GB \u4e4b\u540e\uff0c\u5b83\u5c31\u88ab\u5212\u5206\u6210 1G \u5927\u5c0f\u7684\u6bb5\u3002\u7b2c\u4e00\u4e2a\u6bb5\u7684\u6587\u4ef6\u540d\u548c\u6587\u4ef6\u8282\u70b9\u76f8\u540c\uff1b\u968f\u540e\u7684\u6bb5\u88ab\u547d\u540d\u4e3a filenode.1\u3001filenode.2 \u7b49\u7b49\u3002</p> <p>\u8fd9\u6837\u907f\u514d\u5728\u67d0\u4e9b\u6709\u5355\u6587\u4ef6\u5927\u5c0f\u9650\u5236\u7684\u5e73\u53f0\u4e0a\u7684\u95ee\u9898\uff08\u5b9e\u9645\u4e0a\uff0c1GB \u53ea\u662f\u9ed8\u8ba4\u7684\u6587\u4ef6\u5c3a\u5bf8\u3002\u53ef\u4ee5\u5728\u7f16\u8bd1 PostgreSQL \u65f6\u4f7f\u7528\u914d\u7f6e\u9009\u9879<code>--with-segsize</code>\u8fdb\u884c\u8c03\u6574\uff09\u3002</p> <p>\u5728\u6570\u636e\u5e93\u5185\u90e8\uff0c\u8868\u548c\u7d22\u5f15\u4f5c\u4e3a\u6570\u636e\u5e93\u5bf9\u8c61\u662f\u901a\u8fc7 OID \u6765\u7ba1\u7406\u7684\uff0c\u800c\u8fd9\u4e9b\u6570\u636e\u6587\u4ef6\u5219\u7531\u53d8\u91cf<code>relfilenode</code>\u7ba1\u7406\u3002 \u8868\u548c\u7d22\u5f15\u7684<code>relfilenode</code>\u503c\u901a\u5e38\u4e0e\u5176 OID \u4e00\u81f4\u3002</p> <p>\u6bcf\u4e00\u5f20\u8868\u7684\u6570\u636e\uff08\u5927\u90e8\u5206\uff09\u53c8\u662f\u653e\u5728 $PGDATA/base/{dboid}/{relfilenode} \u8fd9\u4e2a\u6587\u4ef6\u91cc\u9762\uff0crelfilenode \u4e00\u822c\u60c5\u51b5\u4e0b\u548c\u548c tboid \u4e00\u81f4\uff0c\u4f46\u6709\u4e9b\u60c5\u51b5\u4e0b\u4e5f\u4f1a\u53d8\u5316\u3002</p> <p>\u6bcf\u4e00\u5f20\u8868\u7684\u6570\u636e\uff08\u5927\u90e8\u5206\uff09\u53c8\u662f\u653e\u5728 $PGDATA/base/{dboid}/{relfilenode} \u8fd9\u4e2a\u6587\u4ef6\u91cc\u9762\uff0crelfilenode \u4e00\u822c\u60c5\u51b5\u4e0b\u548c\u548c tboid \u4e00\u81f4\uff0c\u4f46\u6709\u4e9b\u60c5\u51b5\u4e0b\u4e5f\u4f1a\u53d8\u5316\uff0c\u5982 TRUNCATE\u3001REINDEX\u3001CLUSTER \u4ee5\u53ca\u67d0\u4e9b\u5f62\u5f0f\u7684 ALTER TABLE\u3002</p>"},{"location":"postgresql/03.%E4%BD%93%E7%B3%BB%E6%9E%B6%E6%9E%84/#_6","title":"\u5806\u8868\u6587\u4ef6\u5e03\u5c40","text":"<p>\u6570\u636e\u5b58\u50a8\u6ca1\u6709\u4efb\u4f55\u987a\u5e8f\uff0c\u9700\u8981\u501f\u52a9\u7d22\u5f15\u9875\u6765\u63d0\u5347\u67e5\u8be2\u6570\u636e\u6027\u80fd\u3002</p> <p>\u5806\u8868\uff08heap\uff09\u662f <code>PostgreSQL</code> \u6240\u9ed8\u8ba4\u4f7f\u7528\u7684\u6570\u636e\u7ec4\u7ec7\u65b9\u5f0f\uff0c\u8fd9\uf9e9\u7684\u5806\u65e2\uf967\u662f\u6307\u6570\u636e\u7ed3\u6784\u4e2d\u7684\u4e8c\u53c9\u5806\uff0c\u4e5f\uf967\u662f\u865a\u62df\u5185\u5b58\u4e2d\u7684\u5806\u5185\u5b58\uff0c\u4e2a\u4eba\uf9e4\u89e3\u8fd9\uf9e9\u5e94\u8be5\u8868\u793a\u7684\u662f\"\u5806\u53e0\"\u4e4b\u610f: \u5373\u6570\u636e\u7684\u5b58\u653e\u662f\u65e0\u5e8f\u7684\u3002</p> <p>Oracle \u4f5c\u4e3a\u4e00\u6b3e\u6210\u719f\u7684\u6570\u636e\u5e93\u8f6f\u4ef6\u4ea7\u54c1\uff0c\u5c31\u63d0\u4f9b\u4e86\u591a\u79cd\u6570\u636e\u8868\u5b58\u50a8\u7ed3\u6784\u3002\u6211\u4eec\u6700\u5e38\u89c1\u7684\u5c31\u662f\u4e09\u79cd\uff0c\u5206\u522b\u4e3a\u5806\u8868\uff08Heap Table\uff09\u3001\u7d22\u5f15\u7ec4\u7ec7\u8868\uff08Index Organization Table\uff0c\u7b80\u79f0\u4e3a IOT\uff09\u548c\u805a\u7c07\u8868\uff08Cluster Table\uff09\u3002Oracle\u3001Microsoft SQL Server \u540e\u671f\u4e5f\u63a8\u51fa\u4e86\u652f\u6301\u7d22\u5f15\u7ec4\u7ec7\u8868\u7684\u5b58\u50a8\u65b9\u5f0f\u3002</p> <p>Oracle \u4f7f\u7528 B-\u6811\u7d22\u5f15\u7ed3\u6784\u5b58\u50a8\u7ecf\u4e3b\u952e\u6392\u5e8f\u8fc7\u7684\u6570\u636e\u3002\u5728\u66f4\u65b0 IOT \u65f6\uff0c\u5b9e\u9645\u66f4\u65b0\u7684\u662f\u7d22\u5f15\u7ed3\u6784\u3002\u7531\u4e8e\u8bbf\u95ee\u7d22\u5f15/\u8868\u53ea\u9700\u4e00\u4e2a I/O,\u56e0\u6b64\u6570\u636e\u8bbf\u95ee\u76f8\u5f53\u5feb\u3002</p> <pre><code>--\n-- Oracle\u9ed8\u8ba4\u7684\u8868\u5b58\u50a8\u7ed3\u6784\u4e5f\u662f\u5806\u8868\uff0c\u4f46\u662fOracle\u4e5f\u652f\u6301\u652f\u6301\u521b\u5efa\u7d22\u5f15\u7ec4\u7ec7\u8868\nCREATE TABLE employee\n(\n    employee_id NUMBER,\n    dept_id NUMBER,\n    name VARCHAR2(30),\n    address VARCHAR2(120),\n    ONSTRAINT pk_employee PRIMARY KEY(employee_id)\n)\nORGANIZATION INDEX TABLESPACE empindex_01\nPCTTHRESHOLD 25\nOVERFLOW TABLESPACE overflow_tables;\n\n-- PCTTHRESHOLD\u5173\u952e\u5b57\u8bf4\u660e\u5728\u7d22\u5f15\u5757\u4e2d\u4e3aemployee_new IOT\u9884\u7559\u7684\u7a7a\u95f4\u767e\u5206\u6bd4\u3002\u8868\u884c\u4e2d\u8d85\u51fa\u6bcf\u4e2a\u6570\u636e\u5757\u4e2d\u768425%\u6781\u9650\u7684\u4efb\u4f55\u90e8\u5206\u90fd\u5c06\u4fdd\u5b58\u5728\u6ea2\u51fa\u533a\u3002\n-- CREATE TABLE\u8bed\u53e5\u5c06\u5206\u914doverflow_teble\u8868\u7a7a\u95f4\u4ee5\u4fdd\u5b58\u7d22\u5f15\u5757\u4e2d\u7684\u6ea2\u51fa\u6570\u636e\u3002\u4f60\u53ef\u4ee5\u8bbe\u7f6e\u6781\u9650\u503c\u4ee5\u9002\u5e94\u952e\u5217\u548c\u7ecf\u5e38\u8bbf\u95ee\u7684\u51e0\u4e2a\u975e\u952e\u5217\u3002\n</code></pre>"},{"location":"postgresql/03.%E4%BD%93%E7%B3%BB%E6%9E%B6%E6%9E%84/#_7","title":"\u9875","text":"<p>\u5728\u6570\u636e\u6587\u4ef6\uff08\u5806\u8868\uff0c\u7d22\u5f15\uff0c\u4e5f\u5305\u62ec\u7a7a\u95f2\u7a7a\u95f4\u6620\u5c04\u548c\u53ef\u89c1\u6027\u6620\u5c04\uff09\u5185\u90e8\uff0c\u5b83\u88ab\u5212\u5206\u4e3a\u56fa\u5b9a\u957f\u5ea6\u7684\u9875\uff08pages\uff09\uff0c\u6216\u6309\u7167\u5b98\u7f51\u6765\u8bf4\uff0c\u53eb\u533a\u5757\uff08blocks\uff09\uff0c\u5927\u5c0f\u9ed8\u8ba4\u4e3a 8192 \u5b57\u8282\uff088KB\uff09\u3002</p> <p>\u6bcf\u4e2a\u6587\u4ef6\u4e2d\u7684\u9875\u4ece 0 \u5f00\u59cb\u6309\u987a\u5e8f\u7f16\u53f7\uff0c\u8fd9\u4e9b\u6570\u5b57\u79f0\u4e3a\u533a\u5757\u53f7\uff08block numbers\uff09\u3002\u5982\u679c\u6587\u4ef6\u5df2\u586b\u6ee1\uff0cPostgreSQL \u901a\u8fc7\u5728\u6587\u4ef6\u672b\u5c3e\u8ffd\u52a0\u4e00\u4e2a\u65b0\u7684\u7a7a\u9875\u6765\u589e\u957f\u6587\u4ef6\u3002</p> <p>\u4e0a\u56fe\u793a\u4f8b\u63cf\u8ff0\u4e00\u4e2a\u6570\u636e\u6587\u4ef6\u7684\u5185\u90e8\u7ed3\u6784\uff0c\u4ece\u56fe\u4e2d\u53ef\u4ee5\u770b\u51fa\uff0c\u4e00\u4e2a\u8868\u6587\u4ef6\u5185\u90e8\u7531\u4ece 0 \u81f3 N \u7f16\u53f7\u7684\u9875\u9762\u6784\u6210\uff0c\u6bcf\u4e2a\u9875\u4e3a 8KB\u3002\u53f3\u8fb9\u5219\u662f\u6bcf\u4e2a\u9875\u9762\u7684\u5185\u90e8\u6784\u6210\u3002\u6bcf\u4e2a\u9875\u9762\u5305\u62ec\u4ee5\u4e0b\u5185\u5bb9\uff1a</p> <p>heap tuples -\u5373 heap \u8868\u4e2d\u7684\u6570\u636e\u8bb0\u5f55\u3002\u8fd9\u4e9b\u8bb0\u5f55\u662f\u4ece\u9875\u9762\u7684\u5e95\u7aef\u5411\u4e0a\u5b58\u653e\u7684\u3002\u6bcf\u4e2a tuple \u5185\u90e8\u7684\u7ed3\u6784\u6211\u4eec\u5355\u72ec\u518d\u63cf\u8ff0\u3002 line pointers -\u6bcf\u4e2a line pointer \u7531 4 \u4e2a\u5b57\u8282\u8868\u793a\uff0c\u662f\u4e00\u4e2a\u6307\u5411\u5177\u4f53\u67d0\u4e00\u6761 heap tuple \u7684\u6307\u9488\uff0c\u4e5f\u88ab\u79f0\u4e3a item pointer\u3002Line pointers \u7ec4\u6210\u4e00\u4e2a\u7b80\u5355\u7684\u6570\u7ec4\uff0c\u8d1f\u8d23\u7d22\u5f15\u5230\u5bf9\u5e94\u8bb0\u5f55\u3002\u6bcf\u4e2a line pointer \u5728 block \u5185\u662f\u4ece 1 \u5f00\u59cb\u8fdb\u884c\u7f16\u53f7\uff0c\u4e5f\u88ab\u79f0\u4e3a\u504f\u79fb\u53f7(offset number)\u3002\u5f53\u4e00\u4e2a\u65b0\u7684\u8bb0\u5f55\u88ab\u6dfb\u52a0\u5230\u9875\u9762\u65f6\uff0c\u5c31\u4f1a\u589e\u52a0\u4e00\u4e2a\u65b0\u7684 line pointer \u4e0e\u4e4b\u5bf9\u5e94\u3002 header data -\u5373\u9875\u9762\u7684\u5934\u4fe1\u606f\uff0c\u653e\u5728\u9875\u9762\u7684\u5f00\u59cb\u90e8\u5206\u3002\u7531 24 \u5b57\u8282\u8868\u793a\uff0c\u5176\u4e2d\u5305\u542b\u4e00\u4e9b\u9875\u9762\u63cf\u8ff0\u7684\u901a\u7528\u4fe1\u606f\u3002\u4e3b\u8981\u7684\u5185\u5bb9\u6709\uff1a \uff081\uff09pd_lsn -\u4fdd\u5b58\u9875\u9762\u4e0a\u6b21\u4fee\u6539\u751f\u6210\u7684 XLOG \u7684 LSN \u4fe1\u606f\u30028 \u5b57\u8282\u7684\u65e0\u7b26\u53f7\u6574\u6570\uff0c\u4e0e WAL \u673a\u5236\u6709\u5173\u3002 \uff082\uff09pd_checksum -\u4fdd\u5b58\u9875\u9762\u7684 checksum \u503c\uff089.3 \u53ca\u4e4b\u540e\u7248\u672c\uff09\u3002 \uff083\uff09pd_lower\uff0cpg_upper -pd_lower \u6307\u5411 line pointers \u7684\u672b\u5c3e\u4f4d\u7f6e\uff0cpd_upper \u6307\u5411\u6700\u65b0\u7684 heap tuple \u4f4d\u7f6e\u3002 \uff084\uff09pd_special -\u7528\u4e8e\u7d22\u5f15\u3002\u5982\u679c\u6b64\u9875\u9762\u662f\u8868\u9875\u9762\uff0c\u6307\u5411\u9875\u9762\u7684\u672b\u5c3e\u3002\u5982\u679c\u6b64\u9875\u9762\u662f\u7d22\u5f15\u9875\u9762\uff0c\u6307\u5411\u7279\u6b8a\u7a7a\u95f4\u7684\u5f00\u59cb\uff08\u6b64\u7a7a\u95f4\u6839\u636e\u7d22\u5f15\u7684\u7c7b\u578b\u662f BTree\u3001GiST \u8fd8\u662f GIN \u4fdd\u5b58\u7279\u5b9a\u7684\u6570\u636e\uff09\u3002 \u5728 line pointers \u7ed3\u5c3e\u5230\u6700\u65b0 tuple \u5f00\u59cb\u4e4b\u95f4\u7684\u7a7a\u95f4\u4ee3\u8868\u7a7a\u95f2\u7a7a\u95f4\u6216\u7a7a\u6d1e\u3002 \u4e3a\u4e86\u786e\u5b9a\u8868\u4e2d\u67d0\u4e00\u4e2a tuple \u7684\u4f4d\u7f6e\uff0cPG \u5185\u90e8\u4f7f\u7528 tuple identifier\uff08TID\uff09 \u3002TID \u7531\u4e00\u7ec4\u503c\u6784\u6210\uff1a\u5305\u62ec\u8fd9\u4e2a tuple \u9875\u9762\u7684\u9875\u7f16\u53f7 block number\uff0c\u4ee5\u53ca\u6307\u5411\u8fd9\u4e2a tuple \u7684\u5177\u4f53\u7684\u504f\u79fb\u53f7 offset number\u3002\u5373 TID=block number + offset number\u3002</p>"},{"location":"postgresql/03.%E4%BD%93%E7%B3%BB%E6%9E%B6%E6%9E%84/#_8","title":"\u6bb5","text":""},{"location":"postgresql/03.%E4%BD%93%E7%B3%BB%E6%9E%B6%E6%9E%84/#toast","title":"TOAST \u6280\u672f","text":"<p>\u5728 PG \u4e2d\uff0c\u9875\u662f\u6570\u636e\u5728\u6587\u4ef6\u5b58\u50a8\u4e2d\u7684\u57fa\u672c\u5355\u4f4d\uff0c\u5176\u5927\u5c0f\u662f\u56fa\u5b9a\u7684\u4e14\u53ea\u80fd\u5728\u7f16\u8bd1\u671f\u6307\u5b9a\uff0c\u4e4b\u540e\u65e0\u6cd5\u4fee\u6539\uff0c\u9ed8\u8ba4\u7684\u5927\u5c0f\u4e3a 8 KB \u3002</p> <p>\u540c\u65f6\uff0cPG \u4e0d\u5141\u8bb8\u4e00\u884c\u6570\u636e\u8de8\u9875\u5b58\u50a8\uff0c\u90a3\u4e48\u5bf9\u4e8e\u8d85\u957f\u7684\u884c\u6570\u636e\u548c\u5927\u5bbd\u8868\uff0cPG \u5c31\u4f1a\u542f\u52a8 TOAST \uff0c\u5177\u4f53\u5c31\u662f\u91c7\u7528\u538b\u7f29\u548c\u5207\u7247\u7684\u65b9\u5f0f\u3002</p> <p>\u8fd9\u4e2a\u673a\u5236\u5bf9\u7528\u6237\u90fd\u662f\u900f\u660e\u7684\uff0c\u53ea\u662f\u5728\u5927\u90e8\u5206\u7684\u540e\u7aef\u4ee3\u7801\u4e0a\u6709\u4e00\u4e9b\u5c0f\u7684\u5f71\u54cd\u3002\u8fd9\u4e2a\u6280\u672f\u7684\u6635\u79f0\u662f TOAST\uff08\u6216\u8005\u201c\u5207\u7247\u9762\u5305\u4e4b\u540e\u7684\u6700\u597d\u7684\u4e1c\u897f\u201d\uff09\u3002TOAST \u673a\u5236\u4e5f\u88ab\u7528\u6765\u63d0\u5347\u5185\u5b58\u4e2d\u5927\u578b\u6570\u636e\u503c\u7684\u5904\u7406\u3002</p> <p>\u5982\u679c\u542f\u7528\u4e86\u5207\u7247\uff0c\u5b9e\u9645\u6570\u636e\u5b58\u50a8\u5728\u53e6\u4e00\u5f20\u7cfb\u7edf\u8868\u7684\u591a\u4e2a\u884c\u4e2d\uff0c\u8fd9\u5f20\u8868\u5c31\u53eb TOAST \u8868\uff0c\u8fd9\u79cd\u5b58\u50a8\u65b9\u5f0f\u53eb\u884c\u5916\u5b58\u50a8\u3002</p> <p>\u5728 PG \u4e2d\u6bcf\u4e2a\u8868\u5b57\u6bb5\u6709\u56db\u79cd TOAST \u7684\u7b56\u7565\uff1a</p> <ul> <li>PLAIN \uff1a\u907f\u514d\u538b\u7f29\u548c\u884c\u5916\u5b58\u50a8\u3002\u53ea\u6709\u90a3\u4e9b\u4e0d\u9700\u8981 TOAST \u7b56\u7565\u5c31\u80fd\u5b58\u653e\u7684\u6570\u636e\u7c7b\u578b\u5141\u8bb8\u9009\u62e9\uff08\u4f8b\u5982 int \u7c7b\u578b\uff09\uff0c\u800c\u5bf9\u4e8e text \u8fd9\u7c7b\u8981\u6c42\u5b58\u50a8\u957f\u5ea6\u8d85\u8fc7\u9875\u5927\u5c0f\u7684\u7c7b\u578b\uff0c\u662f\u4e0d\u5141\u8bb8\u91c7\u7528\u6b64\u7b56\u7565\u7684</li> <li>EXTENDED \uff1a\u5141\u8bb8\u538b\u7f29\u548c\u884c\u5916\u5b58\u50a8\u3002\u4e00\u822c\u4f1a\u5148\u538b\u7f29\uff0c\u5982\u679c\u8fd8\u662f\u592a\u5927\uff0c\u5c31\u4f1a\u884c\u5916\u5b58\u50a8</li> <li>EXTERNA \uff1a\u5141\u8bb8\u884c\u5916\u5b58\u50a8\uff0c\u4f46\u4e0d\u8bb8\u538b\u7f29\u3002\u7c7b\u4f3c\u5b57\u7b26\u4e32\u8fd9\u79cd\u4f1a\u5bf9\u6570\u636e\u7684\u4e00\u90e8\u5206\u8fdb\u884c\u64cd\u4f5c\u7684\u5b57\u6bb5\uff0c\u91c7\u7528\u6b64\u7b56\u7565\u53ef\u80fd\u83b7\u5f97\u66f4\u9ad8\u7684\u6027\u80fd\uff0c\u56e0\u4e3a\u4e0d\u9700\u8981\u8bfb\u53d6\u51fa\u6574\u884c\u6570\u636e\u518d\u89e3\u538b\u3002</li> <li>MAIN \uff1a\u5141\u8bb8\u538b\u7f29\uff0c\u4f46\u4e0d\u8bb8\u884c\u5916\u5b58\u50a8\u3002\u4e0d\u8fc7\u5b9e\u9645\u4e0a\uff0c\u4e3a\u4e86\u4fdd\u8bc1\u8fc7\u5927\u6570\u636e\u7684\u5b58\u50a8\uff0c\u884c\u5916\u5b58\u50a8\u5728\u5176\u5b83\u65b9\u5f0f\uff08\u4f8b\u5982\u538b\u7f29\uff09\u90fd\u65e0\u6cd5\u6ee1\u8db3\u9700\u6c42\u7684\u60c5\u51b5\u4e0b\uff0c\u4f5c\u4e3a\u6700\u540e\u624b\u6bb5\u8fd8\u662f\u4f1a\u88ab\u542f\u52a8\u3002\u56e0\u6b64\u7406\u89e3\u4e3a\uff1a\u5c3d\u91cf\u4e0d\u4f7f\u7528\u884c\u5916\u5b58\u50a8\u66f4\u8d34\u5207\u3002</li> </ul> <p>\u53ef\u4ee5\u81ea\u5df1\u5b9a\u4e49\u7528\u54ea\u79cd\u7b56\u7565</p> <pre><code>ALTER TABLE \u8868\u540d ALTER COLUMN \u5217\u540d SET STORAGE external;\n</code></pre>"},{"location":"postgresql/03.%E4%BD%93%E7%B3%BB%E6%9E%B6%E6%9E%84/#postgres","title":"postgres \u8fdb\u7a0b\u6a21\u578b","text":"<p>postgres \u6570\u636e\u5e93\u662f\u4e00\u4e2a\u591a\u8fdb\u7a0b\u67b6\u6784\uff0c\u91c7\u7528\u5178\u578b\u7684\u670d\u52a1\u7aef\u2013\u5ba2\u6237\u7aef\u98ce\u683c\u7684\u5173\u7cfb\u578b\u6570\u636e\u5e93\uff0c\u8fdb\u7a0b\u95f4\u901a\u8fc7<code>\u5171\u4eab\u5185\u5b58</code>\u8fdb\u884c\u901a\u4fe1\u3002</p> <p>\u5171\u4eab\u5185\u5b58\u7684\u673a\u5236\uff0c\u5c31\u662f\u62ff\u51fa\u4e00\u5757\u865a\u62df\u5730\u5740\u7a7a\u95f4\u6765\uff0c\u6620\u5c04\u5230\u76f8\u540c\u7684\u7269\u7406\u5185\u5b58\u4e2d\u3002\u8fd9\u6837\u8fd9\u4e2a\u8fdb\u7a0b\u5199\u5165\u7684\u4e1c\u897f\uff0c\u53e6\u5916\u4e00\u4e2a\u8fdb\u7a0b\u9a6c\u4e0a\u5c31\u80fd\u770b\u5230\u4e86\uff0c\u90fd\u4e0d\u9700\u8981\u62f7\u8d1d\u6765\u62f7\u8d1d\u53bb\uff0c\u4f20\u6765\u4f20\u53bb\uff0c\u5927\u5927\u63d0\u9ad8\u4e86\u8fdb\u7a0b\u95f4\u901a\u4fe1\u7684\u901f\u5ea6\u3002\u6240\u4ee5\u5171\u4eab\u5185\u5b58\u53ef\u4ee5\u8bf4\u662f\u6700\u6709\u6548\u7684\u8fdb\u7a0b\u95f4\u901a\u4fe1\u65b9\u5f0f\uff0c\u4e5f\u662f\u6700\u5feb\u7684 IPC \u5f62\u5f0f\u3002</p> <p>\u5047\u8bbe\u6709\u4e24\u4e2a\u4e0d\u540c\u8fdb\u7a0b A\u3001B\uff0c\u90a3\u4e48\u4f1a\u6709\u540c\u4e00\u5757\u7269\u7406\u5185\u5b58\u88ab\u6620\u5c04\u5230\u8fdb\u7a0b A\u3001B \u5404\u81ea\u7684\u8fdb\u7a0b\u5730\u5740\u7a7a\u95f4\u3002\u8fdb\u7a0b A \u53ef\u4ee5\u5373\u65f6\u770b\u5230\u8fdb\u7a0b B \u5bf9\u5171\u4eab\u5185\u5b58\u4e2d\u6570\u636e\u7684\u66f4\u65b0\uff0c\u53cd\u4e4b\u4ea6\u7136\u3002</p> <p>\u5728\u6570\u636e\u5e93\u672f\u8bed\u4e2d\uff0cPostgreSQL \u4f7f\u7528 C/S \u67b6\u6784\u3002\u4e00\u6b21 PostgreSQL \u4f1a\u8bdd\u7531\u4e0b\u5217\u76f8\u5173\u7684\u8fdb\u7a0b\uff08\u7a0b\u5e8f\uff09\u7ec4\u6210\uff1a</p> <ul> <li> <p>\u670d\u52a1\u7aef\u8fdb\u7a0b\uff1a\u4e00\u4e2a\u670d\u52a1\u5668\u8fdb\u7a0b\uff0c\u5b83\u7ba1\u7406\u6570\u636e\u5e93\u6587\u4ef6\u3001\u63a5\u53d7\u6765\u81ea\u5ba2\u6237\u7aef\u4e0e\u6570\u636e\u5e93\u7684\u8fde\u63a5\u3002\u5e76\u4e14\u4ee3\u8868\u5ba2\u6237\u7aef\u5728\u6570\u636e\u5e93\u4e0a\u6267\u884c\u64cd\u4f5c\u3002\u8be5\u6570\u636e\u5e93\u670d\u52a1\u5668\u7a0b\u5e8f\u53eb\u505a postgres\u3002   postgres \u4e00\u822c\u4f4d\u4e8e /usr/lib/postgresql/13/bin/</p> </li> <li> <p>\u5ba2\u6237\u7aef\u8fdb\u7a0b\uff1a\u5178\u578b\u7684 C/S \u67b6\u6784\uff0c\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u5668\u53ef\u4ee5\u5728\u4e0d\u540c\u7684\u4e3b\u673a\u4e0a\u3002\u8fd9\u65f6\u5b83\u4eec\u901a\u8fc7 TCP/IP \u7f51\u7edc\u8054\u63a5\u901a\u8baf\u3002</p> </li> </ul> <pre><code>[postgres@stxz-elk-01 src]$\n[postgres@stxz-elk-01 src]$ ps -ef | grep postgres | grep -v grep\npostgres  9849     1  0 10:41 ?        00:00:00 /data/postgres/14.4/bin/postgres -D /home/postgres/data\npostgres  9850  9849  0 10:02 ?        00:00:00 postgres: logger\npostgres  9876  9849  0 10:42 ?        00:00:00 postgres: checkpointer\npostgres  9878  9849  0 10:42 ?        00:00:00 postgres: background writer\npostgres  9879  9849  0 10:42 ?        00:00:00 postgres: walwriter\npostgres  9880  9849  0 10:42 ?        00:00:00 postgres: autovacuum launcher\npostgres  9881  9849  0 10:42 ?        00:00:01 postgres: stats collector\npostgres  9882  9849  0 10:42 ?        00:00:00 postgres: logical replication launcher\npostgres 18247  9849  0 17:22 ?        00:00:00 postgres: postgres dbtt 10.10.30.205(4008) idle\npostgres 18268  9849  0 17:22 ?        00:00:00 postgres: postgres dbtt 10.10.30.205(4009) idle\npostgres 18995  9849  0 11:08 ?        00:00:00 postgres: postgres dbtt 10.10.30.205(12899) idle\npostgres 30539  9849  0 11:42 ?        00:00:00 postgres: postgres postgres 10.10.30.205(12998) idle\n[postgres@stxz-elk-01 src]$\n[postgres@stxz-elk-01 src]$\n</code></pre> <p>\u5728\u670d\u52a1\u7aef\u7528\u4f5c\u7ba1\u7406\u4e00\u4e2a\u6570\u636e\u5e93\u5b9e\u4f8b\u7684\u591a\u4e2a\u8fdb\u7a0b\u7684\u96c6\u5408\u79f0\u4e3a<code>PostgreSQL Server</code>\uff0c\u5b83\u4e3b\u8981\u5305\u542b\u4ee5\u4e0b 3 \u79cd\u7c7b\u578b\u7684\u8fdb\u7a0b\uff1a</p> <ul> <li> <p><code>postgres server process</code>\uff1aPostgres \u670d\u52a1\u5668\u8fdb\u7a0b\uff0c\u5373\u5b88\u62a4\u8fdb\u7a0b\uff0c\u662f\u6570\u636e\u5e93\u96c6\u7fa4\u7ba1\u7406\u7684\u6240\u6709\u8fdb\u7a0b\u7684\u7236\u8fdb\u7a0b\u3002</p> </li> <li> <p><code>backend processes</code>\uff1a\u540e\u7aef\u8fdb\u7a0b\uff0c\u6bcf\u4e2a\u540e\u7aef\u8fdb\u7a0b\u5904\u7406\u8fde\u63a5\u8fdb\u6765\u7684\u5ba2\u6237\u7aef\u53d1\u51fa\u7684\u6240\u6709\u67e5\u8be2\u548c\u8bed\u53e5\u3002</p> </li> <li> <p><code>backgroud processes</code>\uff1a\u540e\u53f0\u8fdb\u7a0b\uff0c\u6bcf\u4e2a\u540e\u53f0\u8fdb\u7a0b\u5206\u522b\u6267\u884c\u76f8\u5e94\u7684\u529f\u80fd\uff08\u4f8b\u5982 VACUUM \u548c CHECKPOINT \u8fdb\u7a0b\uff09\u4ee5\u8fdb\u884c\u6570\u636e\u5e93\u7ba1\u7406\u3002</p> </li> </ul>"},{"location":"postgresql/03.%E4%BD%93%E7%B3%BB%E6%9E%B6%E6%9E%84/#postmaker","title":"\u4e3b\u8fdb\u7a0b\u548c postmaker \u8fdb\u7a0b","text":"<p>postmaker</p> <p>\u5982\u679c\u662f\u5728 centos7+\u4e0b\u4f7f\u7528 yum \u5b89\u88c5\u7684 postgresql\uff0c\u90a3\u4e48 postgresql \u7684\u670d\u52a1\u542f\u505c\u4f1a\u6258\u7ba1\u7ed9 systemctl\uff0c\u6211\u4eec\u5728/usr/lib/systemd/system/postgresql-11.service \u6587\u4ef6\u4e2d\u5c31\u53ef\u4ee5\u770b\u5230\u914d\u7f6e\u7684 ExecStart</p> <p>\u5b9e\u9645\u4e0a\uff0cpostmaster \u547d\u4ee4\u53ea\u662f postgres \u547d\u4ee4\u7684\u4e00\u4e2a\u8f6f\u94fe\u63a5\uff0c\u53ef\u4ee5\u770b\u5230 postmaster \u7684\u76ee\u6807\u547d\u4ee4\u662f postgres\u3002</p> <p>\u5982\u679c\u662f\u7528 pd_ctl -D $PGDATA -l $PGLOGFILE start \u542f\u52a8\u7684\uff0c\u5219\u76f4\u63a5\u542f\u52a8 postgresql \u4e3b\u8fdb\u7a0b\u3002</p> <p>\u771f\u6b63\u7684\u4e3b\u8fdb\u7a0b\u4e5f\u5c31\u662f postgres \u8fdb\u7a0b(\u53ef\u6267\u884c\u6587\u4ef6\u4e3a./bin/postgres)\uff0c\u5b83\u76d1\u542c\u4e86 5432 \u7aef\u53e3\uff0c\u7528\u4e8e\u76d1\u542c\u8fde\u63a5\u3002\u4f46\u662f\u771f\u6b63\u5904\u7406\u8fde\u63a5\u7684\u5e76\u4e0d\u662f\u8fd9\u4e2a\u8fdb\u7a0b\u3002</p>"},{"location":"postgresql/03.%E4%BD%93%E7%B3%BB%E6%9E%B6%E6%9E%84/#backend-processes","title":"\u8fde\u63a5\u8fdb\u7a0b backend processes","text":"<p>postgresql \u670d\u52a1\u5668\u53ef\u4ee5\u5904\u7406\u6765\u81ea\u591a\u4e2a\u5ba2\u6237\u7aef\u7684\u591a\u4e2a\u5e76\u53d1\u8bf7\u6c42\u3002 \u56e0\u6b64\uff0c\u5b83\u4e3a\u6bcf\u4e2a\u5ba2\u6237\u7aef\u7684\u8fde\u63a5\u90fd\u4f1a fork \u4e00\u4e2a\u65b0\u8fdb\u7a0b(\u5229\u7528./bin/postgres \u53ef\u6267\u884c\u6587\u4ef6)\u3002\u56e0\u4e3a\u4e00\u6761\u8fde\u63a5\u53ea\u5141\u8bb8\u64cd\u4f5c\u4e00\u4e2a\u6570\u636e\u5e93\uff0c\u56e0\u6b64\u5fc5\u987b\u5728\u8fde\u63a5\u5230 PostgreSQL \u670d\u52a1\u5668\u65f6\u663e\u5f0f\u6307\u5b9a\u8981\u8fde\u63a5\u7684\u6570\u636e\u5e93\u3002</p> <p>PostgreSQL \u5141\u8bb8\u591a\u4e2a\u5ba2\u6237\u7aef\u540c\u65f6\u8fde\u63a5\uff1b\u914d\u7f6e\u53c2\u6570<code>max_connections</code>\u7528\u4e8e\u63a7\u5236\u6700\u5927\u5ba2\u6237\u7aef\u8fde\u63a5\u6570\uff08\u9ed8\u8ba4\u4e3a 100\uff09\u3002</p> <p>\u56e0\u4e3a PostgreSQL \u6ca1\u6709\u539f\u751f\u7684\u8fde\u63a5\u6c60\u529f\u80fd\uff0c\u56e0\u6b64\u5982\u679c\u8bb8\u591a\u5ba2\u6237\u7aef\u9891\u7e41\u5730\u91cd\u590d\u4e0e PostgreSQL \u670d\u52a1\u5668\u5efa\u7acb\u65ad\u5f00\u8fde\u63a5\uff08\u8b6c\u5982 WEB \u5e94\u7528\uff09\uff0c\u5219\u4f1a\u5bfc\u81f4\u5efa\u7acb\u8fde\u63a5\u4e0e\u521b\u5efa\u540e\u7aef\u8fdb\u7a0b\u7684\u5f00\u9500\u53d8\u5927\u3002\u8fd9\u79cd\u60c5\u51b5\u5bf9\u6570\u636e\u5e93\u670d\u52a1\u5668\u7684\u6027\u80fd\u6709\u8d1f\u9762\u5f71\u54cd\uff0c\u901a\u5e38\u53ef\u4ee5\u4f7f\u7528<code>\u6c60\u5316\u4e2d\u95f4\u4ef6\uff08pgbouncer\u6216pgpool-II\uff09</code>\u6765\u907f\u514d\u8be5\u95ee\u9898\u3002</p> <p>\u53ef\u89c1<code>postgresql</code>\u5728\u9ad8\u5e76\u53d1\u573a\u666f\u4e0b\u5904\u7406\u5ba2\u6237\u7aef\u8fde\u63a5\u65f6\u6210\u672c\u8fd8\u662f\u5f88\u9ad8\u7684\u3002</p> <p>postgresql \u662f\u8fdb\u7a0b\u6a21\u578b\uff0c\u5404\u4e2a\u540e\u53f0\u8fdb\u7a0b\u7531 postmaster \u4e3b\u8fdb\u7a0b\u521b\u5efa\uff0c\u6bcf\u4e2a\u5ba2\u6237\u7aef\u8fde\u63a5\u8fdb\u6765\u670d\u52a1\u5668\u7aef\u90fd\u4f1a\u521b\u5efa\u4e00\u4e2a server process \u4e0e\u5ba2\u6237\u7aef\u4ea4\u4e92\uff0c\u5904\u7406\u5ba2\u6237\u7aef\u8bf7\u6c42\u3002</p> <p>\u5bf9\u4e8e\u521b\u5efa\u7684\u6bcf\u4e2a\u8fde\u63a5\uff0c\u64cd\u4f5c\u7cfb\u7edf\u90fd\u9700\u8981\u4e3a\u6253\u5f00\u7f51\u7edc\u5957\u63a5\u5b57\u7684\u8fdb\u7a0b\u5206\u914d\u5185\u5b58\uff0cPostgreSQL \u9700\u8981\u81ea\u5df1\u8fdb\u884c\u5185\u90e8\u8ba1\u7b97\u6765\u5efa\u7acb\u8fde\u63a5\u3002</p> <p>\u5c06\u5176\u6269\u5c55\u5230\u6570\u5343\u4e2a\u7528\u6237\u4f1a\u8bdd\uff0c\u800c\u4ec5\u4ec5\u4e3a\u7528\u6237\u51c6\u5907\u597d\u6570\u636e\u5e93\u8fde\u63a5\u5c31\u53ef\u80fd\u6d6a\u8d39\u5927\u91cf\u65f6\u95f4\u3002\u5c06 max_connections \u8bbe\u7f6e\u4e3a\u9ad8\u7684\u5176\u4ed6\u6210\u672c\u5305\u62ec\u78c1\u76d8\u4e89\u7528\u3001\u64cd\u4f5c\u7cfb\u7edf\u8c03\u5ea6\uff0c\u751a\u81f3 CPU \u7ea7\u7f13\u5b58\u7ebf\u4e89\u7528\u3002</p> <p>\u4e00\u65e6\u8fde\u63a5\u5efa\u7acb\u4e4b\u540e\uff0c\u5ba2\u6237\u7aef\u548c\u65b0\u670d\u52a1\u5668\u8fdb\u7a0b\u5c31\u4e0d\u518d\u7ecf\u8fc7\u6700\u521d\u7684 postgres \u8fdb\u7a0b\u7684\u5e72\u6d89\u8fdb\u884c\u901a\u8baf\u3002</p> <p>\u56e0\u6b64\uff0c\u4e3b\u670d\u52a1\u5668\u8fdb\u7a0b\u603b\u662f\u5728\u8fd0\u884c\u5e76\u7b49\u5f85\u7740\u5ba2\u6237\u7aef\u8fde\u63a5\uff0c \u800c\u5ba2\u6237\u7aef\u548c\u76f8\u5173\u8054\u7684\u670d\u52a1\u5668 postgres \u8fdb\u7a0b\u5219\u662f\u8d77\u8d77\u505c\u505c\uff08\u5f53\u7136\uff0c\u8fd9\u4e9b\u5bf9\u7528\u6237\u662f\u900f\u660e\u7684\u3002\u6211\u4eec\u4ecb\u7ecd\u8fd9\u4e9b\u4e3b\u8981\u662f\u4e3a\u4e86\u5185\u5bb9\u7684\u5b8c\u6574\u6027\uff09\u3002</p> <p>\u8fdb\u7a0b\u6a21\u578b\u6709\u4e2a\u95ee\u9898\u5c31\u662f\u5bb9\u6613\u9020\u6210 oom\uff0c\u5f53\u7206\u53d1\u8fde\u63a5\u98ce\u66b4\u65f6\uff0cwork_mem \u8fd9\u7c7b\u53c2\u6570\u7684\u8bbe\u7f6e\u53ef\u80fd\u9020\u6210\u5185\u5b58\u6ea2\u51fa\u3002</p> <p>\u5982\u679c\u53d1\u751f\u9047\u5230\u4f7f\u7528 pg_terminate_backend(pid)\u6740\u4e0d\u6389\u67d0\u6761 sql \u7684\u60c5\u51b5\u4e0b\uff08\u7b14\u8005\u751f\u4ea7\u73af\u5883\u591a\u6b21\u9047\u5230\uff09\uff0cpg \u53ef\u4ee5\u5728\u64cd\u4f5c\u7cfb\u7edf\u5c42\u9762\u4f7f\u7528 kill \u547d\u4ee4\u6740\u6389\u8be5\u8fde\u63a5\u3002</p> <p>\u4e3a\u4ec0\u4e48\u8c03\u6574\u6700\u5927\u8fde\u63a5\u6570\u9700\u8981\u91cd\u542f\uff0c\u4e0d\u80fd\u4fee\u6539\u4e3a reload \u65b9\u5f0f\uff1f</p> <p>\u8fd9\u4e2a\u95ee\u9898\u4e0d\u8be6\u7ec6\u5c55\u5f00\uff0c\u7b80\u5355\u6765\u8bf4\u6700\u5927\u8fde\u63a5\u6570\u53c2\u6570\u548c\u5171\u4eab\u5185\u5b58\u53ca\u4fe1\u53f7\u91cf\u7b49\u76f8\u5173\u7684\uff0c\u8bbe\u7f6e\u6700\u5927\u8fde\u63a5\u6570\u540e\uff0c\u5728\u542f\u52a8\u65f6\u7cfb\u7edf\u4f1a\u76f8\u5e94\u5206\u914d\u8fd9\u4e9b\u8d44\u6e90\u3002\u90a3\u539f\u751f\u7684\u6700\u5927\u8fde\u63a5\u6570\u53c2\u6570\u770b\u8d77\u6765\u53ea\u80fd\u662f\u91cd\u542f\u65b9\u5f0f\u4fee\u6539\u751f\u6548\u4e86\u3002</p>"},{"location":"postgresql/03.%E4%BD%93%E7%B3%BB%E6%9E%B6%E6%9E%84/#_9","title":"\u540e\u53f0\u8fdb\u7a0b","text":"<ul> <li>background writer:\u540e\u53f0\u5199\u8fdb\u7a0b\uff0c\u8d1f\u8d23\u5c06\u7f13\u51b2\u6c60\u7684\u810f\u9875\u6570\u636e\u5199\u56de\u78c1\u76d8\uff1b</li> <li>checkpointer:\u68c0\u67e5\u70b9\uff0c\u6bcf\u9694\u4e00\u5b9a\u5468\u671f\u5c06\u810f\u9875\u5237\u76d8\uff0c\u5305\u62ec\u5171\u4eab\u7f13\u51b2\u6c60\u548c SLRU \u810f\u6570\u636e\uff1b</li> <li>autovacuum\uff1a\u81ea\u52a8\u6e05\u7406\u8fdb\u7a0b\uff0c\u7528\u4e8e\u56de\u6536\u88ab\u5220\u9664\u5143\u7ec4\u7a7a\u95f4\uff0c\u907f\u514d\u6570\u636e\u6587\u4ef6\u65e0\u9650\u81a8\u80c0\uff1b</li> <li>WAL writer: WAL \u5199\u8fdb\u7a0b\uff0c\u8d1f\u8d23\u5c06 wal buffer \u5237\u5199\u81f3\u78c1\u76d8\uff0c\u7f13\u89e3\u4e1a\u52a1\u9ad8\u5cf0\u65f6\u65e5\u5fd7\u7684\u5e76\u53d1\u5199\u5165\uff0c\u5bf9\u6570\u636e\u5e93\u6027\u80fd\u9020\u6210\u5f71\u54cd\uff1b</li> <li>statistics collector\uff1a\u4fe1\u606f\u6536\u96c6\u8fdb\u7a0b\uff0c\u8d1f\u8d23\u6536\u96c6\u6570\u636e\u5e93\u7cfb\u7edf\u8fd0\u884c\u7684\u7edf\u8ba1\u4fe1\u606f\uff0c\u4e3b\u8981\u7528\u4e8e\u67e5\u8be2\u4f18\u5316\u65f6\u7684\u4ee3\u4ef7\u4f30\u7b97\uff1b</li> <li>pgArch\uff1a\u65e5\u5fd7\u5f52\u6863\u8fdb\u7a0b\uff0c\u8d1f\u8d23\u5c06 WAL \u65e5\u5fd7\u8fdb\u884c\u5f52\u6863\u5907\u4efd\uff0c\u52a0\u5f3a\u6570\u636e\u5e93\u7684\u9ad8\u53ef\u9760\u6027\u548c\u9ad8\u53ef\u7528\u6027\uff0c\u9632\u6b62\u6570\u636e\u610f\u5916\u4e22\u5931\uff1b</li> </ul> <p>logger \u8fdb\u7a0b\u53ef\u4ee5\u6536\u96c6\u5305\u62ec postmaster \u8fdb\u7a0b\u5728\u5185\u7684\u6240\u6709\u8fdb\u7a0b\u7684 stderr \u65e5\u5fd7\uff0c\u8fd9\u91cc\u9700\u8981\u6ce8\u610f\u662f\u9519\u8bef\u65e5\u5fd7\u54e6\uff0c\u5e76\u4e0d\u662f\u6240\u6709\u7684\u65e5\u5fd7\u5b83\u90fd\u4f1a\u6536\u96c6\u3002</p> <p>\u5b83\u652f\u6301\u901a\u8fc7 postgresql.conf \u6587\u4ef6\u4fee\u6539\u65e5\u5fd7\u76f8\u5173\u7684\u53c2\u6570\uff0c\u53ef\u4ee5\u8bbe\u7f6e\u6700\u5927\u503c\u5e76\u5faa\u73af\u8986\u76d6\uff0c\u65e5\u5fd7\u7684\u9ed8\u8ba4\u76ee\u5f55\u5728$PGDATA/logs/\uff0c\u50cf\u6211\u672c\u673a\u9ed8\u8ba4\u7684\u65e5\u5fd7\u8bb0\u5f55\u5982\u4e0b\uff0c\u6bcf\u5929\u4e00\u4e2a\u65e5\u5fd7\u6587\u4ef6\uff0c\u6309\u7167\u661f\u671f\u5b58\u50a8\u3002</p> <pre><code># \u521b\u5efa\u4e00\u4e2a\u540d\u4e3a logging.conf \u7684\u8865\u5145\u914d\u7f6e\u6587\u4ef6\uff0c\u800c\u4e0d\u662f\u5c31\u5730\u4fee\u6539\u4e3b\u914d\u7f6e\u6587\u4ef6\uff08postgresql.conf\uff09\uff0c\u8be5\u6587\u4ef6\u5c06\u5305\u542b\u5728\u4e3b\u96c6\u7fa4\u914d\u7f6e\u6587\u4ef6\u4e2d\u3002\n# \u901a\u8fc7\u8fd9\u79cd\u65b9\u5f0f\uff0c\u6211\u4eec\u5c06\u80fd\u591f\u5207\u6362\u56de\u539f\u59cb\u65e5\u5fd7\u8bb0\u5f55\u914d\u7f6e\uff0c\u6216\u8005\u901a\u8fc7\u7b80\u5355\u5730\u590d\u5236\u65b0\u6587\u4ef6\u5728\u5176\u4ed6\u7cfb\u7edf\u4e0a\u590d\u5236\u5b83\u3002\n# \u4e3a\u4e86\u6fc0\u6d3b\u65e5\u5fd7\u76f8\u5173\u914d\u7f6e\uff0c\u5728postgresql.conf\u6587\u4ef6\u672b\u5c3e\u63d2\u5165\u4e00\u6761 include_if_exists='logging.conf'\n\n\nlogging_collector = on                            # \u662f\u5426\u5c06\u65e5\u5fd7\u91cd\u5b9a\u5411\u81f3\u6587\u4ef6\u4e2d\uff0c\u9ed8\u8ba4\u662foff\uff08\u8be5\u914d\u7f6e\u4fee\u6539\u540e\uff0c\u9700\u8981\u91cd\u542fDB\u670d\u52a1\uff09\nlog_directory = 'log'                             # \u65e5\u5fd7\u6240\u5c5e\u76ee\u5f55\uff0c\u9ed8\u8ba4\u662f${PGDATA}/log/\u76ee\u5f55\u3002\u53ef\u4ee5\u81ea\u5b9a\u4e49\u8bbe\u7f6e\u76f8\u5bf9\u76ee\u5f55\u548c\u7edd\u5bf9\u76ee\u5f55\nlog_filename = 'postgresql-%Y-%m-%d_%H%M%S.log'   # \u65e5\u5fd7\u6587\u4ef6\u540d\u79f0\n#log_file_mode = 0600                             # \u65e5\u5fd7\u6587\u4ef6\u6743\u9650\n#log_rotation_age = 1d                            # \u5355\u4e2a\u65e5\u5fd7\u6587\u4ef6\u7684\u751f\u5b58\u671f\uff0c\u9ed8\u8ba41\u5929\uff0c\u5728\u65e5\u5fd7\u6587\u4ef6\u5927\u5c0f\u6ca1\u6709\u8fbe\u5230log_rotation_size\u65f6\uff0c\u4e00\u5929\u53ea\u751f\u6210\u4e00\u4e2a\u65e5\u5fd7\u6587\u4ef6\n#log_rotation_size = 10MB                         # \u5355\u4e2a\u65e5\u5fd7\u6587\u4ef6\u7684\u5927\u5c0f\uff0c\u5982\u679c\u65f6\u95f4\u6ca1\u6709\u8d85\u8fc7log_rotation_age\uff0c\u4e00\u4e2a\u65e5\u5fd7\u6587\u4ef6\u6700\u5927\u53ea\u80fd\u523010M\uff0c\u5426\u5219\u5c06\u65b0\u751f\u6210\u4e00\u4e2a\u65e5\u5fd7\u6587\u4ef6\u3002\n#log_truncate_on_rotation = off\n</code></pre>"},{"location":"postgresql/03.%E4%BD%93%E7%B3%BB%E6%9E%B6%E6%9E%84/#_10","title":"\u5176\u4ed6\u8f85\u52a9\u8fdb\u7a0b","text":"<ul> <li>background writer:\u540e\u53f0\u5199\u8fdb\u7a0b\uff0c\u8d1f\u8d23\u5c06\u7f13\u51b2\u6c60\u7684\u810f\u9875\u6570\u636e\u5199\u56de\u78c1\u76d8\uff1b</li> <li>checkpointer:\u68c0\u67e5\u70b9\uff0c\u6bcf\u9694\u4e00\u5b9a\u5468\u671f\u5c06\u810f\u9875\u5237\u76d8\uff0c\u5305\u62ec\u5171\u4eab\u7f13\u51b2\u6c60\u548c SLRU \u810f\u6570\u636e\uff1b</li> <li>autovacuum\uff1a\u81ea\u52a8\u6e05\u7406\u8fdb\u7a0b\uff0c\u7528\u4e8e\u56de\u6536\u88ab\u5220\u9664\u5143\u7ec4\u7a7a\u95f4\uff0c\u907f\u514d\u6570\u636e\u6587\u4ef6\u65e0\u9650\u81a8\u80c0\uff1b</li> <li>WAL writer: WAL \u5199\u8fdb\u7a0b\uff0c\u8d1f\u8d23\u5c06 wal buffer \u5237\u5199\u81f3\u78c1\u76d8\uff0c\u7f13\u89e3\u4e1a\u52a1\u9ad8\u5cf0\u65f6\u65e5\u5fd7\u7684\u5e76\u53d1\u5199\u5165\uff0c\u5bf9\u6570\u636e\u5e93\u6027\u80fd\u9020\u6210\u5f71\u54cd\uff1b</li> <li>statistics collector\uff1a\u4fe1\u606f\u6536\u96c6\u8fdb\u7a0b\uff0c\u8d1f\u8d23\u6536\u96c6\u6570\u636e\u5e93\u7cfb\u7edf\u8fd0\u884c\u7684\u7edf\u8ba1\u4fe1\u606f\uff0c\u4e3b\u8981\u7528\u4e8e\u67e5\u8be2\u4f18\u5316\u65f6\u7684\u4ee3\u4ef7\u4f30\u7b97\uff1b</li> <li>pgArch\uff1a\u65e5\u5fd7\u5f52\u6863\u8fdb\u7a0b\uff0c\u8d1f\u8d23\u5c06 WAL \u65e5\u5fd7\u8fdb\u884c\u5f52\u6863\u5907\u4efd\uff0c\u52a0\u5f3a\u6570\u636e\u5e93\u7684\u9ad8\u53ef\u9760\u6027\u548c\u9ad8\u53ef\u7528\u6027\uff0c\u9632\u6b62\u6570\u636e\u610f\u5916\u4e22\u5931\uff1b</li> </ul>"},{"location":"postgresql/03.%E4%BD%93%E7%B3%BB%E6%9E%B6%E6%9E%84/#_11","title":"\u5185\u5b58\u67b6\u6784","text":"<p>\u5728 postgres \u6570\u636e\u5e93\u4e2d\uff0c\u5185\u5b58\u5206\u4e3a<code>\u5171\u4eab\u5185\u5b58</code>\u548c<code>\u79c1\u6709\u5185\u5b58</code>\u3002</p> <p></p>"},{"location":"postgresql/03.%E4%BD%93%E7%B3%BB%E6%9E%B6%E6%9E%84/#_12","title":"\u5171\u4eab\u5185\u5b58","text":"<p>\u5171\u4eab\u5185\u5b58\u5305\u62ec\u5171\u4eab\u7f13\u51b2\u6c60\u3001WAL buffer\u3001SLRU <p>(1)shared buffer</p> <p>PostgreSQL \u5c06\u8868\u548c\u7d22\u5f15\u4e2d\u7684\u9875\u9762\u4ece\u6301\u4e45\u5b58\u50a8\u52a0\u8f7d\u5230\u5171\u4eab\u7f13\u51b2\u6c60\u4e2d\uff0c\u7136\u540e\u76f4\u63a5\u5bf9\u5b83\u4eec\u8fdb\u884c\u64cd\u4f5c\u3002\u7531\u53c2\u6570 shared_buffers \u63a7\u5236\uff0c\u9ed8\u8ba4\u662f 128MB\u3002</p> <p>(2)wal buffer</p> <p>\u4e3a\u786e\u4fdd\u670d\u52a1\u6545\u969c\u4e0d\u4f1a\u5bfc\u81f4\u4efb\u4f55\u6570\u636e\u4e22\u5931\uff0cPostgreSQL \u5b9e\u73b0\u4e86 WAL \u673a\u5236\u3002</p> <p>WAL \u6570\u636e\uff08\u4e5f\u79f0\u4e3a XLOG \u8bb0\u5f55\uff09\u662f PostgreSQL \u4e2d\u7684\u4e8b\u52a1\u65e5\u5fd7\uff1bWAL \u7f13\u51b2\u533a\u662f WAL \u6570\u636e\u5728\u5199\u5165\u6301\u4e45\u5b58\u50a8\u4e4b\u524d\u7684\u7f13\u51b2\u533a\u3002</p> <p>(3)commit log</p> <p>\u63d0\u4ea4\u65e5\u5fd7(CLOG)\u4fdd\u5b58\u6240\u6709\u4e8b\u52a1\u7684\u72b6\u6001\uff0c\u662f\u5e76\u53d1\u63a7\u5236\u673a\u5236\u7684\u4e00\u90e8\u5206\u3002\u63d0\u4ea4\u65e5\u5fd7\u5206\u914d\u5171\u4eab\u5185\u5b58\uff0c\u5e76\u5728\u6574\u4e2a\u4e8b\u52a1\u5904\u7406\u8fc7\u7a0b\u4e2d\u4f7f\u7528\u3002</p> <p>\u4e8b\u52a1\u6709\u4ee5\u4e0b\u56db\u79cd\u72b6\u6001\uff1a</p> <p>in_progress\u3001commited\u3001aborted\u3001sub-commited</p>"},{"location":"postgresql/03.%E4%BD%93%E7%B3%BB%E6%9E%B6%E6%9E%84/#_13","title":"\u79c1\u6709\u5185\u5b58","text":"<p>\u6bcf\u4e2a\u540e\u7aef\u8fdb\u7a0b\u90fd\u4f1a\u5206\u914d\u4e00\u5757\u672c\u5730\u5185\u5b58\u533a\u57df\u7528\u4e8e\u67e5\u8be2\u5904\u7406\u3002\u8be5\u533a\u57df\u4f1a\u5206\u4e3a\u51e0\u4e2a\u5b50\u533a\u57df \u2014\u2014 \u5b50\u533a\u57df\u7684\u5927\u5c0f\u6709\u7684\u56fa\u5b9a\uff0c\u6709\u7684\u53ef\u53d8\u3002</p> <p>\u79c1\u6709\u5185\u5b58\u4e3b\u8981\u7531 <code>temp_buffers</code>\u3001<code>work_mem</code> \u548c <code>maintenance_work_mem</code> \u7ec4\u6210</p> <p>(1)work_mem</p> <p>\u6267\u884c\u5668\u5728\u6267\u884c <code>ORDER BY</code> \u548c <code>DISTINCT</code> \u65f6\u4f7f\u7528\u8be5\u533a\u57df\u5bf9\u5143\u7ec4\u505a\u6392\u5e8f\uff0c\u4ee5\u53ca\u5b58\u50a8\u5f52\u5e76\u8fde\u63a5\u548c\u6563\u5217\u8fde\u63a5\u4e2d\u7684\u8fde\u63a5\u8868\u3002\u4e5f\u7528\u4e8e\u8868\u7684join\u64cd\u4f5c\uff0c\u6bd4\u5982merge-join\u3001hash-join\u64cd\u4f5c</p> <p>\u6709\u53c2\u6570<code>work_mem</code>\u63a7\u5236\uff0c\u9ed8\u8ba4\u662f4MB\u3002</p> <p>\u53c2\u6570<code>log_temp_files</code>\u4f1a\u63a7\u5236\u8bb0\u5f55\u4e34\u65f6\u6587\u4ef6\u540d\u548c\u5927\u5c0f\u3002\u53ef\u4ee5\u4e3a\u6392\u5e8f\u3001\u6563\u5217\u548c\u4e34\u65f6\u67e5\u8be2\u7ed3\u679c\u521b\u5efa\u4e34\u65f6\u6587\u4ef6\u3002\u5982\u679c\u901a\u8fc7\u6b64\u8bbe\u7f6e\u542f\u7528\uff0c\u5219\u5728\u5220\u9664\u6bcf\u4e2a\u4e34\u65f6\u6587\u4ef6\u65f6\u5c06\u4e3a\u5176\u53d1\u51fa\u4e00\u4e2a\u65e5\u5fd7\u6761\u76ee\u3002\u5f53\u503c\u4e3a0\u65f6\uff0c\u8bb0\u5f55\u6240\u6709\u4e34\u65f6\u6587\u4ef6\u4fe1\u606f;\u5f53\u503c\u4e3a\u6b63\u65f6\uff0c\u53ea\u8bb0\u5f55\u5927\u5c0f\u5927\u4e8e\u6216\u7b49\u4e8e\u6307\u5b9a\u6570\u636e\u91cf\u7684\u6587\u4ef6\u3002\u5982\u679c\u6307\u5b9a\u6b64\u503c\u65f6\u6ca1\u6709\u4f7f\u7528\u5355\u4f4d\uff0c\u5219\u5c06\u5176\u4f5c\u4e3akb\u3002\u9ed8\u8ba4\u8bbe\u7f6e\u662f-1\uff0c\u5b83\u7981\u7528\u8fd9\u6837\u7684\u65e5\u5fd7\u8bb0\u5f55\u3002\u53ea\u6709\u8d85\u7ea7\u7528\u6237\u624d\u80fd\u66f4\u6539\u6b64\u8bbe\u7f6e\u3002</p> <p>\u8bbe\u7f6e\u5efa\u8bae\uff1a</p> <p>--\u4ece\u8f83\u5c0f\u7684\u503c\u5f00\u59cb</p> <p>--\u7136\u540e\u770b\u770b\u65e5\u5fd7\u4e2d\u7684\"temporary file\"\u76f8\u5173\u4fe1\u606f</p> <p>--\u8bbe\u7f6e\u6210temp\u6587\u4ef6\u76842-3\u500d</p>"},{"location":"postgresql/03.%E4%BD%93%E7%B3%BB%E6%9E%B6%E6%9E%84/#_14","title":"\u53ef\u6267\u884c\u6587\u4ef6","text":""},{"location":"postgresql/03.%E4%BD%93%E7%B3%BB%E6%9E%B6%E6%9E%84/#_15","title":"\u5ba2\u6237\u7aef\u7a0b\u5e8f","text":"<p>\u8fd0\u884c PostgreSQL \u7684\u4ea4\u4e92\u5f0f\u7ec8\u7aef\u7a0b\u5e8f\uff0c\u5b83\u88ab\u79f0\u4e3a psql\uff0c \u5b83\u5141\u8bb8\u4f60\u4ea4\u4e92\u5730\u8f93\u5165\u3001\u7f16\u8f91\u548c\u6267\u884c SQL \u547d\u4ee4\u3002</p> <p>PostgreSQL \u7528\u6237\u540d\u662f\u548c\u64cd\u4f5c\u7cfb\u7edf\u7528\u6237\u8d26\u53f7\u5206\u5f00\u7684\u3002</p> <p>\u5982\u679c\u4f60\u8fde\u63a5\u5230\u4e00\u4e2a\u6570\u636e\u5e93\u65f6\uff0c\u4f60\u53ef\u4ee5\u9009\u62e9\u4ee5\u4f55\u79cd PostgreSQL \u7528\u6237\u540d\u8fdb\u884c\u8054\u63a5; \u5982\u679c\u4f60\u4e0d\u9009\u62e9\uff0c\u90a3\u4e48\u9ed8\u8ba4\u5c31\u662f\u4f60\u7684\u5f53\u524d\u64cd\u4f5c\u7cfb\u7edf\u8d26\u53f7\u3002 \u5982\u679c\u8fd9\u6837\uff0c\u90a3\u4e48\u603b\u6709\u4e00\u4e2a\u4e0e\u64cd\u4f5c\u7cfb\u7edf\u7528\u6237\u540c\u540d\u7684 PostgreSQL \u7528\u6237\u8d26\u53f7\u7528\u4e8e\u542f\u52a8\u670d\u52a1\u5668\uff0c \u5e76\u4e14\u901a\u5e38\u8fd9\u4e2a\u7528\u6237\u90fd\u6709\u521b\u5efa\u6570\u636e\u5e93\u7684\u6743\u9650\u3002</p> <p>\u5982\u679c\u4f60\u4e0d\u60f3\u4ee5\u8be5\u7528\u6237\u8eab\u4efd\u767b\u5f55\uff0c \u90a3\u4e48\u4f60\u4e5f\u53ef\u4ee5\u5728\u4efb\u4f55\u5730\u65b9\u58f0\u660e\u4e00\u4e2a-U \u9009\u9879\u4ee5\u9009\u62e9\u4e00\u4e2a\u7528\u4e8e\u8fde\u63a5\u7684 PostgreSQL \u7528\u6237\u540d\u3002</p> <pre><code>root@qhdata:~# su postgres\npostgres@qhdata:/root$\npostgres@qhdata:/root$ psql\npsql (13.2 (Ubuntu 13.2-1.pgdg20.04+1))\nType \"help\" for help.\npostgres=#\n</code></pre>"},{"location":"postgresql/04.postgresql%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6/","title":"\u6982\u8ff0","text":"<p>PostgreSql \u6570\u636e\u5e93\u5b89\u88c5\u5b8c\u6210\u540e\uff0c\u518d\u9700\u8981\u505a\u4e00\u4e9b\u914d\u7f6e\uff0c\u624d\u53ef\u4ee5\u6b63\u5e38\u8bbf\u95ee\u3002\u4e00\u822c\u9700\u8981\u4fee\u6539 <code>postgresql.conf</code>\uff0c<code>pg_hba.conf</code> \u914d\u7f6e\u6587\u4ef6\uff0c\u6709\u5176\u4ed6\u7279\u6b8a\u9700\u6c42\u7684\uff0c\u53ef\u80fd\u8fd8\u9700\u8981\u4fee\u6539 <code>pg_ident.conf</code> \u914d\u7f6e\u6587\u4ef6\u3002</p> <p>postgresql.conf</p> <p>\u6570\u636e\u5e93\u96c6\u7c07\u5b89\u88c5\u90e8\u7f72\u5b8c\u6210\u540e\uff0c\u8981\u66f4\u6539\u5176\u4e2d\u7684\u76d1\u542c\u5730\u5740\uff0c\u5426\u5219\u9ed8\u8ba4\u53ea\u76d1\u542c\u6570\u636e\u5e93\u670d\u52a1\u5668\u672c\u5730 localhost \u5730\u5740\u3002\u53e6\u5916\u786e\u4fdd\u76d1\u542c\u7684\u7aef\u53e3\u53f7\u8981\u901a\u7545\uff0c\u4e0d\u88ab\u9632\u706b\u5899\u6216\u5176\u4ed6\u7f51\u7edc\u5b89\u5168\u7b56\u7565\u6240\u9650\u5236\uff0c\u9ed8\u8ba4\u7aef\u53e3\u53f7 5432\u3002</p> <p>pg_hba.conf</p> <p>\u6570\u636e\u5e93\u96c6\u7c07\u5b89\u88c5\u90e8\u7f72\u5b8c\u6210\u540e\uff0c\u9ed8\u8ba4\u53ea\u5141\u8bb8\u672c\u5730\u8fde\u63a5\uff0c\u4e14\u8fde\u63a5\u8ba4\u8bc1\u65b9\u5f0f\u5747\u4e3a trust\uff0c\u751f\u4ea7\u73af\u5883\u5efa\u8bae\u66f4\u6539\u4e3a md5 \u8fde\u63a5\u8ba4\u8bc1\u65b9\u5f0f\uff0c\u5e76\u6839\u636e\u9700\u6c42\u589e\u52a0\u5141\u8bb8\u8bbf\u95ee\u7684\u5ba2\u6237\u7aef\u5730\u5740\u3002</p> <pre><code># TYPE       DATABASE      USER        ADDRESS      METHOD\n local            all       all                        md5\n  host            all       all   127.0.0.1/32         md5\n  host            all       all      0.0.0.0/0         md5\n  host            all       all        ::1/128         md5\n  local    replication      all                        md5\n  host    replication       all   127.0.0.1/32         md5\n  host    replication       all        ::1/128         md5\n</code></pre> <ul> <li> <p>TYPE\uff0c\u6570\u636e\u5e93\u8fde\u63a5\u65b9\u5f0f\uff0c\u6709\u5982\u4e0b\u56db\u79cd</p> <ul> <li>local\uff1a\u5339\u914d\u4f7f\u7528Unix\u57df\u5957\u63a5\u5b57\u7684\u8fde\u63a5\uff0c\u5982\u679c\u6ca1\u6709\u6b64\u7c7b\u578b\u7684\u8bb0\u5f55\uff0c\u5219\u4e0d\u5141\u8bb8\u4f7f\u7528Unix\u57df\u5957\u63a5\u5b57\u8fde\u63a5\u3002</li> <li>host\uff1a\u5339\u914d\u4f7f\u7528TCP/IP\u8fdb\u884c\u7684\u8fde\u63a5\uff0c\u4e3b\u673a\u8bb0\u5f55\u5339\u914dSSL\u6216\u975eSSL\u8fde\u63a5\uff0c\u9700\u8981\u914d\u7f6elisten_addresses\u3002</li> <li>hostssl\uff1a\u5339\u914d\u4f7f\u7528TCP/IP\u8fdb\u884c\u7684\u8fde\u63a5\uff0c\u4ec5\u9650\u4e8e\u4f7f\u7528SSL\u52a0\u5bc6\u8fdb\u884c\u8fde\u63a5\uff0c\u9700\u8981\u914d\u7f6essl\u53c2\u6570\u3002</li> <li>hostnossl\uff1a\u5339\u914d\u901a\u8fc7TCP/IP\u8fdb\u884c\u7684\u8fde\u63a5\uff0c\u4e0d\u4f7f\u7528SSL\u7684\u8fde\u63a5\u3002</li> </ul> </li> <li> <p>DATABASE\uff1a\u6307\u5b9a\u54ea\u4e9b\u6570\u636e\u5e93\u53ef\u4ee5\u88ab\u8fde\u63a5</p> <ul> <li>\u5339\u914d\u7684\u6570\u636e\u5e93\u540d\u79f0\uff0call \u6307\u5b9a\u5b83\u5339\u914d\u6240\u6709\u6570\u636e\u5e93\u3002</li> <li>\u590d\u5236\uff08replication\uff09\u4e0d\u6307\u5b9a\u6570\u636e\u5e93\u3002</li> <li>\u591a\u4e2a\u6570\u636e\u5e93\u53ef\u4ee5\u7528\u9017\u53f7\u5206\u9694\u3002</li> </ul> </li> <li> <p>USER\uff1a\u6307\u5b9a\u54ea\u4e9b\u7528\u6237\u53ef\u4ee5\u8fde\u63a5</p> <ul> <li>\u5339\u914d\u7684\u6570\u636e\u5e93\u7528\u6237\u540d\uff0call \u6307\u5b9a\u5b83\u5339\u914d\u6240\u6709\u7528\u6237\u3002</li> <li>\u53ef\u4ee5\u901a\u8fc7\u7528\u9017\u53f7\u5206\u9694\u6765\u63d0\u4f9b\u591a\u4e2a\u7528\u6237\u540d\u3002</li> </ul> </li> <li> <p>ADDRESS\uff1a\u6307\u5b9a\u54ea\u4e9bIP\u5730\u5740\u53ef\u4ee5\u8fde\u63a5</p> <ul> <li>\u5339\u914d\u7684\u5ba2\u6237\u7aef\u8ba1\u7b97\u673a\u5730\u5740\uff0call \u5339\u914d\u4efb\u4f55 IP \u5730\u5740\u3002</li> <li>0.0.0.0/0 \u8868\u793a\u6240\u6709 IPv4 \u5730\u5740\u3002</li> <li>:: 0/0 \u8868\u793a\u6240\u6709 IPv6 \u5730\u5740\u3002</li> <li>192.168.100.101/32 \u5141\u8bb8\u8fd9\u4e2a ip \u767b\u5f55\u3002</li> <li>192.168.100.0/24 \u5141\u8bb8 19.168.100.0~192.168.100.255 \u7f51\u6bb5\u767b\u5f55\u6570\u636e\u5e93</li> </ul> </li> <li> <p>METHOD\uff1a\u5ba2\u6237\u7aef\u8ba4\u8bc1\u65b9\u5f0f</p> <ul> <li>trust\uff1a\u53ea\u8981\u77e5\u9053\u6570\u636e\u5e93\u7528\u6237\u540d\u5c31\u4e0d\u9700\u8981\u5bc6\u7801\u6216ident\u5c31\u80fd\u767b\u5f55\uff0c\u5efa\u8bae\u4e0d\u8981\u5728\u751f\u4ea7\u73af\u5883\u4e2d\u4f7f\u7528\u3002</li> <li>am-sha-256\uff1a\u5bc6\u7801\u8ba4\u8bc1\uff0c\u8fd9\u662f\u5f53\u524d\u63d0\u4f9b\u7684\u65b9\u6cd5\u4e2d\u6700\u5b89\u5168\u7684\u4e00\u79cd\uff0c\u4f46\u662f\u65e7\u7684\u5ba2\u6237\u7aef\u5e93\u4e0d\u652f\u6301\u8fd9\u79cd\u65b9\u6cd5\u3002</li> <li>md5\uff1a\u662f\u5e38\u7528\u7684\u5bc6\u7801\u8ba4\u8bc1\u65b9\u5f0f\uff0c\u5982\u679c\u4f60\u4e0d\u4f7f\u7528ident\uff0c\u6700\u597d\u4f7f\u7528md5\u3002\u5bc6\u7801\u662f\u4ee5md5\u5f62\u5f0f\u4f20\u9001\u7ed9\u6570\u636e\u5e93\uff0c\u8f83\u5b89\u5168\uff0c\u4e14\u4e0d\u9700\u5efa\u7acb\u540c\u540d\u7684\u64cd\u4f5c\u7cfb\u7edf\u7528\u6237\u3002</li> <li>password\uff1a\u4ee5\u660e\u6587\u5bc6\u7801\u4f20\u9001\u7ed9\u6570\u636e\u5e93\uff0c\u5efa\u8bae\u4e0d\u8981\u5728\u751f\u4ea7\u73af\u5883\u4e2d\u4f7f\u7528\u3002</li> <li>ident\uff1aLinux\u4e0bPostgreSQL\u9ed8\u8ba4\u7684local\u8ba4\u8bc1\u65b9\u5f0f\uff0c\u51e1\u662f\u80fd\u6b63\u786e\u767b\u5f55\u64cd\u4f5c\u7cfb\u7edf\u7528\u6237\uff08\u6ce8\uff1a\u4e0d\u662f\u6570\u636e\u5e93\u7528\u6237\uff09\u5c31\u80fd\u4f7f\u7528\u672c\u7528\u6237\u6620\u5c04\u7684\u6570\u636e\u5e93\u7528\u6237\u4e0d\u9700\u5bc6\u7801\u767b\u5f55\u6570\u636e\u5e93\u3002\u64cd\u4f5c\u7cfb\u7edf\u540d\uff0c\u6570\u636e\u5e93\u7528\u6237\u540d\uff0c\u6570\u636e\u5e93\u540d\u4e00\u81f4\u3002</li> <li>reject\uff1a\u62d2\u7edd\u8ba4\u8bc1\uff0c\u8fd9\u5bf9\u4e8e\u4ece\u7ec4\u4e2d\u201c\u8fc7\u6ee4\u6389\u201d\u67d0\u4e9b\u4e3b\u673a\u975e\u5e38\u6709\u7528\u3002</li> </ul> </li> </ul> <p>\u4fee\u6539\u5b8cpg_hba.conf\u6587\u4ef6\u4e4b\u540e\uff0c\u9700\u8981\u91cd\u65b0\u52a0\u8f7d\u914d\u7f6e\uff0c\u4e0d\u7528\u91cd\u542f\u6570\u636e\u5e93\uff1a <pre><code>--\u7cfb\u7edf\u547d\u4ee4\u884c\u6267\u884c\npg_ctl reload\n--\u8fde\u5165\u6570\u636e\u5e93\u6267\u884c\nselect pg_reload_conf();\n</code></pre></p> <p>pg_ident.conf</p> <p>\u6570\u636e\u5e93\u6620\u5c04\u6587\u4ef6\uff0cident \u8ba4\u8bc1\u65b9\u5f0f\u7684\u6269\u5c55\uff0c\u6807\u6ce8\u64cd\u4f5c\u7cfb\u7edf\u7528\u6237\u4e0e\u6570\u636e\u5e93\u7528\u6237\u7684\u6620\u5c04\u5173\u7cfb\uff0c\u914d\u5408pg_hba.conf \u4f7f\u7528\u3002\u5141\u8bb8\u6570\u636e\u5e93\u670d\u52a1\u5668\u4e0a\u6307\u5b9a\u7684\u64cd\u4f5c\u7cfb\u7edf\u7528\u6237\uff0c\u4f7f\u7528\u6307\u5b9a\u7684\u6570\u636e\u5e93\u7528\u6237\uff0c\u514d\u5bc6\u8fde\u5165\u6570\u636e\u5e93\u3002</p> <p>PostgreSql \u8ba4\u8bc1\u65b9\u5f0f Peer \u8ba4\u8bc1</p> <p>Peer \u8ba4\u8bc1\u65b9\u6cd5\u901a\u8fc7\u4ece\u5185\u6838\u83b7\u5f97\u5ba2\u6237\u7aef\u7684\u64cd\u4f5c\u7cfb\u7edf\u7528\u6237\u540d\u5e76\u628a\u5b83\u7528\u4f5c\u88ab\u5141\u8bb8\u7684\u6570\u636e\u5e93\u7528\u6237\u540d\uff08\u548c\u53ef\u9009\u7684\u7528\u6237\u540d\u6620\u5c04\uff09\u6765\u5de5\u4f5c\u3002\u8fd9\u79cd\u65b9\u6cd5\u53ea\u5728\u672c\u5730\u8fde\u63a5\u4e0a\u652f\u6301\u3002</p> <p>Peer \u8ba4\u8bc1\u53ea\u5728\u63d0\u4f9bgetpeereid()\u51fd\u6570\u3001SO_PEERCRED\u5957\u63a5\u5b57\u53c2\u6570\u6216\u76f8\u4f3c\u673a\u5236\u7684\u64cd\u4f5c\u7cfb\u7edf\u4e0a\u53ef\u7528\u3002\u8fd9\u4e9b OS \u5f53\u524d\u5305\u62ecLinux\u3001\u5927\u90e8\u5206\u7684BSD\u5305\u62ecOS X\u4ee5\u53caSolaris\u3002</p> <p>PostgreSql \u8ba4\u8bc1\u65b9\u5f0f Idnet \u8ba4\u8bc1</p> <p>ident \u8ba4\u8bc1\u65b9\u6cd5\u901a\u8fc7\u4ece\u4e00\u4e2a ident \u670d\u52a1\u5668\u83b7\u5f97\u5ba2\u6237\u7aef\u7684\u64cd\u4f5c\u7cfb\u7edf\u7528\u6237\u540d\u5e76\u4e14\u7528\u5b83\u4f5c\u4e3a\u88ab\u5141\u8bb8\u7684\u6570\u636e\u5e93\u7528\u6237\u540d\uff08\u548c\u53ef\u9009\u7684\u7528\u6237\u540d\u6620\u5c04\uff09\u6765\u5de5\u4f5c\u3002\u5b83\u53ea\u5728 TCP/IP \u8fde\u63a5\u4e0a\u652f\u6301\u3002</p> <p>\"Identification Protocol\uff08\u6807\u8bc6\u534f\u8bae\uff09\"\u5728 RFC 1413 \u4e2d\u63cf\u8ff0\u3002\u5b9e\u9645\u4e0a\u6bcf\u4e2a\u7c7b Unix \u64cd\u4f5c\u7cfb\u7edf\u90fd\u5e26\u7740\u4e00\u4e2a\u9ed8\u8ba4\u76d1\u542c TCP 113 \u7aef\u53e3\u7684 ident \u670d\u52a1\u5668\u3002ident \u670d\u52a1\u5668\u7684\u57fa\u672c\u529f\u80fd\u662f\u56de\u7b54\u7c7b\u4f3c\u8fd9\u6837\u7684\u95ee\u9898\uff1a\u201c\u54ea\u4e2a\u7528\u6237\u4ece\u4f60\u7684\u7aef\u53e3X\u53d1\u8d77\u4e86\u8fde\u63a5\u5e76\u4e14\u8fde\u5230\u4e86\u6211\u7684\u7aef\u53e3Y\uff1f\u201d \u3002</p> <p>\u56e0\u4e3a\u5f53\u4e00\u4e2a\u7269\u7406\u8fde\u63a5\u88ab\u5efa\u7acb\u540e\uff0cPostgreSQL\u65e2\u77e5\u9053X\u4e5f\u77e5\u9053Y\uff0c \u6240\u4ee5\u5b83\u53ef\u4ee5\u8be2\u95ee\u5c1d\u8bd5\u8fde\u63a5\u7684\u5ba2\u6237\u7aef\u4e3b\u673a\u4e0a\u7684 ident \u670d\u52a1\u5668\u5e76\u4e14\u5728\u7406\u8bba\u4e0a\u53ef\u4ee5\u5224\u65ad\u4efb\u610f\u7ed9\u5b9a\u8fde\u63a5\u7684\u64cd\u4f5c\u7cfb\u7edf\u7528\u6237\u3002\u7b80\u5355\u6765\u8bf4\uff0cident \u670d\u52a1\u80fd\u591f\u544a\u77e5 socket \u88ab\u8fde\u63a5\u7aef\u5f53\u524d\u64cd\u4f5c\u7cfb\u7edf\u7528\u6237\u4fe1\u606f\u3002</p> <p>\u8fd9\u4e2a\u8fc7\u7a0b\u7684\u7f3a\u70b9\u662f\u5b83\u4f9d\u8d56\u4e8e\u5ba2\u6237\u7aef\u7684\u5b8c\u6574\u6027\uff1a\u5982\u679c\u5ba2\u6237\u7aef\u673a\u5668\u4e0d\u53ef\u4fe1\u6216\u8005\u88ab\u653b\u7834\uff0c\u653b\u51fb\u8005\u53ef\u80fd\u5728 113 \u7aef\u53e3\u4e0a\u8fd0\u884c\u4efb\u4f55\u7a0b\u5e8f\u5e76\u4e14\u8fd4\u56de\u4ed6\u4eec\u9009\u62e9\u7684\u4efb\u4f55\u7528\u6237\u3002\u56e0\u6b64\u8fd9\u79cd\u8ba4\u8bc1\u65b9\u6cd5\u53ea\u9002\u7528\u4e8e\u5c01\u95ed\u7684\u7f51\u7edc\uff0c \u8fd9\u6837\u7684\u7f51\u7edc\u4e2d\u7684\u6bcf\u53f0\u5ba2\u6237\u7aef\u673a\u5668\u90fd\u5904\u4e8e\u4e25\u5bc6\u7684\u63a7\u5236\u4e0b\u5e76\u4e14\u6570\u636e\u5e93\u548c\u64cd\u4f5c\u7cfb\u7edf\u7ba1\u7406\u5458\u64cd\u4f5c\u65f6\u53ef\u4ee5\u65b9\u4fbf\u5730\u8054\u7cfb\u3002\u6362\u53e5\u8bdd\u8bf4\uff0c\u4f60\u5fc5\u987b\u4fe1\u4efb\u8fd0\u884c ident \u670d\u52a1\u5668\u7684\u673a\u5668\u3002</p>"},{"location":"postgresql/05.%E5%B8%B8%E7%94%A8SQL/","title":"5. \u5e38\u7528SQL","text":""},{"location":"postgresql/05.%E5%B8%B8%E7%94%A8SQL/#sql","title":"\u5e38\u7528SQL","text":""},{"location":"postgresql/05.%E5%B8%B8%E7%94%A8SQL/#_1","title":"\u547d\u540d","text":""},{"location":"postgresql/05.%E5%B8%B8%E7%94%A8SQL/#_2","title":"\u6807\u8bc6\u7b26\u5b57\u7b26\u8303\u56f4","text":"<p>SQL\u6807\u8bc6\u7b26\u548c\u5173\u952e\u8bcd\u5fc5\u987b\u4ee5\u4e00\u4e2a\u5b57\u6bcd\uff08a-z\uff0c\u4e5f\u53ef\u4ee5\u662f\u5e26\u53d8\u97f3\u7b26\u7684\u5b57\u6bcd\u548c\u975e\u62c9\u4e01\u5b57\u6bcd\uff09\u6216\u4e00\u4e2a\u4e0b\u5212\u7ebf\uff08_\uff09\u5f00\u59cb\u3002\u540e\u7eed\u5b57\u7b26\u53ef\u4ee5\u662f\u5b57\u6bcd\u3001\u4e0b\u5212\u7ebf\uff08_\uff09\u3001\u6570\u5b57\uff080-9\uff09\u6216\u7f8e\u5143\u7b26\u53f7\uff08$\uff09\u3002</p> <p>\u6ce8\u610f\u6839\u636eSQL\u6807\u51c6\u7684\u5b57\u6bcd\u89c4\u5b9a\uff0c\u7f8e\u5143\u7b26\u53f7\u662f\u4e0d\u5141\u8bb8\u51fa\u73b0\u5728\u6807\u8bc6\u7b26\u4e2d\u7684\uff0c\u56e0\u6b64\u5b83\u4eec\u7684\u4f7f\u7528\u53ef\u80fd\u4f1a\u964d\u4f4e\u5e94\u7528\u7684\u53ef\u79fb\u690d\u6027\u3002SQL\u6807\u51c6\u4e0d\u4f1a\u5b9a\u4e49\u5305\u542b\u6570\u5b57\u6216\u8005\u4ee5\u4e0b\u5212\u7ebf\u5f00\u5934\u6216\u7ed3\u5c3e\u7684\u5173\u952e\u8bcd\uff0c\u56e0\u6b64\u8fd9\u79cd\u5f62\u5f0f\u7684\u6807\u8bc6\u7b26\u4e0d\u4f1a\u4e0e\u672a\u6765\u53ef\u80fd\u7684\u6807\u51c6\u6269\u5c55\u51b2\u7a81 \u3002</p>"},{"location":"postgresql/05.%E5%B8%B8%E7%94%A8SQL/#_3","title":"\u6807\u8bc6\u7b26\u5b57\u7b26\u957f\u5ea6","text":"<p>\u7cfb\u7edf\u4e2d\u4e00\u4e2a\u6807\u8bc6\u7b26\u7684\u957f\u5ea6\u4e0d\u80fd\u8d85\u8fc7 NAMEDATALEN-1 \u5b57\u8282\uff0c\u5728\u547d\u4ee4\u4e2d\u53ef\u4ee5\u5199\u8d85\u8fc7\u6b64\u957f\u5ea6\u7684\u6807\u8bc6\u7b26\uff0c\u4f46\u662f\u5b83\u4eec\u4f1a\u88ab\u622a\u65ad\u3002</p> <p>\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cNAMEDATALEN \u7684\u503c\u4e3a64\uff0c\u56e0\u6b64\u6807\u8bc6\u7b26\u7684\u957f\u5ea6\u4e0a\u9650\u4e3a63\u5b57\u8282\u3002\u5982\u679c\u8fd9\u4e2a\u9650\u5236\u6709\u95ee\u9898\uff0c\u53ef\u4ee5\u5728src/include/pg_config_manual.h\u4e2d\u4fee\u6539 NAMEDATALEN \u5e38\u91cf\u3002</p>"},{"location":"postgresql/05.%E5%B8%B8%E7%94%A8SQL/#_4","title":"\u6807\u8bc6\u7b26\u5927\u5c0f\u5199","text":"<p>\u5728PostgreSQL\u4e2d\uff0c\u4e0d\u5e26\u5f15\u53f7\u7684\u6807\u8bc6\u7b26\uff08\u4f8b\u5982\u8868\u540d\u3001\u5217\u540d\u7b49\uff09\u603b\u662f\u4f1a\u88ab\u6298\u53e0\u6210\u5c0f\u5199\u3002\u4f8b\u5982\u6807\u8bc6\u7b26FOO\u3001foo\u548c\"foo\"\u5728PostgreSQL\u4e2d\u88ab\u8ba4\u4e3a\u662f\u76f8\u540c\u7684\uff0c\u4f46\u662f\"Foo\"\u548c\"FOO\"\u4e0e\u8fd9\u4e09\u4e2a\u4e0d\u540c\uff0c\u5e76\u4e14\u5f7c\u6b64\u4e0d\u540c\u3002</p> <pre><code>-- \u5373\u4f7f\u8fd9\u91cc\u5efa\u8868\u8bed\u53e5\u5b9a\u4e49\u4e3a\"DB_TEST\"\u3002\u5728PG\u5185\u90e8\uff0c\u8868\u540d\u4f1a\u53d8\u6210\"db_test\"\nCREATE TABLE IF NOT EXISTS db_test.DB_TEST\n(\n  \"id\"               SERIAL       NOT NULL,\n  \"file_id\"          varchar(255) NOT NULL,\n  \"file_name\"        varchar(255) NOT NULL,\n  \"dr\"               int2 DEFAULT 0,\n    \"phone\"            int  DEFAULT 0,\n    \"PHONE\"            int  DEFAULT 0,\n    \"is_admin\"         boolean default false, \n   PRIMARY KEY (\"id\")\n);\n</code></pre> <p>\u5173\u952e\u8bcd\u548c\u4e0d\u88ab\u5f15\u53f7\u4fee\u9970\u7684\u6807\u8bc6\u7b26\u662f\u5927\u5c0f\u5199\u4e0d\u654f\u611f\u7684</p> <pre><code>--\u4e0b\u9762\u4e24\u6761SQL\u662f\u7b49\u4ef7\u7684\nUPDATE MY_TABLE SET A = 5;\n\nuPDaTE my_TabLE SeT a = 5;\n</code></pre>"},{"location":"postgresql/05.%E5%B8%B8%E7%94%A8SQL/#_5","title":"\u7528\u6237\u7ba1\u7406","text":"<p>\u5728UNIX\u5e73\u53f0\u4e2d\u5b89\u88c5PostgreSQL\u4e4b\u540e\uff0cPostgreSQL\u4f1a\u5728UNIX\u7cfb\u7edf\u4e2d\u521b\u5efa\u4e00\u4e2a\u540d\u4e3a<code>postgres</code>\u7684\u64cd\u4f5c\u7cfb\u7edf\u7528\u6237\u3002PostgreSQL\u7684<code>\u9ed8\u8ba4\u7528\u6237\u540d</code>,<code>\u5bc6\u7801</code>\u548c<code>\u9ed8\u8ba4\u6570\u636e\u5e93</code>\u4e5f\u662f<code>postgres</code>\u3002</p> <p>\u5982\u679c\u662f\u5305\u7ba1\u7406\u5668\u5b89\u88c5\uff0c\u4e00\u822c\u4f1a\u81ea\u52a8\u521b\u5efa\u8fd9\u4e2a\u7528\u6237\uff0c\u5982\u679c\u662f\u6e90\u4ee3\u7801\u7f16\u8bd1\u5b89\u88c5\uff0c\u4e00\u822c\u4e5f\u5efa\u8bae\u521b\u5efa\u4e00\u4e2a\u8fd9\u6837\u7684\u7528\u6237\u3002Linux\u4e2d\u7684postgresql\u8fdb\u7a0b\u901a\u5e38\u662f\u7531\u64cd\u4f5c\u7cfb\u7edf\u7684postgres\u7528\u6237\u6765\u542f\u52a8\u7684\u3002</p> <p>\u5f53\u4f60\u8fde\u63a5\u5230\u4e00\u4e2a\u6570\u636e\u5e93\u65f6\uff0c\u4f60\u53ef\u4ee5\u9009\u62e9\u4ee5\u4f55\u79cdPostgreSQL\u7528\u6237\u540d\u8fdb\u884c\u8fde\u63a5\u7684\uff1b\u5982\u679c\u4f60\u4e0d\u9009\u62e9\uff0c\u90a3\u4e48\u7f3a\u7701\u5c31\u662f\u4f60\u7684\u5f53\u524d\u64cd\u4f5c\u7cfb\u7edf\u7684\u8d26\u53f7\u3002</p> <p>\u5982\u679c\u8fd9\u6837\uff0c\u90a3\u4e48\u603b\u5e94\u8be5\u6709\u4e00\u4e2a\u4e0e\u64cd\u4f5c\u7cfb\u7edf\u7528\u6237\u540c\u540d\u7684PostgreSQL\u7528\u6237\u8d26\u53f7\u7528\u4e8e\u542f\u52a8\u670d\u52a1\u5668\uff0c \u5e76\u4e14\u901a\u5e38\u8fd9\u4e2a\u7528\u6237\u90fd\u6709\u521b\u5efa\u6570\u636e\u5e93\u7684\u6743\u9650\u3002</p> <p>\u5982\u679c\u4f60\u4e0d\u60f3\u4ee5\u8be5\u7528\u6237\u8eab\u4efd\u767b\u5f55\uff0c \u90a3\u4e48\u4f60\u4e5f\u53ef\u4ee5\u5728\u4efb\u4f55\u5730\u65b9\u58f0\u660e\u4e00\u4e2a-U\u9009\u9879\u4ee5\u9009\u62e9\u4e00\u4e2a\u7528\u4e8e\u8fde\u63a5\u7684PostgreSQL\u7528\u6237\u540d\u3002</p> <p>PostgreSQL\u5b89\u88c5\u540e\u9ed8\u8ba4\u7528\u6237\u540d\u548c\u6570\u636e\u5e93\u4e5f\u662f\u201cpostgres\u201d\uff0c\u8fd9\u4e2a\u7528\u6237\u4e3a\u8d85\u7ea7\u7ba1\u7406\u5458\u4e14\u9ed8\u8ba4\u6ca1\u6709\u5bc6\u7801\u3002\u5728\u5b89\u88c5PostgreSQL\u4e4b\u540e\u53ef\u4ee5\u4ee5\u9ed8\u8ba4\u7528\u6237\u767b\u5f55\uff0c\u4e5f\u53ef\u4ee5\u521b\u5efa\u65b0\u5f53\u7528\u6237\u540d\u3002</p> <p>\u5b89\u88c5\u540e\uff0c\u7b2c\u4e00\u4ef6\u4e8b\u5c31\u662f\u7528\u547d\u4ee4\u884c\u767b\u9646\u540e\uff0c\u5e76\u4fee\u6539\u5bc6\u7801</p> <pre><code># \u5728\u521d\u59cb\u5316\u6570\u636e\u5e93\u7cfb\u7edf\u65f6\u6709\u4e00\u4e2a\u9884\u5b9a\u4e49\u7684\u8d85\u7ea7\u7528\u6237\uff0c\u8fd9\u4e2a\u7528\u6237\u7684\u540d\u79f0\u4e0e\u521d\u59cb\u5316\u8be5\u6570\u636e\u5e93\u7684\u64cd\u4f5c\u7cfb\u7edf\u7528\u6237\u540d\u76f8\u540c\u3002\u5728Linux\u7ec8\u7aef\u4e2d\uff0c\u5207\u6362\u5230\u64cd\u4f5c\u7cfb\u7edf\u7684postgre\u7528\u6237\nsu postgres \n\n# \u767b\u9646\u5230pg\u4e2d: \u4e3b\u673a\uff0c\u7aef\u53e3\uff0c\u7528\u6237\u540d\uff0c\u5bc6\u7801\uff0c\u4f7f\u7528\u7684\u6570\u636e\u5e93\npsql  -h localhost -p 54321 -U postgres -w password -d postgres\n\n# \u4fee\u6539\u8d85\u7ba1\u7528\u6237\u7684\u5bc6\u7801\nALTER USER postgres WITH PASSWORD 'Password@123';\n</code></pre> <p>\u5b98\u65b9\u5efa\u8bae\u662f\u8fd9\u6837\u7684\uff1a</p> <p>\u5728\u7ba1\u7406\u5458\u521b\u5efa\u4e00\u4e2a\u5177\u4f53\u6570\u636e\u5e93\u540e\uff0c\u5e94\u8be5\u4e3a\u6240\u6709\u53ef\u4ee5\u8fde\u63a5\u5230\u8be5\u6570\u636e\u5e93\u7684\u7528\u6237\u5206\u522b\u521b\u5efa\u4e00\u4e2a\u4e0e\u7528\u6237\u540d\u76f8\u540c\u7684\u6a21\u5f0f\uff0c\u7136\u540e\uff0c\u5c06search_path\u8bbe\u7f6e\u4e3a\"$user\"(\u5373\u7f3a\u7701\u6a21\u5f0f\u4e3a\u4e0e\u7528\u6237\u540d\u76f8\u540c\u7684\u6a21\u5f0f)\uff0c\u8fd9\u6837\uff0c\u4efb\u4f55\u5f53\u67d0\u4e2a\u7528\u6237\u8fde\u63a5\u4e0a\u6765\u540e\uff0c\u4f1a\u9ed8\u8ba4\u5c06\u67e5\u627e\u6216\u8005\u5b9a\u4e49\u7684\u5bf9\u8c61\u90fd\u5b9a\u4f4d\u5230\u4e0e\u4e4b\u540c\u540d\u7684\u6a21\u5f0f\u4e2d\u3002\u8fd9\u662f\u4e00\u4e2a\u597d\u7684\u8bbe\u8ba1\u67b6\u6784\u3002</p> <p>\u4e0d\u5efa\u8bae\u9879\u76ee\u7684\u8868\u5b58\u653e\u5728public\u4e0b\uff1a</p> <pre><code>- \u4e00\u662f\u6570\u636e\u5b89\u5168\uff1b\n- \u4e8c\u662f\u8868\u5b58\u653e\u6df7\u4e71\uff1b\u4e0d\u5229\u4e8e\u540e\u671f\u7ef4\u62a4\u7b49\u7b49\n</code></pre> <pre><code>CREATE ROLE david;\u3000\u3000/*\u9ed8\u8ba4\u4e0d\u5e26LOGIN\u5c5e\u6027*/\nCREATE USER sandy WITH PASSWORD 'password';\u3000\u3000/*\u9ed8\u8ba4\u5177\u6709LOGIN\u5c5e\u6027*/\nALTER USER sandy WITH PASSWORD 'password';     /*\u4fee\u6539\u7528\u6237\uff0c\u4e3a\u5176\u8bbe\u7f6e\u5bc6\u7801*/\n\n-- \u7528\u6237sandy\u53ef\u4ee5\u767b\u5f55\uff0c\u89d2\u8272david\u4e0d\u53ef\u4ee5\u767b\u5f55\u3002\n\nSELECT * from pg_roles;  -- \u67e5\u770b\u89d2\u8272\nSELECT * from pg_user;   -- \u67e5\u770b\u7528\u6237\uff0c\u89d2\u8272david\u521b\u5efa\u65f6\u6ca1\u6709\u5206\u914dlogin\u6743\u9650\uff0c\u6240\u4ee5\u6ca1\u6709\u521b\u5efa\u7528\u6237\n\n\n-- \u5f53\u6211\u4eec\u521b\u5efa\u4e00\u4e2a\u7528\u6237\uff0c\u7528\u6237\u9ed8\u8ba4\u5177\u6709\u4ec0\u4e48\u6743\u9650\uff1f\n</code></pre> <p>\u5728<code>PostgreSQL</code>\u91cc\u6ca1\u6709\u533a\u5206\u7528\u6237\u548c\u89d2\u8272\u7684\u6982\u5ff5\uff0c\"CREATE USER\" \u662f \"CREATE ROLE\"\u7684\u522b\u540d</p> <p>\u8fd9\u4e24\u4e2a\u547d\u4ee4\u51e0\u4e4e\u662f\u5b8c\u5168\u76f8\u540c\u7684\uff0c\u552f\u4e00\u7684\u533a\u522b\u662f<code>CREATE USER</code>\u547d\u4ee4\u521b\u5efa\u7684\u7528\u6237\u9ed8\u8ba4\u5e26\u6709LOGIN\u5c5e\u6027\uff0c\u800c<code>CREATE ROLE</code>\u547d\u4ee4\u521b\u5efa\u7684\u7528\u6237\u9ed8\u8ba4\u4e0d\u5e26LOGIN\u5c5e\u6027\u3002</p> <p>CREATE USER is equivalent to CREATE ROLE except that CREATE USER assumes LOGIN by default, while CREATE ROLE does not</p> <p>\u7528\u6237\u548c\u89d2\u8272\u5728\u6574\u4e2a\u6570\u636e\u5e93\u5b9e\u4f8b\u4e2d\u662f\u5168\u5c40\u7684\uff0c\u5728\u540c\u4e00\u4e2a\u5b9e\u4f8b\u4e2d\u7684\u4e0d\u540c\u6570\u636e\u5e93\u4e2d\uff0c\u770b\u5230\u7684\u7528\u6237\u90fd\u662f\u76f8\u540c\u7684\u3002</p> <pre><code>CREATE ROLE role_name;\n</code></pre> <p><code>PUBLIC</code>\u662f <code>PostgreSQL</code> \u6570\u636e\u5e93\u4e2d\u4e00\u4e2a\u7279\u6b8a\u7684\u89d2\u8272\u7ec4\uff0c\u5728\u5143\u6570\u636e\u8868\uff08pg_roles\uff09\u4e2d\u90fd\u67e5\u4e0d\u5230\u8be5\u89d2\u8272\uff0c\u6570\u636e\u5e93\u4e2d\u6240\u521b\u5efa\u7684\u89d2\u8272\u90fd\u53ef\u4ee5\u7406\u89e3\u4e3a\u662f<code>PUBLIC</code>\u89d2\u8272\u7ec4\u6210\u5458\u3002</p> <p>\u800c\u4e14\u5bf9<code>PUBLIC</code>\u6743\u9650\u7684\u7ee7\u627f\u5b8c\u5168\u4e0d\u53d7<code>NOINHERIT</code>\u7684\u63a7\u5236\uff0c\u4e00\u65e6\u521b\u5efa\u4e86\u4e00\u4e2a\u62e5\u6709 login \u6743\u9650\u7684\u89d2\u8272\uff0c\u5b83\u4f1a\u7acb\u5373\u7ee7\u627f PUBLIC \u89d2\u8272\u7ec4\u62e5\u6709\u7684\u6743\u9650\uff0c\u6b64\u65f6\u5982\u679c\u60f3\u901a\u8fc7 revoke\uff08\u6bd4\u5982 revoke connect on database\uff09\u6765\u56de\u6536\u7684\u8bdd\u4e0d\u4f1a\u6210\u529f\uff0c\u53ea\u80fd\u4ece PUBLIC \u7ec4\u56de\u6536\u76f8\u5173\u6743\u9650\uff08\u6bd4\u5982 revoke connect on database from PUBLIC\uff09\u3002</p>"},{"location":"postgresql/05.%E5%B8%B8%E7%94%A8SQL/#_6","title":"\u6570\u636e\u5e93\u7ba1\u7406","text":"\u6570\u636e\u5e93\u521b\u5efa <p><code>CREATE DATABASE</code>\u5b9e\u9645\u4e0a\u662f\u901a\u8fc7\u62f7\u8d1d\u4e00\u4e2a\u73b0\u6709\u7684\u6570\u636e\u5e93\u8fdb\u884c\u5de5\u4f5c\u7684\u3002\u9ed8\u8ba4\u5730\u5b83\u5c06\u62f7\u8d1d\u540d\u4e3atemplate1\u7684\u6807\u51c6\u7cfb\u7edf\u6570\u636e\u5e93\u3002 </p> <p>\u6240\u4ee5\u8be5\u6570\u636e\u5e93\u662f\u521b\u5efa\u65b0\u6570\u636e\u5e93\u7684\"\u6a21\u677f\"\u3002\u5982\u679c\u4f60\u7ed9template1\u589e\u52a0\u5bf9\u8c61\uff0c\u8fd9\u4e9b\u5bf9\u8c61\u5c06\u88ab\u62f7\u8d1d\u5230\u968f\u540e\u521b\u5efa\u7684\u7528\u6237\u6570\u636e\u5e93\u4e2d\u3002\u8fd9\u6837\u7684\u884c\u4e3a\u5141\u8bb8\u8282\u70b9\u5bf9\u6570\u636e\u5e93\u4e2d\u7684\u6807\u51c6\u5957\u4ef6\u8fdb\u884c\u4fee\u6539\u3002</p> <p>\u6bd4\u5982\uff0c\u5982\u679c\u4f60\u628a\u8fc7\u7a0b\u8bed\u8a00PL/Perl\u5b89\u88c5\u5230template1\u91cc\uff0c \u90a3\u4e48\u4f60\u5728\u521b\u5efa\u7528\u6237\u6570\u636e\u5e93\u7684\u65f6\u5019\u5b83\u4eec\u5c31\u4f1a\u81ea\u52a8\u53ef\u5f97\uff0c\u800c\u4e0d\u9700\u8981\u989d\u5916\u7684\u52a8\u4f5c\u3002</p> <p>PostgreSQL\u9ed8\u8ba4\u6709template0\u3001template1\u4e24\u4e2a\u6a21\u677f\uff0c\u521b\u5efa\u6570\u636e\u5e93\u65f6\u4e0d\u6307\u5b9a\u6a21\u677f\uff0c\u5219\u9ed8\u8ba4\u6a21\u677f\u4e3atemplate1\u3002\u7528\u6237\u4e5f\u53ef\u4ee5\u6307\u5b9a\u5176\u4ed6\u7684\u81ea\u5b9a\u4e49\u6a21\u677f\u521b\u5efa\u6570\u636e\u5e93\u3002</p> <ul> <li> <p>\u4f7f\u7528 template1 \u6a21\u677f\u5e93\u5efa\u5e93\u65f6\u4e0d\u53ef\u6307\u5b9a\u65b0\u7684\u5b57\u7b26\u96c6\u548c\u672c\u5730\u5316collate\u5c5e\u6027</p> </li> <li> <p>\u4f7f\u7528 template0 \u6a21\u677f\u5e93\u5efa\u5e93\u65f6\u53ef\u6307\u5b9a\u5b57\u7b26\u96c6\u548c\u672c\u5730\u5316collate\u5c5e\u6027</p> </li> </ul> <pre><code>-- \u5efa\u5e93\nCREATE DATABASE db_test  WITH OWNER fengzhao tablespace pg_default;\n\nCREATE DATABASE db_test\n WITH  \n    OWNER = stxz                     --\u5c5e\u4e3b\uff0c\u9ed8\u8ba4\u662fdefault\uff0c\u8868\u793a\u5f53\u524d\u6267\u884csql\u7684\u7528\u6237\n    TEMPLATE = template0             --\u6a21\u677f\u5e93\uff0c\u9ed8\u8ba4\u662ftemplate1\n    ENCODING = UTF8                  --\u8981\u5728\u65b0\u6570\u636e\u5e93\u4e2d\u4f7f\u7528\u7684\u5b57\u7b26\u96c6\u7f16\u7801\u3002\u4e00\u822c\u7528utf8\u5c31\u591f\u4e86\n    LC_COLLATE = 'zh_CN.utf8'        --\u8981\u5728\u65b0\u6570\u636e\u5e93\u4e2d\u4f7f\u7528\u7684\u6574\u7406\u987a\u5e8f (LC_COLLATE)\u3002\u8fd9\u4f1a\u5f71\u54cd\u5e94\u7528\u4e8e\u5b57\u7b26\u4e32\u7684\u6392\u5e8f\u987a\u5e8f\u3002\n    LC_CTYPE = 'zh_CN.utf8'          --\u8981\u5728\u65b0\u6570\u636e\u5e93\u4e2d\u4f7f\u7528\u7684\u5b57\u7b26\u5206\u7c7b (LC_CTYPE)\u3002\u8fd9\u4f1a\u5f71\u54cd\u5b57\u7b26\u7684\u5206\u7c7b\uff0c\u4f8b\u5982\u5c0f\u5199\u3001\u5927\u5199\u548c\u6570\u5b57\u3002\n    TABLESPACE = default             --\u8868\u7a7a\u95f4\uff0c\u9ed8\u8ba4\u662fdefault\n    ALLOW_CONNECTIONS = true         --\u662f\u5426\u5141\u8bb8\u8fde\u63a5\u5230\u6b64\u6570\u636e\u5e93\u3002\u5982\u679c\u4e3a false\uff0c\u5219\u6ca1\u6709\u4eba\u53ef\u4ee5\u8fde\u63a5\u5230\u8be5\u6570\u636e\u5e93\u3002\u9ed8\u8ba4\u503c\u4e3a true\uff0c\u5141\u8bb8\u8fde\u63a5\u3002\n    CONNECTION LIMIT = -1            --\u8fde\u63a5\u6570\u9650\u5236\u3002-1\uff08\u9ed8\u8ba4\uff09\u8868\u793a\u6ca1\u6709\u9650\u5236\u3002\n    IS_TEMPLATE = 0                  --\u662f\u5426\u53ef\u4e3a\u6a21\u677f\n;   \n\n-- \u5982\u679c\u62a5\u9519 invalid LC_COLLATE locale name: \"zh_CN.utf8\"\uff0c\u90a3\u4e48\u8868\u793a\u8981\u63d0\u524d\u53bbLinux\u4e0a\u8bbe\u7f6e\u4e00\u4e0blocale-gen zh_CN.utf8\uff0c\u5e76\u91cd\u542fpg\u751f\u6548\n\n-- \u67e5\u770b\u6240\u6709\u6570\u636e\u5e93\nSELECT *  FROM pg_database;\n\n-- \n</code></pre> <pre><code>-----------------------------------------------------------------------------------------------------------------\n-- \u5efa\u5e93\n-- CREATE DATABASE\u5b9e\u9645\u4e0a\u662f\u901a\u8fc7\u62f7\u8d1d\u4e00\u4e2a\u73b0\u6709\u7684\u6570\u636e\u5e93\u8fdb\u884c\u5de5\u4f5c\u7684\u3002\u9ed8\u8ba4\u5730\u5b83\u5c06\u62f7\u8d1d\u540d\u4e3atemplate1\u7684\u6807\u51c6\u7cfb\u7edf\u6570\u636e\u5e93\u3002 \n-- \u6240\u4ee5\u8be5\u6570\u636e\u5e93\u662f\u521b\u5efa\u65b0\u6570\u636e\u5e93\u7684\"\u6a21\u677f\"\u3002\u5982\u679c\u4f60\u7ed9template1\u589e\u52a0\u5bf9\u8c61\uff0c\u8fd9\u4e9b\u5bf9\u8c61\u5c06\u88ab\u62f7\u8d1d\u5230\u968f\u540e\u521b\u5efa\u7684\u7528\u6237\u6570\u636e\u5e93\u4e2d\u3002\u8fd9\u6837\u7684\u884c\u4e3a\u5141\u8bb8\u8282\u70b9\u5bf9\u6570\u636e\u5e93\u4e2d\u7684\u6807\u51c6\u5957\u4ef6\u8fdb\u884c\u4fee\u6539\u3002 \n-- \u6bd4\u5982\uff0c\u5982\u679c\u4f60\u628a\u8fc7\u7a0b\u8bed\u8a00PL/Perl\u5b89\u88c5\u5230template1\u91cc\uff0c \u90a3\u4e48\u4f60\u5728\u521b\u5efa\u7528\u6237\u6570\u636e\u5e93\u7684\u65f6\u5019\u5b83\u4eec\u5c31\u4f1a\u81ea\u52a8\u53ef\u5f97\uff0c\u800c\u4e0d\u9700\u8981\u989d\u5916\u7684\u52a8\u4f5c\u3002\n\n-- PostgreSQL\u9ed8\u8ba4\u6709template0\u3001template1\u4e24\u4e2a\u6a21\u677f\uff0c\u521b\u5efa\u6570\u636e\u5e93\u65f6\u4e0d\u6307\u5b9a\u6a21\u677f\uff0c\u5219\u9ed8\u8ba4\u6a21\u677f\u4e3atemplate1\u3002\u7528\u6237\u4e5f\u53ef\u4ee5\u6307\u5b9a\u5176\u4ed6\u7684\u81ea\u5b9a\u4e49\u6a21\u677f\u521b\u5efa\u6570\u636e\u5e93\u3002\n-- \u4f7f\u7528 template1 \u6a21\u677f\u5e93\u5efa\u5e93\u65f6\u4e0d\u53ef\u6307\u5b9a\u65b0\u7684\u5b57\u7b26\u96c6\u548c\u672c\u5730\u5316collate\u5c5e\u6027\n-- \u4f7f\u7528 template0 \u6a21\u677f\u5e93\u5efa\u5e93\u65f6\u53ef\u6307\u5b9a\u5b57\u7b26\u96c6\u548c\u672c\u5730\u5316collate\u5c5e\u6027\n\n-- \u5efa\u5e93\u6307\u5b9aowner\uff0c\u6307\u5b9a\u8868\u7a7a\u95f4\uff0c\u8fd9\u65f6\u9ed8\u8ba4\u7684\u6a21\u677f\u5c31\u662ftemplate1\nCREATE  db_test  WITH OWNER fengzhao tablespace pg_default;\n\n\n-- LC_COLLATE\uff08\u5b57\u7b26\u6392\u5e8f\u89c4\u5219\uff09\u9ed8\u8ba4en_US.utf8\u3002\u4e0d\u540c\u7684\u6392\u5e8f\u89c4\u5219\u4e0b\uff0c\u76f8\u540c\u5b57\u7b26\u4e32\u7684\u6bd4\u8f83\u5176\u7ed3\u679c\u53ef\u80fd\u662f\u4e0d\u540c\u7684\u3002\n-- LC_CTYPE\uff08\u5b57\u7b26\u5206\u7c7b\uff09\u5b57\u7b26\u96c6\u4e2d\u7684\u5b57\u7b26\u5206\u7c7b\uff0c\u7528\u6765\u533a\u5206\u5b57\u6bcd\u3001\u6570\u5b57\u3001\u53ca\u5927\u5c0f\u5199\u7b49\uff0c\u652f\u6301\u7684\u5b57\u7b26\u5206\u7c7b\u53ef\u4ee5\u67e5\u8be2\u7cfb\u7edf\u8868 pg_collation\u3002\n\n\n-- \u4f7f\u7528 initdb \u521d\u59cb\u5316 PostgreSQL \u6570\u636e\u5e93\u96c6\u7fa4\u65f6\u9009\u62e9\u4e86(\u9ed8\u8ba4\u7ee7\u627f\u81ea\u64cd\u4f5c\u7cfb\u7edflocale\u53d8\u91cf)\u3002\u5728\u521b\u5efa\u6570\u636e\u5e93\u65f6\u53ef\u4ee5\u91cd\u5199\u5b83\uff0c\u56e0\u6b64\u53ef\u4ee5\u4f7f\u7528\u591a\u4e2a\u6570\u636e\u5e93\uff0c\u6bcf\u4e2a\u6570\u636e\u5e93\u5177\u6709\u4e0d\u540c\u7684\u5b57\u7b26\u96c6\u3002\n-- \u5728\u65e5\u5e38\u4f7f\u7528\u4e2d\uff0c\u5f88\u5c11\u4f1a\u7528\u5230\u6307\u5b9a\u6570\u636e\u5e93\u7684\u5b57\u7b26\u96c6\u3002\u56e0\u4e3aPostgreSQL\u6570\u636e\u5e93\u670d\u52a1\u7aef\u5e76\u4e0d\u652f\u6301\u901a\u5e38\u6c49\u5b57\u5b57\u7b26\u96c6\"GBK\"\u3001\"GB18030\",\u6240\u4ee5\u4e00\u822c\u90fd\u7528\"UTF8\"\u5b57\u7b26\u96c6\u6765\u652f\u6301\u4e2d\u6587\u7684\u3002\n\n\n\n--  \u67e5\u8be2\u5b57\u7b26\u96c6\u652f\u6301\u7684LC_COLLATE\u548cLC_CTYPE\u4fe1\u606f\nSELECT pg_encoding_to_char(collencoding) AS encoding,collname,collcollate AS \"LC_COLLATE\",collctype AS \"LC_CTYPE\" FROM pg_collation;\n\n-- \u67e5\u8be2\u67d0\u4e2a\u5e93\u7684\u5b57\u7b26\u96c6\nSELECT datname,datcollate,datctype FROM pg_database WHERE datname = 'test';\n\nCREATE DATABASE db_test\n WITH  \n    OWNER = stxz  \n    TEMPLATE = template0 \n    ENCODING = UTF8 \n    LC_COLLATE = 'zh_CN.utf8'\n    LC_CTYPE = 'zh_CN.utf8'\n    TABLESPACE = default \n    ALLOW_CONNECTIONS = true \n    CONNECTION LIMIT = -1 \n    IS_TEMPLATE = 0 \n;            \n\n\n\nGRANT CONNECT ON DATABASE  db_test TO fengzhao;\n\n\n\n-- \u5efa\u6a21\u5f0f\n\nCREATE SCHEMA  IF NOT EXISTS schema_name AUTHORIZATION username;\nCOMMENT ON SCHEMA schema_name is 'test';\nALTER SCHEMA schema_name OWNER TO fengzhao;\n\n\n-----------------------------------------------------------------------------------------------------------------\n\n-- \u9009\u62e9schema\nSET schema 'temp';\n\n-- \u5efa\u8868\nCREATE TABLE db_test.dim_admin_area (\n  rid SERIAL PRIMARY KEY,\n  qh_base_id BIGINT,\n  source_code TEXT,\n  update_time TIMESTAMP,\n  cur_code VARCHAR(50),\n  cur_name VARCHAR(50),\n  parent_code VARCHAR(50),\n  country_code VARCHAR(50),\n  country_name VARCHAR(50),\n  province_code VARCHAR(50),\n  province_name VARCHAR(50),\n  city_code VARCHAR(50),\n  city_name VARCHAR(50),\n  area_code VARCHAR(50),\n  area_name VARCHAR(50),\n  street_code VARCHAR(50),\n  street_name VARCHAR(50),\n  community_code VARCHAR(50),\n  community_name VARCHAR(50),\n  cur_level INTEGER,\n  cur_order INTEGER,\n  uid TEXT,\n  border_id VARCHAR(50),\n  version VARCHAR(50),\n  UNIQUE (cur_code),\n  UNIQUE (qh_base_id)\n);\n\nCOMMENT ON TABLE dim_admin_area IS '\u884c\u653f\u533a\u5212\u4ee3\u7801';\nCOMMENT ON COLUMN dim_admin_area.rid IS '\u884cID';\nCOMMENT ON COLUMN dim_admin_area.qh_base_id is  '\u5bf9\u8c61id';\nCOMMENT ON COLUMN dim_admin_area.source_code is  '\u6570\u636e\u6e90\u4ee3\u7801';\nCOMMENT ON COLUMN dim_admin_area.cur_code is  '\u5f53\u524d\u7f16\u7801';\nCOMMENT ON COLUMN dim_admin_area.cur_name is  '\u5f53\u524d\u540d\u79f0';\nCOMMENT ON COLUMN dim_admin_area.parent_code is  '\u7236\u7ea7\u7f16\u7801';\nCOMMENT ON COLUMN dim_admin_area.country_code is  '\u56fd\u5bb6\u7f16\u7801';\nCOMMENT ON COLUMN dim_admin_area.country_name is  '\u56fd\u5bb6\u540d\u79f0';\nCOMMENT ON COLUMN dim_admin_area.province_code is  '\u7701(\u81ea\u6cbb\u533a/\u76f4\u8f96\u5e02)\u7f16\u7801';\nCOMMENT ON COLUMN dim_admin_area.province_name is  '\u7701(\u81ea\u6cbb\u533a/\u76f4\u8f96\u5e02)\u540d\u79f0';\nCOMMENT ON COLUMN dim_admin_area.city_code is  '\u5730(\u533a/\u5e02/\u5dde/\u76df)\u7f16\u7801';\nCOMMENT ON COLUMN dim_admin_area.city_name is  '\u5730(\u533a/\u5e02/\u5dde/\u76df)\u540d\u79f0';\nCOMMENT ON COLUMN dim_admin_area.area_code is  '\u53bf(\u533a/\u5e02/\u65d7)\u7f16\u7801';\nCOMMENT ON COLUMN dim_admin_area.area_name is  '\u53bf(\u533a/\u5e02/\u65d7)\u540d\u79f0';\nCOMMENT ON COLUMN dim_admin_area.street_code is  '\u8857\u9053\u529e\u4e8b\u5904\u7f16\u7801';\nCOMMENT ON COLUMN dim_admin_area.street_name is  '\u8857\u9053\u529e\u4e8b\u5904\u540d\u79f0';\nCOMMENT ON COLUMN dim_admin_area.community_code is  '\u793e\u533a/\u793e\u533a\u5c45\u59d4\u4f1a\u7f16\u7801';\nCOMMENT ON COLUMN dim_admin_area.community_name is  '\u793e\u533a/\u793e\u533a\u5c45\u59d4\u4f1a\u540d\u79f0';\nCOMMENT ON COLUMN dim_admin_area.cur_level is  '\u7f16\u7801\u7b49\u7ea7';\nCOMMENT ON COLUMN dim_admin_area.cur_order is  '\u7f16\u7801\u987a\u5e8f';\n\n-- \u5efa\u8868\n\nCREATE TABLE IF NOT EXISTS \"db_TEST\"\n(\n  \"id\"               SERIAL       NOT NULL,\n  \"file_id\"          varchar(255) NOT NULL,\n  \"file_name\"        varchar(255) NOT NULL,\n  \"dr\"               int2 DEFAULT 0,\n    \"PHONE\"            int  DEFAULT 0,\n    \"is_admin\"         boolean default false, \n   PRIMARY KEY (\"id\")\n);\n\n\nCREATE TABLE products (\n    id SERIAL PRIMARY KEY,             -- ID    \u4e3b\u952e\uff0c\u9ed8\u8ba4\u503c\u4e3a\u81ea\u589e\u6570\u503c\u7c7b\u578b\uff0cSERIAL \u662f\u4e00\u79cd\u7b80\u5199\u65b9\u5f0f\uff0c\u76f8\u5f53\u4e8e DEFAULT nextval('products_id_seq')\n    no integer,                        -- \u7f16\u53f7   \u672a\u6307\u5b9a\u9ed8\u8ba4\u503c\uff0c\u9ed8\u8ba4\u503c\u5c06\u4f1a\u662f null\n    name text,                         -- \u540d\u79f0   \u672a\u6307\u5b9a\u9ed8\u8ba4\u503c\uff0c\u9ed8\u8ba4\u503c\u5c06\u4f1a\u662f null\n    price numeric(6,2) DEFAULT 9.99 ,   -- \u4ef7\u683c   \u9ed8\u8ba4\u503c\u662f 9.99\n    created_at timestamp DEFAULT now() -- \u521b\u5efa\u65f6\u95f4   \u9ed8\u8ba4\u503c\u4e3a\u63d2\u5165\u65f6\u95f4\n);\n\n\nCREATE TABLE products (\n    no integer,\n    name text,\n    price numeric CHECK (price &gt; 0)    --\u7ea6\u675f\uff0c \u4ef7\u683c\u5927\u4e8e0 \n    -- price numeric CONSTRAINT positive_price CHECK (price &gt; 0) -- \u53ef\u7ed9\u7ea6\u675f\u8d77\u4e00\u4e2a\u540d\u5b57\n    -- \u68c0\u67e5\u7ea6\u675f\u662f\u6700\u901a\u7528\u7684\u7ea6\u675f\u7c7b\u578b\u3002\u53ef\u4ee5\u4f7f\u7528\u5176\u6765\u6307\u5b9a\u67d0\u5217\u6ee1\u8db3\u4e00\u4e2a\u5e03\u5c14\uff08\u771f\u503c\uff09\u8868\u8fbe\u5f0f\u3002\u5982\uff1a\u60f3\u6307\u5b9a\u4ea7\u54c1\u4ef7\u683c\u5fc5\u987b\u662f\u6b63\u6570\u7c7b\u578b\uff0c\n    -- \u7ea6\u675f\u5b9a\u4e49\u5c31\u50cf\u9ed8\u8ba4\u503c\u5b9a\u4e49\u4e00\u6837\u7d27\u8ddf\u6570\u636e\u7c7b\u578b\u4e4b\u540e\u3002\u68c0\u67e5\u7ea6\u675f\u7531CHECK\u5173\u952e\u5b57\u548c\u4e00\u4e2a\u62ec\u53f7\u8868\u8fbe\u5f0f\u7ec4\u6210\u3002\u7ea6\u675f\u5b9a\u4e49\u4e0e\u9ed8\u8ba4\u503c\u5b9a\u4e49\u7684\u987a\u5e8f\u6ca1\u6709\u8981\u6c42\u3002\n);\n\n\nCREATE TABLE products (\n    no INTEGER,                                             -- \u4ea7\u54c1\u7f16\u53f7\n    name TEXT,                                              -- \u4ea7\u54c1\u540d\u79f0\n    price NUMERIC CHECK (price &gt; 0),                        -- \u4ef7\u683c(\u7ea6\u675f:\u4ef7\u683c\u5927\u4e8e0)\n    discounted_price numeric CHECK (discounted_price &gt; 0),  -- \u6298\u6263\u4ef7(\u7ea6\u675f:\u4ef7\u683c\u5927\u4e8e0)\n    CHECK (price &gt; discounted_price)                        -- \u7ea6\u675f:(\u6298\u6263\u4ef7\u4f4e\u4e8e\u6b63\u5e38\u4ef7)\n    -- \u5217\u5b9a\u4e49\u4e0e\u8fd9\u4e9b\u7ea6\u675f\u5b9a\u4e49\u53ef\u4ee5\u6309\u6df7\u5408\u987a\u5e8f\u51fa\u73b0\u3002\u6211\u4eec\u53eb\u524d\u4e24\u79cd\u7ea6\u675f\u4e3a\u5217\u7ea6\u675f\uff0c\u7b2c\u4e09\u4e2a\u4e3a\u8868\u7ea6\u675f\u3002\n);\n\n\n\n\n-- \u68c0\u67e5\u8868\u8fbe\u5f0f\u8ba1\u7b97\u4e3atrue\u6216null\u5747\u8ba4\u4e3a\u662f\u6ee1\u8db3\u6761\u4ef6\u7684\u3002\u6240\u4ee5\u4e0b\u9762\u7684\u63d2\u5165\u8bed\u53e5\u662f\u53ef\u4ee5\u901a\u8fc7\u7684\nINSERT INTO products (no, name, price, discounted_price)\n    VALUES (1, 'apple', null, null);\n\n\n-- \u5efa\u8868\n\nCREATE TABLE employees( \n    employee_id INTEGER NOT NULL, \n    first_name CHARACTER VARYING(20),\n    last_name CHARACTER VARYING(25) NOT NULL, \n    email CHARACTER VARYING(25) NOT NULL, \n    phone_number CHARACTER VARYING(20), \n    hire_date DATE NOT NULL, \n    salary NUMERIC(8,2), \n    commission_pct NUMERIC(2,2), \n    manager_id INTEGER,\n    department_id INTEGER,\n    CONSTRAINT emp_emp_id_pk PRIMARY KEY (employee_id),\n    CONSTRAINT emp_salary_min CHECK (salary &gt; 0),\n    CONSTRAINT emp_email_uk UNIQUE (email), \n    CONSTRAINT emp_dept_fk FOREIGN KEY (department_id) REFERENCES departments(department_id)\n    CONSTRAINT emp_manager_fk FOREIGN KEY (manager_id) REFERENCES employees(employee_id)\n) ;\n\n\n-- employee_id\uff1a\u5458\u5de5\u7f16\u53f7\uff0c\u6574\u6570\u7c7b\u578b\uff0c\u4e3b\u952e\uff08\u901a\u8fc7\u8868\u7ea7\u7ea6\u675f\u4e3a\u4e3b\u952e\u6307\u5b9a\u4e86\u540d\u79f0emp_emp_id_pk\uff09\n-- first_name\uff1a\u5458\u5de5\u540d\u5b57\uff0c\u5b57\u7b26\u4e32\n-- last_name\uff1a\u5458\u5de5\u59d3\u6c0f\uff0c\u5b57\u7b26\u4e32\uff0c\u4e0d\u80fd\u4e3a\u7a7a\n-- email\uff1a\u5458\u5de5\u7535\u5b50\u90ae\u7bb1\uff0c\u5b57\u7b26\u4e32\uff0c\u4e0d\u80fd\u4e3a\u7a7a\uff0c\u5fc5\u987b\u552f\u4e00\uff08emp_email_uk\uff09\n-- phone_number\uff1a\u5458\u5de5\u7535\u8bdd\u53f7\u7801\uff0c\u5b57\u7b26\u4e32\n-- hire_date\uff1a\u5458\u5de5\u96c7\u4f63\u65e5\u671f\uff0c\u65e5\u671f\u7c7b\u578b\uff0c\u4e0d\u80fd\u4e3a\u7a7a\n-- salary\uff1a\u5458\u5de5\u85aa\u6c34\uff0c\u6570\u5b57\u7c7b\u578b\uff0c\u5fc5\u987b\u5927\u4e8e\u96f6\uff08emp_salary_min\uff09\n-- commission_pct\uff1a\u5458\u5de5\u4f63\u91d1\u767e\u5206\u6bd4\uff0c\u6570\u5b57\u7c7b\u578b\n-- manager_id\uff1a\u7ecf\u7406\u7f16\u53f7\uff0c\u5916\u952e\uff08\u901a\u8fc7\u5916\u952e emp_manager_fk \u5f15\u7528\u5458\u5de5\u8868\u7684\u5458\u5de5\u7f16\u53f7\uff09\n-- department_id\uff0c\u90e8\u95e8\u7f16\u53f7\uff0c\u5916\u952e\uff08\u901a\u8fc7\u5916\u952e emp_dept_fk \u5f15\u7528\u90e8\u95e8\u8868 departments \u7684\u7f16\u53f7department_id\uff09\n\n\nCREATE TABLE IF NOT EXISTS \"DB_TEST\"\n(\n  \"id\"               SERIAL       NOT NULL,\n  \"file_id\"          varchar(255) NOT NULL,\n  \"file_name\"        varchar(255) NOT NULL,\n  \"dr\"               int2 DEFAULT 0,\n    \"phone\"            int  DEFAULT 0,\n    \"PHONE\"            int  DEFAULT 0,\n    \"is_admin\"         boolean default false, \n   PRIMARY KEY (\"id\")\n);\n\n\ninsert into \"DB_TEST\" values(1,'abc','xyz',1,1,1,true)\ninsert into \"DB_TEST\" values(2,'abc','xyz',1,1,2,true)\n\ninsert into \"db_TEST\" values(1,'\u5173\u7fbd','\u5f20\u98de',1,1,true);\ninsert into \"db_TEST\" values(2,'\u5218\u5907','\u8d75\u4e91',1,1,true);\n\n\n\n\n\nselect * from \"DB_TEST\"\nselect * from \"db_TEST\"\n\nselect \"phone\", \"PHONE\" from \"DB_TEST\"\n\n\n\n-----------------------------------------------------------------------------------------------------------------\n\n\n\n\n\n\nselect *  from pg_database;\nselect * from pg_user;\nselect * from pg_stat_activity;\n</code></pre>"},{"location":"postgresql/05.%E5%B8%B8%E7%94%A8SQL/#_7","title":"\u7cfb\u7edf\u5b57\u6bb5","text":"<p>\u5728 PostgreSQL \u4e2d\uff0c\u5f53\u6211\u4eec\u521b\u5efa\u4e00\u4e2a\u6570\u636e\u8868\u65f6\uff0c\u6570\u636e\u5e93\u4f1a\u9690\u5f0f\u589e\u52a0\u51e0\u4e2a\u7cfb\u7edf\u5b57\u6bb5\u3002\u8fd9\u4e9b\u5b57\u6bb5\u7531\u7cfb\u7edf\u8fdb\u884c\u7ef4\u62a4\uff0c\u7528\u6237\u4e00\u822c\u4e0d\u4f1a\u611f\u77e5\u5b83\u4eec\u7684\u5b58\u5728\u3002</p> <pre><code>create table test(col integer);\n\ninsert into test(col) values (1),(2),(3);\n</code></pre> <p>\u6211\u4eec\u67e5\u8be2\u6570\u636e\u5b57\u5178\u8868 pg_attribute \u6765\u67e5\u770b\u8868\u7ed3\u6784\u3002</p> <pre><code>select attname, attnum, atttypid::regtype \n    from pg_attribute\nwhere attrelid = 'test'::regclass;\n</code></pre> <p>\u67e5\u8be2\u7ed3\u679c\u663e\u793a\uff0c\u8868 test \u4e2d\u4e00\u5171\u5305\u542b 7 \u4e2a\u5b57\u6bb5\u3002PostgreSQL \u4e3a\u6211\u4eec\u589e\u52a0\u4e86 6 \u4e2a\u989d\u5916\u7684\u7cfb\u7edf\u5b57\u6bb5\uff0c\u5b83\u4eec\u7684 attnum \u5c5e\u6027\u90fd\u662f\u8d1f\u6570\u3002</p>"},{"location":"postgresql/06.%E7%BB%A7%E6%89%BF%E8%A1%A8/","title":"\u7ee7\u627f","text":"<p>PostgreSQL \u652f\u6301\u9ad8\u7ea7\u7684 object-relational \u673a\u5236\u2014\u2014\u2014\u2014\u7ee7\u627f\uff0c\u7ee7\u627f\u5141\u8bb8\u4e00\u5f20\u8868\u7ee7\u627f\u4e00\u5f20\uff08\u6216\u591a\u5f20\uff09\u8868\u7684\u5217\u5c5e\u6027\uff0c\u6765\u5efa\u7acb parent-child \u5173\u7cfb\u3002</p> <p>\u5b50\u8868\u53ef\u4ee5\u7ee7\u627f\u7236\u8868\u7684\u5b57\u6bb5\u4ee5\u53ca\u7ea6\u675f\uff0c\u540c\u65f6\u53ef\u4ee5\u62e5\u6709\u81ea\u5df1\u7684\u5b57\u6bb5\u3002</p> <p>\u5f53\u6267\u884c\u4e00\u4e2a\u7236\u8868\u67e5\u8be2\u7684\u65f6\u5019\uff0c\u8fd9\u4e2a\u67e5\u8be2\u53ef\u4ee5\u83b7\u53d6\u6765\u81ea\u672c\u8868\u548c\u5b83\u7684\u5b50\u8868\uff0c\u4e5f\u53ef\u4ee5\u6307\u5b9a\u53ea\u67e5\u8be2\u672c\u8868\u3002\u5728\u5b50\u8868\u4e2d\u67e5\u8be2\uff0c\u5219\u4e0d\u4f1a\u8fd4\u56de\u7236\u8868\u7684\u6570\u636e\u3002</p> <p>Inheritance\u662fPostgreSQL\u72ec\u6709\u7684\uff0c\u4e5f\u662f\u524d\u6587\u4e2d\u6211\u4eec\u63d0\u5230\u7684\"\u4f7f\u7528\u9762\u5411\u5bf9\u8c61\u7684\u601d\u60f3\u6765\u7ec4\u7ec7\u6570\u636e\u5e93\"\u7684\u5177\u4f53\u4f53\u73b0\u4e4b\u4e00\u3002</p> <pre><code>CREATE TABLE IF NOT EXISTS cities (   --\u7236\u8868:\u57ce\u5e02\u8868 \n    name            text,\n    population      float,\n    elevation       int     -- in feet\n);\n\n\nCREATE TABLE IF NOT EXISTS capitals (  --\u5b50\u8868:\u7701\u4f1a\u8868\n    state           char(2)\n) INHERITS (cities);\n</code></pre> <p>capitals\u8868\u7ee7\u627f\u81eacities\u8868\u7684\u6240\u6709\u5c5e\u6027\u3002</p> <p>\u5728PostgreSQL\u91cc\uff0c\u4e00\u4e2a\u8868\u53ef\u4ee5\u4ece\u96f6\u4e2a\u6216\u591a\u4e2a\u5176\u5b83\u8868\u4e2d\u7ee7\u627f\u5c5e\u6027\uff0c\u4e5f\u800c\u4e14\u4e00\u4e2a\u67e5\u8be2\u65e2\u53ef\u4ee5\u5f15\u7528\u7236\u8868\u4e2d\u7684\u6240\u6709\u884c\uff0c\u53ef\u4ee5\u5f15\u7528\u7236\u8868\u7684\u6240\u6709\u884c\u52a0\u4e0a\u5176\u6240\u6709\u5b50\u8868\u7684\u884c\uff0c\u5176\u4e2d\u540e\u8005\u662f\u7f3a\u7701\u884c\u4e3a\u3002</p> <p>\u5728\u8fd9\u4e2a\u4f8b\u5b50\u4e2d\uff0c\u7236\u8868\u662f\u57ce\u5e02\u8868\u3002</p> <p>\u7701\u4f1a\u5176\u5b9e\u4e5f\u662f\u57ce\u5e02\uff0c\u53ea\u662f\u6bd4\u666e\u901a\u7684\u57ce\u5e02\u591a\u4e86\u4e00\u4e2astate\u5b57\u6bb5\uff0c\u8868\u660e\u662f\u54ea\u4e2a\u7701\u7684\u7701\u4f1a\u3002\u5728\u4e0a\u4f8b\u4e2dcapitals\u8868\u7ee7\u627f\u4e86cities\u8868\u4e2d\u7684\u6240\u6709\u5b57\u6bb5\u3002</p> <p>\u5047\u8bbe\u6709\u6d1b\u9633\uff0c\u90d1\u5dde\u548c\u5f00\u5c01\u4e09\u4e2a\u57ce\u5e02\uff0c\u5176\u4e2d\u90d1\u5dde\u662f\u7701\u4f1a\u57ce\u5e02\u3002\u63d2\u5165\u6570\u636e\u65f6\u53ea\u9700\u8981\u5411capitals\u63d2\u5165\u90d1\u5dde\u7684\u6570\u636e\u5373\u53ef\u3002</p> <p>\u6839\u636e\u9762\u5411\u5bf9\u8c61\u7684\u601d\u60f3\uff0c\u6211\u4eec\u53ef\u4ee5\u8ba4\u4e3a\u8868\u4e2d\u7684\u6bcf\u4e00\u884c\u5c31\u662f\u4e00\u4e2a\u5b9e\u4f8b\u5316\u540e\u7684\u5bf9\u8c61\uff0c\u800c\u90d1\u5dde\u53ea\u5e94\u8be5\u88ab\u5b9e\u4f8b\u5316\u4e00\u6b21\u3002</p> <pre><code>INSERT INTO cities VALUES ('\u6d1b\u9633',1500, 50);  --\u7236\u8868\u63d2\u5165\u6570\u636e1\nINSERT INTO cities VALUES ('\u5f00\u5c01',1000, 50);  --\u7236\u8868\u63d2\u5165\u6570\u636e2\nINSERT INTO capitals VALUES ('\u90d1\u5dde',2000, 50, 'HN');  --\u5b50\u8868\u63d2\u5165\u6570\u636e\n</code></pre> <p>\u7236\u5b50\u8868\u5171\u540c\u7684\u5b57\u6bb5\u7684\u5173\u7cfb\u5e76\u4e0d\u4ec5\u4ec5\u662f\u88c5\u9970\u7528\u7684\u3002\u5728\u5b50\u8868\u4e2d\u63d2\u5165\u6570\u636e\uff0c\u540c\u6837\u5728\u7236\u8868\u662f\u53ef\u89c1\uff0c\u4f46\u662f\u53ea\u80fd\u770b\u5230\u5171\u4eab\u7684\u5b57\u6bb5\u3002\u5982\u679c\u4f60\u60f3\u8981\u5728\u67e5\u8be2\u7236\u8868\u7684\u6570\u636e\uff0c\u5ffd\u7565\u5b50\u8868\uff0c\u53ef\u4ee5\u4f7f\u7528 ONLY \u5173\u952e\u5b57\u3002</p> <p>\u6ce8\u610f\uff1a\u7ed9\u5b50\u8868\u63d2\u5165\u6570\u636e\u7684\u65f6\u5019\uff0c\u5e76\u4e0d\u662f\u540c\u65f6\u628a\u6570\u636e\u4e2d\u7684\u5171\u4eab\u5b57\u6bb5\u63d2\u5165\u5230\u7236\u8868\u4e2d\uff0c\u53ea\u662f\u7b80\u5355\u901a\u8fc7\u7ee7\u627f\u5173\u7cfb\u4f7f\u5b50\u8868\u7684\u6570\u636e\u5728\u7236\u8868\u53ef\u89c1\u3002\u5982\u679c\u4f60\u6307\u5b9a\u4e86 ONLY \u5173\u952e\u5b57\uff0c\u5219\u67e5\u8be2\u4e0d\u5728\u4ece\u5b50\u8868\u4e2d\u83b7\u53d6\u6570\u636e\u3002</p> <pre><code>SELECT * FROM cities ;                        --\u4e0d\u5e26\u6761\u4ef6\u67e5\u7236\u8868\uff0c\u5b50\u8868\u548c\u7236\u8868\u6570\u636e\u5747\u88ab\u53d6\u51fa\uff1a\u6d1b\u9633\uff0c\u5f00\u5c01\uff0c\u90d1\u5dde\nSELECT * FROM cities WHERE population &gt; 0;    --\u5e26\u6761\u4ef6\u67e5\u7236\u8868\uff0c\u5b50\u8868\u548c\u7236\u8868\u6570\u636e\u5747\u88ab\u53d6\u51fa\uff1a\u6d1b\u9633\uff0c\u5f00\u5c01\uff0c\u90d1\u5dde\nSELECT * FROM cities WHERE population &gt; 1700; --\u67e5\u7236\u8868\uff0c\u5b50\u8868\u7236\u8868\u90fd\u67e5\uff0c\u4ec5\u67e5\u51fa\u7b26\u5408\u6761\u4ef6\u7684\uff1a\u90d1\u5dde\n\n\n-- ONLY\u5173\u952e\u5b57\u8868\u793a\u8be5\u67e5\u8be2\u5e94\u8be5\u53ea\u5bf9cities\u8fdb\u884c\u67e5\u627e\u800c\u4e0d\u5305\u62ec\u7ee7\u627f\u7ea7\u522b\u4f4e\u4e8ecities\u7684\u8868\u3002SELECT/UPDATE/DELETE\u90fd\u652f\u6301\u8fd9\u4e2aONLY\u5173\u952e\u5b57\nSELECT name, elevation FROM ONLY  cities WHERE population &gt; 1000;  -- \u53ea\u67e5\u7236\u8868\uff0conly\u5173\u952e\u5b57\uff1a\u4ec5\u67e5\u51fa\u7b26\u5408\u6761\u4ef6\u7684\uff1a\u6d1b\u9633\n</code></pre> <ul> <li>\u7531\u4e8e\u7ee7\u627f\u8868\u7684\u672c\u8d28\u539f\u56e0\uff0c\u4e00\u4e9b\u7ea6\u675f\u6761\u4ef6\u53ef\u80fd\u4f1a\u88ab\u6253\u7834\uff1b\u4f8b\u5982\uff0c\u58f0\u660e\u4e00\u4e2a\u552f\u4e00\u5b57\u6bb5\uff0c\u53ef\u80fd\u5728\u67e5\u8be2\u7ed3\u679c\u4e2d2\u6761\u76f8\u540c\u7684\u503c\u3002</li> <li>\u56e0\u6b64\uff0c\u5728\u4f7f\u7528\u7684\u7ee7\u627f\u7684\u8fc7\u7a0b\u4e2d\uff0c\u4f60\u8981\u7279\u522b\u6ce8\u610f\u7ea6\u675f\uff1b\u56e0\u4e3a\u4ed6\u4eec\u5728\u5404\u81ea\u7684\u8868\u4e2d\u6ca1\u6709\u8fdd\u53cd\u7ea6\u675f\u6761\u4ef6\uff1b\u56e0\u6b64\uff0c\u5982\u679c\u4f60\u5728\u67e5\u8be2\u7236\u8868\u7684\u65f6\u5019\u6ca1\u6709\u6307\u5b9a ONLY \u5b57\u6bb5\uff0c\u90a3\u5b83\u53ef\u80fd\u4f1a\u8fd4\u56de\u4f60\u975e\u9884\u671f\u7684\u7ed3\u679c\u3002</li> </ul> <p>\u6ce8\u610f\u4e8b\u9879</p> <p>\u6570\u636e\u5220\u9664 \u5982\u679c\u76f4\u63a5truncate\u7236\u8868\uff0c\u6b64\u65f6\u7236\u8868\u548c\u5176\u6240\u6709\u5b50\u8868\u7684\u6570\u636e\u5747\u88ab\u5220\u9664\u3002 \u5982\u679c\u53ea\u662ftruncate\u5b50\u8868\uff0c\u90a3\u4e48\u5176\u7236\u8868\u7684\u6570\u636e\u5c06\u4e0d\u4f1a\u53d8\u5316\uff0c\u53ea\u662f\u5b50\u8868\u4e2d\u7684\u6570\u636e\u88ab\u6e05\u7a7a\u3002</p> <ul> <li>\u786e\u5b9a\u6570\u636e\u6765\u6e90</li> </ul> <pre><code>-- \u6709\u65f6\u5019\u4f60\u53ef\u80fd\u60f3\u77e5\u9053\u67d0\u6761\u8bb0\u5f55\u6765\u81ea\u54ea\u4e2a\u8868\u3002\u5728\u6bcf\u4e2a\u8868\u91cc\u6211\u4eec\u90fd\u6709\u4e00\u4e2a\u7cfb\u7edf\u9690\u542b\u5b57\u6bb5tableoid\uff0c\u5b83\u53ef\u4ee5\u544a\u8bc9\u4f60\u8868\u7684\u6765\u6e90\nSELECT tableoid, name, elevation FROM cities WHERE elevation &gt; 500;\n-- \u901a\u8fc7tableiod\u67e5\u8868\u540d\uff0c\u67e5\u7684\u662f\u7236\u8868\uff0c\u6570\u636e\u6765\u6e90\u5b9e\u9645\u662f\u5b50\u8868\nSELECT p.relname, c.name, c.elevation FROM cities c,pg_class p WHERE c.elevation &gt; 500 and c.tableoid = p.oid;\n</code></pre> <ul> <li>\u7ee7\u627f\u5e76\u4e0d\u81ea\u52a8\u4eceINSERT\u6216\u8005COPY\u4e2d\u5411\u7ee7\u627f\u7ea7\u522b\u4e2d\u7684\u5176\u5b83\u8868\u586b\u5145\u6570\u636e\u3002\u5728\u6211\u4eec\u7684\u4f8b\u5b50\u91cc\uff0c\u4e0b\u9762\u7684INSERT\u8bed\u53e5\u4e0d\u4f1a\u6210\u529f\uff1a       INSERT INTO cities (name, population, altitude, state) VALUES ('New York', NULL, NULL, 'NY');</li> <li>\u6211\u4eec\u53ef\u80fd\u5e0c\u671b\u6570\u636e\u88ab\u4f20\u9012\u5230capitals\u8868\u91cc\u9762\u53bb\uff0c\u4f46\u662f\u8fd9\u662f\u4e0d\u4f1a\u53d1\u751f\u7684\uff1aINSERT\u603b\u662f\u63d2\u5165\u660e\u786e\u58f0\u660e\u7684\u90a3\u4e2a\u8868\u3002</li> <li>\u4ece\u8bbe\u8ba1\u7684\u89d2\u5ea6\u6765\u770b\uff0c\u7236\u5b50\u548c\u5b50\u8868\u53ef\u4ee5\u5404\u6709\u5404\u7684\u529f\u7528\u3002\u57ce\u5e02\u8868\uff0c\u53ef\u4ee5\u770b\u6210\u662f\u4e00\u4e2a\u66f4\u5bbd\u6cdb\u7684\u6982\u5ff5\u3002</li> <li>\u7ee7\u627f\u7279\u6027\u7684\u4e00\u4e2a\u4e25\u91cd\u7684\u5c40\u9650\u6027\u662f\u7d22\u5f15(\u5305\u62ec\u552f\u4e00\u7ea6\u675f)\u548c\u5916\u952e\u7ea6\u675f\u53ea\u65bd\u7528\u4e8e\u5355\u4e2a\u8868\uff0c\u800c\u4e0d\u5305\u62ec\u5b83\u4eec\u7684\u7ee7\u627f\u7684\u5b50\u8868\u3002</li> <li>\u8fd9\u4e00\u70b9\u4e0d\u7ba1\u5bf9\u5f15\u7528\u8868\u8fd8\u662f\u88ab\u5f15\u7528\u8868\u90fd\u662f\u4e8b\u5b9e\uff0c\u56e0\u6b64\u5728\u4e0a\u9762\u7684\u4f8b\u5b50\u91cc\uff0c\u5982\u679c\u6211\u4eec\u58f0\u660ecities.name\u4e3aUNIQUE\u6216\u8005\u662f\u4e00\u4e2aPRIMARY KEY\uff0c\u90a3\u4e48\u4e5f\u4e0d\u4f1a\u963b\u6b62capitals\u8868\u62e5\u6709\u91cd\u590d\u4e86\u540d\u5b57\u7684cities\u6570\u636e\u884c\u3002</li> <li>\u5e76\u4e14\u8fd9\u4e9b\u91cd\u590d\u7684\u884c\u7f3a\u7701\u65f6\u5728\u67e5\u8be2cities\u8868\u7684\u65f6\u5019\u4f1a\u663e\u793a\u51fa\u6765\u3002\u5b9e\u9645\u4e0a\uff0c\u7f3a\u7701\u65f6capitals\u5c06\u5b8c\u5168\u6ca1\u6709\u552f\u4e00\u7ea6\u675f\uff0c\u56e0\u6b64\u53ef\u80fd\u5305\u542b\u5e26\u6709\u540c\u540d\u7684\u591a\u4e2a\u884c\u3002</li> <li>\u4f60\u5e94\u8be5\u7ed9capitals\u589e\u52a0\u552f\u4e00\u7ea6\u675f\uff0c\u4f46\u662f\u8fd9\u6837\u505a\u4e5f\u4e0d\u4f1a\u907f\u514d\u4e0ecities\u7684\u91cd\u590d\u3002\u7c7b\u4f3c\uff0c\u5982\u679c\u6211\u4eec\u58f0\u660ecities.name REFERENCES\u67d0\u4e9b\u5176\u5b83\u7684\u8868\uff0c\u8fd9\u4e2a\u7ea6\u675f\u4e0d\u4f1a\u81ea\u52a8\u5e7f\u64ad\u5230capitals\u3002</li> <li> <p>\u5728\u8fd9\u79cd\u6761\u4ef6\u4e0b\uff0c\u4f60\u53ef\u4ee5\u901a\u8fc7\u624b\u5de5\u7ed9capitals \u589e\u52a0\u540c\u6837\u7684REFERENCES\u7ea6\u675f\u6765\u505a\u5230\u8fd9\u70b9\u3002</p> </li> <li> <p>\u591a\u8868\u7ee7\u627f</p> </li> <li>\u4e00\u4e2a\u8868\u53ef\u4ee5\u4ece\u591a\u4e2a\u7236\u8868\u7ee7\u627f\uff0c\u8fd9\u79cd\u60c5\u51b5\u4e0b\u5b83\u62e5\u6709\u7236\u8868\u4eec\u7684\u5b57\u6bb5\u7684\u603b\u548c\u3002\u5b50\u8868\u4e2d\u4efb\u610f\u5b9a\u4e49\u7684\u5b57\u6bb5\u4e5f\u4f1a\u52a0\u5165\u5176\u4e2d\u3002</li> <li>\u5982\u679c\u540c\u4e00\u4e2a\u5b57\u6bb5\u540d\u51fa\u73b0\u5728\u591a\u4e2a\u7236\u8868\u4e2d\uff0c\u6216\u8005\u540c\u65f6\u51fa\u73b0\u5728\u7236\u8868\u548c\u5b50\u8868\u7684\u5b9a\u4e49\u91cc\uff0c\u90a3\u4e48\u8fd9\u4e9b\u5b57\u6bb5\u5c31\u4f1a\u88ab\"\u878d\u5408\"\uff0c\u8fd9\u6837\u5728\u5b50\u8868\u91cc\u9762\u5c31\u53ea\u6709\u4e00\u4e2a\u8fd9\u6837\u7684\u5b57\u6bb5\u3002-</li> <li>\u8981\u60f3\u878d\u5408\uff0c\u5b57\u6bb5\u5fc5\u987b\u662f\u76f8\u540c\u7684\u6570\u636e\u7c7b\u578b\uff0c\u5426\u5219\u5c31\u4f1a\u629b\u51fa\u4e00\u4e2a\u9519\u8bef\u3002\u878d\u5408\u7684\u5b57\u6bb5\u5c06\u4f1a\u62e5\u6709\u5b83\u6240\u7ee7\u627f\u7684\u5b57\u6bb5\u7684\u6240\u6709\u7ea6\u675f\u3002</li> </ul>"},{"location":"postgresql/07.%E7%94%A8%E6%88%B7%E8%87%AA%E5%AE%9A%E4%B9%89%E5%87%BD%E6%95%B0/","title":"User Defined Funtions","text":"<p>PostgreSQL \u63d0\u4f9b\u4e86\u56db\u79cd\u51fd\u6570\uff1a</p>"},{"location":"postgresql/07.%E7%94%A8%E6%88%B7%E8%87%AA%E5%AE%9A%E4%B9%89%E5%87%BD%E6%95%B0/#-","title":"-","text":"<ul> <li> <p>\u5185\u90e8\u51fd\u6570</p> </li> <li> <p>C\u8bed\u8a00\u51fd\u6570</p> </li> </ul>"},{"location":"postgresql/07.%E7%94%A8%E6%88%B7%E8%87%AA%E5%AE%9A%E4%B9%89%E5%87%BD%E6%95%B0/#-user-defined-procedures","title":"\u5b58\u50a8\u8fc7\u7a0b-User-Defined Procedures","text":"<p>\u5b58\u50a8\u8fc7\u7a0b\u662f\u4e0e\u51fd\u6570\u5f88\u76f8\u4f3c\u7684\u6570\u636e\u5bf9\u8c61\uff0c\u533a\u522b\u4e4b\u5904\u5728\u4e8e\uff1a</p> <ul> <li> <p>\u5b58\u50a8\u8fc7\u7a0b\u6ca1\u6709\u8fd4\u56de\u503c\uff0c\u56e0\u6b64 <code>CREATE PROCEDURE</code> \u5176\u4e2d\u6ca1\u6709 <code>RETURN</code> \u5b50\u53e5</p> </li> <li></li> </ul>"},{"location":"postgresql/07.%E7%94%A8%E6%88%B7%E8%87%AA%E5%AE%9A%E4%B9%89%E5%87%BD%E6%95%B0/#-query-language-sql-functions","title":"\u67e5\u8be2\u8bed\u53e5\u51fd\u6570-Query Language (SQL) Functions","text":"<pre><code>CREATE FUNCTION clean_emp() RETURNS void AS '\n    DELETE FROM emp\n        WHERE salary &lt; 0;\n' LANGUAGE SQL;\n\nSELECT clean_emp();\n\n clean_emp\n-----------\n</code></pre>"},{"location":"postgresql/08.%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/","title":"\u6570\u636e\u7c7b\u578b","text":"<p>PostgreSQL \u63d0\u4f9b\u4e86\u4e30\u5bcc\u7684\u6570\u636e\u7c7b\u578b\uff0c\u5305\u62ec **\u6570\u5b57\u7c7b\u578b\u3001\u8d27\u5e01\u7c7b\u578b\u3001\u5b57\u7b26\u7c7b\u578b\u3001\u4e8c\u8fdb\u5236\u6570\u636e\u7c7b\u578b\u3001\u65f6\u95f4/\u65e5\u671f\u7c7b\u578b\u3001\u5e03\u5c14\u7c7b\u578b\u3001\u679a\u4e3e\u7c7b\u578b\u3001JSON \u7c7b\u578b\u3001\u51e0\u4f55\u7c7b\u578b\u3001\u7f51\u7edc\u5730\u5740\u7c7b\u578b\u3001bite\u7c7b\u578b\u3001\u6587\u672c\u641c\u7d22\u7c7b\u578b\u3001UUID \u7c7b\u578b\u3001XML \u7c7b\u578b\u3001\u6570\u7ec4\u7c7b\u578b\u3001\u96c6\u5408\u7c7b\u578b\u3001\u533a\u95f4\u7c7b\u578b\u3001\u4f4d\u5b57\u7b26\u4e32\u7c7b\u578b**\u7b49\u7b49\u3002</p> <p>\u9664\u6b64\u4e4b\u5916\uff0cPostgreSQL \u8fd8\u63d0\u4f9b\u7ed9\u6211\u4eecDIY\u7684\u4e50\u8da3\uff0c\u53ef\u4ee5\u81ea\u5b9a\u4e49\u81ea\u5df1\u60f3\u8981\u7684\u6570\u636e\u7c7b\u578b\u3002</p>"},{"location":"postgresql/08.%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/#_2","title":"\u6570\u5b57\u7c7b\u578b","text":"\u540d\u5b57 \u5b58\u50a8\u5c3a\u5bf8 \u63cf\u8ff0 \u8303\u56f4 <code>smallint</code> 2\u5b57\u8282 \u5c0f\u8303\u56f4\u6574\u6570 -32768   \u5230 +32767 <code>integer</code> 4\u5b57\u8282 \u6574\u6570\u7684\u5178\u578b\u9009\u62e9\uff0c\u6700\u5e38\u7528 -2147483648 \u5230 +2147483647 <code>bigint</code> 8\u5b57\u8282 \u5927\u8303\u56f4\u6574\u6570 -9223372036854775808 \u5230 +9223372036854775807 <code>decimal</code> \u53ef\u53d8 \u7528\u6237\u6307\u5b9a\u7cbe\u5ea6\uff0c\u7cbe\u786e \u6700\u9ad8\u5c0f\u6570\u70b9\u524d131072\u4f4d\uff0c\u4ee5\u53ca\u5c0f\u6570\u70b9\u540e16383\u4f4d <code>numeric</code> \u53ef\u53d8 \u7528\u6237\u6307\u5b9a\u7cbe\u5ea6\uff0c\u7cbe\u786e \u6700\u9ad8\u5c0f\u6570\u70b9\u524d131072\u4f4d\uff0c\u4ee5\u53ca\u5c0f\u6570\u70b9\u540e16383\u4f4d <code>real</code> 4\u5b57\u8282 \u53ef\u53d8\u7cbe\u5ea6\uff0c\u4e0d\u7cbe\u786e 6\u4f4d\u5341\u8fdb\u5236\u7cbe\u5ea6 <code>double precision</code> 8\u5b57\u8282 \u53ef\u53d8\u7cbe\u5ea6\uff0c\u4e0d\u7cbe\u786e 15\u4f4d\u5341\u8fdb\u5236\u7cbe\u5ea6 <code>smallserial</code> 2\u5b57\u8282 \u81ea\u52a8\u589e\u52a0\u7684\u5c0f\u6574\u6570 1\u523032767 <code>serial</code> 4\u5b57\u8282 \u81ea\u52a8\u589e\u52a0\u7684\u6574\u6570 1\u52302147483647 <code>bigserial</code> 8\u5b57\u8282 \u81ea\u52a8\u589e\u957f\u7684\u5927\u6574\u6570 1\u52309223372036854775807 <p>\u4e0eMySQL \u6574\u6570\u4e0d\u540c\uff0cPostgreSQL \u4e0d\u63d0\u4f9b\u65e0\u7b26\u53f7\u6574\u6570\u7c7b\u578b</p> <p><code>numeric</code>\u5217\u7684\u6700\u5927\u7cbe\u5ea6\u548c\u6700\u5927\u5c0f\u6570\u4f4d\u6570\u90fd\u662f\u53ef\u4ee5\u914d\u7f6e\u7684\u3002\u58f0\u660e\u4e00\u4e2a\u7c7b\u578b\u4e3a<code>numeric</code>\u7684\u5217\uff1a</p> <pre><code>-- \uff08\u7cbe\u5ea6\uff09\u662f\u6574\u4e2a\u6570\u4e2d\u6709\u6548\u4f4d\u7684\u603b\u6570\uff0c\u4e5f\u5c31\u662f\u5c0f\u6570\u70b9\u4e24\u8fb9\u7684\u4f4d\u6570\u3002\u7cbe\u5ea6\u5fc5\u987b\u4e3a\u6b63\u6574\u6570\uff0c\n-- \uff08\u5c0f\u6570\u4f4d\u6570\uff09\u662f\u5c0f\u6570\u90e8\u5206\u7684\u6570\u5b57\u4f4d\u6570\uff0c\u4e5f\u5c31\u662f\u5c0f\u6570\u70b9\u53f3\u8fb9\u7684\u90e8\u5206\u3002\u5c0f\u6570\u4f4d\u6570\u53ef\u4ee5\u4e3a\u96f6\u6216\u8005\u6b63\u6570\n\n-- \u6570\u5b57 23.5141 \u7684\u7cbe\u5ea6\u4e3a6\uff0c\u800c\u5c0f\u6570\u4f4d\u6570\u4e3a4\n\nNUMERIC(precision, scale)\n\nCREATE TABLE tbl_test (\n    a integer CHECK(a&gt;0) ,   --\u5982\u679c\u9700\u8981\u6b63\u6574\u6570\uff0c\u5219\u4f7f\u7528check\u7ea6\u675f\n    b integer \n)\n</code></pre> <pre><code>CREATE TABLE cities (\n    city_id serial PRIMARY KEY,\n    city_name VARCHAR (255) NOT NULL,\n    population INT NOT NULL CHECK (population &gt;= 0)     -- \u6b63\u6574\u6570\u7528check\u7ea6\u675f\u6765\u5b9e\u73b0\n);\n</code></pre>"},{"location":"postgresql/08.%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/#_3","title":"\u5b57\u7b26\u7c7b\u578b","text":"<p>SQL\u5b9a\u4e49\u4e86\u4e24\u79cd\u57fa\u672c\u7684\u5b57\u7b26\u7c7b\u578b\uff1a <code>character varying(n)</code>\u548c<code>character(n)</code>\uff0c \u5176\u4e2d*<code>n</code>\u662f\u4e00\u4e2a\u6b63\u6574\u6570\u3002\u4e24\u79cd\u7c7b\u578b\u90fd\u53ef\u4ee5\u5b58\u50a8\u6700\u591a<code>n</code>*\u4e2a\u5b57\u7b26\u957f\u7684\u4e32\u3002</p> <p><code>varchar(n)</code>\u548c<code>char(n)</code>\u7684\u6982\u5ff5\u5206\u522b\u662f<code>character varying(n)</code>\u548c<code>character(n)</code>\u7684\u522b\u540d\uff0c\u5206\u522b\u8868\u793a**\u53d8\u957f\u5b57\u7b26\u4e32**\u548c\u548c**\u5b9a\u957f\u5b57\u7b26\u4e32**</p> \u540d\u5b57 \u5b58\u50a8\u5c3a\u5bf8 \u8bf4\u660e \u63cf\u8ff0 <code>character varying(n)</code>, <code>varchar(n)</code> 4 \u5b57\u8282 + \u5b9e\u9645\u5b57\u7b26\u4e32\u5360\u7528\u7a7a\u95f4 \u5176\u4e2d\uff0c<code>n</code> \u8868\u793a\u8be5\u5217\u80fd\u591f\u5b58\u50a8\u7684\u6700\u5927\u5b57\u7b26\u6570\u3002\u53d6\u503c\u8303\u56f4\uff080\uff0c10,485,760\uff09 \u53d8\u957f\u5b57\u7b26\u4e32 <code>character(n)</code>, <code>char(n)</code> 4 \u5b57\u8282 + \u5b9e\u9645\u5b57\u7b26\u4e32\u5360\u7528\u7a7a\u95f4 \u5176\u4e2d\uff0cn\u8868\u793a\u5b9a\u957f\u5b57\u7b26\u4e32\u6570\u91cf\uff0c\u5982\u679c\u5b9e\u9645\u503c\u5c0f\u4e8e\u5b83\uff0c\u5c3e\u90e8\u4ee5\u7a7a\u683c\u586b\u5145 \u5b9a\u957f\uff0c\u7a7a\u683c\u586b\u5145 <code>text</code> \u65e0\u9650\u53d8\u957f"},{"location":"postgresql/08.%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/#oid","title":"OID\u7c7b\u578b","text":"<p>\u5bf9\u8c61\u6807\u8bc6\u7b26\uff08OID\uff09\u88abPostgreSQL\u7528\u6765\u5728\u5185\u90e8\u4f5c\u4e3a\u591a\u4e2a\u7cfb\u7edf\u8868\u7684\u4e3b\u952e\u3002 \u7c7b\u578b<code>oid</code>\u8868\u793a\u4e00\u4e2a\u5bf9\u8c61\u6807\u8bc6\u7b26\u3002</p> <p>\u5728pg\u4e2d\uff0coid\u7528\u6765\u5728\u6574\u4e2a\u6570\u636e\u96c6\u7c07\u4e2d\u552f\u4e00\u6807\u8bc6\u4e00\u4e2a\u6570\u636e\u5e93\u5bf9\u8c61\uff0c\u5bf9\u8c61\u53ef\u4ee5\u662f\u6570\u636e\u5e93\u3001\u8868\u3001\u7d22\u5f15\u3001\u89c6\u56fe\u3001\u5143\u7956\u7b49\u7b49\u3002</p> <p>oid\u75284\u4e2a\u5b57\u8282\u7684\u65e0\u7b26\u53f7\u6574\u6570\u8868\u793a\u3002\u56e0\u6b64\uff0c\u5728\u5927\u578b\u6570\u636e\u5e93\u4e2d\u5b83\u5e76\u4e0d\u8db3\u4ee5\u63d0\u4f9b\u6570\u636e\u5e93\u8303\u56f4\u5185\u7684\u552f\u4e00\u6027\uff0c\u751a\u81f3\u5728\u4e00\u4e9b\u5927\u578b\u7684\u8868\u4e2d\u4e5f\u65e0\u6cd5\u63d0\u4f9b\u8868\u8303\u56f4\u5185\u7684\u552f\u4e00\u6027\u3002</p>"},{"location":"postgresql/08.%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/#_4","title":"\u7c7b\u578b\u8f6c\u6362","text":"<p>\u5728 postgresql \u4e2d\uff0c\"::\" \u7b26\u53f7\u5176\u5b9e\u662f\u4e00\u4e2a\u5f3a\u5236\u7c7b\u578b\u8f6c\u6362\u7b26\uff0c\u4f5c\u7528\u7b49\u540c\u4e8eCAST\u3002</p> <p>\u5728\u5f88\u591a\u60c5\u51b5\u4e0b\uff0c\u6211\u4eec\u9700\u8981\u5c06\u4e00\u79cd\u6570\u636e\u7c7b\u578b\u7684\u503c\u8f6c\u6362\u4e3a\u53e6\u4e00\u79cd\u6570\u636e\u7c7b\u578b\u3002\u90a3\u4e48\u6211\u4eec\u5c31\u53ef\u4ee5\u4f7f\u7528\u5b83\u6765\u8fdb\u884c\u8f6c\u6362\u3002\u8bed\u6cd5\u5982\u4e0b\uff1a</p> <pre><code>expression::type\n\nCAST ( expression AS target_type );\n</code></pre> <p>\u5f3a\u5236\u7c7b\u578b\u8f6c\u6362\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u5982\u679c\u8868\u8fbe\u5f0f\u4e0d\u80fd\u8f6c\u6362\u4e3a\u76ee\u6807\u7c7b\u578b\uff0c\u5219\u4f1a\u89e6\u53d1\u9519\u8bef</p> <pre><code>SELECT oid :: regclass AS table_name FROM pg_class WHERE relkind = 'r';\n</code></pre>"},{"location":"postgresql/08.%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/#_5","title":"\u63d2\u5165\u9650\u5236","text":"<p>\u591a\u6761insert\u6570\u636e\uff0c\u5efa\u8bae\u4fee\u6539\u4e3ainsert values\u5f62\u5f0f\u3002</p> <p>\u6279\u91cf\u63d2\u5165\u7684\u65f6\u5019<code>values</code>\u91cc\u9762\u7684\u53c2\u6570\u4e2a\u6570\u4e0d\u80fd\u8d85\u8fc732767\uff0c\u53ef\u4ee5\u8bbe\u7f6e300-500\u4e2a\u63d0\u4ea4\u4e00\u6b21\u3002</p> <p>\u4ece\u6e90\u4ee3\u7801\u4e2d\u53ef\u4ee5\u770b\u5230pgsql\u4f7f\u75282\u4e2a\u5b57\u8282\u7684integer\uff0c\u6545\u5176\u53d6\u503c\u8303\u56f4\u4e3a[-32768, 32767]\u3002</p> <p>\u8fd9\u610f\u5473\u7740sql\u8bed\u53e5\u7684\u53c2\u6570\u6570\u91cf\uff0c\u5373\u884c\u6570*\u5217\u6570\u4e4b\u79ef\u5fc5\u987b\u5c0f\u4e8e\u7b49\u4e8e32767\u3002\u5982\u679c\u4e00\u6b21\u63d2\u5165\u7684\u6570\u636e\u91cf\u592a\u591a\uff0c\u4f7f\u5f97\u53c2\u6570\u6570\u91cf\u8d85\u8fc7\u4e86\u6700\u5927\u503c\uff0c\u53ea\u80fd\u5206\u6279\u63d2\u5165\u4e86\u3002</p> <p>\u5047\u5982\u8868\u670910\u5217\uff0c\u90a3\u4e48\u4e00\u6b21\u6700\u591a\u63d2\u51653276\u884c\u3002</p> <p>https://blog.csdn.net/ziranqiuzhi/article/details/104331348</p>"},{"location":"postgresql/08.%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/#_6","title":"\u6570\u7ec4\u7c7b\u578b","text":"<p>postgresql\u652f\u6301\u6570\u7ec4\u7c7b\u578b\uff0c\u53ef\u4ee5\u662f\u57fa\u672c\u7c7b\u578b\uff0c\u4e5f\u53ef\u4ee5\u662f\u7528\u6237\u81ea\u5b9a\u4e49\u7684\u7c7b\u578b\u3002\u65e5\u5e38\u4e2d\u4f7f\u7528\u6570\u7ec4\u7c7b\u578b\u7684\u673a\u4f1a\u4e0d\u591a\uff0c\u4f46\u8fd8\u662f\u53ef\u4ee5\u4e86\u89e3\u4e00\u4e0b\u3002</p> <p>\u4e0d\u50cfC\u6216JAVA\u9ad8\u7ea7\u8bed\u8a00\u7684\u6570\u7ec4\u4e0b\u6807\u4ece0\u5f00\u59cb\uff0cpostgresql\u6570\u7ec4\u4e0b\u6807\u4ece1\u5f00\u59cb\uff0c\u65e2\u53ef\u4ee5\u6307\u5b9a\u957f\u5ea6\uff0c\u4e5f\u53ef\u4ee5\u4e0d\u6307\u5b9a\u957f\u5ea6\u3002</p> <p>\u4e14postgresql\u65e2\u652f\u6301\u4e00\u7ef4\u6570\u7ec4\uff0c\u4e5f\u652f\u6301\u591a\u7ef4\u6570\u7ec4\uff0c\u4f46\u662f\u5e73\u65f6\u4e8c\u7ef4\u6570\u7ec4\u4e5f\u5c31\u591f\u7528\u4e86\u3002</p> <pre><code>CREATE table tbl_array(\n    a int[],                --int[]\u8868\u793a\u6570\u7ec4\u957f\u5ea6\u65e0\u9650\u5236\uff0cint[4]\u8868\u793a\u6570\u7ec4\u957f\u5ea6\u4e3a4.\n    b varchar(32)[][],      -- \n    c int\n);\n</code></pre>"},{"location":"postgresql/09.%E5%8F%AF%E6%89%A7%E8%A1%8C%E7%A8%8B%E5%BA%8F/","title":"\u6982\u8ff0","text":""},{"location":"postgresql/09.%E5%8F%AF%E6%89%A7%E8%A1%8C%E7%A8%8B%E5%BA%8F/#psql","title":"psql","text":"<p>psql is the PostgreSQL interactive terminal</p> <pre><code># psql [OPTION]... [DBNAME [USERNAME]]\n\n# \u767b\u5f55\u8fde\u63a5\u6570\u636e\u5e93\npsql -h127.0.0.1 -Upostgres -p5432 -dwordpress\n</code></pre>"},{"location":"postgresql/10.Postgresql%E7%B4%A2%E5%BC%95/","title":"\u6982\u8ff0","text":"<p>\u4ec0\u4e48\u662f\u6761\u4ef6\u7d22\u5f15\u5462\uff1f\u6761\u4ef6\u7d22\u5f15\u5c31\u662f\u5728\u7d22\u5f15\u5217\u4e0a\u6839\u636eWHERE\u6761\u4ef6\u8fdb\u884c\u4e00\u5b9a\u7684\u8fc7\u6ee4\u540e\u4ea7\u751f\u7684\u7d22\u5f15\u3002 \u8fd9\u6837\u7684\u7d22\u5f15\u6709\u4ee5\u4e0b\u4f18\u52bf\uff1a</p> <ul> <li>\u7b2c\u4e00\u70b9\uff0c \u6bd4\u57fa\u4e8e\u8fd9\u4e2a\u5217\u7684\u5168\u90e8\u7d22\u5f15\u5360\u7528\u7a7a\u95f4\u6765\u7684\u5c0f\u3002</li> <li>\u7b2c\u4e8c\u70b9\uff0c \u7279\u522b\u662f\u57fa\u4e8e<code>FULL INDEX SCAN</code>\u7684\u65f6\u5019\uff0c\u5360\u7528\u7a7a\u95f4\u5c0f\u7684\u7d22\u5f15\u5bf9\u5185\u5b58\u5360\u7528\u4e5f\u5c0f\u5f88\u591a\u3002</li> </ul> <p>PostgreSQL,SQLServer \u7b49\u90fd\u652f\u6301\u6761\u4ef6\u7d22\u5f15\uff0c\u6240\u4ee5\u6211\u4eec\u5148\u6765\u770b\u4e0b\u6761\u4ef6\u7d22\u5f15\u7684\u5b9e\u9645\u60c5\u51b5\u3002</p> <p>\u53c2\u8003\u5b98\u7f51</p> <p>\u7528\u6570\u636e\u5e93\u5b58\u7f51\u7ad9\u8bbf\u95ee\u65e5\u5fd7\uff0c\u5305\u62ec\u8bbf\u5ba2IP\u548cURL\u7b49\uff0c\u5927\u90e8\u5206\u8bbf\u5ba2IP\u6765\u81ea\u5c40\u57df\u7f51\uff0c\u5c11\u6570\u6765\u81ea\u4e92\u8054\u7f51\u3002\u5982\u679c\u4e3b\u8981\u901a\u8fc7IP\u641c\u7d22\u6765\u81ea\u4e8e\u5916\u90e8\u7684\u8bbf\u95ee\uff0c\u90a3\u5c31\u6ca1\u6709\u5fc5\u8981\u7d22\u5f15\u5bf9\u5e94\u4e8e\u6211\u4eec\u7ec4\u7ec7\u5185\u7f51\u7684IP\u8303\u56f4\u3002</p> <pre><code>CREATE TABLE access_log (\n    url_path varchar,\n    client_ip inet,\n    acess_time date\n);\n\n\n\nCREATE INDEX access_log_client_ip_ix ON access_log (client_ip)\nWHERE NOT (client_ip &gt; inet '192.168.100.0' AND client_ip &lt; inet '192.168.100.255');\n\n-- \u8fd9\u4e2a\u67e5\u8be2\u53ef\u4ee5\u88ab\u90e8\u5206\u7d22\u5f15\u8986\u76d6\nSELECT *\nFROM access_log\nWHERE url = '/index.html' AND client_ip = inet '212.78.10.32';\n</code></pre> <p>\u5982\u679c\u6211\u4eec\u6709\u4e00\u4e2a\u8868\u5305\u542b\u5df2\u4e0a\u8d26\u548c\u672a\u4e0a\u8d26\u7684\u8ba2\u5355\uff0c\u5176\u4e2d\u672a\u4e0a\u8d26\u7684\u8ba2\u5355\u5728\u6574\u4e2a\u8868\u4e2d\u5360\u636e\u4e00\u5c0f\u90e8\u5206\u4e14\u5b83\u4eec\u662f\u6700\u7ecf\u5e38\u88ab\u8bbf\u95ee\u7684\u884c\u3002\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u53ea\u5728\u672a\u4e0a\u8d26\u7684\u884c\u4e0a\u521b\u5efa\u4e00\u4e2a\u7d22\u5f15\u6765\u63d0\u9ad8\u6027\u80fd\u3002</p>"},{"location":"postgresql/11.%E5%A4%96%E9%83%A8%E8%A1%A8/","title":"\u5916\u90e8\u8868","text":"<p>FDW (foreign-data wrapper\uff0c\u5916\u90e8\u6570\u636e\u5305\u88c5\u5668)\uff0cPostgreSQL FDW \u662f\u4e00\u79cd\u5916\u90e8\u8bbf\u95ee\u63a5\u53e3\uff0c\u5b83\u53ef\u4ee5\u88ab\u7528\u6765\u8bbf\u95ee\u5b58\u50a8\u5728\u5916\u90e8\u7684\u6570\u636e\uff0c\u8fd9\u4e9b\u6570\u636e\u53ef\u4ee5\u662f\u5916\u90e8\u7684pg\u6570\u636e\u5e93\uff0c\u4e5f\u53ef\u4ee5oracle\u3001mysql\u7b49\u6570\u636e\u5e93\uff0c\u751a\u81f3\u53ef\u4ee5\u662f\u6587\u4ef6\u3002\u8be5\u6a21\u5757\u63d0\u4f9b\u7684\u529f\u80fd\u4e0e\u65e7dblink\u6a21\u5757\u7684\u529f\u80fd\u57fa\u672c\u91cd\u53e0\u3002</p> <p>\u4f46\u662fpostgres_fdw\u4e3a\u8bbf\u95ee\u8fdc\u7a0b\u8868\u63d0\u4f9b\u4e86\u66f4\u900f\u660e\u548c\u7b26\u5408\u6807\u51c6\u7684\u8bed\u6cd5\uff0c\u5e76\u4e14\u5728\u8bb8\u591a\u60c5\u51b5\u4e0b\u53ef\u4ee5\u63d0\u4f9b\u66f4\u597d\u7684\u6027\u80fd\u3002\u800cPostgreSQL\u5185\u7f6esharding \u4e5f\u5c06\u662f\u57fa\u4e8epostgres_fdw\u5b9e\u73b0\u3002</p> <p>2003 \u5e74\uff0cSQL/MED\uff08SQL Management of External Data\uff09\u88ab\u52a0\u5165 SQL \u6807\u51c6\uff0c\u5176\u4e3a\u5916\u90e8\u6570\u636e\u7ba1\u7406\u63d0\u4f9b\u4e86\u89c4\u8303\u3002\u5728 2011 \u5e74\u53d1\u884c\u7684 PostgreSQL 9.1 \u5f00\u59cb\u652f\u6301\u5916\u90e8\u6570\u636e\u8bfb\uff0c2013 \u53d1\u884c\u7684 PostgreSQL 9.3 \u5f00\u59cb\u652f\u6301\u5916\u90e8\u6570\u636e\u5199\u3002</p> <p>\u76ee\u524d\uff0cPostgreSQL 14\u5df2\u63d0\u4f9b\u591a\u79cd\u6269\u5c55\u6765\u652f\u6301\u5bf9\u5404\u79cd\u7c7b\u578b\u5916\u90e8\u6570\u636e\u5e93\u6216\u6587\u4ef6\u7684\u64cd\u4f5c\uff08\u5982 postgres_fdw \u652f\u6301\u8fde\u63a5\u5916\u90e8 PostgreSQL \u6570\u636e\u5e93\uff0coracle_fdw \u652f\u6301\u8fde\u63a5\u5916\u90e8 Oracle \u6570\u636e\u5e93\uff0cmysql_fdw \u652f\u6301\u8fde\u63a5\u5916\u90e8 MySQL \u6570\u636e\u5e93\uff0cjdbc_fdw \u652f\u6301\u4ee5 JDBC \u534f\u8bae\u8fde\u63a5\u5916\u90e8\u5e38\u7528\u5173\u7cfb\u578b\u6570\u636e\u5e93\uff0cfile_fdw \u652f\u6301\u8fde\u63a5\u5916\u90e8\u7279\u5b9a\u683c\u5f0f\u7684\u6587\u4ef6\u7b49\uff09\u3002file_fdw\u63d2\u4ef6\u4e3aPG\u6570\u636e\u5e93\u63d0\u4f9b\u4e86\u8bbf\u95ee\u5916\u90e8\u6570\u636e\u7684\u80fd\u529b\uff0c\u6bd4\u5982\u6211\u4eec\u5e38\u89c1\u7684\u6587\u4ef6csv,log\u7b49\uff0c\u8be5\u63d2\u4ef6\u662f\u5185\u7f6e\u5728PG\u6e90\u7801\u7684contrib\u4e2d\u3002</p> <p>\u4f7f\u7528postgres_fdw\u4ea7\u8981\u6709\u4ee5\u4e0b\u6b65\u9aa4\uff1a</p> <ul> <li>\u521b\u5efa\u6269\u5c55</li> <li>\u521b\u5efa\u670d\u52a1</li> <li>\u521b\u5efa\u7528\u6237\u6620\u5c04</li> <li>\u521b\u5efa\u4e0e\u8bbf\u95ee\u8868\u5bf9\u5e94\u7684\u5916\u8868</li> </ul> <p>\u5230\u6b64\u5c31\u53ef\u4ee5\u4f7f\u7528SELECT\u4ece\u5916\u90e8\u8868\u4e2d\u8bbf\u95ee\u5b58\u50a8\u5728\u5176\u5e95\u5c42\u8fdc\u7a0b\u8868\u4e2d\u7684\u6570\u636e\u3002\u540c\u65f6\u53ef\u4ee5 UPDATE,INSERT,DELETE\u8fdc\u7a0b\u8868\u6570\u636e\u5e93\uff0c\u524d\u63d0\u662f\u5728\u7528\u6237\u6620\u5c04\u4e2d\u6307\u5b9a\u7684\u8fdc\u7a0b\u7528\u6237\u5fc5\u987b\u5177\u6709\u6267\u884c\u8fd9\u4e9b\u64cd\u4f5c\u7684\u6743\u9650\u3002</p> <p>\u672c\u6587\u4ec5\u5173\u6ce8 postgres_fdw\uff0c\u5373 PostgreSQL \u6570\u636e\u5e93\u5982\u4f55\u4e0e\u5916\u90e8 PostgreSQL \u6570\u636e\u5e93\u8fdb\u884c\u8fde\u63a5\u4ee5\u53ca\u5176\u5982\u4f55\u5bf9\u5916\u90e8\u6570\u636e\u8fdb\u884c\u7ba1\u7406\u3002</p> <p>\u4f7f\u7528 superuser \u5728\u8fdc\u7a0b PostgreSQL \u6570\u636e\u5e93\u6267\u884c\u5982\u4e0b\u8bed\u53e5\u521b\u5efa\u666e\u901a\u7528\u6237fdw_user\uff0c\u4f9b\u540e\u9762\u672c\u5730\u6570\u636e\u5e93\u5efa\u7acb FDW \u8fde\u63a5\u65f6\u4f7f\u7528\u3002 <pre><code>CREATE USER fdw_user WITH ENCRYPTED PASSWORD 'secret';\n</code></pre></p> <p>\u5728\u8fdc\u7a0b\u6570\u636e\u5e93\u521b\u5efa\u7528\u4e8e\u6d4b\u8bd5\u7684\u5929\u6c14\u8868weather\uff0c\u63d2\u5165\u6d4b\u8bd5\u6570\u636e\uff0c\u5e76\u4e3a\u7528\u6237fdw_user\u6388\u6743\u9488\u5bf9\u8be5\u8868\u7684\u589e\u5220\u6539\u67e5\u6743\u9650\u3002</p> <pre><code>CREATE TABLE weather (\n    city        varchar(80),  -- city name (\u57ce\u5e02\u540d)\n    temp_low    int,          -- low temperature (\u6700\u4f4e\u6e29\u5ea6)\n    temp_high   int,          -- high temperature (\u6700\u9ad8\u6e29\u5ea6)\n    prcp        real,         -- precipitation (\u964d\u6c34\u91cf)\n    date        date          -- date (\u65e5\u671f)\n);\n\nINSERT INTO weather (city, temp_low, temp_high, prcp, date)\n    VALUES ('Beijing', 18, 32, 0.25, '2021-05-19'),\n          ('Beijing', 20, 30, 0.0, '2021-05-20'),\n          ('Dalian', 16, 24, 0.0, '2021-05-21');\n</code></pre>"},{"location":"postgresql/12.postgresql%E6%89%A9%E5%B1%95/","title":"\u6269\u5c55\u6982\u8ff0","text":"<p>PostgreSQL\u4e4b\u6240\u4ee5\u5f3a\u5927\uff0c\u4e0d\u4ec5\u4ec5\u56e0\u4e3a\u5b83\u662f\u4e00\u4e2a\u529f\u80fd\u5f3a\u52b2\u7684\u5173\u7cfb\u6570\u636e\u5e93\uff0c\u8fd8\u6709\u4e00\u4e2a\u539f\u56e0\u5c31\u662f\u5b83\u62e5\u6709\u975e\u5e38\u4e30\u5bcc\u7684\u6269\u5c55\u53ef\u7528\uff1a\u65e0\u8bba\u4f60\u662f\u505aAI\u3001\u79d1\u5b66\u8ba1\u7b97\u3001\u6570\u636e\u5206\u6790\u3001\u641c\u7d22\u5f15\u64ce\u8fd8\u662f\u50a8\u5b58\u5730\u7406\u4f4d\u7f6e\u7b49\u7b49\uff0c\u90fd\u80fd\u627e\u5230\u76f8\u5e94\u7684PostgreSQL\u6269\u5c55\u6765\u5b8c\u6210\u4efb\u52a1\u3002</p> <p>\u6362\u53e5\u8bdd\u6765\u8bf4\uff0c\u4f60\u4e0d\u4ec5\u53ef\u4ee5\u5c06PostgreSQL\u7528\u4f5c\u5173\u7cfb\u6570\u636e\u5e93\u7ba1\u7406\u5668\uff0c\u8fd8\u53ef\u4ee5\u628a\u5b83\u7528\u4f5c\u6570\u636e\u5e73\u53f0\uff0c\u5728\u5176\u4e0a\u901a\u8fc7\u6269\u5c55\u63d0\u4f9b\u8fd1\u4e4e\u65e0\u9650\u591a\u7684\u529f\u80fd\u3002</p> <p>\u5728PostgreSQL\u4e2d\uff0c\u6269\u5c55\u901a\u5e38\u4ee5\u6e90\u4ee3\u7801\u7684\u5f62\u5f0f\u63d0\u4f9b\uff0c\u5e76\u4e14\u9700\u8981\u7f16\u8bd1\u548c\u5b89\u88c5\u5230\u6570\u636e\u5e93\u4e2d\u3002\u8981\u5b89\u88c5\u6269\u5c55\uff0c\u60a8\u9700\u8981\u5177\u6709\u8db3\u591f\u7684\u6743\u9650\uff08\u901a\u5e38\u662f\u6570\u636e\u5e93\u7ba1\u7406\u5458\u6743\u9650\uff09\u3002</p> <p>\u63d2\u4ef6\u5c31\u662f\u539f\u8f6f\u4ef6\u7684\u6269\u5c55\u529f\u80fd\u3002postgresql\u6709\u975e\u5e38\u591a\u7684\u5404\u79cd\u5404\u6837\u7684\u63d2\u4ef6\uff0c\u5f53\u7136\u4e86\uff0c\u63d2\u4ef6\u4e0d\u5b89\u88c5\u5bf9\u4e8e\u6211\u4eec\u4f7f\u7528\u6570\u636e\u5e93\u5e76\u6ca1\u6709\u4ec0\u4e48\u592a\u591a\u7684\u5f71\u54cd\uff0c\u53ef\u80fd\u53ea\u662f\u4e0d\u8212\u670d\u4e00\u4e9b\u800c\u5df2\uff0c\u4f46\u6709\u4e00\u4e9b\u63d2\u4ef6\u6211\u4eec\u5982\u679c\u6709\u5b89\u88c5\uff0c\u90a3\u4e48\uff0c\u5bf9\u4e8e\u6570\u636e\u5e93\u7684\u7ef4\u62a4\uff0c\u7ba1\u7406\u5de5\u4f5c\u53ef\u80fd\u4f1a\u66f4\u52a0\u7684\u65b9\u4fbf\uff0c\u5feb\u6377\uff0cpg_stat_statements\u8fd9\u4e2a\u63d2\u4ef6\u5c31\u662f\u8fd9\u6837\u7684\u4e00\u4e2a\u63d2\u4ef6\uff0c\u6982\u62ec\u8d77\u6765\uff0c\u8fd9\u4e2a\u63d2\u4ef6\u7684\u529f\u80fd\u5c31\u662f\u63d0\u4f9bpostgresql\u76d1\u63a7\u7684\uff0c\u63d0\u4f9b\u4e86\u4e00\u79cd\u8ddf\u8e2a\u6267\u884c\u7684\u6240\u6709SQL\u8bed\u53e5\u7684\u7edf\u8ba1\u4fe1\u606f\u7684\u65b9\u6cd5\u3002</p> <p>PostgreSQL\u53ef\u6269\u5c55\u7684\u539f\u56e0\u662f\u5b83\u7684\u64cd\u4f5c\u662f\u7531\u8868\u9a71\u52a8\u7684\u3002 \u5982\u679c\u4f60\u719f\u6089\u6807\u51c6\u7684\u5173\u7cfb\u6570\u636e\u5e93\u7cfb\u7edf\uff0c \u4f60\u5c31\u77e5\u9053\u5b83\u4eec\u628a\u6570\u636e\u5e93\u3001\u8868\u3001\u5b57\u6bb5\u7b49\u4fe1\u606f\u5b58\u50a8\u5728\u4e00\u4e2a\u88ab\u79f0\u4e3a\u7cfb\u7edf\u8868 (\u6709\u4e9b\u7cfb\u7edf\u79f0\u4e3a\u6570\u636e\u5b57\u5178)\u7684\u5730\u65b9\u3002\u8fd9\u4e9b\u8868\u4e0e\u5176\u5b83\u8868\u6ca1\u4ec0\u4e48\u4e0d\u540c\uff0c \u53ea\u4e0d\u8fc7DBMS\u628a\u5b83\u81ea\u5df1\u5185\u90e8\u7684\u4fe1\u606f\u5b58\u653e\u4e8e\u6b64\u7f62\u4e86\u3002 PostgreSQL\u4e0e\u5176\u5b83\u7cfb\u7edf\u7684\u4e0d\u540c\u4e4b\u5904\u5728\u4e8e\u5b83\u5728\u7cfb\u7edf\u8868\u91cc\u5b58\u50a8\u4e86\u66f4\u591a\u7684\u4fe1\u606f\uff1a \u9664\u4e86\u5173\u4e8e\u8868\u548c\u5217/\u5b57\u6bb5\u7684\u4fe1\u606f\u4e4b\u5916\uff0c \u8fd8\u6709\u5173\u4e8e\u5b83\u4eec\u7684\u7c7b\u578b\u3001\u51fd\u6570\u3001\u8bbf\u95ee\u65b9\u5f0f\u4e4b\u7c7b\u7684\u4fe1\u606f\u3002\u8fd9\u4e9b\u8868\u53ef\u4ee5\u88ab\u7528\u6237\u4fee\u6539\uff0c \u800c\u4e14\u7531\u4e8ePostgreSQL\u7684\u5185\u90e8\u64cd\u4f5c\u662f\u4ee5\u8fd9\u4e9b\u8868\u4e3a\u57fa\u7840\u7684\uff0c \u8fd9\u5c31\u610f\u5473\u7740PostgreSQL\u53ef\u4ee5\u88ab\u7528\u6237\u8fdb\u884c\u6269\u5c55\u3002\u76f8\u6bd4\u4e4b\u4e0b\uff0c \u4f20\u7edf\u7684\u6570\u636e\u5e93\u7cfb\u7edf\u53ea\u80fd\u901a\u8fc7\u4fee\u6539\u6e90\u4ee3\u7801\u6216\u52a0\u8f7d\u7531DBMS\u4f9b\u5e94\u5546\u63d0\u4f9b\u7684\u7279\u6b8a\u6a21\u5757\u6765\u6269\u5c55\u3002</p>"},{"location":"postgresql/13.%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3toast%E6%8A%80%E6%9C%AF/","title":"\u4ec0\u4e48\u662f Postgres TOAST\uff1f","text":"<p>\u56e0\u4e3a <code>PostgreSQL</code> \u7684 <code>tuple</code>\uff08\u884c\u6570\u636e\uff09\u662f\u5b58\u5728\u5728 <code>Page</code> \u4e2d\u7684\uff0c<code>Page</code> \u7684\u5927\u5c0f\u9ed8\u8ba4\u4e3a 8KB\u3002postgresql \u4e0d\u5141\u8bb8 tuple \u8de8\u9875\u5b58\u50a8\uff0c\u6240\u4ee5\u5f53\u4e00\u884c\u6570\u636e\u7684\u67d0\u4e2a\u5217\u6570\u636e\u8fc7\u5927\u65f6\uff0c\u6bd4\u5982 <code>text</code> \u7c7b\u578b\u7684\u6570\u636e\uff0c\u8d85\u8fc7\u4e86\u5355\u9875\u7684\u5927\u5c0f\uff0c\u90a3\u4e48 <code>postgresql</code> \u4f1a\u5c06\u5b83\u538b\u7f29\uff0c\u5207\u5206\uff0c\u5e76\u4e14\u5b58\u50a8\u5728\u53e6\u5916\u7684\u4f4d\u7f6e\u3002\u8fd9\u79cd\u6280\u672f\u5c31\u662f\u79f0\u4e3a Toast\u3002</p> <p><code>PostgreSQL Toast</code> \u662f\u901a\u8fc7\u5355\u4e2a\u5b57\u6bb5\u7684\u5927\u5c0f\u6765\u8fdb\u884c\u5224\u65ad\u662f\u5426\u89e6\u53d1\u6b64\u673a\u5236\u7684\uff0c\u6bd4\u5982\u4e00\u4e2a\u5b57\u6bb5\uff0c\u8d85\u8fc7\u4e86<code>toast_tuple_threshold</code> \u7684\u9608\u503c\u5c31\u4f1a\u89e6\u53d1\u5b57\u6bb5\u91cc\u9762\u7684\u503c\uff0c\u8981\u8fdb\u884c TOAST \u7684\u5de5\u4f5c\u6d41\u7a0b\uff0c\u9ed8\u8ba4\u8fd9\u4e2a\u5b57\u6bb5\u7684\u503c\uff0c\u5927\u5c0f\u8981\u8d85\u8fc7 2KB\uff0c\u624d\u4f1a\u89e6\u53d1\u3002</p> <p>Postgres \u7684\u5b58\u50a8\u5355\u4f4d\u79f0\u4e3a\u9875\uff0c\u5b83\u4eec\u5177\u6709\u56fa\u5b9a\u5927\u5c0f\uff08\u9ed8\u8ba4\u4e3a 8 kB\uff09\u3002\u56fa\u5b9a\u9875\u9762\u5927\u5c0f\u4e3a Postgres \u5e26\u6765\u4e86\u8bb8\u591a\u4f18\u52bf\uff0c\u5373\u6570\u636e\u7ba1\u7406\u7b80\u5355\u3001\u9ad8\u6548\u548c\u4e00\u81f4\u6027\uff0c\u4f46\u5b83\u4e5f\u6709\u4e00\u4e2a\u7f3a\u70b9\uff1a\u67d0\u4e9b\u6570\u636e\u503c\u53ef\u80fd\u4e0d\u9002\u5408\u8be5\u9875\u9762\u3002</p> <pre><code>INSERT INTO post_toast (long_text, large_varchar, json_data, other_column)\nVALUES\n('Short text', 'Short varchar', '{\"key\": \"value\"}', 1);\n\n\n\nINSERT INTO post_toast (long_text, large_varchar, json_data, other_column)\nVALUES \n(\n repeat('This is a long text. ', 200),               \n repeat('A large varchar field. ', 200),            \n '{\"nested_key\": {\"sub_key\": \"large_value\"}}',      \n    2\n);\n</code></pre>"},{"location":"postgresql/14.PostgreSQL%E5%8E%8B%E7%BC%A9%E8%A1%A8/","title":"\u6982\u8ff0","text":"<p>PostgreSQL \u662f\u4e00\u6b3e\u529f\u80fd\u5f3a\u5927\u7684\u5173\u7cfb\u578b\u6570\u636e\u5e93\u7ba1\u7406\u7cfb\u7edf\uff0c\u5728\u5904\u7406\u5927\u91cf\u6570\u636e\u65f6\uff0c\u6709\u6548\u8282\u7701\u5b58\u50a8\u7a7a\u95f4\u662f\u4e00\u9879\u91cd\u8981\u7684\u4f18\u5316\u4efb\u52a1\u3002\u4ee5\u4e0b\u5c06\u8be6\u7ec6\u63a2\u8ba8\u5728 PostgreSQL \u4e2d\u5982\u4f55\u5b9e\u73b0\u6570\u636e\u7684\u538b\u7f29\u5b58\u50a8\u4ee5\u8282\u7701\u7a7a\u95f4\uff0c\u5e76\u63d0\u4f9b\u76f8\u5e94\u7684\u89e3\u51b3\u65b9\u6848\u548c\u793a\u4f8b\u4ee3\u7801\u3002</p> <p>PostgreSQL \u4ece\u7248\u672c 12 \u5f00\u59cb\u652f\u6301\u521b\u5efa\u538b\u7f29\u8868\uff08COMPRESSED TABLES\uff09\u3002\u538b\u7f29\u8868\u53ef\u4ee5\u663e\u8457\u51cf\u5c11\u5b58\u50a8\u7a7a\u95f4\u7684\u4f7f\u7528\uff0c\u7279\u522b\u662f\u5bf9\u4e8e\u5305\u542b\u91cd\u590d\u503c\u8f83\u591a\u6216\u6570\u636e\u7c7b\u578b\u8f83\u5927\u7684\u5217\u3002</p> <p>\u5728 PG14 \u4e4b\u524d\u7248\u672c\uff0cTOAST \u4ec5\u652f\u6301\u4e00\u4e2a\u538b\u7f29\u7b97\u6cd5 PGLZ\uff08PG \u5185\u7f6e\u7b97\u6cd5\uff09\u3002\u4f46\u662f\u5176\u4ed6\u538b\u7f29\u7b97\u6cd5\u53ef\u80fd\u6bd4 PGLZ \u66f4\u5feb\u6216\u8005\u6709\u66f4\u9ad8\u7684\u538b\u7f29\u7387\u3002PG14 \u4e2d\u6709\u4e86\u65b0\u538b\u7f29\u9009\u9879 LZ4 \u538b\u7f29\uff0c\u8fd9\u662f\u4e00\u4e2a\u4ee5\u901f\u5ea6\u8457\u79f0\u7684\u65e0\u635f\u538b\u7f29\u7b97\u6cd5\u3002\u56e0\u6b64\u6211\u4eec\u53ef\u4ee5\u671f\u671b\u5b83\u6709\u52a9\u4e8e\u63d0\u9ad8 TOAST \u538b\u7f29\u548c\u89e3\u538b\u7f29\u7684\u901f\u5ea6\u3002</p> <p>\u4e3a\u4e86\u4f7f\u7528 LZ4 \u538b\u7f29\u7279\u6027\uff0c\u5728\u7f16\u8bd1\u65f6\u9700\u8981\u6307\u5b9a<code>--with-lz4</code>\uff0c\u5e76\u4e14\u5728\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u6309\u7167<code>LZ</code>4 \u5e93\u3002\u901a\u8fc7 GUC \u53c2\u6570<code>default_toast_compression</code>\u53ef\u4ee5\u6307\u5b9a PG \u5b9e\u4f8b\u7684 TOAST \u9ed8\u8ba4\u538b\u7f29\u7b97\u6cd5\u3002\u53ef\u4ee5\u5728<code>postgresql.conf</code>\u4e2d\u914d\u7f6e\uff0c\u4e5f\u53ef\u4ee5\u901a\u8fc7 SET \u547d\u4ee4\u4ec5\u6539\u53d8\u5f53\u524d\u8fde\u63a5\uff1a</p> <pre><code>postgres=# SET default_toast_compression=lz4;\nSET\n\nCREATE TABLE tbl (\n    id int,\n    col1 text COMPRESSION pglz,\n    col2 text COMPRESSION lz4,\n    col3 text\n);\n\n\npostgres=# \\d+ tbl\nTable \"public.tbl\"\nColumn | Type    | \u2026 | Storage  | Compression | \u2026\n-------+---------+---+----------+-------------+ \u2026\nid     | integer |   | plain    |             |\ncol1   | text    |   | extended | pglz        |\ncol2   | text    |   | extended | lz4         |\ncol3   | text    |   | extended |             |\nAccess method: heap\n</code></pre> <p>\u6211\u4eec\u4f7f\u7528\\d+\u547d\u4ee4\u53ef\u4ee5\u770b\u5230\u6240\u6709\u5217\u7684\u538b\u7f29\u7b97\u6cd5\u3002\u5982\u679c\u5217\u4e0d\u652f\u6301\u6216\u8005\u6ca1\u6709\u6307\u5b9a\u538b\u7f29\u7b97\u6cd5\uff0c\u90a3\u4e48\u4f1a\u5728 Compression \u5217\u663e\u793a\u7a7a\u683c\u3002</p> <p>\u5728\u4e0a\u9762\u7684\u4f8b\u5b50\u4e2d\uff0cid \u5217\u4e0d\u652f\u6301\u538b\u7f29\u7b97\u6cd5\uff0ccol1 \u5217\u4f7f\u7528 PGLZ\uff0ccol2 \u4f7f\u7528 LZ4\uff0ccol3 \u6ca1\u6709\u6307\u5b9a\u538b\u7f29\u7b97\u6cd5\uff0c\u90a3\u4e48\u5b83\u4f1a\u4f7f\u7528\u9ed8\u8ba4\u7684\u538b\u7f29\u7b97\u6cd5\u3002\u53ef\u4ee5\u901a\u8fc7<code>ALTER TABLE</code>  \u4fee\u6539\u5217\u538b\u7f29\u7b97\u6cd5\uff0c\u4f46\u9700\u8981\u6ce8\u610f\uff0c\u4fee\u6539\u540e\u7684\u7b97\u6cd5\u4ec5\u5f71\u54cd\u6267\u884c\u6574\u4e2a\u547d\u4ee4\u540e\u7684 insert \u6570\u636e\u3002</p>"},{"location":"redis/01.redis%E7%AE%80%E4%BB%8B/","title":"0. redis\u6982\u8ff0","text":""},{"location":"redis/01.redis%E7%AE%80%E4%BB%8B/#_1","title":"\u7b80\u4ecb","text":"<p>Redis is an open source (BSD licensed), in-memory data structure store, used as database, cache and message broker.</p> <p>\u8fd9\u662f redis \u7684\u5b98\u65b9\u7684\u5b9a\u4e49\uff0c\u5b83\u662f\u4e00\u4e2a\u6570\u636e\u5e93\uff0c\u4e14\u662f\u628a\u6570\u636e\u5b58\u5230\u5185\u5b58\u4e2d\uff0c\u80fd\u7528\u4f5c cache (\u7f13\u5b58) \u548c\u6d88\u606f\u961f\u5217\u3002</p> <p>Redis \u662f\u5b8c\u5168\u5f00\u6e90\u514d\u8d39\u7684\uff0c\u9075\u5b88 BSD \u534f\u8bae\uff0c\u662f\u4e00\u4e2a\u9ad8\u6027\u80fd\u7684 key-value \u6570\u636e\u5e93\uff0c\u4e0e\u5176\u5b83 key/value \u7f13\u5b58\u4ea7\u54c1\u76f8\u6bd4\u6709\u4ee5\u4e0b\u4e09\u4e2a\u7279\u70b9\uff1a</p> <ul> <li>Redis \u652f\u6301\u6570\u636e\u7684\u6301\u4e45\u5316\uff0c\u53ef\u4ee5\u5c06\u5185\u5b58\u4e2d\u7684\u6570\u636e\u4fdd\u5b58\u5728\u78c1\u76d8\u4e2d\uff0c\u91cd\u542f\u7684\u65f6\u5019\u53ef\u4ee5\u518d\u6b21\u52a0\u8f7d\u8fdb\u884c\u4f7f\u7528\u3002</li> <li>Redis \u4e0d\u4ec5\u652f\u6301 key-value \u7c7b\u578b\u7684\u6570\u636e\uff0c\u8fd8\u63d0\u4f9b list\uff0cset\uff0czset\uff0chash \u7b49\u6570\u636e\u7ed3\u6784\u7684\u5b58\u50a8\uff0c\u5bf9\u7a0b\u5e8f\u5458\u900f\u660e\uff0c\u65e0\u9700\u8fdb\u884c\u989d\u5916\u7684\u62bd\u8c61\u3002</li> <li>Redis \u652f\u6301\u6570\u636e\u7684\u5907\u4efd\uff0c\u5373 master-slave \u6a21\u5f0f\u7684\u6570\u636e\u5907\u4efd</li> <li>Redis \u53ef\u4ee5\u5b58\u50a8\u952e\u548c\u4e94\u79cd\u4e0d\u540c\u7c7b\u578b\u7684\u503c\u4e4b\u95f4\u7684\u6620\u5c04\u3002\u952e\u7684\u7c7b\u578b\u53ea\u80fd\u4e3a\u5b57\u7b26\u4e32\uff0c\u503c\u652f\u6301\u4e94\u79cd\u6570\u636e\u7c7b\u578b\uff1a\u5b57\u7b26\u4e32\u3001\u5217\u8868\u3001\u96c6\u5408\u3001\u6563\u5217\u8868\u3001\u6709\u5e8f\u96c6\u5408</li> </ul>"},{"location":"redis/01.redis%E7%AE%80%E4%BB%8B/#redis","title":"redis\u7b80\u53f2","text":"<p>Redis \u7531 Salvatore Sanfilippo\uff08\u53c8\u540dantirez\uff09\u4e8e 2009 \u5e74\u521b\u5efa\uff0c\u7531\u4e8e\u5176\u901f\u5ea6\u548c\u7b80\u5355\u6027\uff0c\u5b83\u5f88\u5feb\u5728\u5f00\u53d1\u4eba\u5458\u4e2d\u6d41\u884c\u8d77\u6765\u3002</p> <p>redis labs\u521b\u7acb\u4e8e2011\u5e74\uff0c\u516c\u53f8\u81f4\u529b\u4e8e\u4e3aRedis\u3001Memcached\u7b49\u6d41\u884c\u7684NoSQL\u5f00\u6e90\u6570\u636e\u5e93\u63d0\u4f9b\u4e91\u6258\u7ba1\u670d\u52a1\u3002\u53ef\u4ee5\u7b97\u662f\u4e13\u95e8\u81f4\u529b\u4e8eredis\u4e91\u7684\u4e00\u5bb6\u4e13\u4e1a\u516c\u53f8\u3002\u4ed6\u4eec\u7684\u63d0\u4f9b\u7684\u8f6f\u4ef6\u4e2d\uff0c\u9664\u4e86\u53ef\u4ee5\u8fde\u63a5\u4f01\u4e1a\u79c1\u6709\u7684redis\u670d\u52a1\uff0c\u4e5f\u53ef\u4ee5\u8fde\u63a5\u4ed6\u4eec\u7684redis\u4e91\u3002</p> <p>redis labs\u516c\u53f8\u5728 2011 \u5e74\u6210\u7acb\u540e\u4e0d\u4e45\u5c31\u5f00\u59cb\u4e3a\u5f00\u6e90\u9879\u76ee\u505a\u51fa\u8d21\u732e\u3002 2015 \u5e74\uff0cSanfilippo \u52a0\u5165\u516c\u53f8\uff0c\u6210\u4e3a\u8be5\u9879\u76ee\u7684\u53d1\u8d77\u4eba\uff0c\u5e76\u4e8e 2018 \u5e74\u5c06 Redis \u9879\u76ee\u7684\u77e5\u8bc6\u4ea7\u6743\u548c\u5546\u6807\u6743\u8f6c\u8ba9\u7ed9\u4e86\u516c\u53f8\u3002</p> <p><code>2020.07.01</code> antirez \u4ee5\u4e00\u7bc7\u300aThe end of the Redis adventure\u300b\u5ba3\u544a\u81ea\u5df1\u6b63\u5f0f<code>\"\u9000\u4f11\"</code>\uff0c\u4e0d\u518d\u53c2\u4e0eRedis\u5f00\u6e90\u9879\u76ee\u7684\u5f00\u53d1\u4e0e\u9879\u76ee\u7ef4\u62a4\u5de5\u4f5c\uff0c\u4ec5\u4ec5\u53ea\u662fRedis\u987e\u95ee\u59d4\u5458\u4f1a\u7684\u4e00\u5458\u3002</p> <p><code>2021.08.01</code>\uff0cRedis Labs \u5ba3\u5e03\u8be5\u516c\u53f8\u73b0\u5df2\u6ce8\u518c\u4e3aRedis\uff0c\u4ece\u5176\u540d\u79f0\u4e2d\u5220\u9664\u4e86\"Labs\"\u3002\u8fd9\u4e00\u53d8\u5316\u6807\u5fd7\u7740\u8be5\u516c\u53f8\u548c Redis \u5f00\u6e90\u9879\u76ee\u7684\u6210\u719f\uff0c\u8be5\u9879\u76ee\u81ea 2011 \u5e74\u5f00\u59cb\u8d21\u732e\u5e76\u81ea 2015 \u5e74\u8d77\u8d5e\u52a9\u3002redislabs\u7f51\u7ad9\u4e5f\u91cd\u5b9a\u5411\u5230redis\u7f51\u7ad9</p> <p>\u516c\u53f8\u66f4\u540d\u4e0d\u4f1a\u5f71\u54cd\u5f00\u6e90 Redis\u7684\u8bb8\u53ef\uff0c\u5b83\u4e00\u76f4\u662f\u5e76\u5c06\u7ee7\u7eed\u662f BSD \u8bb8\u53ef\u7684\u3002\u66f4\u540d\u4e5f\u53cd\u6620\u4e86\u516c\u53f8\u7ee7\u7eed\u5c06 Redis \u4f5c\u4e3a\u5b9e\u65f6\u6570\u636e\u5e73\u53f0\u53d1\u5c55\u7684\u4f7f\u547d\u3002\u8be5\u516c\u53f8\u4e13\u6ce8\u4e8e\u9886\u5bfc\u548c\u6307\u5bfc\u6574\u4e2a\u793e\u533a\uff08\u5305\u62ec\u4e2a\u4eba\u8d21\u732e\u8005\u3001\u5ba2\u6237\u548c\u5408\u4f5c\u4f19\u4f34\uff09\u7684\u4e00\u81f4\u6027\uff0c\u4ee5\u63d0\u4f9b\u5e94\u5bf9\u6280\u672f\u6311\u6218\u7684\u89e3\u51b3\u65b9\u6848\u5e76\u4fdd\u6301\u5176\u7ecf\u4e45\u4e0d\u8870\u7684\u53d7\u6b22\u8fce\u7a0b\u5ea6\u3002</p> <p>Redis \u901a\u8fc7\u6cbb\u7406\u6a21\u578b\u8fdb\u884c\u7ef4\u62a4\uff0c\u8be5\u6a21\u578b\u7531\u516c\u53f8\u6838\u5fc3\u4eba\u5458\u4ee5\u53ca\u5bf9 Redis \u505a\u51fa\u957f\u671f\u627f\u8bfa\u5e76\u505a\u51fa\u91cd\u5927\u8d21\u732e\u7684\u793e\u533a\u6210\u5458\u7ec4\u6210\u3002</p> <p>\u6838\u5fc3\u56e2\u961f\u8d1f\u8d23\u4e3b Redis \u5b58\u50a8\u5e93\u3002\u4ed6\u4eec\u8fd8\u4e0e\u7ec4\u6210 Redis \u751f\u6001\u7cfb\u7edf\u7684\u5176\u4ed6\u9879\u76ee\u8fdb\u884c\u534f\u8c03\u548c\u534f\u4f5c\uff0c\u5305\u62ec\u5ba2\u6237\u7aef\u5e93\u3001\u536b\u661f\u9879\u76ee\u548c\u4f9d\u8d56 Redis \u7684\u4e3b\u8981\u4e2d\u95f4\u4ef6\u3002</p> <p>\u8bf4\u5230\u6570\u636e\u5e93\uff0c\u53ef\u80fd\u5927\u5bb6\u7528\u5f97\u6700\u591a\u7684\u662f\u5173\u7cfb\u578b\u6570\u636e\u5e93\uff0c\u6bd4\u5982 MySQL\uff0cPostgreSQL \u7b49\u3002\u8fd9\u79cd\u6570\u636e\u5e93\u662f\u628a\u6570\u636e\u5b58\u5230\u78c1\u76d8\u4e2d\u7684\uff0c\u8fd9\u79cd\u80fd\u5b58\u5927\u91cf\u7684\u6570\u636e\uff0c\u7136\u800c\u6211\u4eec\u7684\u5e94\u7528\u662f\u7ecf\u5e38\u9700\u8981\u8bbf\u95ee\u6570\u636e\u5e93\u6765\u67e5\u627e\u6570\u636e\u3002\u6bcf\u6b21\u8bbf\u95ee\uff0c\u65e0\u8bba\u600e\u6837\uff0c\u90fd\u662f\u9700\u8981\u6d88\u8017CPU\u548cIO\u7b49\u5f85\u3002</p> <p>\u5f53\u5e94\u7528\u7684\u6570\u636e\u79ef\u7d2f\u5230\u5f88\u5e9e\u5927\u65f6\uff0c\u8fd9\u79cd\u6027\u80fd\u7684\u95ee\u9898\u66f4\u4e25\u91cd\uff0c\u6240\u4ee5\u6709\u4e00\u79cd\u89e3\u51b3\u65b9\u6cd5\u662f\u8fd9\u6837\u7684\uff0c\u628a\u7ecf\u5e38\u88ab\u8bbf\u95ee\u7684\u6570\u636e\u653e\u5230\u5185\u5b58\u4e2d\uff0c\u56e0\u4e3a\u5185\u5b58\u7684\u8bbf\u95ee\u901f\u5ea6\u6bd4\u78c1\u76d8\u5feb\u592a\u591a\u4e86\u3002</p> <p>\u4f46\u662f\u8fd9\u90e8\u5206\u6570\u636e\u53ef\u80fd\u4e0d\u4f1a\u662f\u5168\u90e8\u7684\u6570\u636e\uff0c\u56e0\u4e3a\u5185\u5b58\u7684\u4ef7\u683c\u6bd4\u78c1\u76d8\u8d35\u591a\u4e86\u3002\u6240\u4ee5\u6709\u4e86 memcached \uff0c\u8fd9\u79cd\u5c31\u662f\u628a\u6570\u636e\u653e\u5230\u5185\u5b58\u4e2d\uff0c\u4f46\u5b83\u4ec5\u652f\u6301\u4e00\u79cd\u6700\u7b80\u5355\u7684\u6570\u636e\u7ed3\u6784\uff0c\u5c31\u662f\u952e\u503c\u5bf9\uff0c\u8fd9\u79cd\u6570\u636e\u5e93\u53c8\u4e0d\u540c\u4e8e\u4f20\u7edf\u7ed3\u6784\u578b\u7684\u5173\u7cfb\u578b\u6570\u636e\u5e93\uff0c\u6240\u4ee5\u53c8\u88ab\u79f0\u4e3a nosql\u3002</p> <p>\u800c redis \u4e5f\u662f nosql \u7684\u4e00\u79cd\uff0c\u4f46\u5b83\u76f8\u6bd4 memcached \u4e0d\u4ec5\u652f\u6301\u952e\u503c\u5bf9\uff0c\u8fd8\u652f\u6301\u5217\u8868\uff0c\u96c6\u5408\uff0c\u6392\u5e8f\u96c6\u5408\u7b49\u591a\u79cd\u7ed3\u6784\uff0c\u800c\u4e14\u5b83\u8fd8\u662f\u53ef\u6301\u4e45\u5316\u7684\u3002</p> <p>\u6301\u4e45\u5316\u5c31\u662f\u8bf4\u5728\u5185\u5b58\u4e2d\u7684\u6570\u636e\u4f1a\u4ee5\u6587\u4ef6\u7684\u5f62\u5f0f\u540c\u6b65\u5230\u78c1\u76d8\u4e2d\uff0c\u5f53\u4e0b\u6b21\u91cd\u542f\u65f6\u8fd8\u80fd\u6062\u590d\uff0c\u8fd9\u70b9\u76f8\u6bd4memcached\uff0c\u5c31\u80fd\u5b58\u76f8\u5bf9\u91cd\u8981\u7684\u6570\u636e\u3002\u6bd5\u7adf\u5982\u679c\u6570\u636e\u4e0d\u80fd\u6301\u4e45\u5316\uff0c\u4e22\u5931\u4e86\u4e5f\u662f\u4ef6\u9ebb\u70e6\u7684\u4e8b\uff0c\u8c01\u4e5f\u4fdd\u8bc1\u4e0d\u4e86\u4e0d\u4f1a\u51fa\u95ee\u9898\u3002</p> <p>\u8fd8\u6709\u4e00\u4e2a\u5f88\u91cd\u8981\u7684\u7279\u5f81\u5c31\u662f redis \u652f\u6301\u5206\u5e03\u5f0f\u96c6\u7fa4\uff0c\u7528\u5b83\u53ef\u4ee5\u8f7b\u6613\u5730\u90e8\u7f72\u5230\u591a\u53f0\u673a\u5668\u4e2d\uff0c\u6210\u4e3a\u4e00\u4e2a\u96c6\u7fa4\u3002\u7279\u522b\u662f 3.0 \u5f00\u59cb\uff0credis \u5bf9\u96c6\u7fa4\u7684\u652f\u6301\u6bd4\u8f83\u5065\u5168\u4e86\u3002</p> <p>redis \u6bd4\u8f83\u5e38\u89c1\u7684\u4f5c\u7528\u548c\u5e94\u7528\u573a\u666f\uff1a</p> <ul> <li>\u7b2c\u4e00\u4e2a\u662f cache\uff0c\u8fd9\u662f\u7531\u4e8e\u5b83\u7684\u6570\u636e\u5b58\u5728\u5185\u5b58\u4e2d\uff0c\u8bbf\u95ee\u901f\u5ea6\u6bd4\u8f83\u5feb\uff0c\u5b83\u80fd\u8ba9\u6570\u636e\u5728\u4e00\u5b9a\u65f6\u95f4\u540e\u8fc7\u671f\uff0c\u4e14\u53c8\u6709\u4e30\u5bcc\u7684\u6570\u636e\u7ed3\u6784\u7684\u652f\u6301\uff0c\u6240\u4ee5\u5b83\u80fd\u4f5c\u4e3a\u4e00\u4e2a\u9ad8\u6027\u80fd\u7684 cache\u3002</li> <li>\u7b2c\u4e8c\u4e2a\u662f\u4f5c\u4e3a\u6d88\u606f\u961f\u5217\uff0c\u7528\u7684\u662f\u5b83\u7684 sub/pub \u7684\u529f\u80fd\uff0c\u80fd\u5177\u6709\u6d88\u606f\u8d39\u751f\u4ea7\u8005\u7684\u6a21\u5f0f\uff0c\u4e14\u662f\u6570\u636e\u5b58\u5728\u5185\u5b58\u4e2d\uff0c\u8bbf\u95ee\u901f\u5ea6\u9ad8\u3002</li> <li>\u505a\u4e3a session \u7684\u5b58\u50a8\uff0c\u53ef\u4ee5\u8f7b\u677e\u7684\u5b9e\u73b0\u5206\u5e03\u5f0f session \u670d\u52a1\u5668\u3002</li> <li>\u9879\u76ee\u4e2d\u4f7f\u7528Redis\uff0c\u4e3b\u8981\u8003\u8651 \u6027\u80fd\u548c\u5e76\u53d1\u3002\u5982\u679c\u4ec5\u4ec5\u662f\u5206\u5e03\u5f0f\u9501\u8fd9\u4e9b\uff0c\u5b8c\u5168\u53ef\u4ee5\u7528\u4e2d\u95f4\u4ef6 <code>zookeeper</code> \u7b49\u4ee3\u66ff\u3002</li> </ul> <p>redis \u5728\u5b9e\u9645\u9879\u76ee\u4e2d\u7684\u5e94\u7528\u573a\u666f\uff1a</p> <ul> <li> <p>\u8bb0\u5f55\u5e16\u5b50\u7684\u70b9\u8d5e\u6570\u3001\u8bc4\u8bba\u6570\u548c\u70b9\u51fb\u6570 (hash)\u3002</p> </li> <li> <p>\u8bb0\u5f55\u7528\u6237\u7684\u5e16\u5b50 ID \u5217\u8868 (\u6392\u5e8f)\uff0c\u4fbf\u4e8e\u5feb\u901f\u663e\u793a\u7528\u6237\u7684\u5e16\u5b50\u5217\u8868 (zset)\u3002</p> </li> <li> <p>\u8bb0\u5f55\u5e16\u5b50\u7684\u6807\u9898\u3001\u6458\u8981\u3001\u4f5c\u8005\u548c\u5c01\u9762\u4fe1\u606f\uff0c\u7528\u4e8e\u5217\u8868\u9875\u5c55\u793a (hash)\u3002</p> </li> <li> <p>\u8bb0\u5f55\u5e16\u5b50\u7684\u70b9\u8d5e\u7528\u6237 ID \u5217\u8868\uff0c\u8bc4\u8bba ID \u5217\u8868\uff0c\u7528\u4e8e\u663e\u793a\u548c\u53bb\u91cd\u8ba1\u6570 (zset)\u3002</p> </li> <li> <p>\u7f13\u5b58\u8fd1\u671f\u70ed\u5e16\u5185\u5bb9 (\u5e16\u5b50\u5185\u5bb9\u7a7a\u95f4\u5360\u7528\u6bd4\u8f83\u5927)\uff0c\u51cf\u5c11\u6570\u636e\u5e93\u538b\u529b (hash)\u3002</p> </li> <li> <p>\u8bb0\u5f55\u5e16\u5b50\u7684\u76f8\u5173\u6587\u7ae0 ID\uff0c\u6839\u636e\u5185\u5bb9\u63a8\u8350\u76f8\u5173\u5e16\u5b50 (list)\u3002</p> </li> <li> <p>\u5982\u679c\u5e16\u5b50 ID \u662f\u6574\u6570\u81ea\u589e\u7684\uff0c\u53ef\u4ee5\u4f7f\u7528 Redis \u6765\u5206\u914d\u5e16\u5b50 ID(\u8ba1\u6570\u5668)\u3002</p> </li> <li> <p>\u6536\u85cf\u96c6\u548c\u5e16\u5b50\u4e4b\u95f4\u7684\u5173\u7cfb (zset)\u3002</p> </li> <li> <p>\u8bb0\u5f55\u70ed\u699c\u5e16\u5b50 ID \u5217\u8868\uff0c\u603b\u70ed\u699c\u548c\u5206\u7c7b\u70ed\u699c (zset)\u3002</p> </li> <li> <p>\u7f13\u5b58\u7528\u6237\u884c\u4e3a\u5386\u53f2\uff0c\u8fdb\u884c\u6076\u610f\u884c\u4e3a\u8fc7\u6ee4 (zset,hash)\u3002</p> </li> </ul>"},{"location":"redis/01.redis%E7%AE%80%E4%BB%8B/#_2","title":"\u5b89\u88c5","text":"<pre><code># \u6e90\u7801\u5305\u7f16\u8bd1\u5b89\u88c5redis6.0\n\n\n# \u521b\u5efa\u597d\u6307\u5b9a\u8fd0\u884credis\u7684\u7528\u6237\ngroupadd redis\nuseradd -r -g redis -s /bin/false redis\nsudo mkdir -p  /home/redis/{run,dbdata}\nchown -R redis:redis /home/redis/\n\n## \u51c6\u5907gcc\u73af\u5883\n# centos7 \u9ed8\u8ba4\u7684 gcc \u7248\u672c\u4e3a\uff1a4.8.5 &lt; 5.3 \u65e0\u6cd5\u7f16\u8bd1\nsudo yum -y install centos-release-scl tcl tclx tcl-devel   systemd-devel \nsudo yum -y install devtoolset-9-gcc devtoolset-9-gcc-c++ devtoolset-9-binutils \n# \u4e34\u65f6\u6709\u6548\uff0c\u9000\u51fa shell \u6216\u91cd\u542f\u4f1a\u6062\u590d\u539f gcc \u7248\u672c\nsudo scl enable devtoolset-9 bash\n# \u957f\u671f\u6709\u6548\nsudo echo \"source /opt/rh/devtoolset-9/enable\" &gt;&gt;/etc/profile\n\n# ubuntu\u51c6\u5907\u76f8\u5173\u5de5\u5177\n$ sudo apt-get install  gcc g++ libxml2  pkg-config  libxml2-dev libsqlite3-dev tcl tk make\n\n# \u4e0b\u8f7d\u6e90\u4ee3\u7801\u5305\ngit clone -b 6.0 https://github.com/redis/redis.git  /usr/local/src/redis/\nwget http://download.redis.io/releases/redis-6.0.5.tar.gz  -O  /usr/local/src/redis-6.0.5.tar.gz\nwget http://download.redis.io/releases/redis-7.0.3.tar.gz  -O  /usr/local/src/redis-7.0.3.tar.gz\n# \u89e3\u538b\ntar xf redis-6.0.5.tar.gz  &amp;&amp; cd redis-6.0.5\n\n# \u7f16\u8bd1\uff0c\uff0c\u5177\u4f53\u7f16\u8bd1\u53c2\u6570\uff1a\n# USE_SYSTEMD=yes  \u652f\u6301\u4ee5systemd\u7cfb\u7edf\u670d\u52a1\u65b9\u5f0f\u6765\u7ba1\u7406redis\uff0c\u9700\u8981\u5305\u7684\u652f\u6301\uff1alibsystemd-dev on Debian/Ubuntu or systemd-devel on CentOS\n# PREFIX=/some/other/directory \u6307\u5b9a\u5c06redis\u53ef\u6267\u884c\u6587\u4ef6\u5b89\u88c5\u5230\u4e0d\u540c\u76ee\u5f55\u4e0b\n# BUILD_TLS=yes  \u5f00\u542fTLS\u901a\u8baf\uff0c\u4e00\u822c\u4e5f\u4e0d\u9700\u8981\n# MALLOC=libc   \u5728ubuntu\u4f7f\u7528\u8fd9\u4e2a\u53c2\u6570 MALLOC=libc\uff0c\u4e00\u822c\u4e0d\u9700\u8981\u8bbe\u7f6e\u8fd9\u4e2a\nsudo make USE_SYSTEMD=yes\n\n# \u5b89\u88c5\uff0c\u5b89\u88c5\u540e\uff0c\u4e8c\u8fdb\u5236\u6587\u4ef6\u4f1a\u88ab\u590d\u5236\u5230/usr/local/bin\u76ee\u5f55\u4e0b\nsudo make install\n\n\n# \u521b\u5efa\u914d\u7f6e\u76ee\u5f55\uff0c\u5982\u679c\u591a\u4e2a\u5b9e\u4f8b\uff0c\u53ef\u4ee5\u7528/etc/redis/6379.conf,/etc/redis/6380.conf\u8fd9\u6837\u6765\u914d\u7f6e\nsudo mkdir /etc/redis\n\n# \u914d\u7f6e\u6587\u4ef6\u53bb\u6389\u7a7a\u683c\u548c\u6ce8\u91ca\ngrep -v '^#' redis.conf | grep -v '^$' &gt;  /etc/redis.conf\n\ncp utils/redis_init_script \n\n# \u6e90\u4ee3\u7801\u5305\u89e3\u538b\u4e4b\u540e\u7684./utils/redis_init_script \u53ef\u4ee5\u505a\u4e3a\u4e00\u4e2a\u7b80\u5355\u7684\u542f\u505c\u811a\u672c\n# https://github.com/redis/redis/blob/unstable/utils/redis_init_script\n\n# \u6e90\u4ee3\u7801\u5305\u89e3\u538b\u4e4b\u540e\u7684./utils/install_server.sh \u53ef\u4ee5\u8fdb\u884c\u4e00\u4e2a\u4ea4\u4e92\u5f0f\u7684\u5f15\u5bfc\u7528\u6237\u751f\u6210\u914d\u7f6e\u6587\u4ef6\uff0c\u5e76\u6ce8\u518c\u6210\u7cfb\u7edf\u670d\u52a1\n# https://github.com/redis/redis/blob/unstable/utils/install_server.sh\n\n\n# /usr/lib/systemd/system/redis.service\n[Unit]\nDescription=Redis persistent key-value database\nWants=network-online.target\nAfter=network.target\n[Service]\nExecStart=/usr/local/bin/redis-server /etc/redis.conf --supervised systemd\nExecStop=/bin/kill -s QUIT $MAINPID\nType=notify\nUser=redis\nGroup=redis\nRuntimeDirectory=redis\nRuntimeDirectoryMode=0755\n[Install]\nWantedBy=multi-user.target\n\n\n\n# \u4fee\u6539\u914d\u7f6e\u6587\u4ef6 redis.conf \n\n# include /path/to/local.conf \n# \u50cf\u5f88\u591a\u8f6f\u4ef6\u4e00\u6837\uff0cinclude\u8bed\u6cd5\u5bfc\u5165\u5176\u4ed6\u914d\u7f6e\u6587\u4ef6\uff0c\u5c06\u914d\u7f6e\u6587\u4ef6\u5206\u6210\u591a\u5757\uff0c\u5206\u5c42\u7ba1\u7406\uff0c\u4e0d\u652f\u6301\u5339\u914d\u6a21\u5f0f\uff0c\u5fc5\u987b\u5355\u4e2a\u5bfc\u5165\uff0c\u5bfc\u5165\u914d\u7f6e\u4f1a\u8986\u76d6\u5bfc\u5165\u914d\u7f6e\u4e4b\u524d\u7684\u914d\u7f6e\uff1b\n\n#\u3000\u7f51\u7edc\u914d\u7f6e\nbind  *             # \u76d1\u542c\u591a\u4e2a\u7f51\u5361\u5730\u5740 \u3000bind 192.168.1.100 10.1.0.1 \uff0credis\u5c3d\u91cf\u4e0d\u8981\u76f4\u63a5\u5bf9\u516c\u7f51\u5f00\u653e\nport 6379           # \u76d1\u542c\u7aef\u53e3\u53f7\uff0c\u5b9e\u5728\u8981\u5bf9\u516c\u7f51\u5f00\u653e\uff0c\u4fee\u6539\u9ed8\u8ba4\u7aef\u53e3\u80fd\u907f\u514d\u88ab\u626b\u63cf\u3002\n\nprotect-mode  yes      # \u5b89\u5168\u6a21\u5f0f\nrequirepass Elw2Ea&amp;3kvmDwv0  # redis\u5bc6\u7801\u662f\u660e\u6587\u4fdd\u5b58\uff0c\u5fc5\u987b\u8981\u8bbe\u7f6e\u8d85\u9ad8\u5f3a\u5ea6\u5bc6\u7801\ndaemonize yes       # \u5b88\u62a4\u8fdb\u7a0b\u7684\u65b9\u5f0f\u542f\u52a8\n\npidfile /var/run/redis_6379.pid  # pid\u6587\u4ef6\nloglevel notice  # \u65e5\u5fd7\u7ea7\u522b\nlogfile \"\"       # \u65e5\u5fd7\u6587\u4ef6\n\n\n# \u7981\u7528\u6216\u8005\u91cd\u547d\u540d\u5371\u9669\u547d\u4ee4\n# Redis\u4e2d\u7ebf\u4e0a\u4f7f\u7528keys *\u547d\u4ee4\uff0c\u4e5f\u662f\u975e\u5e38\u5371\u9669\u7684\u3002\u56e0\u6b64\u7ebf\u4e0a\u7684Redis\u5fc5\u987b\u8003\u8651\u7981\u7528\u4e00\u4e9b\u5371\u9669\u7684\u547d\u4ee4\uff0c\u6216\u8005\u5c3d\u91cf\u907f\u514d\u8c01\u90fd\u53ef\u4ee5\u4f7f\u7528\u8fd9\u4e9b\u547d\u4ee4\uff0cRedis\u6ca1\u6709\u5b8c\u6574\u7684\u6743\u9650\u7ba1\u7406\uff0c\u4f46\u662f\u4e5f\u63d0\u4f9b\u4e86\u4e00\u4e9b\u65b9\u6848\u3002\n# \u91cd\u547d\u540d\u4e3a\"\" \u4ee3\u8868\u7981\u7528\u547d\u4ee4\uff0c\u5982\u60f3\u4fdd\u7559\u547d\u4ee4\uff0c\u53ef\u4ee5\u91cd\u547d\u540d\u4e3a\u4e0d\u53ef\u731c\u6d4b\u7684\u5b57\u7b26\u4e32\uff0c\u5982\uff1a rename-command FLUSHALL joYAPNXRPmcarcR4ZDgC\nrename-command FLUSHALL \"\"\nrename-command FLUSHDB  \"\"\nrename-command CONFIG   \"\"\nrename-command KEYS     \"\"\nrename-command SHUTDOWN \"\"\nrename-command DEL \"\"\nrename-command EVAL \"\"\n\n\n\n\n\n\n\n./redis-server /path/to/redis.conf\n./redis-server --daemonize yes\n\n\n\n\n# Install Redis Server on Ubuntu 18.04\nsudo apt-get update\nsudo apt-get upgrade\nsudo apt-get install redis-server\n# \u5f00\u673a\u81ea\u542f\nsudo systemctl enable redis-server.service\n# \u5728\u914d\u7f6e\u6587\u4ef6\u4e2d\u4fee\u6539\u4f7f\u7528systemd\u6765\u505a\u4e3aredis\u7684\u5b88\u62a4\u8fdb\u7a0b\u7ba1\u7406\u5de5\u5177\nsupervised systemd\n\n\n\n# Installing Redis Server on CentOS 7\nyum install epel-release\nyum install redis \n\n\n# vim  /etc/sysctl.conf \u8bbe\u7f6e\u5185\u5b58\u53c2\u6570\n# \u5185\u6838\u53c2\u6570overcommit_memory:\u5185\u5b58\u5206\u914d\u7b56\u7565\uff0c\u5728Ubuntu\u548cCentOS\u4e2d\u8fd9\u4e2a\u53c2\u6570\u503c\u9ed8\u8ba4\u662f0\n# \u67e5\u770b cat /proc/sys/vm/overcommit_memory\n# \u53ef\u9009\u503c\uff1a0\u30011\u30012\u3002\n# 0\uff0c \u8868\u793a\u5185\u6838\u5c06\u68c0\u67e5\u662f\u5426\u6709\u8db3\u591f\u7684\u53ef\u7528\u5185\u5b58\u4f9b\u5e94\u7528\u8fdb\u7a0b\u4f7f\u7528\uff1b\u5982\u679c\u6709\u8db3\u591f\u7684\u53ef\u7528\u5185\u5b58\uff0c\u5185\u5b58\u7533\u8bf7\u5141\u8bb8\uff1b\u5426\u5219\uff0c\u5185\u5b58\u7533\u8bf7\u5931\u8d25\uff0c\u5e76\u628a\u9519\u8bef\u8fd4\u56de\u7ed9\u5e94\u7528\u8fdb\u7a0b\u3002\n# 1\uff0c \u8868\u793a\u5185\u6838\u5141\u8bb8\u5206\u914d\u6240\u6709\u7684\u7269\u7406\u5185\u5b58\uff0c\u800c\u4e0d\u7ba1\u5f53\u524d\u7684\u5185\u5b58\u72b6\u6001\u5982\u4f55\u3002\n# 2\uff0c \u8868\u793a\u5185\u6838\u5141\u8bb8\u5206\u914d\u8d85\u8fc7\u6240\u6709\u7269\u7406\u5185\u5b58\u548c\u4ea4\u6362\u7a7a\u95f4\u603b\u548c\u7684\u5185\u5b58\nvm.overcommit_memory = 1\n\n\n\n\n# docker\u7248\u672c\ndocker pull redis:latest\n\n\nREDIS=/home/ybd/data/docker/redis &amp;&amp; \\\ndocker run -p 6379:6379 --restart=always \\\n-v $REDIS/redis.conf:/usr/local/etc/redis/redis.conf \\\n-v $REDIS/data:/data \\\n--name redis -d redis \\\nredis-server /usr/local/etc/redis/redis.conf --appendonly yes\n\n\n\n\n# docker-compose.yml \nversion: '3'\nservices:\n  redis:\n    image: redis:latest\n#    command: [\"redis-server\", \"--appendonly\", \"yes\"]\n    command: [\"redis-server\", \"/usr/local/etc/redis/redis.conf\"]\n    restart: always\n    ports:\n      - \"6379:6379\"\n    networks:\n      backend-swarm:\n        aliases:\n         - redis\n    volumes:\n      - ./data:/data\n      - ./config/redis.conf:/usr/local/etc/redis/redis.conf\n\n# docker network create -d=overlay --attachable backend\nnetworks:\n  backend-swarm:\n    external:\n      name: backend-swarm\n</code></pre>"},{"location":"redis/01.redis%E7%AE%80%E4%BB%8B/#redis_1","title":"\u9488\u5bf9redis\u7684\u5185\u6838\u53c2\u6570\u4f18\u5316","text":"<pre><code># vim  /etc/sysctl.conf \u8bbe\u7f6e\u5185\u5b58\u53c2\u6570\n# \u5185\u6838\u53c2\u6570overcommit_memory:\u5185\u5b58\u5206\u914d\u7b56\u7565\uff0c\u5728Ubuntu\u548cCentOS\u4e2d\u8fd9\u4e2a\u53c2\u6570\u503c\u9ed8\u8ba4\u662f0\n# \u67e5\u770b cat /proc/sys/vm/overcommit_memory\n# \u53ef\u9009\u503c\uff1a0\u30011\u30012\u3002\n# 0\uff0c \u8868\u793a\u5185\u6838\u5c06\u68c0\u67e5\u662f\u5426\u6709\u8db3\u591f\u7684\u53ef\u7528\u5185\u5b58\u4f9b\u5e94\u7528\u8fdb\u7a0b\u4f7f\u7528\uff1b\u5982\u679c\u6709\u8db3\u591f\u7684\u53ef\u7528\u5185\u5b58\uff0c\u5185\u5b58\u7533\u8bf7\u5141\u8bb8\uff1b\u5426\u5219\uff0c\u5185\u5b58\u7533\u8bf7\u5931\u8d25\uff0c\u5e76\u628a\u9519\u8bef\u8fd4\u56de\u7ed9\u5e94\u7528\u8fdb\u7a0b\u3002\n# 1\uff0c \u8868\u793a\u5185\u6838\u5141\u8bb8\u5206\u914d\u6240\u6709\u7684\u7269\u7406\u5185\u5b58\uff0c\u800c\u4e0d\u7ba1\u5f53\u524d\u7684\u5185\u5b58\u72b6\u6001\u5982\u4f55\u3002\n# 2\uff0c \u8868\u793a\u5185\u6838\u5141\u8bb8\u5206\u914d\u8d85\u8fc7\u6240\u6709\u7269\u7406\u5185\u5b58\u548c\u4ea4\u6362\u7a7a\u95f4\u603b\u548c\u7684\u5185\u5b58\nvm.overcommit_memory = 1\n\n# \u8ffd\u52a0\u8fd9\u4e2a\u53c2\u6570\u5230\u914d\u7f6e\u6587\u4ef6\u672b\u5c3e\necho \"vm.overcommit_memory = 1\" &gt;&gt; /etc/sysctl.conf\n# \u5f53\u524d\u4e34\u65f6\u8bbe\u7f6e\u751f\u6548\nsysctl vm.overcommit_memory=1 \n\n\necho madvise &gt; /sys/kernel/mm/transparent_hugepage/enabled\n\n\n# WARNING: The TCP backlog setting of 511 cannot be enforced because /proc/sys/net/core/somaxconn is set to the lower value of 128.\n\n#  WARNING overcommit_memory is set to 0! Background save may fail under low memory condition. To fix this issue add 'vm.overcommit_memory = 1' to /etc/sysctl.conf and then reboot or run the command 'sysctl vm.overcommit_memory=1' for this to take effect\n\n\n\n\n# WARNING you have Transparent Huge Pages (THP) support enabled in your kernel. This will create latency and memory usage issues with Redis. To fix this issue run the command 'echo never &gt; /sys/kernel/mm/transparent_hugepage/enabled' as root, and add it to your /etc/rc.local in order to retain the setting after a reboot. Redis must be restarted after THP is disabled.\n</code></pre>"},{"location":"redis/01.redis%E7%AE%80%E4%BB%8B/#_3","title":"\u76f8\u5173\u6587\u4ef6","text":"\u53ef\u6267\u884c\u6587\u4ef6 \u4f5c\u7528 /usr/bin/redis-cli redis\u5ba2\u6237\u7aef\u5de5\u5177\uff0c\u547d\u4ee4\u884c\u5de5\u5177 /usr/bin/redis-check-rdb /usr/bin/redis-server redis\u670d\u52a1\u7aef\u5b88\u62a4\u8fdb\u7a0b /usr/bin/redis-check-aof /usr/bin/redis-benchmark redis\u6027\u80fd\u6d4b\u8bd5\u5de5\u5177 /usr/lib/systemd/system/redis.service redis\u542f\u52a8\u811a\u672c\u6587\u4ef6 /etc/redis.conf redis\u914d\u7f6e\u6587\u4ef6"},{"location":"redis/01.redis%E7%AE%80%E4%BB%8B/#redis-cli","title":"redis-cli","text":"<p>\u4e0e MySQL \u4e2d\u7684 mysql \u4e8c\u8fdb\u5236\u6587\u4ef6\uff0credis-cli \u4e5f\u662f\u4e00\u4e2a\u5ba2\u6237\u7aef\u5de5\u5177\uff0c\u4f7f\u7528 redis-cli  \u53bb\u767b\u9646</p> <pre><code>redis-cli -h host -p port  -a  password\n</code></pre>"},{"location":"redis/01.redis%E7%AE%80%E4%BB%8B/#redis_2","title":"redis \u57fa\u672c\u6982\u5ff5","text":"<p>Redis\u9ed8\u8ba4\u63d0\u4f9b\u4e8616\u4e2a\u6570\u636e\u5e93\uff08database\uff09\uff0c\u6bcf\u4e2a\u6570\u636e\u5e93\u6709\u4e00\u4e2aid\uff0c\u4ece0\u523015\uff0c\u4ed6\u4eec\u6ca1\u6709\u540d\u5b57\uff0c\u53ea\u6709id\u3002</p> <p>\u53ef\u4ee5\u5728Redis\u914d\u7f6e\u6587\u4ef6\u4e2d\u4fee\u6539\u6570\u636e\u5e93\u4e2a\u6570\uff0c\u4f7f\u7528\u4ee5\u4e0b\u914d\u7f6e(\u4ee3\u8868\u542f\u52a8\u65f6\u63d0\u4f9b32\u4e2a\u6570\u636e\u5e93)\uff1a</p> <p>databases 32 </p> <p>\u5ba2\u6237\u7aef\u767b\u5f55 redis \u65f6\u9ed8\u8ba4\u767b\u5f55\u7684\u662f id \u4e3a 0 \u7684\u6570\u636e\u5e93\u3002\u53ef\u4ee5\u968f\u65f6\u4f7f\u7528 SELECT \u547d\u4ee4\u66f4\u6362\u6570\u636e\u5e93\u3002</p> <p>\u5728\u5b9e\u9645\u9879\u76ee\u4e2d\u5219\u53ef\u4ee5\u901a\u8fc7\u4ee5\u914d\u7f6e\u6587\u4ef6\u7684\u5f62\u5f0f\u6307\u5b9a\u6570\u636e\u5e93\u3002</p> <pre><code># https://www.jianshu.com/p/5abbee8e4564\n####\u5355\u673a\u6a21\u5f0f#######\n##redis\u7684\u670d\u52a1\u5668\u5730\u5740\nredis.host=192.168.1.20\n##redis\u7684\u670d\u52a1\u7aef\u53e3 \nredis.port=6400 \n\n####\u54e8\u5175\u6a21\u5f0f\n##redis\u7684\u670d\u52a1\u5668\u5730\u5740\nredis.sentinel.master.host=192.168.1.20\n##redis\u7684\u670d\u52a1\u7aef\u53e3 \nredis.sentinel.master.port=26379\nredis.sentinel.slave1.host=192.168.1.21\nredis.sentinel.slave1.port=26380\nredis.sentinel.slave2=192.168.1.22\nredis.sentinel.slave2.port=26381\n\n####\u96c6\u7fa4\u6a21\u5f0f\n##redis\u7684\u670d\u52a1\u5668\u5730\u5740\nredis.cluster.host1=192.168.1.20\n##redis\u7684\u670d\u52a1\u7aef\u53e3 \nredis.cluster.port1=6400\nredis.cluster.host2=192.168.1.20\nredis.cluster.port2=6400\nredis.cluster.host3=192.168.1.20\nredis.cluster.port3=6400\n\n\n##redis\u5bc6\u7801\nredis.pass=1234xxxxx\n##redis\u8fde\u63a5\u6570\u636e\u5e93\nredis.default.db=0\n##\u5ba2\u6237\u7aef\u8d85\u65f6\u65f6\u95f4\u5355\u4f4d\u662f\u6beb\u79d2  \nredis.timeout=100000\n##\u6700\u5927\u8fde\u63a5\u6570\nredis.maxActive=300\n##\u6700\u5927\u7a7a\u95f2\u6570\nredis.maxIdle=100\n##\u6700\u5927\u5efa\u7acb\u8fde\u63a5\u7b49\u5f85\u65f6\u95f4  \nredis.maxWait=1000\n##\u6307\u660e\u662f\u5426\u5728\u4ece\u6c60\u4e2d\u53d6\u51fa\u8fde\u63a5\u524d\u8fdb\u884c\u68c0\u9a8c,\u5982\u679c\u68c0\u9a8c\u5931\u8d25,\u5219\u4ece\u6c60\u4e2d\u53bb\u9664\u8fde\u63a5\u5e76\u5c1d\u8bd5\u53d6\u51fa\u53e6\u4e00\u4e2a\nredis.testOnBorrow=true\n</code></pre> <p>\u7531\u4e8eRedis\u4e0d\u652f\u6301\u81ea\u5b9a\u4e49\u6570\u636e\u5e93\u7684\u540d\u5b57\uff0c\u6240\u4ee5\u6bcf\u4e2a\u6570\u636e\u5e93\u90fd\u4ee5\u7f16\u53f7\u547d\u540d\u3002\u5f00\u53d1\u8005\u5219\u9700\u8981\u81ea\u5df1\u8bb0\u5f55\u5b58\u50a8\u7684\u6570\u636e\u4e0e\u6570\u636e\u5e93\u7684\u5bf9\u5e94\u5173\u7cfb\u3002</p> <p>\u53e6\u5916Redis\u4e5f\u4e0d\u652f\u6301\u4e3a\u6bcf\u4e2a\u6570\u636e\u5e93\u8bbe\u7f6e\u4e0d\u540c\u7684\u8bbf\u95ee\u5bc6\u7801\uff0c\u6240\u4ee5\u4e00\u4e2a\u5ba2\u6237\u7aef\u8981\u4e48\u53ef\u4ee5\u8bbf\u95ee\u5168\u90e8\u6570\u636e\u5e93\uff0c\u8981\u4e48\u5168\u90e8\u6570\u636e\u5e93\u90fd\u6ca1\u6709\u6743\u9650\u8bbf\u95ee\u3002</p> <pre><code># \u6e05\u7a7a\u4e00\u4e2aRedis\u5b9e\u4f8b\u4e2d\u6240\u6709\u6570\u636e\u5e93\u4e2d\u7684\u6570\u636e \nredis 127.0.0.1:6379&gt; FLUSHALL \n\n#\u3000\u8be5\u547d\u4ee4\u53ef\u4ee5\u6e05\u7a7a\u5b9e\u4f8b\u4e0b\u7684\u6240\u6709\u6570\u636e\u5e93\u6570\u636e\uff0c\u8fd9\u4e0e\u6211\u4eec\u6240\u719f\u77e5\u7684\u5173\u7cfb\u578b\u6570\u636e\u5e93\u6240\u4e0d\u540c\u3002\u5173\u7cfb\u578b\u6570\u636e\u5e93\u591a\u4e2a\u5e93\u5e38\u7528\u4e8e\u5b58\u50a8\u4e0d\u540c\u5e94\u7528\u7a0b\u5e8f\u7684\u6570\u636e \uff0c\u4e14\u6ca1\u6709\u65b9\u5f0f\u53ef\u4ee5\u540c\u65f6\u6e05\u7a7a\u5b9e\u4f8b\u4e0b\u7684\u6240\u6709\u5e93\u6570\u636e\u3002\n\n# redis\u96c6\u7fa4\u6a21\u5f0f\u4e0b\u53ea\u6709\u4e00\u4e2adb0\u3002\n\n# \u5bf9\u4e8edb\u6b63\u786e\u7684\u7406\u89e3\u5e94\u4e3a\u201c\u547d\u540d\u7a7a\u95f4\u201d\uff0c\u591a\u4e2a\u5e94\u7528\u7a0b\u5e8f\u4e0d\u5e94\u4f7f\u7528\u540c\u4e00\u4e2aRedis\u4e0d\u540c\u5e93\uff0c\u800c\u5e94\u4e00\u4e2a\u5e94\u7528\u7a0b\u5e8f\u5bf9\u5e94\u4e00\u4e2aRedis\u5b9e\u4f8b\uff0c\u4e0d\u540c\u7684\u6570\u636e\u5e93\u53ef\u7528\u4e8e\u5b58\u50a8\u4e0d\u540c\u73af\u5883\u7684\u6570\u636e\u3002\n</code></pre>"},{"location":"redis/01.redis%E7%AE%80%E4%BB%8B/#_4","title":"\u6570\u636e\u7c7b\u578b","text":"<p>redis \u5e76\u4e0d\u662f\u7b80\u5355\u7684\u952e\u503c\u5bf9\u5b58\u50a8\u670d\u52a1\u5668\uff0c\u5b83\u5b9e\u9645\u4e0a\u662f\u4e00\u4e2a  \u6570\u636e\u7ed3\u6784\u670d\u52a1\u5668 \uff0c\u5b83\u652f\u6301\u591a\u79cd\u7c7b\u578b\u7684 value  \u3002</p> <p>\u5728\u4f20\u7edf\u7684\u952e\u503c\u5b58\u50a8\u4e2d\u901a\u5e38\u90fd\u662f\u5728 string \u7c7b\u578b\u7684 key \u4e2d\u5b58\u653e string \u7c7b\u578b\u7684 value \u3002\uff08\u5373 key:value \u90fd\u662f\u5b57\u7b26\u4e32\uff09</p> <p>\u5728 redis \u4e2d\uff0cvalue \u5e76\u4e0d\u4ec5\u9650\u4e3a string \u8fd9\u6837\u7684\u7b80\u5355\u6570\u636e\u7c7b\u578b\uff0cvalue \u53ef\u4ee5\u662f List , Set \uff0cHashes \u8fd9\u6837\u66f4\u52a0\u590d\u6742\u7684\u6570\u636e\u7ed3\u6784\uff1a</p> <ul> <li>Binary-safe strings  </li> <li></li> <li>Lists\uff08\u5217\u8868\uff09\uff1a\u6839\u636e\u63d2\u5165\u987a\u5e8f\u6392\u5e8f\u7684\u591a\u4e2a string \u5143\u7d20\u96c6\u5408\uff0c\u6700\u57fa\u672c\u7684 linked lists\uff08\u94fe\u8868\uff09\u3002</li> <li>Sets\uff08\u96c6\u5408\uff09\uff1a\u65e0\u5e8f\u4e14\u4e0d\u91cd\u590d\u7684 string \u5143\u7d20\u96c6\u5408</li> <li>Sorted sets\uff08\u6709\u5e8f\u96c6\u5408\uff09\uff1a\u6709\u5e8f\u7684 sets \uff0c\u6bcf\u4e2a\u5143\u7d20\u90fd\u6709\u4e00\u4e2a\u6743\u91cd(score)\uff0c\u5143\u7d20\u6309\u7167 score \u6392\u5e8f\u3002</li> <li>**Hashes\uff08\u54c8\u5e0c\uff09\uff1a**\u662f\u4e00\u4e2a\u7531\u952e\u503c\u5bf9\u5173\u8054\u8d77\u6765\u7684<code>map</code>\uff0c\u952e\u548c\u503c\u90fd\u662f\u5b57\u7b26\u4e32\u3002\u5bf9\u4e8e<code>Ruby</code>\u548c<code>Python</code>\u975e\u5e38\u7684\u53cb\u597d\u3002</li> <li>**Bit arrays (\u6bd4\u7279\u6570\u7ec4) \uff1a**\u662f</li> </ul>"},{"location":"redis/01.redis%E7%AE%80%E4%BB%8B/#redis-keys","title":"Redis Keys","text":"<p>Redis \u4e2d\u7684 Keys \u662f\u4e8c\u8fdb\u5236\u5b89\u5168\u7684\uff0c\u8fd9\u5c31\u610f\u5473\u7740\u4f7f\u7528\u4efb\u4f55 \u4e8c\u8fdb\u5236\u5e8f\u5217 \u90fd\u53ef\u4ee5\u505a\u4e3a key , \u65e0\u8bba\u662f\u50cf \"foo\" \u8fd9\u6837\u7684\u5b57\u7b26\u4e32\u8fd8\u662f\u4e00\u4e2a JPEG \u6587\u4ef6\u7684\u5185\u5bb9\uff0c\u90fd\u53ef\u4ee5\u505a\u4e3a key \u3002</p> <p>\u751a\u81f3\u7a7a string \u88ab\u8ba4\u4e3a\u662f\u6709\u6548\u7684 key \u3002</p> <p>\u5173\u4e8e\u4f7f\u7528 key \u7684\u4e00\u4e9b\u5efa\u8bae\uff1a</p> <ul> <li>\u8fc7\u957f\u7684 key \u4e0d\u662f\u5f88\u597d\u7684\u9009\u62e9\uff0c\u4e0d\u4ec5\u4ec5\u662f\u56e0\u4e3a\u5185\u5b58\u6d6a\u8d39\uff0c\u66f4\u662f\u56e0\u4e3a\u5728\u6570\u636e\u96c6\u4e2d\u641c\u7d22\u6bd4\u5bf9key\u7684\u65f6\u5019\u9700\u8981\u8017\u8d39\u66f4\u591a\u7684\u6210\u672c\u3002\u5f53\u8981\u5904\u7406\u7684\u662f\u5339\u914d\u4e00\u4e2a\u975e\u5e38\u5927\u7684\u503c\uff0c\u4ece\u5185\u5b58\u548c\u5e26\u5bbd\u7684\u89d2\u5ea6\u6765\u770b\uff0c\u4f7f\u7528\u8fd9\u4e2a\u503c\u7684<code>hash</code>\u503c\u662f\u66f4\u597d\u7684\u529e\u6cd5\uff08\u6bd4\u5982\u4f7f\u7528<code>SHA1</code>\uff09\u3002</li> <li>\u8fc7\u77ed\u7684key\u901a\u5e38\u4e5f\u662f\u4e0d\u63a8\u8350\u7684\u3002\u5728\u5199\u50cf u100flw \u8fd9\u6837\u7684\u952e\u7684\u65f6\u5019\uff0c\u6709\u4e00\u4e2a\u5c0f\u5c0f\u7684\u8981\u70b9\uff0c\u6211\u4eec\u53ef\u4ee5\u7528<code>user:1000:followers</code>\u4ee3\u66ff\u3002\u53ef\u8bfb\u6027\u66f4\u597d\uff0c\u5bf9\u4e8ekey\u5bf9\u8c61\u548cvalue\u5bf9\u8c61\u589e\u52a0\u7684\u7a7a\u95f4\u5360\u7528\u4e0e\u6b64\u76f8\u6bd4\u6765\u8bf4\u5012\u662f\u6b21\u8981\u7684\u3002\u5f53\u77ed\u7684key\u53ef\u4ee5\u5f88\u660e\u663e\u51cf\u5c11\u7a7a\u95f4\u5360\u7528\u7684\u65f6\u5019\u3002**\u8fd9\u4e2a\u4f8b\u5b50\u5c31\u63cf\u8ff0\u4e86\u4f7f\u7528 redis \u4e00\u4e2a\u573a\u666f\uff1a\u8ba1\u6570\u5668\u3002\u5982\uff1a\u5982\u77e5\u4e4e\u6bcf\u4e2a\u95ee\u9898\u7684\u88ab\u6d4f\u89c8\u6b21\u6570\uff0c\u65b0\u6d6a\u5fae\u535a\u7684\u7528\u6237\u5173\u6ce8\u6570\uff0cuserid \u4e3a1000 \u8fd9\u4e2a\u7528\u6237\u7684\u7c89\u4e1d\u6570\u8fd9\u4e2a key \u5c31\u53ef\u4ee5\u7528 \"user:1000:followers\" \u8fd9\u6837\u7684 key \u540d\u6765\u8868\u793a **\u3002</li> <li>\u4f7f\u7528 schema \u6765\u9650\u5b9a\u57df\uff0c\u4f8b\u5982\u4f7f\u7528  \"object-type:id\" \u8fd9\u79cd\u65b9\u5f0f\u6765\u8868\u793a\uff0c\u5192\u53f7\u548c\u6a2a\u7ebf\u90fd\u53ef\u4ee5\u7528\u6765\u5206\u5272\u57df\uff0c\u4f8b\u5982  \"comment:123:reply.to\" or \"comment:123:reply-to\" \u8fd9\u6837\u7684\u683c\u5f0f\u3002</li> <li>key \u7684\u6700\u5927\u9650\u5236\u662f 512 MB\u3002 </li> <li></li> </ul>"},{"location":"redis/01.redis%E7%AE%80%E4%BB%8B/#string","title":"string\u7c7b\u578b","text":"<p>\u901a\u8fc7 key-value \u4e2d\u8fd9\u6837\u7684\u65b9\u5f0f\u65f6\uff0cstring \u662f value \u4e2d\u6700\u7b80\u5355\u7684\u6570\u636e\u7c7b\u578b\uff0c\u5b83\u4e5f\u662f Memcached \u4e2d\u552f\u4e00\u7684\u6570\u636e\u7c7b\u578b\uff0c\u8fd9\u4e2a\u5f88\u7b80\u5355\u5f88\u5bb9\u6613\u7406\u89e3\uff0c\u503c\u8ddf\u952e\u4e00\u6837\uff0c\u90fd\u662f\u5b57\u7b26\u4e32\u3002</p> <p>string \u6570\u636e\u7c7b\u578b\u5728\u5f88\u591a\u573a\u666f\u90fd\u5f88\u6709\u7528\uff0c\u6bd4\u5982\u7f13\u5b58\u4e00\u4e9b HTML fragments \u6216\u8005 pages\u3002</p> <pre><code>root@hwsrv-512783:~# redis-cli \n127.0.0.1:6379&gt;\n127.0.0.1:6379&gt; ping\nPONG\n127.0.0.1:6379&gt; set mykey somevalue\nOK\n127.0.0.1:6379&gt; get mykey\n\"somevalue\"\n127.0.0.1:6379&gt;\n127.0.0.1:6379&gt;\n# \u4f7f\u7528 set \u5bf9\u5df2\u5b58\u5728\u7684 key \u91cd\u65b0\u8d4b\u503c\uff0c\u5b83\u4f1a\u8986\u76d6\u4ee5\u524d\u7684\u503c\u3002\n127.0.0.1:6379&gt;\n127.0.0.1:6379&gt; set mykey anothervalue\nOK\n127.0.0.1:6379&gt; get mykey\n\"anothervalue\"\n127.0.0.1:6379&gt;\n127.0.0.1:6379&gt;\n# NX - Only set the key if it does not already exist.\n# XX - Only set the key if it already exist.\n# set \u547d\u4ee4\u540e\u52a0\u4e0a NX \u53c2\u6570\uff0c\u5219\u5148\u5224\u65ad key \u662f\u5426\u5b58\u5728\uff0c\u5982\u679c\u4e0d\u5b58\u5728\u5219\u521b\u5efa\uff0c\u5982\u679c\u5df2\u5b58\u5728\uff0c\u5219\u8fd4\u56de nil \n# set key value NX \u7b49\u4ef7\u4e8e SETNX key value \uff08\u5176\u5b9e\u5c31\u662f set if not exits\uff0c\u5982\u679c\u4e0d\u5b58\u5728\u5219set\u7684\u610f\u601d\uff09\n127.0.0.1:6379&gt; set mykey value NX\n(nil)\n127.0.0.1:6379&gt;\n127.0.0.1:6379&gt; get mykey\n\"anothervalue\"\n127.0.0.1:6379&gt;\n127.0.0.1:6379&gt;\n</code></pre>"},{"location":"redis/01.redis%E7%AE%80%E4%BB%8B/#_5","title":"\u4ecb\u7ecd","text":"<ul> <li>\u53ef\u4ee5\u4fdd\u5b58\u54ea\u4e9b\u503c</li> <li>\u5b57\u7b26\u4e32</li> <li>\u6570\u5b57</li> <li>\u4e8c\u8fdb\u5236</li> <li> <p>json\u3001xml \u7b49\u5b57\u7b26\u4e32</p> </li> <li> <p>\u4f7f\u7528\u573a\u666f</p> </li> <li>\u7f13\u5b58</li> <li>\u8ba1\u6570\u5668</li> <li>\u5206\u5e03\u5f0f\u9501</li> <li>...</li> </ul>"},{"location":"redis/01.redis%E7%AE%80%E4%BB%8B/#list","title":"LIST\u7c7b\u578b","text":"<p>redis \u4e2d\u7684 list \u662f\u4e00\u4e2a\u6709\u5e8f\u6570\u7ec4\uff08\u5143\u7d20\u90fd\u662fstring\u7c7b\u578b\uff09\uff0c\u6309\u7167\u63d2\u5165\u987a\u5e8f\u6392\u5e8f\u3002\u53ef\u4ee5\u76f4\u63a5\u63d2\u5165\u4e00\u4e2a\u5143\u7d20\u5230\u5217\u8868\u7684\u5934\u90e8\uff08\u5de6\u8fb9\uff09\u6216\u8005\u5c3e\u90e8\uff08\u53f3\u8fb9\uff09</p> <ul> <li>LPUSH  \u547d\u4ee4\u5728\u5934\u90e8\u63d2\u5165\u4e00\u4e2a\u5143\u7d20</li> <li>RPUSH  \u547d\u4ee4\u5728\u5c3e\u90e8\u63d2\u5165\u4e00\u4e2a\u5143\u7d20</li> </ul> <pre><code># \u58f0\u660e\u4e00\u4e2alist, list\u7684\u5143\u7d20\u6700\u5927\u6570\u91cf\u4e3a 2^32 - 1 \u4e2a (\u53734294967295)\n127.0.0.1:6379&gt; rpush mylist A B C D\n(integer) 4\n127.0.0.1:6379&gt;\n\n\n##  \u63d2\u5165\n\n# \u4ece\u5934\u90e8\u63d2\u5165\u5143\u7d20\nlpush [key] [value1] [value2] [value3] ...\n\n# \u5f80\u5c3e\u90e8\u63d2\u5165\u5143\u7d20\nrpush [key] [value1] [value2] [value3] ...\n\n## \u5220\u9664\nlpop # \u5220\u9664index\u6700\u5c0f\u7684\u5143\u7d20\uff0c\u6216\u8005\u53ef\u4ee5\u7406\u89e3\u4e3a\u5220\u9664\u6808\u5e95\u5143\u7d20\nrpop # \u5220\u9664index\u6700\u5927\u7684\u5143\u7d20\uff0c\u6216\u8005\u53ef\u4ee5\u7406\u89e3\u4e3a\u5220\u9664\u6808\u9876\u5143\u7d20\n\n# \u6309\u4e0b\u6807\u53d6\u5143\u7d20 \nlindex [list] [index]\n\n# \u53d6\u5168\u90e8\u5143\u7d20\uff0c\u7b2c\u4e00\u4e2a\u5230\u6700\u540e\u4e00\u4e2a\u5143\u7d20\uff0c\u6709\u70b9\u50cf\u6570\u7ec4\u5207\u7247\n127.0.0.1:6379&gt; lrange mylist 0 -1\n1) \"A\"\n2) \"B\"\n3) \"C\"\n4) \"D\"\n127.0.0.1:6379&gt;\n\n# \u904d\u5386list\nlrange [key] [startIndex] [endIndex]\n# \u904d\u5386key\u8fd9\u4e2alist,\u4ece\u4e0b\u8868\u4e3astartIndex\u5f00\u59cb,\u904d\u5386\u5230\u4e0b\u6807\u4e3aendIndex\u7684\u5143\u7d20\n# \u5982\u679cendIndex=-1\u5c31\u8868\u793a\u904d\u5386\u5230\u6700\u540e\u4e00\u4f4d\n</code></pre>"},{"location":"redis/01.redis%E7%AE%80%E4%BB%8B/#hash","title":"hash\u7c7b\u578b","text":"<p>Redis hash\u6570\u636e\u7ed3\u6784\u662f\u4e00\u4e2a\u952e\u503c\u5bf9\uff08key-value\uff09\u96c6\u5408\uff0c\u5b83\u662f\u4e00\u4e2a string \u7c7b\u578b\u7684 field \u548c value \u7684\u6620\u5c04\u8868\uff0credis\u672c\u8eab\u5c31\u662f\u4e00\u4e2akey-value\u578b\u6570\u636e\u5e93\uff0c\u56e0\u6b64hash\u6570\u636e\u7ed3\u6784\u76f8\u5f53\u4e8e\u5728value\u4e2d\u53c8\u5957\u4e86\u4e00\u5c42key-value\u578b\u6570\u636e\u3002\u6240\u4ee5redis\u4e2dhash\u6570\u636e\u7ed3\u6784\u7279\u522b\u9002\u5408\u5b58\u50a8\u5173\u7cfb\u578b\u5bf9\u8c61\u3002\u6bd4\u5982\u7528\u6765\u5b58\u50a8\u5b66\u751f\u57fa\u672c\u4fe1\u606f\uff0c\u6216\u8005\u7528\u6237\u4fe1\u606f\u7b49\u3002</p>"},{"location":"redis/01.redis%E7%AE%80%E4%BB%8B/#redis_3","title":"redis \u57fa\u672c\u547d\u4ee4","text":"<pre><code>root@pve /u/l/s/r/src# redis-cli\n127.0.0.1:6379&gt; ping\nPONG\n127.0.0.1:6379&gt;\n# set\u8bed\u6cd5\n# set name value [EX seconds|PX milliseconds] [NX|XX] [KEEPTTL]\n\n# EX seconds : \u5c06\u952e\u7684\u8fc7\u671f\u65f6\u95f4\u8bbe\u7f6e\u4e3aseconds\u79d2: (set mail \"fengzhao@fengzhao.me\"  EX 5) 5\u79d2\u540e\u5931\u6548\n# PX milliseconds \u6beb\u79d2\n\n# NX:\u53ea\u5728\u952e\u4e0d\u5b58\u5728\u65f6\uff0c\u624d\u5bf9\u952e\u8fdb\u884c\u8bbe\u7f6e\u64cd\u4f5c\u3002\n# XX:\u5f53\u952e\u5b58\u5728\u65f6\uff0c\u8fdb\u884c\u66f4\u65b0\u3002\uff08set mail2 fengzhao1124@163.com XX) (\u5982\u679cmail2\u4e4b\u524d\u5b58\u5728\uff0c\u66f4\u65b0\u6210\u529f\u3002\u5426\u5219\u8fd4\u56denil)\n\n# KEEPTTL: \u8fd4\u56de\u952e\u7684\u8fc7\u671f\u65f6\u95f4\n\n# \u6dfb\u52a0\u952e\u503c\u5bf9\uff0c\u6839\u636e\u952e\u540d\u83b7\u53d6\u503c\uff0c\u83b7\u53d6\u952e\u7c7b\u578b\uff0c\u5224\u65ad\u952e\u662f\u5426\u5b58\u5728\n127.0.0.1:6379&gt;\n127.0.0.1:6379&gt; set name fengzhao\nOK\n127.0.0.1:6379&gt; get name\n\"fengzhao\"\n127.0.0.1:6379&gt;type name\nstring\n127.0.0.1:6379&gt;\n\n127.0.0.1:6379&gt; set name fengzhao\nOK\n127.0.0.1:6379&gt; get name\n\"fengzhao\"\n127.0.0.1:6379&gt;type name\nstring\n127.0.0.1:6379&gt;\n127.0.0.1:6379&gt;exit name\nstring\n127.0.0.1:6379&gt;\n</code></pre> <ul> <li>incr </li> </ul> <p>\u8bed\u6cd5\uff1aincr KEY</p> <p>\u529f\u80fd\uff1akey \u81ea\u589e 1 \uff0c\u5982\u679c key \u4e0d\u5b58\u5728\uff0c\u81ea\u589e\u540e key=1</p> <p><pre><code># \u539f\u5b50\u81ea\u589e\n# \u5982\u679c key \u4e0d\u5b58\u5728\uff0c\u90a3\u4e48 key \u7684\u503c\u4f1a\u5148\u88ab\u521d\u59cb\u5316\u4e3a 0 \uff0c\u7136\u540e\u518d\u6267\u884c INCR \u64cd\u4f5c\u3002\n# \u5982\u679c\u503c\u5305\u542b\u9519\u8bef\u7684\u7c7b\u578b\uff0c\u6216\u5b57\u7b26\u4e32\u7c7b\u578b\u7684\u503c\u4e0d\u80fd\u8868\u793a\u4e3a\u6570\u5b57\uff0c\u90a3\u4e48\u8fd4\u56de\u4e00\u4e2a\u9519\u8bef\u3002\n# \u672c\u64cd\u4f5c\u7684\u503c\u9650\u5236\u5728 64 \u4f4d(bit)\u6709\u7b26\u53f7\u6570\u5b57\u8868\u793a\u4e4b\u5185\u3002\n# INCR \u547d\u4ee4\u662f\u4e00\u4e2a\u9488\u5bf9\u5b57\u7b26\u4e32\u7684\u64cd\u4f5c\u3002 \u56e0\u4e3a Redis \u5e76\u6ca1\u6709\u4e13\u7528\u7684\u6574\u6570\u7c7b\u578b\uff0c \u6240\u4ee5\u952e key \u50a8\u5b58\u7684\u503c\u5728\u6267\u884c INCR \u547d\u4ee4\u65f6\u4f1a\u88ab\u89e3\u91ca\u4e3a\u5341\u8fdb\u5236 64 \u4f4d\u6709\u7b26\u53f7\u6574\u6570\u3002\n\nincr \u547d\u4ee4\u5c06 key \u4ece string \u8f6c\u6362\u4e3a value \u7c7b\u578b\uff0c\u6bcf\u6267\u884c\u4e00\u6b21\u5219\u9012\u589e\u52a01\u540e\u7528 set \u8d4b\u503c\u56de\u53bb\uff0c\u8fd8\u6709 incrby,decr,decrby \u7b49\u8fd9\u4e9b\u547d\u4ee4\u90fd\u662f\u4e00\u6837\u7684\u3002\n# \u539f\u5b50\u81ea\u589e\u610f\u5473\u7740\u9012\u589e\u64cd\u4f5c\u90fd\u662f\u4e32\u884c\u5316\u7684\uff0c\u65e0\u6cd5\u540c\u65f6\u6709\u4e24\u4e2a\u5ba2\u6237\u7aef\u5bf9\u4e00\u4e2a key \u8fdb\u884c\u539f\u5b50\u64cd\u4f5c\u3002\u5728\u8fdb\u884c\u9012\u589e\u52a01\u8fd4\u56de\u65b0\u503c\u540e\uff0c\u4e0b\u4e00\u4e2a\u539f\u5b50\u9012\u589e\u624d\u80fd\u5f00\u59cb\u3002\n# \u6240\u4ee5\u539f\u5b50\u81ea\u589e\u662f\u53ef\u4ee5\u7528\u6765\u505a\u51c6\u786e\u8ba1\u6570\u7684\u3002\u5373\u4f7f\u5728\u6d77\u91cf\u5e76\u53d1\u60c5\u51b5\u4e0b\u4e5f\u4e0d\u7528\u62c5\u5fc3\u3002\n</code></pre> <pre><code># \u573a\u666f\u4e00\uff1a\u8ba1\u6570\u5668\n# \u4f7f\u7528\u601d\u8def\u662f\uff1a\u6bcf\u6b21\u6709\u76f8\u5173\u64cd\u4f5c\u7684\u65f6\u5019\uff0c\u5c31\u5411Redis\u670d\u52a1\u5668\u53d1\u9001\u4e00\u4e2aincr\u547d\u4ee4\u3002\n# \u4f8b\u5982\u8fd9\u6837\u4e00\u4e2a\u573a\u666f\uff1a\u6211\u4eec\u6709\u4e00\u4e2aweb\u5e94\u7528\uff0c\u6211\u4eec\u60f3\u8bb0\u5f55\u6bcf\u4e2a\u7528\u6237\u6bcf\u5929\u8bbf\u95ee\u8fd9\u4e2a\u7f51\u7ad9\u7684\u6b21\u6570\u3002\n# web\u5e94\u7528\u53ea\u9700\u8981\u901a\u8fc7\u62fc\u63a5\u7528\u6237id\u548c\u4ee3\u8868\u5f53\u524d\u65f6\u95f4\u7684\u5b57\u7b26\u4e32\u4f5c\u4e3akey\uff0c\u6bcf\u6b21\u7528\u6237\u8bbf\u95ee\u8fd9\u4e2a\u9875\u9762\u7684\u65f6\u5019\u5bf9\u8fd9\u4e2akey\u6267\u884c\u4e00\u4e0bincr\u547d\u4ee4\u3002\n\n# \u8fd9\u4e2a\u573a\u666f\u53ef\u4ee5\u6709\u5f88\u591a\u79cd\u6269\u5c55\u65b9\u6cd5:\n# \u901a\u8fc7\u7ed3\u5408\u4f7f\u7528INCR\u548cEXPIRE\u547d\u4ee4\uff0c\u53ef\u4ee5\u5b9e\u73b0\u4e00\u4e2a\u53ea\u8bb0\u5f55\u7528\u6237\u5728\u6307\u5b9a\u95f4\u9694\u65f6\u95f4\u5185\u7684\u8bbf\u95ee\u6b21\u6570\u7684\u8ba1\u6570\u5668\n# \u5ba2\u6237\u7aef\u53ef\u4ee5\u901a\u8fc7GETSET\u547d\u4ee4\u83b7\u53d6\u5f53\u524d\u8ba1\u6570\u5668\u7684\u503c\u5e76\u4e14\u91cd\u7f6e\u4e3a0\n# \u901a\u8fc7\u7c7b\u4f3c\u4e8eDECR\u6216\u8005INCRBY\u7b49\u539f\u5b50\u9012\u589e/\u9012\u51cf\u7684\u547d\u4ee4\uff0c\u53ef\u4ee5\u6839\u636e\u7528\u6237\u7684\u64cd\u4f5c\u6765\u589e\u52a0\u6216\u8005\u51cf\u5c11\u67d0\u4e9b\u503c \u6bd4\u5982\u5728\u7ebf\u6e38\u620f\uff0c\u9700\u8981\u5bf9\u7528\u6237\u7684\u6e38\u620f\u5206\u6570\u8fdb\u884c\u5b9e\u65f6\u63a7\u5236\uff0c\u5206\u6570\u53ef\u80fd\u589e\u52a0\u4e5f\u53ef\u80fd\u51cf\u5c11\u3002\n\n\n# \u573a\u666f\u4e8c\uff1a\u9650\u901f\u5668\n# \u9650\u901f\u5668\u662f\u4e00\u79cd\u53ef\u4ee5\u9650\u5236\u67d0\u4e9b\u64cd\u4f5c\u6267\u884c\u901f\u7387\u7684\u7279\u6b8a\u573a\u666f\u3002\n# \u4f20\u7edf\u7684\u4f8b\u5b50\u5c31\u662f\u9650\u5236\u67d0\u4e2a\u516c\u5171api\u7684\u8bf7\u6c42\u6570\u76ee\u3002\n# \u5047\u8bbe\u6211\u4eec\u8981\u89e3\u51b3\u5982\u4e0b\u95ee\u9898\uff1a\u9650\u5236\u67d0\u4e2aapi\u6bcf\u79d2\u6bcf\u4e2aip\u7684\u8bf7\u6c42\u6b21\u6570\u4e0d\u8d85\u8fc710\u6b21\u3002\n# \u6211\u4eec\u53ef\u4ee5\u901a\u8fc7incr\u547d\u4ee4\u6765\u5b9e\u73b0\u4e24\u79cd\u65b9\u6cd5\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\u3002\n# \u53c2\u8003https://blog.csdn.net/Roy_70/article/details/78260826\n</code></pre></p> <ul> <li>decr</li> </ul> <p>\u8bed\u6cd5\uff1adecr KEY</p> <p>\u529f\u80fd\uff1akey \u81ea\u51cf 1\uff0c\u5982\u679c key \u4e0d\u5b58\u5728\uff0c\u81ea\u51cf\u540e key=1</p> <ul> <li>incrby</li> </ul> <p>\u8bed\u6cd5\uff1aincrby KEY N</p> <p>\u529f\u80fd\uff1akey \u81ea\u589e n\uff0c\u5982\u679c key \u4e0d\u5b58\u5728\uff0c\u81ea\u589e\u540e key=n</p> <ul> <li>decrby</li> </ul> <p>\u8bed\u6cd5\uff1adecrby KEY N</p> <p>\u529f\u80fd\uff1akey \u81ea\u51cf n\uff0c\u5982\u679c key \u4e0d\u5b58\u5728\uff0c\u81ea\u51cf\u540e key=-n</p> <ul> <li>set</li> </ul> <p>\u8bed\u6cd5\uff1aset KEY VALUE</p> <p>\u529f\u80fd\uff1a\u4e0d\u7ba1  key \u662f\u5426\u5b58\u5728\uff0c\u90fd\u8fdb\u884c\u8bbe\u7f6e</p> <ul> <li>setnx</li> </ul> <p>\u8bed\u6cd5\uff1asetnx KEY VALUE\uff0c\u7b49\u4ef7\u4e8e  set KEY VALUE NX</p> <p>\u529f\u80fd\uff1akey \u4e0d\u5b58\u5728\u65f6\uff0c\u624d\u8fdb\u884c\u8bbe\u7f6e</p> <ul> <li>set xx</li> </ul> <p>\u8bed\u6cd5\uff1aset KEY VALUE xx</p> <p>\u529f\u80fd\uff1akey\u5b58\u5728\u65f6\uff0c\u624d\u8fdb\u884c\u8bbe\u7f6e</p> <ul> <li>setex</li> </ul> <p>\u8bed\u6cd5\uff1asetex KEY SECONDS VALUE</p> <p>\u529f\u80fd\uff1a\u76f8\u5f53\u4e8e\u5982\u4e0b\u4e24\u6761\u547d\u4ee4</p> <pre><code>SET key value\nEXPIRE key seconds\n</code></pre> <p>\u8bbe\u7f6e1\u4e2akey\u540c\u65f6\u8bbe\u7f6e\u8fc7\u671f\u65f6\u95f4</p> <ul> <li>mset</li> </ul> <p>\u8bed\u6cd5\uff1amset KEY VALUE [KEY VALUE ...]</p> <p>\u529f\u80fd\uff1a\u521b\u5efa\u591a\u4e2a\u952e\u503c\u5bf9</p> <pre><code># \u4f7f\u7528 mset \u548c mget \u6765\u8bbe\u7f6e\u6216\u53d6\u51fa\u591a\u4e2a key \u7684 value \u662f\u4e00\u4e2a\u964d\u4f4e\u5ef6\u8fdf\u7684\u597d\u529e\u6cd5\n127.0.0.1:6379&gt; mset key1 value1 key2 value2\nOK\n# \u4f7f\u7528 keys * \u547d\u4ee4\u6765\u83b7\u53d6\u6240\u6709\u7684 key\uff0c\u7ebf\u4e0a\u73af\u5883\u8fd9\u4e2a\u662f\u9ad8\u5371\u64cd\u4f5c\uff0c\u4e00\u5b9a\u8981\u907f\u514d\u8fd9\u4e2a\u64cd\u4f5c\n127.0.0.1:6379&gt; keys *\n1) \"key2\"\n2) \"key1\"\n</code></pre> <ul> <li>mget</li> </ul> <p>\u8bed\u6cd5\uff1amget KEY [KEY ...]</p> <p>\u529f\u80fd\uff1a\u83b7\u53d6\u591a\u4e2akey\uff0c multiple keys get </p> <pre><code># \u4f7f\u7528 mget \u6765\u4e00\u6b21\u83b7\u53d6\u591a\u4e2a key \u7684 value,(value\u7ec4\u6210\u7684\u6570\u7ec4) \u5f53 key3 \u4e0d\u5b58\u5728\u65f6\u5219\u8fd4\u56de nil\n127.0.0.1:6379&gt; mget key1 key2 key3\n1) \"value1\"\n2) \"value2\"\n3) (nil)\n127.0.0.1:6379&gt;\n</code></pre> <ul> <li>getset</li> </ul> <p>\u8bed\u6cd5\uff1agetset KEY VALUE</p> <p>\u5c06\u65b0\u503c\u8bbe\u7f6e\u5230key\uff0c\u5e76\u8fd4\u56de\u65e7\u503c</p> <pre><code># \u4f7f\u7528\u5b9e\u4f8b\uff1a\u4f7f\u7528\u4e00\u4e2a\u81ea\u589e\u52a01\u7684key\u6765\u8bb0\u5f55\u7f51\u7ad9\u7684\u8bbf\u5ba2\u4eba\u6570\uff0c\u5e0c\u671b\u6bcf\u5c0f\u65f6\u6536\u96c6\u4e00\u6b21\u8bbf\u5ba2\u4eba\u6570\uff0c\u90a3\u5c31\u53ef\u4ee5\u4f7f\u7528 getset \u547d\u4ee4\u6536\u96c6\u65e7\u503c\uff0c\u5e76\u8fdb\u884c\u6e05\u96f6\u64cd\u4f5c\u3002\n</code></pre> <ul> <li>append</li> </ul> <p>\u8bed\u6cd5\uff1aappend KEY VALUE</p> <p>\u529f\u80fd\uff1a\u5c06\u503c\u8ffd\u52a0\u5230\u539f\u6709\u5b57\u7b26\u4e32\u4e4b\u540e</p> <pre><code>127.0.0.1:6380&gt; get key1\n\"haha\"\n127.0.0.1:6380&gt; append key1 haah\n(integer) 8\n127.0.0.1:6380&gt; get key1\n\"hahahaah\"\n</code></pre> <ul> <li>strlen</li> </ul> <p>\u8bed\u6cd5\uff1astrlen KEY</p> <p>\u529f\u80fd\uff1a\u8fd4\u56de\u5b57\u7b26\u4e32\u957f\u5ea6</p> <p>\u6ce8\u610f\uff1a\u4e2d\u6587\u5360\u75282\u4e2a\u5b57\u8282</p> <ul> <li>incrbyfloat</li> </ul> <p>\u8bed\u6cd5\uff1aincrbyfloat KEY N</p> <p>\u529f\u80fd\uff1a\u6d6e\u70b9\u6570key\u81ea\u589en</p> <pre><code>127.0.0.1:6380&gt; incrbyfloat key5 3.5\n\"3.5\"\n127.0.0.1:6380&gt; get key5\n\"3.5\"\n</code></pre> <ul> <li>getrange</li> </ul> <p>\u8bed\u6cd5\uff1agetrange KEY START END</p> <p>\u529f\u80fd\uff1a\u83b7\u53d6\u6307\u5b9a\u4e0b\u6807\u7684\u503c</p> <p>\u7b2c1\u4e2a\u5b57\u6bcd\u7684\u4e0b\u6807\u4e3a0</p> <pre><code>127.0.0.1:6380&gt; get key2\n\"value2\"\n127.0.0.1:6380&gt; getrange key2 2 3\n\"lu\"\n</code></pre> <ul> <li>setrange</li> </ul> <p>\u8bed\u6cd5\uff1asetrange KEY INDEX VALUE</p> <p>\u529f\u80fd\uff1a\u5c06key\u5bf9\u5e94\u7684\u503c\u7684\u67d0\u4e2a\u4e0b\u6807\u7684\u503c\u66ff\u6362\u4e3a\u65b0\u503c</p> <pre><code>127.0.0.1:6380&gt; get key2\n\"value2\"\n127.0.0.1:6380&gt; setrange key2 2 L\n(integer) 6\n127.0.0.1:6380&gt; get key2\n\"vaLue2\"\n</code></pre>"},{"location":"redis/01.redis%E7%AE%80%E4%BB%8B/#key","title":"\u64cd\u4f5c\u548c\u67e5\u8be2 key","text":"<p>\u6709\u4e9b\u547d\u4ee4\u4e0d\u662f\u9488\u5bf9\u67d0\u4e2a\u7279\u5b9a\u7684\u6570\u636e\u7c7b\u578b\u7684\uff0c\u4f46\u662f\u548c<code>key</code>\u7a7a\u95f4\u4ea4\u4e92\u7684\u65f6\u5019\u662f\u975e\u5e38\u6709\u7528\u7684\uff0c\u6240\u4ee5\uff0c\u53ef\u4ee5\u4f7f\u7528\u5728\u4efb\u610f\u7c7b\u578b\u7684<code>key</code>\u4e4b\u4e0a\u3002</p> <p>\u6bd4\u5982\uff1a</p> <p><code>EXISTS</code>\u547d\u4ee4\u8fd4\u56de<code>1</code>\u6216\u8005<code>0</code>\u53bb\u6807\u8bb0\u4e00\u4e2a<code>key</code>\u662f\u5426\u5b58\u5728\u3002</p> <p><code>DEL</code>\u547d\u4ee4\u7528\u6765\u5220\u9664\u4e00\u4e2a key \u548c\u4ed6\u6240\u5173\u8054\u7684 value \u503c\u3002</p> <p><code>TYPE</code>\u547d\u4ee4\u8fd4\u56de\u4e00\u4e2a\u8fd9\u4e2a value \u7684\u6570\u636e\u7c7b\u578b\u3002</p> <pre><code>127.0.0.1:6379&gt; set mykey hello\nOK\n127.0.0.1:6379&gt; type mykey\nstring\n127.0.0.1:6379&gt;\n127.0.0.1:6379&gt; exists mykey\n(integer) 1\n# \u53ef\u4ee5\u901a\u8fc7 del \u547d\u4ee4\u7684\u8fd4\u56de\u503c\u662f0\u8fd8\u662f1\u6765\u5224\u65ad\u5220\u9664\u662f\u5426\u6210\u529f\n127.0.0.1:6379&gt; del mykey\n(integer) 1\n# \u4f7f\u7528 del \u5220\u9664\u4e0d\u5b58\u5728\u7684 key \u65f6\uff0c\u8fd4\u56de0\u8868\u793a\u5220\u9664\u5931\u8d25\n127.0.0.1:6379&gt; del key6\n(integer) 0\n127.0.0.1:6379&gt;\n127.0.0.1:6379&gt;\n127.0.0.1:6379&gt; exists mykey\n(integer) 0\n</code></pre>"},{"location":"redis/01.redis%E7%AE%80%E4%BB%8B/#redis-key","title":"Redis \u8fc7\u671f\uff1akey \u7684\u751f\u547d\u5468\u671f","text":"<p>\u5728\u63a5\u53d7\u66f4\u590d\u6742\u7684\u6570\u636e\u7ed3\u6784\u4e4b\u524d\uff0c\u9700\u8981\u5148\u8ba8\u8bba\u53e6\u5916\u4e00\u4e2a\u6570\u636e\u7c7b\u578b\u65e0\u5173\u7684\u7279\u6027\uff0c\u90a3\u5c31\u662f Redis expires\u3002</p> <p>Redis \u7684\u6570\u636e\u662f\u5b58\u50a8\u4e8e\u5185\u5b58\u4e4b\u4e2d\uff0c\u6240\u4ee5\u5bf9\u5185\u5b58\u7684\u6e05\u7406\u662f\u975e\u5e38\u91cd\u8981\u7684\uff0c\u901a\u5e38\u53ef\u4ee5\u7ed9 key \u8bbe\u7f6e\u4e00\u4e2a  timeout \u65f6\u95f4\uff0c\u8fd9\u5c31\u9650\u5b9a\u4e86\u8fd9\u4e2a key \u7684\u751f\u5b58\u65f6\u95f4\u3002</p> <p>\u5f53\u65f6\u95f4\u5230\u4e86\uff0ckey \u76f4\u63a5\u88ab\u9500\u6bc1\uff0c\u5c31\u597d\u50cf\u7528\u6237\u4e3b\u52a8\u8c03 del \u547d\u4ee4\u5220\u9664\u5b83\u4e00\u6837\u3002</p> <ul> <li>\u53ef\u4ee5\u4f7f\u7528\u6beb\u79d2\uff08millisecond\uff09\u548c\u79d2\uff08seconds\uff09\u505a\u4e3a key \u7684\u751f\u547d\u5468\u671f</li> <li>\u6700\u77ed\u7684\u751f\u547d\u5468\u671f\u662f1\u6beb\u79d2\uff08millisecond\uff09</li> <li>\u8fc7\u671f\u4fe1\u606f\u7684\u8bbe\u7f6e\u662f\u4fdd\u5b58\u5728\u78c1\u76d8\u4e2d\u6301\u4e45\u5b58\u5728\u7684**\uff0c\u8fd9\u610f\u5473\u7740\uff08\u5f53 redis \u670d\u52a1\u505c\u6b62\u7684\u65f6\u5019\uff0c\u65f6\u95f4\u4e5f\u662f\u5728\u8d70\u7684\uff0c\u5728redis\u6301\u4e45\u5316\u4e2d\u53ef\u4ee5\u8fdb\u4e00\u6b65\u8be6\u7ec6\u8bb2\u8bb2\uff09</li> <li></li> </ul> <pre><code>127.0.0.1:6379&gt; set key some-value EX 15\nOK\n\n127.0.0.1:6379127.0.0.1:6379&gt; expire key 5  # \u5237\u65b0key\u7684\u8fc7\u671f\u65f6\u95f4\uff0c\u6709\u5f88\u591a\u5e94\u7528\u6709\u8fd9\u79cd\u4e1a\u52a1\u573a\u666f\uff0c\u4f8b\u5982\u8bb0\u5f55\u4f1a\u8bdd\u7684session\u3002\n(integer) 1\n127.0.0.1:6379&gt; get key   # \u7acb\u5373\u53d6\u503c\uff0ckey\u8fd8\u5b58\u5728\n\"some-value\"\n127.0.0.1:6379&gt; get key    # 5\u79d2\u4ee5\u540e\u6267\u884cget\uff0ckey\u5df2\u88ab\u5220\u9664\n(nil)\n127.0.0.1:6379&gt; expire key time   # \u66f4\u65b0\u8fc7\u671f\u65f6\u95f4\uff0c\u4e5f\u662f\u8fd9\u4e2a\u547d\u4ee4\n\n127.0.0.1:6379&gt; TTL key  # \u67e5\u770bkey\u7684\u5269\u4f59\u751f\u5b58\u65f6\u95f4 -1 \u8868\u793a\u6c38\u4e0d\u8fc7\u671f\n\n127.0.0.1:6379&gt; PERSIST key # \u5c06key\u8bbe\u7f6e\u4e3a\u6c38\u4e45key\n\n127.0.0.1:6379&gt; PERSIST key # \u5c06key\u8bbe\u7f6e\u4e3a\u6c38\u4e45key\n</code></pre>"},{"location":"redis/01.redis%E7%AE%80%E4%BB%8B/#redis_4","title":"redis \u8fc7\u671f\u7b56\u7565\u7684\u5185\u90e8\u5b9e\u73b0","text":"<p>\u6240\u8c13\u7f13\u5b58\uff0c\u5373\u5728\u7b2c\u4e00\u6b21\u83b7\u53d6\u5230\u6570\u636e\u7684\u65f6\u5019\uff0c\u628a\u5b83\u6682\u5b58\u5728\u5185\u5b58\u4e2d\u3002</p> <p>\u8fd9\u6837\u4e0b\u6b21\u9700\u8981\u8fd9\u4e2a\u6570\u636e\u7684\u65f6\u5019\uff0c\u5c31\u76f4\u63a5\u4ece\u5185\u5b58\u4e2d\u53d6\uff0c\u4e0d\u7528\u518d\u53bb\u67e5\u8be2\u6570\u636e\u5e93\u6216\u8c03\u7528\u8fdc\u7a0b\u63a5\u53e3\uff0c\u8fd9\u6837\u53ef\u4ee5\u6781\u5927\u5730\u63d0\u9ad8\u5e94\u7528\u7a0b\u5e8f\u7684\u6027\u80fd\u3002</p> <p>\u5982\u679c\u7f13\u5b58\u4e2d\u7684\u6570\u636e\u6c38\u4e45\u5b58\u5728\uff0c\u90a3\u5360\u7528\u7684\u5185\u5b58\u5c31\u4f1a\u53d8\u5f97\u8d8a\u6765\u8d8a\u5927\u3002\u800c\u5185\u5b58\u662f\u6709\u9650\u7684\uff0c\u6240\u4ee5\u7f13\u5b58\u7cfb\u7edf\u5728\u5fc5\u8981\u7684\u65f6\u5019\u4f1a\u5220\u9664\u4e00\u4e9b\u4e0d\u5fc5\u8981\u7684\u7f13\u5b58\u6570\u636e\u4ee5\u8282\u7ea6\u5185\u5b58\u7a7a\u95f4\u3002</p> <p>\u5728Redis\u5185\u90e8\uff0c\u6bcf\u5f53\u6211\u4eec\u8bbe\u7f6e\u4e00\u4e2a\u952e\u7684\u8fc7\u671f\u65f6\u95f4\u65f6\uff0cRedis\u5c31\u4f1a\u5c06\u8be5\u952e\u5e26\u4e0a\u8fc7\u671f\u65f6\u95f4\u5b58\u653e\u5230\u4e00\u4e2a**\u8fc7\u671f\u5b57\u5178**\u4e2d\u3002</p> <p>\u5f53\u6211\u4eec\u67e5\u8be2\u4e00\u4e2a\u952e\u65f6\uff0cRedis \u4fbf\u9996\u5148\u68c0\u67e5\u8be5\u952e\u662f\u5426\u5b58\u5728\u8fc7\u671f\u5b57\u5178\u4e2d\uff0c\u5982\u679c\u5b58\u5728\uff0c\u90a3\u5c31\u83b7\u53d6\u5176\u8fc7\u671f\u65f6\u95f4\u3002</p> <p>\u7136\u540e\u5c06\u8fc7\u671f\u65f6\u95f4\u548c\u5f53\u524d\u7cfb\u7edf\u65f6\u95f4\u8fdb\u884c\u6bd4\u5bf9\uff0c\u6bd4\u7cfb\u7edf\u65f6\u95f4\u5927\uff0c\u90a3\u5c31\u6ca1\u6709\u8fc7\u671f\uff1b\u53cd\u4e4b\u5224\u5b9a\u8be5\u952e\u8fc7\u671f\u3002</p> <p>\u6211\u4eec\u6765\u770b\u4e00\u4e0b redis \u5185\u90e8\u5b9e\u73b0\u6570\u636e\u8fc7\u671f\u7684\u673a\u5236\uff1a</p> <p>\u5148\u8bf4\u7ed3\u8bba\uff1aredis \u5185\u90e8\u7684\u5b9e\u73b0\uff0c\u4f7f\u7528 \u5b9a\u671f\u5220\u9664+\u60f0\u6027\u5220\u9664 \u4e24\u8005\u914d\u5408\u7684\u8fc7\u671f\u7b56\u7565\u3002</p> <ul> <li> <p>\u5b9a\u65f6\u5220\u9664\uff08\u5b9a\u65f6\u5668\uff09</p> </li> <li> <p>\u542b\u4e49\uff1a\u5728\u8bbe\u7f6e key \u7684\u8fc7\u671f\u65f6\u95f4\u7684\u540c\u65f6\uff0c\u4e3a\u8be5 key \u521b\u5efa\u4e00\u4e2a\u5b9a\u65f6\u5668\uff0c\u8ba9\u5b9a\u65f6\u5668\u5728 key \u7684\u8fc7\u671f\u65f6\u95f4\u6765\u4e34\u65f6\uff0c\u7acb\u5373\u5bf9 key \u8fdb\u884c\u5220\u9664\u3002</p> </li> <li> <p>\u4f18\u70b9\uff1a\u4fdd\u8bc1\u5185\u5b58\u88ab\u5c3d\u5feb\u91ca\u653e\u3002</p> </li> <li> <p>\u7f3a\u70b9\uff1a</p> <ul> <li> <p>\u82e5\u8fc7\u671f key \u5f88\u591a\uff0c\u5220\u9664\u8fd9\u4e9bkey\u4f1a\u5360\u7528\u5f88\u591a\u7684 CPU \u65f6\u95f4\uff0c\u5728 CPU \u65f6\u95f4\u7d27\u5f20\u7684\u60c5\u51b5\u4e0b\uff0cCPU \u4e0d\u80fd\u628a\u6240\u6709\u7684\u65f6\u95f4\u7528\u6765\u505a\u8981\u7d27\u7684\u4e8b\u513f\uff0c\u8fd8\u9700\u8981\u53bb\u82b1\u65f6\u95f4\u5220\u9664\u8fd9\u4e9b key\u3002CPU\u65f6\u95f4\u5f00\u9500\uff08CPU\u8981\u53bb\u5bfb\u5740\uff0c\u8981\u53bb\u5bfb\u627e\u5185\u5b58\u5730\u5740\uff09</p> </li> <li> <p>\u5b9a\u65f6\u5668\u7684\u521b\u5efa\u8017\u65f6\uff0c\u82e5\u4e3a\u6bcf\u4e00\u4e2a\u8bbe\u7f6e\u8fc7\u671f\u65f6\u95f4\u7684key\u521b\u5efa\u4e00\u4e2a\u5b9a\u65f6\u5668\uff08\u5c06\u4f1a\u6709\u5927\u91cf\u7684\u5b9a\u65f6\u5668\u4ea7\u751f\uff09\uff0c\u6027\u80fd\u5f71\u54cd\u4e25\u91cd\u3002</p> </li> </ul> </li> <li> <p>\u4ece\u7528\u6237\u89d2\u5ea6\u770b\uff0c\u770b\u8d77\u6765 redis \u5e94\u8be5\u5c31\u662f\u8fd9\u6837\u5b9e\u73b0\u7684\u3002\u4e3a\u6bcf\u4e2a key \u8bbe\u7f6e\u5b9a\u65f6\u5668\uff0c\u5230\u65f6\u8fdb\u884c\u5220\u9664\u6dd8\u6c70\u3002</p> <ul> <li>\u4f46\u662f\u5b9e\u9645\u4e0a\uff0c\u56e0\u4e3a\u8fd9\u6837\u4f1a\u4e25\u91cd\u5f71\u54cd redis \u6027\u80fd\uff0c\u6240\u4ee5redis \u5185\u90e8\u4e5f\u4e0d\u4f1a\u8fd9\u6837\u5b9e\u73b0\u3002</li> </ul> </li> <li> <p>\u5b9a\u671f\u5220\u9664</p> </li> <li> <p>redis \u5185\u90e8\u9ed8\u8ba4\u6bcf\u9694100ms\u5c31 \u968f\u673a\u62bd\u53d6 \u4e00\u4e9b\u8bbe\u7f6e\u4e86\u8fc7\u671f\u65f6\u95f4\u7684key\uff0c\u68c0\u6d4b\u8fd9\u4e9b key \u662f\u5426\u8fc7\u671f\uff0c\u5982\u679c\u8fc7\u671f\u4e86\u5c31\u5c06\u5176\u5220\u6389\u3002</p> <p>\u56e0\u4e3akey\u592a\u591a\uff0c\u5982\u679c\u5168\u76d8\u626b\u63cf\u6240\u6709\u7684key\u4f1a\u975e\u5e38\u8017\u6027\u80fd\uff0c\u6240\u4ee5\u662f\u968f\u673a\u62bd\u53d6\u4e00\u4e9bkey\u6765\u5220\u9664\u3002\u8fd9\u6837\u5c31\u6709\u53ef\u80fd\u5220\u9664\u4e0d\u5b8c\uff0c\u9700\u8981\u60f0\u6027\u5220\u9664\u914d\u5408\u3002</p> </li> <li> <p>\u4f18\u70b9\uff1a</p> <ul> <li>\u901a\u8fc7\u9650\u5236\u5220\u9664\u64cd\u4f5c\u7684\u65f6\u957f\u548c\u9891\u7387\uff0c\u6765\u51cf\u5c11\u5220\u9664\u64cd\u4f5c\u5bf9CPU\u65f6\u95f4\u7684\u5360\u7528\u2013\u5904\u7406\u201d\u5b9a\u65f6\u5220\u9664\u201d\u7684\u7f3a\u70b9\u3002</li> </ul> </li> <li> <p>\u7f3a\u70b9</p> <ul> <li>\u5728\u5185\u5b58\u53cb\u597d\u65b9\u9762\uff0c\u4e0d\u5982\u201d\u5b9a\u65f6\u5220\u9664\u201d\uff08\u4f1a\u9020\u6210\u4e00\u5b9a\u7684\u5185\u5b58\u5360\u7528\uff0c\u4f46\u662f\u6ca1\u6709\u60f0\u6027\u5220\u9664\u90a3\u4e48\u5360\u7528\u5185\u5b58\uff09</li> <li>\u5728CPU\u65f6\u95f4\u53cb\u597d\u65b9\u9762\uff0c\u4e0d\u5982\u201d\u60f0\u6027\u5220\u9664\u201d\uff08\u4f1a\u5b9a\u671f\u7684\u53bb\u8fdb\u884c\u6bd4\u8f83\u548c\u5220\u9664\u64cd\u4f5c\uff0ccpu\u65b9\u9762\u4e0d\u5982\u61d2\u6c49\u5f0f\uff0c\u4f46\u662f\u6bd4\u5b9a\u65f6\u597d\uff09</li> </ul> </li> <li> <p>\u96be\u70b9</p> <ul> <li>\u5408\u7406\u8bbe\u7f6e\u5220\u9664\u64cd\u4f5c\u7684\u6267\u884c\u65f6\u957f\uff08\u6bcf\u6b21\u5220\u9664\u6267\u884c\u591a\u957f\u65f6\u95f4\uff09\u548c\u6267\u884c\u9891\u7387\uff08\u6bcf\u9694\u591a\u957f\u65f6\u95f4\u505a\u4e00\u6b21\u5220\u9664\uff09\uff08\u8fd9\u4e2a\u8981\u6839\u636e\u670d\u52a1\u5668\u8fd0\u884c\u60c5\u51b5\u6765\u5b9a\u4e86\uff09\uff0c\u6bcf\u6b21\u6267\u884c\u65f6\u95f4\u592a\u957f\uff0c\u6216\u8005\u6267\u884c\u9891\u7387\u592a\u9ad8\u5bf9cpu\u90fd\u662f\u4e00\u79cd\u538b\u529b\u3002</li> </ul> <p>\u6bcf\u6b21\u8fdb\u884c\u5b9a\u671f\u5220\u9664\u64cd\u4f5c\u6267\u884c\u4e4b\u540e\uff0c\u9700\u8981\u8bb0\u5f55\u904d\u5386\u5faa\u73af\u5230\u4e86\u54ea\u4e2a\u6807\u5fd7\u4f4d\uff0c\u4ee5\u4fbf\u4e0b\u4e00\u6b21\u5b9a\u671f\u65f6\u95f4\u6765\u65f6\uff0c\u4ece\u4e0a\u6b21\u4f4d\u7f6e\u5f00\u59cb\u8fdb\u884c\u5faa\u73af\u904d\u5386  </p> </li> <li> <p>\u60f0\u6027\u5220\u9664</p> </li> <li> <p>\u60f0\u6027\u5220\u9664\u4e0d\u518d\u662fRedis\u53bb\u4e3b\u52a8\u5220\u9664\uff0c\u800c\u662f\u5728\u5ba2\u6237\u7aef\u8981\u83b7\u53d6\u67d0\u4e2akey\u7684\u65f6\u5019\uff0cRedis\u518d\u53bb\u53bb\u68c0\u6d4b\u4e00\u4e0b\u8fd9\u4e2akey\u662f\u5426\u5df2\u7ecf\u8fc7\u671f\uff0c\u5982\u679c\u6ca1\u6709\u8fc7\u671f\u5219\u8fd4\u56de\u7ed9\u5ba2\u6237\u7aef\uff0c\u5982\u679c\u5df2\u7ecf\u8fc7\u671f\u4e86\uff0c\u90a3\u4e48Redis\u4f1a\u5220\u9664\u8fd9\u4e2akey\uff0c\u4e0d\u4f1a\u8fd4\u56de\u7ed9\u5ba2\u6237\u7aef\u3002</p> </li> <li> <p>\u4f18\u70b9\uff1a</p> <ul> <li>\u5220\u9664\u64cd\u4f5c\u53ea\u53d1\u751f\u5728\u901a\u8fc7key\u53d6\u503c\u7684\u65f6\u5019\u53d1\u751f\uff0c\u800c\u4e14\u53ea\u5220\u9664\u5f53\u524dkey\uff0c\u6240\u4ee5\u5bf9CPU\u65f6\u95f4\u7684\u5360\u7528\u662f\u6bd4\u8f83\u5c11\u7684\uff0c\u800c\u4e14\u6b64\u65f6\u7684\u5220\u9664\u662f\u5df2\u7ecf\u5230\u4e86\u975e\u505a\u4e0d\u53ef\u7684\u5730\u6b65\uff08\u5982\u679c\u6b64\u65f6\u8fd8\u4e0d\u5220\u9664\u7684\u8bdd\uff0c\u6211\u4eec\u5c31\u4f1a\u83b7\u53d6\u5230\u4e86\u5df2\u7ecf\u8fc7\u671f\u7684key\u4e86\uff09</li> <li>**\u7f3a\u70b9\uff1a**\u82e5\u5927\u91cf\u7684key\u5728\u8d85\u51fa\u8d85\u65f6\u65f6\u95f4\u540e\uff0c\u5f88\u4e45\u4e00\u6bb5\u65f6\u95f4\u5185\uff0c\u90fd\u6ca1\u6709\u88ab\u83b7\u53d6\u8fc7\uff0c\u90a3\u4e48\u53ef\u80fd\u53d1\u751f\u5185\u5b58\u6cc4\u9732\uff08\u65e0\u7528\u7684\u5783\u573e\u5360\u7528\u4e86\u5927\u91cf\u7684\u5185\u5b58\uff09</li> </ul> </li> <li> <p>\u6240\u4ee5\u60f0\u6027\u5220\u9664\u53ef\u4ee5\u89e3\u51b3\u4e00\u4e9b\u8fc7\u671f\u4e86\uff0c\u4f46\u6ca1\u88ab\u5b9a\u671f\u5220\u9664\u968f\u673a\u62bd\u53d6\u5230\u7684key\u3002\u4f46\u6709\u4e9b\u8fc7\u671f\u7684key\u65e2\u6ca1\u6709\u88ab\u968f\u673a\u62bd\u53d6\uff0c\u4e5f\u6ca1\u6709\u88ab\u5ba2\u6237\u7aef\u8bbf\u95ee\uff0c\u5c31\u4f1a\u4e00\u76f4\u4fdd\u7559\u5728\u6570\u636e\u5e93\uff0c\u5360\u7528\u5185\u5b58\uff0c\u957f\u671f\u4e0b\u53bb\u53ef\u80fd\u4f1a\u5bfc\u81f4\u5185\u5b58\u8017\u5c3d\u3002\u6240\u4ee5Redis\u63d0\u4f9b\u4e86\u5185\u5b58\u6dd8\u6c70\u673a\u5236\u6765\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\u3002</p> </li> <li></li> </ul>"},{"location":"redis/01.redis%E7%AE%80%E4%BB%8B/#redis_5","title":"redis\u5185\u5b58\u6dd8\u6c70\u673a\u5236","text":"<p>\u5728\u914d\u7f6e\u6587\u4ef6 redis.conf \u4e2d\uff0c\u53ef\u4ee5\u901a\u8fc7\u53c2\u6570 <code>maxmemory  &lt;bytes&gt;</code>  \u6765\u8bbe\u5b9a\u6700\u5927\u5185\u5b58\u3002</p> <p>\u5f53\u73b0\u6709\u5185\u5b58\u5927\u4e8e maxmemory \u65f6\uff0c\u4fbf\u4f1a\u89e6\u53d1 redis \u4e3b\u52a8\u6dd8\u6c70\u5185\u5b58\u65b9\u5f0f\uff0c\u901a\u8fc7\u8bbe\u7f6e maxmemory-policy</p> <ul> <li> <p>\u5982\u679c\u5927\u91cf\u7684key\u6ca1\u6709\u88ab\u626b\u63cf\u5230\uff0c\u4e14\u5df2\u8fc7\u671f\uff0c\u4e5f\u6ca1\u6709\u88ab\u518d\u6b21\u8bbf\u95ee\uff0c\u5373\u6ca1\u6709\u8d70\u60f0\u6027\u5220\u9664\uff0c\u8fd9\u4e9b\u5927\u91cf\u8fc7\u671f key \u5806\u79ef\u5728\u5185\u5b58\u91cc\uff0c\u4e5f\u6709\u53ef\u80fd\u5bfc\u81f4 redis \u5185\u5b58\u5757\u8017\u5c3d\u4e86\u3002</p> </li> <li> <p>\u8fd9\u5c31\u5f15\u5165\u4e86\u5185\u5b58\u6dd8\u6c70\u673a\u5236\uff0credis \u5185\u90e8\u63d0\u4f9b\u4e86**\u5185\u5b58\u6dd8\u6c70\u673a\u5236**\u3002\u6709\u5f88\u591a\u79cd\u7b97\u6cd5\u53ef\u4ee5\u5b9e\u73b0\uff0c\u6bd4\u8f83\u5178\u578b\u7684\u7b97\u6cd5\u5c31\u662f LRU \u7b97\u6cd5\uff0c\u8fd9\u8ddf MySQL \u5185\u5b58\u7f13\u51b2\u6c60\u4e2d\u7684 LRU \u7b97\u6cd5\u662f\u4e00\u4e2a\u9053\u7406\u3002</p> </li> </ul> <p>LRU\u662fLeast Recently Used\u7684\u7f29\u5199\uff0c\u5373\u6700\u8fd1\u6700\u5c11\u4f7f\u7528\u3002LRU\u6e90\u4e8e\u64cd\u4f5c\u7cfb\u7edf\u7684\u4e00\u79cd\u9875\u9762\u7f6e\u6362\u7b97\u6cd5\uff0c\u9009\u62e9\u6700\u8fd1\u6700\u4e45\u672a\u4f7f\u7528\u7684\u9875\u9762\u4e88\u4ee5\u6dd8\u6c70\u3002</p> <p>\u5728Redis\u91cc\uff0c\u5c31\u662f\u9009\u62e9\u6700\u8fd1\u6700\u4e45\u672a\u4f7f\u7528\u7684key\u8fdb\u884c\u5220\u9664\u3002\u5f88\u591a\u9762\u8bd5\u9762\u7ecf\uff0c\u90fd\u8bf4\u9047\u5230\u8fc7\u624b\u64b8 LRU \u7b97\u6cd5</p> <ul> <li>redis\u5728\u4f7f\u7528\u5185\u5b58\u8fbe\u5230\u67d0\u4e2a\u9608\u503c\uff08\u901a\u8fc7maxmemory\u914d\u7f6e)\u7684\u65f6\u5019\uff0c\u5c31\u4f1a\u89e6\u53d1\u5185\u5b58\u6dd8\u6c70\u673a\u5236\uff0c\u9009\u53d6\u4e00\u4e9bkey\u6765\u5220\u9664\u3002</li> </ul> <pre><code># maxmemory &lt;bytes&gt; \u914d\u7f6e\u5185\u5b58\u9608\u503c\n# maxmemory-policy noeviction   \u5185\u5b58\u6dd8\u6c70\u7b56\u7565\n\nnoeviction\uff1a\u5f53\u5185\u5b58\u4e0d\u8db3\u4ee5\u5bb9\u7eb3\u65b0\u5199\u5165\u6570\u636e\u65f6\uff0c\u65b0\u5199\u5165\u64cd\u4f5c\u4f1a\u62a5\u9519\u3002\u9ed8\u8ba4\u7b56\u7565\nallkeys-lru\uff1a\u5f53\u5185\u5b58\u4e0d\u8db3\u4ee5\u5bb9\u7eb3\u65b0\u5199\u5165\u6570\u636e\u65f6\uff0c\u5728\u952e\u7a7a\u95f4\u4e2d\uff0c\u79fb\u9664\u6700\u8fd1\u6700\u5c11\u4f7f\u7528\u7684key\u3002\nallkeys-random\uff1a\u5f53\u5185\u5b58\u4e0d\u8db3\u4ee5\u5bb9\u7eb3\u65b0\u5199\u5165\u6570\u636e\u65f6\uff0c\u5728\u952e\u7a7a\u95f4\u4e2d\uff0c\u968f\u673a\u79fb\u9664\u67d0\u4e2akey\u3002\nvolatile-lru\uff1a\u5f53\u5185\u5b58\u4e0d\u8db3\u4ee5\u5bb9\u7eb3\u65b0\u5199\u5165\u6570\u636e\u65f6\uff0c\u5728\u8bbe\u7f6e\u4e86\u8fc7\u671f\u65f6\u95f4\u7684\u952e\u7a7a\u95f4\u4e2d\uff0c\u79fb\u9664\u6700\u8fd1\u6700\u5c11\u4f7f\u7528\u7684key\u3002\nvolatile-random\uff1a\u5f53\u5185\u5b58\u4e0d\u8db3\u4ee5\u5bb9\u7eb3\u65b0\u5199\u5165\u6570\u636e\u65f6\uff0c\u5728\u8bbe\u7f6e\u4e86\u8fc7\u671f\u65f6\u95f4\u7684\u952e\u7a7a\u95f4\u4e2d\uff0c\u968f\u673a\u79fb\u9664\u67d0\u4e2akey\u3002\nvolatile-ttl\uff1a\u5f53\u5185\u5b58\u4e0d\u8db3\u4ee5\u5bb9\u7eb3\u65b0\u5199\u5165\u6570\u636e\u65f6\uff0c\u5728\u8bbe\u7f6e\u4e86\u8fc7\u671f\u65f6\u95f4\u7684\u952e\u7a7a\u95f4\u4e2d\uff0c\u6709\u66f4\u65e9\u8fc7\u671f\u65f6\u95f4\u7684key\u4f18\u5148\u79fb\u9664\u3002\n\n# \u5982\u4f55\u9009\u53d6\u5408\u9002\u7684\u7b56\u7565\uff1f\u6bd4\u8f83\u63a8\u8350\u7684\u662f\u4e24\u79cdlru\u7b56\u7565\u3002\n# \u6839\u636e\u81ea\u5df1\u7684\u4e1a\u52a1\u9700\u6c42\uff1a\n# \u5982\u679c\u4f60\u4f7f\u7528Redis\u53ea\u662f\u4f5c\u4e3a\u7f13\u5b58\uff0c\u4e0d\u4f5c\u4e3aDB\u6301\u4e45\u5316\uff0c\u90a3\u63a8\u8350\u9009\u62e9allkeys-lru\uff1b\n# \u5982\u679c\u4f60\u4f7f\u7528Redis\u540c\u65f6\u7528\u4e8e\u7f13\u5b58\u548c\u6570\u636e\u6301\u4e45\u5316\uff0c\u90a3\u63a8\u8350\u9009\u62e9volatile-lru\u3002\n</code></pre>"},{"location":"redis/01.redis%E7%AE%80%E4%BB%8B/#_6","title":"\u7ed3\u8bba","text":"<p>\u5728\u5b9e\u9645\u4e2d\uff0c\u5982\u679c\u6211\u4eec\u8981\u81ea\u5df1\u8bbe\u8ba1\u8fc7\u671f\u7b56\u7565\uff0c\u5728\u4f7f\u7528\u60f0\u6027\u5220\u9664+\u5b9a\u671f\u5220\u9664\u65f6\uff0c\u63a7\u5236\u65f6\u957f\u548c\u9891\u7387\u8fd9\u4e2a\u5c24\u4e3a\u5173\u952e\uff0c\u9700\u8981\u7ed3\u5408\u670d\u52a1\u5668\u6027\u80fd\uff0c\u5df2\u7ecf\u5e76\u53d1\u91cf\u7b49\u60c5\u51b5\u8fdb\u884c\u8c03\u6574\uff0c\u4ee5\u81f4\u6700\u4f73\u3002</p> <p>http://www.jiangxinlingdu.com/redis/2019/01/31/delcore.html</p> <p>https://liangshuang.name/2017/06/29/redis/</p>"},{"location":"redis/01.redis%E7%AE%80%E4%BB%8B/#redis_6","title":"\u6df1\u5165\u7406\u89e3 redis \u5185\u5b58\u6a21\u578b","text":"<p>\u5de5\u6b32\u5584\u5176\u4e8b\u5fc5\u5148\u5229\u5176\u5668\uff0c\u5728\u8bf4\u660eRedis\u5185\u5b58\u4e4b\u524d\u9996\u5148\u8bf4\u660e\u5982\u4f55\u7edf\u8ba1Redis\u4f7f\u7528\u5185\u5b58\u7684\u60c5\u51b5\u3002</p> <p>\u5728\u5ba2\u6237\u7aef\u901a\u8fc7redis-cli\u8fde\u63a5\u670d\u52a1\u5668\u540e\uff08\u540e\u9762\u5982\u65e0\u7279\u6b8a\u8bf4\u660e\uff0c\u5ba2\u6237\u7aef\u4e00\u5f8b\u4f7f\u7528redis-cli\uff09\uff0c\u901a\u8fc7 info \u547d\u4ee4\u53ef\u4ee5\u67e5\u770b\u5185\u5b58\u4f7f\u7528\u60c5\u51b5\uff1a</p> <p>\u5176\u4e2d\uff0cinfo \u547d\u4ee4\u53ef\u4ee5\u663e\u793a redis \u670d\u52a1\u5668\u7684\u8bb8\u591a\u4fe1\u606f\uff0c\u5305\u62ec\u670d\u52a1\u5668\u57fa\u672c\u4fe1\u606f\u3001CPU\u3001\u5185\u5b58\u3001\u6301\u4e45\u5316\u3001\u5ba2\u6237\u7aef\u8fde\u63a5\u4fe1\u606f\u7b49\u7b49\uff1b</p> <p>memory\u662f\u53c2\u6570\uff0c\u8868\u793a\u53ea\u663e\u793a\u5185\u5b58\u76f8\u5173\u7684\u4fe1\u606f\u3002</p> <pre><code>127.0.0.1:7000&gt;infomemory\n# Memory\nused_memory:1536400\nused_memory_human:1.47M\nused_memory_rss:8212480\nused_memory_rss_human:7.83M\nused_memory_peak:1539032\nused_memory_peak_human:1.47M\nused_memory_peak_perc:99.83%\nused_memory_overhead:1478258\nused_memory_startup:1461272\nused_memory_dataset:58142\nused_memory_dataset_perc:77.39%\nallocator_allocated:1538472\nallocator_active:1814528\nallocator_resident:4329472\ntotal_system_memory:8185995264\ntotal_system_memory_human:7.62G\nused_memory_lua:37888\nused_memory_lua_human:37.00K\nused_memory_scripts:0\nused_memory_scripts_human:0B\nnumber_of_cached_scripts:0\nmaxmemory:0\nmaxmemory_human:0B\nmaxmemory_policy:noeviction\nallocator_frag_ratio:1.18\nallocator_frag_bytes:276056\nallocator_rss_ratio:2.39\nallocator_rss_bytes:2514944\nrss_overhead_ratio:1.90\nrss_overhead_bytes:3883008\nmem_fragmentation_ratio:5.49\nmem_fragmentation_bytes:6717096\nmem_not_counted_for_evict:0\nmem_replication_backlog:0\nmem_clients_slaves:0\nmem_clients_normal:16986\nmem_aof_buffer:0\nmem_allocator:jemalloc-5.1.0\nactive_defrag_running:0\nlazyfree_pending_objects:0\n127.0.0.1:7000&gt;\n127.0.0.1:7000&gt;\n</code></pre> <p>\u8fd4\u56de\u7ed3\u679c\u4e2d\u6bd4\u8f83\u91cd\u8981\u7684\u51e0\u4e2a\u8bf4\u660e\u5982\u4e0b\uff1a</p> <p>\uff081\uff09used_memory\uff1aRedis\u5206\u914d\u5668\u5206\u914d\u7684\u5185\u5b58\u603b\u91cf\uff08\u5355\u4f4d\u662f\u5b57\u8282\uff09\uff0c\u5305\u62ec\u4f7f\u7528\u7684\u865a\u62df\u5185\u5b58\uff08\u5373swap\uff09\uff1bRedis\u5206\u914d\u5668\u540e\u9762\u4f1a\u4ecb\u7ecd\u3002used_memory_human \u53ea\u662f\u663e\u793a\u66f4\u53cb\u597d\u3002</p> <p>\uff082\uff09used_memory_rss\uff1aRedis\u8fdb\u7a0b\u5360\u636e\u64cd\u4f5c\u7cfb\u7edf\u7684\u5185\u5b58\uff08\u5355\u4f4d\u662f\u5b57\u8282\uff09\uff0c\u4e0etop\u53caps\u547d\u4ee4\u770b\u5230\u7684\u503c\u662f\u4e00\u81f4\u7684\uff1b\u9664\u4e86\u5206\u914d\u5668\u5206\u914d\u7684\u5185\u5b58\u4e4b\u5916\uff0cused_memory_rss\u8fd8\u5305\u62ec\u8fdb\u7a0b\u8fd0\u884c\u672c\u8eab\u9700\u8981\u7684\u5185\u5b58\u3001\u5185\u5b58\u788e\u7247\u7b49\uff0c\u4f46\u662f\u4e0d\u5305\u62ec\u865a\u62df\u5185\u5b58\u3002</p> <p>\u56e0\u6b64\uff0cused_memory\u548cused_memory_rss\uff0c\u524d\u8005\u662f\u4eceRedis\u89d2\u5ea6\u5f97\u5230\u7684\u91cf\uff0c\u540e\u8005\u662f\u4ece\u64cd\u4f5c\u7cfb\u7edf\u89d2\u5ea6\u5f97\u5230\u7684\u91cf\u3002\u4e8c\u8005\u4e4b\u6240\u4ee5\u6709\u6240\u4e0d\u540c\uff0c\u4e00\u65b9\u9762\u662f\u56e0\u4e3a\u5185\u5b58\u788e\u7247\u548cRedis\u8fdb\u7a0b\u8fd0\u884c\u9700\u8981\u5360\u7528\u5185\u5b58\uff0c\u4f7f\u5f97\u524d\u8005\u53ef\u80fd\u6bd4\u540e\u8005\u5c0f\uff0c\u53e6\u4e00\u65b9\u9762\u865a\u62df\u5185\u5b58\u7684\u5b58\u5728\uff0c\u4f7f\u5f97\u524d\u8005\u53ef\u80fd\u6bd4\u540e\u8005\u5927\u3002</p> <p>\u7531\u4e8e\u5728\u5b9e\u9645\u5e94\u7528\u4e2d\uff0cRedis\u7684\u6570\u636e\u91cf\u4f1a\u6bd4\u8f83\u5927\uff0c\u6b64\u65f6\u8fdb\u7a0b\u8fd0\u884c\u5360\u7528\u7684\u5185\u5b58\u4e0eRedis\u6570\u636e\u91cf\u548c\u5185\u5b58\u788e\u7247\u76f8\u6bd4\uff0c\u90fd\u4f1a\u5c0f\u5f97\u591a\uff1b\u56e0\u6b64used_memory_rss\u548cused_memory\u7684\u6bd4\u4f8b\uff0c\u4fbf\u6210\u4e86\u8861\u91cfRedis\u5185\u5b58\u788e\u7247\u7387\u7684\u53c2\u6570\uff1b\u8fd9\u4e2a\u53c2\u6570\u5c31\u662f mem_fragmentation_ratio\u3002</p> <p>\uff083\uff09mem_fragmentation_ratio\uff1a\u5185\u5b58\u788e\u7247\u6bd4\u7387\uff0c\u8be5\u503c\u662f used_memory_rss / used_memory \u7684\u6bd4\u503c\u3002</p> <p>mem_fragmentation_ratio\u4e00\u822c\u5927\u4e8e1\uff0c\u4e14\u8be5\u503c\u8d8a\u5927\uff0c\u5185\u5b58\u788e\u7247\u6bd4\u4f8b\u8d8a\u5927\u3002mem_fragmentation_ratio&lt;1\uff0c\u8bf4\u660eRedis\u4f7f\u7528\u4e86\u865a\u62df\u5185\u5b58\uff0c\u7531\u4e8e\u865a\u62df\u5185\u5b58\u7684\u5a92\u4ecb\u662f\u78c1\u76d8\uff0c\u6bd4\u5185\u5b58\u901f\u5ea6\u8981\u6162\u5f88\u591a\uff0c\u5f53\u8fd9\u79cd\u60c5\u51b5\u51fa\u73b0\u65f6\uff0c\u5e94\u8be5\u53ca\u65f6\u6392\u67e5\uff0c\u5982\u679c\u5185\u5b58\u4e0d\u8db3\u5e94\u8be5\u53ca\u65f6\u5904\u7406\uff0c\u5982\u589e\u52a0Redis\u8282\u70b9\u3001\u589e\u52a0Redis\u670d\u52a1\u5668\u7684\u5185\u5b58\u3001\u4f18\u5316\u5e94\u7528\u7b49\u3002</p> <p>\u4e00\u822c\u6765\u8bf4\uff0cmem_fragmentation_ratio\u57281.03\u5de6\u53f3\u662f\u6bd4\u8f83\u5065\u5eb7\u7684\u72b6\u6001\uff08\u5bf9\u4e8ejemalloc\u6765\u8bf4\uff09\uff1b\u4e0a\u9762\u622a\u56fe\u4e2d\u7684mem_fragmentation_ratio\u503c\u5f88\u5927\uff0c\u662f\u56e0\u4e3a\u8fd8\u6ca1\u6709\u5411Redis\u4e2d\u5b58\u5165\u6570\u636e\uff0cRedis\u8fdb\u7a0b\u672c\u8eab\u8fd0\u884c\u7684\u5185\u5b58\u4f7f\u5f97used_memory_rss \u6bd4used_memory\u5927\u5f97\u591a\u3002</p> <p>\uff084\uff09mem_allocator**\uff1a**Redis\u4f7f\u7528\u7684\u5185\u5b58\u5206\u914d\u5668\uff0c\u5728\u7f16\u8bd1\u65f6\u6307\u5b9a\uff1b\u53ef\u4ee5\u662f libc \u3001jemalloc\u6216\u8005tcmalloc\uff0c\u9ed8\u8ba4\u662fjemalloc\uff1b\u622a\u56fe\u4e2d\u4f7f\u7528\u7684\u4fbf\u662f\u9ed8\u8ba4\u7684jemalloc\u3002</p>"},{"location":"redis/01.redis%E7%AE%80%E4%BB%8B/#redis_7","title":"redis \u5185\u5b58\u5212\u5206","text":"<p>redis \u4f5c\u4e3a\u5185\u5b58\u6570\u636e\u5e93\uff0c\u5728\u5185\u5b58\u4e2d\u5b58\u50a8\u7684\u5185\u5bb9\u4e3b\u8981\u662f\u6570\u636e\uff08\u952e\u503c\u5bf9\uff09\uff1b\u901a\u8fc7\u524d\u9762\u7684\u53d9\u8ff0\u53ef\u4ee5\u77e5\u9053\uff0c\u9664\u4e86\u6570\u636e\u4ee5\u5916\uff0credis \u7684\u5176\u4ed6\u90e8\u5206\u4e5f\u4f1a\u5360\u7528\u5185\u5b58</p> <p>redis \u7684\u5185\u5b58\u5360\u7528\u4e3b\u8981\u53ef\u4ee5\u5212\u5206\u4e3a\u4ee5\u4e0b\u51e0\u4e2a\u90e8\u5206\uff1a</p>"},{"location":"redis/01.redis%E7%AE%80%E4%BB%8B/#redis_8","title":"redis \u96c6\u7fa4","text":""},{"location":"redis/01.redis%E7%AE%80%E4%BB%8B/#redis_9","title":"redis\u9ad8\u53ef\u7528\u65b9\u6848","text":"<ul> <li> <p>\u6301\u4e45\u5316</p> </li> <li> <p>\u4e3b\u4ece\u590d\u5236</p> </li> <li>\u54e8\u5175</li> <li>\u96c6\u7fa4</li> </ul>"},{"location":"redis/01.redis%E7%AE%80%E4%BB%8B/#_7","title":"\u4e3b\u4ece\u590d\u5236\u539f\u7406","text":"<p>\u4e3b\u4ece\u590d\u5236\uff0c\u662f\u6307\u5c06\u4e00\u53f0Redis\u670d\u52a1\u5668\u7684\u6570\u636e\uff0c\u590d\u5236\u5230\u5176\u4ed6\u7684Redis\u670d\u52a1\u5668\u3002</p> <p>\u524d\u8005\u79f0\u4e3a\u4e3b\u8282\u70b9(master)\uff0c\u540e\u8005\u79f0\u4e3a\u4ece\u8282\u70b9(slave)\uff1b\u6570\u636e\u7684\u590d\u5236\u662f\u5355\u5411\u7684\uff0c\u53ea\u80fd\u7531\u4e3b\u8282\u70b9\u5230\u4ece\u8282\u70b9\u3002</p> <p>\u5728\u9ed8\u8ba4\u60c5\u51b5\u7684\u5355\u673a\u7248\u4e0b\uff1a\u6bcf\u53f0Redis\u670d\u52a1\u5668\u90fd\u662f\u4e3b\u8282\u70b9\uff1b\u4e14\u4e00\u4e2a\u4e3b\u8282\u70b9\u53ef\u4ee5\u6709\u591a\u4e2a\u4ece\u8282\u70b9(\u6216\u6ca1\u6709\u4ece\u8282\u70b9)\uff0c\u4f46\u4e00\u4e2a\u4ece\u8282\u70b9\u53ea\u80fd\u6709\u4e00\u4e2a\u4e3b\u8282\u70b9\u3002</p> <p>\u6bcf\u5f53 slave \u548c master \u4e4b\u95f4\u7684\u8fde\u63a5\u65ad\u5f00\u65f6\uff0c slave \u4f1a\u81ea\u52a8\u91cd\u8fde\u5230 master \u4e0a\uff0c\u5e76\u4e14\u65e0\u8bba\u8fd9\u671f\u95f4 master \u53d1\u751f\u4e86\u4ec0\u4e48\uff0c slave \u90fd\u5c06\u5c1d\u8bd5\u8ba9\u81ea\u8eab\u6210\u4e3a master \u7684\u5b8c\u6574\u7cbe\u786e\u526f\u672c\u3002</p> <p>\u4e3b\u4ece\u590d\u5236\u7684\u4e3b\u8981\u4f5c\u7528\uff1a</p> <ul> <li> <p>\u6570\u636e\u5197\u4f59\uff1a\u4e3b\u4ece\u590d\u5236\u5b9e\u73b0\u4e86\u6570\u636e\u7684\u70ed\u5907\u4efd\uff0c\u662f\u6301\u4e45\u5316\u4e4b\u5916\u7684\u4e00\u79cd\u6570\u636e\u5197\u4f59\u65b9\u5f0f\u3002</p> </li> <li> <p>\u6545\u969c\u6062\u590d\uff1a\u5f53\u4e3b\u8282\u70b9\u51fa\u73b0\u95ee\u9898\u65f6\uff0c\u53ef\u4ee5\u7531\u4ece\u8282\u70b9\u63d0\u4f9b\u670d\u52a1\uff0c\u5b9e\u73b0\u5feb\u901f\u7684\u6545\u969c\u6062\u590d\uff1b\u5b9e\u9645\u4e0a\u662f\u4e00\u79cd\u670d\u52a1\u7684\u5197\u4f59\u3002</p> </li> <li> <p>\u8d1f\u8f7d\u5747\u8861\uff1a\u901a\u8fc7\u4e3b\u4ece\u590d\u5236\u548c\u8bfb\u5199\u5206\u79bb\uff0c\u53ef\u4ee5\u7531\u4e3b\u8282\u70b9\u63d0\u4f9b\u5199\u670d\u52a1\uff0c\u7531\u4ece\u8282\u70b9\u63d0\u4f9b\u8bfb\u670d\u52a1\u3002</p> </li> </ul> <p>\u5c24\u5176\u662f\u5728\u5199\u5c11\u8bfb\u591a\u7684\u573a\u666f\u4e0b\uff0c\u901a\u8fc7\u591a\u4e2a\u4ece\u8282\u70b9\u5206\u62c5\u8bfb\u8d1f\u8f7d\uff0c\u53ef\u4ee5\u5927\u5927\u63d0\u9ad8Redis\u670d\u52a1\u5668\u7684\u5e76\u53d1\u3002\uff08\u5982\u7535\u5546\u7f51\u7ad9\u7684\u5546\u54c1\uff09</p> <ul> <li>\u9ad8\u53ef\u7528\u57fa\u77f3\uff1a\u9664\u4e86\u4e0a\u8ff0\u4f5c\u7528\u4ee5\u5916\uff0c\u4e3b\u4ece\u590d\u5236\u8fd8\u662f\u54e8\u5175\u548c\u96c6\u7fa4\u80fd\u591f\u5b9e\u65bd\u7684\u57fa\u7840\uff0c\u56e0\u6b64\u8bf4\u4e3b\u4ece\u590d\u5236\u662fRedis\u9ad8\u53ef\u7528\u7684\u57fa\u7840\u3002</li> </ul> <p>redis \u590d\u5236\u4e3b\u8981\u901a\u8fc7\u5982\u4e0b\u673a\u5236\u5b9e\u73b0\uff1a</p> <ul> <li>\u5f53\u4e3b\u8282\u70b9\u548c\u4ece\u8282\u70b9\u8fde\u63a5\u826f\u597d\u65f6\uff0c\u4e3b\u8282\u70b9\u901a\u8fc7\u53d1\u9001\u4e00\u4e2a\u547d\u4ee4\u6d41\u6765\u4fdd\u6301\u4ece\u8282\u70b9\u7684\u6570\u636e\u66f4\u65b0\u3002\uff08\u5305\u62ec\u5ba2\u6237\u7aef\u7684\u5199\u5165\u548c\u66f4\u65b0\uff0ckey\u8fc7\u671f\u6216\u88ab\u9010\u51fa\uff0c\u6216\u8005\u5176\u4ed6\u53d8\u66f4\uff09</li> <li>\u5f53\u4e3b\u8282\u70b9\u548c\u4ece\u8282\u70b9\u8fde\u63a5\u6545\u969c\uff0c\u6bd4\u5982\u7f51\u7edc\u8d85\u65f6\u7b49\u3002</li> <li>slave \u91cd\u65b0\u8fde\u63a5\u4e0a master \u5e76\u4f1a\u5c1d\u8bd5\u8fdb\u884c\u90e8\u5206**\u91cd\u540c\u6b65**\uff1a\u8fd9\u610f\u5473\u7740\u5b83\u4f1a\u5c1d\u8bd5\u53ea\u83b7\u53d6\u5728\u65ad\u5f00\u8fde\u63a5\u671f\u95f4\u5185\u4e22\u5931\u7684\u547d\u4ee4\u6d41\u3002</li> <li>\u5f53\u65e0\u6cd5\u8fdb\u884c\u90e8\u5206\u91cd\u540c\u6b65\u65f6\uff0c slave \u4f1a\u8bf7\u6c42\u8fdb\u884c\u5168\u91cf\u91cd\u540c\u6b65\u3002</li> <li>\u8fd9\u4f1a\u6d89\u53ca\u5230\u4e00\u4e2a\u66f4\u590d\u6742\u7684\u8fc7\u7a0b\uff0c\u4f8b\u5982 master \u9700\u8981\u521b\u5efa\u6240\u6709\u6570\u636e\u7684\u5feb\u7167\uff0c\u5c06\u4e4b\u53d1\u9001\u7ed9 slave \uff0c\u4e4b\u540e\u5728\u6570\u636e\u96c6\u66f4\u6539\u65f6\u6301\u7eed\u53d1\u9001\u547d\u4ee4\u6d41\u5230 slave \u3002</li> </ul> <p>redis \u590d\u5236\u5206\u4e3a\u4e24\u79cd\u60c5\u51b5\uff1a</p> <ul> <li>\u90e8\u5206\u590d\u5236\uff1a</li> </ul> <p>\u7528\u4e8e\u5904\u7406\u5728\u4e3b\u4ece\u590d\u5236\u4e2d\u56e0\u7f51\u7edc\u95ea\u65ad\u7b49\u539f\u56e0\u9020\u6210\u7684\u6570\u636e\u4e22\u5931\u573a\u666f\uff0c\u5f53\u4ece\u8282\u70b9\u518d\u6b21\u8fde\u4e0a\u4e3b\u8282\u70b9\u540e\uff0c\u5982\u679c\u6761\u4ef6\u5141\u8bb8\uff0c\u4e3b\u8282\u70b9\u4f1a**\u8865\u53d1\u4e22\u5931\u6570\u636e**\u7ed9\u4ece\u8282\u70b9\u3002</p> <p>\u56e0\u4e3a\u8865\u53d1\u7684\u6570\u636e\u8fdc\u8fdc\u5c0f\u4e8e\u5168\u91cf\u6570\u636e\uff0c\u53ef\u4ee5\u6709\u6548\u907f\u514d\u5168\u91cf\u590d\u5236\u7684\u8fc7\u9ad8\u5f00\u9500\u3002</p> <p>\u5982\u679c\u4e3b\u8282\u70b9\u7684\u590d\u5236\u79ef\u538b\u7f13\u51b2\u533a\u5185\u5b58\u5728\u8fd9\u90e8\u5206\u6570\u636e\u5219\u76f4\u63a5\u53d1\u9001\u7ed9\u4ece\u8282\u70b9\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u4fdd\u6301\u4e3b\u4ece\u8282\u70b9\u590d\u5236\u7684\u4e00\u81f4\u6027\u3002</p> <p>\u8865\u53d1\u7684\u8fd9\u90e8\u5206\u6570\u636e\u4e00\u822c\u8fdc\u8fdc\u5c0f\u4e8e\u5168\u91cf\u6570\u636e\uff0c\u6240\u4ee5\u5f00\u9500\u5f88\u5c0f\u3002</p> <p>\u200b      \u4e3b\u8282\u70b9\u4f55\u65f6\u8ba4\u4e3a\u4ece\u8282\u70b9\u6302\u6389\uff1f</p> <p>\u200b      \u4e3b\u4ece\u8282\u70b9\u4e4b\u95f4\u7f51\u7edc\u51fa\u73b0\u4e2d\u65ad\u65f6\uff0c\u5982\u679c\u8d85\u8fc7 <code>repl-timeout</code> \u65f6\u95f4\uff0c\u4e3b\u8282\u70b9\u4f1a\u8ba4\u4e3a\u4ece\u8282\u70b9\u6545\u969c\uff0c\u5e76\u4e2d\u65ad\u590d\u5236\u8fde\u63a5\u3002</p> <p>\u200b      \u5f53\u4e3b\u4ece\u8fde\u63a5\u6062\u590d\u540e\uff0c\u7531\u4e8e\u4ece\u8282\u70b9\u4e4b\u524d\u4fdd\u5b58\u4e86\u81ea\u8eab\u5df2\u590d\u5236\u7684\u504f\u79fb\u91cf\u548c\u4e3b\u8282\u70b9\u7684\u8fd0\u884cID\u3002\u56e0\u6b64\u4f1a\u628a\u5b83\u4eec\u5f53\u4f5c<code>psync</code>\u53c2\u6570\u53d1\u9001\u7ed9\u4e3b\u8282\u70b9\uff0c\u8981\u6c42\u8fdb\u884c\u90e8\u5206\u590d\u5236\u64cd\u4f5c\u3002</p> <p>Redis \u9ed8\u8ba4\u4f7f\u7528**\u5f02\u6b65\u590d\u5236**\uff0c\u4fdd\u8bc1\u4e86\u4f4e\u5ef6\u8fdf\u548c\u9ad8\u6027\u80fd\uff0c\u9002\u7528\u4e8e\u7edd\u5927\u6570\u7684\u5e94\u7528\u573a\u666f\u3002</p> <p>\u4ece\u8282\u70b9\u4f1a\u5f02\u6b65\u7684\u5904\u7406\u4e3b\u8282\u70b9\u53d1\u8fc7\u6765\u7684\u6570\u636e\uff08\u5468\u671f\u6027\u5730\uff09\u3002\u6240\u4ee5\u4e3b\u8282\u70b9\u4e0d\u9700\u8981\u4e00\u76f4\u7b49\u5f85\u76f4\u81f3\u4e00\u4e2a\u547d\u4ee4\u88ab\u4ece\u8282\u70b9\u5904\u7406\u5b8c\u6210\u3002</p> <p>\u4f46\u662f\uff0c\u5982\u679c\u5fc5\u8981\uff0c\u4e3b\u8282\u70b9\u662f\u53ef\u4ee5\u611f\u77e5\u5230\u54ea\u4e9b\u4ece\u8282\u70b9\u5df2\u7ecf\u5904\u7406\u4e86\u54ea\u4e9b\u6570\u636e\u3002\uff08\u4e5f\u5c31\u662f\u8bf4\u4e3b\u8282\u70b9\u80fd\u591f\u611f\u77e5\u590d\u5236\u72b6\u6001\uff09</p> <p>\u8fd9\u5c31\u7ed9\u4e86\u540c\u6b65\u590d\u5236\u7559\u4e0b\u53ef\u80fd\u3002</p> <ul> <li>redis \u9ed8\u8ba4\u4f7f\u7528\u5f02\u6b65\u590d\u5236\uff0c</li> <li>\u4e00\u4e3b\u53ef\u4ee5\u591a\u4ece</li> <li>\u53ef\u4ee5\u661f\u5f62\u590d\u5236\uff0c\u4e5f\u53ef\u4ee5\u94fe\u5f0f\u590d\u5236\u3002</li> <li>redis \u5728\u4e3b\u8282\u70b9\u4e0a\u662f\u975e\u963b\u585e\u7684\u3002</li> </ul>"},{"location":"redis/01.redis%E7%AE%80%E4%BB%8B/#_8","title":"\u5efa\u7acb\u4e3b\u4ece\u590d\u5236","text":"<p>\u4e3b\u4ece\u590d\u5236\u7684\u5f00\u542f\uff0c\u5b8c\u5168\u662f\u5728\u4ece\u8282\u70b9\u53d1\u8d77\u7684\uff1b\u4e0d\u9700\u8981\u6211\u4eec\u5728\u4e3b\u8282\u70b9\u505a\u4efb\u4f55\u4e8b\u60c5\u3002</p> <p>\u4ece\u8282\u70b9\u5f00\u542f\u4e3b\u4ece\u590d\u5236\uff0c\u67093\u79cd\u65b9\u5f0f\uff1a</p> <p>\uff081\uff09\u914d\u7f6e\u6587\u4ef6</p> <p>\u5728\u4ece\u670d\u52a1\u5668\u7684\u914d\u7f6e\u6587\u4ef6\u4e2d\u52a0\u5165\uff1aslaveof  <p>\uff082\uff09\u542f\u52a8\u547d\u4ee4</p> <p>redis-server\u542f\u52a8\u547d\u4ee4\u540e\u52a0\u5165 --slaveof  <p>\uff083\uff09\u5ba2\u6237\u7aef\u547d\u4ee4</p> <p>Redis\u670d\u52a1\u5668\u542f\u52a8\u540e\uff0c\u76f4\u63a5\u901a\u8fc7\u5ba2\u6237\u7aef\u6267\u884c\u547d\u4ee4\uff1aslaveof  \uff0c\u5219\u8be5Redis\u5b9e\u4f8b\u6210\u4e3a\u4ece\u8282\u70b9\u3002 <p>\u4e0a\u8ff03\u79cd\u65b9\u5f0f\u662f\u7b49\u6548\u7684\uff0c\u4e0b\u9762\u4ee5\u5ba2\u6237\u7aef\u547d\u4ee4\u7684\u65b9\u5f0f\u4e3a\u4f8b\uff0c\u770b\u4e00\u4e0b\u5f53\u6267\u884c\u4e86 slaveof \u540e\uff0cRedis\u4e3b\u8282\u70b9\u548c\u4ece\u8282\u70b9\u7684\u53d8\u5316\u3002</p> <p>\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u4ece\u8282\u70b9\u9ed8\u8ba4\u4e5f\u53ef\u4ee5\u8fdb\u884c\u8bfb\u5199\u64cd\u4f5c\uff0c\u4f46\u4ece\u8282\u70b9\u7684\u5199\u5165\u5c06\u4f1a\u5bfc\u81f4\u8fd9\u90e8\u5206\u6570\u636e\u4e0d\u4f1a\u88ab\u540c\u6b65\uff0c\u4ece\u800c\u9020\u6210\u6570\u636e\u4e0d\u4e00\u81f4\u7684\u95ee\u9898\u3002</p> <p>\u53ef\u4ee5\u901a\u8fc7\u6307\u5b9a\u914d\u7f6e\u6765\u5f3a\u5236\u4ece\u8282\u70b9\u4e0d\u53ef\u5199\u5165\uff1a</p> <pre><code>replica-read-only yes\n</code></pre> <p>\u6b64\u65f6\u5bf9\u4ece\u8282\u70b9\u8fdb\u884c\u5199\u5165\u64cd\u4f5c\u4f1a\u62a5\u9519\uff1a</p> <pre><code>(error) READONLY You can't write against a read only replica.\n</code></pre> <p>\u5728 redis-cli \u4e2d\uff0c\u901a\u8fc7\u6267\u884c info replication \u53ef\u4ee5\u770b\u5230\u96c6\u7fa4\u4fe1\u606f</p> <pre><code># \u5176\u4e2d\u6709\u4e24\u4e2a\u6807\u8bc6\uff1a\n\n#     master_replid -- \u957f\u5ea6\u4e3a41\u4e2a\u5b57\u8282\u7684\u5b57\u7b26\u4e32\uff0c\u4e3b\u8282\u70b9\u6807\u8bc6\n\n#     master_replid2 -- \u8be5\u8282\u70b9\u4e0a\u4e00\u6b21\u8fde\u63a5\u4e3b\u5b9e\u4f8b\u7684\u5b9e\u4f8b master_replid\n</code></pre>"},{"location":"redis/01.redis%E7%AE%80%E4%BB%8B/#_9","title":"\u5b9e\u4f8b","text":"<p>\u65b9\u4fbf\u8d77\u89c1\uff0c\u5b9e\u9a8c\u6240\u4f7f\u7528\u7684\u4e3b\u4ece\u8282\u70b9\u662f\u5728\u4e00\u53f0\u673a\u5668\u4e0a\u7684\u4e0d\u540cRedis\u5b9e\u4f8b\uff0c\u5176\u4e2d\u4e3b\u8282\u70b9\u76d1\u542c6379\u7aef\u53e3\uff0c\u4ece\u8282\u70b9\u76d1\u542c6380\u7aef\u53e3\uff1b</p> <p>\u4ece\u8282\u70b9\u76d1\u542c\u7684\u7aef\u53e3\u53f7\u53ef\u4ee5\u5728\u914d\u7f6e\u6587\u4ef6\u4e2d\u4fee\u6539\uff1a</p>"},{"location":"redis/01.redis%E7%AE%80%E4%BB%8B/#_10","title":"\u590d\u5236\u8fc7\u7a0b","text":"<p>\u4e3b\u4ece\u590d\u5236\u8fc7\u7a0b\u5927\u4f53\u53ef\u4ee5\u5206\u4e3a3\u4e2a\u9636\u6bb5\uff1a\u8fde\u63a5\u5efa\u7acb\u9636\u6bb5\uff08\u5373\u51c6\u5907\u9636\u6bb5\uff09\u3001\u6570\u636e\u540c\u6b65\u9636\u6bb5\u3001\u547d\u4ee4\u4f20\u64ad\u9636\u6bb5\uff1b\u4e0b\u9762\u5206\u522b\u8fdb\u884c\u4ecb\u7ecd\u3002</p>"},{"location":"redis/01.redis%E7%AE%80%E4%BB%8B/#_11","title":"\u8fde\u63a5\u5efa\u7acb\u9636\u6bb5","text":"<p>\u8be5\u9636\u6bb5\u7684\u4e3b\u8981\u4f5c\u7528\u662f\u5728\u4e3b\u4ece\u8282\u70b9\u4e4b\u95f4\u5efa\u7acb\u8fde\u63a5\uff0c\u4e3a\u6570\u636e\u540c\u6b65\u505a\u597d\u51c6\u5907\u3002</p> <p>\u6b65\u9aa4\u4e00\u3001\u4fdd\u5b58\u4e3b\u8282\u70b9\u4fe1\u606f</p> <p>\u4ece\u8282\u70b9\u670d\u52a1\u5668\u5185\u90e8\u7ef4\u62a4\u4e86\u4e24\u4e2a\u5b57\u6bb5\uff0c\u5373 masterhost \u548c masterport \u5b57\u6bb5\uff0c\u7528\u4e8e\u5b58\u50a8\u4e3b\u8282\u70b9\u7684 ip \u548c port \u4fe1\u606f\u3002</p> <p>\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0cslaveof \u662f\u5f02\u6b65\u547d\u4ee4\uff0c\u4ece\u8282\u70b9\u5b8c\u6210\u4e3b\u8282\u70b9 ip \u548c port \u7684\u4fdd\u5b58\u540e\uff0c\u5411\u53d1\u9001 slaveof \u547d\u4ee4\u7684\u5ba2\u6237\u7aef\u76f4\u63a5\u8fd4\u56de OK\u3002\u7136\u540e\u624d\u5f00\u59cb\u8fdb\u884c\u590d\u5236\u3002</p> <p>\u6b65\u9aa4\u4e8c\u3001\u5efa\u7acb socket \u8fde\u63a5</p> <p>\u4ece\u8282\u70b9\u6bcf\u79d21\u6b21\u8c03\u7528\u590d\u5236\u5b9a\u65f6\u51fd\u6570 replicationCron()\uff0c\u5982\u679c\u53d1\u73b0\u4e86\u6709\u4e3b\u8282\u70b9\u53ef\u4ee5\u8fde\u63a5\uff0c\u4fbf\u4f1a\u6839\u636e\u4e3b\u8282\u70b9\u7684ip\u548cport\uff0c\u521b\u5efasocket\u8fde\u63a5\u3002\u5982\u679c\u8fde\u63a5\u6210\u529f\uff0c\u5219\uff1a</p> <p>\u4ece\u8282\u70b9\uff1a\u4e3a\u8be5socket\u5efa\u7acb\u4e00\u4e2a\u4e13\u95e8\u5904\u7406\u590d\u5236\u5de5\u4f5c\u7684\u6587\u4ef6\u4e8b\u4ef6\u5904\u7406\u5668\uff0c\u8d1f\u8d23\u540e\u7eed\u7684\u590d\u5236\u5de5\u4f5c\uff0c\u5982\u63a5\u6536RDB\u6587\u4ef6\u3001\u63a5\u6536\u547d\u4ee4\u4f20\u64ad\u7b49\u3002</p> <p>\u4e3b\u8282\u70b9\uff1a\u63a5\u6536\u5230\u4ece\u8282\u70b9\u7684socket\u8fde\u63a5\u540e\uff08\u5373accept\u4e4b\u540e\uff09\uff0c\u4e3a\u8be5socket\u521b\u5efa\u76f8\u5e94\u7684\u5ba2\u6237\u7aef\u72b6\u6001\uff1a</p> <p>\u5e76\u5c06\u4ece\u8282\u70b9\u770b\u505a\u662f\u8fde\u63a5\u5230\u4e3b\u8282\u70b9\u7684\u4e00\u4e2a\u5ba2\u6237\u7aef\uff0c\u540e\u9762\u7684\u6b65\u9aa4\u4f1a\u4ee5\u4ece\u8282\u70b9\u5411\u4e3b\u8282\u70b9\u53d1\u9001\u547d\u4ee4\u8bf7\u6c42\u7684\u5f62\u5f0f\u6765\u8fdb\u884c\u3002</p> <p>\u6b65\u9aa4\u4e09\u3001\u53d1\u9001 ping \u547d\u4ee4</p> <p>\u4ece\u8282\u70b9\u6210\u4e3a\u4e3b\u8282\u70b9\u7684\u5ba2\u6237\u7aef\u4e4b\u540e\uff0c\u53d1\u9001ping\u547d\u4ee4\u8fdb\u884c\u9996\u6b21\u8bf7\u6c42\uff0c\u76ee\u7684\u662f\uff1a\u68c0\u67e5socket\u8fde\u63a5\u662f\u5426\u53ef\u7528\uff0c\u4ee5\u53ca\u4e3b\u8282\u70b9\u5f53\u524d\u662f\u5426\u80fd\u591f\u5904\u7406\u8bf7\u6c42\u3002</p> <p>\u4ece\u8282\u70b9\u53d1\u9001ping\u547d\u4ee4\u540e\uff0c\u53ef\u80fd\u51fa\u73b03\u79cd\u60c5\u51b5\uff1a</p> <p>\uff081\uff09\u8fd4\u56depong\uff1a\u8bf4\u660esocket\u8fde\u63a5\u6b63\u5e38\uff0c\u4e14\u4e3b\u8282\u70b9\u5f53\u524d\u53ef\u4ee5\u5904\u7406\u8bf7\u6c42\uff0c\u590d\u5236\u8fc7\u7a0b\u7ee7\u7eed\u3002</p> <p>\uff082\uff09\u8d85\u65f6\uff1a\u4e00\u5b9a\u65f6\u95f4\u540e\u4ece\u8282\u70b9\u4ecd\u672a\u6536\u5230\u4e3b\u8282\u70b9\u7684\u56de\u590d\uff0c\u8bf4\u660esocket\u8fde\u63a5\u4e0d\u53ef\u7528\uff0c\u5219\u4ece\u8282\u70b9\u65ad\u5f00socket\u8fde\u63a5\uff0c\u5e76\u91cd\u8fde\u3002</p> <p>\uff083\uff09\u8fd4\u56depong\u4ee5\u5916\u7684\u7ed3\u679c\uff1a\u5982\u679c\u4e3b\u8282\u70b9\u8fd4\u56de\u5176\u4ed6\u7ed3\u679c\uff0c\u5982\u6b63\u5728\u5904\u7406\u8d85\u65f6\u8fd0\u884c\u7684\u811a\u672c\uff0c\u8bf4\u660e\u4e3b\u8282\u70b9\u5f53\u524d\u65e0\u6cd5\u5904\u7406\u547d\u4ee4\uff0c\u5219\u4ece\u8282\u70b9\u65ad\u5f00socket\u8fde\u63a5\uff0c\u5e76\u91cd\u8fde\u3002</p> <p>\u6b65\u9aa4\u56db\u3001\u8eab\u4efd\u9a8c\u8bc1</p> <p>\u5982\u679c\u4ece\u8282\u70b9\u4e2d\u8bbe\u7f6e\u4e86masterauth \u9009\u9879\uff0c\u5219\u4ece\u8282\u70b9\u9700\u8981\u5411\u4e3b\u8282\u70b9\u8fdb\u884c\u8eab\u4efd\u9a8c\u8bc1\uff1b\u6ca1\u6709\u8bbe\u7f6e\u8be5\u9009\u9879\uff0c\u5219\u4e0d\u9700\u8981\u9a8c\u8bc1\u3002\u4ece\u8282\u70b9\u8fdb\u884c\u8eab\u4efd\u9a8c\u8bc1\u662f\u901a\u8fc7\u5411\u4e3b\u8282\u70b9\u53d1\u9001auth\u547d\u4ee4\u8fdb\u884c\u7684\uff0cauth \u547d\u4ee4\u7684\u53c2\u6570\u5373\u4e3a\u914d\u7f6e\u6587\u4ef6\u4e2d\u7684 masterauth \u7684\u503c\u3002</p> <p>\u5982\u679c\u4e3b\u8282\u70b9\u8bbe\u7f6e\u5bc6\u7801\u7684\u72b6\u6001\uff0c\u4e0e\u4ece\u8282\u70b9 <code>masterauth</code> \u7684\u72b6\u6001\u4e00\u81f4\uff08\u4e00\u81f4\u662f\u6307\u90fd\u5b58\u5728\uff0c\u4e14\u5bc6\u7801\u76f8\u540c\uff0c\u6216\u8005\u90fd\u4e0d\u5b58\u5728\uff09\uff0c\u5219\u8eab\u4efd\u9a8c\u8bc1\u901a\u8fc7\uff0c\u590d\u5236\u8fc7\u7a0b\u7ee7\u7eed\uff1b\u5982\u679c\u4e0d\u4e00\u81f4\uff0c\u5219\u4ece\u8282\u70b9\u65ad\u5f00 socket \u8fde\u63a5\uff0c\u5e76\u91cd\u8fde\u3002</p>"},{"location":"redis/01.redis%E7%AE%80%E4%BB%8B/#redis-cluster","title":"redis-cluster \u6559\u7a0b","text":"<p>Redis\u96c6\u7fa4\u63d0\u4f9b\u4e00\u79cd\u65b9\u5f0f\u81ea\u52a8\u5c06\u6570\u636e\u5206\u5e03\u5728\u591a\u4e2aRedis\u8282\u70b9\u4e0a\u3002</p> <p>Redis Cluster provides a way to run a Redis installation where data is automatically sharded across multiple Redis nodes.</p> <p>Redis\u96c6\u7fa4\u662f\u4e00\u4e2adistribute\u3001fault-tolerant\u7684Redis\u5b9e\u73b0\uff0c\u4e3b\u8981\u8bbe\u8ba1\u76ee\u6807\u662f\u8fbe\u5230\u7ebf\u6027\u53ef\u6269\u5c55\u6027\u3001\u53ef\u7528\u6027\u3001\u6570\u636e\u4e00\u81f4\u6027\u3002</p> <ul> <li>\u7ebf\u6027\u62d3\u5c55\u2003\u5b98\u65b9\u63a8\u8350\u6700\u5927\u7684\u8282\u70b9\u6570\u91cf\u4e3a1000\uff0c\u7531\u4e8eCluster\u67b6\u6784\u4e2d\u65e0Proxy\u5c42\uff0cMaster\u4e0eSlave\u4e4b\u95f4\u4f7f\u7528\u5f02\u6b65replication\u3002</li> <li>\u6570\u636e\u4e00\u81f4\u6027\u2003\u5ba2\u6237\u7aef\u5bb9\u5fcd\u4e00\u5b9a\u7a0b\u5ea6\u7684\u6570\u636e\u4e22\u5931\uff0c\u96c6\u7fa4\u5c3d\u53ef\u80fd\u4fdd\u5b58 Client write \u64cd\u4f5c\u7684\u6570\u636e\uff0c\u4fdd\u8bc1\u6570\u636e\u4e00\u81f4\u6027\u3002</li> <li>\u53ef\u7528\u6027\u2003Redis\u96c6\u7fa4\u901a\u8fc7 partition \u6765\u63d0\u4f9b\u4e00\u5b9a\u7a0b\u5ea6\u7684\u53ef\u7528\u6027\uff0c\u5f53\u96c6\u7fa4\u4e2d\u7684\u4e00\u90e8\u5206\u8282\u70b9\u5931\u6548\u6216\u8005\u65e0\u6cd5\u8fdb\u884c\u901a\u8baf\u65f6\uff0c\u96c6\u7fa4\u4ecd\u53ef\u4ee5\u7ee7\u7eed\u63d0\u4f9b\u670d\u52a1\u3002</li> <li>\u53ea\u8981\u96c6\u7fa4\u4e2d\u5927\u591a\u6570 master \u53ef\u8fbe\u3001\u4e14\u5931\u6548\u7684 master \u81f3\u5c11\u6709\u4e00\u4e2a slave \u53ef\u8fbe\uff0c\u5373\u96c6\u7fa4\u975e Fail \u72b6\u6001\uff0c\u96c6\u7fa4\u90fd\u662f\u53ef\u7528\u7684\u3002</li> <li>Redis\u96c6\u7fa4\u7684 replicas migration \u673a\u5236\u53ef\u4ee5\u5c06\u62e5\u6709\u591a\u4e2a Slave \u7684 master\u7684\u67d0\u4e2a slave\uff0c\u8fc1\u79fb\u5230\u6ca1\u6709 slave\u7684 master\u4e0b\uff0c\u5373 slave \u5206\u5e03\u76f8\u5bf9\u5e73\u8861\uff0c\u786e\u4fdd master \u90fd\u6709\u4e00\u5b9a\u6570\u91cf\u7684 slave \u5907\u4efd\u3002</li> <li>\u5373\u5728  A (A1, A2) B ( B1 , B1)  C ( C1 , C2 ) \u8fd9\u79cd\u673a\u5236\u4e0b\u3002</li> </ul>"},{"location":"redis/01.redis%E7%AE%80%E4%BB%8B/#redis-cluster_1","title":"redis-cluster\u57fa\u672c\u8981\u6c42","text":"<ul> <li>\u5728\u6784\u5efa redis cluster \u96c6\u7fa4\u65f6\uff0c\u81f3\u5c11\u9700\u8981 3(Master)+3(Slave) \u624d\u80fd\u5efa\u7acb\u96c6\u7fa4\u3002\u5426\u5219\u4f1a\u521b\u5efa\u5931\u8d25\u3002</li> </ul> <p>Redis-Cluster \u91c7\u7528\u65e0\u4e2d\u5fc3\u7ed3\u6784\uff0c\u6bcf\u4e2a\u8282\u70b9\u4fdd\u5b58\u6570\u636e\u548c\u6574\u4e2a\u96c6\u7fa4\u72b6\u6001\uff0c\u6bcf\u4e2a\u8282\u70b9\u90fd\u548c\u5176\u4ed6\u6240\u6709\u8282\u70b9\u8fde\u63a5\u3002</p> <p>\u5e76\u4e14\uff0c\u5f53\u96c6\u7fa4\u4e2d\u5b58\u6d3b\u7684master\u8282\u70b9\u6570\u5c0f\u4e8e\u603b\u8282\u70b9\u6570\u7684\u4e00\u534a\u7684\u8bdd\uff0c\u96c6\u7fa4\u5c31\u65e0\u6cd5\u63d0\u4f9b\u670d\u52a1\u4e86\u3002</p> <ul> <li> <p>\u4e00\u822c\u53ef\u4ee5\u89c4\u5212\u4e3a\uff1a7 \u53f0\u673a\u5668\uff0c\u53ef\u4ee5\u4e09\u53f0\u4e3a master\uff0c4 \u53f0\u4e3a replica \u3002\u8fd9\u6837 7 \u53f0\u673a\u5668\u4e2d\u53ef\u4ee5\u968f\u4fbf\u6302\u6389\u4efb\u610f\u4e24\u53f0\u3002\uff08\u5fc5\u987b\u662f\u4f9d\u6b21\u6302\u6389\uff0c\u4e0d\u80fd\u540c\u65f6\u6302\uff09</p> </li> <li> <p>\u771f\u96c6\u7fa4\uff1a \u751f\u4ea7\u73af\u5883\u4e2d\u4e00\u5b9a\u8981\u51c6\u59076\u53f0\u670d\u52a1\u5668\uff0c6\u4e2a\u4e0d\u540c\u7684 ip \u5730\u5740\uff0c\u90fd\u662f\u8bbf\u95ee 637 \u7aef\u53e3\u3002\u5047\u96c6\u7fa4\uff1a\u4e00\u53f0\u670d\u52a1\u5668\u5b58\u57286\u4e2aredis\u670d\u52a1\uff0c\u4e00\u4e2aip\u5730\u5740 6\u4e2a\u4e0d\u540c\u7684\u7aef\u53e3\u3002</p> </li> </ul> <p>\u8fd9\u662f\u4e00\u4efd redis-cluster \u7684\u6559\u7a0b\uff0c\u4e0d\u4f1a\u8bb2\u89e3\u4e00\u4e9b\u590d\u6742\u7684\u5206\u5e03\u5f0f\u7cfb\u7edf\u77e5\u8bc6\uff0c\u63d0\u4f9b\u4e86\u5b89\u88c5\u642d\u5efa\u914d\u7f6e redis-cluster \u7684\u6559\u7a0b\u3002\u8fd9\u4efd\u6559\u7a0b\u4ec5\u4ec5\u662f\u4ece\u7528\u6237\u89c6\u89d2\u6765\u63cf\u8ff0 cluster \u3002</p> <p>\u5b9e\u9645\u4e0a\uff0c\u5728 redis-cluster \u4e2d\u3002</p> <ul> <li>\u5728\u591a\u4e2a\u8282\u70b9\u4e2d\u81ea\u52a8\u5206\u7247\u6570\u636e\u96c6\u7684\u80fd\u529b\u3002\u6bcf\u4e2a master \u4e0a\u653e\u4e00\u90e8\u5206\u6570\u636e\u3002</li> <li>\u5f53\u96c6\u7fa4\u4e2d\u6709\u8282\u70b9\u5931\u8054\u6216\u8005\u6545\u969c\u65f6\uff0c\u7ee7\u7eed\u63d0\u4f9b\u652f\u6301\u7684\u80fd\u529b\u3002\uff08\u9664\u975e\u8d85\u8fc7\u4e00\u534a\u7684 mater \u8282\u70b9\u6302\u6389\uff09</li> <li>redis cluster \u652f\u6491 N \u4e2a redis master node\uff0c\u6bcf\u4e2a master node \u90fd\u53ef\u4ee5\u6302\u8f7d\u591a\u4e2a slave node\u3002</li> <li>\u53ef\u4ee5\u5f88\u8f7b\u677e\u7684\u6a2a\u5411\u6269\u5bb9\u66f4\u591a master \u8282\u70b9\uff0c\u6bcf\u4e2a master \u8282\u70b9\u5c31\u80fd\u5b58\u653e\u66f4\u591a\u7684\u6570\u636e\u4e86\u3002</li> </ul>"},{"location":"redis/01.redis%E7%AE%80%E4%BB%8B/#tcp","title":"TCP\u7aef\u53e3","text":"<p>\u6bcf\u4e2a redis \u8282\u70b9\u90fd\u9700\u8981\u5f00\u653e\u4e24\u4e2a tcp \u7aef\u53e3\uff0c\u9ed8\u8ba4\u7684 6379 \u662f\u7ed9\u5ba2\u6237\u7aef\u8fde\u63a5\u4f7f\u7528\u3002</p> <p>\u7b2c\u4e8c\u4e2a\u9ad8\u7aef\u53e3\u7528\u4e8e\u96c6\u7fa4\u603b\u7ebf\uff08cluster bus\uff09\uff0c\u8fd9\u662f\u4f7f\u7528\u4e8c\u8fdb\u5236\u534f\u8bae\u8fdb\u884c\u70b9\u5bf9\u70b9\u7684\u901a\u8baf\u4fe1\u9053\u3002</p> <p>\u96c6\u7fa4\u603b\u7ebf\u7528\u4e8e\u8282\u70b9\u95f4\u7684\u6545\u969c\u68c0\u6d4b\uff0c\u914d\u7f6e\u66f4\u65b0\uff0c\u6545\u969c\u8f6c\u79fb\u6388\u6743(failover authorization)\u7b49\u3002</p> <p>\u5ba2\u6237\u7aef\u6c38\u8fdc\u4e0d\u4f1a\u4e0e\u96c6\u7fa4\u603b\u7ebf\u7aef\u53e3\u901a\u8baf\u3002\u800c\u662f\u5e94\u8be5\u4f7f\u7528\u666e\u901a\u7684\u547d\u4ee4\u7aef\u53e3\u3002\uff08\u4f46\u662f\u8981\u6ce8\u610f\u5728\u9632\u706b\u5899\u4e2d\u6253\u5f00\u96c6\u7fa4\u95f4\u7684\u603b\u7ebf\u7aef\u53e3\uff09</p> <ul> <li> <p>\u96c6\u7fa4\u603b\u7ebf\u7aef\u53e3\u548c\u547d\u4ee4\u7aef\u53e3\u7684\u504f\u79fb\u91cf\u59cb\u7ec8\u662f\u56fa\u5b9a\u7684\u3002\u503c\u4e3a 10000 \uff08\u4e5f\u5c31\u662f\u8bf4\u5ba2\u6237\u7aef\u7aef\u53e3\u662f 6379\uff0c\u90a3\u4e48\u603b\u7ebf\u7aef\u53e3\u5c31\u662f 16379\uff09</p> </li> <li> <p>cluster bus \u7528\u4e86\u53e6\u5916\u4e00\u79cd\u4e8c\u8fdb\u5236\u7684\u534f\u8bae\uff0cgossip \u534f\u8bae\uff0c\u7528\u4e8e\u8282\u70b9\u95f4\u8fdb\u884c\u9ad8\u6548\u7684\u6570\u636e\u4ea4\u6362\uff0c\u5360\u7528\u66f4\u5c11\u7684\u7f51\u7edc\u5e26\u5bbd\u548c\u5904\u7406\u65f6\u95f4\u3002</p> </li> </ul>"},{"location":"redis/01.redis%E7%AE%80%E4%BB%8B/#redis-sharding","title":"Redis\u96c6\u7fa4\u6570\u636e\u5206\u7247-sharding","text":"<p>https://www.cnblogs.com/zhusihua/p/11328042.html</p> <p>https://www.huaweicloud.com/articles/38e2316d01880fdbdd63d62aa26b31b4.html</p> <p>redis \u96c6\u7fa4\u6ca1\u6709\u4f7f\u7528**\u4e00\u81f4\u6027\u54c8\u5e0c**\u3002\u5b83\u7528\u4e00\u79cd\u4e0d\u540c\u7684\u5206\u7247\u5f62\u5f0f\uff0c\u5728\u8fd9\u79cd\u5f62\u5f0f\u4e2d\uff0c\u6bcf\u4e2a key \u90fd\u662f\u4e00\u4e2a\u6982\u5ff5\u6027\uff08hash slot\uff09\u7684\u4e00\u90e8\u5206\u3002\u4e2d\u6587\u4e5f\u53eb**\u54c8\u5e0c\u69fd** \u3002</p> <p>Redis \u96c6\u7fa4\u4e2d\u9ed8\u8ba4\u5206\u914d\u4e86 16384 \u4e2a hash slots\uff0c\u5f53\u6211\u4eec set \u4e00\u4e2akey \u65f6\uff0c\u4f1a\u5bf9 key \u7528<code>CRC16</code>\u7b97\u6cd5\u6765\u53d6\u6a21\u5f97\u5230\u6240\u5c5e\u7684<code>slot</code>\uff0c\u7136\u540e\u5c06\u8fd9\u4e2a key \u5206\u5230\u54c8\u5e0c\u69fd\u533a\u95f4\u7684\u8282\u70b9\u4e0a\u3002</p> <p>\u4e3a\u4e86\u8ba1\u7b97\u7ed9\u5b9a\u7684 key \u5e94\u8be5\u5728\u54ea\u4e2a hash slot \u4e0a\uff0c\u6211\u4eec\u7b80\u5355\u5730\u7528\u8fd9\u4e2a key \u7684 CRC16 \u503c\u6765\u5bf9 16384 \u53d6\u6a21\u3002</p> <p>\uff08\u5373\uff1akey \u7684 CRC16  %  16384\uff09</p> <p>Redis\u96c6\u7fa4\u4e2d\u7684\u6bcf\u4e2a\u8282\u70b9\u8d1f\u8d23\u4e00\u90e8\u5206 hash slots\uff0c\u5047\u8bbe\u4f60\u7684\u96c6\u7fa4\u67093\u4e2a\u8282\u70b9\uff0c\u90a3\u4e48\uff1a</p> <ul> <li>Node A contains hash slots from 0 to 5500</li> <li>Node B contains hash slots from 5501 to 11000</li> <li>Node C contains hash slots from 11001 to 16383</li> </ul> <p>\u5728\u6784\u5efa redis cluster \u96c6\u7fa4\u65f6\uff0cmaster \u5fc5\u987b\u5927\u4e8e\u7b49\u4e8e3\uff0c\u5426\u5219\u4f1a\u521b\u5efa\u5931\u8d25\u3002</p> <p>\u5e76\u4e14\uff0c\u5f53\u96c6\u7fa4\u4e2d\u5b58\u6d3b\u7684 master \u8282\u70b9\u6570\u5c0f\u4e8e\u603b\u8282\u70b9\u6570\u7684\u4e00\u534a\u7684\u8bdd\uff0c\u96c6\u7fa4\u5c31\u65e0\u6cd5\u63d0\u4f9b\u670d\u52a1\u4e86\u3002</p> <p>redis cluster \u8fd8\u5141\u8bb8\u968f\u65f6\u6dfb\u52a0\u548c\u5220\u9664\u96c6\u7fa4\u8282\u70b9\u3002\u6bd4\u5982\uff0c\u5982\u679c\u4f60\u60f3\u589e\u52a0\u4e00\u4e2a\u65b0\u7684\u8282\u70b9 D\uff0c\u90a3\u4e48\u5c31\u9700\u8981\u4ece A\u3001B\u3001C \u8282\u70b9\u4e0a\u5220\u9664\u4e00\u4e9b hash slot \u7ed9\u5230 D\u3002</p> <p>\u540c\u6837\u5730\uff0c\u5982\u679c\u4f60\u60f3\u4ece\u96c6\u7fa4\u4e2d\u5220\u9664\u8282\u70b9 A\uff0c\u90a3\u4e48\u4f1a\u5c06 A \u4e0a\u9762\u7684 hash slots \u79fb\u52a8\u5230 B \u548c C\uff0c\u5f53\u8282\u70b9 A \u4e0a\u662f\u7a7a\u7684\u65f6\u5019\u5c31\u53ef\u4ee5\u5c06\u5176\u4ece\u96c6\u7fa4\u4e2d\u5b8c\u5168\u5220\u9664\u3002</p> <p>\u56e0\u4e3a\u5c06 hash slots \u4ece\u4e00\u4e2a\u8282\u70b9\u79fb\u52a8\u5230\u53e6\u4e00\u4e2a\u8282\u70b9\u5e76\u4e0d\u9700\u8981\u505c\u6b62\u5176\u5b83\u7684\u64cd\u4f5c\u3002</p> <p>\u6dfb\u52a0\u3001\u5220\u9664\u8282\u70b9\u3001\u66f4\u6539\u8282\u70b9\u6240\u7ef4\u62a4\u7684 hash slots \u7684\u767e\u5206\u6bd4 \u90fd\u4e0d\u9700\u8981\u4efb\u4f55\u505c\u673a\u65f6\u95f4\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c\u79fb\u52a8 hash slots \u662f\u5e76\u884c\u7684\uff0c\u79fb\u52a8 hash slots \u4e0d\u4f1a\u5f71\u54cd\u5176\u5b83\u64cd\u4f5c\u3002</p> <p>Redis\u652f\u6301\u591a\u4e2a key \u64cd\u4f5c\uff0c\u53ea\u8981\u8fd9\u4e9bkey\u5728\u4e00\u4e2a\u5355\u4e2a\u547d\u4ee4\u4e2d\u6267\u884c\uff08\u6216\u8005\u4e00\u4e2a\u4e8b\u52a1\uff0c\u6216\u8005Lua\u811a\u672c\u6267\u884c\uff09\uff0c\u90a3\u4e48\u5b83\u4eec\u5c31\u5c5e\u4e8e\u76f8\u540c\u7684 hash slot\u3002</p> <p>\u4f60\u4e5f\u53ef\u4ee5\u7528 hash tags \u4fe9\u5f3a\u5236\u591a\u4e2akey\u90fd\u5728\u76f8\u540c\u7684 hash slot \u4e2d\u3002</p>"},{"location":"redis/01.redis%E7%AE%80%E4%BB%8B/#redis-cluster_2","title":"redis-cluster \u4e3b\u4ece\u6a21\u578b","text":"<p>\u5f53\u90e8\u5206 master \u8282\u70b9\u6302\u6389\uff0c\u6216\u8005\u4e0d\u80fd\u591f\u548c\u5927\u591a\u6570\u8282\u70b9\u901a\u4fe1\u7684\u65f6\u5019\uff0c\u4e3a\u4e86\u4fdd\u6301\u53ef\u7528\uff0cRedis \u96c6\u7fa4\u4f7f\u7528 master-slave \u6a21\u578b\u3002</p> <p>\u8fd9\u6837\u7684\u8bdd\u6bcf\u4e2a hash slot \u5c31\u6709 1 \u5230 N \u4e2a\u526f\u672c\u3002</p> <p>\u5728\u6211\u4eec\u7684\u4f8b\u5b50\u4e2d\uff0c\u96c6\u7fa4\u6709 A\u3001B\u3001C \u4e09\u4e2a\u8282\u70b9\uff0c\u5982\u679c\u8282\u70b9 B \u6302\u4e86\uff0c\u90a3\u4e48 5501-11000 \u4e4b\u95f4\u7684 hash slot \u5c06\u65e0\u6cd5\u63d0\u4f9b\u670d\u52a1\u3002</p> <p>\u7136\u800c\uff0c\u5f53\u6211\u4eec\u7ed9\u6bcf\u4e2a master \u8282\u70b9\u6dfb\u52a0\u4e00\u4e2a slave \u8282\u70b9\u4ee5\u540e\uff0c\u6211\u4eec\u7684\u96c6\u7fa4\u6700\u7ec8\u4f1a\u53d8\u6210\u7531 A\u3001B\u3001C \u4e09\u4e2a master \u8282\u70b9\u548c A1\u3001B1\u3001C1 \u4e09\u4e2a slave \u8282\u70b9\u7ec4\u6210\u3002</p> <p>\u8282\u70b9 B1 \u662f B \u7684\u526f\u672c\uff0c\u5982\u679c B \u5931\u8d25\u4e86\uff0c\u96c6\u7fa4\u4f1a\u5c06 B1 \u63d0\u5347\u4e3a\u65b0\u7684 master\uff0c\u4ece\u800c\u7ee7\u7eed\u63d0\u4f9b\u670d\u52a1\u3002\u7136\u800c\uff0c\u5982\u679c B \u548c B1 \u540c\u65f6\u6302\u4e86\uff0c\u90a3\u4e48\u6574\u4e2a\u96c6\u7fa4\u5c06\u4e0d\u53ef\u7528\u3002</p>"},{"location":"redis/01.redis%E7%AE%80%E4%BB%8B/#redis_10","title":"redis\u96c6\u7fa4\u4e00\u81f4\u6027\u4fdd\u8bc1","text":"<p>Redis\u96c6\u7fa4\u4e0d\u80fd\u4fdd\u8bc1\u5f3a\u4e00\u81f4\u6027\u3002\u6362\u53e5\u8bdd\u8bf4\uff0cRedis\u96c6\u7fa4\u53ef\u80fd\u4f1a\u4e22\u5931\u4e00\u4e9b\u5199\u64cd\u4f5c\u3002</p> <p>Redis\u96c6\u7fa4\u53ef\u80fd\u4e22\u5931\u5199\u7684\u7b2c\u4e00\u4e2a\u539f\u56e0\u662f\u56e0\u4e3a\u5b83\u7528\u5f02\u6b65\u590d\u5236\u3002</p> <p>\u5199\u53ef\u80fd\u662f\u8fd9\u6837\u53d1\u751f\u7684\uff1a</p> <ul> <li>\u5ba2\u6237\u7aef\u5199\u5230 master B</li> <li>master B \u8fd4\u56de\u5ba2\u6237\u7aefOK</li> <li>master B \u5c06\u8fd9\u4e2a\u5199\u64cd\u4f5c\u5e7f\u64ad\u7ed9\u5b83\u7684 slaves B1\u3001B2\u3001B3</li> </ul> <p>\u6b63\u5982\u4f60\u770b\u5230\u7684\u90a3\u6837\uff0cB \u6ca1\u6709\u7b49\u5230 B1\u3001B2\u3001B3 \u786e\u8ba4\u5c31\u56de\u590d\u5ba2\u6237\u7aef\u4e86\uff0c\u4e5f\u5c31\u662f\u8bf4\uff0cB \u5728\u56de\u590d\u5ba2\u6237\u7aef\u4e4b\u524d\u6ca1\u6709\u7b49\u5f85 B1\u3001B2\u3001B3 \u7684\u786e\u8ba4\uff0c</p> <p>\u8fd9\u5bf9\u5e94Redis\u6765\u8bf4\u662f\u4e00\u4e2a\u6f5c\u5728\u7684\u98ce\u9669\u3002\u6240\u4ee5\uff0c\u5982\u679c\u5ba2\u6237\u7aef\u5199\u4e86\u4e00\u4e9b\u4e1c\u897f\uff0cB \u4e5f\u786e\u8ba4\u4e86\u8fd9\u4e2a\u5199\u64cd\u4f5c\uff0c\u4f46\u662f\u5728\u5b83\u5c06\u8fd9\u4e2a\u5199\u64cd\u4f5c\u53d1\u7ed9\u5b83\u7684 slaves \u4e4b\u524d\u5b83\u5b95\u673a\u4e86\uff0c</p> <p>\u968f\u540e\u5176\u4e2d\u4e00\u4e2aslave\uff08\u6ca1\u6709\u6536\u5230\u8fd9\u4e2a\u5199\u547d\u4ee4\uff09\u53ef\u80fd\u88ab\u63d0\u5347\u4e3a\u65b0\u7684master\uff0c\u4e8e\u662f\u8fd9\u4e2a\u5199\u64cd\u4f5c\u5c31\u6c38\u8fdc\u4e22\u5931\u4e86\u3002</p> <p>\u8fd9\u548c\u5927\u591a\u6570\u7684\u5173\u7cfb\u578b\u6570\u636e\u5e93\u914d\u7f6e\u4e3a\u6bcf\u79d2\u5237\u65b0\u4e00\u6b21\u6570\u636e\u5230\u78c1\u76d8\u7684\u60c5\u51b5\u662f\u4e00\u6837\u7684\u3002\u4f60\u53ef\u4ee5\u901a\u8fc7\u5f3a\u5236\u6570\u636e\u5e93\u5728\u8fd4\u56de\u5ba2\u6237\u7aef\u4e4b\u524d\u5148\u5237\u65b0\u6570\u636e\u3002</p> <p>\u4f46\u662f\u8fd9\u6837\u505a\u7684\u7ed3\u679c\u4f1a\u5bfc\u81f4\u6027\u80fd\u5f88\u4f4e\uff0c\u8fd9\u5c31\u76f8\u5f53\u4e8e\u540c\u6b65\u590d\u5236\u4e86\u3002</p> <p>\u57fa\u672c\u4e0a\uff0c\u8fd8\u662f\u9700\u8981\u5728\u6027\u80fd\u548c\u4e00\u81f4\u6027\u4e4b\u95f4\u505a\u4e00\u4e2a\u6743\u8861\u3002</p> <p>Basically, there is a trade-off to be made between performance and consistency.</p> <p>\u5f53\u9700\u8981\u4e00\u81f4\u6027\u65f6\uff0credis-cluster \u4e5f\u662f\u652f\u6301\u540c\u6b65\u5199\u7684\u3002\u901a\u8fc7 <code>WAIT</code> \u547d\u4ee4\u3002</p> <p>\u7136\u800c\uff0c\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0cRedis\u96c6\u7fa4\u6ca1\u6709\u5b9e\u73b0\u5f3a\u4e00\u81f4\u6027\uff0c\u5373\u4f7f\u7528\u540c\u6b65\u590d\u5236\uff0c\u56e0\u4e3a\u603b\u662f\u6709\u66f4\u590d\u6742\u7684\u5931\u8d25\u573a\u666f\u4f7f\u5f97\u4e00\u4e2a\u6ca1\u6709\u63a5\u53d7\u5230\u8fd9\u4e2a\u5199\u64cd\u4f5c\u7684 slave \u5f53\u9009\u4e3a\u65b0\u7684 master\u3002</p> <p>\u5728  A,B,C,A1,B1,C1 \u7684\u573a\u666f\u4e2d\uff0c Z \u662f\u5ba2\u6237\u7aef\uff0c\u5f53\u53d1\u751f\u7f51\u7edc\u95ee\u9898\u65f6\uff0cA, C, A1, B1, C1 \u5728\u4e00\u4e2a\u7f51\u7edc\u5206\u533a\uff0cZ\u548cB\u5728\u4e00\u4e2a\u7f51\u7edc\u5206\u533a\u3002</p> <p>Z \u4ecd\u7136\u53ef\u4ee5\u5411 B \u5199\u5165\uff0c\u5982\u679c\u5f88\u5feb\u7f51\u7edc\u597d\u4e86\uff0c\u96c6\u7fa4\u6062\u590d\uff0c\u4e00\u5207\u6b63\u5e38\u3002</p> <p>\u5982\u679c\u7f51\u7edc\u5206\u533a\u6301\u7eed\u8f83\u957f\u65f6\u95f4\uff0c\u8fd9\u65f6\u5019Z1\u5f80B\u4e2d\u5199\u6570\u636e\uff0c\u4e8e\u6b64\u540c\u65f6\u53e6\u4e00\u8fb9\uff08\u5373A\u3001C\u3001A1\u3001B1\u3001C1\uff09\u8ba4\u4e3aB\u5df2\u7ecf\u6302\u4e86\uff0c\u4e8e\u662f\u5c06B1\u63d0\u5347\u4e3amaster\uff0c\u5f53\u5206\u533a\u6062\u590d\u7684\u65f6\u5019\uff0c\u7531\u4e8eB1\u53d8\u6210\u4e86master\uff0c\u6240\u4ee5B\u5c31\u6210\u4e86slave\uff0c\u4e8e\u662fB\u5c31\u8981\u4e22\u5f03\u5b83\u81ea\u5df1\u539f\u6709\u7684\u6570\u636e\u800c\u4eceB1\u90a3\u91cc\u540c\u6b65\u6570\u636e\uff0c\u4e8e\u662f\u4e4e\u5148\u53bbZ1\u5199\u5230B\u7684\u6570\u636e\u5c31\u4e22\u5931\u4e86\u3002</p> <p>\u6ce8\u610f\uff0c\u6709\u4e00\u4e2a\u6700\u5927\u7a97\u53e3\uff0c\u8fd9\u662fZ1\u80fd\u591f\u5411B\u5199\u7684\u6700\u5927\u6570\u91cf\uff1a\u5982\u679c\u65f6\u95f4\u8db3\u591f\u7684\u8bdd\uff0c\u5206\u533a\u7684\u591a\u6570\u7684\u90a3\u4e00\u8fb9\u5df2\u7ecf\u9009\u4e3e\u5b8c\u6210\uff0c\u9009\u62e9\u4e00\u4e2aslave\u6210\u4e3amaster\uff0c\u6b64\u65f6\uff0c\u6240\u6709\u5728\u5c11\u6570\u7684\u90a3\u4e00\u8fb9\u7684master\u8282\u70b9\u5c06\u505c\u6b62\u63a5\u53d7\u5199\u3002</p> <p>\u4e5f\u5c31\u662f\u8bf4\uff0c\u6709\u4e00\u4e2a\u6700\u5927\u7a97\u53e3\u7684\u8bbe\u7f6e\u9879\uff0c\u5b83\u51b3\u5b9a\u4e86Z1\u5728\u90a3\u79cd\u60c5\u51b5\u4e0b\u80fd\u591f\u5411B\u53d1\u9001\u591a\u6570\u5199\u64cd\u4f5c\uff1a\u5982\u679c\u5206\u9694\u7684\u65f6\u95f4\u8db3\u591f\u957f\uff0c\u591a\u6570\u7684\u90a3\u8fb9\u5df2\u7ecf\u9009\u4e3eslave\u6210\u4e3a\u65b0\u7684master\uff0c\u6b64\u540e\u5c11\u6570\u90a3\u8fb9\u7684\u6240\u6709master\u8282\u70b9\u5c06\u4e0d\u518d\u63a5\u53d7\u5199\u64cd\u4f5c\u3002</p> <p>\u5728Redis\u96c6\u7fa4\u4e2d\uff0c\u8fd9\u4e2a\u65f6\u95f4\u6570\u91cf\u662f\u4e00\u4e2a\u975e\u5e38\u91cd\u8981\u7684\u914d\u7f6e\u6307\u4ee4\uff0c\u5b83\u88ab\u79f0\u4e3anode timeout\u3002\u5728\u8d85\u8fc7 node timeout \u4ee5\u540e\uff0c\u4e00\u4e2a master \u8282\u70b9\u88ab\u8ba4\u4e3a\u5df2\u7ecf\u5931\u8d25\u4e86\uff0c\u5e76\u4e14\u9009\u62e9\u5b83\u7684\u4e00\u4e2a\u526f\u672c\u63a5\u66ff master\u3002</p> <p>\u7c7b\u4f3c\u5730\uff0c\u5982\u679c\u5728\u8fc7\u4e86node timeout\u65f6\u95f4\u4ee5\u540e\uff0c\u6ca1\u6709\u4e00\u4e2amaster\u80fd\u591f\u548c\u5176\u5b83\u5927\u591a\u6570\u7684master\u901a\u4fe1\uff0c\u90a3\u4e48\u6574\u4e2a\u96c6\u7fa4\u90fd\u5c06\u505c\u6b62\u63a5\u53d7\u5199\u64cd\u4f5c\u3002</p>"},{"location":"redis/01.redis%E7%AE%80%E4%BB%8B/#redis_11","title":"redis\u96c6\u7fa4\u914d\u7f6e\u53c2\u6570","text":"<pre><code>cluster-enabled  &lt;yes/no&gt;: \u5982\u679c\u662fyes\uff0c\u8868\u793a\u542f\u7528\u96c6\u7fa4\uff0c\u5426\u5219\u4ee5\u5355\u4f8b\u6a21\u5f0f\u542f\u52a8\ncluster-config-file &lt;filename&gt;: \u53ef\u9009\uff0c\u8fd9\u4e0d\u662f\u4e00\u4e2a\u7528\u6237\u53ef\u7f16\u8f91\u7684\u914d\u7f6e\u6587\u4ef6\uff0c\u8fd9\u4e2a\u6587\u4ef6\u662fRedis\u96c6\u7fa4\u8282\u70b9\u81ea\u52a8\u6301\u4e45\u5316\u6bcf\u6b21\u914d\u7f6e\u7684\u6539\u53d8\uff0c\u4e3a\u4e86\u5728\u542f\u52a8\u7684\u65f6\u5019\u91cd\u65b0\u8bfb\u53d6\u5b83\u3002\ncluster-node-timeout &lt;milliseconds&gt;: \u8d85\u65f6\u65f6\u95f4\uff0c\u96c6\u7fa4\u8282\u70b9\u4e0d\u53ef\u7528\u7684\u6700\u5927\u65f6\u95f4\u3002\u5982\u679c\u4e00\u4e2amaster\u8282\u70b9\u4e0d\u53ef\u5230\u8fbe\u8d85\u8fc7\u4e86\u6307\u5b9a\u65f6\u95f4\uff0c\u5219\u8ba4\u4e3a\u5b83\u5931\u8d25\u4e86\u3002\u6ce8\u610f\uff0c\u6bcf\u4e00\u4e2a\u5728\u6307\u5b9a\u65f6\u95f4\u5185\u4e0d\u80fd\u5230\u8fbe\u5927\u591a\u6570master\u8282\u70b9\u7684\u8282\u70b9\u5c06\u505c\u6b62\u63a5\u53d7\u67e5\u8be2\u8bf7\u6c42\u3002\ncluster-slave-validity-factor &lt;factor&gt;: \u5982\u679c\u8bbe\u7f6e\u4e3a0\uff0c\u5219\u4e00\u4e2aslave\u5c06\u603b\u662f\u5c1d\u8bd5\u6545\u969c\u8f6c\u79fb\u4e00\u4e2amaster\u3002\u5982\u679c\u8bbe\u7f6e\u4e3a\u4e00\u4e2a\u6b63\u6570\uff0c\u90a3\u4e48\u6700\u5927\u5931\u53bb\u8fde\u63a5\u7684\u65f6\u95f4\u662fnode timeout\u4e58\u4ee5\u8fd9\u4e2afactor\u3002\ncluster-migration-barrier &lt;count&gt;: \u4e00\u4e2amaster\u548cslave\u4fdd\u6301\u8fde\u63a5\u7684\u6700\u5c0f\u6570\u91cf\uff08\u5373\uff1a\u6700\u5c11\u4e0e\u591a\u5c11\u4e2aslave\u4fdd\u6301\u8fde\u63a5\uff09\uff0c\u4e5f\u5c31\u662f\u8bf4\u81f3\u5c11\u4e0e\u5176\u5b83\u591a\u5c11slave\u4fdd\u6301\u8fde\u63a5\u7684slave\u624d\u6709\u8d44\u683c\u6210\u4e3amaster\u3002\ncluster-require-full-coverage &lt;yes/no&gt;: \u5982\u679c\u8bbe\u7f6e\u4e3ayes\uff0c\u8fd9\u4e5f\u662f\u9ed8\u8ba4\u503c\uff0c\u5982\u679ckey space\u6ca1\u6709\u8fbe\u5230\u767e\u5206\u4e4b\u591a\u5c11\u65f6\u505c\u6b62\u63a5\u53d7\u5199\u8bf7\u6c42\u3002\u5982\u679c\u8bbe\u7f6e\u4e3ano\uff0c\u5c06\u4ecd\u7136\u63a5\u53d7\u67e5\u8be2\u8bf7\u6c42\uff0c\u5373\u4f7f\u5b83\u53ea\u662f\u8bf7\u6c42\u90e8\u5206key\u3002\n</code></pre>"},{"location":"redis/01.redis%E7%AE%80%E4%BB%8B/#redis_12","title":"\u521b\u5efa\u5e76\u4f7f\u7528 redis \u96c6\u7fa4","text":"<p>\u4e3a\u4e86\u521b\u5efa redis \u96c6\u7fa4\uff0c\u5fc5\u987b\u8981\u5148\u542f\u52a8\u4e00\u4e9b\u4ee5 cluster mode \u6a21\u5f0f\u8fd0\u884c\u7684\u5b9e\u4f8b</p> <p>\u6700\u5c0f\u914d\u7f6e\u6587\u4ef6\u5982\u4e0b\uff1a</p> <pre><code># \u7aef\u53e3\nport 7000\n# \u5f00\u542f\u96c6\u7fa4\u6a21\u5f0f\ncluster-enabled yes\n# \u6bcf\u4e2a\u5b9e\u4f8b\u90fd\u5305\u542b\u4e00\u4e2a\u6587\u4ef6\uff0c\u8fd9\u4e2a\u6587\u4ef6\u5b58\u50a8\u8be5\u8282\u70b9\u7684\u914d\u7f6e\uff0c\u6a21\u5f0f\u662fnodes.conf\u3002\u662fRedis\u96c6\u7fa4\u5b9e\u4f8b\u542f\u52a8\u7684\u65f6\u5019\u751f\u6210\u7684\uff0c\u5e76\u4e14\u6bcf\u6b21\u5728\u9700\u8981\u7684\u65f6\u5019\u81ea\u52a8\u66f4\u65b0\u3002\ncluster-config-file nodes.conf\ncluster-node-timeout 5000\nappendonly yes\n</code></pre> <p>\u6700\u5c0f\u7684\u96c6\u7fa4\u81f3\u5c11\u9700\u89813\u4e2amaster\u8282\u70b9\u3002\u8fd9\u91cc\uff0c\u6211\u4eec\u4e3a\u4e86\u6d4b\u8bd5\uff0c\u5728\u4e00\u53f0\u673a\u5668\u4e0a\u7528\u4e09\u4e3b\u4e09\u4ece\u3002</p> <pre><code>mkdir cluster-test\ncd cluster-test\nmkdir 7000 7001 7002 7003 7004 7005\ncd 7000\n\n# \u586b\u5165\u914d\u7f6e\nvim  redis.conf\n\n# \u8bb0\u5f97\u4fee\u6539\u7aef\u53e3\ncp 7000/redis.conf 7001/\ncp 7000/redis.conf 7002/\ncp 7000/redis.conf 7003/\ncp 7000/redis.conf 7004/\ncp 7000/redis.conf 7005/\n\n# \u4f20\u5165redis-server\u4e8c\u8fdb\u5236\u6587\u4ef6\n\n# \u6253\u5f00\u591a\u4e2a\u7ec8\u7aef\uff0c\u4f9d\u6b21\u542f\u52a8\u591a\u4e2a\u5b9e\u4f8b\n\ncd 7000\n./redis-server 7000/redis.conf\n\ncd 7001\n./redis-server 7001/redis.conf \n\ncd 7002\n./redis-server 7002/redis.conf \n\ncd 7003\n./redis-server 7003/redis.conf \n\ncd 7004\n./redis-server 7004/redis.conf\n</code></pre> <p>\u6bcf\u4e2aRedis\u5b9e\u4f8b\u90fd\u6709\u4e00\u4e2aID\uff0c\u8fd9\u662f\u5b9e\u4f8b\u5728\u96c6\u7fa4\u4e0a\u4e0b\u6587\u4e2d\u7684\u552f\u4e00\u6807\u8bc6\u3002\u5728\u8282\u70b9\u7684\u6574\u4e2a\u751f\u547d\u5468\u671f\u4e2d\u8fd9\u4e2a\u552f\u4e00\u7684ID\u662f\u4e0d\u4f1a\u53d8\u7684\uff0c\u6211\u4eec\u628a\u5b83\u53eb\u505a**Node ID**</p> <p>\u6bcf\u4e2a\u8282\u70b9\u5185\u90e8\uff0c\u90fd\u662f\u901a\u8fc7 Node ID \u6765\u8bb0\u4f4f\u5176\u4ed6 node\uff0c\u800c\u4e0d\u662fIP\u548c\u7aef\u53e3\u3002</p> <p>\u521b\u5efa\u96c6\u7fa4</p> <p>\u73b0\u5728\u5df2\u7ecf\u6709\u4e00\u4e9b\u8fd0\u884c\u4e2d\u7684\u8282\u70b9\u4e86\uff0c\u9700\u8981\u521b\u5efa\u96c6\u7fa4\u3002</p> <p>redis5 \u53ef\u4ee5\u4f7f\u7528 redis-cli \u5de5\u5177\u6765\u7ba1\u7406\u96c6\u7fa4\u3002</p> <p>redis3 \u6216 redis4 \u53ef\u4ee5\u4f7f\u7528 redis-trib.rb \u8fd9\u4e2a\u5de5\u5177\u3002\u5728 redis \u6e90\u4ee3\u7801\u4e2d\u7684 src \u76ee\u5f55\u4e2d\u3002</p> <pre><code>#  redis-trib.rb\u662f\u4e00\u4e2a ruby \u8bed\u8a00\u7684\u5de5\u5177\uff0c\u6240\u4ee5\u9700\u8981\u5b89\u88c5ruby\nyum install ruby\nyum install rubygems\ngem install redis\n\n# \u5982\u679c\u63d0\u793aruby\u7248\u672c\u8fc7\u4f4e\uff0c\u53ef\u4ee5\u4f7f\u7528\u8fd9\u4e2a\nyum install -y centos-release-scl-rh rh-ruby23\nscl  enable  rh-ruby23 bash\nruby -v\n</code></pre> <pre><code># \u5728 redis5 \u4e2d\u4f7f\u7528redis-cli\u521b\u5efa\u96c6\u7fa4\nredis-cli --cluster create 127.0.0.1:7000 127.0.0.1:7001 \\\n127.0.0.1:7002 127.0.0.1:7003 127.0.0.1:7004 127.0.0.1:7005 \\\n--cluster-replicas 1\n\n\n\n# \u5728 redis3\u6216redis4 \u4e2d\u4f7f\u7528ruby\u811a\u672c\u6765\u521b\u5efa\u96c6\u7fa4\n./redis-trib.rb create --replicas 1 127.0.0.1:7000 127.0.0.1:7001 \\\n127.0.0.1:7002 127.0.0.1:7003 127.0.0.1:7004 127.0.0.1:7005\n\n\n# \u4f7f\u7528 create \u547d\u4ee4\u6765\u521b\u5efa\u96c6\u7fa4\uff0c--cluster-replicas 1 \u8fd9\u4e2a\u9009\u9879\u8868\u793a\u4e3a\u6bcf\u4e00\u4e2amaster\u90fd\u521b\u5efa\u4e00\u4e2aslave\u8282\u70b9\n# \u5269\u4e0b\u7684\u662f\u96c6\u7fa4\u4e2d\u8282\u70b9\u5b9e\u4f8b\u7684\u5730\u5740\n</code></pre> <p>\u6267\u884c\u4e0a\u8ff0\u547d\u4ee4\u4faf\uff0credis-cli \u5de5\u5177\u4f1a\u5f39\u51fa\u4ea4\u4e92\u5f0f prompt \u6765\u8ba9\u4f60\u786e\u8ba4\u4e3b\u4ece\u5173\u7cfb\uff0c\u8f93\u5165 yes \u786e\u8ba4\u5c31\u5f00\u59cb\u8fdb\u884c\u914d\u7f6e\u3002</p> <p>\u6700\u7ec8\u7684\u8f93\u51fa\u5982\u4e0b\uff1a</p> <pre><code>[OK] All 16384 slots covered\n</code></pre> <p>\u8fd9\u8868\u793a\u96c6\u7fa4\u5df2\u7ecf\u5b89\u88c5\u5b8c\u6210\u3002</p>"},{"location":"redis/01.redis%E7%AE%80%E4%BB%8B/#redis_13","title":"\u4f7f\u7528\u811a\u672c\u521b\u5efaredis\u96c6\u7fa4","text":"<p>\u5728\u751f\u4ea7\u73af\u5883\uff0c\u4e00\u822c\u90fd\u4e0d\u4f1a\u624b\u52a8\u521b\u5efa redis \u96c6\u7fa4\u5b9e\u4f8b</p> <p>\u5728 redis \u6e90\u4ee3\u7801\u7684 utils/create-cluster \u76ee\u5f55\u4e2d\uff0c\u6709\u4e00\u4e2a\u811a\u672c\u6587\u4ef6 create-cluster \uff0c\u8fd9\u662f\u4e00\u4e2a\u7b80\u5355\u7684 bash \u811a\u672c\uff0c\u53ef\u4ee5\u76f4\u63a5\u542f\u52a8\u4e09\u4e3b\u4e09\u4ece\u8282\u70b9\u7684\u96c6\u7fa4\u3002</p> <pre><code># create-cluster\u662f\u4e00\u4e2a\u5feb\u901f\u642d\u5efaredis\u96c6\u7fa4\u7684\u811a\u672c\uff0c\u8fd9\u4e2a\u811a\u672c\u4e2d\u5b9a\u4e49\u7684\u7aef\u53e3\u53f7\u662f\u4ece30000\u5f00\u59cb\n# \u4f7f\u7528\u65b9\u6cd5\uff1a\n#   1.\u7f16\u8f91\u4fee\u6539 create-cluster \u8fd9\u4e2a\u6587\u4ef6\u91cc\u9762\u7684\u7aef\u53e3\u53f7\n#   2.\u8c03\u7528 ./create-cluster start \u6765\u542f\u52a8\u5b9e\u4f8b\n#   3.\u8c03\u7528 ./create-cluster create \u6765\u521b\u5efa\u96c6\u7fa4\n#   4.\u96c6\u7fa4\u542f\u52a8\u6210\u529f\uff0c\u5728\u5f53\u524d\u76ee\u5f55\u4e0b\u4f1a\u4e3a\u6bcf\u4e2a\u5b9e\u4f8b\u751f\u6210 AOF\u6587\u4ef6\u548c\u65e5\u5fd7\u6587\u4ef6\n\n\n#   ./create-cluster stop \u505c\u6b62\u6240\u6709\u5b9e\u4f8b\uff0c\n#   ./create-cluster clean \u5220\u9664AOF\u6587\u4ef6\u548c\u65e5\u5fd7i\u6587\u4ef6\uff0c\u751f\u6210\u5e72\u51c0\u7684\u65b0\u5b9e\u4f8b\n\n\n\ncreate-cluster start\ncreate-cluster create \n</code></pre>"},{"location":"redis/01.redis%E7%AE%80%E4%BB%8B/#redis_14","title":"\u73a9\u8f6c redis \u96c6\u7fa4","text":"<p>\u8fd9\u4e2a\u9636\u6bb5\uff0c\u7f3a\u5c11\u7684\u662f redis \u5ba2\u6237\u7aef\u5e93\u7684\u5b9e\u73b0\u3002</p> <ul> <li>redis-rb-cluster  \u662f\u4e00\u4e2a ruby \u5b9e\u73b0\u7684\u811a\u672c\uff0c\u5b83\u662f\u5bf9\u539f\u751f\u7684  redis-rb \u7684\u5c01\u88c5\u3002https://github.com/antirez/redis-rb-cluster</li> <li>preids \u662f\u4e00\u4e2a\u5f88\u597d\u7684\u652f\u6301 php7.2 \u53ca\u4ee5\u4e0a\u7684 reids \u5ba2\u6237\u7aef\u5e93\u3002</li> <li>predis \u9ed8\u8ba4\u4e0d\u9700\u8981\u4efb\u4f55C\u6269\u5c55\u3002\u53ef\u4ee5\u8ddf phpiredis \u4e00\u8d77</li> </ul> <p>\u4f7f\u7528\u547d\u4ee4\u884c\u6765\u8fde\u63a5 redis \u96c6\u7fa4</p> <pre><code># -c \u5141\u8bb8\u96c6\u7fa4\u6a21\u5f0f  -p \u7aef\u53e3\n$ redis-cli -c -p 7000\nredis 127.0.0.1:7000&gt; set foo bar\n-&gt; Redirected to slot [12182] located at 127.0.0.1:7002\nOK\nredis 127.0.0.1:7002&gt; set hello world\n-&gt; Redirected to slot [866] located at 127.0.0.1:7000\nOK\nredis 127.0.0.1:7000&gt; get foo\n-&gt; Redirected to slot [12182] located at 127.0.0.1:7002\n\"bar\"\nredis 127.0.0.1:7000&gt; get hello\n-&gt; Redirected to slot [866] located at 127.0.0.1:7000\n\"world\"\n\n# \u5982\u679c\u6ca1\u6709\u4fee\u6539\u7aef\u53e3\uff0c\u5b9e\u9645\u53ef\u80fd\u662f\u4ece 30001 \u5f00\u59cb\n\n# \u7531\u4e8e redis-cli \u662f\u5f88\u57fa\u7840\u7684\u5de5\u5177\uff0c\u6240\u4ee5 set key \u76f4\u63a5\u91cd\u5b9a\u5411\u5206\u4e0d\u5230\u4e0d\u540c\u7684\u540e\u7aef\u8282\u70b9\u4e0a\u3002\n# \u5b9e\u9645\u4e0a\uff0c\u5bf9\u4e8e\u4e00\u4e9b\u5ba2\u6237\u7aef\u8fde\u63a5\u6765\u8bf4\uff0c\u5176\u5b9e\u4f1a\u5728hash slots\u95f4\u548c\u8282\u70b9\u95f4\u7f13\u5b58 map\u3002\n# \u53ea\u6709\u5728 cluster \u914d\u7f6e\u53d8\u66f4\u3002\u4f8b\u5982\u53d1\u751f\u6545\u969c\u5207\u6362\uff0c\u4ee5\u53ca\u65b0\u589e\u5220\u9664\u8282\u70b9\u8c03\u6574cluster\u67b6\u6784\u65f6\uff0cmap\u624d\u4f1a\u88ab\u5237\u65b0\u3002\n</code></pre>"},{"location":"redis/01.redis%E7%AE%80%E4%BB%8B/#redis-rb-cluster-redis-cluster","title":"\u4f7f\u7528 redis-rb-cluster \u8fde\u63a5 redis-cluster","text":"<p>\u5728\u5bf9 redis-cluster \u7ba1\u7406\u4e4b\u524d\uff0c\u4f7f\u7528 ruby \u642d\u5efa\u4e00\u4e2a demo \u73af\u5883\u6765\u8fde redis-cluster \u6765\u6f14\u793a redis-cluster \u7684\u6545\u969c\u5207\u6362\uff0c\u914d\u7f6e\u66f4\u65b0\u7b49\u3002</p> <p>https://github.com/antirez/redis-rb-cluster</p>"},{"location":"redis/01.redis%E7%AE%80%E4%BB%8B/#_12","title":"\u96c6\u7fa4\u5206\u7247","text":"<p>\u5206\u5e03\u5f0f\u7cfb\u7edf\u7684\u6570\u636e\u5206\u7247\uff0c\u53ef\u4ee5\u770b\u8fd9\u7bc7\u6587\u7ae0 https://www.cnblogs.com/xybaby/p/7076731.html</p> <p>redis \u96c6\u7fa4\u662f\u901a\u8fc7\u5206\u7247\uff08shard\uff09\u65b9\u5f0f\uff0c \u5c06\u4e00\u4e2a\u6570\u636e\u5e93\u5212\u5206\u4e3a\u591a\u4e2a\u90e8\u5206\uff0c \u5e76\u5c06\u4e0d\u540c\u90e8\u5206\u4ea4\u7ed9\u96c6\u7fa4\u4e2d\u7684\u4e0d\u540c\u670d\u52a1\u5668\u6765\u5904\u7406\uff0c \u4ece\u800c\u8fbe\u5230\u6269\u5c55\u6027\u80fd\u7684\u76ee\u7684\u3002</p> <p>\u5206\u7247\u540e\uff0credis \u96c6\u7fa4\u6709 16384\u4e2a \u54c8\u5e0c\u69fd\uff0c\u6bcf\u4e2a key \u901a\u8fc7CRC16 \u6821\u9a8c\u540e\u5bf9 16384 \u53d6\u6a21\u6765\u51b3\u5b9a\u653e\u7f6e\u54ea\u4e2a\u69fd\uff0c\u96c6\u7fa4\u7684\u6bcf\u4e2a\u8282\u70b9\u8d1f\u8d23\u4e00\u90e8\u5206 hash \u69fd\u3002</p> <p>\u6570\u636e\u5e93\u4e2d\u7684\u6bcf\u4e2a\u952e\u90fd\u5c5e\u4e8e\u8fd9 16384 \u4e2a\u69fd\u7684\u5176\u4e2d\u4e00\u4e2a\uff0c\u96c6\u7fa4\u4e2d\u7684\u6bcf\u4e2a\u8282\u70b9\u53ef\u4ee5\u5904\u7406 0 \u4e2a\u6216\u8005\u6700\u591a 16384 \u4e2a\u69fd\u3002</p> <p>\u4e3a\u4ec0\u4e48\u96c6\u7fa4\u4e2d\u53ea\u80fd\u6709 16384 \u4e2a\u69fd\uff1f</p> <p>https://github.com/redis/redis/issues/2576</p> <p>\u96c6\u7fa4\u6700\u4e3b\u8981\u7684\uff0c\u89e3\u51b3\u7684\u662f\u4e00\u4e2a\u201c\u6570\u636e\u5206\u7247\u201d\u7684\u95ee\u9898\uff0c\u5b83\u80fd\u628a redis \u7684\u6570\u636e\u5206\u6563\u5230\u4e0d\u540c\u7684 slot \u91cc\uff0c\u800c\u4e0d\u662f\u90fd\u96c6\u4e2d\u5728\u4e00\u53f0\u673a\u5668\u7684\u5185\u5b58\u91cc\u3002\u8fd9\u6837\u4e5f\u5c31\u7ed9\u5355\u8fdb\u7a0b\u5355\u7ebf\u7a0b\u3001\u7eaf\u5185\u5b58\u7684 redis \u63d0\u4f9b\u4e86\u6c34\u5e73\u6269\u5bb9\u7684\u80fd\u529b\u3002</p> <p>\u4f46\u662f\u8fd9\u662f\u6709\u4ee3\u4ef7\u7684\uff0c \u4e00\u90e8\u5206\u547d\u4ee4\u65e0\u6cd5\u8de8\u8282\u70b9\u6267\u884c\uff0c\u6bd4\u5982 zunionstore \u7b49\u4e00\u4e9b\u547d\u4ee4\uff0c\u5b83\u6d89\u53ca\u591a\u4e2a key\uff0c\u56e0\u6b64\u5728\u96c6\u7fa4\u72b6\u6001\u4e0b\uff0c\u9700\u8981\u81ea\u884c\u4fdd\u8bc1\u8fd9\u4e9b key \u90fd\u5728\u4e00\u4e2a slot \u4e0a\uff1b</p> <p>\u518d\u6bd4\u5982 watch exec\uff0c \u5728\u5355\u8282\u70b9\u6216\u54e8\u5175\u573a\u666f\u4e0b\u53ef\u4ee5\u7528\uff0c\u4f46\u96c6\u7fa4\u6a21\u5f0f\u4e0b\u662f\u4e0d\u80fd\u4f7f\u7528\u7684\u3002\u8fd8\u6709\u4e00\u4e9b\u547d\u4ee4\uff0c\u5728\u96c6\u7fa4\u72b6\u6001\u4e0b\u867d\u80fd\u6267\u884c\u6216\u6709\u66ff\u4ee3\u65b9\u6848\uff0c\u4f46\u4f1a\u4e27\u5931\u539f\u5b50\u6027\u3002 \u6bd4\u5982 mget \u7b49\u3002</p> <p>redis cluster \u5e76\u6ca1\u6709\u4f7f\u7528\u4e00\u81f4\u6027\u54c8\u5e0c\u6765\u8ba1\u7b97 key \u5bf9\u5e94\u7684\u8282\u70b9\uff0c\u800c\u662f\u901a\u8fc7\u8bb0\u5f55\u4e00\u5f20\u6620\u5c04\u8868 hash slots \u7684\u65b9\u5f0f\u3002\u901a\u8fc7\u5bf9 key \u8fdb\u884c\u5982\u4e0b\u7b97\u6cd5\uff0c\u6765\u786e\u8ba4 key \u6240\u5728\u8282\u70b9\u7684 slot \u3002</p> <p>```shell</p>"},{"location":"redis/01.redis%E7%AE%80%E4%BB%8B/#slotid","title":"\u8ba1\u7b97 slotid","text":"<p>slot = CRC16(key) % 16384  ```</p> <p>\u4ec5\u4ec5\u5b9a\u4f4d\u5230 slotid\uff0c\u8fd8\u9700\u8981\u901a\u8fc7 slotid \u5b9a\u4f4d\u5230 nodeid\uff0c\u5728\u96c6\u7fa4\u5185\u90e8\u901a\u8fc7\u8bb0\u5f55\u4e00\u5f20\u6620\u5c04\u8868\uff08slotId-&gt;nodeId\uff09\u7684\u65b9\u5f0f\u6765\u5b9e\u73b0\u7684\u3002\u8282\u70b9\u4e4b\u95f4\u901a\u8fc7 gossip \u534f\u8bae\u6765\u5e7f\u64ad\u8fd9\u4e2a\u5173\u7cfb\uff0c\u53ef\u4ee5\u8fc5\u901f\u6536\u655b\u3002</p> <p>\u5982\u679c\u5ba2\u6237\u7aef\u5c06\u4e0d\u5c5e\u4e8e\u8be5 node \u7684\u4e00\u4e2a slot \u8bf7\u6c42\u53d1\u9001\u5230\u8be5 node \u4e0a\uff0credis \u4f1a\u901a\u8fc7\u67e5\u8868\uff0c\u5feb\u901f\u627e\u5230\u8be5 slot \u8bf7\u6c42\u672c\u5e94\u8be5\u53bb\u7684 node\uff0c\u7136\u540e\u5411 client \u8fd4\u56de MOVED \u6d88\u606f\u3002</p> <p>\u5176\u4e2d\uff0c \u6570\u636e\u5e93\u7684\u6bcf\u4e2a\u90e8\u5206\u5c31\u662f\u4e00\u4e2a\u69fd\uff08slot\uff09\uff0c \u4e00\u4e2a\u69fd\u53ef\u4ee5\u5305\u542b\u4efb\u610f\u591a\u4e2a\u952e\uff08key\uff09\uff1b \u800c\u96c6\u7fa4\u4e2d\u7684\u6bcf\u4e2a\u670d\u52a1\u5668\u5219\u662f\u4e00\u4e2a\u8282\u70b9\uff08node\uff09\u3002</p> <p>redis cluster \u5e76\u6ca1\u6709\u4f7f\u7528\u4e00\u81f4\u6027\u54c8\u5e0c\u6765\u8ba1\u7b97 key \u5bf9\u5e94\u7684\u8282\u70b9\uff0c\u800c\u662f\u901a\u8fc7\u8bb0\u5f55\u4e00\u5f20\u6620\u5c04\u8868 hash slots \u7684\u65b9\u5f0f\u3002</p> <p>\u901a\u8fc7\u5bf9 key \u8fdb\u884c\u5982\u4e0b\u7b97\u6cd5\uff0c\u6765\u786e\u8ba4 key \u6240\u5728\u8282\u70b9\u7684 slot </p> \u69fd \u8d1f\u8d23\u7684\u8282\u70b9 0~5461 node_a 5462~10922 node_b 10923~16383 node_c <p>https://redis.io/topics/client-side-caching</p> <p>\u7136\u540e\uff0c \u6bcf\u5f53\u7528\u6237\u60f3\u8981\u8bbf\u95ee\u952e k \u65f6\uff0c \u5ba2\u6237\u7aef\u90fd\u4f1a\u901a\u8fc7\u4ee5\u4e0b\u516c\u5f0f\uff0c \u8ba1\u7b97\u51fa\u952e key \u6240\u5728\u7684\u69fd\uff1a</p> <pre><code>slot = CRC16(key) % 16384\n</code></pre> <p>\u7136\u540e\u5ba2\u6237\u7aef\u5c31\u53ef\u4ee5\u6839\u636e <code>slot</code> \u7684\u503c\u4ee5\u53ca\u69fd\u5206\u914d\u7684\u8868\u683c\uff0c \u76f4\u63a5\u5bf9\u69fd\u6240\u5728\u7684\u8282\u70b9\u8fdb\u884c\u8bbf\u95ee\uff0c \u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c \u5ba2\u6237\u7aef\u53ea\u9700\u8981\u4e00\u6b21\u8bbf\u95ee\u5c31\u53ef\u4ee5\u83b7\u53d6\u5230\u952e k \u7684\u503c\u3002</p>"},{"location":"redis/01.redis%E7%AE%80%E4%BB%8B/#reid-cluster","title":"reid-cluster \u5ba2\u6237\u7aef\u5b9e\u73b0","text":"<p>\u6309\u7167 redis \u5b98\u65b9\u89c4\u8303\uff0c\u4e00\u4e2a redis \u5ba2\u6237\u7aef\u53ef\u4ee5\u5411\u96c6\u7fa4\u4e2d\u7684\u4efb\u610f\u8282\u70b9\uff08\u5305\u62ec\u4ece\u8282\u70b9\uff09\u53d1\u9001\u547d\u4ee4\u8bf7\u6c42\u3002</p> <p>\u5355\u8282\u70b9 redis \u548c redis \u96c6\u7fa4\u7684\u5ba2\u6237\u7aef\u7684\u5b9e\u73b0\u65b9\u5f0f\u4e0d\u4e00\u6837\uff0credis\u96c6\u7fa4\u5ba2\u6237\u7aef\u7684\u5927\u81f4\u5904\u7406\u6d41\u7a0b\u5982\u4e0b:</p> <ul> <li>\u5ba2\u6237\u7aef\u521d\u59cb\u5316\uff0c\u968f\u673a\u9009\u62e9\u4e00\u4e2anode \u901a\u4fe1\uff0c\u83b7\u53d6 hashslot-&gt;node \u6620\u5c04\u8868\u548c nodes \u4fe1\u606f\uff1b</li> <li>\u5411 cluster \u4e2d\u6240\u6709 node \u5efa\u7acb\u8fde\u63a5\uff0c\u5e76\u4e3a\u6bcf\u4e2a node \u521b\u5efa\u4e00\u4e2a\u8fde\u63a5\u6c60;</li> <li>\u53d1\u9001\u8bf7\u6c42\u7684\u65f6\u5019\uff0c\u5148\u5728\u672c\u5730\u8ba1\u7b97key\u7684hashslot\uff0c\u518d\u5728\u672c\u5730\u6620\u5c04\u8868\u627e\u5230\u5bf9\u5e94node;</li> <li>\u82e5\u76ee\u6807 node \u6b63\u597d\u6301\u6709\u90a3\u4e2a hashslot \uff0c\u90a3\u4e48\u6b63\u5e38\u5904\u7406.</li> <li></li> </ul> <p>\u6bd4\u5982\u8fd9\u6837\uff1a</p> <p>\u8282\u70b9\u4f1a\u5bf9\u547d\u4ee4\u8bf7\u6c42\u8fdb\u884c\u5206\u6790\uff0c\u5982\u679c\u8be5\u547d\u4ee4\u662f\u96c6\u7fa4\u53ef\u4ee5\u6267\u884c\u7684\u547d\u4ee4\uff0c\u90a3\u4e48\u8282\u70b9\u4f1a\u67e5\u627e\u8fd9\u4e2a\u547d\u4ee4\u6240\u8981\u5904\u7406\u7684\u952e\u6240\u5728\u7684\u69fd\u3002</p> <p>\u5982\u679c\u5904\u7406\u8be5\u547d\u4ee4\u7684\u69fd\u4f4d\u4e8e\u5f53\u524d\u8282\u70b9\uff0c\u90a3\u4e48\u547d\u4ee4\u53ef\u4ee5\u987a\u5229\u6267\u884c\uff0c\u5426\u5219\u5f53\u524d\u8282\u70b9\u4f1a\u8fd4\u56de MOVED \u9519\u8bef\uff08\u91cd\u5b9a\u5411\uff09\uff0c\u8ba9\u5ba2\u6237\u7aef\u5230\u53e6\u4e00\u4e2a\u8282\u70b9\u6267\u884c\u8be5\u547d\u4ee4\u3002</p> <p>redis \u5b98\u65b9\u89c4\u8303\u8981\u6c42\u6240\u6709\u5ba2\u6237\u7aef\u90fd\u5e94\u5904\u7406 MOVED \u9519\u8bef\uff0c\u4ece\u800c\u5b9e\u73b0\u5bf9\u7528\u6237\u7684\u900f\u660e\u3002</p> <p>\u6211\u4eec\u4e0a\u9762\u770b\u5230\u7684\u9519\u8bef\u5c31\u662f MOVED \u9519\u8bef\uff1a</p> <pre><code>(error) MOVED 866 172.21.16.4:6379\n</code></pre> <p>\u4ed6\u8868\u793a\uff0c\u8be5\u6267\u884c\u8be5\u547d\u4ee4\u6240\u9700\u8981\u7684 slot \u662f 866 \u53f7\u54c8\u5e0c\u69fd\uff0c\u8d1f\u8d23\u8be5\u69fd\u7684\u8282\u70b9\u662f 172.21.16.4:6379</p> <p>\u5728\u4e00\u822c\u60c5\u51b5\u4e0b\uff0c redis \u96c6\u7fa4\u7684\u5ba2\u6237\u7aef\u90fd\u4f1a\u5728\u5185\u90e8\u7f13\u5b58\u96c6\u7fa4\u7684\u69fd\u5206\u914d\u60c5\u51b5\uff08\u4f46\u5e76\u4e0d\u662f\u5f3a\u5236\uff09</p> <p>\u6bcf\u6b21 REDIS \u6307\u4ee4\u64cd\u4f5c\u540e\uff0c\u5ba2\u6237\u7aef\u5e94\u8be5\u8bb0\u5f55\u4e0b\u6b63\u786e\u7684\u8282\u70b9\u4e0e\u69fd\u4e4b\u95f4\u7684\u5bf9\u5e94\u5173\u7cfb -- \u69fd\u4f4d\u8def\u7531\u8868\uff0c\u6765\u63d0\u5347\u6027\u80fd  </p> <p>\u6bd4\u5982\uff0credis-go-cluster \u662f\u57fa\u4e8e Redigo \u5b9e\u73b0\u7684 Golang Redis \u5ba2\u6237\u7aef\u3002redis-go-cluster \u53ef\u4ee5\u5728\u672c\u5730\u7f13\u5b58 slot \u4fe1\u606f\uff0c\u5e76\u4e14\u5f53\u96c6\u7fa4\u4fee\u6539\u7684\u65f6\u5019\u4f1a\u81ea\u52a8\u66f4\u65b0\u3002</p> <p>\u6b64\u5ba2\u6237\u7aef\u7ba1\u7406\u6bcf\u4e2a\u8282\u70b9\u8fde\u63a5\u6c60\uff0c\u4f7f\u7528 goroutine \u6765\u5c3d\u53ef\u80fd\u7684\u5e76\u53d1\u6267\u884c\uff0c\u8fbe\u5230\u4e86\u9ad8\u6548\uff0c\u4f4e\u5ef6\u8fdf\u3002</p> <p>github.com/go-redis/redis \u662f\u4e00\u4e2a\u975e\u5e38\u53cb\u597d\u7684 redis \u7684SDK</p> <p>\u5199\u5165\u5b89\u5168\u6027</p> <p>redis cluster \u96c6\u7fa4\u8282\u70b9\u95f4\u4f7f\u7528**\u5f02\u6b65\u590d\u5236**\u4f20\u8f93\u6570\u636e\uff0c\u6700\u540e\u4e00\u6b21\u6545\u969c\u8f6c\u79fb\u6267\u884c\u9690\u5f0f\u5408\u5e76\u52a8\u4f5c\uff08last failover wins implicit merge function\uff09\u3002</p> <p>\u8fd9\u610f\u5473\u7740\u6700\u540e\u88ab\u9009\u4e3e\u51fa\u6765\u7684master\u7684\u6570\u636e\u96c6\u6700\u7ec8\u4f1a\u8986\u76d6\u5230\u5176\u4ed6 slave \u526f\u672c\u8282\u70b9\u3002</p> <p>\u4f7f\u7528\u5f02\u6b65\u590d\u5236\u7684\u7f3a\u70b9\u5c31\u662f\u5728\u6545\u969c\u671f\u95f4\u603b\u4f1a\u4e22\u5931\u4e00\u70b9\u6570\u636e\uff0c\u4f46\u8fde\u63a5\u5230\u5927\u591a\u6570 master \u8282\u70b9\u7684\u5ba2\u6237\u7aef\u4e0e\u8fde\u63a5\u5230\u6781\u5c11\u90e8\u5206 master \u8282\u70b9\u7684\u5ba2\u6237\u7aef\u60c5\u51b5\u5b8c\u5168\u4e0d\u540c\u3002</p> <p>redis \u96c6\u7fa4\u4f1a\u5c3d\u91cf\u4fdd\u5b58\u6240\u6709\u4e0e\u5927\u591a\u6570 master \u8282\u70b9\u8fde\u63a5\u7684\u5ba2\u6237\u7aef\u6267\u884c\u7684\u5199\u5165\uff0c\u4f46\u4ee5\u4e0b\u4e24\u79cd\u60c5\u51b5\u9664\u5916\uff1a</p> <p>1\u3001\u4e00\u4e2a\u5199\u5165\u64cd\u4f5c\u80fd\u5230\u8fbe\u4e00\u4e2amaster\u8282\u70b9\uff0c\u4f46\u5f53master\u8282\u70b9\u51c6\u5907\u56de\u590d\u5ba2\u6237\u7aef\u65f6\uff0c\u6b64\u5199\u5165\u53ef\u80fd\u8fd8\u672a\u901a\u8fc7\u5f02\u6b65\u590d\u5236\u5230\u5b83\u7684 slave \u590d\u5236\u8282\u70b9\u3002</p> <p>\u82e5master\u8282\u70b9\u5728\u5199\u5165\u8fd8\u672a\u590d\u5236\u5230slave\u8282\u70b9\u65f6\u6302\u6389\uff0c\u90a3\u4e48\u6b64\u6b21\u5199\u5165\u5c31\u4f1a\u4e22\u5931\uff0c\u82e5 master \u8282\u70b9\u4e0d\u53ef\u8fbe\uff0c\u5c31\u4f1a\u6709\u4e00\u4e2a\u5408\u9002\u7684 slave \u88ab\u63d0\u5347\u4e3a\u65b0 master\u3002</p> <p>2\u3001\u7406\u8bba\u4e0a\u53e6\u4e00\u79cd\u5199\u5165\u53ef\u80fd\u7684\u4e22\u5931\u7684\u60c5\u51b5\uff1a</p> <p>a\u3001\u7f51\u7edc\u6545\u969c\u9020\u6210\u7f51\u7edc\u5206\u533a\uff0c\u81f4\u4f7f master \u8282\u70b9\u4e0d\u53ef\u8fbe</p> <p>b\u3001\u6545\u969c\u8f6c\u79fb\u5bfc\u81f4 slave \u8282\u70b9\u88ab\u63d0\u5347\u4e3a master</p> <p>c\u3001master\u8282\u70b9\u518d\u6b21\u53ef\u8fbe</p> <p>d\u3001\u7f51\u7edc\u5206\u533a\u540e master \u8282\u70b9\u9694\u79bb\uff0c\u4f7f\u7528\u8fc7\u65f6\u8def\u7531\u4fe1\u606f\uff08out-of-date routing table\uff09\u7684\u5ba2\u6237\u7aef\u5199\u5165\u6570\u636e\u5230\u65e7 master \u8282\u70b9</p>"},{"location":"redis/01.redis%E7%AE%80%E4%BB%8B/#redis_15","title":"redis \u91cd\u5206\u7247","text":"<p>\u968f\u7740\u6570\u636e\u91cf\u7684\u589e\u591a\u6216\u8005\u8bbf\u95ee\u91cf\u7684\u52a0\u5927\uff0c \u96c6\u7fa4\u4e2d\u7684\u4e00\u4e2a\u6216\u591a\u4e2a\u8282\u70b9\u53ef\u80fd\u4f1a\u65e0\u6cd5\u7ee7\u7eed\u5904\u7406\u4e4b\u524d\u5206\u914d\u7ed9\u5b83\u4eec\u7684\u69fd\uff0c \u8fd9\u65f6\u7528\u6237\u5c31\u9700\u8981\u5bf9\u96c6\u7fa4\u8fdb\u884c\u91cd\u5206\u7247\uff08reshard\uff09\u3002</p> <p>\u4e5f\u5373\u662f\uff0c \u7ed9\u96c6\u7fa4\u589e\u52a0\u66f4\u591a\u8282\u70b9\uff0c \u5e76\u628a\u4e4b\u524d\u7531\u5df2\u6709\u8282\u70b9\u5904\u7406\u7684\u69fd\u5206\u914d\u4e00\u90e8\u5206\u7ed9\u65b0\u8282\u70b9\u8d1f\u8d23\u3002</p> <p>\u5206\u7247\u5176\u5b9e\u5c31\u662f\u628a hash slots \u4ece\u4e00\u7ec4 nodes \u79fb\u52a8\u5230\u53e6\u5916\u4e00\u7ec4 nodes \u3002\u5c31\u50cf\u4f7f\u7528 redis-cli \u5de5\u5177\u521b\u5efa cluster \u4e00\u6837\u3002</p> <pre><code>redis-cli --cluster reshard 127.0.0.1:7000\n</code></pre> <p>\u5f53\u524d redis-cli \u662f\u552f\u4e00\u5b98\u65b9\u652f\u6301\u7684\u5206\u7247\u7ba1\u7406\u65b9\u5f0f\uff0c</p>"},{"location":"redis/01.redis%E7%AE%80%E4%BB%8B/#redis-cli-cluster","title":"redis-cli cluster \u547d\u4ee4","text":"<p>https://www.cnblogs.com/zhoujinyi/p/11606935.html</p>"},{"location":"redis/01.redis%E7%AE%80%E4%BB%8B/#redis-cluster_3","title":"redis-cluster \u89c4\u8303","text":"<p>redis \u96c6\u7fa4\u4e0d\u50cf\u5355\u673a redis \u90a3\u6837\u652f\u6301\u591a\u6570\u636e\u5e93\u529f\u80fd\uff0c \u96c6\u7fa4\u53ea\u4f7f\u7528\u9ed8\u8ba4\u7684 <code>0</code> \u53f7\u6570\u636e\u5e93(database0)\uff0c \u5e76\u4e14\u4e0d\u80fd\u4f7f\u7528 SELECT index \u547d\u4ee4\u3002</p>"},{"location":"redis/01.redis%E7%AE%80%E4%BB%8B/#redis_16","title":"Redis \u96c6\u7fa4\u534f\u8bae\u4e2d\u7684\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u5668","text":"<p>Redis \u96c6\u7fa4\u4e2d\u7684\u8282\u70b9\u6709\u4ee5\u4e0b\u8d23\u4efb\uff1a</p> <ul> <li>\u6301\u6709\u952e\u503c\u5bf9\u6570\u636e\u3002</li> <li>\u8bb0\u5f55\u96c6\u7fa4\u7684\u72b6\u6001\uff0c\u5305\u62ec\u952e\u5230\u6b63\u786e\u8282\u70b9\u7684\u6620\u5c04\uff08mapping keys to right nodes\uff09\u3002</li> <li>\u81ea\u52a8\u53d1\u73b0\u5176\u4ed6\u8282\u70b9\uff0c\u8bc6\u522b\u5de5\u4f5c\u4e0d\u6b63\u5e38\u7684\u8282\u70b9\uff0c\u5e76\u5728\u6709\u9700\u8981\u65f6\uff0c\u5728\u4ece\u8282\u70b9\u4e2d\u9009\u4e3e\u51fa\u65b0\u7684\u4e3b\u8282\u70b9\u3002</li> </ul> <p>\u4e3a\u4e86\u6267\u884c\u4ee5\u4e0a\u5217\u51fa\u7684\u4efb\u52a1\uff0c \u96c6\u7fa4\u4e2d\u7684\u6bcf\u4e2a\u8282\u70b9\u90fd\u4e0e\u5176\u4ed6\u8282\u70b9\u5efa\u7acb\u8d77\u4e86\u201c\u96c6\u7fa4\u603b\u7ebf\uff08cluster bus\uff09\u201d\uff0c \u8be5\u8fde\u63a5\u662f\u4e00\u4e2a TCP \u8fde\u63a5\uff0c \u4f7f\u7528\u4e8c\u8fdb\u5236\u534f\u8bae\u8fdb\u884c\u901a\u8baf\u3002</p> <p>\u8282\u70b9\u4e4b\u95f4\u4f7f\u7528 Gossip \u534f\u8bae \u6765\u8fdb\u884c\u4ee5\u4e0b\u5de5\u4f5c\uff1a</p> <ul> <li>\u4f20\u64ad\uff08propagate\uff09\u5173\u4e8e\u96c6\u7fa4\u7684\u4fe1\u606f\uff0c\u4ee5\u6b64\u6765\u53d1\u73b0\u65b0\u7684\u8282\u70b9\u3002</li> <li>\u5411\u5176\u4ed6\u8282\u70b9\u53d1\u9001 <code>PING</code> \u6570\u636e\u5305\uff0c\u4ee5\u6b64\u6765\u68c0\u67e5\u76ee\u6807\u8282\u70b9\u662f\u5426\u6b63\u5e38\u8fd0\u4f5c\u3002</li> <li>\u5728\u7279\u5b9a\u4e8b\u4ef6\u53d1\u751f\u65f6\uff0c\u53d1\u9001\u96c6\u7fa4\u4fe1\u606f\u3002</li> </ul> <p>\u9664\u6b64\u4e4b\u5916\uff0c \u96c6\u7fa4\u8fde\u63a5\u8fd8\u7528\u4e8e\u5728\u96c6\u7fa4\u4e2d\u53d1\u5e03\u6216\u8ba2\u9605\u4fe1\u606f</p>"},{"location":"redis/01.redis%E7%AE%80%E4%BB%8B/#redis_17","title":"redis \u54e8\u5175\u6a21\u5f0f","text":"<p>https://www.cnblogs.com/kevingrace/p/9004460.html</p> <p>https://v2ex.com/t/696387</p> <p>redis \u54e8\u5175\uff08sentinel \uff09\u4e5f\u662f\u4f01\u4e1a\u573a\u666f\u4e2d\u6700\u5e38\u89c1\u7684\u9ad8\u53ef\u7528\u65b9\u6848\u3002\u4e5f\u662f\u5b98\u65b9\u63a8\u8350\u7684\u9ad8\u53ef\u7528\u65b9\u6848\u3002</p> <p>redis-sentinel \u672c\u8eab\u4e5f\u662f\u4e00\u4e2a\u72ec\u7acb\u8fd0\u884c\u7684\u8fdb\u7a0b\uff0c\u5b83\u80fd\u76d1\u63a7\u591a\u4e2a master-slave \u96c6\u7fa4\uff0c\u53d1\u73b0 master \u5b95\u673a\u540e\u80fd\u8fdb\u884c\u81ea\u52a8\u5207\u6362\u3002</p> <p>\u5f53\u4e00\u4e2a\u96c6\u7fa4\u4e2d\u7684 master \u5931\u6548\u4e4b\u540e\uff0csentinel \u53ef\u4ee5\u9009\u4e3e\u51fa\u4e00\u4e2a\u65b0\u7684 master \u7528\u4e8e\u81ea\u52a8\u63a5\u66ff master \u7684\u5de5\u4f5c\u3002</p> <p>\u96c6\u7fa4\u4e2d\u7684\u5176\u4ed6 redis \u670d\u52a1\u5668\u81ea\u52a8\u6307\u5411\u65b0\u7684 master \u540c\u6b65\u6570\u636e\u3002</p> <p>\u4e00\u822c\u5efa\u8bae sentinel \u91c7\u53d6\u5947\u6570\u53f0\uff0c\u9632\u6b62\u67d0\u4e00\u53f0 sentinel \u65e0\u6cd5\u8fde\u63a5\u5230 master \u5bfc\u81f4\u8bef\u5207\u6362\u3002\u5176\u7ed3\u6784\u5982\u4e0b:</p> <p></p> <p>\u54e8\u5175(sentinel) \u662f\u4e00\u4e2a\u5206\u5e03\u5f0f\u7cfb\u7edf\uff0c\u4f60\u53ef\u4ee5\u5728\u4e00\u4e2a\u67b6\u6784\u4e2d\u8fd0\u884c\u591a\u4e2a\u54e8\u5175(sentinel) \u8fdb\u7a0b\u3002</p> <p>\u8fd9\u4e9b\u8fdb\u7a0b\u4f7f\u7528\u6d41\u8a00\u534f\u8bae(gossip protocols)\u6765\u63a5\u6536\u5173\u4e8eMaster \u662f\u5426\u4e0b\u7ebf\u7684\u4fe1\u606f\u3002</p> <p>Sentinel \u72b6\u6001\u6301\u4e45\u5316</p> <p>snetinel \u7684\u72b6\u6001\u4f1a\u88ab\u6301\u4e45\u5316\u5730\u5199\u5165sentinel \u7684\u914d\u7f6e\u6587\u4ef6\u4e2d\u3002</p> <p>\u6bcf\u6b21\u5f53\u6536\u5230\u4e00\u4e2a\u65b0\u7684\u914d\u7f6e\u65f6\uff0c\u6216\u8005\u65b0\u521b\u5efa\u4e00\u4e2a\u914d\u7f6e\u65f6\uff0c\u914d\u7f6e\u4f1a\u88ab\u6301\u4e45\u5316\u5230\u786c\u76d8\u4e2d\uff0c\u5e76\u5e26\u4e0a\u914d\u7f6e\u7684\u7248\u672c\u6233\u3002</p> <p>\u8fd9\u610f\u5473\u7740\uff0c\u53ef\u4ee5\u5b89\u5168\u7684\u505c\u6b62\u548c\u91cd\u542fsentinel\u8fdb\u7a0b\u3002</p> <p>redis\u7684\u54e8\u5175(sentinel) \u7cfb\u7edf\u7528\u4e8e\u7ba1\u7406\u591a\u4e2a redis \u670d\u52a1\u5668\u7ec4\uff0c\u8be5\u7cfb\u7edf\u6267\u884c\u4ee5\u4e0b\u4e09\u4e2a\u4efb\u52a1:</p> <ul> <li> <p>\u76d1\u63a7(Monitoring)\uff1a\u54e8\u5175(sentinel) \u4f1a\u4e0d\u65ad\u5730\u68c0\u67e5\u4f60\u7684 Master \u548c Slave \u662f\u5426\u8fd0\u4f5c\u6b63\u5e38\u3002</p> </li> <li> <p>\u63d0\u9192(Notification)\uff1a\u5f53\u88ab\u76d1\u63a7\u7684\u67d0\u4e2a Redis \u7ec4\u51fa\u73b0\u95ee\u9898\u65f6, \u54e8\u5175(sentinel) \u53ef\u4ee5\u901a\u8fc7 API \u5411\u7ba1\u7406\u5458\u6216\u8005\u5176\u4ed6\u5e94\u7528\u7a0b\u5e8f\u53d1\u9001\u901a\u77e5\u3002</p> </li> <li>\u6545\u969c\u8f6c\u79fb(Automatic failover)\uff1a\u5f53\u4e00\u4e2aMaster\u4e0d\u80fd\u6b63\u5e38\u5de5\u4f5c\u65f6\uff0c\u54e8\u5175(sentinel) \u4f1a\u5f00\u59cb\u4e00\u6b21\u81ea\u52a8\u6545\u969c\u8fc1\u79fb\u64cd\u4f5c\uff1b</li> <li>\u5b83\u4f1a\u5c06\u5931\u6548 Master \u7684\u5176\u4e2d\u4e00\u4e2a Slave \u5347\u7ea7\u4e3a\u65b0\u7684 Master,</li> <li>\u5e76\u8ba9\u5931\u6548 Master \u7684\u5176\u4ed6 Slave \u6539\u4e3a\u590d\u5236\u65b0\u7684 Master; </li> <li>\u5f53\u5ba2\u6237\u7aef\u8bd5\u56fe\u8fde\u63a5\u5931\u6548\u7684 Master \u65f6,\u96c6\u7fa4\u4e5f\u4f1a\u5411\u5ba2\u6237\u7aef\u8fd4\u56de\u65b0Master\u7684\u5730\u5740,\u4f7f\u5f97\u96c6\u7fa4\u53ef\u4ee5\u4f7f\u7528\u65b0 master\u4ee3\u66ff\u5931\u6548\u7684 Master\u3002</li> <li>master_redis.conf\u3001slave_redis.conf\u548c sentinel.conf \u7684\u5185\u5bb9\u90fd\u4f1a\u53d1\u751f\u6539\u53d8\uff0c\u5373 master_redis.conf \u4e2d\u4f1a\u591a\u4e00\u884c slaveof \u7684\u914d\u7f6e\uff0csentinel.conf \u7684\u76d1\u63a7\u76ee\u6807\u4f1a\u968f\u4e4b\u8c03\u6362\u3002</li> </ul> <p>Sentinel\u5de5\u4f5c\u65b9\u5f0f\uff08\u6bcf\u4e2aSentinel\u5b9e\u4f8b\u90fd\u6267\u884c\u7684\u5b9a\u65f6\u4efb\u52a1\uff09</p> <p>1\uff09\u6bcf\u4e2a Sentinel \u4ee5\u6bcf\u79d2\u949f\u4e00\u6b21\u7684\u9891\u7387\u5411\u5b83\u6240\u7ba1\u7406\u7684 Master\uff0cSlave \u4ee5\u53ca\u5176\u4ed6 Sentinel \u5b9e\u4f8b\u53d1\u9001\u4e00\u4e2a PING \u547d\u4ee4\u3002 2\uff09\u5982\u679c\u4e00\u4e2a\u5b9e\u4f8b\uff08instance\uff09\u8ddd\u79bb\u6700\u540e\u4e00\u6b21\u6709\u6548\u56de\u590d PING \u547d\u4ee4\u7684\u65f6\u95f4\u8d85\u8fc7 own-after-milliseconds \u9009\u9879\u6240\u6307\u5b9a\u7684\u503c\uff0c\u5219\u8fd9\u4e2a\u5b9e\u4f8b\u4f1a\u88ab Sentinel \u6807\u8bb0\u4e3a\u4e3b\u89c2\u4e0b\u7ebf\u3002  3\uff09\u5982\u679c\u4e00\u4e2a Master \u88ab\u6807\u8bb0\u4e3a\u4e3b\u89c2\u4e0b\u7ebf\uff0c\u5219\u6b63\u5728\u76d1\u89c6\u8fd9\u4e2a Master \u7684\u6240\u6709 Sentinel \u8981\u4ee5\u6bcf\u79d2\u4e00\u6b21\u7684\u9891\u7387\u786e\u8ba4 Master \u7684\u786e\u8fdb\u5165\u4e86\u4e3b\u89c2\u4e0b\u7ebf\u72b6\u6001\u3002  4\uff09\u5f53\u6709\u8db3\u591f\u6570\u91cf\u7684 Sentinel\uff08\u5927\u4e8e\u7b49\u4e8e\u914d\u7f6e\u6587\u4ef6\u6307\u5b9a\u7684\u503c\uff09\u5728\u6307\u5b9a\u7684\u65f6\u95f4\u8303\u56f4\u5185\u786e\u8ba4 Master \u7684\u786e\u8fdb\u5165\u4e86\u4e3b\u89c2\u4e0b\u7ebf\u72b6\u6001\uff0c\u5219 Master \u4f1a\u88ab\u6807\u8bb0\u4e3a\u5ba2\u89c2\u4e0b\u7ebf\u3002 5\uff09\u5728\u4e00\u822c\u60c5\u51b5\u4e0b\uff0c\u6bcf\u4e2a Sentinel \u4f1a\u4ee5\u6bcf 10 \u79d2\u4e00\u6b21\u7684\u9891\u7387\u5411\u5b83\u5df2\u77e5\u7684\u6240\u6709 Master\uff0cSlave \u53d1\u9001 INFO \u547d\u4ee4\u3002 6\uff09\u5f53 Master \u88ab Sentinel \u6807\u8bb0\u4e3a\u5ba2\u89c2\u4e0b\u7ebf\u65f6\uff0cSentinel \u5411\u4e0b\u7ebf\u7684 Master \u7684\u6240\u6709 Slave \u53d1\u9001 INFO \u547d\u4ee4\u7684\u9891\u7387\u4f1a\u4ece 10 \u79d2\u4e00\u6b21\u6539\u4e3a\u6bcf\u79d2\u4e00\u6b21\u3002  7\uff09\u82e5\u6ca1\u6709\u8db3\u591f\u6570\u91cf\u7684 Sentinel \u540c\u610f Master \u5df2\u7ecf\u4e0b\u7ebf\uff0cMaster \u7684\u5ba2\u89c2\u4e0b\u7ebf\u72b6\u6001\u5c31\u4f1a\u88ab\u79fb\u9664\u3002 \u82e5 Master \u91cd\u65b0\u5411 Sentinel \u7684 PING \u547d\u4ee4\u8fd4\u56de\u6709\u6548\u56de\u590d\uff0cMaster \u7684\u4e3b\u89c2\u4e0b\u7ebf\u72b6\u6001\u5c31\u4f1a\u88ab\u79fb\u9664\u3002</p> <p>sentinel\u5728\u5185\u90e8\u67093\u4e2a\u5b9a\u65f6\u4efb\u52a1</p> <ul> <li>\u6bcf10\u79d2\u5bf9\u6bcf\u4e2asentinel\u4f1a\u5bf9master\u548cslave\u6267\u884cinfo\u547d\u4ee4\uff0c\u8fd9\u4e2a\u4efb\u52a1\u8fbe\u5230\u4e24\u4e2a\u76ee\u7684\uff1a</li> <li>a\uff09\u53d1\u73b0slave\u8282\u70b9</li> <li>b\uff09\u786e\u8ba4\u4e3b\u4ece\u5173\u7cfb</li> <li>\u6bcf2\u79d2\u6bcf\u4e2asentinel\u901a\u8fc7master\u8282\u70b9\u7684channel\u4ea4\u6362\u4fe1\u606f\uff08pub/sub\uff09\u3002master\u8282\u70b9\u4e0a\u6709\u4e00\u4e2a\u53d1\u5e03\u8ba2\u9605\u7684\u9891\u9053(sentinel:hello)\u3002sentinel\u8282\u70b9\u901a\u8fc7__sentinel__:hello\u9891\u9053\u8fdb\u884c\u4fe1\u606f\u4ea4\u6362(\u5bf9\u8282\u70b9\u7684\"\u770b\u6cd5\"\u548c\u81ea\u8eab\u7684\u4fe1\u606f)\uff0c\u8fbe\u6210\u5171\u8bc6\u3002</li> <li>\u6bcf1\u79d2\u6bcf\u4e2a sentinel \u5bf9\u5176\u4ed6 sentinel \u548c redis \u8282\u70b9\u6267\u884c ping \u64cd\u4f5c\uff08\u76f8\u4e92\u76d1\u63a7\uff09\uff0c\u8fd9\u4e2a\u5176\u5b9e\u662f\u4e00\u4e2a\u5fc3\u8df3\u68c0\u6d4b\uff0c\u662f\u5931\u8d25\u5224\u5b9a\u7684\u4f9d\u636e\u3002</li> </ul> <p>\u4e3b\u89c2\u4e0b\u7ebf\uff1a\u4ec5\u54e8\u5175\u96c6\u7fa4\u4e2d\u7684\u4e00\u4e2a\u54e8\u5175\u8fdb\u7a0b\u6216\u5c11\u6570\u54e8\u5175\u8fdb\u7a0b\u8ba4\u4e3a\u5b9e\u4f8b\u4e0b\u7ebf\u3002</p> <p>\u5ba2\u89c2\u4e0b\u7ebf\uff1a\u4e0d\u4f46\u54e8\u5175\u81ea\u5df1\u8ba4\u4e3a\u8282\u70b9\u5b95\u673a\uff0c\u800c\u4e14\u8be5\u54e8\u5175\u4e0e\u5176\u4ed6\u54e8\u5175\u6c9f\u901a\u540e\uff0c\u8fbe\u5230\u4e00\u5b9a\u6570\u91cf\u7684\u54e8\u5175\u90fd\u8ba4\u4e3a\u5b9e\u4f8b\u4e0b\u7ebf\u3002</p> <p>\u8fd9\u91cc\u7684\u300c\u4e00\u5b9a\u6570\u91cf\u300d\u662f\u4e00\u4e2a\u6cd5\u5b9a\u6570\u91cf\uff08Quorum\uff09\uff0c\u662f\u7531\u54e8\u5175\u76d1\u63a7\u914d\u7f6e\u51b3\u5b9a\u7684\uff0c\u89e3\u91ca\u4e00\u4e0b\u8be5\u914d\u7f6e\uff1a</p> <p>Sentinel\u652f\u6301\u96c6\u7fa4\uff08\u53ef\u4ee5\u90e8\u7f72\u5728\u591a\u53f0\u673a\u5668\u4e0a\uff0c\u4e5f\u53ef\u4ee5\u5728\u4e00\u53f0\u7269\u7406\u673a\u4e0a\u901a\u8fc7\u591a\u7aef\u53e3\u5b9e\u73b0\u4f2a\u96c6\u7fa4\u90e8\u7f72\uff09</p> <p>\u5f88\u663e\u7136\uff0c\u53ea\u4f7f\u7528\u5355\u4e2a sentinel \u8fdb\u7a0b\u6765\u76d1\u63a7 redis \u96c6\u7fa4\u662f\u4e0d\u53ef\u9760\u7684\uff0c\u5f53 sentinel \u8fdb\u7a0b\u5b95\u6389\u540e</p> <p>(sentinel \u672c\u8eab\u4e5f\u6709\u5355\u70b9\u95ee\u9898\uff0csingle-point-of-failure) \u6574\u4e2a\u96c6\u7fa4\u7cfb\u7edf\u5c06\u65e0\u6cd5\u6309\u7167\u9884\u671f\u7684\u65b9\u5f0f\u8fd0\u884c\u3002\u6240\u4ee5\u6709\u5fc5\u8981\u5c06 sentinel \u96c6\u7fa4\uff0c\u8fd9\u6837\u6709\u51e0\u4e2a\u597d\u5904\uff1a</p> <p>1\uff09\u5373\u4f7f\u6709\u4e00\u4e9b sentinel \u8fdb\u7a0b\u5b95\u6389\u4e86\uff0c\u4f9d\u7136\u53ef\u4ee5\u8fdb\u884c redis \u96c6\u7fa4\u7684\u4e3b\u5907\u5207\u6362\uff1b</p> <p>2\uff09\u5982\u679c\u53ea\u6709\u4e00\u4e2asentinel\u8fdb\u7a0b\uff0c\u5982\u679c\u8fd9\u4e2a\u8fdb\u7a0b\u8fd0\u884c\u51fa\u9519\uff0c\u6216\u8005\u662f\u7f51\u7edc\u5835\u585e\uff0c\u90a3\u4e48\u5c06\u65e0\u6cd5\u5b9e\u73b0redis\u96c6\u7fa4\u7684\u4e3b\u5907\u5207\u6362\uff08\u5355\u70b9\u95ee\u9898\uff09;</p> <p>3\uff09\u5982\u679c\u6709\u591a\u4e2asentinel\uff0credis\u7684\u5ba2\u6237\u7aef\u53ef\u4ee5\u968f\u610f\u5730\u8fde\u63a5\u4efb\u610f\u4e00\u4e2a sentinel\u6765\u83b7\u5f97\u5173\u4e8eredis\u96c6\u7fa4\u4e2d\u7684\u4fe1\u606f\u3002</p> <p>redis \u54e8\u5175\u662f\u5982\u4f55\u4fdd\u8bc1\u9ad8\u53ef\u7528\u7684</p>"},{"location":"redis/01.redis%E7%AE%80%E4%BB%8B/#redis_18","title":"redis \u54e8\u5175\u65b9\u6848","text":"<p>\u5728 redis \u4e2d\uff0c\u4e00\u4e3b\u4e24\u4ece\u4e09\u54e8\u5175\uff0c\u8fd9\u662f\u6700\u7ecf\u5178\u7684 redis \u54e8\u5175\u65b9\u6848\u3002</p> <p>\u751f\u4ea7\u73af\u5883\u4f7f\u7528\u4e09\u53f0\u670d\u52a1\u5668\u642d\u5efaredis\u54e8\u5175\u96c6\u7fa4\uff0c3\u4e2aredis\u5b9e\u4f8b\uff081\u4e3b2\u4ece\uff09+ 3\u4e2a\u54e8\u5175\u5b9e\u4f8b\uff1a</p> <p></p> <ul> <li>redis.conf \u914d\u7f6e\u4e3b\u4ece</li> <li>sentinel.conf \u914d\u7f6e\u54e8\u5175</li> </ul>"},{"location":"redis/01.redis%E7%AE%80%E4%BB%8B/#redis_19","title":"redis \u54e8\u5175\u548c\u96c6\u7fa4\u7684\u5f02\u540c","text":"<p>Sentinel \u7cfb\u7edf\u7528\u4e8e\u7ba1\u7406\u591a\u4e2a Redis \u670d\u52a1\u5668\uff08instance\uff09\uff0c \u8be5\u7cfb\u7edf\u6267\u884c\u4ee5\u4e0b\u4e09\u4e2a\u4efb\u52a1\uff1a</p> <p>\u76d1\u63a7\uff08Monitoring\uff09\uff1a Sentinel \u4f1a\u4e0d\u65ad\u5730\u68c0\u67e5\u4f60\u7684\u4e3b\u670d\u52a1\u5668\u548c\u4ece\u670d\u52a1\u5668\u662f\u5426\u8fd0\u4f5c\u6b63\u5e38\u3002</p> <p>\u63d0\u9192\uff08Notification\uff09\uff1a \u5f53\u88ab\u76d1\u63a7\u7684\u67d0\u4e2a Redis \u670d\u52a1\u5668\u51fa\u73b0\u95ee\u9898\u65f6\uff0c Sentinel \u53ef\u4ee5\u901a\u8fc7 API \u5411\u7ba1\u7406\u5458\u6216\u8005\u5176\u4ed6\u5e94\u7528\u7a0b\u5e8f\u53d1\u9001\u901a\u77e5\u3002</p> <p>\u81ea\u52a8\u6545\u969c\u8fc1\u79fb\uff08Automatic failover\uff09\uff1a \u5f53\u4e00\u4e2a\u4e3b\u670d\u52a1\u5668\u4e0d\u80fd\u6b63\u5e38\u5de5\u4f5c\u65f6\uff0c Sentinel \u4f1a\u5f00\u59cb\u4e00\u6b21\u81ea\u52a8\u6545\u969c\u8fc1\u79fb\u64cd\u4f5c\uff0c \u5b83\u4f1a\u5c06\u5931\u6548\u4e3b\u670d\u52a1\u5668\u7684\u5176\u4e2d\u4e00\u4e2a\u4ece\u670d\u52a1\u5668\u5347\u7ea7\u4e3a\u65b0\u7684\u4e3b\u670d\u52a1\u5668\uff0c \u5e76\u8ba9\u5931\u6548\u4e3b\u670d\u52a1\u5668\u7684\u5176\u4ed6\u4ece\u670d\u52a1\u5668\u6539\u4e3a\u590d\u5236\u65b0\u7684\u4e3b\u670d\u52a1\u5668\uff1b \u5f53\u5ba2\u6237\u7aef\u8bd5\u56fe\u8fde\u63a5\u5931\u6548\u7684\u4e3b\u670d\u52a1\u5668\u65f6\uff0c \u96c6\u7fa4\u4e5f\u4f1a\u5411\u5ba2\u6237\u7aef\u8fd4\u56de\u65b0\u4e3b\u670d\u52a1\u5668\u7684\u5730\u5740\uff0c \u4f7f\u5f97\u96c6\u7fa4\u53ef\u4ee5\u4f7f\u7528\u65b0\u4e3b\u670d\u52a1\u5668\u4ee3\u66ff\u5931\u6548\u670d\u52a1\u5668\u3002</p> <p>\u5ba2\u6237\u7aef\u4e2d\u4e0d\u4f1a\u8bb0\u5f55redis\u7684\u5730\u5740\uff08\u67d0\u4e2aIP\uff09\uff0c\u800c\u662f\u8bb0\u5f55sentinel\u7684\u5730\u5740\uff0c\u8fd9\u6837\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u4ecesentinel\u83b7\u53d6\u7684redis\u5730\u5740\uff0c\u56e0\u4e3asentinel\u4f1a\u5bf9\u6240\u6709\u7684master\u3001slave\u8fdb\u884c\u76d1\u63a7\u3002</p> <p>\u5b83\u662f\u77e5\u9053\u5230\u5e95\u8c01\u624d\u662f\u771f\u6b63\u7684master\u7684\uff0c\u4f8b\u5982\u6211\u4eec\u6545\u969c\u8f6c\u79fb\uff0c\u8fd9\u65f6\u5019\u5bf9\u4e8esentinel\u6765\u8bf4\uff0cmaster\u662f\u53d8\u4e86\u7684\uff0c\u7136\u540e\u901a\u77e5\u5ba2\u6237\u7aef\u3002</p> <p>\u800c\u5ba2\u6237\u7aef\u6839\u672c\u4e0d\u7528\u5173\u5fc3\u5230\u5e95\u8c01\u624d\u662f\u771f\u6b63\u7684master\uff0c\u53ea\u5173\u5fc3sentinel\u544a\u77e5\u7684master\u3002</p> <p>cluster\u662f\u4e3a\u4e86\u89e3\u51b3\u5355\u673aRedis\u5bb9\u91cf\u6709\u9650\u7684\u95ee\u9898\uff0c\u5c06\u6570\u636e\u6309\u4e00\u5b9a\u7684\u89c4\u5219\u5206\u914d\u5230\u591a\u53f0\u673a\u5668\u3002\u96c6\u7fa4\u6a21\u5f0f\u63d0\u9ad8\u5e76\u53d1\u91cf\u3002</p>"},{"location":"redis/01.redis%E7%AE%80%E4%BB%8B/#_13","title":"\u9ad8\u53ef\u7528\u89d2\u5ea6","text":"<p>\u54e8\u5175\uff1a \u54e8\u5175\u4ec5\u4ec5\u63d0\u4f9b\u6545\u969c\u5207\u6362\u80fd\u529b\uff0c\u5728\u8fd9\u4e4b\u4e0a\uff0c\u5bf9\u4f7f\u7528\u65b9\u6765\u8bf4\uff0c\u548c\u5355\u673a\u7684 redis \u662f\u5b8c\u5168\u4e00\u6837\u7684\u3002\u5ba2\u6237\u7aef\u53ea\u9700\u8981\u8fde\u63a5\u4e00\u4e2aIP\u5730\u5740\u3002</p> <p>\u96c6\u7fa4\uff1a \u96c6\u7fa4\u6700\u4e3b\u8981\u7684\uff0c\u89e3\u51b3\u7684\u662f\u4e00\u4e2a\u201c\u6570\u636e\u5206\u7247\u201d\u7684\u95ee\u9898\uff0c\u5b83\u80fd\u628a redis \u7684\u6570\u636e\u5206\u6563\u5230\u4e0d\u540c\u7684 slot \u91cc\uff0c\u800c\u4e0d\u662f\u90fd\u96c6\u4e2d\u5728\u4e00\u53f0\u673a\u5668\u7684\u5185\u5b58\u91cc\u3002\u8fd9\u6837\u4e5f\u5c31\u7ed9\u5355\u8fdb\u7a0b\u5355\u7ebf\u7a0b\u3001\u7eaf\u5185\u5b58\u7684 redis \u63d0\u4f9b\u4e86\u6c34\u5e73\u6269\u5bb9\u7684\u80fd\u529b\u3002</p> <p>\u200b       </p>"},{"location":"redis/01.redis%E7%AE%80%E4%BB%8B/#_14","title":"\u6570\u636e\u5206\u7247","text":""},{"location":"redis/01.redis%E7%AE%80%E4%BB%8B/#_15","title":"\u8fd0\u7ef4\u590d\u6742\u5ea6","text":"<p>\u96c6\u7fa4\u6a21\u5f0f\u663e\u7136\u6bd4\u54e8\u5175\u6a21\u5f0f\u66f4\u91cd\u3001\u9700\u8981\u66f4\u591a\u7684\u8d44\u6e90\u53bb\u8fd0\u884c\uff1b\u518d\u5c31\u662f\u90e8\u7f72\u8fd0\u7ef4\u590d\u6742\u5ea6\u4e5f\u662f\u66f4\u9ad8\u7684\u3002</p> <p>\u800c\u54e8\u5175\u548c\u5355\u8282\u70b9\uff0c\u4e00\u822c\u6765\u8bf4\u9664\u4e86\u914d\u7f6e\u7a0d\u6709\u533a\u522b\u4ee5\u5916\uff0c\u7edd\u5927\u90e8\u5206\u4e1a\u52a1\u4ee3\u7801\u662f\u53ef\u4ee5\u76f8\u5bb9\u7684\uff0c\u65e0\u9700\u7279\u5730\u4fee\u6539\u3002</p> <p>\u800c\u73b0\u6709\u7684\u4ee3\u7801\u5982\u679c\u4f7f\u7528\u4e86\u96c6\u7fa4\u6a21\u5f0f\u4e0d\u652f\u6301\u7684\u90a3\u4e9b\u547d\u4ee4\uff0c\u90a3\u4e48\u96c6\u7fa4\u6a21\u5f0f\u4e0b\u662f\u65e0\u6cd5\u6b63\u5e38\u5de5\u4f5c\u7684\u3002\u6240\u4ee5\u76ee\u524d\u54e8\u5175\u6a21\u5f0f\u4ecd\u7136\u88ab\u5e7f\u6cdb\u4f7f\u7528\uff0c\u6ca1\u6709\u88ab\u96c6\u7fa4\u6a21\u5f0f\u5f7b\u5e95\u66ff\u4ee3\u3002  </p>"},{"location":"redis/01.redis%E7%AE%80%E4%BB%8B/#_16","title":"\u65b9\u6848\u9009\u62e9\u548c\u5bf9\u6bd4","text":"<ol> <li> <p>\u96c6\u7fa4 cluster \u4e2d,\u4e3b\u670d\u52a1\u5668\u7684\u4ece\u670d\u52a1\u5668\u4e0d\u80fd\u8bfb\u53d6\u6570\u636e\uff0c\u64cd\u4f5c\u4ece\u670d\u52a1\u5668\u4f1a\u53d1\u9001 move \u8f6c\u5411\u9519\u8bef\u5230\u5bf9\u5e94\u7684\u4e3b\u670d\u52a1\u5668\u3002</p> </li> <li> <p>\u96c6\u7fa4 cluster \u4e2d\u4ece\u670d\u52a1\u5668\u5b58\u5728\u610f\u4e49\uff1a</p> </li> <li> <p>\u4f5c\u4e3a\u4e3b\u670d\u52a1\u5668\u7684\u6570\u636e\u5907\u4efd;</p> </li> <li> <p>\u5728 redis.config \u914d\u7f6e\u5141\u8bb8\u7684\u60c5\u51b5\u4e0b\uff0c\u5728\u4e3b\u670d\u52a1\u5668\u6545\u969c\u65f6\u5019\u4f1a\u89e6\u53d1 [\u81ea\u52a8\u6545\u969c\u8f6c\u79fb] \uff0c\u5347\u7ea7\u4e3a\u4e3b\u670d\u52a1\u5668;</p> </li> <li> <p>\u5728 redis.config \u914d\u7f6e\u5141\u8bb8\u7684\u60c5\u51b5\u4e0b\uff0c\u4e3b\u670d\u52a1\u5668\u88f8\u5954\u540e\uff0c\u53ef\u4ee5\u81ea\u52a8\u4ece\u5176\u4ed6\u4e3b\u670d\u52a1\u5668\u7684\u4ece\u670d\u52a1\u5668\u4e2d\u8fc1\u79fb\u4e00\u53f0\u8fc7\u6765\u6210\u4e3a\u88f8\u5954\u4e3b\u670d\u52a1\u5668\u7684\u4ece\u670d\u52a1\u5668\u3002</p> </li> <li> <p>\u54e8\u5175 sentine \u4e0d\u662f\u5403\u767d\u996d\u7684\uff0c\u53ef\u4ee5\u76d1\u63a7\u3001\u901a\u77e5\u3001\u81ea\u52a8\u6545\u969c\u8f6c\u79fb\uff0c\u53ef\u4ee5\u76d1\u63a7\u591a\u4e2a\u4e3b\u4ece\u4f53\u7cfb\u3002\u6570\u636e\u91cf\u4e0d\u662f\u74f6\u9888\u7684\u8bdd sentinel \u66f4\u6709\u4fdd\u969c\uff0c\u66f4\u7701\u94b1\uff08\u751f\u4ea7 2 \u53f0\u670d\u52a1\u5668\u5c31\u884c\uff09</p> </li> </ol>"},{"location":"redis/01.redis%E7%AE%80%E4%BB%8B/#redis_20","title":"redis \u6301\u4e45\u5316","text":"<p>https://juejin.cn/post/6844903998986665992</p> <p>\u6301\u4e45\u5316\u5c31\u662f\u628a\u5185\u5b58\u7684\u6570\u636e\u5199\u5230\u78c1\u76d8\u4e2d\u53bb\uff0c\u9632\u6b62\u670d\u52a1\u5b95\u673a\u4e86\u5185\u5b58\u6570\u636e\u4e22\u5931\u3002</p> <p>\u9762\u8bd5\u9898</p> <p>redis \u7684\u6301\u4e45\u5316\u6709\u54ea\u51e0\u79cd\u65b9\u5f0f\uff1f\u4e0d\u540c\u7684\u6301\u4e45\u5316\u673a\u5236\u90fd\u6709\u4ec0\u4e48\u4f18\u7f3a\u70b9\uff1f\u6301\u4e45\u5316\u673a\u5236\u5177\u4f53\u5e95\u5c42\u662f\u5982\u4f55\u5b9e\u73b0\u7684\uff1f</p> <p>\u9762\u8bd5\u5b98\u5fc3\u7406\u5206\u6790</p> <p>redis \u5982\u679c\u4ec5\u4ec5\u53ea\u662f\u5c06\u6570\u636e\u7f13\u5b58\u5728\u5185\u5b58\u91cc\u9762\uff0c\u5982\u679c redis \u5b95\u673a\u4e86\u518d\u91cd\u542f\uff0c\u5185\u5b58\u91cc\u7684\u6570\u636e\u5c31\u5168\u90e8\u90fd\u5f04\u4e22\u4e86\u554a\u3002</p> <p>\u4f60\u5fc5\u987b\u5f97\u7528 redis \u7684\u6301\u4e45\u5316\u673a\u5236\uff0c\u5c06\u6570\u636e\u5199\u5165\u5185\u5b58\u7684\u540c\u65f6\uff0c\u5f02\u6b65\u7684\u6162\u6162\u7684\u5c06\u6570\u636e\u5199\u5165\u78c1\u76d8\u6587\u4ef6\u91cc\uff0c\u8fdb\u884c\u6301\u4e45\u5316\u3002</p> <p>\u5982\u679c redis \u5b95\u673a\u91cd\u542f\uff0c\u81ea\u52a8\u4ece\u78c1\u76d8\u4e0a\u52a0\u8f7d\u4e4b\u524d\u6301\u4e45\u5316\u7684\u4e00\u4e9b\u6570\u636e\u5c31\u53ef\u4ee5\u4e86\uff0c\u4e5f\u8bb8\u4f1a\u4e22\u5931\u5c11\u8bb8\u6570\u636e\uff0c\u4f46\u662f\u81f3\u5c11\u4e0d\u4f1a\u5c06\u6240\u6709\u6570\u636e\u90fd\u5f04\u4e22\u3002</p> <p>\u8fd9\u4e2a\u5176\u5b9e\u4e00\u6837\uff0c\u9488\u5bf9\u7684\u90fd\u662f redis \u7684\u751f\u4ea7\u73af\u5883\u53ef\u80fd\u9047\u5230\u7684\u4e00\u4e9b\u95ee\u9898\uff0c\u5c31\u662f redis \u8981\u662f\u6302\u4e86\u518d\u91cd\u542f\uff0c\u5185\u5b58\u91cc\u7684\u6570\u636e\u4e0d\u5c31\u5168\u4e22\u4e86\uff1f\u80fd\u4e0d\u80fd\u91cd\u542f\u7684\u65f6\u5019\u628a\u6570\u636e\u7ed9\u6062\u590d\u4e86\uff1f</p> <p>\u6301\u4e45\u5316\u4e3b\u8981\u662f\u505a\u707e\u96be\u6062\u590d\u3001\u6570\u636e\u6062\u590d\uff0c\u4e5f\u53ef\u4ee5\u5f52\u7c7b\u5230\u9ad8\u53ef\u7528\u7684\u4e00\u4e2a\u73af\u8282\u4e2d\u53bb\uff0c\u6bd4\u5982\u4f60 redis \u6574\u4e2a\u6302\u4e86\uff0c\u7136\u540e redis \u5c31\u4e0d\u53ef\u7528\u4e86\uff0c\u4f60\u8981\u505a\u7684\u4e8b\u60c5\u5c31\u662f\u8ba9 redis \u53d8\u5f97\u53ef\u7528\uff0c\u5c3d\u5feb\u53d8\u5f97\u53ef\u7528\u3002</p> <p>\u91cd\u542f redis\uff0c\u5c3d\u5feb\u8ba9\u5b83\u5bf9\u5916\u63d0\u4f9b\u670d\u52a1\uff0c\u5982\u679c\u6ca1\u505a\u6570\u636e\u5907\u4efd\uff0c\u8fd9\u65f6\u5019 redis \u542f\u52a8\u4e86\uff0c\u4e5f\u4e0d\u53ef\u7528\u554a\uff0c\u6570\u636e\u90fd\u6ca1\u4e86\u3002</p> <p>\u5f88\u53ef\u80fd\u8bf4\uff0c\u5927\u91cf\u7684\u8bf7\u6c42\u8fc7\u6765\uff0c\u7f13\u5b58\u5168\u90e8\u65e0\u6cd5\u547d\u4e2d\uff0c\u5728 redis \u91cc\u6839\u672c\u627e\u4e0d\u5230\u6570\u636e\uff0c\u8fd9\u4e2a\u65f6\u5019\u5c31\u6b7b\u5b9a\u4e86\uff0c\u51fa\u73b0\u7f13\u5b58\u96ea\u5d29\u95ee\u9898\u3002</p> <p>\u6240\u6709\u8bf7\u6c42\u6ca1\u6709\u5728 redis \u547d\u4e2d\uff0c\u5c31\u4f1a\u53bb mysql \u6570\u636e\u5e93\u8fd9\u79cd\u6570\u636e\u6e90\u5934\u4e2d\u53bb\u627e\uff0c\u4e00\u4e0b\u5b50 mysql \u627f\u63a5\u9ad8\u5e76\u53d1\uff0c\u7136\u540e\u5c31\u6302\u4e86...</p> <p>\u5982\u679c\u4f60\u628a redis \u6301\u4e45\u5316\u505a\u597d\uff0c\u5907\u4efd\u548c\u6062\u590d\u65b9\u6848\u505a\u5230\u4f01\u4e1a\u7ea7\u7684\u7a0b\u5ea6\uff0c\u90a3\u4e48\u5373\u4f7f\u4f60\u7684 redis \u6545\u969c\u4e86\uff0c\u4e5f\u53ef\u4ee5\u901a\u8fc7\u5907\u4efd\u6570\u636e\uff0c\u5feb\u901f\u6062\u590d\uff0c\u4e00\u65e6\u6062\u590d\u7acb\u5373\u5bf9\u5916\u63d0\u4f9b\u670d\u52a1\u3002</p> <p>Redis \u63d0\u4f9b\u4e24\u79cd\u6301\u4e45\u5316\u673a\u5236 RDB\uff08\u9ed8\u8ba4\uff09 \u548c AOF \u673a\u5236:</p>"},{"location":"redis/01.redis%E7%AE%80%E4%BB%8B/#rdb","title":"RDB(\u5feb\u7167)","text":"<p>RDB\uff1a\u662f Redis DataBase \u7f29\u5199\u3002\u662f\u4e00\u79cd\u5feb\u7167\u5f0f\u7684\u6301\u4e45\u5316\u65b9\u6cd5\uff0c\u5c06\u67d0\u4e00\u65f6\u523b\u7684\u6570\u636e\u6301\u4e45\u5316\u5230\u78c1\u76d8\u4e2d\u3002</p> <p>\u5728\u5ba2\u6237\u7aef\u4e2d\u6267\u884c <code>save</code> \u547d\u4ee4\uff0c\u5c31\u4f1a\u89e6\u53d1 Redis \u7684\u6301\u4e45\u5316\uff0c\u4f46\u540c\u65f6\u4e5f\u662f\u4f7f Redis \u5904\u4e8e\u963b\u585e\u72b6\u6001\u3002</p> <p>\u76f4\u5230 RDB \u6301\u4e45\u5316\u5b8c\u6210\uff0c\u624d\u4f1a\u54cd\u5e94\u5176\u4ed6\u5ba2\u6237\u7aef\u53d1\u6765\u7684\u547d\u4ee4\uff0c\u6240\u4ee5**\u5728\u751f\u4ea7\u73af\u5883\u4e00\u5b9a\u8981\u614e\u7528**\u3002</p> <p>bgsave\uff08background save\uff09\u5373\u540e\u53f0\u4fdd\u5b58\u7684\u610f\u601d\uff0c \u5b83\u548c <code>save</code> \u547d\u4ee4\u6700\u5927\u7684\u533a\u522b\u5c31\u662f <code>bgsave</code> \u4f1a fork() \u4e00\u4e2a\u5b50\u8fdb\u7a0b\u6765\u6267\u884c\u6301\u4e45\u5316\u3002</p> <p>\u6574\u4e2a\u8fc7\u7a0b\u4e2d\u53ea\u6709\u5728 fork() \u5b50\u8fdb\u7a0b\u65f6\u6709\u77ed\u6682\u7684\u963b\u585e\uff0c\u5f53\u5b50\u8fdb\u7a0b\u88ab\u521b\u5efa\u4e4b\u540e\uff0cRedis \u7684\u4e3b\u8fdb\u7a0b\u5c31\u53ef\u4ee5\u54cd\u5e94\u5176\u4ed6\u5ba2\u6237\u7aef\u7684\u8bf7\u6c42\u4e86\u3002</p> <p>\u76f8\u5bf9\u4e8e\u6574\u4e2a\u6d41\u7a0b\u90fd\u963b\u585e\u7684 <code>save</code> \u547d\u4ee4\u6765\u8bf4\uff0c\u663e\u7136 <code>bgsave</code> \u547d\u4ee4\u66f4\u9002\u5408\u6211\u4eec\u4f7f\u7528\u3002</p> <p>RDB\u662fRedis\u9ed8\u8ba4\u7684\u6301\u4e45\u5316\u65b9\u5f0f\u3002\u6309\u7167\u4e00\u5b9a\u7684\u65f6\u95f4\u5c06\u5185\u5b58\u7684\u6570\u636e\u4ee5\u5feb\u7167\u7684\u5f62\u5f0f\u4fdd\u5b58\u5230\u786c\u76d8\u4e2d\uff0c\u5bf9\u5e94\u4ea7\u751f\u7684\u6570\u636e\u6587\u4ef6\u4e3a dump.rdb\u3002</p> <p>\u901a\u8fc7\u914d\u7f6e\u6587\u4ef6\u4e2d\u7684save\u53c2\u6570\u6765\u5b9a\u4e49\u5feb\u7167\u7684\u5468\u671f\u3002</p> <p></p> <p>RDB \u5c31\u662fSnapshot\u5feb\u7167\u5b58\u50a8\uff0c\u662f\u9ed8\u8ba4\u7684\u6301\u4e45\u5316\u65b9\u5f0f\u3002\u53ef\u7406\u89e3\u4e3a\u534a\u6301\u4e45\u5316\u6a21\u5f0f\uff0c\u5373\u6309\u7167\u4e00\u5b9a\u7684\u7b56\u7565\u5468\u671f\u6027\u7684\u5c06\u6570\u636e\u4fdd\u5b58\u5230\u78c1\u76d8\u3002\u5bf9\u5e94\u4ea7\u751f\u7684\u6570\u636e\u6587\u4ef6\u4e3adump.rdb\uff0c\u901a\u8fc7\u914d\u7f6e\u6587\u4ef6\u4e2d\u7684save\u53c2\u6570\u6765\u5b9a\u4e49\u5feb\u7167\u7684\u5468\u671f\u3002\u4e0b\u9762\u662f\u9ed8\u8ba4\u7684\u5feb\u7167\u8bbe\u7f6e\uff1a</p> <pre><code># save m n\u00a0\u662f\u6307\u5728 m \u79d2\u5185\uff0c\u5982\u679c\u6709 n \u4e2a\u952e\u53d1\u751f\u6539\u53d8\uff0c\u5219\u81ea\u52a8\u89e6\u53d1\u6301\u4e45\u5316\u3002\n# \u53c2\u6570 m\u00a0\u548c\u00a0n\u00a0\u53ef\u4ee5\u5728\u00a0Redis\u00a0\u7684\u914d\u7f6e\u6587\u4ef6\u4e2d\u627e\u5230\uff0c\u4f8b\u5982\uff0csave 60 1\u00a0\u5219\u8868\u660e\u5728 60 \u79d2\u5185\uff0c\u81f3\u5c11\u6709\u4e00\u4e2a\u952e\u53d1\u751f\u6539\u53d8\uff0c\u5c31\u4f1a\u89e6\u53d1\u00a0RDB\u00a0\u6301\u4e45\u5316\u3002\n# \u81ea\u52a8\u89e6\u53d1\u6301\u4e45\u5316\uff0c\u672c\u8d28\u662f\u00a0Redis\u00a0\u901a\u8fc7\u5224\u65ad\uff0c\u5982\u679c\u6ee1\u8db3\u8bbe\u7f6e\u7684\u89e6\u53d1\u6761\u4ef6\uff0c\u81ea\u52a8\u6267\u884c\u4e00\u6b21\u00a0bgsave\u00a0\u547d\u4ee4\u3002\n# save\u53c2\u6570\u53ef\u4ee5\u914d\u7f6e\u591a\u7ec4\uff0c\u6ee1\u8db3\u5728\u4e0d\u540c\u6761\u4ef6\u7684\u5907\u4efd\u8981\u6c42\u3002\n\nsave 900 1     # \u5f53\u81f3\u5c11\u6709\u4e00\u6761Keys\u6570\u636e\u88ab\u6539\u53d8\u65f6\uff0c900\u79d2\u5237\u65b0\u5230Disk\u4e00\u6b21\nsave 300 10    # \u5f53\u670910\u6761Keys\u6570\u636e\u88ab\u6539\u53d8\u65f6\uff0c300\u79d2\u5237\u65b0\u5230Disk\u4e00\u6b21\nsave 60 10000  # \u5728 60 \u79d2\u5185\uff0c\u81f3\u5c11\u6709\u4e00\u4e2a\u952e\u53d1\u751f\u6539\u53d8\uff0c\u5c31\u4f1a\u89e6\u53d1\u00a0RDB\u00a0\u6301\u4e45\u5316\u5237\u5230\u78c1\u76d8\u3002\n</code></pre> <p>Redis \u7684 RDB \u6587\u4ef6\u4e0d\u4f1a\u574f\u6389\uff0c\u56e0\u4e3a\u5176**\u5199\u64cd\u4f5c\u662f\u5728\u4e00\u4e2a\u65b0\u8fdb\u7a0b\u4e2d\u8fdb\u884c\u7684**\u3002</p> <p>\u5f53\u751f\u6210\u4e00\u4e2a\u65b0\u7684 RDB \u6587\u4ef6\u65f6\uff0cRedis\u751f\u6210\u7684\u5b50\u8fdb\u7a0b\u4f1a\u5148\u5c06\u6570\u636e\u5199\u5230\u4e00\u4e2a\u4e34\u65f6\u6587\u4ef6\u4e2d\uff0c\u7136\u540e\u901a\u8fc7\u539f\u5b50\u6027 rename \u7cfb\u7edf\u8c03\u7528\u5c06\u4e34\u65f6\u6587\u4ef6\u91cd\u547d\u540d\u4e3a RDB \u6587\u4ef6\u3002\u8fd9\u6837\u5728\u4efb\u4f55\u65f6\u5019\u51fa\u73b0\u6545\u969c\uff0cRedis \u7684 RDB \u6587\u4ef6\u90fd\u603b\u662f\u53ef\u7528\u7684\u3002</p> <p>\u4f18\u70b9\uff1a</p> <ul> <li>1\u3001\u53ea\u6709\u4e00\u4e2a\u6587\u4ef6 dump.rdb\uff0c\u65b9\u4fbf\u6301\u4e45\u5316\u3002\u975e\u5e38\u9002\u5408\u5907\u4efd\u3002</li> <li>2\u3001\u5bb9\u707e\u6027\u597d\uff0c\u4e00\u4e2a\u6587\u4ef6\u53ef\u4ee5\u4fdd\u5b58\u5230\u5b89\u5168\u7684\u78c1\u76d8\u3002</li> <li>3\u3001\u6027\u80fd\u6700\u5927\u5316\uff0cfork \u5b50\u8fdb\u7a0b\u6765\u5b8c\u6210\u5199\u64cd\u4f5c\uff0c\u8ba9\u4e3b\u8fdb\u7a0b\u7ee7\u7eed\u5904\u7406\u547d\u4ee4\uff0c\u6240\u4ee5\u662f IO \u6700\u5927\u5316\u3002\u4f7f\u7528\u5355\u72ec\u5b50\u8fdb\u7a0b\u6765\u8fdb\u884c\u6301\u4e45\u5316\uff0c\u4e3b\u8fdb\u7a0b\u4e0d\u4f1a\u8fdb\u884c\u4efb\u4f55 IO \u64cd\u4f5c\uff0c\u4fdd\u8bc1\u4e86 redis \u7684\u9ad8\u6027\u80fd\u3002</li> <li>4\u3001\u76f8\u5bf9\u4e8e\u6570\u636e\u96c6\u5927\u65f6\uff0c\u6bd4 AOF \u7684\u542f\u52a8\u6548\u7387\u66f4\u9ad8\u3002</li> </ul> <p>\u7f3a\u70b9\uff1a</p> <ul> <li>1\u3001\u6570\u636e\u5b89\u5168\u6027\u4f4e\u3002RDB \u662f\u95f4\u9694\u4e00\u6bb5\u65f6\u95f4\u8fdb\u884c\u6301\u4e45\u5316\uff0c\u5982\u679c\u6301\u4e45\u5316\u4e4b\u95f4 redis \u53d1\u751f\u6545\u969c\uff0c\u4f1a\u53d1\u751f\u6570\u636e\u4e22\u5931\u3002\u6240\u4ee5\u8fd9\u79cd\u65b9\u5f0f\u66f4\u9002\u5408\u6570\u636e\u8981\u6c42\u4e0d\u4e25\u8c28\u7684\u65f6\u5019\u3002</li> <li>2\u3001AOF\uff08Append-only file)\u6301\u4e45\u5316\u65b9\u5f0f\uff1a \u662f\u6307\u6240\u6709\u7684\u547d\u4ee4\u884c\u8bb0\u5f55\u4ee5 redis \u547d\u4ee4\u8bf7 \u6c42\u534f\u8bae\u7684\u683c\u5f0f\u5b8c\u5168\u6301\u4e45\u5316\u5b58\u50a8)\u4fdd\u5b58\u4e3a aof \u6587\u4ef6\u3002</li> </ul>"},{"location":"redis/01.redis%E7%AE%80%E4%BB%8B/#aof","title":"AOF\u6301\u4e45\u5316","text":"<p>AOF\u65e5\u5fd7\u662f\u901a\u8fc7\u4fdd\u5b58 Redis \u5199\u547d\u4ee4\u6765\u8bb0\u5f55\u6570\u636e\u5e93\u6570\u636e\u7684\u3002</p> <p>\u5927\u591a\u6570\u7684\u6570\u636e\u5e93\u91c7\u7528\u7684\u662f**\u5199\u524d\u65e5\u5fd7\uff08WAL\uff09\uff0c\u4f8b\u5982MySQL\uff0c\u901a\u8fc7**\u5199\u524d\u65e5\u5fd7**\u548c**\u4e24\u9636\u6bb5\u63d0\u4ea4\uff0c\u5b9e\u73b0\u6570\u636e\u548c\u903b\u8f91\u7684\u4e00\u81f4\u6027\u3002</p> <p>AOF\u65e5\u5fd7\u91c7\u7528**\u5199\u540e\u65e5\u5fd7**\uff0c\u5373\u5148\u5199\u5185\u5b58\uff0c\u540e\u5199\u65e5\u5fd7\u3002</p> <p>Redis\u8981\u6c42\u9ad8\u6027\u80fd\uff0c\u91c7\u7528\u5199\u65e5\u5fd7\u6709\u4e24\u65b9\u9762\u597d\u5904\uff1a</p> <ol> <li>\u907f\u514d\u989d\u5916\u7684\u68c0\u67e5\u5f00\u9500</li> <li>\u4e0d\u4f1a\u963b\u585e\u5f53\u524d\u7684\u5199\u64cd\u4f5c</li> </ol> <p>\u4f46\u8fd9\u79cd\u65b9\u5f0f\u5b58\u5728\u6f5c\u5728\u98ce\u9669\uff1a</p> <ol> <li>\u5982\u679c\u547d\u4ee4\u6267\u884c\u5b8c\u6210\uff0c\u5199\u65e5\u5fd7\u4e4b\u524d\u5b95\u673a\u4e86\uff0c\u4f1a\u4e22\u5931\u6570\u636e\u3002</li> <li>\u4e3b\u7ebf\u7a0b\u5199\u78c1\u76d8\u538b\u529b\u5927\uff0c\u5bfc\u81f4\u5199\u76d8\u6162\uff0c\u963b\u585e\u540e\u7eed\u64cd\u4f5c\u3002</li> </ol> <p>AOF \u65e5\u5fd7\u8bb0\u5f55 Redis \u7684\u6bcf\u4e2a\u5199\u547d\u4ee4\uff0c\u6b65\u9aa4\u5206\u4e3a\uff1a\u547d\u4ee4\u8ffd\u52a0\uff08append\uff09\u3001\u6587\u4ef6\u5199\u5165\uff08write\uff09\u548c\u6587\u4ef6\u540c\u6b65\uff08sync\uff09\u3002</p> <p>\u547d\u4ee4\u8ffd\u52a0</p> <p>\u5f53AOF\u6301\u4e45\u5316\u529f\u80fd\u6253\u5f00\u4e86\uff0c\u670d\u52a1\u5668\u5728\u6267\u884c\u5b8c\u4e00\u4e2a\u5199\u547d\u4ee4\u4e4b\u540e\uff0c\u4f1a\u4ee5\u534f\u8bae\u683c\u5f0f\u5c06\u88ab\u6267\u884c\u7684\u5199\u547d\u4ee4\u8ffd\u52a0\u5230\u670d\u52a1\u5668\u7684 <code>aof_buf</code> \u7f13\u51b2\u533a\u3002</p> <p>\u6587\u4ef6\u5199\u5165\u548c\u540c\u6b65</p> <p>\u5173\u4e8e\u4f55\u65f6\u5c06 <code>aof_buf</code> \u7f13\u51b2\u533a\u7684\u5185\u5bb9\u5199\u5165AOF\u6587\u4ef6\u4e2d\uff0cRedis\u63d0\u4f9b\u4e86\u4e09\u79cd\u5199\u56de\u7b56\u7565\uff1a</p> <ul> <li><code>Always\uff0c\u540c\u6b65\u5199\u56de</code>\uff1a\u6bcf\u4e2a\u5199\u547d\u4ee4\u6267\u884c\u5b8c\uff0c\u7acb\u9a6c\u540c\u6b65\u5730\u5c06\u65e5\u5fd7\u5199\u56de\u78c1\u76d8\uff1b</li> <li><code>Everysec\uff0c\u6bcf\u79d2\u5199\u56de</code>\uff1a\u6bcf\u4e2a\u5199\u547d\u4ee4\u6267\u884c\u5b8c\uff0c\u53ea\u662f\u5148\u628a\u65e5\u5fd7\u5199\u5230AOF\u6587\u4ef6\u7684\u5185\u5b58\u7f13\u51b2\u533a\uff0c\u6bcf\u9694\u4e00\u79d2\u628a\u7f13\u51b2\u533a\u4e2d\u7684\u5185\u5bb9\u5199\u5165\u78c1\u76d8\uff1b</li> <li><code>No\uff0c\u64cd\u4f5c\u7cfb\u7edf\u63a7\u5236\u7684\u5199\u56de</code>\uff1a\u6bcf\u4e2a\u5199\u547d\u4ee4\u6267\u884c\u5b8c\uff0c\u53ea\u662f\u5148\u628a\u65e5\u5fd7\u5199\u5230AOF\u6587\u4ef6\u7684\u5185\u5b58\u7f13\u51b2\u533a\uff0c\u7531\u64cd\u4f5c\u7cfb\u7edf\u51b3\u5b9a\u4f55\u65f6\u5c06\u7f13\u51b2\u533a\u5185\u5bb9\u5199\u56de\u78c1\u76d8\u3002</li> </ul> <p>\u4e0a\u9762\u7684\u4e09\u79cd\u5199\u56de\u7b56\u7565\u4f53\u73b0\u4e86\u4e00\u4e2a\u91cd\u8981\u539f\u5219\uff1atrade-off\uff0c\u53d6\u820d\uff0c\u6307\u5728\u6027\u80fd\u548c\u53ef\u9760\u6027\u4fdd\u8bc1\u4e4b\u95f4\u505a\u53d6\u820d\u3002</p> <p>\u5173\u4e8eAOF\u7684\u540c\u6b65\u7b56\u7565\u662f\u6d89\u53ca\u5230\u64cd\u4f5c\u7cfb\u7edf\u7684 <code>write</code> \u51fd\u6570\u548c <code>fsync</code> \u51fd\u6570\u7684\uff0c\u5728\u300aRedis\u8bbe\u8ba1\u4e0e\u5b9e\u73b0\u300b\u4e2d\u662f\u8fd9\u6837\u8bf4\u660e\u7684\uff1a</p> <p>\u4e3a\u4e86\u63d0\u9ad8\u6587\u4ef6\u5199\u5165\u6548\u7387\uff0c\u5728\u73b0\u4ee3\u64cd\u4f5c\u7cfb\u7edf\u4e2d\uff0c\u5f53\u7528\u6237\u8c03\u7528<code>write</code>\u51fd\u6570\uff0c\u5c06\u4e00\u4e9b\u6570\u636e\u5199\u5165\u6587\u4ef6\u65f6\uff0c\u64cd\u4f5c\u7cfb\u7edf\u901a\u5e38\u4f1a\u5c06\u6570\u636e\u6682\u5b58\u5230\u4e00\u4e2a\u5185\u5b58\u7f13\u51b2\u533a\u91cc\u3002</p> <p>\u5f53\u7f13\u51b2\u533a\u7684\u7a7a\u95f4\u88ab\u586b\u6ee1\u6216\u8d85\u8fc7\u4e86\u6307\u5b9a\u65f6\u9650\u540e\uff0c\u624d\u771f\u6b63\u5c06\u7f13\u51b2\u533a\u7684\u6570\u636e\u5199\u5165\u5230\u78c1\u76d8\u91cc\u3002</p> <p>\u8fd9\u6837\u7684\u64cd\u4f5c\u867d\u7136\u63d0\u9ad8\u4e86\u6548\u7387\uff0c\u4f46\u4e5f\u4e3a\u6570\u636e\u5199\u5165\u5e26\u6765\u4e86\u5b89\u5168\u95ee\u9898\uff1a\u5982\u679c\u8ba1\u7b97\u673a\u505c\u673a\uff0c\u5185\u5b58\u7f13\u51b2\u533a\u4e2d\u7684\u6570\u636e\u4f1a\u4e22\u5931\u3002</p> <p>\u4e3a\u6b64\uff0c\u64cd\u4f5c\u7cfb\u7edf\u63d0\u4f9b\u4e86<code>fsync</code>\u3001<code>fdatasync</code>\u540c\u6b65\u51fd\u6570\uff0c\u53ef\u4ee5\u5f3a\u5236\u64cd\u4f5c\u7cfb\u7edf\u7acb\u523b\u5c06\u7f13\u51b2\u533a\u4e2d\u7684\u6570\u636e\u5199\u5165\u5230\u786c\u76d8\u91cc\uff0c\u4ece\u800c\u786e\u4fdd\u5199\u5165\u6570\u636e\u7684\u5b89\u5168\u6027\u3002</p>"},{"location":"redis/01.redis%E7%AE%80%E4%BB%8B/#aof_1","title":"AOF\u914d\u7f6e","text":"<p>\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cRedis\u662f\u6ca1\u6709\u5f00\u542fAOF\u7684\uff0c\u53ef\u4ee5\u901a\u8fc7\u914d\u7f6e redis.conf \u6587\u4ef6\u6765\u5f00\u542fAOF\u6301\u4e45\u5316</p> <pre><code># appendonly\u53c2\u6570\u5f00\u542fAOF\u6301\u4e45\u5316\nappendonly no\n\n# AOF\u6301\u4e45\u5316\u7684\u6587\u4ef6\u540d\uff0c\u9ed8\u8ba4\u662fappendonly.aof\nappendfilename \"appendonly.aof\"\n\n# AOF\u6587\u4ef6\u7684\u4fdd\u5b58\u4f4d\u7f6e\u548cRDB\u6587\u4ef6\u7684\u4f4d\u7f6e\u76f8\u540c\uff0c\u90fd\u662f\u901a\u8fc7dir\u53c2\u6570\u8bbe\u7f6e\u7684\ndir ./\n\n# \u540c\u6b65\u7b56\u7565\n# appendfsync always\nappendfsync everysec\n# appendfsync no\n\n# aof\u91cd\u5199\u671f\u95f4\u662f\u5426\u540c\u6b65\nno-appendfsync-on-rewrite no\n\n# \u91cd\u5199\u89e6\u53d1\u914d\u7f6e\nauto-aof-rewrite-percentage 100\nauto-aof-rewrite-min-size 64mb\n\n# \u52a0\u8f7daof\u51fa\u9519\u5982\u4f55\u5904\u7406\naof-load-truncated yes\n\n# \u6587\u4ef6\u91cd\u5199\u7b56\u7565\naof-rewrite-incremental-fsync yes\n</code></pre>"},{"location":"redis/01.redis%E7%AE%80%E4%BB%8B/#aof_2","title":"AOF\u91cd\u5199","text":"<p>AOF\u4f1a\u8bb0\u5f55\u6bcf\u4e2a\u5199\u547d\u4ee4\u5230AOF\u6587\u4ef6\uff0c\u968f\u7740\u65f6\u95f4\u8d8a\u6765\u8d8a\u957f\uff0cAOF\u6587\u4ef6\u4f1a\u53d8\u5f97\u8d8a\u6765\u8d8a\u5927\u3002</p> <p>\u5982\u679c\u4e0d\u52a0\u4ee5\u63a7\u5236\uff0c\u4f1a\u5bf9Redis\u670d\u52a1\u5668\uff0c\u751a\u81f3\u5bf9\u64cd\u4f5c\u7cfb\u7edf\u9020\u6210\u5f71\u54cd\uff0c\u800c\u4e14AOF\u6587\u4ef6\u8d8a\u5927\uff0c\u6570\u636e\u6062\u590d\u4e5f\u8d8a\u6162\u3002</p> <p>\u4e3a\u4e86\u89e3\u51b3AOF\u6587\u4ef6\u4f53\u79ef\u81a8\u80c0\u7684\u95ee\u9898\uff0cRedis\u63d0\u4f9bAOF\u6587\u4ef6\u91cd\u5199\u529f\u80fd\u6765\u5bf9AOF\u6587\u4ef6\u8fdb\u884c\"\u7626\u8eab\"\u3002</p> <p>Redis\u901a\u8fc7\u521b\u5efa\u4e00\u4e2a\u65b0\u7684AOF\u6587\u4ef6\u6765\u66ff\u6362\u73b0\u6709\u7684AOF\uff0c\u65b0\u65e7\u4e24\u4e2aAOF\u6587\u4ef6\u4fdd\u5b58\u7684\u6570\u636e\u76f8\u540c\uff0c\u4f46\u65b0AOF\u6587\u4ef6\u6ca1\u6709\u4e86\u5197\u4f59\u547d\u4ee4\u3002</p> <p>\u7b80\u5355\u6765\u8bf4\uff0cAOF\u91cd\u5199\u5c31\u662f\u628a\u65e7AOF\u65e5\u5fd7\u6587\u4ef6\u7684\u591a\u6761\u547d\u4ee4\uff0c\u5728\u91cd\u5199\u540e\u53d8\u6210\u65b0\u65e5\u5fd7\u6587\u4ef6\u7684\u4e00\u6761\u547d\u4ee4\u3002</p> <p>AOF\u91cd\u5199\u539f\u7406</p> <p>AOF\u91cd\u5199\u5e76\u4e0d\u9700\u8981\u5bf9\u539f\u6709AOF\u6587\u4ef6\u8fdb\u884c\u4efb\u4f55\u7684\u8bfb\u53d6\uff0c\u5199\u5165\uff0c\u5206\u6790\u7b49\u64cd\u4f5c\uff0c\u8fd9\u4e2a\u529f\u80fd\u662f\u901a\u8fc7\u8bfb\u53d6\u670d\u52a1\u5668\u5f53\u524d\u7684\u6570\u636e\u5e93\u72b6\u6001\u6765\u5b9e\u73b0\u7684\u3002</p> <p>AOF\u91cd\u5199\u4f1a\u963b\u585e\u5417\uff1fAOF\u91cd\u5199\u662f\u7531\u540e\u53f0\u7ebf\u7a0bbgrewriteaof\u6765\u5b8c\u6210\u7684\u3002</p> <p>AOF\u91cd\u5199\u8fc7\u7a0b</p> <p>\u7528\u4e00\u53e5\u8bdd\u603b\u7ed3\uff1a\u4e00\u4e2a\u62f7\u8d1d\uff0c\u4e24\u5904\u65e5\u5fd7\u3002\u4e00\u4e2a\u62f7\u8d1d\u6307\u4e00\u4efd\u5185\u5b58\u62f7\u8d1d\uff0c\u4e24\u5904\u65e5\u5fd7\u5206\u522b\u662f\u4e00\u5904\u6b63\u5728\u4f7f\u7528\u7684AOF\u65e5\u5fd7\uff0c\u53e6\u4e00\u5904\u662f\u65b0\u7684AOF\u91cd\u5199\u65e5\u5fd7\u3002</p>"},{"location":"redis/01.redis%E7%AE%80%E4%BB%8B/#aof_3","title":"\u5173\u4e8eAOF\u91cd\u5199\u8fc7\u7a0b\u7684\u6f5c\u5728\u963b\u585e\u98ce\u9669","text":"<p>\u524d\u9762\u63d0\u5230AOF\u91cd\u5199\u4e0d\u4f1a\u963b\u585e\uff0c\u6307\u7684\u662f\u5728AOF\u91cd\u5199\u8fc7\u7a0b\u4e0d\u4f1a\u963b\u585e\u4e3b\u7ebf\u7a0b\uff0c\u56e0\u4e3a\u662f\u901a\u8fc7\u540e\u53f0bgrewriteaof\u7ebf\u7a0b\u6765\u6267\u884c\u7684\u3002</p> <p>\u4f46\u662f\u5728fork\u5b50\u8fdb\u7a0b\u7684\u65f6\u5019\uff0cfork\u8fd9\u4e2a\u77ac\u95f4\u4e00\u5b9a\u662f\u4f1a\u963b\u585e\u4e3b\u7ebf\u7a0b\u7684\u3002</p> <p>fork\u91c7\u7528\u7684\u662f\u64cd\u4f5c\u7cfb\u7edf\u63d0\u4f9b\u7684\u5199\u65f6\u590d\u5236\uff08Copy On Write\uff09\u673a\u5236\uff0c\u907f\u514d\u4e00\u6b21\u6027\u62f7\u8d1d\u9020\u6210\u7684\u963b\u585e\u3002</p> <p>\u4f46fork\u5b50\u8fdb\u7a0b\u9700\u8981\u62f7\u8d1d\u8fdb\u7a0b\u5fc5\u8981\u7684\u6570\u636e\u7ed3\u6784\uff0c\u5176\u4e2d\u6709\u4e00\u9879\u662f**\u62f7\u8d1d\u5185\u5b58\u9875\u8868**\uff08\u865a\u62df\u5185\u5b58\u548c\u7269\u7406\u5185\u5b58\u7684\u6620\u5c04\u7d22\u5f15\u8868\uff09\uff0c\u8fd9\u4e2a\u62f7\u8d1d\u8fc7\u7a0b\u4f1a\u6d88\u8017\u5927\u91cf\u7684CPU\u8d44\u6e90\uff0c\u5728\u62f7\u8d1d\u5b8c\u6210\u4e4b\u524d\uff0c\u6574\u4e2a\u8fdb\u7a0b\u662f\u4f1a\u963b\u585e\u7684\u3002</p> <p>\u62f7\u8d1d\u5185\u5b58\u9875\u5b8c\u6210\u540e\uff0c\u5b50\u8fdb\u7a0b\u4e0e\u7236\u8fdb\u7a0b\u6307\u5411\u76f8\u540c\u7684\u5185\u5b58\u5730\u5740\u7a7a\u95f4\uff0c\u4e5f\u5c31\u662f\u8bf4\u6b64\u65f6\u867d\u7136\u4ea7\u751f\u4e86\u5b50\u8fdb\u7a0b\uff0c\u4f46\u662f\u5e76\u6ca1\u6709\u7533\u8bf7\u4e0e\u7236\u8fdb\u7a0b\u76f8\u540c\u7684\u5185\u5b58\u5927\u5c0f\u3002</p> <p>\u90a3\u4ec0\u4e48\u65f6\u5019\u7236\u5b50\u8fdb\u7a0b\u624d\u4f1a\u771f\u6b63\u5185\u5b58\u5206\u79bb\u5462\uff1f\u5728\u5199\u53d1\u751f\u65f6\uff0c\u624d\u771f\u6b63\u62f7\u8d1d\u5185\u5b58\u7684\u6570\u636e\uff0c\u8fd9\u4e2a\u8fc7\u7a0b\u4e2d\uff0c\u7236\u8fdb\u7a0b\u4e5f\u53ef\u80fd\u4f1a\u4ea7\u751f\u963b\u585e\u98ce\u9669\u3002</p> <p>\u56e0\u4e3a\u5185\u5b58\u5206\u914d\u662f\u4ee5\u9875\u4e3a\u5355\u4f4d\u8fdb\u884c\u5206\u914d\u7684\uff0c\u9ed8\u8ba44K\uff0c\u5982\u679c\u7236\u8fdb\u7a0b\u6b64\u65f6\u64cd\u4f5c\u7684\u662f\u4e00\u4e2abigkey\uff0c\u91cd\u65b0\u7533\u8bf7\u5927\u5757\u5185\u5b58\u8017\u65f6\u4f1a\u53d8\u957f\uff0c\u53ef\u80fd\u4f1a\u4ea7\u751f\u963b\u585e\u98ce\u9669\u3002</p> <p>\u53e6\u5916\uff0c\u5982\u679c\u64cd\u4f5c\u7cfb\u7edf\u5f00\u542f\u4e86\u5185\u5b58\u5927\u9875\u673a\u5236\uff08Huge Page\uff0c\u9875\u9762\u5927\u5c0f2M\uff09\u3002</p> <p>\u90a3\u4e48\u7236\u8fdb\u7a0b\u7533\u8bf7\u5185\u5b58\u65f6\u963b\u585e\u7684\u6982\u7387\u5c06\u4f1a\u5927\u5927\u63d0\u9ad8\uff0c\u6240\u4ee5**\u5728Redis\u673a\u5668\u4e0a\u9700\u8981\u5173\u95edHuge Page\u673a\u5236\u3002**</p> <p>\u53c2\u8003 https://www.cnblogs.com/liang24/p/14180036.html</p>"},{"location":"redis/01.redis%E7%AE%80%E4%BB%8B/#_17","title":"\u6587\u4ef6\u5199\u5165\u548c\u540c\u6b65","text":""},{"location":"redis/01.redis%E7%AE%80%E4%BB%8B/#redis-session","title":"redis \u5b9e\u73b0\u5206\u5e03\u5f0f session","text":"<p>\u4f20\u7edf\u7684 session \u7531\u670d\u52a1\u5668\u7aef\u751f\u6210\u5e76\u5b58\u50a8\uff0c\u5f53\u5e94\u7528\u8fdb\u884c\u5206\u5e03\u5f0f\u96c6\u7fa4\u90e8\u7f72\u7684\u65f6\u5019\uff0c  \u5982\u4f55\u4fdd\u8bc1\u4e0d\u540c\u670d\u52a1\u5668\u4e0asession\u4fe1\u606f\u80fd\u591f\u5171\u4eab\u5462\uff1f\u53ef\u4ee5\u4f7f\u7528 redis </p> <p>Cookie \u4fdd\u5b58\u5728\u5ba2\u6237\u7aef\u6d4f\u89c8\u5668\u4e2d\uff0c\u800c Session \u4fdd\u5b58\u5728\u670d\u52a1\u5668\u4e0a\u3002\u5ba2\u6237\u7aef\u6d4f\u89c8\u5668\u8bbf\u95ee\u670d\u52a1\u5668\u7684\u65f6\u5019\uff0c\u670d\u52a1\u5668\u628a\u5ba2\u6237\u7aef\u4fe1\u606f\u4ee5\u67d0\u79cd\u5f62\u5f0f\u8bb0\u5f55\u5728\u670d\u52a1\u5668\u4e0a\uff0c\u8fd9\u5c31\u662f Session\u3002</p> <p>\u5ba2\u6237\u7aef\u6d4f\u89c8\u5668\u518d\u6b21\u8bbf\u95ee\u65f6\u53ea\u9700\u8981\u4ece\u8be5 Session \u4e2d\u67e5\u627e\u8be5\u5ba2\u6237\u7684\u72b6\u6001\u5c31\u53ef\u4ee5\u4e86\u3002</p> <p>\u5728\u5b9e\u9645\u5de5\u4f5c\u4e2d\u6211\u4eec\u5efa\u8bae\u4f7f\u7528\u5916\u90e8\u7684\u7f13\u5b58\u8bbe\u5907\u6765\u5171\u4eab Session\uff0c\u907f\u514d\u5355\u4e2a\u670d\u52a1\u5668\u8282\u70b9\u6302\u6389\u800c\u5f71\u54cd\u670d\u52a1\uff0c\u5171\u4eab\u6570\u636e\u90fd\u4f1a\u653e\u5230\u5916\u90e8\u7f13\u5b58\u5bb9\u5668\u4e2d\u3002</p>"},{"location":"redis/01.redis%E7%AE%80%E4%BB%8B/#redis_21","title":"redis \u5f00\u53d1\u89c4\u8303","text":""},{"location":"redis/01.redis%E7%AE%80%E4%BB%8B/#redis_22","title":"\u5173\u4e8eredis\u7684\u7ecf\u5178\u6587\u7ae0\u4ee5\u53ca\u56de\u7b54","text":"<p>https://www.cnblogs.com/kevingrace/p/9004460.html</p> <p>https://v2ex.com/t/696387</p>"},{"location":"redis/01.redis%E7%AE%80%E4%BB%8B/#_18","title":"\u53cc\u5199\u4e00\u81f4\u6027","text":"<p>\u8ba1\u7b97\u673a\u79d1\u5b66\u9886\u57df\u53ea\u6709\u4e24\u4ef6\u96be\u4e8b\uff1a\u7f13\u5b58\u5931\u6548\u548c\u547d\u540d\u4e1c\u897f\u2014\u2014Phil Karlton</p> <p>\u7531\u4e8e\u662f redis \u548c rdbms \u90fd\u5b58\u653e\u4e86\u6570\u636e\uff0c\u6240\u4ee5\u5c31\u51fa\u73b0\u4e86\u4e00\u81f4\u6027\u95ee\u9898\u3002\u5982\u4f55\u4fdd\u8bc1\u5199\u64cd\u4f5c\u7684\u6570\u636e\u4e00\u81f4\u6027\uff0c\u5c31\u662f\u4e00\u4e2a\u95ee\u9898\u3002</p> <p>\u53cc\u5199\u4e00\u81f4\u6027\u7684\u542b\u4e49\u5c31\u662f\uff1a\u4fdd\u8bc1\u7f13\u5b58\u4e2d\u7684\u6570\u636e\u548cDB\u4e2d\u6570\u636e\u4e00\u81f4\u3002</p> <p>\u4f4e\u5e76\u53d1\u4e0b\u7684\u89e3\u51b3\u65b9\u6848</p> <p>\u5728\u5e76\u53d1\u4e0d\u5927\uff0c\u6216\u8005\u8bf4\u5bf9\u7f13\u5b58\u548cDB\u6570\u636e\u4e00\u81f4\u6027\u8981\u6c42\u4e0d\u662f\u5f88\u9ad8\u7684\u60c5\u51b5\u3002\u5927\u591a\u6570\u516c\u53f8\u90fd\u53ef\u4ee5\u7528\u8fd9\u79cd\u65b9\u6848\u4e86\u3002</p> <p>\u8be5\u95ee\u9898\u5c31\u662f\u7ecf\u5178\u7684\uff1a\u7f13\u5b58+\u6570\u636e\u5e93\u8bfb\u5199\uff08KV+DB\u8bfb\u5199\uff09\u7684\u6a21\u5f0f\uff0c\u5c31\u662f Cache Aside Pattern</p> <ul> <li>\u8bfb\u7684\u65f6\u5019\uff0c\u5148\u8bfb\u7f13\u5b58\uff0c\u7f13\u5b58\u6ca1\u6709\u7684\u8bdd\uff0c\u5c31\u8bfb\u6570\u636e\u5e93\uff0c\u53d6\u51fa\u6570\u636e\u540e\u653e\u5165\u7f13\u5b58\uff0c\u540c\u65f6\u8fd4\u56de\u54cd\u5e94\u3002</li> <li>\u66f4\u65b0\u7684\u65f6\u5019\uff0c\u5148\u66f4\u65b0\u6570\u636e\u5e93\uff0c\u7136\u540e\u518d\u5220\u9664\u7f13\u5b58\u3002</li> </ul> <p>\u5256\u6790\uff1a</p> <p>(1). \u4e3a\u4ec0\u4e48\u66f4\u65b0DB\u540e\uff0c\u662f\u5220\u9664\u7f13\u5b58\uff0c\u800c\u4e0d\u662f\u66f4\u65b0\u7f13\u5b58\u5462\uff1f</p> <p>\u4e3e\u4e2a\u4f8b\u5b50\uff0c\u6bd4\u5982\u8be5DB\u66f4\u65b0\u7684\u9891\u7387\u5f88\u9ad8\uff0c\u6bd4\u59821min\u4e2d\u5185\u66f4\u65b0100\u6b21\uff0c\u5982\u679c\u6bcf\u6b21\u90fd\u66f4\u65b0\u7f13\u5b58\uff0c\u7f13\u5b58\u4e5f\u5bf9\u5e94\u4e86\u66f4\u65b0\u4e86100\u6b21\u3002</p> <p>\u4f46\u7f13\u5b58\u5728\u8fd9\u4e00\u5206\u949f\u5185\u6839\u672c\u6ca1\u88ab\u8c03\u7528\uff0c\u6216\u8005\u8bf4\u8be5\u7f13\u5b5810min\u624d\u53ef\u80fd\u4f1a\u88ab\u67e5\u8be2\u4e00\u6b21\uff0c\u90a3\u4e48\u9891\u7e41\u66f4\u65b0\u7f13\u5b58\u662f\u4e0d\u662f\u5c31\u4ea7\u751f\u4e86\u5f88\u591a\u4e0d\u5fc5\u8981\u7684\u5f00\u9500\u5462\u3002</p> <p>\u9891\u7e41\u66f4\u65b0\u7684\u6570\u636e\uff0c\u5e76\u4e0d\u662f\u6bcf\u6b21\u66f4\u65b0\u90fd\u8981\u9a6c\u4e0a\u88ab\u5927\u91cf\u8bfb\uff0c\u53ea\u6709\u5728\u8981\u8bfb\u7684\u65f6\u5019\uff0c\u624d\u53bb\u7f13\u5b58\u6570\u636e\u3002</p> <p>\u8fd9\u91cc\u7684\u601d\u8def\u662f\uff1a\u7528\u5230\u7f13\u5b58\u7684\u65f6\u5019\uff0c\u624d\u53bb\u8ba1\u7b97\u7f13\u5b58\u3002\u8ba1\u7b97\u673a\u9886\u57df\u7ecf\u5178\u7684 lazy \u601d\u60f3\u3002</p> <p>\u975e\u5e38\u91cd\u8981\u7684\u4f18\u5316\u601d\u60f3\uff1a\u628a\u4efb\u52a1\u63a8\u8fdf\u5230\u5fc5\u987b\u7684\u65f6\u523b\uff0c\u597d\u5904\u662f\u907f\u514d\u91cd\u590d\u8ba1\u7b97\uff0c\u751a\u81f3\u4e0d\u8ba1\u7b97\u3002</p> <p>(2). \u8be5\u65b9\u6848\u9ad8\u5e76\u53d1\u573a\u666f\u4e0b\u662f\u5426\u9002\u7528\uff1f</p> <p>\u4e0d\u9002\u7528</p> <p>\u6bd4\u5982\u66f4\u65b0DB\u540e\uff0c\u7136\u540e\u8fd8\u6709\u6ca1\u6709\u6765\u5f97\u53ca\u5220\u9664\u7f13\u5b58\uff0c\u522b\u7684\u8bf7\u6c42\u5c31\u5df2\u7ecf\u8bfb\u53d6\u5230\u7f13\u5b58\u7684\u6570\u636e\u4e86\uff0c\u6b64\u65f6\u8bfb\u53d6\u7684\u6570\u636e\u548cDB\u4e2d\u7684\u5b9e\u9645\u7684\u6570\u636e\u662f\u4e0d\u4e00\u81f4\u7684\u3002</p> <p>\u4e0d\u7ba1\u662f\u5148\u5199MySQL\u6570\u636e\u5e93\uff0c\u518d\u5220\u9664Redis\u7f13\u5b58\uff1b\u8fd8\u662f\u5148\u5220\u9664\u7f13\u5b58\uff0c\u518d\u5199\u5e93\uff0c\u90fd\u6709\u53ef\u80fd\u51fa\u73b0\u6570\u636e\u4e0d\u4e00\u81f4\u7684\u60c5\u51b5\u3002</p> <p>3. \u9ad8\u5e76\u53d1\u4e0b\u7684\u89e3\u51b3\u65b9\u6848</p> <p>\u5ef6\u8fdf\u53cc\u5220</p> <p>\u5728\u5199\u5e93\u524d\u540e\u90fd\u8fdb\u884c redis.del(key) \u64cd\u4f5c\uff0c\u5e76\u4e14\u7b2c\u4e8c\u6b21\u5220\u9664\u901a\u8fc7\u5ef6\u8fdf\u7684\u65b9\u5f0f\u8fdb\u884c\u3002</p> <p>\u65b9\u6848\u4e00\uff08\u4e00\u79cd\u601d\u8def\uff0c\u4e0d\u4e25\u8c28\uff09\u5177\u4f53\u6b65\u9aa4\u662f\uff1a</p> <p>1\uff09\u5148\u5220\u9664\u7f13\u5b58\uff1b</p> <p>\u200b       \uff08\u5982\u679c\u5728\u5220\u9664\u7f13\u5b58\u4e4b\u540e\uff0c\u5199\u6570\u636e\u5e93\u4e4b\u524d\uff0c\u5982\u679c\u6709\u5176\u4ed6\u8fdb\u7a0b\u6765\u8bfb\u8fdb\u7a0b\u6765\u8bfb\uff0c\u5148\u8bfb\u7f13\u5b58\u6ca1\u8bfb\u5230\u518d\u53bb\u8bfb\u6570\u636e\u5e93\u53c8\u7f13\u5b58\u5230redis\u4e2d\u4e86\uff09</p> <p>2\uff09\u518d\u5199\u6570\u636e\u5e93\uff1b\uff08\u5982\u679c\u6ca1\u6709\u540e\u7eed\u7684\u5ef6\u8fdf\u53cc\u5220\uff0c\u90a3\u4e48\u6b64\u65f6\u6570\u636e\u5e93\u4e0eredis\u6570\u636e\u4e0d\u4e00\u81f4\uff0credis\u4e3a\u810f\u6570\u636e\uff09</p> <p>3\uff09\u4f11\u7720500\u6beb\u79d2\uff08\u6839\u636e\u5177\u4f53\u7684\u4e1a\u52a1\u65f6\u95f4\u6765\u5b9a\uff09\uff1b</p> <p>4\uff09\u518d\u6b21\u5220\u9664\u7f13\u5b58\u3002\uff08\u8fd9\u65f6\u5019\u5220\u9664\u7f13\u5b58\uff0c\u5c31\u662f\u628a\u53ef\u80fd\u5b58\u5728\u7684\u810f\u6570\u636e\u5237\u51faredis\uff09</p> <p>\u95ee\u9898\uff1a\u8fd9\u4e2a500\u6beb\u79d2\u600e\u4e48\u786e\u5b9a\u7684\uff0c\u5177\u4f53\u8be5\u4f11\u7720\u591a\u4e45\u65f6\u95f4\u5462\uff1f</p> <p>\u8fd9\u79cd\u7b56\u7565\u9700\u8981\u8003\u8651\u7684\uff1a</p> <ul> <li>\u9700\u8981\u8bc4\u4f30\u81ea\u5df1\u7684\u9879\u76ee\u7684\u8bfb\u6570\u636e\u4e1a\u52a1\u903b\u8f91\u7684\u8017\u65f6\u3002</li> <li>\u8fd9\u4e48\u505a\u7684\u76ee\u7684\uff0c\u5c31\u662f\u786e\u4fdd\u8bfb\u8bf7\u6c42\u7ed3\u675f\uff0c\u5199\u8bf7\u6c42\u53ef\u4ee5\u5220\u9664\u8bfb\u8bf7\u6c42\u9020\u6210\u7684\u7f13\u5b58\u810f\u6570\u636e\u3002</li> <li>\u5f53\u7136\u8fd9\u79cd\u7b56\u7565\u8fd8\u8981\u8003\u8651redis\u548c\u6570\u636e\u5e93\u4e3b\u4ece\u540c\u6b65\u7684\u8017\u65f6\u3002</li> <li>\u6700\u540e\u7684\u7684\u5199\u6570\u636e\u7684\u4f11\u7720\u65f6\u95f4\uff1a\u5219\u5728\u8bfb\u6570\u636e\u4e1a\u52a1\u903b\u8f91\u7684\u8017\u65f6\u57fa\u7840\u4e0a\uff0c\u52a0\u51e0\u767ems\u5373\u53ef\u3002\u6bd4\u5982\uff1a\u4f11\u77201\u79d2\u3002</li> </ul> <p>\u5176\u5b9e\u5ef6\u8fdf\u53cc\u5220\uff0c\u4e5f\u5e76\u4e0d\u80fd\u89e3\u51b3\u591a\u7ebf\u7a0b\u9ad8\u5e76\u53d1\u4e0b\u7684\u7edd\u5bf9\u4e00\u81f4\u3002</p> <p>\u9053\u7406\u5f88\u7b80\u5355\uff0c\u8fd9\u4e9b\u64cd\u4f5c\u662f\u4e00\u4e2a\u7ebf\u7a0b\uff08\u8fdb\u7a0b\uff09\u4e2d\u64cd\u4f5c\u591a\u4e2a\u8d44\u6e90\u5bf9\u8c61\uff08redis \u548c mysql\uff09\u3002</p> <p>\u5728\u9ad8\u5e76\u53d1\u573a\u666f\u4e0b\uff0c\u8fd8\u662f\u5b58\u5728\u8bf7\u6c42\u4e32\u8fdb\u6765\u7684\u60c5\u51b5\u300299% \u7684\u4eba\u5927\u90e8\u5206\u60c5\u51b5\u4e0b\u90fd\u9047\u4e0d\u5230\u8fd9\u4e48\u9ad8\u7684\u5e76\u53d1\u573a\u666f\uff0c\u8fd9\u91cc\u5c31\u7b80\u5355\u63d0\u4e00\u4e2a\u7f51\u4e0a\u770b\u5230\u7684\u65b9\u6848\uff1a</p> <p>https://github.com/doocs/advanced-java/issues/54</p> <p>\u9ad8\u5e76\u53d1\u4e0b\u4fdd\u8bc1\u7edd\u5bf9\u7684\u4e00\u81f4\uff0c\u5c31\u9700\u8981\u7528\u5230\u5185\u5b58\u961f\u5217\u505a\u5f02\u6b65\u4e32\u884c\u5316\u3002\u975e\u9ad8\u5e76\u53d1\u573a\u666f\uff0c\u53cc\u5220\u7b56\u7565\u57fa\u672c\u6ee1\u8db3\u4e86\u3002\u5982\u679c\u7279\u522b\u8981\u6c42\u5f3a\u4e00\u81f4\u6027\uff0c\u5e76\u4e0d\u9002\u5408\u653e\u5728redis</p>"},{"location":"redis/01.redis%E7%AE%80%E4%BB%8B/#_19","title":"\u7f13\u5b58\u96ea\u5d29","text":"<p>\u4ec0\u4e48\u53eb\u7f13\u5b58\u96ea\u5d29\uff1f</p> <p>\u5982\u679c\u6240\u6709\u7684 <code>Key</code> \u5931\u6548\u65f6\u95f4\u90fd\u662f12\u5c0f\u65f6\uff0c\u4e2d\u534812\u70b9\u5237\u65b0\u7684\uff0c\u6211\u96f6\u70b9\u6709\u4e2a\u79d2\u6740\u6d3b\u52a8\u5927\u91cf\u7528\u6237\u6d8c\u5165\uff0c\u5047\u8bbe\u5f53\u65f6\u6bcf\u79d2 6000 \u4e2a\u8bf7\u6c42\uff0c\u672c\u6765\u7f13\u5b58\u5728\u53ef\u4ee5\u625b\u4f4f\u6bcf\u79d2 5000 \u4e2a\u8bf7\u6c42\uff0c\u4f46\u662f\u7f13\u5b58\u5f53\u65f6\u6240\u6709\u7684Key\u90fd\u5931\u6548\u4e86\u3002</p> <p>\u6b64\u65f6 1 \u79d2 6000 \u4e2a\u8bf7\u6c42\u5168\u90e8\u843d\u6570\u636e\u5e93\uff0c\u6570\u636e\u5e93\u5fc5\u7136\u625b\u4e0d\u4f4f\uff0c\u5b83\u4f1a\u62a5\u4e00\u4e0b\u8b66\uff0c\u771f\u5b9e\u60c5\u51b5\u53ef\u80fdDBA\u90fd\u6ca1\u53cd\u5e94\u8fc7\u6765\u5c31\u76f4\u63a5\u6302\u4e86\u3002</p> <p>\u6b64\u65f6\uff0c\u5982\u679c\u6ca1\u7528\u4ec0\u4e48\u7279\u522b\u7684\u65b9\u6848\u6765\u5904\u7406\u8fd9\u4e2a\u6545\u969c\uff0cDBA \u5f88\u7740\u6025\uff0c\u91cd\u542f\u6570\u636e\u5e93\uff0c\u4f46\u662f\u6570\u636e\u5e93\u7acb\u9a6c\u53c8\u88ab\u65b0\u7684\u6d41\u91cf\u7ed9\u6253\u6b7b\u4e86\u3002\u8fd9\u5c31\u662f\u6211\u7406\u89e3\u7684\u7f13\u5b58\u96ea\u5d29\u3002</p> <p>\u5176\u5b9e redis \u6302\u4e86\uff0c\u8bf7\u6c42\u4e5f\u662f\u5168\u90e8\u6253\u5230\u6570\u636e\u5e93</p> <p>\u9488\u5bf9\u7b2c\u4e00\u79cd\u60c5\u51b5\uff0c\u53ef\u4ee5\u5b9e\u73b0 redis \u9ad8\u53ef\u7528\uff1aredis cluster \u6216 redis sentinel \u6a21\u5f0f\u3002</p> <p>\u96ea\u5d29\u7684\u5173\u952e\u95ee\u9898\u5728\u4e8e\uff1a\u5927\u91cf\u7684 key \u90fd\u5728\u540c\u4e00\u65f6\u95f4\u5931\u6548\uff0c\u867d\u7136 redis \u8fd8\u5728\uff0c\u51e0\u4e4e\u5c31\u76f8\u5f53\u4e8e redis \u6302\u4e86\u4e00\u6837</p> <p>\u5982\u679c\u8fd9\u65f6\u5019\u662f\u5927\u578b\u7f51\u7ad9\uff0c\u4e00\u76f4\u5904\u4e8e\u9ad8\u5e76\u53d1\u72b6\u6001\uff0c \u6240\u6709\u7684\u8bf7\u6c42\u90fd\u4f1a\u6253\u5230\u6570\u636e\u5e93\u4e0a\u3002\u8fd9\u65f6\u5019\u6570\u636e\u5e93\u538b\u529b\u5f88\u5927\uff0c\u5bfc\u81f4\u7cfb\u7edf\u5d29\u6e83</p> <p>\u540c\u4e00\u65f6\u95f4\u5927\u9762\u79ef\u5931\u6548\uff0c\u90a3\u4e00\u77ac\u95f4 Redis \u8ddf\u6ca1\u6709\u4e00\u6837\uff0c\u90a3\u8fd9\u4e2a\u6570\u91cf\u7ea7\u522b\u7684\u8bf7\u6c42\u76f4\u63a5\u6253\u5230\u6570\u636e\u5e93\u51e0\u4e4e\u662f\u707e\u96be\u6027\u7684\uff0c\u4f60\u60f3\u60f3\u5982\u679c\u6253\u6302\u7684\u662f\u4e00\u4e2a\u7528\u6237\u670d\u52a1\u7684\u5e93\uff0c\u90a3\u5176\u4ed6\u4f9d\u8d56\u4ed6\u7684\u5e93\u6240\u6709\u7684\u63a5\u53e3\u51e0\u4e4e\u90fd\u4f1a\u62a5\u9519\u3002</p> <p>\u5982\u679c\u6ca1\u505a\u7194\u65ad\u9650\u6d41\u7b49\u7b56\u7565\u57fa\u672c\u4e0a\u5c31\u662f\u77ac\u95f4\u6302\u4e00\u7247\u7684\u8282\u594f\uff0c\u4f60\u600e\u4e48\u91cd\u542f\u7528\u6237\u90fd\u4f1a\u628a\u4f60\u6253\u6302\uff0c\u7b49\u4f60\u80fd\u91cd\u542f\u7684\u65f6\u5019\uff0c\u7528\u6237\u65e9\u5c31\u7761\u89c9\u53bb\u4e86\uff0c\u5e76\u4e14\u5bf9\u4f60\u7684\u4ea7\u54c1\u5931\u53bb\u4e86\u4fe1\u5fc3\uff0c\u4ec0\u4e48\u5783\u573e\u4ea7\u54c1\u3002</p> <p>Redis\u7684KEYS\u547d\u4ee4\u5f15\u8d77\u5b95\u673a\u4e8b\u4ef6</p>"},{"location":"redis/01.redis%E7%AE%80%E4%BB%8B/#_20","title":"\u5982\u4f55\u907f\u514d\u96ea\u5d29","text":"<p>\u7b2c\u4e00\u79cd\u65b9\u6cd5\uff1a\u968f\u673a\u6570</p> <p>\u5bf9key\u7684\u5931\u6548\u65f6\u95f4\u52a0\u4e2a\u968f\u673a\u6570\uff08\u4e0d\u540c\u7684key\uff0c\u8bbe\u7f6e\u4e0d\u540c\u7684\u8fc7\u671f\u65f6\u95f4\uff09\u8ba9\u7f13\u5b58\u5931\u6548\u7684\u65f6\u95f4\u70b9\u5c3d\u91cf\u5747\u5300</p> <p>\u5904\u7406\u7f13\u5b58\u96ea\u5d29\u7684\u95ee\u9898\uff0c\u5728\u6279\u91cf\u5f80 Redis \u5b58\u6570\u636e\u7684\u65f6\u5019\uff0c\u628a\u6bcf\u4e2aKey\u7684\u5931\u6548\u65f6\u95f4\u90fd\u52a0\u4e2a\u968f\u673a\u503c\u5c31\u597d\u4e86\uff0c\u8fd9\u6837\u53ef\u4ee5\u4fdd\u8bc1\u6570\u636e\u4e0d\u4f1a\u5728\u540c\u4e00\u65f6\u95f4\u5927\u9762\u79ef\u5931\u6548\uff0c\u6211\u76f8\u4fe1\uff0cRedis \u8fd9\u70b9\u6d41\u91cf\u8fd8\u662f\u9876\u5f97\u4f4f\u7684\u3002</p> <pre><code>setRedis\uff08Key\uff0cvalue\uff0ctime + Math.random() * 10000\uff09\uff1b\n</code></pre> <p>\u7b2c\u4e8c\u79cd\u65b9\u6cd5\uff1a\u9488\u5bf9\u7cfb\u7edf\u7684\u4e00\u4e9b\u70ed\u70b9\u6570\u636e\uff0c \u53ef\u4ee5\u8bbe\u7f6e\u7f13\u5b58\u6c38\u4e0d\u8fc7\u671f\u3002 \uff08\u6216\u8005\u5b9a\u65f6\u66f4\u65b0\uff09</p> <p>\u7b2c\u4e09\u79cd\u65b9\u6cd5\uff1a\u53cc\u7f13\u5b58\u7b56\u7565</p> <p>\u8bbe\u7f6e\u4e24\u4e2a\u7f13\u5b58\uff0c\u539f\u59cb\u7f13\u5b58\u548c\u5907\u7528\u7f13\u5b58\uff0c\u539f\u59cb\u7f13\u5b58\u5931\u6548\u65f6\uff0c\u8bbf\u95ee\u5907\u7528\u7f13\u5b58\uff0c\u5907\u7528\u7f13\u5b58\u5931\u6548\u65f6\u95f4\u8bbe\u7f6e\u957f\u70b9\u3002</p> <p>\u8bbe\u7f6e\u4e8c\u7ea7\u7f13\u5b58\u67b6\u6784C1\u3001C2\uff0cC1\u5728\u524d\uff0cC2\u5728\u540e\uff0cC1\u7684\u7f13\u5b58\u53ef\u4ee5\u8bbe\u7f6e\u4e0d\u540c\u7684\u8fc7\u671f\u65f6\u95f4\uff0cC2\u7f13\u5b58\u4e0eDB\u4fdd\u6301\u5f3a\u4e00\u81f4\u6027\uff0c\u5b9e\u73b0\u6570\u636e\u540c\u6b65\u3002</p> <p>\u7b2c\u56db\u79cd\u65b9\u6cd5\uff1a\u9ad8\u53ef\u7528\u96c6\u7fa4</p> <p>\u4ece\u67b6\u6784\u5c42\u9762\u6765\u8bf4\uff1aRedis\u505a\u96c6\u7fa4\uff0c\u5c06\u70ed\u70b9\u6570\u636e\u5206\u914d\u5728\u4e0d\u540c\u7684master\u4e0a\uff0c\u51cf\u8f7b\u5355\u70b9\u538b\u529b\uff0c\u540c\u65f6master\u8981\u5bf9\u5e94\u591a\u4e2aslave\uff0c\u4fdd\u8bc1\u9ad8\u53ef\u7528\uff1b  \u7cfb\u7edf\u67b6\u6784\u8981\u6709\u5feb\u901f\u7194\u65ad\u7b56\u7565\uff0c\u51cf\u8f7b\u7cfb\u7edf\u7684\u538b\u529b\u3002 </p>"},{"location":"redis/01.redis%E7%AE%80%E4%BB%8B/#_21","title":"\u7f13\u5b58\u7a7f\u900f","text":"<p>\u4e1a\u52a1\u8bf7\u6c42\u7684\u6570\u636e\u7f13\u5b58\u4e2d\u6ca1\u6709\uff0cDB\u4e2d\u4e5f\u6ca1\u6709\uff0c\u5bfc\u81f4\u7c7b\u4f3c\u8bf7\u6c42\u76f4\u63a5\u8de8\u8fc7\u7f13\u5b58\uff0c\u53cd\u590d\u5728DB\u4e2d\u67e5\u8be2\uff0c\u4e0e\u6b64\u540c\u65f6\u7f13\u5b58\u4e5f**\u4e0d\u4f1a**\u5f97\u5230\u66f4\u65b0\u3002</p> <p>\u8fd9\u79cd\u60c5\u51b5\u53ef\u4ee5\u7406\u89e3\u4e3a\u5927\u91cf\u7684\u67e5\u8be2\uff0c\u662f\u65e0\u6548\u7684\u67e5\u8be2\uff0c\u5efa\u7acb\u8d77\u5927\u91cf\u65e0\u6548\u6570\u636e\u8fde\u63a5\u3002</p> <p>\u6211\u4eec\u6570\u636e\u5e93\u7684 id \u90fd\u662f1\u5f00\u59cb\u81ea\u589e\u4e0a\u53bb\u7684\uff0c\u5982\u53d1\u8d77\u4e3aid\u503c\u4e3a -1 \u7684\u6570\u636e\u6216 id \u4e3a\u7279\u522b\u5927\u4e0d\u5b58\u5728\u7684\u6570\u636e\u67e5\u8be2\u3002</p> <p>\u8fd9\u65f6\u7684\u7528\u6237\u5f88\u53ef\u80fd\u662f\u653b\u51fb\u8005\u6076\u610f\u6784\u9020\u7684\u5404\u79cd\u8bf7\u6c42\uff0c\u653b\u51fb\u4f1a\u5bfc\u81f4\u6570\u636e\u5e93\u538b\u529b\u8fc7\u5927\uff0c\u4e25\u91cd\u4f1a\u51fb\u57ae\u6570\u636e\u5e93\u3002</p> <p>\u5c0f\u70b9\u7684\u5355\u673a\u7cfb\u7edf\uff0c\u57fa\u672c\u4e0a\u7528postman\u5c31\u80fd\u641e\u6b7b\uff0c\u6bd4\u5982\u6211\u81ea\u5df1\u4e70\u7684\u963f\u91cc\u4e91\u670d\u52a1</p>"},{"location":"redis/01.redis%E7%AE%80%E4%BB%8B/#_22","title":"\u5982\u4f55\u907f\u514d\u7f13\u5b58\u7a7f\u900f","text":"<p>\u63a5\u53e3\u6821\u9a8c\u548c\u62e6\u622a</p> <p>\u5728\u63a5\u53e3\u5c42\u589e\u52a0\u6821\u9a8c\uff0c\u6bd4\u5982\u7528\u6237\u9274\u6743\u6821\u9a8c\uff0c\u53c2\u6570\u505a\u6821\u9a8c\uff0c\u4e0d\u5408\u6cd5\u7684\u53c2\u6570\u76f4\u63a5\u4ee3\u7801Return\uff0c\u6bd4\u5982\uff1aid \u505a\u57fa\u7840\u6821\u9a8c\uff0cid &lt;=0 \u7684\u76f4\u63a5\u62e6\u622a\u7b49\u3002</p> <p>\u5728\u5f00\u53d1\u7a0b\u5e8f\u7684\u65f6\u5019\u90fd\u8981\u6709\u4e00\u9897 \u201c\u4e0d\u4fe1\u4efb\u201d \u7684\u5fc3\uff0c\u5c31\u662f\u4e0d\u8981\u76f8\u4fe1\u4efb\u4f55\u8c03\u7528\u65b9\uff0c\u6bd4\u5982\u4f60\u63d0\u4f9b\u4e86API\u63a5\u53e3\u51fa\u53bb\uff0c\u4f60\u6709\u8fd9\u51e0\u4e2a\u53c2\u6570\u3002</p> <p>\u90a3\u6211\u89c9\u5f97\u4f5c\u4e3a\u88ab\u8c03\u7528\u65b9\uff0c\u4efb\u4f55\u53ef\u80fd\u7684\u53c2\u6570\u60c5\u51b5\u90fd\u5e94\u8be5\u88ab\u8003\u8651\u5230\uff0c\u505a\u6821\u9a8c\uff0c\u56e0\u4e3a\u4f60\u4e0d\u76f8\u4fe1\u8c03\u7528\u4f60\u7684\u4eba\uff0c\u4f60\u4e0d\u77e5\u9053\u4ed6\u4f1a\u4f20\u4ec0\u4e48\u53c2\u6570\u7ed9\u4f60\u3002</p> <p>\u4ece\u7f13\u5b58\u53d6\u4e0d\u5230\u7684\u6570\u636e\uff0c\u5728\u6570\u636e\u5e93\u4e2d\u4e5f\u6ca1\u6709\u53d6\u5230\uff0c\u8fd9\u65f6\u4e5f\u53ef\u4ee5\u5c06\u5bf9\u5e94 Key \u7684 Value \u5bf9\u5199\u4e3anull\u3001\u4f4d\u7f6e\u9519\u8bef\u3001\u7a0d\u540e\u91cd\u8bd5\u8fd9\u6837\u7684\u503c\u5177\u4f53\u53d6\u5565\u95ee\u4ea7\u54c1\u3002</p> <p>\u6216\u8005\u770b\u5177\u4f53\u7684\u573a\u666f\uff0c\u7f13\u5b58\u6709\u6548\u65f6\u95f4\u53ef\u4ee5\u8bbe\u7f6e\u77ed\u70b9\uff0c\u598230\u79d2\uff08\u8bbe\u7f6e\u592a\u957f\u4f1a\u5bfc\u81f4\u6b63\u5e38\u60c5\u51b5\u4e5f\u6ca1\u6cd5\u4f7f\u7528\uff09\u3002</p> <p>\u8fd9\u6837\u53ef\u4ee5\u9632\u6b62\u653b\u51fb\u7528\u6237\u53cd\u590d\u7528\u540c\u4e00\u4e2aid\u66b4\u529b\u653b\u51fb\uff0c\u4f46\u662f\u6211\u4eec\u8981\u77e5\u9053\u6b63\u5e38\u7528\u6237\u662f\u4e0d\u4f1a\u5728\u5355\u79d2\u5185\u53d1\u8d77\u8fd9\u4e48\u591a\u6b21\u8bf7\u6c42\u7684\uff0c\u90a3\u7f51\u5173\u5c42**Nginx**\u672c\u6e23\u6211\u4e5f\u8bb0\u5f97\u6709\u914d\u7f6e\u9879\uff0c\u53ef\u4ee5\u8ba9\u8fd0\u7ef4\u5927\u5927\u5bf9\u5355\u4e2aIP\u6bcf\u79d2\u8bbf\u95ee\u6b21\u6570\u8d85\u51fa\u9608\u503c\u7684IP\u90fd\u62c9\u9ed1\u3002</p>"},{"location":"redis/01.redis%E7%AE%80%E4%BB%8B/#redis-acl","title":"Redis \u8ba4\u8bc1\u548cACL","text":"<p>\u5728 Redis 6.0 \u4e2d\u5f15\u5165\u4e86 ACL\uff08Access Control List) \u7684\u652f\u6301\u5728\u6b64\u524d\u7684\u7248\u672c\u4e2d Redis \u4e2d\u662f\u6ca1\u6709\u7528\u6237\u7684\u6982\u5ff5\u7684\u3002</p> <p>\u5176\u5b9e\u8fd9\u6837\u662f\u6ca1\u6709\u529e\u6cd5\u5f88\u597d\u7684\u63a7\u5236\u6743\u9650\uff0credis 6.0 \u5f00\u59cb\u652f\u6301\u7528\u6237\uff0c\u53ef\u4ee5\u7ed9\u6bcf\u4e2a\u7528\u6237\u5206\u914d\u4e0d\u540c\u7684\u6743\u9650\u6765\u63a7\u5236\u6743\u9650\u3002</p> <p>\u540c\u4e00\u4e2aredis\u96c6\u7fa4\u7684\u6240\u6709\u5f00\u53d1\u90fd\u5171\u4eabdefault\u7528\u6237\uff0c\u96be\u514d\u4f1a\u51fa\u73b0\u8bef\u64cd\u4f5c\u628a\u522b\u4eba\u7684key\u5220\u6389\u6216\u8005\u6570\u636e\u6cc4\u9732\u7684\u60c5\u51b5\uff0c\u90a3\u4e4b\u524d\u6211\u4eec\u4e5f\u53ef\u4ee5\u4f7f\u7528rename command\u7684\u65b9\u5f0f\u7ed9\u4e00\u4e9b\u5371\u9669\u51fd\u6570\u91cd\u547d\u540d\u6216\u7981\u7528\uff0c\u4f46\u662f\u8fd9\u6837\u4e5f\u9632\u6b62\u4e0d\u4e86\u81ea\u5df1\u7684key\u88ab\u5176\u4ed6\u4eba\u8bbf\u95ee\u3002</p> <p>\u5728 6.0 \u4e4b\u524d\uff0c\u5982\u679c\u5f00\u542f\u4e86\u5bc6\u7801\u8ba4\u8bc1\uff0c\u6211\u4eec\u9700\u8981\u4f7f\u7528 <code>redis-cli -h host -p port</code>\u8fd9\u6837\u7684\u547d\u4ee4\u767b\u5f55\uff0c\u7136\u540e\u518d\u6267\u884c <code>auth password</code> \u547d\u4ee4\u6765\u4ea4\u4e92\u5f0f\u63d0\u4f9b\u5bc6\u7801\u6765\u8ba4\u8bc1\u3002</p> <p>\u4f46\u662f\u6ca1\u6709\u7528\u6237\u8fd9\u4e2a\u6982\u5ff5\u7684\uff0c\u8fd9\u5c31\u5bfc\u81f4\u6240\u6709\u7684\u5ba2\u6237\u7aef\u76f8\u5f53\u4e8e\u662f\u4f7f\u7528\u540c\u4e00\u4e2a\u8d26\u6237\u6765\u64cd\u4f5c\u540c\u4e00\u4e2a redis \u5b9e\u4f8b\u7684\uff0credis 6.0 \u6269\u5c55\u4e86 AUTH \u7684\u8bed\u6cd5:</p> <pre><code>AUTH &lt;username&gt; &lt;password&gt;\n</code></pre> <p>\u540c\u65f6\u4e5f\u517c\u5bb9\u4e86\u65e7\u7248\u672c\u7684 <code>AUTH</code>:</p> <pre><code>AUTH &lt;password&gt;\n</code></pre> <p>\u4f7f\u7528\u8fd9\u79cd\u65b9\u5f0f\u65f6\uff0c\u4e5f\u5c31\u662f\u53ea\u63d0\u4f9b\u5bc6\u7801\uff0c\u76f8\u5f53\u4e8e\u4f7f\u7528\u4e86\u4e00\u4e2a\u9ed8\u8ba4\u7684\u7528\u6237 \u201cdefault\u201d\uff0c\u901a\u8fc7\u8fd9\u6837\u7684\u65b9\u5f0f\uff0c\u5b9e\u73b0\u4e86\u5bf9\u4f4e\u7248\u672c\u7684\u517c\u5bb9\u3002</p> <ul> <li>\u901a\u8fc7\u9650\u5236\u5bf9\u547d\u4ee4\u548c\u5bc6\u94a5\u7684\u8bbf\u95ee\u6765\u63d0\u9ad8\u5b89\u5168\u6027\uff0c\u4ee5\u4f7f\u4e0d\u53d7\u4fe1\u4efb\u7684\u5ba2\u6237\u7aef\u65e0\u6cd5\u8bbf\u95ee\uff0c\u800c\u53d7\u4fe1\u4efb\u7684\u5ba2\u6237\u7aef\u4ec5\u5177\u6709\u5bf9\u6570\u636e\u5e93\u7684\u6700\u4f4e\u8bbf\u95ee\u7ea7\u522b\u624d\u80fd\u6267\u884c\u6240\u9700\u7684\u5de5\u4f5c\u3002\u4f8b\u5982\uff0c\u67d0\u4e9b\u5ba2\u6237\u7aef\u53ef\u80fd\u4ec5\u80fd\u591f\u6267\u884c\u53ea\u8bfb\u547d\u4ee4\uff0c</li> <li>\u63d0\u9ad8\u64cd\u4f5c\u5b89\u5168\u6027\uff0c\u4ee5\u9632\u6b62\u7531\u4e8e\u8f6f\u4ef6\u9519\u8bef\u6216\u4eba\u4e3a\u9519\u8bef\u800c\u5bfc\u81f4\u8fdb\u7a0b\u6216\u4eba\u5458\u8bbf\u95ee Redis\uff0c\u4ece\u800c\u635f\u574f\u6570\u636e\u6216\u914d\u7f6e\u3002\u4f8b\u5982\uff0c\u6ca1\u6709\u5fc5\u8981\u8ba9\u5de5\u4f5c\u4eba\u5458\u4ece Redis \u8c03\u7528 <code>FLUSHALL</code> \u547d\u4ee4\u3002</li> </ul> <p>ACL \u7684\u53e6\u4e00\u79cd\u5178\u578b\u7528\u6cd5\u4e0e\u6258\u7ba1Redis\u5b9e\u4f8b\u6709\u5173\u3002</p> <p>Redis\u901a\u5e38\u7531\u516c\u53f8\u5185\u90e8\u7ba1\u7406 redis \u57fa\u7840\u7ed3\u6784\u7684\u5185\u90e8\u56e2\u961f\u4e3a\u5176\u6240\u62e5\u6709\u7684\u5176\u4ed6\u5185\u90e8\u5ba2\u6237\u63d0\u4f9b\u7684\u4e00\u9879\u6258\u7ba1\u670d\u52a1\uff0c\u6216\u8005\u7531\u4e91\u63d0\u4f9b\u5546\u5728\u8f6f\u4ef6\u5373\u670d\u52a1\u8bbe\u7f6e\u4e2d\u63d0\u4f9b\u3002</p> <p>\u5728\u8fd9\u4e24\u79cd\u8bbe\u7f6e\u4e2d\uff0c\u6211\u4eec\u90fd\u5e0c\u671b\u786e\u4fdd\u4e3a\u5ba2\u6237\u6392\u9664\u914d\u7f6e\u547d\u4ee4\u3002</p> <p>\u8fc7\u53bb\uff0c\u901a\u8fc7\u547d\u4ee4\u91cd\u547d\u540d\u6765\u5b8c\u6210\u6b64\u64cd\u4f5c\u7684\u65b9\u6cd5\u662f\u4e00\u79cd\u6280\u5de7\uff0c\u5b83\u4f7f\u6211\u4eec\u53ef\u4ee5\u957f\u65f6\u95f4\u4e0d\u7528 ACL \u751f\u5b58\uff0c\u4f46\u4f7f\u7528\u4f53\u9a8c\u5e76\u4e0d\u7406\u60f3\u3002</p>"},{"location":"redis/01.redis%E7%AE%80%E4%BB%8B/#acl","title":"\u914d\u7f6eACL","text":"<p>\u914d\u7f6eACL\u7684\u65b9\u5f0f\u6709\u4e24\u79cd\uff0c\u4e00\u79cd\u662f\u5728 config \u6587\u4ef6\u4e2d\u76f4\u63a5\u914d\u7f6e\uff0c\u53e6\u4e00\u79cd\u662f\u5728\u5916\u90e8 aclfile \u4e2d\u914d\u7f6e\u3002</p> <p>\u914d\u7f6e\u7684\u547d\u4ee4\u662f\u4e00\u6837\u7684\uff0c\u4f46\u662f\u4e24\u79cd\u65b9\u5f0f\u53ea\u80fd\u9009\u62e9\u5176\u4e2d\u4e00\u79cd\uff0c\u6211\u4eec\u4e4b\u524d\u4f7f\u7528 requirepass \u7ed9 default \u7528\u6237\u8bbe\u7f6e\u5bc6\u7801 \u9ed8\u8ba4\u5c31\u662f\u4f7f\u7528 config \u7684\u65b9\u5f0f\u3002</p> <pre><code># \u6bd4\u5982\u5e38\u89c1\u7684\u5355\u673aredis\u914d\u7f6e\uff0c\u5c31\u662f\u5728redis.conf\u4e2d\u914d\u7f6edefault\u7528\u6237\u7684\u5bc6\u7801\nrequirepass 123456\n\n\n# \u5f53\u60a8\u8981\u4f7f\u7528\u5916\u90e8ACL\u6587\u4ef6\u65f6\uff0c\u9700\u8981\u5728redis.conf\u4e2d\u4f7f\u7528\u914d\u7f6e\u6307\u4ee4aclfile\u6765\u6307\u5b9a\u5916\u90e8acl\u6587\u4ef6\u8def\u5f84\naclfile /etc/redis/users.acl\n\n\n# \u5f53\u4ec5\u5728redis.conf\u6587\u4ef6\u5185\u90e8\u76f4\u63a5\u6307\u5b9a\u51e0\u4e2a\u7528\u6237\u65f6\uff0c\u53ef\u4ee5\u4f7f\u7528CONFIG REWRITE\u4ee5\u4fbf\u901a\u8fc7\u91cd\u5199\u5c06\u65b0\u7684\u7528\u6237\u914d\u7f6e\u5b58\u50a8\u5728\u6587\u4ef6\u4e2d\u3002\n</code></pre>"},{"location":"redis/01.redis%E7%AE%80%E4%BB%8B/#acl_1","title":"ACL\u89c4\u5219","text":"<p>\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528 ACL LIST \u547d\u4ee4\u6765\u68c0\u67e5\u5f53\u524d\u6709\u6548\u7684 ACL \u89c4\u5219\u3002\u4f7f\u7528 ACL LIST \u786e\u8ba4\u521a\u542f\u52a8\u7684\uff0c\u4f7f\u7528\u9ed8\u8ba4\u914d\u7f6e\u7684 Redis \u5b9e\u4f8b ACL \u89c4\u5219\u5982\u4e0b\uff1a</p>"},{"location":"redis/01.redis%E7%AE%80%E4%BB%8B/#redis_23","title":"Redis\u5f00\u53d1\u89c4\u8303","text":""},{"location":"redis/01.redis%E7%AE%80%E4%BB%8B/#redis_24","title":"redis\u5b89\u5168","text":""},{"location":"redis/01.redis%E7%AE%80%E4%BB%8B/#_23","title":"\u5b89\u5168\u6a21\u578b","text":"<p>redis \u662f\u8bbe\u8ba1\u6210\u5728\u4e00\u4e2a\u5b89\u5168\u7684\u5185\u7f51\u73af\u5883\u4e2d\uff0c\u88ab\u53ef\u4fe1\u4efb\u7684\u5185\u7f51\u5ba2\u6237\u7aef\u8bbf\u95ee\u7684\u3002\u8fd9\u610f\u5473\u7740\u901a\u5e38\u4e0d\u4f1a\u628a</p>"},{"location":"redis/01.redis%E7%AE%80%E4%BB%8B/#redis-cluster_4","title":"redis \u4e09\u8282\u70b9-cluster\u90e8\u7f72","text":""},{"location":"redis/01.redis%E7%AE%80%E4%BB%8B/#_24","title":"\u96c6\u7fa4\u89c4\u5212","text":"<p>\u4e09\u53f0\u670d\u52a1\u5668\u5404\u90e8\u7f72\u4e00\u4e2a\u4e3b\u8282\u70b9\u3001\u4e00\u4e2a\u4ece\u8282\u70b9\uff0c\u540c\u4e00\u53f0\u670d\u52a1\u5668\u4e0a\u4e0d\u662f\u76f4\u63a5\u4e3b\u4ece\u5173\u7cfb\u3002</p> \u670d\u52a1\u5668 \u64cd\u4f5c\u7cfb\u7edf \u89d2\u8272 ip:\u7aef\u53e3 node1 CentOS Linux release 7.6.1810 master1/slave2 192.168.1.199:6379/192.168.1.199:6380 node2 CentOS Linux release 7.6.1810 master2/slave3 192.168.1.200:6379/192.168.1.200:6380 node3 CentOS Linux release 7.6.1810 master3/slave1 192.168.1.201:6379/192.168.1.201:6380"},{"location":"redis/01.redis%E7%AE%80%E4%BB%8B/#_25","title":"\u51c6\u5907\u5de5\u4f5c","text":"<p>\u4ee5\u4e0b\u90fd\u8981\u5728\u4e09\u4e2a\u8282\u70b9\u4e0a\u51c6\u5907\uff1a</p> <pre><code># vi /etc/hosts\uff0c\u7ed9\u4e09\u53f0\u4e3b\u673a\u90fd\u8bbe\u7f6ehosts\n192.168.1.199 node1 \n192.168.1.200 node2\n192.168.1.201 node3\n\n# \u9632\u706b\u5899\nsudo firewall-cmd --zone=public --add-port=6379/tcp --permanent\nsudo firewall-cmd --zone=public --add-port=6380/tcp --permanent\nsudo firewall-cmd --zone=public --add-port=16379/tcp --permanent\nsudo firewall-cmd --zone=public --add-port=16380/tcp --permanent\nsudo firewall-cmd --permanent --zone=public --list-ports\nsudo firewall-cmd --reload\n\n\n## \u51c6\u5907gcc\u73af\u5883\n# \u67e5\u770b\uff0c\u5982\u679c\u662fgcc version 4.8.5\uff0c\u5219\u770b\u4e0b\u9762\ngcc -v\n\n# centos7 \u9ed8\u8ba4\u7684 gcc \u7248\u672c\u4e3a\uff1a4.8.5 &lt; 5.3 \u65e0\u6cd5\u7f16\u8bd1\uff0c\u9700\u8981\u51c6\u5907\u65b0\u7684gcc\uff0c\u5e76\u8bbe\u7f6e\u9ed8\u8ba4gcc\nsudo yum -y install centos-release-scl tcl tclx tcl-devel  \nsudo yum -y install devtoolset-9-gcc devtoolset-9-gcc-c++ devtoolset-9-binutils \n# \u4e34\u65f6\u6709\u6548\uff0c\u9000\u51fa shell \u6216\u91cd\u542f\u4f1a\u6062\u590d\u539f gcc \u7248\u672c\nsudo scl enable devtoolset-9 bash\n# \u957f\u671f\u6709\u6548\nsudo echo \"source /opt/rh/devtoolset-9/enable\" &gt;&gt;/etc/profile\n\n# \u67e5\u770bgcc\u7248\u672c\uff1a\ngcc -v\n\n\n# \u4e0b\u8f7d\u5f53\u524d\u6700\u65b0\u7684\u6e90\u4ee3\u7801\u5305\nwget http://download.redis.io/releases/redis-6.2.4.tar.gz -O  /usr/local/src/redis-6.2.4.tar.gz\ncd /usr/local/src/\n# \u7f16\u8bd1\u5b89\u88c5\uff0c\u7f16\u8bd1\u5b89\u88c5\u540e\uff0c\u4e8c\u8fdb\u5236\u6587\u4ef6\u4f1a\u88ab\u590d\u5236\u5230/usr/local/bin\u76ee\u5f55\u4e0b\ntar xf redis-6.0.5.tar.gz\ncd redis-6.0.5\n# \u7f16\u8bd1\u53c2\u6570 USE_SYSTEMD=yes BUILD_TLS=yes # \u5728ubuntu\u4f7f\u7528\u8fd9\u4e2a\u53c2\u6570 MALLOC=libc\nmake  \n# \u9ed8\u8ba4\u4f1a\u628a\u4e8c\u8fdb\u5236\u6587\u4ef6\u5b89\u88c5\u5230 /usr/local/bin \u3002\u4e5f\u53ef\u4ee5 make PREFIX=/some/other/directory install \u6307\u5b9a\u4e0d\u540c\u76ee\u5f55\nsudo make install\n\n\n\n\n# \u521b\u5efa\u65e5\u5fd7\u76ee\u5f55\u548c\u5de5\u4f5c\u76ee\u5f55\nmkdir -p /var/log/redis/\nmkdir -p /var/lib/redis/6379\nmkdir -p /var/lib/redis/6380\n\n\n# \u521b\u5efa\u914d\u7f6e\u76ee\u5f55\nsudo mkdir /etc/redis/\n# \u628a\u9ed8\u8ba4\u914d\u7f6e\u6587\u4ef6\u53bb\u6389\u7a7a\u683c\ngrep -v '^#' redis.conf | grep -v '^$' &gt;  /etc/redis/6379.conf\n\n\n\ncp utils/redis_init_script  \n</code></pre>"},{"location":"redis/01.redis%E7%AE%80%E4%BB%8B/#redis-sentinel","title":"redis \u4e09\u8282\u70b9-sentinel\u90e8\u7f72","text":"<p>\u4e00\u4e3b\u4e8c\u4ece\u4e09\u54e8\u5175</p> <p>redis \u54e8\u5175\u96c6\u7fa4\u6700\u5c11\u8981\u4e09\u4e2a\u8282\u70b9\u3002</p> <ul> <li>\u54e8\u5175\u8fdb\u7a0b\u7684\u53ef\u6267\u884c\u6587\u4ef6\uff0c\u7f16\u8bd1\u5b89\u88c5\u540e\u7684 redis-sentinel \u3002\u4e00\u822c\u4f4d\u4e8e /usr/local/bin/redis-sentinel</li> <li>\u54e8\u5175\u914d\u7f6e\u6587\u4ef6\uff0c\u4f4d\u4e8eredis\u89e3\u538b\u6839\u76ee\u5f55\u4e0b redis.conf \u3002/usr/local/src/redis-6.0.5/sentinel.conf</li> </ul> <p>\u6bcf\u4e00\u4e2a\u54e8\u5175**\u90fd\u53ef\u4ee5\u53bb**\u76d1\u63a7\u591a\u4e2amaster-slaves\u7684\u4e3b\u4ece\u67b6\u6784\u3002</p> <p>\u56e0\u4e3a\u751f\u4ea7\u73af\u5883\u4e00\u822c\u4f1a \u90e8\u7f72\u591a\u4e2amaster-slaves\u7684redis\u4e3b\u4ece\u96c6\u7fa4\u3002\u76f8\u540c\u7684\u4e00\u5957\u54e8\u5175\u96c6\u7fa4\uff0c\u53ef\u4ee5\u53bb \u76d1\u63a7\u4e0d\u540c\u7684\u591a\u4e2aredis\u4e3b\u4ece\u96c6\u7fa4**\u3002**</p> <p>\u54e8\u5175\u9ed8\u8ba4\u662f\u752826279\u7aef\u53e3\uff0c\u9ed8\u8ba4\u4e0d\u80fd\u8ddf\u5176\u4ed6\u96c6\u7fa4\u5728\u6307\u5b9a\u7aef\u53e3\u8054\u901a\uff0c\u53ea\u80fd\u5728\u672c\u5730\u8bbf\u95ee\u3002</p>"},{"location":"redis/02.redis%E5%AE%A2%E6%88%B7%E7%AB%AF/","title":"redis","text":"<p>\u53ef\u80fd\u8fd9\u662f Redis \u53ef\u89c6\u5316\u5de5\u5177\u6700\u5168\u7684\u6a2a\u5411\u8bc4\u6d4b</p> <p>RedisInsight\u662fRedis\u5b98\u65b9\u51fa\u54c1\u7684\u53ef\u89c6\u5316\u7ba1\u7406\u5de5\u5177\uff0c\u53ef\u7528\u4e8e\u8bbe\u8ba1\u3001\u5f00\u53d1\u3001\u4f18\u5316\u4f60\u7684Redis\u5e94\u7528\u3002\u652f\u6301\u6df1\u8272\u548c\u6d45\u8272\u4e24\u79cd\u4e3b\u9898\uff0c\u754c\u9762\u975e\u5e38\u70ab\u9177\u3002\u5b83\u652f\u6301Windows\u3001Linux\u4ee5\u53caMac\u5e73\u53f0\u3002</p> <p>\u53ef\u652f\u6301String\u3001Hash\u3001Set\u3001List\u3001JSON\u7b49\u591a\u79cd\u6570\u636e\u7c7b\u578b\u7684\u7ba1\u7406\uff0c\u540c\u65f6\u652f\u6301\u8fdc\u7a0b\u4f7f\u7528CLI \u529f\u80fd\uff0c\u529f\u80fd\u975e\u5e38\u5f3a\u5927\u3002</p> <p>\u57fa\u4e8eElectron, Elastic UI, Monaco Editor, NodeJS\u5f00\u53d1\uff0c\u662f\u5f00\u6e90\u7684\uff0c\u76ee\u524d\u4e5f\u6ca1\u6709\u63d0\u5230\u662f\u5426\u4f1a\u6536\u8d39\uff0c\u4e0d\u8fc7\u5c5e\u4e8eredis-enterprise\u3002 \u5f00\u6e90\u5730\u5740</p> <p>\u6700\u65b0\u684c\u9762\u7248\u611f\u89c9\u548c\u4ee5\u524d\u7684Redis Desktop Manager\u4e4b\u7c7b\u7684\u5ba2\u6237\u7aef\u4e5f\u5dee\u4e0d\u591a\u3002</p> <p>\u76ee\u524d\u6700\u65b0\u7684RedisInsight\u662f2.x\u7248\u672c\uff0c\u5df2\u7ecf\u662f\u72ec\u7acb\u7684\u5ba2\u6237\u7aef\u4e86\uff0c\u57fa\u4e8eElectron\u3002 RedisInsight\u76841.x\u7248\u672c\u662f\u57fa\u4e8eWeb\u7684\uff0c\u53ef\u4ee5\u7528Docker\u8fd0\u884c\uff0c\u684c\u9762\u7248\u4e5f\u662f\u8fd0\u884c\u4e00\u4e2a8001\u670d\u52a1\u7aef\u53e3\uff0c\u7136\u540e\u7528\u6d4f\u89c8\u5668\u8bbf\u95ee\u3002</p> <p>tableplus  https://tableplus.com/ \u652f\u6301\u591a\u79cd\u6570\u636e\u5e93\uff0cModern, native, and friendly GUI tool for relational databases: MySQL, PostgreSQL, SQLite &amp; more</p>"},{"location":"redis/02.redis%E5%AE%A2%E6%88%B7%E7%AB%AF/#anotherredisdesktopmanager","title":"AnotherRedisDesktopManager","text":""},{"location":"redis/02.redis%E5%AE%A2%E6%88%B7%E7%AB%AF/#vscode","title":"vscode\u6269\u5c55","text":""},{"location":"redis/02.redis%E5%AE%A2%E6%88%B7%E7%AB%AF/#g-dis","title":"G-dis","text":""},{"location":"sql/sql2023/","title":"\u6982\u8ff0","text":"<p>SQL\u867d\u662f\u4e00\u95e8\u53e4\u8001\u7684\u6280\u672f\uff0c\u4f46\u5374\u5e76\u975e\u505c\u6ede\u4e0d\u524d\u3002\u770b\u4e0b\u5386\u4ee3SQL\u6807\u51c6\u5e74\u8868\uff1a</p> <p>SQL-86 SQL-89 SQL-92 SQL:1999 SQL:2003 SQL:2006 SQL:2008 SQL:2011 SQL:2016 SQL:2023</p> <p>\u6807\u51c6\u8fd9\u79cd\u4e1c\u897f\u8fed\u4ee3\u592a\u5feb\u4e5f\u4e0d\u884c\uff0c\u4e0d\u7136\u5c31\u7b97\u7a0b\u5e8f\u5458\u4eec\u7684\u5934\u53d1\u80fd\u53d7\u4e86\uff0c\u6570\u636e\u5e93\u5382\u5bb6\u4e5f\u53d7\u4e0d\u4e86\uff0c\u6240\u4ee5\u76ee\u524dSQL\u6807\u51c6\u8fd9\u79cd\u7a33\u5065\u7684\u8fed\u4ee3\u662f\u6bd4\u8f83\u6b63\u786e\u7684\u505a\u6cd5\u3002</p> <p>\u4f46\u5373\u4f7f\u8fd9\u6837\uff0c\u6570\u636e\u5e93\u5382\u5bb6\u4eec\u4e5f\u6ca1\u80fd\u8ddf\u4e0a\u8282\u594f\uff0c\u81f3\u4eca\u6ca1\u6709\u4efb\u4f55\u4e00\u5bb6\u6570\u636e\u5e93\u4ea7\u54c1\u58f0\u79f0\u5b8c\u5168\u7b26\u5408<code>SQL:2016</code>\u7684\u6838\u5fc3\u7279\u6027\u3002</p> <p><code>SQL</code>\u6807\u51c6\u6bcf\u9694\u51e0\u5e74\u5c31\u4f1a\u53d1\u5e03\u4e00\u6b21\uff0c\u56fd\u9645\u6807\u51c6\u5316\u7ec4\u7ec7\uff08ISO\uff09\u4e8e2023\u5e746\u67081\u65e5\u6b63\u5f0f\u53d1\u5e03\u4e86\u6700\u65b0<code>SQL</code>\u6807\u51c6\uff0c\u4e5f\u5c31\u662f<code>SQL:2023</code>\u3002Peter Eisentraut\u5728\u8fd9\u7bc7\u6587\u7ae0\u6709\u8be6\u7ec6\u7684\u793a\u8303\u8bf4\u660e\uff1a</p> <p>https://peter.eisentraut.org/blog/2023/04/04/sql-2023-is-finished-here-is-whats-new</p> <p>\u6587\u7ae0\u5bf9<code>SQL:2023</code>\u6807\u51c6\u8fdb\u884c\u4e86\u5206\u6790\uff0c\u5e76\u5f52\u7c7b\u4e86\u4e09\u5927\u7c7b\u522b\u65b9\u9762\u7684\u53d8\u5316\uff1a</p> <ul> <li>\u5f53\u524dSQL\u8bed\u8a00\u7684\u4e00\u4e9b\u5c0f\u53d8\u66f4</li> <li>JSON\u76f8\u5173\u7684\u529f\u80fd\u7279\u6027</li> <li>\u65b0\u5f15\u5165\u56fe\u67e5\u8be2\u7684\u63a5\u53e3</li> </ul> <p>\u6587\u7ae0\u56f4\u7ed5\u8fd9\u4e09\u65b9\u9762\u8fdb\u884c\u4e86\u793a\u4f8b\u8bf4\u660e\uff0c\u540c\u65f6\u4f5c\u8005\u53c8\u7d27\u63a5\u7740\u5206\u6790\u4e86PostgreSQL\u6570\u636e\u5e93\u5bf9SQL:2023\u6807\u51c6\u7684\u652f\u6301\u60c5\u51b5\uff0c\u53c2\u8003\u6587\u7ae0\u5982\u4e0b\uff1a</p> <p>https://peter.eisentraut.org/blog/2023/04/18/postgresql-and-sql-2023</p> <p>PostgreSQL supports most of the major features of SQL:2023. Out of 177 mandatory features required for full Core conformance, PostgreSQL conforms to at least 170. In addition, there is a long list of supported optional features. It might be worth noting that at the time of writing, no current version of any database management system claims full conformance to Core SQL:2023.</p> UNIQUE null treatment (F292) PostgreSQL 15 ORDER BY in grouped table (F868) ancient GREATEST and LEAST (T054) ancient String padding functions (T055) ancient Multi-character TRIM functions (T056) ancient Optional string types maximum length (T081) ancient Enhanced cycle mark values (T133) PostgreSQL 14 ANY_VALUE (T626) PostgreSQL 16 Non-decimal integer literals (T661) PostgreSQL 16 Underscores in numeric literals (T662) PostgreSQL 16 JSON data type (T801) PostgreSQL 9.2/9.4 Enhanced JSON data type (T802) future String-based JSON (T803) not planned Hex integer literals in SQL/JSON path language (T840) PostgreSQL 16 SQL/JSON simplified accessor (T860\u2013T864) future SQL/JSON item methods (T865\u2013T878) future JSON comparison (T879\u2013T882) PostgreSQL 9.4 Property Graph Queries future <p>Notes:</p> <ul> <li>\"ancient\" means sometime before PostgreSQL 10. These are features that were already widely available in SQL implementations before they were added to the standard.</li> <li>As of this writing, PostgreSQL 16 is in feature freeze but not released yet. So those entries could in theory change, but it\u2019s pretty unlikely. Conformance information for PostgreSQL 16 relative to SQL:2023 can also be found in the documentation.</li> <li>For the T801 entry, the <code>json</code> type was added in PostgreSQL 9.2 and the <code>jsonb</code> type was added in PostgreSQL 9.4. Most of the JSON functionality in SQL:2016 and SQL:2023 (including features T879 ff.) maps more readily to the <code>jsonb</code> type, so this information should be interpreted that way. Whether and how the <code>json</code> and <code>jsonb</code> types should be consolidated in PostgreSQL is an open question.</li> <li>\u201cnot planned\u201d is my opinion that the feature is essentially obsolete (see previous article) and not worth implementing.</li> <li>\u201cfuture\u201d is my opinion that the feature could be a sensible addition to PostgreSQL, but there is no concrete work in progress.</li> </ul>"},{"location":"sql/sql2023/#sql","title":"SQL \u589e\u5f3a","text":""},{"location":"sql/sql2023/#unique-f292","title":"UNIQUE \u7ea6\u675f\u4e2d\u7684\u7a7a\u503c\uff08F292\uff09","text":"<p>\u8fd9\u4e2a\u529f\u80fd\u7528\u4e8e\u5b9a\u4e49\u552f\u4e00\u7ea6\u675f\u4e2d\u662f\u5426\u5141\u8bb8\u591a\u4e2a\u7a7a\u503c\u3002\u4f8b\u5982\uff1a</p> <pre><code>CREATE TABLE t1 (\n    a int,\n    b int,\n    c int,\n    UNIQUE (a, b, c)\n);\n\nINSERT INTO t1 VALUES (1, NULL, NULL);\nINSERT INTO t1 VALUES (1, NULL, NULL);  -- ?\n</code></pre> <p>\u95ee\u9898\u5728\u4e8e\u7b2c\u4e8c\u4e2a\u63d2\u5165\u8bed\u53e5\u662f\u5426\u4f1a\u8fdd\u6cd5\u552f\u4e00\u7ea6\u675f\u3002</p> <p>\u663e\u7136\uff0c\u5df2\u6709\u7684\u6807\u51c6\u6ca1\u6709\u660e\u786e\u7684\u5b9a\u4e49\u3002\u4e3a\u4e86\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\uff0c\u65b0\u6807\u51c6\u589e\u52a0\u4e86\u4e00\u4e2a\u9009\u9879\u3002\u4f8b\u5982\uff1a</p> <pre><code>CREATE TABLE t2 (\n    a int,\n    b int,\n    c int,\n    UNIQUE NULLS DISTINCT (a, b, c)    -- NULLS DISTINCT \u9009\u9879\u5c06\u591a\u4e2a\u7a7a\u503c\u770b\u4f5c\u4e0d\u540c\u7684\u6570\u636e\uff0c\u56e0\u6b64\u4e0d\u4f1a\u8fdd\u53cd\u552f\u4e00\u7ea6\u675f\n);\n\nINSERT INTO t2 VALUES (1, NULL, NULL);\nINSERT INTO t2 VALUES (1, NULL, NULL);  -- \u6b63\u786e\n\nCREATE TABLE t3 (\n    a int,\n    b int,\n    c int,\n    UNIQUE NULLS NOT DISTINCT (a, b, c)  -- NULLS NOT DISTINCT \u9009\u9879\u5c06\u591a\u4e2a\u7a7a\u503c\u770b\u4f5c\u76f8\u540c\u7684\u6570\u636e\uff0c\u56e0\u6b64\u8fdd\u53cd\u4e86\u552f\u4e00\u7ea6\u675f\u3002\n);\n\nINSERT INTO t3 VALUES (1, NULL, NULL);  \nINSERT INTO t3 VALUES (1, NULL, NULL);  -- \u9519\u8bef\n</code></pre> <p>\u8be5\u9009\u9879\u7684\u9ed8\u8ba4\u503c\u53d6\u51b3\u4e8e\u6570\u636e\u5e93\u4ea7\u54c1\u7684\u5177\u4f53\u5b9e\u73b0\uff0c\u8fd9\u6837\u53ef\u4ee5\u517c\u5bb9\u5df2\u6709\u7684\u884c\u4e3a\u3002</p>"},{"location":"sql/sql2023/#order-byf868","title":"\u5206\u7ec4\u8868\u4e2d\u7684 ORDER BY\uff08F868\uff09","text":"<p>\u6211\u4eec\u6765\u770b\u4e00\u4e2a\u793a\u4f8b\uff1a</p> <pre><code>CREATE TABLE product (\n    product_id int PRIMARY KEY,\n    product_name varchar,\n    product_code varchar UNIQUE\n);\n\nCREATE TABLE product_part (\n    product_id int,\n    part_id int,\n    num int,\n    PRIMARY KEY (product_id, part_id)\n);\n\nSELECT product.product_id, sum(product_part.num)\nFROM product JOIN product_part ON product.product_id = product_part.product_id\nGROUP BY product.product_id\nORDER BY product.product_code;\n</code></pre> <p>\u4ee5\u4e0a\u793a\u4f8b\u5728\u5927\u591a\u6570 SQL \u5b9e\u73b0\u4e2d\u90fd\u80fd\u6b63\u5e38\u5de5\u4f5c\uff0c\u4f46\u662f\u6807\u51c6\u5374\u4e0d\u5141\u8bb8\u8fd9\u79cd\u67e5\u8be2\u65b9\u5f0f\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c<code>SQL\u6807\u51c6</code>\u4e0d\u5141\u8bb8\u4f7f\u7528\u6ca1\u6709\u51fa\u73b0\u5728<code>SELECT</code>\u5217\u8868\u4e2d\u7684\u5206\u7ec4\u8868\u5b57\u6bb5\uff08product.product_code\uff09\u8fdb\u884c\u6392\u5e8f\u3002\u65b0\u6807\u51c6\u5219\u5141<code>SQL</code>\u5b9e\u73b0\u660e\u786e\u652f\u6301\u8fd9\u79cd\u884c\u4e3a\u3002</p> <p>\u4f5c\u4e3a\u7528\u6237\uff0c\u6211\u4eec\u5e76\u4e0d\u9700\u8981\u5173\u5fc3\u8fd9\u4e2a\u95ee\u9898\u3002</p>"},{"location":"sql/sql2023/#greatest-least-t054","title":"GREATEST \u548c LEAST \u51fd\u6570\uff08T054\uff09","text":"<p>\u8fd9\u4e2a\u529f\u80fd\u589e\u52a0\u4e86\u4e24\u4e2a\u65b0\u7684\u6807\u91cf\u51fd\u6570\uff1a<code>GREATEST</code>\uff08\u6700\u5927\u503c\uff09\u4ee5\u53ca <code>LEAST</code>\uff08\u6700\u5c0f\u503c\uff09\u3002\u5b83\u4eec\u4e0d\u662f\u805a\u5408\u51fd\u6570 <code>MAX</code> \u548c<code>MIN</code>\uff0c\u800c\u662f\u8fd4\u56de\u4e00\u7ec4\u53c2\u6570\u4e2d\u7684\u6700\u5927\u503c\u548c\u6700\u5c0f\u503c\u3002\u5b9e\u9645\u4e0a\u5f88\u591a\u6570\u636e\u5e93\u5df2\u7ecf\u5b9e\u73b0\u4e86\u8fd9\u4e24\u4e2a\u51fd\u6570\uff1a</p> <pre><code>SELECT greatest(1, 2);  --&gt; 2\nSELECT least(1, 2);     --&gt; 1\n\nSELECT greatest(1, 2, 3);  --&gt; 3\nSELECT least(1, 2, 3);     --&gt; 1\n</code></pre>"},{"location":"sql/sql2023/#t055","title":"\u5b57\u7b26\u4e32\u586b\u5145\u51fd\u6570\uff08T055\uff09","text":"<p>\u8fd9\u4e2a\u529f\u80fd\u589e\u52a0\u4e86\u4e24\u4e2a\u65b0\u7684\u5b57\u7b26\u4e32\u51fd\u6570\uff1a<code>LPAD</code>\uff08\u5de6\u4fa7\u586b\u5145\uff09\u4ee5\u53ca <code>RPAD</code>\uff08\u53f3\u4fa7\u586b\u5145\uff09\u3002\u8fd9\u4e24\u4e2a\u51fd\u6570\u540c\u6837\u5728\u5f88\u591a\u6570\u636e\u5e93\u4e2d\u5df2\u7ecf\u6709\u4e86\u5b9e\u73b0\uff1a</p> <pre><code>SELECT lpad(cast(12345.67 as varchar), 12, '*');\n\n-- ****12345.67\n</code></pre> <p>\u9ed8\u8ba4\u4f7f\u7528\u7684\u586b\u5145\u5b57\u7b26\u4e3a\u7a7a\u683c\u3002</p>"},{"location":"sql/sql2023/#trim-t056","title":"\u591a\u5b57\u7b26 TRIM \u51fd\u6570\uff08T056\uff09","text":"<p>\u5df2\u6709\u7684\u5355\u5b57\u7b26\u622a\u65ad\u51fd\u6570<code>\uff08TRIM({LEADING|TRAILING|BOTH} 'x' FROM val)\uff09</code>\u53ea\u80fd\u6307\u5b9a\u8981\u622a\u65ad\u7684\u5355\u4e2a\u5b57\u7b26\uff0c\u65b0\u51fd\u6570\u5219\u53ef\u4ee5\u6307\u5b9a\u591a\u4e2a\u9700\u8981\u622a\u65ad\u7684\u5b57\u7b26\uff0c\u800c\u4e14\u8bed\u6cd5\u66f4\u52a0\u7b80\u6d01\u3002\u4f8b\u5982\uff1a <pre><code>SELECT ltrim('****12345.67', '*');\n</code></pre></p>"},{"location":"sql/sql2023/#t081","title":"\u53ef\u9009\u7684\u5b57\u7b26\u4e32\u7c7b\u578b\u6700\u5927\u957f\u5ea6\uff08T081\uff09","text":"<p>\u8fd9\u4e2a\u529f\u80fd\u5141\u8bb8\u4e0d\u6307\u5b9a <code>VARCHAR</code> \u7c7b\u578b\u7684\u6700\u5927\u957f\u5ea6\u3002\u5728\u6b64\u4e4b\u524d\uff0c\u6211\u4eec\u7ecf\u5e38\u4f1a\u770b\u5230\u4e3a\u4e86\u652f\u6301\u4efb\u610f\u957f\u5ea6\u800c\u6307\u5b9a\u4e00\u4e2a\u5f88\u5927\u7684\u957f\u5ea6\u503c\uff1a <pre><code>CREATE TABLE t1 (\n    a VARCHAR(1000),\n    b VARCHAR(4000),\n    -- ...\n);\n</code></pre></p> <p>\u73b0\u5728\u53ef\u4ee5\u7b80\u5355\u7684\u6307\u5b9a\u6570\u636e\u7c7b\u578b\uff1a</p> <pre><code>CREATE TABLE t1 (\n    a VARCHAR,\n    b VARCHAR,\n    -- ...\n);\n</code></pre> <p>\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u5b57\u6bb5\u7684\u6700\u5927\u957f\u5ea6\u53d6\u51b3\u4e8e\u6570\u636e\u5e93\u5b9e\u73b0\u3002</p>"},{"location":"sql/sql2023/#t133","title":"\u589e\u5f3a\u7684\u9012\u5f52\u5faa\u73af\u6807\u8bc6\uff08T133\uff09","text":"<p><code>CYCLE</code> \u5b50\u53e5\u662f\u9c9c\u4e3a\u4eba\u77e5\u7684\u4e00\u4e2a\u9012\u5f52\u67e5\u8be2\u529f\u80fd\uff0c\u53ef\u4ee5\u7528\u4e8e\u68c0\u6d4b\u5faa\u73af\u9012\u5f52\uff1a</p> <pre><code>WITH RECURSIVE ... (\n    SELECT ...\n      UNION ALL\n    SELECT ...\n)\nCYCLE id SET is_cycle TO 'Y' DEFAULT 'N' USING path;\n</code></pre> <p>\u8fd9\u79cd\u65b9\u5f0f\u53ef\u4ee5\u57fa\u4e8e id \u5b57\u6bb5\u68c0\u6d4b\u662f\u5426\u51fa\u73b0\u5faa\u73af\u9012\u5f52\uff0c\u5e76\u4e14\u5c06 is_cycle \u5b57\u6bb5\u8bbe\u7f6e\u4e3a\u6307\u5b9a\u503c\u3002</p> <p>\u5f53 <code>SQL</code> \u6807\u51c6\u589e\u52a0\u9012\u5f52\u5faa\u73af\u65f6\uff0c\u8fd8\u6ca1\u6709\u5e03\u5c14\u7c7b\u578b\uff0c\u56e0\u6b64\u4f7f\u7528\u4e86\u4e00\u4e2a\u5b57\u7b26\u4e32\u3002\u5982\u4eca <code>SQL</code> \u6807\u51c6\u63d0\u4f9b\u4e86\u5e03\u5c14\u7c7b\u578b\uff0c\u56e0\u6b64\u4e0a\u9762\u7684\u67e5\u8be2\u53ef\u4ee5\u6539\u8fdb\u4e3a\uff1a</p> <pre><code>WITH RECURSIVE ... (\n    SELECT ...\n      UNION ALL\n    SELECT ...\n)\nCYCLE id SET is_cycle USING path;\n</code></pre>"},{"location":"sql/sql2023/#any_value-t626","title":"ANY_VALUE \u51fd\u6570\uff08T626\uff09","text":"<p>\u8fd9\u4e2a\u65b0\u7684\u805a\u5408\u51fd\u6570\u53ef\u4ee5\u4ece\u4e00\u7ec4\u6570\u636e\u4e2d\u8fd4\u56de\u4efb\u610f\u4e00\u4e2a\u975e\u7a7a\u503c\u3002\u4f8b\u5982\uff1a <pre><code>CREATE TABLE t1 (\n    a int,\n    b int\n);\n\nINSERT INTO t1 VALUES (1, 11), (1, 22), (1, 33);\n\nSELECT a, any_value(b) \nFROM t1 \nGROUP BY a;\n</code></pre></p> <p>\u4ee5\u4e0a\u67e5\u8be2\u53ef\u80fd\u4f1a\u8fd4\u56de\uff081 | 11\uff09\u3001\uff081 | 22\uff09\u6216\u8005\uff081 | 33\uff09\u3002</p>"},{"location":"sql/sql2023/#t661","title":"\u975e\u5341\u8fdb\u5236\u7684\u6574\u6570\u5e38\u91cf\uff08T661\uff09","text":"<p>\u8fd9\u4e2a\u65b0\u529f\u80fd\u652f\u6301\u5341\u516d\u8fdb\u5236\u3001\u516b\u8fdb\u5236\u4ee5\u53ca\u4e8c\u8fdb\u5236\u7684\u6574\u6570\u5e38\u91cf\u3002 <pre><code>SELECT 0xFFFF, 0o755, 0b11001111;\n</code></pre></p>"},{"location":"sql/sql2023/#t662","title":"\u6570\u5b57\u5e38\u91cf\u4e2d\u7684\u4e0b\u5212\u7ebf\uff08T662\uff09","text":"<p>\u8fd9\u4e2a\u529f\u80fd\u5141\u8bb8\u5728\u6570\u5b57\u5e38\u91cf\u4e2d\u4f7f\u7528\u4e0b\u5212\u7ebf\uff0c\u63d0\u9ad8\u53ef\u8bfb\u6027\u3002</p> <pre><code>SELECT ... WHERE a &gt; 1_000_000;\nUPDATE ... SET x = 0x_FFFF_FFFF ...\n</code></pre>"},{"location":"sql/sql2023/#json","title":"JSON \u65b0\u529f\u80fd","text":""},{"location":"sql/sql2023/#json-t801","title":"JSON \u6570\u636e\u7c7b\u578b\uff08T801\uff09","text":"<p>\u65b0\u6807\u51c6\u589e\u52a0\u4e86 <code>JSON</code> \u6570\u636e\u7c7b\u578b\u3002\u8bb8\u591a\u6570\u636e\u5e93\u4ea7\u54c1\u5b9e\u9645\u4e0a\u5df2\u7ecf\u63d0\u4f9b\u4e86\u8fd9\u4e2a\u7c7b\u578b\u3002</p> <p><code>SQL:2016</code> \u53ea\u662f\u652f\u6301\u4e86 <code>JSON</code> \u6570\u636e\u7684\u64cd\u4f5c\uff0c\u6570\u636e\u4ecd\u7136\u4f7f\u7528\u5b57\u7b26\u4e32\u5b58\u50a8\u3002\u65b0\u7684\u529f\u80fd\u540c\u65f6\u8fd8\u589e\u52a0\u4e86\u4e00\u4e9b <code>JSON</code> \u76f8\u5173\u7684\u51fd\u6570\uff0c\u4f8b\u5982 <code>JSON_SERIALIZE</code>\u3001<code>JSON_SCALAR</code> \u4ee5\u53ca <code>IS JSON</code>\u3002</p>"},{"location":"sql/sql2023/#json-t802","title":"\u589e\u5f3a\u7684 JSON \u6570\u636e\u7c7b\u578b\uff08T802\uff09","text":"<p>\u8fd9\u4e2a\u529f\u80fd\u53ef\u4ee5\u4e3a <code>JSON</code> \u7c7b\u578b\u6307\u5b9a\u989d\u5916\u7684\u9009\u9879\u3002\u5177\u4f53\u6765\u8bf4\uff0c\u53ef\u4ee5\u6307\u5b9a\u4e00\u4e2a\u552f\u4e00\u952e\u68c0\u6d4b\uff0c\u4f8b\u5982 <code>JSON('...text...' WITH UNIQUE KEYS)</code>\u3002</p>"},{"location":"sql/sql2023/#jsont803","title":"\u57fa\u4e8e\u5b57\u7b26\u4e32\u7684 JSON\uff08T803\uff09","text":"<p>\u8fd9\u4e2a\u529f\u80fd\u4ee3\u8868\u4e86 <code>SQL:2016</code> \u4e2d\u7684\u5b57\u7b26\u4e32 <code>JSON</code>\u3002\u6570\u636e\u5e93\u63d0\u4f9b\u7684 <code>JSON</code> \u51fd\u6570\uff08\u4f8b\u5982 <code>JSON_OBJECT</code>\u3001<code>JSON_OBJECTAGG</code>\u3001<code>JSON_TABLE</code> \u7b49\uff09\u53ef\u4ee5\u9009\u62e9\u652f\u6301\u5b57\u7b26\u4e32\u683c\u5f0f\u7684 <code>JSON</code> \u6570\u636e\u8fd8\u662f\u539f\u751f\u7684 <code>JSON</code> \u6570\u636e\u7c7b\u578b\uff0c\u4e5f\u53ef\u4ee5\u652f\u6301\u4e24\u8005\u3002</p>"},{"location":"sql/sql2023/#sqljson-t840","title":"SQL/JSON \u8def\u5f84\u4e2d\u7684\u5341\u516d\u8fdb\u5236\u6574\u6570\u5e38\u91cf\uff08T840\uff09","text":"<p>\u8fd9\u4e2a\u529f\u80fd\u5141\u8bb8\u5728 <code>SQL/JSON</code> \u8def\u5f84\u8bed\u8a00\u4e2d\u4f7f\u7528\u5341\u516d\u8fdb\u5236\u6574\u6570\u5e38\u91cf\u3002</p> <p>\u867d\u7136\u4e0d\u5c5e\u4e8e\u8fd9\u4e2a\u529f\u80fd\uff0c\u4f46\u662f <code>SQL</code> \u6807\u51c6\u73b0\u5728\u5141\u8bb8\u4ee5\u6269\u5c55\u63d2\u4ef6\u7684\u5f62\u5f0f\u652f\u6301 <code>JavaScript\uff08ECMAScript\uff09</code>\uff0c\u56e0\u6b64\u4e0d\u9700\u8981\u6bcf\u6b21 <code>ECMAScript</code> \u66f4\u65b0\u65f6\u66f4\u65b0 <code>SQL</code> \u6807\u51c6\u3002\u6240\u4ee5 <code>SQL/JSON</code> \u8def\u5f84\u73b0\u5728\u4e5f\u53ef\u4ee5\u652f\u6301\u6700\u65b0 <code>ECMAScript</code> \u4e2d\u7684\u5176\u4ed6\u6570\u5b57\u5e38\u91cf\uff0c\u4f8b\u5982\u4e8c\u8fdb\u5236\u6574\u6570\u548c\u4e0b\u5212\u7ebf\u5206\u9694\u7b26\u3002</p>"},{"location":"sql/sql2023/#sqljson-t860-t864","title":"SQL/JSON \u7b80\u5316\u8bbf\u95ee\u7b26\uff08T860-T864\uff09","text":"<p>\"\u7b80\u5316\u8bbf\u95ee\u7b26\"\u529f\u80fd\u5141\u8bb8\u4f7f\u7528\u70b9\u53f7\u548c\u6570\u7ec4\u8bed\u6cd5\u8bbf\u95ee <code>JSON</code> \u6570\u636e\u4e2d\u7684\u590d\u5408\u7c7b\u578b\u548c\u6570\u7ec4\u7c7b\u578b\u3002\u4f8b\u5982\uff0c\u5047\u8bbe\u5b57\u6bb5 j \u662f\u4e00\u4e2a <code>JSON</code> \u7c7b\u578b\uff0c\u5305\u542b\u4ee5\u4e0b\u6570\u636e\uff1a</p> <pre><code>{\"foo\": {\"bar\": [100, 200, 300]}, ...}\n</code></pre> <p>\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u7b80\u5316\u8bbf\u95ee\u7b26\u83b7\u53d6\u5b57\u6bb5\u4e2d\u7684\u4fe1\u606f\uff1a</p> <pre><code>SELECT t.j.foo.bar[2], ... \nFROM tbl t ...\n</code></pre>"},{"location":"sql/sql2023/#sqljson-t865-t878","title":"SQL/JSON \u5143\u7d20\u65b9\u6cd5\uff08T865-T878\uff09","text":"<p><code>SQL/JSON</code> \u5143\u7d20\u65b9\u6cd5\u6216\u8005\u51fd\u6570\u53ef\u4ee5\u5728 <code>SQL/JSON</code> \u8def\u5f84\u8868\u8fbe\u5f0f\u4e2d\u4f7f\u7528\uff0c\u5bf9\u5143\u7d20\u503c\u8fdb\u884c\u5904\u7406\u3002<code>SQL:2016</code> \u5df2\u7ecf\u5b9a\u4e49\u4e86\u4e00\u4e9b\u8fd9\u7c7b\u65b9\u6cd5\uff0c\u4f8b\u5982 abs()\u3001floor()\u3001size()\u3002\u65b0\u589e\u7684\u65b9\u6cd5\u4e3b\u8981\u7528\u4e8e\u6570\u636e\u7c7b\u578b\u8f6c\u6362\uff1a</p> <ul> <li>T865: SQL/JSON item method: bigint()</li> <li>T866: SQL/JSON item method: boolean()</li> <li>T867: SQL/JSON item method: date()</li> <li>T868: SQL/JSON item method: decimal()</li> <li>T869: SQL/JSON item method: decimal() with precision and scale</li> <li>T870: SQL/JSON item method: integer()</li> <li>T871: SQL/JSON item method: number()</li> <li>T872: SQL/JSON item method: string()</li> <li>T873: SQL/JSON item method: time()</li> <li>T874: SQL/JSON item method: time_tz()</li> <li>T875: SQL/JSON item method: time precision</li> <li>T876: SQL/JSON item method: timestamp()</li> <li>T877: SQL/JSON item method: timestamp_tz()</li> <li>T878: SQL/JSON item method: timestamp precision</li> </ul>"},{"location":"sql/sql2023/#json-t879-t882","title":"JSON \u6570\u636e\u6bd4\u8f83\u529f\u80fd\uff08T879-T882\uff09","text":"<p>\u8fd9\u4e2a\u529f\u80fd\u5141\u8bb8\u9488\u5bf9 <code>JSON</code> \u6570\u636e\u7c7b\u578b\u7684\u6bd4\u8f83\u3001\u6392\u5e8f\u4ee5\u53ca\u5206\u7ec4\u64cd\u4f5c\u3002</p>"},{"location":"sql/sql2023/#_2","title":"\u5c5e\u6027\u56fe\u67e5\u8be2\u8bed\u8a00","text":"<p>\u8fd9\u662f <code>SQL</code> \u6807\u51c6\u4e2d\u589e\u52a0\u7684\u4e00\u4e2a\u5168\u65b0\u90e8\u5206\uff1a<code>Property Graph Queries (SQL/PGQ)</code>\u3002\u8fd9\u4e2a\u65b0\u529f\u80fd\u652f\u6301\u4f7f\u7528\u56fe\u6570\u636e\u5e93\u7684\u65b9\u5f0f\u67e5\u8be2\u8868\u4e2d\u7684\u6570\u636e\u3002</p> <p>\u5b8c\u6574\u7684\u5c5e\u6027\u56fe\u67e5\u8be2\u8bed\u8a00\u6bd4\u8f83\u590d\u6742\uff0c\u4ee5\u4e0b\u662f\u4e00\u4e2a\u7b80\u5355\u7684\u793a\u4f8b\uff1a</p> <pre><code>CREATE TABLE person (...);\nCREATE TABLE company (...);\nCREATE TABLE ownerof (...);\nCREATE TABLE transaction (...);\nCREATE TABLE account (...);\n\nCREATE PROPERTY GRAPH financial_transactions\n    VERTEX TABLES (person, company, account)\n    EDGE TABLES (ownerof, transaction);\n\nSELECT owner_name,\n       SUM(amount) AS total_transacted\nFROM financial_transactions GRAPH_TABLE (\n  MATCH (p:person WHERE p.name = 'Alice')\n        -[:ownerof]-&gt; (:account)\n        -[t:transaction]- (:account)\n        &lt;-[:ownerof]- (owner:person|company)\n  COLUMNS (owner.name AS owner_name, t.amount AS amount)\n) AS ft\nGROUP BY owner_name;\n</code></pre> <p>\u4ee5\u4e0a\u793a\u4f8b\u4e2d\uff0c\u8868\u4e4b\u95f4\u8fd8\u9700\u8981\u5b9a\u4e49\u5916\u952e\uff0c\u8fd9\u6837\u5c5e\u6027\u56fe\u5b9a\u4e49\u624d\u80fd\u786e\u5b9a\u5b83\u4eec\u4e4b\u95f4\u7684\u8054\u7cfb\uff1b\u6216\u8005\u4e5f\u53ef\u4ee5\u5728\u5c5e\u6027\u56fe\u5b9a\u4e49\u65f6\u6307\u5b9a\u8868\u4e4b\u95f4\u7684\u8054\u7cfb\u3002</p>"},{"location":"%E7%AE%97%E6%B3%95/01.%E7%AE%97%E6%B3%95%E5%92%8C%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E6%A6%82%E8%BF%B0/","title":"\u6982\u8ff0","text":"<p>\u6570\u636e\u7ed3\u6784\u662f\u7a0b\u5e8f\u7684\u9aa8\u67b6\uff0c\u800c\u7b97\u6cd5\u5219\u662f\u7a0b\u5e8f\u7684\u7075\u9b42\u3002</p> <p>\u300a\u7b97\u6cd5 + \u6570\u636e\u7ed3\u6784 = \u7a0b\u5e8f\u300b \u662f Pascal \u8bed\u8a00\u4e4b\u7236 Niklaus Emil Wirth \u5199\u8fc7\u7684\u4e00\u672c\u975e\u5e38\u8457\u540d\u7684\u4e66\u3002\u800c\u4f5c\u4e3a\u4e66\u540d\u7684\u8fd9\u53e5\u8bdd\u4e5f\u6210\u4e3a\u4e86\u8ba1\u7b97\u673a\u79d1\u5b66\u7684\u7ecf\u5178\u540d\u53e5\u3002</p> <p>\u5927\u90e8\u5206\u6570\u636e\u7ed3\u6784\u548c\u7b97\u6cd5\u6559\u6750\uff0c\u5728\u5f00\u7bc7\u90fd\u8bd5\u56fe\u4f1a\u7ed9\u8fd9\u4e24\u4e2a\u6982\u5ff5\u4e0b\u4e00\u4e2a\u660e\u786e\u7684\u5b9a\u4e49\u3002\u4f46\u662f\u8fd9\u4e9b\u5b9a\u4e49\u90fd\u5f88\u62bd\u8c61\uff0c\u5bf9\u7406\u89e3\u8fd9\u4e24\u4e2a\u6982\u5ff5\u5e76\u6ca1\u6709\u5b9e\u8d28\u6027\u7684\u5e2e\u52a9\u3002</p> <p>\u4ece\u5e7f\u4e49\u4e0a\u8bb2\uff0c\u6570\u636e\u7ed3\u6784\u5c31\u662f\u6307\u4e00\u7ec4\u6570\u636e\u7684\u5b58\u50a8\u7ed3\u6784\u3002\u7b97\u6cd5\u5c31\u662f\u64cd\u4f5c\u6570\u636e\u7684\u4e00\u7ec4\u65b9\u6cd5\u3002</p> <p>\u6570\u636e\u7ed3\u6784\u662f\u8ba1\u7b97\u673a\u5b58\u50a8\u3001\u7ec4\u7ec7\u6570\u636e\u7684\u65b9\u5f0f\uff0c\u662f\u6307\u76f8\u4e92\u4e4b\u95f4\u5b58\u5728\u4e00\u79cd\u6216\u591a\u79cd\u7279\u5b9a\u5173\u7cfb\u7684\u6570\u636e\u5143\u7d20\u7684\u96c6\u5408</p> <p>\u6570\u636e\u7ed3\u6784\u548c\u7b97\u6cd5\u662f\u76f8\u8f85\u76f8\u6210\u7684\u3002\u6570\u636e\u7ed3\u6784\u662f\u4e3a\u7b97\u6cd5\u670d\u52a1\u7684\uff0c\u7b97\u6cd5\u8981\u4f5c\u7528\u5728\u7279\u5b9a\u7684\u6570\u636e\u7ed3\u6784\u4e4b\u4e0a\u3002 \u56e0\u6b64\uff0c\u6211\u4eec\u65e0\u6cd5\u5b64\u7acb\u6570\u636e\u7ed3\u6784\u6765\u8bb2\u7b97\u6cd5\uff0c\u4e5f\u65e0\u6cd5\u5b64\u7acb\u7b97\u6cd5\u6765\u8bb2\u6570\u636e\u7ed3\u6784\u3002</p> <p>\u7b97\u6cd5\uff08Algorithm\uff09\u662f\u6307\u7528\u6765\u64cd\u4f5c\u6570\u636e\u3001\u89e3\u51b3\u7a0b\u5e8f\u95ee\u9898\u7684\u4e00\u7ec4\u65b9\u6cd5\u3002\u5bf9\u4e8e\u540c\u4e00\u4e2a\u95ee\u9898\uff0c\u4f7f\u7528\u4e0d\u540c\u7684\u7b97\u6cd5\uff0c\u4e5f\u8bb8\u6700\u7ec8\u5f97\u5230\u7684\u7ed3\u679c\u662f\u4e00\u6837\u7684\uff0c\u4f46\u5728\u8fc7\u7a0b\u4e2d\u6d88\u8017\u7684\u8d44\u6e90\u548c\u65f6\u95f4\u5374\u4f1a\u6709\u5f88\u5927\u7684\u533a\u522b\u3002</p> <p>\u7b97\u6cd5\uff08algorithm\uff09\u662f\u5728\u6709\u9650\u65f6\u95f4\u5185\u89e3\u51b3\u7279\u5b9a\u95ee\u9898\u7684\u4e00\u7ec4\u6307\u4ee4\u6216\u64cd\u4f5c\u6b65\u9aa4\uff0c\u5b83\u5177\u6709\u4ee5\u4e0b\u7279\u6027\u3002</p> <ul> <li>\u95ee\u9898\u662f\u660e\u786e\u7684\uff0c\u5305\u542b\u6e05\u6670\u7684\u8f93\u5165\u548c\u8f93\u51fa\u5b9a\u4e49\u3002</li> <li>\u5177\u6709\u53ef\u884c\u6027\uff0c\u80fd\u591f\u5728\u6709\u9650\u6b65\u9aa4\u3001\u65f6\u95f4\u548c\u5185\u5b58\u7a7a\u95f4\u4e0b\u5b8c\u6210\u3002</li> <li>\u5404\u6b65\u9aa4\u90fd\u6709\u786e\u5b9a\u7684\u542b\u4e49\uff0c\u5728\u76f8\u540c\u7684\u8f93\u5165\u548c\u8fd0\u884c\u6761\u4ef6\u4e0b\uff0c\u8f93\u51fa\u59cb\u7ec8\u76f8\u540c\u3002</li> </ul> <p>\u6570\u636e\u7ed3\u6784\uff08data structure\uff09\u662f\u7ec4\u7ec7\u548c\u5b58\u50a8\u6570\u636e\u7684\u65b9\u5f0f\uff0c\u6db5\u76d6\u6570\u636e\u5185\u5bb9\u3001\u6570\u636e\u4e4b\u95f4\u5173\u7cfb\u548c\u6570\u636e\u64cd\u4f5c\u65b9\u6cd5\uff0c\u5b83\u5177\u6709\u4ee5\u4e0b\u8bbe\u8ba1\u76ee\u6807\u3002</p> <ul> <li>\u7a7a\u95f4\u5360\u7528\u5c3d\u91cf\u5c11\uff0c\u4ee5\u8282\u7701\u8ba1\u7b97\u673a\u5185\u5b58\u3002</li> <li>\u6570\u636e\u64cd\u4f5c\u5c3d\u53ef\u80fd\u5feb\u901f\uff0c\u6db5\u76d6\u6570\u636e\u8bbf\u95ee\u3001\u6dfb\u52a0\u3001\u5220\u9664\u3001\u66f4\u65b0\u7b49\u3002</li> <li>\u63d0\u4f9b\u7b80\u6d01\u7684\u6570\u636e\u8868\u793a\u548c\u903b\u8f91\u4fe1\u606f\uff0c\u4ee5\u4fbf\u7b97\u6cd5\u9ad8\u6548\u8fd0\u884c\u3002</li> </ul> <p>\u6570\u636e\u7ed3\u6784\u8bbe\u8ba1\u662f\u4e00\u4e2a\u5145\u6ee1\u6743\u8861\u7684\u8fc7\u7a0b\u3002\u5982\u679c\u60f3\u5728\u67d0\u65b9\u9762\u53d6\u5f97\u63d0\u5347\uff0c\u5f80\u5f80\u9700\u8981\u5728\u53e6\u4e00\u65b9\u9762\u4f5c\u51fa\u59a5\u534f\u3002\u4e0b\u9762\u4e3e\u4e24\u4e2a\u4f8b\u5b50\u3002</p> <ul> <li>\u94fe\u8868\u76f8\u8f83\u4e8e\u6570\u7ec4\uff0c\u5728\u6570\u636e\u6dfb\u52a0\u548c\u5220\u9664\u64cd\u4f5c\u4e0a\u66f4\u52a0\u4fbf\u6377\uff0c\u4f46\u727a\u7272\u4e86\u6570\u636e\u8bbf\u95ee\u901f\u5ea6\u3002</li> <li>\u56fe\u76f8\u8f83\u4e8e\u94fe\u8868\uff0c\u63d0\u4f9b\u4e86\u66f4\u4e30\u5bcc\u7684\u903b\u8f91\u4fe1\u606f\uff0c\u4f46\u9700\u8981\u5360\u7528\u66f4\u5927\u7684\u5185\u5b58\u7a7a\u95f4\u3002</li> </ul> <p>\u60f3\u8981\u5b66\u4e60\u6570\u636e\u7ed3\u6784\u4e0e\u7b97\u6cd5\uff0c\u9996\u5148\u8981\u638c\u63e1\u4e00\u4e2a\u6570\u636e\u7ed3\u6784\u4e0e\u7b97\u6cd5\u4e2d\u6700\u91cd\u8981\u7684\u6982\u5ff5\u2014\u2014\u590d\u6742\u5ea6\u5206\u6790\u3002</p> <p>\u300a\u6570\u636e\u7ed3\u6784\u548c\u7b97\u6cd5\u300b\u89e3\u51b3\u7684\u662f\u5982\u4f55\u66f4\u7701\u3001\u66f4\u5feb\u5730\u5b58\u50a8\u548c\u5904\u7406\u6570\u636e\u7684\u95ee\u9898\uff0c\u56e0\u6b64\uff0c\u6211\u4eec\u5c31\u9700\u8981\u4e00\u4e2a\u8003\u91cf\u6548\u7387\u548c\u8d44\u6e90\u6d88\u8017\u7684\u65b9\u6cd5\uff0c\u8fd9\u5c31\u662f\u590d\u6742\u5ea6\u5206\u6790\u65b9\u6cd5\u3002</p> <p>\u6240\u4ee5\uff0c\u5982\u679c\u4f60\u53ea\u638c\u63e1\u4e86\u6570\u636e\u7ed3\u6784\u548c\u7b97\u6cd5\u7684\u7279\u70b9\u3001\u7528\u6cd5\uff0c\u4f46\u662f\u6ca1\u6709\u5b66\u4f1a\u590d\u6742\u5ea6\u5206\u6790\uff0c\u90a3\u5c31\u76f8\u5f53\u4e8e\u53ea\u77e5\u9053\u64cd\u4f5c\u53e3\u8bc0\uff0c\u800c\u6ca1\u638c\u63e1\u5fc3\u6cd5\u3002</p> <p>\u90a3\u4e48\u6211\u4eec\u5e94\u8be5\u5982\u4f55\u53bb\u8861\u91cf\u4e0d\u540c\u7b97\u6cd5\u4e4b\u95f4\u7684\u4f18\u52a3\u5462\uff1f\u4e3b\u8981\u8fd8\u662f\u4ece\u7b97\u6cd5\u6240\u5360\u7528\u7684\u300c\u65f6\u95f4\u300d\u548c\u300c\u7a7a\u95f4\u300d\u4e24\u4e2a\u7ef4\u5ea6\u53bb\u8003\u91cf\u3002</p> <ul> <li> <p>\u65f6\u95f4\u7ef4\u5ea6\uff1a\u662f\u6307\u6267\u884c\u5f53\u524d\u7b97\u6cd5\u6240\u6d88\u8017\u7684\u65f6\u95f4\uff0c\u6211\u4eec\u901a\u5e38\u7528\u300c\u65f6\u95f4\u590d\u6742\u5ea6\u300d\u6765\u63cf\u8ff0\u3002</p> </li> <li> <p>\u7a7a\u95f4\u7ef4\u5ea6\uff1a\u662f\u6307\u6267\u884c\u5f53\u524d\u7b97\u6cd5\u9700\u8981\u5360\u7528\u591a\u5c11\u5b58\u50a8\u7a7a\u95f4\uff0c\u6211\u4eec\u901a\u5e38\u7528\u300c\u7a7a\u95f4\u590d\u6742\u5ea6\u300d\u6765\u63cf\u8ff0\u3002</p> </li> </ul> <p>\u56e0\u6b64\uff0c\u8bc4\u4ef7\u4e00\u4e2a\u7b97\u6cd5\u7684\u6548\u7387\u4e3b\u8981\u662f\u770b\u5b83\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u548c\u7a7a\u95f4\u590d\u6742\u5ea6\u60c5\u51b5\u3002\u7136\u800c\u6709\u65f6\u5019\uff0c\u65f6\u95f4\u6700\u4f18\u548c\u7a7a\u95f4\u6700\u4f18\u5f80\u5f80\u662f\u300c\u9c7c\u548c\u718a\u638c\u300d\u4e0d\u53ef\u517c\u5f97\uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u9700\u8981\u4ece\u4e2d\u53bb\u53d6\u4e00\u4e2a\u5e73\u8861\u70b9\u3002</p> <p>\u540c\u4e00\u4e2a\u7b97\u6cd5\u5728\u4e0d\u540c\u7684\u8ba1\u7b97\u673a\u4e0a\u8fd0\u884c\u7684\u901f\u5ea6\u4f1a\u6709\u4e00\u5b9a\u7684\u5dee\u522b\uff0c\u5e76\u4e14\u5b9e\u9645\u8fd0\u884c\u901f\u5ea6\u96be\u4ee5\u5728\u7406\u8bba\u4e0a\u8fdb\u884c\u8ba1\u7b97\uff0c\u5b9e\u9645\u53bb\u6d4b\u91cf\u53c8\u6bd4\u8f83\u9ebb\u70e6\uff0c\u6240\u4ee5\u6211\u4eec\u901a\u5e38\u8003\u8651\u7684\u4e0d\u662f\u7b97\u6cd5\u8fd0\u884c\u7684\u5b9e\u9645\u7528\u65f6\uff0c\u800c\u662f\u7b97\u6cd5\u8fd0\u884c\u6240\u9700\u8981\u8fdb\u884c\u7684\u57fa\u672c\u64cd\u4f5c\u7684\u6570\u91cf\u3002</p>"},{"location":"%E7%AE%97%E6%B3%95/01.%E7%AE%97%E6%B3%95%E5%92%8C%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E6%A6%82%E8%BF%B0/#_2","title":"\u590d\u6742\u5ea6","text":"<p>\u590d\u6742\u5ea6\u5206\u6790\u80fd\u591f\u4f53\u73b0\u7b97\u6cd5\u8fd0\u884c\u6240\u9700\u7684\u65f6\u95f4\u548c\u7a7a\u95f4\u8d44\u6e90\u4e0e\u8f93\u5165\u6570\u636e\u5927\u5c0f\u4e4b\u95f4\u7684\u5173\u7cfb\u3002\u5b83\u63cf\u8ff0\u4e86\u968f\u7740\u8f93\u5165\u6570\u636e\u5927\u5c0f\u7684\u589e\u52a0\uff0c\u7b97\u6cd5\u6267\u884c\u6240\u9700\u65f6\u95f4\u548c\u7a7a\u95f4\u7684\u589e\u957f\u8d8b\u52bf\u3002</p> <ul> <li>\"\u65f6\u95f4\u548c\u7a7a\u95f4\u8d44\u6e90\"\u5206\u522b\u5bf9\u5e94\u65f6\u95f4\u590d\u6742\u5ea6\uff08time complexity\uff09\u548c\u7a7a\u95f4\u590d\u6742\u5ea6\uff08space complexity\uff09\u3002</li> <li>\"\u968f\u7740\u8f93\u5165\u6570\u636e\u5927\u5c0f\u7684\u589e\u52a0\"\u610f\u5473\u7740\u590d\u6742\u5ea6\u53cd\u6620\u4e86\u7b97\u6cd5\u8fd0\u884c\u6548\u7387\u4e0e\u8f93\u5165\u6570\u636e\u4f53\u91cf\u4e4b\u95f4\u7684\u5173\u7cfb\u3002</li> <li>\"\u65f6\u95f4\u548c\u7a7a\u95f4\u7684\u589e\u957f\u8d8b\u52bf\u8868\u793a\u590d\u6742\u5ea6\u5206\u6790\u5173\u6ce8\u7684\u4e0d\u662f\u8fd0\u884c\u65f6\u95f4\u6216\u5360\u7528\u7a7a\u95f4\u7684\u5177\u4f53\u503c\uff0c\u800c\u662f\u65f6\u95f4\u6216\u7a7a\u95f4\u589e\u957f\u7684\"\u5feb\u6162\"\u3002</li> </ul> <p>\u65f6\u95f4\u590d\u6742\u5ea6\u5206\u6790\u7edf\u8ba1\u7684\u4e0d\u662f\u7b97\u6cd5\u8fd0\u884c\u65f6\u95f4\uff0c\u800c\u662f\u7b97\u6cd5\u8fd0\u884c\u65f6\u95f4\u968f\u7740\u6570\u636e\u91cf\u53d8\u5927\u65f6\u7684\u589e\u957f\u8d8b\u52bf\u3002</p> <pre><code>// \u7b97\u6cd5 A \u7684\u65f6\u95f4\u590d\u6742\u5ea6\uff1a\u5e38\u6570\u9636\nvoid algorithm_A(int n) {\n    System.out.println(0);\n}\n// \u7b97\u6cd5 B \u7684\u65f6\u95f4\u590d\u6742\u5ea6\uff1a\u7ebf\u6027\u9636\nvoid algorithm_B(int n) {\n    for (int i = 0; i &lt; n; i++) {\n        System.out.println(0);\n    }\n}\n// \u7b97\u6cd5 C \u7684\u65f6\u95f4\u590d\u6742\u5ea6\uff1a\u5e38\u6570\u9636\nvoid algorithm_C(int n) {\n    for (int i = 0; i &lt; 1000000; i++) {\n        System.out.println(0);\n    }\n}\n</code></pre> <ul> <li>\u7b97\u6cd5 A \u53ea\u67091\u4e2a\u6253\u5370\u64cd\u4f5c\uff0c\u7b97\u6cd5\u8fd0\u884c\u65f6\u95f4\u4e0d\u968f\u7740n\u589e\u5927\u800c\u589e\u957f\u3002\u6211\u4eec\u79f0\u6b64\u7b97\u6cd5\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a\u201c\u5e38\u6570\u9636\u201d\u3002</li> <li>\u7b97\u6cd5 B \u4e2d\u7684\u6253\u5370\u64cd\u4f5c\u9700\u8981\u5faa\u73afn\u6b21\uff0c\u7b97\u6cd5\u8fd0\u884c\u65f6\u95f4\u968f\u7740n\u589e\u5927\u5448\u7ebf\u6027\u589e\u957f\u3002\u6b64\u7b97\u6cd5\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u88ab\u79f0\u4e3a\u201c\u7ebf\u6027\u9636\u201d\u3002</li> <li>\u7b97\u6cd5 C \u4e2d\u7684\u6253\u5370\u64cd\u4f5c\u9700\u8981\u5faa\u73af\u5f88\u591a\u6b21\uff0c\u867d\u7136\u8fd0\u884c\u65f6\u95f4\u5f88\u957f\uff0c\u4f46\u5b83\u4e0e\u8f93\u5165\u6570\u636e\u5927\u5c0fn\u65e0\u5173\u3002\u56e0\u6b64C\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u548cA\u76f8\u540c\uff0c\u4ecd\u4e3a\u201c\u5e38\u6570\u9636\u201d\u3002</li> </ul> <pre><code>int cal(int n) {\n    int sum = 0;\n    int i = 1;\n    for (; i &lt;= n; ++i) {\n        sum = sum + i;\n    }\n    return sum;\n}\n</code></pre> <p>\u5728\u666e\u901a\u7684\u8ba1\u7b97\u673a\u4e0a\uff0c\u52a0\u51cf\u4e58\u9664\u3001\u8bbf\u95ee\u53d8\u91cf\uff08\u57fa\u672c\u6570\u636e\u7c7b\u578b\u7684\u53d8\u91cf\uff0c\u4e0b\u540c\uff09\u3001\u7ed9\u53d8\u91cf\u8d4b\u503c\u7b49\u90fd\u53ef\u4ee5\u770b\u4f5c\u57fa\u672c\u64cd\u4f5c\u3002\u5bf9\u57fa\u672c\u64cd\u4f5c\u7684\u8ba1\u6570\u6216\u662f\u4f30\u6d4b\u53ef\u4ee5\u4f5c\u4e3a\u8bc4\u5224\u7b97\u6cd5\u7528\u65f6\u7684\u6307\u6807\u3002</p> <p>\u4eceCPU\u7684\u89d2\u5ea6\u6765\u770b\uff0c\u8fd9\u6bb5\u4ee3\u7801\u7684\u6bcf\u4e00\u884c\u90fd\u6267\u884c\u7740\u7c7b\u4f3c\u7684\u64cd\u4f5c\uff1a\u8bfb\u6570\u636e\u2014\u2014\u8fd0\u7b97\u2014\u2014\u5199\u6570\u636e\u3002</p> <p>\u5c3d\u7ba1\u6bcf\u884c\u4ee3\u7801\u5bf9\u5e94\u7684CPU\u6267\u884c\u7684\u4e2a\u6570\u3001\u6267\u884c\u7684\u65f6\u95f4\u90fd\u4e0d\u4e00\u6837\uff0c\u8fd9\u91cc\u53ea\u662f\u7c97\u7565\u4f30\u8ba1\uff0c\u5047\u8bbe\u6bcf\u884c\u4ee3\u7801\u6267\u884c\u7684\u65f6\u95f4\u90fd\u4e00\u6837\uff0c\u4e3aunit_time\u3002</p> <p>\u7b2c2\u30013\u884c\u4ee3\u7801\u5206\u522b\u9700\u89811\u4e2aunit_time\u7684\u6267\u884c\u65f6\u95f4\uff0c\u7b2c4\u30015\u884c\u90fd\u8fd0\u884c\u4e86n\u904d\uff0c\u6240\u4ee5\u5171\u9700\u8981 2n \u4e2a unit_time \u7684\u6267\u884c\u65f6\u95f4\uff0c\u6240\u4ee5\u8fd9\u6bb5\u4ee3\u7801\u603b\u7684\u6267\u884c\u65f6\u95f4\u5c31\u662f(2n+2)\u4e2aunit_time </p> <p>\u6b64\u6c42\u548c\u51fd\u6570\u7684\u64cd\u4f5c\u6570\u91cf\u4e0e\u8f93\u5165\u6570\u636e\u5927\u5c0f\u6210\u6b63\u6bd4\uff0c\u6216\u8005\u8bf4\u6210\"\u7ebf\u6027\u5173\u7cfb\"\u3002\u5b9e\u9645\u4e0a\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u63cf\u8ff0\u7684\u5c31\u662f\u8fd9\u4e2a\"\u7ebf\u6027\u5173\u7cfb\"\u3002</p> <pre><code>T(n)  = O(f(n))\n</code></pre> <p>T(n) \u5b83\u8868\u793a\u4ee3\u7801\u6267\u884c\u7684\u65f6\u95f4\uff1b n \u8868\u793a\u6570\u636e\u89c4\u6a21\u7684\u5927\u5c0f\uff1b  f(n) \u8868\u793a\u6bcf\u884c\u4ee3\u7801\u6267\u884c\u7684\u6b21\u6570\u603b\u548c\uff0c\u56e0\u4e3a\u8fd9\u662f\u4e00\u4e2a\u516c\u5f0f\uff0c\u6240\u4ee5\u7528 f(n) \u6765\u8868\u793a\u3002</p> <p>\u516c\u5f0f\u4e2d\u7684 O \uff0c\u8868\u793a\u4ee3\u7801\u7684\u6267\u884c\u65f6\u95f4 T(n) \u4e0e f(n) \u8868\u8fbe\u5f0f\u6210\u6b63\u6bd4\u3002\u7b2c\u4e00\u4e2a\u4f8b\u5b50\u4e2d\u7684T(n) = O(2n+2)\uff0c\u7b2c\u4e8c\u4e2a\u4f8b\u5b50\u4e2d\u7684T(n) = O(2n 2 +2n+3)\u3002</p> <p>\u5927O\u590d\u6742\u5ea6\u8868\u793a\u6cd5</p> <p>\u8fd9\u5c31\u662f\u5927O\u65f6\u95f4\u590d\u6742\u5ea6\u8868\u793a\u6cd5\u3002\u5927O\u65f6\u95f4\u590d\u6742\u5ea6\u5b9e\u9645\u4e0a\u5e76\u4e0d\u5177\u4f53\u8868\u793a\u4ee3\u7801\u771f\u6b63\u7684\u6267\u884c\u65f6\u95f4\uff0c\u800c\u662f\u8868\u793a\u4ee3\u7801\u6267\u884c\u65f6\u95f4\u968f\u6570\u636e\u89c4\u6a21\u589e\u957f\u7684\u53d8\u5316\u8d8b\u52bf\uff0c\u6240\u4ee5\u4e5f\u53eb\u4f5c\u6e10\u8fdb\u65f6\u95f4\u590d\u6742\u5ea6\uff08asymptotic time complexity\uff09\uff0c\u7b80\u79f0\u65f6\u95f4\u590d\u6742\u5ea6\u3002</p> <p>\u5f53 n \u5f88\u5927\u65f6\uff0c\u4f60\u53ef\u4ee5\u628a\u5b83\u60f3\u8c61\u6210 10000 \u3001 100000 \u3002\u800c\u516c\u5f0f\u4e2d\u7684\u4f4e\u9636\u3001\u5e38\u91cf\u3001\u7cfb\u6570\u4e09\u90e8\u5206\u5e76\u4e0d\u5de6\u53f3\u589e\u957f\u8d8b\u52bf\uff0c\u6240\u4ee5\u90fd\u53ef\u4ee5\u5ffd\u7565\u3002</p> <p>\u6211\u4eec\u53ea\u9700\u8981\u8bb0\u5f55\u4e00\u4e2a\u6700\u5927\u91cf\u7ea7\u5c31\u53ef\u4ee5\u4e86\uff0c\u5982\u679c\u7528\u5927O\u8868\u793a\u6cd5\u8868\u793a\u521a\u8bb2\u7684\u90a3\u4e24\u6bb5\u4ee3\u7801\u7684\u65f6\u95f4\u590d\u6742\u5ea6\uff0c\u5c31\u53ef\u4ee5\u8bb0\u4e3a\uff1aT(n) = O(n)\uff1b T(n) = O(n 2 )\u3002</p>"},{"location":"%E7%AE%97%E6%B3%95/01.%E7%AE%97%E6%B3%95%E5%92%8C%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E6%A6%82%E8%BF%B0/#_3","title":"\u65f6\u95f4\u590d\u6742\u5ea6\u5206\u6790","text":"<p>\u5982\u4f55\u5206\u6790\u4e00\u6bb5\u4ee3\u7801\u7684\u65f6\u95f4\u590d\u6742\u5ea6\uff1f</p> <ol> <li>\u53ea\u5173\u6ce8\u5faa\u73af\u6267\u884c\u6b21\u6570\u6700\u591a\u7684\u4e00\u6bb5\u4ee3\u7801</li> </ol> <p>\u5927O\u8fd9\u79cd\u590d\u6742\u5ea6\u8868\u793a\u65b9\u6cd5\u53ea\u662f\u8868\u793a\u4e00\u79cd\u53d8\u5316\u8d8b\u52bf\u3002\u6211\u4eec\u901a\u5e38\u4f1a\u5ffd\u7565\u6389\u516c\u5f0f\u4e2d\u7684\u5e38\u91cf\u3001\u4f4e\u9636\u3001\u7cfb\u6570\uff0c\u53ea\u9700\u8981\u8bb0\u5f55\u4e00\u4e2a\u6700\u5927\u9636\u7684\u91cf\u7ea7\u5c31\u53ef\u4ee5\u4e86\u3002 \u6240\u4ee5\u6211\u4eec\u5728\u5206\u6790\u4e00\u4e2a\u7b97\u6cd5\u3001\u4e00\u6bb5\u4ee3\u7801\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u7684\u65f6\u5019\uff0c\u4e5f\u53ea\u5173\u6ce8\u5faa\u73af\u6267\u884c\u6b21\u6570\u6700\u591a\u7684\u90a3\u4e00\u6bb5\u4ee3\u7801\u5c31\u53ef\u4ee5\u4e86\u3002 \u8fd9\u6bb5\u6838\u5fc3\u4ee3\u7801\u6267\u884c\u6b21\u6570\u7684n\u7684\u91cf\u7ea7\uff0c\u5c31\u662f\u6574\u6bb5\u8981\u5206\u6790\u4ee3\u7801\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u3002</p> <pre><code>int cal(int n) {\n    int sum = 0;\n    int i = 1;\n    for (; i &lt;= n; ++i) {\n        sum = sum + i;\n    }\n    return sum;\n}\n</code></pre> <p>\u5176\u4e2d\u7b2c 2 \u3001 3 \u884c\u4ee3\u7801\u90fd\u662f\u5e38\u91cf\u7ea7\u7684\u6267\u884c\u65f6\u95f4\uff0c\u4e0e n \u7684\u5927\u5c0f\u65e0\u5173\uff0c\u6240\u4ee5\u5bf9\u4e8e\u590d\u6742\u5ea6\u5e76\u6ca1\u6709\u5f71\u54cd\u3002\u5faa\u73af\u6267\u884c\u6b21\u6570\u6700\u591a\u7684\u662f\u7b2c 4 \u3001 5 \u884c\u4ee3\u7801\uff0c\u6240\u4ee5\u8fd9\u5757\u4ee3\u7801\u8981\u91cd\u70b9\u5206\u6790\u3002</p> <p>\u8fd9\u4e24\u884c\u4ee3\u7801\u88ab\u6267\u884c\u4e86 n \u6b21\uff0c\u6240\u4ee5\u603b\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u5c31\u662f O(n) \u3002</p> <ol> <li>\u52a0\u6cd5\u6cd5\u5219\uff1a\u603b\u590d\u6742\u5ea6\u7b49\u4e8e\u91cf\u7ea7\u6700\u5927\u7684\u90a3\u6bb5\u4ee3\u7801\u7684\u590d\u6742\u5ea6</li> </ol> <p>\u5728\u65f6\u95f4\u590d\u6742\u5ea6\u7684\u6982\u5ff5\u6765\u8bf4\uff0c\u5b83\u8868\u793a\u7684\u662f\u4e00\u4e2a\u7b97\u6cd5\u6267\u884c\u6548\u7387\u4e0e\u6570\u636e\u89c4\u6a21\u589e\u957f\u7684\u53d8\u5316\u8d8b\u52bf\uff0c\u6240\u4ee5\u4e0d\u7ba1\u5e38\u91cf\u7684\u6267\u884c\u65f6\u95f4\u591a\u5927\uff0c\u6211\u4eec\u90fd\u53ef\u4ee5\u5ffd\u7565\u6389\u3002\u56e0\u4e3a\u5b83\u672c\u8eab\u5bf9\u589e\u957f\u8d8b\u52bf\u5e76\u6ca1\u6709\u5f71\u54cd\u3002</p> <ol> <li>\u4e58\u6cd5\u6cd5\u5219\uff1a\u5d4c\u5957\u4ee3\u7801\u7684\u590d\u6742\u5ea6\u7b49\u4e8e\u5d4c\u5957\u5185\u5916\u4ee3\u7801\u590d\u6742\u5ea6\u7684\u4e58\u79ef</li> </ol>"},{"location":"%E7%AE%97%E6%B3%95/01.%E7%AE%97%E6%B3%95%E5%92%8C%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E6%A6%82%E8%BF%B0/#_4","title":"\u51e0\u79cd\u5e38\u89c1\u65f6\u95f4\u590d\u6742\u5ea6\u5b9e\u4f8b\u5206\u6790","text":"<ol> <li>\u5e38\u91cf\u9636O(1)</li> </ol> <p>O(1) \u53ea\u662f\u5e38\u91cf\u7ea7\u65f6\u95f4\u590d\u6742\u5ea6\u7684\u4e00\u79cd\u8868\u793a\u65b9\u6cd5\uff0c\u5e76\u4e0d\u662f\u6307\u53ea\u6267\u884c\u4e86\u4e00\u884c\u4ee3\u7801\u3002\u6bd4\u5982\u4e0b\u9762\u8fd9\u6bb5\u4ee3\u7801\uff0c\u5373\u4fbf\u6709 3 \u884c\uff0c\u5b83\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u4e5f\u662f O(1)\uff0c\u800c\u4e0d\u662f O(3)\u3002</p> <pre><code>int i = 8;\nint j = 6;\nint sum = i + j;\n\n/* \u5e38\u6570\u9636 */\nint constant(int n) {\n    int count = 0;\n    int size = 100000;\n    for (int i = 0; i &lt; size; i++)\n        count++;\n    return count;\n}\n</code></pre> <p>\u53ea\u8981\u4ee3\u7801\u7684\u6267\u884c\u65f6\u95f4\u4e0d\u968fn\u7684\u589e\u5927\u800c\u589e\u957f\uff0c\u8fd9\u6837\u4ee3\u7801\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u6211\u4eec\u90fd\u8bb0\u4f5cO(1)\u3002</p> <p>\u6216\u8005\u8bf4\uff0c\u4e00\u822c\u60c5\u51b5\u4e0b\uff0c\u53ea\u8981\u7b97\u6cd5\u4e2d\u4e0d\u5b58\u5728\u5faa\u73af\u8bed\u53e5\u3001\u9012\u5f52\u8bed\u53e5\uff0c\u5373\u4f7f\u6709\u6210\u5343\u4e0a\u4e07\u884c\u7684\u4ee3\u7801\uff0c\u5176\u65f6\u95f4\u590d\u6742\u5ea6\u4e5f\u662f\u039f(1)</p> <ol> <li>\u7ebf\u6027\u9636</li> </ol> <p>\u7ebf\u6027\u9636\u7684\u64cd\u4f5c\u6570\u91cf\u76f8\u5bf9\u4e8e\u8f93\u5165\u6570\u636e\u5927\u5c0f\u3002\u4ee5\u7ebf\u6027\u7ea7\u522b\u589e\u957f\u3002\u7ebf\u6027\u9636\u901a\u5e38\u51fa\u73b0\u5728\u5355\u5c42\u5faa\u73af\u4e2d</p> <pre><code>/* \u7ebf\u6027\u9636 */\nint linear(int n) {\n    int count = 0;\n    for (int i = 0; i &lt; n; i++)\n        count++;\n    return count;\n}\n</code></pre>"}]}